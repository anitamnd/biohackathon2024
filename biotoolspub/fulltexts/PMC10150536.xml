<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10150536</article-id>
    <article-id pub-id-type="pmid">37121998</article-id>
    <article-id pub-id-type="publisher-id">2920</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-023-02920-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DREAMS: deep read-level error model for sequencing data applied to low-frequency variant calling and circulating tumor DNA detection</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Christensen</surname>
          <given-names>Mikkel H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Drue</surname>
          <given-names>Simon O.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Rasmussen</surname>
          <given-names>Mads H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Frydendahl</surname>
          <given-names>Amanda</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lyskjær</surname>
          <given-names>Iben</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Demuth</surname>
          <given-names>Christina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nors</surname>
          <given-names>Jesper</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gotschalck</surname>
          <given-names>Kåre A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Iversen</surname>
          <given-names>Lene H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Andersen</surname>
          <given-names>Claus L.</given-names>
        </name>
        <address>
          <email>cla@clin.au.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7236-4001</contrib-id>
        <name>
          <surname>Pedersen</surname>
          <given-names>Jakob Skou</given-names>
        </name>
        <address>
          <email>jakob.skou@clin.au.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.154185.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0512 597X</institution-id><institution>Department of Molecular Medicine, </institution><institution>Aarhus University Hospital, </institution></institution-wrap>Aarhus, Denmark </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.7048.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 1956 2722</institution-id><institution>Department of Clinical Medicine, Faculty of Health, </institution><institution>Aarhus University, </institution></institution-wrap>Aarhus, Denmark </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.414334.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 0646 9002</institution-id><institution>Department of Surgery, </institution><institution>Horsens Regional Hospital, </institution></institution-wrap>Horsens, Denmark </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.154185.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0512 597X</institution-id><institution>Department of Surgery, </institution><institution>Aarhus University Hospital, </institution></institution-wrap>Aarhus, Denmark </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.7048.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 1956 2722</institution-id><institution>Bioinformatics Research Center, Faculty of Science, </institution><institution>Aarhus University, </institution></institution-wrap>Aarhus, Denmark </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>99</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Circulating tumor DNA detection using next-generation sequencing (NGS) data of plasma DNA is promising for cancer identification and characterization. However, the tumor signal in the blood is often low and difficult to distinguish from errors. We present DREAMS (Deep Read-level Modelling of Sequencing-errors) for estimating error rates of individual read positions. Using DREAMS, we develop statistical methods for variant calling (DREAMS-vc) and cancer detection (DREAMS-cc). For evaluation, we generate deep targeted NGS data of matching tumor and plasma DNA from 85 colorectal cancer patients. The DREAMS approach performs better than state-of-the-art methods for variant calling and cancer detection.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-023-02920-1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Circulating tumor DNA</kwd>
      <kwd>Next-generation sequencing</kwd>
      <kwd>Cancer research</kwd>
      <kwd>Colorectal cancer</kwd>
      <kwd>Machine learning</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100012526</institution-id>
            <institution>Sundhedsvidenskabelige Fakultet, Aarhus Universitet</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008363</institution-id>
            <institution>Kræftens Bekæmpelse</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R307-A17932</award-id>
        <award-id>R133-A8520-00-S41</award-id>
        <award-id>R146-A9466-16-S2</award-id>
        <award-id>R231-A13845</award-id>
        <award-id>R257-A14700</award-id>
        <principal-award-recipient>
          <name>
            <surname>Andersen</surname>
            <given-names>Claus L.</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>Jakob Skou</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100005940</institution-id>
            <institution>Dansk Kræftforsknings Fond</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FID1839672</award-id>
        <principal-award-recipient>
          <name>
            <surname>Andersen</surname>
            <given-names>Claus L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003554</institution-id>
            <institution>Lundbeckfonden</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R180-2014-3998</award-id>
        <principal-award-recipient>
          <name>
            <surname>Andersen</surname>
            <given-names>Claus L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100012774</institution-id>
            <institution>Innovationsfonden</institution>
          </institution-wrap>
        </funding-source>
        <award-id>9068-00046B</award-id>
        <principal-award-recipient>
          <name>
            <surname>Andersen</surname>
            <given-names>Claus L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>NEYE Fonden</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Frimodt-Heinke Foundation</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100009708</institution-id>
            <institution>Novo Nordisk Fonden</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NNF17OC0025052</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pedersen</surname>
            <given-names>Jakob Skou</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004836</institution-id>
            <institution>Danmarks Frie Forskningsfond</institution>
          </institution-wrap>
        </funding-source>
        <award-id>8021-00419B</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pedersen</surname>
            <given-names>Jakob Skou</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008628</institution-id>
            <institution>Institut for Klinisk Medicin, Aarhus Universitet</institution>
          </institution-wrap>
        </funding-source>
        <award-id>AUFF-E-2020-6-14</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pedersen</surname>
            <given-names>Jakob Skou</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Degraded DNA fragments are released into the blood through apoptosis, necrosis, and active secretion from a range of cell types and can be detected as circulating free DNA (cfDNA) [<xref ref-type="bibr" rid="CR1">1</xref>]. Solid tumors also shed DNA into the bloodstream and cfDNA of cancer origin is called circulating tumor DNA (ctDNA) [<xref ref-type="bibr" rid="CR2">2</xref>]. The ctDNA level in blood is reported to be positively associated with tumor burden [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. As the half-life of cfDNA is less than an hour, ctDNA measurements can be considered real-time assessments of tumor burden and studies have shown that ctDNA can be more sensitive than radiological imaging [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. This makes ctDNA measurements a promising approach for detecting relapse in patients who have undergone curative surgery [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. Other proposed applications include diagnosis and intervention planning, tracking therapeutic response, monitoring the development of treatment resistance, and ultimately early detection of cancer in screening programs [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. Since obtaining liquid biopsies, such as plasma from blood samples, is both cost-effective and minimally invasive, techniques for efficient ctDNA detection hold great promise for targeted treatment in precision medicine.</p>
    <p id="Par3">In clinical contexts with low tumor burden, e.g., detection of minimal residual disease after curative-intended surgery and early detection of recurrence, the ctDNA constitute only a minor fraction of the cfDNA, often less than 0.1%. Hence, the error rate of current sequencing methods is in the same order of magnitude as the tumor signal [<xref ref-type="bibr" rid="CR12">12</xref>], making it challenging to accurately distinguish errors from true mutations in ctDNA applications. Errors can arise in several steps between the initial shedding of cfDNA and the final generation of next-generation sequencing (NGS) reads (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). DNA fragments may be damaged, e.g., by deamination or oxidation [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>], during PCR amplification of the sequencing library [<xref ref-type="bibr" rid="CR13">13</xref>], and during sequencing from PCR amplification and/or sequencing artifacts [<xref ref-type="bibr" rid="CR13">13</xref>]. For deep sequencing, some of the PCR and sequencing errors can be rectified using unique molecular identifiers (UMIs). With the use of UMIs, each DNA fragment is labeled with a unique “barcode” prior to PCR amplification, such that replicates of the same fragment can be grouped together. Errors can then be eliminated by comparing the replicates within a group, as errors from PCR amplification and sequencing are likely to be present in only a minority of reads. However, some errors, such as DNA damage introduced prior to UMI labeling, remain and continue to challenge the discrimination of true low-frequency mutational signal from these errors.<fig id="Fig1"><label>Fig. 1</label><caption><p>Error generation in next-generation sequencing data. Normal cells (gray) and cancer cells (blue) shed DNA into the bloodstream. The cancer DNA (blue) contains a mutation (yellow star). The circulating free DNA in the blood is damaged both in vivo and in vitro (green triangle). Errors can be introduced at each PCR duplication during amplification (red circle). Further errors are accumulated during sequencing and mapping (purple square). The final data contains mapped reads, where some mismatches are errors, and others are mutations from tumor cells</p></caption><graphic xlink:href="13059_2023_2920_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par4">Several methods for detecting low-frequency variants using NGS data have been developed. Most of these establish a model for the expected frequency of errors and then assess the mutational signal with a statistical test. They differ greatly in the required data prerequisites, how the errors are modeled and handled, and the final assessment of the mutational signal.</p>
    <p id="Par5">Mutect2 [<xref ref-type="bibr" rid="CR15">15</xref>], Strelka2 [<xref ref-type="bibr" rid="CR16">16</xref>], and Shearwater [<xref ref-type="bibr" rid="CR17">17</xref>] are examples of general somatic variant callers applicable for most NGS data. Mutect2 realigns reads in regions with mutational signal and then calculates a log-odds for the existence of the alternative allele using a statistical model in which the error rates are derived from the PHRED scores. Similar to Mutect2, Strelka2 realigns the reads and then uses a statistical model to determine the likelihood of a variation being real by analyzing base quality, read mapping quality, and depth at each position. Shearwater is developed specifically for low-frequency somatic variant detection for sub-clonal tumor mutations. It builds a position-specific error model based on the observed rate of read alignment mismatches across a set of training samples. A mutation is called if the observed signal exceeds what is expected from the error model. Additionally, this method can incorporate prior knowledge about the probability of the mutations of interest.</p>
    <p id="Par6">Other methods, including MRDetect [<xref ref-type="bibr" rid="CR18">18</xref>] and INVAR [<xref ref-type="bibr" rid="CR19">19</xref>], have been specifically tailored to detect ctDNA in NGS data. These methods build on the idea of aggregating the signal across multiple mutations to classify a sample as ctDNA positive or negative, as opposed to calling each individual mutation. For this purpose, a patient-specific catalog of mutations is generated from a matched tumor sample. However, the enhanced performance of these methods comes at the expense of general applicability as they assume the presence of curated data from known ctDNA fragments or specialized lab protocols. Another approach, iDES [<xref ref-type="bibr" rid="CR12">12</xref>], finds mutations in paired reads by combining a specialized stranded barcoding scheme and a polisher that aims to filter out an erroneous mutational signal based on a number of criteria, including an error model. Mutations are then called based on the remaining variant signal.</p>
    <p id="Par7">Here we develop a generally applicable ctDNA detection method based on a detailed background error model of individual read positions. This approach aims to capture general read-level error behavior and thus be applicable even for genomic regions where training data is not available. Data from reads known to come from ctDNA is not needed, and all data outside known mutated positions, or from independent normal samples can be used as training data. However, training data that was obtained similarly to the test data will provide the most precise model. Thus, severe changes in laboratory protocols should optimally be accompanied by re-training the model. Some features such as the read position [<xref ref-type="bibr" rid="CR20">20</xref>], proximity to fragment ends [<xref ref-type="bibr" rid="CR14">14</xref>], UMI group size [<xref ref-type="bibr" rid="CR12">12</xref>], GC-content [<xref ref-type="bibr" rid="CR21">21</xref>], and trinucleotide context [<xref ref-type="bibr" rid="CR22">22</xref>] have been shown to affect the probability of errors at individual read positions. By modeling their combined effect, the error rate of individual read positions may be predicted. Thereby, a read alignment mismatch, i.e., a non-reference base, with a low predicted error rate can provide more mutational evidence than a mismatch with a high error rate. This allows for improved cfDNA error modeling, which is key to develop accurate ctDNA applications.</p>
    <p id="Par8">In the following, we demonstrate how cfDNA errors can be modeled accurately using a neural network, by combining read-level features with information about the sequencing context. For this we developed DREAMS (Deep Read-level Modelling of Sequencing-errors) that incorporates both read-level and local sequence-context features for positional error rate estimation. Based on DREAMS, we developed a method for variant calling (DREAMS-<italic>vc</italic>) to accurately call individual cancer mutations in cfDNA data. The method was generalized for cancer calling in DREAMS-<italic>cc</italic> that aggregates the signal across a catalog of mutations for accurate estimation of the tumor fraction and sensitive determination of the overall cancer status. To evaluate the performance of DREAMS, we performed deep-targeted sequencing of pre- and postoperative cfDNA samples from 85 stage I–II colorectal cancer (CRC) patients and compared to state-of-the-art methods Mutect2 [<xref ref-type="bibr" rid="CR15">15</xref>] and Shearwater [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par9">Plasma cfDNA was extracted from preoperative (Pre-OP) and postoperative (Post-OP) blood draws of 85 stage I-II CRC patients (Table <xref rid="Tab1" ref-type="table">1</xref>) undergoing curative surgery. In addition, data from two stage III CRC patients were used in the model training. A biopsy from the resected tumor and paired peripheral blood cells was sequenced to generate a patient-specific mutational catalog. Post-OP samples were collected 2–4 weeks after surgical removal of the primary tumor (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Each cfDNA sample was sequenced using a custom hybrid-capture panel, designed to capture 41 exonic regions, spanning 15.413 bp, frequently mutated in CRC (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S1 and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). After collapsing UMI groups, the median of the average depths with corresponding interquartile range (IQR) of samples were for Pre-OP, 3307 (IQR: 3560); Post-OP, 7143 (IQR: 8844); buffycoat, 1850 (IQR: 1468); and tumor samples, 2132 (IQR: 2145); no samples had an average read depth below 100. All samples have been mapped and processed through the same pipeline (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S1).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Clinical characteristics</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Characteristic</th><th align="left"><bold>Count or median</bold> (percent or range)</th></tr></thead><tbody><tr><td align="left">Patients</td><td align="left">85 (100%)</td></tr><tr><td align="left" colspan="2">Gender</td></tr><tr><td align="left"> <italic>Male</italic></td><td align="left">53 (62%)</td></tr><tr><td align="left"> <italic>Female</italic></td><td align="left">32 (38%)</td></tr><tr><td align="left"> Age [years]</td><td align="left">71 (49–87)</td></tr><tr><td align="left" colspan="2">Tumor location</td></tr><tr><td align="left"> <italic>Right colon</italic></td><td align="left">23 (27%)</td></tr><tr><td align="left"> <italic>Left colon</italic></td><td align="left">26 (31%)</td></tr><tr><td align="left"> <italic>Rectum</italic></td><td align="left">36 (42%)</td></tr><tr><td align="left" colspan="2">Pathological T-stage</td></tr><tr><td align="left"> <italic>pT1</italic></td><td align="left">15 (18%)</td></tr><tr><td align="left"> <italic>pT2</italic></td><td align="left">25 (29%)</td></tr><tr><td align="left"> <italic>pT3</italic></td><td align="left">41 (48%)</td></tr><tr><td align="left"> <italic>pT4</italic></td><td align="left">4 (4.7%)</td></tr><tr><td align="left" colspan="2">UICC stage</td></tr><tr><td align="left"> <italic>I</italic></td><td align="left">40 (47%)</td></tr><tr><td align="left"> <italic>II</italic></td><td align="left">45 (53%)</td></tr></tbody></table></table-wrap><fig id="Fig2"><label>Fig. 2</label><caption><p>The data collection setup for tumor-informed relapse detection in colon cancer patients. After the patient is diagnosed, a liquid biopsy is extracted prior to curative surgery (Pre-OP). A biopsy is taken from the resected tumor. Following surgery liquid biopsies (Post-OP) can be collected to monitor relapse. All collected samples are sequenced using next-generation sequencing</p></caption><graphic xlink:href="13059_2023_2920_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par10">We first identified features that are known or expected to affect the error rate (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). In general, they can be split into two types: local sequence-context features and read-level features. The local sequence-context features capture the genomic sequence context, including the trinucleotide context, information about the sequence complexity (Shannon entropy of nucleotide, 1-mer, or dinucleotide, 2-mer, frequency), and GC contents in an 11 bp window around the position of interest (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section).<fig id="Fig3"><label>Fig. 3</label><caption><p><bold>a</bold> Examples of local sequence-context features and read-level features extracted from reads covering a position of interest in a read mapping. Centered at the position of interest, the trinucleotide context is extracted, and the surrounding 11-bp region is used for calculating regional features, including GC content and K-mer complexity. The read pairs contain a forward and reverse read that are enumerated as either the first or second of the pair according to the order of sequencing. Two read pairs are used for illustration of the read-centric features in the panels on the right. The UMI groups are shown to indicate the variation in the number of reads used for the consensus reads. The read position and fragment size are shown for the consensus reads. <bold>b</bold>–<bold>e</bold> Variation in observed error rate for selected features based on their observed distribution: <bold>b</bold> fragment size, <bold>c</bold> UMI group size, <bold>d</bold> read position relative to the start and end of reads and the variation between the first and second read in a pair. <bold>e</bold> Error type for each strand (forward and reverse). For each feature, the 95% confidence interval is indicated by the shaded areas or error bars. See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3 for how the error rates and confidence intervals are calculated and similar plots of the remaining features</p></caption><graphic xlink:href="13059_2023_2920_Fig3_HTML" id="MO3"/></fig></p>
    <p id="Par11">The read-level features capture the structural composition of the read, UMI characteristics, and sequencing information. The structural composition includes the strand a read aligns to (forward or reverse), the number of insertions and deletions in the read, and the total size of the underlying fragment. In the read pre-processing, UMIs were used to generate consensus reads with lowered error rates (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S2). For each consensus read, we extracted the UMI-group size, the number of reads disagreeing with the consensus at the position, and the overall number of mismatches outside the position of interest. As sequencing-related features, we included the base position in the read (read position), the length of the read sequence after overlap trimming, and whether the read is the first to be sequenced from the read-pair. The read quality (PHRED score) was not included, as it had the same high value for all positions in the UMI-collapsed consensus reads.</p>
    <p id="Par12">We evaluated the individual feature associated with the error rate by analyzing the total set of read alignment mismatches (<italic>n</italic> = 707,562) across all Post-OP samples (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b–d), after excluding mutations and variants found in matching tumor and germline samples. The mismatches were compared to an equal number of randomly sampled matches, to estimate the error rate for each feature across its values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3).</p>
    <p id="Par13">Since fragment lengths of cfDNA are influenced by nucleosome binding patterns, the fragment length distribution has peaks at around 162 bp (mono-nucleosomal) and 340 bp (di-nucleosomal) [<xref ref-type="bibr" rid="CR23">23</xref>]. The error rate tended to be minimized in fragments of these lengths (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). As expected, we observed a lower error rate in consensus reads formed by larger UMI groups [<xref ref-type="bibr" rid="CR12">12</xref>] (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c).</p>
    <p id="Par14">The error distribution for the read position showed an increased error rate in the beginning and end of the reads (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). We also observed a clear difference in error distribution along the read between the first and second read of the pair. The 12 different nucleotide alterations showed widely different error rates (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e), which is expected as error-induced mismatches are not equally likely, and the rate further differed between the two strands. However, strand symmetric alterations were generally similar, apart from the mismatches C➔T/G➔A and C➔A/G➔T.</p>
    <p id="Par15">Overall, we saw variation in the error rate for all the presented features (the remaining are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3). Thus, for a given genomic position, different reads may have different error rates due to differences in read-level features. In the following, we present how this variation can be captured and used to potentially improve detection of ctDNA.</p>
    <sec id="Sec3">
      <title>Neural network model and feature selection</title>
      <p id="Par16">To predict the error rate at a given read position, we used a neural network model with the input features described above (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section). The predictive ability of individual features was evaluated using a “leave-one-covariate-out” (LOCO) scheme [<xref ref-type="bibr" rid="CR24">24</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4). In short, we evaluated the performance of a full model containing all features (baseline) and then the relative performances of restricted models where each feature had been left out one by one. We used the latter to measure and rank the importance of each feature (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). When leaving out the trinucleotide context, the reference base was provided instead to assess only the importance of the two neighboring nucleotides.<fig id="Fig4"><label>Fig. 4</label><caption><p><bold>a</bold> Features are individually removed one-by-one from the full model containing all features to measure the decrease in validation error. The most important feature is then defined as the one that if removed decreases the validation error the most, and vice versa. The gray points show the mean decrease in validation error for each fold of a fivefold cross-validation. The average of these is used to rank the features by importance, indicated by the black points. <bold>b</bold> Based on the importance ranking, the features are cumulatively removed one-by-one from a full model. If the decrease in validation error compared to the full model is significant, the feature should not be removed from the model. A feature is only kept if removing it worsens the performance in all folds of the fivefold cross-validation. <bold>c</bold> Structure of the neural network model. The neural network uses three different types of input features: numeric, categorical, and embedded. The input features are processed differently in each group. The input features are then parsed through three hidden layers of decreasing width. The output contains 4 nodes representing the probability of observing each of the four based (A, T, C, G) at the given read position. <bold>d</bold> Illustration of 5 × 2-cross-validation procedure for the estimation of performance. The patients are first split into two approximately equally sized folds. The neural network model is trained on the Post-OP data of fold 1 and validated by testing the models on the Pre-OP samples of the other fold. This is then repeated by swapping the data in fold 1 and 2. The whole process is repeated 5 times</p></caption><graphic xlink:href="13059_2023_2920_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par17">We found the most and second most informative feature for modeling the error rate to be respectively the read position and the strand (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). The third feature was the trinucleotide context, indicating that there is a difference in error rate for different contexts, as found by others [<xref ref-type="bibr" rid="CR19">19</xref>]. The fourth feature was whether the read was the first in the read pair to be sequenced, indicating that systematic errors might be induced by the lab protocol. The fragment length, sequence length, and UMI group size also contribute significantly to the model. The remaining features showed little to no effect on the model performance. This showed that read-level features do contribute to accurate modeling of the error rate, and that they might be at least as important as features derived from the local sequence context.</p>
      <p id="Par18">An optimal subset of informative features was chosen using a stepwise procedure where features were excluded in order of importance (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section). The set of features chosen was the smallest model that did not perform significantly worse than the full model (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4). The five least important features could be removed without any significant negative effect on the performance (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). Of the remaining eight features, seven were read-level features, namely the number of other errors in the read, the fragment length, the sequence length, the UMI group size, and if the read was first in pair, strand, and read position. The only remaining local sequence-context feature was the tri-nucleotide context.</p>
      <p id="Par19">The numerical and categorical variables are processed differently in the neural network prior to the hidden layers (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). The numerical features are batch normalized, the categorical features are one-hot encoded, and the tri-nucleotide context is embedded in three dimensions to handle the large number of possible contexts (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section).</p>
      <p id="Par20">To validate the utilization of the DREAMS error model, we applied it in calling tumor variants (DREAMS-<italic>vc</italic>) and cancer (DREAMS-<italic>cc</italic>) (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section). We assessed the performance using five repeats of twofold cross-validation (5 × 2 CV) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). The model was trained on the Post-OP samples, and Pre-OP samples were used for method validation. The tumor variant positions were excluded from the training data. Potential signals from sub-clonal variants that are not detected in the tumor should be infrequent and present at low levels and therefore have minimal effect on the error model. By excluding variants found in the germline samples, we expect to reduce the potential signal of clonal hematopoiesis of indetermined potential (CHIP). The split was done on patient level to ensure that a model is not trained and tested on data from the same patient. This analysis was repeated with five different randomized splits to control for split-induced variation.</p>
    </sec>
    <sec id="Sec4">
      <title>Predictive performance in clinical data</title>
      <p id="Par21">The performance of calling tumor mutations in the plasma samples was assessed by looking at the area under the receiver operating characteristic curves (AUC). The performance of DREAMS-<italic>vc</italic> was compared to state-of-the-art algorithms Mutect2 and Shearwater. All positions with at least one observed mismatch were scored with each method and included in the performance calculations (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). Positions without signal was called negative by any method, making them redundant for performance comparisons. DREAMS was also compared to iDES [<xref ref-type="bibr" rid="CR12">12</xref>] and Strelka2 [<xref ref-type="bibr" rid="CR16">16</xref>]; however, these methods are not directly comparable and are therefore presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S5. In addition, we evaluated how the performance of DREAMS depended on the size of the training set and found it increased with the number of training samples, with the largest gain seen when going from one to two samples (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S6).<fig id="Fig5"><label>Fig. 5</label><caption><p><bold>a</bold> Performance of variant calling using DREAMS-<italic>vc</italic> compared to state-of-the-art tools Shearwater and Mutect2. The AUC is estimated based on the different negative sets: The cross-patient calls, 500 random validation alterations, and these sets combined (All). The AUC is also estimated for the full group of patients (All), and the patients with stage I and stage II CRC, individually (ns: <italic>p</italic> ≥ 0.05, *: <italic>p</italic> &lt; 0.05, **: <italic>p</italic> &lt; 0.01, ***: <italic>p</italic> &lt; 0.001, ****: <italic>p</italic> &lt; 0.0001). <bold>b</bold> Performance of variant calling using DREAMS-<italic>vc</italic>, Shearwater, and Mutect2 with various trimmings of the reads (start:end). The performance is compared pair-wise to the 0:0 model, with worse (red) and improved (green) performances indicated</p></caption><graphic xlink:href="13059_2023_2920_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par22">Using DREAMS-<italic>vc</italic>, we aimed to call the tumor mutations of each patient from their respective mutation catalog. As negative controls, we attempted to call cross-patient mutations, by searching for the mutations found in other patients. Additionally, within the sequencing panel, a set of 500 randomly selected positions each associated with a random alteration, was used as negative controls, and referred to as validation alterations.</p>
      <p id="Par23">Evaluating across the combined negative set of both cross-patient mutations and validation alterations and cancer stages, DREAMS-<italic>vc</italic> performs significantly better than both Shearwater and Mutect2 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). Additionally, the performance was assessed separately for stage I and stage II CRC patients. This showed superior performance of DREAMS-<italic>vc</italic> especially for the stage II CRC patients (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). As expected, all models perform better on later-stage patient samples as these are expected to have a higher mutational signal in the cfDNA due to a higher tumor burden. The methods perform more similarly on stage I patients; however, DREAMS-<italic>vc</italic> has significantly better performance.</p>
      <p id="Par24">Performance evaluations for each of the separate negative sets showed that DREAMS performs better than Mutect2 with the cross-patient negative set and better than Shearwater with the validation set as the negative set. The variation in performance of DREAMS-<italic>vc</italic> across splits and folds is lower than for Mutect2 and Shearwater, which indicates that its variant calling is more stable across patients and mutation types.</p>
      <p id="Par25">The explorative feature analysis indicated an increased error rate at the beginning and end of reads (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). DREAMS takes the read position into account and can thereby compensate for the increased error rate at these positions. Other methods such as Mutect2 and Shearwater are not aware of read ends and the performance of these can potentially improve by trimming these. To investigate the effect of trimming, we evaluated the performance of each method when trimming 0, 2, 6, or 12 of the bases in the beginning of reads or 0, 1, or 2 of the bases in the end of reads (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). We found that Shearwater can improve performance by trimming 2 bases from the beginning of reads and Mutect2 can improve by trimming the last base of each read. For DREAMS, the performance is only decreased when trimming, especially in the beginning of reads.</p>
      <p id="Par26">By setting the false-positive rate at 5% for each method across the validation alterations with any support, we get comparable thresholds for the three confidence measures: <italic>p</italic>-values, Bayes factor, and TLOD for DREAMS-<italic>vc</italic>, Shearwater, and Mutect2, respectively. This allows for a comparison of the sensitivity of the models at a pre-determined specificity of 95%. The methods could then be assessed across an alteration catalog of 191 true-positive mutations from the mutation catalog and 12,900 cross-patient negative calls based on the mutation catalog of the other patients. Out of the alteration catalog, 88 true mutations and 1330 cross-patient negative calls had a signal for the alteration.</p>
      <p id="Par27">Using this threshold, DREAMS-<italic>vc</italic> called 84.1% of the tumor mutations with signal, while Shearwater and Mutect2 called 70.5% and 67.0%, respectively (Table <xref rid="Tab2" ref-type="table">2</xref>). F1 and G-mean scores were calculated to assess the performance of the models by using the cross-patient mutations as negative controls. G-mean is the geometric mean of sensitivity and specificity, and F1 is the harmonic mean of precision and sensitivity. For G-mean, DREAMS-<italic>vc</italic> performed better than Shearwater and Mutect2; however, the F1 score of Shearwater was very similar to DREAMS-<italic>vc</italic>, due to lower false-positive rate of shearwater (Table <xref rid="Tab2" ref-type="table">2</xref>). Considering all mutations observed in the tumors, including those without signal in plasma, we found that about 38.7% could be recalled in Pre-OP liquid biopsy samples. DREAMS is generally more sensitive than Mutect2 and Shearwater, especially for stage II cancer mutations. Higher stage cancer is expected to have a larger signal for cancer mutations. Mutations called by DREAMS-vc but missed by Shearwater generally have low allele frequencies (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S7).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Mutation calling performance (true-positive mutations and cross-patient negative calls)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="2">Full alteration catalog<sup>a</sup></th><th align="left" colspan="4">Catalog alterations with signal<sup>b</sup></th></tr><tr><th align="left"/><th align="left">Sensitivity</th><th align="left">Specificity</th><th align="left">Sensitivity</th><th align="left">Specificity</th><th align="left">F1</th><th align="left">G-mean</th></tr></thead><tbody><tr><td align="left">DREAMS-<italic>vc</italic></td><td char="." align="char">0.387</td><td char="." align="char">0.997</td><td char="." align="char">0.841</td><td char="." align="char">0.955</td><td char="." align="char">0.479</td><td char="." align="char">0.896</td></tr><tr><td align="left">Shearwater</td><td char="." align="char">0.325</td><td char="." align="char">0.998</td><td char="." align="char">0.705</td><td char="." align="char">0.963</td><td char="." align="char">0.461</td><td char="." align="char">0.824</td></tr><tr><td align="left">Mutect2</td><td char="." align="char">0.309</td><td char="." align="char">0.997</td><td char="." align="char">0.670</td><td char="." align="char">0.948</td><td char="." align="char">0.376</td><td char="." align="char">0.797</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Full alteration catalog consisting of <italic>n</italic> = 191 true-positive mutations, and<italic> n</italic> = 12,900 potential cross-patient negative calls</p><p><sup>b</sup>Catalog of alterations with signal consisting of <italic>n</italic> = 88 true positive mutations, and <italic>n</italic> = 1330 potential cross-patient negative calls</p></table-wrap-foot></table-wrap></p>
      <p id="Par28">By setting the threshold based on a 5% false-positive rate in the cross-patient mutation set, the validation mutation set can be used as negative controls. The true positives are still the same 191 mutations of which 88 has a signal for the alteration. The negatives are the 500 validation positions multiplied with the 87 tested samples, giving a total of 43,500 possible alterations of which 1920 had a signal. With this set, we obtained an 86.4% true positive rate, compared to 76.1% for Shearwater and 67.0% for Mutect2 (Table <xref rid="Tab3" ref-type="table">3</xref>). DREAMS-<italic>vc</italic> scored highest in both F1 and G-mean scores. Here, DREAMS-<italic>vc</italic> performed distinctly better than Shearwater and Mutect2.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Mutation calling performance (true-positive mutations and validation alterations)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="2">Full alteration catalog<sup>a</sup></th><th align="left" colspan="4">Catalog alterations with signal<sup>b</sup></th></tr><tr><th align="left"/><th align="left">Sensitivity</th><th align="left">Specificity</th><th align="left">Sensitivity</th><th align="left">Specificity</th><th align="left">F1</th><th align="left">G-mean</th></tr></thead><tbody><tr><td align="left">DREAMS-<italic>vc</italic></td><td char="." align="char">0.398</td><td char="." align="char">0.997</td><td char="." align="char">0.864</td><td char="." align="char">0.946</td><td char="." align="char">0.448</td><td char="." align="char">0.904</td></tr><tr><td align="left">Shearwater</td><td char="." align="char">0.351</td><td char="." align="char">0.995</td><td char="." align="char">0.761</td><td char="." align="char">0.920</td><td char="." align="char">0.323</td><td char="." align="char">0.837</td></tr><tr><td align="left">Mutect2</td><td char="." align="char">0.309</td><td char="." align="char">0.997</td><td char="." align="char">0.670</td><td char="." align="char">0.952</td><td char="." align="char">0.388</td><td char="." align="char">0.799</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Whole catalog consisting of <italic>n</italic> = 191 true-positive mutations, and <italic>n</italic> = 43,500 validation alterations</p><p><sup>b</sup>Catalog of positions with signal consisting of <italic>n</italic> = 88 true positive mutations, and <italic>n</italic> = 1920 validation alterations</p></table-wrap-foot></table-wrap></p>
      <p id="Par29">A common measure used to predict the presence of ctDNA is the estimated tumor fraction in plasma. DREAMS-<italic>cc</italic> combines the mutational evidence across the mutation catalog, to estimate the tumor fraction with an accompanying <italic>p</italic>-value for the presence of cancer (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section). We aimed to detect cancer in the Pre-OP samples, since cancer is present and should, in theory, be detectable given enough ctDNA is present in the blood. As a negative control, we attempted to detect cancer in each Pre-OP sample (Tested Sample) with the mutation catalog from all other patients (Candidate patient) (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). In case of shared mutations between the mutation catalogs, these were eliminated to prevent false positives. As a benchmark, we constructed a cancer call score using the product of the individual Bayes factors across the mutation catalog from Shearwater, resulting in a similar tendency (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b), and for Mutect2, we used the highest scoring variant, since we do not have a natural way of combining the scores (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). The performance of calling cancer can be assessed by treating the cross-patient mutation catalogs as expected negatives and calculate an AUC score (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). Performance was compared using the 5 × 2 cross-validation setup as above (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). The AUC was similar between DREAMS-<italic>cc</italic> and Shearwater with respect to calling cancer; however, DREAMS-<italic>cc</italic> showed an increased performance. Mutect2 does not seem to be suited for cancer calling in this way. As for variant calling, we only included the samples with mutational signal to showcase and compare the performance of the different methods in discriminating tumor from error signal.<fig id="Fig6"><label>Fig. 6</label><caption><p>Prediction of cancer using <bold>a</bold> DREAMS-cc, <bold>b</bold> Shearwater, and <bold>c</bold> Mutect2. For each patient’s LB-sample (<italic>y</italic>-axis), the mutation catalog (<italic>x</italic>-axis) for every candidate patient is used for calling cancer. The patients are stratified into patients with stage I and stage II CRC. The diagonal is showing the result of using a patient’s own mutation catalog for cancer calling and constitutes the expected positives. The off-diagonal is the cross-patient results, for which the mutation catalog is filtered with the patient’s tumor and germline variants prior to cancer calling, and thus these are expected to be negative. The color scheme is chosen based on the matched quantiles of the rank from the <italic>p</italic>-value, combined Bayes factors and max TLOD from <bold>a</bold> DREAMS-cc, <bold>b</bold> Shearwater, and <bold>c</bold> Mutect2, respectively. The cancer predictions show the results from one split in the 5 × 2 CV. <bold>d</bold> AUC performance of DREAMS-cc, shearwater, and Mutect2 with respect to calling cancer using the 5 × 2 CV</p></caption><graphic xlink:href="13059_2023_2920_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par30">For the patients with stage I and II CRC, we found tumor-supporting reads in 47.5% (19/40) and 73% (33/45) of the Pre-OP samples, respectively. We called cancer in 36.6% of the stage I CRC patients, corresponding to 78.9% (15/19) of the patients with a mutational signal. We called cancer in 72.1% of the stage II CRC patients, corresponding to 93.9% (31/33) of the patients with signal. These results were obtained while still limiting the false-positive rate to 5% in cross-patient cancer calls with a non-zero mutational signal.</p>
      <p id="Par31">Detailed analysis of the false-positive cancer calls reveals that most are due to a specific KRAS G12V variant: chr12:25,245,350 C &gt; A. This variant is common in colon cancer, and it is therefore not surprising to find in the patients [<xref ref-type="bibr" rid="CR25">25</xref>]. However, the mutation was not found in the patient’s corresponding tumor or buffycoat samples. A possible explanation for this is that the mutation is not detected in the tumor biopsy due to sub-clonality [<xref ref-type="bibr" rid="CR26">26</xref>] or that there is an underlying germline signal that was not caught in the buffycoat.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Discussion</title>
    <p id="Par32">We have developed DREAMS, as a new approach for modeling the error rates in sequencing data that incorporates information from both the local sequence context and read-level information. DREAMS is intended for settings that rely on accurate error identification and quantification. We applied the error model for low-frequency ctDNA variant calling (DREAMS-<italic>vc</italic>) and cancer detection (DREAMS-<italic>cc</italic>).</p>
    <p id="Par33">The error rate was found to vary depending on several of the proposed read-level features. Surprisingly, fragment size was found to be correlated with the error rate, with the smallest error-rates being observed for fragment sizes corresponding to the mono-nucleosomal and di-nucleosomal lengths (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Fragments that deviate from these in length may have been degraded in the blood for a longer time and thereby accumulated more errors. Fragments of ctDNA are generally shorter and error rates are generally highest in short fragments, which shows the importance of accurate error modeling [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. The error rate was also found to vary with the strand, and symmetric mismatches occurred at different rates (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e). The G &gt; T/C &gt; A asymmetry can be explained by the hybridization capture protocol only targeting one strand and thus only capturing oxidative damage of that strand [<xref ref-type="bibr" rid="CR14">14</xref>]. A similar mechanism might explain the C &gt; T/G &gt; A asymmetry in the case of cytosine deamination. The error rate varied with the position in the read and was especially increased in the beginning of reads (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). This may be because the ends of fragments are prone to damage [<xref ref-type="bibr" rid="CR14">14</xref>] and in thermodynamic equilibrium with being single stranded. The error rate also varied depending on whether the read was the first or second in the pair (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). Besides being intermitted by a PCR amplification step when sequencing, the reads differ in composition and length of adapters sequenced prior to the insert, which might cause this difference.</p>
    <p id="Par34">Training a background error model using DREAMS does not require known mutation sites in aligned reads (BAM-files), as it only aims to model the errors. For optimal ctDNA detection, the error model should describe the error distribution among normal cfDNA in the evaluated samples. Training data can originate from normal samples or potentially from mutation-filtered cancer samples, as in this study. Since error patterns are highly dependent on laboratory procedures, the same protocol should be used for training samples and subsequent testing samples. From the training samples, the common patterns of the errors occurring during library preparation, sequencing, etc., can be learned and would generalize to the testing samples. Error signals that are only found in a smaller subset of training samples, such as sample or batch effects, could lead to small biases. However, these should not have any significant effect on the final model, if the model is trained across multiple samples gathered over time, thereby learning the general error patterns of the specific assay. Conversely, if the amount of data in a single sample is large, the error model could be trained on the sample itself, which would potentially yield a highly specific model that accounts for sample-specific error patterns. As shown here, even a single sample can provide sufficient data to get a relatively good performance (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S6), and similarly, it could potentially be advantageous to only train on same batch samples to diminish batch effects.</p>
    <p id="Par35">Since the biogenesis of ctDNA fragments may differ from normal cfDNA, they might have a different error profile, which could potentially lead to an error model not fitting normal cfDNA optimally. Large ctDNA contents in the training data might therefore affect ctDNA detection performance negatively and therefore best avoided. The samples here used for model training are expected to have low to no ctDNA content, and the performance presented does not indicate that our error model was affected by this.</p>
    <p id="Par36">The error model has been implemented using a neural network, allowing the feature set to be tailored to capture the relevant information of a specific setting. Analysis of the feature importance revealed that several of the proposed read-level features are useful in predicting the error rate in sequencing data (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Most features presented in this paper are general to NGS data; however, not all sequencing protocols use UMI-based error correction, rendering UMI-related features redundant. In particular, UMI cannot be exploited for shallow whole-genome sequencing as read groups cannot be formed. In such cases error rates would be increased, making accurate error modeling as performed by DREAMS even more important.</p>
    <p id="Par37">Compared to simpler methods, the presented approach is more computationally demanding, due to training of the neural network model and the use of complex data extracted from BAM-files. A neural network is a simple and flexible approach for bridging the gap between a complex set of contexts and read-level features and the error rate of a given read position but might not be the most efficient solution. The model can be trained on a regular laptop within a few hours, which should only be done once, when the training dataset is defined. Using the trained model and the statistical modules adds no significant computation time for calling mutations and cancer in the current setting. However, very large mutation catalogs are expected to increase the computation time for DREAMS-<italic>cc</italic>.</p>
    <p id="Par38">DREAMS was built to exploit read-level features under the assumption that these affect the error rate in sequencing data. Thus, the power of this approach increases with the variability in the error rate explained by read-level features. Thereby, less emphasis is put on mismatches that are likely errors, and more confidence in the potential tumor signal from other mismatches. Conversely, if read-level features are not improving error prediction, the performance is expected to be similar to methods working with simpler summary data. Although DREAMS use information about the local sequence-context, strong regional effects on the error rate are not expected to be captured by the model. An added benefit of DREAMS being position agnostic is that it can be used to predict error rates for positions for which no training data is available. In principle, the method is fit for both deep sequencing of panels and shallow sequencing of whole genomes.</p>
    <p id="Par39">In all performance comparisons, DREAMS-<italic>vc</italic> performed better than the other methods in calling tumor mutations. This indicates that read-position level features can improve performance in separating error from mutational signal. Similarly for cancer detection, DREAMS-<italic>cc</italic> performed better than Shearwater and Mutect2. Cancer was detected in most (73%) of stage II CRC cancer patients and a third (34%) of stage I patients. While Shearwater and Mutect2 could benefit from trimming the read ends, DREAMS can exploit the signal even in parts of the read with an increased error rate.</p>
    <p id="Par40">There are false-positive cancer and mutation calls, some of which could potentially be explained by clonal hematopoiesis of indeterminate potential (CHIP) or an unexpected error signal. To reduce the signal from CHIP, we have excluded positions with significant presence of non-reference nucleotides, found in the germline samples; however, a low signal might still be present. Remaining false-positive calls might be due to regional effects or sample-specific artifacts. Many of the false-positive mutation calls in the Pre-OP samples were found to be a mutation leading to the KRAS G12V variant, and it could therefore potentially be explained by a sub-clonal variant that was not identified in the tumor sample or a germline signal of clonal hematopoiesis of indeterminate potential (CHIP) that was not identified in the buffycoat samples. KRAS G12V is found to be an early driver event across multiple cancer types and therefore not expected to be particularly often subclonal [<xref ref-type="bibr" rid="CR29">29</xref>]; however, it has been identified as a potential driver of clonal hematopoiesis [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
    <p id="Par41">Sensitive variant calling in liquid biopsies can provide non-invasive insight into tumor genetics, which can potentially enable personalized treatment of patients and be a cost-effective approach for cancer screening. DREAMS-<italic>cc</italic> integrates evidence across a mutation catalog to increase sensitivity in cancer detection. Cancer detection is expected to get more sensitive as the number of mutations in the catalog rises. A potential application of DREAMS-<italic>cc</italic> could be tumor-agnostic cancer detection based on a catalog of commonly known tumor variants.</p>
    <p id="Par42">The approach presented in this paper does not rely on tumor-specific signals, such as the fragment size distribution of fragmentations patterns of ctDNA, mutational signatures, and expression information, which differentiates it from seemingly similar methods such as INVAR [<xref ref-type="bibr" rid="CR19">19</xref>] and MRDetect [<xref ref-type="bibr" rid="CR18">18</xref>]. In the case of INVAR, the statistical model underlying the test for the presence of cancer uses the differences in fragment length distribution between normal cfDNA and ctDNA to help discriminate the fragments. Furthermore, INVAR uses a simple tri-nucleotide context error model compared to DREAMS’ read-specific error model that uses multiple read-level features. Compared to MRDetect, we try to solve a similar problem using a neural network as the backbone, but with very different approaches. The Neural Network in MRDetect aims to discriminate between normal cfDNA and ctDNA by training on curated sequencing data. In DREAMS, we aim to predict the probability of an error occurring at a position in a read by training on bulk sequencing data from samples with minimal ctDNA concentration, or samples from healthy individuals. However, the performance of DREAMS could potentially be improved by incorporating a tumor-specific foreground model into the statistical framework to help guide if a fragment is indeed ctDNA, which would require a curated data from ctDNA fragments, which is rarely available. Additionally of cancer-specific regional properties or fragment behavioral information could potentially further increase sensitivity.</p>
    <p id="Par43">In this paper, we focus on the single nucleotide variants, but the model could be extended to be able to look for indels. The underlying ideas in DREAMS are not restricted to variant calling and could be used in other tasks of sequencing data analysis such as advanced error filtering.</p>
  </sec>
  <sec id="Sec6">
    <title>Conclusion</title>
    <p id="Par44">We have presented the DREAMS error rate model and demonstrated the importance of using read-level features for modeling the errors in NGS data. The model was validated in a tumor-informed setting, using DREAMS-<italic>vc</italic> for variant calling and DREAMS-<italic>cc</italic> for cancer detection in patients with CRC. DREAMS-<italic>vc</italic> allowed accurate detection of mutation signal in plasma samples extracted prior to curative intended surgery with improved performance compared to state-of-the-art methods. This highlights the importance of including read-level information in modeling the background error rate. Furthermore, DREAMS-<italic>cc</italic> demonstrated the ability to combine signal from multiple mutations known from the tumor biopsy for improved cancer detection. DREAMS-<italic>cc</italic> was able to call cancer in 73% of Pre-OP samples from CRC stage II patients and 34% of CRC stage I patients. Potential future applications of DREAMS include analysis of WGS data and tumor-agnostic cancer detection. The approach presented with DREAMS is generally applicable across NGS applications that need accurate handling and quantifications of errors, and the presented algorithms (DREAMS-<italic>vc</italic> and DREAMS-<italic>cc</italic>) are only examples of how to exploit this. The specific application presented in this paper is implemented as a user-friendly R package [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>].</p>
  </sec>
  <sec id="Sec7">
    <title>Methods</title>
    <sec id="Sec8">
      <title>Error rate prediction using read level information</title>
      <p id="Par45">In this study, we present a method called DREAMS (Deep Read-level Modelling of Sequencing-errors) for estimating the error rate at each read position using features of the individual read and the genomic context of the position. In practice, this is achieved by predicting the probability of observing each allele given the describing features of a position in a read and considering the probabilities of observing the alternative alleles as the error rates. The read-specific features can include information such as the read position, the strand of the mapped read, the length of the fragment, and UMI-group size. The read position refers to the cycle number at which the position was sequenced starting with the first nucleotide of the fragment, thus disregarding cycles used for reading primers, adapters, unaligned ends, etc. Context-specific features contain information about the genomic sequence surrounding the position, including the neighboring bases (tri-nucleotide context), the complexity, and GC-content. The local complexity is calculated as the Shannon entropy for both single nucleotides and pairs. Similarly, the local GC content is calculated as the fraction of C and G nucleotides. In principle, any feature that can be thought to affect the error rate of a read position can be added to improve the error rate prediction. Another possible feature would be the positional read quality score given by the sequencing machine. However, the estimated quality for the collapsed consensus reads were all capped at the same high value and thus excluded as they do not include any information for further modeling.</p>
    </sec>
    <sec id="Sec9">
      <title>Data</title>
      <p id="Par46">Data for a read position can be extracted from a read mapping (BAM-file) with sequencing data from a next-generation sequencing experiment. The training data for the model consists of a set of read positions from multiple samples, for which the observed allele is denoted together with the relevant features. This means that the training data includes both matches, where read positions where the observed allele is equal to the reference allele and mismatches where the observed and reference allele differ. Mismatches that correspond to known single nucleotide polymorphisms found in the germline samples are excluded from the training. Assuming that the training samples are non-cancerous means that all remaining mismatches in the dataset can be assumed to be errors that have occurred on a molecular level in the body or lab, or during sequencing of the sample.</p>
      <p id="Par47">The mismatches are extracted from the BAM-file using the mismatched positions annotated in the MD-tag. The equivalent genomic position is found, and the 11- and 3-mer context is extracted from the reference genome and used for calculation of local sequence-context features. The UMI errors and UMI count are extracted from the cE and cD tags generated by the CallMolecularConsensusReads from fgbio used for calling UMI consensus reads. Information about the insertions and deletions is extracted from the cigar tag. The fragment size is the insert-size (isize), and the read position is the position in the read sequence from the 5′-end of the read. Strand and first in pair are extracted from BAM flag where this information is encoded in a bitwise fashion.</p>
      <p id="Par48">The model assumes that the input data for both training and testing is based on readings of unique fragments, so each position in a fragment is only represented in one read. This can be assured using unique molecular identifiers (UMIs) and by trimming overlapping read positions in the read pairs.</p>
      <p id="Par49">As training on every single read position in every single read is very demanding and inefficient, we employ a methodology akin to importance sampling where we extract all the mismatches from the data and randomly sample a subset of the non-mismatches. To account for this skew induced by down-sampling one category of the training data, a rescaling scheme inspired by [<xref ref-type="bibr" rid="CR33">33</xref>] is used on the predicted error rates. The method is outlined in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S8.</p>
    </sec>
    <sec id="Sec10">
      <title>Neural network model</title>
      <sec id="Sec11">
        <title>Structure of the neural network</title>
        <p id="Par50">To predict the error rate at a given read position, we use a multilayer perceptron (MLP) which is a simple neural network setup with multiple fully connected layers. The neural network allows us to use the features without prior knowledge of how they interact among each other or how they affect the error rate. The neural network is trained using a set of read positions where the features describing the read positions are used as inputs and the observed allele as output.</p>
        <p id="Par51">For a given read position, the possible observed outcomes are the alleles A, T, C, or G. Interpreting this as a random event, the observed allele can be seen as an outcome from a four-dimensional multinomial distribution with one trial. Let <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq1.gif"/></alternatives></inline-formula> represents the observed allele in read <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M4"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq2.gif"/></alternatives></inline-formula> at position <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M6"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{ij}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq4.gif"/></alternatives></inline-formula> be the set of observed features for that read position. For a non-mutated, homozygote position, the observed allele should predominantly be the reference allele, and any observations of non-reference alleles would be considered errors. In this situation, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({X}_{ij}=A|{D}_{ij}\right)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq5.gif"/></alternatives></inline-formula> would be close to 1 if <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M12"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq6.gif"/></alternatives></inline-formula> was the reference allele for read position <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(i,j\right)$$\end{document}</tex-math><mml:math id="M14"><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq7.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({X}_{ij}=x|{D}_{ij}\right), x\in \left\{T,C,G\right\}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq8.gif"/></alternatives></inline-formula> would be the error rates for the remaining three alleles. Given a set of observations <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{\left({x}_{ij},{D}_{ij}\right)\right\}}_{i=1}^{N}$$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq9.gif"/></alternatives></inline-formula>, it is then possible to write the log-likelihood function for the observed data:<disp-formula id="Equa"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}l\left({\left\{\left({x}_{ij},{D}_{ij}\right)\right\}}_{i,j}\right)\\ =\sum\limits_{i,j}\mathrm{log}\left(P\left({X}_{ij}={x}_{ij}|{D}_{ij}\right)\right)\\ \begin{array}{l}=\sum\limits_{i,j:{x}_{ij}=A}\mathrm{log}\left(P\left({X}_{ij}=A|{D}_{ij}\right)\right)+\sum\limits_{i,j:{x}_{ij}=T}\mathrm{log}\left(P\left({X}_{ij}=T|{D}_{ij}\right)\right)+\\ \sum\limits_{i,j:{x}_{ij}=C}\mathrm{log}\left(P\left({X}_{ij}=C|{D}_{ij}\right)\right)+\sum\limits_{i,j:{x}_{ij}=G}\mathrm{log}\left(P\left({X}_{ij}=G|{D}_{ij}\right)\right)\end{array}\end{array}$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par52">The problem now becomes how to estimate the distribution <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({X}_{ij}|{D}_{ij}\right)$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq10.gif"/></alternatives></inline-formula> above. To do this, start by defining the probability functions via the SoftMax function:<disp-formula id="Equb"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({X}_{ij}=a|{D}_{ij}\right)=\frac{{e}^{{f}_{a}\left({D}_{ij}\right)}}{\sum_{{a}^{^{\prime}}\in \left\{A,T,C,G\right\}}{e}^{{f}_{{a}^{^{\prime}}}\left({D}_{ij}\right)}}$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:msup><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${f}_{a}\left({D}_{ij}\right)$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq11.gif"/></alternatives></inline-formula> is a predictor function for the allele <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a$$\end{document}</tex-math><mml:math id="M28"><mml:mi>a</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq12.gif"/></alternatives></inline-formula> using the observed information <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{ij}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq13.gif"/></alternatives></inline-formula>. As an example, for classic multinomial logistic regression, a linear predictor function is chosen such that <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${f}_{a}\left({X}_{i}\right)={\beta }_{a}\cdot {X}_{i}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq14.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{a}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq15.gif"/></alternatives></inline-formula> is a vector of feature-specific weights that can be found by maximizing the log-likelihood function. To get a more flexible model, a neural network is chosen, since this can approximate any arbitrary predictor function well including arbitrary interactions between input features. To do this <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({X}_{ij}=a|{D}_{ij}\right)$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq16.gif"/></alternatives></inline-formula> can be interpreted as the output from a neural network model where SoftMax is used as the last activation function and <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${f}_{a}\left({D}_{ij}\right)$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq17.gif"/></alternatives></inline-formula> is the output from the last hidden layer. To train such a model inspiration is drawn from likelihood theory and the negative log-likelihood function is chosen as the loss function to minimize.</p>
      </sec>
      <sec id="Sec12">
        <title>Architecture</title>
        <p id="Par53">The neural network model allows for high flexibility in the choice of features and requires very limited prior knowledge about the effect of the features on the error rate. The neural network was selected to be a MLP with an input layer, three hidden layers and an output layer. The dimension of the input layer depends on the selected input features, the hidden layers have a configuration of 128, 64, and 32 nodes with a ReLu activation function, and the output layer contains 4 nodes with SoftMax activation, as explained above, corresponding to probability of observing each of the 4 alleles. The configuration of hidden layers can be varied, depending on the input data and the available computational resources. The models were trained using the Keras library (2.3.0) in R, which is an interface that builds in Tensorflow (2.6.0) [<xref ref-type="bibr" rid="CR34">34</xref>].</p>
      </sec>
      <sec id="Sec13">
        <title>Feature handling/embedding</title>
        <p id="Par54">The features are split into numeric, categorical, and embedded variables and handled accordingly. Categorical features are one-hot encoded, and the numeric features are batch normalized. The trinucleotide context can be seen as the three distinct features: reference allele and the two neighboring bases. These can be handled as categorical features with individual one-hot encoded 4-dimensional inputs using 12 (3 × 4) input nodes in total. Alternatively, a 64-dimensional (4 × 4 × 4) one-hot encoded input of the entire trinucleotide context (TNC) can be used. We will employ another alternative that takes the 64-dimensional feature in the input layer and embeds it into a continuous 3-dimensional vector before including it in the model alongside the remaining input features. Thereby, the model can learn the relationship between the contexts, and cluster contexts that have a similar effect on the error rate close together and vice versa.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Assessing cancer status across a catalog of multiple mutation candidates</title>
      <p id="Par55">Based on the neural network error model developed above, it can now be assumed that the individual error rates for a given position in each read are known. In this section, the error rates will be exploited to develop a statistical framework for estimating the tumor fraction in a sample based on a catalog of candidate mutations. This framework can ignore some mutation candidates if these are not found in the sample, for example due to relatively low allelic frequency due to sub-clonality in the tumor or due to little tumor in the circulation. Reduction in the candidate mutations allows for a comprehensive mutation catalog to be used, where mutation candidates with limited evidence may be excluded. The subset of candidate mutations is selected statistically by finding mutations with a consistently high mutational signal, and the tumor fraction is estimated based on these candidates. This subset of mutations is then used in a statistical procedure for testing if the observed mutational signal exceeds what we would expect if no mutated DNA were present, making it possible to determine the cancer status of a patient based on the sample.</p>
    </sec>
    <sec id="Sec15">
      <title>The statistical model</title>
      <p id="Par56">Start by introducing <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq18.gif"/></alternatives></inline-formula> as a variable that controls the presence of a given mutation on the site <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M42"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq19.gif"/></alternatives></inline-formula>, such that <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}=1$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq20.gif"/></alternatives></inline-formula> represent the case where the site is mutated, and <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}=0$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq21.gif"/></alternatives></inline-formula> when it is not. Furthermore let:<disp-formula id="Equc"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}\sim Bernulli\left(r\right)$$\end{document}</tex-math><mml:math id="M48" display="block"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par57">Thus, given a catalog of possible mutations, <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M50"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq22.gif"/></alternatives></inline-formula> is the probability that each of them is present in the sample. For site <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M52"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq23.gif"/></alternatives></inline-formula> let <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R$$\end{document}</tex-math><mml:math id="M54"><mml:mi>R</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq24.gif"/></alternatives></inline-formula> be the germline reference allele and <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M56"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq25.gif"/></alternatives></inline-formula> the alternative allele of interest. Furthermore, it is assumed that the germline site is homozygote, such that any signal from non-reference alleles must be due to errors or mutational signal from a tumor. To model the molecular composition of the fragments covering site <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M58"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq26.gif"/></alternatives></inline-formula>, let <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ij}\in \left\{R,M\right\}$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq27.gif"/></alternatives></inline-formula> be the true error-free nucleotide of the <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M62"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq28.gif"/></alternatives></inline-formula>’th fragment. If the <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M64"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq29.gif"/></alternatives></inline-formula>’th mutation is not present in the sample (<inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}=0$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq30.gif"/></alternatives></inline-formula>), we are sure that the true nucleotide of the fragment is the reference and thus the following distribution holds:<disp-formula id="Equd"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({Y}_{ij}=R|{Z}_{i}=0\right)=1,\quad P\left({Y}_{ij}=M|{Z}_{i}=0\right)=0$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par58">To model the mutational DNA present in the sample, let <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f&gt;0$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>f</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq31.gif"/></alternatives></inline-formula> denote the tumor fraction. This is the fraction of the DNA in the blood that originates from tumor cells. Assuming that the mutation of interest is (sufficiently) clonal in the tumor, i.e., half of the DNA in the tumor has this mutation, the probability of a given fragment having the mutation is <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f/2$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq32.gif"/></alternatives></inline-formula>. Using this, the following distribution for <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ij}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq33.gif"/></alternatives></inline-formula> can be assumed when the mutation is present in the sample (<inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}=1$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq34.gif"/></alternatives></inline-formula>):<disp-formula id="Eque"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({Y}_{ij}=R|{Z}_{i}=1\right)=1-\frac{f}{2},\quad P\left({Y}_{ij}=M|{Z}_{i}=1\right)=\frac{f}{2}$$\end{document}</tex-math><mml:math id="M78" display="block"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par59">To model the errors that occur in NGS data, let <inline-formula id="IEq35"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq35.gif"/></alternatives></inline-formula> be the observed nucleotide in fragment <inline-formula id="IEq36"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M82"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq36.gif"/></alternatives></inline-formula> at position <inline-formula id="IEq37"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M84"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq37.gif"/></alternatives></inline-formula>. Assume that the distribution of <inline-formula id="IEq38"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq38.gif"/></alternatives></inline-formula> depends only on the corresponding true nucleotide <inline-formula id="IEq39"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ij}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq39.gif"/></alternatives></inline-formula>, in the sense that the event <inline-formula id="IEq40"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}\ne {Y}_{ij}$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq40.gif"/></alternatives></inline-formula> corresponds to the observation being an error. This distribution is exactly what the neural network model described above aims to approximate using the observed features <inline-formula id="IEq41"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{ij}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq41.gif"/></alternatives></inline-formula>. To simplify notation, the dependence of <inline-formula id="IEq42"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq42.gif"/></alternatives></inline-formula> on <inline-formula id="IEq43"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{ij}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq43.gif"/></alternatives></inline-formula> will be omitted from the notation in the following. Note that observations <inline-formula id="IEq44"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq44.gif"/></alternatives></inline-formula> outside <inline-formula id="IEq45"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{R,M\}$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq45.gif"/></alternatives></inline-formula> will have little information about the true nucleotide <inline-formula id="IEq46"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ij}$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq46.gif"/></alternatives></inline-formula>. Furthermore, since the error rates generally are low, the difference between including interactions between all four possible alleles and only the two allele of interest is negligible. Thus, to simplify the following calculations, we assume that <inline-formula id="IEq47"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}\in \{R,M\}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq47.gif"/></alternatives></inline-formula>. In practice, this means that all fragments, <inline-formula id="IEq48"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j^{\prime}$$\end{document}</tex-math><mml:math id="M106"><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq48.gif"/></alternatives></inline-formula>, for which <inline-formula id="IEq49"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i{j}^{^{\prime}}}\notin \left\{R,M\right\}$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mrow></mml:msub><mml:mo>∉</mml:mo><mml:mfenced close="}" open="{"><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq49.gif"/></alternatives></inline-formula> are eliminated from the analysis. Using this assumption, we define the probability of observing the alternative allele in a reference allele position as the following error rate:<disp-formula id="Equf"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{ij}^{R\to M}=P\left({X}_{ij}=M|{Y}_{ij}=R,{X}_{ij}\in \left\{R,M\right\}\right)=\frac{P\left({X}_{ij}=M|{Y}_{ij}=R\right)}{P\left({X}_{ij}=R|{Y}_{ij}=R\right)+P\left({X}_{ij}=M|{Y}_{ij}=R\right)}$$\end{document}</tex-math><mml:math id="M110" display="block"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mfenced></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par60">Conversely, for a fragment that stems from a tumor cell and contains the mutated allele, we define:<disp-formula id="Equg"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{ij}^{M\to R}=\frac{P\left({X}_{ij}=R|{Y}_{ij}=M\right)}{P\left({X}_{ij}=R|{Y}_{ij}=M\right)+P\left({X}_{ij}=M|{Y}_{ij}=M\right)}$$\end{document}</tex-math><mml:math id="M112" display="block"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec16">
      <title>Estimating the tumor fraction and mutation presence</title>
      <p id="Par61">In this section, we will develop a procedure for estimating the tumor fraction (<inline-formula id="IEq50"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f$$\end{document}</tex-math><mml:math id="M114"><mml:mi>f</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq50.gif"/></alternatives></inline-formula>) and mutation presence probability (<inline-formula id="IEq51"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M116"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq51.gif"/></alternatives></inline-formula>). For this, let <inline-formula id="IEq52"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\in \{1,\dots ,K\}$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq52.gif"/></alternatives></inline-formula> be the index of a catalog of <inline-formula id="IEq53"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M120"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq53.gif"/></alternatives></inline-formula> candidate mutations, <inline-formula id="IEq54"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{i}$$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq54.gif"/></alternatives></inline-formula> the corresponding number of covering reads and <inline-formula id="IEq55"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{\left({x}_{ij}\right)}_{j\in \left\{1,...,{N}_{i}\right\}}\right\}}_{i\in \left\{1,...,K\right\}}$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mfenced close="}" open="{"><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mfenced></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq55.gif"/></alternatives></inline-formula> all the observed alleles. First, we write the likelihood function for <inline-formula id="IEq56"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f$$\end{document}</tex-math><mml:math id="M126"><mml:mi>f</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq56.gif"/></alternatives></inline-formula> and <inline-formula id="IEq57"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M128"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq57.gif"/></alternatives></inline-formula>:<disp-formula id="Equh"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}L\left(f,r\vert{\left\{\left(x_{ij}\right)\right\}}_{i\in\left\{1,...,K\right\},j\in\left\{1,...,N_i\right\}}\right)\\=\prod\limits_{i=1}^KP\left(Z_i=0\right).\\\begin{array}{l}\prod\limits_{j:x_{ij}=R}\left[P\left(X_{ij}=R\vert Y_{ij}=R\right)P\left(Y_{ij}=R\vert Z_{ij}=0\right)+P\left(X_{ij}=R\vert Y_{ij}=M\right)P\left(Y_{ij}=M\vert Z_{ij}=0\right)\right].\\\prod\limits_{j:x_{ij}=M}\left[P\left(X_{ij}=M\vert Y_{ij}=R\right)P\left(Y_{ij}=R\vert Z_{ij}=0\right)+P\left(X_{ij}=M\vert Y_{ij}=M\right)P\left(Y_{ij}=M\vert Z_{ij}=0\right)\right]+\\\begin{array}{l}P\left(Z_i=1\right).\\\prod\limits_{j:x_{ij}=R}\left[P\left(X_{ij}=R\vert Y_{ij}=R\right)P\left(Y_{ij}=R\vert Z_{ij}=1\right)+P\left(X_{ij}=R\vert Y_{ij}=M\right)P\left(Y_{ij}=M\vert Z_{ij}=1\right)\right].\\\begin{array}{l}\prod\limits_{j:x_{ij}=M}\left[P\left(X_{ij}=M\vert Y_{ij}=R\right)P\left(Y_{ij}=R\vert Z_{ij}=1\right)+P\left(X_{ij}=M\vert Y_{ij}=M\right)P\left(Y_{ij}=M\vert Z_{ij}=1\right)\right]\\=\prod\limits_{i=1}^K\left(1-r\right)\cdot\prod\limits_{j:x_{ij}=R}\left(1-e_{ij}^{R\rightarrow M}\right)\cdot\prod\limits_{j:x_{ij}=M}e_{ij}^{R\rightarrow M}+\\r\cdot\prod\limits_{j:x_{ij}=R}\left[\left(1-e_{ij}^{R\rightarrow M}\right)\cdot\left(1-\frac f2\right)+e_{ij}^{M\rightarrow R}\cdot\frac f2\right]\cdot\prod\limits_{j:x_{ij}=M}\left[e_{ij}^{R\rightarrow M}\cdot\left(1-\frac f2\right)+\left(1-e_{ij}^{M\rightarrow R}\right)\cdot\frac f2\right]\end{array}\end{array}\end{array}\end{array}$$\end{document}</tex-math><mml:math id="M130" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>r</mml:mi></mml:mfenced><mml:mo>·</mml:mo><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>·</mml:mo><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mo>·</mml:mo><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>·</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>·</mml:mo><mml:mfrac><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mo>·</mml:mo><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>·</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>·</mml:mo><mml:mfrac><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par62">Getting a maximum likelihood estimate (MLE) of <inline-formula id="IEq58"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f$$\end{document}</tex-math><mml:math id="M132"><mml:mi>f</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq58.gif"/></alternatives></inline-formula> and <inline-formula id="IEq59"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M134"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq59.gif"/></alternatives></inline-formula> by optimizing this expression analytically is not tractable. However, by seeing <inline-formula id="IEq60"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ij}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq60.gif"/></alternatives></inline-formula> and <inline-formula id="IEq61"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq61.gif"/></alternatives></inline-formula> as latent variables, estimates can be found by employing an EM-algorithm (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S9). For now, assume that <inline-formula id="IEq62"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{f}$$\end{document}</tex-math><mml:math id="M140"><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq62.gif"/></alternatives></inline-formula> and <inline-formula id="IEq63"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{r}$$\end{document}</tex-math><mml:math id="M142"><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq63.gif"/></alternatives></inline-formula> are MLEs of <inline-formula id="IEq64"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f$$\end{document}</tex-math><mml:math id="M144"><mml:mi>f</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq64.gif"/></alternatives></inline-formula> and <inline-formula id="IEq65"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M146"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq65.gif"/></alternatives></inline-formula> respectively.</p>
      <p id="Par63">To test if a sample has a significant content of mutational DNA, we focus on the parameters in the model. By representing the hypothesis of a negative sample as a tumor fraction of 0 and no mutations present (<inline-formula id="IEq66"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{0}:f,r=0$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq66.gif"/></alternatives></inline-formula>) and a positive sample as a positive tumor fraction and some mutations present<inline-formula id="IEq67"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({H}_{A}:f&gt;0,r\ge \frac{1}{K}\right)$$\end{document}</tex-math><mml:math id="M150"><mml:mfenced close=")" open="("><mml:msub><mml:mi>H</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mi>f</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>≥</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq67.gif"/></alternatives></inline-formula>, a likelihood ratio test can be used to test for significance. Note that <inline-formula id="IEq68"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r\ge \frac{1}{K}$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mi>r</mml:mi><mml:mo>≥</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq68.gif"/></alternatives></inline-formula> in <inline-formula id="IEq69"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{A}$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mi>H</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq69.gif"/></alternatives></inline-formula> corresponds to at least one mutation being present in the sample. The LR-test statistic for this test is:<disp-formula id="Equi"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q=-2\mathrm{log}\frac{L\left(\mathrm{0,0}|{\left\{\left({x}_{ij}\right)\right\}}_{i\in \left\{1,...,K\right\}, j\in \left\{1,...,{N}_{i}\right\}}\right)}{L\left(\widehat{f},\widehat{r}|{\left\{\left({x}_{ij}\right)\right\}}_{i\in \left\{1,...,K\right\}, j\in \left\{1,...,{N}_{i}\right\}}\right)}$$\end{document}</tex-math><mml:math id="M156" display="block"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">log</mml:mi><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par64">Since there are 2 free parameters in the model, it can be assumed that <inline-formula id="IEq70"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q$$\end{document}</tex-math><mml:math id="M158"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq70.gif"/></alternatives></inline-formula> is approximately <inline-formula id="IEq71"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\chi }^{2}\left(2\right)$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq71.gif"/></alternatives></inline-formula>-distributed, and a <italic>p</italic>-value can be obtained as follows:<disp-formula id="Equj"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{val}=1-{F}_{{\chi }^{2}\left(2\right)}\left(Q\right)$$\end{document}</tex-math><mml:math id="M162" display="block"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">val</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>Q</mml:mi></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equj.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par65">Using this statistical model for cancer calling on top of the error rate predictions from DREAMS, we refer to it as the DREAMS-cc.</p>
    </sec>
    <sec id="Sec17">
      <title>Calling individual mutations</title>
      <p id="Par66">In the special case where the number of mutations in the catalog is <inline-formula id="IEq72"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=1$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq72.gif"/></alternatives></inline-formula>, the algorithm outlined above can be thought of as a regular variant caller. In this case, the concept of some mutations not being present in the sample is unnecessary, as the presence of the single mutations of interest can be governed solely by the tumor fraction <inline-formula id="IEq73"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f$$\end{document}</tex-math><mml:math id="M166"><mml:mi>f</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq73.gif"/></alternatives></inline-formula>. The algorithm above is easily modified to handle this by assuming that <inline-formula id="IEq74"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=1$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq74.gif"/></alternatives></inline-formula>, and using one degree of freedom for the <inline-formula id="IEq75"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\chi }^{2}$$\end{document}</tex-math><mml:math id="M170"><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq75.gif"/></alternatives></inline-formula>-distribution in the significance test. The equations in the EM-algorithm can also be simplified by making this assumption. We refer to the variant caller as DREAMS<italic>-vc.</italic></p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2023_2920_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary material, Supplementary methods, tables, and figures  [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR35">35</xref>–<xref ref-type="bibr" rid="CR43">43</xref>].</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2023_2920_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Mikkel H. Christensen, Simon O. Drue, Mads H. Rasmussen, and Amanda Frydendahl shared the first authorship.</p>
    </fn>
    <fn>
      <p>Claus L. Andersen and Jakob Skou Pedersen shared the senior authorship.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the participating CRC patients and the Danish Cancer Biobank for contributing clinical material. We also thank the IMPROVE study group for patient inclusion: Kåre Andersson Gotschalck (Horsens Hospital), Lene Hjerrild Iversen (Aarhus University Hospital), Uffe Schou Løve (Viborg hospital), Anders Husted Madsen (Herning Hospital), Ole Thorlacius-Ussing (Aalborg University Hospital), Ismail Gögenur (Køge Hospital), Per Vadgaard Andersen (Odense University Hospital), Jakob Lykke (Herlev Hospital), Peter Bondeven (Randers Hospital), and Nis Hallundbæk Schlesinger (Bispebjerg Hospital).</p>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par67">Anahita Bishop and Andrew Cosgrove were the primary editors of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="FPar2">
      <title>Review history</title>
      <p id="Par68">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MHC, SD, CLA, and JSP conceived and designed the study. MHC and SD developed the statistical methods and the software under supervision by JSP with input from MHR and CLA. MHR, AF, IL, CD, JN, KAG, and LHI acquired patient samples and generated patient data, including NGS data. MHC, SD, MHR, AF, CLA, and JSP analyzed and interpreted the patient data. SD and MHC wrote the article under the supervision of CLA and JSP with revisions and suggestions from the other authors. All authors read and approved the final manuscript.</p>
    <sec id="FPar3">
      <title>Authors’ Twitter handles</title>
      <p id="Par69">Amanda Frydendahl, @amanda_fbj; Iben Lyskjær, @illyskjaer; Jesper Nors, @JesperNors; Lene H. Iversen, @LeneHjerrild; Claus L. Andersen, @ClausLindbjerg; Jakob Skou Pedersen, @skouped.</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>MHR, AF, LI, JN, and CLA were funded by Aarhus University, Lundbeck Foundation (R180-2014–3998), Dansk Kræftforsknings Fond (FID1839672), Innovationfund Denmark (9068-00046B), Danish Cancer Society (R133-A8520-00-S41, R146-A9466-16-S2, R231-A13845, R257-A14700), NEYE foundation, Frimodt-Heinke Foundation, and Novo Nordisk Foundation (NNF17OC0025052). SD, MHC, and JSP were funded by Aarhus University, the Independent Research Fund Denmark | Medical Sciences (8021-00419B), the Danish Cancer Society (R307-A17932), and Aarhus University Research Foundation (AUFF-E-2020–6-14).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The data that support the findings of this study are available on request from the corresponding author [CLA]. The data are not publicly available due to them containing information that could compromise the research participants’ privacy. Access to the data requires that the Danish National Committee on Health Research Ethics ethically approve the requestors’ intended use of the data and that the legal entity of the data requestor enters into a data protection agreement with the Danish data controller, the Central Denmark Region. DREAMS is available as an R software package Zenodo and GitHub under GPL-3.0 license [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p id="Par70">The Committees on Biomedical Research Ethics in the Central Region of Denmark have approved the study (J. No. 1–10-72–3-18). The study was performed in accordance with the Declaration of Helsinki and all participants provided written informed consent.</p>
    </notes>
    <notes id="FPar5">
      <title>Consent for publication</title>
      <p id="Par71">Not applicable.</p>
    </notes>
    <notes id="FPar6" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par72">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>The main sources of circulating cell-free DNA: apoptosis, necrosis and active secretion</article-title>
        <source>Crit Rev Oncol Hematol</source>
        <year>2021</year>
        <volume>157</volume>
        <fpage>103166</fpage>
        <pub-id pub-id-type="doi">10.1016/j.critrevonc.2020.103166</pub-id>
        <?supplied-pmid 33254039?>
        <pub-id pub-id-type="pmid">33254039</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bettegowda</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sausen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Leary</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Kinde</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Agrawal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bartlett</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Luber</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Alani</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detection of circulating tumor DNA in early- and late-stage human malignancies</article-title>
        <source>Sci Transl Med</source>
        <year>2014</year>
        <volume>6</volume>
        <fpage>224ra224</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.3007094</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phallen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sausen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Adleff</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Leal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hruban</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Anagnostou</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Fiksel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cristiano</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Papp</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Direct detection of early-stage cancers using circulating tumor DNA</article-title>
        <source>Sci Transl Med</source>
        <year>2017</year>
        <volume>9</volume>
        <fpage>eaan2415</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.aan2415</pub-id>
        <?supplied-pmid 28814544?>
        <pub-id pub-id-type="pmid">28814544</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abbosh</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Birkbak</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Jamal-Hanjani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Constantin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Salari</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Le Quesne</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Veeriah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rosenthal</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phylogenetic ctDNA analysis depicts early-stage lung cancer evolution</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>545</volume>
        <fpage>446</fpage>
        <lpage>451</lpage>
        <pub-id pub-id-type="doi">10.1038/nature22364</pub-id>
        <?supplied-pmid 28445469?>
        <pub-id pub-id-type="pmid">28445469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coakley</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Garcia-Murillas</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>NC</given-names>
          </name>
        </person-group>
        <article-title>Molecular residual disease and adjuvant trial design in solid tumors</article-title>
        <source>Clin Cancer Res</source>
        <year>2019</year>
        <volume>25</volume>
        <fpage>6026</fpage>
        <lpage>6034</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-19-0152</pub-id>
        <?supplied-pmid 31088829?>
        <pub-id pub-id-type="pmid">31088829</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henriksen</surname>
            <given-names>TV</given-names>
          </name>
          <name>
            <surname>Tarazona</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Frydendahl</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gimeno-Valiente</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Carbonell-Asins</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Renner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hafez</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Roda</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Circulating tumor DNA in stage III colorectal cancer, beyond minimal residual disease detection, toward assessment of adjuvant therapy efficacy and clinical behavior of recurrences</article-title>
        <source>Clin Cancer Res</source>
        <year>2022</year>
        <volume>28</volume>
        <fpage>507</fpage>
        <lpage>517</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-21-2404</pub-id>
        <?supplied-pmid 34625408?>
        <pub-id pub-id-type="pmid">34625408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Øgaard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Henriksen</surname>
            <given-names>TV</given-names>
          </name>
          <name>
            <surname>Frydendahl</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aagaard</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Ørntoft M-BW, Larsen MØ, Knudsen AR, Mortensen FV, Andersen CL: Tumour-agnostic circulating tumour DNA analysis for improved recurrence surveillance after resection of colorectal liver metastases: a prospective cohort study</article-title>
        <source>Eur J Cancer</source>
        <year>2022</year>
        <volume>163</volume>
        <fpage>163</fpage>
        <lpage>176</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ejca.2021.12.026</pub-id>
        <?supplied-pmid 35074652?>
        <pub-id pub-id-type="pmid">35074652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cescon</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Bratman</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Siu</surname>
            <given-names>LL</given-names>
          </name>
        </person-group>
        <article-title>Circulating tumor DNA and liquid biopsy in oncology</article-title>
        <source>Nat Cancer</source>
        <year>2020</year>
        <volume>1</volume>
        <fpage>276</fpage>
        <lpage>290</lpage>
        <pub-id pub-id-type="doi">10.1038/s43018-020-0043-5</pub-id>
        <?supplied-pmid 35122035?>
        <pub-id pub-id-type="pmid">35122035</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diehl</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Choti</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Romans</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goodman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Agrawal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sokoll</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Szabo</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Circulating mutant DNA to assess tumor dynamics</article-title>
        <source>Nat Med</source>
        <year>2008</year>
        <volume>14</volume>
        <fpage>985</fpage>
        <lpage>990</lpage>
        <pub-id pub-id-type="doi">10.1038/nm.1789</pub-id>
        <?supplied-pmid 18670422?>
        <pub-id pub-id-type="pmid">18670422</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garcia-Murillas</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schiavon</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Weigelt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hrebien</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cutts</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Cheang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Osin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nerurkar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kozarewa</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mutation tracking in circulating tumor DNA predicts relapse in early breast cancer</article-title>
        <source>Sci Transl Med</source>
        <year>2015</year>
        <volume>7</volume>
        <fpage>302ra133</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.aab0021</pub-id>
        <?supplied-pmid 26311728?>
        <pub-id pub-id-type="pmid">26311728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corcoran</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Chabner</surname>
            <given-names>BA</given-names>
          </name>
        </person-group>
        <article-title>Application of cell-free DNA analysis to cancer treatment</article-title>
        <source>N Engl J Med</source>
        <year>2018</year>
        <volume>379</volume>
        <fpage>1754</fpage>
        <lpage>1765</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMra1706174</pub-id>
        <?supplied-pmid 30380390?>
        <pub-id pub-id-type="pmid">30380390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lovejoy</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Klass</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Chabon</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Stehr</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Bratman</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Say</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated digital error suppression for improved detection of circulating tumor DNA</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>547</fpage>
        <lpage>555</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3520</pub-id>
        <?supplied-pmid 27018799?>
        <pub-id pub-id-type="pmid">27018799</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Ma X, Shao Y, Tian L, Flasch DA, Mulder HL, Edmonson MN, et al. Analysis of error profiles in deep next-generation sequencing data. Genome Biol. 2019;20:50.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Evans Thomas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ettwiller Laurence</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>DNA damage is a pervasive cause of sequencing errors, directly confounding variant identification</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>355</volume>
        <fpage>752</fpage>
        <lpage>756</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aai8690</pub-id>
        <?supplied-pmid 28209900?>
        <pub-id pub-id-type="pmid">28209900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Benjamin D, Sato T, Cibulskis K, Getz G, Stewart C, Lichtenstein L: Calling Somatic SNVs and Indels with Mutect2. Cold Spring Harbor Laboratory; 2019. 10.1101/861054.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Scheffler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Halpern</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Bekritsky</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Noh</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Källberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Beyter</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Krusche</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Saunders</surname>
            <given-names>CT</given-names>
          </name>
        </person-group>
        <article-title>Strelka2: fast and accurate calling of germline and somatic variants</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>591</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0051-x</pub-id>
        <?supplied-pmid 30013048?>
        <pub-id pub-id-type="pmid">30013048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerstung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Papaemmanuil</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Subclonal variant calling with multiple samples and prior knowledge</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1198</fpage>
        <lpage>1204</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt750</pub-id>
        <?supplied-pmid 24443148?>
        <pub-id pub-id-type="pmid">24443148</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zviran</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schulman</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>STK</given-names>
          </name>
          <name>
            <surname>Deochand</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khamnei</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Maloney</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Widman</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide cell-free DNA mutational integration enables ultra-sensitive cancer monitoring</article-title>
        <source>Nat Med</source>
        <year>2020</year>
        <volume>26</volume>
        <fpage>1114</fpage>
        <lpage>1124</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-020-0915-3</pub-id>
        <?supplied-pmid 32483360?>
        <pub-id pub-id-type="pmid">32483360</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wan</surname>
            <given-names>JCM</given-names>
          </name>
          <name>
            <surname>Heider</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gale</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mouliere</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ruiz-Valdepenas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Santonja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chandrananda</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ctDNA monitoring using patient-specific sequencing and integration of variant reads</article-title>
        <source>Sci Transl Med</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>eaaz8084</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.aaz8084</pub-id>
        <?supplied-pmid 32554709?>
        <pub-id pub-id-type="pmid">32554709</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pfeiffer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gröber</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Blank</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Händler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Beyer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schultze</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Mayer</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Systematic evaluation of error rates and causes in short samples in next-generation sequencing</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>10950</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-018-29325-6</pub-id>
        <?supplied-pmid 30026539?>
        <pub-id pub-id-type="pmid">30026539</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huptas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wenning</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Optimized Illumina PCR-free library preparation for bacterial whole genome sequencing and analysis of factors influencing de novo assembly</article-title>
        <source>BMC Res Notes</source>
        <year>2016</year>
        <volume>9</volume>
        <fpage>269</fpage>
        <pub-id pub-id-type="doi">10.1186/s13104-016-2072-9</pub-id>
        <?supplied-pmid 27176120?>
        <pub-id pub-id-type="pmid">27176120</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meacham</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Boffelli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dhahbi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>DIK</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Identification and correction of systematic error in high-throughput sequence data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>451</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-451</pub-id>
        <?supplied-pmid 22099972?>
        <pub-id pub-id-type="pmid">22099972</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Blumenfeld</surname>
            <given-names>YJ</given-names>
          </name>
          <name>
            <surname>Chitkara</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Hudgins</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Analysis of the size distributions of fetal and maternal cell-free DNA by paired-end sequencing</article-title>
        <source>Clin Chem</source>
        <year>2010</year>
        <volume>56</volume>
        <fpage>1279</fpage>
        <lpage>1286</lpage>
        <pub-id pub-id-type="doi">10.1373/clinchem.2010.144188</pub-id>
        <?supplied-pmid 20558635?>
        <pub-id pub-id-type="pmid">20558635</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lei</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>G’Sell</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rinaldo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Wasserman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Distribution-free predictive inference for regression</article-title>
        <source>J Am Stat Assoc</source>
        <year>2018</year>
        <volume>113</volume>
        <fpage>1094</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2017.1307116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hayama</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hashiguchi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Okamoto</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Okada</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ono</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shimada</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ozawa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Toyoda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tsuchiya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Iinuma</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>G12V and G12C mutations in the gene KRAS are associated with a poorer prognosis in primary colorectal cancer</article-title>
        <source>Int J Colorectal Dis</source>
        <year>2019</year>
        <volume>34</volume>
        <fpage>1491</fpage>
        <lpage>1496</lpage>
        <pub-id pub-id-type="doi">10.1007/s00384-019-03344-9</pub-id>
        <?supplied-pmid 31309326?>
        <pub-id pub-id-type="pmid">31309326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parikh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goyal</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hazar-Rethinam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Siravegna</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Blaszkowsky</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Russo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Van Seventer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nadres</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shahzade</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic liquid biopsy identifies novel and heterogeneous mechanisms of acquired resistance in gastrointestinal (GI) cancer patients</article-title>
        <source>Ann Oncol</source>
        <year>2017</year>
        <volume>28</volume>
        <fpage>iii137</fpage>
        <pub-id pub-id-type="doi">10.1093/annonc/mdx262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cristiano</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Phallen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fiksel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Adleff</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bruhm</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Medina</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Hruban</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide cell-free DNA fragmentation in patients with cancer</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>570</volume>
        <fpage>385</fpage>
        <lpage>389</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1272-6</pub-id>
        <?supplied-pmid 31142840?>
        <pub-id pub-id-type="pmid">31142840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mouliere</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rosenfeld</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Circulating tumor-derived DNA is shorter than somatic DNA in plasma</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>3178</fpage>
        <lpage>3179</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1501321112</pub-id>
        <?supplied-pmid 25733911?>
        <pub-id pub-id-type="pmid">25733911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerstung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jolly</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Leshchiner</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Dentro</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rosebrock</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mitchell</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Rubanova</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Anur</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The evolutionary history of 2,658 cancers</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>578</volume>
        <fpage>122</fpage>
        <lpage>128</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1907-7</pub-id>
        <?supplied-pmid 32025013?>
        <pub-id pub-id-type="pmid">32025013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Pich O, Reyes-Salazar I, Gonzalez-Perez A, Lopez-Bigas N. Discovering the drivers of clonal hematopoiesis. Nat Commun. 2022;13:4267.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Christensen MH, Drue S, Rasmussen MH, Frydendahl Boll Johansen A, Lyskjær I, Demuth C, et al. DREAMS R package - Zenodo. Zenodo. 2023. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/badge/latestdoi/455089263">https://zenodo.org/badge/latestdoi/455089263</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Christensen MH, Drue S, Rasmussen MH, Frydendahl Boll Johansen A, Lyskjær I, Demuth C, et al. DREAMS R package - Github. Github. 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/JakobSkouPedersenLab/dreams">https://github.com/JakobSkouPedersenLab/dreams</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Pozzolo AD, Caelen O, Johnson RA, Bontempi G. Calibrating Probability with Undersampling for Unbalanced Classification. Cape Town: 2015 IEEE Symposium Series on Computational Intelligence; 2015. pp. 159–166. 10.1109/SSCI.2015.33.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Abadi M, Agarwal A, Barham P, Brevdo E, Chen Z, Citro C, et al. Tensorflow: large-scale machine learning on heterogeneous distributed systems. arXiv. 2016;1603.04467.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reinert</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schøler</surname>
            <given-names>LV</given-names>
          </name>
          <name>
            <surname>Thomsen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tobiasen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Vang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nordentoft</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lamy</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kannerup</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Mortensen</surname>
            <given-names>FV</given-names>
          </name>
          <name>
            <surname>Stribolt</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of circulating tumour DNA to monitor disease burden following colorectal cancer surgery</article-title>
        <source>Gut</source>
        <year>2016</year>
        <volume>65</volume>
        <fpage>625</fpage>
        <lpage>634</lpage>
        <pub-id pub-id-type="doi">10.1136/gutjnl-2014-308859</pub-id>
        <?supplied-pmid 25654990?>
        <pub-id pub-id-type="pmid">25654990</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reinert</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Petersen</surname>
            <given-names>LMS</given-names>
          </name>
          <name>
            <surname>Henriksen</surname>
            <given-names>TV</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>MØ</given-names>
          </name>
          <name>
            <surname>Rasmussen</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Johansen</surname>
            <given-names>AFB</given-names>
          </name>
          <name>
            <surname>Øgaard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Knudsen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nordentoft</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Vang</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Circulating tumor &lt;scp&gt;DNA&lt;/scp&gt; for prognosis assessment and postoperative management after curative-intent resection of colorectal liver metastases</article-title>
        <source>Int J Cancer</source>
        <year>2022</year>
        <volume>150</volume>
        <fpage>1537</fpage>
        <lpage>1548</lpage>
        <pub-id pub-id-type="doi">10.1002/ijc.33924</pub-id>
        <?supplied-pmid 34994972?>
        <pub-id pub-id-type="pmid">34994972</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Network TR: The results shown here are in whole or part based upon data generated by the TCGA Research Network: <ext-link ext-link-type="uri" xlink:href="https://www.cancer.gov/tcga">https://www.cancer.gov/tcga</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Li H. Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. arXiv pre-print server. 2013;1303.3997.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Heger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sudbery</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>UMI-tools: modeling sequencing errors in Unique Molecular Identifiers to improve quantification accuracy</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>491</fpage>
        <lpage>499</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.209601.116</pub-id>
        <?supplied-pmid 28100584?>
        <pub-id pub-id-type="pmid">28100584</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Picard toolkit [<ext-link ext-link-type="uri" xlink:href="http://broadinstitute.github.io/picard/">http://broadinstitute.github.io/picard/</ext-link>].</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Danecek P, Bonfield JK, Liddle J, Marshall J, Ohan V, Pollard MO, et al. Twelve years of SAMtools and BCFtools. GigaScience. 2021;10:giab008.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guyon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Weston</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barnhill</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vapnik</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <source>Mach Learn</source>
        <year>2002</year>
        <volume>46</volume>
        <fpage>389</fpage>
        <lpage>422</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1012487302797</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>
        <source>J Roy Stat Soc: Ser B (Methodol)</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10150536</article-id>
    <article-id pub-id-type="pmid">37121998</article-id>
    <article-id pub-id-type="publisher-id">2920</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-023-02920-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DREAMS: deep read-level error model for sequencing data applied to low-frequency variant calling and circulating tumor DNA detection</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Christensen</surname>
          <given-names>Mikkel H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Drue</surname>
          <given-names>Simon O.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Rasmussen</surname>
          <given-names>Mads H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Frydendahl</surname>
          <given-names>Amanda</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lyskjær</surname>
          <given-names>Iben</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Demuth</surname>
          <given-names>Christina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nors</surname>
          <given-names>Jesper</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gotschalck</surname>
          <given-names>Kåre A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Iversen</surname>
          <given-names>Lene H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Andersen</surname>
          <given-names>Claus L.</given-names>
        </name>
        <address>
          <email>cla@clin.au.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7236-4001</contrib-id>
        <name>
          <surname>Pedersen</surname>
          <given-names>Jakob Skou</given-names>
        </name>
        <address>
          <email>jakob.skou@clin.au.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.154185.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0512 597X</institution-id><institution>Department of Molecular Medicine, </institution><institution>Aarhus University Hospital, </institution></institution-wrap>Aarhus, Denmark </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.7048.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 1956 2722</institution-id><institution>Department of Clinical Medicine, Faculty of Health, </institution><institution>Aarhus University, </institution></institution-wrap>Aarhus, Denmark </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.414334.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 0646 9002</institution-id><institution>Department of Surgery, </institution><institution>Horsens Regional Hospital, </institution></institution-wrap>Horsens, Denmark </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.154185.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0512 597X</institution-id><institution>Department of Surgery, </institution><institution>Aarhus University Hospital, </institution></institution-wrap>Aarhus, Denmark </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.7048.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 1956 2722</institution-id><institution>Bioinformatics Research Center, Faculty of Science, </institution><institution>Aarhus University, </institution></institution-wrap>Aarhus, Denmark </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>99</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Circulating tumor DNA detection using next-generation sequencing (NGS) data of plasma DNA is promising for cancer identification and characterization. However, the tumor signal in the blood is often low and difficult to distinguish from errors. We present DREAMS (Deep Read-level Modelling of Sequencing-errors) for estimating error rates of individual read positions. Using DREAMS, we develop statistical methods for variant calling (DREAMS-vc) and cancer detection (DREAMS-cc). For evaluation, we generate deep targeted NGS data of matching tumor and plasma DNA from 85 colorectal cancer patients. The DREAMS approach performs better than state-of-the-art methods for variant calling and cancer detection.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-023-02920-1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Circulating tumor DNA</kwd>
      <kwd>Next-generation sequencing</kwd>
      <kwd>Cancer research</kwd>
      <kwd>Colorectal cancer</kwd>
      <kwd>Machine learning</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100012526</institution-id>
            <institution>Sundhedsvidenskabelige Fakultet, Aarhus Universitet</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008363</institution-id>
            <institution>Kræftens Bekæmpelse</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R307-A17932</award-id>
        <award-id>R133-A8520-00-S41</award-id>
        <award-id>R146-A9466-16-S2</award-id>
        <award-id>R231-A13845</award-id>
        <award-id>R257-A14700</award-id>
        <principal-award-recipient>
          <name>
            <surname>Andersen</surname>
            <given-names>Claus L.</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>Jakob Skou</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100005940</institution-id>
            <institution>Dansk Kræftforsknings Fond</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FID1839672</award-id>
        <principal-award-recipient>
          <name>
            <surname>Andersen</surname>
            <given-names>Claus L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003554</institution-id>
            <institution>Lundbeckfonden</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R180-2014-3998</award-id>
        <principal-award-recipient>
          <name>
            <surname>Andersen</surname>
            <given-names>Claus L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100012774</institution-id>
            <institution>Innovationsfonden</institution>
          </institution-wrap>
        </funding-source>
        <award-id>9068-00046B</award-id>
        <principal-award-recipient>
          <name>
            <surname>Andersen</surname>
            <given-names>Claus L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>NEYE Fonden</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Frimodt-Heinke Foundation</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100009708</institution-id>
            <institution>Novo Nordisk Fonden</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NNF17OC0025052</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pedersen</surname>
            <given-names>Jakob Skou</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004836</institution-id>
            <institution>Danmarks Frie Forskningsfond</institution>
          </institution-wrap>
        </funding-source>
        <award-id>8021-00419B</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pedersen</surname>
            <given-names>Jakob Skou</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008628</institution-id>
            <institution>Institut for Klinisk Medicin, Aarhus Universitet</institution>
          </institution-wrap>
        </funding-source>
        <award-id>AUFF-E-2020-6-14</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pedersen</surname>
            <given-names>Jakob Skou</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Degraded DNA fragments are released into the blood through apoptosis, necrosis, and active secretion from a range of cell types and can be detected as circulating free DNA (cfDNA) [<xref ref-type="bibr" rid="CR1">1</xref>]. Solid tumors also shed DNA into the bloodstream and cfDNA of cancer origin is called circulating tumor DNA (ctDNA) [<xref ref-type="bibr" rid="CR2">2</xref>]. The ctDNA level in blood is reported to be positively associated with tumor burden [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. As the half-life of cfDNA is less than an hour, ctDNA measurements can be considered real-time assessments of tumor burden and studies have shown that ctDNA can be more sensitive than radiological imaging [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. This makes ctDNA measurements a promising approach for detecting relapse in patients who have undergone curative surgery [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. Other proposed applications include diagnosis and intervention planning, tracking therapeutic response, monitoring the development of treatment resistance, and ultimately early detection of cancer in screening programs [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. Since obtaining liquid biopsies, such as plasma from blood samples, is both cost-effective and minimally invasive, techniques for efficient ctDNA detection hold great promise for targeted treatment in precision medicine.</p>
    <p id="Par3">In clinical contexts with low tumor burden, e.g., detection of minimal residual disease after curative-intended surgery and early detection of recurrence, the ctDNA constitute only a minor fraction of the cfDNA, often less than 0.1%. Hence, the error rate of current sequencing methods is in the same order of magnitude as the tumor signal [<xref ref-type="bibr" rid="CR12">12</xref>], making it challenging to accurately distinguish errors from true mutations in ctDNA applications. Errors can arise in several steps between the initial shedding of cfDNA and the final generation of next-generation sequencing (NGS) reads (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). DNA fragments may be damaged, e.g., by deamination or oxidation [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>], during PCR amplification of the sequencing library [<xref ref-type="bibr" rid="CR13">13</xref>], and during sequencing from PCR amplification and/or sequencing artifacts [<xref ref-type="bibr" rid="CR13">13</xref>]. For deep sequencing, some of the PCR and sequencing errors can be rectified using unique molecular identifiers (UMIs). With the use of UMIs, each DNA fragment is labeled with a unique “barcode” prior to PCR amplification, such that replicates of the same fragment can be grouped together. Errors can then be eliminated by comparing the replicates within a group, as errors from PCR amplification and sequencing are likely to be present in only a minority of reads. However, some errors, such as DNA damage introduced prior to UMI labeling, remain and continue to challenge the discrimination of true low-frequency mutational signal from these errors.<fig id="Fig1"><label>Fig. 1</label><caption><p>Error generation in next-generation sequencing data. Normal cells (gray) and cancer cells (blue) shed DNA into the bloodstream. The cancer DNA (blue) contains a mutation (yellow star). The circulating free DNA in the blood is damaged both in vivo and in vitro (green triangle). Errors can be introduced at each PCR duplication during amplification (red circle). Further errors are accumulated during sequencing and mapping (purple square). The final data contains mapped reads, where some mismatches are errors, and others are mutations from tumor cells</p></caption><graphic xlink:href="13059_2023_2920_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par4">Several methods for detecting low-frequency variants using NGS data have been developed. Most of these establish a model for the expected frequency of errors and then assess the mutational signal with a statistical test. They differ greatly in the required data prerequisites, how the errors are modeled and handled, and the final assessment of the mutational signal.</p>
    <p id="Par5">Mutect2 [<xref ref-type="bibr" rid="CR15">15</xref>], Strelka2 [<xref ref-type="bibr" rid="CR16">16</xref>], and Shearwater [<xref ref-type="bibr" rid="CR17">17</xref>] are examples of general somatic variant callers applicable for most NGS data. Mutect2 realigns reads in regions with mutational signal and then calculates a log-odds for the existence of the alternative allele using a statistical model in which the error rates are derived from the PHRED scores. Similar to Mutect2, Strelka2 realigns the reads and then uses a statistical model to determine the likelihood of a variation being real by analyzing base quality, read mapping quality, and depth at each position. Shearwater is developed specifically for low-frequency somatic variant detection for sub-clonal tumor mutations. It builds a position-specific error model based on the observed rate of read alignment mismatches across a set of training samples. A mutation is called if the observed signal exceeds what is expected from the error model. Additionally, this method can incorporate prior knowledge about the probability of the mutations of interest.</p>
    <p id="Par6">Other methods, including MRDetect [<xref ref-type="bibr" rid="CR18">18</xref>] and INVAR [<xref ref-type="bibr" rid="CR19">19</xref>], have been specifically tailored to detect ctDNA in NGS data. These methods build on the idea of aggregating the signal across multiple mutations to classify a sample as ctDNA positive or negative, as opposed to calling each individual mutation. For this purpose, a patient-specific catalog of mutations is generated from a matched tumor sample. However, the enhanced performance of these methods comes at the expense of general applicability as they assume the presence of curated data from known ctDNA fragments or specialized lab protocols. Another approach, iDES [<xref ref-type="bibr" rid="CR12">12</xref>], finds mutations in paired reads by combining a specialized stranded barcoding scheme and a polisher that aims to filter out an erroneous mutational signal based on a number of criteria, including an error model. Mutations are then called based on the remaining variant signal.</p>
    <p id="Par7">Here we develop a generally applicable ctDNA detection method based on a detailed background error model of individual read positions. This approach aims to capture general read-level error behavior and thus be applicable even for genomic regions where training data is not available. Data from reads known to come from ctDNA is not needed, and all data outside known mutated positions, or from independent normal samples can be used as training data. However, training data that was obtained similarly to the test data will provide the most precise model. Thus, severe changes in laboratory protocols should optimally be accompanied by re-training the model. Some features such as the read position [<xref ref-type="bibr" rid="CR20">20</xref>], proximity to fragment ends [<xref ref-type="bibr" rid="CR14">14</xref>], UMI group size [<xref ref-type="bibr" rid="CR12">12</xref>], GC-content [<xref ref-type="bibr" rid="CR21">21</xref>], and trinucleotide context [<xref ref-type="bibr" rid="CR22">22</xref>] have been shown to affect the probability of errors at individual read positions. By modeling their combined effect, the error rate of individual read positions may be predicted. Thereby, a read alignment mismatch, i.e., a non-reference base, with a low predicted error rate can provide more mutational evidence than a mismatch with a high error rate. This allows for improved cfDNA error modeling, which is key to develop accurate ctDNA applications.</p>
    <p id="Par8">In the following, we demonstrate how cfDNA errors can be modeled accurately using a neural network, by combining read-level features with information about the sequencing context. For this we developed DREAMS (Deep Read-level Modelling of Sequencing-errors) that incorporates both read-level and local sequence-context features for positional error rate estimation. Based on DREAMS, we developed a method for variant calling (DREAMS-<italic>vc</italic>) to accurately call individual cancer mutations in cfDNA data. The method was generalized for cancer calling in DREAMS-<italic>cc</italic> that aggregates the signal across a catalog of mutations for accurate estimation of the tumor fraction and sensitive determination of the overall cancer status. To evaluate the performance of DREAMS, we performed deep-targeted sequencing of pre- and postoperative cfDNA samples from 85 stage I–II colorectal cancer (CRC) patients and compared to state-of-the-art methods Mutect2 [<xref ref-type="bibr" rid="CR15">15</xref>] and Shearwater [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par9">Plasma cfDNA was extracted from preoperative (Pre-OP) and postoperative (Post-OP) blood draws of 85 stage I-II CRC patients (Table <xref rid="Tab1" ref-type="table">1</xref>) undergoing curative surgery. In addition, data from two stage III CRC patients were used in the model training. A biopsy from the resected tumor and paired peripheral blood cells was sequenced to generate a patient-specific mutational catalog. Post-OP samples were collected 2–4 weeks after surgical removal of the primary tumor (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Each cfDNA sample was sequenced using a custom hybrid-capture panel, designed to capture 41 exonic regions, spanning 15.413 bp, frequently mutated in CRC (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S1 and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). After collapsing UMI groups, the median of the average depths with corresponding interquartile range (IQR) of samples were for Pre-OP, 3307 (IQR: 3560); Post-OP, 7143 (IQR: 8844); buffycoat, 1850 (IQR: 1468); and tumor samples, 2132 (IQR: 2145); no samples had an average read depth below 100. All samples have been mapped and processed through the same pipeline (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S1).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Clinical characteristics</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Characteristic</th><th align="left"><bold>Count or median</bold> (percent or range)</th></tr></thead><tbody><tr><td align="left">Patients</td><td align="left">85 (100%)</td></tr><tr><td align="left" colspan="2">Gender</td></tr><tr><td align="left"> <italic>Male</italic></td><td align="left">53 (62%)</td></tr><tr><td align="left"> <italic>Female</italic></td><td align="left">32 (38%)</td></tr><tr><td align="left"> Age [years]</td><td align="left">71 (49–87)</td></tr><tr><td align="left" colspan="2">Tumor location</td></tr><tr><td align="left"> <italic>Right colon</italic></td><td align="left">23 (27%)</td></tr><tr><td align="left"> <italic>Left colon</italic></td><td align="left">26 (31%)</td></tr><tr><td align="left"> <italic>Rectum</italic></td><td align="left">36 (42%)</td></tr><tr><td align="left" colspan="2">Pathological T-stage</td></tr><tr><td align="left"> <italic>pT1</italic></td><td align="left">15 (18%)</td></tr><tr><td align="left"> <italic>pT2</italic></td><td align="left">25 (29%)</td></tr><tr><td align="left"> <italic>pT3</italic></td><td align="left">41 (48%)</td></tr><tr><td align="left"> <italic>pT4</italic></td><td align="left">4 (4.7%)</td></tr><tr><td align="left" colspan="2">UICC stage</td></tr><tr><td align="left"> <italic>I</italic></td><td align="left">40 (47%)</td></tr><tr><td align="left"> <italic>II</italic></td><td align="left">45 (53%)</td></tr></tbody></table></table-wrap><fig id="Fig2"><label>Fig. 2</label><caption><p>The data collection setup for tumor-informed relapse detection in colon cancer patients. After the patient is diagnosed, a liquid biopsy is extracted prior to curative surgery (Pre-OP). A biopsy is taken from the resected tumor. Following surgery liquid biopsies (Post-OP) can be collected to monitor relapse. All collected samples are sequenced using next-generation sequencing</p></caption><graphic xlink:href="13059_2023_2920_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par10">We first identified features that are known or expected to affect the error rate (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). In general, they can be split into two types: local sequence-context features and read-level features. The local sequence-context features capture the genomic sequence context, including the trinucleotide context, information about the sequence complexity (Shannon entropy of nucleotide, 1-mer, or dinucleotide, 2-mer, frequency), and GC contents in an 11 bp window around the position of interest (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section).<fig id="Fig3"><label>Fig. 3</label><caption><p><bold>a</bold> Examples of local sequence-context features and read-level features extracted from reads covering a position of interest in a read mapping. Centered at the position of interest, the trinucleotide context is extracted, and the surrounding 11-bp region is used for calculating regional features, including GC content and K-mer complexity. The read pairs contain a forward and reverse read that are enumerated as either the first or second of the pair according to the order of sequencing. Two read pairs are used for illustration of the read-centric features in the panels on the right. The UMI groups are shown to indicate the variation in the number of reads used for the consensus reads. The read position and fragment size are shown for the consensus reads. <bold>b</bold>–<bold>e</bold> Variation in observed error rate for selected features based on their observed distribution: <bold>b</bold> fragment size, <bold>c</bold> UMI group size, <bold>d</bold> read position relative to the start and end of reads and the variation between the first and second read in a pair. <bold>e</bold> Error type for each strand (forward and reverse). For each feature, the 95% confidence interval is indicated by the shaded areas or error bars. See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3 for how the error rates and confidence intervals are calculated and similar plots of the remaining features</p></caption><graphic xlink:href="13059_2023_2920_Fig3_HTML" id="MO3"/></fig></p>
    <p id="Par11">The read-level features capture the structural composition of the read, UMI characteristics, and sequencing information. The structural composition includes the strand a read aligns to (forward or reverse), the number of insertions and deletions in the read, and the total size of the underlying fragment. In the read pre-processing, UMIs were used to generate consensus reads with lowered error rates (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S2). For each consensus read, we extracted the UMI-group size, the number of reads disagreeing with the consensus at the position, and the overall number of mismatches outside the position of interest. As sequencing-related features, we included the base position in the read (read position), the length of the read sequence after overlap trimming, and whether the read is the first to be sequenced from the read-pair. The read quality (PHRED score) was not included, as it had the same high value for all positions in the UMI-collapsed consensus reads.</p>
    <p id="Par12">We evaluated the individual feature associated with the error rate by analyzing the total set of read alignment mismatches (<italic>n</italic> = 707,562) across all Post-OP samples (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b–d), after excluding mutations and variants found in matching tumor and germline samples. The mismatches were compared to an equal number of randomly sampled matches, to estimate the error rate for each feature across its values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3).</p>
    <p id="Par13">Since fragment lengths of cfDNA are influenced by nucleosome binding patterns, the fragment length distribution has peaks at around 162 bp (mono-nucleosomal) and 340 bp (di-nucleosomal) [<xref ref-type="bibr" rid="CR23">23</xref>]. The error rate tended to be minimized in fragments of these lengths (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). As expected, we observed a lower error rate in consensus reads formed by larger UMI groups [<xref ref-type="bibr" rid="CR12">12</xref>] (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c).</p>
    <p id="Par14">The error distribution for the read position showed an increased error rate in the beginning and end of the reads (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). We also observed a clear difference in error distribution along the read between the first and second read of the pair. The 12 different nucleotide alterations showed widely different error rates (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e), which is expected as error-induced mismatches are not equally likely, and the rate further differed between the two strands. However, strand symmetric alterations were generally similar, apart from the mismatches C➔T/G➔A and C➔A/G➔T.</p>
    <p id="Par15">Overall, we saw variation in the error rate for all the presented features (the remaining are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3). Thus, for a given genomic position, different reads may have different error rates due to differences in read-level features. In the following, we present how this variation can be captured and used to potentially improve detection of ctDNA.</p>
    <sec id="Sec3">
      <title>Neural network model and feature selection</title>
      <p id="Par16">To predict the error rate at a given read position, we used a neural network model with the input features described above (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section). The predictive ability of individual features was evaluated using a “leave-one-covariate-out” (LOCO) scheme [<xref ref-type="bibr" rid="CR24">24</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4). In short, we evaluated the performance of a full model containing all features (baseline) and then the relative performances of restricted models where each feature had been left out one by one. We used the latter to measure and rank the importance of each feature (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). When leaving out the trinucleotide context, the reference base was provided instead to assess only the importance of the two neighboring nucleotides.<fig id="Fig4"><label>Fig. 4</label><caption><p><bold>a</bold> Features are individually removed one-by-one from the full model containing all features to measure the decrease in validation error. The most important feature is then defined as the one that if removed decreases the validation error the most, and vice versa. The gray points show the mean decrease in validation error for each fold of a fivefold cross-validation. The average of these is used to rank the features by importance, indicated by the black points. <bold>b</bold> Based on the importance ranking, the features are cumulatively removed one-by-one from a full model. If the decrease in validation error compared to the full model is significant, the feature should not be removed from the model. A feature is only kept if removing it worsens the performance in all folds of the fivefold cross-validation. <bold>c</bold> Structure of the neural network model. The neural network uses three different types of input features: numeric, categorical, and embedded. The input features are processed differently in each group. The input features are then parsed through three hidden layers of decreasing width. The output contains 4 nodes representing the probability of observing each of the four based (A, T, C, G) at the given read position. <bold>d</bold> Illustration of 5 × 2-cross-validation procedure for the estimation of performance. The patients are first split into two approximately equally sized folds. The neural network model is trained on the Post-OP data of fold 1 and validated by testing the models on the Pre-OP samples of the other fold. This is then repeated by swapping the data in fold 1 and 2. The whole process is repeated 5 times</p></caption><graphic xlink:href="13059_2023_2920_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par17">We found the most and second most informative feature for modeling the error rate to be respectively the read position and the strand (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). The third feature was the trinucleotide context, indicating that there is a difference in error rate for different contexts, as found by others [<xref ref-type="bibr" rid="CR19">19</xref>]. The fourth feature was whether the read was the first in the read pair to be sequenced, indicating that systematic errors might be induced by the lab protocol. The fragment length, sequence length, and UMI group size also contribute significantly to the model. The remaining features showed little to no effect on the model performance. This showed that read-level features do contribute to accurate modeling of the error rate, and that they might be at least as important as features derived from the local sequence context.</p>
      <p id="Par18">An optimal subset of informative features was chosen using a stepwise procedure where features were excluded in order of importance (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section). The set of features chosen was the smallest model that did not perform significantly worse than the full model (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4). The five least important features could be removed without any significant negative effect on the performance (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). Of the remaining eight features, seven were read-level features, namely the number of other errors in the read, the fragment length, the sequence length, the UMI group size, and if the read was first in pair, strand, and read position. The only remaining local sequence-context feature was the tri-nucleotide context.</p>
      <p id="Par19">The numerical and categorical variables are processed differently in the neural network prior to the hidden layers (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). The numerical features are batch normalized, the categorical features are one-hot encoded, and the tri-nucleotide context is embedded in three dimensions to handle the large number of possible contexts (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section).</p>
      <p id="Par20">To validate the utilization of the DREAMS error model, we applied it in calling tumor variants (DREAMS-<italic>vc</italic>) and cancer (DREAMS-<italic>cc</italic>) (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section). We assessed the performance using five repeats of twofold cross-validation (5 × 2 CV) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). The model was trained on the Post-OP samples, and Pre-OP samples were used for method validation. The tumor variant positions were excluded from the training data. Potential signals from sub-clonal variants that are not detected in the tumor should be infrequent and present at low levels and therefore have minimal effect on the error model. By excluding variants found in the germline samples, we expect to reduce the potential signal of clonal hematopoiesis of indetermined potential (CHIP). The split was done on patient level to ensure that a model is not trained and tested on data from the same patient. This analysis was repeated with five different randomized splits to control for split-induced variation.</p>
    </sec>
    <sec id="Sec4">
      <title>Predictive performance in clinical data</title>
      <p id="Par21">The performance of calling tumor mutations in the plasma samples was assessed by looking at the area under the receiver operating characteristic curves (AUC). The performance of DREAMS-<italic>vc</italic> was compared to state-of-the-art algorithms Mutect2 and Shearwater. All positions with at least one observed mismatch were scored with each method and included in the performance calculations (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). Positions without signal was called negative by any method, making them redundant for performance comparisons. DREAMS was also compared to iDES [<xref ref-type="bibr" rid="CR12">12</xref>] and Strelka2 [<xref ref-type="bibr" rid="CR16">16</xref>]; however, these methods are not directly comparable and are therefore presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S5. In addition, we evaluated how the performance of DREAMS depended on the size of the training set and found it increased with the number of training samples, with the largest gain seen when going from one to two samples (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S6).<fig id="Fig5"><label>Fig. 5</label><caption><p><bold>a</bold> Performance of variant calling using DREAMS-<italic>vc</italic> compared to state-of-the-art tools Shearwater and Mutect2. The AUC is estimated based on the different negative sets: The cross-patient calls, 500 random validation alterations, and these sets combined (All). The AUC is also estimated for the full group of patients (All), and the patients with stage I and stage II CRC, individually (ns: <italic>p</italic> ≥ 0.05, *: <italic>p</italic> &lt; 0.05, **: <italic>p</italic> &lt; 0.01, ***: <italic>p</italic> &lt; 0.001, ****: <italic>p</italic> &lt; 0.0001). <bold>b</bold> Performance of variant calling using DREAMS-<italic>vc</italic>, Shearwater, and Mutect2 with various trimmings of the reads (start:end). The performance is compared pair-wise to the 0:0 model, with worse (red) and improved (green) performances indicated</p></caption><graphic xlink:href="13059_2023_2920_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par22">Using DREAMS-<italic>vc</italic>, we aimed to call the tumor mutations of each patient from their respective mutation catalog. As negative controls, we attempted to call cross-patient mutations, by searching for the mutations found in other patients. Additionally, within the sequencing panel, a set of 500 randomly selected positions each associated with a random alteration, was used as negative controls, and referred to as validation alterations.</p>
      <p id="Par23">Evaluating across the combined negative set of both cross-patient mutations and validation alterations and cancer stages, DREAMS-<italic>vc</italic> performs significantly better than both Shearwater and Mutect2 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). Additionally, the performance was assessed separately for stage I and stage II CRC patients. This showed superior performance of DREAMS-<italic>vc</italic> especially for the stage II CRC patients (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). As expected, all models perform better on later-stage patient samples as these are expected to have a higher mutational signal in the cfDNA due to a higher tumor burden. The methods perform more similarly on stage I patients; however, DREAMS-<italic>vc</italic> has significantly better performance.</p>
      <p id="Par24">Performance evaluations for each of the separate negative sets showed that DREAMS performs better than Mutect2 with the cross-patient negative set and better than Shearwater with the validation set as the negative set. The variation in performance of DREAMS-<italic>vc</italic> across splits and folds is lower than for Mutect2 and Shearwater, which indicates that its variant calling is more stable across patients and mutation types.</p>
      <p id="Par25">The explorative feature analysis indicated an increased error rate at the beginning and end of reads (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). DREAMS takes the read position into account and can thereby compensate for the increased error rate at these positions. Other methods such as Mutect2 and Shearwater are not aware of read ends and the performance of these can potentially improve by trimming these. To investigate the effect of trimming, we evaluated the performance of each method when trimming 0, 2, 6, or 12 of the bases in the beginning of reads or 0, 1, or 2 of the bases in the end of reads (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). We found that Shearwater can improve performance by trimming 2 bases from the beginning of reads and Mutect2 can improve by trimming the last base of each read. For DREAMS, the performance is only decreased when trimming, especially in the beginning of reads.</p>
      <p id="Par26">By setting the false-positive rate at 5% for each method across the validation alterations with any support, we get comparable thresholds for the three confidence measures: <italic>p</italic>-values, Bayes factor, and TLOD for DREAMS-<italic>vc</italic>, Shearwater, and Mutect2, respectively. This allows for a comparison of the sensitivity of the models at a pre-determined specificity of 95%. The methods could then be assessed across an alteration catalog of 191 true-positive mutations from the mutation catalog and 12,900 cross-patient negative calls based on the mutation catalog of the other patients. Out of the alteration catalog, 88 true mutations and 1330 cross-patient negative calls had a signal for the alteration.</p>
      <p id="Par27">Using this threshold, DREAMS-<italic>vc</italic> called 84.1% of the tumor mutations with signal, while Shearwater and Mutect2 called 70.5% and 67.0%, respectively (Table <xref rid="Tab2" ref-type="table">2</xref>). F1 and G-mean scores were calculated to assess the performance of the models by using the cross-patient mutations as negative controls. G-mean is the geometric mean of sensitivity and specificity, and F1 is the harmonic mean of precision and sensitivity. For G-mean, DREAMS-<italic>vc</italic> performed better than Shearwater and Mutect2; however, the F1 score of Shearwater was very similar to DREAMS-<italic>vc</italic>, due to lower false-positive rate of shearwater (Table <xref rid="Tab2" ref-type="table">2</xref>). Considering all mutations observed in the tumors, including those without signal in plasma, we found that about 38.7% could be recalled in Pre-OP liquid biopsy samples. DREAMS is generally more sensitive than Mutect2 and Shearwater, especially for stage II cancer mutations. Higher stage cancer is expected to have a larger signal for cancer mutations. Mutations called by DREAMS-vc but missed by Shearwater generally have low allele frequencies (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S7).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Mutation calling performance (true-positive mutations and cross-patient negative calls)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="2">Full alteration catalog<sup>a</sup></th><th align="left" colspan="4">Catalog alterations with signal<sup>b</sup></th></tr><tr><th align="left"/><th align="left">Sensitivity</th><th align="left">Specificity</th><th align="left">Sensitivity</th><th align="left">Specificity</th><th align="left">F1</th><th align="left">G-mean</th></tr></thead><tbody><tr><td align="left">DREAMS-<italic>vc</italic></td><td char="." align="char">0.387</td><td char="." align="char">0.997</td><td char="." align="char">0.841</td><td char="." align="char">0.955</td><td char="." align="char">0.479</td><td char="." align="char">0.896</td></tr><tr><td align="left">Shearwater</td><td char="." align="char">0.325</td><td char="." align="char">0.998</td><td char="." align="char">0.705</td><td char="." align="char">0.963</td><td char="." align="char">0.461</td><td char="." align="char">0.824</td></tr><tr><td align="left">Mutect2</td><td char="." align="char">0.309</td><td char="." align="char">0.997</td><td char="." align="char">0.670</td><td char="." align="char">0.948</td><td char="." align="char">0.376</td><td char="." align="char">0.797</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Full alteration catalog consisting of <italic>n</italic> = 191 true-positive mutations, and<italic> n</italic> = 12,900 potential cross-patient negative calls</p><p><sup>b</sup>Catalog of alterations with signal consisting of <italic>n</italic> = 88 true positive mutations, and <italic>n</italic> = 1330 potential cross-patient negative calls</p></table-wrap-foot></table-wrap></p>
      <p id="Par28">By setting the threshold based on a 5% false-positive rate in the cross-patient mutation set, the validation mutation set can be used as negative controls. The true positives are still the same 191 mutations of which 88 has a signal for the alteration. The negatives are the 500 validation positions multiplied with the 87 tested samples, giving a total of 43,500 possible alterations of which 1920 had a signal. With this set, we obtained an 86.4% true positive rate, compared to 76.1% for Shearwater and 67.0% for Mutect2 (Table <xref rid="Tab3" ref-type="table">3</xref>). DREAMS-<italic>vc</italic> scored highest in both F1 and G-mean scores. Here, DREAMS-<italic>vc</italic> performed distinctly better than Shearwater and Mutect2.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Mutation calling performance (true-positive mutations and validation alterations)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="2">Full alteration catalog<sup>a</sup></th><th align="left" colspan="4">Catalog alterations with signal<sup>b</sup></th></tr><tr><th align="left"/><th align="left">Sensitivity</th><th align="left">Specificity</th><th align="left">Sensitivity</th><th align="left">Specificity</th><th align="left">F1</th><th align="left">G-mean</th></tr></thead><tbody><tr><td align="left">DREAMS-<italic>vc</italic></td><td char="." align="char">0.398</td><td char="." align="char">0.997</td><td char="." align="char">0.864</td><td char="." align="char">0.946</td><td char="." align="char">0.448</td><td char="." align="char">0.904</td></tr><tr><td align="left">Shearwater</td><td char="." align="char">0.351</td><td char="." align="char">0.995</td><td char="." align="char">0.761</td><td char="." align="char">0.920</td><td char="." align="char">0.323</td><td char="." align="char">0.837</td></tr><tr><td align="left">Mutect2</td><td char="." align="char">0.309</td><td char="." align="char">0.997</td><td char="." align="char">0.670</td><td char="." align="char">0.952</td><td char="." align="char">0.388</td><td char="." align="char">0.799</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Whole catalog consisting of <italic>n</italic> = 191 true-positive mutations, and <italic>n</italic> = 43,500 validation alterations</p><p><sup>b</sup>Catalog of positions with signal consisting of <italic>n</italic> = 88 true positive mutations, and <italic>n</italic> = 1920 validation alterations</p></table-wrap-foot></table-wrap></p>
      <p id="Par29">A common measure used to predict the presence of ctDNA is the estimated tumor fraction in plasma. DREAMS-<italic>cc</italic> combines the mutational evidence across the mutation catalog, to estimate the tumor fraction with an accompanying <italic>p</italic>-value for the presence of cancer (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section). We aimed to detect cancer in the Pre-OP samples, since cancer is present and should, in theory, be detectable given enough ctDNA is present in the blood. As a negative control, we attempted to detect cancer in each Pre-OP sample (Tested Sample) with the mutation catalog from all other patients (Candidate patient) (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). In case of shared mutations between the mutation catalogs, these were eliminated to prevent false positives. As a benchmark, we constructed a cancer call score using the product of the individual Bayes factors across the mutation catalog from Shearwater, resulting in a similar tendency (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b), and for Mutect2, we used the highest scoring variant, since we do not have a natural way of combining the scores (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). The performance of calling cancer can be assessed by treating the cross-patient mutation catalogs as expected negatives and calculate an AUC score (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). Performance was compared using the 5 × 2 cross-validation setup as above (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). The AUC was similar between DREAMS-<italic>cc</italic> and Shearwater with respect to calling cancer; however, DREAMS-<italic>cc</italic> showed an increased performance. Mutect2 does not seem to be suited for cancer calling in this way. As for variant calling, we only included the samples with mutational signal to showcase and compare the performance of the different methods in discriminating tumor from error signal.<fig id="Fig6"><label>Fig. 6</label><caption><p>Prediction of cancer using <bold>a</bold> DREAMS-cc, <bold>b</bold> Shearwater, and <bold>c</bold> Mutect2. For each patient’s LB-sample (<italic>y</italic>-axis), the mutation catalog (<italic>x</italic>-axis) for every candidate patient is used for calling cancer. The patients are stratified into patients with stage I and stage II CRC. The diagonal is showing the result of using a patient’s own mutation catalog for cancer calling and constitutes the expected positives. The off-diagonal is the cross-patient results, for which the mutation catalog is filtered with the patient’s tumor and germline variants prior to cancer calling, and thus these are expected to be negative. The color scheme is chosen based on the matched quantiles of the rank from the <italic>p</italic>-value, combined Bayes factors and max TLOD from <bold>a</bold> DREAMS-cc, <bold>b</bold> Shearwater, and <bold>c</bold> Mutect2, respectively. The cancer predictions show the results from one split in the 5 × 2 CV. <bold>d</bold> AUC performance of DREAMS-cc, shearwater, and Mutect2 with respect to calling cancer using the 5 × 2 CV</p></caption><graphic xlink:href="13059_2023_2920_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par30">For the patients with stage I and II CRC, we found tumor-supporting reads in 47.5% (19/40) and 73% (33/45) of the Pre-OP samples, respectively. We called cancer in 36.6% of the stage I CRC patients, corresponding to 78.9% (15/19) of the patients with a mutational signal. We called cancer in 72.1% of the stage II CRC patients, corresponding to 93.9% (31/33) of the patients with signal. These results were obtained while still limiting the false-positive rate to 5% in cross-patient cancer calls with a non-zero mutational signal.</p>
      <p id="Par31">Detailed analysis of the false-positive cancer calls reveals that most are due to a specific KRAS G12V variant: chr12:25,245,350 C &gt; A. This variant is common in colon cancer, and it is therefore not surprising to find in the patients [<xref ref-type="bibr" rid="CR25">25</xref>]. However, the mutation was not found in the patient’s corresponding tumor or buffycoat samples. A possible explanation for this is that the mutation is not detected in the tumor biopsy due to sub-clonality [<xref ref-type="bibr" rid="CR26">26</xref>] or that there is an underlying germline signal that was not caught in the buffycoat.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Discussion</title>
    <p id="Par32">We have developed DREAMS, as a new approach for modeling the error rates in sequencing data that incorporates information from both the local sequence context and read-level information. DREAMS is intended for settings that rely on accurate error identification and quantification. We applied the error model for low-frequency ctDNA variant calling (DREAMS-<italic>vc</italic>) and cancer detection (DREAMS-<italic>cc</italic>).</p>
    <p id="Par33">The error rate was found to vary depending on several of the proposed read-level features. Surprisingly, fragment size was found to be correlated with the error rate, with the smallest error-rates being observed for fragment sizes corresponding to the mono-nucleosomal and di-nucleosomal lengths (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Fragments that deviate from these in length may have been degraded in the blood for a longer time and thereby accumulated more errors. Fragments of ctDNA are generally shorter and error rates are generally highest in short fragments, which shows the importance of accurate error modeling [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. The error rate was also found to vary with the strand, and symmetric mismatches occurred at different rates (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e). The G &gt; T/C &gt; A asymmetry can be explained by the hybridization capture protocol only targeting one strand and thus only capturing oxidative damage of that strand [<xref ref-type="bibr" rid="CR14">14</xref>]. A similar mechanism might explain the C &gt; T/G &gt; A asymmetry in the case of cytosine deamination. The error rate varied with the position in the read and was especially increased in the beginning of reads (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). This may be because the ends of fragments are prone to damage [<xref ref-type="bibr" rid="CR14">14</xref>] and in thermodynamic equilibrium with being single stranded. The error rate also varied depending on whether the read was the first or second in the pair (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). Besides being intermitted by a PCR amplification step when sequencing, the reads differ in composition and length of adapters sequenced prior to the insert, which might cause this difference.</p>
    <p id="Par34">Training a background error model using DREAMS does not require known mutation sites in aligned reads (BAM-files), as it only aims to model the errors. For optimal ctDNA detection, the error model should describe the error distribution among normal cfDNA in the evaluated samples. Training data can originate from normal samples or potentially from mutation-filtered cancer samples, as in this study. Since error patterns are highly dependent on laboratory procedures, the same protocol should be used for training samples and subsequent testing samples. From the training samples, the common patterns of the errors occurring during library preparation, sequencing, etc., can be learned and would generalize to the testing samples. Error signals that are only found in a smaller subset of training samples, such as sample or batch effects, could lead to small biases. However, these should not have any significant effect on the final model, if the model is trained across multiple samples gathered over time, thereby learning the general error patterns of the specific assay. Conversely, if the amount of data in a single sample is large, the error model could be trained on the sample itself, which would potentially yield a highly specific model that accounts for sample-specific error patterns. As shown here, even a single sample can provide sufficient data to get a relatively good performance (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S6), and similarly, it could potentially be advantageous to only train on same batch samples to diminish batch effects.</p>
    <p id="Par35">Since the biogenesis of ctDNA fragments may differ from normal cfDNA, they might have a different error profile, which could potentially lead to an error model not fitting normal cfDNA optimally. Large ctDNA contents in the training data might therefore affect ctDNA detection performance negatively and therefore best avoided. The samples here used for model training are expected to have low to no ctDNA content, and the performance presented does not indicate that our error model was affected by this.</p>
    <p id="Par36">The error model has been implemented using a neural network, allowing the feature set to be tailored to capture the relevant information of a specific setting. Analysis of the feature importance revealed that several of the proposed read-level features are useful in predicting the error rate in sequencing data (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Most features presented in this paper are general to NGS data; however, not all sequencing protocols use UMI-based error correction, rendering UMI-related features redundant. In particular, UMI cannot be exploited for shallow whole-genome sequencing as read groups cannot be formed. In such cases error rates would be increased, making accurate error modeling as performed by DREAMS even more important.</p>
    <p id="Par37">Compared to simpler methods, the presented approach is more computationally demanding, due to training of the neural network model and the use of complex data extracted from BAM-files. A neural network is a simple and flexible approach for bridging the gap between a complex set of contexts and read-level features and the error rate of a given read position but might not be the most efficient solution. The model can be trained on a regular laptop within a few hours, which should only be done once, when the training dataset is defined. Using the trained model and the statistical modules adds no significant computation time for calling mutations and cancer in the current setting. However, very large mutation catalogs are expected to increase the computation time for DREAMS-<italic>cc</italic>.</p>
    <p id="Par38">DREAMS was built to exploit read-level features under the assumption that these affect the error rate in sequencing data. Thus, the power of this approach increases with the variability in the error rate explained by read-level features. Thereby, less emphasis is put on mismatches that are likely errors, and more confidence in the potential tumor signal from other mismatches. Conversely, if read-level features are not improving error prediction, the performance is expected to be similar to methods working with simpler summary data. Although DREAMS use information about the local sequence-context, strong regional effects on the error rate are not expected to be captured by the model. An added benefit of DREAMS being position agnostic is that it can be used to predict error rates for positions for which no training data is available. In principle, the method is fit for both deep sequencing of panels and shallow sequencing of whole genomes.</p>
    <p id="Par39">In all performance comparisons, DREAMS-<italic>vc</italic> performed better than the other methods in calling tumor mutations. This indicates that read-position level features can improve performance in separating error from mutational signal. Similarly for cancer detection, DREAMS-<italic>cc</italic> performed better than Shearwater and Mutect2. Cancer was detected in most (73%) of stage II CRC cancer patients and a third (34%) of stage I patients. While Shearwater and Mutect2 could benefit from trimming the read ends, DREAMS can exploit the signal even in parts of the read with an increased error rate.</p>
    <p id="Par40">There are false-positive cancer and mutation calls, some of which could potentially be explained by clonal hematopoiesis of indeterminate potential (CHIP) or an unexpected error signal. To reduce the signal from CHIP, we have excluded positions with significant presence of non-reference nucleotides, found in the germline samples; however, a low signal might still be present. Remaining false-positive calls might be due to regional effects or sample-specific artifacts. Many of the false-positive mutation calls in the Pre-OP samples were found to be a mutation leading to the KRAS G12V variant, and it could therefore potentially be explained by a sub-clonal variant that was not identified in the tumor sample or a germline signal of clonal hematopoiesis of indeterminate potential (CHIP) that was not identified in the buffycoat samples. KRAS G12V is found to be an early driver event across multiple cancer types and therefore not expected to be particularly often subclonal [<xref ref-type="bibr" rid="CR29">29</xref>]; however, it has been identified as a potential driver of clonal hematopoiesis [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
    <p id="Par41">Sensitive variant calling in liquid biopsies can provide non-invasive insight into tumor genetics, which can potentially enable personalized treatment of patients and be a cost-effective approach for cancer screening. DREAMS-<italic>cc</italic> integrates evidence across a mutation catalog to increase sensitivity in cancer detection. Cancer detection is expected to get more sensitive as the number of mutations in the catalog rises. A potential application of DREAMS-<italic>cc</italic> could be tumor-agnostic cancer detection based on a catalog of commonly known tumor variants.</p>
    <p id="Par42">The approach presented in this paper does not rely on tumor-specific signals, such as the fragment size distribution of fragmentations patterns of ctDNA, mutational signatures, and expression information, which differentiates it from seemingly similar methods such as INVAR [<xref ref-type="bibr" rid="CR19">19</xref>] and MRDetect [<xref ref-type="bibr" rid="CR18">18</xref>]. In the case of INVAR, the statistical model underlying the test for the presence of cancer uses the differences in fragment length distribution between normal cfDNA and ctDNA to help discriminate the fragments. Furthermore, INVAR uses a simple tri-nucleotide context error model compared to DREAMS’ read-specific error model that uses multiple read-level features. Compared to MRDetect, we try to solve a similar problem using a neural network as the backbone, but with very different approaches. The Neural Network in MRDetect aims to discriminate between normal cfDNA and ctDNA by training on curated sequencing data. In DREAMS, we aim to predict the probability of an error occurring at a position in a read by training on bulk sequencing data from samples with minimal ctDNA concentration, or samples from healthy individuals. However, the performance of DREAMS could potentially be improved by incorporating a tumor-specific foreground model into the statistical framework to help guide if a fragment is indeed ctDNA, which would require a curated data from ctDNA fragments, which is rarely available. Additionally of cancer-specific regional properties or fragment behavioral information could potentially further increase sensitivity.</p>
    <p id="Par43">In this paper, we focus on the single nucleotide variants, but the model could be extended to be able to look for indels. The underlying ideas in DREAMS are not restricted to variant calling and could be used in other tasks of sequencing data analysis such as advanced error filtering.</p>
  </sec>
  <sec id="Sec6">
    <title>Conclusion</title>
    <p id="Par44">We have presented the DREAMS error rate model and demonstrated the importance of using read-level features for modeling the errors in NGS data. The model was validated in a tumor-informed setting, using DREAMS-<italic>vc</italic> for variant calling and DREAMS-<italic>cc</italic> for cancer detection in patients with CRC. DREAMS-<italic>vc</italic> allowed accurate detection of mutation signal in plasma samples extracted prior to curative intended surgery with improved performance compared to state-of-the-art methods. This highlights the importance of including read-level information in modeling the background error rate. Furthermore, DREAMS-<italic>cc</italic> demonstrated the ability to combine signal from multiple mutations known from the tumor biopsy for improved cancer detection. DREAMS-<italic>cc</italic> was able to call cancer in 73% of Pre-OP samples from CRC stage II patients and 34% of CRC stage I patients. Potential future applications of DREAMS include analysis of WGS data and tumor-agnostic cancer detection. The approach presented with DREAMS is generally applicable across NGS applications that need accurate handling and quantifications of errors, and the presented algorithms (DREAMS-<italic>vc</italic> and DREAMS-<italic>cc</italic>) are only examples of how to exploit this. The specific application presented in this paper is implemented as a user-friendly R package [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>].</p>
  </sec>
  <sec id="Sec7">
    <title>Methods</title>
    <sec id="Sec8">
      <title>Error rate prediction using read level information</title>
      <p id="Par45">In this study, we present a method called DREAMS (Deep Read-level Modelling of Sequencing-errors) for estimating the error rate at each read position using features of the individual read and the genomic context of the position. In practice, this is achieved by predicting the probability of observing each allele given the describing features of a position in a read and considering the probabilities of observing the alternative alleles as the error rates. The read-specific features can include information such as the read position, the strand of the mapped read, the length of the fragment, and UMI-group size. The read position refers to the cycle number at which the position was sequenced starting with the first nucleotide of the fragment, thus disregarding cycles used for reading primers, adapters, unaligned ends, etc. Context-specific features contain information about the genomic sequence surrounding the position, including the neighboring bases (tri-nucleotide context), the complexity, and GC-content. The local complexity is calculated as the Shannon entropy for both single nucleotides and pairs. Similarly, the local GC content is calculated as the fraction of C and G nucleotides. In principle, any feature that can be thought to affect the error rate of a read position can be added to improve the error rate prediction. Another possible feature would be the positional read quality score given by the sequencing machine. However, the estimated quality for the collapsed consensus reads were all capped at the same high value and thus excluded as they do not include any information for further modeling.</p>
    </sec>
    <sec id="Sec9">
      <title>Data</title>
      <p id="Par46">Data for a read position can be extracted from a read mapping (BAM-file) with sequencing data from a next-generation sequencing experiment. The training data for the model consists of a set of read positions from multiple samples, for which the observed allele is denoted together with the relevant features. This means that the training data includes both matches, where read positions where the observed allele is equal to the reference allele and mismatches where the observed and reference allele differ. Mismatches that correspond to known single nucleotide polymorphisms found in the germline samples are excluded from the training. Assuming that the training samples are non-cancerous means that all remaining mismatches in the dataset can be assumed to be errors that have occurred on a molecular level in the body or lab, or during sequencing of the sample.</p>
      <p id="Par47">The mismatches are extracted from the BAM-file using the mismatched positions annotated in the MD-tag. The equivalent genomic position is found, and the 11- and 3-mer context is extracted from the reference genome and used for calculation of local sequence-context features. The UMI errors and UMI count are extracted from the cE and cD tags generated by the CallMolecularConsensusReads from fgbio used for calling UMI consensus reads. Information about the insertions and deletions is extracted from the cigar tag. The fragment size is the insert-size (isize), and the read position is the position in the read sequence from the 5′-end of the read. Strand and first in pair are extracted from BAM flag where this information is encoded in a bitwise fashion.</p>
      <p id="Par48">The model assumes that the input data for both training and testing is based on readings of unique fragments, so each position in a fragment is only represented in one read. This can be assured using unique molecular identifiers (UMIs) and by trimming overlapping read positions in the read pairs.</p>
      <p id="Par49">As training on every single read position in every single read is very demanding and inefficient, we employ a methodology akin to importance sampling where we extract all the mismatches from the data and randomly sample a subset of the non-mismatches. To account for this skew induced by down-sampling one category of the training data, a rescaling scheme inspired by [<xref ref-type="bibr" rid="CR33">33</xref>] is used on the predicted error rates. The method is outlined in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S8.</p>
    </sec>
    <sec id="Sec10">
      <title>Neural network model</title>
      <sec id="Sec11">
        <title>Structure of the neural network</title>
        <p id="Par50">To predict the error rate at a given read position, we use a multilayer perceptron (MLP) which is a simple neural network setup with multiple fully connected layers. The neural network allows us to use the features without prior knowledge of how they interact among each other or how they affect the error rate. The neural network is trained using a set of read positions where the features describing the read positions are used as inputs and the observed allele as output.</p>
        <p id="Par51">For a given read position, the possible observed outcomes are the alleles A, T, C, or G. Interpreting this as a random event, the observed allele can be seen as an outcome from a four-dimensional multinomial distribution with one trial. Let <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq1.gif"/></alternatives></inline-formula> represents the observed allele in read <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M4"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq2.gif"/></alternatives></inline-formula> at position <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M6"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{ij}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq4.gif"/></alternatives></inline-formula> be the set of observed features for that read position. For a non-mutated, homozygote position, the observed allele should predominantly be the reference allele, and any observations of non-reference alleles would be considered errors. In this situation, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({X}_{ij}=A|{D}_{ij}\right)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq5.gif"/></alternatives></inline-formula> would be close to 1 if <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A$$\end{document}</tex-math><mml:math id="M12"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq6.gif"/></alternatives></inline-formula> was the reference allele for read position <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(i,j\right)$$\end{document}</tex-math><mml:math id="M14"><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq7.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({X}_{ij}=x|{D}_{ij}\right), x\in \left\{T,C,G\right\}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq8.gif"/></alternatives></inline-formula> would be the error rates for the remaining three alleles. Given a set of observations <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{\left({x}_{ij},{D}_{ij}\right)\right\}}_{i=1}^{N}$$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq9.gif"/></alternatives></inline-formula>, it is then possible to write the log-likelihood function for the observed data:<disp-formula id="Equa"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}l\left({\left\{\left({x}_{ij},{D}_{ij}\right)\right\}}_{i,j}\right)\\ =\sum\limits_{i,j}\mathrm{log}\left(P\left({X}_{ij}={x}_{ij}|{D}_{ij}\right)\right)\\ \begin{array}{l}=\sum\limits_{i,j:{x}_{ij}=A}\mathrm{log}\left(P\left({X}_{ij}=A|{D}_{ij}\right)\right)+\sum\limits_{i,j:{x}_{ij}=T}\mathrm{log}\left(P\left({X}_{ij}=T|{D}_{ij}\right)\right)+\\ \sum\limits_{i,j:{x}_{ij}=C}\mathrm{log}\left(P\left({X}_{ij}=C|{D}_{ij}\right)\right)+\sum\limits_{i,j:{x}_{ij}=G}\mathrm{log}\left(P\left({X}_{ij}=G|{D}_{ij}\right)\right)\end{array}\end{array}$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par52">The problem now becomes how to estimate the distribution <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({X}_{ij}|{D}_{ij}\right)$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq10.gif"/></alternatives></inline-formula> above. To do this, start by defining the probability functions via the SoftMax function:<disp-formula id="Equb"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({X}_{ij}=a|{D}_{ij}\right)=\frac{{e}^{{f}_{a}\left({D}_{ij}\right)}}{\sum_{{a}^{^{\prime}}\in \left\{A,T,C,G\right\}}{e}^{{f}_{{a}^{^{\prime}}}\left({D}_{ij}\right)}}$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:msup><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${f}_{a}\left({D}_{ij}\right)$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq11.gif"/></alternatives></inline-formula> is a predictor function for the allele <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a$$\end{document}</tex-math><mml:math id="M28"><mml:mi>a</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq12.gif"/></alternatives></inline-formula> using the observed information <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{ij}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq13.gif"/></alternatives></inline-formula>. As an example, for classic multinomial logistic regression, a linear predictor function is chosen such that <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${f}_{a}\left({X}_{i}\right)={\beta }_{a}\cdot {X}_{i}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq14.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{a}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq15.gif"/></alternatives></inline-formula> is a vector of feature-specific weights that can be found by maximizing the log-likelihood function. To get a more flexible model, a neural network is chosen, since this can approximate any arbitrary predictor function well including arbitrary interactions between input features. To do this <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({X}_{ij}=a|{D}_{ij}\right)$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq16.gif"/></alternatives></inline-formula> can be interpreted as the output from a neural network model where SoftMax is used as the last activation function and <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${f}_{a}\left({D}_{ij}\right)$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq17.gif"/></alternatives></inline-formula> is the output from the last hidden layer. To train such a model inspiration is drawn from likelihood theory and the negative log-likelihood function is chosen as the loss function to minimize.</p>
      </sec>
      <sec id="Sec12">
        <title>Architecture</title>
        <p id="Par53">The neural network model allows for high flexibility in the choice of features and requires very limited prior knowledge about the effect of the features on the error rate. The neural network was selected to be a MLP with an input layer, three hidden layers and an output layer. The dimension of the input layer depends on the selected input features, the hidden layers have a configuration of 128, 64, and 32 nodes with a ReLu activation function, and the output layer contains 4 nodes with SoftMax activation, as explained above, corresponding to probability of observing each of the 4 alleles. The configuration of hidden layers can be varied, depending on the input data and the available computational resources. The models were trained using the Keras library (2.3.0) in R, which is an interface that builds in Tensorflow (2.6.0) [<xref ref-type="bibr" rid="CR34">34</xref>].</p>
      </sec>
      <sec id="Sec13">
        <title>Feature handling/embedding</title>
        <p id="Par54">The features are split into numeric, categorical, and embedded variables and handled accordingly. Categorical features are one-hot encoded, and the numeric features are batch normalized. The trinucleotide context can be seen as the three distinct features: reference allele and the two neighboring bases. These can be handled as categorical features with individual one-hot encoded 4-dimensional inputs using 12 (3 × 4) input nodes in total. Alternatively, a 64-dimensional (4 × 4 × 4) one-hot encoded input of the entire trinucleotide context (TNC) can be used. We will employ another alternative that takes the 64-dimensional feature in the input layer and embeds it into a continuous 3-dimensional vector before including it in the model alongside the remaining input features. Thereby, the model can learn the relationship between the contexts, and cluster contexts that have a similar effect on the error rate close together and vice versa.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Assessing cancer status across a catalog of multiple mutation candidates</title>
      <p id="Par55">Based on the neural network error model developed above, it can now be assumed that the individual error rates for a given position in each read are known. In this section, the error rates will be exploited to develop a statistical framework for estimating the tumor fraction in a sample based on a catalog of candidate mutations. This framework can ignore some mutation candidates if these are not found in the sample, for example due to relatively low allelic frequency due to sub-clonality in the tumor or due to little tumor in the circulation. Reduction in the candidate mutations allows for a comprehensive mutation catalog to be used, where mutation candidates with limited evidence may be excluded. The subset of candidate mutations is selected statistically by finding mutations with a consistently high mutational signal, and the tumor fraction is estimated based on these candidates. This subset of mutations is then used in a statistical procedure for testing if the observed mutational signal exceeds what we would expect if no mutated DNA were present, making it possible to determine the cancer status of a patient based on the sample.</p>
    </sec>
    <sec id="Sec15">
      <title>The statistical model</title>
      <p id="Par56">Start by introducing <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq18.gif"/></alternatives></inline-formula> as a variable that controls the presence of a given mutation on the site <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M42"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq19.gif"/></alternatives></inline-formula>, such that <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}=1$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq20.gif"/></alternatives></inline-formula> represent the case where the site is mutated, and <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}=0$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq21.gif"/></alternatives></inline-formula> when it is not. Furthermore let:<disp-formula id="Equc"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}\sim Bernulli\left(r\right)$$\end{document}</tex-math><mml:math id="M48" display="block"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par57">Thus, given a catalog of possible mutations, <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M50"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq22.gif"/></alternatives></inline-formula> is the probability that each of them is present in the sample. For site <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M52"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq23.gif"/></alternatives></inline-formula> let <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R$$\end{document}</tex-math><mml:math id="M54"><mml:mi>R</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq24.gif"/></alternatives></inline-formula> be the germline reference allele and <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M56"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq25.gif"/></alternatives></inline-formula> the alternative allele of interest. Furthermore, it is assumed that the germline site is homozygote, such that any signal from non-reference alleles must be due to errors or mutational signal from a tumor. To model the molecular composition of the fragments covering site <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M58"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq26.gif"/></alternatives></inline-formula>, let <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ij}\in \left\{R,M\right\}$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq27.gif"/></alternatives></inline-formula> be the true error-free nucleotide of the <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M62"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq28.gif"/></alternatives></inline-formula>’th fragment. If the <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M64"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq29.gif"/></alternatives></inline-formula>’th mutation is not present in the sample (<inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}=0$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq30.gif"/></alternatives></inline-formula>), we are sure that the true nucleotide of the fragment is the reference and thus the following distribution holds:<disp-formula id="Equd"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({Y}_{ij}=R|{Z}_{i}=0\right)=1,\quad P\left({Y}_{ij}=M|{Z}_{i}=0\right)=0$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par58">To model the mutational DNA present in the sample, let <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f&gt;0$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>f</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq31.gif"/></alternatives></inline-formula> denote the tumor fraction. This is the fraction of the DNA in the blood that originates from tumor cells. Assuming that the mutation of interest is (sufficiently) clonal in the tumor, i.e., half of the DNA in the tumor has this mutation, the probability of a given fragment having the mutation is <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f/2$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq32.gif"/></alternatives></inline-formula>. Using this, the following distribution for <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ij}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq33.gif"/></alternatives></inline-formula> can be assumed when the mutation is present in the sample (<inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}=1$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq34.gif"/></alternatives></inline-formula>):<disp-formula id="Eque"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({Y}_{ij}=R|{Z}_{i}=1\right)=1-\frac{f}{2},\quad P\left({Y}_{ij}=M|{Z}_{i}=1\right)=\frac{f}{2}$$\end{document}</tex-math><mml:math id="M78" display="block"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par59">To model the errors that occur in NGS data, let <inline-formula id="IEq35"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq35.gif"/></alternatives></inline-formula> be the observed nucleotide in fragment <inline-formula id="IEq36"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M82"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq36.gif"/></alternatives></inline-formula> at position <inline-formula id="IEq37"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M84"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq37.gif"/></alternatives></inline-formula>. Assume that the distribution of <inline-formula id="IEq38"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq38.gif"/></alternatives></inline-formula> depends only on the corresponding true nucleotide <inline-formula id="IEq39"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ij}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq39.gif"/></alternatives></inline-formula>, in the sense that the event <inline-formula id="IEq40"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}\ne {Y}_{ij}$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq40.gif"/></alternatives></inline-formula> corresponds to the observation being an error. This distribution is exactly what the neural network model described above aims to approximate using the observed features <inline-formula id="IEq41"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{ij}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq41.gif"/></alternatives></inline-formula>. To simplify notation, the dependence of <inline-formula id="IEq42"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq42.gif"/></alternatives></inline-formula> on <inline-formula id="IEq43"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{ij}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq43.gif"/></alternatives></inline-formula> will be omitted from the notation in the following. Note that observations <inline-formula id="IEq44"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq44.gif"/></alternatives></inline-formula> outside <inline-formula id="IEq45"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{R,M\}$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq45.gif"/></alternatives></inline-formula> will have little information about the true nucleotide <inline-formula id="IEq46"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ij}$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq46.gif"/></alternatives></inline-formula>. Furthermore, since the error rates generally are low, the difference between including interactions between all four possible alleles and only the two allele of interest is negligible. Thus, to simplify the following calculations, we assume that <inline-formula id="IEq47"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}\in \{R,M\}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq47.gif"/></alternatives></inline-formula>. In practice, this means that all fragments, <inline-formula id="IEq48"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j^{\prime}$$\end{document}</tex-math><mml:math id="M106"><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq48.gif"/></alternatives></inline-formula>, for which <inline-formula id="IEq49"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i{j}^{^{\prime}}}\notin \left\{R,M\right\}$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mrow></mml:msub><mml:mo>∉</mml:mo><mml:mfenced close="}" open="{"><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq49.gif"/></alternatives></inline-formula> are eliminated from the analysis. Using this assumption, we define the probability of observing the alternative allele in a reference allele position as the following error rate:<disp-formula id="Equf"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{ij}^{R\to M}=P\left({X}_{ij}=M|{Y}_{ij}=R,{X}_{ij}\in \left\{R,M\right\}\right)=\frac{P\left({X}_{ij}=M|{Y}_{ij}=R\right)}{P\left({X}_{ij}=R|{Y}_{ij}=R\right)+P\left({X}_{ij}=M|{Y}_{ij}=R\right)}$$\end{document}</tex-math><mml:math id="M110" display="block"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mfenced></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par60">Conversely, for a fragment that stems from a tumor cell and contains the mutated allele, we define:<disp-formula id="Equg"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{ij}^{M\to R}=\frac{P\left({X}_{ij}=R|{Y}_{ij}=M\right)}{P\left({X}_{ij}=R|{Y}_{ij}=M\right)+P\left({X}_{ij}=M|{Y}_{ij}=M\right)}$$\end{document}</tex-math><mml:math id="M112" display="block"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec16">
      <title>Estimating the tumor fraction and mutation presence</title>
      <p id="Par61">In this section, we will develop a procedure for estimating the tumor fraction (<inline-formula id="IEq50"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f$$\end{document}</tex-math><mml:math id="M114"><mml:mi>f</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq50.gif"/></alternatives></inline-formula>) and mutation presence probability (<inline-formula id="IEq51"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M116"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq51.gif"/></alternatives></inline-formula>). For this, let <inline-formula id="IEq52"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\in \{1,\dots ,K\}$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq52.gif"/></alternatives></inline-formula> be the index of a catalog of <inline-formula id="IEq53"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K$$\end{document}</tex-math><mml:math id="M120"><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq53.gif"/></alternatives></inline-formula> candidate mutations, <inline-formula id="IEq54"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{i}$$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq54.gif"/></alternatives></inline-formula> the corresponding number of covering reads and <inline-formula id="IEq55"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\{{\left({x}_{ij}\right)}_{j\in \left\{1,...,{N}_{i}\right\}}\right\}}_{i\in \left\{1,...,K\right\}}$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mfenced close="}" open="{"><mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:msub></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mfenced></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq55.gif"/></alternatives></inline-formula> all the observed alleles. First, we write the likelihood function for <inline-formula id="IEq56"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f$$\end{document}</tex-math><mml:math id="M126"><mml:mi>f</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq56.gif"/></alternatives></inline-formula> and <inline-formula id="IEq57"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M128"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq57.gif"/></alternatives></inline-formula>:<disp-formula id="Equh"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}L\left(f,r\vert{\left\{\left(x_{ij}\right)\right\}}_{i\in\left\{1,...,K\right\},j\in\left\{1,...,N_i\right\}}\right)\\=\prod\limits_{i=1}^KP\left(Z_i=0\right).\\\begin{array}{l}\prod\limits_{j:x_{ij}=R}\left[P\left(X_{ij}=R\vert Y_{ij}=R\right)P\left(Y_{ij}=R\vert Z_{ij}=0\right)+P\left(X_{ij}=R\vert Y_{ij}=M\right)P\left(Y_{ij}=M\vert Z_{ij}=0\right)\right].\\\prod\limits_{j:x_{ij}=M}\left[P\left(X_{ij}=M\vert Y_{ij}=R\right)P\left(Y_{ij}=R\vert Z_{ij}=0\right)+P\left(X_{ij}=M\vert Y_{ij}=M\right)P\left(Y_{ij}=M\vert Z_{ij}=0\right)\right]+\\\begin{array}{l}P\left(Z_i=1\right).\\\prod\limits_{j:x_{ij}=R}\left[P\left(X_{ij}=R\vert Y_{ij}=R\right)P\left(Y_{ij}=R\vert Z_{ij}=1\right)+P\left(X_{ij}=R\vert Y_{ij}=M\right)P\left(Y_{ij}=M\vert Z_{ij}=1\right)\right].\\\begin{array}{l}\prod\limits_{j:x_{ij}=M}\left[P\left(X_{ij}=M\vert Y_{ij}=R\right)P\left(Y_{ij}=R\vert Z_{ij}=1\right)+P\left(X_{ij}=M\vert Y_{ij}=M\right)P\left(Y_{ij}=M\vert Z_{ij}=1\right)\right]\\=\prod\limits_{i=1}^K\left(1-r\right)\cdot\prod\limits_{j:x_{ij}=R}\left(1-e_{ij}^{R\rightarrow M}\right)\cdot\prod\limits_{j:x_{ij}=M}e_{ij}^{R\rightarrow M}+\\r\cdot\prod\limits_{j:x_{ij}=R}\left[\left(1-e_{ij}^{R\rightarrow M}\right)\cdot\left(1-\frac f2\right)+e_{ij}^{M\rightarrow R}\cdot\frac f2\right]\cdot\prod\limits_{j:x_{ij}=M}\left[e_{ij}^{R\rightarrow M}\cdot\left(1-\frac f2\right)+\left(1-e_{ij}^{M\rightarrow R}\right)\cdot\frac f2\right]\end{array}\end{array}\end{array}\end{array}$$\end{document}</tex-math><mml:math id="M130" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:mfenced><mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>r</mml:mi></mml:mfenced><mml:mo>·</mml:mo><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>·</mml:mo><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mo>·</mml:mo><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>·</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>·</mml:mo><mml:mfrac><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mo>·</mml:mo><mml:munder><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>·</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>·</mml:mo><mml:mfrac><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par62">Getting a maximum likelihood estimate (MLE) of <inline-formula id="IEq58"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f$$\end{document}</tex-math><mml:math id="M132"><mml:mi>f</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq58.gif"/></alternatives></inline-formula> and <inline-formula id="IEq59"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M134"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq59.gif"/></alternatives></inline-formula> by optimizing this expression analytically is not tractable. However, by seeing <inline-formula id="IEq60"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ij}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq60.gif"/></alternatives></inline-formula> and <inline-formula id="IEq61"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{i}$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq61.gif"/></alternatives></inline-formula> as latent variables, estimates can be found by employing an EM-algorithm (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S9). For now, assume that <inline-formula id="IEq62"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{f}$$\end{document}</tex-math><mml:math id="M140"><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq62.gif"/></alternatives></inline-formula> and <inline-formula id="IEq63"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{r}$$\end{document}</tex-math><mml:math id="M142"><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq63.gif"/></alternatives></inline-formula> are MLEs of <inline-formula id="IEq64"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f$$\end{document}</tex-math><mml:math id="M144"><mml:mi>f</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq64.gif"/></alternatives></inline-formula> and <inline-formula id="IEq65"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M146"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq65.gif"/></alternatives></inline-formula> respectively.</p>
      <p id="Par63">To test if a sample has a significant content of mutational DNA, we focus on the parameters in the model. By representing the hypothesis of a negative sample as a tumor fraction of 0 and no mutations present (<inline-formula id="IEq66"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{0}:f,r=0$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq66.gif"/></alternatives></inline-formula>) and a positive sample as a positive tumor fraction and some mutations present<inline-formula id="IEq67"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({H}_{A}:f&gt;0,r\ge \frac{1}{K}\right)$$\end{document}</tex-math><mml:math id="M150"><mml:mfenced close=")" open="("><mml:msub><mml:mi>H</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mi>f</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>≥</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq67.gif"/></alternatives></inline-formula>, a likelihood ratio test can be used to test for significance. Note that <inline-formula id="IEq68"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r\ge \frac{1}{K}$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mi>r</mml:mi><mml:mo>≥</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq68.gif"/></alternatives></inline-formula> in <inline-formula id="IEq69"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{A}$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mi>H</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq69.gif"/></alternatives></inline-formula> corresponds to at least one mutation being present in the sample. The LR-test statistic for this test is:<disp-formula id="Equi"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q=-2\mathrm{log}\frac{L\left(\mathrm{0,0}|{\left\{\left({x}_{ij}\right)\right\}}_{i\in \left\{1,...,K\right\}, j\in \left\{1,...,{N}_{i}\right\}}\right)}{L\left(\widehat{f},\widehat{r}|{\left\{\left({x}_{ij}\right)\right\}}_{i\in \left\{1,...,K\right\}, j\in \left\{1,...,{N}_{i}\right\}}\right)}$$\end{document}</tex-math><mml:math id="M156" display="block"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">log</mml:mi><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par64">Since there are 2 free parameters in the model, it can be assumed that <inline-formula id="IEq70"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q$$\end{document}</tex-math><mml:math id="M158"><mml:mi>Q</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq70.gif"/></alternatives></inline-formula> is approximately <inline-formula id="IEq71"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\chi }^{2}\left(2\right)$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq71.gif"/></alternatives></inline-formula>-distributed, and a <italic>p</italic>-value can be obtained as follows:<disp-formula id="Equj"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{val}=1-{F}_{{\chi }^{2}\left(2\right)}\left(Q\right)$$\end{document}</tex-math><mml:math id="M162" display="block"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">val</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="("><mml:mn>2</mml:mn></mml:mfenced></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>Q</mml:mi></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13059_2023_2920_Article_Equj.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par65">Using this statistical model for cancer calling on top of the error rate predictions from DREAMS, we refer to it as the DREAMS-cc.</p>
    </sec>
    <sec id="Sec17">
      <title>Calling individual mutations</title>
      <p id="Par66">In the special case where the number of mutations in the catalog is <inline-formula id="IEq72"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=1$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq72.gif"/></alternatives></inline-formula>, the algorithm outlined above can be thought of as a regular variant caller. In this case, the concept of some mutations not being present in the sample is unnecessary, as the presence of the single mutations of interest can be governed solely by the tumor fraction <inline-formula id="IEq73"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f$$\end{document}</tex-math><mml:math id="M166"><mml:mi>f</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq73.gif"/></alternatives></inline-formula>. The algorithm above is easily modified to handle this by assuming that <inline-formula id="IEq74"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=1$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq74.gif"/></alternatives></inline-formula>, and using one degree of freedom for the <inline-formula id="IEq75"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\chi }^{2}$$\end{document}</tex-math><mml:math id="M170"><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2920_Article_IEq75.gif"/></alternatives></inline-formula>-distribution in the significance test. The equations in the EM-algorithm can also be simplified by making this assumption. We refer to the variant caller as DREAMS<italic>-vc.</italic></p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2023_2920_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary material, Supplementary methods, tables, and figures  [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR35">35</xref>–<xref ref-type="bibr" rid="CR43">43</xref>].</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2023_2920_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Mikkel H. Christensen, Simon O. Drue, Mads H. Rasmussen, and Amanda Frydendahl shared the first authorship.</p>
    </fn>
    <fn>
      <p>Claus L. Andersen and Jakob Skou Pedersen shared the senior authorship.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the participating CRC patients and the Danish Cancer Biobank for contributing clinical material. We also thank the IMPROVE study group for patient inclusion: Kåre Andersson Gotschalck (Horsens Hospital), Lene Hjerrild Iversen (Aarhus University Hospital), Uffe Schou Løve (Viborg hospital), Anders Husted Madsen (Herning Hospital), Ole Thorlacius-Ussing (Aalborg University Hospital), Ismail Gögenur (Køge Hospital), Per Vadgaard Andersen (Odense University Hospital), Jakob Lykke (Herlev Hospital), Peter Bondeven (Randers Hospital), and Nis Hallundbæk Schlesinger (Bispebjerg Hospital).</p>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par67">Anahita Bishop and Andrew Cosgrove were the primary editors of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="FPar2">
      <title>Review history</title>
      <p id="Par68">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MHC, SD, CLA, and JSP conceived and designed the study. MHC and SD developed the statistical methods and the software under supervision by JSP with input from MHR and CLA. MHR, AF, IL, CD, JN, KAG, and LHI acquired patient samples and generated patient data, including NGS data. MHC, SD, MHR, AF, CLA, and JSP analyzed and interpreted the patient data. SD and MHC wrote the article under the supervision of CLA and JSP with revisions and suggestions from the other authors. All authors read and approved the final manuscript.</p>
    <sec id="FPar3">
      <title>Authors’ Twitter handles</title>
      <p id="Par69">Amanda Frydendahl, @amanda_fbj; Iben Lyskjær, @illyskjaer; Jesper Nors, @JesperNors; Lene H. Iversen, @LeneHjerrild; Claus L. Andersen, @ClausLindbjerg; Jakob Skou Pedersen, @skouped.</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>MHR, AF, LI, JN, and CLA were funded by Aarhus University, Lundbeck Foundation (R180-2014–3998), Dansk Kræftforsknings Fond (FID1839672), Innovationfund Denmark (9068-00046B), Danish Cancer Society (R133-A8520-00-S41, R146-A9466-16-S2, R231-A13845, R257-A14700), NEYE foundation, Frimodt-Heinke Foundation, and Novo Nordisk Foundation (NNF17OC0025052). SD, MHC, and JSP were funded by Aarhus University, the Independent Research Fund Denmark | Medical Sciences (8021-00419B), the Danish Cancer Society (R307-A17932), and Aarhus University Research Foundation (AUFF-E-2020–6-14).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The data that support the findings of this study are available on request from the corresponding author [CLA]. The data are not publicly available due to them containing information that could compromise the research participants’ privacy. Access to the data requires that the Danish National Committee on Health Research Ethics ethically approve the requestors’ intended use of the data and that the legal entity of the data requestor enters into a data protection agreement with the Danish data controller, the Central Denmark Region. DREAMS is available as an R software package Zenodo and GitHub under GPL-3.0 license [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p id="Par70">The Committees on Biomedical Research Ethics in the Central Region of Denmark have approved the study (J. No. 1–10-72–3-18). The study was performed in accordance with the Declaration of Helsinki and all participants provided written informed consent.</p>
    </notes>
    <notes id="FPar5">
      <title>Consent for publication</title>
      <p id="Par71">Not applicable.</p>
    </notes>
    <notes id="FPar6" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par72">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>The main sources of circulating cell-free DNA: apoptosis, necrosis and active secretion</article-title>
        <source>Crit Rev Oncol Hematol</source>
        <year>2021</year>
        <volume>157</volume>
        <fpage>103166</fpage>
        <pub-id pub-id-type="doi">10.1016/j.critrevonc.2020.103166</pub-id>
        <?supplied-pmid 33254039?>
        <pub-id pub-id-type="pmid">33254039</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bettegowda</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sausen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Leary</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Kinde</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Agrawal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bartlett</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Luber</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Alani</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detection of circulating tumor DNA in early- and late-stage human malignancies</article-title>
        <source>Sci Transl Med</source>
        <year>2014</year>
        <volume>6</volume>
        <fpage>224ra224</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.3007094</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phallen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sausen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Adleff</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Leal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hruban</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Anagnostou</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Fiksel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cristiano</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Papp</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Direct detection of early-stage cancers using circulating tumor DNA</article-title>
        <source>Sci Transl Med</source>
        <year>2017</year>
        <volume>9</volume>
        <fpage>eaan2415</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.aan2415</pub-id>
        <?supplied-pmid 28814544?>
        <pub-id pub-id-type="pmid">28814544</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abbosh</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Birkbak</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Jamal-Hanjani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Constantin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Salari</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Le Quesne</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Veeriah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rosenthal</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phylogenetic ctDNA analysis depicts early-stage lung cancer evolution</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>545</volume>
        <fpage>446</fpage>
        <lpage>451</lpage>
        <pub-id pub-id-type="doi">10.1038/nature22364</pub-id>
        <?supplied-pmid 28445469?>
        <pub-id pub-id-type="pmid">28445469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coakley</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Garcia-Murillas</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>NC</given-names>
          </name>
        </person-group>
        <article-title>Molecular residual disease and adjuvant trial design in solid tumors</article-title>
        <source>Clin Cancer Res</source>
        <year>2019</year>
        <volume>25</volume>
        <fpage>6026</fpage>
        <lpage>6034</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-19-0152</pub-id>
        <?supplied-pmid 31088829?>
        <pub-id pub-id-type="pmid">31088829</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henriksen</surname>
            <given-names>TV</given-names>
          </name>
          <name>
            <surname>Tarazona</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Frydendahl</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gimeno-Valiente</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Carbonell-Asins</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Renner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hafez</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Roda</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Circulating tumor DNA in stage III colorectal cancer, beyond minimal residual disease detection, toward assessment of adjuvant therapy efficacy and clinical behavior of recurrences</article-title>
        <source>Clin Cancer Res</source>
        <year>2022</year>
        <volume>28</volume>
        <fpage>507</fpage>
        <lpage>517</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-21-2404</pub-id>
        <?supplied-pmid 34625408?>
        <pub-id pub-id-type="pmid">34625408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Øgaard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Henriksen</surname>
            <given-names>TV</given-names>
          </name>
          <name>
            <surname>Frydendahl</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aagaard</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Ørntoft M-BW, Larsen MØ, Knudsen AR, Mortensen FV, Andersen CL: Tumour-agnostic circulating tumour DNA analysis for improved recurrence surveillance after resection of colorectal liver metastases: a prospective cohort study</article-title>
        <source>Eur J Cancer</source>
        <year>2022</year>
        <volume>163</volume>
        <fpage>163</fpage>
        <lpage>176</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ejca.2021.12.026</pub-id>
        <?supplied-pmid 35074652?>
        <pub-id pub-id-type="pmid">35074652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cescon</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Bratman</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Siu</surname>
            <given-names>LL</given-names>
          </name>
        </person-group>
        <article-title>Circulating tumor DNA and liquid biopsy in oncology</article-title>
        <source>Nat Cancer</source>
        <year>2020</year>
        <volume>1</volume>
        <fpage>276</fpage>
        <lpage>290</lpage>
        <pub-id pub-id-type="doi">10.1038/s43018-020-0043-5</pub-id>
        <?supplied-pmid 35122035?>
        <pub-id pub-id-type="pmid">35122035</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diehl</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Choti</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Romans</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goodman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Agrawal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sokoll</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Szabo</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Circulating mutant DNA to assess tumor dynamics</article-title>
        <source>Nat Med</source>
        <year>2008</year>
        <volume>14</volume>
        <fpage>985</fpage>
        <lpage>990</lpage>
        <pub-id pub-id-type="doi">10.1038/nm.1789</pub-id>
        <?supplied-pmid 18670422?>
        <pub-id pub-id-type="pmid">18670422</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garcia-Murillas</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schiavon</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Weigelt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hrebien</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cutts</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Cheang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Osin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nerurkar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kozarewa</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mutation tracking in circulating tumor DNA predicts relapse in early breast cancer</article-title>
        <source>Sci Transl Med</source>
        <year>2015</year>
        <volume>7</volume>
        <fpage>302ra133</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.aab0021</pub-id>
        <?supplied-pmid 26311728?>
        <pub-id pub-id-type="pmid">26311728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corcoran</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Chabner</surname>
            <given-names>BA</given-names>
          </name>
        </person-group>
        <article-title>Application of cell-free DNA analysis to cancer treatment</article-title>
        <source>N Engl J Med</source>
        <year>2018</year>
        <volume>379</volume>
        <fpage>1754</fpage>
        <lpage>1765</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMra1706174</pub-id>
        <?supplied-pmid 30380390?>
        <pub-id pub-id-type="pmid">30380390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lovejoy</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Klass</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Chabon</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Stehr</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Bratman</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Say</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated digital error suppression for improved detection of circulating tumor DNA</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>547</fpage>
        <lpage>555</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3520</pub-id>
        <?supplied-pmid 27018799?>
        <pub-id pub-id-type="pmid">27018799</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Ma X, Shao Y, Tian L, Flasch DA, Mulder HL, Edmonson MN, et al. Analysis of error profiles in deep next-generation sequencing data. Genome Biol. 2019;20:50.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Evans Thomas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ettwiller Laurence</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>DNA damage is a pervasive cause of sequencing errors, directly confounding variant identification</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>355</volume>
        <fpage>752</fpage>
        <lpage>756</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aai8690</pub-id>
        <?supplied-pmid 28209900?>
        <pub-id pub-id-type="pmid">28209900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Benjamin D, Sato T, Cibulskis K, Getz G, Stewart C, Lichtenstein L: Calling Somatic SNVs and Indels with Mutect2. Cold Spring Harbor Laboratory; 2019. 10.1101/861054.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Scheffler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Halpern</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Bekritsky</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Noh</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Källberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Beyter</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Krusche</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Saunders</surname>
            <given-names>CT</given-names>
          </name>
        </person-group>
        <article-title>Strelka2: fast and accurate calling of germline and somatic variants</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>591</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0051-x</pub-id>
        <?supplied-pmid 30013048?>
        <pub-id pub-id-type="pmid">30013048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerstung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Papaemmanuil</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Subclonal variant calling with multiple samples and prior knowledge</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1198</fpage>
        <lpage>1204</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt750</pub-id>
        <?supplied-pmid 24443148?>
        <pub-id pub-id-type="pmid">24443148</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zviran</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schulman</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>STK</given-names>
          </name>
          <name>
            <surname>Deochand</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khamnei</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Maloney</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Widman</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide cell-free DNA mutational integration enables ultra-sensitive cancer monitoring</article-title>
        <source>Nat Med</source>
        <year>2020</year>
        <volume>26</volume>
        <fpage>1114</fpage>
        <lpage>1124</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-020-0915-3</pub-id>
        <?supplied-pmid 32483360?>
        <pub-id pub-id-type="pmid">32483360</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wan</surname>
            <given-names>JCM</given-names>
          </name>
          <name>
            <surname>Heider</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gale</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mouliere</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ruiz-Valdepenas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Santonja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chandrananda</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ctDNA monitoring using patient-specific sequencing and integration of variant reads</article-title>
        <source>Sci Transl Med</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>eaaz8084</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.aaz8084</pub-id>
        <?supplied-pmid 32554709?>
        <pub-id pub-id-type="pmid">32554709</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pfeiffer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gröber</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Blank</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Händler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Beyer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schultze</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Mayer</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Systematic evaluation of error rates and causes in short samples in next-generation sequencing</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>10950</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-018-29325-6</pub-id>
        <?supplied-pmid 30026539?>
        <pub-id pub-id-type="pmid">30026539</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huptas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wenning</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Optimized Illumina PCR-free library preparation for bacterial whole genome sequencing and analysis of factors influencing de novo assembly</article-title>
        <source>BMC Res Notes</source>
        <year>2016</year>
        <volume>9</volume>
        <fpage>269</fpage>
        <pub-id pub-id-type="doi">10.1186/s13104-016-2072-9</pub-id>
        <?supplied-pmid 27176120?>
        <pub-id pub-id-type="pmid">27176120</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meacham</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Boffelli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dhahbi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>DIK</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Identification and correction of systematic error in high-throughput sequence data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>451</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-451</pub-id>
        <?supplied-pmid 22099972?>
        <pub-id pub-id-type="pmid">22099972</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Blumenfeld</surname>
            <given-names>YJ</given-names>
          </name>
          <name>
            <surname>Chitkara</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Hudgins</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Analysis of the size distributions of fetal and maternal cell-free DNA by paired-end sequencing</article-title>
        <source>Clin Chem</source>
        <year>2010</year>
        <volume>56</volume>
        <fpage>1279</fpage>
        <lpage>1286</lpage>
        <pub-id pub-id-type="doi">10.1373/clinchem.2010.144188</pub-id>
        <?supplied-pmid 20558635?>
        <pub-id pub-id-type="pmid">20558635</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lei</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>G’Sell</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rinaldo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Wasserman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Distribution-free predictive inference for regression</article-title>
        <source>J Am Stat Assoc</source>
        <year>2018</year>
        <volume>113</volume>
        <fpage>1094</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2017.1307116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hayama</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hashiguchi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Okamoto</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Okada</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ono</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shimada</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ozawa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Toyoda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tsuchiya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Iinuma</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>G12V and G12C mutations in the gene KRAS are associated with a poorer prognosis in primary colorectal cancer</article-title>
        <source>Int J Colorectal Dis</source>
        <year>2019</year>
        <volume>34</volume>
        <fpage>1491</fpage>
        <lpage>1496</lpage>
        <pub-id pub-id-type="doi">10.1007/s00384-019-03344-9</pub-id>
        <?supplied-pmid 31309326?>
        <pub-id pub-id-type="pmid">31309326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parikh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goyal</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hazar-Rethinam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Siravegna</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Blaszkowsky</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Russo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Van Seventer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nadres</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shahzade</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic liquid biopsy identifies novel and heterogeneous mechanisms of acquired resistance in gastrointestinal (GI) cancer patients</article-title>
        <source>Ann Oncol</source>
        <year>2017</year>
        <volume>28</volume>
        <fpage>iii137</fpage>
        <pub-id pub-id-type="doi">10.1093/annonc/mdx262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cristiano</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Phallen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fiksel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Adleff</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bruhm</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Medina</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Hruban</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide cell-free DNA fragmentation in patients with cancer</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>570</volume>
        <fpage>385</fpage>
        <lpage>389</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1272-6</pub-id>
        <?supplied-pmid 31142840?>
        <pub-id pub-id-type="pmid">31142840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mouliere</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rosenfeld</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Circulating tumor-derived DNA is shorter than somatic DNA in plasma</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>3178</fpage>
        <lpage>3179</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1501321112</pub-id>
        <?supplied-pmid 25733911?>
        <pub-id pub-id-type="pmid">25733911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerstung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jolly</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Leshchiner</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Dentro</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rosebrock</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mitchell</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Rubanova</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Anur</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The evolutionary history of 2,658 cancers</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>578</volume>
        <fpage>122</fpage>
        <lpage>128</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1907-7</pub-id>
        <?supplied-pmid 32025013?>
        <pub-id pub-id-type="pmid">32025013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Pich O, Reyes-Salazar I, Gonzalez-Perez A, Lopez-Bigas N. Discovering the drivers of clonal hematopoiesis. Nat Commun. 2022;13:4267.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Christensen MH, Drue S, Rasmussen MH, Frydendahl Boll Johansen A, Lyskjær I, Demuth C, et al. DREAMS R package - Zenodo. Zenodo. 2023. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/badge/latestdoi/455089263">https://zenodo.org/badge/latestdoi/455089263</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Christensen MH, Drue S, Rasmussen MH, Frydendahl Boll Johansen A, Lyskjær I, Demuth C, et al. DREAMS R package - Github. Github. 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/JakobSkouPedersenLab/dreams">https://github.com/JakobSkouPedersenLab/dreams</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Pozzolo AD, Caelen O, Johnson RA, Bontempi G. Calibrating Probability with Undersampling for Unbalanced Classification. Cape Town: 2015 IEEE Symposium Series on Computational Intelligence; 2015. pp. 159–166. 10.1109/SSCI.2015.33.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Abadi M, Agarwal A, Barham P, Brevdo E, Chen Z, Citro C, et al. Tensorflow: large-scale machine learning on heterogeneous distributed systems. arXiv. 2016;1603.04467.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reinert</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schøler</surname>
            <given-names>LV</given-names>
          </name>
          <name>
            <surname>Thomsen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tobiasen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Vang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nordentoft</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lamy</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kannerup</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Mortensen</surname>
            <given-names>FV</given-names>
          </name>
          <name>
            <surname>Stribolt</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of circulating tumour DNA to monitor disease burden following colorectal cancer surgery</article-title>
        <source>Gut</source>
        <year>2016</year>
        <volume>65</volume>
        <fpage>625</fpage>
        <lpage>634</lpage>
        <pub-id pub-id-type="doi">10.1136/gutjnl-2014-308859</pub-id>
        <?supplied-pmid 25654990?>
        <pub-id pub-id-type="pmid">25654990</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reinert</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Petersen</surname>
            <given-names>LMS</given-names>
          </name>
          <name>
            <surname>Henriksen</surname>
            <given-names>TV</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>MØ</given-names>
          </name>
          <name>
            <surname>Rasmussen</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Johansen</surname>
            <given-names>AFB</given-names>
          </name>
          <name>
            <surname>Øgaard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Knudsen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nordentoft</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Vang</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Circulating tumor &lt;scp&gt;DNA&lt;/scp&gt; for prognosis assessment and postoperative management after curative-intent resection of colorectal liver metastases</article-title>
        <source>Int J Cancer</source>
        <year>2022</year>
        <volume>150</volume>
        <fpage>1537</fpage>
        <lpage>1548</lpage>
        <pub-id pub-id-type="doi">10.1002/ijc.33924</pub-id>
        <?supplied-pmid 34994972?>
        <pub-id pub-id-type="pmid">34994972</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Network TR: The results shown here are in whole or part based upon data generated by the TCGA Research Network: <ext-link ext-link-type="uri" xlink:href="https://www.cancer.gov/tcga">https://www.cancer.gov/tcga</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Li H. Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. arXiv pre-print server. 2013;1303.3997.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Heger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sudbery</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>UMI-tools: modeling sequencing errors in Unique Molecular Identifiers to improve quantification accuracy</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>491</fpage>
        <lpage>499</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.209601.116</pub-id>
        <?supplied-pmid 28100584?>
        <pub-id pub-id-type="pmid">28100584</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Picard toolkit [<ext-link ext-link-type="uri" xlink:href="http://broadinstitute.github.io/picard/">http://broadinstitute.github.io/picard/</ext-link>].</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Danecek P, Bonfield JK, Liddle J, Marshall J, Ohan V, Pollard MO, et al. Twelve years of SAMtools and BCFtools. GigaScience. 2021;10:giab008.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guyon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Weston</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barnhill</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vapnik</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <source>Mach Learn</source>
        <year>2002</year>
        <volume>46</volume>
        <fpage>389</fpage>
        <lpage>422</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1012487302797</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>
        <source>J Roy Stat Soc: Ser B (Methodol)</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
