<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2935402</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq385</article-id>
    <article-id pub-id-type="publisher-id">btq385</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Eccb 2010 Conference Proceedings September 26 to September 29, 2010, Ghent, Belgium</subject>
        <subj-group>
          <subject>Original Papers</subject>
          <subj-group>
            <subject>Protein Interactions, Molecular Networks and Systems Biology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Dynamic deterministic effects propagation networks: learning signalling pathways from longitudinal protein array data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bender</surname>
          <given-names>Christian</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Henjes</surname>
          <given-names>Frauke</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fröhlich</surname>
          <given-names>Holger</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wiemann</surname>
          <given-names>Stefan</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Korf</surname>
          <given-names>Ulrike</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Beißbarth</surname>
          <given-names>Tim</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Department of Molecular Genome Analysis, German Cancer Research Center, 69120 Heidelberg, <sup>2</sup>Department of Algorithmic Bioinformatics, Bonn-Aachen International Center for IT, 53113 Bonn and <sup>3</sup>Department of Medical Statistics, University of Göttingen, 37099 Göttingen, Germany</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>9</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>9</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>9</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>26</volume>
    <issue>18</issue>
    <fpage>i596</fpage>
    <lpage>i602</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Network modelling in systems biology has become an important tool to study molecular interactions in cancer research, because understanding the interplay of proteins is necessary for developing novel drugs and therapies. <italic>De novo</italic> reconstruction of signalling pathways from data allows to unravel interactions between proteins and make qualitative statements on possible aberrations of the cellular regulatory program. We present a new method for reconstructing signalling networks from time course experiments after external perturbation and show an application of the method to data measuring abundance of phosphorylated proteins in a human breast cancer cell line, generated on reverse phase protein arrays.</p>
      <p><bold>Results:</bold> Signalling dynamics is modelled using active and passive states for each protein at each timepoint. A fixed signal propagation scheme generates a set of possible state transitions on a discrete timescale for a given network hypothesis, reducing the number of theoretically reachable states. A likelihood score is proposed, describing the probability of measurements given the states of the proteins over time. The optimal sequence of state transitions is found via a hidden Markov model and network structure search is performed using a genetic algorithm that optimizes the overall likelihood of a population of candidate networks. Our method shows increased performance compared with two different dynamical Bayesian network approaches. For our real data, we were able to find several known signalling cascades from the ERBB signalling pathway.</p>
      <p><bold>Availability:</bold> Dynamic deterministic effects propagation networks is implemented in the R programming language and available at <ext-link ext-link-type="uri" xlink:href="http://www.dkfz.de/mga2/ddepn/">http://www.dkfz.de/mga2/ddepn/</ext-link></p>
      <p>
        <bold>Contact:</bold>
        <email>c.bender@dkfz.de</email>
      </p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Studying the molecular biology of cells and tissues has developed from the investigation of few genes or proteins in one experiment to the analysis of the interplay of many components as a system. Various array techniques have been devised for analysing cellular behaviour on DNA, RNA and protein level that make it possible to generate thousands of measurements in a single experiment. These data can be plugged into <italic>de novo</italic> network reconstruction methods in order to infer regulatory interactions between the measured components. For this purpose, several approaches have been developed in the past.</p>
    <p>Bayesian Networks (BN; Heckerman, <xref ref-type="bibr" rid="B8">1996</xref>) have been frequently used to reconstruct gene regulatory networks from RNA expression experiments (Friedman <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2000</xref>; Segal <italic>et al.</italic>, <xref ref-type="bibr" rid="B28">2005</xref>) as well as causal protein–protein relationships for intensity data from protein quantification (Sachs <italic>et al.</italic>, <xref ref-type="bibr" rid="B26">2005</xref>). The latter is an example where directed perturbations of several measured proteins were performed in order to resolve the structure of the underlying interactions. External interventions can be introduced by multiple means, for example, changing environmental conditions, applying drugs or using gene silencing methods such as RNA interference. Another example for BN usage under perturbation conditions is given in Pe'er <italic>et al.</italic> (<xref ref-type="bibr" rid="B24">2001</xref>).</p>
    <p>Besides BNs, there are several related approaches to infer networks from perturbation data. Markowetz <italic>et al.</italic> (<xref ref-type="bibr" rid="B19">2005</xref>) derived networks after knocking out specific genes by analysing expression patterns in the discretized gene expression measurements. Fröhlich <italic>et al.</italic> (<xref ref-type="bibr" rid="B5">2008</xref>) extended this approach to perform inference on non-discretized expression levels. Tegner <italic>et al.</italic> (<xref ref-type="bibr" rid="B32">2003</xref>) suggested iterative perturbation of the system in order to reveal the underlying network structure. They modelled perturbations as a linear combination of inputs and inferred weights for the pairwise node to node influences. Nelander <italic>et al.</italic> (<xref ref-type="bibr" rid="B21">2008</xref>) improved this idea by using nonlinear perturbation effects and modelled the interaction behaviour of a number of components after several single and combinatorial perturbations.</p>
    <p>Time resolved measurements provide insight into the dynamical behaviour of the system and do not restrict modelling to a ‘snapshot’ of the system's state. A suitable approach for network inference from time resolved data are dynamic Bayesian networks (DBN), a family of reconstruction methods including Boolean network models, state-space models or regression models (Akutsu <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">1999</xref>; Imoto <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2002</xref>; Lébre, <xref ref-type="bibr" rid="B13">2009</xref>; Murphy and Mian, <xref ref-type="bibr" rid="B20">1999</xref>; Rau <italic>et al.</italic>, <xref ref-type="bibr" rid="B25">2010</xref>).</p>
    <p>While these methods model the dynamics of the system over time, they do not model perturbation effects directly. However, Geier <italic>et al.</italic> (<xref ref-type="bibr" rid="B7">2007</xref>) studied reverse engineering methods on simulated data for time courses and external perturbations and came to the conclusion that additional perturbation of the system is beneficial. So methods that explicitly include perturbations in the modelling approach for time course analysis are still needed. In addition, most of the current network reconstruction methods are tailored to the analysis of gene regulatory networks based on gene expression data from microarray experiments. Rather few studies deal with the signalling flow between proteins based on the analysis of protein activation and abundance coupled with intervention effects. Fröhlich <italic>et al.</italic> (<xref ref-type="bibr" rid="B6">2009</xref>) developed a network inference method for protein networks after knockdown of the measured components that allows time series measurements, too. But their method treats each time point as independent measurement and does not model the time-dependent behaviour of the system explicitly. However, using only few perturbations and gathering information on the signal flow through longer time series would be desirable, too.</p>
    <p>In this study, we set up a framework for reconstructing signalling networks from time course measurements after external perturbation (both inhibitory and stimulating). <xref ref-type="fig" rid="F1">Figure 1</xref> shows an outline of the proposed workflow. Networks are represented as directed cyclic graphs with distinct edge types for activating and inhibiting interactions. We model signalling dynamics by a Boolean signal propagation mechanism defining state transitions for a given network structure. An optimal state transition series is found in a hidden Markov model (HMM; Durbin <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">1998</xref>) and the fit of the data to such a transition matrix is assessed by our proposed likelihood score. Network structure search is performed in a genetic algorithm (GA) optimizing the overall likelihood of a population of candidate networks. Our method shows good performance for reconstructing signalling networks from artificial data and outperforms two current DBN approaches.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Overview of the approach: given a network hypothesis (<bold>A</bold>), we generate a set of reachable system states by applying a fixed signal propagation scheme (<bold>B</bold>) which in effect reduces the number of possible system states. An optimal path through these reachable system states over time is identified by an HMM (<bold>C</bold>). Using the series of system states from the HMM, model parameters for two Gaussian distributions for each protein (one for active, one for passive) are estimated (<bold>D</bold>) and a total likelihood of our measurements given the network and model parameters is calculated (<bold>E</bold>). We use this likelihood score in a GA in order to optimize the overall score for an evolving population of candidate networks (<bold>F</bold>) and generate a final network from this population, after we found convergence in the GA.</p></caption><graphic xlink:href="btq385f1"/></fig></p>
    <p>As an application of the algorithm, we used protein phosphorylation measurements for 16 ERBB signalling-related phosphoproteins. The data were generated on reverse phase protein arrays (RPPA; Loebke <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2007</xref>) in the human breast cancer cell line HCC1954, which overexpresses the ERBB2 receptor that is associated with reduced disease-free and overall survival in breast cancer patients (Slamon <italic>et al.</italic>, <xref ref-type="bibr" rid="B29">1987</xref>, <xref ref-type="bibr" rid="B30">1989</xref>). Note that dynamic deterministic effects propagation networks (DDEPN) was developed for protein phosphorylation data, but in principle is also applicable to other types of high-throughput data, e.g. for RNA microarrays. We stimulated the cells with two ligands [epidermal growth factor (EGF) and heregulin (HRG)], both as separate and combined stimulation experiments. All three experiments were combined to infer a signalling network which was compared with current literature knowledge. DDEPN was able to identify several well-known signalling chains from the MAPK and AKT signalling pathways, some of which originally were found in ERBB2 overexpressing cells. This shows the ability of our method to identify meaningful interactions from experimental proteomics data.</p>
  </sec>
  <sec id="SEC2">
    <title>2 SYSTEM AND METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 Modelling the dynamics of the system</title>
      <p>Let <italic>V</italic> = {<italic>v</italic><sub><italic>i</italic></sub>: <italic>i</italic> ∈ 1,…, <italic>N</italic>} be the set of nodes representing proteins and Φ = <italic>V</italic> × <italic>V</italic> → {0, 1, 2} an adjacency matrix defining a network, where 0 means no edge, 1 activation and 2 inhibition between two nodes. The signal flow through a given network of proteins is represented as a matrix Γ = {γ<sub><italic>ik</italic></sub> ∈ {0, 1} : <italic>i</italic> ∈ 1,…, <italic>N</italic>, <italic>k</italic> ∈ 1,…, <italic>M</italic>}, which contains a series of possible system states <bold>γ</bold><sub><bold>k</bold></sub> = {γ<sub><italic>i</italic></sub> : <italic>i</italic> ∈ 1,…, <italic>N</italic>, γ<sub><italic>i</italic></sub> ∈ {0, 1}}. These are vectors of activation states for each node at a time step <italic>k</italic>. Define 0 &lt; <italic>M</italic> ≤ 2<sup><italic>N</italic></sup> as number of reachable system states, determined as soon as a state is repeated during the signal propagation. Each perturbation is seen as an external influence which is included as a node into the network and whose state is constantly active (i.e. 1).</p>
      <p>Starting at the stimuli nodes, the status of all children is subsequently determined. A child is active if at least one parent connected by an activation edge is active and all parents connected via inhibition edges are inactive in the preceding step. For example, in the matrix Γ shown in <xref ref-type="fig" rid="F1">Figure 1</xref>, the state γ<sub><italic>B</italic>2</sub> of protein B at Step 2 is determined by γ<sub><italic>B</italic>2</sub> = γ<sub><italic>S</italic>1</sub> ∧ ¬γ<sub><italic>A</italic>1</sub> = 1 ∧ 1 = 1 (where ‘¬’ is the logical negation which is used whenever a parent is connected via an inhibitory edge).</p>
      <p>A formal description of the signal propagation follows: given a set of nodes <italic>V</italic> and a network Φ. Define <italic>S</italic> ⊆ <italic>V</italic> as the set of input stimuli and consider the network Φ as fixed for the propagation. We derive the state matrix Γ that comprises all <italic>M</italic> reachable state vectors <bold>γ</bold><sub><bold>k</bold></sub> for the given network. The propagation is stopped at a step <italic>M</italic>, if ∃ <italic>k</italic> ≤ <italic>M</italic>, such that <bold>γ</bold><sub><bold>k</bold></sub> = <bold>γ</bold><sub><bold>M</bold></sub>, i.e. if one of the preceding states is found a second time.</p>
      <p>All stimuli nodes <italic>s</italic> ∈ <italic>S</italic> are active in all steps, i.e. γ<sub><italic>sk</italic></sub> = 1 ∀<italic>k</italic>, and all other nodes are initialized to be 0 in the first step, i.e. γ<sub><italic>v</italic><sub><italic>i</italic></sub>1</sub> = 0 ∀<italic>v</italic><sub><italic>i</italic></sub> ∈ <italic>V</italic> ∖ <italic>S</italic>. Let <italic>pa</italic>(<italic>v</italic><sub><italic>i</italic></sub>) be the set of all parents of a node <italic>v</italic><sub><italic>i</italic></sub> and ϕ<sub><italic>wv</italic><sub><italic>i</italic></sub></sub> an edge from a node <italic>w</italic> to <italic>v</italic><sub><italic>i</italic></sub>. For any status <italic>k</italic> and protein <italic>v</italic><sub><italic>i</italic></sub>, define
<disp-formula><graphic xlink:href="btq385um1"/></disp-formula>
as the sets of states of parental nodes of <italic>v</italic><sub><italic>i</italic></sub> in step <italic>k</italic> − 1, connected by activating edges (<italic>E</italic><sub><italic>k</italic>−1</sub><sup>+</sup>) and connected by inhibiting edges (<italic>E</italic><sub><italic>k</italic>−1</sub><sup>−</sup>). An entry γ<sub><italic>v</italic><sub><italic>i</italic></sub><italic>k</italic></sub> in Γ is then determined by:
<disp-formula id="M1"><label>(1)</label><graphic xlink:href="btq385m1"/></disp-formula></p>
      <p>This procedure reduces the maximal number of columns in the system state matrix Γ from 2<sup><italic>N</italic></sup> to <italic>M</italic> ≤ 2<sup><italic>N</italic></sup>. However, the states in Γ do not necessarily correspond to the actual measured time points in the data. In general, it is expected that a different number of reachable states than time points is found. For example, in the hypothetical case that the system remains in a constant state, only one state would be present Γ. Thus, we have to find a series of system states that is consistent with the measured experimental data and represents expected dynamics under our given network hypothesis, which is described in the next section.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 HMM for searching the optimal sequence of system states</title>
      <p>Let <italic>t</italic> ∈ 1,…, <italic>T</italic> denote the index for the time point and <italic>r</italic> ∈ 1,…, <italic>R</italic> denote the index for the replicated measurements. Our measured data are recorded in a data matrix <italic>X</italic> = {<italic>x</italic><sub><italic>itr</italic></sub> : <italic>i</italic> ∈ 1,…, <italic>N</italic>, <italic>t</italic> ∈ 1,…, <italic>T</italic>, <italic>r</italic> ∈ 1,…, <italic>R</italic>}. The true sequence of reachable system states is represented in an unknown matrix Γ<sup>*</sup> = {γ<sup>*</sup><sub><italic>itr</italic></sub> : <italic>i</italic> ∈ 1,…, <italic>N</italic>, <italic>t</italic> ∈ 1,…, <italic>T</italic>, <italic>r</italic> ∈ 1,…, <italic>R</italic>}. Each entry in Γ<sup>*</sup> represents the state of a node <italic>i</italic> at time point <italic>t</italic> and corresponds to each measurement <italic>x</italic><sub><italic>itr</italic></sub>, where replicate measurements indexed by <italic>r</italic> are assumed to have the same state. We omit the index <italic>r</italic> for notational simplicity for the rest of this section, but the reader should be aware that optimization in the HMM is done by multiplying all replicate emission probabilities for determining the entries in the Viterbi matrix [as shown in Equation (<xref ref-type="disp-formula" rid="M4">4</xref>)].</p>
      <p>Intuitively, Γ<sup>*</sup> provides a classification of measurements into measurements coming from an active state and those from an inactive state. We infer an estimate <inline-formula><inline-graphic xlink:href="btq385i1.jpg"/></inline-formula> for Γ<sup>*</sup> by using an HMM <italic>H</italic> = (<italic>W</italic>, Γ, <italic>A</italic>, <italic>e</italic>). Here, <italic>W</italic> represents the range of possible values for observations, i.e. all positive real-valued intensities generated by the array scanning software (in our case [0, 2<sup>16</sup> − 1]). Γ is the set of possible states, as derived in <xref ref-type="sec" rid="SEC2.1">Section 2.1</xref>. <italic>A</italic> is a matrix of transition probabilities for the system states. We refer to <italic>e</italic> as the emission probability <inline-formula><inline-graphic xlink:href="btq385i2.jpg"/></inline-formula> [Equation (<xref ref-type="disp-formula" rid="M4">4</xref>)], where <inline-formula><inline-graphic xlink:href="btq385i3.jpg"/></inline-formula> is the matrix of estimated model parameters [Equation (<xref ref-type="disp-formula" rid="M3">3</xref>)]. <italic>e</italic> corresponds to the likelihood of observing data point <bold>x</bold><sub><bold>t</bold></sub> given its state <inline-formula><inline-graphic xlink:href="btq385i4.jpg"/></inline-formula>. Note that <bold>x</bold><sub><bold>t</bold></sub> is a column in the measurement matrix <italic>X</italic>, i.e. a vector of intensity values.</p>
      <p>We use the Viterbi training algorithm (Durbin <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">1998</xref>) to find an optimal sequence of system states and optimize the transition matrix <italic>A</italic> as well as the parameter matrix <inline-formula><inline-graphic xlink:href="btq385i5.jpg"/></inline-formula>. We initialize <inline-formula><inline-graphic xlink:href="btq385i6.jpg"/></inline-formula> by sampling random states from Γ, while preserving the order of the states, and the transition matrix <italic>A</italic> to uniform probabilities for all state transitions. We estimate model parameters <inline-formula><inline-graphic xlink:href="btq385i7.jpg"/></inline-formula> depending on <inline-formula><inline-graphic xlink:href="btq385i8.jpg"/></inline-formula> [Equations (<xref ref-type="disp-formula" rid="M2">2</xref>) and (<xref ref-type="disp-formula" rid="M3">3</xref>)]. Now <inline-formula><inline-graphic xlink:href="btq385i9.jpg"/></inline-formula> is updated using the HMM and the procedure iterated until convergence, as described in Durbin <italic>et al.</italic> (<xref ref-type="bibr" rid="B3">1998</xref>). This yields the final state matrix estimate <inline-formula><inline-graphic xlink:href="btq385i10.jpg"/></inline-formula> used for the likelihood calculation, described in the next section.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Likelihood model</title>
      <p>For calculation of emission probabilities in <xref ref-type="sec" rid="SEC2.2">Section 2.2</xref> as well as computation of the total network likelihood in the structure search (<xref ref-type="sec" rid="SEC2.4">Section 2.4</xref>), we set up a likelihood score that describes the probability of observing measurements under our model, represented by the network hypothesis. Given a state matrix estimate <inline-formula><inline-graphic xlink:href="btq385i11.jpg"/></inline-formula>, each measurement <italic>x</italic><sub><italic>itr</italic></sub> for protein <italic>i</italic>, time point <italic>t</italic> and replicate <italic>r</italic> comes from an ‘active’ normal distribution 𝒩(μ<sub><italic>i</italic>1</sub>, σ<sub><italic>i</italic>1</sub>), if its state <inline-formula><inline-graphic xlink:href="btq385i12.jpg"/></inline-formula>, and from a ‘passive’ normal distribution 𝒩(μ<sub><italic>i</italic>0</sub>, σ<sub><italic>i</italic>0</sub>), if <inline-formula><inline-graphic xlink:href="btq385i13.jpg"/></inline-formula>:
<disp-formula id="M2"><label>(2)</label><graphic xlink:href="btq385m2"/></disp-formula></p>
      <p>The parameters of each distribution for one protein are obtained as unbiased empirical mean and SD of all measurements for this protein in the given class. This yields the parameter matrix:
<disp-formula id="M3"><label>(3)</label><graphic xlink:href="btq385m3"/></disp-formula></p>
      <p>Now we can write the likelihood for a data point <italic>x</italic><sub><italic>t</italic></sub> as:
<disp-formula id="M4"><label>(4)</label><graphic xlink:href="btq385m4"/></disp-formula></p>
      <p>The total likelihood for a network hypothesis Φ can be written as:
<disp-formula id="M5"><label>(5)</label><graphic xlink:href="btq385m5"/></disp-formula></p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Network structure search</title>
      <p>The previous two sections dealt with the assessment of a single network hypothesis. However, the aim of our method is to optimize the network structure with respect to the network likelihood, so a suitable network structure search strategy has to be chosen. We use a GA as sampling-based technique for network structure search that optimizes a whole population of candidate networks. Studies of Wahde and Hertz (<xref ref-type="bibr" rid="B34">2000</xref>) and Spieth <italic>et al.</italic> (<xref ref-type="bibr" rid="B31">2006</xref>) show the usefulness of evolutionary strategies for network reconstruction. We evolve a population of networks in parallel by selection and mutation of the individuals. Selection should choose the fittest individuals and mutations should be beneficial for the overall fitness of all networks. Further, we allow ‘communication’ between the networks in form of crossovers. To avoid overfitting by inclusion of too many edges in the networks, we use the Bayesian information criterion (BIC; Schwarz, <xref ref-type="bibr" rid="B27">1978</xref>) as fitness score, which penalizes higher numbers of edges and is calculated from the likelihood [Equation (<xref ref-type="disp-formula" rid="M5">5</xref>)]:
<disp-formula><graphic xlink:href="btq385um2"/></disp-formula>
where <italic>K</italic> is the number of edges in Φ and <italic>n</italic> is the number of data points in <italic>X</italic>. This will result in sparse network structures.</p>
      <sec id="SEC2.4.1">
        <title>2.4.1 GA specification</title>
        <p>A population <italic>P</italic> = {Φ<sub><italic>j</italic></sub> : <italic>j</italic> ∈ 1,…, <italic>p</italic>} of <italic>p</italic> networks, a crossover (selection) rate <italic>q</italic> (1 − <italic>q</italic>) and mutation rate <italic>m</italic> with <italic>q</italic>, <italic>m</italic> ∈ [0; 1] are given. During selection we choose a fraction ⌊(1 − <italic>q</italic>)<italic>p</italic>⌋ individuals with probability proportional to their fitness. We require that BICs of selected networks are smaller than the median of the BICs of all individuals in the population, mimicing a simple greedy search, but leaving the possibility for selecting suboptimal moves. The selected individuals are added to the next generation population <italic>P</italic>′.</p>
        <p>For crossing over we choose <inline-formula><inline-graphic xlink:href="btq385i14.jpg"/></inline-formula> random pairs from <italic>P</italic>, again proportional to each individuals' fitness. To perform crossing over of two networks, each network adjacency matrix is represented as a vector (simply attaching all columns to each other) and two point crossover is performed for these vectors. The modified individuals are added to <italic>P</italic>′ if their BICs are smaller than the median BIC for all individuals in <italic>P</italic>′. In case that after crossover the size of the modified population <italic>P</italic>′ is smaller than <italic>p</italic>, we add as many random individuals from <italic>P</italic> to <italic>P</italic>′, such that the population size stays constant.</p>
        <p>Finally, we perform mutation of ⌊<italic>mp</italic>⌋ networks chosen from the new population <italic>P</italic>′. For each selected network a random edge is drawn and its type is changed randomly to one of the remaining types. As an example, given an edge ϕ<sub><italic>vw</italic></sub> = 2, it can be either changed to ϕ<sub><italic>vw</italic></sub>′ = 1 or ϕ<sub><italic>vw</italic></sub>′ = 0. Mutations are allowed if the fitness of the individual improves by introducing the mutation.</p>
        <p>These three steps are repeated until a prespecified number of iterations (usually 1000) have been run or the median of all BICs in the population does not change for 10 times in a row. At the end of the GA, the population of candidate networks is combined into a final network by including each edge that occurs in more than a prespecified fraction of all networks in the population (usually 50% if not stated explicitly).</p>
      </sec>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Data generation and preprocessing for HCC1954 RPPA data</title>
      <p>The human breast cancer cell line HCC1954 was cultivated as recommended by ATCC and cells were split three times per week. For stimulation experiments, cells were seeded in 6-well plates, cultivated for 24 h and serum-starved in phenol red-free medium for additional 24 h. EGF (Sigma, Steinheim, Germany) and HRG (Biovision, Mountain View, CA, USA) were added to the cells to a final concentration of 5 nM. After times 0, 4, 8, 12, 16, 20, 30, 40, 50 and 60 min, medium was replaced by ice-cold PBS and plates were put on ice. Afterwards, PBS was aspirated and cells were harvested by manual scraping in 40 μl lysis buffer [M-PER (Pierce, Bonn, Germany), Complete Mini, PhosSTOP (Roche, Mannheim, Germany)]. Cells were lysed for 20 min at 4 <sup>○</sup>C. After centrifugation, total protein concentration was determined using the BCA method (Pierce, Bonn, Germany) and all samples were adjusted to the same protein concentration. Prior to printing, samples were mixed with Tween-20 to a final concentration of 0.05%. Three biological replicates were generated at three different days. The samples were printed in triplicate onto nitrocellulose coated glass slides [Oncyte; Grace-Biolabs (Bend, OR, USA)] with a contact spotter [2470 Arrayer; (Aushon Biosystems, billerica, MA, USA)] using 180 μm pins. Slides were blocked in 50% Odyssey Blocking Buffer LI-COR (Lincoln, NE, USA) in PBS containing 5 mM sodium fluoride and 1 mM vanadate. Primary antibodies were diluted 1:300 in antibody diluent with background reducing components (Dako, Glostrup, Denmark). Alexa 680 labelled secondary antibodies (Molecular Probes, Darmstadt, Germany) were diluted 1:5000 in PBS (+0.2% NP-40, 0.02% SDS + 0.5% BSA). After drying, arrays were scanned using the Odyssey Infrared Imaging System (LI-COR, Lincoln, NE, USA) and signal intensities were determined with GenePix Pro 5.0 (Molecular Devices, Sunnyvale, CA, USA). Sample normalisation was done using Fast Green FCF dye (see Loebke <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2007</xref>; Luo <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">2006</xref>) to account for different protein concentrations in each spot on the array. Replicate time courses were centred around their common mean to remove systematic shifts in the intensities. Sixteen antibodies for specific phosphorylation sites were used to obtain signal intensities of phosphorylated protein. A list of the proteins and phosphorylation sites is shown in <xref ref-type="table" rid="T1">Table 1</xref>. The antibodies were obtained from the following companies: ERBB4 and GSK3 from Epitomics (Burlingame, CA, USA), ERBB2 from Millipore (billerica, MA, USA), MEK1/2 from Sigma, PKCα from Abcam (Cambrige, UK) all others from Cell Signaling (Beverly, MA, USA).
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Proteins and phosphorylation sites used in the RPPA analysis</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Protein</th><th align="left" rowspan="1" colspan="1">Phosphosite</th><th align="left" rowspan="1" colspan="1">Protein</th><th align="left" rowspan="1" colspan="1">Phosphosite</th><th align="left" rowspan="1" colspan="1">Protein</th><th align="left" rowspan="1" colspan="1">Phosphosite</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">AKT</td><td align="left" rowspan="1" colspan="1">S473</td><td align="left" rowspan="1" colspan="1">EGFR</td><td align="left" rowspan="1" colspan="1">Y1068</td><td align="left" rowspan="1" colspan="1">ERBB2</td><td align="left" rowspan="1" colspan="1">Y1112</td></tr><tr><td align="left" rowspan="1" colspan="1">ERBB3</td><td align="left" rowspan="1" colspan="1">Y1289</td><td align="left" rowspan="1" colspan="1">ERBB4</td><td align="left" rowspan="1" colspan="1">Y1162</td><td align="left" rowspan="1" colspan="1">ERK1/2</td><td align="left" rowspan="1" colspan="1">T202,Y204</td></tr><tr><td align="left" rowspan="1" colspan="1">GSK3</td><td align="left" rowspan="1" colspan="1">Y279,Y216</td><td align="left" rowspan="1" colspan="1">MEK1/2</td><td align="left" rowspan="1" colspan="1">S217,S221</td><td align="left" rowspan="1" colspan="1">MTOR</td><td align="left" rowspan="1" colspan="1">S2448</td></tr><tr><td align="left" rowspan="1" colspan="1">p38</td><td align="left" rowspan="1" colspan="1">T180,Y182</td><td align="left" rowspan="1" colspan="1">p70S6K</td><td align="left" rowspan="1" colspan="1">T389</td><td align="left" rowspan="1" colspan="1">PDK1</td><td align="left" rowspan="1" colspan="1">S241</td></tr><tr><td align="left" rowspan="1" colspan="1">PKCα</td><td align="left" rowspan="1" colspan="1">S657,Y658</td><td align="left" rowspan="1" colspan="1">PLCγ</td><td align="left" rowspan="1" colspan="1">S1248</td><td align="left" rowspan="1" colspan="1">PRAS</td><td align="left" rowspan="1" colspan="1">T246</td></tr><tr><td align="left" rowspan="1" colspan="1">SRC</td><td align="left" rowspan="1" colspan="1">Y416</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr></tbody></table></table-wrap>
</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 RESULTS AND DISCUSSION</title>
    <sec id="SEC3.1">
      <title>3.1 Simulations</title>
      <sec id="SEC3.1.1">
        <title>3.1.1 Generation of simulation data</title>
        <p>Given a number of nodes and a number of input stimuli, we generated networks as follows: starting at the input stimuli, we sampled outgoing activation edges until all nodes were connected and added 20% of the number of activating edges as inhibitions to retrieve fully connected networks. This ensured that all nodes could be reached by a stimulus signal and that feed forward and feed back loops were included in the network.</p>
        <p>Given such a sampled network, a data matrix <italic>X</italic> (as defined in <xref ref-type="sec" rid="SEC2.2">Section 2.2</xref>) was constructed. We refer to parameters <italic>nstim</italic> as the number of distinct input stimuli and <italic>cstim</italic> as the number of stimulus combinations. Each stimulus gives rise to a separate experiment, so for each stimulus a separate state matrix was constructed by our effect propagation. A state transition matrix for each stimulus was built up by sampling <italic>T</italic> columns with replacement from each state matrix, while the order of the states was preserved. Each column in the state transition matrix was repeated <italic>R</italic> times to generate replicates. Finally, all state matrices were attached to get the total state matrix Γ, and all state transition matrices were attached to generate Γ<sup>*</sup>.</p>
        <p>Then, for each time point, replicate and node a measurement <italic>x</italic><sub><italic>itr</italic></sub> was sampled from two Gaussian distributions, either from <italic>x</italic><sub><italic>itr</italic></sub> ∼ 𝒩(1200, 400) if γ<sup>*</sup><sub><italic>itr</italic></sub> = 0 or from <italic>x</italic><sub><italic>itr</italic></sub> ∼ 𝒩(2000, 1000) if γ<sup>*</sup><sub><italic>itr</italic></sub> = 1. The parameters for the Gaussians (mean and variance) were chosen similar to the observed measurements in our real data. We chose <italic>T</italic> = 10 and <italic>R</italic> = 9 as number of time points and number of replicates for the simulations.</p>
      </sec>
      <sec id="SEC3.1.2">
        <title>3.1.2 Recovering the true state sequence</title>
        <p>We tested how good the HMM from <xref ref-type="sec" rid="SEC2.2">Section 2.2</xref> is able to recover a true state sequence Γ<sup>*</sup>. For this purpose we sampled networks for increasing number of nodes and performed the effect propagation from <xref ref-type="sec" rid="SEC2.1">Section 2.1</xref> for different numbers of input stimuli. Γ<sup>*</sup> matrices were sampled 100 times for each network and stimulus combination, and for each Γ<sup>*</sup> data was generated as described in <xref ref-type="sec" rid="SEC3.1.1">Section 3.1.1</xref>. We performed the HMM state sequence search for all data matrices and compared the resulting state transition matrix <inline-formula><inline-graphic xlink:href="btq385i15.jpg"/></inline-formula> with the corresponding reference Γ<sup>*</sup> in terms of sensitivity SN = (TP/(TP+FN)) and specificity SP = (TN/(TN+FP)), counting the true and false occurrences of the entries in <inline-formula><inline-graphic xlink:href="btq385i16.jpg"/></inline-formula>. <xref ref-type="fig" rid="F2">Figure 2</xref> shows that the recovery performance stays constantly high at average values of around SN = 0.84 and SP = 0.95 for networks up to 30 nodes, and around SN = 0.83 and SP = 0.97 for increasing the number of input stimuli <italic>nstim</italic>. Hence, given an unknown series of system states, the HMM is able to identify the correct states, even for bigger networks with up to 30 nodes.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>Performance of state recovery for increasing number of nodes <italic>N</italic> (<bold>A</bold>) and number of stimuli <italic>nstim</italic> (<bold>B</bold>).</p></caption><graphic xlink:href="btq385f2"/></fig></p>
      </sec>
      <sec id="SEC3.1.3">
        <title>3.1.3 Performance of structure search</title>
        <p>We sampled random networks and generated intensity measurements as described in <xref ref-type="sec" rid="SEC3.1.1">Section 3.1.1</xref>. For network comparisons, we counted the number of truly inferred edges (TP), truly not inferred edges (TN), erroneously inferred edges (FP) and erroneously not inferred edges (FN). Note that now we counted edges in the network, and not entries in the state matrix as in the previous section. Network reconstructions were done for artificial networks of size <italic>N</italic> = 10 with population sizes from <italic>p</italic> ∈ {100, 250, 500}, <italic>q</italic> = 0.3 and <italic>m</italic> = 0.8. Also increasing numbers of different input stimuli were compared. We chose <italic>nstim</italic> ∈ {1, 2} and <italic>cstim</italic> ∈ {0, 1}. To measure the performance, the GA was run for 25 sampled networks, each time with the maximum number of generations set to 1000. The edge inclusion threshold for the final network (<xref ref-type="sec" rid="SEC2.4">Section 2.4</xref>) was varied in [0; 1], and the respective final network for each given threshold was compared with the original net, yielding SN and SP values for the generation of receiver operator characteristic (ROC) curves and area under curve (AUC) values.</p>
        <p><xref ref-type="fig" rid="F3">Figure 3</xref> shows that the reconstruction performance was limited for the case of <italic>nstim</italic> = 1,<italic>cstim</italic> = 0 and increasing population size <italic>p</italic> = 100, <italic>p</italic> = 250 and <italic>p</italic> = 500 (AUCs 0.57, 0.6, 0.61), while a slight increase could be found for the bigger population size. This is expected because the use of a bigger population ensures broader sampling of the network search space. However, true increase in performance was reached when including two distinct stimuli (<italic>nstim</italic> = 2) and further including one stimulus combination (<italic>cstim</italic> = 1). Here, the AUCs increased to 0.75 and 0.73, respectively. As before, for higher population sizes the AUCs increased (from 0.7 to 0.75). In <xref ref-type="fig" rid="F3">Figure 3</xref>B, for a fixed threshold <italic>th</italic> = 0.5, SN and SP were plotted for each simulation test. In the <italic>nstim</italic> = 1 case, SP was high around 0.87, while SN was rather low around 0.17. For <italic>nstim</italic> = 2, SN increased to values around 0.4, while SP improved from 0.78 to 0.83 for growing population sizes. This showed that inclusion of multiple stimuli triggering signalling in the network at different input nodes increased the amount of information that could be used to find the signalling connectivity, and thus resulted in better identification of true edges in the network (apparent in the increasing SN values). However, it was also apparent that SN levels were still rather low, so the reconstruction missed quite a number of edges, that should have been found. On the other hand, the high values for SP ensured that inferred edges were those with strong support from the experimental measurements, and thus could be expected to be meaningful. Summarising this, our method was able to recover parts of the original signalling networks but did this with high specificity, meaning that predominantly true edges were found. This makes the method useful for the generation of new interaction hypotheses.
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>(<bold>A</bold>) ROC curves and AUCs for different settings of input (<italic>nstim</italic>) and combinatorial stimuli (<italic>cstim</italic>) and population sizes (<italic>p</italic>). SN and SP were calculated as average of each 25 network reconstructions with network size of <italic>N</italic> = 10. (<bold>B</bold>) Example SN and SP plot for <italic>th</italic> = 0.5 for all settings. For <italic>p</italic> = 500, SP was high at ∼0.83, while SN increased from ∼0.17 to ∼0.4. This shows, that DDEPN found edges with strong support from the data with low FP rates. The increase in SN for bigger population sizes shows, that broader sampling of the network search space yielded better inference results.</p></caption><graphic xlink:href="btq385f3"/></fig></p>
      </sec>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Comparison with related approaches for network inference</title>
      <p>We compared our method with the DBN reconstruction approach G1DBN of Lébre (<xref ref-type="bibr" rid="B13">2009</xref>) and to a recent method of Rau <italic>et al.</italic> (<xref ref-type="bibr" rid="B25">2010</xref>), called ebdbNet. For network size <italic>N</italic> = 10, 25 networks were simulated and the reconstruction performed. We repeated each network reconstruction 100 times and calculated ROCs and AUCs as shown in <xref ref-type="sec" rid="SEC3.1.3">Section 3.1.3</xref>. The results are depicted in <xref ref-type="fig" rid="F4">Figure 4</xref>. For <italic>nstim</italic> = 1, <italic>cstim</italic> = 0, DDEPN performed slightly better than G1DBN and ebdbNet (AUCs 0.61 for DDEPN, 0.58 and 0.55 for G1DBN and ebdbNet, respectively). However, the performance was limited in this case for all methods. Using <italic>nstim</italic> = 2, DDEPN clearly outperformed G1DBN and ebdbNet, for both <italic>cstim</italic> = 0 (AUC = 0.75) and <italic>cstim</italic> = 1 (AUC = 0.73). This highlighted the ability of DDEPN to make use of the additional information gained from multiple perturbations. The better performance had its price in terms of computation time. On average, a 10 node network with three input stimuli was reconstructed in around 7000 s using DDEPN, while G1DBN and ebdbNet completed this task in a few seconds. However, the network inferred in DDEPN was derived from a whole population of candidate networks that covers larger portions of the network search space than the other two approaches. Calculation was done on a Quad-Core AMD Opteron(tm) 2.7 GHz machine with 64 GB memory, on which each 14 cores were used in parallel to optimize the population of networks in the GA. Because of the better performance of the reconstruction and the fact that DDEPN was able to infer both activation and inhibition edges, we think this price is worth paying.
<fig id="F4" position="float"><label>Fig. 4.</label><caption><p>ROC curves and AUCs for DDEPN network reconstruction compared with G1DBN and ebdbNet. (<bold>A</bold>) For <italic>nstim</italic> = 1,<italic>cstim</italic> = 0, a slight improvement of AUCs was observed, and performances were limited for all approaches. (<bold>B</bold>) For <italic>nstim</italic> = 2,<italic>cstim</italic> = {0, 1}, a clear increase in AUC was found for DDEPN, showing the improved quality of the network reconstructions.</p></caption><graphic xlink:href="btq385f4"/></fig></p>
      <p>We also compared our new approach DDEPN with the related approach deterministic effects propagation networks (DEPNs) of Fröhlich <italic>et al.</italic> (<xref ref-type="bibr" rid="B6">2009</xref>), but were not able to infer reasonable networks under the settings applied here. This was for two reasons: first, DEPN was designed for the setting of few time points and many perturbations, i.e. the information on the signal flow is collected through the perturbation of many or even all nodes in the network, so a small number of time points is sufficient. In DDEPN, we only introduced few perturbations and got additional information on the signal flow through a higher number of time points. Therefore, it was not possible to capture the signalling relationships of the components downstream the perturbed nodes with high resolution using DEPN. Second, DEPN cannot model perturbations as stimulation, but only as knockdown. So both methods have specific requirements and cannot be exchanged without care for different datasets. However, DDEPN can also be run with more than two perturbed nodes and has the advantage, that both types of perturbation can be included.</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Signalling networks in HCC1954 breast cancer cell line</title>
      <p>We used DDEPN to reconstruct a signalling network from our data. Parameters were chosen as population size 500, maximum iterations 1000, crossover rate <italic>q</italic> = 0.3 and mutation rate <italic>m</italic> = 0.8. The inferred network is shown in <xref ref-type="fig" rid="F5">Figure 5</xref>. An edge is shown if it was contained in at least 50% of the networks in the final population (<italic>th</italic> = 0.5), allowing only interactions with strong support from the data. We saw several signal cascades in our network that were known from the literature. For example, we inferred the regulation HRG → ERBB1. Olayioye <italic>et al.</italic> (<xref ref-type="bibr" rid="B23">1999</xref>) showed that HRG is an activator of the ERBB-Dimers 1/3 and 1/4, which supported this result. Activation of ERBB2 by EGF or HRG could be found in Jones <italic>et al.</italic> (<xref ref-type="bibr" rid="B10">1999</xref>) (EGF/HRG → ERBB2/3), which also supported activation of PKCα by HRG through the cascade HRG → ERBB2 → PKCα, since crosstalk between ERBB2 and PKCα in ERBB2 overexpressing breast cancer cells was reported by Magnifico <italic>et al.</italic> (<xref ref-type="bibr" rid="B17">2007</xref>). The result was further interesting, since our HCC1954 cells overexpress ERBB2. Kim <italic>et al.</italic> (<xref ref-type="bibr" rid="B11">2009</xref>) reported activation of p38 by ERBB2 in ERBB2 overexpressing breast cancer cells, reflected in our activation EGF → p38. The activations of MEK1/2, ERK1/2 and p70S6K by EGF are key elements in the classical MAPK signalling cascade EGF → ERBB1/1 → GRB2 → SOS1 → RAS → RAF1 → MEK1/2 → ERK1/2 → p70S6K. EGF → ERBB1/1 → PLCγ was shown by Kim <italic>et al.</italic> (<xref ref-type="bibr" rid="B12">1990</xref>), which demonstrated the relevance of the activation EGF → PLCγ in our network. Further EGF → AKT ⊣ GSK3α is found in the cascade EGF → ERBB → GRB2 → GAB1 → PI3K → AKT ⊣ GSK3α.
<fig id="F5" position="float"><label>Fig. 5.</label><caption><p>Network reconstructed from HCC1954 data. Interactions found in the literature are marked as thick lines. Dark nodes mark the input stimuli. The numbers at the edges show the proportion of networks in the final GA population, in which the respective edge was contained.</p></caption><graphic xlink:href="btq385f5"/></fig></p>
      <p>More hypothetical interactions included the inferred SRC activation (ERBB3 → SRC), interpreted as activation of SRC by ERBB2 (see e.g. Luttrell <italic>et al.</italic>, <xref ref-type="bibr" rid="B16">1994</xref>; Mao <italic>et al.</italic>, <xref ref-type="bibr" rid="B18">1997</xref>; Xian <italic>et al.</italic>, <xref ref-type="bibr" rid="B35">1997</xref>) through the ERBB2/3 heterodimer. Finally, PDK1 activation by receptor tyrosine kinases was shown by Cohen <italic>et al.</italic> (<xref ref-type="bibr" rid="B2">1997</xref>) in insulin signalling. We found the activation ERBB3 → PDK1, which supported the hypothesis that the cascade ERBB1/3 → PI3K → PIP3 → PDK1 (see Oda <italic>et al.</italic>, <xref ref-type="bibr" rid="B22">2005</xref>; Vanhaesebroeck <italic>et al.</italic>, <xref ref-type="bibr" rid="B33">1997</xref>) might also play a role in cancer-related signal transduction processes.</p>
      <p>All of these inferred and literature confirmed interactions had high support by our data (occurrence in &gt;75% of all networks in the final population, see edge labels in <xref ref-type="fig" rid="F5">Figure 5</xref>). Our findings showed that literature knowledge was reproduced well by our method and in addition allowed for discussion of the newly inferred interactions. However, there were cases, where interactions would have been expected, but were not found in the network. For example, in the classical MAPK cascade, MEK1/2 phosphorylates ERK1/2 directly. In our network, the interaction between MEK1/2 and ERK1/2 was not found, but only direct activations of the two proteins by EGF. The reason was that we only measured phosphorylation at time points 8 and 12 min. Activation of MEK1/2 and ERK1/2 is expected around 10 min after stimulation, but in our data we saw peaks for both proteins at the 12 min time point. Thus, we could not resolve this cascade at a higher resolution. Another problem arised when proteins of a signalling cascade were not measured on the array, as seen, for example, for several of the components in the MAPK cascade (e.g. RAS, RAF, etc.). So even if a direct edge between two proteins is found, it has to be carefully assessed whether this edge is a direct influence or an indirect interaction over multiple intermediate steps. Our data only represents the abundance of phosphorylated protein in the cells, which might increase or decrease in response to a ligand. All interactions from such data are abstract influences between two proteins that have to be validated in further experiments. However, considering these kind of caveats and performing careful interpretation of the results makes our method suitable for the generation of reasonable hypotheses on signalling cascades.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC4">
    <title>4 CONCLUSION</title>
    <p>In this work, we showed a novel approach for the reconstruction of signalling networks from high-throughput proteomics data generated on RPPAs. The phosphorylation of 16 proteins related to ERBB signalling in human breast cancer was measured after three different stimulations (EGF, HRG, EGF+HRG). We devised a method that describes the signalling dynamics in a discretized way and infers the most likely series of activation states for all proteins at each time point given a candidate network by using an HMM. A likelihood model was set up to describe the goodness of fit of our measurements for a particular candidate network. To find a best fitting network, the space of possible network hypotheses is searched by a GA. We tested our method on simulated data and found good performance for the reconstruction of given networks, and improved performance over two other DBN approaches that were suitable for analysing our kind of data. Finally, we used our method to infer a signalling network from real protein phosphorylation measurements, generated by RPPAs for cell lysates from the human breast cancer cell line HCC1954. We successfully identified parts of signalling cascades, as they could be found in the literature, in particular from the MAPK and AKT signalling cascades, with some interactions originally found in ERBB2 overexpressing breast cancers (e.g. HRG→ PKCα). As new technologies such as RPPAs arise that make parallel measurement of larger numbers of proteins feasible, the need for suitable methods for the analysis of this kind of data is apparent. Our method aims precisely at this niche and gives an example for upcoming systems proteomics methodology.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank Anika Joecker, Maria Fälth, Stephan Gade, Marc Johannes and Alexander Kerner for proofreading the manuscript. We also thank Dirk Ledwinka for technical support.</p>
    <p><italic>Funding</italic>: The Helmholtz Alliance on Systems Biology network SB-Cancer, through the German Federal Ministry of Education and Science (BMBF) project BreastSys in the platform Medical Systems Biology; the network IG Cellular Systems Genomics (01GS0864) in the platform NGFNplus; the Clinical Research Group 179 through the German Research Foundation.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akutsu</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of genetic networks from a small number of gene expression patterns under the Boolean network model</article-title>
        <source>Pac. Symp. Biocomput.</source>
        <year>1999</year>
        <fpage>17</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="pmid">10380182</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cohen</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PDK1, one of the missing links in insulin signal transduction?</article-title>
        <source>FEBS Lett.</source>
        <year>1997</year>
        <volume>410</volume>
        <fpage>3</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">9247112</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Biological Sequence Analysis</source>
        <year>1998</year>
        <edition>1</edition>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Using Bayesian networks to analyze expression data</article-title>
        <source>J. Comput. Biol.</source>
        <year>2000</year>
        <volume>7</volume>
        <fpage>601</fpage>
        <lpage>620</lpage>
        <pub-id pub-id-type="pmid">11108481</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fröhlich</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Estimating large scale signaling networks through nested effect models with intervention effects from microarray data</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>2650</fpage>
        <lpage>2656</lpage>
        <pub-id pub-id-type="pmid">18227117</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fröhlich</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deterministic effects propagation networks for reconstructing protein signaling networks from multiple interventions</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>322</fpage>
        <pub-id pub-id-type="pmid">19814779</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geier</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reconstructing gene-regulatory networks from time series, knock-out data and prior knowledge</article-title>
        <source>BMC Syst. Biol.</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>11</fpage>
        <pub-id pub-id-type="pmid">17408501</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Heckerman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A tutorial on learning with Bayesian networks</article-title>
        <source>Innovations in Bayesian Networks</source>
        <year>1996</year>
        <publisher-loc>Berlin/Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>33</fpage>
        <lpage>82</lpage>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imoto</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Estimation of genetic networks and functional structures between genes by using Bayesian networks and nonparametric regression</article-title>
        <source>Pac. Symp. Biocomput.</source>
        <year>2002</year>
        <fpage>175</fpage>
        <lpage>186</lpage>
        <pub-id pub-id-type="pmid">11928473</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>JT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Binding specificities and affinities of EGF domains for ErbB receptors</article-title>
        <source>FEBS Lett.</source>
        <year>1999</year>
        <volume>447</volume>
        <fpage>227</fpage>
        <lpage>231</lpage>
        <pub-id pub-id-type="pmid">10214951</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>I-Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Overexpression of ErbB2 induces invasion of MCF10A human breast epithelial cells via MMP-9</article-title>
        <source>Cancer Lett.</source>
        <year>2009</year>
        <volume>275</volume>
        <fpage>227</fpage>
        <lpage>233</lpage>
        <pub-id pub-id-type="pmid">19022565</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>JW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tyrosine residues in bovine phospholipase C-gamma phosphorylated by the epidermal growth factor receptor in vitro</article-title>
        <source>J. Biol. Chem.</source>
        <year>1990</year>
        <volume>265</volume>
        <fpage>3940</fpage>
        <lpage>3943</lpage>
        <pub-id pub-id-type="pmid">1689310</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lébre</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Inferring dynamic genetic networks with low order independencies</article-title>
        <source>Stat. Appl. Genet. Mol. Biol.</source>
        <year>2009</year>
        <volume>8</volume>
        <comment>Article 9</comment>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loebke</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Infrared-based protein detection arrays for quantitative proteomics</article-title>
        <source>Proteomics</source>
        <year>2007</year>
        <volume>7</volume>
        <fpage>558</fpage>
        <lpage>564</lpage>
        <pub-id pub-id-type="pmid">17309101</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantitation of protein on gels and blots by infrared fluorescence of coomassie blue and fast green</article-title>
        <source>Anal. Biochem.</source>
        <year>2006</year>
        <volume>350</volume>
        <fpage>233</fpage>
        <lpage>238</lpage>
        <pub-id pub-id-type="pmid">16336940</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luttrell</surname>
            <given-names>DK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Involvement of pp60c-src with two major signaling pathways in human breast cancer</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>1994</year>
        <volume>91</volume>
        <fpage>83</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="pmid">7506422</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Magnifico</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Protein kinase calpha determines HER2 fate in breast carcinoma cells with HER2 protein overexpression without gene amplification</article-title>
        <source>Cancer Res.</source>
        <year>2007</year>
        <volume>67</volume>
        <fpage>5308</fpage>
        <lpage>5317</lpage>
        <pub-id pub-id-type="pmid">17545611</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mao</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Activation of c-Src by receptor tyrosine kinases in human colon cancer cells with high metastatic potential</article-title>
        <source>Oncogene</source>
        <year>1997</year>
        <volume>15</volume>
        <fpage>3083</fpage>
        <lpage>3090</lpage>
        <pub-id pub-id-type="pmid">9444956</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Markowetz</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Non-transcriptional pathway features reconstructed from secondary effects of RNA interference</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>4026</fpage>
        <lpage>4032</lpage>
        <pub-id pub-id-type="pmid">16159925</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Murphy</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mian</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Modelling gene expression data using dynamic Bayesian networks</article-title>
        <source>Technical report</source>
        <year>1999</year>
        <publisher-loc>Berkeley</publisher-loc>
        <publisher-name>University of California</publisher-name>
      </element-citation>
    </ref>
    <ref id="B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nelander</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Models from experiments: combinatorial drug perturbations of cancer cells</article-title>
        <source>Mol. Syst. Biol.</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>216</fpage>
        <pub-id pub-id-type="pmid">18766176</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oda</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comprehensive pathway map of epidermal growth factor receptor signaling</article-title>
        <source>Mol. Syst. Biol.</source>
        <year>2005</year>
        <volume>1</volume>
        <comment>2005.0010</comment>
      </element-citation>
    </ref>
    <ref id="B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olayioye</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ErbB receptor-induced activation of stat transcription factors is mediated by Src tyrosine kinases</article-title>
        <source>J. Biol. Chem.</source>
        <year>1999</year>
        <volume>274</volume>
        <fpage>17209</fpage>
        <lpage>17218</lpage>
        <pub-id pub-id-type="pmid">10358079</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pe'er</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inferring subnetworks from perturbed expression profiles</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <issue>Suppl. 1</issue>
        <fpage>S215</fpage>
        <lpage>S224</lpage>
        <pub-id pub-id-type="pmid">11473012</pub-id>
      </element-citation>
    </ref>
    <ref id="B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rau</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An empirical Bayesian method for estimating biological networks from temporal microarray data</article-title>
        <source>Stat. Appl. Genet. Mol. Biol.</source>
        <year>2010</year>
        <volume>9</volume>
        <comment>Article 9</comment>
      </element-citation>
    </ref>
    <ref id="B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sachs</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Causal protein-signaling networks derived from multiparameter single-cell data</article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>308</volume>
        <fpage>523</fpage>
        <lpage>529</lpage>
        <pub-id pub-id-type="pmid">15845847</pub-id>
      </element-citation>
    </ref>
    <ref id="B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Estimating the dimension of a model</article-title>
        <source>Ann. Stat.</source>
        <year>1978</year>
        <volume>6</volume>
        <fpage>461</fpage>
        <lpage>464</lpage>
      </element-citation>
    </ref>
    <ref id="B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segal</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Learning module networks</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>557</fpage>
        <lpage>588</lpage>
      </element-citation>
    </ref>
    <ref id="B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Slamon</surname>
            <given-names>DJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human breast cancer: correlation of relapse and survival with amplification of the HER-2/neu oncogene</article-title>
        <source>Science</source>
        <year>1987</year>
        <volume>235</volume>
        <fpage>177</fpage>
        <lpage>182</lpage>
        <pub-id pub-id-type="pmid">3798106</pub-id>
      </element-citation>
    </ref>
    <ref id="B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Slamon</surname>
            <given-names>DJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Studies of the HER-2/neu proto-oncogene in human breast and ovarian cancer</article-title>
        <source>Science</source>
        <year>1989</year>
        <volume>244</volume>
        <fpage>707</fpage>
        <lpage>712</lpage>
        <pub-id pub-id-type="pmid">2470152</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Spieth</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparing evolutionary algorithms on the problem of network inference</article-title>
        <source>Proceedings of the Genetic and Evolutionary Computation Conference.</source>
        <year>2006</year>
        <publisher-loc>Seattle, Washington</publisher-loc>
      </element-citation>
    </ref>
    <ref id="B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tegner</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reverse engineering gene networks: integrating genetic perturbations with dynamical modeling</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>5944</fpage>
        <lpage>5949</lpage>
        <pub-id pub-id-type="pmid">12730377</pub-id>
      </element-citation>
    </ref>
    <ref id="B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vanhaesebroeck</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phosphoinositide 3-kinases: a conserved family of signal transducers</article-title>
        <source>Trends Biochem. Sci.</source>
        <year>1997</year>
        <volume>22</volume>
        <fpage>267</fpage>
        <lpage>272</lpage>
        <pub-id pub-id-type="pmid">9255069</pub-id>
      </element-citation>
    </ref>
    <ref id="B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wahde</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hertz</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Coarse-grained reverse engineering of genetic regulatory networks</article-title>
        <source>Biosystems</source>
        <year>2000</year>
        <volume>55</volume>
        <fpage>129</fpage>
        <lpage>136</lpage>
        <pub-id pub-id-type="pmid">10745116</pub-id>
      </element-citation>
    </ref>
    <ref id="B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xian</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Activation of erbB2 and c-src in phorbol ester-treated mouse epidermis: possible role in mouse skin tumor promotion</article-title>
        <source>Oncogene</source>
        <year>1997</year>
        <volume>14</volume>
        <fpage>1435</fpage>
        <lpage>1444</lpage>
        <pub-id pub-id-type="pmid">9136987</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
