<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7430844</article-id>
    <article-id pub-id-type="pmid">32795263</article-id>
    <article-id pub-id-type="publisher-id">3703</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03703-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SQMtools: automated processing and visual analysis of ’omics data with R and anvi’o</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6341-3692</contrib-id>
        <name>
          <surname>Puente-Sánchez</surname>
          <given-names>Fernando</given-names>
        </name>
        <address>
          <email>fpusan@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>García-García</surname>
          <given-names>Natalia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tamames</surname>
          <given-names>Javier</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.428469.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1794 1018</institution-id><institution>Systems Biology Department, </institution><institution>Centro Nacional de Biotecnología (CNB-CSIC), </institution></institution-wrap>C/ Darwin n° 3, Campus de Cantoblanco, 28049 Madrid, Spain </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>358</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>4</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The dramatic decrease in sequencing costs over the last decade has boosted the adoption of high-throughput sequencing applications as a standard tool for the analysis of environmental microbial communities. Nowadays even small research groups can easily obtain raw sequencing data. After that, however, non-specialists are faced with the double challenge of choosing among an ever-increasing array of analysis methodologies, and navigating the vast amounts of results returned by these approaches.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here we present a workflow that relies on the SqueezeMeta software for the automated processing of raw reads into annotated contigs and reconstructed genomes (bins). A set of custom scripts seamlessly integrates the output into the anvi’o analysis platform, allowing filtering and visual exploration of the results. Furthermore, we provide a software package with utility functions to expose the SqueezeMeta results to the R analysis environment.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Altogether, our workflow allows non-expert users to go from raw sequencing reads to custom plots with only a few powerful, flexible and well-documented commands.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Metagenomics</kwd>
      <kwd>Metatranscriptomics</kwd>
      <kwd>Microbial ecology</kwd>
      <kwd>Automatic</kwd>
      <kwd>Pipeline</kwd>
      <kwd>Visualization</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100010198</institution-id>
            <institution>Ministerio de Economía, Industria y Competitividad, Gobierno de España</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CTM2016-80095-C2-1-R</award-id>
        <award-id>PID2019-110011RB-C31</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tamames</surname>
            <given-names>Javier</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100014440</institution-id>
            <institution>Ministerio de Ciencia, Innovación y Universidades</institution>
          </institution-wrap>
        </funding-source>
        <award-id>IJC2018-035180-I</award-id>
        <award-id>SEV-2013-0347-17-2</award-id>
        <principal-award-recipient>
          <name>
            <surname>Puente-Sánchez</surname>
            <given-names>Fernando</given-names>
          </name>
          <name>
            <surname>García-García</surname>
            <given-names>Natalia</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par12">The advent of high-throughput sequencing technologies in 2008 made it possible to directly sequence the different microbial genomes present in a given sample (metagenomics) as well as measuring the expression profiles of those genomes (metatranscriptomics) in a culture-independent manner. This supposed a revolution in the field of microbial ecology, as it allowed to profile the taxonomic composition and functional potential of microbial communities [<xref ref-type="bibr" rid="CR1">1</xref>] and eventually to recover full genomes from environmental bacteria that in some cases could not be studied by other means [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par13">Current sequencing costs (as of the end of 2019) are around 0.01$ per Megabase of DNA [<xref ref-type="bibr" rid="CR3">3</xref>], which have led to the popularization of metagenomics as a powerful and affordable tool to study microbial communities. In parallel, access to the required high-performance computing infrastructures is becoming more common, either via academic institutions or other government agencies. The democratization in the use of meta’omics is however hindered by the inherent complexity of high-throughput sequencing results, which need to be processed and analysed by specialized personnel. Life science graduates might lack training in advanced data science skills [<xref ref-type="bibr" rid="CR4">4</xref>], and while large research groups might be able to hire one or more dedicated bioinformaticians, this is often not the case for smaller groups. There is thus a need for tools that allow life science researchers to reliably analyse meta’omics data with minimal training. Such tools should provide interfaces that relieve users from the burden of processing large amounts of data, while still giving them enough freedom to pose and answer biologically meaningful questions.</p>
    <p id="Par14">A standard metagenomics workflow comprises assembling shotgun reads into contigs, predicting genes on such contigs, taxonomically and functionally classifying contigs and genes, and estimating contig and gene abundances by mapping the shotgun reads back to the assembly. Optionally, contigs can be combined into metagenome-assembled genomes (MAGs) or bins. This workflow is rather straightforward and thus amenable to be combined into a single pipeline that runs on sensible parameters with minimal user intervention. We recently implemented this concept in the SqueezeMeta pipeline for the automated analysis of metagenomes and metatranscriptomes [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par15">Once a metagenome has been processed, users face a second challenge, which is simply to navigate the vast amount of results. A standard-sized metagenome can contain from hundreds of thousands to millions of contigs, each coming from different organisms and containing different functions. Thus, even if results are already presented in a human-readable form (e.g. tables), their sheer size prevents non-experts from extracting the required information.</p>
    <p id="Par16">In this work, we seek to eliminate this problem by proposing an integrated workflow that takes care of all the steps of data processing and formatting, allowing users to easily propose and answer scientifically meaningful questions using their metagenomics/metatranscriptomics data. To achieve this, we here present a set of tools that seamlessly integrate the output of the SqueezeMeta pipeline with the anvi’o interactive visualization platform [<xref ref-type="bibr" rid="CR6">6</xref>] and the R environment for statistical analysis [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par17">Anvi’o enables the interactive exploration of (meta) genomic data, and excels at bin refinement, but will struggle when trying to display a large number (i.e. millions) of contigs at the same time. For that, we provide a custom search engine that prefilters the data before launching the anvi’o interactive session. This engine allows users to input complex queries for selecting the contigs to be displayed based on their taxonomy, functional annotation and abundance across the different samples.</p>
    <p id="Par18">Additionally, we here describe the SQMtools R package, which automatically loads the different results generated by a SqueezeMeta run (e.g. contigs and gene sequences and annotations, aggregated functional and taxonomic profiles, binning results …) and exposes them as a single R object that can be then explored with a set of nine simple yet powerful functions. For example, users with no prior knowledge of the R programming language can easily generate a heatmap that displays the most abundant functions present in a taxa of interest across a set of samples, a barplot with the distribution of a given function across taxa in their metagenomes, or export a subset of their results into a spreadsheet. Furthermore, data loaded with the SQMtools package can be readily used with other popular analysis packages in microbial ecology, such as the DESeq2 package for differential abundance analysis [<xref ref-type="bibr" rid="CR8">8</xref>], the vegan package for multivariate analysis [<xref ref-type="bibr" rid="CR9">9</xref>], or the caret package for machine learning [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par19">To illustrate the utility and features of SQMtools, we used SqueezeMeta to analyse a set of 16 human gut metagenomes from two different populations with different lifestyles: urban-living Italian adult and hunter-gatherers from the Hadza people (Supplementary Table S<xref rid="MOESM1" ref-type="media">1</xref> [<xref ref-type="bibr" rid="CR11">11</xref>];). We were interested in identifying taxonomic and functional differences between the microbiomes of both populations. To that end, we loaded the data into R using the SQMtools package, and analysed it using the workflow illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref> and detailed in the <xref rid="MOESM1" ref-type="media">Supplementary Material</xref> (which includes all the code necessary to generate the figures in this article, and other examples showing additional features). We also show how to expose the data to other R packages such as vegan in order to perform more advanced analyses. Finally, we use anvi’o to visually explore subsets of the metagenomes, as well as the bins obtained by the SqueezeMeta pipeline.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Main workflow of the SQMtools pipeline. Raw reads are processed automatically by SqueezeMeta, which integrates assembly, ORF prediction, annotation and binning. The results can then be easily filtered and explored either with R (by creating a SQM object) or anvi’o (by creating an anvi’o database) in order to produce custom plots with the information of interest. Arrows correspond to function calls (e.g. going from raw reads to a krona chart would involve three function calls). The workflow is exemplified in detail in the <xref rid="MOESM1" ref-type="media">Supplementary Information</xref></p></caption><graphic xlink:href="12859_2020_3703_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par20">Briefly the SQMtools contains the following types of functions:
<list list-type="bullet"><list-item><p id="Par21">Load functions: load all the data generated by SqueezeMeta (sequences, annotations, bins, aggregated functional and taxonomic profiles) into a single R object (SQM object), whose structure is described in Supplementary Table S<xref rid="MOESM1" ref-type="media">2</xref>, and which will be used by the rest of the main functions in the SQMtools package.</p></list-item><list-item><p id="Par22">Subset functions: generate a new SQM object containing a subset of functions, taxa, or bins of the parent SQM object.</p></list-item><list-item><p id="Par23">Combine functions: generate a new SQM object aggregating the data from two or more SQM objects.</p></list-item><list-item><p id="Par24">Plot functions: make different R plots from the data (taxonomy, functions …) contained in a SQM object.</p></list-item><list-item><p id="Par25">Export functions: create files (krona charts, KEGG pathway maps, tables …) from the data contained in a SQM object.</p></list-item></list></p>
    <p id="Par26">A general overview of the genus-level composition of the samples is presented in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a. Samples from Hadza individuals contain higher amounts of <italic>Prevotella</italic> (red), while samples from Italians contain higher amounts of <italic>Bacteroides</italic> (light blue). Non-metric multidimensional scaling (NMDS) coupled to Permutational Multivariate Analysis of Variance shows that Hadza and Italian gut metagenomes can be clearly differentiated (<italic>p</italic> &lt; 0.005) in terms of their taxonomic (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) and functional (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c) compositions.
<fig id="Fig2"><label>Fig. 2</label><caption><p>General overview of the example dataset. <bold>a</bold> Genus-level taxonomic composition of the Hadza (blue) and Italian (orange) samples, as depicted by the SQMtools package. <bold>b, c</bold> Non-metric multidimensional scaling (NMDS) showing the clustering of Hadza vs Italian samples based on their (<bold>b</bold>) genus-level taxonomy and (<bold>c</bold>) KEGG orthology functional profiling. Differences between clusters were significant (Permutational Multivariate Analysis of Variance <italic>p</italic> &lt; 0.005)</p></caption><graphic xlink:href="12859_2020_3703_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par27">We then show how SQMtools can be used to explore an individual metabolic pathway, in this case the biosynthesis of aromatic amino acids. Figure <xref rid="Fig3" ref-type="fig">3</xref>a shows the KEGG pathway map, with colours indicating whether a reaction was more present in the Hadza (blue) or Italian (orange) samples. As reported by Rampelli et al. [<xref ref-type="bibr" rid="CR11">11</xref>], dietary differences result in the Hadza microbiome being enriched in functions related to the biosynthesis of Phenylalanine and Tyrosine (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, box), in particular the transaminase <italic>tyrB</italic> / K00832 / EC:2.6.1.57 catalysing the biosynthesis of the common intermediary L-arogenate. Figure <xref rid="Fig3" ref-type="fig">3</xref>b shows an anvi’o visualization obtained with the <italic>anvi-filter.py</italic> script, containing the taxonomy and distribution across samples of the contigs containing genes related to the biosynthesis of aromatic amino acids. The pathway is present in <italic>Prevotella</italic> for the Hadza samples (blue colored rings) and in <italic>Bacteroides</italic> for the Italian samples (orange colored rings), consistently with the taxonomic distribution presented in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a. Note that, when executed by the user, this visualization would appear in a browser window, and could be explored interactively. Finally, the abundance of individual KEGG orthology groups in each sample is presented as a heatmap in Fig. <xref rid="Fig3" ref-type="fig">3</xref>c.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Detailed overview of the biosynthesis of aromatic amino acids. <bold>a</bold> KEGG pathway map for Phenylalanine, Tyrosine and Tryptophan biosynthesis. Reactions are coloured based on the log2 fold-change of their average copy numbers in Italian (orange) vs Hadza (blue) samples. Asterisks indicated reactions performed by KEGG orthologs that were significantly enriched in Hadza (blue) or Italian (orange) samples (DESeq2 <italic>p adj.</italic> &lt; 0.05). Black asterisks indicate reactions in which a different KEGG ortholog was enriched in Hadza and Italian samples (note that the same reaction can be performed by more than one KEGG ortholog). Asterisks within parentheses indicate reactions in which some, but not all KEGG orthologs were significantly enriched in a group. <bold>b</bold> anvi’o plot showing the taxonomy and distribution across samples of the contigs containing genes related to the biosynthesis of aromatic amino acids. <bold>c</bold> Heatmap depicting the TPM across samples of selected KEGG orthologs related to the biosynthesis of aromatic amino acids. Asterisks indicate significant enrichment in Hadza or Italian samples as described above</p></caption><graphic xlink:href="12859_2020_3703_Fig3_HTML" id="MO3"/></fig></p>
    <p id="Par28">Finally, Fig. <xref rid="Fig4" ref-type="fig">4</xref> shows the weight (in percentage of total reads) and taxonomic distribution of six broad functional categories across the different samples. Some taxa, like <italic>Prevotella</italic> (red) and <italic>Bacteroides</italic> (light blue), seem capable of metabolizing a large array of carbohydrates, while others, like <italic>Bifidobacterium (</italic>dark blue), seem for the most part limited to a few substrates.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Taxonomic distribution of selected functions. Barplots showing the weight (in percentage of total reads) and taxonomic distribution of six broad functional categories across the different samples</p></caption><graphic xlink:href="12859_2020_3703_Fig4_HTML" id="MO4"/></fig></p>
    <p id="Par29">Overall, our results agree well with those presented by Rampelli et al. [<xref ref-type="bibr" rid="CR11">11</xref>]. Except for minor post-processing additions (e.g. adding titles, coloured axes labels, etc) all the plots presented in Figs. <xref rid="Fig2" ref-type="fig">2</xref>, <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref> can be generated by novice users with only a few commands, which illustrates the potential of this approach.</p>
  </sec>
  <sec id="Sec3">
    <title>Discussion</title>
    <p id="Par30">There are several software packages for the analysis and visualization of metagenomic data, with MEGAN [<xref ref-type="bibr" rid="CR12">12</xref>] or STAMP [<xref ref-type="bibr" rid="CR13">13</xref>] being among the most popular. Our workflow differentiates from them in that 1) it covers all the steps of the analysis, from raw reads to custom figures and statistics and 2) results can be effortlessly loaded into the R analysis environment, where they can be explored with a set of convenience functions included in the SQMtools package, but also directly analysed with other tools from the R ecosystem.</p>
    <p id="Par31">SQMtools provides different ways to look at the abundance of orfs, contigs, bins, taxa and functions in the metagenome (Table <xref rid="Tab1" ref-type="table">1</xref>). In addition to read and base counts, which have a straightforward interpretation, we also provide TPM and copy numbers in order to take into account both sequencing depth and feature length. The TPM (transcripts per million) metric was introduced by Wagner et al. [<xref ref-type="bibr" rid="CR14">14</xref>] as an improved way to account for gene length and sequencing depth in transcriptomic experiments: we find it equally useful in metagenomics. The TPM of a feature (be it a transcript, a gene or a functional category) is the number of times that we would find that feature when randomly sampling 1 million features, given the abundances of the different features in our sample. As an alternative to TPM, we also provide copy numbers, calculated as the ratio between the coverage of function of interest and the coverage of the RecA/RadA recombinase universal single-copy gene. By default, the <italic>subsetTax</italic> and <italic>subsetBins</italic> functions will rescale TPM and copy numbers so that the resulting values relate to the taxa present in the subset, rather than to the whole metagenome (e.g. copy number of a function per genome <italic>of the selected taxa</italic>). Details on the interpretation of those values in the different subsets are shown in Table <xref rid="Tab1" ref-type="table">1</xref>.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Abundance metrics included in SQMtools and their interpretation in the full metagenome and in taxonomic and functional subsets</p></caption><table frame="hsides" rules="groups"><thead><tr><th colspan="2"/><th>Functions / Taxonomy</th><th colspan="2">Functions</th><th>Taxonomy</th></tr><tr><th/><th>Scaling method</th><th>Abund</th><th>TPM</th><th>Copy number</th><th>Percent</th></tr></thead><tbody><tr><td/><td><bold>Calculation</bold></td><td>Reads per function or taxon</td><td>10<sup>6</sup> × reads per kilobase of each function / total reads per kilobase of all functions</td><td><p>Coverage of function /</p><p>Coverage of RecA</p></td><td>100 × reads per taxon / Total reads</td></tr><tr><td><bold>Full data</bold></td><td><bold>Interpretation in the full data</bold></td><td>Reads from each function or taxon in the whole metagenome</td><td>Genes from each function per million genes in the whole metagenome</td><td>Average copies of each function per genome in the whole metagenome</td><td>Percentage of each taxonomic group in the whole metagenome</td></tr><tr><td rowspan="2"><bold>subsetTax/subsetBin</bold></td><td><bold>Rescaled in the new subset?</bold></td><td>Not applicable</td><td>Yes, by taxonomy</td><td>Yes, by taxonomy</td><td>No</td></tr><tr><td><bold>Interpretation in the subset</bold></td><td>Reads from each function or taxon in the selected taxon or bin</td><td>Genes from each function per miIlion genes in the selected taxon or bin</td><td>Average copies of the function per genome from the selected taxon or bin</td><td>Percentage of each of the selected taxonomic groups in the whole metagenome</td></tr><tr><td rowspan="2"><bold>subsetFun</bold></td><td><bold>Rescaled in the new subset?</bold></td><td>Not applicable</td><td>No</td><td>No</td><td>No</td></tr><tr><td><bold>Interpretation in the subset</bold></td><td>Reads from each function or taxon in the subset</td><td>Genes from each function in the subset per million genes in the metagenome</td><td>Average copies per genome of the functions in the subset per genome in the metagenome</td><td>Percentage of each taxonomic group in the whole metagenome, counting only the reads assigned to the functions in the subset</td></tr></tbody></table></table-wrap></p>
    <p id="Par32">Note that TPMs are based on proportions calculated over an arbitrary count total (in this case, the number of reads sequenced per sample) and as such are compositional (see [<xref ref-type="bibr" rid="CR15">15</xref>] for a detailed discussion on the problem and its implications). For visualization/exploration purposes, we often find it useful to compare TPMs from different samples (e.g. in Fig. <xref rid="Fig3" ref-type="fig">3</xref>c) but in general statistical tests should be performed using raw reads and composition-aware methods [<xref ref-type="bibr" rid="CR15">15</xref>]. Copy numbers, on the other hand, are ratios and should be less affected by compositionality issues [<xref ref-type="bibr" rid="CR16">16</xref>]. We nonetheless still recommend caution when performing statistical tests. The debate over the best way to analyse microbiome data is still ongoing (see e.g. two alternative avenues in [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]) and older methods such as DESeq2 might still outperform composition-aware methods for some applications (see <xref rid="Sec5" ref-type="sec">Methods</xref>). In SQMtools, we provide common normalizations that can facilitate data exploration as well as the raw abundance data required to perform more advanced analyses, but we do not promote any particular statistical method as we expect the field to continue evolving.</p>
  </sec>
  <sec id="Sec4">
    <title>Conclusions</title>
    <p id="Par33">While many tools for metagenomics are available [<xref ref-type="bibr" rid="CR19">19</xref>], to our knowledge we are the first to provide a robust, comprehensive and well-curated software suite covering all the steps of the analysis. This ensures full compatibility between the different included tools, and facilitates installation (a single instruction if using the conda package manager). Integration with R and anvi’o is effortless, relieving the users from the burden of parsing the complex output files that are common to metagenomic studies. Overall, our workflow allows non-expert users to go from raw sequencing reads to custom plots with only a few powerful, flexible and well-documented commands, while also facilitating the incorporation of more advanced statistical methods to their analyses.</p>
  </sec>
  <sec id="Sec5">
    <title>Methods</title>
    <sec id="Sec6">
      <title>Software implementation</title>
      <p id="Par34">The SqueezeMeta to anvi’o interface is implemented in python3, and consists of two scripts. Firstly, the <italic>anvi-load-sqm.py</italic> script will parse a whole SqueezeMeta project (annotated orfs, contigs and bins) into anvi’o [<xref ref-type="bibr" rid="CR6">6</xref>], generating databases that can be directly used with the <italic>anvi-interactive</italic> or <italic>anvi-refine</italic> tools from the anvi’o suite. Secondly, the <italic>anvi-filter-sqm.py</italic> integrates a search engine for prefiltering the data before launching the anvi’o interactive session. The SQM to R interface is implemented in the SQMtools R package, which contains several utility functions. The main components of the package are described in the next four sections. All analyses were performed using SqueezeMeta v1.1.1 and SQMtools v0.4.5.</p>
    </sec>
    <sec id="Sec7">
      <title>The SQM object</title>
      <p id="Par35">The SQM object is a custom R object (implemented as a S3 class) which contain all the relevant information from a metagenomic experiment (orf, contig and bin annotations, aggregated taxonomic and functional profiles, etc). The formal structure of the SQM object is defined in Supplementary Table S<xref rid="MOESM1" ref-type="media">2</xref>. The <italic>loadSQM</italic> function from the SQMtools package will create a SQM folder by reading and parsing the results directory generated by the SqueezeMeta pipeline [<xref ref-type="bibr" rid="CR5">5</xref>]. The SQM object can then be explored by a set of utility functions included in the SQMtools package (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Alternatively, expert users can directly access its content in order to perform custom analyses.</p>
    </sec>
    <sec id="Sec8">
      <title>Normalization of sequencing data</title>
      <p id="Par36">For individual orfs, contigs and bins, we provide the following abundance metrics: mapped read count, mapped base counts, and TPM. The TPM (transcripts per million) metric was introduced by Wagner et al. [<xref ref-type="bibr" rid="CR14">14</xref>] and its calculation is performed in two steps:
<list list-type="order"><list-item><p id="Par37">Obtain the RPK (reads per kilobase) of each feature, by dividing the number of mapped reads to that feature in that sample by the feature length in kilobases.</p></list-item><list-item><p id="Par38">Calculate the TPM of each feature by dividing its RPK by the sum of RPKs of all the features in that sample, and multiplying by a million.</p></list-item></list></p>
      <p id="Par39">For the sake of being consistent with previous works, we maintain the nomenclature “TPM”, even when use it to measure the abundances of features other than transcripts.</p>
      <p id="Par40">For functional categories, we provide the following abundance metrics: mapped read counts, mapped base counts, TPM and copy number. The TPM of a given functional category is calculated as described above. The reads mapping to genes from that category are aggregated and divided by the average length of the genes from that category in the assembly. Copy number is calculated by dividing the aggregated coverage of the genes from that functional category by the coverage of COG0468 to the RecA/RadA recombinase, which is a universal single copy gene. An alternative way of calculating copy numbers using the median coverage of 15 different Universal Single Copy Genes is also available and described in the <italic>USiCGs</italic> section of the SQMtools manual.</p>
    </sec>
    <sec id="Sec9">
      <title>The subset methods</title>
      <p id="Par41">The subset methods can be applied to every SQM object in order to generate smaller SQM objects containing the taxa or functions of interest. The <italic>subsetTax</italic> and <italic>subsetBins</italic> methods will select the contigs assigned to the requested taxon and bin, respectively, and the ORFs contained in those contigs. By default, they will rescale TPMs and copy numbers so that they are calculated with respect to the selected taxon/bins, rather than to the whole metagenome (Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
      <p id="Par42">The <italic>subsetFun</italic> method will directly select all the ORFs containing the requested functions. By default, functions are searched for by string matching against all the functional annotations. By default SqueezeMeta uses KEGG [<xref ref-type="bibr" rid="CR20">20</xref>], COG [<xref ref-type="bibr" rid="CR21">21</xref>] and PFAM [<xref ref-type="bibr" rid="CR22">22</xref>], but also allows users to include additional custom databases. Users can also search within the KEGG and COG functional hierarchies (e.g. “Phenylalanine, Tyrosine and Tryptophan biosynthesis”). Finally, users can search for functions using regular expressions instead of string matching by adding the parameter <italic>fixed = F</italic>.</p>
    </sec>
    <sec id="Sec10">
      <title>Figure generation</title>
      <p id="Par43">Heatmaps and barplots are generated using ggplot2. We also use KronaTools [<xref ref-type="bibr" rid="CR23">23</xref>] for generating Krona charts, and pathview [<xref ref-type="bibr" rid="CR24">24</xref>] for generating annotated KEGG pathway maps. Anvi’o plots were generated with anvi’o version 6.1 [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    </sec>
    <sec id="Sec11">
      <title>Multivariate and differential abundance analyses</title>
      <p id="Par44">Multivariate analysis was performed using the <italic>metaMDS</italic> and <italic>adonis</italic> functions from vegan version 2.5.6 [<xref ref-type="bibr" rid="CR9">9</xref>]. Differential abundance analysis was performed with DESeq2 version 1.24.0 [<xref ref-type="bibr" rid="CR8">8</xref>] using an adjusted <italic>p</italic>-value cutoff of 0.05. DESeq2 was chosen in this study as it was shown to have a good precision/recall balance in simulated datasets with 5 and 10, replicates per group [<xref ref-type="bibr" rid="CR25">25</xref>], which is close to our 8 replicates per cohort.</p>
    </sec>
    <sec id="Sec12">
      <title>Computational resources</title>
      <p id="Par45">All tests were ran in a server with a 24-core Intel Xeon E5–2620 v2 CPU at 2.10GHz / core and 256 Gb of RAM, using 12 processors. Under these conditions, SqueezeMeta (including assembly, annotation and binning of the 16 samples) ran in 113 h (c.a. 4 days and a half). Loading results into SQMtools took only a few minutes. Loading results into anvi’o took an additional 130 h (c.a. 5 days and a half).</p>
      <p id="Par46">Alternatively, we were also capable of running SqueezeMeta on the 16 samples in a laptop with an 8-core Intel Core i7 8750H CPU at 2.20 GHz / core, 16 Gb of RAM, and an extra 16 Gb of swap memory in a SSD disk. The process took 80 h. Results were loaded in SQMtools as described above, but we were unable to load them into anvi’o as the system ran out of memory, making the <italic>anvi-profile</italic> script to eventually stall.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec13">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3703_MOESM1_ESM.pdf">
            <caption>
              <p>
                <bold>Additional file 1.</bold>
              </p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MAG</term>
        <def>
          <p id="Par4">Metagenome-Assembled Genome</p>
        </def>
      </def-item>
      <def-item>
        <term>KEGG</term>
        <def>
          <p id="Par5">Kyoto Encyclopedia of Genes and Genomes</p>
        </def>
      </def-item>
      <def-item>
        <term>RPK</term>
        <def>
          <p id="Par6">Reads Per Kilobase</p>
        </def>
      </def-item>
      <def-item>
        <term>TPM</term>
        <def>
          <p id="Par7">Transcripts Per Million</p>
        </def>
      </def-item>
      <def-item>
        <term>COG</term>
        <def>
          <p id="Par8">Clusters of Orthologous Groups os proteins</p>
        </def>
      </def-item>
      <def-item>
        <term>PFAM</term>
        <def>
          <p id="Par9">Protein FAMilies database</p>
        </def>
      </def-item>
      <def-item>
        <term>Gb</term>
        <def>
          <p id="Par10">Gigabytes</p>
        </def>
      </def-item>
      <def-item>
        <term>GHz</term>
        <def>
          <p id="Par11">Gigahertzs</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Fernando Puente-Sánchez and Natalia García-García contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-03703-2.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Giuseppe D’Auria (FISABIO) for the initial contribution of the SQMtools – KronaTools interface. We acknowledge support of the publication fee by the CSIC Open Access Publication Support Initiative through its Unit of Information Resources for Research (URICI).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>FP-S and JT devised the package. FP-S designed and wrote the core SQMtools functions, FP-S and NG-G wrote the code involved in figure generation. All authors contributed to the SQM to anvi’o interface. FP-S and NG-G wrote the manuscript. The authors discussed the manuscript and approved the final version.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Computational resources were provided by the Spanish Ministry of Economy of Competitiveness grants CTM2016–80095-C2–1-R and PID2019-110011RB-C31. Study design, data analysis and data interpretation were supported by grants IJC2018–035180-I (awarded to F.P-S) and SEV-2013-0347-17-2 (Severo Ochoa program, awarded to N.G-G) from the Spanish Ministry of Science and Innovation. Publication fees were covered by grant IJC2018-035180-I and the CSIC Open Access Publication Support Initiative through its Unit of Information Resources for Research (URICI).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>SqueezeMeta and SQMtools are available under a GPL3 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/jtamames/SqueezeMeta">https://github.com/jtamames/SqueezeMeta</ext-link>. The raw datasets analysed during the current study are available in the NCBI repository, under BioProject PRJNA278393 (SRA Study: SRP056480; <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRP056480">https://www.ncbi.nlm.nih.gov/sra/?term=SRP056480</ext-link> [<xref ref-type="bibr" rid="CR11">11</xref>];).</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par47">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par48">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par49">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Environmental shotgun sequencing: its potential and challenges for studying the hidden world of microbes</article-title>
        <source>PLoS Biol</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>e82</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0050082</pub-id>
        <pub-id pub-id-type="pmid">17355177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pedrós-Alió</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Acinas</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Logares</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Massana</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>Marine microbial diversity as seen by high throughput sequencing</source>
        <year>2018</year>
        <publisher-loc>Hoboken</publisher-loc>
        <publisher-name>Wiley</publisher-name>
        <fpage>47</fpage>
        <lpage>98</lpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Wetterstrand KA. DNA Sequencing Costs: Data from the NHGRI Genome Sequencing Program (GSP) Available at: <ext-link ext-link-type="uri" xlink:href="http://www.genome.gov/sequencingcostsdata">www.genome.gov/sequencingcostsdata</ext-link>. Accessed 10/07/2020.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Attwood</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Blackford</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brazas</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>MV</given-names>
          </name>
        </person-group>
        <article-title>A global perspective on evolving bioinformatics and data science training needs</article-title>
        <source>Brief Bioinform</source>
        <year>2017</year>
        <volume>20</volume>
        <fpage>398</fpage>
        <lpage>404</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbx100</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tamames</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Puente-Sanchez</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>SqueezeMeta, a highly portable, fully automatic metagenomic analysis pipeline</article-title>
        <source>Front Microbiol</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>3349</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2018.03349</pub-id>
        <pub-id pub-id-type="pmid">30733714</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eren</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Esen</surname>
            <given-names>ÖC</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vineis</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Sogin</surname>
            <given-names>ML</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Anvi’o: an advanced analysis and visualization platform for ‘omics data</article-title>
        <source>PeerJ</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>e1319</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.1319</pub-id>
        <pub-id pub-id-type="pmid">26500826</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <source>R: a language and environment for statistical computing</source>
        <year>2013</year>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Oksanen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Blanchet</surname>
            <given-names>FG</given-names>
          </name>
          <name>
            <surname>Friendly</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kindt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Legendre</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McGlinn</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>Vegan: community ecology package, R package version 2.5–6</source>
        <year>2007</year>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhn</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Building predictive models in R using the caret package</article-title>
        <source>J Stat Softw</source>
        <year>2008</year>
        <volume>28</volume>
        <fpage>1</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v028.i05</pub-id>
        <pub-id pub-id-type="pmid">27774042</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rampelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schnorr</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Consolandi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Turroni</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Severgnini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Peano</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenome sequencing of the Hadza hunter-gatherer gut microbiota</article-title>
        <source>Curr Biol</source>
        <year>2015</year>
        <volume>25</volume>
        <fpage>1682</fpage>
        <lpage>1693</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2015.04.055</pub-id>
        <pub-id pub-id-type="pmid">25981789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Huson DH, Beier S, Flade I, Górska A, El-Hadidi M, Mitra S, et al. MEGAN community edition-interactive exploration and analysis of large-scale microbiome sequencing data. PLoS Comput Biol. 2016;12:e1004957.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Beiko</surname>
            <given-names>RG</given-names>
          </name>
        </person-group>
        <article-title>STAMP: statistical analysis of taxonomic and functional profiles</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>3123</fpage>
        <lpage>3124</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu494</pub-id>
        <pub-id pub-id-type="pmid">25061070</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Kin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lynch</surname>
            <given-names>VJ</given-names>
          </name>
        </person-group>
        <article-title>Measurement of mRNA abundance using RNA-seq data: RPKM measure is inconsistent among samples</article-title>
        <source>Theor Biosci</source>
        <year>2012</year>
        <volume>131</volume>
        <fpage>281</fpage>
        <lpage>285</lpage>
        <pub-id pub-id-type="doi">10.1007/s12064-012-0162-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gloor</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Macklaim</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Pawlowsky-Glahn</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Egozcue</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Microbiome datasets are compositional: and this is not optional</article-title>
        <source>Front Microbiol</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>2224</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2017.02224</pub-id>
        <pub-id pub-id-type="pmid">29187837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morton</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Marotz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Washburne</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Silverman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaramela</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Edlund</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Establishing microbial composition measurement standards with reference frames</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-10656-5</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinn</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Erb</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gloor</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Crowley</surname>
            <given-names>TM</given-names>
          </name>
        </person-group>
        <article-title>A field guide for the compositional analysis of any-omics data</article-title>
        <source>GigaScience</source>
        <year>2019</year>
        <volume>8</volume>
        <fpage>giz107</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giz107</pub-id>
        <pub-id pub-id-type="pmid">31544212</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cruz</surname>
            <given-names>GNF</given-names>
          </name>
          <name>
            <surname>Christoff</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>De Oliveira</surname>
            <given-names>LFV</given-names>
          </name>
        </person-group>
        <source>Equivolumetric protocol generates library sizes proportional to total microbial load in next-generation sequencing</source>
        <year>2020</year>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breitwieser</surname>
            <given-names>FP</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>A review of methods and databases for metagenomic classification and assembly</article-title>
        <source>Brief Bioinform</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>1125</fpage>
        <lpage>1136</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbx120</pub-id>
        <pub-id pub-id-type="pmid">29028872</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The KEGG database</article-title>
        <source>Silico Simul Biol Processes</source>
        <year>2002</year>
        <volume>247</volume>
        <fpage>91</fpage>
        <lpage>103</lpage>
        <pub-id pub-id-type="doi">10.1002/0470857897.ch8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tatusov</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Fedorova</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Jacobs</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Kiryutin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The COG database: an updated version includes eukaryotes</article-title>
        <source>BMC Bioinformatics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>41</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-4-41</pub-id>
        <pub-id pub-id-type="pmid">12969510</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>El-Gebali</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mistry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Luciani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Potter</surname>
            <given-names>SC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Pfam protein families database in 2019</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D427</fpage>
        <lpage>D432</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky995</pub-id>
        <pub-id pub-id-type="pmid">30357350</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ondov</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Interactive metagenomic visualization in a web browser</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>385</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-385</pub-id>
        <pub-id pub-id-type="pmid">21961884</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Brouwer</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Pathview: an R/bioconductor package for pathway-based data integration and visualization</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>14</issue>
        <fpage>1830</fpage>
        <lpage>1831</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt285</pub-id>
        <pub-id pub-id-type="pmid">23740750</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinn</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Crowley</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking differential expression analysis tools for RNA-Seq: normalization-based vs log-ratio transformation-based methods</article-title>
        <source>BMC Bioinformatics</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>274</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2261-8</pub-id>
        <pub-id pub-id-type="pmid">30021534</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
