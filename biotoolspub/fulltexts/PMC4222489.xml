<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Evol Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Evol. Biol</journal-id>
    <journal-title-group>
      <journal-title>BMC Evolutionary Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2148</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4222489</article-id>
    <article-id pub-id-type="publisher-id">s12862-014-0163-6</article-id>
    <article-id pub-id-type="pmid">25055743</article-id>
    <article-id pub-id-type="doi">10.1186/s12862-014-0163-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Novel non-parametric models to estimate evolutionary rates and divergence times from heterochronous sequence data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Fourment</surname>
          <given-names>Mathieu</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mfourment@sydney.edu.au</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Holmes</surname>
          <given-names>Edward C</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>edward.holmes@sydney.edu.au</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Marie Bashir Institute for Infectious Diseases and Biosecurity, Charles Perkins Centre, School of Biological Sciences and Sydney Medical School, The University of Sydney, Sydney, Australia</aff>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>7</month>
      <year>2014</year>
    </pub-date>
    <volume>14</volume>
    <fpage>163</fpage>
    <lpage>163</lpage>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>3</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>7</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2014 Fourment and Holmes; licensee BioMed Central Ltd</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Fourment and Holmes; licensee BioMed Central Ltd</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2148/14/163"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Early methods for estimating divergence times from gene sequence data relied on the assumption of a molecular clock. More sophisticated methods were created to model rate variation and used auto-correlation of rates, local clocks, or the so called “uncorrelated relaxed clock” where substitution rates are assumed to be drawn from a parametric distribution. In the case of Bayesian inference methods the impact of the prior on branching times is not clearly understood, and if the amount of data is limited the posterior could be strongly influenced by the prior.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We develop a maximum likelihood method – Physher – that uses local or discrete clocks to estimate evolutionary rates and divergence times from heterochronous sequence data. Using two empirical data sets we show that our discrete clock estimates are similar to those obtained by other methods, and that Physher outperformed some methods in the estimation of the root age of an influenza virus data set. A simulation analysis suggests that Physher can outperform a Bayesian method when the real topology contains two long branches below the root node, even when evolution is strongly clock-like.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>These results suggest it is advisable to use a variety of methods to estimate evolutionary rates and divergence times from heterochronous sequence data. Physher and the associated data sets used here are available online at <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/physher/">http://code.google.com/p/physher/</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>ᅟ</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Accurately estimating evolutionary (substitution) rates and divergence times is central to revealing the timing, patterns, and processes of molecular evolution. Several methods have been developed to co-estimate evolutionary rates and divergence times along a phylogeny or sets of phylogenies. The earliest and easiest method was to assume a strict molecular clock (i.e. homogenous rate among lineages). Although convenient, the assumption of a “strict” molecular clock is often violated, such that more complex models are required that are able to integrate rate variation among lineages. Sanderson [<xref ref-type="bibr" rid="B1">1</xref>] addressed this problem using non-parametric rate smoothing and by assuming that rates of consecutive lineages are correlated. Later, he adopted a maximum likelihood framework and used penalized likelihood to investigate different levels of rate correlation, and a penalty multiplier to achieve a trade-off between rate autocorrelation and goodness-of-fit [<xref ref-type="bibr" rid="B2">2</xref>]. Thorne, Kishino and Painter [<xref ref-type="bibr" rid="B3">3</xref>] further explored the idea of auto-correlation between rates using a Bayesian framework and Markov chain Monte Carlo (MCMC). To accelerate their calculations, the topology is assumed to be known and the likelihood is approximated using a multivariate normal density. The MCMC used is based on Metropolis-Hastings algorithms, which are less efficient than other implementations such as Gibbs sampling [<xref ref-type="bibr" rid="B4">4</xref>]. Hence, Lartillot [<xref ref-type="bibr" rid="B4">4</xref>] proposed an efficient Gibbs sampler using data augmentation and prior conjugacy, which was extended by Guindon [<xref ref-type="bibr" rid="B5">5</xref>] who also used an approximation to the likelihood function. Yang [<xref ref-type="bibr" rid="B6">6</xref>] employed maximum likelihood and a heuristic rate smoothing approach to calculate rates and classify lineages into rate classes. This <italic>ad hoc</italic> procedure was further improved by Aris-Brosou [<xref ref-type="bibr" rid="B7">7</xref>] using more advanced clustering methods that allow the estimation of the number of rates.</p>
    <p>In practice, however, there is no guarantee that evolutionary rates are autocorrelated. In addition, in the case of rapidly evolving organisms such as RNA viruses measurable evolution occurs across the sampling period, such that ‘heterochronous’ sequences sampled at different time-points provide valuable information about evolutionary rates. An alternative approach is therefore to allow rates to vary freely along a phylogeny, and to explicitly incorporate times of sampling. Drummond and colleagues [<xref ref-type="bibr" rid="B8">8</xref>] presented an ‘uncorrelated’ relaxed clock model in which rates are drawn independently from an underlying parametric distribution, such as lognormal or exponential. Although rates are not necessarily distributed according to a probability distribution, this approach greatly reduces the number of parameters. Another way of modelling uncorrelated rates is to assume clock-like behaviour within a particular lineage. The main difficulty with this approach is to find the number and the distribution of these local clocks on a phylogeny, although Bayesian stochastic search variable selection has now been used in this context [<xref ref-type="bibr" rid="B9">9</xref>]. More recently Heath [<xref ref-type="bibr" rid="B10">10</xref>] proposed a model where lineages are assigned a substitution rate value according to the Dirichlet process prior.</p>
    <p>Herein, we propose a simple maximum likelihood-based approach to infer substitution rates and divergence times from heterochronous nucleotide sequences. Given a rooted tree, rate variation among lineages is modelled using either local (LC) or discrete (DC) clocks. Our definition of a ‘local clock’ is the same as that used previously [<xref ref-type="bibr" rid="B9">9</xref>] and assumes that while the substitution rate may vary across a phylogeny, some adjacent lineages evolve at the same rate. In contrast, the ‘discrete clock’ model assumes that a number of substitution rate categories are assigned to lineages without assuming autocorrelation and where lineages that are not adjacent are able to share a rate category. We devised a heuristic approach using a greedy algorithm to infer the distribution of local clocks along a phylogeny, referred to here as the Heuristic Local Clock (HLC) algorithm. The estimates of the best model can be fed to a genetic algorithm (GA) to re-estimate the rates and local clock positions, and calculate model-averaged estimates of the substitution rate and time parameters (i.e. GALC). Similarly, we present a GA to determine the number and allocation of rate categories under a discrete clock model (GADC). The greedy algorithm and GAs are optimized to run efficiently on a distributed computing environment using OpenMP. Finally, we demonstrate the efficiency of the program using data sets of human influenza viruses and simulated data sets.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Models of rate variation among lineages</title>
      <p>Given <italic>n</italic> nucleotide sequences and a rooted phylogeny with <italic>N = 2n-2</italic> branches, we set out to model rate heterogeneity along lineages using local clocks or a discrete distribution of rates.</p>
      <p>We define a local clock on a phylogeny as a monophyletic group where every lineage evolves at exactly the same substitution rate. This definition assumes the existence of another clock (e.g. ‘global’ clock) for lineages that are not assigned a local clock. We model each local clock and the global clock as independent rate classes. In the absence of local clocks, the model corresponds to a strict clock; the other extreme is to have one rate per branch, leading to an over-parameterized model. The optimization challenge for this problem is two-fold: finding the number and location of the local clocks along a phylogeny (discrete optimization) and estimating rates and ages of internal nodes (continuous optimization). The difficulty in using this type of clock lies in the discrete optimization component because of the size of the combinatorial search space. With <italic>2</italic><sup><italic>2n-2</italic></sup> rate combinations, it is impossible to adopt a brute force approach and heuristic algorithms must be used instead.</p>
      <p>We also consider an alternative and more flexible parameterization to local clocks by assigning independent substitution rate classes to lineages to model lineage-specific rate heterogeneity. Unlike the local clock model, this discrete clock model allows non-adjacent lineages to evolve under the same substitution rate. Local clocks are therefore a special case of discrete clocks. Given a fixed number of rate categories <italic>k</italic>, the parameters of the discrete substitution model is a vector of rates <bold><italic>r</italic></bold> = (<italic>r</italic><sub>1</sub>, <italic>r</italic><sub>2</sub>, …, <italic>r</italic><sub><italic>k</italic></sub>) and a vector of rate-class assignments for each lineage <bold><italic>c</italic></bold> = (<italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>, …, <italic>c</italic><sub>2<italic>n</italic> − 2</sub>) where <italic>c</italic><sub><italic>i</italic></sub> ∈ 1 … <italic>k</italic>. Using an appropriate ordering of the <italic>2n-2</italic> branches, each element of vector <bold><italic>c</italic></bold> represents the class assignment of a branch. In our implementation, the number of rate categories is not fixed and is co-estimated with node heights and vector <bold><italic>r</italic></bold> from the data. The number of combinations for the discrete clock algorithm is also computationally difficult and warrants the use of approximation methods. The number of combinations is described by the Bell number <inline-formula><mml:math id="M1" overflow="scroll"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mstyle></mml:math></inline-formula> where <italic>N</italic> is the number of branches and<disp-formula id="bmcM1"><label>(1)</label><mml:math id="M2" name="s12862-014-0163-6-i1" overflow="scroll"><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>k</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mi>i</mml:mi></mml:msup><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula>is the Stirling number of the second kind. For example, for a relatively small data set of 20 sequences, there are approximately 7 × 10<sup>32</sup> possible combinations.</p>
    </sec>
    <sec>
      <title>Algorithms</title>
      <p>One solution to search the high-dimensional parameter space of the local and discrete clock models without using an MCMC is to use a genetic algorithm (GA). GAs belong to a class of evolutionary algorithms that simulate natural selection in a population of individuals to solve an optimization problem. Most algorithms require encoding solutions in a vector and are therefore well suited to discrete optimization. Each individual represents a candidate solution from which a fitness score can be calculated. Individuals with high fitness, and therefore a promising solution, are more likely to be selected during a stochastic step (mating or recombination) to form the next generation. In analogy to biological processes, candidate solutions randomly mutate to promote diversity within the population. GAs are therefore generational processes that stochastically move populations around a fitness landscape. The simplest form of genetic algorithm requires a fitness function and three operators: recombination, selection and mutation.</p>
      <p>We implemented the GA as a generational genetic search algorithm CHC GA [<xref ref-type="bibr" rid="B11">11</xref>]; this approach was previously applied to the detection of both recombination [<xref ref-type="bibr" rid="B12">12</xref>] and natural selection [<xref ref-type="bibr" rid="B13">13</xref>]. The population size of CHC GAs are usually smaller than traditional GAs and use an elitist selection operator that always allows the fittest individual to be selected for the next generation. In our analyses, we used a fixed population size of 30 individuals. In addition, it uses a highly disruptive recombination operator that generates a new individual with a solution that contains half the solution from the first parent and the other half from the second parent. The mutation step is only triggered when the diversity of the population is below a fixed threshold by mutating a fixed number of elements of the solution vector. Given a fixed number of rate classes, the fitness function is simply the likelihood score since every model has the same number of parameters. The mutation and recombination operators for the local and discrete clocks are different and will be presented in the next sections.</p>
      <p>Finding the number of rate classes is more challenging and is not easily addressed with GAs, as it requires jumping between parameter spaces with different dimensions. We use an iterative approach, starting with two rate classes and increment the number of classes until the addition of a rate class stops improving the fitness of the model. During each iteration, a new population is evolved, leading to the fittest model that will be compared to the next iteration. To test whether the addition of a rate class improves the fitness of the model, we assess the goodness of fit of each model using the Akaike Information Criterion with a correction for small sample sizes (<italic>AICc</italic>; the lowest <italic>AICc</italic> represents the best model):<disp-formula id="bmcM2"><label>(2)</label><mml:math id="M3" name="s12862-014-0163-6-i2" overflow="scroll"><mml:mi mathvariant="italic">AICc</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>L</mml:mi><mml:mi>n</mml:mi><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:math></disp-formula>where <inline-formula><mml:math id="M4" overflow="scroll"><mml:mi>L</mml:mi><mml:mi>n</mml:mi><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math></inline-formula> is the maximum likelihood estimate under the model of interest, <italic>k</italic> is the number of parameters and <italic>s</italic> is the sample size. We set the sample size as the number of site patterns in the alignment.</p>
      <p>In the local clock model, each individual of the GA population is represented as a vector where each element maps a local clock to a branch in the phylogenetic tree. If a branch is assigned a local clock, its descendants will belong to the same local clock unless they are assigned a new local clock. The mutation operator randomly changes the location of the local clock. The recombination operator selects two individuals from the population and generates a new individual by randomly choosing the value of one of the parents for each element of the vector state. In the current implementation of the GA, both operators do not allow a local clock to be assigned more than once. The most extreme case is when there is only one local clock: the vector is of size one and recombination has no effect. For models containing a few local clocks, the diversity of the population drops under the threshold after the first round of mating. To escape this problem a mutation rate close to 100% is needed, defeating the purpose of evolutionary algorithms. A solution to this problem would be to start the GA with several local clocks, but determining an appropriate number of local clocks is difficult. Alternatively, we could employ exhaustive search on all the combinations of local clocks but this is only possible for small data sets. We implemented a greedy algorithm that starts with one local clock, fits in turn a local clock to each branch, and retains the location of the local clock that yields the best likelihood. In each subsequent iteration, another local clock is considered on each branch that does not have a local clock already assigned. The algorithm stops either when the addition of a parameter does not improve the fitness of the model based the <italic>AICc</italic> or when the number of clocks exceeds a user-defined threshold <italic>T</italic> (typically <italic>T &lt;&lt;N-1</italic>). Therefore, the algorithm will evaluate a maximum <inline-formula><mml:math id="M5" overflow="scroll"><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> models.</p>
      <p>The best model found by the greedy search will have enough parameters for a GA to more efficiently sample the parameter space without the convergence issue discussed earlier. Hence, we use the fittest model of the greedy search to seed the GA. This approach allows us to assess other combinations that were not previously tested. Since models with different numbers of classes are not necessarily nested we also compute <italic>AICc</italic> to compare models.</p>
      <p>Given a fixed number of rate classes, the encoding of each individual of the GA in the discrete clock model is represented as vector of size <italic>N</italic> where each element represents the class assignment of a branch. The number of rate classes can take any value between 1 (strict clock) and <italic>N</italic> (one rate per branch), although the number of classes should be much smaller than <italic>N</italic> in order to limit model complexity as mentioned earlier. The recombination operator for the discrete model simply selects two individuals from the population and generates a new individual by randomly choosing the value of one of the parents for each element of the vector state. During the mutation step, each element of the vector is subject to switching to a different class assignment with fixed probability. As in the GA for local clocks we adopt a forward selection approach, starting with two rate classes and increment by one the number of rate classes until the <italic>AICc</italic> stops decreasing.</p>
      <p>Finding the combination of rate classes using the greedy algorithm described above is substantially more difficult as the combinatorial complexity increases; therefore, we employ a CHC-GA to search through the parameter space.</p>
    </sec>
    <sec>
      <title>Model averaging and confidence intervals</title>
      <p>Uncertainty is inherent to selecting the best model. As a consequence it might be desirable to model average estimated parameters across all the models <italic>M</italic> explored by the GA. First, we need to compute for each model <italic>M</italic><sub><italic>i</italic></sub> the <italic>AIC</italic> difference (Δ<sub>i</sub>) between the best model and itself such as Δ<sub><italic>i</italic></sub> = <italic>AIC</italic><sub><italic>min</italic></sub> − <italic>AIC</italic><sub><italic>i</italic></sub>, where <italic>AIC</italic><sub><italic>min</italic></sub> is the <italic>AIC</italic> of the best model. Akaike weights are now calculated as:<disp-formula id="bmcM3"><label>(3)</label><mml:math id="M6" name="s12862-014-0163-6-i3" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:msup><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="true">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:msup></mml:mrow></mml:mstyle></mml:mfrac></mml:math></disp-formula>where the numerator is the relative likelihood of model <italic>M</italic><sub><italic>i</italic></sub> and the denominator is a normalization term. The relative likelihood can be interpreted as the relative probability that the <italic>i</italic><sup><italic>th</italic></sup> model minimizes the information loss. Once the models are sorted in decreasing order, we can obtain a confidence set of models by summing the weights from the largest to the lowest until the sum is (1-α) where α is the significance level. Descriptive statistics such as mean and quantiles can be applied to each parameter using the models belonging to this set.</p>
      <p>To investigate the uncertainty of the point estimates under a strict clock and a local clock model with the greedy algorithm, we calculated confidence intervals (CI) using the non-parametric percentile bootstrap method [<xref ref-type="bibr" rid="B14">14</xref>]. The percentile bootstrap uses the empirical quantiles from the bootstrap distribution of the parameter <italic>θ</italic> to calculate the confidence interval <inline-formula><mml:math id="M7" overflow="scroll"><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>*</mml:mo></mml:msubsup><mml:mo>;</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfenced></mml:math></inline-formula> where <italic>α</italic> is the significance level and <inline-formula><mml:math id="M8" overflow="scroll"><mml:msubsup><mml:mi>θ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M9" overflow="scroll"><mml:msubsup><mml:mi>θ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> are the <italic>α</italic>/2 and 1 − <italic>α</italic>/2 percentile of the bootstrap coefficients <italic>θ</italic>*.</p>
    </sec>
    <sec>
      <title>Program workflow</title>
      <p>The first step that is common to the GA and greedy algorithms is to estimate the branch lengths (in term of expected number of substitution per site) of the phylogeny and the parameters of the substitution model by maximum likelihood. The likelihood of this parameter rich non-clock model will give us an upper-bound for the likelihood of the global, local and discrete clock models. The parameters of the substitution rate matrix are fixed during the rest of the algorithm as we make the assumption that nucleotide frequencies and relative rates are not affected by explicitly modelling substitution rates. Next, we estimate the age of <italic>n-1</italic> internal nodes and the substitution rate under a strict clock model. This simplistic model, if violated, gives us the lower-bound in term of likelihood and the starting point for statistically testing the introduction of rate heterogeneity in the model. Because we are explicitly dealing with heterochronous sequences, every taxon must be assigned a fixed date.</p>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>Since the GA and greedy search algorithms presented in this paper are embarrassingly parallel problems, we implemented the program within the OpenMP framework to run on distributed systems. The evaluation of the likelihood for each configuration of clocks was therefore computed by a single thread. Finally, the likelihood is calculated using Felsenstein’s pruning algorithm [<xref ref-type="bibr" rid="B15">15</xref>] and is optimised with SSE-based SIMD vectorization. These methods are implemented in a C program called Physher. Simulated data sets were generated with a custom program that uses a library shared with Physher.</p>
    </sec>
    <sec>
      <title>Data sets and analysis</title>
      <p>We applied our algorithms to two data sets of heterochronous viral nucleotide sequences. The first data set comprises an alignment of 69 human influenza A/H3N2 virus haemagglutinin (HA) sequences (987 nt in length) isolated between 1981 and 1998. The evolutionary rates and time to the most recent ancestors (tMRCAs) of this data set was previously investigated using a random local clock method [<xref ref-type="bibr" rid="B9">9</xref>] with a Bayesian MCMC approach implemented in BEAST [<xref ref-type="bibr" rid="B16">16</xref>]. As in the original study, the alignment was analysed using strict, local and discrete clocks implemented in Physher under the HKY + Γ<sub>4</sub> substitution model that incorporates gamma-distributed rate variation among sites (4 rate classes). We reanalysed the data using BEAST with either an uncorrelated lognormal relaxed-clock (UCLN) or a random local clock model (RLC) and calculated the Bayes factor (BF) using the path sampling method [<xref ref-type="bibr" rid="B17">17</xref>] to compare competing models. We performed a series of simulations to assess the effect of stochastic noise over the phylogenetic signal. Accordingly, data sets of 1000, 2000 and 10,000 nucleotides (nt) in length were simulated along a ladder-like tree containing 16 taxa that represents a simplified version of the influenza A data set (Figure <xref ref-type="fig" rid="F1">1</xref>). The root age is 25 years, the global rate is set to 5 × 10<sup>−3</sup> subs/site/year and a local clock is set in the middle of the tree inducing a rate shift with rate equal to 10<sup>−2</sup> subs/site/year. 50 replicates were simulated under the HKY model with equal nucleotide frequencies, a transition to transversion rate ratio <italic>κ</italic> = 3, and a gamma shape <italic>α</italic> = 0.5. These data sets were analysed using the RLC and UCLN with a constant size coalescent model and an exponential prior on the rate with mean 8 × 10<sup>−3</sup> subs/site/year using BEAST. The GADC and HLC models were used in Physher.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Phylogeny used for simulating data sets under a local clock model.</bold> Lineages are coloured according to their substitution rates.</p>
        </caption>
        <graphic xlink:href="s12862-014-0163-6-1"/>
      </fig>
      <p>The second data set comprising 265 full-length HA genes (1382 nt in length) of influenza B virus, containing sequences from the co-circulating Yamagata and Victoria lineages isolated between 2002 and 2013. Each taxon was calibrated using year, month, and day of isolation. The substitution rate and tMRCA were estimated under a GTR + Γ<sub>4</sub> substitution model using strict and discrete clocks with Physher. The data was also analysed using BEAST [<xref ref-type="bibr" rid="B16">16</xref>] under a strict clock and an uncorrelated lognormal relaxed clock and with both constant population size and Bayesian skyride tree priors. As previous analyses [<xref ref-type="bibr" rid="B18">18</xref>] estimated the substitution rate for influenza B virus to be 1 – 3 × 10<sup>−3</sup> nucleotide substitutions per site per year (subs/site/year), we used an exponential prior with mean 3 × 10<sup>−3</sup> subs/site/year on the mean of the lognormal distribution and strict rate parameter. We did not use any prior assumption on the age of the root.</p>
      <p>Influenza B virus data sets were also simulated under a strict molecular clock using divergence times, substitution rates and other substitution parameters estimated by Physher. These data sets are effectively parametric bootstraps with a fixed topology. The parameters of importance in this simulation are the substitution rate, for which the Physher estimate was 1.4 × 10<sup>−3</sup> subs/site/year and the age of the root (<italic>t</italic> = 1967) (see Results). In this case we know that the root predates, or should be close, to 1972 since the two main lineages became antigenically distinct in the 1970’s [<xref ref-type="bibr" rid="B19">19</xref>] and the earliest virus that emerged after the split was sampled in 1972. We analysed 50 replicates with Physher and BEAST using a strict clock. The BEAST analyses were performed using a constant population size, and both the Bayesian skyride [<xref ref-type="bibr" rid="B20">20</xref>] and the constant rate birth-death methods [<xref ref-type="bibr" rid="B21">21</xref>]. To investigate the effect of allowing rate variation among lineages we also analysed the replicates using an uncorrelated relaxed lognormal prior. In this case we used an exponential prior with mean 2 × 10<sup>−3</sup> subs/site/year on the mean of the lognormal distribution and strict rate parameter. We performed at least two analyses of 20 million generations each and used Tracer [<xref ref-type="bibr" rid="B22">22</xref>] to assess the stationarity of the chain and to discard an appropriate number of generations. Support for the substitution rate and root age was given by 95% highest posterior density intervals. Confidence intervals were derived using the percentile bootstrap method with 200 replicates. We also inferred the rate and root age, using a fixed topology, by regressing the expected number of substitution per site from the root to each tip from the maximum likelihood tree against sampling times with Physher. To obtain a rooted a tree, a node (the root) needs to be inserted in the unrooted tree by splitting a branch in two. We estimate the location of the root as the location that maximizes the coefficient of correlation between time and the expected number of substitutions. The rate and root age are defined as the slope and intercept of the regression line, respectively.</p>
      <p>To validate our algorithms we simulated two series of data sets of 2000 nt in length using a local clock model with two local clocks and a discrete clock with three rate classes (Figure <xref ref-type="fig" rid="F2">2</xref>). The age of the root was 15 years and the rates were 3 × 10<sup>−3</sup>, 5 × 10<sup>−3</sup>, and 10<sup>−2</sup> subs/site/year. We analysed 50 replicates of each scheme using Physher with a strict, local, and discrete clock and the confidence intervals of the root were derived for the root age using the methods described previously.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Phylogenies used for simulating data sets under different clock models.</bold> Lineages are coloured according to their substitution rates. <bold>(a)</bold> Phylogeny with two local clocks. <bold>(b)</bold> Phylogeny with three rate classes.</p>
        </caption>
        <graphic xlink:href="s12862-014-0163-6-2"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Influenza A virus</title>
      <sec>
        <title>Empirical data</title>
        <p>We used our local and discrete clock methods to investigate rate heterogeneity of the influenza A virus data set (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S1) by comparing the <italic>AICc</italic> of a strict clock to models that allow rate heterogeneity among lineages. The greedy algorithm found that ten local clocks were the best-fit to the data, improving the log-likelihood from −4159.51 (<italic>AICc</italic> = 8484.73) under the strict molecular clock to −4118.58 (<italic>AICc</italic> = 8420.17) under the local clock. Subsequently, we ran a GA starting with ten local clocks to check that the greedy search did not get trapped in local optima, but this approach failed to find a better model.</p>
        <p>We also modelled rate variation with a discrete clock and allocated the rate categories to each lineage using a genetic algorithm. We started the algorithm with two rate classes and incremented the number of classes until the fit of the model stopped improving based on the <italic>AICc</italic>. The algorithm suggested that the maximum likelihood is −4104.59 and that the optimal number of rate classes is four. The <italic>AICc</italic> value of the GADC model (<italic>AICc</italic> = 8376.4) was smaller than the HLC model. The relative likelihood of the HLC model is about 10<sup>−23</sup>, suggesting that the GADC model is about 10<sup>23</sup> times more likely to be correct than the HLC model.</p>
        <p>The mode of the posterior distribution of the number of local clocks reported by Drummond and Suchard [<xref ref-type="bibr" rid="B9">9</xref>] was significantly lower than our estimate suggesting that two local clocks were appropriate for this data set. The important difference between our estimates is probably due to the specification of the prior that placed 50% of the mass on a unique clock. Although the root height estimates inferred using our two methods (HLC: 1974.6, CI: 1953.2-1979.27; GADC: 1979.7, CI: 1978.5-1980) are in agreement with their estimate [<xref ref-type="bibr" rid="B9">9</xref>] (RLC: 1979, BCI: 1977.98-1979.93, UCLN: 1977.8, BCI: 1975.8-1979.6), the UCLN and GADC models show no obvious rate shift (Figure <xref ref-type="fig" rid="F3">3</xref>), and rates between each branch and its parent are uncorrelated (r = −5 × 10<sup>−3</sup>; p-value = 0.95). To check whether this shift was caused by the specification of the local clock model we reanalysed the same data set with an uncorrelated lognormal relaxed-clock model using BEAST. If the viral genomes underwent a phase of accelerated mutation rate the UCLN model would be able to recover the same pattern. The distribution over the rates using UCLN does not show this trend although the root height estimate is similar (1978.83, BCI: 1977.06-1980.25). The Bayes factor calculated using the path sampling method (log BF = −8.4) suggests the UCLN model (log marginal likelihood = −4384.83) is strongly preferred to the local clock model (log marginal likelihood = −4388.25).</p>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p><bold>Influenza phylogenies estimated using Bayesian and maximum likelihood methods.</bold> Branches are coloured according to their rates using a gradient from blue (low rate) to red (high rate). <bold>(a)</bold> Maximum likelihood inference using a local clock model. <bold>(b)</bold> Maximum likelihood inference using a discrete clock model. <bold>(c)</bold> Bayesian inference using a local clock model. <bold>(d)</bold> Bayesian inference using an uncorrelated lognormal relaxed clock.</p>
          </caption>
          <graphic xlink:href="s12862-014-0163-6-3"/>
        </fig>
      </sec>
      <sec>
        <title>Simulations</title>
        <p>We simulated 50 data sets of different length with a rate shift occurring in the middle branch of a completely asymmetric phylogeny (Figure <xref ref-type="fig" rid="F1">1</xref>). Each panel of Figure <xref ref-type="fig" rid="F4">4</xref> depicts rate variation using a heatmap for 50 replicates where each row represents a replicate and each column indexes a branch. Because of the ladder-like nature of the phylogenies, each tree was linearized using a postorder traversal of the tree, allowing visualisation of rate through time. Starting from the left, the first cell is represents the rate (mean for BEAST and maximum likelihood estimate for Physher) for the branch leading to the earliest taxon and the last two cells represent the rates of the branches leading to the youngest. Between these cells, rates at branches leading to internal and external nodes alternate. These plots clearly show a rate shift when a local clock is used with BEAST and Physher. Plots generated with UCLN and discrete clock models show a more nuanced picture where low and high rates tend to blend together.</p>
        <fig id="F4" position="float">
          <label>Figure 4</label>
          <caption>
            <p><bold>Substitution rates for simulated data sets with a rate shift.</bold> Substitution rate variation in simulated data sets of length 1000, 2000, and 10000 nt using random local (RLC) and relaxed lognormal (UCLN) clock models implemented in BEAST and local (HLC) and discrete (GADC) clock models implemented in Physher. Each row represents a replicate and each column represent a branch where the rightmost cell is a branch leading to latest taxon and the leftmost cell is a branch near the root. Each cell maps a branch is coloured according to its substitution rate using a gradient from blue (low rate) to red (high rate).</p>
          </caption>
          <graphic xlink:href="s12862-014-0163-6-4"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Influenza B virus</title>
      <sec>
        <title>Empirical data</title>
        <p>We analysed the influenza B virus data set using Physher under both non-clock (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Figure S2) (log likelihood LnL = −9503.2) and strict clock (LnL = −9585.9) models. To test whether every lineage evolved at the same rate, we used the likelihood ratio test [<xref ref-type="bibr" rid="B15">15</xref>]. The comparison of twice the log-likelihood difference with a χ<sup>2</sup> distribution with 262 degrees of freedom suggests the strict clock model could not be rejected (p-value = 0.99). The estimate of the substitution rate was 1.42 × 10<sup>−3</sup> subs/site/year with 95% bootstrap confidence interval [1.2 × 10<sup>−3</sup>, 1.49 × 10<sup>−3</sup>]. The divergence time of the two lineages is estimated to be 1966 (95% CI: 1959, 1971). The same data set was reanalysed using BEAST and the mean substitution rate estimate was 2.1 × 10<sup>−3</sup> subs/site/year (95% BCI: 1.85 × 10<sup>−3</sup>, 2.36 × 10<sup>−3</sup>) under a constant population size coalescent model and 2.72 × 10<sup>−3</sup> subs/site/year (95% Bayesian CI: 2.4 × 10<sup>−3</sup>, 3 × 10<sup>−3</sup>) using the Bayesian skyride tree prior. Similarly the mean root age estimate was 1978 (95% Bayesian CI: 1973,1984) under a constant population size coalescent model and 1998 (95% Bayesian CI: 1997,1999) using the Bayesian skyride method and hence considerably more recent that the ‘true’ estimate.</p>
      </sec>
      <sec>
        <title>Simulations</title>
        <p>We simulated 50 data set replicates using the parameters estimated with Physher in the influenza B analysis and then re-estimated the parameters using Physher and BEAST. We initially used a strict molecular clock with BEAST. Using a constant size coalescent model (Figure <xref ref-type="fig" rid="F5">5</xref>) none of the Bayesian credible intervals of the substitution rate contained the true rate, and only one interval contained the true root age. The substitution rate was consistently overestimated while the age of the root was consistently underestimated. More striking was that the Bayesian skyride coalescent model underperformed compared to the constant size model, under-estimating the age of the root by about 20 years, as was seen with the empirical data (Figure <xref ref-type="fig" rid="F6">6</xref>). The same pattern of over-estimation of the rate and underestimation of the root age was observed using a lognormal relaxed clock. Interestingly, the confidence interval of the standard deviation of the lognormal distribution and coefficient of variation did not include 0 using the Bayesian skyride method, suggesting that there was rate variation in the data. Finally, using a birth-death process prior, the rate and root age could not be recovered in any of the replicates (Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>: Figure S3). The bootstrap analysis with Physher showed that 40 intervals contained the true substitution rate and 43 intervals contained the true root age (Figure <xref ref-type="fig" rid="F7">7</xref>). Finally, the rate and root age estimates using a simple linear regression in Physher are consistent with our maximum likelihood estimates (Additional file <xref ref-type="supplementary-material" rid="S4">4</xref>: Figure S4).</p>
        <fig id="F5" position="float">
          <label>Figure 5</label>
          <caption>
            <p><bold>95% Bayesian confidence intervals of substitution rate and root age using the coalescent prior and a strict molecular clock on 50 simulated data sets.</bold> Parameters are estimated using BEAST for 50 replicates under a strict molecular clock and a coalescent tree prior. Intervals that do not include the true value (blue line) are shown in red. Nucleotide substitution rate <bold>(a)</bold> and root age <bold>(b)</bold> inferred using a constant size tree prior. Nucleotide substitution rate <bold>(c)</bold> and root age <bold>(d)</bold> inferred using the Bayesian skyride method.</p>
          </caption>
          <graphic xlink:href="s12862-014-0163-6-5"/>
        </fig>
        <fig id="F6" position="float">
          <label>Figure 6</label>
          <caption>
            <p><bold>95% Bayesian confidence intervals of substitution rate and root age using a coalescent prior a nd a relaxed molecular clock on 50 simulated data sets.</bold> Intervals are estimated using BEAST for 50 replicates under a lognormal molecular clock and a coalescent tree prior. Intervals that do not include the true value (blue line) are shown in red. Nucleotide substitution rate <bold>(a)</bold> and root age <bold>(b)</bold> inferred using a constant size tree prior. Nucleotide substitution rate <bold>(c)</bold> and root age <bold>(d)</bold> inferred using the Bayesian skyride method.</p>
          </caption>
          <graphic xlink:href="s12862-014-0163-6-6"/>
        </fig>
        <fig id="F7" position="float">
          <label>Figure 7</label>
          <caption>
            <p><bold>95% bootstrap confidence intervals of substitution rate and root age using maximum likelihood and a strict molecular clock on 50 simulated data sets.</bold> The nucleotide substitution rate <bold>(a)</bold> and root age <bold>(b)</bold> are inferred using Physher for 50 replicates using a strict molecular clock. Red intervals that do not include the true value (blue line) are shown in red.</p>
          </caption>
          <graphic xlink:href="s12862-014-0163-6-7"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Additional simulations</title>
      <p>Finally, we performed two sets of simulations with two local clocks and three discrete classes. The phylogeny and the rate allocation to lineages are shown in Figure <xref ref-type="fig" rid="F2">2</xref>. Table <xref ref-type="table" rid="T1">1</xref> shows the number of replicates (out of 50 replicates) for which the true root age lies within the 95% confidence interval. As expected, the strict clock model does not perform well in the presence of rate variation. The local clock model recovered the true root age in every replicate simulated with a local clock and it recovered the true root age in 49 of 50 replicates simulated under a discrete clock model. The discrete clock model recovered the true root age in 48 and 46 replicates in the local and discrete clock data sets. The distribution of the estimated number of rates suggests that the discrete model tends to under-fit the data by assigning two rate classes to most replicates.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Results of the analysis of simulated data sets</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
          </colgroup>
          <thead>
            <tr valign="top">
              <th align="left" valign="top">
                <bold>Clock</bold>
                <hr/>
              </th>
              <th colspan="2" align="left" valign="top">
                <bold>Two local clocks</bold>
                <hr/>
              </th>
              <th colspan="2" align="left" valign="top">
                <bold>Three discrete rate classes</bold>
                <hr/>
              </th>
            </tr>
            <tr valign="top">
              <th align="left" valign="top"> </th>
              <th align="left" valign="top">
                <bold>Root age</bold>
              </th>
              <th align="left" valign="top">
                <bold>Number of rates</bold>
              </th>
              <th align="left" valign="top">
                <bold>Root age</bold>
              </th>
              <th align="left" valign="top">
                <bold>Number of rates</bold>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr valign="top">
              <td align="left" valign="top">Strict<hr/></td>
              <td align="left" valign="top">29<hr/></td>
              <td align="left" valign="top">1<hr/></td>
              <td align="left" valign="top">33<hr/></td>
              <td align="left" valign="top">1<hr/></td>
            </tr>
            <tr valign="top">
              <td align="left" valign="top">Local<hr/></td>
              <td align="left" valign="top">50<hr/></td>
              <td align="left" valign="top">2 (4), 3 (34), 4 (10), 5 (2)<hr/></td>
              <td align="left" valign="top">49<hr/></td>
              <td align="left" valign="top">2 (16), 3 (11), 4 (18), 5 (5)<hr/></td>
            </tr>
            <tr valign="top">
              <td align="left" valign="top">Discrete</td>
              <td align="left" valign="top">49</td>
              <td align="left" valign="top">2 (35), 3 (15)</td>
              <td align="left" valign="top">46</td>
              <td align="left" valign="top">2 (49), 3 (1)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The table shows the number of replicates (out of 50) for which the true root age lies within the 95% confidence interval estimated by Physher for data sets simulated under two different clock models. The ‘number of rates’ column shows the distribution of the estimated number of rates with their proportion between brackets.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>We describe local and discrete clock models to estimate nucleotide substitution rates from heterochronous sequence data sets within a maximum likelihood framework and in the presence of rate heterogeneity among lineages.</p>
    <p>The analysis of influenza A virus shows that the discrete clock model fits the data better than the local clock model, as suggested by the Bayes factor calculated using BEAST and the relative likelihood calculated using Physher. Although root age estimates under local and discrete clocks are similar, the relaxed (UCLN) and the discrete clock failed to recover the rate shift pattern that Drummond and Suchard [<xref ref-type="bibr" rid="B9">9</xref>] first identified using a random local clock. We performed a series of simulations by generating alignments of 1000, 2000, and 10,000 nt in length with a tree similar to the influenza A virus data set and with a rate shift in the centre of the tree (Figure <xref ref-type="fig" rid="F1">1</xref>). While the local clock algorithms recovered the location of the rate shift for the shortest alignments, the relaxed and discrete clock model failed to identify the rate shift for data sets of 1000 and 2000 nt. The rate shift only becomes apparent for the data set of 10,000 nt under the discrete model. These simulations therefore confirm that more flexible models cannot recover a single rate shift from 5 × 10<sup>−3</sup> to 10<sup>−2</sup> subs/site/year for relatively short alignments. A likely explanation for this discrepancy is that there is not enough data for the UCLN and DC models to recover the true distribution of rate and a certain degree of autocorrelation is needed to correctly identify rate variation.</p>
    <p>With limited data, Bayesian-based inference should perform better than the maximum likelihood method if one can use an appropriate prior on the branching times. Unfortunately, it can produce posterior distributions that are heavily influenced by priors, as is probably the case in our simulation study where no coalescent model might be appropriate. The two main classes of prior that are currently used are coalescent processes and the birth-death process. The coalescent process is a function of the effective population size (<italic>N</italic><sub><italic>e</italic></sub>) scaled by the generation time (<italic>τ</italic>), and since no assumptions are made about the generation time in our analyses we refer to this composite parameter (<italic>θ</italic> = <italic>N</italic><sub><italic>e</italic></sub><italic>τ</italic>) as the relative genetic diversity. The relative size function can be constant, distributed according to a parametric distribution (e.g. exponential distribution) or any function of time. Importantly, in data sets that contain several lineages that evolved concurrently with incomplete sampling of extant taxa (e.g. influenza B virus data set) these priors can produce spurious results. Using simulations it was shown that relaxed clock models can greatly underestimate the age of the root when lineages exhibit strong rate heterogeneity [<xref ref-type="bibr" rid="B23">23</xref>]. In the influenza B virus example, the two long branches below the root node (i.e. the ancestors of the Victoria and Yamagata lineages) suggest an initially large relative genetic diversity. With a fluctuating relative diversity the constant coalescent appears to be a poor choice of prior and the Bayesian skyride method should be more appropriate. Indeed, it is striking that the age of the root estimated with BEAST using different priors is significantly younger than the Physher estimate. Hence, we suggest that using a relaxed molecular clock with the Bayesian skyride method should be avoided when a tree contains long branches at the root. In our analyses, the prior appears to overpower the likelihood and is in a favour of a younger root age with a faster rate.</p>
    <p>Genetic algorithms appear to be well suited for optimizing the allocation of discrete clocks but their efficiency in the local clock problem is arguable, probably due to the different solution encodings. In the discrete case the individual size is the number of branches (N = <italic>2n-2)</italic>, whereas in the local clock setting the length of each individual is equal to the number of local clocks being investigated. In the influenza A virus data set, we started the GA with ten local clocks. Discrete optimization is notoriously more difficult than its continuous counterpart because functions are generally not convex and because a modification of only one of the variables can significantly change the likelihood of the model.</p>
    <p>With respect to performance, the greedy algorithm finished in about 20 minutes on a Mac Pro 3.33 GHz 6-core and the discrete clock GA converged in about two hours for the analysis of the influenza virus A data set. For 20 million cycles, the random local clock ran for approximately 4 hours and the relaxed clock ran for about 5 hours. It is important to highlight that although Physher appears faster than BEAST, Physher optimizes a single topology while BEAST integrate over topologies.</p>
    <p>The algorithms described in this paper rely on some common assumptions but differ from other methods in several ways. Several published algorithms [<xref ref-type="bibr" rid="B1">1</xref>],[<xref ref-type="bibr" rid="B3">3</xref>],[<xref ref-type="bibr" rid="B5">5</xref>],[<xref ref-type="bibr" rid="B6">6</xref>] use a normal approximation to the costly likelihood function, while Sanderson [<xref ref-type="bibr" rid="B2">2</xref>] used a Poisson approximation to describe the mutation process. Some work has also been done on improving the approximate likelihood calculation using parameters transform [<xref ref-type="bibr" rid="B24">24</xref>]. To speed-up our inferences we rely instead on parallelization of our algorithms, hence avoiding the assumption that the parameters (product of rate and time) are sufficiently close to the maximum likelihood estimates of the branch lengths inferred in the rate-free analysis. Like many methods we assumed that the rooted tree topology is known; while this is computationally attractive, this assumption is not always realistic. Notably, Aris-Brosou [<xref ref-type="bibr" rid="B7">7</xref>] investigated the impact of ignoring topology uncertainty on an empirical data set and revealed no significant differences in age estimates when topology uncertainty was integrated.</p>
    <p>The nearly constant substitution rate of the human influenza B virus phylogeny should provide a set of favourable conditions for the estimation of these parameters. Importantly, our simulations suggest that estimating divergence times is difficult if the prior overrides the data even when the substitution rate is constant. Wertheim et al. [<xref ref-type="bibr" rid="B25">25</xref>] previously pointed out how rate variation resulted in major discrepancies in the estimation of the age of HIV-1 M group subtypes when each subtype was analysed separately or combined in a total data set of all subtypes. In a similar way to the influenza B virus simulations undertaken here, prior information on the topology could also be a reason for this discrepancy between full phylogeny and sub-tree only estimates. Finally, if a data set contains weak or no temporal signal (i.e. strong rate variation), the estimation of the evolutionary history will be impossible [<xref ref-type="bibr" rid="B26">26</xref>].</p>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>We have presented algorithms to estimate evolutionary rates and divergence times from heterochronous gene sequence data without making assumptions about the distribution of rates across a phylogeny. In our analyses the local clock underperformed compared to the discrete clock model, and empirical data that show use of local clock models is only warranted when there is a clear rate shift among lineages. We also show that current Bayesian methods can sometimes fail to recover true node ages and rates due to the specification of the prior.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>MF conceived and designed the experiments. MF implemented the software Physher. Both authors were involved in the writing of the manuscript. Both authors read and approved the final manuscript.</p>
  </sec>
  <sec>
    <title>Additional files</title>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1:</title>
        <p><bold>Maximum likelihood phylogeny of the influenza A virus data.</bold> Maximum likelihood tree without the assumption of a molecular clock. Branch lengths depict the expected number of substitution per site.</p>
      </caption>
      <media xlink:href="s12862-014-0163-6-S1.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2:</title>
        <p><bold>Maximum likelihood phylogeny of the influenza B virus data. Maximum likelihood tree without the assumption of a molecular clock.</bold> Branch lengths depict the expected number of substitution per site.</p>
      </caption>
      <media xlink:href="s12862-014-0163-6-S2.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3:</title>
        <p><bold>95% Bayesian confidence intervals of substitution rate and root age using the birth-death model and a strict clock in 50 simulated data sets.</bold> Confidence intervals of the nucleotide substitution rate (a) and root age (a) were inferred using BEAST for 50 replicates using a birth-death model prior on the phylogeny. Intervals that do not include the true value (blue line) are shown in red.</p>
      </caption>
      <media xlink:href="s12862-014-0163-6-S3.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4:</title>
        <p><bold>Linear regression estimates of substitution rate and root age in 50 simulated data sets.</bold> Point estimates of the nucleotide substitution rate (a) and root age (b) using a root to tip linear regression of the expected number of substitutions per site and sampling dates.</p>
      </caption>
      <media xlink:href="s12862-014-0163-6-S4.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>MF started to work on Physher while working in the Department of Pathology, University of California San Diego, San Diego, USA and was supported by the National Institutes of Health (AI47745) and the Joint DMS/NIGMS Mathematical Biology Initiative through Grant NSF-0714991. MF is currently supported by a postdoctoral research fellowship from the University of Sydney. ECH is supported by an NHMRC Australia Fellowship.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sanderson</surname>
          <given-names>MJ</given-names>
        </name>
        <article-title>A nonparametric approach to estimating divergence times in the absence of rate constancy</article-title>
        <source>Mol Biol Evol</source>
        <year>1997</year>
        <volume>14</volume>
        <fpage>1218</fpage>
        <lpage>1231</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a025731</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sanderson</surname>
          <given-names>MJ</given-names>
        </name>
        <article-title>Estimating absolute rates of molecular evolution and divergence times: A penalized likelihood approach</article-title>
        <source>Mol Biol Evol</source>
        <year>2002</year>
        <volume>19</volume>
        <fpage>101</fpage>
        <lpage>109</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a003974</pub-id>
        <?supplied-pmid 11752195?>
        <pub-id pub-id-type="pmid">11752195</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Thorne</surname>
          <given-names>JL</given-names>
        </name>
        <name>
          <surname>Kishino</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Painter</surname>
          <given-names>IS</given-names>
        </name>
        <article-title>Estimating the rate of evolution of the rate of molecular evolution</article-title>
        <source>Mol Biol Evol</source>
        <year>1998</year>
        <volume>15</volume>
        <fpage>1647</fpage>
        <lpage>1657</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a025892</pub-id>
        <?supplied-pmid 9866200?>
        <pub-id pub-id-type="pmid">9866200</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lartillot</surname>
          <given-names>N</given-names>
        </name>
        <article-title>Conjugate Gibbs sampling for Bayesian phylogenetic models</article-title>
        <source>J Comput Biol</source>
        <year>2006</year>
        <volume>13</volume>
        <fpage>1701</fpage>
        <lpage>1722</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2006.13.1701</pub-id>
        <?supplied-pmid 17238840?>
        <pub-id pub-id-type="pmid">17238840</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Guindon</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Bayesian estimation of divergence times from large sequence alignments</article-title>
        <source>Mol Biol Evol</source>
        <year>2010</year>
        <volume>27</volume>
        <fpage>1768</fpage>
        <lpage>1781</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msq060</pub-id>
        <?supplied-pmid 20194424?>
        <pub-id pub-id-type="pmid">20194424</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yang</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>A heuristic rate smoothing procedure for maximum likelihood estimation of species divergence times</article-title>
        <source>Acta Zool Sin</source>
        <year>2004</year>
        <volume>50</volume>
        <fpage>645</fpage>
        <lpage>656</lpage>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Aris-Brosou</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Dating phylogenies with hybrid local molecular clocks</article-title>
        <source>PLoS One</source>
        <year>2007</year>
        <volume>2</volume>
        <fpage>e879</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0000879</pub-id>
        <?supplied-pmid 17849008?>
        <pub-id pub-id-type="pmid">17849008</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Drummond</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Ho</surname>
          <given-names>SYW</given-names>
        </name>
        <name>
          <surname>Phillips</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Rambaut</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Relaxed phylogenetics and dating with confidence</article-title>
        <source>PLoS Biol</source>
        <year>2006</year>
        <volume>4</volume>
        <fpage>699</fpage>
        <lpage>710</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0040088</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Drummond</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Suchard</surname>
          <given-names>MA</given-names>
        </name>
        <article-title>Bayesian random local clocks, or one rate to rule them all</article-title>
        <source>BMC Biol</source>
        <year>2010</year>
        <volume>8</volume>
        <fpage>114</fpage>
        <pub-id pub-id-type="doi">10.1186/1741-7007-8-114</pub-id>
        <?supplied-pmid 20807414?>
        <pub-id pub-id-type="pmid">20807414</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Heath</surname>
          <given-names>TA</given-names>
        </name>
        <article-title>A hierarchical Bayesian model for calibrating estimates of species divergence times</article-title>
        <source>Syst Biol</source>
        <year>2012</year>
        <volume>61</volume>
        <fpage>793</fpage>
        <lpage>809</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/sys032</pub-id>
        <?supplied-pmid 22334343?>
        <pub-id pub-id-type="pmid">22334343</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="book">
        <name>
          <surname>Eshelman</surname>
          <given-names>LJ</given-names>
        </name>
        <source>The CHC adaptive search algorithm: how to do safe search when engaging in nontraditional genetic recombination</source>
        <year>1991</year>
        <publisher-name>Morgan Kaufmann Publisher, San Mateo, CA</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kosakovsky Pond</surname>
          <given-names>SL</given-names>
        </name>
        <name>
          <surname>Posada</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Gravenor</surname>
          <given-names>MB</given-names>
        </name>
        <name>
          <surname>Woelk</surname>
          <given-names>CH</given-names>
        </name>
        <name>
          <surname>Frost</surname>
          <given-names>SDW</given-names>
        </name>
        <article-title>Automated phylogenetic detection of recombination using a genetic algorithm</article-title>
        <source>Mol Biol Evol</source>
        <year>2006</year>
        <volume>23</volume>
        <fpage>1891</fpage>
        <lpage>1901</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msl051</pub-id>
        <?supplied-pmid 16818476?>
        <pub-id pub-id-type="pmid">16818476</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kosakovsky Pond</surname>
          <given-names>SL</given-names>
        </name>
        <name>
          <surname>Frost</surname>
          <given-names>SDW</given-names>
        </name>
        <article-title>A genetic algorithm approach to detecting lineage-specific variation in selection pressure</article-title>
        <source>Mol Biol Evol</source>
        <year>2005</year>
        <volume>22</volume>
        <fpage>478</fpage>
        <lpage>485</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msi031</pub-id>
        <pub-id pub-id-type="pmid">15509724</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="book">
        <name>
          <surname>Efron</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Tibshirani</surname>
          <given-names>RJ</given-names>
        </name>
        <source>An introduction to the bootstrap</source>
        <year>1993</year>
        <publisher-name>Chapman and Hall, New York</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Felsenstein</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Evolutionary trees from DNA-sequences - a maximum-likelihood approach</article-title>
        <source>J Mol Evol</source>
        <year>1981</year>
        <volume>17</volume>
        <fpage>368</fpage>
        <lpage>376</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01734359</pub-id>
        <?supplied-pmid 7288891?>
        <pub-id pub-id-type="pmid">7288891</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Drummond</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Rambaut</surname>
          <given-names>A</given-names>
        </name>
        <article-title>BEAST: Bayesian evolutionary analysis by sampling trees</article-title>
        <source>BMC Evol Biol</source>
        <year>2007</year>
        <volume>7</volume>
        <fpage>214</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-7-214</pub-id>
        <?supplied-pmid 17996036?>
        <pub-id pub-id-type="pmid">17996036</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Baele</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Lemey</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Bedford</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Rambaut</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Suchard</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Alekseyenko</surname>
          <given-names>AV</given-names>
        </name>
        <article-title>Improving the accuracy of demographic and molecular clock model comparison while accommodating phylogenetic uncertainty</article-title>
        <source>Mol Biol Evol</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>2157</fpage>
        <lpage>2167</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/mss084</pub-id>
        <?supplied-pmid 22403239?>
        <pub-id pub-id-type="pmid">22403239</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chen</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Holmes</surname>
          <given-names>EC</given-names>
        </name>
        <article-title>The evolutionary dynamics of human influenza B virus</article-title>
        <source>J Mol Evol</source>
        <year>2008</year>
        <volume>66</volume>
        <fpage>655</fpage>
        <lpage>663</lpage>
        <pub-id pub-id-type="doi">10.1007/s00239-008-9119-z</pub-id>
        <?supplied-pmid 18504518?>
        <pub-id pub-id-type="pmid">18504518</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Biere</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Bauer</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Schweiger</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Differentiation of influenza B virus lineages Yamagata and Victoria by real-time PCR</article-title>
        <source>J Clin Microbiol</source>
        <year>2010</year>
        <volume>48</volume>
        <fpage>1425</fpage>
        <lpage>1427</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.02116-09</pub-id>
        <?supplied-pmid 20107085?>
        <pub-id pub-id-type="pmid">20107085</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Minin</surname>
          <given-names>VN</given-names>
        </name>
        <name>
          <surname>Bloomquist</surname>
          <given-names>EW</given-names>
        </name>
        <name>
          <surname>Suchard</surname>
          <given-names>MA</given-names>
        </name>
        <article-title>Smooth skyride through a rough skyline: Bayesian coalescent-based inference of population dynamics</article-title>
        <source>Mol Biol Evol</source>
        <year>2008</year>
        <volume>25</volume>
        <fpage>1459</fpage>
        <lpage>1471</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msn090</pub-id>
        <?supplied-pmid 18408232?>
        <pub-id pub-id-type="pmid">18408232</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Stadler</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Sampling-through-time in birth-death trees</article-title>
        <source>J Theor Biol</source>
        <year>2010</year>
        <volume>267</volume>
        <fpage>396</fpage>
        <lpage>404</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jtbi.2010.09.010</pub-id>
        <?supplied-pmid 20851708?>
        <pub-id pub-id-type="pmid">20851708</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <article-title>Tracer</article-title>
        <source>ᅟ</source>
        <year>ᅟ</year>
        <volume>ᅟ</volume>
        <fpage>ᅟ</fpage>
        <ext-link ext-link-type="uri" xlink:href="http://tree.bio.ed.ac.uk/software/tracer/">http://tree.bio.ed.ac.uk/software/tracer/</ext-link>
        <comment>[http://tree.bio.ed.ac.uk/software/tracer/]</comment>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Worobey</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Han</surname>
          <given-names>GZ</given-names>
        </name>
        <name>
          <surname>Rambaut</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Genesis and pathogenesis of the 1918 pandemic H1N1 influenza A virus</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2014</year>
        <volume>111</volume>
        <fpage>8107</fpage>
        <lpage>8112</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1324197111</pub-id>
        <?supplied-pmid 24778238?>
        <pub-id pub-id-type="pmid">24778238</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>dos Reis</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>Approximate likelihood calculation on a phylogeny for Bayesian estimation of divergence times</article-title>
        <source>Mol Biol Evol</source>
        <year>2011</year>
        <volume>28</volume>
        <fpage>2161</fpage>
        <lpage>2172</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msr045</pub-id>
        <?supplied-pmid 21310946?>
        <pub-id pub-id-type="pmid">21310946</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wertheim</surname>
          <given-names>JO</given-names>
        </name>
        <name>
          <surname>Fourment</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Kosakovsky Pond</surname>
          <given-names>SL</given-names>
        </name>
        <article-title>Inconsistencies in estimating the age of HIV-1 subtypes due to heterotachy</article-title>
        <source>Mol Biol Evol</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>451</fpage>
        <lpage>456</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msr266</pub-id>
        <?supplied-pmid 22045998?>
        <pub-id pub-id-type="pmid">22045998</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wagner</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Klunk</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Harbeck</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Devault</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Waglechner</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Sahl</surname>
          <given-names>JW</given-names>
        </name>
        <name>
          <surname>Enk</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Birdsell</surname>
          <given-names>DN</given-names>
        </name>
        <name>
          <surname>Kuch</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lumibao</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Poinar</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Pearson</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Fourment</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Golding</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Riehm</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Earn</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Dewitte</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Rouillard</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Grupe</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Wiechmann</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Bliska</surname>
          <given-names>JB</given-names>
        </name>
        <name>
          <surname>Keim</surname>
          <given-names>PS</given-names>
        </name>
        <name>
          <surname>Scholz</surname>
          <given-names>HC</given-names>
        </name>
        <name>
          <surname>Holmes</surname>
          <given-names>EC</given-names>
        </name>
        <name>
          <surname>Poinar</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Yersinia pestis and the Plague of Justinian 541–543 AD: a genomic analysis</article-title>
        <source>Lancet Infect Dis</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>319</fpage>
        <lpage>326</lpage>
        <pub-id pub-id-type="doi">10.1016/S1473-3099(13)70323-2</pub-id>
        <?supplied-pmid 24480148?>
        <pub-id pub-id-type="pmid">24480148</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Evol Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Evol. Biol</journal-id>
    <journal-title-group>
      <journal-title>BMC Evolutionary Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2148</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4222489</article-id>
    <article-id pub-id-type="publisher-id">s12862-014-0163-6</article-id>
    <article-id pub-id-type="pmid">25055743</article-id>
    <article-id pub-id-type="doi">10.1186/s12862-014-0163-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Novel non-parametric models to estimate evolutionary rates and divergence times from heterochronous sequence data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Fourment</surname>
          <given-names>Mathieu</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mfourment@sydney.edu.au</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Holmes</surname>
          <given-names>Edward C</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>edward.holmes@sydney.edu.au</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Marie Bashir Institute for Infectious Diseases and Biosecurity, Charles Perkins Centre, School of Biological Sciences and Sydney Medical School, The University of Sydney, Sydney, Australia</aff>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>7</month>
      <year>2014</year>
    </pub-date>
    <volume>14</volume>
    <fpage>163</fpage>
    <lpage>163</lpage>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>3</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>7</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2014 Fourment and Holmes; licensee BioMed Central Ltd</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Fourment and Holmes; licensee BioMed Central Ltd</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2148/14/163"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Early methods for estimating divergence times from gene sequence data relied on the assumption of a molecular clock. More sophisticated methods were created to model rate variation and used auto-correlation of rates, local clocks, or the so called “uncorrelated relaxed clock” where substitution rates are assumed to be drawn from a parametric distribution. In the case of Bayesian inference methods the impact of the prior on branching times is not clearly understood, and if the amount of data is limited the posterior could be strongly influenced by the prior.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We develop a maximum likelihood method – Physher – that uses local or discrete clocks to estimate evolutionary rates and divergence times from heterochronous sequence data. Using two empirical data sets we show that our discrete clock estimates are similar to those obtained by other methods, and that Physher outperformed some methods in the estimation of the root age of an influenza virus data set. A simulation analysis suggests that Physher can outperform a Bayesian method when the real topology contains two long branches below the root node, even when evolution is strongly clock-like.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>These results suggest it is advisable to use a variety of methods to estimate evolutionary rates and divergence times from heterochronous sequence data. Physher and the associated data sets used here are available online at <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/physher/">http://code.google.com/p/physher/</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>ᅟ</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Accurately estimating evolutionary (substitution) rates and divergence times is central to revealing the timing, patterns, and processes of molecular evolution. Several methods have been developed to co-estimate evolutionary rates and divergence times along a phylogeny or sets of phylogenies. The earliest and easiest method was to assume a strict molecular clock (i.e. homogenous rate among lineages). Although convenient, the assumption of a “strict” molecular clock is often violated, such that more complex models are required that are able to integrate rate variation among lineages. Sanderson [<xref ref-type="bibr" rid="B1">1</xref>] addressed this problem using non-parametric rate smoothing and by assuming that rates of consecutive lineages are correlated. Later, he adopted a maximum likelihood framework and used penalized likelihood to investigate different levels of rate correlation, and a penalty multiplier to achieve a trade-off between rate autocorrelation and goodness-of-fit [<xref ref-type="bibr" rid="B2">2</xref>]. Thorne, Kishino and Painter [<xref ref-type="bibr" rid="B3">3</xref>] further explored the idea of auto-correlation between rates using a Bayesian framework and Markov chain Monte Carlo (MCMC). To accelerate their calculations, the topology is assumed to be known and the likelihood is approximated using a multivariate normal density. The MCMC used is based on Metropolis-Hastings algorithms, which are less efficient than other implementations such as Gibbs sampling [<xref ref-type="bibr" rid="B4">4</xref>]. Hence, Lartillot [<xref ref-type="bibr" rid="B4">4</xref>] proposed an efficient Gibbs sampler using data augmentation and prior conjugacy, which was extended by Guindon [<xref ref-type="bibr" rid="B5">5</xref>] who also used an approximation to the likelihood function. Yang [<xref ref-type="bibr" rid="B6">6</xref>] employed maximum likelihood and a heuristic rate smoothing approach to calculate rates and classify lineages into rate classes. This <italic>ad hoc</italic> procedure was further improved by Aris-Brosou [<xref ref-type="bibr" rid="B7">7</xref>] using more advanced clustering methods that allow the estimation of the number of rates.</p>
    <p>In practice, however, there is no guarantee that evolutionary rates are autocorrelated. In addition, in the case of rapidly evolving organisms such as RNA viruses measurable evolution occurs across the sampling period, such that ‘heterochronous’ sequences sampled at different time-points provide valuable information about evolutionary rates. An alternative approach is therefore to allow rates to vary freely along a phylogeny, and to explicitly incorporate times of sampling. Drummond and colleagues [<xref ref-type="bibr" rid="B8">8</xref>] presented an ‘uncorrelated’ relaxed clock model in which rates are drawn independently from an underlying parametric distribution, such as lognormal or exponential. Although rates are not necessarily distributed according to a probability distribution, this approach greatly reduces the number of parameters. Another way of modelling uncorrelated rates is to assume clock-like behaviour within a particular lineage. The main difficulty with this approach is to find the number and the distribution of these local clocks on a phylogeny, although Bayesian stochastic search variable selection has now been used in this context [<xref ref-type="bibr" rid="B9">9</xref>]. More recently Heath [<xref ref-type="bibr" rid="B10">10</xref>] proposed a model where lineages are assigned a substitution rate value according to the Dirichlet process prior.</p>
    <p>Herein, we propose a simple maximum likelihood-based approach to infer substitution rates and divergence times from heterochronous nucleotide sequences. Given a rooted tree, rate variation among lineages is modelled using either local (LC) or discrete (DC) clocks. Our definition of a ‘local clock’ is the same as that used previously [<xref ref-type="bibr" rid="B9">9</xref>] and assumes that while the substitution rate may vary across a phylogeny, some adjacent lineages evolve at the same rate. In contrast, the ‘discrete clock’ model assumes that a number of substitution rate categories are assigned to lineages without assuming autocorrelation and where lineages that are not adjacent are able to share a rate category. We devised a heuristic approach using a greedy algorithm to infer the distribution of local clocks along a phylogeny, referred to here as the Heuristic Local Clock (HLC) algorithm. The estimates of the best model can be fed to a genetic algorithm (GA) to re-estimate the rates and local clock positions, and calculate model-averaged estimates of the substitution rate and time parameters (i.e. GALC). Similarly, we present a GA to determine the number and allocation of rate categories under a discrete clock model (GADC). The greedy algorithm and GAs are optimized to run efficiently on a distributed computing environment using OpenMP. Finally, we demonstrate the efficiency of the program using data sets of human influenza viruses and simulated data sets.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Models of rate variation among lineages</title>
      <p>Given <italic>n</italic> nucleotide sequences and a rooted phylogeny with <italic>N = 2n-2</italic> branches, we set out to model rate heterogeneity along lineages using local clocks or a discrete distribution of rates.</p>
      <p>We define a local clock on a phylogeny as a monophyletic group where every lineage evolves at exactly the same substitution rate. This definition assumes the existence of another clock (e.g. ‘global’ clock) for lineages that are not assigned a local clock. We model each local clock and the global clock as independent rate classes. In the absence of local clocks, the model corresponds to a strict clock; the other extreme is to have one rate per branch, leading to an over-parameterized model. The optimization challenge for this problem is two-fold: finding the number and location of the local clocks along a phylogeny (discrete optimization) and estimating rates and ages of internal nodes (continuous optimization). The difficulty in using this type of clock lies in the discrete optimization component because of the size of the combinatorial search space. With <italic>2</italic><sup><italic>2n-2</italic></sup> rate combinations, it is impossible to adopt a brute force approach and heuristic algorithms must be used instead.</p>
      <p>We also consider an alternative and more flexible parameterization to local clocks by assigning independent substitution rate classes to lineages to model lineage-specific rate heterogeneity. Unlike the local clock model, this discrete clock model allows non-adjacent lineages to evolve under the same substitution rate. Local clocks are therefore a special case of discrete clocks. Given a fixed number of rate categories <italic>k</italic>, the parameters of the discrete substitution model is a vector of rates <bold><italic>r</italic></bold> = (<italic>r</italic><sub>1</sub>, <italic>r</italic><sub>2</sub>, …, <italic>r</italic><sub><italic>k</italic></sub>) and a vector of rate-class assignments for each lineage <bold><italic>c</italic></bold> = (<italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>, …, <italic>c</italic><sub>2<italic>n</italic> − 2</sub>) where <italic>c</italic><sub><italic>i</italic></sub> ∈ 1 … <italic>k</italic>. Using an appropriate ordering of the <italic>2n-2</italic> branches, each element of vector <bold><italic>c</italic></bold> represents the class assignment of a branch. In our implementation, the number of rate categories is not fixed and is co-estimated with node heights and vector <bold><italic>r</italic></bold> from the data. The number of combinations for the discrete clock algorithm is also computationally difficult and warrants the use of approximation methods. The number of combinations is described by the Bell number <inline-formula><mml:math id="M1" overflow="scroll"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mstyle></mml:math></inline-formula> where <italic>N</italic> is the number of branches and<disp-formula id="bmcM1"><label>(1)</label><mml:math id="M2" name="s12862-014-0163-6-i1" overflow="scroll"><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>k</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mi>i</mml:mi></mml:msup><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula>is the Stirling number of the second kind. For example, for a relatively small data set of 20 sequences, there are approximately 7 × 10<sup>32</sup> possible combinations.</p>
    </sec>
    <sec>
      <title>Algorithms</title>
      <p>One solution to search the high-dimensional parameter space of the local and discrete clock models without using an MCMC is to use a genetic algorithm (GA). GAs belong to a class of evolutionary algorithms that simulate natural selection in a population of individuals to solve an optimization problem. Most algorithms require encoding solutions in a vector and are therefore well suited to discrete optimization. Each individual represents a candidate solution from which a fitness score can be calculated. Individuals with high fitness, and therefore a promising solution, are more likely to be selected during a stochastic step (mating or recombination) to form the next generation. In analogy to biological processes, candidate solutions randomly mutate to promote diversity within the population. GAs are therefore generational processes that stochastically move populations around a fitness landscape. The simplest form of genetic algorithm requires a fitness function and three operators: recombination, selection and mutation.</p>
      <p>We implemented the GA as a generational genetic search algorithm CHC GA [<xref ref-type="bibr" rid="B11">11</xref>]; this approach was previously applied to the detection of both recombination [<xref ref-type="bibr" rid="B12">12</xref>] and natural selection [<xref ref-type="bibr" rid="B13">13</xref>]. The population size of CHC GAs are usually smaller than traditional GAs and use an elitist selection operator that always allows the fittest individual to be selected for the next generation. In our analyses, we used a fixed population size of 30 individuals. In addition, it uses a highly disruptive recombination operator that generates a new individual with a solution that contains half the solution from the first parent and the other half from the second parent. The mutation step is only triggered when the diversity of the population is below a fixed threshold by mutating a fixed number of elements of the solution vector. Given a fixed number of rate classes, the fitness function is simply the likelihood score since every model has the same number of parameters. The mutation and recombination operators for the local and discrete clocks are different and will be presented in the next sections.</p>
      <p>Finding the number of rate classes is more challenging and is not easily addressed with GAs, as it requires jumping between parameter spaces with different dimensions. We use an iterative approach, starting with two rate classes and increment the number of classes until the addition of a rate class stops improving the fitness of the model. During each iteration, a new population is evolved, leading to the fittest model that will be compared to the next iteration. To test whether the addition of a rate class improves the fitness of the model, we assess the goodness of fit of each model using the Akaike Information Criterion with a correction for small sample sizes (<italic>AICc</italic>; the lowest <italic>AICc</italic> represents the best model):<disp-formula id="bmcM2"><label>(2)</label><mml:math id="M3" name="s12862-014-0163-6-i2" overflow="scroll"><mml:mi mathvariant="italic">AICc</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>L</mml:mi><mml:mi>n</mml:mi><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:math></disp-formula>where <inline-formula><mml:math id="M4" overflow="scroll"><mml:mi>L</mml:mi><mml:mi>n</mml:mi><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math></inline-formula> is the maximum likelihood estimate under the model of interest, <italic>k</italic> is the number of parameters and <italic>s</italic> is the sample size. We set the sample size as the number of site patterns in the alignment.</p>
      <p>In the local clock model, each individual of the GA population is represented as a vector where each element maps a local clock to a branch in the phylogenetic tree. If a branch is assigned a local clock, its descendants will belong to the same local clock unless they are assigned a new local clock. The mutation operator randomly changes the location of the local clock. The recombination operator selects two individuals from the population and generates a new individual by randomly choosing the value of one of the parents for each element of the vector state. In the current implementation of the GA, both operators do not allow a local clock to be assigned more than once. The most extreme case is when there is only one local clock: the vector is of size one and recombination has no effect. For models containing a few local clocks, the diversity of the population drops under the threshold after the first round of mating. To escape this problem a mutation rate close to 100% is needed, defeating the purpose of evolutionary algorithms. A solution to this problem would be to start the GA with several local clocks, but determining an appropriate number of local clocks is difficult. Alternatively, we could employ exhaustive search on all the combinations of local clocks but this is only possible for small data sets. We implemented a greedy algorithm that starts with one local clock, fits in turn a local clock to each branch, and retains the location of the local clock that yields the best likelihood. In each subsequent iteration, another local clock is considered on each branch that does not have a local clock already assigned. The algorithm stops either when the addition of a parameter does not improve the fitness of the model based the <italic>AICc</italic> or when the number of clocks exceeds a user-defined threshold <italic>T</italic> (typically <italic>T &lt;&lt;N-1</italic>). Therefore, the algorithm will evaluate a maximum <inline-formula><mml:math id="M5" overflow="scroll"><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> models.</p>
      <p>The best model found by the greedy search will have enough parameters for a GA to more efficiently sample the parameter space without the convergence issue discussed earlier. Hence, we use the fittest model of the greedy search to seed the GA. This approach allows us to assess other combinations that were not previously tested. Since models with different numbers of classes are not necessarily nested we also compute <italic>AICc</italic> to compare models.</p>
      <p>Given a fixed number of rate classes, the encoding of each individual of the GA in the discrete clock model is represented as vector of size <italic>N</italic> where each element represents the class assignment of a branch. The number of rate classes can take any value between 1 (strict clock) and <italic>N</italic> (one rate per branch), although the number of classes should be much smaller than <italic>N</italic> in order to limit model complexity as mentioned earlier. The recombination operator for the discrete model simply selects two individuals from the population and generates a new individual by randomly choosing the value of one of the parents for each element of the vector state. During the mutation step, each element of the vector is subject to switching to a different class assignment with fixed probability. As in the GA for local clocks we adopt a forward selection approach, starting with two rate classes and increment by one the number of rate classes until the <italic>AICc</italic> stops decreasing.</p>
      <p>Finding the combination of rate classes using the greedy algorithm described above is substantially more difficult as the combinatorial complexity increases; therefore, we employ a CHC-GA to search through the parameter space.</p>
    </sec>
    <sec>
      <title>Model averaging and confidence intervals</title>
      <p>Uncertainty is inherent to selecting the best model. As a consequence it might be desirable to model average estimated parameters across all the models <italic>M</italic> explored by the GA. First, we need to compute for each model <italic>M</italic><sub><italic>i</italic></sub> the <italic>AIC</italic> difference (Δ<sub>i</sub>) between the best model and itself such as Δ<sub><italic>i</italic></sub> = <italic>AIC</italic><sub><italic>min</italic></sub> − <italic>AIC</italic><sub><italic>i</italic></sub>, where <italic>AIC</italic><sub><italic>min</italic></sub> is the <italic>AIC</italic> of the best model. Akaike weights are now calculated as:<disp-formula id="bmcM3"><label>(3)</label><mml:math id="M6" name="s12862-014-0163-6-i3" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:msup><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="true">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:msup></mml:mrow></mml:mstyle></mml:mfrac></mml:math></disp-formula>where the numerator is the relative likelihood of model <italic>M</italic><sub><italic>i</italic></sub> and the denominator is a normalization term. The relative likelihood can be interpreted as the relative probability that the <italic>i</italic><sup><italic>th</italic></sup> model minimizes the information loss. Once the models are sorted in decreasing order, we can obtain a confidence set of models by summing the weights from the largest to the lowest until the sum is (1-α) where α is the significance level. Descriptive statistics such as mean and quantiles can be applied to each parameter using the models belonging to this set.</p>
      <p>To investigate the uncertainty of the point estimates under a strict clock and a local clock model with the greedy algorithm, we calculated confidence intervals (CI) using the non-parametric percentile bootstrap method [<xref ref-type="bibr" rid="B14">14</xref>]. The percentile bootstrap uses the empirical quantiles from the bootstrap distribution of the parameter <italic>θ</italic> to calculate the confidence interval <inline-formula><mml:math id="M7" overflow="scroll"><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>*</mml:mo></mml:msubsup><mml:mo>;</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfenced></mml:math></inline-formula> where <italic>α</italic> is the significance level and <inline-formula><mml:math id="M8" overflow="scroll"><mml:msubsup><mml:mi>θ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M9" overflow="scroll"><mml:msubsup><mml:mi>θ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> are the <italic>α</italic>/2 and 1 − <italic>α</italic>/2 percentile of the bootstrap coefficients <italic>θ</italic>*.</p>
    </sec>
    <sec>
      <title>Program workflow</title>
      <p>The first step that is common to the GA and greedy algorithms is to estimate the branch lengths (in term of expected number of substitution per site) of the phylogeny and the parameters of the substitution model by maximum likelihood. The likelihood of this parameter rich non-clock model will give us an upper-bound for the likelihood of the global, local and discrete clock models. The parameters of the substitution rate matrix are fixed during the rest of the algorithm as we make the assumption that nucleotide frequencies and relative rates are not affected by explicitly modelling substitution rates. Next, we estimate the age of <italic>n-1</italic> internal nodes and the substitution rate under a strict clock model. This simplistic model, if violated, gives us the lower-bound in term of likelihood and the starting point for statistically testing the introduction of rate heterogeneity in the model. Because we are explicitly dealing with heterochronous sequences, every taxon must be assigned a fixed date.</p>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>Since the GA and greedy search algorithms presented in this paper are embarrassingly parallel problems, we implemented the program within the OpenMP framework to run on distributed systems. The evaluation of the likelihood for each configuration of clocks was therefore computed by a single thread. Finally, the likelihood is calculated using Felsenstein’s pruning algorithm [<xref ref-type="bibr" rid="B15">15</xref>] and is optimised with SSE-based SIMD vectorization. These methods are implemented in a C program called Physher. Simulated data sets were generated with a custom program that uses a library shared with Physher.</p>
    </sec>
    <sec>
      <title>Data sets and analysis</title>
      <p>We applied our algorithms to two data sets of heterochronous viral nucleotide sequences. The first data set comprises an alignment of 69 human influenza A/H3N2 virus haemagglutinin (HA) sequences (987 nt in length) isolated between 1981 and 1998. The evolutionary rates and time to the most recent ancestors (tMRCAs) of this data set was previously investigated using a random local clock method [<xref ref-type="bibr" rid="B9">9</xref>] with a Bayesian MCMC approach implemented in BEAST [<xref ref-type="bibr" rid="B16">16</xref>]. As in the original study, the alignment was analysed using strict, local and discrete clocks implemented in Physher under the HKY + Γ<sub>4</sub> substitution model that incorporates gamma-distributed rate variation among sites (4 rate classes). We reanalysed the data using BEAST with either an uncorrelated lognormal relaxed-clock (UCLN) or a random local clock model (RLC) and calculated the Bayes factor (BF) using the path sampling method [<xref ref-type="bibr" rid="B17">17</xref>] to compare competing models. We performed a series of simulations to assess the effect of stochastic noise over the phylogenetic signal. Accordingly, data sets of 1000, 2000 and 10,000 nucleotides (nt) in length were simulated along a ladder-like tree containing 16 taxa that represents a simplified version of the influenza A data set (Figure <xref ref-type="fig" rid="F1">1</xref>). The root age is 25 years, the global rate is set to 5 × 10<sup>−3</sup> subs/site/year and a local clock is set in the middle of the tree inducing a rate shift with rate equal to 10<sup>−2</sup> subs/site/year. 50 replicates were simulated under the HKY model with equal nucleotide frequencies, a transition to transversion rate ratio <italic>κ</italic> = 3, and a gamma shape <italic>α</italic> = 0.5. These data sets were analysed using the RLC and UCLN with a constant size coalescent model and an exponential prior on the rate with mean 8 × 10<sup>−3</sup> subs/site/year using BEAST. The GADC and HLC models were used in Physher.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Phylogeny used for simulating data sets under a local clock model.</bold> Lineages are coloured according to their substitution rates.</p>
        </caption>
        <graphic xlink:href="s12862-014-0163-6-1"/>
      </fig>
      <p>The second data set comprising 265 full-length HA genes (1382 nt in length) of influenza B virus, containing sequences from the co-circulating Yamagata and Victoria lineages isolated between 2002 and 2013. Each taxon was calibrated using year, month, and day of isolation. The substitution rate and tMRCA were estimated under a GTR + Γ<sub>4</sub> substitution model using strict and discrete clocks with Physher. The data was also analysed using BEAST [<xref ref-type="bibr" rid="B16">16</xref>] under a strict clock and an uncorrelated lognormal relaxed clock and with both constant population size and Bayesian skyride tree priors. As previous analyses [<xref ref-type="bibr" rid="B18">18</xref>] estimated the substitution rate for influenza B virus to be 1 – 3 × 10<sup>−3</sup> nucleotide substitutions per site per year (subs/site/year), we used an exponential prior with mean 3 × 10<sup>−3</sup> subs/site/year on the mean of the lognormal distribution and strict rate parameter. We did not use any prior assumption on the age of the root.</p>
      <p>Influenza B virus data sets were also simulated under a strict molecular clock using divergence times, substitution rates and other substitution parameters estimated by Physher. These data sets are effectively parametric bootstraps with a fixed topology. The parameters of importance in this simulation are the substitution rate, for which the Physher estimate was 1.4 × 10<sup>−3</sup> subs/site/year and the age of the root (<italic>t</italic> = 1967) (see Results). In this case we know that the root predates, or should be close, to 1972 since the two main lineages became antigenically distinct in the 1970’s [<xref ref-type="bibr" rid="B19">19</xref>] and the earliest virus that emerged after the split was sampled in 1972. We analysed 50 replicates with Physher and BEAST using a strict clock. The BEAST analyses were performed using a constant population size, and both the Bayesian skyride [<xref ref-type="bibr" rid="B20">20</xref>] and the constant rate birth-death methods [<xref ref-type="bibr" rid="B21">21</xref>]. To investigate the effect of allowing rate variation among lineages we also analysed the replicates using an uncorrelated relaxed lognormal prior. In this case we used an exponential prior with mean 2 × 10<sup>−3</sup> subs/site/year on the mean of the lognormal distribution and strict rate parameter. We performed at least two analyses of 20 million generations each and used Tracer [<xref ref-type="bibr" rid="B22">22</xref>] to assess the stationarity of the chain and to discard an appropriate number of generations. Support for the substitution rate and root age was given by 95% highest posterior density intervals. Confidence intervals were derived using the percentile bootstrap method with 200 replicates. We also inferred the rate and root age, using a fixed topology, by regressing the expected number of substitution per site from the root to each tip from the maximum likelihood tree against sampling times with Physher. To obtain a rooted a tree, a node (the root) needs to be inserted in the unrooted tree by splitting a branch in two. We estimate the location of the root as the location that maximizes the coefficient of correlation between time and the expected number of substitutions. The rate and root age are defined as the slope and intercept of the regression line, respectively.</p>
      <p>To validate our algorithms we simulated two series of data sets of 2000 nt in length using a local clock model with two local clocks and a discrete clock with three rate classes (Figure <xref ref-type="fig" rid="F2">2</xref>). The age of the root was 15 years and the rates were 3 × 10<sup>−3</sup>, 5 × 10<sup>−3</sup>, and 10<sup>−2</sup> subs/site/year. We analysed 50 replicates of each scheme using Physher with a strict, local, and discrete clock and the confidence intervals of the root were derived for the root age using the methods described previously.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Phylogenies used for simulating data sets under different clock models.</bold> Lineages are coloured according to their substitution rates. <bold>(a)</bold> Phylogeny with two local clocks. <bold>(b)</bold> Phylogeny with three rate classes.</p>
        </caption>
        <graphic xlink:href="s12862-014-0163-6-2"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Influenza A virus</title>
      <sec>
        <title>Empirical data</title>
        <p>We used our local and discrete clock methods to investigate rate heterogeneity of the influenza A virus data set (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S1) by comparing the <italic>AICc</italic> of a strict clock to models that allow rate heterogeneity among lineages. The greedy algorithm found that ten local clocks were the best-fit to the data, improving the log-likelihood from −4159.51 (<italic>AICc</italic> = 8484.73) under the strict molecular clock to −4118.58 (<italic>AICc</italic> = 8420.17) under the local clock. Subsequently, we ran a GA starting with ten local clocks to check that the greedy search did not get trapped in local optima, but this approach failed to find a better model.</p>
        <p>We also modelled rate variation with a discrete clock and allocated the rate categories to each lineage using a genetic algorithm. We started the algorithm with two rate classes and incremented the number of classes until the fit of the model stopped improving based on the <italic>AICc</italic>. The algorithm suggested that the maximum likelihood is −4104.59 and that the optimal number of rate classes is four. The <italic>AICc</italic> value of the GADC model (<italic>AICc</italic> = 8376.4) was smaller than the HLC model. The relative likelihood of the HLC model is about 10<sup>−23</sup>, suggesting that the GADC model is about 10<sup>23</sup> times more likely to be correct than the HLC model.</p>
        <p>The mode of the posterior distribution of the number of local clocks reported by Drummond and Suchard [<xref ref-type="bibr" rid="B9">9</xref>] was significantly lower than our estimate suggesting that two local clocks were appropriate for this data set. The important difference between our estimates is probably due to the specification of the prior that placed 50% of the mass on a unique clock. Although the root height estimates inferred using our two methods (HLC: 1974.6, CI: 1953.2-1979.27; GADC: 1979.7, CI: 1978.5-1980) are in agreement with their estimate [<xref ref-type="bibr" rid="B9">9</xref>] (RLC: 1979, BCI: 1977.98-1979.93, UCLN: 1977.8, BCI: 1975.8-1979.6), the UCLN and GADC models show no obvious rate shift (Figure <xref ref-type="fig" rid="F3">3</xref>), and rates between each branch and its parent are uncorrelated (r = −5 × 10<sup>−3</sup>; p-value = 0.95). To check whether this shift was caused by the specification of the local clock model we reanalysed the same data set with an uncorrelated lognormal relaxed-clock model using BEAST. If the viral genomes underwent a phase of accelerated mutation rate the UCLN model would be able to recover the same pattern. The distribution over the rates using UCLN does not show this trend although the root height estimate is similar (1978.83, BCI: 1977.06-1980.25). The Bayes factor calculated using the path sampling method (log BF = −8.4) suggests the UCLN model (log marginal likelihood = −4384.83) is strongly preferred to the local clock model (log marginal likelihood = −4388.25).</p>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p><bold>Influenza phylogenies estimated using Bayesian and maximum likelihood methods.</bold> Branches are coloured according to their rates using a gradient from blue (low rate) to red (high rate). <bold>(a)</bold> Maximum likelihood inference using a local clock model. <bold>(b)</bold> Maximum likelihood inference using a discrete clock model. <bold>(c)</bold> Bayesian inference using a local clock model. <bold>(d)</bold> Bayesian inference using an uncorrelated lognormal relaxed clock.</p>
          </caption>
          <graphic xlink:href="s12862-014-0163-6-3"/>
        </fig>
      </sec>
      <sec>
        <title>Simulations</title>
        <p>We simulated 50 data sets of different length with a rate shift occurring in the middle branch of a completely asymmetric phylogeny (Figure <xref ref-type="fig" rid="F1">1</xref>). Each panel of Figure <xref ref-type="fig" rid="F4">4</xref> depicts rate variation using a heatmap for 50 replicates where each row represents a replicate and each column indexes a branch. Because of the ladder-like nature of the phylogenies, each tree was linearized using a postorder traversal of the tree, allowing visualisation of rate through time. Starting from the left, the first cell is represents the rate (mean for BEAST and maximum likelihood estimate for Physher) for the branch leading to the earliest taxon and the last two cells represent the rates of the branches leading to the youngest. Between these cells, rates at branches leading to internal and external nodes alternate. These plots clearly show a rate shift when a local clock is used with BEAST and Physher. Plots generated with UCLN and discrete clock models show a more nuanced picture where low and high rates tend to blend together.</p>
        <fig id="F4" position="float">
          <label>Figure 4</label>
          <caption>
            <p><bold>Substitution rates for simulated data sets with a rate shift.</bold> Substitution rate variation in simulated data sets of length 1000, 2000, and 10000 nt using random local (RLC) and relaxed lognormal (UCLN) clock models implemented in BEAST and local (HLC) and discrete (GADC) clock models implemented in Physher. Each row represents a replicate and each column represent a branch where the rightmost cell is a branch leading to latest taxon and the leftmost cell is a branch near the root. Each cell maps a branch is coloured according to its substitution rate using a gradient from blue (low rate) to red (high rate).</p>
          </caption>
          <graphic xlink:href="s12862-014-0163-6-4"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Influenza B virus</title>
      <sec>
        <title>Empirical data</title>
        <p>We analysed the influenza B virus data set using Physher under both non-clock (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Figure S2) (log likelihood LnL = −9503.2) and strict clock (LnL = −9585.9) models. To test whether every lineage evolved at the same rate, we used the likelihood ratio test [<xref ref-type="bibr" rid="B15">15</xref>]. The comparison of twice the log-likelihood difference with a χ<sup>2</sup> distribution with 262 degrees of freedom suggests the strict clock model could not be rejected (p-value = 0.99). The estimate of the substitution rate was 1.42 × 10<sup>−3</sup> subs/site/year with 95% bootstrap confidence interval [1.2 × 10<sup>−3</sup>, 1.49 × 10<sup>−3</sup>]. The divergence time of the two lineages is estimated to be 1966 (95% CI: 1959, 1971). The same data set was reanalysed using BEAST and the mean substitution rate estimate was 2.1 × 10<sup>−3</sup> subs/site/year (95% BCI: 1.85 × 10<sup>−3</sup>, 2.36 × 10<sup>−3</sup>) under a constant population size coalescent model and 2.72 × 10<sup>−3</sup> subs/site/year (95% Bayesian CI: 2.4 × 10<sup>−3</sup>, 3 × 10<sup>−3</sup>) using the Bayesian skyride tree prior. Similarly the mean root age estimate was 1978 (95% Bayesian CI: 1973,1984) under a constant population size coalescent model and 1998 (95% Bayesian CI: 1997,1999) using the Bayesian skyride method and hence considerably more recent that the ‘true’ estimate.</p>
      </sec>
      <sec>
        <title>Simulations</title>
        <p>We simulated 50 data set replicates using the parameters estimated with Physher in the influenza B analysis and then re-estimated the parameters using Physher and BEAST. We initially used a strict molecular clock with BEAST. Using a constant size coalescent model (Figure <xref ref-type="fig" rid="F5">5</xref>) none of the Bayesian credible intervals of the substitution rate contained the true rate, and only one interval contained the true root age. The substitution rate was consistently overestimated while the age of the root was consistently underestimated. More striking was that the Bayesian skyride coalescent model underperformed compared to the constant size model, under-estimating the age of the root by about 20 years, as was seen with the empirical data (Figure <xref ref-type="fig" rid="F6">6</xref>). The same pattern of over-estimation of the rate and underestimation of the root age was observed using a lognormal relaxed clock. Interestingly, the confidence interval of the standard deviation of the lognormal distribution and coefficient of variation did not include 0 using the Bayesian skyride method, suggesting that there was rate variation in the data. Finally, using a birth-death process prior, the rate and root age could not be recovered in any of the replicates (Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>: Figure S3). The bootstrap analysis with Physher showed that 40 intervals contained the true substitution rate and 43 intervals contained the true root age (Figure <xref ref-type="fig" rid="F7">7</xref>). Finally, the rate and root age estimates using a simple linear regression in Physher are consistent with our maximum likelihood estimates (Additional file <xref ref-type="supplementary-material" rid="S4">4</xref>: Figure S4).</p>
        <fig id="F5" position="float">
          <label>Figure 5</label>
          <caption>
            <p><bold>95% Bayesian confidence intervals of substitution rate and root age using the coalescent prior and a strict molecular clock on 50 simulated data sets.</bold> Parameters are estimated using BEAST for 50 replicates under a strict molecular clock and a coalescent tree prior. Intervals that do not include the true value (blue line) are shown in red. Nucleotide substitution rate <bold>(a)</bold> and root age <bold>(b)</bold> inferred using a constant size tree prior. Nucleotide substitution rate <bold>(c)</bold> and root age <bold>(d)</bold> inferred using the Bayesian skyride method.</p>
          </caption>
          <graphic xlink:href="s12862-014-0163-6-5"/>
        </fig>
        <fig id="F6" position="float">
          <label>Figure 6</label>
          <caption>
            <p><bold>95% Bayesian confidence intervals of substitution rate and root age using a coalescent prior a nd a relaxed molecular clock on 50 simulated data sets.</bold> Intervals are estimated using BEAST for 50 replicates under a lognormal molecular clock and a coalescent tree prior. Intervals that do not include the true value (blue line) are shown in red. Nucleotide substitution rate <bold>(a)</bold> and root age <bold>(b)</bold> inferred using a constant size tree prior. Nucleotide substitution rate <bold>(c)</bold> and root age <bold>(d)</bold> inferred using the Bayesian skyride method.</p>
          </caption>
          <graphic xlink:href="s12862-014-0163-6-6"/>
        </fig>
        <fig id="F7" position="float">
          <label>Figure 7</label>
          <caption>
            <p><bold>95% bootstrap confidence intervals of substitution rate and root age using maximum likelihood and a strict molecular clock on 50 simulated data sets.</bold> The nucleotide substitution rate <bold>(a)</bold> and root age <bold>(b)</bold> are inferred using Physher for 50 replicates using a strict molecular clock. Red intervals that do not include the true value (blue line) are shown in red.</p>
          </caption>
          <graphic xlink:href="s12862-014-0163-6-7"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Additional simulations</title>
      <p>Finally, we performed two sets of simulations with two local clocks and three discrete classes. The phylogeny and the rate allocation to lineages are shown in Figure <xref ref-type="fig" rid="F2">2</xref>. Table <xref ref-type="table" rid="T1">1</xref> shows the number of replicates (out of 50 replicates) for which the true root age lies within the 95% confidence interval. As expected, the strict clock model does not perform well in the presence of rate variation. The local clock model recovered the true root age in every replicate simulated with a local clock and it recovered the true root age in 49 of 50 replicates simulated under a discrete clock model. The discrete clock model recovered the true root age in 48 and 46 replicates in the local and discrete clock data sets. The distribution of the estimated number of rates suggests that the discrete model tends to under-fit the data by assigning two rate classes to most replicates.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Results of the analysis of simulated data sets</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
          </colgroup>
          <thead>
            <tr valign="top">
              <th align="left" valign="top">
                <bold>Clock</bold>
                <hr/>
              </th>
              <th colspan="2" align="left" valign="top">
                <bold>Two local clocks</bold>
                <hr/>
              </th>
              <th colspan="2" align="left" valign="top">
                <bold>Three discrete rate classes</bold>
                <hr/>
              </th>
            </tr>
            <tr valign="top">
              <th align="left" valign="top"> </th>
              <th align="left" valign="top">
                <bold>Root age</bold>
              </th>
              <th align="left" valign="top">
                <bold>Number of rates</bold>
              </th>
              <th align="left" valign="top">
                <bold>Root age</bold>
              </th>
              <th align="left" valign="top">
                <bold>Number of rates</bold>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr valign="top">
              <td align="left" valign="top">Strict<hr/></td>
              <td align="left" valign="top">29<hr/></td>
              <td align="left" valign="top">1<hr/></td>
              <td align="left" valign="top">33<hr/></td>
              <td align="left" valign="top">1<hr/></td>
            </tr>
            <tr valign="top">
              <td align="left" valign="top">Local<hr/></td>
              <td align="left" valign="top">50<hr/></td>
              <td align="left" valign="top">2 (4), 3 (34), 4 (10), 5 (2)<hr/></td>
              <td align="left" valign="top">49<hr/></td>
              <td align="left" valign="top">2 (16), 3 (11), 4 (18), 5 (5)<hr/></td>
            </tr>
            <tr valign="top">
              <td align="left" valign="top">Discrete</td>
              <td align="left" valign="top">49</td>
              <td align="left" valign="top">2 (35), 3 (15)</td>
              <td align="left" valign="top">46</td>
              <td align="left" valign="top">2 (49), 3 (1)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The table shows the number of replicates (out of 50) for which the true root age lies within the 95% confidence interval estimated by Physher for data sets simulated under two different clock models. The ‘number of rates’ column shows the distribution of the estimated number of rates with their proportion between brackets.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>We describe local and discrete clock models to estimate nucleotide substitution rates from heterochronous sequence data sets within a maximum likelihood framework and in the presence of rate heterogeneity among lineages.</p>
    <p>The analysis of influenza A virus shows that the discrete clock model fits the data better than the local clock model, as suggested by the Bayes factor calculated using BEAST and the relative likelihood calculated using Physher. Although root age estimates under local and discrete clocks are similar, the relaxed (UCLN) and the discrete clock failed to recover the rate shift pattern that Drummond and Suchard [<xref ref-type="bibr" rid="B9">9</xref>] first identified using a random local clock. We performed a series of simulations by generating alignments of 1000, 2000, and 10,000 nt in length with a tree similar to the influenza A virus data set and with a rate shift in the centre of the tree (Figure <xref ref-type="fig" rid="F1">1</xref>). While the local clock algorithms recovered the location of the rate shift for the shortest alignments, the relaxed and discrete clock model failed to identify the rate shift for data sets of 1000 and 2000 nt. The rate shift only becomes apparent for the data set of 10,000 nt under the discrete model. These simulations therefore confirm that more flexible models cannot recover a single rate shift from 5 × 10<sup>−3</sup> to 10<sup>−2</sup> subs/site/year for relatively short alignments. A likely explanation for this discrepancy is that there is not enough data for the UCLN and DC models to recover the true distribution of rate and a certain degree of autocorrelation is needed to correctly identify rate variation.</p>
    <p>With limited data, Bayesian-based inference should perform better than the maximum likelihood method if one can use an appropriate prior on the branching times. Unfortunately, it can produce posterior distributions that are heavily influenced by priors, as is probably the case in our simulation study where no coalescent model might be appropriate. The two main classes of prior that are currently used are coalescent processes and the birth-death process. The coalescent process is a function of the effective population size (<italic>N</italic><sub><italic>e</italic></sub>) scaled by the generation time (<italic>τ</italic>), and since no assumptions are made about the generation time in our analyses we refer to this composite parameter (<italic>θ</italic> = <italic>N</italic><sub><italic>e</italic></sub><italic>τ</italic>) as the relative genetic diversity. The relative size function can be constant, distributed according to a parametric distribution (e.g. exponential distribution) or any function of time. Importantly, in data sets that contain several lineages that evolved concurrently with incomplete sampling of extant taxa (e.g. influenza B virus data set) these priors can produce spurious results. Using simulations it was shown that relaxed clock models can greatly underestimate the age of the root when lineages exhibit strong rate heterogeneity [<xref ref-type="bibr" rid="B23">23</xref>]. In the influenza B virus example, the two long branches below the root node (i.e. the ancestors of the Victoria and Yamagata lineages) suggest an initially large relative genetic diversity. With a fluctuating relative diversity the constant coalescent appears to be a poor choice of prior and the Bayesian skyride method should be more appropriate. Indeed, it is striking that the age of the root estimated with BEAST using different priors is significantly younger than the Physher estimate. Hence, we suggest that using a relaxed molecular clock with the Bayesian skyride method should be avoided when a tree contains long branches at the root. In our analyses, the prior appears to overpower the likelihood and is in a favour of a younger root age with a faster rate.</p>
    <p>Genetic algorithms appear to be well suited for optimizing the allocation of discrete clocks but their efficiency in the local clock problem is arguable, probably due to the different solution encodings. In the discrete case the individual size is the number of branches (N = <italic>2n-2)</italic>, whereas in the local clock setting the length of each individual is equal to the number of local clocks being investigated. In the influenza A virus data set, we started the GA with ten local clocks. Discrete optimization is notoriously more difficult than its continuous counterpart because functions are generally not convex and because a modification of only one of the variables can significantly change the likelihood of the model.</p>
    <p>With respect to performance, the greedy algorithm finished in about 20 minutes on a Mac Pro 3.33 GHz 6-core and the discrete clock GA converged in about two hours for the analysis of the influenza virus A data set. For 20 million cycles, the random local clock ran for approximately 4 hours and the relaxed clock ran for about 5 hours. It is important to highlight that although Physher appears faster than BEAST, Physher optimizes a single topology while BEAST integrate over topologies.</p>
    <p>The algorithms described in this paper rely on some common assumptions but differ from other methods in several ways. Several published algorithms [<xref ref-type="bibr" rid="B1">1</xref>],[<xref ref-type="bibr" rid="B3">3</xref>],[<xref ref-type="bibr" rid="B5">5</xref>],[<xref ref-type="bibr" rid="B6">6</xref>] use a normal approximation to the costly likelihood function, while Sanderson [<xref ref-type="bibr" rid="B2">2</xref>] used a Poisson approximation to describe the mutation process. Some work has also been done on improving the approximate likelihood calculation using parameters transform [<xref ref-type="bibr" rid="B24">24</xref>]. To speed-up our inferences we rely instead on parallelization of our algorithms, hence avoiding the assumption that the parameters (product of rate and time) are sufficiently close to the maximum likelihood estimates of the branch lengths inferred in the rate-free analysis. Like many methods we assumed that the rooted tree topology is known; while this is computationally attractive, this assumption is not always realistic. Notably, Aris-Brosou [<xref ref-type="bibr" rid="B7">7</xref>] investigated the impact of ignoring topology uncertainty on an empirical data set and revealed no significant differences in age estimates when topology uncertainty was integrated.</p>
    <p>The nearly constant substitution rate of the human influenza B virus phylogeny should provide a set of favourable conditions for the estimation of these parameters. Importantly, our simulations suggest that estimating divergence times is difficult if the prior overrides the data even when the substitution rate is constant. Wertheim et al. [<xref ref-type="bibr" rid="B25">25</xref>] previously pointed out how rate variation resulted in major discrepancies in the estimation of the age of HIV-1 M group subtypes when each subtype was analysed separately or combined in a total data set of all subtypes. In a similar way to the influenza B virus simulations undertaken here, prior information on the topology could also be a reason for this discrepancy between full phylogeny and sub-tree only estimates. Finally, if a data set contains weak or no temporal signal (i.e. strong rate variation), the estimation of the evolutionary history will be impossible [<xref ref-type="bibr" rid="B26">26</xref>].</p>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>We have presented algorithms to estimate evolutionary rates and divergence times from heterochronous gene sequence data without making assumptions about the distribution of rates across a phylogeny. In our analyses the local clock underperformed compared to the discrete clock model, and empirical data that show use of local clock models is only warranted when there is a clear rate shift among lineages. We also show that current Bayesian methods can sometimes fail to recover true node ages and rates due to the specification of the prior.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>MF conceived and designed the experiments. MF implemented the software Physher. Both authors were involved in the writing of the manuscript. Both authors read and approved the final manuscript.</p>
  </sec>
  <sec>
    <title>Additional files</title>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1:</title>
        <p><bold>Maximum likelihood phylogeny of the influenza A virus data.</bold> Maximum likelihood tree without the assumption of a molecular clock. Branch lengths depict the expected number of substitution per site.</p>
      </caption>
      <media xlink:href="s12862-014-0163-6-S1.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2:</title>
        <p><bold>Maximum likelihood phylogeny of the influenza B virus data. Maximum likelihood tree without the assumption of a molecular clock.</bold> Branch lengths depict the expected number of substitution per site.</p>
      </caption>
      <media xlink:href="s12862-014-0163-6-S2.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3:</title>
        <p><bold>95% Bayesian confidence intervals of substitution rate and root age using the birth-death model and a strict clock in 50 simulated data sets.</bold> Confidence intervals of the nucleotide substitution rate (a) and root age (a) were inferred using BEAST for 50 replicates using a birth-death model prior on the phylogeny. Intervals that do not include the true value (blue line) are shown in red.</p>
      </caption>
      <media xlink:href="s12862-014-0163-6-S3.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4:</title>
        <p><bold>Linear regression estimates of substitution rate and root age in 50 simulated data sets.</bold> Point estimates of the nucleotide substitution rate (a) and root age (b) using a root to tip linear regression of the expected number of substitutions per site and sampling dates.</p>
      </caption>
      <media xlink:href="s12862-014-0163-6-S4.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>MF started to work on Physher while working in the Department of Pathology, University of California San Diego, San Diego, USA and was supported by the National Institutes of Health (AI47745) and the Joint DMS/NIGMS Mathematical Biology Initiative through Grant NSF-0714991. MF is currently supported by a postdoctoral research fellowship from the University of Sydney. ECH is supported by an NHMRC Australia Fellowship.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sanderson</surname>
          <given-names>MJ</given-names>
        </name>
        <article-title>A nonparametric approach to estimating divergence times in the absence of rate constancy</article-title>
        <source>Mol Biol Evol</source>
        <year>1997</year>
        <volume>14</volume>
        <fpage>1218</fpage>
        <lpage>1231</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a025731</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sanderson</surname>
          <given-names>MJ</given-names>
        </name>
        <article-title>Estimating absolute rates of molecular evolution and divergence times: A penalized likelihood approach</article-title>
        <source>Mol Biol Evol</source>
        <year>2002</year>
        <volume>19</volume>
        <fpage>101</fpage>
        <lpage>109</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a003974</pub-id>
        <?supplied-pmid 11752195?>
        <pub-id pub-id-type="pmid">11752195</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Thorne</surname>
          <given-names>JL</given-names>
        </name>
        <name>
          <surname>Kishino</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Painter</surname>
          <given-names>IS</given-names>
        </name>
        <article-title>Estimating the rate of evolution of the rate of molecular evolution</article-title>
        <source>Mol Biol Evol</source>
        <year>1998</year>
        <volume>15</volume>
        <fpage>1647</fpage>
        <lpage>1657</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a025892</pub-id>
        <?supplied-pmid 9866200?>
        <pub-id pub-id-type="pmid">9866200</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lartillot</surname>
          <given-names>N</given-names>
        </name>
        <article-title>Conjugate Gibbs sampling for Bayesian phylogenetic models</article-title>
        <source>J Comput Biol</source>
        <year>2006</year>
        <volume>13</volume>
        <fpage>1701</fpage>
        <lpage>1722</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2006.13.1701</pub-id>
        <?supplied-pmid 17238840?>
        <pub-id pub-id-type="pmid">17238840</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Guindon</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Bayesian estimation of divergence times from large sequence alignments</article-title>
        <source>Mol Biol Evol</source>
        <year>2010</year>
        <volume>27</volume>
        <fpage>1768</fpage>
        <lpage>1781</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msq060</pub-id>
        <?supplied-pmid 20194424?>
        <pub-id pub-id-type="pmid">20194424</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yang</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>A heuristic rate smoothing procedure for maximum likelihood estimation of species divergence times</article-title>
        <source>Acta Zool Sin</source>
        <year>2004</year>
        <volume>50</volume>
        <fpage>645</fpage>
        <lpage>656</lpage>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Aris-Brosou</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Dating phylogenies with hybrid local molecular clocks</article-title>
        <source>PLoS One</source>
        <year>2007</year>
        <volume>2</volume>
        <fpage>e879</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0000879</pub-id>
        <?supplied-pmid 17849008?>
        <pub-id pub-id-type="pmid">17849008</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Drummond</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Ho</surname>
          <given-names>SYW</given-names>
        </name>
        <name>
          <surname>Phillips</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Rambaut</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Relaxed phylogenetics and dating with confidence</article-title>
        <source>PLoS Biol</source>
        <year>2006</year>
        <volume>4</volume>
        <fpage>699</fpage>
        <lpage>710</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0040088</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Drummond</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Suchard</surname>
          <given-names>MA</given-names>
        </name>
        <article-title>Bayesian random local clocks, or one rate to rule them all</article-title>
        <source>BMC Biol</source>
        <year>2010</year>
        <volume>8</volume>
        <fpage>114</fpage>
        <pub-id pub-id-type="doi">10.1186/1741-7007-8-114</pub-id>
        <?supplied-pmid 20807414?>
        <pub-id pub-id-type="pmid">20807414</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Heath</surname>
          <given-names>TA</given-names>
        </name>
        <article-title>A hierarchical Bayesian model for calibrating estimates of species divergence times</article-title>
        <source>Syst Biol</source>
        <year>2012</year>
        <volume>61</volume>
        <fpage>793</fpage>
        <lpage>809</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/sys032</pub-id>
        <?supplied-pmid 22334343?>
        <pub-id pub-id-type="pmid">22334343</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="book">
        <name>
          <surname>Eshelman</surname>
          <given-names>LJ</given-names>
        </name>
        <source>The CHC adaptive search algorithm: how to do safe search when engaging in nontraditional genetic recombination</source>
        <year>1991</year>
        <publisher-name>Morgan Kaufmann Publisher, San Mateo, CA</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kosakovsky Pond</surname>
          <given-names>SL</given-names>
        </name>
        <name>
          <surname>Posada</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Gravenor</surname>
          <given-names>MB</given-names>
        </name>
        <name>
          <surname>Woelk</surname>
          <given-names>CH</given-names>
        </name>
        <name>
          <surname>Frost</surname>
          <given-names>SDW</given-names>
        </name>
        <article-title>Automated phylogenetic detection of recombination using a genetic algorithm</article-title>
        <source>Mol Biol Evol</source>
        <year>2006</year>
        <volume>23</volume>
        <fpage>1891</fpage>
        <lpage>1901</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msl051</pub-id>
        <?supplied-pmid 16818476?>
        <pub-id pub-id-type="pmid">16818476</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kosakovsky Pond</surname>
          <given-names>SL</given-names>
        </name>
        <name>
          <surname>Frost</surname>
          <given-names>SDW</given-names>
        </name>
        <article-title>A genetic algorithm approach to detecting lineage-specific variation in selection pressure</article-title>
        <source>Mol Biol Evol</source>
        <year>2005</year>
        <volume>22</volume>
        <fpage>478</fpage>
        <lpage>485</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msi031</pub-id>
        <pub-id pub-id-type="pmid">15509724</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="book">
        <name>
          <surname>Efron</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Tibshirani</surname>
          <given-names>RJ</given-names>
        </name>
        <source>An introduction to the bootstrap</source>
        <year>1993</year>
        <publisher-name>Chapman and Hall, New York</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Felsenstein</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Evolutionary trees from DNA-sequences - a maximum-likelihood approach</article-title>
        <source>J Mol Evol</source>
        <year>1981</year>
        <volume>17</volume>
        <fpage>368</fpage>
        <lpage>376</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01734359</pub-id>
        <?supplied-pmid 7288891?>
        <pub-id pub-id-type="pmid">7288891</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Drummond</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Rambaut</surname>
          <given-names>A</given-names>
        </name>
        <article-title>BEAST: Bayesian evolutionary analysis by sampling trees</article-title>
        <source>BMC Evol Biol</source>
        <year>2007</year>
        <volume>7</volume>
        <fpage>214</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-7-214</pub-id>
        <?supplied-pmid 17996036?>
        <pub-id pub-id-type="pmid">17996036</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Baele</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Lemey</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Bedford</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Rambaut</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Suchard</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Alekseyenko</surname>
          <given-names>AV</given-names>
        </name>
        <article-title>Improving the accuracy of demographic and molecular clock model comparison while accommodating phylogenetic uncertainty</article-title>
        <source>Mol Biol Evol</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>2157</fpage>
        <lpage>2167</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/mss084</pub-id>
        <?supplied-pmid 22403239?>
        <pub-id pub-id-type="pmid">22403239</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chen</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Holmes</surname>
          <given-names>EC</given-names>
        </name>
        <article-title>The evolutionary dynamics of human influenza B virus</article-title>
        <source>J Mol Evol</source>
        <year>2008</year>
        <volume>66</volume>
        <fpage>655</fpage>
        <lpage>663</lpage>
        <pub-id pub-id-type="doi">10.1007/s00239-008-9119-z</pub-id>
        <?supplied-pmid 18504518?>
        <pub-id pub-id-type="pmid">18504518</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Biere</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Bauer</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Schweiger</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Differentiation of influenza B virus lineages Yamagata and Victoria by real-time PCR</article-title>
        <source>J Clin Microbiol</source>
        <year>2010</year>
        <volume>48</volume>
        <fpage>1425</fpage>
        <lpage>1427</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.02116-09</pub-id>
        <?supplied-pmid 20107085?>
        <pub-id pub-id-type="pmid">20107085</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Minin</surname>
          <given-names>VN</given-names>
        </name>
        <name>
          <surname>Bloomquist</surname>
          <given-names>EW</given-names>
        </name>
        <name>
          <surname>Suchard</surname>
          <given-names>MA</given-names>
        </name>
        <article-title>Smooth skyride through a rough skyline: Bayesian coalescent-based inference of population dynamics</article-title>
        <source>Mol Biol Evol</source>
        <year>2008</year>
        <volume>25</volume>
        <fpage>1459</fpage>
        <lpage>1471</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msn090</pub-id>
        <?supplied-pmid 18408232?>
        <pub-id pub-id-type="pmid">18408232</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Stadler</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Sampling-through-time in birth-death trees</article-title>
        <source>J Theor Biol</source>
        <year>2010</year>
        <volume>267</volume>
        <fpage>396</fpage>
        <lpage>404</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jtbi.2010.09.010</pub-id>
        <?supplied-pmid 20851708?>
        <pub-id pub-id-type="pmid">20851708</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <article-title>Tracer</article-title>
        <source>ᅟ</source>
        <year>ᅟ</year>
        <volume>ᅟ</volume>
        <fpage>ᅟ</fpage>
        <ext-link ext-link-type="uri" xlink:href="http://tree.bio.ed.ac.uk/software/tracer/">http://tree.bio.ed.ac.uk/software/tracer/</ext-link>
        <comment>[http://tree.bio.ed.ac.uk/software/tracer/]</comment>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Worobey</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Han</surname>
          <given-names>GZ</given-names>
        </name>
        <name>
          <surname>Rambaut</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Genesis and pathogenesis of the 1918 pandemic H1N1 influenza A virus</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2014</year>
        <volume>111</volume>
        <fpage>8107</fpage>
        <lpage>8112</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1324197111</pub-id>
        <?supplied-pmid 24778238?>
        <pub-id pub-id-type="pmid">24778238</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>dos Reis</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>Approximate likelihood calculation on a phylogeny for Bayesian estimation of divergence times</article-title>
        <source>Mol Biol Evol</source>
        <year>2011</year>
        <volume>28</volume>
        <fpage>2161</fpage>
        <lpage>2172</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msr045</pub-id>
        <?supplied-pmid 21310946?>
        <pub-id pub-id-type="pmid">21310946</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wertheim</surname>
          <given-names>JO</given-names>
        </name>
        <name>
          <surname>Fourment</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Kosakovsky Pond</surname>
          <given-names>SL</given-names>
        </name>
        <article-title>Inconsistencies in estimating the age of HIV-1 subtypes due to heterotachy</article-title>
        <source>Mol Biol Evol</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>451</fpage>
        <lpage>456</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msr266</pub-id>
        <?supplied-pmid 22045998?>
        <pub-id pub-id-type="pmid">22045998</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wagner</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Klunk</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Harbeck</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Devault</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Waglechner</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Sahl</surname>
          <given-names>JW</given-names>
        </name>
        <name>
          <surname>Enk</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Birdsell</surname>
          <given-names>DN</given-names>
        </name>
        <name>
          <surname>Kuch</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lumibao</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Poinar</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Pearson</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Fourment</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Golding</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Riehm</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Earn</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Dewitte</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Rouillard</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Grupe</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Wiechmann</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Bliska</surname>
          <given-names>JB</given-names>
        </name>
        <name>
          <surname>Keim</surname>
          <given-names>PS</given-names>
        </name>
        <name>
          <surname>Scholz</surname>
          <given-names>HC</given-names>
        </name>
        <name>
          <surname>Holmes</surname>
          <given-names>EC</given-names>
        </name>
        <name>
          <surname>Poinar</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Yersinia pestis and the Plague of Justinian 541–543 AD: a genomic analysis</article-title>
        <source>Lancet Infect Dis</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>319</fpage>
        <lpage>326</lpage>
        <pub-id pub-id-type="doi">10.1016/S1473-3099(13)70323-2</pub-id>
        <?supplied-pmid 24480148?>
        <pub-id pub-id-type="pmid">24480148</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
