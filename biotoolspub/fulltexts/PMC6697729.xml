<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Oncogenesis</journal-id>
    <journal-id journal-id-type="iso-abbrev">Oncogenesis</journal-id>
    <journal-title-group>
      <journal-title>Oncogenesis</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2157-9024</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6697729</article-id>
    <article-id pub-id-type="publisher-id">157</article-id>
    <article-id pub-id-type="doi">10.1038/s41389-019-0157-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DeepCC: a novel deep learning-based framework for cancer molecular subtype classification</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gao</surname>
          <given-names>Feng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Wei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tan</surname>
          <given-names>Miaomiao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Lina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Yuchen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fessler</surname>
          <given-names>Evelyn</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Vermeulen</surname>
          <given-names>Louis</given-names>
        </name>
        <address>
          <phone>+31 (0) 20 56 64824</phone>
          <email>l.vermeulen@amc.uva.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5122-2418</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Xin</given-names>
        </name>
        <address>
          <phone>+852 3442 2367</phone>
          <email>Xin.Wang@cityu.edu.hk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1792 6846</institution-id><institution-id institution-id-type="GRID">grid.35030.35</institution-id><institution>Department of Biomedical Sciences, </institution><institution>City University of Hong Kong, </institution></institution-wrap>Hong Kong SAR, China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2360 039X</institution-id><institution-id institution-id-type="GRID">grid.12981.33</institution-id><institution>Department of Colorectal Surgery, The Sixth Affiliated Hospital, </institution><institution>Sun Yat-sen University, </institution></institution-wrap>Guangzhou, China </aff>
      <aff id="Aff3"><label>3</label>Guangdong Institute of Gastroenterology, Guangdong Provincial Key Laboratory of Colorectal and Pelvic Floor Diseases, Supported by National Key Clinical Discipline, Guangzhou, China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000000084992262</institution-id><institution-id institution-id-type="GRID">grid.7177.6</institution-id><institution>Laboratory for Experimental Oncology and Radiobiology (LEXOR), Center for Experimental Molecular Medicine (CEMM), Academic Medical Center (AMC), </institution><institution>University of Amsterdam, </institution></institution-wrap>Amsterdam, the Netherlands </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1792 6846</institution-id><institution-id institution-id-type="GRID">grid.35030.35</institution-id><institution>Shenzhen Research Institute, </institution><institution>City University of Hong Kong, </institution></institution-wrap>Shenzhen, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <volume>8</volume>
    <issue>9</issue>
    <elocation-id>44</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>12</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>5</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>6</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Molecular subtyping of cancer is a critical step towards more individualized therapy and provides important biological insights into cancer heterogeneity. Although gene expression signature-based classification has been widely demonstrated to be an effective approach in the last decade, the widespread implementation has long been limited by platform differences, batch effects, and the difficulty to classify individual patient samples. Here, we describe a novel supervised cancer classification framework, deep cancer subtype classification (DeepCC), based on deep learning of functional spectra quantifying activities of biological pathways. In two case studies about colorectal and breast cancer classification, DeepCC classifiers and DeepCC single sample predictors both achieved overall higher sensitivity, specificity, and accuracy compared with other widely used classification methods such as random forests (RF), support vector machine (SVM), gradient boosting machine (GBM), and multinomial logistic regression algorithms. Simulation analysis based on random subsampling of genes demonstrated the robustness of DeepCC to missing data. Moreover, deep features learned by DeepCC captured biological characteristics associated with distinct molecular subtypes, enabling more compact within-subtype distribution and between-subtype separation of patient samples, and therefore greatly reduce the number of unclassifiable samples previously. In summary, DeepCC provides a novel cancer classification framework that is platform independent, robust to missing data, and can be used for single sample prediction facilitating clinical implementation of cancer molecular subtyping.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Tumour heterogeneity</kwd>
      <kwd>Cancer genomics</kwd>
      <kwd>Tumour heterogeneity</kwd>
      <kwd>Cancer genomics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100002920</institution-id>
            <institution>Research Grants Council, University Grants Committee (RGC, UGC)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>21101115</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wang</surname>
            <given-names>Xin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>The Science Technology and Innovation Committee of Shenzhen Municipality (JCYJ20170307091256048)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100004622</institution-id>
            <institution>KWF Kankerbestrijding (Dutch Cancer Society)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>UVA2014-7245</award-id>
        <principal-award-recipient>
          <name>
            <surname>Vermeulen</surname>
            <given-names>Louis</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100001826</institution-id>
            <institution>ZonMw (Netherlands Organisation for Health Research and Development)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Vidi 016.156.308</award-id>
        <principal-award-recipient>
          <name>
            <surname>Vermeulen</surname>
            <given-names>Louis</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>European Research Council (ERG-StG 638193)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par2">Cancer subtyping is important for selection of patients that benefit most from specified therapies and design of novel targeted agents. Traditionally, cancer classification is largely based on histopathological and clinical characteristics, which makes it difficult to implement uniformly, as individual expertize of the clinicians is often a major determinant<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. Although the prognostic value of these classifications is undisputed, they fall behind in predicting drug efficacy due to the lack of a clear molecular basis. Instead, as an example in colorectal cancer (CRC), genetic features, such as <italic>KRAS</italic> mutation and microsatellite instability (MSI) status<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, have proven predictive power regarding anti-EGFR and 5-FU efficacy, respectively. However, classifications based on these molecular characteristics still leave much of additional cancer heterogeneity unaccounted for<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. Therefore, in recent years, whole transcriptome-based cancer subtyping has been widely demonstrated as an efficient approach for dissecting cancer heterogeneity<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. The evident benefit of this approach is the integration of genetic, epigenetic, and microenvironmental features that impact on cancer biology and clinical presentation. A widely-implemented strategy involves consensus clustering for determination of an optimal number of cancer subgroups, and classification with feature selection, i.e., selection of a list of signature genes<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>.</p>
    <p id="Par3">While several consensus clustering methods<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup> have been well established and widely adopted, the classification step suffers several critical limitations. First, a signature gene-based approach places sole emphasis on the role of individual genes, without effective incorporation of biological knowledge such as pathway activity, which often leads to poor interpretability<sup><xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>. Second, signature genes for classification are not always available due to unpaired gene annotation caused by platform differences, which hampers its portability and translational potential<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Last but not least, gene expression profiling is easily affected by factors such as technical platform variation and experimental protocols, leading to nonbiological batch effects<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. Mathematical and statistical methods might be able to correct for such bias so that data from various sources are comparable. However, such correction methods are not always suitable, especially in situations when the sources of bias are unclear. For instance, the correction power of existing methods such as ComBat<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> have been demonstrated to be limited to a balanced experimental design<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. Most critically for clinical implementation, the batch effects also prevent the development of gene expression signature-based classifiers for single sample prediction.</p>
    <p id="Par4">Recent advances in the machine learning community have shown a great promise to apply deep learning for cancer classification. For instance, deep convolutional neural networks have been demonstrated to improve accuracy and reproducibility of tumor classification based on histopathological or radiographic images<sup><xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR19">19</xref></sup>. Deep learning-based frameworks, such as D-GEX<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, DeepChrome<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, and DeepSEA<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> have also been developed for predicting gene expression or effects of noncoding variants based on high-dimensional genomic or epigenomic profiles. Furthermore, several supervised and unsupervised deep learning-based classification methods have been proposed for cancer detection and diagnosis, and they have been demonstrated superior performance over classical methods such as support vector machine (SVM) and random forests (RF)<sup><xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR25">25</xref></sup>. Meanwhile, pathway activities transformed from gene expression profiles have been shown to be more informative and robust for disease classification<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>. Motivated by these pioneering works in machine learning, we developed a novel framework Deep Cancer subtype Classification (DeepCC), which leverages both pathway activity transformation and deep learning to address the abovementioned critical limitations in cancer subtype classification.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overall design of DeepCC</title>
      <p id="Par5">DeepCC is a supervised, biological knowledge-based framework for cancer classification, consisting of two major steps (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>):<list list-type="order"><list-item><p id="Par6">Transformation of high-throughput gene expression data to functional spectra. We first perform gene set enrichment analysis (GSEA)<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> for each tumor sample’s gene expression profile on thousands of gene sets obtained from public databases such as MSigDB<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. For each patient sample, the vector of enrichment scores of all gene sets represents a landscape of molecular patterns associating with biological functions, and therefore it is referred to as a functional spectrum.</p></list-item><list-item><p id="Par7">Classification based on deep learning. Taking the obtained functional spectra as input, we next train a classifier using deep learning. By using a trainable multilayer artificial neural network (ANN) to replace hand-engineered features, deep learning takes the advantage of functional spectra, which are more robust and informative. In contrast, feature selection for high-dimensional data is a challenging task for conventional machine learning algorithms, which could lead to bias especially for high-throughput gene expression profiles<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. To train a DeepCC classifier, we highly recommend employing a widely adopted molecular subtyping system, so that the deep features trained by the ANN can capture most relevant biological properties associated with each molecular subtype. In our case studies, we used the consensus molecular subtyping (CMS) system<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> for CRC and intrinsic subtyping system for breast cancer (implemented by PAM50<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>), which are both widely adopted in respective fields. The trained DeepCC model can be subsequently used for classification of new samples.</p></list-item></list><fig id="Fig1"><label>Fig. 1</label><caption><title>Overview of DeepCC.</title><p><bold>a</bold> A deep learning-based cancer classification framework. DeepCC takes as input high-throughput gene expression data and transforms it to functional spectra using gene set enrichment analysis (GSEA). A feedforward artificial neural network is employed subsequently to perform feature learning and build a classifier for cancer classification. <bold>b</bold> Intersection of gene annotations (Entrez IDs) between three technical platforms: TCGA RNA-Seq data set, Affymetrix Human Genome U133 Plus 2.0 array, and Agilent Homo sapiens 37 K DiscoverPrint19742 microarray. <bold>c</bold> DeepCC’s classification performance on subsets of top variable genes, ranging from 1000 to 20,531, selected for calculating functional spectra on the TCGA CRC data set (<italic>n</italic> = 456). The classification performance was evaluated by overall accuracy, mean balanced accuracy, mean sensitivity, and mean specificity</p></caption><graphic xlink:href="41389_2019_157_Fig1_HTML" id="d29e508"/></fig></p>
      <p id="Par8">In short, our DeepCC framework has four major advantages over previous cancer subtyping methods:<list list-type="order"><list-item><p id="Par9">Better interpretability. DeepCC transforms gene expression profiles to functional spectra, which are transcriptomic patterns that have been previously demonstrated to directly associate with biological function. Deep learning is also well known for its capability to learn high-level representations of data through multiple hidden layers<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. In both case studies, we demonstrated that deep features learned by DeepCC represent characteristic biological processes of different cancer subtypes, which better dissects molecular heterogeneity than gene expression signature-based methods.</p></list-item><list-item><p id="Par10">Platform independency. Different types of high-throughput gene expression data are transformed to the same form of functional spectra, and therefore are directly comparable.</p></list-item><list-item><p id="Par11">More robustness. Since GSEA is performed on the ranks of input data and corrected by its raw value, DeepCC is much less influenced by nonbiological factors such as batch effect and normalization methods.</p></list-item><list-item><p id="Par12">Single sample prediction. DeepCC can deal with single sample gene expression data regardless of the platform by adaptive rescaling to a predefined or user-defined reference (details in “Methods” section). DeepCC single sample predictor (SSP) addresses one critical limitation of previous cancer classification methods, which hampers the translation of cancer molecular subtyping into the clinic.</p></list-item></list></p>
    </sec>
    <sec id="Sec4">
      <title>Case study in colorectal cancer</title>
      <p id="Par13">To demonstrate the performance of DeepCC, we initially applied it to classify CRC. Recently, we participated in an international CRC subtyping consortium (CRCSC) and identified four consensus molecular subtypes (CMSs)<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> based on gene expression data of 4151 primary tumor samples from a total of 18 data sets. The four CMSs are characterized by distinct molecular features: CMS1 (MSI immune), CMS2 (canonical), CMS3 (metabolic), and CMS4 (mesenchymal). Also, the CMSs display vastly different clinical features including prognosis and response to therapies. Moreover, together with the CMS taxonomy we reported a 273-gene classifier based on the RF algorithm to facilitate classification of additional data sets<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>.</p>
      <p id="Par14">The translational potential of a signature gene-based classifier is always hampered by missing data due to discrepant gene annotations between different gene expression profiling platforms, leading to poor classification performance<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. In this case study, we collected 14 publicly available CRC data sets (<italic>n</italic> = 3578) generated from six different microarray/RNA-Seq platforms (Table <xref rid="MOESM1" ref-type="media">S1</xref>). Comparing Entrez gene annotations between three representative platforms, RNA-Seq for the TCGA CRC data set, Affymetrix Human Genome U133 Plus 2.0 array and Agilent Homo sapiens 37 K DiscoverPrint19742 microarray, we found more than one third of all annotated genes (8451 out of 23,557) are unique to certain platforms (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>).</p>
      <p id="Par15">To evaluate the robustness of DeepCC to cross-platform missing genes, we trained a DeepCC classifier for CMS subtypes using TCGA CRC data set (<italic>n</italic> = 456) with CMS subtype information provided by CRCSC<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, and subsequently studied its performance on expression data of only a subset of genes. More specifically, we iteratively selected a random subset of genes that are most variable across TCGA samples (measured by median absolute deviations), and calculated functional spectra based on the subset of genes selected for classification. Accuracy, balanced accuracy, sensitivity, and specificity were calculated for evaluation of DeepCC’s performance. As expected, we found that DeepCC accomplished a very high accuracy (balanced accuracy &gt; 90%) even when only 2000 genes were used for training the classifier (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>), demonstrating DeepCC’s strong robustness to missing data.</p>
      <p id="Par16">To comprehensively benchmark the classification performance, we trained a DeepCC classifier using the TCGA RNA-Seq data set with CMS subtype labels, and then applied it to classify 13 other independent data sets based on Affymetrix or Agilent microarray platforms (Table <xref rid="MOESM1" ref-type="media">S1</xref>), followed by the calculation of sensitivity, specificity, and accuracy based on their original CMS subtyping information. Four widely used signature gene-based classifiers were constructed based on RF, SVM, gradient boosting machine (GBM) and multinomial logistic regression algorithms, respectively. As an intrinsic limitation, we previously reported that the signature gene-based classifier trained on RNA-Seq and Affymetrix microarray platform derived data, showed poor performance on Agilent array derived data<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. Compared with these signature gene-based classifiers, DeepCC demonstrated higher sensitivity, specificity, and accuracy on the validation data sets (Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Table <xref rid="MOESM1" ref-type="media">S2</xref>, <italic>P</italic> = 8.47 × 10<sup>−20</sup>, 1.61 × 10<sup>–10</sup>, 3.07 × 10<sup>–21</sup>, 4.56 × 10<sup>–68</sup>, respectively, McNemar’s tests). Notably, DeepCC SSP also showed promising performance as DeepCC (Fig. <xref rid="MOESM1" ref-type="media">S1</xref>), with remarkably even higher accuracy than the other classifiers (Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Table <xref rid="MOESM1" ref-type="media">S2</xref>, <italic>P</italic> = 3.08 × 10<sup>–16</sup>, 5.19 × 10<sup>–9</sup>, 6.56 × 10<sup>–17</sup>, 8.2 × 10<sup>–60</sup>, respectively, McNemar’s tests).<fig id="Fig2"><label>Fig. 2</label><caption><title>CRC classification performance.</title><p>Bar plots of classification performance of DeepCC, compared to other signature gene-based approaches. The performance was evaluated on 13 independent validation data sets and the merged data set (ALL), by <bold>a</bold> balanced accuracy (calculated by the mean of balanced accuracy per class), <bold>b</bold> overall accuracy, <bold>c</bold> sensitivity (calculated by the mean of sensitivity per class), and <bold>d</bold> specificity (calculated by the mean of specificity per class)</p></caption><graphic xlink:href="41389_2019_157_Fig2_HTML" id="d29e659"/></fig></p>
      <p id="Par17">For clinical implementation, it is essential that the proportion of samples that cannot be accurately classified is low. Previously we found that ~20% of CRC samples could not be reliably classified in a single CMS<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. The question remained if this represented biological and clinical reality, or was a limitation of the classification strategy. Because we detected large variation in the number of unclassifiable samples in the various data sets (range 11–48%)<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, we suspected that it is predominantly the latter reason paired with data set dependent differences in data quality. Therefore, we hypothesized that DeepCC would be able to reduce the number of unclassifiable samples. To assess classification performance, we used the same criterion that was previously employed for the CMS classifier (posterior probability &gt; 0.5). Across all data sets previously analyzed by CRCSC, DeepCC only failed to classify ~5% tumor samples, much lower than previously reported methods using the same data series (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). To further investigate whether this classification has practical meaning, we performed survival analyses and Fisher’s exact tests for associations with key molecular features (<italic>MSI</italic>, <italic>CIMP</italic>, <italic>CIN</italic>, <italic>P53</italic>, <italic>BRAF</italic>, and <italic>KRAS</italic>) on a public data set (<italic>CIT/GSE39582</italic>, <italic>n</italic> = 557). In the CIT data set, DeepCC can classify 531 out of 557 samples, whereas the CMS classifier based on RF failed to classify 117 out of them. Interestingly, these unclassifiable samples were mainly in the boundary regions of the CMS signature gene space (Fig. <xref rid="MOESM1" ref-type="media">S2</xref> and Table <xref rid="MOESM1" ref-type="media">S3</xref>), suggesting an effect of a suboptimal classification strategy for CMS classifier. Furthermore, the classification results of DeepCC have in general higher associations with molecular markers and clinical outcomes than those of other classifiers (Fig. <xref rid="MOESM1" ref-type="media">S3</xref> and Tables <xref rid="MOESM1" ref-type="media">S2</xref> and <xref rid="MOESM1" ref-type="media">S4</xref>). These results demonstrated that DeepCC-based classifications display generally stronger associations with molecular and clinical features, while greatly reduce the number of ‘unclassifiable’ samples.<fig id="Fig3"><label>Fig. 3</label><caption><title>Applying DeepCC to CRC classification.</title><p><bold>a</bold> Bar plots of unclassified samples across multiple data sets demonstrating the superior classification performance of DeepCC. The TCGA data set was used to train DeepCC, DeepCC SSP, random forests, SVM, GBM, and multinomial logistic regression classifiers, which were applied to classify 13 independent data sets. In addition, the CMS classifier built by CRCSC was also included for a comparison. <bold>b</bold> Features learned by the hierarchical network of DeepCC showed increasing within-subtype compactness as the hidden layer goes deeper, as indicated by the distributions of CRC samples and average silhouette widths (ASWs) measured in the TCGA data set (<italic>n</italic> = 456). For visualization, the same set of samples were shown in the space of the first two principal components of features learned at each hidden layer (from 1 to 5). <bold>c</bold> Deep feature groups implicate the distinct biological functions associated with CRC subtypes. Deep features were obtained from the last hidden layer of the ANN trained with the TCGA data set (<italic>n</italic> = 456). Clustering of absolute Pearson correlation coefficients between the ten deep features identified three deep feature groups, which are highly correlated with microsatellite instability, metabolic dysregulation, and higher epithelial-to-mesenchymal transition, respectively. The order of deep features is in Fig. <xref rid="MOESM1" ref-type="media">S4</xref> and the detailed list of top correlated gene sets for each deep feature is in Table <xref rid="MOESM1" ref-type="media">S5</xref>. <bold>d</bold> Visualization of patients from two independent validation cohorts in the space of the first two principal components (PCs) of expression data of the 273 CMS signature genes and the ten deep features, respectively. In both data sets, samples are much more tightly distributed within assigned subtypes in the deep feature space than the signature gene space, as quantified by average silhouette width (AWS)<sup><xref ref-type="bibr" rid="CR52">52</xref></sup></p></caption><graphic xlink:href="41389_2019_157_Fig3_HTML" id="d29e751"/></fig></p>
      <p id="Par18">An important advantage of deep learning is feature learning<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. The ANN employed by DeepCC learned features through a hierarchy of hidden layers, showing gradual increasing within-subtype compactness, as indicated by the distributions of CRC samples and average silhouette widths (ASWs) measured in the TCGA data set (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). Deep features obtained at the last layer of ANN in DeepCC show distinct patterns across different CRC subgroups (Fig. <xref rid="MOESM1" ref-type="media">S4</xref>). Especially, after clustering of absolute correlation coefficients between features, three distinct groups of deep features emerged (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>). Interestingly, these feature groups are highly correlated with MSI, metabolic dysregulation, and higher epithelial-to-mesenchymal transition (EMT), respectively (Table <xref rid="MOESM1" ref-type="media">S5</xref>), which summarize the major characteristics of CMS1, CMS3, and CMS4 respectively. CMS2 is a canonical subtype, which is here reinforced by a lack of distinctive feature sets recognized. Moreover, we found that the deep features extracted by DeepCC provide a better representation of patients than the signature genes. In each individual validation data set, we found patient samples are more compactly distributed within assigned subgroups in the space of deep features than in the space of signature genes (two representative examples in Fig. <xref rid="Fig3" ref-type="fig">3d</xref>, and the others in Fig. <xref rid="MOESM1" ref-type="media">S5</xref>). To quantitatively compare the within-class coherence, we calculated ASW of patient samples. We found that the ASWs calculated using deep features are much higher than those based on expression levels of signature genes in all data sets (Figs. <xref rid="Fig3" ref-type="fig">3d</xref>, <xref rid="MOESM1" ref-type="media">S5</xref>, <italic>P</italic> &lt; 0.01, one-sided Wilcoxon signed-rank test). This implicates that DeepCC can find more fundamental functional distinctions between cancer subtypes, which also explains its superior classification performance.</p>
    </sec>
    <sec id="Sec5">
      <title>Case study in breast cancer</title>
      <p id="Par19">To evaluate the general applicability of DeepCC to other cancers, we studied breast cancer, another major malignancy with well characterized molecular subtypes. As a reference, we employed PAM50<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> for intrinsic subtype classification, which is a widely used transcriptome-based classification system. In PAM50, five distinct (intrinsic) molecular subtypes are defined: Basal-like, Her2, Luminal A, Luminal B, and Normal-like. Using TCGA RNA-Seq data set (<italic>n</italic> = 517) with subtyping result predicted by PAM50, we trained a supervised DeepCC classifier to evaluate the classification performance. Similar to the case study in CRC, we first evaluated the robustness of DeepCC classifier to cross-platform missing genes in breast cancer. As expected, DeepCC accomplished a high accuracy (balanced accuracy &gt; 80%) even when only 1000 genes were used for training (Fig. <xref rid="MOESM1" ref-type="media">S6</xref>). The classifier was subsequently applied to classify four other independent validation data sets (Table <xref rid="MOESM1" ref-type="media">S6</xref>). DeepCC successfully extracted deep features highly correlated with the underlying biological characteristics of breast cancer subtypes (Fig. <xref rid="Fig4" ref-type="fig">4a</xref> and Table <xref rid="MOESM1" ref-type="media">S7</xref>). Similarly, patient samples showed higher within-class coherence in the deep feature space than in the signature gene space, as suggested by the much higher ASWs (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>, <italic>P</italic> &lt; 0.01, one-sided Wilcoxon signed-rank test). Furthermore, survival analyses on the four validation sets (<italic>TANSBIG</italic>, <italic>UNT</italic>, <italic>UPP</italic>, and <italic>NKI</italic>) separately and jointly demonstrated that DeepCC classification has higher associations with disease-free survival than PAM50 (Figs. <xref rid="Fig4" ref-type="fig">4c</xref>, <xref rid="MOESM1" ref-type="media">S7</xref> and Table <xref rid="MOESM1" ref-type="media">S8</xref>). The clinical relevance is also supported by the significant associations (all <italic>P</italic> &lt; 10<sup>–12</sup>, Fisher’s exact tests) between the Luminal and HER2 subtypes predicted by DeepCC with ER/PR and HER2 receptor status, which are their corresponding characteristic markers, respectively (Table <xref rid="MOESM1" ref-type="media">S9</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><title>Applying DeepCC to breast cancer data sets.</title><p><bold>a</bold> Deep features of breast cancer learned from the TCGA data set (<italic>n</italic> = 517). In the left heatmap, rows represent patient samples, and are ordered by the four CMS subtypes. In the right heatmap, deep features were clustered by the absolute Pearson correlation coefficients between each other. <bold>b</bold> Visualization of patients in five independent breast cancer data sets. The top and bottom rows of figures visualize patients in the spaces of the first two principal components (PCs) of expression data of PAM50 signature genes and the ten deep features, respectively. In each independent data set (<italic>TANSBIG</italic>, <italic>UNT</italic>, <italic>UPP</italic>, <italic>NKI</italic>, and TCGA), samples are much more tightly distributed within assigned subtypes in the deep feature space than the signature gene space, as quantified by average silhouette width (AWS). <bold>c</bold> Kaplan–Meier survival curves of patients in all of four breast cancer data sets (<italic>TANSBIG</italic>, <italic>UNT</italic>, <italic>UPP</italic>, and <italic>NK</italic>). KM plots on the left and right were generated based on classification using DeepCC and the PAM50 classifier, respectively</p></caption><graphic xlink:href="41389_2019_157_Fig4_HTML" id="d29e895"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec6" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par20">Major malignancies such as breast and CRCs have been demonstrated to be molecularly heterogeneous, which directly relates to diverse patient outcomes in the clinic. The last decade has seen rich literature for dissecting molecular heterogeneity of cancers, including our own work on colon cancer<sup><xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR36">36</xref>,<xref ref-type="bibr" rid="CR37">37</xref></sup>. The common drawback of all these studies, however, lies in the limitations of the employed gene expression signature-based classification approach: platform dependency, poor robustness to batch effects, and lack of capability for single sample classification. In this study, to address these challenges we developed a novel supervised framework DeepCC, which leverages the power of deep learning based on an ANN for cancer classification. DeepCC transforms gene expression profiles to transcriptional patterns with functional relevance using GSEA, followed by deep learning using a trainable multilayer ANN.</p>
    <p id="Par21">We demonstrated the superior performance of DeepCC to other popular classification methods using multiple independent gene expression data sets involving over 4000 patient samples in a recent study by the CRCSC<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. We found that cancer patients are much more compactly distributed in the deep feature space than in the signature gene space, demonstrating the superior classification performance of DeepCC compared with other conventional methods. Of the utmost translational importance is the ability of DeepCC to successfully classify single samples. Furthermore, to show the general applicability of this new classification framework, we effectively applied DeepCC to breast cancer, and demonstrated a better performance over PAM50, which is a widely used classification system in breast cancer.</p>
    <p id="Par22">It should be noted that DeepCC is a supervised, biological knowledge-based framework specifically developed for addressing current challenges in classification but not clustering of cancer patients. In the last decades, molecular subtyping for major malignancies has been extensively studied, and many subtyping systems have been well established. However, implementing these subtyping systems is challenged by the abovementioned limitations of classical classification methods, which motivated us to develop DeepCC. In practice, it is recommended to use a widely adopted molecular subtyping systems, such as the CMS<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> for CRC and intrinsic subtyping for breast cancer (implemented by PAM50<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>), to train a DeepCC classifier for a particular cancer type. The trained DeepCC model can be subsequently used for classification of new samples, facilitating real clinical implementation of cancer subtyping considering its superior performance, cross-platform robustness and capability for single sample prediction, as demonstrated in our case studies.</p>
    <p id="Par23">There are various molecular testing assays such as Mammaprint<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, BluePrint<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>, and Oncotype DX<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, which have been well established and already applied in clinical practice. However, MammaPrint, and Oncotype DX are prognostic tools for prediction of high-, (intermediate-), and low-risk of recurrence and/or metastasis, which are not strictly ‘biological’ subtypes. BluePrint can only predict Luminal, HER2, and Basal subtypes, but cannot distinguish between Luminal A and Luminal B subtypes. Instead, PAM50 classification system encompasses all the five intrinsic molecular subtypes of breast cancer, and therefore is an ideal subtyping system for training DeepCC. Similarly, a number of risk scoring assays for CRC recurrence prediction have been developed, including Oncotype DX for Colon Cancer<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, ColonPRS<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>, ColoPrint<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, GeneFx Colon<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, OncoDefender-CRC<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>, ColoGuideEx<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, ColoGuidePro<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>, and miRNA recurrence classifier<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. All these assays have demonstrated prognostic values in independent patient series, but are not defining or predicting molecular subtypes of CRC. Therefore, in our CRC case study we selected the widely adopted CMS system developed by CRCSC to train DeepCC.</p>
    <p id="Par24">Since DeepCC employs GSEA to transform gene expression data to functional spectra, the prior knowledge of gene sets needs to be comprehensive to avoid potential bias. Of special importance are the major characteristic signaling pathways or biological processes for each cancer subtype, which should be included in the gene set database. In practice, it is highly recommended to use a database with a large scale of curated gene sets that are of high quality such as MSigDB v6.0 database employed in our case studies, which includes 17,779 gene sets encompassing all cancer hallmark signaling pathways.</p>
    <p id="Par25">In conclusion, our deep learning-based framework DeepCC integrates biological knowledge, overcomes limitations of signature gene-based approach and leads to more robust performance. Through case studies on CRC and breast cancer, we also demonstrated its superior classification performance and clinical relevance. The capability of DeepCC to reliably classify single samples, using transcriptome data obtained by any platform will greatly facilitate the translation of molecular subtyping into clinical practice.</p>
  </sec>
  <sec id="Sec7" sec-type="materials|methods">
    <title>Materials and methods</title>
    <sec id="Sec8">
      <title>Data processing</title>
      <sec id="Sec9">
        <title>Colon cancer data sets</title>
        <p id="Par26">In this study, we analyzed 14 independent CRC data sets, involving in total 3578 primary tumor samples (Table <xref rid="MOESM1" ref-type="media">S1</xref>). TCGA CRC set was employed as our training cohort, and the corresponding gene expression data (level 3 RNA-Seq data) were downloaded from Firehose Broad GDAC portal (<ext-link ext-link-type="uri" xlink:href="http://gdac.broadinstitute.org/">http://gdac.broadinstitute.org/</ext-link>). For patient samples with both gene expression data based on Illumina GA and Hi-Seq platforms, we only kept the Hi-Seq version. Scaled estimates in the gene-level RSEM files were first converted to TPM (transcripts per million) by multiplying with 10<sup>6</sup> and then log2-transformed.</p>
        <p id="Par27">For validation, 11 out of 13 data sets were curated by <italic>CRCSC</italic> (<italic>n</italic> <italic>=</italic> 2 674)<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, including <italic>GSE13067</italic> (<italic>n</italic> <italic>=</italic> 73)<italic>, GSE13294</italic> (<italic>n</italic> <italic>=</italic> 155)<italic>, GSE14333</italic> (<italic>n</italic> <italic>=</italic> 157), <italic>GSE17536</italic> (<italic>n</italic> <italic>=</italic> 174), <italic>GSE20916</italic> (<italic>n</italic> <italic>=</italic> 90), <italic>GSE2109</italic> (<italic>n</italic> <italic>=</italic> 287), <italic>GSE35896</italic> (<italic>n</italic> <italic>=</italic> 62), <italic>GSE37892</italic> (<italic>n</italic> <italic>=</italic> 127), <italic>GSE39582</italic> (<italic>n</italic> <italic>=</italic> 557), <italic>KFSYSCC</italic> (<italic>n</italic> <italic>=</italic> 305), and <italic>PETACC3</italic> (<italic>n</italic> <italic>=</italic> 687). These curated gene expression data were downloaded from the official repository of CRCSC on Synapse (<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#!Synapse:syn2623706/wiki/">https://www.synapse.org/#!Synapse:syn2623706/wiki/</ext-link>). More details about the curation procedures can be found in Guinney et al.<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, which resulted in expression levels of 5973 genes for each data set. The other two validation data sets, <italic>GSE42284</italic> (<italic>n</italic> <italic>=</italic> 188), <italic>GSE33113</italic> (<italic>n</italic> <italic>=</italic> 90), were downloaded from GEO directly in its processed form, using Bioconductor package ‘GEOquery’. The <italic>GSE42284</italic> data set is based on Agilent Homo sapiens 37 K DiscoverPrint_19742 microarray platform, including 188 CRC patient samples, processed by Agilent Feature Extraction software based on MedianSignal output and normalized by Lowess normalization<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. Probeset IDs were converted to gene symbols based on the corresponding gene annotations (GPL16280), and then further converted to Entrez IDs using Bioconductor package ‘org.Hs.eg.db’. The <italic>GES33113</italic> data set is based on Affymetrix Human Genome U133 Plus 2.0 array. The <italic>GSE33113</italic> data set includes 90 CRC patient samples and 6 normal samples, and was processed by MAS5.0 normalization and GCOS software<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. We only kept colorectal samples, and then converted all probeset IDs to Entrez IDs based on the corresponding gene annotations (GPL570).</p>
        <p id="Par28">In addition, CMS classification labels associated with all samples were also obtained from CRCSC Synapse repository (<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#!Synapse:syn2623706/wiki/">https://www.synapse.org/#!Synapse:syn2623706/wiki/</ext-link>).</p>
        <p id="Par29">More details about the CRC data sets can be found in Table <xref rid="MOESM1" ref-type="media">S1</xref>.</p>
      </sec>
      <sec id="Sec10">
        <title>Breast cancer data sets</title>
        <p id="Par30">Four breast cancer data sets (<italic>TANSBIG</italic>, <italic>UNT</italic>, <italic>UPP</italic>, and <italic>NKI</italic>) were downloaded from Bioconductor (<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/">http://www.bioconductor.org/</ext-link>) in their processed form.</p>
        <p id="Par31">For MACQ II BR cohort, the raw data were downloaded from GEO database with the accession number GSE20194 in R using ‘GEOquery’ package. The <italic>GSE20194</italic> data set is based on Affymetrix Human Genome U133A Array, including 230 breast cancer patient samples, normalized using MAS5.0 method. Probeset IDs were converted to gene symbols based on corresponding gene annotations (GPL96), and then converted to Entrez IDs using Bioconductor package ‘org.Hs.eg.db’.</p>
        <p id="Par32">In the breast cancer case study, PAM50 labels for the TCGA BRCA cohort obtained from TCGA<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> were used for training and validation.</p>
        <p id="Par33">More details about the breast cancer data sets can be found in Table <xref rid="MOESM1" ref-type="media">S6</xref>.</p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Functional spectra</title>
      <p id="Par34">A functional spectrum is a list of <italic>Enrichment Scores</italic> calculated by GSEA<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. The following steps are used to calculate the enrichment score <bold><italic>ES</italic></bold>:<list list-type="order"><list-item><p id="Par35">Filter duplicate probes of gene expression to prevent overestimation.</p></list-item><list-item><p id="Par36">Calculate log2 fold changes D of N genes by subtracting the background signal.</p></list-item><list-item><p id="Par37">Rank order D to form the gene list L = {g<sub>1</sub>,…,g<sub>N</sub>}, which is in a descending order.</p></list-item><list-item><p id="Par38">Form a list S = {s1,…,sN} containing the contribution of each gene for the enrichment score. For a gene ghit in the gene set C, we score it by <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{\left| {g_{hit}} \right|}}{{\mathop {\sum }\nolimits_{g_i \in C} \left| {g_i} \right|}}$$\end{document}</tex-math><mml:math id="M2"><mml:mfrac><mml:mrow><mml:mfenced close="∣" open="∣" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mfenced close="∣" open="∣" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41389_2019_157_Article_IEq1.gif"/></alternatives></inline-formula>; for a gene not in the gene set C, we score it by <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$- \frac{1}{{N - \mathop {\sum }\nolimits_{g_i \in C} 1}}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="41389_2019_157_Article_IEq2.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par39">Calculate the accumulation sum from s1 in S to obtain the deviation, and the value deviated the most from zero is the enrichment score ES.</p></list-item></list></p>
      <p id="Par40">In this study, we used all 17,779 gene sets in MSigDB<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> v6.0 (downloaded on 1 Jun 2017).</p>
    </sec>
    <sec id="Sec12">
      <title>Deep learning implementation</title>
      <p id="Par41">The deep learning framework in DeepCC was implemented based on MXNet (<ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1512.01274">https://arxiv.org/abs/1512.01274</ext-link>) incorporating the latest optimization methods developed by deep learning community, which can run on both CPU and GPU. By default, DeepCC builds a fully connected multilayer perceptron (feedforward neural network)<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> using the architecture of hidden layers: 2000, 500, 120, 30, 10 with Tanh activation function. The last layer for output is SoftMax. The whole network is initialized using Xavier<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. The optimizer can be chosen from SDG<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> (learning rate = 0.01, momentum = 0.9) or AdaDelta (<ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1212.5701">https://arxiv.org/abs/1212.5701</ext-link>).</p>
    </sec>
    <sec id="Sec13">
      <title>DeepCC classifier and single sample predictor (SSP)</title>
      <p id="Par42">To predict an individual sample, DeepCC SSP calculates the functional spectrum using a user-customized or a predefined reference, which is averaged gene expression profile over all samples for a specific cancer type in TCGA. First, we keep overlapped genes and rescale the input gene expression profile to the reference by fitting a linear model using the ‘lm’ function of R package ‘stats’. A functional spectrum is subsequently calculated using the residuals obtained from the linear regression, which is used as the input into the trained DeepCC classifier for classification.</p>
    </sec>
    <sec id="Sec14">
      <title>Other classification approaches and evaluation metrics</title>
      <p id="Par43">To compare DeepCC with signature gene-based approaches, we employed center-normalized expression data for the 273 CMS signature genes to build classifiers using different classification algorithms, including RF, SVM, GBM and the multinomial logistic regression model.</p>
      <p id="Par44">Four statistical measures were used to evaluate the classification performance. For each CMS subtype, we first calculate true positive (TP), false negative (FN), false positive (FP), and true negative (TN), and then calculate the following measures:<list list-type="order"><list-item><p id="Par45">Mean of sensitivity (per class). For each class, the sensitivity was calculated using TP/(TP + FN).</p></list-item><list-item><p id="Par46">Mean of specificity (per class). For each class, the specificity was calculated using TN/(TN + FP).</p></list-item><list-item><p id="Par47">Mean of balanced accuracy (per class). For each class, the balanced accuracy was calculated using (sensitivity + specificity)/2.</p></list-item><list-item><p id="Par48">Accuracy. The overall accuracy is the total number of correct predictions divided by the total number of patient samples.</p></list-item></list></p>
    </sec>
    <sec id="Sec15">
      <title>Functional analysis and visualization</title>
      <p id="Par49">To identify highly correlated biological functions of each subtype, we first calculated Pearson correlation coefficients between deep features extracted by DeepCC and enrichment scores of gene sets in the training data set. We obtained a correlation matrix indicating the relationships between deep features and functional gene sets. Highly correlated gene sets, either positively or negatively, indicate biological functions highly associated with deep features (Tables <xref rid="MOESM1" ref-type="media">S4</xref> and <xref rid="MOESM1" ref-type="media">S7</xref>).</p>
      <p id="Par50">To visualize classification results by DeepCC and signature gene-based approaches, we projected all patients into the deep feature space and the signature gene space, respectively. For DeepCC, the first two principal components of the ten deep features were visualize in a two-dimensional space, For the other classification approaches, the first two principal components of the expression levels of signature genes were visualized in a two-dimensional space.</p>
    </sec>
    <sec id="Sec16">
      <title>Code availability</title>
      <sec id="Sec17">
        <title>R package</title>
        <p id="Par51">DeepCC was implemented as an R package, and the source code and instructions for running DeepCC locally are available at GitHub.</p>
        <p id="Par52">Project name: DeepCC</p>
        <p id="Par53">Project home page: <ext-link ext-link-type="uri" xlink:href="https://cityuhk-compbio.github.io/DeepCC/">https://cityuhk-compbio.github.io/DeepCC/</ext-link></p>
        <p id="Par54">Operating system(s): Platform independent</p>
        <p id="Par55">Programming language: R and C</p>
        <p id="Par56">Other requirements: R version 3.3 or higher; MXNet version 0.10, or higher</p>
        <p id="Par57">License: MIT</p>
      </sec>
      <sec id="Sec18">
        <title>Online platform</title>
        <p id="Par58">An online platform of DeepCC (<ext-link ext-link-type="uri" xlink:href="https://cityuhk-compbio.github.io/deepcc_online/">https://cityuhk-compbio.github.io/deepcc_online/</ext-link>) is also provided for transformation of gene expression profiles of tumor samples to functional spectra and prediction of cancer subtypes based on pretrained models.</p>
      </sec>
    </sec>
    <sec id="Sec19">
      <title>Statistics</title>
      <p id="Par59">All statistical analyses were performed using R (version 3.3.3; <ext-link ext-link-type="uri" xlink:href="http://www.r-project.org">http://www.r-project.org</ext-link>) and <italic>P</italic> &lt; 0.05 was considered as significant in all cases. RF, SVM, GBM, and the multinomial logistic regression model were implemented by ‘randomForest’, ‘kernlab’, ‘gbm’, and ‘glmnet’ package respectively in R. Radial kernel and probability model was used for SVM. All other parameters were kept as default in each respective package. The linear model used in DeepCC SSP was implemented by the ‘lm’ function of R package ‘stats’. The comparison of classification results was based on McNemar’s chi-squared test in R, implemented by the ‘mcnemar.test’ function in ‘stats’ package. Analyses of disease-free survival data were performed using R package ‘survival’ and <italic>p</italic>-values were derived from log-rank tests. AWSs were used as the quantification of the relevance between features and CMS subtypes, calculated by the function ‘silhouette’ in R package ‘cluster’. Fisher’s exact tests, <italic>t</italic>-tests, Wilcoxon signed-rank tests, Pearson correlation coefficients were calculated using R package ‘stats’.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41389_2019_157_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary figures.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41389_2019_157_MOESM2_ESM.pdf">
            <caption>
              <p>Supplementary tables.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Louis Vermeulen and Xin Wang</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary Information</bold> accompanies this paper at (10.1038/s41389-019-0157-8).</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by grants from the Research Grants Council of the Hong Kong Special Administrative Region, China (Project no. CityU 21101115, 11102317, 11103718), as well as a grant from The Science Technology and Innovation Committee of Shenzhen Municipality (JCYJ20170307091256048) to X.W. and partially supported by the Shenzhen Research Institute, City University of Hong Kong, and grants from KWF (UVA2014-7245), the European Research Council (ERG-StG 638193) and ZonMw (Vidi 016.156.308) to L.V.</p>
  </ack>
  <notes notes-type="COI-statement">
    <title>Conflict of interest</title>
    <p id="Par60">The authors declare that they have no conflict of interest.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breugom</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Adjuvant chemotherapy and relative survival of patients with stage II colon cancer—A EURECCA international comparison between the Netherlands, Denmark, Sweden, England, Ireland, Belgium, and Lithuania</article-title>
        <source>Eur. J. Cancer</source>
        <year>2016</year>
        <volume>63</volume>
        <fpage>110</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ejca.2016.04.017</pub-id>
        <pub-id pub-id-type="pmid">27299663</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dotan</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Challenges in the management of stage II colon cancer</article-title>
        <source>Semin Oncol.</source>
        <year>2011</year>
        <volume>38</volume>
        <fpage>511</fpage>
        <lpage>520</lpage>
        <pub-id pub-id-type="doi">10.1053/j.seminoncol.2011.05.005</pub-id>
        <pub-id pub-id-type="pmid">21810510</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jass</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Classification of colorectal cancer based on correlation of clinical, morphological and molecular features</article-title>
        <source>Histopathology</source>
        <year>2007</year>
        <volume>50</volume>
        <fpage>113</fpage>
        <lpage>130</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-2559.2006.02549.x</pub-id>
        <pub-id pub-id-type="pmid">17204026</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Linnekamp</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Medema</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Vermeulen</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Colorectal cancer heterogeneity and targeted therapy: a case for molecular disease subtypes</article-title>
        <source>Cancer Res.</source>
        <year>2015</year>
        <volume>75</volume>
        <fpage>245</fpage>
        <lpage>249</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-14-2240</pub-id>
        <pub-id pub-id-type="pmid">25593032</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoadley</surname>
            <given-names>KA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiplatform analysis of 12 cancer types reveals molecular classification within and across tissues of origin</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>158</volume>
        <fpage>929</fpage>
        <lpage>944</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.06.049</pub-id>
        <pub-id pub-id-type="pmid">25109877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dissecting cancer heterogeneity–an unsupervised classification approach</article-title>
        <source>Int. J. Biochem. Cell Biol.</source>
        <year>2013</year>
        <volume>45</volume>
        <fpage>2574</fpage>
        <lpage>2579</lpage>
        <pub-id pub-id-type="doi">10.1016/j.biocel.2013.08.014</pub-id>
        <pub-id pub-id-type="pmid">24004832</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Consensus clustering: a resampling-based method for class discovery and visualization of gene expression microarray data</article-title>
        <source>Mach. Learn.</source>
        <year>2003</year>
        <volume>52</volume>
        <fpage>91</fpage>
        <lpage>118</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1023949509487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brunet</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2004</year>
        <volume>101</volume>
        <fpage>4164</fpage>
        <lpage>4169</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0308531101</pub-id>
        <pub-id pub-id-type="pmid">15016911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haury</surname>
            <given-names>A-C</given-names>
          </name>
          <name>
            <surname>Gestraud</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Vert</surname>
            <given-names>J-P</given-names>
          </name>
        </person-group>
        <article-title>The influence of feature selection methods on accuracy, stability and interpretability of molecular signatures</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e28210</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0028210</pub-id>
        <pub-id pub-id-type="pmid">22205940</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ein-Dor</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kela</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Givol</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Domany</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Outcome signature genes in breast cancer: is there a unique set?</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>171</fpage>
        <lpage>178</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth469</pub-id>
        <pub-id pub-id-type="pmid">15308542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drier</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Domany</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Do two machine-learning based prognostic signatures for breast cancer capture the same biological processes?</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e17795</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0017795</pub-id>
        <pub-id pub-id-type="pmid">21423753</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Engchuan W., Meechai A., Tongsima S., Chan J. H. Cross-platform pathway activity transformation and classification of microarray data. In <italic>Computational Intelligence in Information Systems</italic>. 139–148 (Springer International Publishing, 2015).</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title>
        <source>Nat. Rev. Genet</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>733</fpage>
        <lpage>739</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2825</pub-id>
        <pub-id pub-id-type="pmid">20838408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rabinovic</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>118</fpage>
        <lpage>127</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxj037</pub-id>
        <pub-id pub-id-type="pmid">16632515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lazar</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Batch effect removal methods for microarray gene expression data integration: a survey</article-title>
        <source>Brief. Bioinform.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>469</fpage>
        <lpage>490</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbs037</pub-id>
        <pub-id pub-id-type="pmid">22851511</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Yan, K., et al. Comprehensive autoencoder for prostate recognition on MR images. In <italic>2016 IEEE 13th International Symposium on Biomedical Imaging</italic> (ISBI). 1190–1194 (2016).</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Kim B., Sung Y. S., Suk H. Deep feature learning for pulmonary nodule classification in a lung CT. In <italic>2016 4th International Winter Conference on Brain-Computer Interface (BCI)</italic>, 1–3 (IEEE, 2016).</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Spanhol F. A., Oliveira L. S., Petitjean C., Heutte L. Breast cancer histopathological image classification using ConvolutionalNeural Networks. In <italic>2016 International Joint Conference on Neural Networks (IJCNN)</italic>, 2560–2567 (IEEE, 2016).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Large scale tissue histopathology image classification, segmentation, and visualization via deep convolutional activation features</article-title>
        <source>BMC Bioinform.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>281</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1685-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Narayan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Gene expression inference with deep learning</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>1832</fpage>
        <lpage>1839</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw074</pub-id>
        <pub-id pub-id-type="pmid">26873929</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Singh</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lanchantin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Robins</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>DeepChrome: deep-learning for predicting gene expression from histone modifications</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>i639</fpage>
        <lpage>i648</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw427</pub-id>
        <pub-id pub-id-type="pmid">27587684</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Troyanskaya</surname>
            <given-names>OG</given-names>
          </name>
        </person-group>
        <article-title>Predicting effects of noncoding variants with deep learning-based sequence model</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>931</fpage>
        <lpage>934</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3547</pub-id>
        <pub-id pub-id-type="pmid">26301843</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Karabulut E. M., Ibrikci T. Discriminative deep belief networks for microarray based cancer classification. <italic>Biomed. Res.</italic><bold>28</bold>, 1016–1024 (2017).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ibrahim</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yousri</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Ismail</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>El-Makky</surname>
            <given-names>NM</given-names>
          </name>
        </person-group>
        <article-title>Multi-level gene/MiRNA feature selection using deep belief nets and active learning</article-title>
        <source>Conf. Proc. IEEE Eng. Med. Biol. Soc.</source>
        <year>2014</year>
        <volume>2014</volume>
        <fpage>3957</fpage>
        <lpage>3960</lpage>
        <?supplied-pmid 25570858?>
        <pub-id pub-id-type="pmid">25570858</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Fakoor R., Ladhak F., Nazi A., Huber M. Using deep learning to enhance cancer diagnosis and classification. In <italic>Proceedings of the International Conference on Machine Learning</italic> (ACM New York, USA, 2013). <ext-link ext-link-type="uri" xlink:href="https://www.researchgate.net/profile/Rasool_Fakoor/publication/281857285_Using_deep_learning_to_enhance_cancer_diagnosis_and_classification/links/5982f029458515a60df82098/Using-deep-learning-to-enhance-cancer-diagnosis-and-classification.pdf">https://www.researchgate.net/profile/Rasool_Fakoor/publication/281857285_Using_deep_learning_to_enhance_cancer_diagnosis_and_classification/links/5982f029458515a60df82098/Using-deep-learning-to-enhance-cancer-diagnosis-and-classification.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Engchuan</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Pathway activity transformation for multi-class classification of lung cancer datasets</article-title>
        <source>Neurocomputing</source>
        <year>2015</year>
        <volume>165</volume>
        <fpage>81</fpage>
        <lpage>89</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neucom.2014.08.096</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Young</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Craft</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <article-title>Pathway-Informed Classification System (PICS) for Cancer Analysis Using Gene Expression Data</article-title>
        <source>Cancer Inform.</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>151</fpage>
        <lpage>161</lpage>
        <pub-id pub-id-type="doi">10.4137/CIN.S40088</pub-id>
        <pub-id pub-id-type="pmid">27486299</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krawczuk</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Łukaszuk</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The feature selection bias problem in relation to high-dimensional gene data</article-title>
        <source>Artif. Intell. Med</source>
        <year>2016</year>
        <volume>66</volume>
        <fpage>63</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1016/j.artmed.2015.11.001</pub-id>
        <pub-id pub-id-type="pmid">26674595</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guinney</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The consensus molecular subtypes of colorectal cancer</article-title>
        <source>Nat. Med</source>
        <year>2015</year>
        <volume>21</volume>
        <fpage>1350</fpage>
        <lpage>1356</lpage>
        <pub-id pub-id-type="doi">10.1038/nm.3967</pub-id>
        <pub-id pub-id-type="pmid">26457759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chia</surname>
            <given-names>SK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 50-gene intrinsic subtype classifier for prognosis and prediction of benefit from adjuvant tamoxifen</article-title>
        <source>Clin. Cancer Res.</source>
        <year>2012</year>
        <volume>18</volume>
        <fpage>4465</fpage>
        <lpage>4472</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-12-0286</pub-id>
        <pub-id pub-id-type="pmid">22711706</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeCun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Deep learning</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>521</volume>
        <fpage>436</fpage>
        <lpage>444</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14539</pub-id>
        <pub-id pub-id-type="pmid">26017442</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Souto</surname>
            <given-names>MCP</given-names>
          </name>
          <name>
            <surname>Jaskowiak</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Costa</surname>
            <given-names>IG</given-names>
          </name>
        </person-group>
        <article-title>Impact of missing data imputation methods on gene expression clustering and classification</article-title>
        <source>BMC Bioinform.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>64</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0494-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hinton</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Salakhutdinov</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>Reducing the dimensionality of data with neural networks</article-title>
        <source>Science</source>
        <year>2006</year>
        <volume>313</volume>
        <fpage>504</fpage>
        <lpage>507</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1127647</pub-id>
        <pub-id pub-id-type="pmid">16873662</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parker</surname>
            <given-names>JS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Supervised risk predictor of breast cancer based on intrinsic subtypes</article-title>
        <source>J. Clin. Oncol.</source>
        <year>2009</year>
        <volume>27</volume>
        <fpage>1160</fpage>
        <lpage>1167</lpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2008.18.1370</pub-id>
        <pub-id pub-id-type="pmid">19204204</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Sousa</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Poor-prognosis colon cancer is defined by a molecularly distinct subtype and develops from serrated precursor lesions</article-title>
        <source>Nat. Med.</source>
        <year>2013</year>
        <volume>19</volume>
        <fpage>614</fpage>
        <lpage>618</lpage>
        <pub-id pub-id-type="doi">10.1038/nm.3174</pub-id>
        <pub-id pub-id-type="pmid">23584090</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fessler</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A multidimensional network approach reveals microRNAs as determinants of the mesenchymal colorectal cancer subtype</article-title>
        <source>Oncogene</source>
        <year>2016</year>
        <volume>35</volume>
        <fpage>6026</fpage>
        <lpage>6037</lpage>
        <pub-id pub-id-type="doi">10.1038/onc.2016.134</pub-id>
        <pub-id pub-id-type="pmid">27157610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krijgsman</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A diagnostic gene profile for molecular subtyping of breast cancer associated with treatment response</article-title>
        <source>Breast Cancer Res. Treat.</source>
        <year>2012</year>
        <volume>133</volume>
        <fpage>37</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1007/s10549-011-1683-z</pub-id>
        <pub-id pub-id-type="pmid">21814749</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Connell</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Relationship between tumor gene expression and recurrence in four independent studies of patients with stage II/III colon cancer treated with surgery alone or surgery plus adjuvant fluorouracil plus leucovorin</article-title>
        <source>J. Clin. Oncol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>3937</fpage>
        <lpage>3944</lpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2010.28.9538</pub-id>
        <pub-id pub-id-type="pmid">20679606</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Laar</surname>
            <given-names>RK</given-names>
          </name>
        </person-group>
        <article-title>An online gene expression assay for determining adjuvant therapy eligibility in patients with stage 2 or 3 colon cancer</article-title>
        <source>Br. J. Cancer</source>
        <year>2010</year>
        <volume>103</volume>
        <fpage>1852</fpage>
        <lpage>1857</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.bjc.6605970</pub-id>
        <pub-id pub-id-type="pmid">21119668</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salazar</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene expression signature to improve prognosis prediction of stage II and III colorectal cancer</article-title>
        <source>J. Clin. Oncol.</source>
        <year>2011</year>
        <volume>29</volume>
        <fpage>17</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2010.30.1077</pub-id>
        <pub-id pub-id-type="pmid">21098318</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kennedy</surname>
            <given-names>RD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Development and independent validation of a prognostic assay for stage II colon cancer using formalin-fixed paraffin-embedded tissue</article-title>
        <source>J. Clin. Oncol.</source>
        <year>2011</year>
        <volume>29</volume>
        <fpage>4620</fpage>
        <lpage>4626</lpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2011.35.4498</pub-id>
        <pub-id pub-id-type="pmid">22067406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lenehan</surname>
            <given-names>PF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Generation and external validation of a tumor-derived 5-gene prognostic signature for recurrence of lymph node-negative, invasive colorectal carcinoma</article-title>
        <source>Cancer</source>
        <year>2012</year>
        <volume>118</volume>
        <fpage>5234</fpage>
        <lpage>5244</lpage>
        <pub-id pub-id-type="doi">10.1002/cncr.27628</pub-id>
        <pub-id pub-id-type="pmid">22605513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agesen</surname>
            <given-names>TH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ColoGuideEx: a robust gene classifier specific for stage II colorectal cancer prognosis</article-title>
        <source>Gut</source>
        <year>2012</year>
        <volume>61</volume>
        <fpage>1560</fpage>
        <lpage>1567</lpage>
        <pub-id pub-id-type="doi">10.1136/gutjnl-2011-301179</pub-id>
        <pub-id pub-id-type="pmid">22213796</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sveen</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ColoGuidePro: a prognostic 7-gene expression signature for stage III colorectal cancer patients</article-title>
        <source>Clin. Cancer Res</source>
        <year>2012</year>
        <volume>18</volume>
        <fpage>6001</fpage>
        <lpage>6010</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-11-3302</pub-id>
        <pub-id pub-id-type="pmid">22991413</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kandimalla</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide Discovery and Identification of a Novel miRNA Signature for Recurrence Prediction in Stage II and III Colorectal Cancer</article-title>
        <source>Clin. Cancer Res.</source>
        <year>2018</year>
        <volume>24</volume>
        <fpage>3867</fpage>
        <lpage>3877</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-17-3236</pub-id>
        <pub-id pub-id-type="pmid">29514841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roepman</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Colorectal cancer intrinsic subtypes predict chemotherapy benefit, deficient mismatch repair and epithelial-to-mesenchymal transition</article-title>
        <source>Int. J. Cancer</source>
        <year>2014</year>
        <volume>134</volume>
        <fpage>552</fpage>
        <lpage>562</lpage>
        <pub-id pub-id-type="doi">10.1002/ijc.28387</pub-id>
        <pub-id pub-id-type="pmid">23852808</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Cancer Genome Atlas Network.</collab>
        </person-group>
        <article-title>Comprehensive molecular portraits of human breast tumours</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>490</volume>
        <fpage>61</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11412</pub-id>
        <pub-id pub-id-type="pmid">23000897</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Orbach</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Principles of Neurodynamics. Perceptrons and the Theory of Brain Mechanisms</article-title>
        <source>Arch. Gen. Psychiatry</source>
        <year>1962</year>
        <volume>7</volume>
        <fpage>218</fpage>
        <lpage>219</lpage>
        <pub-id pub-id-type="doi">10.1001/archpsyc.1962.01720030064010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Glorot X., Bengio Y. Understanding the difficulty of training deep feedforward neural networks. In <italic>Proceedings of the Thirteenth International Conference on Artificial Intelligence and Statistics</italic>, 249–256 (PMLR, 2010).</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Bottou L. Large-Scale Machine Learning with Stochastic Gradient Descent. In <italic>Proceedings of COMPSTAT’2010</italic>. 177–186 (Physica-Verlag HD, 2010).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J. Comput. Appl. Math.</source>
        <year>1987</year>
        <volume>20</volume>
        <fpage>53</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/0377-0427(87)90125-7</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
