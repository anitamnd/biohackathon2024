<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8760642</article-id>
    <article-id pub-id-type="publisher-id">4521</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04521-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Aristotle: stratified causal discovery for omics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Mansouri</surname>
          <given-names>Mehrdad</given-names>
        </name>
        <address>
          <email>mehrdadmansouri@yahoo.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Khakabimamaghani</surname>
          <given-names>Sahand</given-names>
        </name>
        <address>
          <email>sahandk@sfu.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chindelevitch</surname>
          <given-names>Leonid</given-names>
        </name>
        <address>
          <email>leonid_chindelevitch@sfu.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ester</surname>
          <given-names>Martin</given-names>
        </name>
        <address>
          <email>ester@cs.sfu.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.61971.38</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 7494</institution-id><institution>School of Computing Science, </institution><institution>Simon Fraser University, </institution></institution-wrap>8888 University Drive, Burnaby, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>42</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">There has been a simultaneous increase in demand and accessibility across genomics, transcriptomics, proteomics and metabolomics data, known as omics data. This has encouraged widespread application of omics data in life sciences, from personalized medicine to the discovery of underlying pathophysiology of diseases. Causal analysis of omics data may provide important insight into the underlying biological mechanisms. Existing causal analysis methods yield promising results when identifying potential general causes of an observed outcome based on omics data. However, they may fail to discover the causes specific to a particular stratum of individuals and missing from others.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p id="Par2">To fill this gap, we introduce the problem of stratified causal discovery and propose a method, Aristotle, for solving it. Aristotle addresses the two challenges intrinsic to omics data: high dimensionality and hidden stratification. It employs existing biological knowledge and a state-of-the-art patient stratification method to tackle the above challenges and applies a quasi-experimental design method to each stratum to find stratum-specific potential causes.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">Evaluation based on synthetic data shows better performance for Aristotle in discovering true causes under different conditions compared to existing causal discovery methods. Experiments on a real dataset on Anthracycline Cardiotoxicity indicate that Aristotle’s predictions are consistent with the existing literature. Moreover, Aristotle makes additional predictions that suggest further investigations.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-04521-w.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Causal discovery</kwd>
      <kwd>Stratification</kwd>
      <kwd>Biclustering</kwd>
      <kwd>Quasi-experiment</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>LSARP</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008762</institution-id>
            <institution>Genome Canada</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>NSERC Discovery</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000879</institution-id>
            <institution>Alfred P. Sloan Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par12">The goal of causal discovery is to infer the cause-effect relationships between an outcome variable and a number of explanatory variables, called features, which pinpoint the mechanism through which changes in the features result in changes in the outcome [<xref ref-type="bibr" rid="CR1">1</xref>]. Causal discovery is used in various fields to discover the causes of complex outcomes, from economics to medicine [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. In the life sciences, genomics, transcriptomics, proteomics and metabolomics data, often referred to as omics data, have experienced an explosive growth rate over the past decade, making them great candidates for causal discovery [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par13">For instance, anthracycline cardiotoxicity is a multi-factorial Adverse Drug Reaction (ADR), whose main mechanisms are believed to be the inhibition of Topoisomerase 2<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M2"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq1.gif"/></alternatives></inline-formula> and the reaction of reactive oxygen species [<xref ref-type="bibr" rid="CR7">7</xref>]. This means that the <italic>rs</italic>2229774 mutation in the <italic>RARG</italic> gene, which influences Topoisomerase <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\beta$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mn>2</mml:mn><mml:mi>β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq2.gif"/></alternatives></inline-formula>, would cause toxicity in some, but not all of the anthracycline patients [<xref ref-type="bibr" rid="CR8">8</xref>]. Current causal analysis methods may lack the statistical power for detecting rs2229774 mutation as a cause for the ADR when looking at the whole population. This causal variant would be dismissed by a current causal analysis methods on the whole population. This is because rs2229774 is absent in those cases where the ADR is caused by the reactive oxygen species mechanism, as there would be patients without this variant in the <italic>RARG</italic> in which anthracycline cardiotoxicity would nevertheless occur.</p>
    <p id="Par14">Randomized controlled trials, where participants are randomly assigned to a case group that undergoes a treatment and a control group that does not, are considered the state-of-the-art approach for testing causality [<xref ref-type="bibr" rid="CR9">9</xref>]. However, due to costs and ethical restrictions, randomized controlled trials are impractical to conduct in many scenarios.</p>
    <p id="Par15">The increasing availability of observational data has motivated the development of data mining methods for causal discovery from observational data in the past three decades, and the structure learning approach has been the center of these developments [<xref ref-type="bibr" rid="CR10">10</xref>]. The goal of structure learning is to produce a graph whose edges represent causal relationships between the variable nodes [<xref ref-type="bibr" rid="CR11">11</xref>]. The common constraint-based structure learning methods achieve this by employing a series of statistical tests to evaluate the conditional independences between the variables to incrementally construct the graphical structure.</p>
    <p id="Par16">One of the major developments in structure learning is the PC-algorithm [<xref ref-type="bibr" rid="CR1">1</xref>], which is designed to efficiently discover the causal structure in the absence of unobserved confounders. FCI [<xref ref-type="bibr" rid="CR12">12</xref>], RFCI [<xref ref-type="bibr" rid="CR13">13</xref>] and their subsequent modifications [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>] were able to find causal relations in the presence of unobserved confounders by performing additional conditional dependency tests, to improve the speed of the algorithm by compromising on the dependency assumptions, and to eliminate the dependency on the order of tests by preparing the model for possible orientation rule effects. Another direction of research has been to investigate local causal discovery methods [<xref ref-type="bibr" rid="CR17">17</xref>], which focus on the Markov blanket to find only those features that are the direct causes of the outcome. However, the computational complexity of structure learning remains exponential in the number of variables [<xref ref-type="bibr" rid="CR17">17</xref>], which make it infeasible for omics datasets with hundreds of thousands of variables [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par17">In recent years, a new direction of research in the data mining community for causal discovery from observational data has emerged. The new methods consist of a filtering algorithm for discovering candidate features from the set of all features, coupled with a Quasi-Experimental Design (QED) or a similar statistical hypothesis testing process for evaluating the validity of those candidate causes. This paradigm for causal discovery promises to scale to larger datasets because the filtering algorithm drastically reduces the number of hypotheses to be tested by QED.</p>
    <p id="Par18">In [<xref ref-type="bibr" rid="CR19">19</xref>], candidate features are selected through an association rule mining algorithm and tested in a series of retrospective cohort studies to evaluate the causality of the candidates. In HUME [<xref ref-type="bibr" rid="CR20">20</xref>], a network of co-occurrence between features and outcomes was used to determine the most likely candidate feature-outcome combinations and their potential confounders, and the causality of the candidates was evaluated by a matched pairs QED.</p>
    <p id="Par19">All of the aforementioned methods have the tendency to discover the causes that would try to explain all positive cases in the outcome. However, this gives low significance to causes that occur only in a particular subpopulation of the positive cases (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).</p>
    <p id="Par20">To perform causal discovery in such scenarios, this paper introduces the problem of stratified causal discovery (SCD), the simultaneous discovery of sub-populations and their corresponding causal mechanisms. We show that if the outcome is modified to represent the outcome strata instead of the original outcome, the less prevalent causal mechanisms are more likely to be captured. Here, an outcome stratum is a subset of cases with a positive outcome that share a causal mechanism.</p>
    <p id="Par21">We present Aristotle, the first method for solving SCD. Aristotle is a multi-phase algorithm that tackles the above challenges by using a novel divide-and-conquer scheme that utilizes biclustering for finding the promising strata and candidate causes and QED to identify the stratum-specific causes. Aristotle is capable of analyzing high dimensional omics data and allows the incorporation of prior domain knowledge about potential confounders and the grouping of biological features.</p>
    <p id="Par22">Our extensive experiments on synthetic and real datasets demonstrate that Aristotle effectively discovers potentially causal features and strata and clearly outperforms the compared state-of-the-art methods.</p>
    <p id="Par23">Rest of the paper is organized as follows. In “<xref rid="Sec2" ref-type="sec">Problem definition</xref>” section we formally introduce the stratified causal discovery problem and describe the inputs, the outputs, and the assumptions. In “<xref rid="Sec3" ref-type="sec">Methods</xref>” section we provide an overview of Aristotle, a justification for its design, and a detailed explanation of each of its phases. Finally, in “<xref rid="Sec9" ref-type="sec">Results</xref>” section we present our experiments on synthetic and real data and discuss our findings.</p>
  </sec>
  <sec id="Sec2">
    <title>Problem definition</title>
    <p id="Par24">The goal of the SCD problem is to identify the causal features involved in different mechanisms associated with an outcome, such as an ADR. The outcome is assumed to have one of two possible values: positive (e.g. an ADR observed) and negative (e.g. no ADR observed). We are interested in the mechanisms corresponding to the positive outcome. Each distinct mechanism is captured by a different hidden stratum of samples, and for every stratum, we want to find the features that potentially cause the positive outcome. Hence, SCD is defined as the problem of identifying strata of samples with positive outcome such that for each stratum, there exist a group of features at statistically significant association with membership in the stratum, after controlling the effect of confounders. Here, we follow the strict notion of causality, which expects that the outcome is positive almost always when and only when the feature group is positive. There are two types of confounders that need to be controlled to avoid endogeneity: (1) natural confounders which are the variables that are known to have association with the outcome, and may include a wide variety of variables such as demographic and clinical attributes, and (2) omics confounders which are features that have a statistically significant association with the outcome. Formally, the inputs are as follows:<list list-type="bullet"><list-item><p id="Par25">An outcome vector <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R \in \{-1,+1\}^{n}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>R</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq3.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i=+1$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq4.gif"/></alternatives></inline-formula> if sample <italic>i</italic> has the positive outcome and <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i=-1$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq5.gif"/></alternatives></inline-formula> otherwise.</p></list-item><list-item><p id="Par26">A matrix of omics profiles <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G \in \{0,1\}^{p \times n}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>G</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq6.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{.i}=\{g_{1i},...,g_{pi}\}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="italic">pi</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq7.gif"/></alternatives></inline-formula> indicates the feature values for sample <italic>i</italic>. If sample <italic>i</italic> has feature <italic>j</italic> present, this is denoted by <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{ji}=1$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq8.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{ji}=0$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq9.gif"/></alternatives></inline-formula> otherwise. <italic>G</italic> can contain a large collection of omics data such as mutations, gene expression, and copy number variations [<xref ref-type="bibr" rid="CR21">21</xref>].</p></list-item><list-item><p id="Par27">A matrix of confounder profiles <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z \in \{0,1\}^{m \times n}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq10.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_{.i}=\{z_{1i},...,z_{mi}\}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi mathvariant="italic">mi</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq11.gif"/></alternatives></inline-formula> indicates the state of the confounders for sample <italic>i</italic>.</p></list-item><list-item><p id="Par28">Prior knowledge about the relationships between the features (e.g., pathways as functional groups of genomic features). As described later in “<xref rid="Sec4" ref-type="sec">Group Features Based on Background Knowledge</xref>” section, this knowledge is used to group related features to resolve the high-dimensionality issue by dividing the large problem into smaller pieces. This input is only needed for high-dimensional inputs with hundreds of thousands features.</p></list-item></list>The outputs are:<list list-type="bullet"><list-item><p id="Par29">A (disjoint) grouping <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{P_1,...,P_K\}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq12.gif"/></alternatives></inline-formula> of the sample population <italic>P</italic> such that <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cup _k P_k = P$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mo>∪</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq13.gif"/></alternatives></inline-formula>. Equivalently, this is the assignment of each sample to one of <italic>K</italic> strata. Each stratum contains a subset of the population with similar outcome (for almost all <italic>k</italic> and all <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a,b \in P_k$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq14.gif"/></alternatives></inline-formula>, <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_a=r_b$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq15.gif"/></alternatives></inline-formula>).</p></list-item><list-item><p id="Par30">For each stratum with positive outcome, a set of features that are potentially causing the outcome in the stratum. A causal relationship of the feature <italic>j</italic> to the outcome <italic>r</italic> for strata <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_k$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq16.gif"/></alternatives></inline-formula> given confounders <italic>Z</italic> means that, after correcting for the effect of <italic>Z</italic>, there is significant evidence suggesting that for the samples in <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_k$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq17.gif"/></alternatives></inline-formula>, the value of the feature <italic>j</italic> is responsible for determining the outcome <italic>r</italic>.</p></list-item></list><fig id="Fig1"><label>Fig. 1</label><caption><p>Diagram representing four variables (columns) across different sample (rows). A standard cause (blue) is highly associated with the original outcome (yellow), and can be identified by most measures of association. However, a stratum cause (green) that only affects the outcome in a particular type of samples (<inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1_A$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mn>1</mml:mn><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq18.gif"/></alternatives></inline-formula>), could be missed from simple association with the outcome, and requires comparison against its corresponding outcome stratum (red) to be identified confidently</p></caption><graphic xlink:href="12859_2021_4521_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par31">Values of features and outcome are assumed to be discrete for three reasons: (1) discrete data can be modeled through Multinomial distribution, which reduces the complexity in training and evaluation of the models, (2) discrete omics data have been shown to improve the prediction accuracy and generality of the trained model [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>], (3) most of the currently available high dimensional omics data are discrete in nature [<xref ref-type="bibr" rid="CR24">24</xref>]. For effective discretization of continuous data (gene expression for example) for the strata analysis, we suggest the method used in [<xref ref-type="bibr" rid="CR25">25</xref>].</p>
    <p id="Par32">It should also be noted that unlike the classical causal discovery methods where the causes are considered based on their adjusted association with the positive outcome, in SCD the causes are considered based only on the outcomes corresponding to the particular stratum. Figure <xref rid="Fig2" ref-type="fig">2</xref> illustrates these two types of causes.<fig id="Fig2"><label>Fig. 2</label><caption><p>A sample dataset illustrating stratum-specific and general causal features</p></caption><graphic xlink:href="12859_2021_4521_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par33">There are two main challenges in solving the SCD problem. The first challenge is the small number of samples combined with a very large number of features, which is typical of most omics datasets. This problem is exacerbated in SCD because stratification (1) further thins out the number of samples for each hypothesis, and (2) multiplies the number of possible causes by the number of strata. This in turn increases the amount of penalty of the multiple hypothesis testing of the causal analysis and makes it less likely to find the right cause, especially if the number of samples is small. The second challenge is to identify the hidden strata that reflect the underlying causal mechanisms; these are not known a priori, and, if poorly chosen, may negatively impact the validity of the results.</p>
  </sec>
  <sec id="Sec3">
    <title>Methods</title>
    <p id="Par34">The overall design of ARISTOTLE is based on a novel divide-and-conquer scheme that breaks the set of features into groups and aggregates the significant sample and feature patterns. To do this, ARISTOTLE utilizes supervised biclustering to identifying the promising strata and features, and matching QED to evaluate the causality of features with respect to an identified stratum.</p>
    <p id="Par35">ARISTOTLE’s solution to SCD’s first challenge is to select a shortlist of candidate causes from the set of features, based on their association with the effect, which is the causal strata in SCD. However, the true strata are unknown, which brings us to SCD’s second challenge of simultaneously stratify the samples and identify the candidate causes. This can be solved using a biclustering that jointly groups features and samples based on their association, which could also be used to score and filter the features.</p>
    <p id="Par36">However, due to the high dimensionality, it is infeasible to perform the computationally complex biclustering on all features simultaneously. Hence, for high-dimensional omics data, ARISTOTLE has to divide the features into groups, perform the biclustering to find the candidate features and strata locally, i.e. separately within each group, and then merge the results to form a data matrix with fewer but more relevant features. After the features are reduced to candidate features, biclustering can be reused, this time addressing the second challenge. Grouping of the features can be performed randomly, if no prior grouping knowledge is available, or skipped if the problem is not very high-dimensional, in which case all features are set in one group. Finally, Aristotle needs to evaluate the causality of the association between each of the candidate features and each of the positive strata. QED is used for causal inference which is one of the best approaches for causal inference from observational data of small sample size created by the first challenge.</p>
    <p id="Par37">In short, Aristotle consists of the following five steps, which are illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref>: <list list-type="order"><list-item><p id="Par38">Group features of the input data into <italic>D</italic> groups <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_d$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>G</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq19.gif"/></alternatives></inline-formula>, <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \le d \le D$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq20.gif"/></alternatives></inline-formula>, based on background knowledge;</p></list-item><list-item><p id="Par39">Assign weights <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_d$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>W</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq21.gif"/></alternatives></inline-formula> to the features of each group <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_d$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>G</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq22.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par40">Filter the set of features of each group <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_d$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>G</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq23.gif"/></alternatives></inline-formula> given their corresponding weights <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_d$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>W</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq24.gif"/></alternatives></inline-formula>, resulting in a set of locally selected features <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_d$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>C</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq25.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par41">Stratify the samples based on the set of candidate features <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C=\cup _{d=1}^D C_d$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∪</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>D</mml:mi></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq26.gif"/></alternatives></inline-formula> and the outcome <italic>R</italic>, resulting in <italic>K</italic> strata <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_k$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq27.gif"/></alternatives></inline-formula>, <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \le k \le K$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq28.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par42">Evaluate the causality of the candidate features <italic>C</italic> with regard to the outcome in each stratum <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_k$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq29.gif"/></alternatives></inline-formula>.</p></list-item></list>Further details of each step are provided in the following sections.<fig id="Fig3"><label>Fig. 3</label><caption><p>Overview of Aristotle. The data are shown by rectangular blocks and the methods are shown by ovals. <italic>P</italic>, <italic>R</italic>, <italic>G</italic>, and <italic>Z</italic> are defined in “<xref rid="Sec2" ref-type="sec">Problem definition</xref>” section <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_1$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq30.gif"/></alternatives></inline-formula> to <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_D$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>G</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq31.gif"/></alternatives></inline-formula> are the subsets of <italic>G</italic> corresponding to feature groups produced in the Feature Grouping phase (see “<xref rid="Sec4" ref-type="sec">Group Features Based on Background Knowledge</xref>” section). <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_1$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>W</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq32.gif"/></alternatives></inline-formula> to <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_D$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>W</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq33.gif"/></alternatives></inline-formula> are the feature weights produced by biclustering for each feature group. <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq34.gif"/></alternatives></inline-formula> to <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_D$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>C</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq35.gif"/></alternatives></inline-formula> are the sets of the top weighted features in each of the feature groups that the feature selection method (indicated by FS in the diagram) chooses from groups <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_1$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq36.gif"/></alternatives></inline-formula> to <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_D$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>G</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq37.gif"/></alternatives></inline-formula> given the weights <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_1$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>W</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq38.gif"/></alternatives></inline-formula> to <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_D$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>W</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq39.gif"/></alternatives></inline-formula>, respectively.<inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_1$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq40.gif"/></alternatives></inline-formula> to <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_K$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi>P</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq41.gif"/></alternatives></inline-formula> are the sample strata produced by biclustering. Quasi-experimental design (indicated by QED in the diagram) evaluates the candidate features in the set <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C=\cup _{d=1}^{D} C_d$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∪</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>D</mml:mi></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq42.gif"/></alternatives></inline-formula> for causality with respect to their corresponding sample strata and confounders <italic>Z</italic>. The outputs of QED are tuples that indicate the causal pairs of feature and stratum</p></caption><graphic xlink:href="12859_2021_4521_Fig3_HTML" id="MO3"/></fig></p>
    <sec id="Sec4">
      <title>Group features based on background knowledge</title>
      <p id="Par43">This phase groups features into <italic>D</italic> possibly overlapping subsets <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_d$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>G</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq43.gif"/></alternatives></inline-formula> (<inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \le d \le D$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq44.gif"/></alternatives></inline-formula>), such that <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cup _{d=1}^D G_d \subseteq G$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msubsup><mml:mo>∪</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>D</mml:mi></mml:msubsup><mml:msub><mml:mi>G</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>⊆</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq45.gif"/></alternatives></inline-formula>. Each group should be small enough to be handled efficiently by biclustering, and at the same time, there should be a meaningful relationship between the features that are in the same group, so that the results of the downstream analysis are relevant.</p>
      <p id="Par44">Because biological pathways are the functional units inside the cell, their use to produce distinct views from omics data is commonplace [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. Therefore, in our experiments, we choose to form feature groups that correspond to Kyoto Encyclopedia of Genes and Genomes (KEGG) pathways [<xref ref-type="bibr" rid="CR28">28</xref>] to reflect the real-world implications of the functional effects of pathways. The features that did not correspond to any pathway are discarded.</p>
    </sec>
    <sec id="Sec5">
      <title>Assign weights to features</title>
      <p id="Par45">In this phase, for each feature group, Aristotle needs to bicluster features and estimate strata-based feature weights. For this task ARISTOTLE uses SUBSTRA [<xref ref-type="bibr" rid="CR25">25</xref>], a state-of-the-art probabilistic supervised biclustering method. SUBSTRA takes the omics profiles of a set of samples along with the outcomes, and produces three inter-related outputs: (1) sample strata, (2) feature clusters, and (3) feature weights. SUBSTRA learns these outputs through an iterative approach that simultaneously optimizes two objectives: biclustering quality and predictive performance.</p>
      <p id="Par46">We chose SUBSTRA for three reasons. First, SUBSTRA assumes similar outcomes for samples in each stratum. This is important for consistency with the notion of stratum-specific causality in the SCD problem (“<xref rid="Sec2" ref-type="sec">Problem definition</xref>” section). Second, SUBSTRA learns feature weights according to their relevance to the outcome, and uses these weights when computing the strata. Accordingly, the feature weights, the strata, and the outcome depend on each other in SUBSTRA, so the produced strata are related to the significant features which are involved in different mechanisms of the outcome. Third, the feature weights produced by SUBSTRA indicate the amount of dependency between the features and the outcome, and can be used for filtering out irrelevant features and narrowing down the set of candidate causal features. This feature filtering helps reduce the number of effective hypotheses and avoid the multiple-hypothesis testing penalties, which is the first challenge in SCD. It should be noted that this is only possible because the patterns that cannot reach statistical significance, or are not tested against the outcome, do not need to be taken into account while correcting for multiple hypothesis testing [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. This assumption is tested in practice in the result section.</p>
    </sec>
    <sec id="Sec6">
      <title>Filter features of each feature group</title>
      <p id="Par47">In this phase, we identify the most promising features based on the weights they received after the Feature Weighting phase. Since SUBSTRA produces weights relative only to the other features in each group, the weights from two different feature groups are not comparable to each other. Accordingly, we apply a Feature Selection algorithm independently to each group. For this task, we use an outlier detection algorithm, which selects features with weights outlying from the distribution of weights in the group.</p>
      <p id="Par48">Specifically, we use the scaled median absolute deviation (MAD) [<xref ref-type="bibr" rid="CR31">31</xref>] as the boundary above which the weights are considered outliers. There are two reasons for choosing MAD. First, MAD is based on a parsimonious and well-studied equation which requires only one parameter, and adds a minimum level of complexity to the process. Second, MAD is extremely robust to heavy-tail distributions, as we observe for SUBSTRA’s weights. The MAD for the feature weights of a group <italic>d</italic> can be computed using the formula:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} MAD_d = \frac{\mathrm {M}\left( |W_d-\mathrm {M} \left( W_d\right) |\right) }{\sqrt{2} \cdot \mathrm {erf^{-1} (1/2)}}, \end{aligned}$$\end{document}</tex-math><mml:math id="M92" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>W</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mo>·</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">erf</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4521_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq46"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_d$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mi>W</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq46.gif"/></alternatives></inline-formula> is the vector of weights of features for feature group <italic>d</italic>, <inline-formula id="IEq47"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M(\cdot )$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq47.gif"/></alternatives></inline-formula> is the median of its input argument, and <inline-formula id="IEq48"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {erf}$$\end{document}</tex-math><mml:math id="M98"><mml:mi mathvariant="normal">erf</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq48.gif"/></alternatives></inline-formula> is the Gaussian error function. We can decide whether a weight <italic>w</italic> in group <italic>d</italic> is an outlier, if <inline-formula id="IEq49"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w - \mathrm {M}(W_d) &gt; L \times MAD_d$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>w</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq49.gif"/></alternatives></inline-formula>. The parameter <italic>L</italic> behaves similarly to the number of standard deviations, and determines how extreme a weight should be to be considered an outlier. In standard practice, the value of <italic>L</italic> is usually selected as an integer between 2 and 5. With the outlier features from each group in hand, we can aggregate them to form the set of candidate features for causal analysis.</p>
    </sec>
    <sec id="Sec7">
      <title>Sample stratification</title>
      <p id="Par49">To perform the stratified causal analysis, we need to know the sample strata. To compute the sample strata, we only use the selected important features from the Feature Filtering phase, which are expected to be more relevant to the outcome than the other features. Ideally, we want the strata to be related to the outcome by capturing different patterns that define the subsets of the two outcome classes. Therefore, once again, we use SUBSTRA for this task, which forms strata with homogeneous outcomes, such that the patterns of up-weighted features are different between the strata as well as the positive and negative outcomes.</p>
    </sec>
    <sec id="Sec8">
      <title>Quasi-experimental design</title>
      <p id="Par50">After the strata and candidate features are identified, our objective is to evaluate whether there is sufficient evidence for a causal relation between the features and the samples of a particular stratum. As input, our QED takes the sample strata <inline-formula id="IEq50"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_1$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq50.gif"/></alternatives></inline-formula> to <inline-formula id="IEq51"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_K$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>P</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq51.gif"/></alternatives></inline-formula> produced in the Sample Stratification phase, the candidate features <italic>C</italic> produced in the Feature Filtering phase, and the confounders <italic>Z</italic>. The output of QED is a list of tuples, where each tuple includes a causal feature and its corresponding stratum, i.e. the stratum that has a positive outcome due (in part) to having this feature. Each feature can be associated to more than one strata, and each stratum can have more than one causal feature. We achieve this goal using matched pairs QED.</p>
      <p id="Par51">Matched pairs design is used for hypotheses in which the potential causes, known as the treatment, has two possible outcomes, as is the case for the candidate features in our problem. In a matched pairs design, the samples are grouped into pairs. In each pair, one sample has received the treatment feature and the other sample has not, but they are as similar as possible with respect to the confounders. Confounders must include both the natural confounders given in input, as well as the other candidates which were statistically significant in the initial Feature Filtering step [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. In our pairing approach, we assume two types of constraints. First, we make sure that the confounders <italic>Z</italic> have identical values for the two elements of each pair. Second, we use Manhattan distance of the other candidate features from <italic>C</italic> to form pairs with elements that are as similar as possible to each other. For efficient pairing, Aristotle employs the Hungarian matching algorithm [<xref ref-type="bibr" rid="CR33">33</xref>] based on the Manhattan distance.</p>
      <p id="Par52">In the next step we use McNemar’s test to check whether the value of the outcome within the pairs is statistically associated with the value of the treatment feature. With this procedure, a large number of hypotheses would be tested for each SCD problem. This increases the chance of some of these hypotheses being incorrectly accepted by chance, which is known as data dredging. To avoid data dredging, a multiple hypothesis testing procedure needs to be used to adjust the significance level [<xref ref-type="bibr" rid="CR34">34</xref>]. A standard approach for dealing with multiple hypothesis testing is using the False Discovery Rate (FDR). The FDR is defined as the expected proportion of significant findings that are false positives. Like most methods for controlling the FDR, Aristotle requires the number of true null hypotheses [<xref ref-type="bibr" rid="CR35">35</xref>]. In Aristotle, due to elimination of some of the potential hypothesis during the Feature Filtering, the equivalent number of hypothesis is hard to identify and lies in the wide range from the number of candidates to the total number of features. Therefore, a method for estimating the number of true null hypotheses is used in Aristotle. A well-known procedure for the estimation of the number of true null hypotheses is the adaptive Benjamini-Hochberg [<xref ref-type="bibr" rid="CR36">36</xref>]. Adaptive Benjamini-Hochberg works based on the graphical interpretation of the <inline-formula id="IEq52"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q-q$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq52.gif"/></alternatives></inline-formula> plot of <italic>p</italic>-values, which results in a simple stepwise procedure for estimating the number of true null hypotheses.</p>
      <p id="Par53">In summary, in the QED step: (1) for each candidate, samples are paired based on their differences with respect to the candidate feature, confounders, and other features in <italic>C</italic> using the Hungarian algorithm, (2) the <italic>p</italic>-value of the hypothesis corresponding to our matched pairs design is calculated using McNemar’s test with Yates’ correction, and (3) the <italic>p</italic>-values of candidate features are analyzed using the adaptive Benjamini-Hochberg method and a subset of them are reported as the causal features.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results</title>
    <sec id="Sec10">
      <title>Experiments on synthetic data</title>
      <p id="Par54">To properly evaluate the performance of Aristotle under different conditions and with known ground truth, we created synthetic datasets. Our goal was to reproduce the biclustering of SNP annotation score [<xref ref-type="bibr" rid="CR37">37</xref>–<xref ref-type="bibr" rid="CR39">39</xref>] and gene expression [<xref ref-type="bibr" rid="CR40">40</xref>] in different ethnic groups and cell types. To reflect the biological reality and the criteria discussed in the problem definition, the generation of our synthetic data is based on the following assumptions:<list list-type="bullet"><list-item><p id="Par55">Features form clusters and the members of those clusters have similar values across all samples. The sizes of feature clusters follow a Binomial distribution. Some of the feature clusters are causal, meaning that all of the features in those clusters are causal features. The remaining clusters are non-causal, meaning that none of their members is causal.</p></list-item><list-item><p id="Par56">Each feature cluster is present in a subset of samples, i.e. the features of the cluster have a value of 1 for those samples but 0 for the others. Each cluster simulates a haplotype [<xref ref-type="bibr" rid="CR41">41</xref>], a set of Single Nucleotide Polymorphisms (SNP), i.e. mutations of a single position in the genome, that tend to be inherited together.</p></list-item><list-item><p id="Par57">The members of causal feature clusters have value 1 only for a subset of patients with the positive outcome (a stratum corresponding to a causal mechanism). There is a one-to-one relationship between the causal feature clusters and the strata of patients with positive outcome.</p></list-item><list-item><p id="Par58">On top of the feature clusters, there is another layer of grouping of features which represents the pathways. These pathways are mixtures of different feature clusters; however, they tend to contain features from a small number of different feature clusters, i.e. they have small entropies. To achieve this, we use a process based on the concept of ”rich gets richer”, i.e. a feature <italic>j</italic> is assigned to a pathway <italic>X</italic> with a probability proportional to the fraction of the current features in <italic>X</italic> that belong to the cluster containing <italic>j</italic>. This idea was introduced in the Barabasi-Albert algorithm [<xref ref-type="bibr" rid="CR42">42</xref>], originally designed for network simulation.</p></list-item><list-item><p id="Par59">Both features and outcome variables contain noise. Noise is added to the features and outcomes by flipping a randomly selected portion of the entries.</p></list-item></list>The parameters of synthetic data generation are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. All parameters are set to be in the same order of magnitude as our ADR data and the typical values of omics datasets [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR43">43</xref>, <xref ref-type="bibr" rid="CR44">44</xref>], which also matches with the marginal distributions in [<xref ref-type="bibr" rid="CR45">45</xref>]. We evaluate the effect of the last three parameters in this table, which we expected to have the biggest impact on Aristotle’s performance. The effect of varying each parameter is investigated by fixing the other two at their default values shown in Table <xref rid="Tab1" ref-type="table">1</xref>. It should be noted that similar omics data-generation processes in the literature could not be used [<xref ref-type="bibr" rid="CR45">45</xref>], because they could not produce the biclustering joint distribution reflected in the annotation scores [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
    </sec>
    <sec id="Sec11">
      <title>Baseline methods</title>
      <p id="Par60">Two other baseline methods are included for benchmarking purposes. First, we use the Really Fast Causal Inference (RFCI) algorithm [<xref ref-type="bibr" rid="CR13">13</xref>] to compare the accuracy of Aristotle in causal discovery. This method is designed for learning causal relationships between random variables. It infers conditional independence between all pairs of variables assuming arbitrary number of latent (i.e. unmeasured) and selection (i.e. unmeasured variables determining the inclusion of the effect of measured variables) variables, which makes the detection of causal relationships difficult. RFCI improves the computational complexity of FCI [<xref ref-type="bibr" rid="CR1">1</xref>] by reducing the number of conditional independence tests and conditioning on a smaller number of variables. However, RFCI is still computationally intensive. Therefore, we employed the same divide and conquer approach as in Aristotle. More precisely, RFCI is applied to each pathway separately and then applied again to the union of causal features selected for different pathways by RFCI. This produces the final set of features predicted to be causal for the outcome variable.</p>
      <p id="Par61">Second, to compare Aristotle’s stratification quality, a supervised fuzzy clustering method introduced in [<xref ref-type="bibr" rid="CR46">46</xref>] is used as benchmark. Similar to SUBSTRA, this method incorporates supervision into the clustering and produces classification scores for features. Their algorithm uses the class label of each point to identify the optimal set of clusters that describe the data, and the obtained clusters are then used to build a fuzzy classifier based on relevant features identified using Fisher-interclass separability method [<xref ref-type="bibr" rid="CR47">47</xref>]. We used all of the features as input for this algorithm as one would naturally do (i.e. no divide and conquer approach).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Parameters of synthetic data generation and their values</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Parameter</th><th align="left">Value</th></tr></thead><tbody><tr><td align="left">Number of features</td><td align="left">100,000</td></tr><tr><td align="left">Number of feature clusters</td><td align="left">2500</td></tr><tr><td align="left">Number of pathways</td><td align="left">100</td></tr><tr><td align="left">Feature noise</td><td align="left">0.05</td></tr><tr><td align="left">Fraction of positive samples</td><td align="left">0.2</td></tr><tr><td align="left">Number of causal feature clusters</td><td align="left">2, <underline>3</underline>, 4, 5</td></tr><tr><td align="left">Outcome noise</td><td align="left">0, 0.05, <underline>0.1</underline>, 0.2</td></tr><tr><td align="left">Number of positive samples</td><td align="left">75, <underline>100</underline>, 125, 150</td></tr></tbody></table><table-wrap-foot><p>The default values are underlined</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec12">
      <title>Results of experiments</title>
      <p id="Par62">The results are shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. First, we test whether the strata found by Aristotle match the true strata of the data. We measure this using the Rand index [<xref ref-type="bibr" rid="CR48">48</xref>], a well-known method for measuring the performance of a clustering algorithm based on an external gold standard. These results show that the Rand index of Aristotle’s strata with respect to the true strata is consistently above 0.5 and reaches a value of about 0.8 in most cases. As expected, the Rand index decreases with increasing noise, but does so slowly. Somewhat unexpectedly, Aristotle tends to be more successful in scenarios with a larger number of strata. This is due to the fact that Aristotle tends to decompose the true strata into subsets due to the effect of non-causal features, resulting in smaller Rand index for cases with fewer strata. The Rand index varies little with respect to the number of samples. Compared to the supervised fuzzy clustering method, Aristotle achieves a consistently and substantially larger Rand index in all experimental settings. Even though both methods use supervision, this indicates a better incorporation of the supervision information in Aristotle through feature weighting.<fig id="Fig4"><label>Fig. 4</label><caption><p>Results for the experiments with the synthetic data</p></caption><graphic xlink:href="12859_2021_4521_Fig4_HTML" id="MO5"/></fig></p>
      <p id="Par63">Second, we evaluate how well Aristotle performs in finding the causal features. We observe that the recall of causal features decreases significantly with increasing percentage of noise and with increasing number of causal feature clusters (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>). This may be due to the reduction in size of the positive strata, which results in a weaker signal for each causal feature and consequently lower statistical power. For the same reason, increasing the number of positive samples improves the recall. Aristotle consistently outperforms RFCI, which demonstrates the advantages of stratified causal discovery over the classical methods that discover causes in the whole population. The gap between the two methods decreases with increasing outcome noise, and both methods perform equally poorly (recall <inline-formula id="IEq53"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx 0.2$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq53.gif"/></alternatives></inline-formula>) for 20% outcome noise. However, the difference between Aristotle and RFCI becomes more pronounced for higher number of positive samples. This is because RFCI substituting the FCI’s possible separation sets with adjacency sets (to speed up the independency checks) compromises the completeness of the causal graph, hinders it from achieving higher accuracies.</p>
      <p id="Par64">As for the sensitivity of Aristotle’s precision to different dataset parameters, according to Fig. <xref rid="Fig4" ref-type="fig">4</xref>, its precision remains at a high level, around 95%, and is always better than RFCI in all the experimental settings we tested. This is consistent with the premise of an FDR of 5%. Although RFCI achieves a similar precision for smaller numbers of strata and levels of noise, the advantage of Aristotle increases for the harder problems with more strata and higher noise levels. To conclude, our experimental results on synthetic data show that Aristotle consistently outperforms RFCI for causal feature discovery.</p>
      <p id="Par65">Lastly, we evaluate Aristotle’s success in identifying causal features among the filtered features. To test this, we compare the performance of Aristotle under the default parameters with two alternative QED settings applied to the filtered features: (1) regular QED without considering the strata, i.e. all positive samples as one group, (2) QED using the ground-truth positive strata as the positive outcome. Aristotle achieves a precision of 0.9306 and a recall of 0.6262. The QED with setting (1) has a precision of 0.95 and a recall of 0.29. The greatly reduced recall is due to the alternative QED’s failure to detect the stratum-specific causal features. This is due to the concentration of the occurrence of causal feature in a small subset of positive samples constituting a stratum. When matching in the regular QED, this small difference fails to separate the positive strata and matching positive samples reduces the support for the hypothesis. This further supports our claim that stratification of the samples can find the potential causes which would have been otherwise missed. The reason for the higher precision of the regular QED is that it results in larger <italic>p</italic>-values in general and, therefore, is more conservative. The QED with setting (2) has a precision of 1 and a recall of 0.69. This indicates that Aristotle has a very similar performance to the alternative method based on the ground-truth. We note that recall is more important than precision in the causal discovery setting, because the computational predictions are often later examined experimentally in order to rule out any false discoveries. However, missing an important true causal feature may be more detrimental from a scientific point of view.</p>
    </sec>
    <sec id="Sec13">
      <title>Experiments on real-world data</title>
      <p id="Par66">We used a dataset about Anthracycline Cardiotoxicity, an Adverse Drug Reaction (ADR) to a class of drugs known as Anthracyclines. More than half of childhood cancer treatment protocols include an Anthracycline. However, the usefulness of Anthracyclines is limited by asymptomatic cardiac dysfunction and heart failure [<xref ref-type="bibr" rid="CR49">49</xref>].</p>
      <p id="Par67">As discussed earlier in the introduction, Anthracycline Cardiotoxicity is now believed to be a multi-factorial ADR with multiple underlying mechanisms including the inhibition of Topoisomerase 2<inline-formula id="IEq54"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M110"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq54.gif"/></alternatives></inline-formula> and the action of Reactive oxidation species [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR50">50</xref>]. Accordingly, discovering the genetic risk markers of pediatric Anthracycline Cardiotoxicity is a SCD problem.</p>
      <p id="Par68">The particular dataset that we used is provided by the Canadian Pharmacogenomics Network for Drug Safety (http://cpnds.ubc.ca/) and consists of the records of 434 childhood cancer patients treated with Anthracyclines, 90 of which show cardiotoxicity [<xref ref-type="bibr" rid="CR51">51</xref>]. The input consisted of germline SNP profiles. A series of data preparation steps were carried out on the input. We created four binary features for each SNP locus (position on the genome), representing the four possible values that a SNP can take based on paternal and maternal alleles in combination. This resulted in 2.4 million binary features. The set of confounders that could have impacted the outcome of Anthracycline Cardiotoxicity in the patient consisted of age, gender, dosage, cardio-protectant, cardiac irradiation, Vincristine, and Blastine. The age and the dosage were continuous values that we turned into two binary variables based on their quantiles, resulting in a total of 9 counfounders. For the outcome variable (the presence of an ADR), the patient’s descriptive reaction records were reduced to a binary variable based on the Canadian Pharmacogenomics protocols and indicated whether the patient showed an Anthracycline Cardiotoxicity (<inline-formula id="IEq55"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+1$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq55.gif"/></alternatives></inline-formula>) or not (<inline-formula id="IEq56"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-1$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4521_Article_IEq56.gif"/></alternatives></inline-formula>).</p>
      <p id="Par69">In the Feature Grouping phase, we mapped the SNPs to genes using the tool introduced in [<xref ref-type="bibr" rid="CR52">52</xref>]. Then, based on the genes’ membership in the 323 pathways, the SNPs were associated with pathways to form the 323 final groups. The SNPs that did not correspond to any gene belonging to one of the pathways were discarded.</p>
      <p id="Par70">We evaluate the results of Aristotle for the ADR dataset from three different standpoints: (1) by a statistical analysis of distribution of the <italic>p</italic>-values of the discoveries, (2) by comparing the overlap between our discoveries and the known causes, which were deduced from independent medical records and the literature, and (3) by providing biological interpretation for corresponding genes and pathways of the discovered SNPs.</p>
      <p id="Par71">Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the logarithmic <italic>q</italic>–<italic>q</italic> plot of the distribution of <italic>p</italic>-values of the candidate SNPs computed by Aristotle for the Anthracycline Cardiotoxicity dataset, where SNPs are sorted in ascending order of p-values. The straight lines indicate what would happen under the null hypothesis for different numbers of hypothesis [<xref ref-type="bibr" rid="CR35">35</xref>]. Interestingly, adaptive estimation of the number of true null hypotheses (the purple line) results in almost the same number of hypothesis as the number of candidate features after filtering (the yellow line), and the corresponding lines align. This indicates that the number of the features passing the filtering of Aristotle is a reasonable estimate of the number of true null hypothesis. The order of magnitude of Aristotle’s <italic>p</italic>-values is similar to those reported in the guideline [<xref ref-type="bibr" rid="CR53">53</xref>] and HUME [<xref ref-type="bibr" rid="CR20">20</xref>] and the distribution of the <italic>p</italic>-values significantly deviates away from the straight line, i.e. null distribution). This indicates that our discoveries are comparable to those reported by Hume and Guideline.<fig id="Fig5"><label>Fig. 5</label><caption><p><italic>q</italic>-<italic>q</italic> plot of <italic>p</italic>-values of SNPs. The blue curve is the <italic>p</italic>-values of candidates, calculated by McNemar’s test. The three linear curves show the significance level adjusted by the 0.05 false discovery rate, each based on different assumptions about the number of true null hypotheses. The yellow line assumes that the number of hypotheses is equal to the total number of SNPs in input data, which gives the most conservative possible adjustment. The orange curve assumes that the number of hypotheses is equal to the number of candidates produced by Feature Filtering and used for the statistical test, which gives the least conservative adjustment. The purple line estimates the number of hypothesis according to [<xref ref-type="bibr" rid="CR36">36</xref>], a method for the estimation of the effective number of hypotheses, which is almost perfectly aligned to the less conservative approach</p></caption><graphic xlink:href="12859_2021_4521_Fig5_HTML" id="MO6"/></fig></p>
      <p id="Par72">The Guideline of Genetic Variants in Anthracycline-induced Cardiotoxicity [<xref ref-type="bibr" rid="CR53">53</xref>] is used to provide the known causal SNPs for Anthracycline Cardiotoxicity. The guideline reviewed Anthracycline Cardiotoxicity genes reported in the literature using the Canadian Pharmacogenomics dataset as well as independent reproducibility analyses, and categorized those into strong, significant, and notable level of evidence of association. However, this does not mean that the only possibly true relations are guideline relations. We investigate the overlap of the causal SNPs detected by Aristotle with the SNPs discussed in the guideline and HUME [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
      <p id="Par73">28 SNPs passed the statistical test at the FDR significance level of 5% and were selected by Aristotle as the causal features. The list of the predicted causal SNPs together with their corresponding genes and pathways is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. Two of the guideline’s three strong SNPs, namely rs2229774 and rs17863783, passed the test with <italic>p</italic>-values of 5.4E-05 and 8.9E-05 respectively. Rs2229774 was also detected by HUME and its validity is carefully studied in [<xref ref-type="bibr" rid="CR53">53</xref>]. But more importantly, rs17863783 was not detected by HUME. This shows the advantage of Aristotle in finding those factors that are causal for one archetype of cases, but would be missed if all cases are counted the same. Looking more closely, rs17863783 has only a very strong association with Anthracycline Cardiotoxicity for one of the strata, but does not have enough prevalence in the other strata to be detected by existing causal analysis methods.</p>
      <p id="Par74">The guideline’s third strong SNP, rs7853758, was missed due to not being included in any of the pathways. However, if it had been tested under the current QED, it would have resulted in a <italic>p</italic>-value of 0.03, which seems significant in isolation, but would probably not have survived multiple hypothesis testing. However, it should be noted that because the feature groups and consequently the final results are susceptible to change by inclusion of new pathways and significant SNPs, such posterior evaluations are not valid.</p>
      <p id="Par75">Furthermore, three of the guideline’s fourteen significant SNPs passed the test, namely rs17583889, rs10426377 and rs4673, with <italic>p</italic>-values of 1.0E-05, 5.4E-05 and 1.0E-04 respectively. Of the remaining eleven significant SNPs, three had fewer cases than the minimum prevalence threshold, four did not correspond to any of the pathways, two did not pass the filtering process, and the two remaining ones did not have sufficiently low <italic>p</italic>-value to pass the multiple hypothesis testing.</p>
      <p id="Par76">It should be noted that not reporting all of the significant guideline SNPs is not necessarily an undesired outcome. First, as mentioned earlier, significant relations are not the ground truth, and some were even considered insignificant by the guideline and HUME. Second, and more interestingly, there can be associations that are considered significant for the overall population, but lack a sufficient statistical power or association when the hypothesis is focused on specific stratum [<xref ref-type="bibr" rid="CR54">54</xref>].</p>
      <p id="Par77">Moreover, from a biological standpoint, a significant number of SNPs discovered by Aristotle share the same corresponding genes and pathways. This not only provides evidence for the functional involvement of those genes and pathways in Anthracycline Cardiotoxicity, but also provides further evidence for the validity of Aristotle’s results.</p>
      <p id="Par78">12 of the 28 discovered SNPs share a gene with at least one other SNP. Five of these SNPs, namely rs795887, rs6436364, rs6756107, rs6722420, and rs10755042, are all from the <italic>ACSL3</italic> gene, which is involved in two of the pathways, 1212-Fatty Acid Metabolism and 4146-Peroxisome. Similarly, rs496179 and rs885622 are both from the <italic>DPYD</italic> gene, involved in pathway 410-Beta-Alanine Metabolism. SNPs rs17863783 and rs10426377, which are a strong and a significant SNP from the guideline, respectively, are both from the <italic>SLC28A3</italic> gene in pathway 140-Steroid Hormone Biosynthesis.</p>
      <p id="Par79">The association among SNPs is also present at the pathway level. SNPs rs26848 and rs26849, both in the <italic>PGP</italic> gene, share three pathways with rs545253 in the <italic>MTND4P31</italic> gene. Similarly, SNPs rs16972837 and rs659517, both from gene <italic>RYR3</italic>, and SNP rs607483, are involved in the same pathways 4371-Apelin Signaling Pathway, 4713-Circadian Entrainment and 5010-Alzheimer’s Disease. Moreover, the two <italic>RYR3</italic> SNPs share pathway 4020-Calcium Signaling Pathway with rs11869821. Another example is the SNPS in the <italic>UGT2B7</italic> gene, rs7662632 and rs4356975, which have the same pathways 40-Pentose &amp; Glucuronate Interconversions, 53-Ascorbate &amp; Aldarate Metabolism and 830-Retinol Metabolism, as the guideline’s strong SNP, rs17863783. Interestingly, rs11869821, rs2271235, rs11936348 and rs611954 are each from a different gene, but are from the same pathway. A detailed list of genes and pathways of passing SNPs is available in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Conclusions</title>
    <p id="Par80">This work introduced the problem of stratified causal discovery and provided a method called Aristotle for solving that problem. Aristotle is applicable for high dimensional datasets, such as omics. It uses background knowledge for decomposing the large feature space into smaller subspaces that are easier to handle. It uses a state-of-the-art stratification method called SUBSTRA for computing feature weights, which are used for feature selection based on outlier detection. Aristotle also detects the hidden strata using SUBSTRA and employs a quasi-experimental design with an adaptive multiple-hypothesis testing for discovering stratum-specific causal features. The main novelty of Aristotle is in its divide and conquer strategy of biclustering and scoring features multiple times in order to ensure that the features and strata used in causal inference are of highest quality.</p>
    <p id="Par81">The method is evaluated using both synthetic and real data. Based on the experiments with synthetic data, in addition to finding the causal features detectable by the conventional causal discovery approach, Aristotle discovered strata-specific causal features. For the case of Anthracycline Cardiotoxicity, Aristotle successfully captured most of the known significant causal features in addition to making new predictions.</p>
    <p id="Par82">A possible limitation of Aristotle is that it consists of five main phases. This might result in the propagation of error from one phase to the consequent phases. Therefore, a direction for future work would be to reduce the number of phases by providing a method that finds the causal features and the corresponding strata in an integrated phase.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4521_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1. Table A1:</bold> Predicted causal SNPs for anthracycline cardiotoxicity and their corresponding genes, pathways, and adjusted <italic>p</italic>-values.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ADR</term>
        <def>
          <p id="Par4">Adverse drug reaction</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p id="Par5">False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>KEGG</term>
        <def>
          <p id="Par6">Kyoto encyclopedia of genes and genomes</p>
        </def>
      </def-item>
      <def-item>
        <term>MAD</term>
        <def>
          <p id="Par7">Median absolute deviation</p>
        </def>
      </def-item>
      <def-item>
        <term>QED</term>
        <def>
          <p id="Par8">Quasi-experimental design</p>
        </def>
      </def-item>
      <def-item>
        <term>RFCI</term>
        <def>
          <p id="Par9">Really fast causal inference</p>
        </def>
      </def-item>
      <def-item>
        <term>SCD</term>
        <def>
          <p id="Par10">Stratified causal discovery</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par11">Single nucleotide polymorphisms</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Mehrdad Mansouri and Sahand Khakabimamaghani contributed equally to this work</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We are grateful for the collaboration with Dr. BC and Dr. CR on the discovery of causal genes of ADRs.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MM and SK designed the model and performed the experiments. ME and LC guided the research and assisted in writing of the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Martin Ester acknowledges support by LSARP grant from CIHR, and Genome Canada and NSERC Discovery Grant. Leonid Chindelevitch acknowledges support from NSERC Discovery Grant and Sloan Foundation fellowship. The funding bodies did not play any role in the design, analysis, or writing of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The Anthracycline Cardiotoxicity dataset can be accessed by applying to the CPNDS website (<ext-link ext-link-type="uri" xlink:href="http://cpnds.ubc.ca/">http://cpnds.ubc.ca/</ext-link>), which is a Canada-wide active surveillance network for maintaining a database of over 10,000 patients with ADRs. The source code for Aristotle and synthetic data generator are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/MehrdadMansouri/Aristotle">https://github.com/MehrdadMansouri/Aristotle</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par83">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par84">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par85">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Spirtes P, Glymour CN, Scheines R, Heckerman D. Causation, prediction, and search (2000)</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zellner</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Causality and causal laws in economics</article-title>
        <source>J Economet</source>
        <year>1988</year>
        <volume>39</volume>
        <issue>1–2</issue>
        <fpage>7</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1016/0304-4076(88)90038-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stehbens</surname>
            <given-names>WE</given-names>
          </name>
        </person-group>
        <article-title>Causality in medical science with particular reference to heart disease and atherosclerosis</article-title>
        <source>Perspect Biol Med</source>
        <year>1992</year>
        <volume>36</volume>
        <issue>1</issue>
        <fpage>97</fpage>
        <lpage>119</lpage>
        <pub-id pub-id-type="doi">10.1353/pbm.1993.0036</pub-id>
        <pub-id pub-id-type="pmid">1475162</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Borboudakis G, Tsamardinos I. Towards robust and versatile causal discovery for business applications. In: Proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining. ACM; 2016. p. 1435–1444.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nauta</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bucur</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Seifert</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Causal discovery with attention-based convolutional neural networks</article-title>
        <source>Mach Learn Knowl Extract</source>
        <year>2019</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>312</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="doi">10.3390/make1010019</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephens</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Faghri</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Zhai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Efron</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Sinha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>GE</given-names>
          </name>
        </person-group>
        <article-title>Big data: astronomical or genomical?</article-title>
        <source>PLoS Biol</source>
        <year>2015</year>
        <volume>13</volume>
        <issue>7</issue>
        <fpage>1002195</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.1002195</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McGowan</surname>
            <given-names>JV</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Maulik</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Piotrowska</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Yellon</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Anthracycline chemotherapy and cardiotoxicity</article-title>
        <source>Cardiovasc Drugs Ther</source>
        <year>2017</year>
        <volume>31</volume>
        <issue>1</issue>
        <fpage>63</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1007/s10557-016-6711-0</pub-id>
        <pub-id pub-id-type="pmid">28185035</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aminkeng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bhavsar</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Rassekh</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Brunham</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Caron</surname>
            <given-names>HN</given-names>
          </name>
          <name>
            <surname>van Dalen</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Kremer</surname>
            <given-names>LC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A coding variant in rarg confers susceptibility to anthracycline-induced cardiotoxicity in childhood cancer</article-title>
        <source>Nat Genet</source>
        <year>2015</year>
        <volume>47</volume>
        <issue>9</issue>
        <fpage>1079</fpage>
        <pub-id pub-id-type="doi">10.1038/ng.3374</pub-id>
        <pub-id pub-id-type="pmid">26237429</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Shadish WR, Cook TD, Campbell DT, et al. Experimental and quasi-experimental designs for generalized causal inference/William R. Shedish, Thomas D. Cook, Donald T. Campbell. 2002.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinze-Deml</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Maathuis</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Meinshausen</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Causal structure learning</article-title>
        <source>Annu Rev Stat Appl</source>
        <year>2018</year>
        <volume>5</volume>
        <fpage>371</fpage>
        <lpage>391</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-statistics-031017-100630</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spirtes</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Introduction to causal inference</article-title>
        <source>J Mach Learn Res</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>May</issue>
        <fpage>1643</fpage>
        <lpage>1662</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Spirtes</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Meek</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>An algorithm for causal inference in the presence of latent variables and selection bias in computation, causation and discovery</source>
        <year>1999</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>MIT Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Colombo D, Maathuis MH, Kalisch M, Richardson TS. Learning high-dimensional directed acyclic graphs with latent and selection variables. Ann Stat. 2012;294–321.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Claassen T, Mooij J, Heskes T. Learning sparse causal models is not np-hard. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1309.6824">arXiv:1309.6824</ext-link> 2013.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Colombo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Maathuis</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>Order-independent constraint-based causal structure learning</article-title>
        <source>J Mach Learn Res</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>3741</fpage>
        <lpage>3782</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>On the completeness of orientation rules for causal discovery in the presence of latent confounders and selection bias</article-title>
        <source>Artif Intell</source>
        <year>2008</year>
        <volume>172</volume>
        <issue>16–17</issue>
        <fpage>1873</fpage>
        <lpage>1896</lpage>
        <pub-id pub-id-type="doi">10.1016/j.artint.2008.08.001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aliferis</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Statnikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tsamardinos</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mani</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Koutsoukos</surname>
            <given-names>XD</given-names>
          </name>
        </person-group>
        <article-title>Local causal and Markov blanket induction for causal discovery and feature selection for classification part I: algorithms and empirical evaluation</article-title>
        <source>J Mach Learn Res</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>171</fpage>
        <lpage>234</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Lagani V, Triantafillou S, Ball G, Tegner J, Tsamardinos I. Probabilistic computational causal discovery for systems biology, 2016;33–73.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Le</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>From observational studies to causal rule mining</article-title>
        <source>ACM Trans Intell Syst Technol</source>
        <year>2016</year>
        <volume>7</volume>
        <issue>2</issue>
        <fpage>14</fpage>
        <pub-id pub-id-type="doi">10.1145/2746410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mansouri</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Carleton</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Ester</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Hume: large-scale detection of causal genetic factors of adverse drug reactions</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>1</volume>
        <fpage>1</fpage>
        <lpage>2</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gehlenborg</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>O’donoghue</surname>
            <given-names>SI</given-names>
          </name>
          <name>
            <surname>Baliga</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Goesmann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hibbs</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Kitano</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kohlbacher</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Neuweger</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tenenbaum</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visualization of omics data for systems biology</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>3s</issue>
        <fpage>56</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1436</pub-id>
        <pub-id pub-id-type="pmid">20010831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Helman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Veroff</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Atlas</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Willman</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A bayesian network classification methodology for gene expression data</article-title>
        <source>J Comput Biol</source>
        <year>2004</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>581</fpage>
        <lpage>615</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2004.11.581</pub-id>
        <pub-id pub-id-type="pmid">15579233</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jung</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Davuluri</surname>
            <given-names>RV</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of data discretization methods to derive platform independent isoform expression signatures for multi-class tumor subtyping</article-title>
        <source>BMC Genom</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>S11</issue>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-16-S11-S3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicholson</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Reviewers peering from under a pile of ‘omics’ data</article-title>
        <source>Nature</source>
        <year>2006</year>
        <volume>440</volume>
        <issue>7087</issue>
        <fpage>992</fpage>
        <lpage>992</lpage>
        <pub-id pub-id-type="doi">10.1038/440992d</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khakabimamaghani</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kelkar</surname>
            <given-names>YD</given-names>
          </name>
          <name>
            <surname>Grande</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Morin</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Ester</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ziemek</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Substra: supervised bayesian patient stratification</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>18</issue>
        <fpage>3263</fpage>
        <lpage>3272</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz112</pub-id>
        <pub-id pub-id-type="pmid">30768166</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ammad-ud-din</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Malani</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Murumägi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kallioniemi</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Aittokallio</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kaski</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Drug response prediction by inferring pathway-response associations with kernelized bayesian matrix factorization</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>17</issue>
        <fpage>455</fpage>
        <lpage>463</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw433</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Yoo C, Cooper GF. Discovery of gene-regulation pathways using local causal search. In: Proceedings of the AMIA symposium. American Medical Informatics Association; 2002. p. 914.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>KEGG: kyoto encyclopedia of genes and genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>27</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.27</pub-id>
        <?supplied-pmid 10592173?>
        <pub-id pub-id-type="pmid">10592173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Tarone RE. A modified bonferroni method for discrete data. Biometrics, 1990;515–522.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Pellegrina L, Vandin F. Efficient mining of the most significant patterns with permutation testing. In: Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery and data mining. ACM; 2018. p. 2070–2079.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leys</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Bernard</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Licata</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Detecting outliers: do not use standard deviation around the mean, use absolute deviation around the median</article-title>
        <source>J Exp Soc Psychol</source>
        <year>2013</year>
        <volume>49</volume>
        <issue>4</issue>
        <fpage>764</fpage>
        <lpage>766</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jesp.2013.03.013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Miettinen OS. The matched pairs design in the case of all-or-none responses. Biometrics. 1968;339–352.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhn</surname>
            <given-names>HW</given-names>
          </name>
        </person-group>
        <article-title>The Hungarian method for the assignment problem</article-title>
        <source>Naval Res Logist Quart</source>
        <year>1955</year>
        <volume>2</volume>
        <issue>1–2</issue>
        <fpage>83</fpage>
        <lpage>97</lpage>
        <pub-id pub-id-type="doi">10.1002/nav.3800020109</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ioannidis</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Why most published research findings are false</article-title>
        <source>PLoS Med</source>
        <year>2005</year>
        <volume>2</volume>
        <issue>8</issue>
        <fpage>124</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pmed.0020124</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hwang</surname>
            <given-names>Y-T</given-names>
          </name>
          <name>
            <surname>Kuo</surname>
            <given-names>H-C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C-C</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>Estimating the number of true null hypotheses in multiple hypothesis testing</article-title>
        <source>Stat Comput</source>
        <year>2014</year>
        <volume>24</volume>
        <issue>3</issue>
        <fpage>399</fpage>
        <lpage>416</lpage>
        <pub-id pub-id-type="doi">10.1007/s11222-013-9377-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>On the adaptive control of the false discovery rate in multiple testing with independent statistics</article-title>
        <source>J Educ Behav Stat</source>
        <year>2000</year>
        <volume>25</volume>
        <issue>1</issue>
        <fpage>60</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.3102/10769986025001060</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Libbrecht</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Rodriguez</surname>
            <given-names>OL</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Bilmes</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>A unified encyclopedia of human functional DNA elements through fully automated annotation of 164 human cell types</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>180</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1784-2</pub-id>
        <pub-id pub-id-type="pmid">31462275</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>EP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <issue>7414</issue>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11247</pub-id>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rentzsch</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kircher</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cadd: predicting the deleteriousness of variants throughout the human genome</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>886</fpage>
        <lpage>894</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1016</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Biclustering of expression data</article-title>
        <source>Ismb</source>
        <year>2000</year>
        <volume>8</volume>
        <fpage>93</fpage>
        <lpage>103</lpage>
        <?supplied-pmid 10977070?>
        <pub-id pub-id-type="pmid">10977070</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gabriel</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Schaffner</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Blumenstiel</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>DeFelice</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lochner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Faggart</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The structure of haplotype blocks in the human genome</article-title>
        <source>Science</source>
        <year>2002</year>
        <volume>296</volume>
        <issue>5576</issue>
        <fpage>2225</fpage>
        <lpage>2229</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1069424</pub-id>
        <pub-id pub-id-type="pmid">12029063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Albert</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Barabási</surname>
            <given-names>A-L</given-names>
          </name>
        </person-group>
        <article-title>Statistical mechanics of complex networks</article-title>
        <source>Rev Mod Phys</source>
        <year>2002</year>
        <volume>74</volume>
        <issue>1</issue>
        <fpage>47</fpage>
        <pub-id pub-id-type="doi">10.1103/RevModPhys.74.47</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nesvizhskii</surname>
            <given-names>AI</given-names>
          </name>
        </person-group>
        <article-title>A survey of computational methods and error rate estimation procedures for peptide and protein identification in shotgun proteomics</article-title>
        <source>J Proteomics</source>
        <year>2010</year>
        <volume>73</volume>
        <issue>11</issue>
        <fpage>2092</fpage>
        <lpage>2123</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jprot.2010.08.009</pub-id>
        <pub-id pub-id-type="pmid">20816881</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bellemain</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eidesen</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Pompanon</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Brochmann</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Taberlet</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>How to track and assess genotyping errors in population genetics studies</article-title>
        <source>Mol Ecol</source>
        <year>2004</year>
        <volume>13</volume>
        <issue>11</issue>
        <fpage>3261</fpage>
        <lpage>3273</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-294X.2004.02346.x</pub-id>
        <pub-id pub-id-type="pmid">15487987</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Testing for genetic associations in arbitrarily structured populations</article-title>
        <source>Nat Genet</source>
        <year>2015</year>
        <volume>47</volume>
        <issue>5</issue>
        <fpage>550</fpage>
        <lpage>554</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3244</pub-id>
        <pub-id pub-id-type="pmid">25822090</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abonyi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Szeifert</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Supervised fuzzy clustering for the identification of fuzzy classifiers</article-title>
        <source>Pattern Recogn Lett</source>
        <year>2003</year>
        <volume>24</volume>
        <issue>14</issue>
        <fpage>2195</fpage>
        <lpage>2207</lpage>
        <pub-id pub-id-type="doi">10.1016/S0167-8655(03)00047-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Cios KJ, Pedrycz W, Swiniarski RW. Data mining and knowledge discovery, 1998;1–26.</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kremer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Van der Pal</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Offringa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Van Dalen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Voute</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Frequency and risk factors of subclinical cardiotoxicity after anthracycline therapy in children: a systematic review</article-title>
        <source>Ann Oncol</source>
        <year>2002</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>819</fpage>
        <lpage>829</lpage>
        <pub-id pub-id-type="doi">10.1093/annonc/mdf167</pub-id>
        <pub-id pub-id-type="pmid">12123328</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geisberg</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Sawyer</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Mechanisms of anthracycline cardiotoxicity and strategies to decrease cardiac damage</article-title>
        <source>Curr Hypertens Rep</source>
        <year>2010</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>404</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="doi">10.1007/s11906-010-0146-y</pub-id>
        <pub-id pub-id-type="pmid">20842465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carleton</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Poole</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Leeder</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ghannadan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hayden</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Adverse drug reaction active surveillance: developing a national network in Canada’s children’s hospitals</article-title>
        <source>Pharmacoepidemiol Drug Saf</source>
        <year>2009</year>
        <volume>18</volume>
        <issue>8</issue>
        <fpage>713</fpage>
        <lpage>721</lpage>
        <pub-id pub-id-type="doi">10.1002/pds.1772</pub-id>
        <pub-id pub-id-type="pmid">19507171</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLaren</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Gil</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Riat</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>GRS</given-names>
          </name>
          <name>
            <surname>Thormann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cunningham</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>The ensembl variant effect predictor</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>122</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0974-4</pub-id>
        <?supplied-pmid 27268795?>
        <pub-id pub-id-type="pmid">27268795</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aminkeng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Rassekh</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rieder</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Bhavsar</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sanatani</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gelmon</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recommendations for genetic testing to reduce the incidence of anthracycline-induced cardiotoxicity</article-title>
        <source>Br J Clin Pharmacol</source>
        <year>2016</year>
        <volume>82</volume>
        <issue>3</issue>
        <fpage>683</fpage>
        <lpage>695</lpage>
        <pub-id pub-id-type="doi">10.1111/bcp.13008</pub-id>
        <pub-id pub-id-type="pmid">27197003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Julious</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Mullee</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Confounding and simpson’s paradox</article-title>
        <source>Bmj</source>
        <year>1994</year>
        <volume>309</volume>
        <issue>6967</issue>
        <fpage>1480</fpage>
        <lpage>1</lpage>
        <pub-id pub-id-type="doi">10.1136/bmj.309.6967.1480</pub-id>
        <pub-id pub-id-type="pmid">7804052</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
