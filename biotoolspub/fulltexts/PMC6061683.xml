<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6061683</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty141</article-id>
    <article-id pub-id-type="publisher-id">bty141</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>esATAC: an easy-to-use systematic pipeline for ATAC-seq data analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wei</surname>
          <given-names>Zheng</given-names>
        </name>
        <xref ref-type="aff" rid="bty141-aff1"/>
        <xref ref-type="author-notes" rid="bty141-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Wei</given-names>
        </name>
        <xref ref-type="aff" rid="bty141-aff1"/>
        <xref ref-type="author-notes" rid="bty141-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fang</surname>
          <given-names>Huan</given-names>
        </name>
        <xref ref-type="aff" rid="bty141-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Yanda</given-names>
        </name>
        <xref ref-type="aff" rid="bty141-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xiaowo</given-names>
        </name>
        <xref ref-type="aff" rid="bty141-aff1"/>
        <xref ref-type="corresp" rid="bty141-cor1"/>
        <!--<email>xwwang@tsinghua.edu.cn</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty141-aff1">Ministry of Education Key Laboratory of Bioinformatics, Center for Synthetic and System Biology, BNRist, Department of Automation, Tsinghua University, Beijing, China</aff>
    <author-notes>
      <fn id="bty141-FM1">
        <p>The authors wish it to be known that, in their opinion, Zheng Wei and Wei Zhang authors should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="bty141-cor1">To whom correspondence should be addressed. Email: <email>xwwang@tsinghua.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>8</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-03-07">
      <day>07</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>15</issue>
    <fpage>2664</fpage>
    <lpage>2665</lpage>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>12</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>2</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>3</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty141.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>ATAC-seq is rapidly emerging as one of the major experimental approaches to probe chromatin accessibility genome-wide. Here, we present ‘esATAC’, a highly integrated easy-to-use R/Bioconductor package, for systematic ATAC-seq data analysis. It covers essential steps for full analyzing procedure, including raw data processing, quality control and downstream statistical analysis such as peak calling, enrichment analysis and transcription factor footprinting. esATAC supports one command line execution for preset pipelines and provides flexible interfaces for building customized pipelines.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>esATAC package is open source under the GPL-3.0 license. It is implemented in R and C++. Source code and binaries for Linux, MAC OS X and Windows are available through Bioconductor (<ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/release/bioc/html/esATAC.html">https://www.bioconductor.org/packages/release/bioc/html/esATAC.html</ext-link>).</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Science Foundation of China</named-content>
          <named-content content-type="funder-identifier">10.13039/501100001809</named-content>
        </funding-source>
        <award-id>31371341</award-id>
        <award-id>61773230</award-id>
        <award-id>61721003</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Tsinghua University Initiative Scientific Research Program</named-content>
        </funding-source>
        <award-id>20141081175</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Open Research Fund of State Key Laboratory of Bioelectronics</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Southeast University</named-content>
          <named-content content-type="funder-identifier">10.13039/501100008081</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Assay for transposase accessible chromatin with high-throughput sequencing (ATAC-seq) is a sensitive method to probe chromatin accessibility genome-wide (<xref rid="bty141-B2" ref-type="bibr">Buenrostro <italic>et al.</italic>, 2013</xref>). The library preparation is fast, easy-to-perform and requires low amount of biological sample. These advantages make ATAC-seq become a popular way to study open chromatin, nucleosome positioning and transcription factor (TF) footprinting in cell lines or primary tissues by a booming number of laboratories.</p>
    <p>Compared with its easy-to-perform experiment, ATAC-seq data analysis may take much more time and effort. Highly integrated cross-platform software to process ATAC-seq data is still lacking. Researchers need to set up their own local pipeline and use multiple tools, each of them provides partial functions of the entire data analysis workflow. Installing those tools from diverse sources, learning their manuals, testing their functions and integrating them together are tedious and time-consuming.</p>
    <p>To fill this gap, we developed an easy-to-use R/Bioconductor package named ‘esATAC’. esATAC systematically integrates the state-of-the-art software for full procedure ATAC-seq data analysis, covering raw data processing, downstream statistical analysis and multiple quality control (QC) functions. For the ease of user, esATAC provides preset pipelines that can be executed by one command line under R/Bioconductor environment on different platforms. Advanced users can easily create customized pipelines through flexible interfaces in esATAC. Multi-core and memory control mechanisms have been implemented to optimize hardware utilization.</p>
  </sec>
  <sec>
    <title>2 Design and implementation</title>
    <p>The flowchart of esATAC is shown in <xref ref-type="fig" rid="bty141-F1">Figure 1a</xref>.
</p>
    <fig id="bty141-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>(<bold>a</bold>) esATAC workflow. esATAC pipeline is mainly divided into two parts, raw data processing and statistical analysis. QC functions at multiple levels are provided, including sequencing QC, library QC and functional annotation QC. (<bold>b</bold>) and (<bold>c</bold>) Examples of analyzing ATAC-seq data (GEO accession number GSE47753, see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). (b) CTCF footprinting. (c) Fragment length distribution. Periodicity of approximately 200 base pairs (bp) for nucleosome protection and 10.4 bp for the pitch of the DNA helix is shown by fast Fourier transformation in the upper right corner</p>
      </caption>
      <graphic xlink:href="bty141f1"/>
    </fig>
    <sec>
      <title>2.1 Data analysis workflow</title>
      <p>The workflow can be mainly divided into two parts, raw data processing and statistical analysis.</p>
      <p>In the raw data processing part, esATAC can directly handle ATAC-seq raw data in FASTQ format. It wraps AdapterRemoval (<xref rid="bty141-B7" ref-type="bibr">Schubert <italic>et al.</italic>, 2016</xref>) for adapter trimming and Bowtie2 (<xref rid="bty141-B5" ref-type="bibr">Langmead <italic>et al.</italic>, 2012</xref>) for reads alignment. esATAC will sort the mapped reads, remove duplicates, shift reads for Tn5 insertion (<xref rid="bty141-B2" ref-type="bibr">Buenrostro <italic>et al.</italic>, 2013</xref>) and generate intensity profile in BigWig format for genome browser visualization.</p>
      <p>In the statistical analysis part, esATAC provides a comprehensive analyzing procedure for mapped ATAC-seq reads. It identifies open chromatin peak regions using F-seq (<xref rid="bty141-B1" ref-type="bibr">Boyle <italic>et al.</italic>, 2008</xref>), which specializes in seeking genome-wide profiling of open chromatin regions with high sensitivity (<xref rid="bty141-B4" ref-type="bibr">Koohy <italic>et al.</italic>, 2014</xref>). The peaks are annotated and related gene ontology terms are reported (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). esATAC has integrated known TF motifs in JASPAR database (<xref rid="bty141-B6" ref-type="bibr">Mathelier <italic>et al.</italic>, 2016</xref>) to find potential TF binding sites in the peak regions, and generate TF footprinting plots (<xref ref-type="fig" rid="bty141-F1">Fig. 1b</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Quality control</title>
      <p>esATAC provides multiple level QC functions. Raw sequencing reads quality report will be generated (<xref rid="bty141-B3" ref-type="bibr">Gaidatzis <italic>et al.</italic>, 2015</xref>). esATAC performs fragment length QC analysis, providing that typical ATAC-seq fragment length distribution has a clear periodicity caused by nucleosome protection and the pitch of the DNA helix (<xref ref-type="fig" rid="bty141-F1">Fig. 1c</xref>). Other QC methods adopted by ENCODE consortium have been integrated (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>), and concordance between replicates can be reported.</p>
    </sec>
    <sec>
      <title>2.3 Implementation</title>
      <p>For user convenience, we preset pipelines to analyze single sample and case-control paired samples for human and mouse. Users only need to provide the raw sequencing files and can execute the entire pipeline with one command in R. Dependent data like annotation files and bowtie2 index can be downloaded and built automatically. An HTML summary report for comprehensive QC and statistical analysis will be generated.</p>
      <p>The package is managed by dataflow graph, therefore users can easily understand and trace the pipeline processing modules (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). Mechanisms in esATAC such as inputs legality checking ensure that sophisticated users are able to customize the pipeline or integrate other tools from any intermediate stages easily.esATAC provides memory control and parallel computing options to maximize the computing efficiency. Breakpoint detection has been established to ensure that users do not have to redo the finished processes in case the program was interrupted.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>We proposed esATAC aiming to make ATAC-seq data analysis easy for a wide range of users. esATAC covers whole procedure for ATAC-seq data processing. It can be installed on different platforms and perform ‘one command line for result’ analysis. Users without sophisticated programming skills can get started easily. At the same time, all the sub-functions are componentized, making it a flexible platform for advanced users to build pipelines for specialized applications.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Science Foundation of China [grant nos. 31371341, 61773230 and 61721003], Tsinghua University Initiative Scientific Research Program [no. 20141081175] and the Open Research Fund of State Key Laboratory of Bioelectronics, Southeast University.</p>
    <p><italic>Conflict of Interest</italic>: <italic>none declared.</italic></p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="bty141_supplementary.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="bty141-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Boyle</surname><given-names>A.P.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>F-Seq: a feature density estimator for high-throughput sequence tags</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>2537</fpage>–<lpage>2538</lpage>.<pub-id pub-id-type="pmid">18784119</pub-id></mixed-citation>
    </ref>
    <ref id="bty141-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Buenrostro</surname><given-names>J.D.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Transposition of native chromatin for fast and sensitive epigenomic profiling of open chromatin, DNA-binding proteins and nucleosome position</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>1213</fpage>–<lpage>1218</lpage>.<pub-id pub-id-type="pmid">24097267</pub-id></mixed-citation>
    </ref>
    <ref id="bty141-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gaidatzis</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>QuasR: quantification and annotation of short reads in R</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>1130</fpage>–<lpage>1132</lpage>.<pub-id pub-id-type="pmid">25417205</pub-id></mixed-citation>
    </ref>
    <ref id="bty141-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Koohy</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A comparison of peak callers used for DNase-Seq data</article-title>. <source>PLos One</source>, <volume>9</volume>, <fpage>e96303</fpage>.<pub-id pub-id-type="pmid">24810143</pub-id></mixed-citation>
    </ref>
    <ref id="bty141-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Langmead</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>357</fpage>–<lpage>U354</lpage>.<pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="bty141-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mathelier</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>JASPAR 2016: a major expansion and update of the open-access database of transcription factor binding profiles</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>D110</fpage>–<lpage>D115</lpage>.<pub-id pub-id-type="pmid">26531826</pub-id></mixed-citation>
    </ref>
    <ref id="bty141-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schubert</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>AdapterRemoval v2: rapid adapter trimming, identification, and read merging</article-title>. <source>BMC Res. Notes</source>, <volume>9</volume>, <fpage>88</fpage>.<pub-id pub-id-type="pmid">26868221</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
