<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7217489</article-id>
    <article-id pub-id-type="pmid">32339163</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007794</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-00571</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Transcriptome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Transcriptome Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Visualization</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Data</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
              <subj-group>
                <subject>Machine Learning Algorithms</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
            <subj-group>
              <subject>Machine Learning Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Artificial Intelligence</subject>
          <subj-group>
            <subject>Machine Learning</subject>
            <subj-group>
              <subject>Machine Learning Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>DNA transcription</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computing Methods</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Plant Science</subject>
          <subj-group>
            <subject>Plant Anatomy</subject>
            <subj-group>
              <subject>Leaves</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Scedar: A scalable Python package for single-cell RNA-seq exploratory data analysis</article-title>
      <alt-title alt-title-type="running-head">Scedar</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9663-5841</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Yuanchao</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1507-9829</contrib-id>
        <name>
          <surname>Kim</surname>
          <given-names>Man S.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1334-1694</contrib-id>
        <name>
          <surname>Reichenberger</surname>
          <given-names>Erin R.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2972-0354</contrib-id>
        <name>
          <surname>Stear</surname>
          <given-names>Ben</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3302-4610</contrib-id>
        <name>
          <surname>Taylor</surname>
          <given-names>Deanne M.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Biomedical and Health Informatics, The Children’s Hospital of Philadelphia, Philadelphia, Pennsylvania, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Genetics, Rutgers University, Piscataway, New Jersey, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Pediatrics, Perelman School of Medicine, University of Pennsylvania, Philadelphia, Pennsylvania, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Pertea</surname>
          <given-names>Mihaela</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Johns Hopkins University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>taylordm@email.chop.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>4</issue>
    <elocation-id>e1007794</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>3</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Zhang et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Zhang et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007794.pdf"/>
    <abstract>
      <p>In single-cell RNA-seq (scRNA-seq) experiments, the number of individual cells has increased exponentially, and the sequencing depth of each cell has decreased significantly. As a result, analyzing scRNA-seq data requires extensive considerations of program efficiency and method selection. In order to reduce the complexity of scRNA-seq data analysis, we present scedar, a scalable Python package for scRNA-seq exploratory data analysis. The package provides a convenient and reliable interface for performing visualization, imputation of gene dropouts, detection of rare transcriptomic profiles, and clustering on large-scale scRNA-seq datasets. The analytical methods are efficient, and they also do not assume that the data follow certain statistical distributions. The package is extensible and modular, which would facilitate the further development of functionalities for future requirements with the open-source development community. The scedar package is distributed under the terms of the MIT license at <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/scedar">https://pypi.org/project/scedar</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>All authors received support for this work from the Department of Biomedical and Health Informatics and the CHOP Research Institute at The Children's Hospital of Philadelphia. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="1"/>
      <page-count count="24"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-05-12</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Used for scedar benchmarking, the real scRNA-seq datasets can be obtained from the following websites: <ext-link ext-link-type="uri" xlink:href="https://hemberg-lab.github.io/scRNA.seq.datasets/">https://hemberg-lab.github.io/scRNA.seq.datasets/</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/MCA_DGE_Data/5435866">https://figshare.com/articles/MCA_DGE_Data/5435866</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://oncoscape.v3.sttrcancer.org/atlas.gs.washington.edu.mouse.rna/downloads">https://oncoscape.v3.sttrcancer.org/atlas.gs.washington.edu.mouse.rna/downloads</ext-link>. The simulated datasets can be generated using scripts at <ext-link ext-link-type="uri" xlink:href="https://github.com/TaylorResearchLab/scedar/tree/master/docs/r_scripts">https://github.com/TaylorResearchLab/scedar/tree/master/docs/r_scripts</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Used for scedar benchmarking, the real scRNA-seq datasets can be obtained from the following websites: <ext-link ext-link-type="uri" xlink:href="https://hemberg-lab.github.io/scRNA.seq.datasets/">https://hemberg-lab.github.io/scRNA.seq.datasets/</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/MCA_DGE_Data/5435866">https://figshare.com/articles/MCA_DGE_Data/5435866</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://oncoscape.v3.sttrcancer.org/atlas.gs.washington.edu.mouse.rna/downloads">https://oncoscape.v3.sttrcancer.org/atlas.gs.washington.edu.mouse.rna/downloads</ext-link>. The simulated datasets can be generated using scripts at <ext-link ext-link-type="uri" xlink:href="https://github.com/TaylorResearchLab/scedar/tree/master/docs/r_scripts">https://github.com/TaylorResearchLab/scedar/tree/master/docs/r_scripts</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Software paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Cost-effective large-scale transcriptomic profiling of individual cells is enabled by the development of microfluidic, nanodroplet, and massively parallel sequencing technologies. Using these technologies, single-cell RNA-seq (scRNA-seq) experiments usually generate transcriptomic profiles of thousands to millions of individual cells [<xref rid="pcbi.1007794.ref001" ref-type="bibr">1</xref>]. Therefore, scRNA-seq has become more commonly used to either study specific biological questions or comprehensively profile certain tissues or organisms [<xref rid="pcbi.1007794.ref002" ref-type="bibr">2</xref>–<xref rid="pcbi.1007794.ref004" ref-type="bibr">4</xref>].</p>
    <p>Analyses of scRNA-seq datasets therefore require efficient computational programs and sophisticated statistical methods. The programs should be able to manage memory efficiently, exploit multiple cores of the processing units, and handle errors and exceptions gracefully. The statistical methods must be able to function against high dimensionality, low signal-to-noise ratio, and different characteristics of data generated from different technologies and protocols [<xref rid="pcbi.1007794.ref005" ref-type="bibr">5</xref>–<xref rid="pcbi.1007794.ref007" ref-type="bibr">7</xref>]. Such requirements can become a barrier between experimental design and biological interpretations of the results.</p>
    <p>In order to be scalable, methods have been designed to minimize the usage of hardware resources, so that a large-scale scRNA-seq dataset can be analyzed using a desktop computer, such as Seurat v3.0 [<xref rid="pcbi.1007794.ref008" ref-type="bibr">8</xref>] and Scanpy [<xref rid="pcbi.1007794.ref009" ref-type="bibr">9</xref>]. Seurat is an R package providing visualization and robust statistical methods to explore and interpret the heterogeneity of the dataset. Scanpy is a Python package providing efficient reimplementations of pre-existing statistical methods and analytical workflows, which can be used to perform general exploratory data analysis and special inferences.</p>
    <p>Here, we attempt to achieve the scalability of scRNA-seq data analysis through an alternative approach, which is to enable the user to exploit powerful analytical methods using modern high-performance computing architectures [<xref rid="pcbi.1007794.ref010" ref-type="bibr">10</xref>–<xref rid="pcbi.1007794.ref012" ref-type="bibr">12</xref>], such as servers and clusters with large amount of memory, multiple central and graphical processing unit cores, and solid-state drives (SSD) with higher read and write speed than traditional hard disk drive (HDD). Such computational resources have been made easily accessible by cloud computing services like Amazon Web Services, Google Cloud, and Microsoft Azure. Applying this approach, we designed the analytical methods to be able to run in parallel processes with minimized memory overhead.</p>
    <p>Additionally, we also aim to develop robust exploratory data analysis (EDA) methods, so that they could be applied to various datasets generated by different experimental designs, technologies, and protocols. Single-cell RNA-seq datasets have distinct statistical characteristics if generated from different scRNA-seq technologies and platforms [<xref rid="pcbi.1007794.ref006" ref-type="bibr">6</xref>,<xref rid="pcbi.1007794.ref007" ref-type="bibr">7</xref>,<xref rid="pcbi.1007794.ref013" ref-type="bibr">13</xref>], such as SMARTer [<xref rid="pcbi.1007794.ref014" ref-type="bibr">14</xref>], Drop-seq [<xref rid="pcbi.1007794.ref015" ref-type="bibr">15</xref>] and 10x Genomics [<xref rid="pcbi.1007794.ref016" ref-type="bibr">16</xref>]. In order to avoid assumptions on the statistical distributions of the datasets, we incorporated efficient implementations of machine learning methods into the data exploration process. Through extensive exploration, the statistical properties of the data could be observed and used to guide the selection of appropriate methods for biological interpretation [<xref rid="pcbi.1007794.ref017" ref-type="bibr">17</xref>].</p>
    <p>Therefore, we developed a scalable and reliable Python package, <underline><bold>s</bold></underline>ingle-<underline><bold>c</bold></underline>ell <underline><bold>e</bold></underline>xploratory <underline><bold>d</bold></underline>ata analysis for <underline><bold>R</bold></underline>NA-seq (scedar), to facilitate the exploration of large-scale scRNA-seq datasets. Scedar provides analytical routines for visualization, gene dropout imputation, rare transcriptomic profile detection, clustering, and identification of cluster separating genes. The visualization methods are integrated with the efficient scRNA-seq data structures to provide intuitive, convenient, and flexible plotting interfaces. We implemented methods to impute gene dropouts (Algorithm A in <xref ref-type="supplementary-material" rid="pcbi.1007794.s001">S1 Text</xref>) and detect rare transcriptomic profiles (Algorithm B in <xref ref-type="supplementary-material" rid="pcbi.1007794.s001">S1 Text</xref>) based on the k-nearest neighbor (KNN) algorithm. The detected rare transcriptomic profiles could be compared with their nearest neighbors in detail to identify rare cell states or types. For clustering analysis, we provide a novel cell clustering algorithm: <underline>M</underline>inimum Description Length (MDL) <underline>I</underline>teratively <underline>R</underline>egularized <underline>A</underline>gglomerative <underline>C</underline>lustering (MIRAC), shown in Algorithm 1. To identify genes that distinguish cell clusters we provide a method utilizing XGBoost, a sparsity-aware gradient boosted tree system [<xref rid="pcbi.1007794.ref018" ref-type="bibr">18</xref>].</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <sec id="sec003">
      <title>Scedar package design</title>
      <p>We designed scedar in an object-oriented manner for quickly exploring large-scale scRNA-seq transcription level matrices on a remote server utilizing parallel computing techniques, in order to provide a robust and extensible platform for EDA, rather than surpassing the analytical performance of any of ≥ 275 existing scRNA-seq data analysis methods [<xref rid="pcbi.1007794.ref017" ref-type="bibr">17</xref>]. The application programming interface (API) is designed to be intuitive to users familiar with the R programming language. The standard analysis workflow is to explore the dataset, cluster cells, and identify cluster separating genes (<xref ref-type="fig" rid="pcbi.1007794.g001">Fig 1</xref>), which is implemented as four main modules: data structure, KNN, clustering and visualization.</p>
      <fig id="pcbi.1007794.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007794.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Demonstration workflow using scedar to analyze an scRNA-seq dataset with 3005 mouse brain cells and 19,972 genes generated using the STRT-Seq UMI protocol by Zeisel <italic>et al</italic>. [<xref rid="pcbi.1007794.ref053" ref-type="bibr">53</xref>].</title>
          <p>Procedures and parameters that are not directly related to data analysis are omitted. The full version of the demo is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/logstar/scedar/tree/master/docs/notebooks">https://github.com/logstar/scedar/tree/master/docs/notebooks</ext-link>.</p>
        </caption>
        <graphic xlink:href="pcbi.1007794.g001"/>
      </fig>
      <p>The core data structure stores each transcription level matrix as a standalone sparse matrix or full array instance, and it can easily be extended to support customized analytical procedures. The built-in extensions include common procedures like pairwise distance computation, Principal Component Analysis (PCA), t-SNE [<xref rid="pcbi.1007794.ref019" ref-type="bibr">19</xref>], UMAP [<xref rid="pcbi.1007794.ref020" ref-type="bibr">20</xref>], and k-nearest neighbor graph [<xref rid="pcbi.1007794.ref021" ref-type="bibr">21</xref>]. We optimized time and memory efficiency with the following design patterns: parallel computing, lazy loading, caching and copy-on-write.</p>
      <p>The KNN and clustering modules utilize the data structure and parallel computing to efficiently perform analytical procedures, and the results are stored in the data structure for further reference.</p>
      <p>The visualization module contains plotting methods optimized for large datasets, especially for plotting heatmaps. For example, it takes less than two minutes to generate a heatmap image from a 50,000 x 20,000 matrix containing random standard normal entries.</p>
      <p>Preprocessing is implemented as selection and transformation routines of the core data structure, which is not a focus of scedar. The package is designed to identify the necessity of certain preprocessing procedures by extensively exploring the original state of the data. Although preprocessing, such as batch effect correction and normalization, could facilitate the detection of biological variances between cells, applying preprocessing methods correctly requires careful validation of their assumptions, otherwise they may introduce unwanted bias or variability [<xref rid="pcbi.1007794.ref022" ref-type="bibr">22</xref>].</p>
    </sec>
    <sec id="sec004">
      <title>Minimum description length iteratively regulated agglomerative clustering</title>
      <p>Minimum description length (MDL) iteratively regulated agglomerative clustering (MIRAC) extends hierarchical agglomerative clustering (HAC) [<xref rid="pcbi.1007794.ref023" ref-type="bibr">23</xref>] in a divide and conquer manner for scRNA-seq data. Input with raw or dimensionality reduced scRNA-seq data, MIRAC starts with one round of bottom-up HAC to build a tree with optimal linear leaf ordering [<xref rid="pcbi.1007794.ref024" ref-type="bibr">24</xref>], and the tree is then divided into small sub-clusters, which are further merged iteratively into clusters. Because each individual cluster becomes more homogenous with higher number of clusters, the iterative merging process is regularized with the MDL principle [<xref rid="pcbi.1007794.ref025" ref-type="bibr">25</xref>]. The asymptotic time complexity of the MIRAC algorithm is <italic>O</italic>(<italic>n</italic><sup>4</sup>+<italic>mn</italic><sup>2</sup>) where n is the number of samples, and m is the number of features. The space complexity is <italic>O</italic>(<italic>n</italic><sup>2</sup>+<italic>mn</italic>). Relevant mathematical theories and notations of MDL are briefly described in the following section. The pseudo-code of MIRAC is shown in <xref ref-type="fig" rid="pcbi.1007794.g002">Fig 2</xref>.</p>
      <fig id="pcbi.1007794.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007794.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>The minimum description length iteratively regulated agglomerative clustering (MIRAC) algorithm.</title>
          <p>MIRAC extends hierarchical agglomerative clustering (HAC) in a divide and conquer manner for scRNA-seq data. Input with raw or dimensionality reduced scRNA-seq data, MIRAC starts with building an HAC tree (Line 1–3), and the tree is then divided into small sub-clusters (Line 4–5), which are further merged iteratively into clusters (Line 9–37). The rationales and detailed procedures are described in the Methods section.</p>
        </caption>
        <graphic xlink:href="pcbi.1007794.g002"/>
      </fig>
      <p>Comparing to HAC, MIRAC is not designed to be faster but rather to improve the cluster robustness. The asymptotic time complexity of MIRAC is the same as HAC with optimal leaf ordering. However, the use of MDL rather than deterministic similarity metrics, improves the noise tolerance by estimating similarity with probabilistic models to give more weight on signal and less weight on noise, assuming that the signal is stronger than noise.</p>
      <sec id="sec005">
        <title>Rationale</title>
        <p>The rationale behind MIRAC is to reduce the number of cell partitions that need to be evaluated and find a good one among them.</p>
        <p>The number of all possible partitions of a set with n elements is the Bell number, which could be computed with the following recurrence
<disp-formula id="pcbi.1007794.e001"><alternatives><graphic xlink:href="pcbi.1007794.e001.jpg" id="pcbi.1007794.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>n</italic>≥1 and <italic>B</italic><sub>0</sub> = 1 [<xref rid="pcbi.1007794.ref026" ref-type="bibr">26</xref>]. It is computationally intractable to compute the code lengths of <italic>B</italic><sub><italic>n</italic></sub> partitions, so we reduced the number of cell partitions to evaluate with the following steps:</p>
        <list list-type="order">
          <list-item>
            <p>We only evaluate the partitions of <italic>n</italic> cells that consecutively divide the optimal HAC tree <italic>T</italic> leaf ordering. The HAC tree with optimal leaf ordering maximizes the sum of similarity measurements between adjacent items in the leaf ordering [<xref rid="pcbi.1007794.ref024" ref-type="bibr">24</xref>], which could be computed with an algorithm developed by Bar-Joseph <italic>et al</italic>. that runs in time <italic>O</italic>(<italic>n</italic><sup>4</sup>). The number of partitions that consecutively divide an ordering is the same as the number of compositions of <italic>n</italic>, which is <italic>C</italic><sub><italic>n</italic></sub> = 2<sup><italic>n</italic>−1</sup>. Because this number still grows exponentially with regard to <italic>n</italic>, it is necessary to further reduce the set of partitions for evaluation.</p>
          </list-item>
          <list-item>
            <p>Within step 1 partitions, we only evaluate those with all clusters having ≥<italic>t</italic> cells. The number of such partitions is the same as the compositions of <italic>n</italic> with all summands ≥<italic>t</italic>, which is
<disp-formula id="pcbi.1007794.e002"><alternatives><graphic xlink:href="pcbi.1007794.e002.jpg" id="pcbi.1007794.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
given by [<xref rid="pcbi.1007794.ref027" ref-type="bibr">27</xref>]. The growth rate of <inline-formula id="pcbi.1007794.e003"><alternatives><graphic xlink:href="pcbi.1007794.e003.jpg" id="pcbi.1007794.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with regard to <italic>n</italic> is smaller, but we still need to reduce it further. For example, <inline-formula id="pcbi.1007794.e004"><alternatives><graphic xlink:href="pcbi.1007794.e004.jpg" id="pcbi.1007794.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>20,21</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> for <italic>n</italic> in an ⟨20, 40, 60, 80, 100, 120, 140, 160, 180, 200⟩ are ⟨1, 2, 23, 274, 2695, 24941, 232016, 2184520, 20628613, 194570810⟩, and the values of 2<sup><italic>n</italic></sup> are ⟨1048576, 1099511627776, …, 1.607 x 10<sup>60</sup>⟩.</p>
          </list-item>
          <list-item>
            <p>Within step 2 partitions, we only evaluate the ones that could be generated by merging adjacent clusters of a specific partition <inline-formula id="pcbi.1007794.e005"><alternatives><graphic xlink:href="pcbi.1007794.e005.jpg" id="pcbi.1007794.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:math></alternatives></inline-formula>, where <italic>P</italic><sup><italic>s</italic></sup> is generated by recursively dividing the root HAC tree T until the partitioned subtree has ≤<italic>t</italic>−1 leaves. Thus, ⌈<italic>n</italic>/(<italic>t</italic>−1)⌉≤<italic>k</italic>≤<italic>n</italic>. Let <italic>M</italic>(<italic>P</italic><sup><italic>s</italic></sup>) denote the number of step 2 partitions that could be generated by merging adjacent clusters of <italic>P</italic><sup><italic>s</italic></sup>. The upper bound of <italic>M</italic>(<italic>P</italic><sup><italic>s</italic></sup>) is the same as the number of step 2 partitions, which could be reached when <italic>k</italic> = <italic>n</italic>. The lower bound of <italic>M</italic>(<italic>P</italic><sup><italic>s</italic></sup>) is not straightforward, since the merged partitions should have all clusters with ≥<italic>t</italic> cells.</p>
          </list-item>
        </list>
        <p>In order to find a good cell partition <italic>P</italic><sup><italic>g</italic></sup> in the subset of all possibles, we iteratively inspect each cluster of <italic>P</italic><sup><italic>s</italic></sup> and merge it with either its left or right adjacent cluster according to the similarity determined by the two-stage MDL scheme described in the following sections. The procedure has the following steps:</p>
        <list list-type="order">
          <list-item>
            <p>Merge <italic>P</italic><sup><italic>s</italic></sup> clusters in the beginning of the optimal ordering until the merged set contains ≥<italic>t</italic> cells (line 9 Algorithm 1).</p>
          </list-item>
          <list-item>
            <p>Similarly, merge <italic>P</italic><sup><italic>s</italic></sup> clusters at the end of the optimal ordering until the merged set contains ≥<italic>t</italic> cells (line 11 Algorithm 1).</p>
          </list-item>
          <list-item>
            <p>For every cluster <inline-formula id="pcbi.1007794.e006"><alternatives><graphic xlink:href="pcbi.1007794.e006.jpg" id="pcbi.1007794.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> in the middle, determine the similarity between <inline-formula id="pcbi.1007794.e007"><alternatives><graphic xlink:href="pcbi.1007794.e007.jpg" id="pcbi.1007794.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and the cluster on the left and right, and merge <inline-formula id="pcbi.1007794.e008"><alternatives><graphic xlink:href="pcbi.1007794.e008.jpg" id="pcbi.1007794.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with the more similar cluster (line 20–26 Algorithm 1). Although the cluster on the left <inline-formula id="pcbi.1007794.e009"><alternatives><graphic xlink:href="pcbi.1007794.e009.jpg" id="pcbi.1007794.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> always has <inline-formula id="pcbi.1007794.e010"><alternatives><graphic xlink:href="pcbi.1007794.e010.jpg" id="pcbi.1007794.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mo>≥</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> cells, the cluster on the right <inline-formula id="pcbi.1007794.e011"><alternatives><graphic xlink:href="pcbi.1007794.e011.jpg" id="pcbi.1007794.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> may have a minimum of one cell, so that the determined similarity between <inline-formula id="pcbi.1007794.e012"><alternatives><graphic xlink:href="pcbi.1007794.e012.jpg" id="pcbi.1007794.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007794.e013"><alternatives><graphic xlink:href="pcbi.1007794.e013.jpg" id="pcbi.1007794.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is sensitive to noise. In order to improve the robustness of similarity comparison, instead of determining the similarity between <inline-formula id="pcbi.1007794.e014"><alternatives><graphic xlink:href="pcbi.1007794.e014.jpg" id="pcbi.1007794.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007794.e015"><alternatives><graphic xlink:href="pcbi.1007794.e015.jpg" id="pcbi.1007794.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, we determine the similarity between <inline-formula id="pcbi.1007794.e016"><alternatives><graphic xlink:href="pcbi.1007794.e016.jpg" id="pcbi.1007794.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007794.e017"><alternatives><graphic xlink:href="pcbi.1007794.e017.jpg" id="pcbi.1007794.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>∪</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>∪</mml:mo><mml:mo>…</mml:mo><mml:mo>∪</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (line 20 Algorithm 1), where <inline-formula id="pcbi.1007794.e018"><alternatives><graphic xlink:href="pcbi.1007794.e018.jpg" id="pcbi.1007794.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo><mml:mo>≥</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, and rmm is the shorthand for right minimax.</p>
          </list-item>
          <list-item>
            <p>Once <inline-formula id="pcbi.1007794.e019"><alternatives><graphic xlink:href="pcbi.1007794.e019.jpg" id="pcbi.1007794.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo><mml:mo>≥</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, determine the similarity between <inline-formula id="pcbi.1007794.e020"><alternatives><graphic xlink:href="pcbi.1007794.e020.jpg" id="pcbi.1007794.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007794.e021"><alternatives><graphic xlink:href="pcbi.1007794.e021.jpg" id="pcbi.1007794.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and merge them if their similarity is above a certain threshold, otherwise split them (line 32–36 Algorithm 1). The code length of merged <inline-formula id="pcbi.1007794.e022"><alternatives><graphic xlink:href="pcbi.1007794.e022.jpg" id="pcbi.1007794.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>∪</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is
<disp-formula id="pcbi.1007794.e023"><alternatives><graphic xlink:href="pcbi.1007794.e023.jpg" id="pcbi.1007794.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>∪</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula></p>
            <p>The code length of divided <inline-formula id="pcbi.1007794.e024"><alternatives><graphic xlink:href="pcbi.1007794.e024.jpg" id="pcbi.1007794.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>∪</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is
<disp-formula id="pcbi.1007794.e025"><alternatives><graphic xlink:href="pcbi.1007794.e025.jpg" id="pcbi.1007794.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>∪</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula></p>
            <p>If <inline-formula id="pcbi.1007794.e026"><alternatives><graphic xlink:href="pcbi.1007794.e026.jpg" id="pcbi.1007794.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msubsup><mml:mrow><mml:mo>−</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>, merge <inline-formula id="pcbi.1007794.e027"><alternatives><graphic xlink:href="pcbi.1007794.e027.jpg" id="pcbi.1007794.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007794.e028"><alternatives><graphic xlink:href="pcbi.1007794.e028.jpg" id="pcbi.1007794.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, otherwise split them. This conditional statement generalizes the situations where <italic>L</italic><sub><italic>m</italic></sub> is either non-negative or negative.</p>
          </list-item>
          <list-item>
            <p>Continue inspecting the next cluster in <italic>P</italic><sup><italic>s</italic></sup>.</p>
          </list-item>
          <list-item>
            <p>After inspecting all middle clusters, <italic>P</italic><sup><italic>g</italic></sup> is the final updated <italic>P</italic><sup><italic>s</italic></sup>.</p>
          </list-item>
        </list>
        <p>We use a standard HAC tree to perform MIRAC when the number of samples is larger than ten thousand, which usually results in decreased but still acceptable performances (<xref ref-type="fig" rid="pcbi.1007794.g003">Fig 3</xref>). Although the optimal leaf ordering of the HAC tree is an important assumption, its computation takes too long when the number of samples is large. For example, it takes more than a week to compute the optimal leaf ordering of a dataset with about 68,000 samples. However, the time complexity of computing a good HAC linear ordering could be significantly reduced by implementing other ordering techniques [<xref rid="pcbi.1007794.ref028" ref-type="bibr">28</xref>].</p>
        <fig id="pcbi.1007794.g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007794.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Clustering method benchmarks on experimental datasets.</title>
            <p>(<bold>A</bold>) Runtimes. (<bold>B</bold>) CCRs on different datasets, with different points of each dataset representing different numbers of clusters. For each dataset, the numbers of clusters are the same across all compared clustering methods.</p>
          </caption>
          <graphic xlink:href="pcbi.1007794.g003"/>
        </fig>
      </sec>
      <sec id="sec006">
        <title>Analysis of complexity</title>
        <p>The time complexity of MIRAC is (<italic>n</italic><sup>4</sup>+<italic>mn</italic><sup>2</sup>), where <italic>n</italic>,<italic>m</italic>≥1. The time complexity of computing the HAC tree with optimal leaf ordering is <italic>O</italic>(<italic>n</italic><sup>4</sup>) [<xref rid="pcbi.1007794.ref024" ref-type="bibr">24</xref>]. The time complexity of finding <italic>P</italic><sup><italic>g</italic></sup> is <italic>O</italic>(<italic>mn</italic><sup>2</sup>), which is briefly analyzed as following.</p>
        <p>The time complexity is <italic>O</italic>(<italic>nm</italic>) for computing the code length <italic>L</italic>(<italic>X</italic><sub><italic>n</italic>×<italic>m</italic></sub>,<italic>P</italic>). In computing <italic>L</italic>(<italic>X</italic><sub><italic>n</italic>×<italic>m</italic></sub>,<italic>P</italic>) we compute the code lengths of each cluster and their labels. Since it takes <italic>O</italic>(<italic>n</italic>) time to compute the code length of <italic>n</italic> observations with a single feature, computing the code length of all clusters and features individually takes <italic>O</italic>(<italic>nm</italic>) time, and computing the code length of <italic>n</italic> labels take <italic>O</italic>(<italic>n</italic>) time.</p>
        <p>Similarly, the time complexity is <italic>O</italic>(<italic>n</italic><sub>1</sub><italic>m</italic>+<italic>n</italic><sub>2</sub><italic>m</italic>) for computing the code length of <inline-formula id="pcbi.1007794.e029"><alternatives><graphic xlink:href="pcbi.1007794.e029.jpg" id="pcbi.1007794.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> encoded by a model fitted with <inline-formula id="pcbi.1007794.e030"><alternatives><graphic xlink:href="pcbi.1007794.e030.jpg" id="pcbi.1007794.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. Fitting a model on <inline-formula id="pcbi.1007794.e031"><alternatives><graphic xlink:href="pcbi.1007794.e031.jpg" id="pcbi.1007794.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> takes <italic>O</italic>(<italic>n</italic><sub>2</sub><italic>m</italic>) amount of time. Using the model to encode <inline-formula id="pcbi.1007794.e032"><alternatives><graphic xlink:href="pcbi.1007794.e032.jpg" id="pcbi.1007794.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> takes <italic>O</italic>(<italic>n</italic><sub>1</sub><italic>m</italic>) amount of time.</p>
        <p>The time complexity of searching for <sup><italic>Pg</italic></sup> is <italic>O</italic>(<italic>mn</italic><sup>2</sup>). In the worst-case scenario, |<italic>P</italic><sup><italic>s</italic></sup>| = <italic>n</italic>, and the inspecting cluster is always merged with the left-hand side cluster in step 4. However, the impact of <inline-formula id="pcbi.1007794.e033"><alternatives><graphic xlink:href="pcbi.1007794.e033.jpg" id="pcbi.1007794.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and step 3 on the time complexity is not straightforward, so we divide the step 3 code length computation into three parts and analyze the upper bound of them individually. The divided three parts are the left cluster, inspecting cluster, and right minimax cluster. Because we keep increasing the size of the left cluster, the upper bound of computing the left cluster code length throughout the execution is <italic>O</italic>(<italic>mn</italic><sup>2</sup>). The maximum size of the inspecting cluster is <inline-formula id="pcbi.1007794.e034"><alternatives><graphic xlink:href="pcbi.1007794.e034.jpg" id="pcbi.1007794.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>, so the upper bound of computing the inspecting cluster code length is also <italic>O</italic>(<italic>mn</italic><sup>2</sup>), when every middle singleton is evaluated <inline-formula id="pcbi.1007794.e035"><alternatives><graphic xlink:href="pcbi.1007794.e035.jpg" id="pcbi.1007794.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula> times before merging with the left. The maximum size of the right minimax cluster is <inline-formula id="pcbi.1007794.e036"><alternatives><graphic xlink:href="pcbi.1007794.e036.jpg" id="pcbi.1007794.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>, so the upper bound of evaluating the right minimax cluster is also <italic>O</italic>(<italic>mn</italic><sup>2</sup>), when every increment of the left cluster takes <inline-formula id="pcbi.1007794.e037"><alternatives><graphic xlink:href="pcbi.1007794.e037.jpg" id="pcbi.1007794.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> times of evaluating the right minimax cluster. Summarizing these three parts, the overall upper bound is therefore <italic>O</italic>(<italic>mn</italic><sup>2</sup>).</p>
        <p>The space complexity of MIRAC is <italic>O</italic>(<italic>nm</italic>+<italic>n</italic><sup>2</sup>), which could be decomposed into the following three parts. The space complexity of storing the <italic>n</italic>×<italic>m</italic> data matrix <italic>X</italic> is <italic>O</italic>(<italic>mn</italic>). The space complexity of storing the HAC tree with optimal leaf ordering is <italic>O</italic>(<italic>n</italic>). The space complexity of storing the pairwise distance matrix is <italic>O</italic>(<italic>n</italic><sup>2</sup>).</p>
      </sec>
      <sec id="sec007">
        <title>Extension with community detection</title>
        <p>We extended MIRAC with community detection to improve scalability. We apply MIRAC on a relatively large number of detected single-cell communities to identify final clusters. We used the Leiden algorithm for community detection on KNN graphs [<xref rid="pcbi.1007794.ref029" ref-type="bibr">29</xref>]. We also provide a KNN graph construction method that supports approximate nearest neighbor (ANN) search using a Hierarchical Navigable Small World (HNSW) graph [<xref rid="pcbi.1007794.ref030" ref-type="bibr">30</xref>].</p>
      </sec>
    </sec>
    <sec id="sec008">
      <title>Cluster separating genes identification</title>
      <p>We use XGBoost [<xref rid="pcbi.1007794.ref018" ref-type="bibr">18</xref>], a scalable and sparsity-aware boosted tree system, to identify genes that are able to separate a specific set of clusters. This method is designed for data exploration after applying any one of a number of various statistical approaches that have been developed to identify differentially expressed genes [<xref rid="pcbi.1007794.ref031" ref-type="bibr">31</xref>–<xref rid="pcbi.1007794.ref035" ref-type="bibr">35</xref>], in order to quickly identify genes or sets of genes that are able to separate an arbitrary set of clusters for further inspection.</p>
      <p>Rather than providing a meticulous p-value for each gene among the compared clusters, we rank the genes by their individual importance on separating the clusters under comparison. The importance of a gene in the trained classifier is the number of times it has been used as an inner node of the decision trees. We use cross validation to train an XGBoost classifier on the compared clusters, and the classifier is essentially a bag of decision trees [<xref rid="pcbi.1007794.ref018" ref-type="bibr">18</xref>]. In order to alleviate the influences of stochasticity on interpretation, we use bootstrap with feature shuffling to better estimate the importance of genes in separating the compared clusters. The obtained list of important genes could be further explored by inspecting transcription level fold changes and decision tree structures.</p>
      <p>Comparing to NSForest [<xref rid="pcbi.1007794.ref036" ref-type="bibr">36</xref>], a method based on random forest [<xref rid="pcbi.1007794.ref037" ref-type="bibr">37</xref>,<xref rid="pcbi.1007794.ref038" ref-type="bibr">38</xref>] to identify a parsimonious set of cluster separating genes from scRNA-seq data, our method identifies all possible cluster separating genes using gradient boosting. Practically, NSForest version 1.3 is distributed on GitHub as a Python script without encapsulation or testing (checked on Oct 11, 2018), but our method is distributed through the Python Package Index, comprehensively tested, and easy to use through the user-friendly API. With regard to scalability, our method uses a scalable implementation of gradient boosting algorithm [<xref rid="pcbi.1007794.ref018" ref-type="bibr">18</xref>], whereas NSForest uses the implementation of random forest in scikit-learn [<xref rid="pcbi.1007794.ref038" ref-type="bibr">38</xref>].</p>
    </sec>
    <sec id="sec009">
      <title>K-nearest neighbor methods</title>
      <p>A k-nearest neighbor analytical strategy exploits the similarity between data points for classification, regression, and imputation [<xref rid="pcbi.1007794.ref039" ref-type="bibr">39</xref>,<xref rid="pcbi.1007794.ref040" ref-type="bibr">40</xref>]. In k-nearest neighbor methods, samples are considered as points in a space with each dimension representing a measured property, which is often referred to as a feature, of the samples. The similarity between samples can be evaluated with various distance metrics, which is extensively reviewed by Bellet <italic>et al</italic>. [<xref rid="pcbi.1007794.ref041" ref-type="bibr">41</xref>]. Generally, a distance metric is a function that takes two samples and output a numeric value to represent the distance between the two samples in their feature space. For example, the Euclidean distance metric is the following function,
<disp-formula id="pcbi.1007794.e038"><alternatives><graphic xlink:href="pcbi.1007794.e038.jpg" id="pcbi.1007794.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msqrt></mml:math></alternatives></disp-formula>
where the <bold><italic>p</italic></bold> and <bold><italic>q</italic></bold> are two samples, and <italic>q</italic><sub><italic>i</italic></sub> and <italic>p</italic><sub><italic>i</italic></sub> are the data values on their <italic>i</italic>th dimension. The k-nearest neighbors of a sample are the k number of other samples that have the smallest distances from the sample. The k-nearest neighbors of a sample are informative, due to their similarity, to determine the category of the sample in classification, the relevant continuous property in regression, and the missing values in imputation.</p>
      <p>We developed two methods based on the KNN algorithm to facilitate the exploration of scRNA-seq datasets. For a relatively large number of cells profiled in each scRNA-seq experiment, we assume that each one of the non-rare cells is similar to at least <italic>k</italic> other cells in their transcriptomic profiles. With this assumption, we impute gene dropouts and detect rare transcriptomic profiles. In the scedar implementation, we also support approximate nearest neighbor (ANN) search using Hierarchical Navigable Small World (HNSW) graph [<xref rid="pcbi.1007794.ref030" ref-type="bibr">30</xref>], which greatly improves the scalability of KNN graph construction.</p>
      <sec id="sec010">
        <title>Impute gene dropouts</title>
        <p>In an scRNA-seq experiment, if a truly expressed gene is not detected in a cell, the gene is considered a “dropout”, and such events are called gene dropouts [<xref rid="pcbi.1007794.ref032" ref-type="bibr">32</xref>]. Gene dropouts may be caused by biological and technical reasons [<xref rid="pcbi.1007794.ref032" ref-type="bibr">32</xref>,<xref rid="pcbi.1007794.ref042" ref-type="bibr">42</xref>,<xref rid="pcbi.1007794.ref043" ref-type="bibr">43</xref>]. The rationale behind the possible causes of biological dropouts are related to phenomena such as transcriptional bursting [<xref rid="pcbi.1007794.ref044" ref-type="bibr">44</xref>,<xref rid="pcbi.1007794.ref045" ref-type="bibr">45</xref>] and RNA degradation. With regard to technical dropouts, the main concerns are the relatively small number of RNA transcripts of a gene, amplification efficiency, and batch effects [<xref rid="pcbi.1007794.ref013" ref-type="bibr">13</xref>].</p>
        <p>We exploit the transcriptomic profiles of the k-nearest neighbors of a cell to impute the gene dropouts in the cell (Algorithm A in <xref ref-type="supplementary-material" rid="pcbi.1007794.s001">S1 Text</xref>). The algorithm could take multiple iterations, so that the dropped-out genes that are expressed in all k-nearest neighbors could be imputed at first, and the ones that are expressed in most but not all of k-nearest neighbors could be imputed in the following iterations.</p>
      </sec>
      <sec id="sec011">
        <title>Detecting rare transcriptomic profiles</title>
        <p>We mark transcriptomic profiles as rare if they are distinct from their k-nearest neighbors, according to the pairwise similarity between cells (Algorithm B in <xref ref-type="supplementary-material" rid="pcbi.1007794.s001">S1 Text</xref>). The algorithm could take multiple iterations, so that the most distinct transcriptomic profiles could be marked at first and less distinct ones in the following iterations.</p>
        <p>This method is provided mainly to facilitate detailed inspection of rare transcriptomic profiles rather than removing outliers from the data. Because rare transcriptomic profiles may have various biological and technical causes, samples and features in a dataset should only be removed after extensive exploratory data analysis and rigorous reasoning with domain specific knowledge. Closely comparing rare transcriptomic profiles with their nearest neighbors may also yield insights into their biological differences, which may further facilitate the identification of rare cell types and states.</p>
      </sec>
    </sec>
    <sec id="sec012">
      <title>Benchmarking</title>
      <p>We benchmarked the clustering and KNN performances of scedar on simulated and experimental scRNA-seq datasets. We obtained previously published experimental scRNA-seq datasets (<xref rid="pcbi.1007794.t001" ref-type="table">Table 1</xref>). We also generated 50 simulated scRNA-seq read count datasets with Splatter [<xref rid="pcbi.1007794.ref013" ref-type="bibr">13</xref>]. The simulation parameters are estimated by Splatter according to a Drop-seq dataset [<xref rid="pcbi.1007794.ref015" ref-type="bibr">15</xref>] and a 10x Genomics GemCode dataset [<xref rid="pcbi.1007794.ref016" ref-type="bibr">16</xref>]. Within each simulated dataset, the cells have 8 clusters taking approximately the following proportions: ⟨0.3, 0.2, 0.15, 0.15, 0.05, 0.05, 0.05, 0.05⟩, with a gene dropout rate around 5%.</p>
      <table-wrap id="pcbi.1007794.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007794.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Real scRNA-seq datasets for benchmark.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007794.t001g" xlink:href="pcbi.1007794.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Publication</th>
                <th align="left" rowspan="1" colspan="1"># cells</th>
                <th align="left" rowspan="1" colspan="1"># genes</th>
                <th align="left" rowspan="1" colspan="1">Organism</th>
                <th align="left" rowspan="1" colspan="1">Tissue</th>
                <th align="left" rowspan="1" colspan="1">Protocol</th>
                <th align="left" rowspan="1" colspan="1">Raw Data Type</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Deng <italic>et al</italic>. (2014)</td>
                <td align="left" rowspan="1" colspan="1">268</td>
                <td align="left" rowspan="1" colspan="1">22,431</td>
                <td align="left" rowspan="1" colspan="1">Mus Musculus</td>
                <td align="left" rowspan="1" colspan="1">Embryo</td>
                <td align="left" rowspan="1" colspan="1">Smart-Seq/Smart-Seq2</td>
                <td align="left" rowspan="1" colspan="1">Read count</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Pollen <italic>et al</italic>. (2014)</td>
                <td align="left" rowspan="1" colspan="1">301</td>
                <td align="left" rowspan="1" colspan="1">23,730</td>
                <td align="left" rowspan="1" colspan="1">Homo sapiens</td>
                <td align="left" rowspan="1" colspan="1">Dermal, blood, pluripotent and neural</td>
                <td align="left" rowspan="1" colspan="1">SMARTer</td>
                <td align="left" rowspan="1" colspan="1">TPM</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Kolodziejczyk <italic>et al</italic>. (2015)</td>
                <td align="left" rowspan="1" colspan="1">704</td>
                <td align="left" rowspan="1" colspan="1">38,653</td>
                <td align="left" rowspan="1" colspan="1">Mus Musculus</td>
                <td align="left" rowspan="1" colspan="1">Embryonic stem cell</td>
                <td align="left" rowspan="1" colspan="1">SMARTer</td>
                <td align="left" rowspan="1" colspan="1">Read count</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Zeisel <italic>et al</italic>. (2015)</td>
                <td align="left" rowspan="1" colspan="1">3005</td>
                <td align="left" rowspan="1" colspan="1">19,972</td>
                <td align="left" rowspan="1" colspan="1">Mus Musculus</td>
                <td align="left" rowspan="1" colspan="1">Brain</td>
                <td align="left" rowspan="1" colspan="1">STRT-Seq UMI</td>
                <td align="left" rowspan="1" colspan="1">Read count</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Macosko <italic>et al</italic>. (2015)</td>
                <td align="left" rowspan="1" colspan="1">44,808</td>
                <td align="left" rowspan="1" colspan="1">23,288</td>
                <td align="left" rowspan="1" colspan="1">Mus Musculus</td>
                <td align="left" rowspan="1" colspan="1">Retina</td>
                <td align="left" rowspan="1" colspan="1">Drop-seq</td>
                <td align="left" rowspan="1" colspan="1">Read count</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Zheng <italic>et al</italic>. (2015)</td>
                <td align="left" rowspan="1" colspan="1">68,579</td>
                <td align="left" rowspan="1" colspan="1">33,694</td>
                <td align="left" rowspan="1" colspan="1">Homo sapiens</td>
                <td align="left" rowspan="1" colspan="1">Peripheral blood mononuclear cell</td>
                <td align="left" rowspan="1" colspan="1">GemCode</td>
                <td align="left" rowspan="1" colspan="1">Read count</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Han <italic>et al</italic>. (2018)</td>
                <td align="left" rowspan="1" colspan="1">405,191</td>
                <td align="left" rowspan="1" colspan="1">39,855</td>
                <td align="left" rowspan="1" colspan="1">Mus Musculus</td>
                <td align="left" rowspan="1" colspan="1">Various tissues</td>
                <td align="left" rowspan="1" colspan="1">Microwell-Seq</td>
                <td align="left" rowspan="1" colspan="1">Read count</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Cao <italic>et al</italic>. (2019)</td>
                <td align="left" rowspan="1" colspan="1">2,058,652</td>
                <td align="left" rowspan="1" colspan="1">26,183</td>
                <td align="left" rowspan="1" colspan="1">Mus Musculus</td>
                <td align="left" rowspan="1" colspan="1">Embryo</td>
                <td align="left" rowspan="1" colspan="1">sci-RNA-seq3</td>
                <td align="left" rowspan="1" colspan="1">Read count</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>Source: <ext-link ext-link-type="uri" xlink:href="https://hemberg-lab.github.io/scRNA.seq.datasets/">https://hemberg-lab.github.io/scRNA.seq.datasets/</ext-link>. TPM represents Transcripts Per Million in the raw data type column.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We performed all benchmark analyses on a high-performance computing cluster, of which the computing resources are strictly managed by Univa Grid Engine. The cluster nodes have CPUs of Intel Xeon E5-2680 v3 or Intel Xeon E7-8880 v3. The memory sizes are either 128GB, 256GB, or 1TB. When scheduling analytical jobs for benchmarking, we make sure that the number of cores and allocated memory are enough for the program.</p>
      <sec id="sec013">
        <title>Clustering</title>
        <p>The clustering accuracy and stability of MIRAC were benchmarked together with several other clustering methods on experimental scRNA-seq datasets listed in <bold><xref rid="pcbi.1007794.t001" ref-type="table">Table 1</xref></bold>.</p>
        <p>The following clustering methods are directly applied on the original data without preprocessing.</p>
        <list list-type="bullet">
          <list-item>
            <p>MIRAC on 2D t-SNE projection.</p>
          </list-item>
          <list-item>
            <p>Single-cell consensus clustering (SC3) version 1.7.7 [<xref rid="pcbi.1007794.ref046" ref-type="bibr">46</xref>]. SC3 is selected for comparison because it was extensively compared with other methods on different experimental datasets.</p>
          </list-item>
          <list-item>
            <p>K-means clustering on 2D t-SNE projection.</p>
          </list-item>
          <list-item>
            <p>Hierarchical agglomerative clustering on 2D t-SNE projection.</p>
          </list-item>
          <list-item>
            <p>Density-based spatial clustering of applications with noise (DBSCAN) [<xref rid="pcbi.1007794.ref047" ref-type="bibr">47</xref>] on 2D t-SNE projection.</p>
          </list-item>
          <list-item>
            <p>Community clustering on KNN graph constructed using the Euclidean distances of 100 principal components. We used the Leiden algorithm for community detection [<xref rid="pcbi.1007794.ref029" ref-type="bibr">29</xref>].</p>
          </list-item>
        </list>
        <p>Although MIRAC could be directly applied on the expression matrix, dimensionality reduction is able to improve the performance of similarity and density-based clustering methods when the number of features is high [<xref rid="pcbi.1007794.ref048" ref-type="bibr">48</xref>]. The mathematical influences of the high number of features are briefly described in the previous sections.</p>
        <p>Although t-SNE projections are stochastic and influenced by the perplexity parameter, t-SNE is proved to be able to recover well-separated clusters [<xref rid="pcbi.1007794.ref049" ref-type="bibr">49</xref>] and t-SNE has been extensively used as dimensionality reduction method for scRNA-seq data [<xref rid="pcbi.1007794.ref003" ref-type="bibr">3</xref>,<xref rid="pcbi.1007794.ref015" ref-type="bibr">15</xref>]. Thus, we chose to use t-SNE for demonstration in this report, but we note that scedar also supports the use of PCA and UMAP for MIRAC clustering, which can be applied just as easily as the t-SNE method.</p>
        <p>When benchmarking for accuracy, we cluster the cells in each experimental dataset using the compared clustering methods with a grid of parameters. We use the maximum similarities between the clustering results and the cell types from the publications in order to compare the accuracy of different clustering methods. Although taking the maximum increases the chance of overfitting, it resembles the procedure of clustering analysis in practice.</p>
        <p>We also recorded the runtime of clustering methods on different datasets. In <xref ref-type="fig" rid="pcbi.1007794.g003">Fig 3A</xref>, SC3 was performed with 20 cores, and community clustering is performed with 60 cores. Other clustering methods were performed with a single core. When running MIRAC, we did not require the hierarchical tree to be optimal. The community-detection-extended MIRAC clustering method was performed with 25 CPU cores, and other methods were performed with 60 CPU cores (<xref ref-type="supplementary-material" rid="pcbi.1007794.s009">S8 Fig</xref>, panel C).</p>
        <p>We also benchmarked the influences of t-SNE random states on the clustering results (<xref ref-type="supplementary-material" rid="pcbi.1007794.s002">S1 Fig</xref>). The t-SNE embeddings generated with different random states may be distinct from each other, although current mathematical results have shown that clustering using t-SNE embeddings is able to recover well separated clusters [<xref rid="pcbi.1007794.ref049" ref-type="bibr">49</xref>]. We characterized the stability to random states of clustering methods by running them on each experimental dataset with the same parameters but ten different random states. The similarity of clustering results between different random states are used to compare the stability of different clustering methods. The stability of community clustering is not characterized, because it is based on PCA.</p>
      </sec>
      <sec id="sec014">
        <title>Cluster similarity metrics</title>
        <p>We use two cluster similarity metrics, cluster consistent ratio (CCR) and adjusted Rand index (ARI) [<xref rid="pcbi.1007794.ref050" ref-type="bibr">50</xref>] for measuring the accuracy and stability of clustering methods respectively. When we have a coarse reference partition <italic>P</italic><sub><italic>r</italic></sub> and a finer clustering partition <italic>P</italic><sub><italic>c</italic></sub>, the CCR is computed as the ratio of pairs within each cluster of <italic>P</italic><sub><italic>c</italic></sub> that are also in the same cluster of <italic>P</italic><sub><italic>r</italic></sub>, with the number of clusters kept the same across compared methods. The ARI is computed with the Python package scikit-learn [<xref rid="pcbi.1007794.ref038" ref-type="bibr">38</xref>] using the mathematical formula given by Hubert and Arabie [<xref rid="pcbi.1007794.ref050" ref-type="bibr">50</xref>].</p>
        <p>The reference partitions <italic>P</italic><sub><italic>r</italic></sub> of real datasets are obtained from their original publications (Table A in <xref ref-type="supplementary-material" rid="pcbi.1007794.s001">S1 Text</xref>). The clusters in Deng <italic>et al</italic>. dataset [<xref rid="pcbi.1007794.ref051" ref-type="bibr">51</xref>] are experimentally determined by manual single cell isolation. The clusters in Pollen <italic>et al</italic>. [<xref rid="pcbi.1007794.ref014" ref-type="bibr">14</xref>] are experimentally determined by the cell line or tissue type of the isolated single cells. The clusters in Kolodziejczyk <italic>et al</italic>. [<xref rid="pcbi.1007794.ref052" ref-type="bibr">52</xref>] are determined by the embryonic stem cell culturing conditions and batches. The clusters in Zeisel <italic>et al</italic>. [<xref rid="pcbi.1007794.ref053" ref-type="bibr">53</xref>] are determined by the BackSPIN clustering method [<xref rid="pcbi.1007794.ref053" ref-type="bibr">53</xref>] and further inspected with domain specific knowledge.</p>
        <p>We choose CCR to measure clustering accuracy rather than ARI, because ARI greatly penalizes the split of a large cluster in <italic>P</italic><sub><italic>r</italic></sub> into multiple smaller ones in <italic>P</italic><sub><italic>c</italic></sub>. This behavior of ARI could prevent the evaluation of transcriptomic variabilities within a large group of cells in clustering analysis, which is an important goal of scRNA-seq experiments that cannot be easily achieved by bulk RNA-seq experiments. In addition, we also provide a method in scedar to easily merge multiple clusters together, in case the users found the sub-types of a cell type are very similar to each other.</p>
        <p>However, we used ARI to measure clustering stability rather than CCR, because the differences between <italic>P</italic><sub><italic>r</italic></sub> and <italic>P</italic><sub><italic>c</italic></sub> are completely caused by different random states, hence splitting a cluster in <italic>P</italic><sub><italic>r</italic></sub> should be penalized.</p>
        <p>MDL is not used as a cluster similarity metric, even though MDL is used in MIRAC to guide the process of finding good partitions. MDL is only used to guide and regularize the merging process of local adjacent sub-clusters by evaluating their similarity, but it is not used as an objective to be optimized globally. Using MDL as a benchmarking metric would introduce a bias as among the various methods, MIRAC is the only method using MDL. Moreover, interpreting relative global MDL differences is not straightforward as it is not only affected by cluster labels, but also transcription levels.</p>
      </sec>
      <sec id="sec015">
        <title>Detection of rare transcriptomic profiles</title>
        <p>We visualize real datasets before and after removing rare transcriptomic profiles in t-SNE projection and pairwise distance heatmaps, without quantitative evaluations like receiver operating characteristic (ROC) curve, since rare transcriptomic profiles are not well defined with a large number of genes [<xref rid="pcbi.1007794.ref048" ref-type="bibr">48</xref>]. Approaches to identify rare data points in low-dimensional spaces (≤3) do not scale well to higher dimensions due to the exponentially decreased density of data points in space and increased instability of distances, which is elaborated in the previous section about mathematical theories on high-dimensional data analysis. KNN rare transcriptomic profile detection was performed with 25 CPU cores, as shown in <xref ref-type="supplementary-material" rid="pcbi.1007794.s009">S8 Fig</xref> panel B.</p>
        <p>It is important to note that rare transcriptomic profiles are detected to facilitate detailed inspection rather than the removal of them from the data. The visualizations are only used to illustrate the capability of the KNN method for detecting rare transcriptomic profiles.</p>
      </sec>
      <sec id="sec016">
        <title>Gene dropout imputation</title>
        <p>We simulate gene dropouts using Splatter [<xref rid="pcbi.1007794.ref013" ref-type="bibr">13</xref>] to obtain a dropout rate around 5%. Then, we benchmark the performance of imputing gene dropout as two parts: detection and smoothing. On simulated data, because the true gene dropouts are known, we use a ROC curve and mean squared errors (MSEs) to characterize the performance of gene dropout detection and smoothing respectively. In <xref ref-type="fig" rid="pcbi.1007794.g004">Fig 4A</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007794.s008">S7 Fig</xref> panel A, and <xref ref-type="supplementary-material" rid="pcbi.1007794.s009">S8 Fig</xref> panel A, all imputation methods were executed with a single core. On real data, we visualize the cells in 2D t-SNE space before and after imputation. The compared methods are KNN gene dropout imputation (KNNGDI) version 0.1.5, SAVER version 1.0.0 [<xref rid="pcbi.1007794.ref054" ref-type="bibr">54</xref>], MAGIC version 1.1.0 [<xref rid="pcbi.1007794.ref055" ref-type="bibr">55</xref>], and scImpute version 0.0.6 [<xref rid="pcbi.1007794.ref056" ref-type="bibr">56</xref>].</p>
        <fig id="pcbi.1007794.g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007794.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Gene dropout imputation method benchmarks.</title>
            <p>(<bold>A</bold>) Runtimes on 40 simulated 10x Genomics datasets. (<bold>B</bold>) ROC curves (± standard deviation) of dropout detection on the simulated 10x Genomics datasets. (<bold>C</bold>) t-SNE scatter plots of the Zeisel <italic>et al</italic>. [<xref rid="pcbi.1007794.ref053" ref-type="bibr">53</xref>] dataset after gene dropout imputations.</p>
          </caption>
          <graphic xlink:href="pcbi.1007794.g004"/>
        </fig>
      </sec>
      <sec id="sec017">
        <title>Method speed-up by parallel processing</title>
        <p>We characterized the analysis speed-up by parallel processing on different datasets (<xref ref-type="supplementary-material" rid="pcbi.1007794.s010">S9 Fig</xref>). KNN dropout imputation is not evaluated on larger datasets, because the speed limiting step has not yet been parallelized. In addition to parallelizing the computation in the implemented methods, we also provide an easy-to-use utility function (scedar.utils.parmap) to parallelly run analytical methods with different parameters, which would significantly facilitate exploratory parameter search.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="sec018">
    <title>Results</title>
    <sec id="sec019">
      <title>Basic workflow of scedar</title>
      <p>We illustrate the basic workflow of using scedar for scRNA-seq exploratory data analysis with the dataset published by Zeisel <italic>et al</italic>. [<xref rid="pcbi.1007794.ref053" ref-type="bibr">53</xref>] (<xref ref-type="fig" rid="pcbi.1007794.g001">Fig 1</xref>). The dataset contains the RNA unique molecule identifier (UMI) counts of 19,972 genes in 3005 cells from the mouse brain. We selected this dataset for demonstration because it could be clearly visualized in small graphs, although our package is capable of analyzing much larger datasets with over 2 million cells (<xref ref-type="supplementary-material" rid="pcbi.1007794.s003">S2 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007794.s004">S3 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007794.s005">S4 Fig</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007794.s006">S5 Fig</xref>).</p>
      <p>In <xref ref-type="fig" rid="pcbi.1007794.g001">Fig 1</xref>, each box represents a data analysis step, and they are consecutively executed according to the arrow. The purpose and runtime are listed in the upper ribbon. The code that is essential to the step is listed in the box, and their results are also shown.</p>
      <p>The preparation step imports required packages and loads the data. The class SampleDistanceMatrix is one of the core data structures in the package that is used to store the read counts and pairwise distances of an scRNA-seq dataset. Because the pairwise distance computation is delayed until necessary, i.e. lazily loaded, this step only takes 12 seconds. We use cosine distance rather than correlation distance to greatly speed up the computation, since we implemented the computation procedure of pairwise cosine distances completely with NumPy linear algebra operations with OpenBLAS backend [<xref rid="pcbi.1007794.ref057" ref-type="bibr">57</xref>,<xref rid="pcbi.1007794.ref058" ref-type="bibr">58</xref>].</p>
      <p>The t-Distributed Stochastic Neighbor Embedding (t-SNE) scatter plot and KNN graph are used to explore the dataset. The cell type labels published by Zeisel <italic>et al</italic>. [<xref rid="pcbi.1007794.ref053" ref-type="bibr">53</xref>] are truncated to fit in the space. We also provide methods to visualize arbitrary statistics, e.g. number of expressed genes, of individual cells as color gradient. The layouts of cells in t-SNE and KNN graph are similar to each other. Although KNN graph is faster than t-SNE, the runtime for t-SNE could be reduced by optimizing its parameters, e.g. lowering the number of iterations.</p>
      <p>The MIRAC step clusters the cells and visualizes them with t-SNE scatter plot and pairwise distance matrix heatmap. The heatmap generation procedure in scedar is optimized for large-scale datasets, which is able to generate a heatmap with tens of thousands of columns and rows in a few minutes. Users could also generate heatmaps for the read count matrix to directly inspect the sparsity of datasets (all panels B in <xref ref-type="supplementary-material" rid="pcbi.1007794.s003">S2 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007794.s004">S3 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007794.s005">S4 Fig</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007794.s006">S5 Fig</xref>).</p>
      <p>The last step identifies cluster separating genes with XGBoost [<xref rid="pcbi.1007794.ref018" ref-type="bibr">18</xref>]. Users could choose an arbitrary set of clusters to compare, and the genes are ranked by their importance in separating the clusters. Then, the read counts of a gene across clustered labels could easily be visualized by t-SNE scatter plot.</p>
    </sec>
    <sec id="sec020">
      <title>Performance of MIRAC clustering</title>
      <p>We benchmarked several clustering methods on the datasets listed in <xref rid="pcbi.1007794.t001" ref-type="table">Table 1</xref> (<xref ref-type="fig" rid="pcbi.1007794.g003">Fig 3</xref>). Each dataset is clustered multiple times with each clustering method to obtain different numbers of clusters (Table A in <xref ref-type="supplementary-material" rid="pcbi.1007794.s001">S1 Text</xref>).</p>
      <p>The t-SNE based clustering methods are faster than SC3 (<xref ref-type="fig" rid="pcbi.1007794.g003">Fig 3A</xref>). Also, the t-SNE based clustering methods have similar runtimes (<xref ref-type="fig" rid="pcbi.1007794.g003">Fig 3A</xref>), since the time limiting step is the computation of t-SNE projection, when optimal hierarchical clustering ordering is not required in MIRAC. When the optimal ordering is required, the time limiting step is the computation of optimal ordering (<xref ref-type="fig" rid="pcbi.1007794.g001">Fig 1</xref>). With regard to practical usage, we recommend the users to explore different parameters of MIRAC without optimal ordering. Once appropriate parameters have been identified, users can perform MIRAC with optimal ordering. However, for datasets with more than 10,000 cells, we recommend that users perform MIRAC without optimal ordering (<xref ref-type="supplementary-material" rid="pcbi.1007794.s003">S2 Fig</xref> panel C and <xref ref-type="supplementary-material" rid="pcbi.1007794.s004">S3 Fig</xref> panel C). For datasets with more than 100,000 cells, we recommend that users perform community-detection-extended MIRAC without optimal ordering (<xref ref-type="supplementary-material" rid="pcbi.1007794.s009">S8C Fig</xref>), which takes for instance 2885.5 ± 176.0 (mean ± standard deviation) seconds on the mouse organogenesis cell atlas (MOCA) dataset with 2,058,652 single cells using 25 CPU cores (<xref ref-type="supplementary-material" rid="pcbi.1007794.s009">S8C Fig</xref>) [<xref rid="pcbi.1007794.ref059" ref-type="bibr">59</xref>]. We also performed clustering with the community clustering methods implemented in scedar, Seurat [<xref rid="pcbi.1007794.ref008" ref-type="bibr">8</xref>] and Scanpy [<xref rid="pcbi.1007794.ref009" ref-type="bibr">9</xref>] on relatively large scRNA-seq datasets with more than 10,000 cells (<xref ref-type="supplementary-material" rid="pcbi.1007794.s009">S8C Fig</xref>). The runtime of community clustering methods Seurat and Scanpy is comparable to community clustering and community-detection-extended MIRAC (<xref ref-type="supplementary-material" rid="pcbi.1007794.s009">S8C Fig</xref>), except that Scanpy and Seurat were not able to cluster the MOCA dataset that contain 2,058,652 single cells on a server with 1TB memory due to a mandatory conversion of the sparse read count matrix into dense matrix.</p>
      <p>The cluster consistent ratios (CCRs) of t-SNE based clustering methods are comparable to SC3 (<xref ref-type="fig" rid="pcbi.1007794.g003">Fig 3B</xref>). The PCA based community clustering results showed relatively lower CCRs than other clustering methods (<xref ref-type="fig" rid="pcbi.1007794.g003">Fig 3B</xref>), which might due to the non-optimal representation of similarities between high-dimensional single cell read counts in the linear PCA space, comparing to t-SNE embeddings that are optimized to capture the similarities between high-dimensional single cell read counts. The representative MIRAC clustering results of Zheng <italic>et al</italic>. [<xref rid="pcbi.1007794.ref016" ref-type="bibr">16</xref>] and Macosko <italic>et al</italic>. [<xref rid="pcbi.1007794.ref015" ref-type="bibr">15</xref>] datasets are visualized with t-SNE scatter plots and pairwise distance matrix heatmaps (<xref ref-type="supplementary-material" rid="pcbi.1007794.s003">S2 Fig</xref> panel C and <xref ref-type="supplementary-material" rid="pcbi.1007794.s004">S3 Fig</xref> panel C). For smaller datasets, the representative MIRAC results are shown (<xref ref-type="supplementary-material" rid="pcbi.1007794.s007">S6 Fig</xref>). Although t-SNE projections obtained with different random states are distinct from each other, the consistency of clustering results is comparable to SC3 (<xref ref-type="supplementary-material" rid="pcbi.1007794.s002">S1 Fig</xref>).</p>
    </sec>
    <sec id="sec021">
      <title>Performance of imputing gene dropouts</title>
      <p>We benchmarked several gene dropout imputation methods on the simulated 10x Genomics (<xref ref-type="fig" rid="pcbi.1007794.g004">Fig 4</xref>) and Drop-seq (<xref ref-type="supplementary-material" rid="pcbi.1007794.s008">S7 Fig</xref>) datasets. K-nearest neighbor gene dropout imputation (KNNGDI) is faster than other compared methods on relatively small datasets (<xref ref-type="fig" rid="pcbi.1007794.g004">Fig 4A</xref>) and is capable of handling scRNA-seq datasets with over 10,000 cells (<xref ref-type="supplementary-material" rid="pcbi.1007794.s009">S8 Fig</xref> panel A). The runtime of KNNDGI on 2,058,652 cells is 71.56 ± 1.71 (mean ± standard deviation) hours.</p>
      <p>The performance of KNNGDI on detecting gene dropouts is comparable to SAVER and better than scImpute and MAGIC. The ROC curve of scImpute sharply turns around TPR = 0.25 (<xref ref-type="fig" rid="pcbi.1007794.g004">Fig 4B</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007794.s008">S7 Fig</xref> panel B) because its threshold parameters, determining whether a zero entry is a dropout or not, are not sensitive enough to achieve any higher TPRs. Although the AUCs of KNNGDI and SAVER are higher than scImpute and MAGIC, they all have comparable performances when FPRs are lower than 0.05 (<xref ref-type="fig" rid="pcbi.1007794.g004">Fig 4B</xref>), except that MAGIC has worse performance on the simulated Drop-seq datasets that have higher sparsity than the Zeisel <italic>et al</italic>. [<xref rid="pcbi.1007794.ref053" ref-type="bibr">53</xref>] dataset (<xref ref-type="supplementary-material" rid="pcbi.1007794.s008">S7 Fig</xref> panel B).</p>
      <p>The MSEs of KNNGDI on correcting gene dropouts are comparable to SAVER and smaller than scImpute and MAGIC (<xref ref-type="supplementary-material" rid="pcbi.1007794.s008">S7 Fig</xref> panel C and <xref ref-type="supplementary-material" rid="pcbi.1007794.s008">S7 Fig</xref> panel D). However, these methods all have MSEs many times higher than the MSEs of the observed counts to the true counts, which implies that these methods all introduced many times more reads than the true dropout reads. Despite different levels of MSEs, the t-SNE embeddings of the imputed read counts are consistent with the t-SNE embeddings of original read counts (<xref ref-type="fig" rid="pcbi.1007794.g004">Fig 4C</xref>, and all panels E in <xref ref-type="supplementary-material" rid="pcbi.1007794.s003">S2 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007794.s004">S3 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007794.s005">S4 Fig</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007794.s006">S5 Fig</xref>).</p>
    </sec>
    <sec id="sec022">
      <title>Performance of detecting rare transcriptomic profiles</title>
      <p>We detected rare transcriptomic profiles in datasets listed in <xref rid="pcbi.1007794.t001" ref-type="table">Table 1</xref> with the KNN method (<xref ref-type="fig" rid="pcbi.1007794.g005">Fig 5</xref>, and all panels F in <xref ref-type="supplementary-material" rid="pcbi.1007794.s003">S2 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007794.s004">S3 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007794.s005">S4 Fig</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007794.s006">S5 Fig</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007794.s007">S6 Fig</xref>) Although the detection method has many limitations, rare transcriptomic profiles tend to be points on the t-SNE scatter plots either far away from the majority of their same types or along the edges of a group of agglomerated points. On the pairwise distance matrix heatmap, rare transcriptomic profiles tend to be small chunks that are distinct from their neighbors, and the heatmap becomes smoother after removing the rare transcriptomic profiles. The detected rare transcriptomic profiles could be further inspected as potential rare cell types and states by comparing with their nearest neighbors. The KNN rare transcriptomic profile detection method is also capable of handling scRNA-seq datasets with over 10,000 cells (<xref ref-type="supplementary-material" rid="pcbi.1007794.s009">S8 Fig</xref> panel B), with a runtime of 22.14 ± 0.87 (mean ± standard deviation) minutes on 2,058,652 cells.</p>
      <fig id="pcbi.1007794.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007794.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>KNN rare transcriptomic profile detection on the Zeisel <italic>et al</italic>. [<xref rid="pcbi.1007794.ref053" ref-type="bibr">53</xref>] dataset.</title>
          <p>(<bold>A</bold>) t-SNE scatter plot with colors labeling cell types and markers labeling common or rare transcriptomic profiles. 9.3% cells are marked as rare. (<bold>B</bold>) Pairwise cosine distance heatmap with left strip as MIRAC labels and upper strip as common or rare transcriptomic profiles labels. (<bold>C</bold>) Pairwise cosine distance heatmap with rare transcriptomic profiles removed.</p>
        </caption>
        <graphic xlink:href="pcbi.1007794.g005"/>
      </fig>
    </sec>
    <sec id="sec023">
      <title>Identification of cluster separating genes</title>
      <p>We used scedar to identify the genes distinguishing the MIRAC cluster 1, 15, and 22 of the Zeisel <italic>et al</italic>. [<xref rid="pcbi.1007794.ref053" ref-type="bibr">53</xref>] dataset (<xref ref-type="fig" rid="pcbi.1007794.g006">Fig 6</xref> and Table B in <xref ref-type="supplementary-material" rid="pcbi.1007794.s001">S1 Text</xref>). In the original publication, the upper to lower MIRAC clusters labeled 22, 1, and 15 in the t-SNE scatter plot are assigned to microglia, endothelial cells, and astrocytes respectively (<xref ref-type="fig" rid="pcbi.1007794.g004">Fig 4C</xref>). We choose these three clusters to inspect one of the discrepancies between cell types and MIRAC clustering results, where the small isolated upper part of the MIRAC cluster 15 is assigned to microglia instead of endothelial cells in the original publication.</p>
      <fig id="pcbi.1007794.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007794.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Identified genes separating the MIRAC clusters 1, 15, and 22 of the Zeisel <italic>et al</italic>. [<xref rid="pcbi.1007794.ref053" ref-type="bibr">53</xref>] dataset.</title>
          <p>(<bold>A</bold>) t-SNE scatter plot with color as MIRAC cluster labels and marker shape as compared or not compared. (<bold>B</bold>) t-SNE scatter plots of the compared clusters with color as log<sub>2</sub>(read count + 1) of the corresponding gene and marker shape as MIRAC clusters. (<bold>C</bold>) Transcription level heatmap of the top 100 important cluster separating genes in the compared cells, with rows as cells ordered by cluster labels and columns as genes ordered by importance. The color gradient is log<sub>2</sub>(clip(read count, 1, 100)), where the clip(read count, 1, 100) function changes any read count below 1 to 1 and above 100 to 100, in order to better compare genes at different transcription levels.</p>
        </caption>
        <graphic xlink:href="pcbi.1007794.g006"/>
      </fig>
      <p>The smaller upper isolated part of MIRAC cluster 15 might be a distinct cell sub-type of microglia. Although it expresses a microglia marker gene C1qb (<xref ref-type="fig" rid="pcbi.1007794.g006">Fig 6B</xref>) [<xref rid="pcbi.1007794.ref060" ref-type="bibr">60</xref>], it does not express Mrc1 or Apoe in the same pattern as the MIRAC cluster 22 (<xref ref-type="fig" rid="pcbi.1007794.g006">Fig 6B and 6C</xref>). According to the transcription levels of the cluster separating genes (<xref ref-type="fig" rid="pcbi.1007794.g006">Fig 6C</xref>), the smaller upper isolated part of MIRAC cluster 15, which is located at the top of the cluster 15 rows, has some genes expressed in the same pattern as the microglia, but it also has some other genes expressed distinctly from the microglia.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec024">
    <title>Discussion</title>
    <p>Comprehensive profiling of the transcriptomes of individual cells within an organism or tissue by scRNA-seq is able to facilitate the systematic study of physiological or pathological states [<xref rid="pcbi.1007794.ref003" ref-type="bibr">3</xref>,<xref rid="pcbi.1007794.ref061" ref-type="bibr">61</xref>,<xref rid="pcbi.1007794.ref062" ref-type="bibr">62</xref>]. Previous scRNA-seq experiments identified novel cell types or states [<xref rid="pcbi.1007794.ref061" ref-type="bibr">61</xref>], obtained insights into the regulation of differentiation process [<xref rid="pcbi.1007794.ref003" ref-type="bibr">3</xref>,<xref rid="pcbi.1007794.ref059" ref-type="bibr">59</xref>,<xref rid="pcbi.1007794.ref063" ref-type="bibr">63</xref>,<xref rid="pcbi.1007794.ref064" ref-type="bibr">64</xref>], and inferred molecular mechanisms of tissue functions [<xref rid="pcbi.1007794.ref053" ref-type="bibr">53</xref>,<xref rid="pcbi.1007794.ref065" ref-type="bibr">65</xref>,<xref rid="pcbi.1007794.ref066" ref-type="bibr">66</xref>].</p>
    <p>The biological results of scRNA-seq experiments are obtained from extensive data analyses, which could take more time than doing the experiments. As the size of scRNA-seq datasets increases rapidly [<xref rid="pcbi.1007794.ref001" ref-type="bibr">1</xref>,<xref rid="pcbi.1007794.ref067" ref-type="bibr">67</xref>], computational methods also need to be scalable by exploiting hardware and software techniques for big data analytics, in order to complete an analysis within a reasonable amount of time.</p>
    <p>Scedar is able to facilitate gene dropout imputation, rare transcriptomic profile detection, clustering, and identification of cluster separating genes for scRNA-seq data by exploiting scalable system design patterns and high-performance computing architectures. We parallelized time-consuming computational procedures by multi-processing without excessive copies of shared data in memory. We also decompose the whole analytical procedure into multiple steps, so that certain steps could be specifically optimized without repeating others. In addition, intermediate results, such as pairwise distances and t-SNE projections, are lazy loaded and cached in a unified data structure to speed up analytical routines, prevent repeated computations, and alleviate the burden on users to keep track of all intermediate results.</p>
    <p>Comparing to other computational tools that were developed or updated for large scale scRNA-seq data analysis, like PAGODA2 [<xref rid="pcbi.1007794.ref068" ref-type="bibr">68</xref>], Seurat v2.0 [<xref rid="pcbi.1007794.ref008" ref-type="bibr">8</xref>], and Scanpy [<xref rid="pcbi.1007794.ref009" ref-type="bibr">9</xref>], scedar distinguishes itself with an additional research focus on developing new analytical methods, including those based on machine learning. In scedar, we adapted KNN, a typical machine learning algorithm, to impute gene dropouts and detect rare transcriptomic profiles. MDL principle, an important concept in computational learning, is applied to cluster single cells [<xref rid="pcbi.1007794.ref025" ref-type="bibr">25</xref>]. A scalable and sparsity-aware gradient boosted tree system XGBoost [<xref rid="pcbi.1007794.ref018" ref-type="bibr">18</xref>], which implements a typical machine learning algorithm, is used to identify genes that are able to distinguish different clusters. In addition, these machine learning methods are able to exploit modern high-performance computing architecture, which improves the scalability of the package.</p>
    <p>In scedar, we developed a clustering algorithm, MIRAC, for scRNA-seq data. MIRAC clusters observations in three steps: 1) build a tree by hierarchical clustering, 2) divide the tree into sub-trees, and 3) merge similar sub-trees into individual clusters. This clustering strategy adapts the basic ideas of BIRCH [<xref rid="pcbi.1007794.ref069" ref-type="bibr">69</xref>] and BackSPIN [<xref rid="pcbi.1007794.ref053" ref-type="bibr">53</xref>]. Instead of building a balanced tree structure, like the clustering feature tree in BIRCH for further partitioning, MIRAC divides the tree structure built by hierarchical clustering optionally in a balanced manner (<xref ref-type="supplementary-material" rid="pcbi.1007794.s011">S10 Fig</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007794.s001">S1 Text</xref> section 1.4), which simplifies the clustering procedure. In BackSPIN, a sorted pairwise correlation matrix is recursively bi-partitioned into clusters according to criteria based on the normalized sums of correlation coefficients. In contrast, MIRAC iteratively merges the relatively small sub-clusters according to criteria based on the MDL principle, which increases the robustness for determining whether two groups of observations should be put in the same cluster or not. Especially, when the number of observations is large within a group, finding an optimal bi-partition is not straightforward, since there may be multiple distinct sub-groups. Although the performance of MIRAC under certain metrics is comparable to other clustering algorithms, it is able to provide distinct clusters that are sensitive to local structures, which could be used as alternative perspectives to interpret the source of heterogeneity within the dataset.</p>
    <p>There are still many possible improvements on scedar. To improve the scalability of MIRAC, we could provide more efficient methods to obtain the optimal leaf ordering using linear embedding techniques [<xref rid="pcbi.1007794.ref028" ref-type="bibr">28</xref>]. To improve the scalability of the backend data structure, we could extend it with distributed analytic systems such as Apache Spark [<xref rid="pcbi.1007794.ref010" ref-type="bibr">10</xref>]. To visualize the differences between different clusters, we could plot the fold changes of gene transcription levels on the pathway maps in the KEGG (Kyoto Encyclopedia of Genes and Genomes) database [<xref rid="pcbi.1007794.ref070" ref-type="bibr">70</xref>].</p>
    <p>Scedar is at its core developed as an open-source, community-extensible package for exploratory data analysis, with strong testing and code development standards (Table C in <xref ref-type="supplementary-material" rid="pcbi.1007794.s001">S1 Text</xref>). Scedar will continue to be developed in an open-source environment that can offer an analytical platform for developing novel algorithms, support state-of-the-art software quality control standards, and provide easy-to-use programming interfaces for exploratory data research.</p>
    <sec id="sec025">
      <title>Code availability</title>
      <p>The scedar package is distributed through Pypi <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/scedar">https://pypi.org/project/scedar</ext-link></p>
      <p>The code and other resources are available in Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/logstar/scedar">https://github.com/logstar/scedar</ext-link></p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec026">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007794.s001">
      <label>S1 Text</label>
      <caption>
        <title>Supplementary text.</title>
        <p>Algorithm A, Algorithm B and Table A, Table B, and Table C. Includes discussion of scedar package development, minimum description length method, two-stage coding scheme for clustered scRNA-seq, mathematical theories on high-dimensional data analysis including distances between points in high dimensional space and the Johnson-Lindenstrauss lemma. Discussion of the skewed root division of a hierarchical agglomerative clustering tree.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1007794.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007794.s002">
      <label>S1 Fig</label>
      <caption>
        <title>Stability of clustering methods on experimental dataset.</title>
        <p>Similarity between clustering results generated with different random states but the same parameters, quantified by adjusted rand index (ARI) [<xref rid="pcbi.1007794.ref023" ref-type="bibr">23</xref>].</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007794.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007794.s003">
      <label>S2 Fig</label>
      <caption>
        <title>Scedar analysis of the scRNA-seq dataset containing 44,808 mouse retina cells generated by Drop-seq platform published by Macosko <italic>et al</italic>. [<xref rid="pcbi.1007794.ref024" ref-type="bibr">24</xref>].</title>
        <p>(<bold>A</bold>) t-SNE scatter plot with cell type labels. (<bold>B</bold>) Read count matrix heatmap with rows as cells, columns as genes, and black color as ≥ 1reads. (<bold>C</bold>) t-SNE scatter plot with MIRAC labels. (<bold>D</bold>) Pairwise cosine distance heatmap with left strip as MIRAC labels and upper strip as cell type labels. (<bold>E</bold>) t-SNE scatter plot after KNN gene dropout imputation with cell type labels. (<bold>F</bold>) pairwise cosine distance heatmap with left strip as MIRAC labels and upper strip as common or rare transcriptomic profile labels. (<bold>G</bold>) pairwise cosine distance heatmap with rare transcriptomic profiles removed.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007794.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007794.s004">
      <label>S3 Fig</label>
      <caption>
        <title>Scedar analysis of the scRNA-seq dataset containing 68,579 human peripheral blood mononuclear cells generated by 10x genomics GemCode platform published by Zheng <italic>et al</italic>. [<xref rid="pcbi.1007794.ref025" ref-type="bibr">25</xref>].</title>
        <p>(<bold>A</bold>) t-SNE scatter plot with cell type labels. (<bold>B</bold>) Read count matrix heatmap with rows as cells, columns as genes, and black color as ≥ 1 reads. (<bold>C</bold>) t-SNE scatter plot with MIRAC labels. (<bold>D</bold>) Pairwise cosine distance heatmap with left strip as MIRAC labels and upper strip as cell type labels. (<bold>E</bold>) t-SNE scatter plot after KNN gene dropout imputation with cell type labels. (<bold>F</bold>) Pairwise cosine distance heatmap with left strip as MIRAC labels and upper strip as common or rare transcriptomic profile labels. (<bold>G</bold>) Pairwise cosine distance heatmap with rare transcriptomic profiles removed.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007794.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007794.s005">
      <label>S4 Fig</label>
      <caption>
        <title>Scedar analysis of the scRNA-seq dataset containing 405,191 mouse cells from multiple tissues generated by Microwell-seq platform published by <italic>Han et al</italic>. [<xref rid="pcbi.1007794.ref026" ref-type="bibr">26</xref>].</title>
        <p>(<bold>A</bold>) UMAP scatter plot with cell type labels. (<bold>B</bold>) Read count matrix heatmap with rows as cells, columns as genes, and black color as ≥ 1 reads. (<bold>C</bold>) UMAP scatter plot with MIRAC labels. (<bold>D</bold>) Pairwise cosine distance heatmap of downsampled 7449 cells with left strip as MIRAC labels and upper strip as cell type labels. (<bold>E</bold>) UMAP scatter plot after KNN gene dropout imputation with cell type labels. (<bold>F</bold>) Pairwise cosine distance heatmap of downsampled 7449 cells with left strip as MIRAC labels and upper strip as common or rare transcriptomic profile labels. (<bold>G</bold>) Pairwise cosine distance heatmap of downsampled 7449 cells with rare transcriptomic profiles removed.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007794.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007794.s006">
      <label>S5 Fig</label>
      <caption>
        <title>Scedar analysis of the scRNA-seq dataset containing 2,058,652 mouse cells from multiple tissues generated by sci-RNA-seq3 platform published by <italic>Cao et al</italic>. [<xref rid="pcbi.1007794.ref027" ref-type="bibr">27</xref>].</title>
        <p>(<bold>A</bold>) UMAP scatter plot with cell type labels. (<bold>B</bold>) Read count matrix heatmap of downsampled 20,403 cells with rows as cells, columns as genes, and black color as ≥ 1 reads. (<bold>C</bold>) UMAP scatter plot with MIRAC labels. (<bold>D</bold>) Pairwise cosine distance heatmap of downsampled 20,118 cells with left strip as MIRAC labels and upper strip as cell type labels. (<bold>E</bold>) UMAP scatter plot after KNN gene dropout imputation with cell type labels. (<bold>F</bold>) Pairwise cosine distance heatmap of downsampled 20,118 cells with left strip as MIRAC labels and upper strip as common or rare transcriptomic profile labels. (<bold>G</bold>) Pairwise cosine distance heatmap of downsampled 20,118 cells with rare transcriptomic profiles removed.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007794.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007794.s007">
      <label>S6 Fig</label>
      <caption>
        <title>MIRAC and KNN rare transcriptomic profile detection results of experimental datasets.</title>
        <p>The sub-figures A, B, and C represent the results of scRNA-seq datasets published by Pollen <italic>et al</italic>. [<xref rid="pcbi.1007794.ref028" ref-type="bibr">28</xref>], Deng <italic>et al</italic>. [<xref rid="pcbi.1007794.ref029" ref-type="bibr">29</xref>], and Kolodziejczyk <italic>et al</italic>. [<xref rid="pcbi.1007794.ref030" ref-type="bibr">30</xref>] respectively. Within each sub-figure, the plots are 1) t-SNE scatter plot with cell type labels, 2) t-SNE scatter plot with MIRAC cluster labels, 3) pairwise cosine distance heatmap with left strip as MIRAC labels and upper strip as cell type labels, 4) t-SNE scatter plot with common or rare rare transcriptomic profile labels, 5) pairwise cosine distance heatmap with left strip as MIRAC labels and upper strip as common or rare transcriptomic profile labels, 6) pairwise cosine distance heatmap with rare transcriptomic profiles removed.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007794.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007794.s008">
      <label>S7 Fig</label>
      <caption>
        <title>Benchmark results of gene dropout imputation methods.</title>
        <p>(<bold>A</bold>) Runtimes on 40 simulated Drop-seq datasets. (<bold>B</bold>) ROC curves (± standard deviation) of dropout detection on simulated Drop-seq datasets. (<bold>C</bold>) and (<bold>D</bold>) are mean squared error (MSE) ratios of different methods on simulated Drop-seq and 10x Genomics datasets respectively, where the MSE ratio is computed as the MSE of corrected read counts / MSE of true read counts.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007794.s008.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007794.s009">
      <label>S8 Fig</label>
      <caption>
        <title>Runtimes of analytical methods implemented in scedar.</title>
        <p><bold>(A)</bold> KNN gene dropout imputation. <bold>(B)</bold> KNN rare transcriptomic profile detection. <bold>(C)</bold> Community clustering, community extended MIRAC clustering, Seurat clustering, and Scanpy clustering. These methods were all performed on experimentally generated scRNA-seq datasets with 3005, 44808, 68579, 405191, and 2058652 cells [<xref rid="pcbi.1007794.ref024" ref-type="bibr">24</xref>–<xref rid="pcbi.1007794.ref027" ref-type="bibr">27</xref>,<xref rid="pcbi.1007794.ref031" ref-type="bibr">31</xref>], except that Scanpy and Seurat were not able to cluster the mouse organogenesis cell atlas (MOCA) dataset that contain 2,058,652 single cells on a server with 1TB memory due to a mandatory conversion of the sparse read count matrix into dense matrix.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007794.s009.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007794.s010">
      <label>S9 Fig</label>
      <caption>
        <title>Runtimes of analytical methods implemented in scedar with different number of CPU cores for parallel computation.</title>
        <p><bold>(A)</bold> All implemented methods performed on an scRNA-seq dataset with 3005 single cells [<xref rid="pcbi.1007794.ref031" ref-type="bibr">31</xref>]. <bold>(B)</bold> KNN rare transcriptomic profile detection, <bold>(C)</bold> community clustering, and <bold>(D)</bold> community extended MIRAC clustering performed on two scRNA-seq datasets with 44,808 and 68,579 single cells [<xref rid="pcbi.1007794.ref024" ref-type="bibr">24</xref>,<xref rid="pcbi.1007794.ref025" ref-type="bibr">25</xref>].</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007794.s010.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007794.s011">
      <label>S10 Fig</label>
      <caption>
        <title>Skewed division of hierarchical agglomerative clustering tree.</title>
        <p>Tree leaves are samples, which are marked by upper case letters. Tree inner nodes are agglomerated samples by arbitrary linkage, which are marked by number. The triangle under inner node 0 represents an arbitrary valid subtree with <inline-formula id="pcbi.1007794.e039"><alternatives><graphic xlink:href="pcbi.1007794.e039.jpg" id="pcbi.1007794.e039g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M39"><mml:mo>≥</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> leaves. The root division procedure divides a tree into left and right subtrees of the root node. The skewing procedure creates a minimum subtree of the root with <inline-formula id="pcbi.1007794.e040"><alternatives><graphic xlink:href="pcbi.1007794.e040.jpg" id="pcbi.1007794.e040g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M40"><mml:mo>≥</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> leaves, where <inline-formula id="pcbi.1007794.e041"><alternatives><graphic xlink:href="pcbi.1007794.e041.jpg" id="pcbi.1007794.e041g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M41"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:math></alternatives></inline-formula> in this specific case.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007794.s011.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007794.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Svensson</surname><given-names>V</given-names></name>, <name><surname>Vento-Tormo</surname><given-names>R</given-names></name>, <name><surname>Teichmann</surname><given-names>SA</given-names></name>. <article-title>Exponential scaling of single-cell RNA-seq in the past decade</article-title>. <source>Nat Protoc</source>. <year>2018</year>;<volume>13</volume>: <fpage>599</fpage>–<lpage>604</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2017.149</pub-id><?supplied-pmid 29494575?><pub-id pub-id-type="pmid">29494575</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Filbin</surname><given-names>MG</given-names></name>, <name><surname>Tirosh</surname><given-names>I</given-names></name>, <name><surname>Hovestadt</surname><given-names>V</given-names></name>, <name><surname>Shaw</surname><given-names>ML</given-names></name>, <name><surname>Escalante</surname><given-names>LE</given-names></name>, <name><surname>Mathewson</surname><given-names>ND</given-names></name>, <etal>et al</etal><article-title>Developmental and oncogenic programs in H3K27M gliomas dissected by single-cell RNA-seq</article-title>. <source>Science</source>. <year>2018</year>;<volume>360</volume>: <fpage>331</fpage>–<lpage>335</lpage>. <pub-id pub-id-type="doi">10.1126/science.aao4750</pub-id><?supplied-pmid 29674595?><pub-id pub-id-type="pmid">29674595</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Cao</surname><given-names>J</given-names></name>, <name><surname>Packer</surname><given-names>JS</given-names></name>, <name><surname>Ramani</surname><given-names>V</given-names></name>, <name><surname>Cusanovich</surname><given-names>DA</given-names></name>, <name><surname>Huynh</surname><given-names>C</given-names></name>, <name><surname>Daza</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>Comprehensive single-cell transcriptional profiling of a multicellular organism</article-title>. <source>Science</source>. <year>2017</year>;<volume>357</volume>: <fpage>661</fpage>–<lpage>667</lpage>. <pub-id pub-id-type="doi">10.1126/science.aam8940</pub-id><?supplied-pmid 28818938?><pub-id pub-id-type="pmid">28818938</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Regev</surname><given-names>A</given-names></name>, <name><surname>Teichmann</surname><given-names>SA</given-names></name>, <name><surname>Lander</surname><given-names>ES</given-names></name>, <name><surname>Amit</surname><given-names>I</given-names></name>, <name><surname>Benoist</surname><given-names>C</given-names></name>, <name><surname>Birney</surname><given-names>E</given-names></name>, <etal>et al</etal><source>The Human Cell Atlas. Elife</source>. <year>2017</year>;<volume>6</volume><pub-id pub-id-type="doi">10.7554/eLife.27041</pub-id><?supplied-pmid 29206104?><pub-id pub-id-type="pmid">29206104</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Kiselev</surname><given-names>VY</given-names></name>, <name><surname>Andrews</surname><given-names>TS</given-names></name>, <name><surname>Hemberg</surname><given-names>M</given-names></name>. <article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>. <source>Nat Rev Genet</source>. <year>2019</year><pub-id pub-id-type="doi">10.1038/s41576-018-0088-9</pub-id><?supplied-pmid 30617341?><pub-id pub-id-type="pmid">30617341</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Dueck</surname><given-names>HR</given-names></name>, <name><surname>Ai</surname><given-names>R</given-names></name>, <name><surname>Camarena</surname><given-names>A</given-names></name>, <name><surname>Ding</surname><given-names>B</given-names></name>, <name><surname>Dominguez</surname><given-names>R</given-names></name>, <name><surname>Evgrafov</surname><given-names>OV</given-names></name>, <etal>et al</etal><article-title>Assessing characteristics of RNA amplification methods for single cell RNA sequencing</article-title>. <source>BMC Genomics</source>. <year>2016</year>;<volume>17</volume>: <fpage>377</fpage><pub-id pub-id-type="doi">10.1186/s12864-016-2735-x</pub-id><pub-id pub-id-type="pmid">27206480</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Ziegenhain</surname><given-names>C</given-names></name>, <name><surname>Vieth</surname><given-names>B</given-names></name>, <name><surname>Parekh</surname><given-names>S</given-names></name>, <name><surname>Reinius</surname><given-names>B</given-names></name>, <name><surname>Guillaumet-Adkins</surname><given-names>A</given-names></name>, <name><surname>Smets</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Comparative Analysis of Single-Cell RNA Sequencing Methods</article-title>. <source>Mol Cell</source>. <year>2017</year>;<volume>65</volume>: <fpage>631</fpage>–<lpage>643.e4</lpage>. <pub-id pub-id-type="doi">10.1016/j.molcel.2017.01.023</pub-id><?supplied-pmid 28212749?><pub-id pub-id-type="pmid">28212749</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Butler</surname><given-names>A</given-names></name>, <name><surname>Hoffman</surname><given-names>P</given-names></name>, <name><surname>Smibert</surname><given-names>P</given-names></name>, <name><surname>Papalexi</surname><given-names>E</given-names></name>, <name><surname>Satija</surname><given-names>R</given-names></name>. <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat Biotechnol</source>. <year>2018</year><pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id><?supplied-pmid 29608179?><pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Wolf</surname><given-names>FA</given-names></name>, <name><surname>Angerer</surname><given-names>P</given-names></name>, <name><surname>Theis</surname><given-names>FJ</given-names></name>. <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source>. <year>2018</year>;<volume>19</volume>: <fpage>15</fpage><pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id><?supplied-pmid 29409532?><pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Zaharia</surname><given-names>M</given-names></name>, <name><surname>Xin</surname><given-names>RS</given-names></name>, <name><surname>Wendell</surname><given-names>P</given-names></name>, <name><surname>Das</surname><given-names>T</given-names></name>, <name><surname>Armbrust</surname><given-names>M</given-names></name>, <name><surname>Dave</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Apache Spark: A Unified Engine for Big Data Processing</article-title>. <source>Commun ACM</source>. <year>2016</year>;<volume>59</volume>: <fpage>56</fpage>–<lpage>65</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Dean</surname><given-names>J</given-names></name>, <name><surname>Ghemawat</surname><given-names>S</given-names></name>. <article-title>MapReduce: simplified data processing on large clusters</article-title>. <source>Commun ACM</source>. <year>2008</year>;<volume>51</volume>: <fpage>107</fpage>–<lpage>113</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref012">
      <label>12</label>
      <mixed-citation publication-type="other">Abadi M, Barham P, Chen J, Chen Z, Davis A, Dean J, et al. Tensorflow: A system for large-scale machine learning. 12th USENIX Symposium on Operating Systems Design and Implementation (OSDI 16). <ext-link ext-link-type="uri" xlink:href="http://usenix.org">usenix.org</ext-link>; 2016. pp. 265–283.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Zappia</surname><given-names>L</given-names></name>, <name><surname>Phipson</surname><given-names>B</given-names></name>, <name><surname>Oshlack</surname><given-names>A</given-names></name>. <article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>. <year>2017</year>;<volume>18</volume>: <fpage>174</fpage><pub-id pub-id-type="doi">10.1186/s13059-017-1305-0</pub-id><?supplied-pmid 28899397?><pub-id pub-id-type="pmid">28899397</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Pollen</surname><given-names>AA</given-names></name>, <name><surname>Nowakowski</surname><given-names>TJ</given-names></name>, <name><surname>Shuga</surname><given-names>J</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Leyrat</surname><given-names>AA</given-names></name>, <name><surname>Lui</surname><given-names>JH</given-names></name>, <etal>et al</etal><article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title>. <source>Nat Biotechnol</source>. <year>2014</year>;<volume>32</volume>: <fpage>1053</fpage>–<lpage>1058</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2967</pub-id><?supplied-pmid 25086649?><pub-id pub-id-type="pmid">25086649</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Macosko</surname><given-names>EZ</given-names></name>, <name><surname>Basu</surname><given-names>A</given-names></name>, <name><surname>Satija</surname><given-names>R</given-names></name>, <name><surname>Nemesh</surname><given-names>J</given-names></name>, <name><surname>Shekhar</surname><given-names>K</given-names></name>, <name><surname>Goldman</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title>. <source>Cell</source>. <year>2015</year>;<volume>161</volume>: <fpage>1202</fpage>–<lpage>1214</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id><?supplied-pmid 26000488?><pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>GXY</given-names></name>, <name><surname>Terry</surname><given-names>JM</given-names></name>, <name><surname>Belgrader</surname><given-names>P</given-names></name>, <name><surname>Ryvkin</surname><given-names>P</given-names></name>, <name><surname>Bent</surname><given-names>ZW</given-names></name>, <name><surname>Wilson</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source>. <year>2017</year>;<volume>8</volume>: <fpage>14049</fpage><pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id><?supplied-pmid 28091601?><pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Zappia</surname><given-names>L</given-names></name>, <name><surname>Phipson</surname><given-names>B</given-names></name>, <name><surname>Oshlack</surname><given-names>A</given-names></name>. <article-title>Exploring the single-cell RNA-seq analysis landscape with the scRNA-tools database</article-title>. <source>PLoS Comput Biol</source>. <year>2018</year>;<volume>14</volume>: <fpage>e1006245</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006245</pub-id><?supplied-pmid 29939984?><pub-id pub-id-type="pmid">29939984</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref018">
      <label>18</label>
      <mixed-citation publication-type="other">Chen T, Guestrin C. XGBoost: A Scalable Tree Boosting System. Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining—KDD ‘16. New York, New York, USA: ACM Press; 2016. pp. 785–794.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Maaten</surname><given-names>L van der</given-names></name>, <name><surname>Hinton</surname><given-names>G</given-names></name>. <article-title>Visualizing Data using t-SNE</article-title>. <source>J Mach Learn Res</source>. <year>2008</year>;<volume>9</volume>: <fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref020">
      <label>20</label>
      <mixed-citation publication-type="other">McInnes L, Healy J. UMAP: Uniform Manifold Approximation and Projection for Dimension Reduction. arXiv [stat.ML]. 2018. Available: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1802.03426">http://arxiv.org/abs/1802.03426</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Jacomy</surname><given-names>M</given-names></name>, <name><surname>Venturini</surname><given-names>T</given-names></name>, <name><surname>Heymann</surname><given-names>S</given-names></name>, <name><surname>Bastian</surname><given-names>M</given-names></name>. <article-title>ForceAtlas2, a continuous graph layout algorithm for handy network visualization designed for the Gephi software</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>: <fpage>e98679</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0098679</pub-id><?supplied-pmid 24914678?><pub-id pub-id-type="pmid">24914678</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Hicks</surname><given-names>SC</given-names></name>, <name><surname>Irizarry</surname><given-names>RA</given-names></name>. <article-title>quantro: a data-driven approach to guide the choice of an appropriate normalization method</article-title>. <source>Genome Biol</source>. <year>2015</year>;<volume>16</volume>: <fpage>117</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0679-0</pub-id><?supplied-pmid 26040460?><pub-id pub-id-type="pmid">26040460</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref023">
      <label>23</label>
      <mixed-citation publication-type="other">Müllner D. Modern hierarchical, agglomerative clustering algorithms. arXiv [stat.ML]. 2011. Available: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1109.2378">http://arxiv.org/abs/1109.2378</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Bar-Joseph</surname><given-names>Z</given-names></name>, <name><surname>Gifford</surname><given-names>DK</given-names></name>, <name><surname>Jaakkola</surname><given-names>TS</given-names></name>. <article-title>Fast optimal leaf ordering for hierarchical clustering</article-title>. <source>Bioinformatics</source>. <year>2001</year>;<volume>17</volume><issue>Suppl 1</issue>: <fpage>S22</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">11472989</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Hansen</surname><given-names>MH</given-names></name>, <name><surname>Yu</surname><given-names>B</given-names></name>. <article-title>Model Selection and the Principle of Minimum Description Length</article-title>. <source>J Am Stat Assoc</source>. <year>2001</year>;<volume>96</volume>: <fpage>746</fpage>–<lpage>774</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref026">
      <label>26</label>
      <mixed-citation publication-type="book"><name><surname>Wilf</surname><given-names>HS</given-names></name>. <source>generatingfunctionology</source>. <publisher-name>AK Peters/CRC Press</publisher-name>; <year>2005</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Abramson</surname><given-names>M</given-names></name>. <article-title>Restricted combinations and compositions</article-title>. <source>Fibonacci Quart</source>. <year>1976</year>;<volume>14</volume>: <fpage>439</fpage>–<lpage>452</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref028">
      <label>28</label>
      <mixed-citation publication-type="other">Aydin K, Bateni M, Mirrokni V. Distributed Balanced Partitioning via Linear Embedding. Proceedings of the Ninth ACM International Conference on Web Search and Data Mining. New York, NY, USA: ACM; 2016. pp. 387–396.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Traag</surname><given-names>VA</given-names></name>, <name><surname>Waltman</surname><given-names>L</given-names></name>, <name><surname>van Eck</surname><given-names>NJ</given-names></name>. <article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>. <source>Sci Rep</source>. <year>2019</year>;<volume>9</volume>: <fpage>5233</fpage><pub-id pub-id-type="doi">10.1038/s41598-019-41695-z</pub-id><?supplied-pmid 30914743?><pub-id pub-id-type="pmid">30914743</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref030">
      <label>30</label>
      <mixed-citation publication-type="other">Malkov YA, Yashunin DA. Efficient and robust approximate nearest neighbor search using Hierarchical Navigable Small World graphs. arXiv [cs.DS]. 2016. Available: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1603.09320">http://arxiv.org/abs/1603.09320</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Vallejos</surname><given-names>CA</given-names></name>, <name><surname>Marioni</surname><given-names>JC</given-names></name>, <name><surname>Richardson</surname><given-names>S</given-names></name>. <article-title>BASiCS: Bayesian Analysis of Single-Cell Sequencing Data</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>: <fpage>e1004333</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004333</pub-id><?supplied-pmid 26107944?><pub-id pub-id-type="pmid">26107944</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Kharchenko</surname><given-names>PV</given-names></name>, <name><surname>Silberstein</surname><given-names>L</given-names></name>, <name><surname>Scadden</surname><given-names>DT</given-names></name>. <article-title>Bayesian approach to single-cell differential expression analysis</article-title>. <source>Nat Methods</source>. <year>2014</year>;<volume>11</volume>: <fpage>740</fpage>–<lpage>742</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2967</pub-id><?supplied-pmid 24836921?><pub-id pub-id-type="pmid">24836921</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Qiu</surname><given-names>X</given-names></name>, <name><surname>Hill</surname><given-names>A</given-names></name>, <name><surname>Packer</surname><given-names>J</given-names></name>, <name><surname>Lin</surname><given-names>D</given-names></name>, <name><surname>Ma</surname><given-names>Y-A</given-names></name>, <name><surname>Trapnell</surname><given-names>C</given-names></name>. <article-title>Single-cell mRNA quantification and differential analysis with Census</article-title>. <source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>: <fpage>309</fpage>–<lpage>315</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4150</pub-id><?supplied-pmid 28114287?><pub-id pub-id-type="pmid">28114287</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Soneson</surname><given-names>C</given-names></name>, <name><surname>Robinson</surname><given-names>MD</given-names></name>. <article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title>. <source>Nat Methods</source>. <year>2018</year>;<volume>15</volume>: <fpage>255</fpage>–<lpage>261</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4612</pub-id><?supplied-pmid 29481549?><pub-id pub-id-type="pmid">29481549</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Korthauer</surname><given-names>KD</given-names></name>, <name><surname>Chu</surname><given-names>L-F</given-names></name>, <name><surname>Newton</surname><given-names>MA</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Thomson</surname><given-names>J</given-names></name>, <name><surname>Stewart</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>A statistical approach for identifying differential distributions in single-cell RNA-seq experiments</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>: <fpage>222</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-1077-y</pub-id><?supplied-pmid 27782827?><pub-id pub-id-type="pmid">27782827</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Aevermann</surname><given-names>BD</given-names></name>, <name><surname>Novotny</surname><given-names>M</given-names></name>, <name><surname>Bakken</surname><given-names>T</given-names></name>, <name><surname>Miller</surname><given-names>JA</given-names></name>, <name><surname>Diehl</surname><given-names>AD</given-names></name>, <name><surname>Osumi-Sutherland</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Cell type discovery using single-cell transcriptomics: implications for ontological representation</article-title>. <source>Hum Mol Genet</source>. <year>2018</year>;<volume>27</volume>: <fpage>R40</fpage>–<lpage>R47</lpage>. <pub-id pub-id-type="doi">10.1093/hmg/ddy100</pub-id><?supplied-pmid 29590361?><pub-id pub-id-type="pmid">29590361</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Breiman</surname><given-names>L</given-names></name>. <article-title>Random Forests</article-title>. <source>Mach Learn</source>. <year>2001</year>;<volume>45</volume>: <fpage>5</fpage>–<lpage>32</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Pedregosa</surname><given-names>F</given-names></name>, <name><surname>Varoquaux</surname><given-names>G</given-names></name>, <name><surname>Gramfort</surname><given-names>A</given-names></name>, <name><surname>Michel</surname><given-names>V</given-names></name>, <name><surname>Thirion</surname><given-names>B</given-names></name>, <name><surname>Grisel</surname><given-names>O</given-names></name>, <etal>et al</etal><article-title>Scikit-learn: Machine Learning in Python</article-title>. <source>J Mach Learn Res</source>. <year>2011</year>;<volume>12</volume>: <fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Cover</surname><given-names>T</given-names></name>, <name><surname>Hart</surname><given-names>P</given-names></name>. <article-title>Nearest Neighbor Pattern Classification</article-title>. <source>IEEE Trans Inf Theory</source>. <year>2006</year>;<volume>13</volume>: <fpage>21</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Bezdek</surname><given-names>JC</given-names></name>, <name><surname>Chuah</surname><given-names>SK</given-names></name>, <name><surname>Leep</surname><given-names>D</given-names></name>. <article-title>Generalized k-nearest neighbor rules</article-title>. <source>Fuzzy Sets and Systems</source>. <year>1986</year>;<volume>18</volume>: <fpage>237</fpage>–<lpage>256</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref041">
      <label>41</label>
      <mixed-citation publication-type="other">Bellet A, Habrard A, Sebban M. A Survey on Metric Learning for Feature Vectors and Structured Data. arXiv [cs.LG]. 2013. Available: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1306.6709">http://arxiv.org/abs/1306.6709</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Risso</surname><given-names>D</given-names></name>, <name><surname>Perraudeau</surname><given-names>F</given-names></name>, <name><surname>Gribkova</surname><given-names>S</given-names></name>, <name><surname>Dudoit</surname><given-names>S</given-names></name>, <name><surname>Vert</surname><given-names>J-P</given-names></name>. <article-title>A general and flexible method for signal extraction from single-cell RNA-seq data</article-title>. <source>Nat Commun</source>. <year>2018</year>;<volume>9</volume>: <fpage>284</fpage><pub-id pub-id-type="doi">10.1038/s41467-017-02554-5</pub-id><?supplied-pmid 29348443?><pub-id pub-id-type="pmid">29348443</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Pierson</surname><given-names>E</given-names></name>, <name><surname>Yau</surname><given-names>C</given-names></name>. <article-title>ZIFA: Dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title>. <source>Genome Biol</source>. <year>2015</year>;<volume>16</volume>: <fpage>618</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Suter</surname><given-names>DM</given-names></name>, <name><surname>Molina</surname><given-names>N</given-names></name>, <name><surname>Gatfield</surname><given-names>D</given-names></name>, <name><surname>Schneider</surname><given-names>K</given-names></name>, <name><surname>Schibler</surname><given-names>U</given-names></name>, <name><surname>Naef</surname><given-names>F</given-names></name>. <article-title>Mammalian genes are transcribed with widely different bursting kinetics</article-title>. <source>Science</source>. <year>2011</year>;<volume>332</volume>: <fpage>472</fpage>–<lpage>474</lpage>. <pub-id pub-id-type="doi">10.1126/science.1198817</pub-id><?supplied-pmid 21415320?><pub-id pub-id-type="pmid">21415320</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Tantale</surname><given-names>K</given-names></name>, <name><surname>Mueller</surname><given-names>F</given-names></name>, <name><surname>Kozulic-Pirher</surname><given-names>A</given-names></name>, <name><surname>Lesne</surname><given-names>A</given-names></name>, <name><surname>Victor</surname><given-names>J-M</given-names></name>, <name><surname>Robert</surname><given-names>M-C</given-names></name>, <etal>et al</etal><article-title>A single-molecule view of transcription reveals convoys of RNA polymerases and multi-scale bursting</article-title>. <source>Nat Commun</source>. <year>2016</year>;<volume>7</volume>: <fpage>12248</fpage><pub-id pub-id-type="doi">10.1038/ncomms12248</pub-id><?supplied-pmid 27461529?><pub-id pub-id-type="pmid">27461529</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Kiselev</surname><given-names>VY</given-names></name>, <name><surname>Kirschner</surname><given-names>K</given-names></name>, <name><surname>Schaub</surname><given-names>MT</given-names></name>, <name><surname>Andrews</surname><given-names>T</given-names></name>, <name><surname>Yiu</surname><given-names>A</given-names></name>, <name><surname>Chandra</surname><given-names>T</given-names></name>, <etal>et al</etal><article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>: <fpage>483</fpage>–<lpage>486</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id><?supplied-pmid 28346451?><pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Ester</surname><given-names>M</given-names></name>, <name><surname>Kriegel</surname><given-names>H-P</given-names></name>, <name><surname>Sander</surname><given-names>J</given-names></name>, <name><surname>Xu</surname><given-names>X</given-names></name>. <article-title>A density-based algorithm for discovering clusters in large spatial databases with noise</article-title>. <source>Kdd</source>. <year>1996</year> pp. <fpage>226</fpage>–<lpage>231</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref048">
      <label>48</label>
      <mixed-citation publication-type="book"><name><surname>Aggarwal</surname><given-names>CC</given-names></name>, <name><surname>Hinneburg</surname><given-names>A</given-names></name>, <name><surname>Keim</surname><given-names>DA</given-names></name>. <chapter-title>On the Surprising Behavior of Distance Metrics in High Dimensional Space</chapter-title><source>Database Theory—ICDT 2001</source>. <publisher-name>Springer</publisher-name><publisher-loc>Berlin Heidelberg</publisher-loc>; <year>2001</year> pp. <fpage>420</fpage>–<lpage>434</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Linderman</surname><given-names>GC</given-names></name>, <name><surname>Steinerberger</surname><given-names>S</given-names></name>. <article-title>Clustering with t-SNE, Provably</article-title>. <source>SIAM Journal on Mathematics of Data Science</source>. <year>2019</year>;<volume>1</volume>: <fpage>313</fpage>–<lpage>332</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Hubert</surname><given-names>L</given-names></name>, <name><surname>Arabie</surname><given-names>P</given-names></name>. <article-title>Comparing partitions</article-title>. <source>J Classification</source>. <year>1985</year>;<volume>2</volume>: <fpage>193</fpage>–<lpage>218</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Deng</surname><given-names>Q</given-names></name>, <name><surname>Ramsköld</surname><given-names>D</given-names></name>, <name><surname>Reinius</surname><given-names>B</given-names></name>, <name><surname>Sandberg</surname><given-names>R</given-names></name>. <article-title>Single-cell RNA-seq reveals dynamic, random monoallelic gene expression in mammalian cells</article-title>. <source>Science</source>. <year>2014</year>;<volume>343</volume>: <fpage>193</fpage>–<lpage>196</lpage>. <pub-id pub-id-type="doi">10.1126/science.1245316</pub-id><?supplied-pmid 24408435?><pub-id pub-id-type="pmid">24408435</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Kolodziejczyk</surname><given-names>AA</given-names></name>, <name><surname>Kim</surname><given-names>JK</given-names></name>, <name><surname>Tsang</surname><given-names>JCH</given-names></name>, <name><surname>Ilicic</surname><given-names>T</given-names></name>, <name><surname>Henriksson</surname><given-names>J</given-names></name>, <name><surname>Natarajan</surname><given-names>KN</given-names></name>, <etal>et al</etal><article-title>Single Cell RNA-Sequencing of Pluripotent States Unlocks Modular Transcriptional Variation</article-title>. <source>Cell Stem Cell</source>. <year>2015</year>;<volume>17</volume>: <fpage>471</fpage>–<lpage>485</lpage>. <pub-id pub-id-type="doi">10.1016/j.stem.2015.09.011</pub-id><?supplied-pmid 26431182?><pub-id pub-id-type="pmid">26431182</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Zeisel</surname><given-names>A</given-names></name>, <name><surname>Muñoz-Manchado</surname><given-names>AB</given-names></name>, <name><surname>Codeluppi</surname><given-names>S</given-names></name>, <name><surname>Lönnerberg</surname><given-names>P</given-names></name>, <name><surname>La Manno</surname><given-names>G</given-names></name>, <name><surname>Juréus</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Brain structure. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source>Science</source>. <year>2015</year>;<volume>347</volume>: <fpage>1138</fpage>–<lpage>1142</lpage>. <pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id><?supplied-pmid 25700174?><pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>M</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Torre</surname><given-names>E</given-names></name>, <name><surname>Dueck</surname><given-names>H</given-names></name>, <name><surname>Shaffer</surname><given-names>S</given-names></name>, <name><surname>Bonasio</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>SAVER: gene expression recovery for single-cell RNA sequencing</article-title>. <source>Nat Methods</source>. <year>2018</year>; <volume>1</volume>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>van Dijk</surname><given-names>D</given-names></name>, <name><surname>Sharma</surname><given-names>R</given-names></name>, <name><surname>Nainys</surname><given-names>J</given-names></name>, <name><surname>Yim</surname><given-names>K</given-names></name>, <name><surname>Kathail</surname><given-names>P</given-names></name>, <name><surname>Carr</surname><given-names>AJ</given-names></name>, <etal>et al</etal><article-title>Recovering Gene Interactions from Single-Cell Data Using Data Diffusion</article-title>. <source>Cell</source>. <year>2018</year><pub-id pub-id-type="doi">10.1016/j.cell.2018.05.061</pub-id><?supplied-pmid 29961576?><pub-id pub-id-type="pmid">29961576</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>WV</given-names></name>, <name><surname>Li</surname><given-names>JJ</given-names></name>. <article-title>scImpute: Accurate And Robust Imputation For Single Cell RNA-Seq Data</article-title>. <source>bioRxiv</source>. <year>2017</year> p. <fpage>141598</fpage>
<pub-id pub-id-type="doi">10.1101/141598</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref057">
      <label>57</label>
      <mixed-citation publication-type="other">Xianyi Z, Qian W, Yunquan Z. Model-driven Level 3 BLAS Performance Optimization on Loongson 3A Processor. 2012 IEEE 18th International Conference on Parallel and Distributed Systems. 2012. pp. 684–691.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref058">
      <label>58</label>
      <mixed-citation publication-type="other">Wang Q, Zhang X, Zhang Y, Yi Q. AUGEM: Automatically generate high performance Dense Linear Algebra kernels on x86 CPUs. SC ‘13: Proceedings of the International Conference on High Performance Computing, Networking, Storage and Analysis. 2013. pp. 1–12.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Cao</surname><given-names>J</given-names></name>, <name><surname>Spielmann</surname><given-names>M</given-names></name>, <name><surname>Qiu</surname><given-names>X</given-names></name>, <name><surname>Huang</surname><given-names>X</given-names></name>, <name><surname>Ibrahim</surname><given-names>DM</given-names></name>, <name><surname>Hill</surname><given-names>AJ</given-names></name>, <etal>et al</etal><article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title>. <source>Nature</source>. <year>2019</year>; <volume>1</volume>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Beutner</surname><given-names>C</given-names></name>, <name><surname>Linnartz-Gerlach</surname><given-names>B</given-names></name>, <name><surname>Schmidt</surname><given-names>SV</given-names></name>, <name><surname>Beyer</surname><given-names>M</given-names></name>, <name><surname>Mallmann</surname><given-names>MR</given-names></name>, <name><surname>Staratschek-Jox</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Unique transcriptome signature of mouse microglia</article-title>. <source>Glia</source>. <year>2013</year>;<volume>61</volume>: <fpage>1429</fpage>–<lpage>1442</lpage>. <pub-id pub-id-type="doi">10.1002/glia.22524</pub-id><?supplied-pmid 23832717?><pub-id pub-id-type="pmid">23832717</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Villani</surname><given-names>A-C</given-names></name>, <name><surname>Satija</surname><given-names>R</given-names></name>, <name><surname>Reynolds</surname><given-names>G</given-names></name>, <name><surname>Sarkizova</surname><given-names>S</given-names></name>, <name><surname>Shekhar</surname><given-names>K</given-names></name>, <name><surname>Fletcher</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>. <source>Science</source>. <year>2017</year>;<volume>356</volume>: <fpage>eaah4573</fpage><pub-id pub-id-type="doi">10.1126/science.aah4573</pub-id><?supplied-pmid 28428369?><pub-id pub-id-type="pmid">28428369</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Baslan</surname><given-names>T</given-names></name>, <name><surname>Hicks</surname><given-names>J</given-names></name>. <article-title>Unravelling biology and shifting paradigms in cancer with single-cell sequencing</article-title>. <source>Nat Rev Cancer</source>. <year>2017</year>;<volume>17</volume>: <fpage>557</fpage>–<lpage>569</lpage>. <pub-id pub-id-type="doi">10.1038/nrc.2017.58</pub-id><?supplied-pmid 28835719?><pub-id pub-id-type="pmid">28835719</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Rizvi</surname><given-names>AH</given-names></name>, <name><surname>Camara</surname><given-names>PG</given-names></name>, <name><surname>Kandror</surname><given-names>EK</given-names></name>, <name><surname>Roberts</surname><given-names>TJ</given-names></name>, <name><surname>Schieren</surname><given-names>I</given-names></name>, <name><surname>Maniatis</surname><given-names>T</given-names></name>, <etal>et al</etal><article-title>Single-cell topological RNA-seq analysis reveals insights into cellular differentiation and development</article-title>. <source>Nat Biotechnol</source>. <year>2017</year>;<volume>35</volume>: <fpage>551</fpage>–<lpage>560</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.3854</pub-id><?supplied-pmid 28459448?><pub-id pub-id-type="pmid">28459448</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Schiebinger</surname><given-names>G</given-names></name>, <name><surname>Shu</surname><given-names>J</given-names></name>, <name><surname>Tabaka</surname><given-names>M</given-names></name>, <name><surname>Cleary</surname><given-names>B</given-names></name>, <name><surname>Subramanian</surname><given-names>V</given-names></name>, <name><surname>Solomon</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Optimal-Transport Analysis of Single-Cell Gene Expression Identifies Developmental Trajectories in Reprogramming</article-title>. <source>Cell</source>. <year>2019</year>;<volume>176</volume>: <fpage>1517</fpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.02.026</pub-id><?supplied-pmid 30849376?><pub-id pub-id-type="pmid">30849376</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Lake</surname><given-names>BB</given-names></name>, <name><surname>Chen</surname><given-names>S</given-names></name>, <name><surname>Sos</surname><given-names>BC</given-names></name>, <name><surname>Fan</surname><given-names>J</given-names></name>, <name><surname>Kaeser</surname><given-names>GE</given-names></name>, <name><surname>Yung</surname><given-names>YC</given-names></name>, <etal>et al</etal><article-title>Integrative single-cell analysis of transcriptional and epigenetic states in the human adult brain</article-title>. <source>Nat Biotechnol</source>. <year>2018</year>;<volume>36</volume>: <fpage>70</fpage>–<lpage>80</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.4038</pub-id><?supplied-pmid 29227469?><pub-id pub-id-type="pmid">29227469</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Haber</surname><given-names>AL</given-names></name>, <name><surname>Biton</surname><given-names>M</given-names></name>, <name><surname>Rogel</surname><given-names>N</given-names></name>, <name><surname>Herbst</surname><given-names>RH</given-names></name>, <name><surname>Shekhar</surname><given-names>K</given-names></name>, <name><surname>Smillie</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>A single-cell survey of the small intestinal epithelium</article-title>. <source>Nature</source>. <year>2017</year>;<volume>551</volume>: <fpage>333</fpage>–<lpage>339</lpage>. <pub-id pub-id-type="doi">10.1038/nature24489</pub-id><?supplied-pmid 29144463?><pub-id pub-id-type="pmid">29144463</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref067">
      <label>67</label>
      <mixed-citation publication-type="journal"><name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></name>, <name><surname>Stubbington</surname><given-names>MJT</given-names></name>, <name><surname>Regev</surname><given-names>A</given-names></name>, <name><surname>Teichmann</surname><given-names>SA</given-names></name>. <article-title>The Human Cell Atlas: from vision to reality</article-title>. <source>Nature</source>. <year>2017</year>;<volume>550</volume>: <fpage>451</fpage>–<lpage>453</lpage>. <pub-id pub-id-type="doi">10.1038/550451a</pub-id><?supplied-pmid 29072289?><pub-id pub-id-type="pmid">29072289</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Fan</surname><given-names>J</given-names></name>, <name><surname>Salathia</surname><given-names>N</given-names></name>, <name><surname>Liu</surname><given-names>R</given-names></name>, <name><surname>Kaeser</surname><given-names>GE</given-names></name>, <name><surname>Yung</surname><given-names>YC</given-names></name>, <name><surname>Herman</surname><given-names>JL</given-names></name>, <etal>et al</etal><article-title>Characterizing transcriptional heterogeneity through pathway and gene set overdispersion analysis</article-title>. <source>Nat Methods</source>. <year>2016</year>;<volume>13</volume>: <fpage>241</fpage>–<lpage>244</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3734</pub-id><?supplied-pmid 26780092?><pub-id pub-id-type="pmid">26780092</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>T</given-names></name>, <name><surname>Ramakrishnan</surname><given-names>R</given-names></name>, <name><surname>Livny</surname><given-names>M</given-names></name>. <article-title>BIRCH: an efficient data clustering method for very large databases</article-title>. <source>ACM Sigmod Record</source>. <year>1996</year> Available: <ext-link ext-link-type="uri" xlink:href="https://dl.acm.org/citation.cfm?id=233324">https://dl.acm.org/citation.cfm?id=233324</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1007794.ref070">
      <label>70</label>
      <mixed-citation publication-type="journal"><name><surname>Kanehisa</surname><given-names>M</given-names></name>, <name><surname>Sato</surname><given-names>Y</given-names></name>, <name><surname>Kawashima</surname><given-names>M</given-names></name>, <name><surname>Furumichi</surname><given-names>M</given-names></name>, <name><surname>Tanabe</surname><given-names>M</given-names></name>. <article-title>KEGG as a reference resource for gene and protein annotation</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>: <fpage>D457</fpage>–<lpage>62</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkv1070</pub-id><?supplied-pmid 26476454?><pub-id pub-id-type="pmid">26476454</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
