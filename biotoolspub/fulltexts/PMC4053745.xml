<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1465-6906</issn>
    <issn pub-type="epub">1465-6914</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4053745</article-id>
    <article-id pub-id-type="publisher-id">gb-2012-13-8-r77</article-id>
    <article-id pub-id-type="pmid">22937822</article-id>
    <article-id pub-id-type="doi">10.1186/gb-2012-13-8-r77</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ggbio: an R package for extending the grammar of graphics for genomic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Yin</surname>
          <given-names>Tengfei</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>tengfei@iastate.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Cook</surname>
          <given-names>Dianne</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>dicook@iastate.edu</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A3">
        <name>
          <surname>Lawrence</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>lawrence.michael@gene.com</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Genetics, Development and Cell Biology, Iowa State University, Ames,
IA 50011, USA</aff>
    <aff id="I2"><label>2</label>Department of Statistics, Iowa State University, Ames, IA 50011, USA</aff>
    <aff id="I3"><label>3</label>Department of Bioinformatics, Genentech, 1 Dna Way South San Francisco, CA 94080,
USA</aff>
    <pub-date pub-type="ppub">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>31</day>
      <month>8</month>
      <year>2012</year>
    </pub-date>
    <volume>13</volume>
    <issue>8</issue>
    <fpage>R77</fpage>
    <lpage>R77</lpage>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>6</month>
        <year>2012</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>7</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>8</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright Â© 2012 Yin et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Yin et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an open access article distributed under the terms of the Creative Commons
Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which
permits unrestricted use, distribution, and reproduction in any medium, provided the
original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://genomebiology.com/content/13/8/R77"/>
    <abstract>
      <p>We introduce ggbio, a new methodology to visualize and explore genomics annotations
and high-throughput data. The plots provide detailed views of genomic regions,
summary views of sequence alignments and splicing patterns, and genome-wide overviews
with karyogram, circular and grand linear layouts. The methods leverage the
statistical functionality available in R, the grammar of graphics and the data
handling capabilities of the Bioconductor project. The plots are specified within a
modular framework that enables users to construct plots in a systematic way, and are
generated directly from Bioconductor data structures. The ggbio R package is
available at
<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/2.11/bioc/html/ggbio.html">http://www.bioconductor.org/packages/2.11/bioc/html/ggbio.html</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Rationale</title>
    <p>Visualization is an important component of genomic analysis, primarily because it
facilitates exploration and discovery, by revealing patterns of variation and
relationships between experimental data sets and annotations. Data on the genome fall
into two classes: annotations, such as gene models, and experimental measurements, such
as alignments of high-throughput sequencing data. The unique and unifying trait of all
genomic data is that they occupy ranges on the genome. Associated with the ranges is
usually multivariate meta-information both at the feature level, such as a score or
functional annotation, and at the sample level, such as gender, treatment, cancer or
cell type. These data ranges can range in scale from hundreds to billions of data
points, and the features are dispersed along genomes that might be many gigabases in
length. Visualization tools need to slice and dice and summarize the data in different
ways to expose its different aspects and to focus on different resolutions, from a
sensible overview of the whole genome, to detailed information on a per base scale. To
help focus attention on interesting features, statistical summaries need to be viewed in
conjunction with displays of raw data and annotations.</p>
    <p>Various visualization tools have been developed, most of which are implemented in the
form of a genome browser. Data are typically plotted along with annotations with genomic
coordinates on the horizontal axis with other information laid out in different panels
called tracks. Examples of genome browsers include the desktop-based browsers Integrated
Genome Browser [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>] and Integrative Genomics Viewer [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>]. There are also web-based genome browsers, including Ensembl [<xref ref-type="bibr" rid="B5">5</xref>], UCSC Genome Browser [<xref ref-type="bibr" rid="B6">6</xref>], and GBrowse [<xref ref-type="bibr" rid="B7">7</xref>], and several new web-based browsers, like Dalliance, which rely on
technologies like HTML5 and Scalable Vector Graphics [<xref ref-type="bibr" rid="B8">8</xref>], or Adobe Flash, like DNAnexus [<xref ref-type="bibr" rid="B9">9</xref>]. Other software, like Circos [<xref ref-type="bibr" rid="B10">10</xref>], provide specialist functionality. R also has some new tools for visualizing
genomic data, GenomeGraphs [<xref ref-type="bibr" rid="B11">11</xref>] and Gviz [<xref ref-type="bibr" rid="B12">12</xref>]. They all have advantages for different purposes: some are fast, while others
have easier user interfaces. Some are interactive, offer cross-platform support or
support more file formats.</p>
    <p>Data graphics benefit from being embedded in a statistical analysis environment, which
allows the integration of visualizations with analysis workflows. This integration is
made cohesive through the sharing of common data models [<xref ref-type="bibr" rid="B13">13</xref>]. In addition, recent work on a grammar of data graphics [<xref ref-type="bibr" rid="B14">14</xref>,<xref ref-type="bibr" rid="B15">15</xref>] could be extended for biological data. The grammar of graphics is based on
modular components that when combined in different ways will produce different graphics.
This enables the user to construct a combinatoric number of plots, including those that
were not preconceived by the implementation of the grammar. Most existing tools lack
these capabilities.</p>
    <p>A new R package, ggbio, has been developed and is available on Bioconductor [<xref ref-type="bibr" rid="B16">16</xref>]. The package provides the tools to create both typical and non-typical
biological plots for genomic data, generated from core Bioconductor data structures by
either the high-level autoplot function, or the combination of low-level components of
the grammar of graphics. Sharing data structures with the rest of Bioconductor enables
direct integration with Bioconductor workflows.</p>
  </sec>
  <sec>
    <title>Basic usage</title>
    <p>In ggbio, most of the functionality is available through a single command, autoplot,
which recognizes the data structure and makes a best guess of the appropriate plot.
Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> Table S1 lists the type of plot produced for
each type of data structure. The plot in Figure <xref ref-type="fig" rid="F1">1</xref> was rendered
with the autoplot function in ggbio, using the following code:</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>Gene structure</bold>. Example of exons of gene <italic>SSX4 </italic>and <italic>SSX4B
</italic>isoforms, annotated to illustrate the grammar of graphics extensions used.
The filled rectangle represents exons and the chevron represents introns. They are
grouped by transcript ID and the y axis shows the stepping levels, which stacks
transcripts to avoid overplotting. Color is mapped from strand direction.</p>
      </caption>
      <graphic xlink:href="gb-2012-13-8-r77-1"/>
    </fig>
    <p>
      <disp-formula>
        <mml:math id="M1" name="gb-2012-13-8-r77-i1" overflow="scroll">
          <mml:mrow>
            <mml:mstyle class="text">
              <mml:mtext class="textsf" mathvariant="sans-serif">autoplot</mml:mtext>
            </mml:mstyle>
            <mml:mrow>
              <mml:mo class="MathClass-open">(</mml:mo>
              <mml:mrow>
                <mml:mstyle class="text">
                  <mml:mtext class="textsf" mathvariant="sans-serif">grl</mml:mtext>
                </mml:mstyle>
                <mml:mo class="MathClass-punc">,</mml:mo>
                <mml:mstyle class="text">
                  <mml:mtext class="textsf" mathvariant="sans-serif">aes</mml:mtext>
                </mml:mstyle>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif">color</mml:mtext>
                    </mml:mstyle>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif">strand</mml:mtext>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo class="MathClass-close">)</mml:mo>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>The data, grl, is a GRangesList object, a Bioconductor data structure for representing
compound ranges, including a set of transcript structures. The autoplot function
recognizes the GRangesList object and draws the intervals in the typical fashion for a
gene model or alignment. The y axis is generated by a layout algorithm to ensure that
the transcripts are not overplotted. The x axis is automatically set as the genomic
coordinates. The call to aes maps the strand variable to the color aesthetic. Users can
specify labels, titles, layout, and so on by passing additional arguments to autoplot.
Compared to the more general qplot API of ggplot2, autoplot facilitates the creation of
specialized biological graphics and reacts to the specific class of object passed to it.
Each type of object has a specific set of relevant graphical parameters, and further
customization is possible through the low-level API, introduced later.</p>
  </sec>
  <sec>
    <title>Plotting tracks</title>
    <p>In many genome visualizations, different datasets are typically plotted separately and
then stacked on top of the same x axis, the genomic coordinates. These plots are often
called tracks, because they are usually much wider than they are tall and run parallel
to each other. Each track might contain a heatmap, or a histogram, or a density plot,
for example. The data displayed in each track is related to the data displayed in the
other tracks through the shared genomic axis. The goal is to be able to observe
different patterns in these snapshots for regions of the genome. When displaying a
relatively large region, the tracks might show a summary of the data, whereas more
details are depicted for smaller regions.</p>
    <p>The ggbio package provides a function called tracks, which stacks plots in a specified
order and creates a Tracks object. The object allows users to zoom and shift the plot,
as well as modify parameters like the height and theme of individual tracks. In the
following example, p1, p2 and p3 are plot objects in the session:</p>
    <p>
      <disp-formula>
        <mml:math id="M2" name="gb-2012-13-8-r77-i2" overflow="scroll">
          <mml:mrow>
            <mml:mstyle class="text">
              <mml:mtext class="textsf" mathvariant="sans-serif">tracks</mml:mtext>
            </mml:mstyle>
            <mml:mrow>
              <mml:mo class="MathClass-open">(</mml:mo>
              <mml:mrow>
                <mml:mstyle class="text">
                  <mml:mtext class="textsf" mathvariant="sans-serif">p</mml:mtext>
                </mml:mstyle>
                <mml:mn>1</mml:mn>
                <mml:mo class="MathClass-punc">,</mml:mo>
                <mml:mstyle class="text">
                  <mml:mtext class="textsf" mathvariant="sans-serif">p</mml:mtext>
                </mml:mstyle>
                <mml:mn>2</mml:mn>
                <mml:mo class="MathClass-punc">,</mml:mo>
                <mml:mstyle class="text">
                  <mml:mtext class="textsf" mathvariant="sans-serif">p</mml:mtext>
                </mml:mstyle>
                <mml:mn>3</mml:mn>
                <mml:mo class="MathClass-punc">,</mml:mo>
                <mml:mstyle class="text">
                  <mml:mtext class="textsf" mathvariant="sans-serif">heights</mml:mtext>
                </mml:mstyle>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mstyle class="text">
                  <mml:mtext class="textsf" mathvariant="sans-serif">c</mml:mtext>
                </mml:mstyle>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:mn>4</mml:mn>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo class="MathClass-close">)</mml:mo>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>Figure <xref ref-type="fig" rid="F2">2</xref> illustrates the creation of tracks. One tumor/normal pair
of RNA-seq samples is shown with the goal of interpreting splicing changes. A key aspect
of the plot is how the read alignment coverage and junction counts are composited and
then juxtaposed with the data from the other sample, as well as the annotated transcript
models. The viewer is then able to relate the changes in coverage to the corresponding
transcript structures, via the common x axis. At the top of the figure is an ideogram
overview of the chromosome, using colors corresponding to the Giemsa stain.</p>
    <fig id="F2" position="float">
      <label>Figure 2</label>
      <caption>
        <p><bold>Splicing summary with coordinate truncate gaps</bold>. An example of a plot made
from multiple tracks. At the top, the relevant chromosome is drawn with the
subregion of interest marked in red. The middle track shows the slicing summary
plots for the gene <italic>ALDOA </italic>for normal and tumor samples. Splicing is shown
as arches and size is used to represent junction counts and color represents
novelty: blue indicates known splicing events against the model and red indicates
novel splicing events. The height of arches is proportional to the distance
between the two ends of the arches, or the distance between the junction reads.
Coverage is shown by position to address supporting evidence in the raw data. The
splicing summary plots are aligned with a view of the gene structure in the bottom
track. The thicker rectangle represents the Consensus Coding DNA Sequence (CCDS)
transcripts. The plots in both tracks are made with truncate gaps coordinate
transformation. The space dedicated to introns has been significantly reduced, and
the exonic regions are shown in detail, even though the entire gene region is in
view.</p>
      </caption>
      <graphic xlink:href="gb-2012-13-8-r77-2"/>
    </fig>
  </sec>
  <sec>
    <title>Genomic overviews</title>
    <p>The purpose of an overview plot is to give a grand view of the entire genome. By
definition, this means that the resolution will be poor and that only large features
will be visible. An overview may reveal large features that might be missed if one
focused too narrowly. Different methods for mapping the genomic axis to the screen have
been applied to address the space issues, and also to ease the drawing of connections
between regions.</p>
    <sec>
      <title>Grand linear view</title>
      <p>Figure <xref ref-type="fig" rid="F3">3</xref> shows an example of a grand linear view, which lays
out the entire genome along a single linear axis. The plot shown in the figure is a
special case of the grand linear plot called a Manhattan plot, due to its resemblance
to the Manhattan skyline. It emphasizes extreme events, which show up as high-valued
outliers. This view has been used for many genome-wide association study reports [<xref ref-type="bibr" rid="B17">17</xref>]. The data here come from a genome-wide association study on Angus cattle,
and the data are faceted by three different scoring and classification methods [<xref ref-type="bibr" rid="B18">18</xref>]. The horizontal axis shows the global genomic coordinates, and the
vertical axis is generally mapped to some quantity of interest, in this case, the
genetic variance.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Manhattan plot</bold>. Grand linear view applied to a Manhattan plot as part of
a genome-wide association study in Angus cattle. The y axis shows genetic
variance, calculated by sliding windows of five consecutive SNPs for the
infectious bovine keratoconjunctivitis (IBK; a type of pinkeye) score. The x
axis is the genomic coordinates with all the chromosomes side-by-side. The
horizontal striping of color helps to indicate the end of one chromosome and
beginning of another. The plot is faceted by three different analysis methods.
There is one extreme variance in the middle facet, in the region of chromosome
23. There are also a few large values in other regions. According to the
results from the paper, three of these regions, 2, 13, and 23 are found to be
potentially indicative of a quantitative trait locus associated with IBK.</p>
        </caption>
        <graphic xlink:href="gb-2012-13-8-r77-3"/>
      </fig>
      <p>The plot uses linear layout and employs the genome coordinate transformation, which
transforms the chromosomal coordinates into global genomic coordinates as if all of
the chromosomes were concatenated together. The transformation supports both
proportional and uniform scaling of chromosomes, so that the plot area consumed by a
chromosome is either proportional to its length or the same as the other chromosomes.
It is also possible to add a buffer or break between chromosomes.</p>
    </sec>
    <sec>
      <title>Karyogram overview</title>
      <p>Figure <xref ref-type="fig" rid="F4">4</xref> shows a (single copy) karyogram overview plot, with
the color indicating RNA-editing locations in human [<xref ref-type="bibr" rid="B19">19</xref>]. The karyogram layout represents chromosomes as rectangles and stacks them
vertically or in a grid layout. Genomic position is relative to the chromosome,
starting from the first position at the left for each rectangle. Associated
information is overlaid on or over the box. Applications like Genome Graphs in the
UCSC genome browser [<xref ref-type="bibr" rid="B6">6</xref>] provide a similar plot. The advantage of this layout over the grand linear
view is more efficient use of horizontal space, and hence finer resolution detail on
the positions of the features. The trade-off is that the second variable has less
space - instead of a full vertical axis the information needs to be fit into each
rectangle. Thus, we obtain genomic position resolution at the cost of less data layer
resolution. It is common to see this type of plot used for SNP density, varying
levels of identity-by-descent (IBD) [<xref ref-type="bibr" rid="B20">20</xref>] and length of linkage disequilibrium spans [<xref ref-type="bibr" rid="B21">21</xref>].</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Stacked karyogram overview</bold>. Karyogram plot shows a subset of human
RNA-editing sites, and they are color coded for different regions as follows:
red indicates exons, green indicates introns and blue indicates exons/introns
status is unknown.</p>
        </caption>
        <graphic xlink:href="gb-2012-13-8-r77-4"/>
      </fig>
    </sec>
    <sec>
      <title>Circular overview</title>
      <p>The primary purpose of the circular view is to show links between genomic regions.
This is generally infeasible with the linear or karyogram layouts. In a circular
layout, features are organized into concentric rings. Figure <xref ref-type="fig" rid="F5">5</xref>
illustrates the circular overview on the data from a gene fusion study conducted by
Bass and colleagues [<xref ref-type="bibr" rid="B22">22</xref>], who sequenced the genomes of nine individuals with colorectal cancer and
identified an average of 75 somatic rearrangements per tumor sample. This circular
view shows only a single sample (colorectal tumor sample CRC-1), the structural
rearrangements are shown as links with intrachromosomal events in green and
interchromosomal translocations in orange. An ideogram of the autosomes is shown in
the outer ring, with somatic mutation and score tracks in the plot. There are many
software packages that provide a circular overview plot, including Circos [<xref ref-type="bibr" rid="B10">10</xref>], CGView [<xref ref-type="bibr" rid="B23">23</xref>] and DNAplotter [<xref ref-type="bibr" rid="B24">24</xref>].</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Single sample circular view</bold>. DNA structural rearrangements and somatic
mutation in a single colorectal tumor sample (CRC-1). The outer ring shows the
ideogram of the human autosomes, labeled with chromosome numbers and scales.
The segments represent the missense somatic mutations. The point tracks show
score and support for rearrangement. The size of the points indicates the
number of supporting read pairs in the tumor and the y value indicates the
score for each rearrangement. The links represent the rearrangements, where
intrachromosomal events are colored green and interchromosomal events are
colored orange.</p>
        </caption>
        <graphic xlink:href="gb-2012-13-8-r77-5"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>Specialized plots</title>
    <p>There are some typical types of plots used to examine specific biological questions.
This section describes how ggbio builds two of these: a mismatch summary and an
edge-linked interval plot.</p>
    <sec>
      <title>Mismatch summary</title>
      <p>Mismatch summary is one typical way to visualize alignments from sequencing data,
especially in the context of variant calling. Other genome browsers, such as
Integrative Genomics Viewer [<xref ref-type="bibr" rid="B4">4</xref>], Savant [<xref ref-type="bibr" rid="B25">25</xref>] and Artemis [<xref ref-type="bibr" rid="B26">26</xref>] render similar plots from BAM and variant call format (VCF) files. Figure
<xref ref-type="fig" rid="F6">6</xref> shows two different summaries of mismatches from a set of
RNA-seq read alignments. The top plot shows one DNA-seq sample from the first phase
of the 1000 Genomes Project [<xref ref-type="bibr" rid="B27">27</xref>], represented as a stacked barchart. It provides a detailed view of the
coverage, where the counts of bases that match the reference are indicated by gray
bars, and the counts of non-reference bases are indicated by a different color that
is specific to the base (A, C, G or T).</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Mismatch summary</bold>. An example of a mismatch summary plot, with associated
variant calls. The top track shows a barchart of reference counts in gray and
mismatched counts colored by the nucleotide. The middle track shows SNPs as
letters, color coded also by nucleotide. There is one mismatch, 'T', that is
different for all of the reads from the 'A' in the reference genome (bottom
letter plot).</p>
        </caption>
        <graphic xlink:href="gb-2012-13-8-r77-6"/>
      </fig>
    </sec>
    <sec>
      <title>Edge-linked interval to data views</title>
      <p>Interval data, like genes, regulatory sites, read alignments, and so on, are
different lengths. Differences in length can be distracting when looking at
associated numerical information. Thus, length is sometimes best ignored, and the
interval treated as an id or categorical variable. Figure <xref ref-type="fig" rid="F7">7</xref>
shows an example. The top plot shows a profile display of expression levels for two
samples, GM12878 and K562, where the genomic position of the exons is treated as a
categorical variable, forcing equal width in the plot. This allows us to see exons
where the expression level is different, without being distracted by the relative
interval size of the exons. We could also consider this display to be a parallel
coordinate plot [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B29">29</xref>].</p>
      <fig id="F7" position="float">
        <label>Figure 7</label>
        <caption>
          <p><bold>Edge-linked interval to data view</bold>. Edge-linked interval to data view for
the expression of the exons of gene <italic>PDIA6</italic>. The top track shows the
expression level for each of the exons, and the color indicates the sample
(GM12878 or K562). The second track shows the links between the even-spaced
expression track and the exons track, below. The package DEXseq, which produces
a similar graphic, computes differential expression and significance, and
significance is indicated by coloring the connecting lines red. The track at
the bottom shows the annotated transcripts.</p>
        </caption>
        <graphic xlink:href="gb-2012-13-8-r77-7"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>Biological extensions to the grammar of graphics</title>
    <sec>
      <title>The base grammar</title>
      <p>The work introduced in this paper builds upon the grammar of graphics conceived by
Wilkinson [<xref ref-type="bibr" rid="B14">14</xref>] and expanded upon by Wickham [<xref ref-type="bibr" rid="B15">15</xref>]. The grammar is composed of interchangeable components that are combined
according to a flexible set of rules to produce plots from a wide range of types.
Table <xref ref-type="table" rid="T1">1</xref> explains the components of the grammar (data, geom,
stat, scales, coord, facet), as utilized in ggplot2, and indicates how these are used
to create two graphics: Figure <xref ref-type="fig" rid="F8">8</xref> and <xref ref-type="fig" rid="F1">1</xref>.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Components of basic grammar of graphics</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">Comp</th>
              <th align="left">Explanation</th>
              <th align="left">Figure 8 usage</th>
              <th align="left">Figure 1 usage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Data</td>
              <td align="left">Data to visualize, containing variables and values</td>
              <td align="left">A gene expression table</td>
              <td align="left">A GRanges object (core data structure in Bioconductor)</td>
            </tr>
            <tr>
              <td align="left">Geom</td>
              <td align="left">A geometric object draws the data as a graphical primitive. Types of
primitives include points, lines, polygons or text. Some statistical or
composite primitives, such as histogram, boxplot and point range, are
considered to be geoms</td>
              <td align="left">Points with color indicating significance of expression (red =
significant, black = not)</td>
              <td align="left">Alignments (new), Chevron (new)</td>
            </tr>
            <tr>
              <td align="left">Stat</td>
              <td align="left">A statistical transformation transforms, filters and/or summarizes a
variable prior to plotting. For example, binning and counting is
necessary to make a histogram. The default would be an identity
transformation, which does not change the data. In ggplot2 an appropriate
default transformation is chosen according to the geom, for example, the
bin transform for the histogram geom. Thus, the user rarely needs to
explicitly specify one</td>
              <td align="left">Identity (computation of M value and A values is done outside of the
grammar)</td>
              <td align="left">Steppings (new)</td>
            </tr>
            <tr>
              <td align="left">Scales</td>
              <td align="left">A scale maps the variables (for example, expression, treatment, gene id)
from data space to aesthetics (for example, position, color, area).
Scales also control associated guides like axes and legends. Included in
scales are numerical transformations such as log or square root of
variables, so that an axis can be drawn on a log scale, for example. The
default is a linear scale</td>
              <td align="left">A, the log geometric average, the x axis, and M, the log ratio mapped to
the y axis</td>
              <td align="left">Genomic position mapped to position along x axis, and levels mapped to y
axis</td>
            </tr>
            <tr>
              <td align="left">Coord</td>
              <td align="left">A coordinate system controls how two position scales work together. The
default is the Cartesian coordinate system, but others such as a polar
coordinate system could be chosen</td>
              <td align="left">Cartesian</td>
              <td align="left">Cartesian</td>
            </tr>
            <tr>
              <td align="left">Facet</td>
              <td align="left">A faceting specification is used to produce small multiples [<xref ref-type="bibr" rid="B42">42</xref>] for subsets of the data. In other graphical systems it is
known as latticing [<xref ref-type="bibr" rid="B43">43</xref>], trellising [<xref ref-type="bibr" rid="B44">44</xref>] or even conditioning</td>
              <td align="left">None</td>
              <td align="left">None</td>
            </tr>
            <tr>
              <td align="left">Layout (new)</td>
              <td align="left">A layout is a new grammatical component for controlling how multiple
plots are arranged in a figure. It was motivated by the need to display
multiple genomic annotation data sets simultaneously, and also supports
genomic overviews</td>
              <td align="left">Single</td>
              <td align="left">Linear</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Components of the basic grammar of graphics, and the extended grammar, and how
they are used in Figures 8 and 1. Figure 9 illustrates how the grammar has been
extended for biological data. Entries marked with 'new' are those developed as
part of this work; the rest are inherited from ggplot2.</p>
        </table-wrap-foot>
      </table-wrap>
      <fig id="F8" position="float">
        <label>Figure 8</label>
        <caption>
          <p><bold>MA-plot</bold>. MA-plot for differential expression analysis in four RNA-seq
samples with two cell lines GM12878 and K562, annotated to illustrate the use
of the grammar of graphics. Points is our geometric object, x axis indicates
the normalized mean and the y axis indicates the log<sub>2 </sub>fold change.
Aesthetics mapping took place between the groups and the color to use red to
indicate the most significant differently expressed observation (gene). This
plot uses Cartesian coordinates.</p>
        </caption>
        <graphic xlink:href="gb-2012-13-8-r77-8"/>
      </fig>
    </sec>
    <sec>
      <title>Genomic data and abstractions</title>
      <p>Data are the first component of the grammar, and data may be collected in different
ways. Wilkinson makes a distinction between empirical data, abstract data and
metadata [<xref ref-type="bibr" rid="B14">14</xref>]. Empirical data are collected from observations of the real world, while
abstract data are defined by a formal mathematical model. Metadata are data about
data, which might be empirical, abstract or metadata themselves. We will use the term
data source to refer to concrete data in specific databases and file formats. This is
roughly analogous to Wilkinson's empirical data.</p>
      <p>The ggbio package attempts to automatically load files of specific formats into
common Bioconductor data structures, using routines provided by Bioconductor
packages, according to Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> Table S2. The
loaded data are then considered by Wilkinson to be abstract, in that they are no
longer tied to a specific file format. Analogously, a data structure may be created
by any number of algorithms in R; all that matters is that every algorithm returns a
result of the same type. The type of data structure loaded from a file or returned by
an algorithm depends on the intrinsic structure of the data. For example, BAM files
are loaded into a GappedAlignments, while FASTA and 2bit sequences result in a
DNAStringSet. The ggbio package handles each type of data structure differently,
according to Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> Table S1. In summary, this
abstraction mechanism allows ggbio to handle multiple file formats, without
discarding any intrinsic properties that are critical for effective plotting.</p>
    </sec>
    <sec>
      <title>Extension overview</title>
      <p>Genomic data have some specific features that are different from those of more
conventional data types, and the basic grammar does not conveniently capture such
aspects. The grammar of graphics is extended by ggbio in several ways, which are
illustrated in Figure <xref ref-type="fig" rid="F9">9</xref> and described in Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref> Table S3. These extensions are specific to genomic
data, that is, genomic sequences and features, like genes, located on those
sequences.</p>
      <fig id="F9" position="float">
        <label>Figure 9</label>
        <caption>
          <p><bold>Diagram of the ggbio framework for processing sequence data</bold>. It starts
with a mapping from different file types to different objects or data structure
in R, using Bioconductor tools, followed by general and extended grammar of
graphics mapping of data elements to graphical components. The final stage
arranges the graphics in a designed layout to show annotation tracks or
multiple data sets. Orange boxes and dark brown arrows indicate the extensions
provided by ggbio.</p>
        </caption>
        <graphic xlink:href="gb-2012-13-8-r77-9"/>
      </fig>
      <p>Figure <xref ref-type="fig" rid="F1">1</xref> illustrates how the components of the grammar are
combined to plot gene structures. A sample of the data is shown in Table <xref ref-type="table" rid="T2">2</xref>. The data are passed to ggbio as a GRangesList object. The
chevron geom mimics the typical splice junction diagram found in textbooks and it
draws the introns in the example. The exons are drawn using the rectangle geom, and
the high-level alignment geom ensures that the introns and exons from the same
transcript are drawn connected, according to the tx_id column. The position on the
chromosome is mapped to the horizontal axis and strand is mapped to color. The
vertical axis is mapped to a variable generated by the stepping statistic, which
avoids overplotting between the transcripts. We will explain these aspects in the
following sections.</p>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Example of GRanges object</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th align="center">seqnames</th>
              <th align="center">ranges</th>
              <th align="center">strand</th>
              <th align="center">tx_id</th>
              <th align="center">exon_id</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">1</td>
              <td align="center">chrX</td>
              <td align="center">[48242968], [48243005]</td>
              <td align="center">+</td>
              <td align="center">35775</td>
              <td align="center">132624</td>
            </tr>
            <tr>
              <td align="center">2</td>
              <td align="center">chrX</td>
              <td align="center">[48243475], [48243563]</td>
              <td align="center">+</td>
              <td align="center">35775</td>
              <td align="center">132625</td>
            </tr>
            <tr>
              <td align="center">3</td>
              <td align="center">chrX</td>
              <td align="center">[48244003], [48244117]</td>
              <td align="center">+</td>
              <td align="center">35775</td>
              <td align="center">132626</td>
            </tr>
            <tr>
              <td align="center">4</td>
              <td align="center">chrX</td>
              <td align="center">[48244794], [48244889]</td>
              <td align="center">+</td>
              <td align="center">35775</td>
              <td align="center">132627</td>
            </tr>
            <tr>
              <td align="center">5</td>
              <td align="center">chrX</td>
              <td align="center">[48246753], [48246802]</td>
              <td align="center">+</td>
              <td align="center">35775</td>
              <td align="center">132628</td>
            </tr>
            <tr>
              <td align="center">...</td>
              <td align="center">...</td>
              <td align="center">...</td>
              <td align="center">...</td>
              <td align="center">......</td>
              <td align="center">...</td>
            </tr>
            <tr>
              <td align="center">26</td>
              <td align="center">chrX</td>
              <td align="center">[48270193], [48270307]</td>
              <td align="center">-</td>
              <td align="center">35778</td>
              <td align="center">132637</td>
            </tr>
            <tr>
              <td align="center">27</td>
              <td align="center">chrX</td>
              <td align="center">[48269421], [48269516]</td>
              <td align="center">-</td>
              <td align="center">35778</td>
              <td align="center">132636</td>
            </tr>
            <tr>
              <td align="center">28</td>
              <td align="center">chrX</td>
              <td align="center">[48267508], [48267557]</td>
              <td align="center">-</td>
              <td align="center">35778</td>
              <td align="center">132635</td>
            </tr>
            <tr>
              <td align="center">29</td>
              <td align="center">chrX</td>
              <td align="center">[48262894], [48262998]</td>
              <td align="center">-</td>
              <td align="center">35778</td>
              <td align="center">132633</td>
            </tr>
            <tr>
              <td align="center">30</td>
              <td align="center">chrX</td>
              <td align="center">[48261524], [48262111]</td>
              <td align="center">-</td>
              <td align="center">35778</td>
              <td align="center">132632</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Typical biological data coerced into a data frame: a GRanges table representing
genes <italic>SSX4 </italic>and <italic>SSX4B</italic>. One row represents one exon, seqnames
indicates the chromosome name, ranges indicates the interval of exons, strand
is the direction, tx_id and exon_id are the internal ids used for mapping
cross-database.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Biological geometries</title>
      <p>A geom is responsible for translating data to a visual, geometric representation
according to mappings between variables and aesthetic properties on the geom. In
comparison to regular data elements that might be mapped to the ggplot2 geoms of
points, lines and polygons, genomic data has the basic currency of a range. Ranges
underlie exons, introns and other features, and the genomic coordinate system forms
the reference frame for biological data. We have introduced or extended several geoms
for representing ranges and gaps between ranges. They are listed in Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref> Table S3. For example, the alignment geom delegates to
two other geoms for drawing the ranges and gaps. These default to rectangles and
chevrons, respectively. Having specialized geoms for commonly encountered entities,
like genes, relegates the tedious coding of primitives, and makes user code simpler
and more maintainable.</p>
    </sec>
    <sec>
      <title>Biological statistical transformations</title>
      <p>A statistical transformation (stat) transforms or summarizes the data in a particular
way. These statistics may be mapped to visual aesthetics in the same manner as the
original data. In this work we introduce several statistical transformations
specifically for genomic data as shown in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>
Table S3. For example, given a large number of read alignments, computation of
coverage is useful, as shown in Figure <xref ref-type="fig" rid="F10">10</xref>. These
trans-formations were implemented with significant help from Bioconductor tools. New
statistical transformations are readily incorporated.</p>
      <fig id="F10" position="float">
        <label>Figure 10</label>
        <caption>
          <p><bold>Coverage transformation</bold>. Statistical transformation, coverage and
stepping, are used to summarize short reads data. Top: a set of (simulated)
short reads, displayed using the stepping transformation, vertically, and the
default geom 'rectangle'. Bottom: coverage is shown on the vertical axis, using
the geom 'area'. This example applies the data model GRanges object.</p>
        </caption>
        <graphic xlink:href="gb-2012-13-8-r77-10"/>
      </fig>
    </sec>
    <sec>
      <title>Biological coordinate transformations</title>
      <p>Coordinate systems locate points in space, and we use coordinate transformations to
map from data coordinates to plot coordinates. The most common coordinate system in
statistical graphics is cartesian. The transformation of data to cartesian
coordinates involves mapping points onto a plane specified by two perpendicular axes
(x and y). Why would two plots transform the coordinates differently for the same
data? The first reason is to simplify, such as changing curvilinear graphics to
linear, and the second reason is to reshape a graphic so that the most important
information jumps out at the viewer or can be more accurately perceived [<xref ref-type="bibr" rid="B14">14</xref>].</p>
      <p>Coordinate transformations are also important in genomic data visualization. For
instance, features of interest are often small compared to the intervening gaps,
especially in gene models. The exons are usually much smaller than the introns. If
users are generally interested in viewing exons and associated annotations, we could
simply cut or shrink the intervening introns to use the plot space efficiently. For
example, Figure <xref ref-type="fig" rid="F2">2</xref> is able to show the entire gene region, with
virtually no loss in data resolution. In ggbio, we propose three sets of coordinate
systems, shown in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> Table S3, which are
useful for genomic data.</p>
    </sec>
    <sec>
      <title>Biological faceting</title>
      <p>Almost all experimental outputs are associated with an experimental design and other
meta-data, for example, cancer types, gender and age. Faceting allows users to subset
the data by a combination of factors and then lay out multiple plots in a grid, to
explore relationships between factors and other variables. The ggplot2 package
supports various types of faceting by arbitrary factors. The ggbio package extends
this notion to facet by a list of ranges of interest, for example, a list of gene
regions. There is always an implicit faceting by sequence (chromosome), because when
the x axis is the chromosomal coordinate, it is not sensible to plot data from
different chromosomes on the same plot. As an aside, generating a set of tracks might
resemble faceting, but it is easier to fit into the grammar framework if we think of
it as a post-processing step.</p>
    </sec>
    <sec>
      <title>Biological layout</title>
      <p>We have also extended the grammar of graphics with an additional component called
layout, upon which the mapping from genomic coordinates to plot coordinates depends.
The default layout simply maps the genomic coordinates to the x axis and facets by
chromosome. The currently supported layouts are: linear (genomic coordinates mapped
to the x axis), karyogram (each chromosome displayed separately, in an array), and
circular (like linear, except wrapped around in a circle). The high-level genomic
overview plots take advantage of these layout mechanisms.</p>
    </sec>
  </sec>
  <sec>
    <title>Low-level grammar-oriented API</title>
    <p>For custom use cases, ggbio provides a low-level API that maps more directly to
components of the grammar and thus expresses the plot more explicitly. Generally
speaking, we strive to provide sensible, overridable defaults at the high-level entry
points, such as autoplot, while still supporting customizability through the low-level
API.</p>
    <p>All lower level functions have a special prefix to indicate their role in the grammar,
like layout, geom, stat, coord, and theme. The objects returned by the low-level API may
be added together via the conventional + syntax. This facilitates the creation of new
types of plots. A geom in ggplot2 may be extended to work with more biological data
model, for example, geom rect will automatically figure out the boundary of rectangles
when the data is a GRanges, as do geom bar, geom segment, and so on. As an example, the
following code produces the same plot as the code shown above, using the low-level API
instead of autoplot:</p>
    <p>
      <disp-formula>
        <mml:math id="M3" name="gb-2012-13-8-r77-i3" overflow="scroll">
          <mml:mrow>
            <mml:mstyle class="text">
              <mml:mtext class="textsf" mathvariant="sans-serif">ggplot</mml:mtext>
            </mml:mstyle>
            <mml:mrow>
              <mml:mo class="MathClass-open">(</mml:mo>
              <mml:mrow/>
              <mml:mo class="MathClass-close">)</mml:mo>
            </mml:mrow>
            <mml:mo class="MathClass-bin">+</mml:mo>
            <mml:mstyle class="text">
              <mml:mtext class="textsf" mathvariant="sans-serif">geom</mml:mtext>
            </mml:mstyle>
            <mml:mstyle class="text">
              <mml:mtext>_</mml:mtext>
            </mml:mstyle>
            <mml:mstyle class="text">
              <mml:mtext class="textsf" mathvariant="sans-serif">arrowrect</mml:mtext>
            </mml:mstyle>
            <mml:mrow>
              <mml:mo class="MathClass-open">(</mml:mo>
              <mml:mrow>
                <mml:mstyle class="text">
                  <mml:mtext class="textsf" mathvariant="sans-serif">unlist</mml:mtext>
                </mml:mstyle>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif">grl</mml:mtext>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo class="MathClass-close">)</mml:mo>
            </mml:mrow>
            <mml:mo class="MathClass-bin">+</mml:mo>
            <mml:mstyle class="text">
              <mml:mtext class="textsf" mathvariant="sans-serif">geom</mml:mtext>
            </mml:mstyle>
            <mml:mstyle class="text">
              <mml:mtext>_</mml:mtext>
            </mml:mstyle>
            <mml:mstyle class="text">
              <mml:mtext class="textsf" mathvariant="sans-serif">chevron</mml:mtext>
            </mml:mstyle>
            <mml:mrow>
              <mml:mo class="MathClass-open">(</mml:mo>
              <mml:mrow>
                <mml:mstyle class="text">
                  <mml:mtext class="textsf" mathvariant="sans-serif">gaps</mml:mtext>
                </mml:mstyle>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif">unlist</mml:mtext>
                    </mml:mstyle>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">grl</mml:mtext>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:mo class="MathClass-close">)</mml:mo>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>The reader will notice how the low-level code is more descriptive about the composition
of the plot. In this example, it says we start with an empty plot as created by ggplot.
We then use geom arrowrect for exons and add a second layer for the gaps using geom
chevron.</p>
    <p>The low-level API may be used in conjunction with autoplot, via the + syntax. This makes
it possible to save a plot as an object in a session and modify it in different ways
while experimenting. For example, the following code applies a new theme to the existing
graphic object. The theme null function removes the background labels and legend.</p>
    <p>
      <disp-formula>
        <mml:math id="M4" name="gb-2012-13-8-r77-i4" overflow="scroll">
          <mml:mrow>
            <mml:mtable class="gathered">
              <mml:mtr>
                <mml:mtd columnalign="left">
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">p</mml:mtext>
                  </mml:mstyle>
                  <mml:mo class="MathClass-rel">&lt;</mml:mo>
                  <mml:mo class="MathClass-bin">-</mml:mo>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">autoplot</mml:mtext>
                  </mml:mstyle>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mstyle class="text">
                        <mml:mtext class="textsf" mathvariant="sans-serif">grl</mml:mtext>
                      </mml:mstyle>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                      <mml:mstyle class="text">
                        <mml:mtext class="textsf" mathvariant="sans-serif">aes</mml:mtext>
                      </mml:mstyle>
                      <mml:mrow>
                        <mml:mo class="MathClass-open">(</mml:mo>
                        <mml:mrow>
                          <mml:mstyle class="text">
                            <mml:mtext class="textsf" mathvariant="sans-serif">color</mml:mtext>
                          </mml:mstyle>
                          <mml:mo class="MathClass-rel">=</mml:mo>
                          <mml:mstyle class="text">
                            <mml:mtext class="textsf" mathvariant="sans-serif">strand</mml:mtext>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo class="MathClass-close">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd columnalign="left">
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">p</mml:mtext>
                  </mml:mstyle>
                  <mml:mo class="MathClass-bin">+</mml:mo>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">theme</mml:mtext>
                  </mml:mstyle>
                  <mml:mstyle class="text">
                    <mml:mtext>_</mml:mtext>
                  </mml:mstyle>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">null</mml:mtext>
                  </mml:mstyle>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow/>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd/>
              </mml:mtr>
            </mml:mtable>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and methods</title>
    <p>The ggbio package is an extension for R, a free cross-platform programming environment
for statistical analysis and graphics with more than 3, 000 contributed packages. The
package depends upon Bioconductor libraries for handling and processing data, including
the implementation of the statistics in our extension of the grammar. The Bioconductor
project is a collaborative effort to develop software for computational biology and
bioinformatics with high-quality packages and documentation [<xref ref-type="bibr" rid="B30">30</xref>]. The visualization methods in ggbio depend heavily on the package ggplot2 [<xref ref-type="bibr" rid="B15">15</xref>], which implements the grammar of graphics. The new geoms in ggbio are
constructed from primitives defined in ggplot2. We use ggplot2 as the foundation for
ggbio, due to its principled style, intelligent defaults and explicit orientation
towards the grammar of graphics model. The color schemes in ggbio were derived from
standard palettes available in R [<xref ref-type="bibr" rid="B31">31</xref>-<xref ref-type="bibr" rid="B33">33</xref>].</p>
    <p>The RNA-seq data used in this paper are from ENCODE [<xref ref-type="bibr" rid="B34">34</xref>]. Two cell lines, GM12878 (blood, normal, female) and K562 (blood, cancer,
female), are selected, and there are two replicates for each sample. The data were
mapped against hg19 using Spliced Transcript Alignment and Reconstruction (STAR) [<xref ref-type="bibr" rid="B35">35</xref>]. The Bioconductor packages Rsamtools [<xref ref-type="bibr" rid="B36">36</xref>] and GenomicRanges [<xref ref-type="bibr" rid="B37">37</xref>] were used to import the BAM files and count reads overlapping exons. The
package DEXSeq [<xref ref-type="bibr" rid="B38">38</xref>] was used to conduct the expression analysis and find the most differently
expressed exons. We used the rtracklayer package [<xref ref-type="bibr" rid="B39">39</xref>] to import BED format files and cast them into GRanges objects for ggbio. The
DNA-seq BAM files and VCF files used in Figure <xref ref-type="fig" rid="F6">6</xref> were downloaded
from the 1000 Genomes Project [<xref ref-type="bibr" rid="B27">27</xref>].</p>
    <p>All figures, code and data links are available from the documentation section of the
ggbio website [<xref ref-type="bibr" rid="B40">40</xref>].</p>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>We have demonstrated how ggbio supports both the convenient construction of typical
genomic plots, while simultaneously supporting the invention of new types of plots from
low-level building blocks. Use cases of ggbio range from generating reproducible,
exploratory plots in the course of an analysis to the prototyping of new ways of looking
at these complex data. Lessons learned might be applied to the design of more complex,
interactive systems. A new package, visnab, is being developed to make interactive
graphics for genomic data [<xref ref-type="bibr" rid="B41">41</xref>].</p>
    <p>One such lesson learned is the importance of color choices, which are inconsistent in
many existing tools. Color is one of the primary visual clues in a data graphic and
needs to be handled with some intelligence. For example, the ggbio package builds on
well-specified color palettes used in ggplot2 and biovizBase, including one that is
based on the biologically inspired Giemsa stain colors, as shown at the top of Figure
<xref ref-type="fig" rid="F2">2</xref>.</p>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>API: application programming interface; ENCODE: The Encyclopedia of DNA Elements; SNP:
single nucleotide polymorphism; UCSC: University of California Santa Cruz; VCF: variant
call format.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>Tengfei Yin and Michael Lawrence designed and wrote the package. Michael Lawrence
provided the initial ideas on extending the grammar for biological data. Dianne Cook and
Michael Lawrence provided advice on plot design, and suggestions for the design and
development of the package. All three authors substantially contributed to the
manuscript writing, and have approved the final version.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Supplementary Tables</bold>. Table S1: Data model. Table S2: Supported data
formats. Table S3: Extension of grammar of graphics.</p>
      </caption>
      <media xlink:href="gb-2012-13-8-r77-S1.PDF">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>We are grateful to James Koltes, Kadir Kizilkaya and Jim Reecy for sharing their
Angus cattle infectious bovine keratoconjunctivitis data. Tengfei Yin's research has
been partially funded by Genentech Research and Early Development, Inc. We are
particularly grateful for the support of Robert Gentleman.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="other">
        <article-title>Integrated Genome Browser.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://bioviz.org/igb/">http://bioviz.org/igb/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nicol</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Helt</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Blanchard</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Raja</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Loraine</surname>
          <given-names>A</given-names>
        </name>
        <article-title>The Integrated Genome Browser: free software for distribution and exploration of
genome-scale datasets.</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>13</volume>
        <fpage>2730</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp472</pub-id>
        <?supplied-pmid 19654113?>
        <pub-id pub-id-type="pmid">19654113</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="other">
        <article-title>Integrative Genomics Viewer.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.broadinstitute.org/igv/">http://www.broadinstitute.org/igv/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Robinson</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Thorvaldsdottir</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Winckler</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Guttman</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lander</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Getz</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Mesirov</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Integrative genomics viewer.</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>13</volume>
        <fpage>24</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id>
        <?supplied-pmid 21221095?>
        <pub-id pub-id-type="pmid">21221095</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Flicek</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Amode</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Barrell</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Beal</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Brent</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Clapham</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Coates</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Fairley</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Fitzgerald</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Gordon</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Hendrix</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hourlier</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Kahari</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Keefe</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Keenan</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Kinsella</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Kokocinski</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Kulesha</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Larsson</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Longden</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>McLaren</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Overduin</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Pritchard</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Singh Riat</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Rios</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Ritchie</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Ruer</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Schuster</surname>
          <given-names>M</given-names>
        </name>
        <etal/>
        <article-title>Ensembl 2011.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>13</volume>
        <fpage>D800</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq1064</pub-id>
        <?supplied-pmid 21045057?>
        <pub-id pub-id-type="pmid">21045057</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Karolchik</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Baertsch</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Diekhans</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Furey</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Hinrichs</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Lu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Roskin</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Schwartz</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Sugnet</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Thomas</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Weber</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Haussler</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>WJ</surname>
          <given-names>K</given-names>
        </name>
        <article-title>The UCSC genome browser database.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>51</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkg129</pub-id>
        <?supplied-pmid 12519945?>
        <pub-id pub-id-type="pmid">12519945</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Stein</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Mungall</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Shu</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Caudy</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Mangone</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Day</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Nickerson</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Stajich</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Harris</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Arva</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Lewis</surname>
          <given-names>S</given-names>
        </name>
        <article-title>The generic genome browser: a building block for a model organism system
database.</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>13</volume>
        <fpage>1599</fpage>
        <lpage>1610</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.403602</pub-id>
        <?supplied-pmid 12368253?>
        <pub-id pub-id-type="pmid">12368253</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Down</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Piipari</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hubbard</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Dalliance: interactive genome viewing on the web.</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>13</volume>
        <fpage>889</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr020</pub-id>
        <?supplied-pmid 21252075?>
        <pub-id pub-id-type="pmid">21252075</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="other">
        <article-title>DNAnexus.</article-title>
        <ext-link ext-link-type="uri" xlink:href="https://dnanexus.com/">https://dnanexus.com/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Krzywinski</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Schein</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Birol</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Connors</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Gascoyne</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Horsman</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Jones</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Marra</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Circos: an information aesthetic for comparative genomics.</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>13</volume>
        <fpage>1639</fpage>
        <lpage>1645</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.092759.109</pub-id>
        <?supplied-pmid 19541911?>
        <pub-id pub-id-type="pmid">19541911</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Durinck</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Bullard</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Spellman</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Dudoit</surname>
          <given-names>S</given-names>
        </name>
        <article-title>GenomeGraphs: integrated genomic data visualization with R.</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>13</volume>
        <fpage>2</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-2</pub-id>
        <?supplied-pmid 19123956?>
        <pub-id pub-id-type="pmid">19123956</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="other">
        <name>
          <surname>Hahne</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Durinck</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ivanek</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Mueller</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Gviz: Plotting data and annotation information along genomic coordinates (R
package version 0.99.8).</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/2.12/bioc/html/Gviz.html">http://www.bioconductor.org/packages/2.12/bioc/html/Gviz.html</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ding</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Wendl</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Koboldt</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Mardis</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Analysis of next-generation genomic data in cancer: accom-plishments and
challenges.</article-title>
        <source>Hum Mol Genet</source>
        <year>2010</year>
        <volume>13</volume>
        <fpage>R188</fpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddq391</pub-id>
        <?supplied-pmid 20843826?>
        <pub-id pub-id-type="pmid">20843826</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wilkinson</surname>
          <given-names>L</given-names>
        </name>
        <article-title>The grammar of graphics.</article-title>
        <source>Wiley Interdisciplinary Rev Comput Stat</source>
        <year>2005</year>
        <volume>13</volume>
        <fpage>673</fpage>
        <lpage>677</lpage>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="book">
        <name>
          <surname>Wickham</surname>
          <given-names>H</given-names>
        </name>
        <source>ggplot2: Elegant Graphics for Data Analysis</source>
        <year>2009</year>
        <publisher-name>New York: Springer-Verlag Inc</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="other">
        <article-title>Bioconductor.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/">http://www.bioconductor.org/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gibson</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Hints of hidden heritability in GWAS.</article-title>
        <source>Nat Genet</source>
        <year>2010</year>
        <volume>13</volume>
        <fpage>558</fpage>
        <lpage>560</lpage>
        <pub-id pub-id-type="doi">10.1038/ng0710-558</pub-id>
        <?supplied-pmid 20581876?>
        <pub-id pub-id-type="pmid">20581876</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kizilkaya</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Tait</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Garrick</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Fernando</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Reecy</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Whole genome analysis of infectious bovine ker-atoconjunctivitis in Angus cattle
using Bayesian threshold models.</article-title>
        <source>BMC Proc</source>
        <year>2011</year>
        <volume>13</volume>
        <issue>Suppl 4</issue>
        <fpage>S22</fpage>
        <pub-id pub-id-type="doi">10.1186/1753-6561-5-S4-S22</pub-id>
        <?supplied-pmid 22373228?>
        <pub-id pub-id-type="pmid">21645302</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kiran</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Baranov</surname>
          <given-names>P</given-names>
        </name>
        <article-title>DARNED: a DAtabase of RNa EDiting in humans.</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>13</volume>
        <fpage>1772</fpage>
        <lpage>1776</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq285</pub-id>
        <?supplied-pmid 20547637?>
        <pub-id pub-id-type="pmid">20547637</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <collab>The International HapMap Consortium</collab>
        <article-title>A second generation human haplotype map of over 3.1 million SNPs.</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>13</volume>
        <fpage>851</fpage>
        <lpage>861</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06258</pub-id>
        <?supplied-pmid 17943122?>
        <pub-id pub-id-type="pmid">17943122</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <collab>The International HapMap Consortium</collab>
        <article-title>A haplotype map of the human genome.</article-title>
        <source>Nature</source>
        <year>2005</year>
        <volume>13</volume>
        <fpage>1299</fpage>
        <lpage>1320</lpage>
        <pub-id pub-id-type="doi">10.1038/nature04226</pub-id>
        <?supplied-pmid 16255080?>
        <pub-id pub-id-type="pmid">16255080</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bass</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Lawrence</surname>
          <given-names>MS</given-names>
        </name>
        <name>
          <surname>Brace</surname>
          <given-names>LE</given-names>
        </name>
        <name>
          <surname>Ramos</surname>
          <given-names>AH</given-names>
        </name>
        <name>
          <surname>Drier</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Cibulskis</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Sougnez</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Voet</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Saksena</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Sivachenko</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Jing</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Parkin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Pugh</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Verhaak</surname>
          <given-names>RG</given-names>
        </name>
        <name>
          <surname>Stransky</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Boutin</surname>
          <given-names>AT</given-names>
        </name>
        <name>
          <surname>Barretina</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Solit</surname>
          <given-names>DB</given-names>
        </name>
        <name>
          <surname>Vakiani</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Shao</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Mishina</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Warmuth</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Jimenez</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Chiang</surname>
          <given-names>DY</given-names>
        </name>
        <name>
          <surname>Signoretti</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Kaelin</surname>
          <given-names>WG</given-names>
        </name>
        <name>
          <surname>Spardy</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Hahn</surname>
          <given-names>WC</given-names>
        </name>
        <name>
          <surname>Hoshida</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Ogino</surname>
          <given-names>S</given-names>
        </name>
        <etal/>
        <article-title>Genomic sequencing of colorectal adenocarcinomas identifies a recurrent
VTI1A-TCF7L2 fusion.</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>13</volume>
        <fpage>964</fpage>
        <lpage>968</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.936</pub-id>
        <?supplied-pmid 21892161?>
        <pub-id pub-id-type="pmid">21892161</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Stothard</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Wishart</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Circular genome visualization and exploration using CGView.</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>13</volume>
        <fpage>537</fpage>
        <lpage>539</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti054</pub-id>
        <?supplied-pmid 15479716?>
        <pub-id pub-id-type="pmid">15479716</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Carver</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Thomson</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Bleasby</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Berriman</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Parkhill</surname>
          <given-names>J</given-names>
        </name>
        <article-title>DNAPlotter: circular and linear interactive genome visualization.</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>13</volume>
        <fpage>119</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn578</pub-id>
        <?supplied-pmid 18990721?>
        <pub-id pub-id-type="pmid">18990721</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fiume</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Williams</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Brook</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Brudno</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Savant: genome browser for high-throughput sequencing data.</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>13</volume>
        <fpage>1938</fpage>
        <lpage>1944</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq332</pub-id>
        <?supplied-pmid 20562449?>
        <pub-id pub-id-type="pmid">20562449</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rutherford</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Parkhill</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Crook</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Horsnell</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Rice</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Rajandream</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Barrell</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Artemis: sequence visualization and annotation.</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>13</volume>
        <fpage>944</fpage>
        <lpage>945</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/16.10.944</pub-id>
        <?supplied-pmid 11120685?>
        <pub-id pub-id-type="pmid">11120685</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Consortium</surname>
          <given-names>TIH</given-names>
        </name>
        <article-title>A map of human genome variation from population-scale sequencing.</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>13</volume>
        <fpage>1061</fpage>
        <lpage>1073</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09534</pub-id>
        <?supplied-pmid 20981092?>
        <pub-id pub-id-type="pmid">20981092</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Inselberg</surname>
          <given-names>A</given-names>
        </name>
        <article-title>The Plane with Parallel Coordinates.</article-title>
        <source>Visual Computer</source>
        <year>1985</year>
        <volume>13</volume>
        <fpage>69</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01898350</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wegman</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Hyperdimensional data analysis using parallel coordinates.</article-title>
        <source>J Am Stat Assoc</source>
        <year>1990</year>
        <volume>13</volume>
        <fpage>664</fpage>
        <lpage>675</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1990.10474926</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gentleman</surname>
          <given-names>RC</given-names>
        </name>
        <name>
          <surname>Carey</surname>
          <given-names>VJ</given-names>
        </name>
        <name>
          <surname>Bates</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Bolstad</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Dettling</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Dudoit</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ellis</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Gautier</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Ge</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Gentry</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Hornik</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Hothorn</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Huber</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Iacus</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Irizarry</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Leisch</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Maechler</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Rossini</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Sawitzki</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Smyth</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Tierney</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>JY</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Bioconductor: Open software development for computational biology and
bioinformatics.</article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>13</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2004-5-10-r80</pub-id>
        <?supplied-pmid 15461798?>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lumley</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Color-coding and color blindness in statistical graphics.</article-title>
        <source>Stat Computing</source>
        <year>2006</year>
        <volume>13</volume>
        <fpage>4</fpage>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="other">
        <name>
          <surname>Neuwirth</surname>
          <given-names>E</given-names>
        </name>
        <article-title>RColorBrewer: ColorBrewer palettes (R package version 1.0-5).</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=RColorBrewer">http://CRAN.R-project.org/package=RColorBrewer</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="other">
        <article-title>colorspace.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/web/packages/colorspace/index.html">http://cran.r-project.org/web/packages/colorspace/index.html</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="other">
        <article-title>ENCODE.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu/ENCODE/">http://genome.ucsc.edu/ENCODE/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="other">
        <article-title>STAR.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://gingeraslab.cshl.edu/STAR/">http://gingeraslab.cshl.edu/STAR/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="other">
        <name>
          <surname>Morgan</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Pages</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Rsamtools: Binary alignment (BAM), variant call (BCF), or tabix file import (R
package version 1.9.26).</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/Rsamtools.html">http://bioconductor.org/packages/release/bioc/html/Rsamtools.html</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="other">
        <name>
          <surname>Aboyoun</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Pages</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Lawrence</surname>
          <given-names>M</given-names>
        </name>
        <article-title>GenomicRanges: Representation and manipulation of genomic intervals (R package
version 1.7.36).</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/2.11/bioc/html/GenomicRanges.html">http://www.bioconductor.org/packages/2.11/bioc/html/GenomicRanges.html</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Anders</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Reyes</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Huber</surname>
          <given-names>W</given-names>
        </name>
        <article-title>Detecting diferential usage of exons from RNA-seq data.</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>2008</fpage>
        <lpage>2017</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.133744.111</pub-id>
        <?supplied-pmid 22722343?>
        <pub-id pub-id-type="pmid">22722343</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="other">
        <name>
          <surname>Lawrence</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Carey</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Gentleman</surname>
          <given-names>R</given-names>
        </name>
        <article-title>rtracklayer: R interface to genome browsers and their annotation tracks (R package
version 1.15.7).</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/2.11/bioc/html/rtracklayer.html">http://www.bioconductor.org/packages/2.11/bioc/html/rtracklayer.html</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="other">
        <article-title>ggbio.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.tengfei.name/ggbio">http://www.tengfei.name/ggbio</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="other">
        <article-title>visnab.</article-title>
        <ext-link ext-link-type="uri" xlink:href="https://github.com/tengfei/visnab">https://github.com/tengfei/visnab</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="book">
        <name>
          <surname>Tufte</surname>
          <given-names>E</given-names>
        </name>
        <source>The Visual Display of Quantitative Information</source>
        <year>1983</year>
        <publisher-name>Cheshire, CT: The Graphics Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="other">
        <name>
          <surname>Sarkar</surname>
          <given-names>D</given-names>
        </name>
        <source>lattice: Lattice graphics (R package version 0.17-22 2009)</source>
        <ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=lattice">http://CRAN.R-project.org/package=lattice</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Becker</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Cleveland</surname>
          <given-names>WS</given-names>
        </name>
        <name>
          <surname>Shyu</surname>
          <given-names>MJ</given-names>
        </name>
        <article-title>The visual design and control of trellis displays.</article-title>
        <source>J Comput Graphical Stat</source>
        <year>1996</year>
        <volume>13</volume>
        <fpage>123</fpage>
        <lpage>155</lpage>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
