<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3326335</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkr1292</article-id>
    <article-id pub-id-type="publisher-id">gkr1292</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Use of ChIP-Seq data for the design of a multiple promoter-alignment method</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Erb</surname>
          <given-names>Ionas</given-names>
        </name>
        <xref ref-type="aff" rid="gkr1292-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>González-Vallinas</surname>
          <given-names>Juan R.</given-names>
        </name>
        <xref ref-type="aff" rid="gkr1292-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bussotti</surname>
          <given-names>Giovanni</given-names>
        </name>
        <xref ref-type="aff" rid="gkr1292-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Blanco</surname>
          <given-names>Enrique</given-names>
        </name>
        <xref ref-type="aff" rid="gkr1292-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Eyras</surname>
          <given-names>Eduardo</given-names>
        </name>
        <xref ref-type="aff" rid="gkr1292-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="gkr1292-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Notredame</surname>
          <given-names>Cédric</given-names>
        </name>
        <xref ref-type="aff" rid="gkr1292-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="gkr1292-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="gkr1292-AFF1"><sup>1</sup>Bioinformatics and Genomics program, Centre for Genomic Regulation (CRG) and UPF, 08003 Barcelona, <sup>2</sup>Department of Experimental and Health Sciences, Universitat Pompeu Fabra, 08003 Barcelona, <sup>3</sup>Departament de Genètica / Institut de Biomedicina (IBUB), Universitat de Barcelona (UB), 08028 Barcelona and <sup>4</sup>Catalan Institution for Research and Advanced Studies (ICREA), 08010 Barcelona, Spain</aff>
    <author-notes>
      <corresp id="gkr1292-COR1">*To whom correspondence should be addressed. Tel: <phone>+34 93 3160271</phone>; Fax: <fax>+34 93 3160099</fax>; Email: <email>cedric.notredame@crg.eu</email></corresp>
    </author-notes>
    <!--For NAR both ppub and collection dates generated for PMC processing 1/27/05 beck-->
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>4</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>1</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>1</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>40</volume>
    <issue>7</issue>
    <fpage>e52</fpage>
    <lpage>e52</lpage>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>9</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>11</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>12</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2012. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>We address the challenge of regulatory sequence alignment with a new method, Pro-Coffee, a multiple aligner specifically designed for homologous promoter regions. Pro-Coffee uses a dinucleotide substitution matrix estimated on alignments of functional binding sites from TRANSFAC. We designed a validation framework using several thousand families of orthologous promoters. This dataset was used to evaluate the accuracy for predicting true human orthologs among their paralogs. We found that whereas other methods achieve on average 73.5% accuracy, and 77.6% when trained on that same dataset, the figure goes up to 80.4% for Pro-Coffee. We then applied a novel validation procedure based on multi-species ChIP-seq data. Trained and untrained methods were tested for their capacity to correctly align experimentally detected binding sites. Whereas the average number of correctly aligned sites for two transcription factors is 284 for default methods and 316 for trained methods, Pro-Coffee achieves 331, 16.5% above the default average. We find a high correlation between a method's performance when classifying orthologs and its ability to correctly align proven binding sites. Not only has this interesting biological consequences, it also allows us to conclude that any method that is trained on the ortholog data set will result in functionally more informative alignments.</p>
    </abstract>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>Elucidating gene regulation is a major goal of molecular biology. Most eukaryotic genes are controlled by a non-transcribed region, usually located immediately upstream of the genes, and named a promoter. Promoters may be described as sequences containing protein binding motifs able to interact with a class of regulatory proteins known as Transcription Factors (TFs). The nature of the TF Binding Sites (TFBS) and the way they are combined in the promoter form part of the regulatory process that controls gene expression via some specific interactions with the transcriptional machinery. Identifying and characterizing these TFBSs is therefore an important task, best carried out using experimental techniques such as ChIP-Seq (<xref ref-type="bibr" rid="gkr1292-B1">1</xref>).</p>
    <p>Unfortunately, the cost of ChIP-Seq experiments and their reliance on TF-specific antibodies can be a limiting factor. When this problem arises, comparative genomics can be used to produce useful inferences. This approach relies on the observation that conserved sequences in promoter regions of orthologous genes, also known as footprints, often indicate the presence of functional TF binding sites (<xref ref-type="bibr" rid="gkr1292-B2">2</xref>,<xref ref-type="bibr" rid="gkr1292-B3">3</xref>). [The reverse statement that functional binding sites are conserved is not true, see for example (<xref ref-type="bibr" rid="gkr1292-B4">4</xref>).] It is therefore common practice to use pairwise or multiple sequence alignments as a starting point for predicting TFBSs. This approach, however, can be hampered by the difficulty to assemble accurate genomic DNA alignments. Two factors best explain this difficulty: the low information content resulting from a limited nucleotide alphabet and the lack of strong structural constraints (as happens in proteins) that would limit the amount of variation through purifying selection. Moreover, duplications of transcription factor binding sites and a high-turnover rate in adjacent non-functional DNA often make it impossible to consecutively align corresponding pieces of sequence.</p>
    <p>The most common way to address this problem is to run motif-finding algorithms on sets of sequences expected to contain similar TFBSs, see e.g. (<xref ref-type="bibr" rid="gkr1292-B5 gkr1292-B6 gkr1292-B7 gkr1292-B8 gkr1292-B9 gkr1292-B10">5–10</xref>). Overall, these approaches amount to aligning the putative sites while essentially ignoring their context. This purely local analysis makes a lot of sense when dealing with the promoter of non-homologous co-expressed genes. Yet, situations exist where one would need to accurately align orthologous promoter regions. For instance, when doing whole-genome alignments, it would make sense to use specific TFBSs as constraint sources, since some of them [although heavily depending on the binding factor and the evolutionary distance between genomes, as TFBS turnover is a common phenomenon (<xref ref-type="bibr" rid="gkr1292-B11">11</xref>)], have been shown to evolve significantly slower than their environment (<xref ref-type="bibr" rid="gkr1292-B12">12</xref>). The easiest way to do so is to use experimentally known TFBSs and incorporate their information in position-specific weight matrices (PWMs) during the alignment process. This approach has recently been used in several packages (<xref ref-type="bibr" rid="gkr1292-B7">7</xref>,<xref ref-type="bibr" rid="gkr1292-B8">8</xref>,<xref ref-type="bibr" rid="gkr1292-B13 gkr1292-B14 gkr1292-B15 gkr1292-B16">13–16</xref>) as it can help breaking the vicious circle resulting from the mutual dependency between accurate alignments and accurately predicted TFBSs.</p>
    <p>Aside from improving whole-genome alignment accuracy, the main interest of this approach is to allow the construction of global alignments, thus making it possible to study the evolution of regulatory regions within their genomic context. In practice, however, precious little experimental evidence is available when it comes to vertebrate genomes thus making the reliance on PWMs sometimes difficult. Indeed, a given promoter may contain a regulatory motif that cannot be associated with any known PWM. For this reason, a method is needed that would be able to align promoter regions at nucleotiode level without relying extensively on <italic>a priori</italic> knowledge. This last task defines the goal of our current work: delivering highly accurate alignments of homologous promoter regions, suitable for fine grain evolutionary and functional modeling.</p>
    <p>Because information is scarce at the nucleotide level, our approach involves enriching each nucleotide position with some information on its immediate neighborhood. A variant of this strategy has been successfully exploited, for instance, in the construction of more sophisticated PWMs (<xref ref-type="bibr" rid="gkr1292-B17">17</xref>,<xref ref-type="bibr" rid="gkr1292-B18">18</xref>). Here, we propose to extend the promoter nucleotide sequences with a 16-letters alphabet, where each nucleotide is replaced with a symbol depending on the considered nucleotide and on its immediate 5′ neighbor. The merits of such an extended alphabet have already been demonstrated for producing more accurate alignments of coding DNA (<xref ref-type="bibr" rid="gkr1292-B19">19</xref>) or for searching non-coding RNAs (<xref ref-type="bibr" rid="gkr1292-B20">20</xref>). In the context of this work, we show how this approach can be used to derive promoter-specific substitution matrices and how these matrices can be used within the T-Coffee package (<xref ref-type="bibr" rid="gkr1292-B21">21</xref>) to yield accurate multiple sequence alignments.</p>
    <p>A substantial fraction of the work described here is dedicated to the creation of a benchmark framework suitable for estimating the accuracy of promoter aligners. So far, benchmarks for alignments of functional non-coding sequence have depended on synthetically modeled sequences, thus relying heavily on the model chosen to produce such sequences, see (<xref ref-type="bibr" rid="gkr1292-B22 gkr1292-B23 gkr1292-B24 gkr1292-B25">22–25</xref>). Our framework uses two alternative evaluation procedures. The first one is based on known gene homologies and estimates the merits of an alignment strategy by its capacity to discriminate between orthologous and paralogous promoter regions. This system can be used to optimize the parameters of standard aligners. The second benchmark is an experiment-based validation where methods are evaluated for their capacity to align TFBSs identified using ChIP-Seq. The availability of ChIP-Seq data sets gathered across several species is very recent and to our knowledge it is the first time such a data set is used to determine the relative accuracy of multiple promoter alignment procedures.</p>
    <p>These benchmarks do not only provide a quantification of the accuracy of any considered given method, but they also help to identify common features in the most informative alignments, thus permitting to define an empirical scoring scheme. For instance, we found that high pairwise sequence identity is not the best indicator of accuracy. In practice, optimal modeling seems to result from locally compact alignments made of well-defined blocks interrupted by long stretches of gaps allowing for the correct assignment of corresponding pieces of sequence. Such alignments are rarely obtained when using the default gap penalties of most DNA multiple aligners.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>MATERIALS AND METHODS</title>
    <sec>
      <title>Orthologs and paralogs, alignment methods</title>
      <p>We used Biomart (ENSEMBL version 54) (<xref ref-type="bibr" rid="gkr1292-B26">26</xref>) to extract human, mouse, dog, cow and chicken orthologs resulting in 6822 clusters that are one to one and unique in all pairs of species. Additional download of 13 329 associated human paralogs resulted in a test system of 3258 ortholog clusters for which human paralogs were available. Thus in our homology benchmark on average one ortholog alignment can be compared with four paralog alignments. For the corresponding upstream regions we chose a sequence length of 500 nt for the homology test and 2000 nt for the ChIP-seq benchmark. Since information of multiple transcripts was ignored, Biomart provided the promoter of the longest transcript of a gene. To perform alignments, we used T-Coffee (version 8.9) (<xref ref-type="bibr" rid="gkr1292-B21">21</xref>), Clustal W (1.82) (<xref ref-type="bibr" rid="gkr1292-B27">27</xref>), ProbCons (1.12) (<xref ref-type="bibr" rid="gkr1292-B28">28</xref>), Muscle (3.7) (<xref ref-type="bibr" rid="gkr1292-B29">29</xref>), Mafft (6.624 b) (<xref ref-type="bibr" rid="gkr1292-B30">30</xref>). We did not perform profile alignments, i.e. we did not align the human ortholog/paralog to a previously obtained ortholog alignment. An artificial 20-letter palindrome was added to the start of all promoter regions to avoid discrepancies resulting from a different handling of terminal gap penalties. Percent identity of an alignment was calculated according to T-Coffee's seq reformat tool, i.e. dividing the number of nucleotide identities by the number of ungapped nucleotide pairs and averaging over all pairs of sequences in the alignment.</p>
    </sec>
    <sec>
      <title>Gap training and substitution matrix</title>
      <p>We trained T-Coffee, Muscle and Mafft directly on the test system using sequences of length 500 nt upstream of TSS (see <xref ref-type="fig" rid="gkr1292-F1">Figure 1</xref> for the gap-opening penalties used). We also tried some change of gap-extension penalties. In the case of Muscle the default is 0, and adding a penalty does not improve results. In the case of Mafft, changing the default GEP = −0.123 to 0 leads to a substantial improvement. For Pro-Coffee, GEP = −1 gave better results than no penalty. The BlosumPro substitution matrix (right panel of <xref ref-type="fig" rid="gkr1292-F2">Figure 2</xref>) was constructed from 425 TFBS alignments from TRANSFAC for vertebrate transcription factors. Multiple alignments of TF binding sites were transformed into one long pairwise alignment such that introduction of dummy nucleotides avoided direct neighboring of consecutive sites. The resulting alignment was translated into a dinucleotide alphabet (cf inset in <xref ref-type="fig" rid="gkr1292-F2">Figure 2</xref>), where a sequence ‘ACG’ e.g. would result in ‘ELG’ where E stands for ‘AC’ and L for ‘CG’ (the last letter in the original sequence is retained). Finally, log-odd ratios were built from conditional probabilities of a nucleotide from sequence 1 to be aligned to a nucleotide from sequence 2, given their respective left neighbors, divided by the product of the respective single conditional probabilities:
<disp-formula><graphic xlink:href="gkr1292um1"/></disp-formula>
<fig id="gkr1292-F1" position="float"><label>Figure 1.</label><caption><p>Gap-opening penalty (GOP) training of the homology test for promoter regions of length 500 nt. Penalties for linked-pairwise T-Coffee (‘slow_pair’ mode): −90 to −10 counting points from left to right in steps of 10 (optimal: −50). Pro-Coffee: −100 to −10 in steps of 10 (optimal: −60). Muscle: −1200 to −200 in steps of 100 (optimal: −900). Mafft: 4 to 0.5 in steps of 0.25 (optimal: 2.75). Pro-Coffee uses a gap-extension penalty (GEX) of −1, for the other methods a gap-extension of 0 performed best. Default settings are shown as single points (Mafft: GOP = 1.53 GEX = 0.123, Muscle: GOP = −400, GEX = 0, T-Coffee–method = slow_pair: GOP = −10, GEX = −1).</p></caption><graphic xlink:href="gkr1292f1"/></fig>
<fig id="gkr1292-F2" position="float"><label>Figure 2.</label><caption><p><bold>(A)</bold> Average lateral dependency between nucleotides in 6882 human promoter regions of length 500 nt. The mutual information drops by over 50% going from the immediate neighbor to the next nearest neighbor. <bold>(B)</bold> BlosumPro dinucleotide substitution matrix. The inset shows the recoding of the nucleotide alphabet, where nucleotides in the rows are left neighbors of nucleotides in the columns.</p></caption><graphic xlink:href="gkr1292f2"/></fig></p>
      <p>The resulting values were divided by 0.3 and rounded to the nearest integer value to obtain a blocks substitution matrix in units of 3/10 bits. Before the alignment with this matrix is performed, sequences are translated into the new alphabet of 16 letters (plus 5 additional letters for the last bases in the sequence and an ‘unknown letter’ character). After the alignment is performed, the letters are translated back into mono-nucleotides. To calculate the relative entropy in analogy to what is done in (<xref ref-type="bibr" rid="gkr1292-B31">31</xref>), we take the expectation value of the log ratio above w.r.t. the joint distribution of bases aligned in position <italic>i</italic> and neighboring bases aligned in <italic>i-</italic>1.</p>
    </sec>
    <sec>
      <title>Mapping and peak calling from ChIP-Seq data</title>
      <p>Raw data produced by (<xref ref-type="bibr" rid="gkr1292-B4">4</xref>) was downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/arrayexpress/files/E-TABM-722/E-TABM-722.idf.txt">http://www.ebi.ac.uk/arrayexpress/files/E-TABM-722/E-TABM-722.idf.txt</ext-link>. Mapping of the data for human (hg18), mouse (mm9), dog (canFam2) and chicken (galGal3) for both experiment and control sequence files was done using GEM (<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/apps/mediawiki/gemlibrary/index.php?title=The_GEM_library#Docmentation">http://sourceforge.net/apps/mediawiki/gemlibrary/index.php?title=The_GEM_library#Docmentation</ext-link>) allowing up to two mismatches, with default settings as quality filter (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Tables S1</ext-link>). Peak finding was done with Pyicos (<xref ref-type="bibr" rid="gkr1292-B32">32</xref>), extending reads to the value calculated by the strand correlation, and using the operations of normalization, subtraction and filtering with a Poisson test on read clusters. Significance of reads is associated with peak height, and the resulting <italic>P</italic>-values are subject to a quality cut-off. We selected the cutoff resulting in the most robust ranking for the considered methods (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Figure S3</ext-link>). The final <italic>P</italic>-value cut-off we chose is <italic>P</italic> ≤ 10<sup>−6</sup>, which led to overall numbers of called peaks that are similar to the so-called ‘lenient setting’ reported in (<xref ref-type="bibr" rid="gkr1292-B4">4</xref>), (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Table S2</ext-link>). The binding regions were obtained by centering regions of 100 nucleotides over the genomic coordinates of significant peaks. Coordinates of these regions were then used to fetch their sequences from the Galaxy genome browser and mapped back onto the alignments. See <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Tables S3</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">S4</ext-link> for numbers of peaks called within the orthologous promoter cliques.</p>
    </sec>
    <sec>
      <title>Counting binding site pairs in overlapping factor binding regions</title>
      <p>Prediction of TFBSs in the binding regions for the factors CCAAT/enhancer-binding protein alpha (CEBPA) and hepatocyte nuclear factor 4 alpha (HNF4a) was done using MatScan (<xref ref-type="bibr" rid="gkr1292-B33">33</xref>) along with Jaspar weight matrices (<xref ref-type="bibr" rid="gkr1292-B34">34</xref>). All predicted sites are considered equally valid (also if they overlap) as long as they fall into the 100 nt factor binding regions and have a motif identity no worse than 70%. This cut-off gives a good trade-off between quality of the sites and amount of differential performance of the alignment methods. We show that it has no significant effect on the ranking of performance of the methods, see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Figure S4</ext-link>. We then count for each species combination and factor the total number of gaplessly aligned TFBS pairs falling in ChIP-seq regions as our final benchmark called ‘aligned site pairs’ (cf the two green pairs in the lower panel of <xref ref-type="fig" rid="gkr1292-F3">Figure 3</xref> falling in the overlap of the yellow regions). We also estimated an upper bound on the number of alignable site pairs for one pair of species by taking the smaller of the two numbers of TFBSs in each species falling into our promoters. This upper bound is the number of ‘putative site pairs’. The fraction of putative sites eventually aligned is around 15% when considering mammalian genomes, and down to around 1% for chicken (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Figure S6</ext-link>). This is because many of the TFBS fall in regions that do not get aligned, or regions that do not overlap sufficiently in the alignments, reflecting the greater evolutionary distance of chicken (cf also <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Tables S4</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">S5</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Figure S5</ext-link>). We also define the number of ‘alignable site pairs’ as the minimum of TFBS over two species falling in the overlapping binding regions, cf <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Figure S7</ext-link>.
<fig id="gkr1292-F3" position="float"><label>Figure 3.</label><caption><p>A comparison between alignments of the upstream region of the human gene C18orf19 produced by the gap-trained version of T-Coffee and Pro-Coffee. Highlighted in yellow are ChIP-seq regions for CEBPA, colored sequences are predicted binding sites for this factor that are either in (green) or outside of (red) the factor-binding regions. Unlike T-Coffee, Pro-Coffee manages to correctly align the highlighted regions and their binding sites.</p></caption><graphic xlink:href="gkr1292f3"/></fig></p>
    </sec>
  </sec>
  <sec>
    <title>RESULTS</title>
    <sec>
      <title>Comparing DNA sequences with a dinucleotide evolutionary model</title>
      <p>When considered as independent 4-letters strings, DNA sequences have very low information content, which limits their usage in many sequence-based applications. The effective information content is, however, often higher and can be recovered by taking into account dependencies that define a higher order alphabet. Coding potentials are probably the best example of such a higher order alphabet encoded in DNA sequences. Unfortunately, identifying similar alphabets in non-coding regions has proven an elusive task, probably as a consequence of the high heterogeneity of functions supported by DNA, ranging from regulatory control to nucleosome positioning. The features controlling these functions are encoded within DNA in a non-uniform way that makes them hard to use when comparing sequences. Yet, the nearest neighbor information is a simple feature that can easily be incorporated in the sequences in order to improve the accuracy of sequence comparisons. One can do this by simply recoding each nucleotide so that it reflects both its own nature and the nature of its immediate 5′ neighbor. Since a nucleotide can have four different 5′ neighbors, one can therefore replace each position with a symbol drawn from a 16-letters alphabet (4 × 4). The recoded string will then have exactly the length of the original string, including the last nucleotide, which is kept non-recoded.</p>
      <p>This type of recoding only makes sense if a significant dependency exists between adjacent nucleotides, and if this dependency results in evolutionary constraints. Dependencies can easily be measured on unaligned sequences, by estimating whether some dinucleotides have a higher frequency than one would expect by combining their individual frequency. Such analysis was used recently to show the existence of a significant lateral dependency in RNA sequences (<xref ref-type="bibr" rid="gkr1292-B20">20</xref>). We did a similar analysis here by considering the promoter region of 6882 genes in human (see ‘Materials and Methods’ section). Results are displayed in the left panel of <xref ref-type="fig" rid="gkr1292-F2">Figure 2</xref> and indicate that the strongest dependency occurs between each residue and its nearest neighbor. These findings are consistent with those recently reported in (<xref ref-type="bibr" rid="gkr1292-B20">20</xref>) and suggest that this pattern of dependency is a low level feature of DNA, possibly resulting from structural constraints (<xref ref-type="bibr" rid="gkr1292-B35">35</xref>). In the context of promoters, the existence of such dependencies has long been discussed as limiting in promoter analysis methodology (<xref ref-type="bibr" rid="gkr1292-B36">36</xref>). Indeed, classical PWMs assume positions to be independent from each other.</p>
      <p>Having established the existence of a lateral bias, we then made an attempt to determine whether this bias has evolutionary consequences, that is to say, a tendency of evolution to maintain certain dinucleotides or to influence mutation patterns along promoter regions. We did so by collecting 425 seed alignments of TFBSs used to compute the TRANSFAC weight matrices (<xref ref-type="bibr" rid="gkr1292-B37">37</xref>). In order to make the resulting matrix as informative as possible, we only kept pairwise projections having between 60% and 90% identity. This made a total of 117 172 projections, on which the rate of dinucleotide substitution was measured. The matrix itself was estimated as a standard log-odd matrix (see ‘Materials and Methods’ section). Using the Altschul formula (<xref ref-type="bibr" rid="gkr1292-B31">31</xref>), we found this matrix to have a relative entropy of 0.72, a figure comparable to that of a BLOSUM62 (0.7).</p>
      <p>One could consider the two nearest neighbors (5′ and 3′). Yet, the tiny extra information from next-nearest neighbor dependency one would obtain this way would not justify the problems caused from an alphabet exceeding the amino acid alphabet (which leads to matrices that cannot be used in standard aligners). In contrast, the matrix we designed can be used by a novel mode of T-Coffee, named Pro-Coffee, designed to align promoter sequences. In order to estimate Pro-Coffee's accuracy, we have designed two benchmarks, one based on evolutionary analysis and a second one based on experimental ChIP-Seq data. The rest of this section describes the principle of each benchmark and their readouts on Pro-Coffee and other popular aligners.</p>
    </sec>
    <sec>
      <title>An evolutionary Benchmark for Promoter Alignments</title>
      <p>A standard strategy when evaluating multiple sequence alignment (MSA) methods is to use reference alignments as a standard of truth (<xref ref-type="bibr" rid="gkr1292-B38">38</xref>). In proteins, these gold standards are usually established on the basis of structural information. In principle, reference alignments can also be established by specialists but, when doing so, there is always a risk of circularity. An alternative assessment method is to estimate the modeling capacities of MSAs, that is to say, their capacity of accurately predicting key properties of the considered sequences. This approach is quite realistic since most MSAs are indeed intermediate models, meant to be fed to other modeling techniques. In the context of this benchmark, we decided to estimate the capacity of promoter alignments to help recognizing true orthologous sequences. Two genes are said to be one-to-one orthologs when they are only separated by a speciation event and no duplication. Orthology is inferred on protein sequences, taking advantage of their evolutionary resilience in order to recognize distant relationships. The most trustworthy way to infer these relations usually involves estimating a phylogenetic tree from a multiple sequence alignment and then comparing its topology with a reference Tree of Life (<xref ref-type="bibr" rid="gkr1292-B39">39</xref>). We first assembled a data set of 6882 ENSEMBL (<xref ref-type="bibr" rid="gkr1292-B26">26</xref>) genes represented by a fully connected graph of one-to-one-orthologous relationships between human, mouse, dog, cow and chicken (see ‘Materials and Methods’ section). Among these, we identified 3258 families for which the human ortholog has one or more human paralogs. By definition, these paralogs correspond to duplications older than the last unique common ancestor of the considered species. Given such a data set, the principle of our analysis is to incorporate each human paralog within an MSA made of the orthologs from the four other species. When doing so, one is left with one distinct MSA for each human paralog. These alignments are used to predict the true ortholog that we define as the paralog yielding the highest level of average identity with the orthologs from other species</p>
      <p>This approach may seem like an over-simplification of standard orthologous assignment procedures, but one must consider that the system is provided with a lot of information, in the form of the set of bona fide orthologs to which the human paralogs are compared in turn. We first validated this approach by assessing its capacity to recognize the correct orthologous protein sequences when fed with the collection of selected genes. As expected, and with the default mode of all the aligners used in this study, the prediction accuracy was higher than 97%. This means that in virtually all cases, the human homolog having the highest level of identity with the orthologs from other species was the one considered by ENSEMBL to be the one-to-one ortholog. Having validated the capacity of our framework to effectively deal with protein sequences, we then applied it to the promoter regions, defined as the 500-nt upstream of the transcription start site (TSS) of the same genes.</p>
      <p>Results are shown in the first column of <xref ref-type="table" rid="gkr1292-T1">Table 1</xref>. As one would expect, the classification accuracies are significantly lower than reported for protein-coding regions and range from 70% for the lowest (T-Coffee default) to 76% for the most accurate method (Mafft). These differences correspond to about 200 data sets and are therefore significant from a statistical point of view. While on the one hand this read out confirms the rather poor performances of T-Coffee on DNA sequence, they also reflect the wide range of accuracies one can achieve with the most commonly used methods. Interestingly, when using the default parameters, only around 50% of the genes are consistently classified correctly by all the methods (For a three-way Venn-diagram analysis of selected methods, see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Figure S1</ext-link>). It is important to understand that our goal here is not to classify correctly promoters, but rather to ask about the influence of the underlying MSA when doing such a classification. In summary, we consider the fraction of correctly classified promoters an indicator of an aligner's accuracy. Such a readout makes it possible to do some parameter tuning, and we did so on the gap penalty scheme.
<table-wrap id="gkr1292-T1" position="float"><label>Table 1.</label><caption><p>Effect of optimization for the recognition of orthologous promoter regions</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1">Default</th><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Optimized</th><th rowspan="1" colspan="1"/></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">T-Coffee<xref ref-type="table-fn" rid="gkr1292-TF1"><sup>a</sup></xref></td><td rowspan="1" colspan="1">69.6</td><td rowspan="1" colspan="1">2.1</td><td rowspan="1" colspan="1">75.8</td><td rowspan="1" colspan="1">3.8</td></tr><tr><td rowspan="1" colspan="1">Pro-Coffee</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">80.4</td><td rowspan="1" colspan="1">3.9</td></tr><tr><td rowspan="1" colspan="1">ProbCons</td><td rowspan="1" colspan="1">70.1</td><td rowspan="1" colspan="1">2.1</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">ClustalW</td><td rowspan="1" colspan="1">72.4</td><td rowspan="1" colspan="1">2.8</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">Muscle</td><td rowspan="1" colspan="1">75.1</td><td rowspan="1" colspan="1">2.9</td><td rowspan="1" colspan="1">77.6</td><td rowspan="1" colspan="1">3.8</td></tr><tr><td rowspan="1" colspan="1">Mafft</td><td rowspan="1" colspan="1">75.7</td><td rowspan="1" colspan="1">3.4</td><td rowspan="1" colspan="1">79.5</td><td rowspan="1" colspan="1">3.6</td></tr></tbody></table><table-wrap-foot><fn id="gkr1292-TF1"><p>Percent correctly classified orthologs (first and third columns) and average difference in identity between true ortholog alignment and best paralog alignment (second and fourth columns).</p></fn><fn id="gkr1292-TF2"><p><sup>a</sup>T-Coffee is run in the ‘slow_pair’ mode instead of the (not tunable) default setting ‘proba_pair’.</p></fn></table-wrap-foot></table-wrap></p>
      <p>The gap penalty scheme is arguably the most complex ingredient in an alignment. Correct values depend on a variety of parameters, mostly unknown, which include the indel propensity and the local functional constraints (<xref ref-type="bibr" rid="gkr1292-B40">40</xref>,<xref ref-type="bibr" rid="gkr1292-B41">41</xref>). In protein alignments, the use of improved gap penalty schemes has been shown to be a critical feature for the generation of highly accurate alignments. We followed that same approach to ask whether different values of gap extension and gap opening penalties might have an effect on the classification capacities of the resulting alignments. Two packages were not considered here, ProbCons that does not have an explicit gap penalty scheme and ClustalW that uses an automated gap penalty estimator that makes it hard to control the effect of the procedure. The other methods were evaluated by measuring the level of correct classification achieved when using a pair of gap extension and gap opening penalties (GOP, GEP) within a given range (cf ‘Materials and Methods’ section). The results of this optimization process are shown in <xref ref-type="fig" rid="gkr1292-F1">Figure 1</xref> and in the second column of <xref ref-type="table" rid="gkr1292-T1">Table 1</xref>. Our data suggest that all methods benefit from the tuning and tend to reach a similar level of accuracy (close to 80%) when appropriately optimized. All the differences reported here are statistically significant. A random method with a 75% success rate would have a (binomial) standard deviation of 25 data sets, compared to the 80 data sets gained by the method showing least improvement. <xref ref-type="table" rid="gkr1292-T1">Table 1</xref> also shows that the average differential identity between the true ortholog alignment and the best alignment of a paralog tends to slightly increase after tuning, although this trend is relatively moderate (about 1% point). Another point revealed by <xref ref-type="fig" rid="gkr1292-F1">Figure 1</xref> is that, against simple expectations, the alignments yielding the highest level of identity are not the most predictive ones. Indeed those achieving this goal, regardless of the methods, have an average level of identity close to 45%—way below the 65% of identity all these methods can achieve on this data set. This simple observation indicates the existence of a subtle trade-off between insertions, deletions and substitutions, a situation that could hamper the design of an objective function effectively reflecting the accuracy of promoter alignments. The last conclusion one can draw from <xref ref-type="table" rid="gkr1292-T1">Table 1</xref> and <xref ref-type="fig" rid="gkr1292-F1">Figure 1</xref> is that all things being equal, the best results on this data set are achieved using Pro-Coffee, the new dinucleotide based method. In an additional test we also considered three subsets of our ortholog cliques that show a varying degree of percent identity. The improvement after training on the entire set occurs alike for low, intermediate, and high sequence identity subsets (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Figure S2</ext-link>.)</p>
      <p>The main limitation of these results is the potential circularity that may exist on the reference data set. Indeed the ENSEMBL orthologs are predicted on the basis of sequence similarity, and though we base our analysis on the promoters regions, we are nonetheless trying to re-establish, on the basis of sequence similarity, a result that originally already depended on sequence similarity. Furthermore, even if we ignore this potential tautology and consider these alignments to accurately reflect the effect of optimization on orthology inference, we still have no indication that these alignments could be more informative from a functional point of view. We therefore decided to ask this precise question by taking advantage of a newly available ChIP-Seq data set providing experimental TFBS information across several species.</p>
    </sec>
    <sec>
      <title>Benchmarking promoter MSA methods using ChIP-Seq data</title>
      <p>When the position of each TFBS is known beforehand, the best strategy to establish the accuracy of a sequence alignment would be to simply count the number of TFBSs effectively matched across species. Until recently, this was impossible because this information was available only for a few sites which had been experimentally established for a handful of TFs in single species. Fortunately, the situation has recently improved and data are now available for CEBPA and HNF4a across five and three species, respectively [taken from (<xref ref-type="bibr" rid="gkr1292-B4">4</xref>)]. This experimental data can be considered the equivalent of structural information when doing protein alignments and it allows an evaluation of our alignments based on a functional comparison rather than sequence comparison.</p>
      <p>We constructed this benchmark data set by calling the peaks from ChIP-Seq to map the putative TFBSs on the corresponding genomes (see ‘Materials and Methods’ section). We then considered the 2000-nt upstream of the TSS in each of the 6882 data sets made of one-to-one ENSEMBL orthologous genes. From these, we kept only the ones with ChIP-Seq binding regions in at least two species (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Table S4</ext-link>). Now we scanned the binding regions for matches to the PWM of its respective transcription factor (see ‘Materials and Methods’ section). Once aligned, each data set was evaluated by counting the number of perfectly aligned binding sites. Results are summarized in <xref ref-type="table" rid="gkr1292-T2">Table 2</xref> and <xref ref-type="fig" rid="gkr1292-F4">Figure 4</xref>.
<fig id="gkr1292-F4" position="float"><label>Figure 4.</label><caption><p>Number of gaplessly aligned ChIP-Seq validated binding-site pairs per species combination for both transcription factors and all the methods tested. Best performances are achieved by methods whose gap penalties were optimized using the homology test. Pro-Coffee and optimized Mafft perform best or equally well as the best method on three data sets, followed by the optimized versions of Muscle (two data sets), and T-Coffee (one data set).</p></caption><graphic xlink:href="gkr1292f4"/></fig>
<table-wrap id="gkr1292-T2" position="float"><label>Table 2.</label><caption><p>Comparison of performance for the correct alignment of ChIP-Seq regions</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th colspan="2" align="center" rowspan="1">CEBPA<hr/></th><th colspan="2" align="center" rowspan="1">HNF4a<hr/></th></tr><tr><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1">Default</th><th rowspan="1" colspan="1">Optimized</th><th rowspan="1" colspan="1">Default</th><th rowspan="1" colspan="1">Optimized</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">T-Coffee<xref ref-type="table-fn" rid="gkr1292-TF2"><sup>a</sup></xref></td><td rowspan="1" colspan="1">106</td><td rowspan="1" colspan="1">136</td><td rowspan="1" colspan="1">137</td><td rowspan="1" colspan="1">163</td></tr><tr><td rowspan="1" colspan="1">Pro-Coffee</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1"><bold>153</bold></td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">178</td></tr><tr><td rowspan="1" colspan="1">ClustalW</td><td rowspan="1" colspan="1">120</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">128</td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">ProbCons</td><td rowspan="1" colspan="1">125</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">152</td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">Muscle</td><td rowspan="1" colspan="1">142</td><td rowspan="1" colspan="1">150</td><td rowspan="1" colspan="1">170</td><td rowspan="1" colspan="1">173</td></tr><tr><td rowspan="1" colspan="1">Mafft</td><td rowspan="1" colspan="1">139</td><td rowspan="1" colspan="1">147</td><td rowspan="1" colspan="1">159</td><td rowspan="1" colspan="1"><bold>179</bold></td></tr></tbody></table><table-wrap-foot><fn id="gkr1292-TF3"><p><sup>a</sup>T-Coffee is run in the ‘slow_pair’ mode instead of the (not tunable) default setting ‘proba_pair’.</p></fn><fn id="gkr1292-TF4"><p>Numbers of gaplessly aligned proven binding site pairs summed over all species pairs.</p></fn></table-wrap-foot></table-wrap></p>
      <p>We tested both the methods with default settings and the ones optimized on the ortholog-calling data set. Interestingly, the results obtained on the ChIP-Seq data agree broadly with those estimated on the ortholog prediction framework. Before gap-penalty optimization, Muscle and Mafft clearly dominate, while the methods optimized on the orthologous data sets all outperform the default. These trends are consistent between CEBPA and HNF4a. Overall, the improvement of the optimized methods over the default ranges between 5.3% (Muscle) and 22.1% (T-Coffee) on CEBPA, with differences in a similar range on HNF4a (1.7% on Muscle and 16.0% on T-Coffee). As reported for the ortholog prediction data set, Pro-Coffee is either the best (CEPBA) or the second best (HNF4a) method. These global results are in good agreement with observations made by comparing the TFBS alignments on genome pairs (<xref ref-type="fig" rid="gkr1292-F4">Figure 4</xref>). Pro-Coffee and Mafft win or score equal to the best method on three out of seven data sets, followed by the optimized versions of Muscle (two data sets), and T-Coffee (one data set). Note that <xref ref-type="fig" rid="gkr1292-F4">Figure 4</xref> has only limited implications regarding general statements about the degree of binding site conservation in promoter regions of the considered species, as we are showing data for a specific (highly conserved) subset of promoters, and differences in the level of genome annotation can also lead to artifacts.</p>
      <p>The correspondence between the readouts observed on the ortholog prediction data set and the ChIP-Seq alignment accuracy is quite remarkable. We quantified it and found a correlation of <italic>r</italic><sup>2 </sup>= 0.85 (<italic>P</italic> = 3.8 × 10<sup>−4</sup>) for CEBPA (<xref ref-type="fig" rid="gkr1292-F5">Figure 5</xref>) and <italic>r</italic><sup>2 </sup>= 0.72 (<italic>P</italic> = 4.0 × 10<sup>−3</sup>) for HNF4a (data not shown). Interestingly, we found no correlation when trying to relate either the orthologous prediction accuracy (<xref ref-type="fig" rid="gkr1292-F6">Figure 6</xref>) or the ChIP-Seq alignment accuracy (data not shown) with the average percent identity delivered by the various methods considered here. This finding confirms our observation that high sequence identity is not necessarily associated with highly informative alignments. The high correlation between the ChIP-Seq readout and orthology prediction is more interesting as it suggests a relationship between functionally and evolutionarily correct alignments. As discussed in (<xref ref-type="bibr" rid="gkr1292-B11">11</xref>), binding site conservation should rather be considered in terms of binding site density in corresponding regions than precise nucleotide-to-nucleotide conservation. We will show in the following subsection that our ortholog training helps improving this large-scale property of alignments to match corresponding regions, whereas it has little effect at the nucleotide level. A significant implication is that a simple homology based set-up is as effective as a very complex experiment-based analysis for the training of promoter alignment methods.
<fig id="gkr1292-F5" position="float"><label>Figure 5.</label><caption><p>Performance on the ChIP-Seq test using CEBPA versus the homology test for all methods. There is good correlation between the two benchmarks (<italic>r</italic><sup>2 </sup>= 0.85, <italic>P</italic> = 3.8 × 10<sup>−4</sup>). A similar correlation is observed for HFN4a (data not shown).</p></caption><graphic xlink:href="gkr1292f5"/></fig>
<fig id="gkr1292-F6" position="float"><label>Figure 6.</label><caption><p>Homology test performance versus percent identity of the ortholog alignments for all methods. It can be seen that high average pairwise identity between sequences in an alignment is no indicator of alignment quality. Generally, optimizing methods leads to a loss in percent identity so as to reach an intermediate level that is similar in all methods that perform well. The same trend can be observed for the ChIP-Seq test performance (data not shown).</p></caption><graphic xlink:href="gkr1292f6"/></fig></p>
    </sec>
    <sec>
      <title>Good alignments may neither be short nor highly identical</title>
      <p>Comparing alignment methods gives some insight into what are properties of alignments that perform well in our tests. First of all, it is clear that the best test results are obtained for an intermediate percent identity of the ortholog alignments (<xref ref-type="fig" rid="gkr1292-F1">Figures 1</xref> and <xref ref-type="fig" rid="gkr1292-F6">6</xref>). Neither very high column identities (often resulting in fuzzy alignments with isolated gaps) nor low column identities (yielding a short alignment of essentially one big block) give satisfactory results. <xref ref-type="fig" rid="gkr1292-F6">Figure 6</xref> shows the lack of correlation between the homology test performance and the average percent identity of alignments. Default parameters can be such that alignments are above (ProbCons, T-Coffee and Muscle) or below (ClustalW) this optimal identity, but it is generally achieved when training gap penalties.
<fig id="gkr1292-F7" position="float"><label>Figure 7.</label><caption><p>Distribution of alignment columns depending on the number of gaps they contain. Pro-Coffee (light gray bars) produces less compact alignments, whereas both the default and the tuned version of T-Coffee (dark gray and black bars, respectively) tend to over-align, resulting in column distributions that strongly peak in ungapped columns. This insertion of less gaps results in significantly shorter alignments (as shown in the inset). Data shown for the alignments that were used for the ChIP-Seq test (regions of length 2000 nt).</p></caption><graphic xlink:href="gkr1292f7"/></fig></p>
      <p>The results suggest that good alignments stem from a trade-off between introducing sufficient gaps and keeping a compact block structure. In order to better understand what makes a method perform better, we characterized alignments produced by the default T-Coffee, the optimized T-Coffee and Pro-Coffee (<xref ref-type="fig" rid="gkr1292-F7">Figure 7</xref>). Pro-Coffee's better performance goes along with a more equilibrated alignment-column distribution. While T-Coffee default and also the optimized T-Coffee show high frequencies for columns not containing gaps, Pro-Coffee alignments have many more columns containing at least one gap, so alignments are generally much longer. When optimizing Mafft, the same trend toward longer alignments can be observed (data not shown).</p>
      <p>In <xref ref-type="fig" rid="gkr1292-F3">Figure 3</xref>, we show an example where the optimized T-Coffee's tendency to yield alignments that are still too short makes it less likely to align truly corresponding pieces of sequence (ChIP-Seq regions highlighted in yellow), which Pro-Coffee does manage to align.</p>
      <p>The two observations, that base-to-base identities are not maximized, and that alignments tend to get longer, suggest that we are optimizing on a larger scale, i.e. making truly corresponding regions coincide in the alignments rather than better matching single nucleotides. This can be seen from another angle as well: <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Figure S6</ext-link> shows the aligned site pairs as percentage of putative sites. We now discuss a kind of ‘decomposition’ of this result into large-scale and fine-grained properties. The number of TFBSs falling in overlapping ChIP regions for a given species pair increases in almost all cases for all the methods after optimization (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Figure S7</ext-link>). This is a large-scale property in the sense that it requires the correct regions to be aligned, but not the single binding sites to match. When now looking at the percentage of those that do match, we see that there is no general increase in the optimized methods, it often even decreases (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Figure S8</ext-link>).</p>
    </sec>
  </sec>
  <sec>
    <title>DISCUSSION</title>
    <p>In this work, we are presenting a novel promoter alignment method, along with two benchmarks that can be used either for estimating the accuracy of any method designed for the same type of sequences or even for exploring the parameter space. By promoter alignment, we mean promoter sequences related closely enough so that an alignment may be carried out without much need to re-arrange the order of TFBSs. For this purpose, we have implemented within the T-Coffee package a novel alignment mode named Pro-Coffee. The default T-Coffee relies on the assembly of a collection of pairwise alignments. The collection is named a library, and the multiple alignment is assembled using the progressive alignment algorithm and the library as a position-specific scoring scheme. This general scheme defines the popular consistency based progressive alignment algorithm, an algorithm that is now forming the basis of the most accurate sequence aligners (<xref ref-type="bibr" rid="gkr1292-B42">42</xref>). In Pro-Coffee, the only difference with the original T-Coffee is the computation of the library using a pairwise aligner that relies on a dinucleotide matrix to align pairs of promoter regions. Our choice to use a dinucleotide matrix is based on two observations: the existence of a significant amount of mutual information between adjacent nucleotides in promoter regions, and the possibility to estimate dinucleotide matrices from TFBS collections, with an entropy comparable to standard amino acid substitution matrices.</p>
    <p>We then designed a first data set to estimate the relative accuracy of Pro-Coffee when compared with other multiple aligners. In contrast with other MSA reference data sets, we do not evaluate aligners for their capacity to recapitulate a set of reference alignments, but rather for their capacity to produce the most informative MSAs. In this context, the alignments were evaluated for their capacity to discriminate the true ortholog within a set of alternative human paralogs. Using this simple test, we show that there is a wide range of disparity among the most widely used aligners. Furthermore, using the fraction of correctly identified orthologs, we show that one can train the available method by exploring a range of gap opening penalties. All methods benefit from this training, though Pro-Coffee is the one eventually achieving the highest accuracy. The main strength of this benchmark is its non-reliance on some reference alignment that would be very hard to establish unambiguously. This makes even more sense if considering that in general, MSAs are not the purpose of a project but rather an intermediate model used to feed some other modeling technique. On the other hand, the downside of this approach is its heavy reliance on ENSEMBL defined sets of orthologs. Defining ortholog sets is a highly non-trivial procedure and methods able to unambiguously identify orthologous data sets remain an important focus of research in phylogeny (<xref ref-type="bibr" rid="gkr1292-B39">39</xref>). In this context, one may therefore argue that our tuning is simply a complicated way to recapitulate the ENSEMBL procedure. Of course, one can argue against this that ENSEMBL orthologs are defined from tree comparisons of protein coding genes, while ours result from the comparison of promoter alignments. But overall, one is left here with the observation that a sequence-based analysis (ENSEMBL) is used to validate another sequence-based analysis (Pro-Coffee multiple alignments).</p>
    <p>We addressed this problem by designing a second data set, made of 6882 multiple sequence alignments of promoter regions. These promoter regions are also expected to be orthologs (according to the ENSEMBL definition), but in this case the true nature of the postulated orthology is not critical. The only thing that really matters is the existence of a homology relationship between the considered sequences. On this data set, we projected the results of a ChIP-Seq experiment carried out for HNF4a and CEBPA on, respectively, three and four vertebrates. Thanks to this data we then evaluated the aligners for their capacity to match as many as possible homologous TFBSs. Of course, one may argue that this data set is heavily biased toward functional similarity and that alignments evaluated this way may not reflect the true history of the considered sequences. Fortunately, this does not seem to happen in practice, and we show unambiguously the existence of a strong correlation between the readouts obtained on the ortholog data set and those obtained on the ChIP-Seq data set.</p>
    <p>This finding does not only support our claim that Pro-Coffee is currently one of the best methods for aligning promoter regions, it goes much further. First of all, it shows that our benchmark is providing the community with the first ever experiment-based benchmark for the evaluation of genomic DNA alignment accuracy. [ChIP-Seq data in a single species has very recently been used to verify the predictive power of a method that simultaneously aligns and detects regulatory elements (<xref ref-type="bibr" rid="gkr1292-B16">16</xref>). Also, there has been an experimental validation of DNA alignments in protein-coding regions see (<xref ref-type="bibr" rid="gkr1292-B43">43</xref>)]. As such, the validation may be used to improve any method one wishes to apply on this type of sequences. The correlation between the readouts measured on the two data sets is even more interesting. It indicates that a simple analysis based on sequence comparison can be considered to be as informative as an analysis based on the integration of highly sophisticated and expensive experiments. This observation has important implications for the accurate alignment of genomic DNA. Such accurate alignments will find a multitude of important applications, starting with the improvement of the input required by TFBS discovery programs doing motif-finding [PhyloGibbs (<xref ref-type="bibr" rid="gkr1292-B44">44</xref>)] or motif scanning algorithms [e.g. Monkey (<xref ref-type="bibr" rid="gkr1292-B45">45</xref>), MotEvo (<xref ref-type="bibr" rid="gkr1292-B46">46</xref>)] that take phylogeny into account. For a review of such methods see (<xref ref-type="bibr" rid="gkr1292-B47">47</xref>).</p>
  </sec>
  <sec>
    <title>AVAILABILITY</title>
    <p>The software is part of the T-Coffee package, an open source freeware available from www.tcoffee.org. Benchmark data sets can be downloaded via the Pro-Coffee homepage at <ext-link ext-link-type="uri" xlink:href="www.tcoffee.org/Projects_home_page/procoffee_home_page.html">www.tcoffee.org/Projects_home_page/procoffee_home_page.html</ext-link>.</p>
  </sec>
  <sec>
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr1292/DC1">Supplementary Data</ext-link> are available at NAR Online. Supplementary Tables 1–5, Supplementary Figures 1–8.</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p>Funding for open access charge: The <funding-source>Centre for Genomic Regulation (CRG)</funding-source> (to C.N.); the <funding-source>Plan Nacional</funding-source> (<award-id>BFU2008-00419</award-id>) (to I.E. and E.R.); ‘La Caixa’ international PhD program fellowships (to G.B.). This work was also co-financed by the <funding-source>European Commission</funding-source>, within the 7th <funding-source>Framework Programme</funding-source> (Grant Agreement <award-id>KBBE-2A-222664</award-id>) (‘Quantomics’).</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_40_7_e52__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gkr1292_nar-02222-met-n-2011-File009.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="gkr1292-B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Farnham</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Insights from genomic profiling of transcription factors</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>605</fpage>
        <lpage>616</lpage>
        <pub-id pub-id-type="pmid">19668247</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Endrizzi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Birren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Sequencing and comparison of yeast species to identify genes and regulatory elements</article-title>
        <source>Nature</source>
        <year>2003</year>
        <volume>423</volume>
        <fpage>241</fpage>
        <lpage>254</lpage>
        <pub-id pub-id-type="pmid">12748633</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kulbokas</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Lindblad-Toh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Systematic discovery of regulatory motifs in human promoters and 3′ UTRs by comparison of several mammals</article-title>
        <source>Nature</source>
        <year>2005</year>
        <volume>434</volume>
        <fpage>338</fpage>
        <lpage>345</lpage>
        <pub-id pub-id-type="pmid">15735639</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Ballester</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Schwalie</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kutter</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Watt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Martinez-Jimenez</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Mackay</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Five-vertebrate ChIP-seq reveals the evolutionary dynamics of transcription factor binding</article-title>
        <source>Science</source>
        <year>2010</year>
        <volume>328</volume>
        <fpage>1036</fpage>
        <lpage>1040</lpage>
        <pub-id pub-id-type="pmid">20378774</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prohaska</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Fried</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Flamm</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>Surveying phylogenetic footprints in large gene clusters: applications to Hox cluster duplications</article-title>
        <source>Mol. Phylogenet. Evol.</source>
        <year>2004</year>
        <volume>31</volume>
        <fpage>581</fpage>
        <lpage>604</lpage>
        <pub-id pub-id-type="pmid">15062796</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hertz</surname>
            <given-names>GZ</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <article-title>Identifying DNA and protein patterns with statistically significant alignments of multiple sequences</article-title>
        <source>Bioinformatics</source>
        <year>1999</year>
        <volume>15</volume>
        <fpage>563</fpage>
        <lpage>577</lpage>
        <pub-id pub-id-type="pmid">10487864</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blanco</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Guigo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Messeguer</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Multiple non-collinear TF-map alignments of promoter regions</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>138</fpage>
        <pub-id pub-id-type="pmid">17456238</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berezikov</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Guryev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Plasterk</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Cuppen</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>CONREAL: conserved regulatory elements anchored alignment algorithm for identification of transcription factor binding sites by phylogenetic footprinting</article-title>
        <source>Genome Res.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>170</fpage>
        <lpage>178</lpage>
        <pub-id pub-id-type="pmid">14672977</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loots</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Ovcharenko</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Mulan: multiple-sequence alignment to predict functional elements in genomic sequences</article-title>
        <source>Methods Mol. Biol.</source>
        <year>2007</year>
        <volume>395</volume>
        <fpage>237</fpage>
        <lpage>254</lpage>
        <pub-id pub-id-type="pmid">17993678</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ovcharenko</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Loots</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Giardine</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Stubbs</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Mulan: multiple-sequence local alignment and visualization for studying function and evolution</article-title>
        <source>Genome Res.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>184</fpage>
        <lpage>194</lpage>
        <pub-id pub-id-type="pmid">15590941</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Otto</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Lopez-Giraldez</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Townsend</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Lynch</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Measuring transcription factor-binding site turnover: a maximum likelihood approach using phylogenies</article-title>
        <source>Genome Biol. Evol.</source>
        <year>2009</year>
        <volume>1</volume>
        <fpage>85</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="pmid">20333180</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Bardet</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Patton</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Purvis</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Johnston</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Paulson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gogol</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stark</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zeitlinger</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>High conservation of transcription factor binding and evidence for combinatorial regulation across six Drosophila species</article-title>
        <source>Nat. Genet.</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>414</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="pmid">21478888</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sinha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>MORPH: probabilistic alignment combined with hidden Markov models of cis-regulatory modules</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e216</fpage>
        <pub-id pub-id-type="pmid">17997594</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bais</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Grossmann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Incorporating evolution of transcription factor binding sites into annotated alignments</article-title>
        <source>J. Biosci.</source>
        <year>2007</year>
        <volume>32</volume>
        <fpage>841</fpage>
        <lpage>850</lpage>
        <pub-id pub-id-type="pmid">17914226</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hallikas</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Palin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sinjushina</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rautiainen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Partanen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ukkonen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Taipale</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide prediction of mammalian enhancers based on analysis of transcription-factor binding affinity</article-title>
        <source>Cell</source>
        <year>2006</year>
        <volume>124</volume>
        <fpage>47</fpage>
        <lpage>59</lpage>
        <pub-id pub-id-type="pmid">16413481</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Majoros</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Ohler</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Modeling the evolution of regulatory elements by simultaneous detection and alignment with phylogenetic pair HMMs</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1001037</fpage>
        <pub-id pub-id-type="pmid">21187896</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Siddharthan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Dinucleotide weight matrices for predicting transcription factor binding sites: generalizing the position weight matrix</article-title>
        <source>PLoS One</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>e9722</fpage>
        <pub-id pub-id-type="pmid">20339533</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>MQ</given-names>
          </name>
          <name>
            <surname>Marr</surname>
            <given-names>TG</given-names>
          </name>
        </person-group>
        <article-title>A weight array method for splicing signal analysis</article-title>
        <source>Comput. Appl. Biosci.</source>
        <year>1993</year>
        <volume>9</volume>
        <fpage>499</fpage>
        <lpage>509</lpage>
        <pub-id pub-id-type="pmid">8293321</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sze</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Improving accuracy of multiple sequence alignment algorithms based on alignment of neighboring residues</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>463</fpage>
        <lpage>472</lpage>
        <pub-id pub-id-type="pmid">19056820</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bussotti</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Raineri</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Erb</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Zytnicki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Beaudoing</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bucher</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>BlastR–fast and accurate database searches for non-coding RNAs</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>6886</fpage>
        <lpage>6895</lpage>
        <pub-id pub-id-type="pmid">21624887</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Heringa</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>T-Coffee: A novel method for fast and accurate multiple sequence alignment</article-title>
        <source>J. Mol. Biol.</source>
        <year>2000</year>
        <volume>302</volume>
        <fpage>205</fpage>
        <lpage>217</lpage>
        <pub-id pub-id-type="pmid">10964570</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sinha</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Towards realistic benchmarks for multiple alignments of non-coding sequences</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>54</fpage>
        <pub-id pub-id-type="pmid">20102627</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Nevins</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Ohler</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic simulation of promoter evolution: estimation and modeling of binding site turnover events and assessment of their impact on alignment tools</article-title>
        <source>Genome Biol.</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R225</fpage>
        <pub-id pub-id-type="pmid">17956628</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pollard</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Celniker</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking tools for the alignment of functional noncoding DNA</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>6</fpage>
        <pub-id pub-id-type="pmid">14736341</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keightley</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>MCALIGN: stochastic alignment of noncoding DNA sequences based on an evolutionary model of sequence evolution</article-title>
        <source>Genome Res.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>442</fpage>
        <lpage>450</lpage>
        <pub-id pub-id-type="pmid">14993209</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Aken</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Ballester</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bragin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Brent</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Clapham</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Coates</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fairley</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl's 10th year</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>38</volume>
        <fpage>D557</fpage>
        <lpage>D562</lpage>
        <pub-id pub-id-type="pmid">19906699</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chenna</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sugawara</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Koike</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Multiple sequence alignment with the Clustal series of programs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3497</fpage>
        <lpage>3500</lpage>
        <pub-id pub-id-type="pmid">12824352</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Do</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Mahabhashyam</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Brudno</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>ProbCons: Probabilistic consistency-based multiple sequence alignment</article-title>
        <source>Genome Res.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>330</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="pmid">15687296</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>1792</fpage>
        <lpage>1797</lpage>
        <pub-id pub-id-type="pmid">15034147</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Recent developments in the MAFFT multiple sequence alignment program</article-title>
        <source>Brief. Bioinform.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>286</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="pmid">18372315</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henikoff</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Henikoff</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>Amino acid substitution matrices from protein blocks</article-title>
        <source>Proc. Natl Acad. Sci.</source>
        <year>1992</year>
        <volume>89</volume>
        <fpage>10915</fpage>
        <lpage>10919</lpage>
        <pub-id pub-id-type="pmid">1438297</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Althammer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gonzalez-Vallinas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ballare</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Beato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eyras</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Pyicos: A versatile toolkit for the analysis of high-throughput sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>3333</fpage>
        <lpage>3340</lpage>
        <pub-id pub-id-type="pmid">21994224</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blanco</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Messeguer</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Guigo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Transcription factor map alignment of promoter regions</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2006</year>
        <volume>2</volume>
        <fpage>e49</fpage>
        <pub-id pub-id-type="pmid">16733547</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Portales-Casamar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Thongjuea</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kwon</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Arenillas</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Valen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Yusuf</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lenhard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wasserman</surname>
            <given-names>WW</given-names>
          </name>
          <name>
            <surname>Sandelin</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>JASPAR 2010: the greatly expanded open-access database of transcription factor binding profiles</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>38</volume>
        <fpage>D105</fpage>
        <lpage>D110</lpage>
        <pub-id pub-id-type="pmid">19906716</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parker</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Abaan</surname>
            <given-names>HO</given-names>
          </name>
          <name>
            <surname>Tullius</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Margulies</surname>
            <given-names>EH</given-names>
          </name>
        </person-group>
        <article-title>Local DNA topography correlates with functional noncoding regions of the human genome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>324</volume>
        <fpage>389</fpage>
        <lpage>392</lpage>
        <pub-id pub-id-type="pmid">19286520</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bulyk</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Nucleotides of transcription factor binding sites exert interdependent effects on the binding affinities of transcription factors</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>1255</fpage>
        <lpage>1261</lpage>
        <pub-id pub-id-type="pmid">11861919</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matys</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kel-Margoulis</surname>
            <given-names>OV</given-names>
          </name>
          <name>
            <surname>Fricke</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Liebich</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Land</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Barre-Dirrie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Reuter</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chekmenev</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Krull</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hornischer</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TRANSFAC and its module TRANSCompel: transcriptional gene regulation in eukaryotes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>D108</fpage>
        <lpage>D110</lpage>
        <pub-id pub-id-type="pmid">16381825</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aniba</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Poch</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Issues in bioinformatics benchmarking: the case study of multiple sequence alignment</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>38</volume>
        <fpage>7353</fpage>
        <lpage>7363</lpage>
        <pub-id pub-id-type="pmid">20639539</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altenhoff</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic and functional assessment of orthologs inference projects and methods</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000262</fpage>
        <pub-id pub-id-type="pmid">19148271</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Filipski</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Multiple sequence alignment: in pursuit of homologous DNA positions</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>127</fpage>
        <lpage>135</lpage>
        <pub-id pub-id-type="pmid">17272647</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kemena</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Upcoming challenges for multiple sequence alignment methods in the high-throughput era</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2455</fpage>
        <lpage>2465</lpage>
        <pub-id pub-id-type="pmid">19648142</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Linard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lecompte</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Poch</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive benchmark study of multiple sequence alignment methods: current challenges and future perspectives</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e18093</fpage>
        <pub-id pub-id-type="pmid">21483869</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carroll</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Beckstead</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>O'Connor</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ebbert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snell</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>McClellan</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>DNA reference alignment benchmarks based on tertiary structure of encoded proteins</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2648</fpage>
        <lpage>2649</lpage>
        <pub-id pub-id-type="pmid">17686799</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Siddharthan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Siggia</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>van Nimwegen</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>PhyloGibbs: a Gibbs sampling motif finder that incorporates phylogeny</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2005</year>
        <volume>1</volume>
        <fpage>e67</fpage>
        <pub-id pub-id-type="pmid">16477324</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moses</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Chiang</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>VN</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>MONKEY: identifying conserved transcription-factor binding sites in multiple alignments using a binding site-specific evolutionary model</article-title>
        <source>Genome Biol.</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R98</fpage>
        <pub-id pub-id-type="pmid">15575972</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1292-B46">
      <label>46</label>
      <element-citation publication-type="journal">
        <comment>Arnold,P., Erb,I., Pachkov,M., Molina,N. and van Nimwegen,E. MotEvo: Integrated Bayesian probabilistic methods for inferring regulatory sites and motifs on multiple alignments of DNA sequences. <italic>Bioinformatics</italic>, doi:10.1093/bioinformatics/btr695 [epub ahead of print]</comment>
      </element-citation>
    </ref>
    <ref id="gkr1292-B47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Down</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>Assessing computational methods of cis-regulatory module prediction</article-title>
        <source>PLoS Comput. Biol.</source>
        <volume>6</volume>
        <fpage>e1001020</fpage>
        <pub-id pub-id-type="pmid">21152003</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
