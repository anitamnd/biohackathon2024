<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7075537</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz824</article-id>
    <article-id pub-id-type="publisher-id">btz824</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><monospace>MDiNE</monospace>: a model to estimate differential co-occurrence networks in microbiome studies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>McGregor</surname>
          <given-names>Kevin</given-names>
        </name>
        <xref ref-type="aff" rid="btz824-aff1">1</xref>
        <xref ref-type="aff" rid="btz824-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Labbe</surname>
          <given-names>Aurélie</given-names>
        </name>
        <xref ref-type="aff" rid="btz824-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Greenwood</surname>
          <given-names>Celia M T</given-names>
        </name>
        <xref ref-type="aff" rid="btz824-aff1">1</xref>
        <xref ref-type="aff" rid="btz824-aff2">2</xref>
        <xref ref-type="aff" rid="btz824-aff4">4</xref>
        <xref ref-type="corresp" rid="btz824-cor1"/>
        <!--<email>celia.greenwood@mcgill.ca</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btz824-aff1"><label>1</label><institution>Department of Epidemiology, Biostatistics and Occupational Health, McGill University</institution>, Montréal, QC, <country country="CA">Canada</country></aff>
    <aff id="btz824-aff2"><label>2</label><institution>Centre for Clinical Epidemiology, Lady Davis Institute, Jewish General Hospital</institution>, Montréal, QC, <country country="CA">Canada</country></aff>
    <aff id="btz824-aff3"><label>3</label><institution>Département de sciences de la décision, HEC Montréal</institution>, Montréal, QC, <country country="CA">Canada</country></aff>
    <aff id="btz824-aff4"><label>4</label><institution>Gerald Bronfman Department of Oncology, McGill Department of Human Genetics, McGill University</institution>, Montréal, QC, <country country="CA">Canada</country></aff>
    <author-notes>
      <corresp id="btz824-cor1">
        <email>celia.greenwood@mcgill.ca</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-11-07">
      <day>07</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>6</issue>
    <fpage>1840</fpage>
    <lpage>1847</lpage>
    <history>
      <date date-type="received">
        <day>07</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>10</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>11</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz824.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The human microbiota is the collection of microorganisms colonizing the human body, and plays an integral part in human health. A growing trend in microbiome analysis is to construct a network to estimate the co-occurrence patterns among taxa through precision matrices. Existing methods do not facilitate investigation into how these networks change with respect to covariates.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We propose a new model called Microbiome Differential Network Estimation (<monospace>MDiNE</monospace>) to estimate network changes with respect to a binary covariate. The counts of individual taxa in the samples are modeled through a multinomial distribution whose probabilities depend on a latent Gaussian random variable. A sparse precision matrix over all the latent terms determines the co-occurrence network among taxa. The model fit is obtained and evaluated using Hamiltonian Monte Carlo methods. The performance of our model is evaluated through an extensive simulation study and is shown to outperform existing methods in terms of estimation of network parameters. We also demonstrate an application of the model to estimate changes in the intestinal microbial network topology with respect to Crohn’s disease.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><monospace>MDiNE</monospace> is implemented in a freely available <monospace>R</monospace> package: <ext-link ext-link-type="uri" xlink:href="https://github.com/kevinmcgregor/mdine">https://github.com/kevinmcgregor/mdine</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Fonds de recherche du Québec-Santé</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>McGill University Faculty of Medicine’s Cameron-Davis and Davis Fellowship</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Gerald Clavet Fellowship</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>CIHR</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000024</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>MOP-130344</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The human microbiota refers to the microorganisms residing on and inside the human body. These organisms form symbiotic relationships with their host and consequently have a direct effect on human metabolism and host–environment interaction (<xref rid="btz824-B37" ref-type="bibr">Turnbaugh <italic>et al.</italic>, 2007</xref>). Additionally, the microbiota form ecological communities influenced by body site, metabolic diversity and competition for resources (<xref rid="btz824-B10" ref-type="bibr">Chu <italic>et al.</italic>, 2017</xref>; <xref rid="btz824-B21" ref-type="bibr">Hibbing <italic>et al.</italic>, 2010</xref>). In order to perform any kind of analysis of microbiome data, microbes are classified based on genetic similarity into units called operational taxonomic units (OTUs). By mapping these OTUs to a reference genome, they can be further grouped into taxonomic classifications such as species, family or phylum. Technologies such as 16S ribosomal RNA sequencing allow researchers to get a snapshot of the taxonomic makeup of microbiome samples in the form of counts of each taxonomic group within each sample.</p>
    <p>The co-occurrence patterns among taxa in the human gut microbiome are driven by metabolic interactions and competition for resources (<xref rid="btz824-B26" ref-type="bibr">Levy and Borenstein, 2013</xref>). However, the development of statistical methodology for the analysis of 16S sequencing data, in addition to other metagenomic sequencing platforms, has largely focused on the relative abundances and diversity of the various taxa found in microbiome samples. Differences in microbial composition have been linked to type I diabetes, obesity and stunted growth (<xref rid="btz824-B5" ref-type="bibr">Brugman <italic>et al.</italic>, 2006</xref>; <xref rid="btz824-B38" ref-type="bibr">Turnbaugh <italic>et al.</italic>, 2009</xref>; <xref rid="btz824-B20" ref-type="bibr">Gough <italic>et al.</italic>, 2015</xref>). While it is evident that these methods have proven effective in capturing information about changes in microbial composition, they do not directly address the question of relationships between the taxa in a community. Co-occurrence patterns can be represented through the use of networks, where the nodes correspond to taxa and the edges define the correlation patterns between the taxa. Statistical approaches to modeling taxa co-occurrence networks have the potential to capture important community characteristics that would otherwise go undetected in abundance or diversity-based analyses. There is also value in estimating the difference between two co-occurrence networks, as it is then possible to investigate how external factors are related to changes in the network structure of the microbiome.</p>
    <p>A convenient way to model networks is through precision matrix estimation, as the pattern of zeros occurring in the precision matrix can be used to construct a network. Given a set of <italic>J</italic> random variables, pairwise covariances form a <italic>J </italic>×<italic> J</italic> covariance matrix Σ. The precision matrix is defined as the matrix inverse of the covariance matrix, i.e. <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:msup><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (<xref rid="btz824-B12" ref-type="bibr">Drton <italic>et al.</italic>, 2007</xref>). The advantage of using the precision matrix lies in the off-diagonal elements, which can be transformed to partial correlations between pairs of variables. That is, the partial correlation <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> between variable <italic>j</italic> and variable <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, conditional on all other variables can be calculated as:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>′</mml:mo><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
    <p>(<xref rid="btz824-B24" ref-type="bibr">Kuismin and Sillanpää, 2017</xref>). If <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, then variable <italic>j</italic> is uncorrelated with variable <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> given all the other variables. As a result, the precision matrix gives an idea of how the variables are directly related in the sense that it removes the possibility that an observed association only exists through correlation with one or more other variables.</p>
    <p>In 16S sequencing analysis, nodes in the network are assigned to the microbial taxa and edges correspond to non-zero entries in the precision matrix. In the high-dimensional setting, when the number of taxa is large relative to the sample size, sparsity (or an abundance of zero entries) in the precision matrix must be assumed in order to obtain stable estimates of the precision matrix elements (<xref rid="btz824-B9" ref-type="bibr">Chi and Lange, 2014</xref>). Furthermore, if the number of taxa exceeds the sample size, then the covariance matrix is singular. The estimation of sparse precision matrices in the Gaussian graphical setting is a well-studied problem. Graphical LASSO (GLASSO) was proposed as an efficient solution to the problem, and remains a standard in the domain of sparse precision matrix estimation (<xref rid="btz824-B16" ref-type="bibr">Friedman <italic>et al.</italic>, 2008</xref>). Nonetheless, several characteristics of 16S sequencing data inhibit the use of Gaussian graphical models. Firstly, since the data are in the form of counts, often with many zeros, the assumption of normality does not hold. More importantly, due to the nature of the sequencing process, the data are compositional; that is, inherent features of the sequencing process lead to varying read depths over samples which can bias the observed correlations or similarity metrics. Proper inference can only be performed on the abundance of a taxon relative to one or more of the other taxa (<xref rid="btz824-B19" ref-type="bibr">Gloor <italic>et al.</italic>, 2017</xref>).</p>
    <p>Several approaches have been developed to estimate networks in microbiome data. <monospace>SparCC</monospace> and <monospace>CCLasso</monospace> directly model correlations between taxa in a non-parametric manner (<xref rid="btz824-B17" ref-type="bibr">Friedman and Alm, 2012</xref>; <xref rid="btz824-B14" ref-type="bibr">Fang <italic>et al.</italic>, 2015</xref>). <monospace>MInt</monospace> incorporates a Poisson-Multivariate Normal model which estimates a precision matrix as well as covariate effects on taxon abundances (<xref rid="btz824-B4" ref-type="bibr">Biswas <italic>et al.</italic>, 2016</xref>). Sparse Inverse Covariance Estimation for Ecological Association Inference (<monospace>SPIEC-EASI</monospace>) runs GLASSO on the centered log-ratio transformed counts (<xref rid="btz824-B25" ref-type="bibr">Kurtz <italic>et al.</italic>, 2015</xref>). One common element of each of these methods is that they model a single co-occurrence network among the samples. Yet, there has been interest in estimating separate networks according to a condition, such as a treatment or a disease of interest, to see how the network structure is affected (<xref rid="btz824-B3" ref-type="bibr">Bajaj <italic>et al.</italic>, 2012</xref>; <xref rid="btz824-B20" ref-type="bibr">Gough <italic>et al.</italic>, 2015</xref>; <xref rid="btz824-B29" ref-type="bibr">Mahana <italic>et al.</italic>, 2016</xref>; <xref rid="btz824-B35" ref-type="bibr">Ruiz <italic>et al.</italic>, 2017</xref>).</p>
    <p>Models to compare precision matrices exist in other contexts. The Joint Graphical LASSO was proposed as a solution in the case of Gaussian data (<xref rid="btz824-B11" ref-type="bibr">Danaher <italic>et al.</italic>, 2014</xref>). Similarly, a non-parametric method for differential network estimation was proposed by <xref rid="btz824-B44" ref-type="bibr">Zhao <italic>et al.</italic> (2014)</xref>. In this algorithm, the difference in precision matrices is modeled directly, whereas the precision matrix within each group is not explicitly estimated. To our knowledge, there is no existing differential network estimation procedure for microbiome data based on precision matrix estimation. Currently, a network estimation algorithm must be run separately within each group of interest, effectively reducing the sample size used to model each network.</p>
    <p>In this article, we introduce a new model, called Microbiome Differential Network Estimation (<monospace>MDiNE</monospace>, pronounced ‘em-dine’), capable of estimating separate taxa co-occurrence networks for groups defined by a binary variable. The method can also recover the differences between each network, as well as provide interval estimates for each parameter. Furthermore, estimates of how covariates, including the binary variable of interest, associate with the relative abundance of the taxa can also be obtained. We perform a simulation study to compare the performance of <monospace>MDiNE</monospace> against two precision matrix-based methods: <monospace>SPIEC-EASI</monospace> and <monospace>MInt</monospace>. Additionally, we illustrate the performance of MDiNE through an application on 16S sequencing data from Crohn’s disease and control samples.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>We have chosen a model that is based on the multinomial distribution, which allows us to address the compositional nature of the data. The Dirichlet-Multinomial distribution has been proposed in this context (<xref rid="btz824-B8" ref-type="bibr">Chen and Li, 2013</xref>; <xref rid="btz824-B22" ref-type="bibr">Holmes <italic>et al.</italic>, 2012</xref>), and remains a natural choice given that the Dirichlet distribution is a conjugate prior for the multinomial distribution. Because of varying read depths over samples, covariances should not be calculated on the raw taxa counts. The most obvious way to deal with the problem is to normalize by the total number of counts in each sample, so that the abundance of each taxon <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> is expressed as a proportion <italic>p<sub>j</sub></italic>. However, this introduces a sum constraint in each sample, such that <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Any attempt at modeling the covariance structure on a proportion would lead to a bias toward negative covariances (<xref rid="btz824-B39" ref-type="bibr">van den Boogaart and Tolosana-Delgado, 2013</xref>). Calculating covariances on compositional data also does not preserve subcompositional coherence, a property that guarantees that inference on a subset of taxa does not depend on whether or not other taxa are included in the analysis (<xref rid="btz824-B2" ref-type="bibr">Aitchison, 1994</xref>).</p>
    <p>Solutions have been proposed to address the question of measuring associations in compositional data. <xref rid="btz824-B1" ref-type="bibr">Aitchison (1986)</xref> defined a measure of association based on the variance of two compositional components <italic>y<sub>i</sub></italic> and <italic>y<sub>j</sub></italic>: <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:mtext>var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, for <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>. If <italic>y<sub>i</sub></italic> is highly linearly correlated with <italic>y<sub>j</sub></italic>, then the variance of the log-ratio will be small, and equal to zero in the case that <italic>y<sub>i</sub></italic> is exactly proportional to <italic>y<sub>j</sub></italic>. This metric, however, lacks an interpretable scale. <xref rid="btz824-B28" ref-type="bibr">Lovell <italic>et al.</italic> (2015)</xref> showed that the above variance could be scaled down to a more easily interpretable quantity called the ‘goodness-of-fit to proportionality’ statistic. <xref rid="btz824-B13" ref-type="bibr">Erb and Notredame (2016)</xref> modified this statistic to be symmetric and less prone to spurious proportionality. Proportionality-based association metrics have recently been shown to outperform non-composition based correlation and distance-based metrics in single-cell transcriptomic data (<xref rid="btz824-B36" ref-type="bibr">Skinnider <italic>et al.</italic>, 2019</xref>).</p>
    <p>Another way to handle compositional data is through the choice of distribution to model the counts, along with an appropriate parameterization. In 2013, <xref rid="btz824-B42" ref-type="bibr">Xia <italic>et al.</italic> (2013)</xref> introduced a logistic normal multinomial model capable of estimating associations between taxa abundances and covariates that addresses some of the aforementioned challenges. Define <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>J</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as a vector of proportions of <italic>J </italic>+<italic> </italic>1 different taxa in a sample. The logistic normal multinomial model implicitly models the <italic>additive log-ratio transformation</italic> of <italic>p</italic>, which is defined as:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mtext>alr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>J</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p>
    <p>assuming each <italic>p<sub>j</sub></italic> &gt; 0. This transformation does indeed preserve subcompositional coherence. Multivariate normality is assumed for the transformed proportions, meaning that the precision matrix is explicitly defined as a parameter in the model. We therefore pursue an extension to the model posited by Xia <italic>et al.</italic> by including two precision matrices, as well as a penalization scheme to select network edges.</p>
    <p>In contrast, the method <monospace>SPIEC-EASI</monospace> directly computes the centered log-ratios of the vector of <italic>observed</italic> taxa counts <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>J</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as such:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mtext>clr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>J</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, i.e. the geometric mean of the values in <italic>y</italic>.</p>
    <p>From there, a graphical estimation procedure such as GLASSO is applied to the transformed data to obtain network estimates. Yet, there is typically a large number of zero counts in 16S sequencing data, which cannot be handled in the log-ratio transformation. An arbitrary positive pseudo-count must be added before taking the transformation. The multinomial logistic model, however, can handle zero counts without resorting to the addition of a pseudo-count.</p>
    <p>The statistical theory for penalized covariance matrices in a logistic multinomial normal model is complex. We choose to define the model in a Bayesian framework, and obtain the model fit using Markov Chain Monte Carlo (MCMC) methods. The priors placed on the model parameters control the level of parsimony applied in parameter estimation. Details of the MCMC methods used can be seen in Section 2.4.</p>
    <sec>
      <title>2.1 Model</title>
      <p>Among <italic>N</italic> individuals we consider <italic>J</italic> taxa for inclusion in the network analysis, along with a reference taxon <italic>J </italic>+<italic> </italic>1, which will not be included in the network. The number of covariates in the model is <italic>K</italic>. The counts of the taxa are contained in the matrix <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The total number of reads for individual <italic>i</italic> is denoted as <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Let <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be a vector containing the binary covariate over which the taxa co-occurrence networks are expected to vary. <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the design matrix, and <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> represents row <italic>i</italic> of the design matrix containing individual <italic>i’</italic>s covariates. Our method estimates how each of the covariates in the design matrix relates to taxon abundance. The vector <italic>Z</italic>, which is of primary interest for the network changes, could also be included in the design matrix.</p>
      <p>Assume the true proportions of the <italic>J </italic>+<italic> </italic>1 taxa in individual <italic>i’</italic>s microbiome is <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> such that <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. This implies that the proportions <italic>p<sub>ij</sub></italic> were formed using only taxa that were observed in the dataset. More information on the interpretation of the taxon proportions can be seen in <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S2</xref>. Then the vector of counts for individual <italic>i</italic>, denoted by <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, can be modeled as a multinomial distribution:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the proportions are parameterized through the additive log-ratio transformation with respect to category <italic>J </italic>+<italic> </italic>1 as seen in <xref ref-type="disp-formula" rid="E2">Equation 2</xref>:
<disp-formula id="E5"><label>(5)</label><mml:math id="M5"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">iJ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula>for <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Here, we model the row vector of log-ratio transformed proportions for individual <italic>i</italic>, <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, as a multivariate normal distribution whose parameters depend on the observed covariates <bold>X</bold> and <italic>Z</italic>:
<disp-formula id="E6"><label>(6)</label><mml:math id="M6"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⊤</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>That is, the variance structure depends on the individual’s binary covariate <italic>z<sub>i</sub></italic>. The corresponding precision matrices <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> therefore, define the co-occurrence network structure of the <italic>J</italic> taxa of interest within each group defined by <italic>Z</italic>. We note that, unlike for a covariance matrix, calculating the two precision matrices on a subset of taxa would give different results than if we had calculated them on the full set of taxa, thus violating subcompositional coherence. This shift in the matrix elements, however, represents a change in their interpretations, since we would not longer be conditioning on the missing taxa. The parameters in the matrix <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> define how each of the <italic>K</italic> covariates in <bold>X</bold> relate to the abundances of the taxa relative to the reference category <italic>J </italic>+<italic> </italic>1.</p>
      <p>Equivalently, the inverse transformation for the additive log-ratio transformed data is expressed as:
<disp-formula id="E7"><label>(7)</label><mml:math id="M7"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>Given that we are implementing a Bayesian framework, non-informative (high-variance) normal priors are assumed for each element of <bold>B</bold>. The full model is summarized in <xref ref-type="disp-formula" rid="E12">Equation 12</xref>. The potentially large number of parameters in <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> relative to the sample size <italic>N</italic> necessitates a procedure to shrink the off-diagonal elements of these two matrices. We now outline a prior-based shrinkage strategy in the model.</p>
    </sec>
    <sec>
      <title>2.2 Inducing sparsity</title>
      <p>To solve the problem of unstable estimates of precision matrices resulting from inadequate sample size (as mentioned in the introduction), we must apply a penalization scheme to the elements of <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. In a Bayesian framework, strategic priors can be used on the model parameters to shrink estimates toward zero. In our model, we apply a Laplace prior centered around zero and with inverse scale parameter <italic>λ</italic> to induce sparsity in the off-diagonal elements of the two precision matrices. This is the Bayesian equivalent to adding an <italic>L</italic><sub>1</sub> penalty term to the log-likelihood in the maximum likelihood framework, where the following maximization would take place:
<disp-formula id="E8"><label>(8)</label><mml:math id="M8"><mml:mrow><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mo> </mml:mo><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>l</italic> represents the log-likelihood of the hierarchical model as defined in Section 2.1. <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>·</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> denotes the sum of the absolute values of the matrix elements of <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
      <p>As the diagonal elements are constrained to the set of positive real numbers, an exponential prior with rate parameter <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:mo>λ</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> is used for these elements instead (<xref rid="btz824-B23" ref-type="bibr">Khondker <italic>et al.</italic>, 2013</xref>; <xref rid="btz824-B40" ref-type="bibr">Wang, 2012</xref>). Let <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> represent the value in row <italic>j</italic> and column <inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> of the matrices <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, respectively. Then the priors for the elements of <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are:
<disp-formula id="E9"><label>(9)</label><mml:math id="M9"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mo>λ</mml:mo><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo>λ</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mo>λ</mml:mo><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mo>λ</mml:mo><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mn mathvariant="script">1</mml:mn><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>′</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>The priors for the elements of <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are defined likewise with the same <italic>λ</italic>. This single value of <italic>λ</italic> will then control the amount of parameter shrinkage in the two precision matrices. The current parameterization implies that a higher value of <italic>λ</italic> will correspond to smaller elements in absolute value; that is, a precision matrix with off-diagonal elements closer to zero.</p>
    </sec>
    <sec>
      <title>2.3 Choice of <italic>λ</italic></title>
      <p>In the MCMC framework, the value of the penalization parameter <italic>λ</italic> can be specified as a hyperparameter in the model along with its own prior distribution. In the Bayesian Graphical Lasso, a Gamma prior is applied to the Laplace penalization parameter (<xref rid="btz824-B40" ref-type="bibr">Wang, 2012</xref>), since this leads to its full conditional itself following a Gamma distribution. In our model, we specify an exponential prior on <italic>λ</italic>, as it is a special case of the Gamma distribution, but only includes a single hyperparameter. In order to avoid choosing an arbitrary hyperparameter in the exponential prior, we use an empirical Bayes-like procedure that is similar to what is outlined in <xref rid="btz824-B4" ref-type="bibr">Biswas <italic>et al.</italic> (2016)</xref>.</p>
      <p>We start by estimating an initial multinomial logistic regression model using the counts <bold>Y</bold> as the outcome and the covariates <bold>X</bold> as predictors, which gives an initial estimate <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. From there, we obtain the residuals of the model (on the log-ratio scale), <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, and calculate the empirical covariance matrices separately for residuals of samples with <italic>z<sub>i</sub></italic> = 0 and <italic>z<sub>i</sub></italic> = 1. To obtain initial, naïve estimates <inline-formula id="IE45"><mml:math id="IM45"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE46"><mml:math id="IM46"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, we take the generalized inverses of the empirical covariance matrices. We can plug in our initial estimates <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE48"><mml:math id="IM48"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> into <inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>λ</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and maximize with respect to <italic>λ</italic> to obtain an initial estimate:
<disp-formula id="E10"><label>(10)</label><mml:math id="M10"><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mo> </mml:mo><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mo> </mml:mo><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mo stretchy="false">{</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>exp</mml:mi><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>×</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>exp</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo stretchy="false">}</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>J</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      <p>In the full model, we specify an exponential prior on <italic>λ</italic> having expected value equal to the initial estimate <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="italic">init</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> so that <italic>λ</italic> is sampled over a reasonable region:
<disp-formula id="E11"><label>(11)</label><mml:math id="M11"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Exponential</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="italic">init</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>More details on the choice of the parameter <italic>λ</italic> and how it can be estimated can be seen in <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S1</xref>. In summary, the full model can then be written as:
<disp-formula id="E12"><label>(12)</label><mml:math id="M12"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Normal</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>·</mml:mo></mml:mrow></mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⊤</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mo>λ</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Laplace</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>λ</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jj</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mo>λ</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Exponential</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>λ</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>λ</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Exponential</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="italic">init</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">kj</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Normal</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>10000</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>for each <inline-formula id="IE51"><mml:math id="IM51"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>′</mml:mo><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:mi>z</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>The expression for the joint posterior distribution <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">W</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can be seen in <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S3</xref>.</p>
    </sec>
    <sec>
      <title>2.4 Parameter estimation</title>
      <p>The model is fit through Hamiltonian Monte Carlo (HMC) sampling facilitated by the Stan language (<xref rid="btz824-B7" ref-type="bibr">Carpenter <italic>et al.</italic>, 2017</xref>). One particular advantage of HMC is its efficiency in the case of correlated parameters, which can be a significant hurdle in other Monte Carlo simulation strategies (<xref rid="btz824-B34" ref-type="bibr">Rannala, 2002</xref>). To ensure positive semi-definiteness of <inline-formula id="IE54"><mml:math id="IM54"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE55"><mml:math id="IM55"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, we parameterize them through their Cholesky decompositions, so that <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mo>⊤</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE57"><mml:math id="IM57"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mo>⊤</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, for lower-triangular matrices <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Note that Stan also allows matrices to be declared as covariance matrices, hence preserving positive semi-definiteness during the HMC sampling process. Estimates for each parameter are obtained by calculating the posterior mean from the obtained MCMC samples. For the results in this paper, each model was run for 1000 samples in four chains, with the first half of samples taken as warm-up. Convergence was verified through trace plots and calculation of the potential scale reduction factor.</p>
    </sec>
    <sec>
      <title>2.5 Simulation design</title>
      <p>A simulation study was undertaken to evaluate the performance of <monospace>MDiNE</monospace> against that of <monospace>MInt</monospace> and <monospace>SPIEC-EASI</monospace>. To ensure realistic count data, we based the simulation parameters on data coming from the American Gut Project, which is a publicly available, crowdfunded human microbiome database <ext-link ext-link-type="uri" xlink:href="http://humanfoodproject.com/americangut">http://humanfoodproject.com/americangut</ext-link>. The zero-inflated negative binomial (ZINB) model was previously shown to be a good choice for simulating realistic microbiome count data (<xref rid="btz824-B25" ref-type="bibr">Kurtz <italic>et al.</italic>, 2015</xref>). Therefore, we chose to simulate data through the ZINB model in a way that replicated the distributions of the most common fecal microbial families found in the American Gut data.</p>
      <p>The data generating process involved the ‘Normal to Anything’ method (<xref rid="btz824-B6" ref-type="bibr">Cario and Nelson, 1997</xref>; <xref rid="btz824-B25" ref-type="bibr">Kurtz <italic>et al.</italic>, 2015</xref>), where correlated taxa vectors were simulated from a multivariate normal distribution and were transformed to a ZINB model based on the American Gut data. ZINB parameters were estimated separately for individuals with asthma (310 subjects) and without asthma (3193 subjects). The parameters for subjects with asthma were used to simulate data for subjects in the <italic>z<sub>i</sub></italic> = 1 group and the parameters for subjects without asthma were used for the <italic>z<sub>i</sub></italic> = 0 group. Details on the American Gut data simulation procedure can be seen in <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S4</xref>.</p>
      <p>We ran 12 simulation scenarios, with differing sample sizes and numbers of taxa: <inline-formula id="IE60"><mml:math id="IM60"><mml:mrow><mml:mi>N</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>500</mml:mn><mml:mo>,</mml:mo><mml:mn>750</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:mi>J</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>25</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. We ran 100 replications for each scenario.</p>
      <p>We also performed a simulation where data were generated directly from the model assumed in <monospace>MDiNE</monospace>. This simulation allowed investigation of parameter bias and precision for the precision matrix elements in <monospace>MDiNE</monospace>, which cannot be obtained through the first data generation mechanism. Details of this additional simulation study can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S5</xref>.</p>
    </sec>
    <sec>
      <title>2.6 Metrics of comparison</title>
      <p>Since the model assumptions are substantially different between <monospace>MDiNE</monospace> and the other two network methods, the values in the estimated precision matrices cannot be directly compared. Consequently, our primary metrics of performance are sensitivity and specificity of network edge detection and a measure of overall network structure. In particular, we consider the area under the receiver operating curve (AUC) for detection of edges. Even for these metrics, the comparison of methods is tricky. Although the parameter <italic>λ</italic> controls the amount of shrinkage in <monospace>MDiNE</monospace>, none of the off-diagonal elements of <inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE63"><mml:math id="IM63"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> can be set exactly to zero, in contrast to <monospace>MInt</monospace> and <monospace>SPIEC-EASI</monospace>. As such, we considered an edge to exist in the <monospace>MDiNE</monospace> estimates if its credible interval did not contain zero. The use of interval estimates to direct variable selection has precedent in Bayesian penalization procedures (<xref rid="btz824-B23" ref-type="bibr">Khondker <italic>et al.</italic>, 2013</xref>; <xref rid="btz824-B27" ref-type="bibr">Li <italic>et al.</italic>, 2010</xref>; <xref rid="btz824-B33" ref-type="bibr">Park and Casella, 2008</xref>). We note, however, that such an approach should only be used to detect potentially important links between taxa. Setting elements of a precision matrix to zero based on interval estimates does not necessarily preserve positive semi-definiteness.</p>
      <p>It is also valuable to compare networks based on measures that capture the overall network structure. <italic>Weighted natural connectivity</italic> is a measure of structural robustness in that it measures the extent to which the connectivity of the network is vulnerable to edge deletion (<xref rid="btz824-B43" ref-type="bibr">Xiao-Ke <italic>et al.</italic>, 2013</xref>). Details on its calculation can be seen in <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S6</xref>.</p>
    </sec>
    <sec>
      <title>2.7 Data application</title>
      <p>We performed a network analysis on a dataset from <xref rid="btz824-B18" ref-type="bibr">Gevers <italic>et al.</italic> (2014)</xref>. The data consisted of publicly available 16S sequencing measures from a multi-cohort study of new-onset Crohn’s disease. To avoid potential problems arising from mixing samples from different cohorts, we only analyzed samples from the Risk Stratification and Identification of Immunogenetic and Microbial Markers of Rapid Disease Progression in Children with Crohn’s Disease (RISK) study <ext-link ext-link-type="uri" xlink:href="https://clinicaltrials.gov/ct2/show/NCT00790543">https://clinicaltrials.gov/ct2/show/NCT00790543</ext-link>. The participants in the RISK cohort were all 18 years of age or younger and were recruited from 28 centers in Canada and the USA. Cases were subjects with newly diagnosed Crohn’s disease and controls were subjects presenting with non-inflammatory gastrointestinal conditions.</p>
      <p>Samples from mucosal tissue biopsies of the terminal ileum were available for 314 Crohns patients and 192 controls. The analysis focused on the family taxonomic level, with 15 families included in the network, and all other families summed into a single reference taxon. We examined network differences between Crohn’s samples and controls (i.e. <italic>z<sub>i</sub></italic> = 1 for Crohn’s patients, and <italic>z<sub>i</sub></italic> = 0 for controls). The Crohn’s disease status was also included in the model matrix <bold>X</bold>, in addition to age, sex and antibiotic use. The dataset included preprocessed.<monospace>biom</monospace> files, and OTU tables and taxonomic information were extracted using the <monospace>phyloseq</monospace> package in <monospace>R</monospace> (<xref rid="btz824-B30" ref-type="bibr">McMurdie and Holmes, 2013</xref>). Results from the data application can be seen in Section 3.3.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Simulation results</title>
      <p>Here, we present the results of the American gut dataset based simulation study which employed the performance metrics outlined in Section 2.6, and compare the results of <monospace>MDiNE</monospace> to those of <monospace>SPIEC-EASI</monospace> and <monospace>MInt</monospace>. In <xref ref-type="supplementary-material" rid="sup1">Supplementary Figures S2 and S3</xref>, we show that the simulated data reasonably replicates the distribution of the observed counts in the American Gut study data.</p>
      <p>First, we examined the AUC achieved within each estimation method. <xref ref-type="fig" rid="btz824-F1">Figure 1</xref> shows AUC distributions over 100 simulation scenarios. The results are shown separately for groups <italic>z </italic>=<italic> </italic>0 and <italic>z </italic>=<italic> </italic>1 and are further split up by number of taxa (<italic>J</italic>) and sample size (<italic>N</italic>). It is evident that <monospace>MDiNE</monospace> generally outperforms the other methods in terms of AUC across all scenarios. It also appears for <monospace>MDiNE</monospace> that there is an improvement in AUC as the sample size <italic>N</italic> increases. There is also a considerable amount of variability across datasets in AUC among all methods in the <italic>J </italic>=<italic> </italic>5 scenario.</p>
      <fig id="btz824-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>The AUC for network edge detection in each of <monospace>MDiNE</monospace>, <monospace>MInt</monospace> and <monospace>SPIEC-EASI</monospace> based on simulated data. The results vary over the number of taxa included in the network (<italic>J</italic>), the sample size (<italic>N</italic>) and the two precision matrices corresponding to groups <italic>z </italic>=<italic> </italic>0 and <italic>z </italic>=<italic> </italic>1</p>
        </caption>
        <graphic xlink:href="btz824f1"/>
      </fig>
      <p>One important observation is the reduced accuracy of edge detection in all methods in the <italic>J </italic>=<italic> </italic>25 scenario. Even with the large sample size <italic>N </italic>=<italic> </italic>750, the AUC is generally less than 0.75. This result may not be surprising considering there are <inline-formula id="IE64"><mml:math id="IM64"><mml:mrow><mml:mn>25</mml:mn><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>25</mml:mn><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mn>325</mml:mn></mml:mrow></mml:math></inline-formula> parameters to estimate within each precision matrix, for a total of 650 parameters, in addition to the covariate effects in <bold>B</bold>. Even if many elements of the matrix are zero, there are a large number of parameters to estimate relative to the sample size. Since all three methods use some kind of selection or shrinkage procedure, there is generally a bias toward zero in the estimates of the precision matrix elements. This means that all three methods tend to err on the side of specificity for edge detection.</p>
      <p><monospace>MDiNE</monospace> is also capable of detecting edge differences in the networks (i.e. the elements of <inline-formula id="IE65"><mml:math id="IM65"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>). In <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4</xref>, we present the AUC for <monospace>MDiNE</monospace> for detecting differences in the network. Again, the performance is greatly dependent on sample size, with very little power to detect network differences in the <italic>N </italic>=<italic> </italic>50 scenarios. A relatively large sample size is necessary to properly detect differences in network edges. Since <monospace>MInt</monospace> and <monospace>SPIEC-EASI</monospace> do not have parameters that allow us to vary the amount of sparsity in the difference between precision matrices, we are unable to calculate the AUC for those two methods.</p>
      <p>In order to assess overall structure of the estimated networks, we calculated the weighted natural connectivity (based on partial correlations), as defined in <xref ref-type="supplementary-material" rid="sup1">Supplementary Equation 15</xref>, and compared to the natural connectivity in each true simulated partial correlation matrix. <xref ref-type="fig" rid="btz824-F2">Figure 2</xref> shows the distribution of the logarithm of the squared error (square of the estimated minus simulated values) of the natural connectivity over the simulation replications.</p>
      <fig id="btz824-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Log squared error of the weighted natural connectivity in each of <monospace>MDiNE</monospace>, <monospace>MInt</monospace> and <monospace>SPIEC-EASI</monospace> based on simulated data. The results vary over the number of taxa included in the network (<italic>J</italic>), the sample size (<italic>N</italic>) and the two precision matrices corresponding to groups <italic>z </italic>=<italic> </italic>0 and <italic>z </italic>=<italic> </italic>1</p>
        </caption>
        <graphic xlink:href="btz824f2"/>
      </fig>
      <p>In general, <monospace>MDiNE</monospace> outperformed the other methods in terms of estimating natural connectivity. Interestingly, there was not much improvement in estimation accuracy as sample size increased. There was also an increase in the variance of estimation accuracy for <monospace>MDiNE</monospace> in the <italic>J </italic>=<italic> </italic>25 case. Other methods also demonstrated increased variability in this measure of network accuracy, but less so than <monospace>MDiNE</monospace>.</p>
    </sec>
    <sec>
      <title>3.2 Testing parameter estimation in <monospace>MDiNE</monospace></title>
      <sec>
        <title>3.2.1 Estimation accuracy</title>
        <p>Next, we examined the results of the simulation where data were generated under the model assumed in <monospace>MDiNE</monospace>. <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5</xref> shows the squared errors averaged over the elements of <inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE67"><mml:math id="IM67"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. As expected, there was a considerable improvement in estimation accuracy as sample size increased. For a fixed sample size, the errors increased with respect to the number of taxa included in the analysis. We also plotted the squared errors for the difference in the precision matrices <inline-formula id="IE68"><mml:math id="IM68"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S6</xref>, and observed a similar result. The same pattern was also present, though to a lesser extent, in the abundance effects <bold>B</bold> (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S7</xref>). The estimation accuracy for <bold>B</bold> generally improved over sample size.</p>
        <p>We also performed an analysis on credible interval coverage, which can be viewed in <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S8.2</xref>. The analysis showed that coverage greatly depended on the sample size relative to the number of parameters in the model.</p>
      </sec>
      <sec>
        <title>3.2.2 Effect of <italic>λ</italic></title>
        <p>To demonstrate the shrinkage effects of the Laplace and exponential priors on the elements of <inline-formula id="IE69"><mml:math id="IM69"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE70"><mml:math id="IM70"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, we plotted the estimated values of these elements over values of the penalization parameter <italic>λ</italic> (<xref ref-type="fig" rid="btz824-F3">Fig. 3</xref>). It is clear that the value of <italic>λ</italic> had a profound impact on the magnitudes of the estimated parameters in both precision matrices. For values greater than 2<sup>10</sup> the estimates for all parameters were very close to zero (though never exactly equal to zero). We note that specifying an unnecessarily large value for the penalization parameter could cause issues with the HMC sampler and hence lead to unstable parameter estimates.</p>
        <fig id="btz824-F3" orientation="portrait" position="float">
          <label>Fig. 3.</label>
          <caption>
            <p>(Top) The MDiNE coefficient shrinkage paths for elements of <inline-formula id="IE71"><mml:math id="IM71"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE72"><mml:math id="IM72"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> over values of <italic>λ</italic>. (Bottom) The condition number of each matrix over the values of <italic>λ</italic>. The data came from the <italic>N </italic>=<italic> </italic>50, <italic>J </italic>=<italic> </italic>5 scenario. Note the horizontal axes are on a base-2 logarithmic scale</p>
          </caption>
          <graphic xlink:href="btz824f3"/>
        </fig>
        <p>The impact of <italic>λ</italic> was also evaluated through the condition numbers of <inline-formula id="IE73"><mml:math id="IM73"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE74"><mml:math id="IM74"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. The condition number of a positive-definite matrix is calculated as the ratio of the largest and smallest eigenvalues of the matrix (<xref rid="btz824-B41" ref-type="bibr">Won <italic>et al.</italic>, 2013</xref>). A large condition number implies that a covariance matrix is ill-conditioned, leading to numerical instability in inversion. The condition number for the estimated values of the two matrices over different values of <italic>λ</italic> are shown in <xref ref-type="fig" rid="btz824-F3">Figure 3</xref>. For very small values of <italic>λ</italic> the condition number was large. The condition number steadily decreased for larger values of <italic>λ</italic>, clearly demonstrating that the penalization parameter was able to prevent against an ill-conditioned precision matrix when its size was large relative to the sample size. The distributions of the estimated values of <italic>λ</italic> over the 100 simulation replications are shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>. As expected, higher values of <italic>λ</italic> were generally estimated for higher numbers of taxa included in the network analysis.</p>
      </sec>
    </sec>
    <sec>
      <title>3.3 Data application results</title>
      <p>We applied <monospace>MDiNE</monospace> to the Crohn’s disease dataset described in Section 2.7. The estimated family networks for Crohn’s and control samples are shown in <xref ref-type="fig" rid="btz824-F4">Figure 4</xref>. It appears that there were more positive co-occurrences in the control samples, whereas there were some additional negative co-occurrences in the Crohn’s samples. There were also important differences in the relative abundances of <italic>Bacteroidaceae</italic>, <italic>Porphyromonadacea</italic> and <italic>Lachnospiraceae</italic>.</p>
      <fig id="btz824-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Estimated co-occurrence from MDiNE at the family level in control (left) and Crohn’s (right) samples. An edge is displayed if its 90% credible interval does not contain zero. The size of a node represents its relative abundance. The placement of the nodes is based on multidimensional scaling of the precision matrix in the Crohn’s samples</p>
        </caption>
        <graphic xlink:href="btz824f4"/>
      </fig>
      <p>An important advantage of <monospace>MDiN</monospace>E over existing methods is the ability to detect significant changes in family co-occurrences with respect to Crohn’s status. <xref ref-type="fig" rid="btz824-F5">Figure 5</xref> characterizes the differences between the Crohn’s and control networks. Only associations that significantly differ between the two networks, based on 90% credible intervals, were included in the figure. Based on this criterion, only five family–family co-occurrence associations differed significantly between the Crohn’s cases and controls: <italic>Lachnospiraceae</italic> and <italic>Enterobacteriaceae</italic>; <italic>Lachnospiraceae</italic> and <italic>Erysipelotrichaceae</italic>; <italic>Erysipelotrichaceae</italic> and <italic>Fusobacteriaceae</italic>; <italic>Erysipelotrichaceae</italic> and <italic>Veillonellaceae</italic>; and <italic>Porphyromonadaceae</italic> and <italic>Pasteurellaceae</italic>.</p>
      <fig id="btz824-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Network differences between Crohn’s and control samples. An edge is shown when the co-occurrence between a pair of taxa differs significantly between the two groups based on the 90% credible interval. Colors show whether family abundance is higher in Crohn’s or in control samples. (Color version of this figure is available at <italic>Bioinformatics</italic> online.)</p>
        </caption>
        <graphic xlink:href="btz824f5"/>
      </fig>
      <p>The most pronounced shift in co-occurrence was between <italic>Lachnospiraceae</italic> and <italic>Enterobacteriaceae</italic>, with a modest positive co-occurrence in controls that essentially disappears in Crohn’s (partial correlations 0.1619 and 0.0051, respectively). Both <italic>Lachnospiraceae</italic> and <italic>Erysipelotrichaceae</italic> were previously shown to highly contribute to dissimilarity between aphthous ulcers (new-onset Crohn’s) and healthy control mucosa samples (<xref rid="btz824-B32" ref-type="bibr">O’Brien <italic>et al.</italic>, 2018</xref>). <monospace>MDiNE</monospace> estimated <italic>Enterobacteriaceae</italic> to be more abundant in Crohn’s samples and <italic>Lachnospiraceae</italic> to be less abundant, which is consistent with previous work (<xref rid="btz824-B15" ref-type="bibr">Frank <italic>et al.</italic>, 2007</xref>; <xref rid="btz824-B31" ref-type="bibr">Morgan <italic>et al.</italic>, 2012</xref>). Thus, <monospace>MDiNE</monospace> has been able to show an important change between Crohn’s and control samples in community structure beyond previous knowledge of differential abundance for <italic>Lachnospiraceae</italic> and <italic>Enterobacteriaceae</italic>.</p>
      <p>Next, we compared the estimated networks between <monospace>MDiNE</monospace>, <monospace>SPIEC-EASI</monospace> and <monospace>MInt</monospace>. Since <monospace>SPIEC-EASI</monospace> cannot handle covariates, we estimated the networks without adjusting for age, sex or antibiotic status. Results can be seen in <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S9.1</xref>.</p>
      <p><xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S12</xref> contains the estimated networks in Crohn’s cases and control samples for each of the estimation methods. It is evident that the edge density differed greatly between the methods, with <monospace>MInt</monospace> resulting in a very edge-dense network, and <monospace>SPIEC-EASI</monospace> resulting in a much more sparse network. <monospace>SPIEC-EASI</monospace> also appears to have mostly identified negative taxon co-occurrences, whereas both <monospace>MDiNE</monospace> and <monospace>MInt</monospace> uncovered both positive and negative co-occurrences.</p>
      <p>A natural question to ask is: to what extent do the three methods agree with respect to network edges? To test this we plotted the concordance between the methods in a Venn diagram, shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S13</xref>. There appears to be much more concordance between <monospace>MDiNE</monospace> and <monospace>MInt</monospace> with respect to network edges, as they agreed on 30 edges in the control samples, and 34 edges in the Crohn’s samples. There were only six edges common to both <monospace>MDiNE</monospace> and <monospace>SPIEC-EASI</monospace>. These six edges were identified in all three methods.</p>
      <p>The convergence of <monospace>MDiNE</monospace> was verified in <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S9.2</xref>. Traceplots and examination of the potential scale reduction factor confirmed proper mixing of chains and adequate convergence. These results are displayed in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figures S14–S17</xref>. In <xref ref-type="supplementary-material" rid="sup1">Supplementary Sections S9.3 and S9.4</xref>, we investigate the sensitivity to the choice of reference category as well as the assumption of normality in the log-ratio transformed data. Finally, in <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S9.5</xref>, we randomly split the Crohn’s dataset into two subsets of equal size and ran <monospace>MDiNE</monospace> in both. We compared estimates from both subsets, and showed that the results are quite reliable.</p>
      <p>This analysis has shown that there are important differences in co-occurrences between several highly abundant families in the intestinal microbiota of Crohn’s and control samples. Significance of such differences would not have been detected using previous network estimation methods.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We have introduced a new microbiome network estimation model that generally outperformed two existing precision matrix-based methods, both in terms of estimating individual taxon associations, as well as overall network structure. More importantly, we have defined our model in a way that differences between the associations in two networks defined by a binary variable could be directly estimated. As the model parameters were estimated through MCMC sampling, interval estimates for all model parameters were easily obtained. Though we presented an example from the 16S sequencing platform, <monospace>MDiNE</monospace> could be used on any count-based platform, such as RNA-seq data.</p>
    <p>Attention must be drawn to the more broad issue of sample size in network inference. If the desire is to perform inference on individual co-occurrences in the network, then it should be noted that applying a network estimation method with built-in regularization will tend to under estimate the number of true associations if the sample size is not sufficiently large. Even for a modest number of taxa (say 25), a relatively large sample size is required to ensure adequate credible interval coverage, due to the rapidly increasing number of parameters to estimate with increasing network size. We believe this fact has not been properly explored in the literature, and extra study of this problem would be beneficial. Additionally, though the model can handle a modest number of zero counts, the method should not be run on taxa with an excess of zeros, since there is no zero-inflation parameter. We therefore suggest filtering out taxa with a high proportion of zeros in one or both of the groups <italic>z<sub>i</sub></italic> = 0 or <italic>z<sub>i</sub></italic> = 1 before proceeding to run <monospace>MDiNE</monospace>.</p>
    <p>An important limitation of <monospace>MDiNE</monospace> is its running time. Though MCMC sampling has its advantages, the computational burden is always a factor. For example, on Compute Canada’s Graham cluster, with an Intel E5-2683 v4 Broadwell 2.1 GHz processor using 4 cores (one for each MCMC chain), the running times for the <italic>N </italic>=<italic> </italic>500, <italic>J </italic>=<italic> </italic>25 simulations ranged from 95 to 117 min for 1000 MCMC iterations. Regardless, <monospace>MDiNE</monospace> benefits from a Bayesian implementation because interval estimates can be obtained for both the network edges as well the changes in taxon–taxon associations with respect to the binary variable <italic>Z</italic>. Existing methods would have to rely on bootstrap sampling schemes or edge stability measures in order to determine the importance of associations between taxa. These additional procedures would greatly increase their computational times.</p>
    <p>For the moment, the MDiNE model only applies to a single binary covariate defining two networks. In future work, we plan to extend the method to estimate how the networks change with respect to a continuous covariate. This is a challenging problem, as the estimated precision matrix must be positive semi-definite for every possible value of the covariate. Some additional structure will need to be assumed in the parameterization of the precision matrix to satisfy this constraint.</p>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>We have developed a powerful new precision matrix-based network estimation tool called <monospace>MDiNE</monospace> which facilitates the comparison of networks defined by a binary covariate. Furthermore, interval estimates can be obtained both for network parameters as well as the difference between networks, which is not currently possible in existing microbiome network estimation methods.</p>
  </sec>
  <sec>
    <title>Software</title>
    <p>We have developed an R package called <monospace>mdine</monospace>. The package is currently available on Github <ext-link ext-link-type="uri" xlink:href="https://github.com/kevinmcgregor/mdine">https://github.com/kevinmcgregor/mdine</ext-link>.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>K.M. was supported by a Fonds de recherche du Québec-Santé doctoral award, as well as the McGill University Faculty of Medicine’s Cameron-Davis and Davis Fellowship and Gerald Clavet Fellowship. C.G. and A.L. acknowledge the CIHR operating grant (MOP-130344).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz824_Supplementary_Data</label>
      <media xlink:href="btz824_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz824-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Aitchison</surname><given-names>J.</given-names></name></person-group> (<year>1986</year>) <source>The Statistical Analysis of Compositional Data</source>. Monographs on Statistics and Applied Probability. 
<publisher-name>Chapman &amp; Hall Ltd</publisher-name>, 
<publisher-loc>London</publisher-loc>. Reprinted (2003) with additional material by The Blackburn Press, Caldwell, NJ, USA.</mixed-citation>
    </ref>
    <ref id="btz824-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Aitchison</surname><given-names>J.</given-names></name></person-group> (<year>1994</year>) <italic>Principles of Compositional Data Analysis</italic> Lecture Notes-Monograph Series. Institute of Mathematical Statistics, Beachwood, OH, pp. <fpage>73</fpage>–<lpage>81</lpage>.</mixed-citation>
    </ref>
    <ref id="btz824-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bajaj</surname><given-names>J.S.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Colonic mucosal microbiome differs from stool microbiome in cirrhosis and hepatic encephalopathy and is linked to cognition and inflammation</article-title>. <source>Am. J. Physiol. Gastrointest. Liver Physiol</source>., <volume>303</volume>, <fpage>G675</fpage>–<lpage>G685</lpage>.<pub-id pub-id-type="pmid">22821944</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Biswas</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Learning microbial interaction networks from metagenomic count data</article-title>. <source>J. Comput. Biol</source>., <volume>23</volume>, <fpage>526</fpage>–<lpage>535</lpage>.<pub-id pub-id-type="pmid">27267776</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brugman</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Antibiotic treatment partially protects against type 1 diabetes in the bio-breeding diabetes-prone rat. Is the gut flora involved in the development of type 1 diabetes?</article-title><source>Diabetologia</source>, <volume>49</volume>, <fpage>2105</fpage>–<lpage>2108</lpage>.<pub-id pub-id-type="pmid">16816951</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Cario</surname><given-names>M.C.</given-names></name>, <name name-style="western"><surname>Nelson</surname><given-names>B.L.</given-names></name></person-group> (<year>1997</year>) Modeling and generating random vectors with arbitrary marginal distributions and correlation matrix. <italic>Technical report</italic>. Citeseer.</mixed-citation>
    </ref>
    <ref id="btz824-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Carpenter</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Stan: a probabilistic programming language</article-title>. <source>J. Stat. Softw</source>., <volume>76</volume>. </mixed-citation>
    </ref>
    <ref id="btz824-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2013</year>) 
<article-title>Variable selection for sparse Dirichlet-multinomial regression with an application to microbiome data analysis</article-title>. <source>Ann. Appl. Stat</source>., <volume>7</volume>, <fpage>418</fpage>.</mixed-citation>
    </ref>
    <ref id="btz824-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chi</surname><given-names>E.C.</given-names></name>, <name name-style="western"><surname>Lange</surname><given-names>K.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Stable estimation of a covariance matrix guided by nuclear norm penalties</article-title>. <source>Comput. Stat. Data Anal</source>., <volume>80</volume>, <fpage>117</fpage>–<lpage>128</lpage>.<pub-id pub-id-type="pmid">25143662</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chu</surname><given-names>D.M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Maturation of the infant microbiome community structure and function across multiple body sites and in relation to mode of delivery</article-title>. <source>Nat. Med</source>., <volume>23</volume>, <fpage>314</fpage>.<pub-id pub-id-type="pmid">28112736</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Danaher</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>The joint graphical lasso for inverse covariance estimation across multiple classes</article-title>. <source>J. R. Stat. Soc. Series B Stat. Methodol</source>., <volume>76</volume>, <fpage>373</fpage>–<lpage>397</lpage>.<pub-id pub-id-type="pmid">24817823</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Drton</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Multiple testing and error control in Gaussian graphical model selection</article-title>. <source>Stat. Sci</source>., <volume>22</volume>, <fpage>430</fpage>–<lpage>449</lpage>.</mixed-citation>
    </ref>
    <ref id="btz824-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Erb</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Notredame</surname><given-names>C.</given-names></name></person-group> (<year>2016</year>) 
<article-title>How should we measure proportionality on relative gene expression data?</article-title><source>Theory Biosci</source>., <volume>135</volume>, <fpage>21</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">26762323</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fang</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>CCLasso: correlation inference for compositional data through lasso</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>3172</fpage>–<lpage>3180</lpage>.<pub-id pub-id-type="pmid">26048598</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Frank</surname><given-names>D.N.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Molecular-phylogenetic characterization of microbial community imbalances in human inflammatory bowel diseases</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>104</volume>, <fpage>13780</fpage>–<lpage>13785</lpage>.<pub-id pub-id-type="pmid">17699621</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Friedman</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Sparse inverse covariance estimation with the graphical lasso</article-title>. <source>Biostatistics</source>, <volume>9</volume>, <fpage>432</fpage>–<lpage>441</lpage>.<pub-id pub-id-type="pmid">18079126</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Friedman</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Alm</surname><given-names>E.J.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Inferring correlation networks from genomic survey data</article-title>. <source>PLoS Comput. Biol</source>., <volume>8</volume>, <fpage>e1002687</fpage>.<pub-id pub-id-type="pmid">23028285</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gevers</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>The treatment-naive microbiome in new-onset Crohn’s disease</article-title>. <source>Cell Host Microbe</source>, <volume>15</volume>, <fpage>382</fpage>–<lpage>392</lpage>.<pub-id pub-id-type="pmid">24629344</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gloor</surname><given-names>G.B.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Microbiome datasets are compositional: and this is not optional</article-title>. <source>Front. Microbiol</source>., <volume>8</volume>, <fpage>2224</fpage>.<pub-id pub-id-type="pmid">29187837</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gough</surname><given-names>E.K.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Linear growth faltering in infants is associated with acidaminococcus sp. and community-level changes in the gut microbiota</article-title>. <source>Microbiome</source>, <volume>3</volume>, <fpage>24</fpage>.<pub-id pub-id-type="pmid">26106478</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hibbing</surname><given-names>M.E.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Bacterial competition: surviving and thriving in the microbial jungle</article-title>. <source>Nat. Rev. Microbiol</source>., <volume>8</volume>, <fpage>15</fpage>.<pub-id pub-id-type="pmid">19946288</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Holmes</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Dirichlet multinomial mixtures: generative models for microbial metagenomics</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e30126</fpage>.<pub-id pub-id-type="pmid">22319561</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Khondker</surname><given-names>Z.S.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>The Bayesian covariance lasso</article-title>. <source>Stat. Interface</source>, <volume>6</volume>, <fpage>243</fpage>.<pub-id pub-id-type="pmid">24551316</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kuismin</surname><given-names>M.O.</given-names></name>, <name name-style="western"><surname>Sillanpää</surname><given-names>M.J.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Estimation of covariance and precision matrix, network structure, and a view toward systems biology</article-title>. <source>Wiley Interdiscip. Rev. Comput. Stat</source>., <volume>9</volume>, <fpage>e1415</fpage>.</mixed-citation>
    </ref>
    <ref id="btz824-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kurtz</surname><given-names>Z.D.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Sparse and compositionally robust inference of microbial ecological networks</article-title>. <source>PLoS Comput. Biol</source>., <volume>11</volume>, <fpage>e1004226</fpage>.<pub-id pub-id-type="pmid">25950956</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Levy</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Borenstein</surname><given-names>E.</given-names></name></person-group> (<year>2013</year>) 
<article-title>Metabolic modeling of species interaction in the human microbiome elucidates community-level assembly rules</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>110</volume>, <fpage>12804</fpage>–<lpage>12809</lpage>.<pub-id pub-id-type="pmid">23858463</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>Q.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>The Bayesian elastic net</article-title>. <source>Bayesian Anal</source>., <volume>5</volume>, <fpage>151</fpage>–<lpage>170</lpage>.</mixed-citation>
    </ref>
    <ref id="btz824-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lovell</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Proportionality: a valid alternative to correlation for relative data</article-title>. <source>PLoS Comput. Biol</source>., <volume>11</volume>, <fpage>e1004075</fpage>.<pub-id pub-id-type="pmid">25775355</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mahana</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Antibiotic perturbation of the murine gut microbiome enhances the adiposity, insulin resistance, and liver disease associated with high-fat diet</article-title>. <source>Genome Med</source>., <volume>8</volume>, <fpage>48</fpage>.<pub-id pub-id-type="pmid">27124954</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McMurdie</surname><given-names>P.J.</given-names></name>, <name name-style="western"><surname>Holmes</surname><given-names>S.</given-names></name></person-group> (<year>2013</year>) 
<article-title>phyloseq: an r package for reproducible interactive analysis and graphics of microbiome census data</article-title>. <source>PLoS One</source>, <volume>8</volume>, <fpage>e61217</fpage>.<pub-id pub-id-type="pmid">23630581</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Morgan</surname><given-names>X.C.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Dysfunction of the intestinal microbiome in inflammatory bowel disease and treatment</article-title>. <source>Genome Biol</source>., <volume>13</volume>, <fpage>R79</fpage>.<pub-id pub-id-type="pmid">23013615</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>O’Brien</surname><given-names>C.L.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>The microbiome of Crohn’s disease aphthous ulcers</article-title>. <source>Gut Pathog</source>., <volume>10</volume>, <fpage>44</fpage>.<pub-id pub-id-type="pmid">30337963</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Park</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Casella</surname><given-names>G.</given-names></name></person-group> (<year>2008</year>) 
<article-title>The Bayesian lasso</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>103</volume>, <fpage>681</fpage>–<lpage>686</lpage>.</mixed-citation>
    </ref>
    <ref id="btz824-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rannala</surname><given-names>B.</given-names></name></person-group> (<year>2002</year>) 
<article-title>Identifiability of parameters in MCMC Bayesian inference of phylogeny</article-title>. <source>Syst. Biol</source>., <volume>51</volume>, <fpage>754</fpage>–<lpage>760</lpage>.<pub-id pub-id-type="pmid">12396589</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ruiz</surname><given-names>V.E.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>A single early-in-life macrolide course has lasting effects on murine microbial network topology and immunity</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>518</fpage>.<pub-id pub-id-type="pmid">28894149</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Skinnider</surname><given-names>M.A.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Evaluating measures of association for single-cell transcriptomics</article-title>. <source>Nat. Methods</source>, <volume>16</volume>, <fpage>381</fpage>.<pub-id pub-id-type="pmid">30962620</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Turnbaugh</surname><given-names>P.J.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>The human microbiome project</article-title>. <source>Nature</source>, <volume>449</volume>, <fpage>804</fpage>.<pub-id pub-id-type="pmid">17943116</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Turnbaugh</surname><given-names>P.J.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>A core gut microbiome in obese and lean twins</article-title>. <source>Nature</source>, <volume>457</volume>, <fpage>480</fpage>.<pub-id pub-id-type="pmid">19043404</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B39">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>van den Boogaart</surname><given-names>K.G.</given-names></name>, <name name-style="western"><surname>Tolosana-Delgado</surname><given-names>R.</given-names></name></person-group> (<year>2013</year>) <chapter-title>Fundamental concepts of compositional data analysis</chapter-title> In: Gentleman,R. <italic>et al</italic> (eds) <source>Analyzing Compositional Data with R</source>. 
<publisher-name>Springer</publisher-name>, Berlin, Heidelberg, pp. <fpage>13</fpage>–<lpage>50</lpage>.</mixed-citation>
    </ref>
    <ref id="btz824-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>H.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Bayesian graphical lasso models and efficient posterior computation</article-title>. <source>Bayesian Anal</source>., <volume>7</volume>, <fpage>867</fpage>–<lpage>886</lpage>.</mixed-citation>
    </ref>
    <ref id="btz824-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Won</surname><given-names>J.-H.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Condition-number-regularized covariance estimation</article-title>. <source>J. R. Stat. Soc. Series B Stat. Methodol</source>., <volume>75</volume>, <fpage>427</fpage>–<lpage>450</lpage>.<pub-id pub-id-type="pmid">23730197</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xia</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>A logistic normal multinomial regression model for microbiome compositional data analysis</article-title>. <source>Biometrics</source>, <volume>69</volume>, <fpage>1053</fpage>–<lpage>1063</lpage>.<pub-id pub-id-type="pmid">24128059</pub-id></mixed-citation>
    </ref>
    <ref id="btz824-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xiao-Ke</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Structural robustness of weighted complex networks based on natural connectivity</article-title>. <source>Chin. Phys. Lett</source>., <volume>30</volume>, <fpage>108901</fpage>.</mixed-citation>
    </ref>
    <ref id="btz824-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhao</surname><given-names>S.D.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Direct estimation of differential networks</article-title>. <source>Biometrika</source>, <volume>101</volume>, <fpage>253</fpage>–<lpage>268</lpage>.<pub-id pub-id-type="pmid">26023240</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
