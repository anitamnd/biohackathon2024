<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5533426</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0182392</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-17-16567</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Genomic Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genomic Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genomic Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Metagenomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Comparative Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Comparative Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Storage and Handling</subject>
          <subj-group>
            <subject>Specimen Storage</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Nucleotide Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Nucleotide Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Digestive System</subject>
            <subj-group>
              <subject>Mouth</subject>
              <subj-group>
                <subject>Tongue</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Digestive System</subject>
            <subj-group>
              <subject>Mouth</subject>
              <subj-group>
                <subject>Tongue</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Bacteriology</subject>
            <subj-group>
              <subject>Bacterial Genetics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Microbial Genetics</subject>
            <subj-group>
              <subject>Bacterial Genetics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Genomics</subject>
            <subj-group>
              <subject>Bacterial Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>metaSNV: A tool for metagenomic strain level analysis</article-title>
      <alt-title alt-title-type="running-head">metaSNV: A tool for metagenomic strain level analysis</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1645-3947</contrib-id>
        <name>
          <surname>Costea</surname>
          <given-names>Paul Igor</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Munch</surname>
          <given-names>Robin</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Paoli</surname>
          <given-names>Lucas</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sunagawa</surname>
          <given-names>Shinichi</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bork</surname>
          <given-names>Peer</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
        <xref ref-type="aff" rid="aff006">
          <sup>6</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Structural and Computational Biology Unit, European Molecular Biology Laboratory, Heidelberg, Germany</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Biology, Institute of Microbiology, ETH Zurich, Zurich, Switzerland</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Biology, Ecole normale supérieure, Paris, France</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Max-Delbrück-Centre for Molecular Medicine, Berlin, Germany</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Bioinformatics, Biocenter, University of Würzburg, Würzburg, Germany</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Molecular Medicine Partnership Unit, Heidelberg, Germany</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wang</surname>
          <given-names>Kai</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Columbia University Medical Center, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>bork@embl.de</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>12</volume>
    <issue>7</issue>
    <elocation-id>e0182392</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>4</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>7</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2017 Costea et al</copyright-statement>
      <copyright-year>2017</copyright-year>
      <copyright-holder>Costea et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0182392.pdf"/>
    <abstract>
      <p>We present metaSNV, a tool for single nucleotide variant (SNV) analysis in metagenomic samples, capable of comparing populations of thousands of bacterial and archaeal species. The tool uses as input nucleotide sequence alignments to reference genomes in standard SAM/BAM format, performs SNV calling for individual samples and across the whole data set, and generates various statistics for individual species including allele frequencies and nucleotide diversity per sample as well as distances and fixation indices across samples. Using published data from 676 metagenomic samples of different sites in the oral cavity, we show that the results of metaSNV are comparable to those of MIDAS, an alternative implementation for metagenomic SNV analysis, while data processing is faster and has a smaller storage footprint. Moreover, we implement a set of distance measures that allow the comparison of genomic variation across metagenomic samples and delineate sample-specific variants to enable the tracking of specific strain populations over time. The implementation of metaSNV is available at: <ext-link ext-link-type="uri" xlink:href="http://metasnv.embl.de/">http://metasnv.embl.de/</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000781</institution-id>
            <institution>European Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>669830</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bork</surname>
            <given-names>Peer</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>Helmut Horten Foundation</institution>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Sunagawa</surname>
            <given-names>Shinichi</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>ETH Zurich</institution>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Sunagawa</surname>
            <given-names>Shinichi</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>European Molecular Biology Laboratory</institution>
        </funding-source>
      </award-group>
      <funding-statement>This work has been supported by the European Molecular Biology Laboratory and the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme (MicrobioS, grant agreement No. 669830). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="2"/>
      <table-count count="1"/>
      <page-count count="9"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Software is available at <ext-link ext-link-type="uri" xlink:href="https://git.embl.de/costea/metaSNV">https://git.embl.de/costea/metaSNV</ext-link>. All samples are available through the HMP project: <ext-link ext-link-type="uri" xlink:href="http://hmpdacc.org/">http://hmpdacc.org/</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Software is available at <ext-link ext-link-type="uri" xlink:href="https://git.embl.de/costea/metaSNV">https://git.embl.de/costea/metaSNV</ext-link>. All samples are available through the HMP project: <ext-link ext-link-type="uri" xlink:href="http://hmpdacc.org/">http://hmpdacc.org/</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Recently, strain-level analysis of metagenomes has been shown to be feasible even for complex communities such as the human gut [<xref rid="pone.0182392.ref001" ref-type="bibr">1</xref>] and a number of tools have been consequently developed to enable researchers to study microbial communities at this level of resolution. These tools differ considerably in approach and assumptions as well as in the type of information they provide as output. As such, conspecific strains can be disentangled based either on gene content [<xref rid="pone.0182392.ref002" ref-type="bibr">2</xref>,<xref rid="pone.0182392.ref003" ref-type="bibr">3</xref>] or using specific SNVs [<xref rid="pone.0182392.ref001" ref-type="bibr">1</xref>,<xref rid="pone.0182392.ref004" ref-type="bibr">4</xref>]. The latter approach is the category that the current work falls under, though here also the specifics vary, with some tools attempting to reconstruct mini-haplotypes, based either of core species genes [<xref rid="pone.0182392.ref005" ref-type="bibr">5</xref>] or species-specific marker genes [<xref rid="pone.0182392.ref006" ref-type="bibr">6</xref>], while others try to characterize the genome-wide variation landscape, without endeavouring to construct haplotypes [<xref rid="pone.0182392.ref001" ref-type="bibr">1</xref>,<xref rid="pone.0182392.ref004" ref-type="bibr">4</xref>]. All these approaches are dependent of the availability of reference genomes and may thus only be applied to well characterized environments. Complementary methodology is being developed to tackle the challenge of characterizing samples for which few or no reference genomes are available, by combining metagenomic assembly with single cell sequencing [<xref rid="pone.0182392.ref007" ref-type="bibr">7</xref>].</p>
    <p>There are two main challenges in the use of these of the reference dependent tools, which are of interest here: usability and interpretability. For the former, as the number of samples to compare increases, considerations such as run-time and storage footprint become increasingly important. In the case of the latter, the tools currently available output primary analyses that require additional work to interpret the results.</p>
    <p>Here, we present a fast and scalable tool, metaSNV, for quantifying genomic variation based on original concepts and procedures of Schloissnig et al. [<xref rid="pone.0182392.ref001" ref-type="bibr">1</xref>], with additional functionality and packaged as an easy to use pipeline. We compare its performance and output to MIDAS as an alternative implementation [<xref rid="pone.0182392.ref004" ref-type="bibr">4</xref>], which also aims at characterizing whole genome variation based on mapping to one representative genome per species. We do not perform a comparison to the output of tools that use only a subset of the genome to determine strain haplotypes, be it a set of common marker genes [<xref rid="pone.0182392.ref005" ref-type="bibr">5</xref>] or a species-specific set [<xref rid="pone.0182392.ref006" ref-type="bibr">6</xref>].</p>
    <p>metaSNV uses a collection of microbial reference genomes, where each species is represented by a single representative genome to avoid redundancy [<xref rid="pone.0182392.ref008" ref-type="bibr">8</xref>,<xref rid="pone.0182392.ref009" ref-type="bibr">9</xref>]. Alternatively, users may specify their own reference genome or gene collection. We show that our approach identifies extensive variation within microbial species and that this variation is informative in quantifying differences between metagenomic samples. Towards this end, metaSNV also implements a set of distance measures that can be used to compare the variation profiles between samples in order to determine genetic distances of strain populations and to identify relations to explanatory variables of interest (sampling site, environmental conditions, health states, etc.).</p>
    <p>As a demonstration, using data from the Human Microbiome Project (HMP) [<xref rid="pone.0182392.ref010" ref-type="bibr">10</xref>], we show that the genomic variation of most bacteria that inhabit the human oral cavity is highly correlated with the specific sub-habitat that they have been collected from (e.g. tongue dorsum vs. supra-gingival plaque) and that individual SNV profiles are stable over time.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <p>The pipeline input is a list of alignment files in SAM/BAM format, which contain the results of mapping metagenomic samples to a reference genome database. Results presented here were computed using bwa as an aligner [<xref rid="pone.0182392.ref011" ref-type="bibr">11</xref>]; however other tools can be used. In particular, we describe the parameters we used to quality control metagenomic sequences on the tutorial webpage (<ext-link ext-link-type="uri" xlink:href="http://metasnv.embl.de/">http://metasnv.embl.de/</ext-link>) and how to use bwa and Ngless (<ext-link ext-link-type="uri" xlink:href="http://ngless.embl.de/">http://ngless.embl.de/</ext-link>) to produce BAM files [<xref rid="pone.0182392.ref012" ref-type="bibr">12</xref>] which can be used as input for metaSNV. As previously stated, the reference genome database may be a custom one created by the user or the one deployed with the current software [<xref rid="pone.0182392.ref009" ref-type="bibr">9</xref>]. metaSNV is structured as a sequence of three processing steps (<xref ref-type="fig" rid="pone.0182392.g001">Fig 1A</xref>), with the first two wrapped together in one command and a separate script for post-processing. Firstly, we determine the average coverage over each reference genome in each sample. For this, we run qaCompute per sample (a tool from the qaTools suite <ext-link ext-link-type="uri" xlink:href="https://github.com/CosteaPaul/qaTools">https://github.com/CosteaPaul/qaTools</ext-link>, which is deployed with metaSNV) and aggregate the coverage information. This step can be parallelized as each sample coverage estimation is independent of all others. In the next step we compute the genomic variation and output all of the variant positions that meet the imposed quality criteria. Here we take advantage of the mpileup tool in samtools [<xref rid="pone.0182392.ref013" ref-type="bibr">13</xref>], in order to obtain per-position variant information. These variant calls then get filtered based on the given criteria and if a gene position file is given, get annotated as synonymous or non-synonymous change compared to the reference allele. For this processing steps also, metaSNV supports multi-threading to use multiple cores. Lastly, we provide post-processing analyses of the SNV landscape and allow the user to compute per species pair-wise distance matrices of samples, as well as evolutionary measures such as nucleotide diversity and fixation index [<xref rid="pone.0182392.ref014" ref-type="bibr">14</xref>,<xref rid="pone.0182392.ref015" ref-type="bibr">15</xref>].</p>
    <fig id="pone.0182392.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0182392.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Overview of analysis pipeline and example results.</title>
        <p>(A) shows the SNV calling and analysis workflow, consisting of an optional pre-processing step, which splits the computation load into subsets of similar size based on the genome coverage, the main SNV calling step and further post-processing of the raw output, which can be tailored according to the aim of the analysis. (B) shows the Principal Coordinate Analysis projection of a pairwise distance between oral samples, based on population SNVs, which clearly separates strain populations in tongue dorsum samples from those in supra-gingival plaque samples. (C) shows the tracking of the individual SNV frequencies within an individual over a period of 384 days. Each line represents one variant position and the respective colour encodes the amount by which the allele frequency of that position changed over time; red represents stable variants that maintain their frequency while in blue are positions which dramatically change their frequency in the population. Only a small number of positions vary over the measured period, with most remaining at approximately the same population frequency, suggesting great stability of strain populations within the individual.</p>
      </caption>
      <graphic xlink:href="pone.0182392.g001"/>
    </fig>
    <p>If desired, metaSNV can automatically estimate a balanced split of the input data and divide the overall work into multiple jobs, which can then be executed in parallel over many machines in a high-performance computing cluster.</p>
    <sec id="sec003">
      <title>Genome coverage estimation</title>
      <p>Given an alignment file (in standard BAM format [<xref rid="pone.0182392.ref013" ref-type="bibr">13</xref>]), we estimate the vertical coverage, that is the number of bases covering each genome divided by its length. We also compute the horizontal coverage, namely the percentage of the genome that is covered by at least one read. Based on the coverage information, the reference may be divided into parts that are estimated to require similar execution times.</p>
    </sec>
    <sec id="sec004">
      <title>Population and individual SNV calling</title>
      <p>We determine the existence of a candidate variant on a per-nucleotide basis, building upon the mpileup tool in the samtools package [<xref rid="pone.0182392.ref013" ref-type="bibr">13</xref>]. All reads from all samples that align to a given position are considered together. If at least four variant containing reads cover a position (across all samples), it is considered a potential SNV [<xref rid="pone.0182392.ref001" ref-type="bibr">1</xref>]. Variants are split into two classes: population and individual variants. The former are non-reference nucleotides observed in more than 1% of all reads combined across all samples. The individual variants are those that fall below the 1% frequency population threshold, but are confidently observed in at least one sample (at least four reads containing the variant). If multiple different non-reference nucleotides are observed, all are reported independently. We observed such multi-allelic positions to be rare in our experiments: 3.7% of the population variants and 1.6% of the individual ones. While the four reads criterion filters out sequencing errors randomly distributed across the genome, the 1% criterion eliminates random sequencing errors that accumulate in the same position when depth of coverage reaches very high numbers; conservative error rates have been estimated for these cut-offs to be in the range of 0.35–0.7% [<xref rid="pone.0182392.ref001" ref-type="bibr">1</xref>]. The thresholds described are the default settings for the pipeline, but may be customized by the user if desired.</p>
    </sec>
    <sec id="sec005">
      <title>Post-processing and analysis</title>
      <p>Taxon, sample and position filters are applied post SNV calling. Within each sample, we consider a taxon to have been observed if the respective genome has a vertical coverage of at least 5x and a horizontal coverage of at least 40%. We impose the 5x vertical coverage cut-off to prevent ascertainment biases due to spurious coverage. In addition, as high vertical coverages can be reached by spurious mapping of sufficiently high numbers of short reads to highly conserved genes or genomic regions, we additionally impose a horizontal coverage filter. We base the default cut off (40%) on a previously estimated lower bound of the genome percentage shared by distinct <italic>E</italic>. <italic>coli</italic> strains [<xref rid="pone.0182392.ref016" ref-type="bibr">16</xref>]. We note that this lower bound is rather conservative and we generally find more than 80% horizontal coverage at 5x in human faecal samples. However, this ensures the presence of the given species in the sample of interest. Both these cut-offs can be customized by the user, though we recommend using the proposed ones to ensure the accuracy of subsequent distance estimations. Resulting SNVs are further filtered to only consider those positions which were covered at 5x in at least 50% of samples, ensuring that only variation over commonly observed positions is considered. For downstream processing, we implemented a per-taxon computation of pair-wise distance matrices between all samples, based on these filtered SNVs. These distances are based on non-reference allele frequencies across all the pair-wise observed variants. Namely, a Manhattan distance, which adds the absolute frequency difference per site and normalizes to the total number of comparisons. That is, the number of sites for which the comparison was possible; if a position was not observed in a sample, it is ignored in the calculation. Additionally, we offer a “major allele” distance, which only considers differences in the major allele per site; that is, frequency differences greater of equal to 60%. We note that if a position has multiple variants, these are considered independently. Finally, nucleotide diversity (π) [<xref rid="pone.0182392.ref014" ref-type="bibr">14</xref>,<xref rid="pone.0182392.ref017" ref-type="bibr">17</xref>] within and between samples and fixation indexes (F<sub>ST</sub>) [<xref rid="pone.0182392.ref015" ref-type="bibr">15</xref>] can be adapted to metagenomics data [<xref rid="pone.0182392.ref018" ref-type="bibr">18</xref>] and computed for each species as previously described [<xref rid="pone.0182392.ref001" ref-type="bibr">1</xref>]:
<disp-formula id="pone.0182392.e001"><alternatives><graphic xlink:href="pone.0182392.e001.jpg" id="pone.0182392.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>G</mml:mi></mml:mfrac><mml:munderover><mml:mo>Σ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>V</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>G</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
<disp-formula id="pone.0182392.e002"><alternatives><graphic xlink:href="pone.0182392.e002.jpg" id="pone.0182392.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula>
Where G is the size of the genome, and x<sub>S,i,N</sub> the frequency of nucleotide N, at position i in the genome, in sample S. All measured described above result in values from 0 to 1, with 1 denoting the greatest dissimilarity between two populations.</p>
    </sec>
  </sec>
  <sec id="sec006">
    <title>Results and discussion</title>
    <p>We have applied the SNV pipeline to 676 shotgun metagenomes from the oral cavity, collected as part of the Human Microbiome Project (HMP) [<xref rid="pone.0182392.ref010" ref-type="bibr">10</xref>]. The result for <italic>Capnocytophaga sputigena</italic> demonstrates that samples from the tongue dorsum of an individual’s oral cavity cluster separately from those collected from supra-gingival plaque (<xref ref-type="fig" rid="pone.0182392.g001">Fig 1B</xref>). This result provides strong evidence that the strain populations inhabiting the two habitats are divergent, reminiscent of previously described ecotypes [<xref rid="pone.0182392.ref019" ref-type="bibr">19</xref>,<xref rid="pone.0182392.ref020" ref-type="bibr">20</xref>]. Furthermore, metaSNVs enables the tracking of strains within individuals over time using individual specific variant positions (<xref ref-type="fig" rid="pone.0182392.g001">Fig 1C</xref>). Thus, we can track the evolutionary path of SNVs and show that they can be remarkably stable within an individual, even when measured ~400 days later. Specifically, we note that the frequency of the vast majority of variants in the population stays relatively constant, with only few positions being fixed or cleared from the population.</p>
    <p>To compare our results with MIDAS [<xref rid="pone.0182392.ref004" ref-type="bibr">4</xref>], we selected two sites in the oral cavity, tongue dorsum and supra-gingival plaque, and analysed 80 randomly selected HMP samples from these body sites, supra-gingival plaque (N = 40) and tongue dorsum (N = 40). As differences in the called positions themselves are not informative, we computed the Manhattan distance on the allele frequencies using the output from both tools, while running them with similar parameters (using merge_midas.py snps with—min_samples 10—sample_depth 5.0—fract_cov 0.4—site_depth 5—site_prev 0.5—site_maf 0.01 and metaSNV_post.py with -m 10). The distances computed are comparable, with a median R<sup>2</sup> of 0.81 for the common species and sample intersects, suggesting both methods capture the same genomic variation profile. Common species overlap with a Jaccard-index of 0.86 and the sample intersects per species average a Jaccard-index of 0.89. (<xref ref-type="fig" rid="pone.0182392.g002">Fig 2</xref>). Thus, the two methods are able to assess genome variation across the same samples and the resulting characterization is mostly the same.</p>
    <fig id="pone.0182392.g002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0182392.g002</object-id>
      <label>Fig 2</label>
      <caption>
        <title>Comparison of metaSNV and MIDAS results.</title>
        <p>Correlation coefficient (R<sup>2</sup>, mantel) for the pairwise distance matrices generated by MIDAS and metaSNV (top). Compared are only sample intersects for species examined with both methods. Jaccard indices for the sample overlap per species was computed (bottom). The average sample number and average Jaccard index over all samples intersect is shown in the legend.</p>
      </caption>
      <graphic xlink:href="pone.0182392.g002"/>
    </fig>
    <sec id="sec007">
      <title>Runtime Benchmarking</title>
      <p>In order to compare running time and storage footprint we used both approaches with matching parameters and up to 32 CPUs per job. The average runtime for each processing step (alignment, species abundance estimation, SNV calling, filtering and post-processing) was computed by averaging the real time for each individual job (up to 80 jobs per processing step, one for each sample or split). The pipeline's absolute runtime is the sum of all necessary tasks, hence the average real-time to run the total work-flow from fastq files to distance matrix (<xref ref-type="table" rid="pone.0182392.t001">Table 1</xref>).</p>
      <table-wrap id="pone.0182392.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0182392.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Resource comparison for metaSNV and MIDAS.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0182392.t001g" xlink:href="pone.0182392.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">Jobs</th>
                <th align="center" rowspan="1" colspan="1">CPU/Job</th>
                <th align="center" rowspan="1" colspan="1">CPUs</th>
                <th align="center" rowspan="1" colspan="1">Max RAM</th>
                <th align="center" rowspan="1" colspan="1">Time/Job</th>
                <th align="center" rowspan="1" colspan="1">Time</th>
                <th align="center" rowspan="1" colspan="1">Disk</th>
                <th align="center" rowspan="1" colspan="1">CPU Time</th>
                <th align="center" rowspan="1" colspan="1">Total RAM</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">
                  <italic>#</italic>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>#</italic>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>#</italic>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>[GB]</italic>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>[min]</italic>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>[min]</italic>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>[GB]</italic>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>[min]</italic>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>[GB]</italic>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>MetaSNV</bold>
                </td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Alignment</td>
                <td align="right" rowspan="1" colspan="1">80</td>
                <td align="right" rowspan="1" colspan="1">32</td>
                <td align="right" rowspan="1" colspan="1">2560</td>
                <td align="right" rowspan="1" colspan="1">51.00</td>
                <td align="right" rowspan="1" colspan="1">100</td>
                <td align="right" rowspan="1" colspan="1">8000</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">256000</td>
                <td align="right" rowspan="1" colspan="1">2484</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Species</td>
                <td align="right" rowspan="1" colspan="1">80</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">80</td>
                <td align="right" rowspan="1" colspan="1">0.02</td>
                <td align="right" rowspan="1" colspan="1">20</td>
                <td align="right" rowspan="1" colspan="1">1600</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">1600</td>
                <td align="right" rowspan="1" colspan="1">1.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SNVs</td>
                <td align="right" rowspan="1" colspan="1">12</td>
                <td align="right" rowspan="1" colspan="1">2</td>
                <td align="right" rowspan="1" colspan="1">24</td>
                <td align="right" rowspan="1" colspan="1">0.16</td>
                <td align="right" rowspan="1" colspan="1">100</td>
                <td align="right" rowspan="1" colspan="1">1200</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">2400</td>
                <td align="right" rowspan="1" colspan="1">1.9</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Filter/merge</td>
                <td align="right" rowspan="1" colspan="1">12</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">12</td>
                <td align="right" rowspan="1" colspan="1">0.02</td>
                <td align="right" rowspan="1" colspan="1">5</td>
                <td align="right" rowspan="1" colspan="1">60</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">60</td>
                <td align="right" rowspan="1" colspan="1">0.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Post</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>TOTAL</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">185</td>
                <td align="right" rowspan="1" colspan="1">37</td>
                <td align="right" rowspan="1" colspan="1">2677</td>
                <td align="right" rowspan="1" colspan="1">51.20</td>
                <td align="right" rowspan="1" colspan="1">226</td>
                <td align="right" rowspan="1" colspan="1">10861</td>
                <td align="right" rowspan="1" colspan="1">241</td>
                <td align="right" rowspan="1" colspan="1">260061</td>
                <td align="right" rowspan="1" colspan="1">2488</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>MIDAS</bold>
                </td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Species</td>
                <td align="right" rowspan="1" colspan="1">80</td>
                <td align="right" rowspan="1" colspan="1">32</td>
                <td align="right" rowspan="1" colspan="1">2560</td>
                <td align="right" rowspan="1" colspan="1">7.80</td>
                <td align="right" rowspan="1" colspan="1">50</td>
                <td align="right" rowspan="1" colspan="1">4000</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">128000</td>
                <td align="right" rowspan="1" colspan="1">302</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SNVs</td>
                <td align="right" rowspan="1" colspan="1">80</td>
                <td align="right" rowspan="1" colspan="1">32</td>
                <td align="right" rowspan="1" colspan="1">2560</td>
                <td align="right" rowspan="1" colspan="1">2.50</td>
                <td align="right" rowspan="1" colspan="1">310</td>
                <td align="right" rowspan="1" colspan="1">24800</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">793600</td>
                <td align="right" rowspan="1" colspan="1">626</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Filter/merge</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">1.60</td>
                <td align="right" rowspan="1" colspan="1">3094</td>
                <td align="right" rowspan="1" colspan="1">3094</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">3094</td>
                <td align="right" rowspan="1" colspan="1">0.9</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Post</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>TOTAL</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">162</td>
                <td align="right" rowspan="1" colspan="1">66</td>
                <td align="right" rowspan="1" colspan="1">5122</td>
                <td align="right" rowspan="1" colspan="1">11.90</td>
                <td align="right" rowspan="1" colspan="1">3455</td>
                <td align="right" rowspan="1" colspan="1">31895</td>
                <td align="right" rowspan="1" colspan="1">537</td>
                <td align="right" rowspan="1" colspan="1">924695</td>
                <td align="right" rowspan="1" colspan="1">930</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">MIDAS/MetaSNV</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>0.88</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>1.78</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>1.91</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>0.23</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>15.29</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>2.94</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>2.23</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>3.56</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>0.37</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">From Alignment</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">MIDAS/MetaSNV</td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>1.54</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>13.20</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>43.78</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>59.50</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>27.42</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>11.15</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">
                  <bold>-</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>227.70</bold>
                </td>
                <td align="right" rowspan="1" colspan="1">
                  <bold>242.4</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">From BAM</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>Breakdown of resource usage, including number of jobs, number of CPUs, maximum and average RAM usage, CPU time and storage footprint (this number does not include the original fasta files used in the analysis).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>metaSNV processed all the samples in 226 minutes (132 minutes if the samples were already aligned) and produced 18 GB output (241 GB including the alignment files). This processing time includes alignment (BWA), species abundance estimation (qaCompute), SNV calling (samtools + metaSNV called in parallel computing modus) and post-processing (filtering). In comparison, MIDAS ran for 3455 minutes and produced 537 GB output.</p>
      <p>The difference in storage footprint is explained by the fact that metaSNV only outputs positions at which at least one variant across all samples was observed, while MIDAS output all positions. Overall, metaSNV was 15.3 times faster than MIDAS while using 48% less CPUs (2677 total) and has less than half the storage footprint.</p>
    </sec>
    <sec id="sec008">
      <title>Availability of reference genomes: Limitations and perspectives</title>
      <p>metaSNV can be broadly applied to investigate bacterial populations across varying habitats, hosts or clinical conditions. One important consideration, however, is that of availability of reference genomes. At the moment, the collection we provide contains representative genomes for over 5,000 bacterial species [<xref rid="pone.0182392.ref009" ref-type="bibr">9</xref>], though they represent a biased sample of different environments. For instance, the current database only captures a fraction (6%) of the reads collected from the <italic>Tara</italic> Oceans expedition. Nonetheless, the recent release of newly sequenced prokaryotes based on phylogenetic coverage could significantly improve the number of species for previously under-sampled habitats [<xref rid="pone.0182392.ref021" ref-type="bibr">21</xref>]. Additionally, the improvement culture-independent sequencing techniques such as single-cell sequencing or reference-independent approaches [<xref rid="pone.0182392.ref007" ref-type="bibr">7</xref>] could further reduce such biases.</p>
      <p>Taken together, we have shown that metaSNV offers a fast, scalable and reliable way of quantifying prokaryotic single nucleotide variation in hundreds of samples. Moreover, we provide easy to use scripts for analyzing this variation in different settings both to compare populations across samples and to track them over time.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the members of the Bork group for testing the software and providing feedback, Yan Ping Yuan and Ivica Letunic for help in setting up the website and Renato Alves for code reviews and additional input.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0182392.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Schloissnig</surname><given-names>S</given-names></name>, <name><surname>Arumugam</surname><given-names>M</given-names></name>, <name><surname>Sunagawa</surname><given-names>S</given-names></name>, <name><surname>Mitreva</surname><given-names>M</given-names></name>, <name><surname>Tap</surname><given-names>J</given-names></name>, <name><surname>Zhu</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Genomic variation landscape of the human gut microbiome</article-title>. <source>Nature. Nature Publishing Group</source>; <year>2013</year>;<volume>493</volume>: <fpage>45</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11711">10.1038/nature11711</ext-link></comment><?supplied-pmid 23222524?><pub-id pub-id-type="pmid">23222524</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Zhu</surname><given-names>A</given-names></name>, <name><surname>Sunagawa</surname><given-names>S</given-names></name>, <name><surname>Mende</surname><given-names>DR</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>. <article-title>Inter-individual differences in the gene content of human gut bacterial species</article-title>. <source>Genome Biol</source>. <year>2015</year>;<volume>16</volume>: <fpage>82</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13059-015-0646-9">10.1186/s13059-015-0646-9</ext-link></comment><?supplied-pmid 25896518?><pub-id pub-id-type="pmid">25896518</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Scholz</surname><given-names>M</given-names></name>, <name><surname>Ward</surname><given-names>D V</given-names></name>, <name><surname>Pasolli</surname><given-names>E</given-names></name>, <name><surname>Tolio</surname><given-names>T</given-names></name>, <name><surname>Zolfo</surname><given-names>M</given-names></name>, <name><surname>Asnicar</surname><given-names>F</given-names></name>, <etal>et al</etal><article-title>Strain-level microbial epidemiology and population genomics from shotgun metagenomics</article-title>. <source>Nat Methods. Nature Research</source>; <year>2016</year>;<volume>13</volume>: <fpage>435</fpage>–<lpage>438</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.3802">10.1038/nmeth.3802</ext-link></comment><?supplied-pmid 26999001?><pub-id pub-id-type="pmid">26999001</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Nayfach</surname><given-names>S</given-names></name>, <name><surname>Rodriguez-Mueller</surname><given-names>B</given-names></name>, <name><surname>Garud</surname><given-names>N</given-names></name>, <name><surname>Pollard</surname><given-names>KS</given-names></name>. <article-title>An integrated metagenomics pipeline for strain profiling reveals novel patterns of bacterial transmission and biogeography</article-title>. <source>Genome Res. Cold Spring Harbor Laboratory Press</source>; <year>2016</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.201863.115">10.1101/gr.201863.115</ext-link></comment><?supplied-pmid 27803195?><pub-id pub-id-type="pmid">27803195</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Luo</surname><given-names>C</given-names></name>, <name><surname>Knight</surname><given-names>R</given-names></name>, <name><surname>Siljander</surname><given-names>H</given-names></name>, <name><surname>Knip</surname><given-names>M</given-names></name>, <name><surname>Xavier</surname><given-names>RJ</given-names></name>, <name><surname>Gevers</surname><given-names>D</given-names></name>. <article-title>ConStrains identifies microbial strains in metagenomic datasets</article-title>. <source>Nat Biotechnol</source>. <year>2015</year>;<volume>33</volume>: <fpage>1045</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.3319">10.1038/nbt.3319</ext-link></comment><?supplied-pmid 26344404?><pub-id pub-id-type="pmid">26344404</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Truong</surname><given-names>DT</given-names></name>, <name><surname>Tett</surname><given-names>A</given-names></name>, <name><surname>Pasolli</surname><given-names>E</given-names></name>, <name><surname>Huttenhower</surname><given-names>C</given-names></name>, <name><surname>Segata</surname><given-names>N</given-names></name>. <article-title>Microbial strain-level population structure &amp; genetic diversity from metagenomes</article-title>. <source>Genome Res. Cold Spring Harbor Laboratory Press</source>; <year>2017</year>;<volume>27</volume>: <fpage>626</fpage>–<lpage>638</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.216242.116">10.1101/gr.216242.116</ext-link></comment><?supplied-pmid 28167665?><pub-id pub-id-type="pmid">28167665</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Ji</surname><given-names>P</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Zhao</surname><given-names>F</given-names></name>. <article-title>MetaSort untangles metagenome assembly by reducing microbial community complexity</article-title>. <source>Nat Commun</source>. <year>2017</year>;<volume>8</volume>: <fpage>14306</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms14306">10.1038/ncomms14306</ext-link></comment><?supplied-pmid 28112173?><pub-id pub-id-type="pmid">28112173</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Mende</surname><given-names>DR</given-names></name>, <name><surname>Sunagawa</surname><given-names>S</given-names></name>, <name><surname>Zeller</surname><given-names>G</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>. <article-title>Accurate and universal delineation of prokaryotic species</article-title>. <source>Nat Methods. Nature Publishing Group, a division of Macmillan Publishers Limited. All Rights Reserved</source>.; <year>2013</year>;<volume>10</volume>: <fpage>881</fpage>–<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.2575">10.1038/nmeth.2575</ext-link></comment><?supplied-pmid 23892899?><pub-id pub-id-type="pmid">23892899</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Mende</surname><given-names>DR</given-names></name>, <name><surname>Letunic</surname><given-names>I</given-names></name>, <name><surname>Huerta-Cepas</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>SS</given-names></name>, <name><surname>Forslund</surname><given-names>K</given-names></name>, <name><surname>Sunagawa</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>proGenomes: a resource for consistent functional and taxonomic annotations of prokaryotic genomes</article-title>. <source>Nucleic Acids Res. Oxford University Press</source>; <year>2016</year>; gkw989. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkw989">10.1093/nar/gkw989</ext-link></comment><?supplied-pmid 28053165?><pub-id pub-id-type="pmid">28053165</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Huttenhower</surname><given-names>C</given-names></name>, <name><surname>Gevers</surname><given-names>D</given-names></name>, <name><surname>Knight</surname><given-names>R</given-names></name>, <name><surname>Abubucker</surname><given-names>S</given-names></name>, <name><surname>Badger</surname><given-names>JH</given-names></name>, <name><surname>Chinwalla</surname><given-names>AT</given-names></name>, <etal>et al</etal><article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature. Nature Publishing Group, a division of Macmillan Publishers Limited. All Rights Reserved</source>.; <year>2012</year>;<volume>486</volume>: <fpage>207</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11234">10.1038/nature11234</ext-link></comment><?supplied-pmid 22699609?><pub-id pub-id-type="pmid">22699609</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name>. <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>: <fpage>1754</fpage>–<lpage>1760</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btp324">10.1093/bioinformatics/btp324</ext-link></comment><?supplied-pmid 19451168?><pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>R</given-names></name>, <name><surname>Yu</surname><given-names>C</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Lam</surname><given-names>TW</given-names></name>, <name><surname>Yiu</surname><given-names>SM</given-names></name>, <name><surname>Kristiansen</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>SOAP2: An improved ultrafast tool for short read alignment</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>: <fpage>1966</fpage>–<lpage>1967</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btp336">10.1093/bioinformatics/btp336</ext-link></comment><?supplied-pmid 19497933?><pub-id pub-id-type="pmid">19497933</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Handsaker</surname><given-names>B</given-names></name>, <name><surname>Wysoker</surname><given-names>A</given-names></name>, <name><surname>Fennell</surname><given-names>T</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <name><surname>Homer</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics. Oxford University Press</source>; <year>2009</year>;<volume>25</volume>: <fpage>2078</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btp352">10.1093/bioinformatics/btp352</ext-link></comment><?supplied-pmid 19505943?><pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Nei</surname><given-names>M</given-names></name>, <name><surname>Li</surname><given-names>WH</given-names></name>. <article-title>Mathematical model for studying genetic variation in terms of restriction endonucleases</article-title>. <source>Proc Natl Acad Sci. National Academy of Sciences</source>; <year>1979</year>;<volume>76</volume>: <fpage>5269</fpage>–<lpage>5273</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.76.10.5269">10.1073/pnas.76.10.5269</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Wright</surname><given-names>S</given-names></name>. <article-title>The genetical structure of natural populations</article-title>. <source>Ann Eugen</source>. <year>1951</year>;<volume>15</volume>: <fpage>323</fpage>–<lpage>354</lpage>. <?supplied-pmid 24540312?><pub-id pub-id-type="pmid">24540312</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Touchon</surname><given-names>M</given-names></name>, <name><surname>Hoede</surname><given-names>C</given-names></name>, <name><surname>Tenaillon</surname><given-names>O</given-names></name>, <name><surname>Barbe</surname><given-names>V</given-names></name>, <name><surname>Baeriswyl</surname><given-names>S</given-names></name>, <name><surname>Bidet</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>Organised genome dynamics in the Escherichia coli species results in highly diverse adaptive paths</article-title>. <name><surname>Casades?s</surname><given-names>J</given-names></name>, editor. <source>PLoS Genet</source>. <year>2009</year>;<volume>5</volume>: <fpage>e1000344</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1000344">10.1371/journal.pgen.1000344</ext-link></comment><?supplied-pmid 19165319?><pub-id pub-id-type="pmid">19165319</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Nei</surname><given-names>M</given-names></name>, <name><surname>Genetics</surname><given-names>P</given-names></name>. <article-title>Analysis of gene diversity in subdivided populations</article-title>. <source>Proc Nat Acad Sci</source>. <year>1973</year>;<volume>70</volume>: <fpage>3321</fpage>–<lpage>3323</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.70.12.3321">10.1073/pnas.70.12.3321</ext-link></comment><?supplied-pmid 4519626?><pub-id pub-id-type="pmid">4519626</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Begun</surname><given-names>DJ</given-names></name>, <name><surname>Holloway</surname><given-names>AK</given-names></name>, <name><surname>Stevens</surname><given-names>K</given-names></name>, <name><surname>Hillier</surname><given-names>LW</given-names></name>, <name><surname>Poh</surname><given-names>Y-P</given-names></name>, <name><surname>Hahn</surname><given-names>MW</given-names></name>, <etal>et al</etal><article-title>Population Genomics: Whole-Genome Analysis of Polymorphism and Divergence in Drosophila simulans</article-title>. <name><surname>Noor</surname><given-names>MAF</given-names></name>, editor. <source>PLoS Biol. Chapman &amp; Hall</source>; <year>2007</year>;<volume>5</volume>: <fpage>e310</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pbio.0050310">10.1371/journal.pbio.0050310</ext-link></comment><?supplied-pmid 17988176?><pub-id pub-id-type="pmid">17988176</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>ZI</given-names></name>, <name><surname>Zinser</surname><given-names>ER</given-names></name>, <name><surname>Coe</surname><given-names>A</given-names></name>, <name><surname>McNulty</surname><given-names>NP</given-names></name>, <name><surname>Woodward</surname><given-names>EMS</given-names></name>, <name><surname>Chisholm</surname><given-names>SW</given-names></name>. <article-title>Niche partitioning among Prochlorococcus ecotypes along ocean-scale environmental gradients</article-title>. <source>Science. American Association for the Advancement of Science</source>; <year>2006</year>;<volume>311</volume>: <fpage>1737</fpage>–<lpage>40</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1118052">10.1126/science.1118052</ext-link></comment><?supplied-pmid 16556835?><pub-id pub-id-type="pmid">16556835</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Koeppel</surname><given-names>AF</given-names></name>, <name><surname>Wu</surname><given-names>M</given-names></name>. <article-title>Surprisingly extensive mixed phylogenetic and ecological signals among bacterial Operational Taxonomic Units</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>: <fpage>5175</fpage>–<lpage>88</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkt241">10.1093/nar/gkt241</ext-link></comment><?supplied-pmid 23571758?><pub-id pub-id-type="pmid">23571758</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0182392.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Mukherjee</surname><given-names>S</given-names></name>, <name><surname>Stamatis</surname><given-names>D</given-names></name>, <name><surname>Bertsch</surname><given-names>J</given-names></name>, <name><surname>Ovchinnikova</surname><given-names>G</given-names></name>, <name><surname>Verezemska</surname><given-names>O</given-names></name>, <name><surname>Isbandi</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Genomes OnLine Database (GOLD) v.6: data updates and feature enhancements</article-title>. <source>Nucleic Acids Res</source>. <year>2017</year>;<volume>45</volume>: <fpage>D446</fpage>–<lpage>D456</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkw992">10.1093/nar/gkw992</ext-link></comment><?supplied-pmid 27794040?><pub-id pub-id-type="pmid">27794040</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
