<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genetics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">genetics</journal-id>
    <journal-title-group>
      <journal-title>Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0016-6731</issn>
    <issn pub-type="epub">1943-2631</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9526043</article-id>
    <article-id pub-id-type="pmid">36000888</article-id>
    <article-id pub-id-type="doi">10.1093/genetics/iyac126</article-id>
    <article-id pub-id-type="publisher-id">iyac126</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Investigation</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Statistical Genetics and Genomics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01180</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI00010</subject>
        <subject>AcademicSubjects/SCI00960</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Dcifer: an IBD-based method to calculate genetic distance between polyclonal infections</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7772-7473</contrib-id>
        <name>
          <surname>Gerlovina</surname>
          <given-names>Inna</given-names>
        </name>
        <xref rid="iyac126-cor1" ref-type="corresp"/>
        <!--inna.gerlovina@ucsf.edu-->
        <aff><institution>EPPIcenter Research Program, Division of HIV, ID and Global Medicine, Department of Medicine, University of California</institution>, San Francisco, San Francisco, CA 94143, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6062-8471</contrib-id>
        <name>
          <surname>Gerlovin</surname>
          <given-names>Boris</given-names>
        </name>
        <aff><institution>EPPIcenter Research Program, Division of HIV, ID and Global Medicine, Department of Medicine, University of California</institution>, San Francisco, San Francisco, CA 94143, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6784-1021</contrib-id>
        <name>
          <surname>Rodríguez-Barraquer</surname>
          <given-names>Isabel</given-names>
        </name>
        <aff><institution>EPPIcenter Research Program, Division of HIV, ID and Global Medicine, Department of Medicine, University of California</institution>, San Francisco, San Francisco, CA 94143, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0287-9111</contrib-id>
        <name>
          <surname>Greenhouse</surname>
          <given-names>Bryan</given-names>
        </name>
        <aff><institution>EPPIcenter Research Program, Division of HIV, ID and Global Medicine, Department of Medicine, University of California</institution>, San Francisco, San Francisco, CA 94143, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Browning</surname>
          <given-names>S</given-names>
        </name>
        <role>Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="iyac126-cor1">Corresponding author: EPPIcenter Research Program, Division of HIV, ID and Global Medicine, Department of Medicine, University of California, San Francisco, 1001 Potrero Avenue, San Francisco, CA 94110, USA. Email: <email>inna.gerlovina@ucsf.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-08-24">
      <day>24</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <volume>222</volume>
    <issue>2</issue>
    <elocation-id>iyac126</elocation-id>
    <history>
      <date date-type="accepted">
        <day>04</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="received">
        <day>14</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>10</day>
        <month>9</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of Genetics Society of America.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="iyac126.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>An essential step toward reconstructing pathogen transmission and answering epidemiologically relevant questions from genomic data is obtaining pairwise genetic distance between infections. For recombining organisms such as malaria parasites, relatedness measures quantifying recent shared ancestry would provide a meaningful distance, suggesting methods based on identity by descent (IBD). While the concept of relatedness and consequently an IBD approach is fairly straightforward for individual parasites, the distance between polyclonal infections, which are prevalent in malaria, presents specific challenges, and awaits a general solution that could be applied to infections of any clonality and accommodate multiallelic (e.g. microsatellite or microhaplotype) and biallelic [single nucleotide polymorphism (SNP)] data. Filling this methodological gap, we present Dcifer (Distance for complex infections: fast estimation of relatedness), a method for calculating genetic distance between polyclonal infections, which is designed for unphased data, explicitly accounts for population allele frequencies and complexity of infection, and provides reliable inference. Dcifer’s IBD-based framework allows us to define model parameters that represent interhost relatedness and to propose corresponding estimators with attractive statistical properties. By using combinatorics to account for unobserved phased haplotypes, Dcifer is able to quickly process large datasets and estimate pairwise relatedness along with measures of uncertainty. We show that Dcifer delivers accurate and interpretable results and detects related infections with statistical power that is 2–4 times greater than that of approaches based on identity by state. Applications to real data indicate that relatedness structure aligns with geographic locations. Dcifer is implemented in a comprehensive publicly available software package.</p>
    </abstract>
    <kwd-group>
      <kwd>genetic relatedness</kwd>
      <kwd>identity by descent</kwd>
      <kwd>genetic distance</kwd>
      <kwd>ancestry</kwd>
      <kwd>
        <italic toggle="yes">Plasmodium</italic>
      </kwd>
      <kwd>polyclonal infection</kwd>
      <kwd>microhaplotype</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Bill &amp; Melinda Gates Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000865</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>INV-019043</award-id>
        <award-id>INV-024346</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="15"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Monitoring, effective control, and ultimately elimination of malaria can be accelerated by understanding the dynamics of malaria transmission including evaluation of interventions, identification of sources and sinks, and determining the drivers of sustained transmission. Given the substantial genetic diversity of malaria parasites, genomic data have the potential to illuminate important aspects of epidemiology (<xref rid="iyac126-B34" ref-type="bibr">World Health Organization 2019</xref>). Compared to viruses where mutations are the main source of variation and can be used directly to make temporal inferences, reconstructing transmission for recombining organisms with lower mutation rates requires a different approach. Since genetic recombination between malaria parasites occurs in the mosquito during person-to-person transmission, genetic relatedness can provide information on their shared ancestry and therefore transmission epidemiology at relevant timescales. Consequently, pairwise genetic distance as a measure of relatedness between infections may be more useful and detailed for answering epidemiologic questions than metrics based on comparison between populations (<xref rid="iyac126-B26" ref-type="bibr">Taylor <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac126-B31" ref-type="bibr">Wesolowski <italic toggle="yes">et al.</italic> 2018</xref>; <xref rid="iyac126-B5" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> 2019</xref>; <xref rid="iyac126-B27" ref-type="bibr">Tessema <italic toggle="yes">et al.</italic> 2019</xref>). By assessing how closely related individual infections are, pairwise distance can also provide answers to questions such as whether particular infections were more likely to have been acquired locally or imported.</p>
    <p>Due to coinfection and super-infection, individuals in endemic areas are often infected with multiple genetically distinct clones simultaneously. These polyclonal infections are the rule rather than the exception for <italic toggle="yes">Plasmodium falciparum</italic> in many endemic areas, even in relatively low transmission settings of sub-Saharan Africa (<xref rid="iyac126-B23" ref-type="bibr">Roh <italic toggle="yes">et al.</italic> 2019</xref>); polyclonality may be even more common for <italic toggle="yes">Plasmodium vivax</italic> (<xref rid="iyac126-B17" ref-type="bibr">Koepfli <italic toggle="yes">et al.</italic> 2011</xref>; <xref rid="iyac126-B32" ref-type="bibr">White <italic toggle="yes">et al.</italic> 2018</xref>). Assessing genetic relatedness between polyclonal infections is more complicated both conceptually and methodologically than doing so for individual parasites. Obtaining phased genotypes of individual parasites from polyclonal infections would present a potential solution, but outside of single-cell sequencing this currently requires the use of statistical methods which are computationally intensive and may have limited accuracy in the absence of informative reference genomes, particularly when more than 2 clones are present (<xref rid="iyac126-B35" ref-type="bibr">Zhu <italic toggle="yes">et al.</italic> 2019</xref>). Even with phased genotypes, a unified summary of relatedness might be useful as a distance measure, so that it could be compared across pairs of infections that may be either monoclonal or have a higher complexity of infection (COI). Incorporating multiallelic genetic data, i.e. diverse loci with more than 2 variants, can improve the estimation of relatedness between monoclonal infections (<xref rid="iyac126-B25" ref-type="bibr">Taylor <italic toggle="yes">et al.</italic> 2019</xref>) and may offer an even greater improvement over biallelic loci for polyclonal infections (<xref rid="iyac126-B28" ref-type="bibr">Tessema <italic toggle="yes">et al.</italic> 2022</xref>). Fortunately, current technologies make it feasible to efficiently amplify and sequence multiple diverse regions of the <italic toggle="yes">Plasmodium</italic> genome, generating multiallelic data for this purpose (<xref rid="iyac126-B19" ref-type="bibr">Lerch <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac126-B2" ref-type="bibr">Aydemir <italic toggle="yes">et al.</italic> 2018</xref>; <xref rid="iyac126-B28" ref-type="bibr">Tessema <italic toggle="yes">et al.</italic> 2022</xref>; <xref rid="iyac126-B18" ref-type="bibr">LaVerriere <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    <p>Much of the epidemiologically useful information contained in relatedness measures lies in detecting shared ancestry; there is therefore interest in estimating the proportion of genomes that are identical due to descent. Currently available methods based on identity by descent (IBD) for <italic toggle="yes">Plasmodia</italic> are developed for monoclonal infections or are adapted from human genetics: hmmIBD is designed for monoclonal infections and can incorporate multiallelic as well as biallelic loci (<xref rid="iyac126-B24" ref-type="bibr">Schaffner <italic toggle="yes">et al.</italic> 2018</xref>); isoRelate is able to accommodate polyclonal infections (<xref rid="iyac126-B13" ref-type="bibr">Henden <italic toggle="yes">et al.</italic> 2018</xref>), but is limited to biallelic loci and has unclear applicability to infections with COI &gt;2 since it is based on the diploid model. With no existing IBD-based methods to infer a degree of shared ancestry from polyclonal infections using multiallelic data, various suboptimal workarounds are generally employed. For example, some studies have attempted to infer a “dominant strain” from polyclonal infections using within host allele frequencies, while others have excluded polyclonal infections from the analysis altogether. Depending on the proportion of infections that are polyclonal, such procedures may grossly underutilize data or introduce bias to the analysis due to informative missingness. Alternatively, a simple identity by state (IBS) approach has been used (<xref rid="iyac126-B22" ref-type="bibr">Pringle <italic toggle="yes">et al.</italic> 2019</xref>; <xref rid="iyac126-B27" ref-type="bibr">Tessema <italic toggle="yes">et al.</italic> 2019</xref>; <xref rid="iyac126-B1" ref-type="bibr">Atuh <italic toggle="yes">et al.</italic> 2021</xref>); it is convenient and fast but has extensive drawbacks as it produces similarity measures that are not easy to interpret and address relatedness only indirectly (<xref rid="iyac126-B25" ref-type="bibr">Taylor <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>To fill the methodological gap, we introduce Dcifer (distance for complex infections: fast estimation of relatedness), a method employing IBD to estimate the level of common ancestry between polyclonal samples. It allows for unphased multiallelic data such as microsatellites or microhaplotypes as well as SNPs, explicitly takes into account COI and population allele frequencies, and does not require densely spaced or linked markers. Focusing on interhost relatedness, we developed a working model that allowed us to define an estimator with desirable statistical properties and formal inference. As the method provides a probabilistic solution to the multitude of possible underlying phased genomes, we used a unified mixed radix incrementing combinatorial algorithm for its implementation as a comprehensive R software package (<xref rid="iyac126-B12" ref-type="bibr">Gerlovina 2022</xref>): github.com/EPPIcenter/dcifer (accessed 2022 Aug 25). Finally, we assessed the performance of Dcifer for estimating relatedness between <italic toggle="yes">P. falciparum</italic> infections using simulations and empirical data.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>The working model we developed is designed to address interhost relatedness and includes assumptions that reduce a complex realistic dependence structure to a simpler model that still allows us to formally define and estimate the quantity of interest without introducing significant bias. The main assumptions can be summarized as the absence of linkage disequilibrium and intrahost relatedness. As the observed data are several levels removed from the random variables we are interested in, the likelihood for the model accounts for various possible unobserved combinations (phased haplotypes) with multinomial-based probabilities and the use of combinatorics; consequently, numerical methods are used to find a maximum likelihood estimate. The likelihood incorporates population allele frequencies and COI of both samples, and the estimation process explicitly accounts for the fact that alleles present in both infections may match by chance (i.e. be identical by state but not by descent).</p>
    <p>Consider 2 infections with COI of <italic toggle="yes">n<sub>x</sub></italic>, <italic toggle="yes">n<sub>y</sub></italic>, and a panel of <italic toggle="yes">T</italic> multiallelic markers. At each locus <italic toggle="yes">t</italic>, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, there is a set <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> of possible alleles. For convenience, we can arbitrarily order the alleles and map them to the corresponding population allele frequencies <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mo>π</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mo>π</mml:mo><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mo>π</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. We assume that the underlying population allele frequencies are the same for both infections.</p>
    <sec>
      <title>IBD model for 2 haplotypes</title>
      <p>To build up a model for relatedness between polyclonal infections, we first consider 2 haplotypes. Let sequences of random variables <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> represent these haplotypes, and let <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mo mathvariant="italic">(</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mn mathvariant="italic">1</mml:mn></mml:msub><mml:mo mathvariant="italic">,</mml:mo><mml:mo mathvariant="italic">…</mml:mo><mml:mo mathvariant="italic">,</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="italic">T</mml:mi></mml:msub><mml:mo mathvariant="italic">)</mml:mo></mml:math></inline-formula> be a sequence of independent identically distributed random variables, where <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="italic">t</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo mathvariant="italic">∼</mml:mo><mml:mo> </mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mo mathvariant="italic">(</mml:mo><mml:mi>r</mml:mi><mml:mo mathvariant="italic">)</mml:mo></mml:math></inline-formula> and parameter <italic toggle="yes">r</italic> describes the level of relatedness of the 2 haplotypes (<xref rid="iyac126-B25" ref-type="bibr">Taylor <italic toggle="yes">et al.</italic> 2019</xref>). Let <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">P<sub>t</sub></italic> is a categorical distribution with values in <italic toggle="yes">A<sub>t</sub></italic> and corresponding probabilities <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:msub><mml:mo>π</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>π</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>⊥</mml:mo><mml:mo> </mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="italic">t</mml:mi></mml:msub></mml:math></inline-formula>; let <italic toggle="yes">Y<sub>t</sub></italic> be a random variable such that
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mo stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="italic">t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="italic">t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>Note that <italic toggle="yes">X<sub>t</sub></italic> and <italic toggle="yes">Y<sub>t</sub></italic> are interchangeable in this setup, and the joint distribution of <italic toggle="yes">X<sub>t</sub></italic> and <italic toggle="yes">Y<sub>t</sub></italic> (marginal and conditional on <italic toggle="yes">IBD</italic><sub><italic toggle="yes">t</italic></sub>) would not change if they were switched. While <italic toggle="yes">IBD</italic><sub><italic toggle="yes">t</italic></sub> are i.i.d., (<italic toggle="yes">X<sub>t</sub></italic>, <italic toggle="yes">Y<sub>t</sub></italic>) are marginally independent but not identically distributed since <italic toggle="yes">P<sub>t</sub></italic> is different for each <italic toggle="yes">t</italic>.</p>
      <p>We can also define a random variable <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>≡</mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, with <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi mathvariant="italic">t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="italic">t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi mathvariant="italic">t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>. In this model, realizations of <italic toggle="yes">X</italic> and <italic toggle="yes">Y</italic> could be observed (e.g. if they represent monoclonal infections and there is no genotyping error) but <italic toggle="yes">IBD</italic>’s are unobservable. In contrast, <italic toggle="yes">IBS</italic><sub><italic toggle="yes">t</italic></sub> are directly observed if <italic toggle="yes">X</italic> and <italic toggle="yes">Y</italic> are observed.</p>
    </sec>
    <sec>
      <title>Working model for polyclonal infections</title>
      <p>Let an <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> matrix <bold><italic toggle="yes">X</italic></bold> and <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> matrix <bold><italic toggle="yes">Y</italic></bold> represent 2 polyclonal infections with COI of <italic toggle="yes">n<sub>x</sub></italic> and <italic toggle="yes">n<sub>y</sub></italic>, with rows of the matrices referring to haplotypes and columns to loci. Thus, <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, is an <italic toggle="yes">i</italic>’th haplotype of the first infection, and a column <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a sequence of random variables with values in <italic toggle="yes">A<sub>t</sub></italic> representing alleles for all the haplotypes at a locus <italic toggle="yes">t</italic>. Let <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> denote a multiset (a collection of elements that are not necessarily distinct) of unordered elements of a <italic toggle="yes">t</italic>’th column of <bold><italic toggle="yes">X</italic></bold> and let <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></inline-formula> be a set of unique elements in that column; <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are defined similarly. For realizations of <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> we will use notation <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are not observed, but <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are). The model assumes no genotyping error, and the sequences of sets <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are observed data, for which Dcifer is designed.</p>
      <p>There are <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> pairs of malaria strains that can be related. To differentiate <italic toggle="yes">IBD</italic><sub><italic toggle="yes">t</italic></sub> and parameters of their distributions for different pairs, let <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo mathvariant="italic"> </mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> refer to a pair within first infection, a pair within second infection, and a between-host pair, respectively, and, similarly, let <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denote corresponding relatedness parameters. If we are only interested in between-host relatedness (which may be the case for many practical applications), we might formulate the goal as “estimating interhost relatedness adjusted for intrahost relatedness,” which would condense <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> parameters into some lower-dimensional summary. Usefulness of adjusting for intrahost relatedness can be illustrated by considering a case where an extra haplotype <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, very closely related to an existing one (say, <italic toggle="yes">X</italic><sub>1</sub>, with <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math></inline-formula>), is added to one of the infections. That would result in essentially doubling <italic toggle="yes">X</italic><sub>1</sub>’s contribution <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to the sum <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> of all interhost relatedness parameters, as well as increasing COI (recall that <italic toggle="yes">n<sub>x</sub></italic> is defined as a number of distinct haplotypes). With such goal as our scientific question, we introduce a simplifying assumption of no intrahost relatedness, which projects a realistic model of unconstrained intrahost and interhost relatedness parameters onto a much smaller model space and allows us to make the problem tractable while aiming to arrive at the same summary estimate as we would if we were able to estimate all the parameters in a bigger model.</p>
      <p>For each pair of strains in 2 infections, e.g. <italic toggle="yes">i</italic>’th strain in the first sample and <italic toggle="yes">j</italic>’th in the second, let <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> be the random variables as defined in <italic toggle="yes">IBD Model for 2 Haplotypes</italic>. Then, for the working model for polyclonal infections, we introduce the following assumptions:
</p>
      <list list-type="order">
        <list-item>
          <p><inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> (no intrahost relatedness) and</p>
        </list-item>
        <list-item>
          <p><inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>⊥</mml:mo><mml:mo> </mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> if <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math></inline-formula> for all <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> (all interhost <italic toggle="yes">IBD</italic> variables are independent at a given locus).</p>
        </list-item>
      </list>
      <p>An important implication of these two assumptions is that any strain in one sample can be related to at most one strain in another: <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow/><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow/><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. This can be proven by contradiction: since <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>⊥</mml:mo><mml:mo> </mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>≥</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>. If <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, then <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, which contradicts assumption 1. For further discussion on the model assumptions, see <xref rid="s1" ref-type="supplementary-material">Supplementary Section 1 in File_1</xref>.</p>
      <p>Since we can order strains within an infection arbitrarily, and in light of the constraints of the model, we order the haplotypes in 2 infections in such a way that <italic toggle="yes">X</italic><sub>1</sub> can only be related to <italic toggle="yes">Y</italic><sub>1</sub>, <italic toggle="yes">X</italic><sub>2</sub> to <italic toggle="yes">Y</italic><sub>2</sub>, and so on (<xref rid="iyac126-F1" ref-type="fig">Fig. 1</xref>). In addition, we introduce <italic toggle="yes">M—</italic>the number of strain pairs that can be related, <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Then, for brevity, we suppress some of the subscripts and use <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (note that parameters for all the other <italic toggle="yes">IBD</italic> variables are zero). The goal of Dcifer is to estimate parameters of the joint distribution of <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Let <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denote an estimand, and <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>—its maximum likelihood estimator (MLE):
<disp-formula id="E2"><label>(1)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mo> </mml:mo><mml:mtext>max </mml:mtext></mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:msup></mml:mrow></mml:msub></mml:munder><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <fig position="float" id="iyac126-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Working model presented at a single locus <italic toggle="yes">t</italic>: an example featuring <italic toggle="yes">n<sub>x</sub></italic> = 4, <italic toggle="yes">n<sub>y</sub></italic> = 3, and <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>3. Colors of the circles represent alleles; 2 clones in each infection have the same allele. <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a multiset of shared (nonunique) alleles at a locus <italic toggle="yes">t</italic>.</p>
        </caption>
        <graphic xlink:href="iyac126f1" position="float"/>
      </fig>
      <p>At each locus <italic toggle="yes">t</italic>, the likelihood <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> needs to account for all the possible combinations of nonunique alleles in both samples (multiple haplotypes will have the same allele if COI is greater than the number of unique alleles). For one sample, this is done by considering a set of all multisets with given support and cardinality (all the <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> that could have produced <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, see <xref rid="iyac126-F1" ref-type="fig">Fig. 1</xref>); we denote a set of all multisets <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> such that <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">Supp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> by <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can be calculated using a probability mass function of a multinomial distribution: the number of permutations of <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is equal to a multinomial coefficient (“assigning” alleles in <italic toggle="yes">s<sub>x</sub></italic> to strains, or going from <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>), and allele frequencies correspond to event probabilities. Multiplicities of the multiset’s elements <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, or the numbers of strains having the same allele, are multinomial random variables. Adopting a short notation for this key component of the likelihood, let <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>π</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denote a probability mass function for a multinomial distribution <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mi>M</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mo>π</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>π</mml:mo><mml:mi>K</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, where <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is a multiset of cardinality <italic toggle="yes">n</italic> (<inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>) with elements from <italic toggle="yes">K</italic> categories, and <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>π</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mo>π</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>π</mml:mo><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are probabilities for these categories; set <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>∅</mml:mo><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>π</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Next, for given <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, we divide their elements into 3 groups: shared alleles that are identical by descent (say <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), remaining alleles in <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">∖</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), and remaining alleles in <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">∖</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). The probability of each of these multisets is similarly calculated using multinomial distributions. <xref rid="s1" ref-type="supplementary-material">Supplementary Section 2 in File_1</xref> provides more details and builds up the likelihood from <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>1 and <inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. For a general case,
<disp-formula id="E3"><label>(2)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo> </mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mo> </mml:mo><mml:mo>⋯</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mo stretchy="true">[</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo stretchy="true">[</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="true">]</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where
<disp-formula id="E4"><mml:math id="M4" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>m</mml:mi><mml:mo>&gt;</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>⊆</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mo>π</mml:mo><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mo>×</mml:mo><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi mathvariant="normal">∖</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mo>π</mml:mo><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mo>×</mml:mo><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mi mathvariant="normal">∖</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mo>π</mml:mo><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo> </mml:mo><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
and <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
      <p>When <inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula>, the likelihood reduces to
<disp-formula id="E5"><label>(3)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo> </mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo> </mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mo> </mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi mathvariant="italic">Binom</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo> </mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:munderover><mml:mrow><mml:mo> </mml:mo><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where <inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">Binom</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>;</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>M</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>m</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
      <p>While <inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are independent, <inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are not. This dependence stems from the fact that we do not observe ordered alleles at each locus (or, in other words, phased haplotypes). That also provides intuition for why <inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is estimated more accurately than individual <italic toggle="yes">r<sub>i</sub></italic>'s : estimating <inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> at a locus <italic toggle="yes">t</italic> is easier than estimating an actual binary sequence <inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>. Another useful observation is that the order of parameter values in <bold><italic toggle="yes">r</italic></bold> does not affect the value of <inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which can be taken into account when the likelihood is evaluated over a grid of <inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>Calculating the likelihood in (2) requires solving a number of combinatorial problems: finding all the collections of nonunique alleles at a locus that are concordant with observed alleles and COI, finding all the multisets included in a given multiset of shared nonunique alleles, and finding all the possible binary sequences with given constraints for IBD variables. These problems are solved with a unified mixed radix incrementing algorithm (<ext-link xlink:href="https://github.com/innager/mirsa/tree/v1.0.0" ext-link-type="uri">https://github.com/innager/mirsa/tree/v1.0.0</ext-link>; accessed 2022 Aug 25) (<xref rid="s2" ref-type="supplementary-material">Supplementary File_2</xref>), which is an extension of an algorithm to generate all <italic toggle="yes">n</italic>-tuples in (<xref rid="iyac126-B16" ref-type="bibr">Knuth 2011</xref>). As the calculation traverses the combinations described above, multiple <inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> sequences can be processed at each step, and thus the likelihood for a range of parameter values can be calculated in a single pass. With bounded parameter space, this allows for an efficient way to find MLE by simply calculating the likelihood for an <italic toggle="yes">M</italic>-dimensional grid of a desired coarseness. The resulting log-likelihood curve or surface can also be useful for inference, especially for procedures based on a likelihood ratio approach, such as testing various hypotheses or determining confidence regions. For a special case of <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>1, the log-likelihood can be calculated using <xref rid="s1" ref-type="supplementary-material">Supplementary Equation (2) in File_1</xref>, which also admits fast calculation of the score and consequently numerical methods of solving the likelihood equation (Newton’s method adapted for bounded parameter space is used in the package).</p>
    </sec>
    <sec>
      <title>Inference</title>
      <p>Along with an estimate of <bold><italic toggle="yes">r</italic></bold>, Dcifer provides a log-likelihood function, which can serve as a basis for various inferential procedures (for some intuition on the shape of that log-likelihood function, the effect of COI and population allele frequencies on it, and implications for the inference, see <xref rid="s1" ref-type="supplementary-material">Supplementary Section 3 in File_1</xref>). In our model, sample size is <italic toggle="yes">T</italic>, but different loci do not provide the same amount of information (recall that <inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> are independent but not identically distributed); their contribution can be associated with different measures, e.g. heterozygosity. Given these measures and the complexity of the estimator, methods relying on asymptotic approximations should be approached cautiously; still, as the sample size increases, precision of estimation increases as well.</p>
      <p>For hypothesis testing and confidence intervals (CI)/regions, we consider common inferential approaches as applied to Dcifer: asymptotic normality, likelihood-ratio statistics, and resampling methods. There are common challenges that affect all 3 approaches: bounded parameter space <inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> with edge cases not only included but conceptually important, such as a null hypothesis <inline-formula id="IE102"><mml:math id="IM102" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> of infections being unrelated; for other cases, sampling distributions for different (even neighboring) parameter values on the interior of the support could be quite different for panels with even fairly large <italic toggle="yes">T</italic>. Still, some approaches might be better suited for Dcifer, and some may be chosen on the basis of convenience and computational efficiency. For Wald-type CI, observed Fisher information can be easily calculated numerically (and arguably preferred to expected Fisher information; <xref rid="iyac126-B11" ref-type="bibr">Efron and Hinkley 1978</xref>); likelihood-ratio-based CI, while asymptotically equivalent to <xref rid="iyac126-B30" ref-type="bibr">Wald’s (1943)</xref>, are more robust as they are invariant to parameter transformation that could be used to make the log-likelihood function approximately quadratic at MLE (<xref rid="iyac126-B3" ref-type="bibr">Beale 1960</xref>; <xref rid="iyac126-B9" ref-type="bibr">Cox and Hinkley 1979</xref>, pp. 342–343; <xref rid="iyac126-B8" ref-type="bibr">Cook and Weisberg 1990</xref>; <xref rid="iyac126-B29" ref-type="bibr">Vander Wiel and Meeker 1990</xref>; <xref rid="iyac126-B20" ref-type="bibr">Meeker and Escobar 1995</xref>). Resampling methods include bootstrap and generating a null distribution for hypothesis testing. While there are many advantages this approach provides for finite sampling distributions not yet approaching normality, there is a caveat: if a centered sampling distribution at MLE is not close enough to that at the true value, the inference will be problematic. In addition, inverting quantiles of a bootstrap distribution for CI endpoints can lead to violating the bounds of the parameter space (see <xref rid="s1" ref-type="supplementary-material">Supplementary Section 4 in File_1</xref>), as can Wald CI. Simulated null distributions do not suffer from this problem but still rely on various assumptions and might be sensitive to misspecifications as demonstrated in the <italic toggle="yes">Results</italic>. In contrast, likelihood-ratio confidence regions respect parameter bounds and do not require any additional model assumptions for hypothesis testing.</p>
      <p>Likelihood-ratio-based inference is based on Wilks’ theorem (<xref rid="iyac126-B33" ref-type="bibr">Wilks 1938</xref>) and uses the likelihood ratio test statistic, which in the context of Dcifer hypothesis testing with <inline-formula id="IE103"><mml:math id="IM103" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> can be written as <inline-formula id="IE104"><mml:math id="IM104" display="inline" overflow="scroll"><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo> </mml:mo><mml:mi mathvariant="italic">log</mml:mi><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo mathvariant="bold-italic">^</mml:mo></mml:mover><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">π</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>(</mml:mo><mml:mo>ℓ</mml:mo><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mo>ℓ</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula>, where <inline-formula id="IE105"><mml:math id="IM105" display="inline" overflow="scroll"><mml:mrow><mml:mo>ℓ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="italic">log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>;</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and is approximated by chi-squared distribution <inline-formula id="IE106"><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mo>χ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with <italic toggle="yes">M</italic> degrees of freedom. The approximate <inline-formula id="IE107"><mml:math id="IM107" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:math></inline-formula> confidence region consists of the values
<disp-formula id="E6"><mml:math id="M6" display="block" overflow="scroll"><mml:mo>{</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>:</mml:mo><mml:mo>ℓ</mml:mo><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo mathvariant="bold-italic">~</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>≥</mml:mo><mml:mo>ℓ</mml:mo><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo> </mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE108"><mml:math id="IM108" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a <inline-formula id="IE109"><mml:math id="IM109" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>’th quantile of <inline-formula id="IE110"><mml:math id="IM110" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mo>χ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. As the Wilk’s theorem does not apply to border cases, we specifically address these important cases (for which the likelihood-ratio test is still the most powerful; <xref rid="iyac126-B21" ref-type="bibr">Neyman and Pearson 1933</xref>) and compare the corresponding distribution of the likelihood ratio statistic with <inline-formula id="IE111"><mml:math id="IM111" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mo>χ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> that no longer approximates it. First, the test at the boundaries is 1-sided while the chi-squared distribution implies 2-sided tests. Accounting for that would mean dividing a <italic toggle="yes">P</italic>-value obtained from the chi-squared distribution by 2 or finding a corresponding critical value for the significance level <italic toggle="yes">α</italic>. Second, it turns out that even with this adjustment, the resulting <italic toggle="yes">P</italic>-value is still somewhat conservative, and, as shown in the <italic toggle="yes">Results</italic>, the method has excellent error rate control.</p>
    </sec>
    <sec>
      <title>Estimating the number of related strain pairs and <italic toggle="yes">r</italic><sub>total</sub></title>
      <p>Parameters of the working model include <italic toggle="yes">n<sub>x</sub></italic>, <italic toggle="yes">n<sub>y</sub></italic>, and <inline-formula id="IE112"><mml:math id="IM112" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">π</mml:mi></mml:math></inline-formula>. <italic toggle="yes">M</italic>, the length of <bold><italic toggle="yes">r</italic></bold>, can be considered a nuisance parameter. In addition, let <inline-formula id="IE113"><mml:math id="IM113" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow/><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be a number of positively related strain pairs; unlike <italic toggle="yes">M</italic>, <inline-formula id="IE114"><mml:math id="IM114" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> can be a quantity of interest. The estimator <inline-formula id="IE115"><mml:math id="IM115" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> in <xref rid="E2" ref-type="disp-formula">Equation (1)</xref> assumes that the model is constrained by given values of <italic toggle="yes">n<sub>x</sub></italic>, <italic toggle="yes">n<sub>y</sub></italic>, <inline-formula id="IE116"><mml:math id="IM116" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">π</mml:mi></mml:math></inline-formula>, and <italic toggle="yes">M</italic>; the likelihood is calculated using these values. However, while <italic toggle="yes">n<sub>x</sub></italic>, <italic toggle="yes">n<sub>y</sub></italic>, and <inline-formula id="IE117"><mml:math id="IM117" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">π</mml:mi></mml:math></inline-formula> are “external” to <bold><italic toggle="yes">r</italic></bold> and are provided or obtained through other processes, <italic toggle="yes">M</italic> is inherent to relatedness between 2 infections. Thus, here, we consider a less constrained model where <italic toggle="yes">M</italic> is not given. In this case, a trivial solution to estimating <bold><italic toggle="yes">r</italic></bold> would be to set <inline-formula id="IE118"><mml:math id="IM118" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> since <bold><italic toggle="yes">r</italic></bold><italic toggle="yes">’</italic>s associated with different <inline-formula id="IE119"><mml:math id="IM119" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo><mml:mo>≤</mml:mo><mml:mi>M</mml:mi><mml:mo>≤</mml:mo><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> will only differ in the number of zeros (<italic toggle="yes">r<sub>i</sub></italic> = 0). If we want to estimate <inline-formula id="IE120"><mml:math id="IM120" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE121"><mml:math id="IM121" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, which are functions of <bold><italic toggle="yes">r</italic></bold>, they can be similarly obtained from <inline-formula id="IE122"><mml:math id="IM122" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo mathvariant="bold-italic">^</mml:mo></mml:mover></mml:math></inline-formula> as <inline-formula id="IE123"><mml:math id="IM123" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow/><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE124"><mml:math id="IM124" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <p>In practical applications, this trivial solution can incur high-computational cost for higher <inline-formula id="IE125"><mml:math id="IM125" display="inline" overflow="scroll"><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and therefore we propose alternative estimators <inline-formula id="IE126"><mml:math id="IM126" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE127"><mml:math id="IM127" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo mathvariant="bold-italic">~</mml:mo></mml:mover></mml:math></inline-formula>, and <inline-formula id="IE128"><mml:math id="IM128" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> that use an iterative procedure with underlying calculation of <inline-formula id="IE129"><mml:math id="IM129" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo mathvariant="bold-italic">^</mml:mo></mml:mover></mml:math></inline-formula> at each step. The first step is to set <inline-formula id="IE130"><mml:math id="IM130" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and calculate <inline-formula id="IE131"><mml:math id="IM131" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo mathvariant="bold-italic">^</mml:mo></mml:mover></mml:math></inline-formula>, then at each consecutive step increment <italic toggle="yes">M</italic> and recalculate <inline-formula id="IE132"><mml:math id="IM132" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo mathvariant="bold-italic">^</mml:mo></mml:mover></mml:math></inline-formula> until it contains one zero (<inline-formula id="IE133"><mml:math id="IM133" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow/><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) or until <inline-formula id="IE134"><mml:math id="IM134" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Accept <inline-formula id="IE135"><mml:math id="IM135" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo mathvariant="bold-italic">^</mml:mo></mml:mover></mml:math></inline-formula> obtained at the final step as <inline-formula id="IE136"><mml:math id="IM136" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo mathvariant="bold-italic">~</mml:mo></mml:mover></mml:math></inline-formula>, with <inline-formula id="IE137"><mml:math id="IM137" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE138"><mml:math id="IM138" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow/><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. If <italic toggle="yes">r</italic><sub>total</sub>, rather than <inline-formula id="IE139"><mml:math id="IM139" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, is of main interest, the computation time can be cut even further by assuming <inline-formula id="IE140"><mml:math id="IM140" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> and using <xref rid="E5" ref-type="disp-formula">Equation (3)</xref> to calculate the likelihood. In this case, we propose yet another set of estimators <inline-formula id="IE141"><mml:math id="IM141" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE142"><mml:math id="IM142" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE143"><mml:math id="IM143" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is calculated for all <inline-formula id="IE144"><mml:math id="IM144" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE145"><mml:math id="IM145" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the value of <italic toggle="yes">M</italic> that produced the highest maximum likelihood. Then <inline-formula id="IE146"><mml:math id="IM146" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE147"><mml:math id="IM147" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> is an MLE at <inline-formula id="IE148"><mml:math id="IM148" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>Simulations and comparison with an IBS metric</title>
      <p>Our simulations are based on previously published SNP and microhaplotype panels (<xref rid="iyac126-B10" ref-type="bibr">Daniels <italic toggle="yes">et al.</italic> 2008</xref>; <xref rid="iyac126-B28" ref-type="bibr">Tessema <italic toggle="yes">et al.</italic> 2022</xref>; <xref rid="iyac126-B15" ref-type="bibr">Jacob <italic toggle="yes">et al.</italic> 2021</xref>); allele frequencies for these panels were obtained from previously analyzed empiric datasets. The SNP panels have 23 and 101 loci with 2 alleles per locus, and the microhaplotype panel has 91 loci with the number of alleles at each locus ranging between 3 and 95. To assess the performance of Dcifer with varying number of multiallelic loci, we used allele frequencies for the 91-loci panel and repeated them for consistency (thus creating synthetic 182-loci, 273-loci panels, and so on).</p>
      <p>To include genotyping errors in simulations, we devised a “miss-and-split” model with parameters <italic toggle="yes">ϵ</italic> and <italic toggle="yes">λ</italic>:
</p>
      <list list-type="order">
        <list-item>
          <p>False negatives: one of <italic toggle="yes">k</italic> present alleles (drawn with probabilities <inline-formula id="IE149"><mml:math id="IM149" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>) has zero probability of being missed; the remaining <inline-formula id="IE150"><mml:math id="IM150" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> alleles can be missed with probability <italic toggle="yes">ϵ</italic>. Let <italic toggle="yes">K</italic> be a number of alleles remaining present after this step; then <inline-formula id="IE151"><mml:math id="IM151" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="normal">ϵ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        </list-item>
        <list-item>
          <p>False positives: draw a number <inline-formula id="IE152"><mml:math id="IM152" display="inline" overflow="scroll"><mml:msub><mml:mi>N</mml:mi><mml:mi>add</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mo>λ</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> of added alleles (“splitting” event) for each nonmissing allele; subsequently draw <italic toggle="yes">N</italic><sub>add</sub> alleles from <inline-formula id="IE153"><mml:math id="IM153" display="inline" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> alleles with replacement. In the final “observed” data, an allele is considered present if selected by at least one of the splitting events.</p>
        </list-item>
      </list>
      <p>Note that <inline-formula id="IE154"><mml:math id="IM154" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">add</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is very small for reasonably small <italic toggle="yes">λ</italic>’s.</p>
      <p>For analysis procedures that involve estimating COI and population allele frequencies prior to Dcifer, we used naïve COI estimation with a locus rank <italic toggle="yes">c</italic> that depended on the number of loci (COI determined by a locus with <italic toggle="yes">c</italic>’th greatest number of detected alleles) for multiallelic panels, and THE REAL McCOIL method for biallelic SNP panels (<xref rid="iyac126-B6" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> 2017</xref>). Population allele frequencies were estimated from simulated datasets of 400 samples, where relatedness was induced in 10% of the pairs and COI for the rest of the samples was generated with truncated Poisson distribution with parameter <italic toggle="yes">λ </italic>= 3. We used COI-adjusted estimation (see <xref rid="s1" ref-type="supplementary-material">Supplementary Section 5 in File_1</xref>), which is important for polyclonal infections; failure to adjust for COI can lead to overestimating heterozygosity and, consequently, relatedness parameters. Most simulations consisted of 10,000 pairs of related infections for a given COI and <bold><italic toggle="yes">r</italic></bold> combination.</p>
      <p>To compare Dcifer performance with an IBS approach, we used the Jaccard similarity coefficient (<xref rid="iyac126-B14" ref-type="bibr">Jaccard 1912</xref>) as an example since it is a commonly used statistic, which is conceptually simple and fast, and which performs similarly to the other IBS measures we have considered. For this calculation, loci data for a sample (each locus represented by a binary sequence with elements indicating if an allele has been detected or not) were concatenated into a single binary sequence of length <inline-formula id="IE155"><mml:math id="IM155" display="inline" overflow="scroll"><mml:mrow><mml:mo>κ</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">K<sub>t</sub></italic> is the number of possible alleles at a locus <italic toggle="yes">t</italic>. Then Jaccard similarity <inline-formula id="IE156"><mml:math id="IM156" display="inline" overflow="scroll"><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> between 2 sequences <inline-formula id="IE157"><mml:math id="IM157" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mo>κ</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE158"><mml:math id="IM158" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mo>κ</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> that represent 2 infections was calculated as
<disp-formula id="E7"><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>κ</mml:mo></mml:msubsup><mml:mrow/><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>κ</mml:mo></mml:msubsup><mml:mrow/><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>The main goal of Dcifer is to estimate parameters describing relatedness between infections, and this estimation requires values of the other parameters in the model. These external parameters represent COI (<italic toggle="yes">n<sub>x</sub></italic>, <italic toggle="yes">n<sub>y</sub></italic>) and population allele frequencies (<inline-formula id="IE159"><mml:math id="IM159" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">π</mml:mi></mml:math></inline-formula>), which can be known (e.g. in simulations), estimated from data, or otherwise specified. Dcifer is implemented in a software package that takes raw data on the alleles detected at each locus (biallelic or multiallelic) in <italic toggle="yes">Plasmodium</italic> infections, allowing for missing data, along with COI and population allele frequencies. In simulations, we assess the performance of Dcifer when data have no genotyping error and COI and <inline-formula id="IE160"><mml:math id="IM160" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">π</mml:mi></mml:math></inline-formula> are known, as well as in the presence of genotyping error with COI and <inline-formula id="IE161"><mml:math id="IM161" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">π</mml:mi></mml:math></inline-formula> estimated from these data. We also evaluate how sensitive Dcifer is to misspecification of these external quantities and to assumption violations. We start with a case when only one pair of strains can be related (<italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>1), since it can be used to quickly identify related infections in a large dataset, and later proceed to the general case. Finally, we apply Dcifer to analysis of real data, where COI and allele frequencies are estimated from the data.</p>
    <sec>
      <title>Dcifer produces accurate and interpretable estimates of relatedness</title>
      <p>Unlike IBS metrics that simply measure similarity between infections comparing detected alleles, Dcifer aims to produce more interpretable results by estimating parameters that represent IBD and thus separating shared ancestry and chance as underlying reasons for alleles matching between 2 infections. To evaluate the performance of this method in comparison to IBS approach (we used Jaccard similarity coefficient as an example), we simulated genetic data for infection pairs with different degrees of relatedness (induced on a single pair of strains between 2 infections) and COI, based on previously published SNP and microhaplotype panels (<xref rid="iyac126-B10" ref-type="bibr">Daniels <italic toggle="yes">et al.</italic> 2008</xref>; <xref rid="iyac126-B28" ref-type="bibr">Tessema <italic toggle="yes">et al.</italic> 2022</xref>; <xref rid="iyac126-B15" ref-type="bibr">Jacob <italic toggle="yes">et al.</italic> 2021</xref>). Across various values of COI, Dcifer estimates were concentrated around the true values of the parameter while IBS results were not (<xref rid="iyac126-F2" ref-type="fig">Fig. 2</xref>, shown for a panel of 91 microhaplotypes with no genotyping error and known COI and allele frequencies). As COI increased, Dcifer estimates became more variable but remained centered around the true values and maintained some degree of separation, whereas IBS results shifted and overlapped considerably more. For these simulations, separation between results for completely unrelated (<italic toggle="yes">r </italic>=<italic toggle="yes"> </italic>0) and related infections, quantified in receiver operating characteristic (ROC) curves, indicated considerable gain in accuracy by Dcifer compared to the IBS metric across the range of COI, especially for lower degrees of relatedness (<xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 1 in File_1</xref>). For example, Dcifer estimates of sibling-level relatedness (<italic toggle="yes">r </italic>=<italic toggle="yes"> </italic>0.5) remained readily distinguishable from those of unrelated infections even for fairly high COI.</p>
      <fig position="float" id="iyac126-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Densities of Dcifer relatedness estimator <inline-formula id="IE162"><mml:math id="IM162" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and IBS similarity metric results obtained from data simulated using a panel of 91 microhaplotypes (<xref rid="iyac126-B28" ref-type="bibr">Tessema <italic toggle="yes">et al.</italic> 2022</xref>). Simulations were performed for 5 values of <italic toggle="yes">r</italic> and for COI combinations ranging between 1 and 5; true values of COI and population allele frequencies were used for Dcifer. Upward arrows indicate highly concentrated distributions with density values extending above the plot range (note: y-axis scales are different for the 2 methods).</p>
        </caption>
        <graphic xlink:href="iyac126f2" position="float"/>
      </fig>
      <p>When the task of detecting related infections is approached in practice, there are additional issues to be considered because neither COI nor population allele frequencies are known, genetic data often contain genotyping errors, and the extent of these errors is unknown. <xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 2 in File_1</xref> illustrates how results changed when genotyping error was included in the simulations, and estimates of COI and population allele frequencies, and not their true values, were used as inputs to Dcifer. IBS results shifted to the left more or less uniformly; since distributions for different values of <italic toggle="yes">r</italic> were so tightly concentrated and close together, apparently small shifts were significant compared to the differences between these distributions. Dcifer estimates also shifted to the left, but, relative to differences in sampling distributions, the shifts were smaller than those for IBS. The fact that the shifts were more pronounced for larger values of <italic toggle="yes">r</italic> is explained by genotyping errors breaking up some of the relatedness between infections.</p>
    </sec>
    <sec>
      <title>Greater power of hypothesis tests using Dcifer vs. IBS</title>
      <p>One way of detecting related infections along with a measure of uncertainty (e.g. <italic toggle="yes">P</italic>-value) is to compare Dcifer relatedness estimates or IBS similarity results with their corresponding null distributions (<inline-formula id="IE163"><mml:math id="IM163" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), which can in theory be obtained by simulating a large number of unrelated infections. To evaluate the performances of Dcifer and the IBS metric, we calculated false-positive rates (FPR) and power of tests with significance level <inline-formula id="IE164"><mml:math id="IM164" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> for different types of genetic data across a range of COI. Genetic data were simulated with genotyping errors; they were incorporated into simulated “null” distributions as well. Distributions for <italic toggle="yes">r </italic>=<italic toggle="yes"> </italic>0 are different for different COI and therefore a separate null distribution was generated for each COI pair combination; the effect of COI on such distributions was substantial for IBS (<xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 3 in File_1</xref>). Relatedness estimates for each pair of infections were then compared to a rejection cut-off determined by a null distribution corresponding to their estimated COI, and FPR and statistical power were subsequently calculated. In addition to the complexity and computational costs associated with generating a null distribution, this approach relies on a number of assumptions such as COI, allele frequencies, and the error model and its parameters, which are all subject to misspecification.</p>
      <p>As a welcome alternative, Dcifer offers another inferential approach based on the likelihood ratio, which does not require any additional information (i.e. does not require generating a null distribution) and has essentially no computational overhead. <xref rid="iyac126-F3" ref-type="fig">Figure 3</xref> compares hypothesis testing results for IBS, using simulated reference distributions, and Dcifer, using likelihood-ratio <italic toggle="yes">P</italic>-values adjusted for 1-sided tests. For both methods, FPR was mostly at or below the nominal significance level <italic toggle="yes">α</italic> across different simulations of COI and genotyping panels, with Dcifer close to <italic toggle="yes">α</italic>. Statistical power, however, varied considerably. As expected, higher values of relatedness were detected with greater power, increasing the number or diversity of loci increased power, and higher COI led to lower power. Across all simulations, Dcifer consistently demonstrated greater power to detect related infections than the IBS metric, with differences particularly notable for polyclonal infections. For example, with a 91 microhaplotype panel, the power to detect half-siblings (<italic toggle="yes">r </italic>=<italic toggle="yes"> </italic>0.25) in a pair of infections with COI of 2 was 0.81 for Dcifer and 0.43 for the IBS metric; with 455 microhaplotypes and COI of 5 that power was 0.88 and 0.22, respectively. Results for an alternative scenario when <italic toggle="yes">α</italic> is a function of COI, which might be useful if error rate control on the scale of parasite strain pairs rather than infection pairs is desired, are presented in <xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 4 in File_1</xref>. While <xref rid="s1" ref-type="supplementary-material">Supplementary Figs. 1 and 2 in File_1</xref> would suggest that there is still some separation between distributions for different values of <italic toggle="yes">r</italic> for the IBS metric results, which would be expected to improve with increasing the number of loci, its performance was remarkably poor, having very low power for larger COI and <italic toggle="yes">r </italic>&lt;<italic toggle="yes"> </italic>0.5 even with highly informative panels. This reflects the fact that for tightly concentrated distributions of IBS results, the difference between cut-offs associated with different assumed null distributions is critical, and consequently, misspecification of COI or an error process had a deleterious effect on either FPR or power (<xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 3 in File_1</xref>). The likelihood-ratio-based approach performed very similarly to the one based on null distributions for Dcifer, evidencing this as a preferred approach for the reasons described above (<xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 5 in File_1</xref>).</p>
      <fig position="float" id="iyac126-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Detecting related infections. FPR and statistical power of a test <inline-formula id="IE165"><mml:math id="IM165" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> at significance level <inline-formula id="IE166"><mml:math id="IM166" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> are shown. Simulations included genotyping error with fixed error model parameters; COIs were estimated from these data. For simulated null distributions, we varied error model parameters since they would not be normally known. SNP and microhaplotype (MH) panels were used as a basis for simulations.</p>
        </caption>
        <graphic xlink:href="iyac126f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Dcifer provides likelihood-ratio-based CI</title>
      <p>The Dcifer likelihood-ratio-based approach allows for calculating <italic toggle="yes">M</italic>-dimensional confidence regions (where <italic toggle="yes">M</italic> is the number of related pairs)—or, in a case when only one pair of strains is assumed to be related between 2 infections, CI. <xref rid="iyac126-F4" ref-type="fig">Figure 4</xref> shows CI’s for a range of true <italic toggle="yes">r</italic> values and COI. Infections were simulated using microhaplotype panels with various number of loci. As expected, CI’s were narrower for panels with more loci. In general, the intervals were narrower near endpoints (<italic toggle="yes">r </italic>=<italic toggle="yes"> </italic>0 and <italic toggle="yes">r </italic>=<italic toggle="yes"> </italic>1) and wider in the midrange. Interestingly, the least COI in the pair (<inline-formula id="IE167"><mml:math id="IM167" display="inline" overflow="scroll"><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>) had a greater effect on the CI than the sum of COI (<inline-formula id="IE168"><mml:math id="IM168" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>); this can be seen in more rapid widening of the intervals from left to right than from top to bottom of the figure. With large numbers of diverse loci, CI stayed narrow even for higher COI. Coverage for these CI was around <inline-formula id="IE169"><mml:math id="IM169" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>, and consistently higher for endpoints, indicating that CI for these endpoints were conservative, even taking into account the 1-sided nature of such intervals (<xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 6 in File_1</xref>; also demonstrated by FPR in <xref rid="iyac126-F3" ref-type="fig">Fig. 3</xref>).</p>
      <fig position="float" id="iyac126-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>95% CI for relatedness estimates using the likelihood ratio produced by Dcifer.</p>
        </caption>
        <graphic xlink:href="iyac126f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Allowing for multiple pairs of strains to be related</title>
      <p>So far we have only presented results for a single related pair of strains between 2 infections (<italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>1) regardless of COI. When we allow that multiple pairs of strains may be related, Dcifer produces a corresponding number of estimates—one for each pair. To accurately estimate multiple relatedness parameters without any additional assumptions, a large number of diverse loci is needed; otherwise, there is a lot of variation in the individual estimates (see an example in <xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 7 in File_1</xref>). However, while the estimation of individual relatedness parameters was challenging, their sum <italic toggle="yes">r</italic><sub>total</sub> was estimated more accurately even with a lower number of loci (which can be seen in the contour plots of <xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 7 in File_1</xref>). <xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 8 in File_1</xref> shows likelihood surfaces for 2-dimensional parameters (<inline-formula id="IE170"><mml:math id="IM170" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>), where we can clearly see the ridge along <inline-formula id="IE171"><mml:math id="IM171" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>; that value is close to the true sum even when the individual estimates are further away from (<italic toggle="yes">r</italic><sub>1</sub>, <italic toggle="yes">r</italic><sub>2</sub>).</p>
      <p>If the goal is to estimate overall relatedness between 2 infections, we suggest <italic toggle="yes">r</italic><sub>total</sub> as a more identifiable and useful quantity than <inline-formula id="IE172"><mml:math id="IM172" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. To estimate <italic toggle="yes">r</italic><sub>total</sub> and the number of positively related strain pairs <inline-formula id="IE173"><mml:math id="IM173" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, we used the procedure described in <italic toggle="yes">Estimating the Number of Related Strain Pairs and r</italic><sub>total</sub> and compared the estimates obtained from 2 approaches: (1) with “equality assumption” <inline-formula id="IE174"><mml:math id="IM174" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (estimators <inline-formula id="IE175"><mml:math id="IM175" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) and (2) without it (estimators <inline-formula id="IE176"><mml:math id="IM176" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>). First, we validated the stopping rule for the second approach (when <italic toggle="yes">r<sub>i</sub></italic> are not assumed to be equal), confirming that incrementing <italic toggle="yes">M</italic> past the iteration that estimates one of <italic toggle="yes">r<sub>i</sub></italic>'s to be 0 only appended additional 0’s to MLE in most cases. Next, we compared the 2 approaches and assessed the accuracy of the corresponding estimators. For each simulated pair of infections, we first randomly generated <inline-formula id="IE177"><mml:math id="IM177" display="inline" overflow="scroll"><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>total</mml:mi></mml:msub></mml:math></inline-formula> for given <italic toggle="yes">r</italic><sub>total</sub> and <inline-formula id="IE178"><mml:math id="IM178" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>. The estimates were compared across a grid of COI, <italic toggle="yes">r</italic><sub>total</sub>, and <inline-formula id="IE179"><mml:math id="IM179" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>. <xref rid="iyac126-F5" ref-type="fig">Figure 5</xref> shows illustrative examples of these comparisons: in 5(a), <inline-formula id="IE180"><mml:math id="IM180" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> is changed while COI and <italic toggle="yes">r</italic><sub>total</sub> are fixed, in 5(b) <italic toggle="yes">r</italic><sub>total</sub> is changed, and in 5(c) COI is changed. Distributions of <inline-formula id="IE181"><mml:math id="IM181" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE182"><mml:math id="IM182" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> were quite similar, so the equality constraint had a very limited effect on the overall relatedness estimates. There was more difference between <inline-formula id="IE183"><mml:math id="IM183" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE184"><mml:math id="IM184" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, but, importantly, these differences did not significantly affect <italic toggle="yes">r</italic><sub>total</sub> estimates. An effect of varying <inline-formula id="IE185"><mml:math id="IM185" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> on the distributions of <inline-formula id="IE186"><mml:math id="IM186" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE187"><mml:math id="IM187" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was small, while lower COI resulted in more accurate estimates. Higher <italic toggle="yes">r</italic><sub>total</sub> made for more accurate estimation of <inline-formula id="IE188"><mml:math id="IM188" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, as it eliminated lower values incompatible with <inline-formula id="IE189"><mml:math id="IM189" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> estimates. It is worth noting that simply increasing dimensionality of the grid of relatedness values to evaluate over can become unfeasible for larger <italic toggle="yes">M</italic>, so the grid would have to be coarsened to accommodate, which in turn would affect precision. No such limitation exists for the fast “equal <italic toggle="yes">r<sub>i</sub></italic>” approach as it estimates a single parameter.</p>
      <fig position="float" id="iyac126-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Estimation of <italic toggle="yes">r</italic><sub>total</sub> and <inline-formula id="IE190"><mml:math id="IM190" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> with and without equality assumption <inline-formula id="IE191"><mml:math id="IM191" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Densities of <inline-formula id="IE192"><mml:math id="IM192" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="italic">total</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (no assumption) and <inline-formula id="IE193"><mml:math id="IM193" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="italic">total</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (with assumption) are shown on the left, and probabilities for the values of <inline-formula id="IE194"><mml:math id="IM194" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE195"><mml:math id="IM195" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are shown on the right. Quantities highlighted in red indicate those varied between the top and bottom simulations within each panel. Simulations were performed using a panel of 91 microhaplotypes. a) Varying <italic toggle="yes">M</italic>’. b) Varying <italic toggle="yes">r</italic><sub>total</sub>. c) Varying COI.</p>
        </caption>
        <graphic xlink:href="iyac126f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Misspecifications and assumption violations</title>
      <p>In data analysis, COI and population allele frequencies are usually unknown and need to be estimated from data. Allele frequencies can often be estimated from sufficiently large datasets (e.g. over 100 samples) and as such, their estimates are often fairly stable; some implications of their misspecifications are discussed in <xref rid="s1" ref-type="supplementary-material">Supplementary Section 3 in File_1</xref>. COI estimation, however, relies on a smaller amount of information, resulting in greater variability of the estimates and more frequent misspecifications. Fortunately, Dcifer appeared to be relatively robust to COI misspecifications, especially for less complex infections (<xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 9 in File_1</xref>). Even for higher COI, relatedness estimates were fairly close to the true value in the neighborhood of the correct COI.</p>
      <p>Next, we address our working model and its defining assumption of no intrahost relatedness. To assess how violating this assumption affects interhost relatedness estimation, we compared 5 scenarios: one with no intrahost relatedness and 4 where different strains within the samples are siblings (<italic toggle="yes">r </italic>=<italic toggle="yes"> </italic>0.5)—see the diagrams in <xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 10 in File_1</xref>. Note that in scenario 2 (<xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 10b</xref>), there are 2 interhost pairs that are related (strains <italic toggle="yes">X</italic><sub>1</sub>-<italic toggle="yes">Y</italic><sub>1</sub> and <italic toggle="yes">X</italic><sub>2</sub>-<italic toggle="yes">Y</italic><sub>1</sub>) but that “extra” relatedness is only a consequence of the induced <italic toggle="yes">X</italic><sub>1</sub>-<italic toggle="yes">X</italic><sub>2</sub> sibship and does not add anything to our quantity of interest. The same is true for more complex scenarios 4 (<xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 10d</xref>, with related interhost pairs <italic toggle="yes">X</italic><sub>1</sub>-<italic toggle="yes">Y</italic><sub>1</sub>, <italic toggle="yes">X</italic><sub>2</sub>-<italic toggle="yes">Y</italic><sub>1</sub>, <italic toggle="yes">X</italic><sub>1</sub>-<italic toggle="yes">Y</italic><sub>2</sub>, and <italic toggle="yes">X</italic><sub>2</sub>-<italic toggle="yes">Y</italic><sub>2</sub>) and 5 (<xref rid="s1" ref-type="supplementary-material">Supplementary Fig. 10e</xref>, with related interhost pairs <italic toggle="yes">X</italic><sub>1</sub>-<italic toggle="yes">Y</italic><sub>1</sub>, <italic toggle="yes">X</italic><sub>2</sub>-<italic toggle="yes">Y</italic><sub>1</sub>, and <italic toggle="yes">X</italic><sub>3</sub>-<italic toggle="yes">Y</italic><sub>1</sub>). All simulations included genotyping error, and processing involved estimating COI and population allele frequencies. Relatedness estimates for all 3 scenarios were very similar (<xref rid="s1" ref-type="supplementary-material">Supplementary Figs. 11 and 12 in File_1</xref>), confirming that in many common cases of intrahost relatedness, the working model estimates interhost relatedness without significant biases.</p>
    </sec>
    <sec>
      <title>Applications to empirical data</title>
      <p>We applied Dcifer to a small dataset that has 87 microhaplotypes and consists of samples obtained from patients presenting with malaria from 2 health facilities in Maputo and Inhambane provinces of Mozambique (<xref rid="iyac126-B28" ref-type="bibr">Tessema <italic toggle="yes">et al.</italic> 2022</xref>). There were 52 samples overall with 26 from each clinic; only samples with data for at least 75 loci were considered for the analysis (<xref rid="d1" ref-type="supplementary-material">Supplementary Data_1</xref>). From these samples, naïve COI estimates (60% polyclonal samples with maximum COI of 6) and subsequently estimates of population allele frequencies adjusted for COI were calculated (<xref rid="d2" ref-type="supplementary-material">Supplementary Data_2</xref>). We initially set <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>1 and used likelihood-ratio statistics to test a null hypothesis <inline-formula id="IE196"><mml:math id="IM196" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> at significance level <inline-formula id="IE197"><mml:math id="IM197" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> (with the procedure adjusted for a 1-sided test). For comparison, Jaccard similarity was used as an IBS metric; <xref rid="iyac126-F6" ref-type="fig">Fig. 6</xref> displays results from both methods. Dcifer results indicated that the majority of samples were unrelated and that related samples were mostly from the same clinic. Note that significant pairs with relatively low relatedness estimates usually shared a rare allele at one or two loci. The IBS metric also picked up very highly related pairs, but, apart from those, it was more difficult to distinguish related samples from background. Some samples appeared to be less related to all the other ones in IBS results, and some—more (stripe-like patterns in the lower triangle); these single-sample relatedness levels correlated with estimated COI (e.g. all the lighter “stripes” corresponded to monoclonal samples) highlighting the fact that IBS similarity is strongly influenced by COI, which obscures contribution of descent. For related samples, we also estimated <inline-formula id="IE198"><mml:math id="IM198" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> (the number of related strain pairs) and <italic toggle="yes">r</italic><sub>total</sub> (overall relatedness). For these samples, <inline-formula id="IE199"><mml:math id="IM199" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> ranged between 0.105 and 1.97 and there were 4 pairs of samples (all in Maputo), for which <inline-formula id="IE200"><mml:math id="IM200" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> exceeded 1, with estimated COI of 2 in all samples in these pairs and <inline-formula id="IE201"><mml:math id="IM201" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> for all such pairs.</p>
      <fig position="float" id="iyac126-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Relatedness between samples from 2 clinics: one from Inhambane province and one from Maputo province of Mozambique. Lower triangular matrix displays IBS metric results and upper triangular matrix—Dcifer estimates. The color of each matrix entry represents an estimate for 2 corresponding samples; pairs for which <italic toggle="yes">H</italic><sub>0</sub> has been rejected using the Dcifer likelihood ratio test are outlined in red. Estimated COIs are displayed on the margins.</p>
        </caption>
        <graphic xlink:href="iyac126f6" position="float"/>
      </fig>
      <p>We also reevaluated microsatellite data from a previously published dataset, which contained 2,585 samples from 29 clinics in 4 districts in Namibia (<xref rid="iyac126-B27" ref-type="bibr">Tessema <italic toggle="yes">et al.</italic> 2019</xref>), using Dcifer to estimate relatedness (<xref rid="d3" ref-type="supplementary-material">Supplementary Data_3</xref> contains estimated allele frequencies). These data had 26 loci, and 77% of the samples were polyclonal. The average of relatedness estimates between monoclonal samples (which can be taken to represent relatedness between individual parasites) was similar to the average overall relatedness (<inline-formula id="IE202"><mml:math id="IM202" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) between polyclonal infections scaled by the minimum COI for each pair. Minimum COI represents the number of interhost strain pairs in 2 infections that can be related within the Dcifer working model, so scaled <inline-formula id="IE203"><mml:math id="IM203" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> can be viewed as an average estimate of relatedness between individual strains belonging to 2 different infections. We assessed the proportion of related pairs of samples within and between clinics (<inline-formula id="IE204"><mml:math id="IM204" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>), then performed a permutation test to determine which clinic combinations had more related samples than expected by chance. Most of the within-clinic entries had significantly large numbers of related samples (<xref rid="iyac126-F7" ref-type="fig">Fig. 7</xref>). In addition, clinics with geographical proximity had significantly more related between-clinic infections, as illustrated by clusters of darker circles along the diagonal. Rundu DH is a large referral hospital, which could explain relative genetic closeness between samples from this and more geographically distant clinics. Rundu, Nyanganna, and Andara districts are adjacent to each other and Zambezi district is distant from them, which is reflected in the relative lack of relatedness between Zambezi and other districts.</p>
      <fig position="float" id="iyac126-F7">
        <label>Fig. 7.</label>
        <caption>
          <p>Namibia clinic-level relatedness and permutation test results. Each circle represents a single clinic (on a diagonal) or a 2-clinic combination (off-diagonal), with clinics ordered geographically and divided into districts. The color of the circle corresponds to the permutation test’s <italic toggle="yes">P</italic>-value, and the diameter—to the proportion of related samples within or between the clinics. Permutation distributions for clinics with smaller numbers of samples have larger variance leading to larger <italic toggle="yes">P</italic>-values—e.g. Chinchimani and Kanono with only 9 samples each have relatively high proportions of related infections but their <italic toggle="yes">P</italic>-values are not small.</p>
        </caption>
        <graphic xlink:href="iyac126f7" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Computational efficiency</title>
      <p>Because of various simplifications of the likelihood expression for important special cases, there are 3 main versions of the estimation procedure (in the order of increasing computational complexity): (1) <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>1, using Newton’s method adapted for a bounded parameter space to find MLE or calculating likelihood for a 1-dimensional grid of parameter values if a CI is requested, (2) <italic toggle="yes">M </italic>&gt;<italic toggle="yes"> </italic>1 with <inline-formula id="IE205"><mml:math id="IM205" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> assumption involving likelihood calculation for a 1-dimensional grid, and (3) <italic toggle="yes">M </italic>&gt;<italic toggle="yes"> </italic>1 without <inline-formula id="IE206"><mml:math id="IM206" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> assumption involving likelihood calculation for an <italic toggle="yes">M</italic>-dimensional grid. Since we expect that most sample pairs in a typical dataset will be unrelated, an initial analysis step will likely attempt to identify significantly related (or unrelated) ones by evaluating all pairs assuming <inline-formula id="IE207"><mml:math id="IM207" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Therefore, execution times for this special case are the most important ones. Times for “grid” versions depend heavily on the resolution of the grid, while the Newton-based procedure usually converges in 3–4 iterations even with low tolerance. <xref rid="iyac126-T1" ref-type="table">Table 1</xref> shows execution times for calculating <inline-formula id="IE208"><mml:math id="IM208" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> for 1,000 sample pairs (100 loci, each with 2–20 alleles) with <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>1 and various COI combinations for both Newton’s method and a grid; times for all but the highest COI combinations (<inline-formula id="IE209"><mml:math id="IM209" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula> for Newton’s method and <inline-formula id="IE210"><mml:math id="IM210" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:math></inline-formula> for the grid) were &lt;5 s. Simple vectorized computation of the IBS metric does not depend on COI and averages 0.055 s for the same data (1,000 pairs). Calculation times are essentially linear in the number of loci, so times for larger panels can easily be estimated. When <inline-formula id="IE211"><mml:math id="IM211" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, calculation times are roughly exponential in <italic toggle="yes">M</italic> for when <italic toggle="yes">r<sub>i</sub></italic> equality is not assumed and increase only slightly with <italic toggle="yes">M</italic> when it is; these times are shown in <xref rid="iyac126-T2" ref-type="table">Table 2</xref>.</p>
      <table-wrap position="float" id="iyac126-T1">
        <label>Table 1.</label>
        <caption>
          <p>Execution times (in seconds) for Dcifer processing 1,000 pairs of samples with COI combinations ranging between 1 and 10.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>1</bold>
              </td>
              <td rowspan="1" colspan="1">2.24</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">3.16</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>2</bold>
              </td>
              <td rowspan="1" colspan="1">2.31</td>
              <td rowspan="1" colspan="1">2.42</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">3.24</td>
              <td rowspan="1" colspan="1">3.24</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>3</bold>
              </td>
              <td rowspan="1" colspan="1">2.31</td>
              <td rowspan="1" colspan="1">2.35</td>
              <td rowspan="1" colspan="1">2.39</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">3.29</td>
              <td rowspan="1" colspan="1">3.30</td>
              <td rowspan="1" colspan="1">3.29</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>4</bold>
              </td>
              <td rowspan="1" colspan="1">2.20</td>
              <td rowspan="1" colspan="1">2.30</td>
              <td rowspan="1" colspan="1">2.43</td>
              <td rowspan="1" colspan="1">2.43</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">3.47</td>
              <td rowspan="1" colspan="1">3.44</td>
              <td rowspan="1" colspan="1">3.40</td>
              <td rowspan="1" colspan="1">3.32</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>5</bold>
              </td>
              <td rowspan="1" colspan="1">2.21</td>
              <td rowspan="1" colspan="1">2.26</td>
              <td rowspan="1" colspan="1">2.28</td>
              <td rowspan="1" colspan="1">2.35</td>
              <td rowspan="1" colspan="1">2.36</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">3.41</td>
              <td rowspan="1" colspan="1">3.55</td>
              <td rowspan="1" colspan="1">3.51</td>
              <td rowspan="1" colspan="1">3.53</td>
              <td rowspan="1" colspan="1">3.66</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>6</bold>
              </td>
              <td rowspan="1" colspan="1">2.26</td>
              <td rowspan="1" colspan="1">2.34</td>
              <td rowspan="1" colspan="1">2.32</td>
              <td rowspan="1" colspan="1">2.36</td>
              <td rowspan="1" colspan="1">2.48</td>
              <td rowspan="1" colspan="1">2.58</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">3.38</td>
              <td rowspan="1" colspan="1">3.47</td>
              <td rowspan="1" colspan="1">3.47</td>
              <td rowspan="1" colspan="1">3.57</td>
              <td rowspan="1" colspan="1">3.69</td>
              <td rowspan="1" colspan="1">3.79</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>7</bold>
              </td>
              <td rowspan="1" colspan="1">2.26</td>
              <td rowspan="1" colspan="1">2.32</td>
              <td rowspan="1" colspan="1">2.37</td>
              <td rowspan="1" colspan="1">2.49</td>
              <td rowspan="1" colspan="1">2.61</td>
              <td rowspan="1" colspan="1">2.86</td>
              <td rowspan="1" colspan="1">3.46</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">3.52</td>
              <td rowspan="1" colspan="1">3.51</td>
              <td rowspan="1" colspan="1">3.65</td>
              <td rowspan="1" colspan="1">3.68</td>
              <td rowspan="1" colspan="1">3.90</td>
              <td rowspan="1" colspan="1">4.07</td>
              <td rowspan="1" colspan="1">4.60</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>8</bold>
              </td>
              <td rowspan="1" colspan="1">2.30</td>
              <td rowspan="1" colspan="1">2.40</td>
              <td rowspan="1" colspan="1">2.47</td>
              <td rowspan="1" colspan="1">2.60</td>
              <td rowspan="1" colspan="1">2.85</td>
              <td rowspan="1" colspan="1">3.38</td>
              <td rowspan="1" colspan="1">4.46</td>
              <td rowspan="1" colspan="1">6.53</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">3.51</td>
              <td rowspan="1" colspan="1">3.68</td>
              <td rowspan="1" colspan="1">3.65</td>
              <td rowspan="1" colspan="1">3.82</td>
              <td rowspan="1" colspan="1">4.09</td>
              <td rowspan="1" colspan="1">4.68</td>
              <td rowspan="1" colspan="1">5.70</td>
              <td rowspan="1" colspan="1">7.99</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>9</bold>
              </td>
              <td rowspan="1" colspan="1">2.40</td>
              <td rowspan="1" colspan="1">2.52</td>
              <td rowspan="1" colspan="1">2.61</td>
              <td rowspan="1" colspan="1">2.88</td>
              <td rowspan="1" colspan="1">3.37</td>
              <td rowspan="1" colspan="1">4.38</td>
              <td rowspan="1" colspan="1">6.50</td>
              <td rowspan="1" colspan="1">10.81</td>
              <td rowspan="1" colspan="1">19.31</td>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">3.75</td>
              <td rowspan="1" colspan="1">3.61</td>
              <td rowspan="1" colspan="1">3.78</td>
              <td rowspan="1" colspan="1">4.01</td>
              <td rowspan="1" colspan="1">4.62</td>
              <td rowspan="1" colspan="1">5.60</td>
              <td rowspan="1" colspan="1">7.78</td>
              <td rowspan="1" colspan="1">12.18</td>
              <td rowspan="1" colspan="1">21.03</td>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>10</bold>
              </td>
              <td rowspan="1" colspan="1">2.67</td>
              <td rowspan="1" colspan="1">2.77</td>
              <td rowspan="1" colspan="1">2.95</td>
              <td rowspan="1" colspan="1">3.45</td>
              <td rowspan="1" colspan="1">4.43</td>
              <td rowspan="1" colspan="1">6.65</td>
              <td rowspan="1" colspan="1">11.28</td>
              <td rowspan="1" colspan="1">20.03</td>
              <td rowspan="1" colspan="1">37.02</td>
              <td rowspan="1" colspan="1">72.40</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">3.87</td>
              <td rowspan="1" colspan="1">3.98</td>
              <td rowspan="1" colspan="1">4.15</td>
              <td rowspan="1" colspan="1">4.61</td>
              <td rowspan="1" colspan="1">5.72</td>
              <td rowspan="1" colspan="1">7.69</td>
              <td rowspan="1" colspan="1">12.16</td>
              <td rowspan="1" colspan="1">21.04</td>
              <td rowspan="1" colspan="1">38.43</td>
              <td rowspan="1" colspan="1">72.37</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">COI</td>
              <td rowspan="1" colspan="1">
                <bold>1</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>2</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>3</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>4</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>5</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>6</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>7</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>8</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>9</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>10</bold>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>The data were simulated from 100 multiallelic loci (the number of alleles at each locus distributed uniformly between 2 and 20). <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>1, each COI combination displays times for using Newton’s method (unshaded) and calculating likelihood for a grid (shaded). Precision was set at 0.001 for both methods.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="iyac126-T2">
        <label>Table 2.</label>
        <caption>
          <p>Execution times (in seconds) for a pair of infections with COI of 6 and 9.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">M</th>
              <th align="center" rowspan="1" colspan="1">1</th>
              <th align="center" rowspan="1" colspan="1">2</th>
              <th align="center" rowspan="1" colspan="1">3</th>
              <th align="center" rowspan="1" colspan="1">4</th>
              <th align="center" rowspan="1" colspan="1">5</th>
              <th align="center" rowspan="1" colspan="1">6</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1"><inline-formula id="IE212"><mml:math id="IM212" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> constraint</td>
              <td rowspan="1" colspan="1">0.01</td>
              <td rowspan="1" colspan="1">0.67</td>
              <td rowspan="1" colspan="1">0.79</td>
              <td rowspan="1" colspan="1">0.86</td>
              <td rowspan="1" colspan="1">0.89</td>
              <td rowspan="1" colspan="1">0.92</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">No constraint</td>
              <td rowspan="1" colspan="1">0.01</td>
              <td rowspan="1" colspan="1">1.32</td>
              <td rowspan="1" colspan="1">2.17</td>
              <td rowspan="1" colspan="1">3.72</td>
              <td rowspan="1" colspan="1">6.65</td>
              <td rowspan="1" colspan="1">11.54</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <p><italic toggle="yes">M</italic> ranges between 1 and 6, and the likelihood is calculated over a grid of 1,000 <inline-formula id="IE213"><mml:math id="IM213" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> combinations (or 1,000 <italic toggle="yes">r</italic> values when <inline-formula id="IE214"><mml:math id="IM214" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> is assumed).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>For data analysis presented in <italic toggle="yes">Applications to empirical data</italic>, Dcifer execution times were 2.7 s for Mozambique (pairwise distances for 52 samples, or 1,326 comparisons) and 32 min for Namibia (2,585 samples, 3,339,820 comparisons). Consequently, we can estimate that it would take approximately 17 min to calculate all pairwise distances for 1,000 samples of Mozambique-type data (87 microhaplotypes). Calculations were performed on MacBook Pro, 2019, 2.3 GHz Intel Core i9 and were not parallelized.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>The ability to infer genetic distance between infections is a critical step in translating pathogen genetic data into insight regarding transmission. Despite this, there is a lack of established methods available to infer genetic distance between malaria infections containing multiple parasites, which are the majority in many endemic areas. Options are even more limited when using multiallelic loci, which offer more resolution than biallelic SNPs. The lack of any formal approach has left the community with only ad hoc calculations such as IBS, which yield ambiguous results and require extensive efforts to guide any attempt at meaningful inference. In contrast, Dcifer provides relatedness estimates that are based on IBD, interpretable quantities with consistent meaning across studies—regardless of genotyping methods used—with clear implications for ancestry. Importantly, we also show that Dcifer’s statistical power to detect related infections consistently surpasses that of IBS. The method produces reliable measures of uncertainty, and inference obtained from Dcifer vs IBS is more robust to misspecifications of estimated quantities such as COI or population allele frequencies. The R software package implementing Dcifer provides a fast, convenient, and flexible tool that can be easily incorporated into the analysis stream of a wide range of genotyping data to understand transmission.</p>
    <p>While Dcifer is designed to work with many types of genotyping data, e.g. biallelic SNPs, multiallelic loci such as microsatellites and microhaplotypes, and any combination thereof, we show that including multiallelic loci results in substantial gains in power to detect related infections. These benefits become more dramatic as COI increases. The result makes intuitive sense, as multiallelic panels provide more within-host strain differentiation and consequently can allow information pertaining to descent to be more easily detected, benefiting relatedness estimation. For example, where 2 infections with high COI may look similar with biallelic genotyping panels regardless of their level of relatedness (both alleles present at most loci with some diversity), having multiallelic data provides the opportunity to compare these infections more meaningfully. Fortunately, the greater availability of methods to obtain multiallelic data from across the genome makes it feasible to generate these data efficiently and in a high-throughput manner (<xref rid="iyac126-B2" ref-type="bibr">Aydemir <italic toggle="yes">et al.</italic> 2018</xref>; <xref rid="iyac126-B28" ref-type="bibr">Tessema <italic toggle="yes">et al.</italic> 2022</xref>; <xref rid="iyac126-B18" ref-type="bibr">LaVerriere <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    <p>The concept of relatedness for individual parasites does not extend trivially to polyclonal infections, where strains within and between infections can be related. Dcifer offers an approach that focuses on relatedness between infections as this information is very relevant to transmission. Simulations with imposed intrahost relatedness indicate that the working model achieves its stated goal of capturing interhost relatedness by implicitly downweighting the independent contribution of related strains within a host to comparisons between hosts. When multiple pairs of strains are related between 2 infections, degrees of relatedness between these strains could potentially provide an insight into more nuanced aspects of transmission. However, these strain-level comparisons may be difficult to estimate without accurate phasing, which remains a challenging problem. Here, we proposed a more easily identifiable summary, <italic toggle="yes">r</italic><sub>total</sub>, which provides a single measure of the overall degree of relatedness between 2 infections. This summary reliably encapsulates information encoded by the number of related strains and degree of relatedness between them even when individual <italic toggle="yes">r</italic> values are difficult to identify from realistic data—which was the case in our analyses except in situations when a large number of highly informative loci were used. For example, an <italic toggle="yes">r</italic><sub>total</sub> of 1.5 could indicate, amongst other scenarios, that 3 pairs of siblings or one clonal pair and one sibling pair are present between 2 infections. Either way, multiple closely related parasites exist between these 2 infections and they are likely to be closely linked by transmission events, e.g. via a single cotransmission event or multiple independent transmissions. We anticipate that the interpretation of this summary and its potential derivatives, as well as its incorporation into downstream analyses, will evolve as it is evaluated in more sophisticated population-level simulations and estimates from empirical data sets. Another conceptual issue concerns population allele frequencies, which can affect Dcifer estimates. The foremost question is what constitutes the relevant source population in regards to relatedness between samples and consequently from which data the frequencies should be estimated. If 2 infections are from communities with different within-community allele frequencies, what are the implications for descent? Dcifer currently assumes the same allele frequencies for both samples but further exploration might be warranted depending on the question of interest. Questions concerning population and scope of the analysis might also arise in regards to potential multiple testing procedures when many pairwise relatedness hypotheses are tested simultaneously. The fact that these hypotheses are not independent should be taken into account when such procedures are considered.</p>
    <p>The Dcifer model does not account for linkage disequilibrium and assumes independence of loci. As the malaria genome has relatively short linkage disequilibrium segments, loci independence can be assumed up to a reasonably large number of loci for a correspondingly designed genotyping panel. If, however, the panel has loci that are likely to be linked, e.g. those selected to be in close proximity or for a large number of loci, the independence assumption would no longer hold, which could result in anticonservative inference. Another limitation is that the model currently does not account for genotyping errors. Future modification could explicitly incorporate the error process via an appropriate model or assess how a specific error process affects the estimates and inference beyond the explorations we have performed here. Another potential venue for further work is developing an MLE estimator for <italic toggle="yes">r</italic><sub>total</sub> directly as this might become a commonly used summary. A direct estimator might be more efficient, would have the properties of MLE, and would require less processing time. In addition, scaling <italic toggle="yes">r</italic><sub>total</sub> by some function of COI could provide a useful way of comparing all pairwise relatedness estimates with standardized values in a [0,1] interval. Other future directions could explore alternative inferential approaches, including a nonparametric bootstrap, where loci data would be sampled with replacement. In that case, the fact that variables associated with different loci are not identically distributed, and therefore loci might not be equally informative, would need to be addressed.</p>
    <p>With potential to facilitate understanding of relatedness structure from unphased genetic data, including multiallelic loci, Dcifer can provide a vital link in the analytical process leading to better understanding of malaria transmission dynamics. While we have demonstrated the utility of this method for <italic toggle="yes">Plasmodium</italic> infections here, Dcifer may be useful in analyses of other organisms that undergo sexual recombination and where polyclonal infections are encountered, such as shistosomiasis, filarial disease, and soil transmitted helminths (<xref rid="iyac126-B4" ref-type="bibr">Brouwer <italic toggle="yes">et al.</italic> 2001</xref>; <xref rid="iyac126-B7" ref-type="bibr">Churcher <italic toggle="yes">et al.</italic> 2008</xref>). With the ability to incorporate most types of genetic data, rapid computation, and readily available inference, Dcifer may prove to be an important tool in the analytical toolbox for obtaining epidemiologic insight from pathogen genetics.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="s1" position="float" content-type="local-data">
      <label>iyac126_Supplemental_Material_File_1</label>
      <media xlink:href="iyac126_supplemental_material_file_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="s2" position="float" content-type="local-data">
      <label>iyac126_Supplemental_Material_File_2</label>
      <media xlink:href="iyac126_supplemental_material_file_2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="d1" position="float" content-type="local-data">
      <label>iyac126_Supplemental_Material_Data_1</label>
      <media xlink:href="iyac126_supplemental_material_data_1.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="d2" position="float" content-type="local-data">
      <label>iyac126_Supplemental_Material_Data_2</label>
      <media xlink:href="iyac126_supplemental_material_data_2.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="d3" position="float" content-type="local-data">
      <label>iyac126_Supplemental_Material_Data_3</label>
      <media xlink:href="iyac126_supplemental_material_data_3.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>We thank Nicholas Hathaway, Sofonias Tessema, Francisco Saute, and Pedro Aide for generating and sharing microhaplotype data from South Mozambique and for their assistance with extracting relevant information. We also thank the authors of <xref rid="iyac126-B27" ref-type="bibr">Tessema <italic toggle="yes">et al.</italic> (2019)</xref> for making data from Namibia publicly available. We are grateful to Aimee Taylor for fruitful discussions regarding relatedness and genetic distance and inspiring this work with very clearly presented concepts in <xref rid="iyac126-B25" ref-type="bibr">Taylor <italic toggle="yes">et al.</italic> (2019)</xref>.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported, in whole or in part, by the Bill &amp; Melinda Gates Foundation (INV-019043 and INV-024346). Under the grant conditions of the Foundation, a Creative Commons Attribution 4.0 Generic License has already been assigned to the Author Accepted Manuscript version that might arise from this submission. Funding for this project also came from the National Institutes of Health (K24 AI44048).</p>
    </sec>
    <sec>
      <title>Conflicts of interest</title>
      <p>None declared.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p><xref rid="d1" ref-type="supplementary-material">Supplementary Data_1</xref> contain microhaplotype data from Mozambique. Microsatellite data from Namibia are publicly available at <ext-link xlink:href="https://elifesciences.org/articles/43510/figures#supp1" ext-link-type="uri">https://elifesciences.org/articles/43510/figures#supp1</ext-link> (accessed 2022 Aug 25). <xref rid="d2 d3" ref-type="supplementary-material">Supplementary Data_2 and Data_3</xref> contain population allele frequencies estimated from Mozambique and Namibia datasets, respectively.</p>
    <p>Supplemental material is available at <italic toggle="yes">GENETICS</italic> online.</p>
  </sec>
  <ref-list id="ref1">
    <title>Literature cited</title>
    <ref id="iyac126-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Atuh</surname><given-names>NI</given-names></string-name>, <string-name><surname>Anong</surname><given-names>DN</given-names></string-name>, <string-name><surname>Jerome</surname><given-names>FC</given-names></string-name>, <string-name><surname>Oriero</surname><given-names>E</given-names></string-name>, <string-name><surname>Mohammed</surname><given-names>NI</given-names></string-name>, <string-name><surname>D’Alessandro</surname><given-names>U</given-names></string-name>, <string-name><surname>Amambua-Ngwa</surname><given-names>A.</given-names></string-name></person-group><article-title>High genetic complexity but low relatedness in <italic toggle="yes">Plasmodium falciparum</italic> infections from Western Savannah Highlands and coastal equatorial Lowlands of Cameroon</article-title>. <source>Pathog Glob Health</source>. <year>2021</year>;<fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac126-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aydemir</surname><given-names>O</given-names></string-name>, <string-name><surname>Janko</surname><given-names>M</given-names></string-name>, <string-name><surname>Hathaway</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Verity</surname><given-names>R</given-names></string-name>, <string-name><surname>Mwandagalirwa</surname><given-names>MK</given-names></string-name>, <string-name><surname>Tshefu</surname><given-names>AK</given-names></string-name>, <string-name><surname>Tessema</surname><given-names>SK</given-names></string-name>, <string-name><surname>Marsh</surname><given-names>PW</given-names></string-name>, <string-name><surname>Tran</surname><given-names>A</given-names></string-name>, <string-name><surname>Reimonn</surname><given-names>T</given-names></string-name></person-group>, <etal>et al</etal><article-title>Drug-resistance and population structure of <italic toggle="yes">Plasmodium falciparum</italic> across the Democratic Republic of Congo using high-throughput molecular inversion probes</article-title>. <source>J Infect Dis</source>. <year>2018</year>;<volume>218</volume>(<issue>6</issue>):<fpage>946</fpage>–<lpage>955</lpage>.<pub-id pub-id-type="pmid">29718283</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beale</surname><given-names>E.</given-names></string-name></person-group><article-title>Confidence regions in non-linear estimation</article-title>. <source>J R Stat Soc B (Methodol)</source>. <year>1960</year>;<volume>22</volume>(<issue>1</issue>):<fpage>41</fpage>–<lpage>76</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac126-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brouwer</surname><given-names>KC</given-names></string-name>, <string-name><surname>Ndhlovu</surname><given-names>P</given-names></string-name>, <string-name><surname>Munatsi</surname><given-names>A</given-names></string-name>, <string-name><surname>Shiff</surname><given-names>CJ.</given-names></string-name></person-group><article-title>Genetic diversity of a population of <italic toggle="yes">Schistosoma haematobium</italic> derived from schoolchildren in east central Zimbabwe</article-title>. <source>J Parasitol</source>. <year>2001</year>;<volume>87</volume>(<issue>4</issue>):<fpage>762</fpage>–<lpage>769</lpage>.<pub-id pub-id-type="pmid">11534639</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>HH</given-names></string-name>, <string-name><surname>Wesolowski</surname><given-names>A</given-names></string-name>, <string-name><surname>Sinha</surname><given-names>I</given-names></string-name>, <string-name><surname>Jacob</surname><given-names>CG</given-names></string-name>, <string-name><surname>Mahmud</surname><given-names>A</given-names></string-name>, <string-name><surname>Uddin</surname><given-names>D</given-names></string-name>, <string-name><surname>Zaman</surname><given-names>SI</given-names></string-name>, <string-name><surname>Hossain</surname><given-names>MA</given-names></string-name>, <string-name><surname>Faiz</surname><given-names>MA</given-names></string-name>, <string-name><surname>Ghose</surname><given-names>A</given-names></string-name></person-group>, <etal>et al</etal><article-title>Mapping imported malaria in Bangladesh using parasite genetic and human mobility data</article-title>. <source>Elife</source>. <year>2019</year>;<volume>8</volume>:<fpage>e43481</fpage>.<pub-id pub-id-type="pmid">30938289</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>HH</given-names></string-name>, <string-name><surname>Worby</surname><given-names>CJ</given-names></string-name>, <string-name><surname>Yeka</surname><given-names>A</given-names></string-name>, <string-name><surname>Nankabirwa</surname><given-names>J</given-names></string-name>, <string-name><surname>Kamya</surname><given-names>MR</given-names></string-name>, <string-name><surname>Staedke</surname><given-names>SG</given-names></string-name>, <string-name><surname>Dorsey</surname><given-names>G</given-names></string-name>, <string-name><surname>Murphy</surname><given-names>M</given-names></string-name>, <string-name><surname>Neafsey</surname><given-names>DE</given-names></string-name>, <string-name><surname>Jeffreys</surname><given-names>AE</given-names></string-name></person-group>, <etal>et al</etal><article-title>THE REAL McCOIL: a method for the concurrent estimation of the complexity of infection and SNP allele frequency for malaria parasites</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>;<volume>13</volume>(<issue>1</issue>):<fpage>e1005348</fpage>.<pub-id pub-id-type="pmid">28125584</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Churcher</surname><given-names>TS</given-names></string-name>, <string-name><surname>Schwab</surname><given-names>AE</given-names></string-name>, <string-name><surname>Prichard</surname><given-names>RK</given-names></string-name>, <string-name><surname>Basáñez</surname><given-names>MG.</given-names></string-name></person-group><article-title>An analysis of genetic diversity and inbreeding in <italic toggle="yes">Wuchereria bancrofti</italic>: implications for the spread and detection of drug resistance</article-title>. <source>PLoS Negl Trop Dis</source>. <year>2008</year>;<volume>2</volume>(<issue>4</issue>):<fpage>e211</fpage>.<pub-id pub-id-type="pmid">18382607</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cook</surname><given-names>RD</given-names></string-name>, <string-name><surname>Weisberg</surname><given-names>S.</given-names></string-name></person-group><article-title>Confidence curves in nonlinear regression</article-title>. <source>J Am Stat Assoc</source>. <year>1990</year>;<volume>85</volume>(<issue>410</issue>):<fpage>544</fpage>–<lpage>551</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac126-B9">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Cox</surname><given-names>DR</given-names></string-name>, <string-name><surname>Hinkley</surname><given-names>DV.</given-names></string-name></person-group><source>Theoretical Statistics</source>. Oxfordshire (UK): <publisher-name>CRC Press</publisher-name>; <year>1979</year>.</mixed-citation>
    </ref>
    <ref id="iyac126-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Daniels</surname><given-names>R</given-names></string-name>, <string-name><surname>Volkman</surname><given-names>SK</given-names></string-name>, <string-name><surname>Milner</surname><given-names>DA</given-names></string-name>, <string-name><surname>Mahesh</surname><given-names>N</given-names></string-name>, <string-name><surname>Neafsey</surname><given-names>DE</given-names></string-name>, <string-name><surname>Park</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Rosen</surname><given-names>D</given-names></string-name>, <string-name><surname>Angelino</surname><given-names>E</given-names></string-name>, <string-name><surname>Sabeti</surname><given-names>PC</given-names></string-name>, <string-name><surname>Wirth</surname><given-names>DF</given-names></string-name></person-group>, <etal>et al</etal><article-title>A general SNP-based molecular barcode for <italic toggle="yes">Plasmodium falciparum</italic> identification and tracking</article-title>. <source>Malar J</source>. <year>2008</year>;<volume>7</volume>:<fpage>223</fpage>–<lpage>211</lpage>.<pub-id pub-id-type="pmid">18959790</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Efron</surname><given-names>B</given-names></string-name>, <string-name><surname>Hinkley</surname><given-names>DV.</given-names></string-name></person-group><article-title>Assessing the accuracy of the maximum likelihood estimator: observed versus expected Fisher information</article-title>. <source>Biometrika</source>. <year>1978</year>;<volume>65</volume>(<issue>3</issue>):<fpage>457</fpage>–<lpage>483</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac126-B12">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gerlovina</surname><given-names>I.</given-names></string-name></person-group> dcifer: Genetic Relatedness Between Polyclonal Infections. R package version 1.1.1. <year>2022</year>. [Accessed 2022 Aug 25]. https://cran.r-project.org/web/packages/dcifer/index.html</mixed-citation>
    </ref>
    <ref id="iyac126-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henden</surname><given-names>L</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S</given-names></string-name>, <string-name><surname>Mueller</surname><given-names>I</given-names></string-name>, <string-name><surname>Barry</surname><given-names>A</given-names></string-name>, <string-name><surname>Bahlo</surname><given-names>M.</given-names></string-name></person-group><article-title>Identity-by-descent analyses for measuring population dynamics and selection in recombining pathogens</article-title>. <source>PLoS Genet</source>. <year>2018</year>;<volume>14</volume>(<issue>5</issue>):<fpage>e1007279</fpage>.<pub-id pub-id-type="pmid">29791438</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jaccard</surname><given-names>P.</given-names></string-name></person-group><article-title>The distribution of the flora in the alpine zone</article-title>. <source>New Phytol</source>. <year>1912</year>;<volume>11</volume>(<issue>2</issue>):<fpage>37</fpage>–<lpage>50</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac126-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jacob</surname><given-names>CG</given-names></string-name>, <string-name><surname>Thuy-Nhien</surname><given-names>N</given-names></string-name>, <string-name><surname>Mayxay</surname><given-names>M</given-names></string-name>, <string-name><surname>Maude</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Quang</surname><given-names>HH</given-names></string-name>, <string-name><surname>Hongvanthong</surname><given-names>B</given-names></string-name>, <string-name><surname>Vanisaveth</surname><given-names>V</given-names></string-name>, <string-name><surname>Duc</surname><given-names>TN</given-names></string-name>, <string-name><surname>Rekol</surname><given-names>H</given-names></string-name>, <string-name><surname>van der Pluijm</surname><given-names>R</given-names></string-name></person-group>, <etal>et al</etal><article-title>Genetic surveillance in the Greater Mekong subregion and South Asia to support malaria control and elimination</article-title>. <source>Elife</source>. <year>2021</year>;<volume>10</volume>:<fpage>e62997</fpage>.<pub-id pub-id-type="pmid">34372970</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B16">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Knuth</surname><given-names>DE.</given-names></string-name></person-group><source>The Art of Computer Programming, Volume 4A: Combinatorial Algorithms, Part 1</source>. Delhi (India): <publisher-name>Pearson Education India</publisher-name>; <year>2011</year>.</mixed-citation>
    </ref>
    <ref id="iyac126-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Koepfli</surname><given-names>C</given-names></string-name>, <string-name><surname>Ross</surname><given-names>A</given-names></string-name>, <string-name><surname>Kiniboro</surname><given-names>B</given-names></string-name>, <string-name><surname>Smith</surname><given-names>TA</given-names></string-name>, <string-name><surname>Zimmerman</surname><given-names>PA</given-names></string-name>, <string-name><surname>Siba</surname><given-names>P</given-names></string-name>, <string-name><surname>Mueller</surname><given-names>I</given-names></string-name>, <string-name><surname>Felger</surname><given-names>I.</given-names></string-name></person-group><article-title>Multiplicity and diversity of <italic toggle="yes">Plasmodium vivax</italic> infections in a highly endemic region in Papua New Guinea</article-title>. <source>PLoS Negl Trop Dis</source>. <year>2011</year>;<volume>5</volume>(<issue>12</issue>):<fpage>e1424</fpage>.<pub-id pub-id-type="pmid">22206027</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>LaVerriere</surname><given-names>E</given-names></string-name>, <string-name><surname>Schwabl</surname><given-names>P</given-names></string-name>, <string-name><surname>Carrasquilla</surname><given-names>M</given-names></string-name>, <string-name><surname>Taylor</surname><given-names>AR</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>ZM</given-names></string-name>, <string-name><surname>Shieh</surname><given-names>M</given-names></string-name>, <string-name><surname>Panchal</surname><given-names>R</given-names></string-name>, <string-name><surname>Straub</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Kuzma</surname><given-names>R</given-names></string-name>, <string-name><surname>Watson</surname><given-names>S</given-names></string-name></person-group>, <etal>et al</etal> Design and implementation of multiplexed amplicon sequencing panels to serve genomic epidemiology of infectious disease: a malaria case study. Mol Ecol Resour. 2022;22(6):2285–2303.</mixed-citation>
    </ref>
    <ref id="iyac126-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lerch</surname><given-names>A</given-names></string-name>, <string-name><surname>Koepfli</surname><given-names>C</given-names></string-name>, <string-name><surname>Hofmann</surname><given-names>NE</given-names></string-name>, <string-name><surname>Messerli</surname><given-names>C</given-names></string-name>, <string-name><surname>Wilcox</surname><given-names>S</given-names></string-name>, <string-name><surname>Kattenberg</surname><given-names>JH</given-names></string-name>, <string-name><surname>Betuela</surname><given-names>I</given-names></string-name>, <string-name><surname>O'Connor</surname><given-names>L</given-names></string-name>, <string-name><surname>Mueller</surname><given-names>I</given-names></string-name>, <string-name><surname>Felger</surname><given-names>I.</given-names></string-name></person-group><article-title>Development of amplicon deep sequencing markers and data analysis pipeline for genotyping multi-clonal malaria infections</article-title>. <source>BMC Genomics</source>. <year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>864</fpage>.<pub-id pub-id-type="pmid">29132317</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meeker</surname><given-names>WQ</given-names></string-name>, <string-name><surname>Escobar</surname><given-names>LA.</given-names></string-name></person-group><article-title>Teaching about approximate confidence regions based on maximum likelihood estimation</article-title>. <source>Am Stat</source>. <year>1995</year>;<volume>49</volume>(<issue>1</issue>):<fpage>48</fpage>–<lpage>53</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac126-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Neyman</surname><given-names>J</given-names></string-name>, <string-name><surname>Pearson</surname><given-names>ES.</given-names></string-name></person-group><article-title>IX. On the problem of the most efficient tests of statistical hypotheses</article-title>. <source>Philos Trans R Soc Lond A</source>. <year>1933</year>;<volume>231</volume>:<fpage>289</fpage>–<lpage>337</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac126-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pringle</surname><given-names>JC</given-names></string-name>, <string-name><surname>Tessema</surname><given-names>S</given-names></string-name>, <string-name><surname>Wesolowski</surname><given-names>A</given-names></string-name>, <string-name><surname>Chen</surname><given-names>A</given-names></string-name>, <string-name><surname>Murphy</surname><given-names>M</given-names></string-name>, <string-name><surname>Carpi</surname><given-names>G</given-names></string-name>, <string-name><surname>Shields</surname><given-names>TM</given-names></string-name>, <string-name><surname>Hamapumbu</surname><given-names>H</given-names></string-name>, <string-name><surname>Searle</surname><given-names>KM</given-names></string-name>, <string-name><surname>Kobayashi</surname><given-names>T</given-names></string-name></person-group>, <etal>et al</etal><article-title>Genetic evidence of focal <italic toggle="yes">Plasmodium falciparum</italic> transmission in a pre-elimination setting in southern province, Zambia</article-title>. <source>J Infect Dis</source>. <year>2019</year>;<volume>219</volume>(<issue>8</issue>):<fpage>1254</fpage>–<lpage>1263</lpage>.<pub-id pub-id-type="pmid">30445612</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roh</surname><given-names>ME</given-names></string-name>, <string-name><surname>Tessema</surname><given-names>SK</given-names></string-name>, <string-name><surname>Murphy</surname><given-names>M</given-names></string-name>, <string-name><surname>Nhlabathi</surname><given-names>N</given-names></string-name>, <string-name><surname>Mkhonta</surname><given-names>N</given-names></string-name>, <string-name><surname>Vilakati</surname><given-names>S</given-names></string-name>, <string-name><surname>Ntshalintshali</surname><given-names>N</given-names></string-name>, <string-name><surname>Saini</surname><given-names>M</given-names></string-name>, <string-name><surname>Maphalala</surname><given-names>G</given-names></string-name>, <string-name><surname>Chen</surname><given-names>A</given-names></string-name></person-group>, <etal>et al</etal><article-title>High genetic diversity of <italic toggle="yes">Plasmodium falciparum</italic> in the low-transmission setting of the Kingdom of Eswatini</article-title>. <source>J Infect Dis</source>. <year>2019</year>;<volume>220</volume>(<issue>8</issue>):<fpage>1346</fpage>–<lpage>1354</lpage>.<pub-id pub-id-type="pmid">31190073</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaffner</surname><given-names>SF</given-names></string-name>, <string-name><surname>Taylor</surname><given-names>AR</given-names></string-name>, <string-name><surname>Wong</surname><given-names>W</given-names></string-name>, <string-name><surname>Wirth</surname><given-names>DF</given-names></string-name>, <string-name><surname>Neafsey</surname><given-names>DE.</given-names></string-name></person-group><article-title>hmmIBD: software to infer pairwise identity by descent between haploid genotypes</article-title>. <source>Malar J</source>. <year>2018</year>;<volume>17</volume>(<issue>1</issue>):<fpage>4</fpage>.<pub-id pub-id-type="pmid">29304794</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Taylor</surname><given-names>AR</given-names></string-name>, <string-name><surname>Jacob</surname><given-names>PE</given-names></string-name>, <string-name><surname>Neafsey</surname><given-names>DE</given-names></string-name>, <string-name><surname>Buckee</surname><given-names>CO.</given-names></string-name></person-group><article-title>Estimating relatedness between malaria parasites</article-title>. <source>Genetics</source>. <year>2019</year>;<volume>212</volume>(<issue>4</issue>):<fpage>1337</fpage>–<lpage>1351</lpage>.<pub-id pub-id-type="pmid">31209105</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Taylor</surname><given-names>AR</given-names></string-name>, <string-name><surname>Schaffner</surname><given-names>SF</given-names></string-name>, <string-name><surname>Cerqueira</surname><given-names>GC</given-names></string-name>, <string-name><surname>Nkhoma</surname><given-names>SC</given-names></string-name>, <string-name><surname>Anderson</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Sriprawat</surname><given-names>K</given-names></string-name>, <string-name><surname>Pyae Phyo</surname><given-names>A</given-names></string-name>, <string-name><surname>Nosten</surname><given-names>F</given-names></string-name>, <string-name><surname>Neafsey</surname><given-names>DE</given-names></string-name>, <string-name><surname>Buckee</surname><given-names>CO.</given-names></string-name></person-group><article-title>Quantifying connectivity between local <italic toggle="yes">Plasmodium falciparum</italic> malaria parasite populations using identity by descent</article-title>. <source>PLoS Genet</source>. <year>2017</year>;<volume>13</volume>(<issue>10</issue>):<fpage>e1007065</fpage>.<pub-id pub-id-type="pmid">29077712</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tessema</surname><given-names>S</given-names></string-name>, <string-name><surname>Wesolowski</surname><given-names>A</given-names></string-name>, <string-name><surname>Chen</surname><given-names>A</given-names></string-name>, <string-name><surname>Murphy</surname><given-names>M</given-names></string-name>, <string-name><surname>Wilheim</surname><given-names>J</given-names></string-name>, <string-name><surname>Mupiri</surname><given-names>AR</given-names></string-name>, <string-name><surname>Ruktanonchai</surname><given-names>NW</given-names></string-name>, <string-name><surname>Alegana</surname><given-names>VA</given-names></string-name>, <string-name><surname>Tatem</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Tambo</surname><given-names>M</given-names></string-name></person-group>, <etal>et al</etal><article-title>Using parasite genetic and human mobility data to infer local and cross-border malaria connectivity in Southern Africa</article-title>. <source>Elife</source>. <year>2019</year>;<volume>8</volume>:<fpage>e43510</fpage>.<pub-id pub-id-type="pmid">30938286</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B28">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Tessema</surname><given-names>SK</given-names></string-name>, <string-name><surname>Hathaway</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Teyssier</surname><given-names>NB</given-names></string-name>, <string-name><surname>Murphy</surname><given-names>M</given-names></string-name>, <string-name><surname>Chen</surname><given-names>A</given-names></string-name>, <string-name><surname>Aydemir</surname><given-names>O</given-names></string-name>, <string-name><surname>Duarte</surname><given-names>EM</given-names></string-name>, <string-name><surname>Simone</surname><given-names>W</given-names></string-name>, <string-name><surname>Colborn</surname><given-names>J</given-names></string-name>, <string-name><surname>Saute</surname><given-names>F</given-names></string-name></person-group>, <etal>et al</etal> Sensitive, highly multiplexed sequencing of microhaplotypes from the <italic toggle="yes">Plasmodium falciparum</italic> heterozygome. J Infect Dis. <year>2022</year>;225(7):<fpage>1227</fpage>–<lpage>1237</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac126-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vander Wiel</surname><given-names>SA</given-names></string-name>, <string-name><surname>Meeker</surname><given-names>WQ.</given-names></string-name></person-group><article-title>Accuracy of approx confidence bounds using censored Weibull regression data from accelerated life tests</article-title>. <source>IEEE Trans Rel</source>. <year>1990</year>;<volume>39</volume>(<issue>3</issue>):<fpage>346</fpage>–<lpage>351</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac126-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wald</surname><given-names>A.</given-names></string-name></person-group><article-title>Tests of statistical hypotheses concerning several parameters when the number of observations is large</article-title>. <source>Trans Amer Math Soc</source>. <year>1943</year>;<volume>54</volume>(<issue>3</issue>):<fpage>426</fpage>–<lpage>482</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac126-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wesolowski</surname><given-names>A</given-names></string-name>, <string-name><surname>Taylor</surname><given-names>AR</given-names></string-name>, <string-name><surname>Chang</surname><given-names>HH</given-names></string-name>, <string-name><surname>Verity</surname><given-names>R</given-names></string-name>, <string-name><surname>Tessema</surname><given-names>S</given-names></string-name>, <string-name><surname>Bailey</surname><given-names>JA</given-names></string-name>, <string-name><surname>T Perkins</surname><given-names>A</given-names></string-name>, <string-name><surname>Neafsey</surname><given-names>DE</given-names></string-name>, <string-name><surname>Greenhouse</surname><given-names>B</given-names></string-name>, <string-name><surname>Buckee</surname><given-names>CO.</given-names></string-name></person-group><article-title>Mapping malaria by combining parasite genomic and epidemiologic data</article-title>. <source>BMC Med</source>. <year>2018</year>;<volume>16</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac126-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>White</surname><given-names>MT</given-names></string-name>, <string-name><surname>Karl</surname><given-names>S</given-names></string-name>, <string-name><surname>Koepfli</surname><given-names>C</given-names></string-name>, <string-name><surname>Longley</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Hofmann</surname><given-names>NE</given-names></string-name>, <string-name><surname>Wampfler</surname><given-names>R</given-names></string-name>, <string-name><surname>Felger</surname><given-names>I</given-names></string-name>, <string-name><surname>Smith</surname><given-names>T</given-names></string-name>, <string-name><surname>Nguitragool</surname><given-names>W</given-names></string-name>, <string-name><surname>Sattabongkot</surname><given-names>J</given-names></string-name></person-group>, <etal>et al</etal><article-title><italic toggle="yes">Plasmodium vivax</italic> and <italic toggle="yes">Plasmodium falciparum</italic> infection dynamics: re-infections, recrudescences and relapses</article-title>. <source>Malar J</source>. <year>2018</year>;<volume>17</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">29291736</pub-id></mixed-citation>
    </ref>
    <ref id="iyac126-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wilks</surname><given-names>SS.</given-names></string-name></person-group><article-title>The large-sample distribution of the likelihood ratio for testing composite hypotheses</article-title>. <source>Ann Math Statist</source>. <year>1938</year>;<volume>9</volume>(<issue>1</issue>):<fpage>60</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac126-B34">
      <mixed-citation publication-type="other"><collab>World Health Organization</collab>. Meeting report of the technical consultation on the role of parasite and anopheline genetics in malaria surveillance, 5–7 June 2019, Geneva, Switzerland. Technical report. World Health Organization. <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="iyac126-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Hendry</surname><given-names>JA</given-names></string-name>, <string-name><surname>Almagro-Garcia</surname><given-names>J</given-names></string-name>, <string-name><surname>Pearson</surname><given-names>RD</given-names></string-name>, <string-name><surname>Amato</surname><given-names>R</given-names></string-name>, <string-name><surname>Miles</surname><given-names>A</given-names></string-name>, <string-name><surname>Weiss</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Lucas</surname><given-names>TC</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>M</given-names></string-name>, <string-name><surname>Gething</surname><given-names>PW</given-names></string-name></person-group>, <etal>et al</etal>; <collab>for the Pf3k Project</collab>. <article-title>The origins and relatedness structure of mixed infections vary with local prevalence of <italic toggle="yes">P. falciparum</italic> malaria</article-title>. <source>Elife</source>. <year>2019</year>;<volume>8</volume>:<fpage>e40845</fpage>.<pub-id pub-id-type="pmid">31298657</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
