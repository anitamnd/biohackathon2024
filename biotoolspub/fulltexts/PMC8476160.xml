<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8476160</article-id>
    <article-id pub-id-type="pmid">34117771</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/msab175</article-id>
    <article-id pub-id-type="publisher-id">msab175</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Resources</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Geonomics: Forward-Time, Spatially Explicit, and Arbitrarily Complex
Landscape Genomic Simulations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1832-2289</contrib-id>
        <name>
          <surname>Terasaki Hart</surname>
          <given-names>Drew E</given-names>
        </name>
        <xref rid="msab175-cor1" ref-type="corresp"/>
        <!--drew.hart@berkeley.edu-->
        <xref rid="msab175-aff1" ref-type="aff"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1731-8683</contrib-id>
        <name>
          <surname>Bishop</surname>
          <given-names>Anusha P</given-names>
        </name>
        <xref rid="msab175-aff1" ref-type="aff"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ian J</given-names>
        </name>
        <xref rid="msab175-aff1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="msab175-aff1"><institution>Department of Environmental Science, Policy, and Management, College of Natural
Resources, University of California</institution>, Berkeley, CA, <country country="US">USA</country></aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wilson</surname>
          <given-names>Melissa</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="msab175-cor1"><bold>Corresponding author:</bold> E-mail:
<email>drew.hart@berkeley.edu</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-06-12">
      <day>12</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <volume>38</volume>
    <issue>10</issue>
    <fpage>4634</fpage>
    <lpage>4646</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press on behalf of
the Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative
Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted
reuse, distribution, and reproduction in any medium, provided the original work is
properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="msab175.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Understanding the drivers of spatial patterns of genomic diversity has emerged as a major
goal of evolutionary genetics. The flexibility of forward-time simulation makes it
especially valuable for these efforts, allowing for the simulation of arbitrarily complex
scenarios in a way that mimics how real populations evolve. Here, we present Geonomics, a
Python package for performing complex, spatially explicit, landscape genomic simulations
with full spatial pedigrees that dramatically reduces user workload yet remains
customizable and extensible because it is embedded within a popular, general-purpose
language. We show that Geonomics results are consistent with expectations for a variety of
validation tests based on classic models in population genetics and then demonstrate its
utility and flexibility with a trio of more complex simulation scenarios that feature
polygenic selection, selection on multiple traits, simulation on complex landscapes, and
nonstationary environmental change. We then discuss runtime, which is primarily sensitive
to landscape raster size, memory usage, which is primarily sensitive to maximum population
size and recombination rate, and other caveats related to the model’s methods for
approximating recombination and movement. Taken together, our tests and demonstrations
show that Geonomics provides an efficient and robust platform for population genomic
simulations that capture complex spatial and evolutionary dynamics.</p>
    </abstract>
    <kwd-group>
      <kwd>landscape ecology</kwd>
      <kwd>evolutionary genetics</kwd>
      <kwd>population dynamics</kwd>
      <kwd>environmental change</kwd>
      <kwd>spatial modeling</kwd>
      <kwd>Python</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Berkeley Fellowship</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>DEB-1845682</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Spatial patterns of genomic diversity result from the complex interplay of many underlying
ecological and evolutionary processes and are shaped by a wide variety of geographic and
environmental factors. Understanding how these patterns develop in natural systems has
emerged as a primary goal of modern evolutionary genetics. These systems often occupy
complex and potentially changing landscapes and might include populations that are not at
demographic equilibrium. They may undergo neutral evolution as well as natural selection,
sometimes on multiple traits of variable genetic architecture. The study of complex natural
systems is crucial for developing evolutionary and ecological theory (<xref rid="msab175-B8" ref-type="bibr">Epperson et al. 2010</xref>; <xref rid="msab175-B2" ref-type="bibr">Barrett et al. 2019</xref>; <xref rid="msab175-B41" ref-type="bibr">Pelletier
2019</xref>), understanding the forces governing the evolution and maintenance of genetic
diversity (<xref rid="msab175-B6540011037" ref-type="bibr">Manel et al. 2003</xref>; <xref rid="msab175-B52" ref-type="bibr">Schoville et al. 2012</xref>), anticipating ecological
futures in the Anthropocene (<xref rid="msab175-B3" ref-type="bibr">Bay et al. 2018</xref>;
<xref rid="msab175-B5" ref-type="bibr">Capblancq et al. 2020</xref>), and informing
conservation and management (<xref rid="msab175-B6" ref-type="bibr">Crossley et al.
2017</xref>; <xref rid="msab175-B30" ref-type="bibr">Lind et al. 2017</xref>). The complex
genomics of many such systems are beyond the reach of analytical population genetics, and
their spatial complexity and evolutionary dynamics make them intractable for coalescent
simulation (<xref rid="msab175-B20" ref-type="bibr">Hoban et al. 2012</xref>). This hinders
not only our understanding of many empirical systems but also our ability to predict their
dynamics and, thus, to manage them. Hence, in population and landscape genomics, as in many
other fields, forward-time simulation is a crucial tool for dissecting complex study
systems.</p>
    <p>However, the current suite of forward-time genomic simulators, although numerous, is still
of limited utility for such work. Most available software is restricted, either genomically
or geospatially, in the complexity, it can model. Many programs can model systems of
considerable genomic complexity (e.g., simuPOP, <xref rid="msab175-B42" ref-type="bibr">Peng
and Kimmel 2005</xref>; NEMO, <xref rid="msab175-B15" ref-type="bibr">Guillaume and
Rougemont 2006</xref>; QuantiNemo, <xref rid="msab175-B37" ref-type="bibr">Neuenschwander
et al. 2008</xref>) yet incorporate only rudimentary spatial components or none at all.
Other programs are designed specifically for landscape genetic simulations (e.g., CDPOP,
<xref rid="msab175-B27" ref-type="bibr">Landguth and Cushman 2010</xref>; CDMetaPOP, <xref rid="msab175-B26" ref-type="bibr">Landguth et al. 2017</xref>; SimAdapt, <xref rid="msab175-B49" ref-type="bibr">Rebaudo et al. 2013</xref>) but are limited in their
genomic complexity. For instance, many programs are unable to model simultaneous selection
on multiple, polygenic traits. To our knowledge, SLiM (<xref rid="msab175-B35" ref-type="bibr">Messer 2013</xref>; <xref rid="msab175-B16" ref-type="bibr">Haller and
Messer 2017</xref>; <xref rid="msab175-B17" ref-type="bibr">Haller and Messer 2019</xref>)
is the only package currently capable of simulating scenarios that are sufficiently complex,
both genomically and geospatially, to model population genomic patterns emerging under
dynamic evolutionary processes (according to a search of the National Cancer Institute’s
Genetic Simulation Resources website; <xref rid="msab175-B43" ref-type="bibr">Peng et al.
2013</xref>), and its extreme generalizability and complexity allow it to be used for
landscape genomics simulation. Furthermore, many species are distributed continuously in
space, and examining continuous fields of genetic variation can require distinct methods and
assumptions (<xref rid="msab175-B4" ref-type="bibr">Bradburd and Ralph 2019</xref>), yet
most population genomic simulation packages, aside from SLiM, are population-based. Such
software requires individuals to be assigned to discrete subpopulations, which can at best
be arranged on a high-resolution, regular grid in order to approximate continuously
distributed populations.</p>
    <p>Here, we present Geonomics, a Python package for forward-time, individual-based,
continuous-space, population genomic simulations on complex landscapes. Geonomics models are
parameterized by way of an informatively annotated parameters file that provides the user a
straightforward means of building models of arbitrary complexity while offering reasonable
default settings and “off switches” for parameters and components unrelated to the user’s
interests. Models consist of 1) a landscape with one or more environmental layers, each of
which can undergo arbitrarily complex environmental change events and 2) one or more species
having genomes with realistic architecture and any number of associated phenotypes. Species
undergo non-Wright-Fisher evolution in continuous space, with localized mating and
mortality, such that species-level phenomena and simulation dynamics are emergent properties
of a model’s parameterization. Evolution is comprehensively tracked by way of recently
developed data structures that record the complete spatial pedigree (<xref rid="msab175-B25" ref-type="bibr">Kelleher et al. 2018</xref>), providing for the customizable output of
rich, 3D data sets in a variety of common formats, including VCF and FASTA for genomic data,
GeoTiff for landscape data, and CSV, Shapefile, and GeoJSON for individuals’ nongenomic data
(location, environmental values, phenotypes, age, and sex). All of this allows Geonomics to
produce realistic landscape genomic results useful for a wide variety of theoretical and
empirical purposes.</p>
  </sec>
  <sec>
    <title>New Approaches</title>
    <sec>
      <title>Model Design: Overview</title>
      <p>A Geonomics model consists of two core components: the species and the landscape. The
species is composed of a set of individuals and a wide variety of demographic and
life-history parameters, including an intrinsic growth rate, mate-search radius, the mean
number of offspring per mating event, reproductive age, and maximum age, among others. A
species can undergo any number of change events, including changes to demographic and life
history parameters and various types of population size changes. Each individual in the
species has an <italic toggle="yes">x, y</italic> location, a sex, an age (or life-history stage), a
set of phenotypes and a diploid genome consisting of any number of diallelic loci, which
can represent either a contiguous haplotype block or a set of distinct loci. Loci can
exhibit different types of dominance, and recombination rates can be heterozygous across
the genome.</p>
      <p>Phenotypic traits are continuous and quantitative and can be monogenic or multigenic.
Each trait is defined by the loci that comprise its genetic basis, the effect sizes of
those loci, and a phenotypic selection coefficient, which can be made heterogeneous in
both space and time, allowing for spatially complex selection scenarios. While the
strength of selection is determined by that coefficient, the force of selection is
represented by the environmental raster layer to which the trait is adapting. Loci can
have separate mutation rates for three types of mutations: neutral, deleterious, and
trait-affecting mutations. Neutral mutations do not affect fitness, and deleterious
mutations decrease fitness without affecting simulated phenotypic traits. Trait-affecting
mutations, on the other hand, introduce mutations at previously unmutated loci mapped to a
trait. This adds to the genetic variation affecting a trait, thus generating phenotypic
variance upon which natural selection can operate. Mutation rates can be defined
separately for each trait.</p>
      <p>The other core component of a Geonomics model, the landscape, is a stack of raster
layers. Each layer can be set to serve as one or more of 1) a resistance raster, which
controls individual movement or offspring dispersal, 2) a carrying-capacity raster, which
controls population density, and 3) a fitness raster for a trait, which governs natural
selection. A key feature of Geonomics is that each layer can undergo any number of
arbitrarily complex environmental change events which, as they unfold, influence the
dynamics of any species whose carrying capacity, movement and dispersal, or fitness depend
on the corresponding layer.</p>
    </sec>
    <sec>
      <title>Model Operation: Overview</title>
      <p>A Geonomics run begins with a burn-in stage during which individuals move and reproduce,
without genomes or selection, until a series of statistical tests is passed. These tests
include a time-lagged <italic toggle="yes">t</italic>-test and an augmented Dickey–Fuller test, which
are run as a pair for 1) the total population size, serving as a test of temporal
demographic stability, and 2) both the mean and the standard deviation of
timestep-differenced cell-wise counts of individuals, serving as a test of spatial
demographic stability. This burn-in period results in a stationary spatial distribution of
the species on the landscape. Following burn-in, each individual has its genome randomly
assigned according to the genomic architecture parameters, such that the main phase of
each run begins with no pedigree and, thus, without population structure. Each time step
in the main phase is a series of four operations, some optional (<xref rid="msab175-F1" ref-type="fig">fig. 1</xref>):</p>
      <fig position="float" id="msab175-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Operations during the main phase of a Geonomics model run. In the center is a species
on a multilayer landscape that includes a selection layer (above) and a layer for
movement and carrying capacity (below). Surrounding the landscape is a flow-diagram of
the major operations during a time step. Operations in dashed boxes are optional.
During the movement stages (top-left), individuals move along movement vectors drawn
from various distribution options (shown is an example of a cell-specific von Mises
mixture distribution). During the mating stage (top-right), each mating individual
(black circle) randomly chooses a mate (white circle) from all potential mates within
its mating radius (dashed circle). The resulting offspring (half-black, half-white
circle) disperses from its parents' midpoint along a randomly drawn dispersal vector.
During the mortality stage (bottom-right), deaths are modeled as a Bernoulli process,
with the probability of mortality a product of density-dependence and selection on all
traits. During the changes stage (bottom-left), environmental and demographic change
events, which can be represented by a series of change rasters corresponding to
scheduled time steps, take place.</p>
        </caption>
        <graphic xlink:href="msab175f1" position="float"/>
      </fig>
      <list list-type="order">
        <list-item>
          <p>movement (optional);</p>
        </list-item>
        <list-item>
          <p>mating (requisite), which includes mate search, mate choice, offspring creation, and
offspring dispersal;</p>
        </list-item>
        <list-item>
          <p>mortality, which is due to density-dependence (requisite) and natural selection
(optional);</p>
        </list-item>
        <list-item>
          <p>change events (optional), including both environmental and demographic changes.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>Model Operation: Movement</title>
      <p>Movement takes place in continuous space—individuals have <italic toggle="yes">x, y</italic>
coordinates, on either real or simulated landscapes, rather than being arbitrarily
restricted to grid cells or bounded populations. Each individual moves along a vector,
composed of a distance drawn from a Wald distribution and a direction drawn either from a
uniform distribution on the unit circle or from a movement surface—an array of unimodal or
multimodal von Mises distributions derived from a landscape layer that serves as a
resistance surface (sensu <xref rid="msab175-B33" ref-type="bibr">McRae 2006</xref>; <xref rid="msab175-B56" ref-type="bibr">Spear et al. 2010</xref>). On a unimodal movement
surface, each cell is assigned a single von Mises distribution, with mode parameter μ set
to the direction of the highest-valued cell in the 8-cell neighborhood. On a multimodal
surface, each cell’s mixture distribution is a weighted sum of eight such unimodal
distributions, one pointing toward the center of each cell in the 8-cell neighborhood and
with normalized weights equal to the values of the neighboring cells. This approach to
simulating movement generates realistic, anisotropic movement across a heterogeneous
landscape (<xref rid="msab175-F2" ref-type="fig">fig. 2</xref>) while avoiding
time-consuming computational steps, such as repeated searches for minimum-resistance
neighboring cells.</p>
      <fig position="float" id="msab175-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>A raster layer representing a movement surface with example movement histograms for
each cell (left) and a movement track for a sample individual (right). The
circularized histograms represent the movement directions that could be drawn from the
von Mises mixture distribution approximations within each cell. Longer bars in a
histogram indicate higher probability of movement in their direction. The movement
track, plotted with the <italic toggle="yes">gnx.help.param_help.plot_movement</italic> function in
Geonomics, is 5,000 steps long. Both preferential movement toward higher-suitability
regions of the landscape (i.e., cells closer to 1 in value) and occasional
long-distance movements between relatively isolated portions of the landscape are
evident.</p>
        </caption>
        <graphic xlink:href="msab175f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Model Operation: Mating</title>
      <p>Potential mating pairs are randomly drawn from among all eligible pairs of individuals
within the mate-search radius (unless strict nearest-neighbor mating is chosen), with
pairing probabilities either uniform or inverse-distance weighted within the mating
radius, and with eligibility based on both sex and age. From among those pairs, actual
mating-event decisions are Bernoulli distributed, with probability equal to the intrinsic
birth rate. Each mating pair produces a number of offspring according to a fixed value or
drawn from a Poisson distribution with λ equal to the mean number of offspring. Each
parent produces a gamete for each of its offspring, using realistic recombination and
Mendelian segregation. Gametes are united to create offspring individuals, which then
disperse to new locations. As with movement, dispersal vectors can be drawn isotropically
or anisotropically based on a resistance surface.</p>
    </sec>
    <sec>
      <title>Model Operation: Mortality</title>
      <p>Mortality is modeled as a Bernoulli process with the probability of an individual death a
combination of the probabilities of death due to density-dependence (using a
logistic-growth model) and due to natural selection (based on the cumulative fitness for
all traits), calculated as: <disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mrow><mml:msubsup><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula> where <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> is the probability of death due to density-dependence for
individual <italic toggle="yes">i</italic>, <italic toggle="yes">m</italic> is the number of traits, and
<inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the fitness of individual <italic toggle="yes">i</italic> for trait
<italic toggle="yes">p</italic>. The probability of density-dependent death at location
<italic toggle="yes">x,y</italic> is calculated as: <disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>;</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>;</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula> where, for location <italic toggle="yes">x,y</italic>, <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>E</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>;</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> is the expected number of deaths,<inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the population density, <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi>E</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>;</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> is the expected number of births, and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> is the population logistic growth rate. The fitness of
individual <italic toggle="yes">i</italic> for trait <italic toggle="yes">p</italic> is calculated as: <disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:msub><mml:mo>ω</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>;</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>;</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">γ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:msup><mml:mo>,</mml:mo></mml:math></disp-formula> where <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>;</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the phenotypic selection coefficient on trait
<inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mi>p</mml:mi></mml:math></inline-formula> at location <italic toggle="yes">x,y</italic>, <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>;</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the value of the selection layer for trait
<italic toggle="yes">p</italic> at location <italic toggle="yes">x,y</italic>, <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the phenotype of individual <italic toggle="yes">i</italic> for trait
<italic toggle="yes">p</italic>, and γ<sub><italic toggle="yes">p</italic></sub> defines the curvature of the
fitness function for trait <italic toggle="yes">p</italic>. The phenotype is a result of the additive
effects of that individual’s genotypes at all underlying loci, and is calculated as:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></disp-formula> where <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> is the number of loci, <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the effect size of locus <italic toggle="yes">l</italic> on trait
<italic toggle="yes">p</italic>, <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the genotype at locus <italic toggle="yes">l</italic> for individual
<italic toggle="yes">i</italic>, and <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, the baseline genotype, equals 0 for monogenic traits or
0.5 for polygenic traits.</p>
    </sec>
    <sec>
      <title>Model Operation: Change Events</title>
      <p>Each demographic or environmental change event unfolds as a series of incremental changes
that occur at the ends of scheduled time steps. A demographic change event can be
exponential, random, or cyclical, or it can follow an arbitrarily complex, custom
trajectory. Each event is parameterized by defining the time steps at which its changes
take place and the factor by which the carrying capacity raster is multiplied.</p>
      <p>Simple environmental change events are defined by a terminal raster for the final
environmental state and a list of time steps at which incremental changes occur (based on
cell-wise linear interpolation between the beginning and terminal states). More complex,
custom events can be simulated by providing a series of environmental rasters labeled with
the time step at which each will be applied. This option makes it easy to simulate
evolution on real-world landscapes undergoing nonlinear, spatially heterogeneous
environmental change.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Validation</title>
      <p>To validate the performance of Geonomics, we ran a series of simulations based on
classical population genetic models, covering both neutral and nonneutral evolutionary
scenarios. Because the classical models are simpler than the individual-based, spatially
explicit, continuous-movement models built by Geonomics, we parameterized the simulations
so as to accurately emulate these models while minimizing artifacts (see Validation
Testing, Supplementary Material online). Our goal was to statistically and heuristically
validate Geonomics’ full range of functionality and to ensure that it accurately models
neutral and nonneutral evolutionary processes.</p>
      <p>To verify that Geonomics effectively models neutral evolution, we first examined the
average time to fixation for a neutral allele in a finite population using simulations
approximating a Wright-Fisher model (<xref rid="msab175-B10" ref-type="bibr">Fisher
1923</xref>; Wright 1930). We simulated allele-frequency trajectories for 250
independent loci (25 of which are plotted in supplementary fig. S1, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online), and
we found that that fixation time did, indeed, increase with population size and was
proportional to 4N<sub>e</sub>, as expected (Kimura and Ohta 1969), in our simulations
(<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S2</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online). We
then tested for changes in the rate of drift surrounding a population bottleneck event by
forcing a population to undergo a 70% reduction in size for 50 of 300 timesteps. We found
that rates of allele frequency change increased during the bottleneck, then returned to
prior levels shortly thereafter (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S3</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online). Finally, we quantified the accumulation of
genetic structure under a stepping-stone model (Kimura 1953) to certify that genetic
covariance decreases with distance (Kimura and Weiss 1964). As expected, we saw that
migration rates decreased as a function of inter-island distance (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S4</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online),
whereas F<sub>ST</sub>, calculated from both heterozygosity data and genetic variance
data, increased as a function of inter-island distance (and, therefore, decreased with
pairwise migration rate) and as a function of time (<xref rid="sup1" ref-type="supplementary-material">supplementary figs. S4 and S5</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online). We
also performed a discriminant analysis of principal components (DAPC) using the R package
<italic toggle="yes">adegenet</italic> (<xref rid="msab175-B23" ref-type="bibr">Jombart et al.
2010</xref>) to confirm the expected population structure of six island clusters (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S6</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online).</p>
      <p>To validate the performance of Geonomics for modeling nonneutral evolution, we first
performed simulations under a simple scenario of divergent selection between two discrete
habitats. As expected, simulations on a landscape evenly divided by two habitat blocks led
to local adaptation, producing a significant pattern of phenotype-habitat matching (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S7</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online), with
mismatches concentrated along the border between habitats. Additionally, over time, the
species reached migration–selection equilibrium—the frequencies of the beneficial alleles
in each habitat increased up to a stationary level, with that level being positively
correlated with the strength of selection (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S8</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online). A plot of the mean difference between
individuals’ phenotypic and environmental values shows a strong decline over model time,
with the rate and level of decline increasing as a function of increasing strength of
selection (<xref rid="sup1" ref-type="supplementary-material">supplementary fig.
S9</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary
Material</xref> online). Finally, logistic regressions show no significant relationships
between phenotypic and environmental values at the outset
(pseudo-<italic toggle="yes">R</italic><sup>2</sup>s ≈ 0.0, <italic toggle="yes">P</italic> values &gt; 0.1), but
show highly significant relationships at the ends of the simulations
(<italic toggle="yes">P</italic> &lt; 0.0001 for all values of Φ), with the amounts of variation
explained increasing as a function of selection strength
(pseudo-<italic toggle="yes">R</italic><sup>2</sup> = 0.327 for Φ = 0.01, 0.376 for Φ = 0.05, and
0.406 for Φ = 0.1).</p>
      <p>We next tested the ability of Geonomics to recreate the genetic structure expected under
local adaptation along an environmental cline: monotonic change in the allele frequency of
a nonneutral locus across the cline. On a landscape with a symmetric environmental
selection gradient, Geonomics again produced the expected spatial pattern of local
adaptation (<xref rid="sup1" ref-type="supplementary-material">supplementary fig.
S10</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary
Material</xref> online), and when we fitted sigmoid <italic toggle="yes">tanh</italic> clines (<xref rid="msab175-B58" ref-type="bibr">Szymura and Barton 1986</xref>; <xref rid="msab175-B45" ref-type="bibr">Porter 2013</xref>) for all loci, the locus underlying the monogenic
trait was the only one to exhibit clinal variation (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S11</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online). In a
family of genotype-environment analyses using Bonferroni-corrected, locus-wise logistic
regressions, this locus was also the most significantly correlated with the environmental
variable based on locus-wise logistic regressions (<italic toggle="yes">P</italic> &lt; 0.0001). A plot
of the mean difference between individuals’ phenotypic and environmental values shows a
strong decline over model time (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S12</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online), and logistic regressions show no significant
relationship between phenotypic and environmental values at the outset
(pseudo-<italic toggle="yes">R</italic><sup>2</sup> = 0, <italic toggle="yes">P</italic> value = 0.812) but a
significant relationship at the end of the simulation
(pseudo-<italic toggle="yes">R</italic><sup>2</sup> = 0.169, <italic toggle="yes">P</italic> value &lt;
0.0001).</p>
      <p>Finally, we verified that Geonomics can effectively model genomic data with physical
linkage by simulating a selective sweep, introducing a beneficial mutation at the center
of a 101-locus block of otherwise neutral loci. The results exhibited the classic genomic
signal of a selective sweep (<xref rid="msab175-B63466762" ref-type="bibr">Przeworski
2002</xref>; <xref rid="msab175-B092919" ref-type="bibr">Kim and Nielsen 2004</xref>),
with a region of reduced nucleotide diversity surrounding the locus under selection and
that region gradually eroding over time (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S12</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online). During these simulations, as the
beneficial mutant spread through the population the population’s mean fitness increased
from 1 − Φ (where Φ is the strength of selection) to a saturating value of 1 (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S14</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online),
confirming that the population dynamics of the selective sweep played out as expected. To
further support these results, we also validated Geonomics’ method of recombination by
examining effective recombination rates observed in a Geonomics model to those produced by
an msprime simulation using the same randomly drawn, heterogeneous recombination map (see
Recombination Test, <xref rid="sup1" ref-type="supplementary-material">Supplementary
Material</xref> online); the resulting genome-wide pattern of recombination breakpoint
densities recapitulates the one produced by msprime and the true recombination map (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S15</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online).</p>
    </sec>
    <sec>
      <title>Example Applications: Overview</title>
      <p>To demonstrate the broad utility of Geonomics for modeling complex evolutionary
scenarios, we performed a series of simulations covering a range of potential
applications. These demonstrations highlight scenarios for which Geonomics is particularly
well suited, including spatially explicit simulations on highly heterogeneous landscapes,
selection on multiple traits with complex genomic architecture, and microevolutionary
responses to nonstationary environmental change.</p>
    </sec>
    <sec>
      <title>Example 1: Isolation by Distance and by Environment</title>
      <p>Genetic covariances between individuals or populations are often inversely correlated
with linear or resistance-based geographic distance—a pattern known as isolation by
distance (IBD; <xref rid="msab175-B66" ref-type="bibr">Wright 1943</xref>) or isolation by
resistance (IBR; <xref rid="msab175-B33" ref-type="bibr">McRae 2006</xref>; <xref rid="msab175-B34" ref-type="bibr">McRae et al. 2008</xref>)—or with environmental
distance—a pattern known as isolation by environment (IBE; <xref rid="msab175-B64" ref-type="bibr">Wang and Bradburd 2014</xref>). Understanding the landscape factors
and population processes generating these patterns has emerged as a major focus of
landscape genetics (<xref rid="msab175-B55" ref-type="bibr">Sexton et al. 2014</xref>;
<xref rid="msab175-B64" ref-type="bibr">Wang and Bradburd 2014</xref>).</p>
      <p>To demonstrate how Geonomics can simultaneously generate patterns of IBD and IBE, we
built a simulation that uses a heterogeneous resistance layer as a movement surface and
models selection for a 10-gene trait on a heterogeneous environmental layer
(<italic toggle="yes">Φ</italic> = 0.05). The model features a species with a stationary population
size (roughly 2,450 individuals), experiencing both selection and neutral evolution. The
resistance layer consists of a central barrier separating equal-area sides—the barrier has
a high resistance to movement, but the movement is unconstrained on either side. This
layer was also used as the carrying-capacity layer, yielding homogeneous population
density on the two sides and zero density within the barrier region. The selection layer
consists of two environmental gradients running in opposite directions on either side of
the barrier, such that the landscape contains pairs of locations representing a range of
combinations of geographic and environmental distances.</p>
      <p>To observe the development of population structure, we collected data sets consisting of
the genomes for all individuals at timesteps 0 and 1,000. We then used principal component
analysis (PCA) to calculate pairwise genetic distances between all individuals for each
data set. To visualize population structure, we extracted the first three principal
components (PCs) and used them as the red, green, and blue (RGB) color values for mapping
individuals on the landscape. To visualize the outcomes of selection, we produced paired
maps of the same individuals colored by their phenotypes for the trait under selection
(using Geonomics’ “model.plot_phenotype(…)” method), and also created a set of the
population–structure plots using DAPC. To visualize the time course of the simulation, we
plotted the mean phenotype–environment mismatch (i.e., the mean of |e-z|, the driving
force of selection) and mean fitness. We visualized signals of IBD and IBE in the final
data set using a 3D scatterplot of Euclidean pairwise genetic distance against Euclidean
pairwise geographic and environmental distances, colored by pairwise phenotypic distances.
We tested the significance of the relationship between genetic distance and environmental
distance, controlling for geographic distance, using paired partial Mantel tests with the
<italic toggle="yes">vegan</italic> package (version 2.5-6; <xref rid="msab175-B38" ref-type="bibr">Oksanen et al. 2019</xref>) and using multiple matrix regression (MMRR; <xref rid="msab175-B63" ref-type="bibr">Wang 2013</xref>) in R version 4.0.2 (<xref rid="msab175-B47" ref-type="bibr">R Core Team 2020</xref>). Finally, because Geonomics
models do not use defined landscape-resistance values, we quantified the barrier’s
increased landscape resistance by tracking all barrier-crossing events, using them to
calculate the per time step crossing rate, then comparing that to the equivalent crossing
rate of the same landscape zone in an otherwise identical model that omitted the
barrier.</p>
      <p>The RGB and phenotype plots of the initial population, with randomly assigned genomes,
showed a clear lack of both spatial structure and local adaptation (<xref rid="msab175-F3" ref-type="fig">fig. 3</xref>, top left). However, as expected, spatial structure
developed over time, and the species showed signs of local adaptation over the course of
the simulation (<xref rid="msab175-F3" ref-type="fig">fig. 3</xref>, top right), as well
as a corresponding, hierarchical population structure (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S15</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online).
Average phenotype-environment mismatch decreased and average fitness increased over time
(<xref rid="msab175-F3" ref-type="fig">fig. 3</xref>, top middle). At the end of the
simulation, the species demonstrated significant signals of both IBD (partial Mantel test:
<italic toggle="yes">r</italic> = 0.560, <italic toggle="yes">P</italic> ≤ 0.001; MMRR:
<italic toggle="yes">P</italic> ≤ 0.001) and IBE (partial Mantel test: <italic toggle="yes">r</italic> = 0.121,
<italic toggle="yes">P</italic> ≤ 0.001; MMRR: <italic toggle="yes">P</italic> ≤ 0.001; MMRR full model
<italic toggle="yes">R</italic><sup>2</sup> = 0.354), as evidenced by the positive slopes on both
horizontal axes of the 3D scatterplot (<xref rid="msab175-F3" ref-type="fig">fig.
3</xref>, bottom). The colors of the points in the 3D scatter plot also indicate a clear
pattern of increasing phenotypic differences between individuals with increasing
environmental distance (<xref rid="msab175-F3" ref-type="fig">fig. 3</xref>, bottom right)
but not between individuals separated by increasing geographic distances (<xref rid="msab175-F3" ref-type="fig">fig. 3</xref>, bottom left). Finally, the barrier zone
had an observed crossing rate of 0.004 individuals per time step in this model, 13 times
lower than the rate of 0.052 individuals per time step observed in the barrier-less but
otherwise identical model. These results show that Geonomics effectively models IBD and
IBE, driven by divergent natural selection, using two simple raster layers. More complex
layers could be used to simulate IBD and IBE under a wide range of scenarios, and
empirical layers could be used to simulate patterns of spatial genetic variation on
real-world landscapes.</p>
      <fig position="float" id="msab175-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Results of simulations for the isolation by distance (IBD) and isolation by
environment (IBE) example application, in which a species evolved on a landscape with
a barrier layer that served as the movement surface (displayed as a vertical gray band
down the landscape) and an environmental layer that served as the selective surface
for a 10-locus trait (displayed as the red to blue gradient on the landscape).
(<italic toggle="yes">A</italic>) The population before the simulation (left column) and after it
(right column), colored by genetic distance (top row), with colors derived from scores
on the first three PCs of a genetic PCA used to assign RGB values, and by phenotype
(bottom row). The most-fit individuals are those whose phenotypic colors perfectly
match the cells on which they are located. (<italic toggle="yes">B</italic>) The time courses of
the mean difference between individuals’ phenotypes and their environmental values
(blue) and of mean fitness values (red). (<italic toggle="yes">C</italic>) Two views of a 3D
scatter plot of pairwise genetic distance as a function of Euclidean geographic
distance (left) and Euclidean environmental distance (right), with points colored by
phenotypic distance.</p>
        </caption>
        <graphic xlink:href="msab175f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Example 2: Simultaneous Election</title>
      <p>One of the most powerful features of Geonomics is that it can simulate selection on
numerous traits simultaneously, each responding to a separate selection layer. Thus, a
simulated species can experience multiple spatial selection regimes. Many natural systems
are locally adapted to multiple environmental variables (<xref rid="msab175-B11" ref-type="bibr">Fournier-Level et al. 2011</xref>; <xref rid="msab175-B29" ref-type="bibr">Lasky et al. 2012</xref>; <xref rid="msab175-B31" ref-type="bibr">Manel et al. 2012</xref>), so simulating these scenarios could be broadly valuable for
investigating the nature of local adaptation in real environments.</p>
      <p>To demonstrate how Geonomics can model simultaneous selection, we simulated a scenario in
which a species undergoes natural selection along two orthogonal environmental gradients,
each driving selection for a separate trait (Φ = 0.05). Each trait had values ranging from
0 to 1, determined by 10 loci, all with equal effect sizes. Individuals had a mean
movement distance of 0.5 cell widths on a 50 × 50-cell landscape, chosen to limit gene
flow and allow for the development of strong spatial structure and, thus, the potential
for local adaptation. We let the system evolve for 1,000 time steps and then mapped the
species on each of the environmental layers, with individuals colored by phenotype in
order to visually evaluate whether individual phenotypes matched their environmental
backgrounds. The results showed clear patterns of phenotype–environment matching along
both independent gradients (<xref rid="msab175-F4" ref-type="fig">fig. 4</xref>) that
evolved steadily through time (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S16</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online; compare to <xref rid="sup1" ref-type="supplementary-material">supplementary figs. S17 and S18</xref>,
<xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online,
with Φ = 0), indicating strong evidence for simultaneous selection across the simulated
landscape.</p>
      <fig position="float" id="msab175-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Results of simultaneous selection on two traits with spatially distinct selective
regimes. Each trait is controlled by 10 unlinked loci and has a selection coefficient
of Φ = 0.05. Individuals are colored by phenotype for the trait under selection on
each layer.</p>
        </caption>
        <graphic xlink:href="msab175f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Example 3: Polygenic Adaptation to Climate Change in the Yosemite Region</title>
      <p>Better understanding evolutionary responses to changing environments is essential for
predicting species outcomes and preserving biodiversity under ongoing climate change
(<xref rid="msab175-B21" ref-type="bibr">Hoffmann and Sgrò 2011</xref>; <xref rid="msab175-B12" ref-type="bibr">Franks and Hoffmann 2012</xref>; <xref rid="msab175-B3" ref-type="bibr">Bay et al. 2018</xref>; <xref rid="msab175-B5" ref-type="bibr">Capblancq et al. 2020</xref>). In many regions, climate shifts are projected to be
spatially heterogeneous, including in montane regions where cooler, higher-altitude areas
are warming more quickly than warmer, low-altitude regions (<xref rid="msab175-B48" ref-type="bibr">Rangwala et al. 2013</xref>; <xref rid="msab175-B36" ref-type="bibr">Mountain Research Initiative EDW Working Group 2015</xref>; but see <xref rid="msab175-B39" ref-type="bibr">Oyler et al. 2015</xref>). Of particular interest
under these scenarios is the ability of species to adapt to changing local conditions
(<xref rid="msab175-B12" ref-type="bibr">Franks and Hoffmann 2012</xref>).</p>
      <p>To demonstrate the utility of Geonomics for studying microevolutionary responses to
climate change, we simulated the response to projected climate change of a continuously
distributed, locally adapted species, using the sagebrush lizard (<italic toggle="yes">Sceloporus
graciosus</italic>) in the topographically complex Yosemite National Park region of
California (USA) as an empirical model. To model climate change, we assembled time series
raster stacks of projected mean annual temperature, annual precipitation, and habitat
suitability for 19 even time steps from the present through the year 2100. For present
temperature and precipitation, we used PRISM data (<xref rid="msab175-B7" ref-type="bibr">Daly et al. 2008</xref>), calculated as 30-year normals for 1981–2010 at 800 m
resolution. For future years, we used means at a set of 5-year intervals (2015–2100),
downscaled to 6 km resolution using the localized constructed analogs downscaling
technique (LOCA; <xref rid="msab175-B44" ref-type="bibr">Pierce et al. 2014</xref>), from
the Cal-Adapt database (<ext-link xlink:href="https://cal-adapt.org/" ext-link-type="uri">https://cal-adapt.org/</ext-link>). We calculated means of both variables from their
minima and maxima observed across 32 global climate models, using a conservative
representative concentration pathway (RCP 4.5). We developed time series of future
temperature and precipitation layers at 800-m resolution by 1) calculating the raster
difference between the first projected year and the current data, aggregated to the
projected data’s resolution; 2) adding that difference to the current data, such that each
cell in the current data received the difference of the coarser, projected cell within
which it lay; and 3) repeating that process for all remaining years. All data preparation
was done using custom scripts (Supplementary Material online) in R (<xref rid="msab175-B47" ref-type="bibr">R Core Team 2020</xref>). </p>
      <p>For the habitat suitability rasters, we constructed a species distribution model (SDM)
using the present-day temperature and precipitation variables. We downloaded all
georeferenced <italic toggle="yes">S. graciosus</italic> occurrence data from the Global Biodiversity
Information Facility database (<ext-link xlink:href="http://www.gbif.org" ext-link-type="uri">www.gbif.org</ext-link>), using the
<italic toggle="yes">gbif</italic> function in the <italic toggle="yes">dismo</italic> R package (<xref rid="msab175-B19" ref-type="bibr">Hijmans et al. 2017</xref>). We clipped the points to
California and Nevada, then subsampled the full data set to remove multiple points within
the same raster cells. We generated pseudoabsence data by drawing random points from all
cells in the California-Nevada region where the species was not observed (following the
recommendations of <xref rid="msab175-B1" ref-type="bibr">Barbet‐Massin et al.
2012</xref>). We extracted the current temperature and precipitation data at these points
and used them as predictor variables in a binomial generalized linear model (GLM) with a
logit link. We then projected that GLM onto the current and future temperature and
precipitation rasters for our study region, producing a time series of predicted habitat
suitability. </p>
      <p>We generated the simulation’s parameters file using the code provided in Code Sample S1,
then edited the parameter values therein as needed. To simulate the nonneutral evolution
of a polygenic, quantitative trait, we set the trait to be underlain by 100 loci randomly
distributed across a genome of 1,000 loci and set a strength of selection of Φ = 0.5. We
set other life-history and demographic parameters (carrying capacity, age at reproductive
maturity, number of offspring per individual, and maximum age) to reasonable values based
on <italic toggle="yes">S. graciosus</italic> natural history (<xref rid="msab175-B57" ref-type="bibr">Stebbins 1948</xref>; <xref rid="msab175-B59" ref-type="bibr">Tinkle 1973</xref>; <xref rid="msab175-B50" ref-type="bibr">Rose 1976</xref>; <xref rid="msab175-B51" ref-type="bibr">Ruth 1978</xref>; <xref rid="msab175-B60" ref-type="bibr">Tinkle et
al. 1993</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary
Material</xref> online).</p>
      <p>We ran the main phase for 500 time steps without climate change (to develop a pattern of
local adaptation), then ran an additional 100 time steps (years) with changing climate
(see Code Sample S2). At time steps 500 (before the initiation of climate change events)
and 600 (after completion of climate change events), we plotted the current temperature
and habitat-suitability landscape layers along with a kriged surface of the current
population’s phenotypes and a kernel density map of the current population’s density, two
key emergent properties of the model that should be driven by temperature and habitat
suitability, respectively. We then ran the model for an additional 50 timesteps to be able
to more clearly visualize the effect of climate change on population size.</p>
      <p>The model generated a clear and realistic pattern of adaptation to the spatial
temperature gradient in the Yosemite region after the 500 iterations following burn-in,
and that pattern demonstrated a spatial shift in phenotypes that aligns clearly with the
spatial shift in temperature under the simulated climate change scenario (<xref rid="msab175-F5" ref-type="fig">fig. 5<italic toggle="yes">A</italic></xref>, rows 1 and 2; Video 1,
<xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>
online). The model also generated a spatial pattern of population density that clearly
aligns with spatial variation in habitat suitability prior to the onset of climate change
that likewise shifted as expected in response to the climate change-induced shift in
habitat suitability (<xref rid="msab175-F5" ref-type="fig">fig.
5<italic toggle="yes">A</italic></xref>, rows 3 and 4). We observed demographic changes in response to
climate change over the course of the simulation as well. After climate change, mean
population size was reduced by roughly 16.8% (from about 255,500 to 212,500 individuals),
in line with the 17.9% reduction in the carrying capacity layer derived from the habitat
suitability rasters (from 337,089.0 to 276,742.8 individuals, according to sums of the
pre- and post-change carrying capacity layers). The population also exhibited sizable
fluctuations during the climate change period, with oscillations exceeding 60,000
individuals (roughly 23.5% of the pre-change mean population size; <xref rid="msab175-F5" ref-type="fig">fig. 5<italic toggle="yes">B</italic></xref>). We interpret this as a result of the
stepwise environmental changes comprising the climate change event. Each change causes a
shift in the optimum phenotypes of local populations, leading to increased maladaptation
and thus increased mortality rates. Subsequent reductions in density-dependent mortality
rates because of these reduced population densities, paired with adaptation by natural
selection, then reduce overall mortality rates, leading to rebounds in population size,
with stochastic movement into and out of local populations, along with other sources of
model stochasticity, imposing noise on this oscillatory behavior. Overall, these results
show how Geonomics can effectively simulate organismal responses to highly complex
environmental scenarios and reveal that these simulations can uncover system behavior that
could provide avenues for future investigation.</p>
      <fig position="float" id="msab175-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Polygenic adaptation to climate change in the Yosemite region. (<italic toggle="yes">A</italic>)
Hillshade plot comparisons of key variables (mean temperature, phenotype, habitat
suitability, and population density) before and after the simulated climate change
event. The mean of each variable through time is used to draw midvalue contours on
each map (white lines) to help visualize spatial change. As expected, the
spatiotemporal shift in temperature (first row) drives a spatially corresponding shift
in phenotypes, visualized as a surface kriged from all phenotypic values (second row),
and the shift in habitat suitability (third row) likewise drives a corresponding shift
in population density, visualized using a 2D kernel density estimator (fourth row).
(<italic toggle="yes">B</italic>) The time course of population size. The early drop in
population size results from the onset of natural selection after completion of the
unplotted burn-in portion of the model. The oscillations and ultimate reduction at the
end of the simulation are a result of the climate change event, which occurs during
the period bracketed by vertical red lines.</p>
        </caption>
        <graphic xlink:href="msab175f5" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>Our validations tests demonstrate that Geonomics simulates molecular evolution in
concordance with predictions from theoretical population genetics (<xref rid="msab175-B10" ref-type="bibr">Fisher 1923</xref>; <xref rid="msab175-B66" ref-type="bibr">Wright
1943</xref>; Kimura; <xref rid="msab175-B58" ref-type="bibr">Szymura and Barton
1986</xref>), including dynamics of genetic drift, migration, and selection along clines,
and our example applications show that Geonomics is capable of generating accurate and
realistic population and landscape genomic data sets under scenarios of varying complexity.
Geonomics is embedded in Python (<xref rid="msab175-B61" ref-type="bibr">van Rossum
1995</xref>; <xref rid="msab175-B46" ref-type="bibr">Python Software Foundation
2019</xref>), one of the most popular programming languages and one already familiar to
many researchers who use bioinformatics. It makes the creation of arbitrarily complex models
quick and easy, without even requiring prior Python experience, yet provides advanced users
with access to core data structures, enabling broad customization and extension.</p>
    <p>Many theoretical questions in population genomics necessitate explicitly spatial study
methods, often with full tracking of a population’s spatial pedigree (<xref rid="msab175-B4" ref-type="bibr">Bradburd and Ralph 2019</xref>). Geonomics makes this work more tractable
than ever before. Landscape genomics studies draw conclusions about complex, real-world
systems, sometimes with direct implications for conservation and management (<xref rid="msab175-B8" ref-type="bibr">Epperson et al. 2010</xref>; <xref rid="msab175-B28" ref-type="bibr">Landguth et al. 2012</xref>). Geonomics not only enables the generation
of simulated data sets specific to such study systems but will also aid the development and
testing of analytical methods in landscape genomics, strengthening our ability to draw
accurate and reliable inferences from real-world data.</p>
    <sec>
      <title>Runtime and Memory</title>
      <p>Geonomics models run more slowly and have steeper memory limitations than models written
and optimized in compiled languages, such as SLiM (<xref rid="msab175-B35" ref-type="bibr">Messer 2013</xref>; <xref rid="msab175-B16" ref-type="bibr">Haller and Messer
2017</xref>; <xref rid="msab175-B17" ref-type="bibr">Haller and Messer 2019</xref>).
However, for users whose scenarios are well served by the design and affordances of
Geonomics, what is sacrificed in runtime will be made up for in flexibility,
customizability, and ease of use. With a reasonably powerful computer and for moderately
sized models, most users should not find runtime or memory a major limitation. Indeed, our
first two example applications were run on a laptop computer with 8 GB of RAM and an
Intel<sup>®</sup> Core™ i5-8250U 3.4 GHz quad-core processor. Each run took an average
of 271 s (about 0.27 s per time step) for the IBD-IBE model and 144 s (roughly 0.14 s per
time step) for the simultaneous selection model. Because the polygenic adaptation example
has much higher complexity, approximating the high population density of a small
vertebrate, we ran it on a regular-memory node of a computing cluster (the
<italic toggle="yes">savio3</italic> partition of UC Berkeley’s Savio system) with 96 GB RAM and
2.1 GHz Skylake processors in order to handle the larger memory requirement. This model
took considerably longer to run (approximately 7.35 h, running at about 32 s per time step
after time for upfront computation of a series of changing movement surfaces) and had a
peak memory usage of 25.433 GB, but even highly complex scenarios like this remain
tractable on reasonable research timelines.</p>
      <p>Given the complexity of Geonomics and the number of parameters a user can modify,
numerous parameters and parameter combinations can influence a model’s average runtime. We
provide a basic runtime analysis (<xref rid="msab175-F6" ref-type="fig">fig. 6</xref>),
run on the same 8 Gb, quad-core laptop as the examples above. This analysis highlights
some basic parameters that are likely to influence a model’s average runtime per time
step, including the mean population size (as determined by an array of local carrying
capacities), the number of offspring per mating event, the size of the landscape, and the
number of nonneutral loci in the genome. The effect of landscape size predominates, as
runtime scales superlinearly with this parameter. The number of nonneutral loci actually
has only slight effects on total runtime, and because neutral genetic data are stored in a
set of tables rather than redundantly for each individual (<xref rid="msab175-B25" ref-type="bibr">Kelleher et al. 2018</xref>) runtime is even less sensitive to the
number of neutral loci in the genome (although recombination rate does impact runtime and
memory usage), meaning that Geonomics can efficiently simulate genome-scale data sets if
provided adequate memory to store the set of recombination pathways that is calculated at
the outset. Finally, after the upfront cost of computing recombination pathways and
movement surfaces, runtime scales roughly linearly with the number of time steps, barring
large demographic changes. That means that the moderately complex scenario in our
simultaneous selection example could complete 1,000,000 time steps in approximately 40 h,
and even the highly complex scenario in our polygenic adaptation example with more than
200,000 individuals could run through 10,000 generations in about 3.7 days. Hence,
Geonomics could even prove useful for research at deeper timescales, for example in
phylogeography or geogenomics (<xref rid="msab175-B67" ref-type="bibr">Baker et al.
2014</xref>).</p>
      <fig position="float" id="msab175-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Average runtime as a function of four major parameters: the number of nonneutral loci
(<italic toggle="yes">n_loci</italic>), the carrying-capacity constant (<italic toggle="yes">K</italic>) that
determines mean population size, landscape size (<italic toggle="yes">dim</italic>), and the λ
parameter of the Poisson distribution from which the number of offspring in each
mating event is drawn (<italic toggle="yes">lambda</italic>). Runtime increases with landscape
dimension both because of functions whose runtimes scale with the landscape size
directly and because of functions whose runtime scales with total population size. The
difference between the lines for <italic toggle="yes">K</italic> and <italic toggle="yes">dim</italic> can be
taken as an indication of the runtime cost of landscape dimension above and beyond
population size effects, which predominates because it is superlinear.</p>
        </caption>
        <graphic xlink:href="msab175f6" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Caveats</title>
      <p>Geonomics uses two unconventional approximations to make complex models tractable within
reasonable compute time in an interpreted language. The first is the approximation used to
model heterogeneous recombination. Enacting recombination between all neighboring loci
each time a gamete is produced would require an extremely large and time-consuming number
of random draws. To avoid this, when a model is first created, Geonomics generates and
saves, as binary arrays, a large collection of recombination “paths.” The number of paths
used is set by the user, and directly determines the minimum recombination rate difference
that can be modeled. Each path is just a genome-length array that switches between 0 and 1
at each interlocus position where a recombination event should occur. The path can then
quickly be used to subset an individual’s genome, producing a gamete. As a model runs and
gametes are continually produced, these paths are repeatedly shuffled and drawn through,
like a deck of cards during multiple rounds of a game. This approach, which we have
validated using msprime (see Recombination Test, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online), can lead to memory limitations for
models with a large number of paths and a long genome, because the data structure
containing the paths is essentially a 2D binary array whose size is the product of these
values and because more recombination events require that more trees are recorded in the
spatial pedigree. To avoid these problems, for genomic architectures with homogeneous
recombination rates, Geonomics provides the option to use an alternative recombination
mechanism that simulates recombination on the fly for each new gamete but does so at a
cost of increased average runtime per time step.</p>
      <p>The second is the approximation used to model the circular distributions from which
movement directions are drawn. Conceptually, a movement or dispersal surface is an
<inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mi>x</mml:mi><mml:mo>×</mml:mo><mml:mi>y</mml:mi></mml:math></inline-formula> array of Von Mises distributions. In practice, each
distribution on that surface is represented by a column of angular directions (an
“approximation column”) drawn, at the time the model is built, from the true, continuous
distribution. During a model run, to draw a movement direction from a cell, a random value
is sampled from that cell’s approximation column. This increases computational efficiency
by avoiding large numbers of calls to random number generators during runtime. The
accuracy of these approximation columns is a function of their length, which is set by the
user. This length will usually not be so constrained that it significantly impacts the
accuracy of the approximation, but such a constraint could arise if the movement or
dispersal surface undergoes environmental change. In this case, the movement surfaces
corresponding to each step of the change event will be generated and stored when the model
is first created, and the series of arrays produced could exhaust memory if the landscape
is very large and has many environmental change steps. A solution to this problem would
feature some combination of decreasing the temporal resolution of the environmental change
event, decreasing the landscape size, or decreasing the approximation column length. In
all cases, users may check the accuracy of modeled movement by using built-in functions
that visualize the composition and behavior of movement and dispersal surfaces.</p>
    </sec>
  </sec>
  <sec>
    <title>Materials and Methods</title>
    <p>We performed all simulations using the Geonomics Python package (see New Approaches) as
described in the Results section and Supplementary Material. The simplest way to get started
with Geonomics is to install it via pip. Geonomics uses common, well-established Python
packages as required dependencies—Numpy (<xref rid="msab175-B18" ref-type="bibr">Harris et
al. 2020</xref>), Matplotlib (<xref rid="msab175-B22" ref-type="bibr">Hunter 2007</xref>),
Pandas (<xref rid="msab175-B32" ref-type="bibr">McKinney et al. 2010</xref>), Shapely (<xref rid="msab175-B13" ref-type="bibr">Gillies et al. 2007</xref>), Scipy (<xref rid="msab175-B62" ref-type="bibr">Virtanen et al. 2020</xref>), Scikit-learn (<xref rid="msab175-B40" ref-type="bibr">Pedregosa et al. 2011</xref>), Statsmodels (<xref rid="msab175-B54" ref-type="bibr">Seabold and Perktold 2010</xref>), Rasterio (<xref rid="msab175-B14" ref-type="bibr">Gillies et al. 2019</xref>), Bitarray (<xref rid="msab175-B53" ref-type="bibr">Schnell et al. 2021</xref>), msprime (<xref rid="msab175-B24" ref-type="bibr">Kelleher et al. 2016</xref>), and tskit (<xref rid="msab175-B25" ref-type="bibr">Kelleher et al. 2018</xref>)—and offers optional
integration of neutral landscape models through the NLMpy package (<xref rid="msab175-B9" ref-type="bibr">Etherington et al. 2015</xref>). The source code is publicly available on
GitHub (<ext-link xlink:href="https://github.com/drewhart/geonomics" ext-link-type="uri">https://github.com/drewhart/geonomics</ext-link>), where it is actively maintained and
developed.</p>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>Geonomics is a Python package designed to make building and running complex landscape
genomic models quick and simple. At the same time, it provides a flexible scripting
framework that allows advanced users to customize and extend its functionality. We believe
Geonomics will prove highly useful for theoretical, empirical, methodological, and applied
research in population and landscape genomics, molecular ecology, global change biology, and
conservation.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available
at <italic toggle="yes">Molecular Biology and Evolution</italic> online.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>msab175_Supplementary_Data</label>
      <media xlink:href="msab175_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>We thank G. Bradburd, T. Dawson, N. Fefferman, M. Fitzpatrick, J. Frederick, N. Graham, M.
Kelly, M. McElroy, R. Nielsen, T. O’Connor, D. O’Sullivan, C. Small, E. Westeen, N.
Whiteman, G. Wogan, and M. Yuan for feedback and guidance on various iterations of the model
that became Geonomics. We also thank I. R. Wang, B. Xu, J. Zhao for contributing to the
Python code in its early stages and Berkeley Research Computing for access to the Savio
computing cluster. Lastly, we thank M. Terasaki, C. Hart, G. Hart, J. Hart, and M. Tylka for
supporting and encouraging a lifetime of curiosity about nature, and C. Adderly, K. Cobain,
C. Debussy, L. Hill, S. Jeffes, N. Jones, G. R. Sessions, and T. Yorke for their continual
company during many long hours of programming. This work was supported by a Berkeley
Fellowship (to D.E.T.H.) and National Science Foundation grant DEB-1845682 (to I.J.W.).</p>
    <sec>
      <title>Author Contributions</title>
      <p>D.E.T.H. conceived and wrote the software, validations, and example applications, with
contributions from I.J.W. D.E.T.H. co-wrote the manuscript and performed analyses. A.P.B.
co-wrote the manuscript and contributed analyses. I.J.W. co-wrote the manuscript.</p>
    </sec>
    <sec sec-type="data-availability">
      <title>Data Availability</title>
      <p>Geonomics is installable from the Python Package Index (<ext-link xlink:href="https://pypi.org/project/geonomics/" ext-link-type="uri">https://pypi.org/project/geonomics/</ext-link>) using pip, and the Geonomics source
code is available in the Geonomics GitHub repository (<ext-link xlink:href="https://github.com/drewhart/geonomics" ext-link-type="uri">https://github.com/drewhart/geonomics</ext-link>). Parameterizations for all
simulations run for this study are stored in their respective directories in the source
code repository, and other associated data (e.g., raster layers) are available in the
./data directory of a local Geonomics installation. Ancillary code used for the
preparation of simulations and execution of analyses for this paper live in a separate
GitHub repository (<ext-link xlink:href="https://github.com/drewhart/geonomics_methods_paper_ancillary_code" ext-link-type="uri">https://github.com/drewhart/geonomics_methods_paper_ancillary_code</ext-link>).
Validations tests can be run using the code provided in the respective directories in the
source code repository. Demo simulations can be run by loading the Geonomics package into
Python and then calling the run_demo function (e.g., “import geonomics as gnx;
gnx.run_demo(‘IBD IBE’)”). Using those materials, readers can reproduce stochastically
varying but qualitatively equivalent results as those presented in this article.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References </title>
    <ref id="msab175-B67">
      <mixed-citation publication-type="journal">Baker PA, Fritz SC, Dick CW, Eckert AJ, Horton
BK, Manzoni S, Ribas CC, Garzione CN, Battisti DS. 2014. The emerging field of
geogenomics: Constraining geological problems with genetic data. <italic toggle="yes">Earth-Sci
Rev</italic>. 135:38–47.</mixed-citation>
    </ref>
    <ref id="msab175-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barbet-Massin</surname><given-names>M</given-names></string-name>, <string-name><surname>Jiguet</surname><given-names>F</given-names></string-name>, <string-name><surname>Albert</surname><given-names>CH</given-names></string-name>, <string-name><surname>Thuiller</surname><given-names>W.</given-names></string-name></person-group><year>2012</year>. <article-title>Selecting pseudo-absences for species distribution
models: how, where and how many?</article-title><source>Methods Ecol Evol</source>.
<volume>3</volume>(<issue>2</issue>):<fpage>327</fpage>–<lpage>338</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barrett</surname><given-names>RDH</given-names></string-name>, <string-name><surname>Laurent</surname><given-names>S</given-names></string-name>, <string-name><surname>Mallarino</surname><given-names>R</given-names></string-name>, <string-name><surname>Pfeifer</surname><given-names>SP</given-names></string-name>, <string-name><surname>Xu</surname><given-names>CCY</given-names></string-name>, <string-name><surname>Foll</surname><given-names>M</given-names></string-name>, <string-name><surname>Wakamatsu</surname><given-names>K</given-names></string-name>, <string-name><surname>Duke-Cohan</surname><given-names>JS</given-names></string-name>,
<string-name><surname>Jensen</surname><given-names>JD</given-names></string-name>, <string-name><surname>Hoekstra</surname><given-names>HE.</given-names></string-name></person-group><year>2019</year>. <article-title>Linking a mutation to survival in wild
mice</article-title>.
<source>Science</source><volume>363</volume>(<issue>6426</issue>):<fpage>499</fpage>–<lpage>504</lpage>.<pub-id pub-id-type="pmid">30705186</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bay</surname><given-names>RA</given-names></string-name>, <string-name><surname>Harrigan</surname><given-names>RJ</given-names></string-name>,
<string-name><surname>Underwood</surname><given-names>VL</given-names></string-name>,
<string-name><surname>Gibbs</surname><given-names>HL</given-names></string-name>, <string-name><surname>Smith</surname><given-names>TB</given-names></string-name>, <string-name><surname>Ruegg</surname><given-names>K.</given-names></string-name></person-group><year>2018</year>. <article-title>Genomic signals of selection predict climate-driven
population declines in a migratory bird</article-title>.
<source>Science</source><volume>359</volume>(<issue>6371</issue>):<fpage>83</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">29302012</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bradburd</surname><given-names>GS</given-names></string-name>, <string-name><surname>Ralph</surname><given-names>PL.</given-names></string-name></person-group><year>2019</year>. <article-title>Spatial population genetics: it’s about
time</article-title>. <source>Annu Rev Ecol Evol Syst</source>.
<volume>50</volume>(<issue>1</issue>):<fpage>427</fpage>–<lpage>449</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Capblancq</surname><given-names>T</given-names></string-name>, <string-name><surname>Fitzpatrick</surname><given-names>MC</given-names></string-name>,
<string-name><surname>Bay</surname><given-names>RA</given-names></string-name>, <string-name><surname>Exposito-Alonso</surname><given-names>M</given-names></string-name>,
<string-name><surname>Keller</surname><given-names>SR.</given-names></string-name></person-group><year>2020</year>. <article-title>Genomic prediction of (mal)adaptation across current and
future climatic landscapes</article-title>. <source>Annu Rev Ecol Evol Syst</source>.
<volume>51</volume>(<issue>1</issue>):<fpage>245</fpage>–<lpage>269</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Crossley</surname><given-names>MS</given-names></string-name>, <string-name><surname>Chen</surname><given-names>YH</given-names></string-name>, <string-name><surname>Groves</surname><given-names>RL</given-names></string-name>, <string-name><surname>Schoville</surname><given-names>SD.</given-names></string-name></person-group><year>2017</year>. <article-title>Landscape genomics of Colorado potato beetle provides
evidence of polygenic adaptation to insecticides</article-title>. <source>Mol
Ecol</source>.
<volume>26</volume>(<issue>22</issue>):<fpage>6284</fpage>–<lpage>6300</lpage>.<pub-id pub-id-type="pmid">28857332</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Daly</surname><given-names>C</given-names></string-name>, <string-name><surname>Halbleib</surname><given-names>M</given-names></string-name>, <string-name><surname>Smith</surname><given-names>JI</given-names></string-name>, <string-name><surname>Gibson</surname><given-names>WP</given-names></string-name>, <string-name><surname>Doggett</surname><given-names>MK</given-names></string-name>, <string-name><surname>Taylor</surname><given-names>GH</given-names></string-name>, <string-name><surname>Curtis</surname><given-names>J</given-names></string-name>, <string-name><surname>Pasteris</surname><given-names>PP.</given-names></string-name></person-group><year>2008</year>. <article-title>Physiographically sensitive mapping of climatological
temperature and precipitation across the conterminous United States</article-title>.
<source>Int J Climatol</source>.
<volume>28</volume>(<issue>15</issue>):<fpage>2031</fpage>–<lpage>2064</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Epperson</surname><given-names>BK</given-names></string-name>, <string-name><surname>McRae</surname><given-names>BH</given-names></string-name>, <string-name><surname>Scribner</surname><given-names>K</given-names></string-name>, <string-name><surname>Cushman</surname><given-names>SA</given-names></string-name>, <string-name><surname>Rosenberg</surname><given-names>MS</given-names></string-name>, <string-name><surname>Fortin</surname><given-names>MJ</given-names></string-name>, <string-name><surname>James</surname><given-names>PMA</given-names></string-name>, <string-name><surname>Murphy</surname><given-names>M</given-names></string-name>, <string-name><surname>Manel</surname><given-names>S</given-names></string-name>, <string-name><surname>Legendre</surname><given-names>P</given-names></string-name></person-group>,
<etal>et al</etal><year>2010</year>. <article-title>Utility of computer simulations in
landscape genetics</article-title>. <source>Mol Ecol</source>.
<volume>19</volume>(<issue>17</issue>):<fpage>3549</fpage>–<lpage>3564</lpage>.<pub-id pub-id-type="pmid">20618894</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Etherington</surname><given-names>TR</given-names></string-name>, <string-name><surname>Holland</surname><given-names>EP</given-names></string-name>, <string-name><surname>O'Sullivan</surname><given-names>D.</given-names></string-name></person-group><year>2015</year>. <article-title>NLMpy: a python software package for the creation of
neutral landscape models within a general numerical framework</article-title>.
<source>Methods Ecol Evol</source>.
<volume>6</volume>(<issue>2</issue>):<fpage>164</fpage>–<lpage>168</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fisher</surname><given-names>RA.</given-names></string-name></person-group><year>1923</year>. <article-title>XXI.—on the dominance ratio</article-title>.
<source>Proc R Soc Edinb</source>.
<volume>42</volume>:<fpage>321</fpage>–<lpage>341</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fournier-Level</surname><given-names>A</given-names></string-name>, <string-name><surname>Korte</surname><given-names>A</given-names></string-name>, <string-name><surname>Cooper</surname><given-names>MD</given-names></string-name>, <string-name><surname>Nordborg</surname><given-names>M</given-names></string-name>, <string-name><surname>Schmitt</surname><given-names>J</given-names></string-name>, <string-name><surname>Wilczek</surname><given-names>AM.</given-names></string-name></person-group><year>2011</year>. <article-title>A map of local adaptation in <italic toggle="yes">Arabidopsis
thaliana</italic></article-title>.
<source>Science</source><volume>334</volume>(<issue>6052</issue>):<fpage>86</fpage>–<lpage>89</lpage>.<pub-id pub-id-type="pmid">21980109</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Franks</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Hoffmann</surname><given-names>AA.</given-names></string-name></person-group><year>2012</year>. <article-title>Genetics of climate change adaptation</article-title>.
<source>Annu Rev Genet</source>.
<volume>46</volume>:<fpage>185</fpage>–<lpage>208</lpage>.<pub-id pub-id-type="pmid">22934640</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gillies</surname><given-names>S.</given-names></string-name></person-group><year>2007</year>. Shapely contributors. Shapely: manipulation and analysis of geometric
objects. Available from: <ext-link xlink:href="https://github.com/Toblerity/Shapely" ext-link-type="uri">https://github.com/Toblerity/Shapely</ext-link>.</mixed-citation>
    </ref>
    <ref id="msab175-B14">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gillies</surname><given-names>S</given-names></string-name></person-group>, Rasterio contributors. <year>2019</year>. <article-title>Rasterio:
geospatial raster I/O for Python programmers</article-title>. Available from: <ext-link xlink:href="https://github.com/mapbox/rasterio" ext-link-type="uri">https://github.com/mapbox/rasterio</ext-link>.</mixed-citation>
    </ref>
    <ref id="msab175-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guillaume</surname><given-names>F</given-names></string-name>, <string-name><surname>Rougemont</surname><given-names>J.</given-names></string-name></person-group><year>2006</year>. <article-title>Nemo: an evolutionary and population genetics
programming framework</article-title>.
<source>Bioinformatics</source><volume>22</volume>(<issue>20</issue>):<fpage>2556</fpage>–<lpage>2557</lpage>.<pub-id pub-id-type="pmid">16882649</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haller</surname><given-names>BC</given-names></string-name>, <string-name><surname>Messer</surname><given-names>PW.</given-names></string-name></person-group><year>2017</year>. <article-title>SLiM 2: flexible, interactive forward genetic
simulations</article-title>. <source>Mol Biol Evol</source>.
<volume>34</volume>(<issue>1</issue>):<fpage>230</fpage>–<lpage>240</lpage>.<pub-id pub-id-type="pmid">27702775</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haller</surname><given-names>BC</given-names></string-name>, <string-name><surname>Messer</surname><given-names>PW.</given-names></string-name></person-group><year>2019</year>. <article-title>SLiM 3: forward genetic simulations beyond the
wright–fisher model</article-title>. <source>Mol Biol Evol</source>.
<volume>36</volume>(<issue>3</issue>):<fpage>632</fpage>–<lpage>637</lpage>.<pub-id pub-id-type="pmid">30517680</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harris</surname><given-names>CR</given-names></string-name>, <string-name><surname>Millman</surname><given-names>KJ</given-names></string-name>, <string-name><surname>van der
Walt</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Gommers</surname><given-names>R</given-names></string-name>, <string-name><surname>Virtanen</surname><given-names>P</given-names></string-name>, <string-name><surname>Cournapeau</surname><given-names>D</given-names></string-name>, <string-name><surname>Wieser</surname><given-names>E</given-names></string-name>, <string-name><surname>Taylor</surname><given-names>J</given-names></string-name>, <string-name><surname>Berg</surname><given-names>S</given-names></string-name>, <string-name><surname>Smith</surname><given-names>NJ</given-names></string-name></person-group>,
<etal>et al</etal><year>2020</year>. <article-title>Array programming with
NumPy</article-title>.
<source>Nature</source><volume>585</volume>(<issue>7825</issue>):<fpage>357</fpage>–<lpage>362</lpage>.<pub-id pub-id-type="pmid">32939066</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B19">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hijmans</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Phillips</surname><given-names>S</given-names></string-name>, <string-name><surname>Leathwick</surname><given-names>J</given-names></string-name>, <string-name><surname>Elith</surname><given-names>J.</given-names></string-name></person-group><year>2017</year>. <italic toggle="yes">dismo</italic>: species distribution modeling. R package
version <fpage>1.1</fpage>–<lpage>4</lpage>. Available from: <ext-link xlink:href="https://CRAN.R-project.org/package=dismo" ext-link-type="uri">https://CRAN.R-project.org/package=dismo</ext-link>.</mixed-citation>
    </ref>
    <ref id="msab175-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoban</surname><given-names>S</given-names></string-name>, <string-name><surname>Bertorelle</surname><given-names>G</given-names></string-name>,
<string-name><surname>Gaggiotti</surname><given-names>OE.</given-names></string-name></person-group><year>2012</year>. <article-title>Computer simulations: tools for population and
evolutionary genetics</article-title>. <source>Nat Rev Genet</source>.
<volume>13</volume>(<issue>2</issue>):<fpage>110</fpage>–<lpage>122</lpage>.<pub-id pub-id-type="pmid">22230817</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoffmann</surname><given-names>AA</given-names></string-name>, <string-name><surname>Sgrò</surname><given-names>CM.</given-names></string-name></person-group><year>2011</year>. <article-title>Climate change and evolutionary
adaptation</article-title>.
<source>Nature</source><volume>470</volume>(<issue>7335</issue>):<fpage>479</fpage>–<lpage>485</lpage>.<pub-id pub-id-type="pmid">21350480</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hunter</surname><given-names>JD.</given-names></string-name></person-group><year>2007</year>. <article-title>Matplotlib: a 2D graphics environment</article-title>.
<source>Comput Sci Eng</source>.
<volume>9</volume>(<issue>3</issue>):<fpage>90</fpage>–<lpage>95</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jombart</surname><given-names>T</given-names></string-name>, <string-name><surname>Devillard</surname><given-names>S</given-names></string-name>,
<string-name><surname>Balloux</surname><given-names>F.</given-names></string-name></person-group><year>2010</year>. <article-title>Discriminant analysis of principal components: a new
method for the analysis of genetically structured populations</article-title>.
<source>BMC Genet</source>.
<volume>11</volume>(<issue>1</issue>):<fpage>94</fpage>.<pub-id pub-id-type="pmid">20950446</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelleher</surname><given-names>J</given-names></string-name>, <string-name><surname>Etheridge</surname><given-names>AM</given-names></string-name>,
<string-name><surname>McVean</surname><given-names>G.</given-names></string-name></person-group><year>2016</year>. <article-title>Efficient coalescent simulation and genealogical
analysis for large sample sizes</article-title>. <source>PLoS Comput Biol</source>.
<volume>12</volume>(<issue>5</issue>):<fpage>e1004842</fpage>.<pub-id pub-id-type="pmid">27145223</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelleher</surname><given-names>J</given-names></string-name>, <string-name><surname>Thornton</surname><given-names>KR</given-names></string-name>,
<string-name><surname>Ashander</surname><given-names>J</given-names></string-name>, <string-name><surname>Ralph</surname><given-names>PL.</given-names></string-name></person-group><year>2018</year>. <article-title>Efficient pedigree recording for fast population
genetics simulation</article-title>. <source>PLoS Comput Biol</source>.
<volume>14</volume>(<issue>11</issue>):<fpage>e1006581</fpage>.<pub-id pub-id-type="pmid">30383757</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B092919">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>Y</given-names>, </string-name>,
<string-name><surname>Nielsen</surname><given-names>R.</given-names></string-name></person-group><year>2004</year>. <article-title>Linkage disequilibrium as a signature of selective
sweeps</article-title>.
<source>Genetics</source><volume>167</volume>(<issue>3</issue>):<fpage>1513</fpage>–<lpage>1524</lpage>.<pub-id pub-id-type="pmid">15280259</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Landguth</surname><given-names>EL</given-names></string-name>, <string-name><surname>Bearlin</surname><given-names>A</given-names></string-name>, <string-name><surname>Day</surname><given-names>CC</given-names></string-name>, <string-name><surname>Dunham</surname><given-names>J.</given-names></string-name></person-group><year>2017</year>. <article-title>CDMetaPOP: an individual-based, eco-evolutionary model
for spatially explicit simulation of landscape demogenetics</article-title>.
<source>Methods Ecol Evol</source>.
<volume>8</volume>(<issue>1</issue>):<fpage>4</fpage>–<lpage>11</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Landguth</surname><given-names>EL</given-names></string-name>, <string-name><surname>Cushman</surname><given-names>SA.</given-names></string-name></person-group><year>2010</year>. <article-title>cdpop: A spatially explicit cost distance population
genetics program</article-title>. <source>Mol Ecol Resour</source>.
<volume>10</volume>(<issue>1</issue>):<fpage>156</fpage>–<lpage>161</lpage>.<pub-id pub-id-type="pmid">21565001</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Landguth</surname><given-names>EL</given-names></string-name>, <string-name><surname>Cushman</surname><given-names>SA</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>NA.</given-names></string-name></person-group><year>2012</year>. <article-title>Simulating natural selection in landscape
genetics</article-title>. <source>Mol Ecol Resour</source>.
<volume>12</volume>(<issue>2</issue>):<fpage>363</fpage>–<lpage>368</lpage>.<pub-id pub-id-type="pmid">21951716</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lasky</surname><given-names>JR</given-names></string-name>, <string-name><surname>Des
Marais</surname><given-names>DL</given-names></string-name>, <string-name><surname>McKAY</surname><given-names>JK</given-names></string-name>, <string-name><surname>Richards</surname><given-names>JH</given-names></string-name>, <string-name><surname>Juenger</surname><given-names>TE</given-names></string-name>, <string-name><surname>Keitt</surname><given-names>TH.</given-names></string-name></person-group><year>2012</year>. <article-title>Characterizing genomic variation of <italic toggle="yes">Arabidopsis
thaliana</italic>: the roles of geography and climate</article-title>. <source>Mol
Ecol</source>.
<volume>21</volume>(<issue>22</issue>):<fpage>5512</fpage>–<lpage>5529</lpage>.<pub-id pub-id-type="pmid">22857709</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lind</surname><given-names>BM</given-names></string-name>, <string-name><surname>Friedline</surname><given-names>CJ</given-names></string-name>,
<string-name><surname>Wegrzyn</surname><given-names>JL</given-names></string-name>, <string-name><surname>Maloney</surname><given-names>PE</given-names></string-name>, <string-name><surname>Vogler</surname><given-names>DR</given-names></string-name>, <string-name><surname>Neale</surname><given-names>DB</given-names></string-name>, <string-name><surname>Eckert</surname><given-names>AJ.</given-names></string-name></person-group><year>2017</year>. <article-title>Water availability drives signatures of local adaptation
in whitebark pine (<italic toggle="yes">Pinus albicaulis</italic> Engelm.) across fine spatial scales
of the Lake Tahoe Basin, USA</article-title>. <source>Mol Ecol</source>.
<volume>26</volume>(<issue>12</issue>):<fpage>3168</fpage>–<lpage>3185</lpage>.<pub-id pub-id-type="pmid">28316116</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B6540011037">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Manel</surname><given-names>S</given-names>, </string-name>,
<string-name><surname>Schwartz</surname><given-names>MK</given-names>,
</string-name>, <string-name><surname>Luikart</surname><given-names>G</given-names>,
</string-name>,
<string-name><surname>Taberlet</surname><given-names>P.</given-names></string-name></person-group><year>2003</year>. <article-title>Landscape genetics: combining landscape ecology and
population genetics</article-title>. <source>Trends Ecol
Evol</source>.<volume>18</volume>(<issue>4</issue>):<fpage>189</fpage>–<lpage>197</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Manel</surname><given-names>S</given-names></string-name>, <string-name><surname>Gugerli</surname><given-names>F</given-names></string-name>, <string-name><surname>Thuiller</surname><given-names>W</given-names></string-name>, <string-name><surname>Alvarez</surname><given-names>N</given-names></string-name>, <string-name><surname>Legendre</surname><given-names>P</given-names></string-name>, <string-name><surname>Holderegger</surname><given-names>R</given-names></string-name>,
<string-name><surname>Gielly</surname><given-names>L</given-names></string-name>, <string-name><surname>Taberlet</surname><given-names>P.</given-names></string-name></person-group>
IntraBioDiv Consortium. <year>2012</year>. <article-title>Broad-scale adaptive genetic
variation in alpine plants is driven by temperature and precipitation</article-title>.
<source>Mol Ecol</source>.
<volume>21</volume>(<issue>15</issue>):<fpage>3729</fpage>–<lpage>3738</lpage>.<pub-id pub-id-type="pmid">22680783</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B32">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>McKinney</surname><given-names>W</given-names></string-name></person-group>, Numpy contributors. <year>2010</year>. Data structures for statistical
computing in python. Proceedings of the 9th Python in Science Conference. p.
<fpage>51</fpage>–<lpage>56</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McRae</surname><given-names>BH.</given-names></string-name></person-group><year>2006</year>. <article-title>Isolation by resistance</article-title>.
<source>Evolution</source><volume>60</volume>(<issue>8</issue>):<fpage>1551</fpage>–<lpage>1561</lpage>.<pub-id pub-id-type="pmid">17017056</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McRae</surname><given-names>BH</given-names></string-name>, <string-name><surname>Dickson</surname><given-names>BG</given-names></string-name>, <string-name><surname>Keitt</surname><given-names>TH</given-names></string-name>, <string-name><surname>Shah</surname><given-names>VB.</given-names></string-name></person-group><year>2008</year>. <article-title>Using circuit theory to model connectivity in ecology,
evolution, and conservation</article-title>.
<source>Ecology</source><volume>89</volume>(<issue>10</issue>):<fpage>2712</fpage>–<lpage>2724</lpage>.<pub-id pub-id-type="pmid">18959309</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Messer</surname><given-names>PW.</given-names></string-name></person-group><year>2013</year>. <article-title>SLiM: simulating evolution with selection and
linkage</article-title>.
<source>Genetics</source><volume>194</volume>(<issue>4</issue>):<fpage>1037</fpage>–<lpage>1039</lpage>.<pub-id pub-id-type="pmid">23709637</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B36">
      <mixed-citation publication-type="journal">Mountain Research Initiative EDW Working Group.
<year>2015</year>. <article-title>Elevation-dependent warming in mountain regions of the
world</article-title>. <source>Nat Clim Change</source>.
<volume>5</volume>:<fpage>424</fpage>–<lpage>430</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Neuenschwander</surname><given-names>S</given-names></string-name>, <string-name><surname>Hospital</surname><given-names>F</given-names></string-name>, <string-name><surname>Guillaume</surname><given-names>F</given-names></string-name>, <string-name><surname>Goudet</surname><given-names>J.</given-names></string-name></person-group><year>2008</year>. <article-title>quantiNemo: an individual-based program to simulate
quantitative traits with explicit genetic architecture in a dynamic
metapopulation</article-title>.
<source>Bioinformatics</source><volume>24</volume>(<issue>13</issue>):<fpage>1552</fpage>–<lpage>1553</lpage>.<pub-id pub-id-type="pmid">18450810</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B38">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Oksanen</surname><given-names>J</given-names></string-name>, <string-name><surname>Guillaume
Blanchet</surname><given-names>F</given-names></string-name>, <string-name><surname>Friendly</surname><given-names>M</given-names></string-name>, <string-name><surname>Kindt</surname><given-names>R</given-names></string-name>, <string-name><surname>Legendre</surname><given-names>P</given-names></string-name>, <string-name><surname>McGlinn</surname><given-names>D</given-names></string-name>, <string-name><surname>Minchin</surname><given-names>PR</given-names></string-name>, <string-name><surname>O'Hara</surname><given-names>RB</given-names></string-name>, <string-name><surname>Simpson</surname><given-names>GL</given-names></string-name>, <string-name><surname>Solymos</surname><given-names>P</given-names></string-name></person-group>,
<etal>et al</etal><year>2019</year>. vegan: Community Ecology Package. R package version
2.5-6. Available from: <ext-link xlink:href="https://CRAN.R-project.org/package=vegan" ext-link-type="uri">https://CRAN.R-project.org/package=vegan</ext-link>.</mixed-citation>
    </ref>
    <ref id="msab175-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oyler</surname><given-names>JW</given-names></string-name>, <string-name><surname>Dobrowski</surname><given-names>SZ</given-names></string-name>,
<string-name><surname>Ballantyne</surname><given-names>AP</given-names></string-name>,
<string-name><surname>Klene</surname><given-names>AE</given-names></string-name>, <string-name><surname>Running</surname><given-names>SW.</given-names></string-name></person-group><year>2015</year>. <article-title>Artificial amplification of warming trends across the
mountains of the western United States</article-title>. <source>Geophys Res
Lett</source>.
<volume>42</volume>(<issue>1</issue>):<fpage>153</fpage>–<lpage>161</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G</given-names></string-name>,
<string-name><surname>Gramfort</surname><given-names>A</given-names></string-name>, <string-name><surname>Michel</surname><given-names>V</given-names></string-name>, <string-name><surname>Thirion</surname><given-names>B</given-names></string-name>, <string-name><surname>Grisel</surname><given-names>O</given-names></string-name>, <string-name><surname>Blondel</surname><given-names>M</given-names></string-name>, <string-name><surname>Prettenhofer</surname><given-names>P</given-names></string-name>,
<string-name><surname>Weiss</surname><given-names>R</given-names></string-name>, <string-name><surname>Dubourg</surname><given-names>V</given-names></string-name></person-group>,
<etal>et al</etal><year>2011</year>. <article-title>Scikit-learn: machine learning in
Python</article-title>. <source>J Mach Learn Res</source>.
<volume>12</volume>:<fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pelletier</surname><given-names>F.</given-names></string-name></person-group><year>2019</year>. <article-title>Testing evolutionary predictions in wild
mice</article-title>.
<source>Science</source><volume>363</volume>(<issue>6426</issue>):<fpage>452</fpage>–<lpage>453</lpage>.<pub-id pub-id-type="pmid">30705170</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>B</given-names></string-name>, <string-name><surname>Kimmel</surname><given-names>M.</given-names></string-name></person-group><year>2005</year>. <article-title>simuPOP: a forward-time population genetics simulation
environment</article-title>.
<source>Bioinformatics</source><volume>21</volume>(<issue>18</issue>):<fpage>3686</fpage>–<lpage>3687</lpage>.<pub-id pub-id-type="pmid">16020469</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>B</given-names></string-name>, <string-name><surname>Chen</surname><given-names>HS</given-names></string-name>, <string-name><surname>Mechanic</surname><given-names>LE</given-names></string-name>, <string-name><surname>Racine</surname><given-names>B</given-names></string-name>, <string-name><surname>Clarke</surname><given-names>J</given-names></string-name>, <string-name><surname>Clarke</surname><given-names>L</given-names></string-name>, <string-name><surname>Gillanders</surname><given-names>E</given-names></string-name>, <string-name><surname>Feuer</surname><given-names>EJ.</given-names></string-name></person-group><article-title>Genetic Simulation Resources: a website for the registration and discovery
of genetic data simulators</article-title>. <source>Bioinformatics</source>.
<year>2013</year><volume>29</volume>(<issue>8</issue>):<fpage>1101</fpage>–<lpage>1102</lpage>.<pub-id pub-id-type="pmid">23435068</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pierce</surname><given-names>DW</given-names></string-name>, <string-name><surname>Cayan</surname><given-names>DR</given-names></string-name>, <string-name><surname>Thrasher</surname><given-names>BL.</given-names></string-name></person-group><year>2014</year>. <article-title>Statistical downscaling using localized constructed
analogs (LOCA)</article-title>. <source>J Hydrometeorol</source>.
<volume>15</volume>(<issue>6</issue>):<fpage>2558</fpage>–<lpage>2585</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B45">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Porter</surname><given-names>A.</given-names></string-name></person-group><year>2013</year>. ClineFit v. 2.0, user’s manual. Available from: <ext-link xlink:href="http://people.umass.edu/aporter/ClineFit/ClineFit%20Manual.pdf" ext-link-type="uri">http://people.umass.edu/aporter/ClineFit/ClineFit%20Manual.pdf</ext-link>. Accessed
June 24, 2021.</mixed-citation>
    </ref>
    <ref id="msab175-B63466762">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Przeworski</surname><given-names>M.</given-names></string-name></person-group><year>2002</year>. <article-title>The signature of positive selection at randomly chosen
loci</article-title>.
<source>Genetics</source><volume>160</volume>(<issue>3</issue>):<fpage>1179</fpage>–<lpage>1189</lpage>.<pub-id pub-id-type="pmid">11901132</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B46">
      <mixed-citation publication-type="other">Python Software Foundation. <year>2019</year>.
Python language reference, version 3.7. Available from: <ext-link xlink:href="http://www.python.org" ext-link-type="uri">http://www.python.org</ext-link>. Accessed June 24,
2021.</mixed-citation>
    </ref>
    <ref id="msab175-B47">
      <mixed-citation publication-type="other">R Core Team. <year>2020</year>. R: a language and
environment for statistical computing.Vienna, Austria: R Foundation for Statistical
Computing.</mixed-citation>
    </ref>
    <ref id="msab175-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rangwala</surname><given-names>I</given-names></string-name>, <string-name><surname>Sinsky</surname><given-names>E</given-names></string-name>, <string-name><surname>Miller</surname><given-names>JR.</given-names></string-name></person-group><year>2013</year>. <article-title>Amplified warming projections for high altitude regions
of the northern hemisphere mid-latitudes from CMIP5 models</article-title>.
<source>Environ Res Lett</source>.
<volume>8</volume>(<issue>2</issue>):<fpage>024040</fpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rebaudo</surname><given-names>F</given-names></string-name>, <string-name><surname>Le
Rouzic</surname><given-names>A</given-names></string-name>, <string-name><surname>Dupas</surname><given-names>S</given-names></string-name>, <string-name><surname>Silvain</surname><given-names>J-F</given-names></string-name>, <string-name><surname>Harry</surname><given-names>M</given-names></string-name>, <string-name><surname>Dangles</surname><given-names>O.</given-names></string-name></person-group><year>2013</year>. <article-title>SimAdapt: an individual-based genetic model for
simulating landscape management impacts on populations</article-title>. <source>Methods
Ecol Evol</source>.
<volume>4</volume>(<issue>6</issue>):<fpage>595</fpage>–<lpage>600</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rose</surname><given-names>BR.</given-names></string-name></person-group><year>1976</year>. <article-title>Habitat and prey selection of <italic toggle="yes">Sceloporus
occidentalis</italic> and <italic toggle="yes">Sceloporus graciosus</italic></article-title>.
<source>Ecology</source><volume>57</volume>(<issue>3</issue>):<fpage>531</fpage>–<lpage>541</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B51">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ruth</surname><given-names>SB.</given-names></string-name></person-group><year>1978</year>. A comparison of the demography and female reproduction in sympatric
western fence lizards (<italic toggle="yes">Sceloporus occidentalis</italic>) and sagebrush lizards
(<italic toggle="yes">Sceloporus graciosus</italic>) on Mount Diablo, California. Ph.D dissertation:
University of California Berkeley. Available from: <ext-link xlink:href="https://elibrary.ru/item.asp?id=7216038" ext-link-type="uri">https://www.proquest.com/openview/4fc8add6870959ae6228fe7ce5f7cb47</ext-link>. Accessed
November 20, 2020.</mixed-citation>
    </ref>
    <ref id="msab175-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schoville</surname><given-names>SD</given-names></string-name>, <string-name><surname>Bonin</surname><given-names>A</given-names></string-name>, <string-name><surname>François</surname><given-names>O</given-names></string-name>, <string-name><surname>Lobreaux</surname><given-names>S</given-names></string-name>, <string-name><surname>Melodelima</surname><given-names>C</given-names></string-name>, <string-name><surname>Manel</surname><given-names>S.</given-names></string-name></person-group><year>2012</year>. <article-title>Adaptive genetic variation on the landscape: methods and
cases</article-title>. <source>Annu Rev Ecol Evol Syst</source>.
<volume>43</volume>(<issue>1</issue>):<fpage>23</fpage>–<lpage>43</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B53">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Schnell</surname><given-names>I</given-names></string-name></person-group>, Bitarray contributors. <year>2021</year>. bitarray: efficient arrays of
booleans. Available from: <ext-link xlink:href="https://github.com/ilanschnell/bitarray" ext-link-type="uri">https://github.com/ilanschnell/bitarray</ext-link>. Accessed June 24,
2021.</mixed-citation>
    </ref>
    <ref id="msab175-B54">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Seabold</surname><given-names>S</given-names></string-name>, <string-name><surname>Perktold</surname><given-names>J.</given-names></string-name></person-group><year>2010</year>. statsmodels: econometric and statistical modeling with python. In: van
der Walt S, Millman J, editors. Proceedings of the 9th Python in Science Conference (SciPy
2010). Austin (TX): SciPy. p. 92–96.</mixed-citation>
    </ref>
    <ref id="msab175-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sexton</surname><given-names>JP</given-names></string-name>, <string-name><surname>Hangartner</surname><given-names>SB</given-names></string-name>,
<string-name><surname>Hoffmann</surname><given-names>AA.</given-names></string-name></person-group><year>2014</year>. <article-title>Genetic isolation by environment or distance: which
pattern of gene flow is most
common?</article-title><source>Evolution</source><volume>68</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">24111567</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Spear</surname><given-names>SF</given-names></string-name>, <string-name><surname>Balkenhol</surname><given-names>N</given-names></string-name>,
<string-name><surname>Fortin</surname><given-names>M-J</given-names></string-name>, <string-name><surname>Mcrae</surname><given-names>BH</given-names></string-name>, <string-name><surname>Scribner</surname><given-names>K.</given-names></string-name></person-group><year>2010</year>. <article-title>Use of resistance surfaces for landscape genetic
studies: considerations for parameterization and analysis</article-title>. <source>Mol
Ecol</source>.
<volume>19</volume>(<issue>17</issue>):<fpage>3576</fpage>–<lpage>3591</lpage>.<pub-id pub-id-type="pmid">20723064</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stebbins</surname><given-names>RC.</given-names></string-name></person-group><year>1948</year>. <article-title>Additional observations on home ranges and longevity in
the lizard <italic toggle="yes">Sceloporus graciosus</italic></article-title>.
<source>Copeia</source><volume>1948</volume>(<issue>1</issue>):<fpage>20</fpage>–<lpage>22</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szymura</surname><given-names>JM</given-names></string-name>, <string-name><surname>Barton</surname><given-names>NH.</given-names></string-name></person-group><year>1986</year>. <article-title>Genetic analysis of a hybrid zone between the
fire-bellied toads, <italic toggle="yes">Bombina bombina</italic> and <italic toggle="yes">B. variegata</italic>,
near Cracow in Southern Poland</article-title>.
<source>Evolution</source><volume>40</volume>:<fpage>1141</fpage>–<lpage>1159</lpage>.<pub-id pub-id-type="pmid">28563502</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tinkle</surname><given-names>DW.</given-names></string-name></person-group><year>1973</year>. <article-title>A population analysis of the sagebrush lizard,
<italic toggle="yes">Sceloporus graciosus</italic> in Southern Utah</article-title>.
<source>Copeia</source><volume>1973</volume>(<issue>2</issue>):<fpage>284</fpage>–<lpage>296</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tinkle</surname><given-names>DW</given-names></string-name>, <string-name><surname>Dunham</surname><given-names>AE</given-names></string-name>, <string-name><surname>Congdon</surname><given-names>JD.</given-names></string-name></person-group><year>1993</year>. <article-title>Life history and demographic variation in the lizard
<italic toggle="yes">Sceloporus graciosus</italic>: a long-term study</article-title>.
<source>Ecology</source><volume>74</volume>(<issue>8</issue>):<fpage>2413</fpage>–<lpage>2429</lpage>.</mixed-citation>
    </ref>
    <ref id="msab175-B61">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>van Rossum</surname><given-names>G.</given-names></string-name></person-group><year>1995</year>. <part-title>Python tutorial</part-title>. <source>Technical
Report CS-R9526, Centrum voor Wiskunde en Informatica (CWI)</source>,
<publisher-loc>Amsterdam</publisher-loc>, <publisher-name>the
Netherlands</publisher-name>.</mixed-citation>
    </ref>
    <ref id="msab175-B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Virtanen</surname><given-names>P</given-names></string-name>, <string-name><surname>Gommers</surname><given-names>R</given-names></string-name>, <string-name><surname>Oliphant</surname><given-names>TE</given-names></string-name>, <string-name><surname>Haberland</surname><given-names>M</given-names></string-name>, <string-name><surname>Reddy</surname><given-names>T</given-names></string-name>, <string-name><surname>Cournapeau</surname><given-names>D</given-names></string-name>, <string-name><surname>Burovski</surname><given-names>E</given-names></string-name>, <string-name><surname>Peterson</surname><given-names>P</given-names></string-name>, <string-name><surname>Weckesser</surname><given-names>W</given-names></string-name>, <string-name><surname>Bright</surname><given-names>J</given-names></string-name></person-group>,
<etal>et al</etal>; SciPy 1.0 Contributors. <year>2020</year>. <article-title>SciPy 1.0:
fundamental algorithms for scientific computing in python</article-title>. <source>Nat
Methods</source>.
<volume>17</volume>(<issue>3</issue>):<fpage>261</fpage>–<lpage>272</lpage>.<pub-id pub-id-type="pmid">32015543</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>IJ.</given-names></string-name></person-group><year>2013</year>. <article-title>Examining the full effects of landscape heterogeneity on
spatial genetic variation: a multiple matrix regression approach for quantifying
geographic and ecological isolation</article-title>.
<source>Evolution</source><volume>67</volume>(<issue>12</issue>):<fpage>3403</fpage>–<lpage>3411</lpage>.<pub-id pub-id-type="pmid">24299396</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>IJ</given-names></string-name>, <string-name><surname>Bradburd</surname><given-names>GS.</given-names></string-name></person-group><year>2014</year>. <article-title>Isolation by environment</article-title>. <source>Mol
Ecol</source>. <volume>23</volume>
(<issue>23</issue>):<fpage>5649</fpage>–<lpage>5662</lpage>.<pub-id pub-id-type="pmid">25256562</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B65">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wright</surname><given-names>S.</given-names></string-name></person-group><year>1931</year>. <article-title>Evolution in Mendelian populations</article-title>.
<source>Genetics</source><volume>16</volume>(<issue>2</issue>):<fpage>97</fpage>–<lpage>159</lpage>.<pub-id pub-id-type="pmid">17246615</pub-id></mixed-citation>
    </ref>
    <ref id="msab175-B66">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wright</surname><given-names>S.</given-names></string-name></person-group><year>1943</year>. <article-title>Isolation by distance</article-title>.
<source>Genetics</source><volume>28</volume>(<issue>2</issue>):<fpage>114</fpage>–<lpage>138</lpage>.<pub-id pub-id-type="pmid">17247074</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
