<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5860610</article-id>
    <article-id pub-id-type="pmid">29087450</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx633</article-id>
    <article-id pub-id-type="publisher-id">btx633</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ViewBS: a powerful toolkit for visualization of high-throughput bisulfite sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Xiaosan</given-names>
        </name>
        <xref ref-type="aff" rid="btx633-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Shaoling</given-names>
        </name>
        <xref ref-type="aff" rid="btx633-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Kongqing</given-names>
        </name>
        <xref ref-type="aff" rid="btx633-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thimmapuram</surname>
          <given-names>Jyothi</given-names>
        </name>
        <xref ref-type="aff" rid="btx633-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Shaojun</given-names>
        </name>
        <xref ref-type="aff" rid="btx633-aff3">3</xref>
        <xref ref-type="corresp" rid="btx633-cor1"/>
        <!--<email>xie186@purdue.edu</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx633-aff1"><label>1</label>College of Horticulture, State Key Laboratory of Crop Genetics and Germplasm Enhancement, Nanjing Agricultural University, No.6 Tongwei Road Nanjing, P. R. China</aff>
    <aff id="btx633-aff2"><label>2</label>Department of Rural Development, Nanjing Agricultural University, No.6 Tongwei Road Nanjing, P. R. China</aff>
    <aff id="btx633-aff3"><label>3</label>Bioinformatics Core, Purdue University, 155 South Grant Street, West Lafayette, Indiana, USA</aff>
    <author-notes>
      <corresp id="btx633-cor1">To whom correspondence should be addressed. Email: <email>xie186@purdue.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-10-26">
      <day>26</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>4</issue>
    <fpage>708</fpage>
    <lpage>709</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>6</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>9</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>10</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="cc-by-nc">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx633.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>High throughput bisulfite sequencing (BS-seq) is an important technology to generate single-base DNA methylomes in both plants and animals. In order to accelerate the data analysis of BS-seq data, toolkits for visualization are required.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>ViewBS, an open-source toolkit, can extract and visualize the DNA methylome data easily and with flexibility. By using Tabix, ViewBS can visualize BS-seq for large datasets quickly. ViewBS can generate publication-quality figures, such as meta-plots, heat maps and violin-boxplots, which can help users to answer biological questions. We illustrate its application using BS-seq data from <italic>Arabidopsis thaliana</italic>.</p>
      </sec>
      <sec id="s3">
        <title>Availability</title>
        <p>ViewBS is freely available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/xie186/ViewBS">https://github.com/xie186/ViewBS</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Natural Science Foundation of Jiangsu Province</named-content>
          <named-content content-type="funder-identifier">10.13039/501100004608</named-content>
        </funding-source>
        <award-id>BK20150681</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Natural Science Foundation of China</named-content>
          <named-content content-type="funder-identifier">10.13039/501100001809</named-content>
        </funding-source>
        <award-id>71704081</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>A combination of bisulfite treatment of DNA and high-throughput sequencing [bisulfite sequencing (BS-seq)] has been extensively used to investigate DNA methylation at single-base resolution level for animals and plants (<xref rid="btx633-B6" ref-type="bibr">Krueger <italic>et al.</italic>, 2012</xref>). Analysis of BS-seq data includes alignments of reads, identification of differentially methylated regions (DMR) and visualization of the data. Multiple tools for read alignments of BS-seq data have been developed (<xref rid="btx633-B2" ref-type="bibr">Guo <italic>et al.</italic>, 2013</xref>; <xref rid="btx633-B4" ref-type="bibr">Harris <italic>et al.</italic>, 2012</xref>; <xref rid="btx633-B7" ref-type="bibr">Krueger and Andrews, 2011</xref>; <xref rid="btx633-B8" ref-type="bibr">Pedersen <italic>et al.</italic>, 2014</xref>). Many tools (<xref rid="btx633-B1" ref-type="bibr">Akalin <italic>et al.</italic>, 2012</xref>; <xref rid="btx633-B3" ref-type="bibr">Hansen <italic>et al.</italic>, 2012</xref>; <xref rid="btx633-B11" ref-type="bibr">Wang <italic>et al.</italic>, 2015</xref>) are available for DMR identification as well. To visualize the DNA methylome data, heat map, meta-line plot and boxplot are frequently used in published papers (<xref rid="btx633-B6" ref-type="bibr">Krueger <italic>et al.</italic>, 2012</xref>). Developing a toolkit with functions to generate publication-ready figures will be broadly used in the analysis of BS-seq data.</p>
    <p>Here we have developed ViewBS—a standalone program capable of both profiling genome-wide DNA methylation and visualizing DNA methylation patterns of BS-seq data at selected regions. We used a few examples to demonstrate that ViewBS is easy to use and very powerful to generate publication-quality figures.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>ViewBS has one main command named ViewBS. Under ViewBS, eight tools are developed. Getopt:: Long:: Subcommand is used to process command line options with sub commands. Bio:: DB:: HTS:: Tabix (another Perl module) is used to quickly retrieve genome-wide cytosine report as input. Perl module Bio:: SeqIO is used to retrieve information from sequence data. To generate publication-quality figures, three packages (reshape2, ggplot2 and pheatmap) are used in R. The source code is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/xie186/ViewBS">https://github.com/xie186/ViewBS</ext-link>.</p>
  </sec>
  <sec>
    <title>3 Functions and examples</title>
    <p>ViewBS has several tools which determine the required and optional arguments. These tools can be divided into two parts: profiling of genome-wide DNA methylation and visualization of DNA methylation patterns of BS-seq data at selected regions (<xref ref-type="fig" rid="btx633-F1">Fig. 1</xref>). Each tool will generate the result in tab-delimited files, corresponding figures in PDF files and shell scripts to regenerate the figures.
</p>
    <fig id="btx633-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>Summary of the functions of ViewBS</p>
      </caption>
      <graphic xlink:href="btx633f1"/>
    </fig>
    <p>To use ViewBS, users typically need to prepare two types of data set. ViewBS uses genome-wide cytosine methylation report generated by Bismark as input file, which contains the sequence context and has seven columns in the following format: chromosome, position, strand, count methylated, count unmethylated, C-context and trinucleotide context. The second one is input file for selected regions of interest which includes the genomic coordinates.</p>
    <p>To evaluate the performance of ViewBS, we used the BS-seq data (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>) for <italic>Arabidopsis thaliana</italic> (<xref rid="btx633-B9" ref-type="bibr">Stroud <italic>et al.</italic>, 2014</xref>). Figures generated by the tools of ViewBS were based on these data. Details can be found in <xref ref-type="supplementary-material" rid="sup1">supplementary data</xref>.</p>
    <sec>
      <title>Profiling of genome-wide DNA methylation</title>
      <p>For genome-wide DNA methylation profiling, we offer several tools: <italic>BisNonConvRate</italic>, <italic>MethCoverage</italic>, <italic>GlobalMethLev</italic>, <italic>MethGeno</italic> and <italic>MethLevDist</italic>.</p>
      <p><italic>BisNonConvRate</italic> is a tool for estimating non-conversion rate of BS-seq data. In plant, reads mapping to the non-methylated chloroplast genome can be used to assess bisulfite conversion efficiency. BisNonConvRate is especially useful in this case. Users can provide the chromosome ID for chloroplast and <italic>BisNonConvRate</italic> will estimate the non-conversion rate.</p>
      <p><italic>MethCoverage</italic> can be used to assess the read coverage distribution of cytosine in each context. This tool is useful to let users know the read coverage of BS-seq data.</p>
      <p>Global DNA methylation levels are common information for understanding the BS-seq data. <italic>GlobalMethLev</italic> is the tool to generate weighted DNA methylation levels for the samples that the users provide.</p>
      <p>Distribution of methylation levels is another feature that researchers use to profile DNA methylation data. The tool <italic>MethLevDist</italic> can generate methylation level distributions for not only genome-wide, but also for the regions of interest, for example genic regions, TSS regions, etc.</p>
      <p>Another tool named <italic>MethGeno</italic> can generate the methylation levels across the chromosomes.</p>
    </sec>
    <sec>
      <title>Visualization of DNA methylation patterns at selected regions of interest</title>
      <p>For visualization of DNA methylation patterns at functionally important regions, we offer three tools: <italic>MethOverRegion</italic>, <italic>MethHeatmap</italic> and <italic>MethOneRegion</italic>.</p>
      <p><italic>MethOverRegion</italic> is a tool which can generate meta-plot for selected regions, for example a list of genes. By default, the selected region will be split into 60 bins. The flanking 2 kb regions of the selected regions will be split into 100-bp bins. For each bin, weighted methylation levels will be recorded and plotted along the selected regions. The users can set the size of flanking regions and the number of bins.</p>
      <p><italic>MethHeatmap</italic> is a tool that can be used to generate heat map and/or violin-box plot for selected regions, for example a list of DMRs. A violin plot shows the full distribution of the data (<xref rid="btx633-B5" ref-type="bibr">Hintze and Nelson, 1998</xref>) and a box plot shows summary statistics such as mean/median and interquartile ranges. Here <italic>MethHeatmap</italic> combines these two methods together into one violin-boxplot to visualize the data.</p>
      <p><italic>MethOneRegion</italic> is a tool which can be used to visualize DNA methylation information for just one region provided. This is useful if the users don’t want to load the large dataset to genome browser (like IGV <xref rid="btx633-B10" ref-type="bibr">Thorvaldsdottir et al., 2013</xref>) and just want a snapshot of one region. In this tool, the users can define the size of flanking regions that they want to visualize. The DNA methylation in the region provided will be shown in shaded transparent area.</p>
      <p>Evaluation of ViewBS was carried out using BS-seq data from <italic>Arabidopsis</italic>. Details of the results, including the maximum memory consumptions and time used for each of the tools of ViewBS, were shown in the supplementary files.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>We conclude that ViewBS is an extremely efficient and flexible software package to accelerate research in the era of bisulfite sequencing data. It provides a set of toolkits to enable rapid analysis of whole genome bisulfite sequencing.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx633_supp1028.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Dr Hainan Zhao for the suggestions on the project.</p>
    <sec>
      <title>Funding</title>
      <p>This work has been supported by the Excellent Youth Natural Science Foundation of Jiangsu Province (SBK2017030026), the Natural Science Foundation of Jiangsu Province (BK20150681), the National Natural Science Foundation of China (71704081), the Fundamental Research Funds for the Central Universities (KYTZ201401, SKYC2017019, KYZ201607, KYZ201510 and SKTS2017015), the Ministry of education of Humanities and Social Science project (14YJC630058).</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btx633-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Akalin</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>methylKit: a comprehensive R package for the analysis of genome-wide DNA methylation profiles</article-title>. <source>Genome Biol</source>, <volume>13</volume>, <fpage>R87.</fpage><pub-id pub-id-type="pmid">23034086</pub-id></mixed-citation>
    </ref>
    <ref id="btx633-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guo</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>BS-Seeker2: a versatile aligning pipeline for bisulfite sequencing data</article-title>. <source>BMC Genomics</source>, <volume>14</volume>, <fpage>774.</fpage><pub-id pub-id-type="pmid">24206606</pub-id></mixed-citation>
    </ref>
    <ref id="btx633-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hansen</surname><given-names>K.D.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>BSmooth: from whole genome bisulfite sequencing reads to differentially methylated regions</article-title>. <source>Genome Biol</source>, <volume>13</volume>, <fpage>R83</fpage>.<pub-id pub-id-type="pmid">23034175</pub-id></mixed-citation>
    </ref>
    <ref id="btx633-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Harris</surname><given-names>E.Y.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>BRAT-BW: efficient and accurate mapping of bisulfite-treated reads</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1795</fpage>–<lpage>1796</lpage>.<pub-id pub-id-type="pmid">22563065</pub-id></mixed-citation>
    </ref>
    <ref id="btx633-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hintze</surname><given-names>J.L.</given-names></name>, <name name-style="western"><surname>Nelson</surname><given-names>R.D.</given-names></name></person-group> (<year>1998</year>) 
<article-title>Violin plots: a box plot-density trace synergism</article-title>. <source>Am. Stat</source>, <volume>52</volume>, <fpage>181</fpage>–<lpage>184</lpage>.</mixed-citation>
    </ref>
    <ref id="btx633-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Krueger</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>DNA methylome analysis using short bisulfite sequencing data</article-title>. <source>Nat Methods</source>, <volume>9</volume>, <fpage>145</fpage>–<lpage>151</lpage>.<pub-id pub-id-type="pmid">22290186</pub-id></mixed-citation>
    </ref>
    <ref id="btx633-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Krueger</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Andrews</surname><given-names>S.R.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Bismark: a flexible aligner and methylation caller for Bisulfite-Seq applications</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>1571</fpage>–<lpage>1572</lpage>.<pub-id pub-id-type="pmid">21493656</pub-id></mixed-citation>
    </ref>
    <ref id="btx633-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Pedersen</surname><given-names>B.S.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) Fast and accurate alignment of long bisulfite-seq reads. <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1401.1129">https://arxiv.org/abs/1401.1129</ext-link>.</mixed-citation>
    </ref>
    <ref id="btx633-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stroud</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Non-CG methylation patterns shape the epigenetic landscape in <italic>Arabidopsis</italic></article-title>. <source>Nat. Struct. Mol. Biol</source>, <volume>21</volume>, <fpage>64</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">24336224</pub-id></mixed-citation>
    </ref>
    <ref id="btx633-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Thorvaldsdottir</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Integrative Genomics Viewer (IGV): high-performance genomics data visualization and exploration</article-title>. <source>Brief. Bioinformatics</source>, <volume>14</volume>, <fpage>178</fpage>–<lpage>192</lpage>.<pub-id pub-id-type="pmid">22517427</pub-id></mixed-citation>
    </ref>
    <ref id="btx633-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>swDMR: a sliding window approach to identify differentially methylated regions based on whole genome bisulfite sequencing</article-title>. <source>PLoS One</source>, <volume>10</volume>, <fpage>e0132866</fpage>.<pub-id pub-id-type="pmid">26176536</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
