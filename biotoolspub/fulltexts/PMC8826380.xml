<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8826380</article-id>
    <article-id pub-id-type="pmid">34864849</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab807</article-id>
    <article-id pub-id-type="publisher-id">btab807</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Isoform-level quantification for single-cell RNA sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pan</surname>
          <given-names>Lu</given-names>
        </name>
        <aff><institution>Department of Medical Epidemiology and Biostatistics, Karolinska Institutet</institution>, 17177 Stockholm, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dinh</surname>
          <given-names>Huy Q</given-names>
        </name>
        <aff><institution>McArdle Laboratory for Cancer Research, Department of Oncology, School of Medicine and Public Health, University of Wisconsin—Madison</institution>, Madison, WI 53705-227, <country country="US">USA</country></aff>
        <aff><institution>Department of Biostatistics and Medical Informatics, School of Medicine and Public Health, University of Wisconsin—Madison</institution>, Madison, WI 53726, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pawitan</surname>
          <given-names>Yudi</given-names>
        </name>
        <aff><institution>Department of Medical Epidemiology and Biostatistics, Karolinska Institutet</institution>, 17177 Stockholm, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7945-5750</contrib-id>
        <name>
          <surname>Vu</surname>
          <given-names>Trung Nghia</given-names>
        </name>
        <xref rid="btab807-cor1" ref-type="corresp"/>
        <aff><institution>Department of Medical Epidemiology and Biostatistics, Karolinska Institutet</institution>, 17177 Stockholm, <country country="SE">Sweden</country></aff>
        <!--trungnghia.vu@ki.se-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mathelier</surname>
          <given-names>Anthony</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab807-cor1">To whom correspondence should be addressed. <email>trungnghia.vu@ki.se</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-12-02">
      <day>02</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>02</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <volume>38</volume>
    <issue>5</issue>
    <fpage>1287</fpage>
    <lpage>1294</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>11</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>24</day>
        <month>11</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>11</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>09</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab807.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>RNA expression at isoform level is biologically more informative than at gene level and can potentially reveal cellular subsets and corresponding biomarkers that are not visible at gene level. However, due to the strong 3ʹ bias sequencing protocol, mRNA quantification for high-throughput single-cell RNA sequencing such as Chromium Single Cell 3ʹ 10× Genomics is currently performed at the gene level.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We have developed an isoform-level quantification method for high-throughput single-cell RNA sequencing by exploiting the concepts of transcription clusters and isoform paralogs. The method, called Scasa, compares well in simulations against competing approaches including Alevin, Cellranger, Kallisto, Salmon, Terminus and STARsolo at both isoform- and gene-level expression. The reanalysis of a CITE-Seq dataset with isoform-based Scasa reveals a subgroup of CD14 monocytes missed by gene-based methods.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Implementation of Scasa including source code, documentation, tutorials and test data supporting this study is available at Github: <ext-link xlink:href="https://github.com/eudoraleer/scasa" ext-link-type="uri">https://github.com/eudoraleer/scasa</ext-link> and Zenodo: <ext-link xlink:href="https://doi.org/10.5281/zenodo.5712503" ext-link-type="uri">https://doi.org/10.5281/zenodo.5712503</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Research Council (VR) and the Swedish Foundation for Strategic Research (SSF)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish National Infrastructure for Computing (SNIC)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004359</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2018-05973</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>RNA expression measurement based on sequencing technology (RNA-Seq) has progressed from bulk sequencing to highly multiplexed single-cell (sc) RNA-Seq (<xref rid="btab807-B21" ref-type="bibr">Svensson <italic toggle="yes">et al.</italic>, 2018</xref>). Computational methods have been developed to analyze single-cell RNA sequencing (scRNA-Seq) data from high-throughput protocols such as Chromium Single Cell 3ʹ 10× Genomics (<xref rid="btab807-B9" ref-type="bibr">Melsted <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btab807-B19" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab807-B23" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2017</xref>), but because of the strong 3ʹ bias due to polyA-based mRNA capture in library preparation, these methods only attempt gene-level quantification.</p>
    <p>Estimation of isoform expression is still a challenging problem for bulk RNA-Seq, and the problem is even harder for scRNA-Seq (<xref rid="btab807-B22" ref-type="bibr">Westoby <italic toggle="yes">et al.</italic>, 2020</xref>). We provide evidence that the use of methods originally developed to estimate transcript abundance for bulk RNA-Seq data (<xref rid="btab807-B1" ref-type="bibr">Bray <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab807-B12" ref-type="bibr">Patro <italic toggle="yes">et al.</italic>, 2014</xref>, <xref rid="btab807-B13" ref-type="bibr">2017</xref>) indeed leads to substantial quantification errors. The 3ʹ bias from high-throughput scRNA-Seq such as Chromium Single Cell 3ʹ 10× Genomics generates substantial similarities between the read statistics from different isoforms, making isoform-level quantification highly challenging. The 3ʹ bias reduces the number of reads from the 5ʹ end of the isoforms, thus reduces our ability to separate the isoforms. Furthermore, the bias can also break the symmetry in read sharing between isoforms which is often presumed by bulk RNA-Seq quantification methods. In the symmetric case, if isoform A generates reads that are shared with (map to) isoform B, then isoform B will likewise generate reads that are shared with isoform A. But in biased protocol, we observe asymmetric cases where, e.g. all shared reads between several isoforms originate from a single isoform A, but none of the other isoforms contribute reads shared with isoform A. The asymmetry happens when the 3ʹ exons of one isoform are close to the 5ʹ end of the other isoforms. Applying a bulk-based method, which ignores asymmetry, will lead to poor quantification. Several groups have made a great effort to estimate isoform-level expression from full-length scRNA-Seq data (<xref rid="btab807-B5" ref-type="bibr">Hu <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab807-B6" ref-type="bibr">Huang and Sanguinetti, 2017</xref>; <xref rid="btab807-B18" ref-type="bibr">Song <italic toggle="yes">et al.</italic>, 2017</xref>). Recently, STARsolo (<xref rid="btab807-B8" ref-type="bibr">Kaminow <italic toggle="yes">et al.</italic>, 2021</xref>) has attempted to quantify splicing events occurring at 3ʹ-end of transcripts in droplet-based scRNA-Seq data. However, this method does not perform isoform expression estimation. To our best knowledge, to date no method has been developed for isoform expression quantification from 3ʹ bias high-throughput scRNA-Seq data. To address these issues, we have developed Scasa to estimate isoform expression from scRNA-Seq data by relying on the concepts of transcription clusters and isoform paralogs.</p>
    <p>Conceptually, the most similar strategy is the transcript compatibility count (TCC) method (<xref rid="btab807-B10" ref-type="bibr">Ntranos <italic toggle="yes">et al.</italic>, 2016</xref>), providing group rather than individual transcript counts by calculating read counts in groups of highly similar transcripts, also known as equivalence classes of transcripts (<xref rid="btab807-B12" ref-type="bibr">Patro <italic toggle="yes">et al.</italic>, 2014</xref>). In principle, the equivalence classes obtained from TCCs provide a basis for single-cell-level transcript quantification by applying the expectation maximization (EM) algorithm using bulk RNA-Seq methods such as Kallisto (<xref rid="btab807-B1" ref-type="bibr">Bray <italic toggle="yes">et al.</italic>, 2016</xref>) or Salmon (<xref rid="btab807-B13" ref-type="bibr">Patro <italic toggle="yes">et al.</italic>, 2017</xref>). Another attempt is introduced in Terminus (<xref rid="btab807-B17" ref-type="bibr">Sarkar <italic toggle="yes">et al.</italic>, 2020</xref>) to use transcript grouping for quantification of isoform expression from bulk RNA-Seq data. This method utilizes the output of Salmon to group together transcripts in an experiment based on their inferential uncertainty. We have implemented these bulk-based approaches as comparative methods and refer to them with their original names. [We note that the authors of these methods have developed new tools (<xref rid="btab807-B9" ref-type="bibr">Melsted <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btab807-B19" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2019</xref>) for scRNA-Seq data that are gene-based, so the use of the original bulk RNA-Seq tools here is performed only for the purpose of comparing isoform-level quantification results.]</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Overview of Scasa</title>
      <p>An overview of the Scasa procedure for isoform expression estimation is presented in <xref rid="btab807-F1" ref-type="fig">Figure  1a</xref>. The Scasa protocol consists of three main components: (i) estimation of transcript abundance (<italic toggle="yes">β</italic>) using an alternating expectation maximization (AEM) algorithm, (ii) processing of scRNA-Seq data to produce read-count data (<italic toggle="yes">Y</italic>) and (iii) <italic toggle="yes">in</italic> <italic toggle="yes">silico</italic> identification of transcription clusters (TCs) and isoform paralogs and construction of an initial design matrix (<italic toggle="yes">X</italic>) for each TC. Scasa is tailored for use with high-throughput scRNA-Seq technologies with a unique molecular identifier (UMI) barcoding procedure. Scasa takes advantage of the efficient preprocessing already provided by existing pseudoaligners such as Kallisto-bustools (<xref rid="btab807-B9" ref-type="bibr">Melsted <italic toggle="yes">et al.</italic>, 2021</xref>) or Alevin (<xref rid="btab807-B19" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2019</xref>) to produce a read-count equivalent-class matrix. Using the unique barcode sequences, Scasa splits the equivalence class output by cell (<xref rid="btab807-F1" ref-type="fig">Fig.  1a</xref>) and applies the AEM algorithm to multiple cells together. These procedures are described in detail below.</p>
      <fig position="float" id="btab807-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Scasa workflow and its performance against existing quantification tools. (<bold>a</bold>) The Scasa workflow consists of three main parts: (i) fitting the statistical model <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>∼</mml:mo><mml:mi>X</mml:mi><mml:mo>β</mml:mo></mml:mrow></mml:math></inline-formula> using an AEM algorithm, based on (ii) mapping of the scRNA-Seq data to produce count matrix <italic toggle="yes">Y</italic> and (iii) the <italic toggle="yes">in silico</italic> construction of the transcription clusters and isoform paralogs to obtain the initial <italic toggle="yes">X</italic> matrices. (<bold>b</bold>) A simulation study (<italic toggle="yes">n</italic> = 3955 cells) indicates that Scasa performs well against existing methods in terms of isoform quantification. Isoform-level estimates are plotted against the true values. (<bold>c</bold>) From left to right: boxplots of the APE ratios of Kallisto and Salmon against Scasa for all isoforms (<italic toggle="yes">n</italic> = 12 203 truly expressed isoforms) and for non-paralog isoforms (<italic toggle="yes">n</italic> = 1342); boxplots of APE ratios for gene-level quantification methods against Scasa (<italic toggle="yes">n</italic> = 8052 truly expressed genes); boxplots of APE ratios for singleton genes (<italic toggle="yes">n</italic> = 2318)</p>
        </caption>
        <graphic xlink:href="btab807f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Statistical model and AEM algorithm</title>
      <p>Each read <italic toggle="yes">r<sub>i</sub></italic> from an RNA-Seq dataset maps to a set of <italic toggle="yes">k</italic> isoforms <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>; this set defines an equivalence class (eqClass) of all reads that map to the set. Therefore, conceptually, all sequence reads from a cell can be summarized in a read-count vector <italic toggle="yes">y</italic> that represents all eqClasses from the cell. This is performed separately for each cell. In theory, selecting a read from an annotated transcript sequence, which is similar to the protocol to generate a read of RNA sequencing, can be considered as a Poisson process. Here, the process is extended to approximate the selection from the sequences of the transcript set of an equivalence class. So, the underlying statistical model in Scasa assumes that <italic toggle="yes">y</italic> is Poisson with mean <italic toggle="yes">μ</italic> that follows the bilinear model
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mo>μ</mml:mo><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mo>β</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where µ is the vector of the expected number of reads mapped to all eqClasses, <italic toggle="yes">β</italic> is the vector of isoform expression values and <italic toggle="yes">X</italic> is the design matrix summarizing exon sharing between isoforms. The elements of <italic toggle="yes">X</italic> transfer the transcript abundance to eqClass counts. Standard isoform-level quantification tools such as Kallisto (<xref rid="btab807-B1" ref-type="bibr">Bray <italic toggle="yes">et al.</italic>, 2016</xref>) or Salmon (<xref rid="btab807-B13" ref-type="bibr">Patro <italic toggle="yes">et al.</italic>, 2017</xref>) use the same linear model, but the <italic toggle="yes">X</italic> matrix is assumed to be known and appears only implicitly in their algorithm (computed based on exon sharing between isoforms). In contrast, in Scasa, the matrix <italic toggle="yes">X</italic> is explicit, and both <italic toggle="yes">X</italic> and <italic toggle="yes">β</italic> are treated as unknown parameters.</p>
      <p>Hg38 is used as the transcriptome reference, <italic toggle="yes">β</italic> is of length ∼71 000 isoforms, and <italic toggle="yes">y</italic> of length ∼136 000, so <italic toggle="yes">X</italic> is a matrix of size ∼136 000 × 71 000. The estimation of <italic toggle="yes">X</italic> is clearly not feasible without exploiting the fact that isoforms are naturally organized into independent TCs, so <italic toggle="yes">X</italic> can be broken down into many small <italic toggle="yes">X</italic>s that can be analyzed separately. In principle, once an initial <italic toggle="yes">X</italic> is available for each TC, given <italic toggle="yes">Y</italic><inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mo> ≡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the matrix of collated read-count data from <italic toggle="yes">n</italic> cells, the estimation proceeds as follows:</p>
      <p>
        <disp-quote content-type="extract">
          <p>0. Start with an initial <italic toggle="yes">X</italic>.</p>
          <p>1. Given <italic toggle="yes">Y</italic> and <italic toggle="yes">X</italic>, use the EM algorithm to estimate isoform abundance (<italic toggle="yes">β</italic>) (EM Step 1 in <xref rid="btab807-F1" ref-type="fig">Fig.  1a</xref>) based on the linear model <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where the subscript <italic toggle="yes">j</italic> refers to the equivalent class, <italic toggle="yes">t</italic> refers to the transcript and <italic toggle="yes">c</italic> refers to the cell. The algorithm applies to each cell.</p>
          <p>2. Given <italic toggle="yes">Y</italic> and <italic toggle="yes">β</italic>, use the EM algorithm to update design matrix <italic toggle="yes">X</italic> (EM Step 2 in <xref rid="btab807-F1" ref-type="fig">Fig.  1a</xref>) based on the linear model <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where data from all the cells are now combined.</p>
          <p>3. Iterate between 2 and 3 until convergence.</p>
        </disp-quote>
      </p>
      <p>The joint estimation procedure is called an AEM algorithm, for which the exact formulas are given in <xref rid="btab807-B2" ref-type="bibr">Deng <italic toggle="yes">et al.</italic> (2020)</xref>. At convergence, the output <italic toggle="yes">β</italic> represents the estimated transcript abundances for individual cells.</p>
    </sec>
    <sec>
      <title>2.3 Processing of scRNA-Seq to produce read-count data</title>
      <p>Scasa allows the use of scRNA-Seq data from high-throughput scRNA-Seq protocols, such as the Chromium Single Cell 3ʹ 10× Genomics protocol, and includes read mapping to a reference transcriptome and counting of the supporting reads of eqClasses from each cell. Read mapping and read counting for eqClasses are implemented using available external tools such as Alevin (<xref rid="btab807-B19" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2019</xref>) or Kallisto-bustools (<xref rid="btab807-B9" ref-type="bibr">Melsted <italic toggle="yes">et al.</italic>, 2021</xref>). Computational details are shown in the Scasa Wiki page on GitHub repository: <ext-link xlink:href="https://github.com/eudoraleer/Scasa_Paper/wiki" ext-link-type="uri">https://github.com/eudoraleer/Scasa_Paper/wiki</ext-link>.</p>
    </sec>
    <sec>
      <title>2.4 Construction of initial design matrix <italic toggle="yes">X</italic></title>
      <p>Droplet-based protocols, such as the Chromium Single Cell 3ʹ 10× Genomics approach, typically produce strongly 3ʹ-biased sequences due to the polyA tail capture of mRNAs. This violates the standard assumption applied in isoform quantification methods for bulk RNA-Seq, which presumes that the RNA sequences are relatively uniformly distributed. The key methodological innovation of Scasa is the <italic toggle="yes">in</italic> <italic toggle="yes">silico</italic> construction of the TCs, each with a corresponding initial design matrix <italic toggle="yes">X</italic> that adapts to the actual sequencing protocol used. As discussed previously (<xref rid="btab807-B2" ref-type="bibr">Deng <italic toggle="yes">et al.</italic>, 2020</xref>), <italic toggle="yes">X</italic> also automatically accounts for unknown biases in a sequencing protocol. Moreover, an explicitly available <italic toggle="yes">X</italic> makes the statistical processing of the paralogs (isoforms with highly similar sequences) tractable.</p>
      <p>We constructed the initial <italic toggle="yes">X</italic> matrix <italic toggle="yes">in silico</italic> for all isoforms in the transcriptome. However, instead of generating standard bulk RNA-Seq paired-end reads with a uniform read distribution, we simulated scRNA-Seq mimicking the settings of the Chromium Single Cell 3ʹ 10× Genomics method (see Section 2.6). Briefly, each isoform was simulated with the number of reads set to twice the transcript length but with a minimum of 1000. The steps are as follows:
</p>
      <list list-type="order">
        <list-item>
          <p>Map each read to the transcriptome reference; hg38 is used throughout.</p>
        </list-item>
        <list-item>
          <p>Identify the eqClasses associated with each isoform.</p>
        </list-item>
        <list-item>
          <p>Group the isoforms into TCs such that all isoforms that belong to the overlapping eqClasses are included in one cluster.</p>
        </list-item>
        <list-item>
          <p>Summarize all the reads from the eqClasses and isoforms that belong to one TC in a matrix; see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1a</xref> for illustration.</p>
        </list-item>
        <list-item>
          <p>Normalize the columns of the matrix to 1. This is the initial <italic toggle="yes">X</italic> matrix associated with a TC.</p>
        </list-item>
        <list-item>
          <p>Identify the paralogs and merge the appropriate columns of <italic toggle="yes">X</italic>; see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1b</xref>. This is described in more detail below.</p>
        </list-item>
      </list>
      <p>We used the approach of <xref rid="btab807-B2" ref-type="bibr">Deng <italic toggle="yes">et al.</italic> (2020)</xref> to merge highly similar isoforms into isoform paralogs. Theoretically, the number of non-zero singular values of <italic toggle="yes">X</italic> determines the number of estimable paralogs; in practice, we set a low non-zero threshold (1/30). The paralogs are then constructed using <italic toggle="yes">k</italic>-means clustering. For illustration purposes, we use the TC associated with the RPL13A gene, which contains five isoforms. The original <italic toggle="yes">X</italic> matrix is the normalized version of the matrix in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1a</xref>. Its singular values are 1.632, 0.868, 0.692, 0.004 and 0.001, clearly indicating the need to reduce the parameters to three estimable paralogs. <italic toggle="yes">k</italic>-means clustering produces one paralog of size three and preserves two original isoforms. The merged <italic toggle="yes">X</italic> matrix is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1b</xref>; the paralog members show highly similar columns in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1a</xref>. Not using the paralogs, e.g. the standard tool Salmon, results in poor estimation of the expression of the isoforms (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2b and c</xref>). In contrast, Scasa estimates paralog expression well.</p>
    </sec>
    <sec>
      <title>2.5 Accuracy metrics</title>
      <p>For comparisons between different methods applied to simulated data, we computed a symmetric absolute proportion error (APE) for each transcript <italic toggle="yes">i</italic> in each cell as
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>APE</mml:mtext></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">t<sub>i</sub></italic> is the true abundance of individual gene <italic toggle="yes">i</italic> or transcript <italic toggle="yes">i</italic>, and <italic toggle="yes">e<sub>i</sub></italic> is the corresponding estimated abundance. A pseudocount of 1 is added to the denominator to avoid division by zero. In the real sample of human peripheral blood mononuclear cells (PBMCs) upon which we base the simulation, there is a large proportion of isoforms/genes (∼93–94%) with zero expression across cells, and the estimation methods produce concordant zero APE values for them, so they are not informative toward the comparisons. Theoretically, in a paired comparison between two methods, the comparison of performance should be more sensitive in situations where the two methods have discordant APE values than in situations where they have the same APE. We thus limit the comparisons to transcripts (in any cell) that produce discordant APE values, and we can meaningfully compute their ratios. The APE ratio of transcript <italic toggle="yes">i</italic> (in any cell) between Scasa and a competing method is computed as
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mtext>Method</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>APE</mml:mtext></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mtext>Method</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>0.1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>APE</mml:mtext></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mtext>Scasa</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the constant 0.1 is added to reduce the variability in the ratio because the APE values are often close to zero. The effect is also to attenuate the ratio. For example, if APE<sub><italic toggle="yes">i</italic></sub>(Method) = 0.2 and APE<sub><italic toggle="yes">i</italic></sub>(Scasa) = 0.01, the raw ratio is 20, but the attenuated ratio is 0.3/0.11 = 2.73. A ratio &gt;1 indicates that Scasa performs better. Ratios are summarized and reported in boxplots. For a simpler comparison, we also compute the proportion of APE<sub><italic toggle="yes">i</italic></sub>(Scasa) &lt; APE<sub><italic toggle="yes">i</italic></sub>(Method) whenever the two APE values are discordant. To make the paralogs comparable, they are split into individual members, each carrying the APE of the source paralog.</p>
    </sec>
    <sec>
      <title>2.6 Simulated dataset</title>
      <p>The purpose of generating simulated data was to ensure that accuracy could be measured against the ground truth. We also sought to compare our software with other existing quantification software using simulated data. We first created simulated 3ʹ-biased paired-end scRNA-Seq data using the Polyester RNA-Seq read simulator (<xref rid="btab807-B4" ref-type="bibr">Frazee <italic toggle="yes">et al.</italic>, 2015</xref>) with human reference genome hg38 to model the simulation as close as to the end-biased real data from 10× Genomics as possible by mimicking the read length and fragment length distribution (i.e. average and standard deviation). We revised the biased model of Polyester so that its bias was similar to the 3ʹ bias of the Chromium Single Cell 3ʹ 10× Genomics method. Specifically, for a transcript read pair, we fixed the 3ʹ read at the 3ʹ end of the transcript and varied the 5ʹ read. All parameters of the simulation are listed in Scasa Wiki on GitHub.</p>
      <p>Since we were measuring the accuracy of counts at the single-cell transcript level, we also modeled the transcript-count ratio of a given gene in the simulated data by using the single-cell transcript-ratio reference from full-length Smart-Seq2 data (<xref rid="btab807-B3" ref-type="bibr">Ding <italic toggle="yes">et al.</italic>, 2020</xref>). Since Smart-Seq2 is a full-length RNA-Sequencing method for single cells, isoform quantification could be used without strong end bias effect to infer transcript ratios for our simulation. To mimic actual cell-wise and gene-wise read depth from droplet-based scRNA-Seq data, we referenced the read depth for each gene from one healthy human PBMC donor [Single Cell Gene Expression Datasets (Single Cell 3ʹ v3), Chromium Connect Channel 1, 10× Genomics] (February 28, 2020).</p>
      <p>We post-processed the simulated output from Polyester by replacing complementary read 1 of the paired-end reads with cell barcode and UMI sequences that were representative of the actual sample data from 10× single-cell gene expression data (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). The 16-base-pair (bp) cell barcodes used in these cases were taken from the most recent barcode whitelist of 10× Genomics, which includes a total of 3 million cell barcodes that can be sampled. The 12-bp UMI sequences that were used to identify unique RNA molecules were generated at random to ensure that all unique generated RNA molecules were covered. Thus, no correction was needed for cell barcodes or UMIs in these simulated data. The final paired-end single-cell-level simulated data consisted of read 1 as the read sequence containing cell barcode and UMI information, while each of complementary read 2 contained information of the mapped sequences corresponding to the unique cell and unique RNA molecule, as indicated in read 1. The detailed code for producing the simulated data is provided on the Scasa GitHub website.</p>
    </sec>
    <sec>
      <title>2.7 Comparative methods</title>
      <p>We ran the simulated data with (i) Scasa (single-cell isoform/gene expression quantification), (ii) Cellranger (single-cell gene expression quantification), (iii) Kallisto-bustools (single-cell gene expression quantification), (iv) Alevin (single-cell gene expression quantification), (v) STARsolo (<xref rid="btab807-B8" ref-type="bibr">Kaminow <italic toggle="yes">et al.</italic>, 2021</xref>) (single-cell gene expression quantification), (vi) Kallisto (bulk RNA-Seq isoform/gene expression quantification), (vii) Salmon (bulk RNA-Seq isoform/gene expression quantification) and (viii) Terminus (<xref rid="btab807-B17" ref-type="bibr">Sarkar <italic toggle="yes">et al.</italic>, 2020</xref>) (bulk RNA-Seq isoform expression quantification, which uses the output of Salmon for transcript grouping) and compared their quantification results with the ground truth from simulated data. It is worth noting that in the simulated dataset, we focused on the performance of gene/isoform quantification by individual methods. Barcode and UMI correction were not assessed in the simulation setting and would not have any effect on the results. Both Kallisto and Salmon were run on the RNA reads in the single-end mode of the individual tools to quantify isoform- and gene-level expression. Gene expression levels were calculated with Scasa by summing up the isoform counts of each gene; paralog expression was calculated similarly by summing up the member isoforms.</p>
    </sec>
    <sec>
      <title>2.8 Real datasets</title>
      <sec>
        <title>2.8.1 CITE-Seq data</title>
        <p>Bone marrow mononuclear cell CITE-Seq single-cell data from a recently published paper (<xref rid="btab807-B20" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>) (GEO accession number: GSE128639) were used as a real data benchmark. RNA-Seq measurements from this dataset were used for comparison and validation. For comparison, we ran this dataset with Scasa to obtain gene-level and isoform-level gene expression, we used Alevin to obtain gene-level gene expression values following the Alevin tutorial (<ext-link xlink:href="https://combine-lab.github.io/alevin-tutorial/2020/alevin-features/" ext-link-type="uri">https://combine-lab.github.io/alevin-tutorial/2020/alevin-features/</ext-link>), and we collected the gene-level gene expression data of Cellranger from the original publication downloaded from <ext-link xlink:href="https://github.com/satijalab/seurat-data" ext-link-type="uri">https://github.com/satijalab/seurat-data</ext-link>. For fair comparison with Cellranger, only single cells with the same barcode IDs among Cellranger, Alevin and Scasa were used (<italic toggle="yes">n</italic> = 20 840 cells).</p>
        <p>Dimension reduction for abundance estimates was carried out for each of the quantification methods used (i.e. Scasa, Alevin and Cellranger) for the CITE-Seq data, and clustering was performed with homogenous settings for each method. Specifically, we followed the description from the original study (<xref rid="btab807-B20" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>) and the tutorial from the vignettes of Seurat package version 4.0.0. Normalization, feature selection and standardization for isoform/gene expression were performed with the default settings by using the NormalizeData, FindVariableFeatures and ScaleData functions of the Seurat package (<xref rid="btab807-B20" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>), followed by the RunPCA and RunUMAP functions for dimension reduction. Clusters were identified based on the first 30 PCA components using the FindNeighbors and FindClusters functions. The pathway analysis for the DE gene set was performed by using Reactome (<xref rid="btab807-B7" ref-type="bibr">Jassal <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
        <p>Details of the scripts used for implementation are provided in the Scasa Wiki and on the Scasa website. To obtain differentially expressed markers between the TY32.25 Mono and CD14 Mono groups, we used the logistic regression differential expression (DE) test (<xref rid="btab807-B11" ref-type="bibr">Ntranos <italic toggle="yes">et al.</italic>, 2019</xref>) implemented with the FindMarkers function of Seurat. Only genes/isoforms detected in 25% of either of the two groups were considered. To correct for the occurrence of false positives brought about by multiple testing, we used the false discovery rate (FDR) (<xref rid="btab807-B14" ref-type="bibr">Pawitan <italic toggle="yes">et al.</italic>, 2005</xref>). Significant markers were chosen according to a threshold of an FDR &lt; 0.05.</p>
      </sec>
      <sec>
        <title>2.8.2 Smart-Seq2 bone marrow data</title>
        <p>Smart-Seq2 scRNA-Seq data (ArrayExpress: E-MTAB-9067) for 3055 bone marrow cells from the femora and hips of 15 human fetuses were collected for the validation of TY32.25. The annotations of the cells were collected from the original study (<xref rid="btab807-B16" ref-type="bibr">Ranzoni <italic toggle="yes">et al.</italic>, 2021</xref>). We applied Salmon (<xref rid="btab807-B13" ref-type="bibr">Patro <italic toggle="yes">et al.</italic>, 2017</xref>) to the Smart-Seq2 scRNA-Seq dataset using the hg38 annotation to perform isoform quantification. We then used the same procedure applied to the CITE-Seq data for cluster analysis to identify clusters from the isoform expression data of the bone marrow cells.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Strong 3ʹ bias challenges isoform quantification in scRNA-Seq</title>
      <p>The key difference between bulk RNA-Seq and scRNA-Seq data is highlighted in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> in terms of the paralog structure. Among the 70 865 isoforms in the hg38 transcriptome reference, 52 046 (73.3%) are separately quantifiable (paralogs of size 1) according to bulk RNA-Seq data; the rest (26.7%) belonged to paralogs of size 2 or more. In contrast, the 3ʹ bias in the scRNA-Seq data reduces the number of separately quantifiable isoforms to 21 287 (30.0%). Among this last group, 13 753 isoforms belong to singleton genes, so there are still 7534 non-paralog isoforms belonging to multi-isoform genes that are separately quantifiable in the scRNA-Seq data.</p>
      <p>Isoform paralogs with high similarity in their sequences result in high similarity in the corresponding columns in the <italic toggle="yes">X</italic> matrix. Full similarity causes the <italic toggle="yes">X</italic> matrix to be singular and the <italic toggle="yes">β</italic> parameter to be non-identifiable; near similarity causes the <italic toggle="yes">X</italic> matrix to be poorly conditioned and creates estimation problems. The strong 3ʹ bias in 10× Genomics sequencing also increases the similarity between isoforms in the <italic toggle="yes">X</italic> matrix. This is illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2a</xref>, where the isoforms of the RPL13A gene are not distinguishable at the 3ʹ end. Ignoring these paralogs would lead to poor estimation (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2b</xref>); in contrast, by properly identifying the paralog Scasa is able to yield much more precise quantification (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2c</xref>).</p>
      <p>The bias also breaks the symmetry in read sharing between isoforms, an important condition presumed by bulk RNA-Seq methods. For example, in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1a</xref>, the binary code 01011 of the eqClass at row 3 conveys that all reads of this eqClass are mapped to three isoforms NM_012423, NR_026712 and NR_073024. However, following the values in row 3, only NR_026712 contributes 22 reads to this eqClass, while both NM_012423 and NR_073024 contribute no reads to this set. The reason is that the 3ʹ exons of NR_026712 are close to the 5ʹ end of the other isoforms such that the reads of these latter isoforms cannot map to NR_026712. A bulk RNA-based method that ignores this problem performs poorly (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3a</xref>). The problem does not appear in bulk RNA-Seq data, so the method performs much better (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3b</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
    </sec>
    <sec>
      <title>3.2 Scasa outperforms other methods in simulated data</title>
      <p>We used simulated data generated with Polyester (<xref rid="btab807-B4" ref-type="bibr">Frazee <italic toggle="yes">et al.</italic>, 2015</xref>) to compare Scasa against Cellranger (<xref rid="btab807-B23" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2017</xref>), Kallisto-bustools (<xref rid="btab807-B9" ref-type="bibr">Melsted <italic toggle="yes">et al.</italic>, 2021</xref>), Alevin (<xref rid="btab807-B19" ref-type="bibr">Srivastava <italic toggle="yes">et al.</italic>, 2019</xref>), STARsolo (<xref rid="btab807-B8" ref-type="bibr">Kaminow <italic toggle="yes">et al.</italic>, 2021</xref>), Kallisto (<xref rid="btab807-B1" ref-type="bibr">Bray <italic toggle="yes">et al.</italic>, 2016</xref>), Salmon (<xref rid="btab807-B13" ref-type="bibr">Patro <italic toggle="yes">et al.</italic>, 2017</xref>) and Terminus (<xref rid="btab807-B17" ref-type="bibr">Sarkar <italic toggle="yes">et al.</italic>, 2020</xref>). The first four methods are gene-based quantification methods designed for scRNA-Seq data, while the last three are designed for bulk RNA-Seq data. For the isoform-based quantification methods, a comparative gene-level value was computed as the sum of component isoforms according to the transcriptome reference. In the simulation (see Section 2.6), since the RNA reads of individual cells could be separate and independent from cell barcodes and UMIs, these bulk RNA-Seq methods could be run on the data in single-end read mode to obtain both isoform-level and gene-level expression.</p>
      <p>At the isoform level, Scasa was compared against Kallisto, Salmon and Terminus for (i) all isoforms and (ii) non-paralog isoforms, which are isoforms that belong to multi-isoform genes but not to any paralog. Singleton isoforms, which belong to single-isoform genes, were compared at the gene level. At the gene level, Scasa was compared against all of the other methods. Gene-level comparisons were performed for (i) all genes and (ii) singleton genes. The quality of quantification by each method was expressed in terms of the absolute proportion of error (APE) in the estimated abundance versus the true counts (see Sections 2 and 2.5 for details). The methods are compared in two ways: (i) according to the ratio of the APE of the competing method to the APE of Scasa, where an APE ratio &gt;1 indicated that the performance of Scasa was better (the APE ratios are summarized in boxplots); and (ii) according to the proportion of Scasa APE that is less than the APE of the competing methods, a proportion &gt;0.5 indicates that the performance of Scasa is better than the competing method (<xref rid="btab807-F1" ref-type="fig">Fig.  1c</xref>). Scasa also outperforms Terminus, a method that allows transcript grouping from the output of Salmon. The distribution of paralog size of Terminus (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>) is similar to the pattern for bulk RNA-Seq data, indicating that Terminus seems to treat the scRNA-Seq data similarly to the bulk RNA-Seq data.</p>
      <p><xref rid="btab807-F1" ref-type="fig">Figure  1b</xref> shows the true versus estimated abundances at the isoform level for Scasa, Kallisto and Salmon, clearly demonstrating the high noise levels of the quantification methods developed for the bulk RNA-Seq data. In addition to exhibiting high variability, Kallisto has a bias problem that we cannot explain. Similar plots at the gene level are presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4a</xref>. The boxplots of the APE ratios in <xref rid="btab807-F1" ref-type="fig">Figure  1c</xref> show that Scasa performs well overall against the existing methods in all categories of isoform- and gene-level quantification. The most similar performance is observed between Scasa and Salmon for non-paralog isoforms, which are isoforms that belong to multi-isoform genes but not to any paralogs. Among the existing methods that provide gene-level quantification, Alevin and STARsolo perform relatively well. These results are corroborated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>, which shows that Scasa produces a higher proportion of lower APE values than any of the other methods.</p>
    </sec>
    <sec>
      <title>3.3 Scasa reveals a novel subgroup of CD14 monocytes</title>
      <p>The simulation results led us to ask how isoform quantification would improve cell-type identification through scRNA-Seq. To address this question, we used publicly available 10× Chromium CITE-Seq data for bone marrow mononuclear cells (<xref rid="btab807-B20" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>), as the combined use of RNA and antibodies significantly improved cell-type identification and annotation. Through the isoform-level quantification of the same data, Scasa (Scasa isoform) identified a distinct subgroup of CD14 monocytes (<xref rid="btab807-F2" ref-type="fig">Fig.  2a</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). This monocyte subset was largely annotated as CD14 monocytes (420/454 cells, 92.5%) and was missed by gene-level quantification using Scasa-gene, Cellranger and Alevin (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4b</xref>). DE analysis identified eight isoforms (<xref rid="btab807-F2" ref-type="fig">Fig.  2b</xref>) from five genes, TYROBP, HLA-DPA1, RNASE6, FCGRT and LGALS2, as statistically significant DE isoforms between this monocyte subset and the rest of the CD14+ monocytes (<xref rid="btab807-B14" ref-type="bibr">Pawitan <italic toggle="yes">et al.</italic>, 2005</xref>; FDR &lt; 0.05; <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>).</p>
      <fig position="float" id="btab807-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Isoform-level quantification from Scasa unveil new cell-type cluster and differential expressed isoforms. (<bold>a</bold>) UMAP of isoform quantification from Scasa using a bone marrow dataset and cell annotations queried from the original study 12. Arrow points to a distinct subgroup of CD14 monocytes (which we will call it TY32.25 Mono here) discovered via Scasa isoform quantification. (<bold>b</bold>) Heatmap of median expression of isoforms in each cluster, including TY32.25 Mono. Each cluster (row) is annotated by the most dominant cell types of single cells in that cluster. Mutually exclusive expression pattern of TYROBP isoforms (highlighted in purple and green in the <italic toggle="yes">x</italic> axis labels) are observed in the TY32.25 Mono group. Size of each square is proportional to the percentage of cells expressing the isoform in their corresponding cell-type group. Color gradient represents the mean expression of the isoforms in each cell-type group. For convenience, the clusters with low total expression of the isoforms are excluded from the plot. NM-0012425 (24–25) refers to two isoforms, NM-001242524 and NM-001242525. (<bold>c</bold>) Boxplot of the isoforms of TYROBP gene in the TY32.25 Mono group and the other mono groups from the Smart-Seq2 dataset. Full-length-transcript Smart-Seq2 data from the bone marrow cells of 15 human fetuses 14 is used in this validation. (<bold>d</bold>) Patterns of the differential expressed isoforms of TYROBP gene observed in all cells, with distinct observation in the TY32.25 Mono group as indicated in (a)</p>
        </caption>
        <graphic xlink:href="btab807f2" position="float"/>
      </fig>
      <p>Interestingly, the top four DE isoforms all came from the transmembrane immune signaling adaptor gene TYROBP (<xref rid="btab807-F2" ref-type="fig">Fig.  2d</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6a</xref>). Statistically, these isoforms showed substantially higher significance (FDR <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mo>≤</mml:mo></mml:math></inline-formula> 4E−139) than the next most significant isoform paralog from the HLA-DPA1 gene (FDR = 0.0019); see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref> for detailed results. However, the expression at gene level for TYROBP shows no difference across different quantification methods as compared to its isoform-level quantification (<xref rid="btab807-F2" ref-type="fig">Fig.  2d</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4c</xref>). The significant biological pathways enriched with DE genes are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>, where the interferon gamma signaling pathway is ranked at the top. We found isoform-specific expression of TYROBP in CD14 monocytes, in which NM_198125 and NM_003332 were highly expressed in the new subset, whereas the majority of CD14 monocytes expressed the paralog isoform NM001173514-NR_033390 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6b</xref>).</p>
      <p>To validate these findings, we used independent full-length scRNA-Seq data for human bone marrow (<xref rid="btab807-B16" ref-type="bibr">Ranzoni <italic toggle="yes">et al.</italic>, 2021</xref>) generated via the Smart-Seq2 protocol[15]. The Smart-Seq2 scRNA-Seq data allowed isoform quantification to be conducted, since full-length transcript sequencing of single cells is performed in this method (<xref rid="btab807-B15" ref-type="bibr">Picelli <italic toggle="yes">et al.</italic>, 2014</xref>). We used Salmon7 to obtain isoform expression levels, and we performed clustering and cell-type identification (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). A cluster of 83 monocytes (out of 318 cells) expressing the two dominant TYROBP isoforms, NM_198125 and NM_003332, was identified (<xref rid="btab807-F2" ref-type="fig">Fig.  2c</xref>). The results suggested that the monocyte subset identified from 10× 3ʹ data indeed expressed TYROBP in an isoform-specific manner. We did not, however, observe clear mutually exclusive expression of the two isoform groups, as found in the 10× data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>), potentially due to biological differences between the two datasets (e.g. adult cells in the CITE-Seq data versus fetal cells in the Smart-Seq2 data).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Isoforms are the result of alternative splicing, a regulatory process of inclusion and exclusion of exons from the same gene. Even though they have highly similar sequences, the different isoforms of the same gene can have different biological functions. Estimation of isoform expression is still a challenging problem for both bulk RNA-Seq and scRNA-Seq (<xref rid="btab807-B22" ref-type="bibr">Westoby <italic toggle="yes">et al.</italic>, 2020</xref>). In principle, many isoform quantification software designed for bulk RNA-Seq can be utilized for scRNA-Seq datasets. However, we showed that the bulk RNA-Seq methods did not perform well for the high-throughput scRNA-Seq with a strong 3ʹ bias such as 10× Genomics. The bias increases substantially the similarities between the read statistics from different isoforms, and breaks the symmetry in read sharing between them, making the quantification highly challenging for the bulk RNA-Seq methods. We have developed Scasa to deal with this challenge and showed that it was able to accurately quantify isoform expression for 10× 3ʹ scRNA-Seq data and it performed well against competing methods.</p>
    <p>Scasa relies on the concepts of transcription clusters and isoform paralogs, which are inherited from XAEM (<xref rid="btab807-B2" ref-type="bibr">Deng <italic toggle="yes">et al.</italic>, 2020</xref>). As an extension of XAEM, Scasa formalizes and clarifies the issues caused by the 3ʹ-end bias in the droplet-based scRNA-Seq data. The novel contributions include (i) processing the sample data to produce the count matrix <italic toggle="yes">Y</italic> from highly multiplexed cells and (ii) the <italic toggle="yes">in</italic> <italic toggle="yes">silico</italic> construction of transcription cluster to take into account the asymmetry issue and the high proportion of isoform paralogs, specifically occurring in the strong 3ʹ bias scRNA-Seq data. In an application to a 10× Chromium CITE-Seq dataset, we identified an isoform-specific cellular subset that was only detectable in full-length scRNA-Seq data. Further applications of Scasa to various types of biological and clinical data could potentially reveal more cellular subsets and corresponding biomarkers that are not visible at the gene level.</p>
    <p>In the simulation study, the initial <italic toggle="yes">X</italic> matrix in Scasa and the simulated data are based on the same simulator (Polyester). We investigate whether this confers a special advantage to Scasa. To do that, we utilize RNASeqReadSimulator (<ext-link xlink:href="https://github.com/davidliwei/RNASeqReadSimulator" ext-link-type="uri">https://github.com/davidliwei/RNASeqReadSimulator</ext-link>) to generate a new 10× Genomics simulated dataset of 3955 single cells, using the same setting as we did for the simulated data generated from Polyester. The same analysis procedures as before for Scasa, Kallisto, Kallisto-Bustools, Cellranger, Salmon and Alevin are performed on the new simulated dataset. For Scasa, we use the initial design matrix <italic toggle="yes">X</italic> constructed <italic toggle="yes">in</italic> <italic toggle="yes">silico</italic> using Polyester. The results reported in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S10</xref> show that Scasa generally still performs well against the competing methods at both isoform level and gene level; Scasa’s performance is comparable to Salmon for non-paralogs, and to Alevin for gene-level estimation. Thus, the use of the same simulator for initialization and data generation does not give a special advantage to Scasa over other methods.</p>
    <p>In this study, we have evaluated Scasa for Chromium Single Cell 3ʹ 10× Genomics, the most commonly used high-throughput scRNA-Seq. However, Scasa is not limited to run only on the droplet-based method. Conceptually the method could be applicable to any high-throughput scRNA-Seq method with either 3ʹ or 5ʹ bias. The key step was to build an appropriate initial <italic toggle="yes">X</italic> matrix that corresponds to the scRNA-Seq protocol; specific instructions are given in the Scasa webpage. Scasa can also run independently as long as the equivalent classes of single cell are provided. Thus, Scasa can be used as a plug-in module for the current tools developed for gene-level quantification such as Alevin and Kallisto-bustools where the steps of quality of mapping, barcode correction and read processing are already well developed.</p>
    <p>For its limitation, Scasa cannot estimate all the isoforms available in the annotation reference. This is because isoforms with high similarity in their sequences are statistically unidentifiable from each other. Scasa resolves the problem by combining them into paralogs to improve the estimation accuracy, but compensates for the number of identifiable isoforms. Further characterization of the isoform members of an interesting paralog requires extra information and perhaps experiments, but this is out of the scope of the current study.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab807_Supplementary_Data</label>
      <media xlink:href="btab807_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>The authors acknowledge Xuexin Li for naming the Scasa software.</p>
    <sec>
      <title>Funding</title>
      <p>This work was partially supported by research grants from the Swedish Research Council (VR) and the Swedish Foundation for Strategic Research (SSF). The computations were enabled by resources provided by the Swedish National Infrastructure for Computing (SNIC) in Uppsala, which is partially funded by the Swedish Research Council under Grant 2018-05973.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared. </p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab807-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bray</surname><given-names>N.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Near-optimal probabilistic RNA-seq quantification</article-title>. <source>Nat. Biotechnol</source>., <volume>34</volume>, <fpage>525</fpage>–<lpage>527</lpage>.<pub-id pub-id-type="pmid">27043002</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deng</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Alternating EM algorithm for a bilinear model in isoform quantification from RNA-seq data</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>805</fpage>–<lpage>812</lpage>.<pub-id pub-id-type="pmid">31400221</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Systematic comparison of single-cell and single-nucleus RNA-sequencing methods</article-title>. <source>Nat. Biotechnol</source>., <volume>38</volume>, <fpage>737</fpage>–<lpage>746</lpage>.<pub-id pub-id-type="pmid">32341560</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frazee</surname><given-names>A.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Polyester: simulating RNA-seq datasets with differential transcript expression</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>2778</fpage>–<lpage>2784</lpage>.<pub-id pub-id-type="pmid">25926345</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Detecting differential alternative splicing events in scRNA-seq with or without unique molecular identifiers</article-title>. <source>PLoS Comput. Biol</source>., <volume>16</volume>, <fpage>e1007925</fpage>.<pub-id pub-id-type="pmid">32502143</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Sanguinetti</surname><given-names>G.</given-names></string-name></person-group> (<year>2017</year>) <article-title>BRIE: transcriptome-wide splicing quantification in single cells</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>123</fpage>.<pub-id pub-id-type="pmid">28655331</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jassal</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>The reactome pathway knowledgebase</article-title>. <source>Nucleic Acids Res</source>., <volume>48</volume>, <fpage>D498</fpage>–<lpage>D503</lpage>.<pub-id pub-id-type="pmid">31691815</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B8">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kaminow</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <source>STARsolo: Accurate, Fast and Versatile Mapping/Quantification of Single-Cell and Single-Nucleus RNA-seq Data. Technical Report</source>. <publisher-name>Cold Spring Harbor Laboratory</publisher-name>, <publisher-loc>Cold Spring Harbor, NY</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab807-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Melsted</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Modular, efficient and constant-memory single-cell RNA-seq preprocessing</article-title>. <source>Nat. Biotechnol</source>., <volume>39</volume>, <fpage>813</fpage>–<lpage>816</lpage>.<pub-id pub-id-type="pmid">33795888</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ntranos</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Fast and accurate single-cell RNA-seq analysis by clustering of transcript-compatibility counts</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>112</fpage>.<pub-id pub-id-type="pmid">27230763</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ntranos</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>A discriminative learning approach to differential expression analysis for single-cell RNA-seq</article-title>. <source>Nat. Methods</source>, <volume>16</volume>, <fpage>163</fpage>–<lpage>166</lpage>.<pub-id pub-id-type="pmid">30664774</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patro</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Sailfish enables alignment-free isoform quantification from RNA-seq reads using lightweight algorithms</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>462</fpage>–<lpage>464</lpage>.<pub-id pub-id-type="pmid">24752080</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patro</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>417</fpage>–<lpage>419</lpage>.<pub-id pub-id-type="pmid">28263959</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pawitan</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2005</year>) <article-title>Bias in the estimation of false discovery rate in microarray studies</article-title>. <source>Bioinformatics</source>, <volume>21</volume>, <fpage>3865</fpage>–<lpage>3872</lpage>.<pub-id pub-id-type="pmid">16105901</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Picelli</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Full-length RNA-seq from single cells using Smart-seq2</article-title>. <source>Nat. Protoc</source>., <volume>9</volume>, <fpage>171</fpage>–<lpage>181</lpage>.<pub-id pub-id-type="pmid">24385147</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ranzoni</surname><given-names>A.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Integrative single-cell RNA-seq and ATAC-seq analysis of human developmental hematopoiesis</article-title>. <source>Cell Stem Cell</source>, <volume>28</volume>, <fpage>472</fpage>–<lpage>487.e7</lpage>.<pub-id pub-id-type="pmid">33352111</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sarkar</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Terminus enables the discovery of data-driven, robust transcript groups from RNA-seq data</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>i102</fpage>–<lpage>i110</lpage>.<pub-id pub-id-type="pmid">32657377</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Single-cell alternative splicing analysis with expedition reveals splicing dynamics during neuron differentiation</article-title>. <source>Mol. Cell</source>, <volume>67</volume>, <fpage>148</fpage>–<lpage>161.e5</lpage>.<pub-id pub-id-type="pmid">28673540</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Srivastava</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Alevin efficiently estimates accurate gene abundances from dscRNA-seq data</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>65</fpage>.<pub-id pub-id-type="pmid">30917859</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>1888</fpage>–<lpage>1902.e21</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Svensson</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Exponential scaling of single-cell RNA-seq in the past decade</article-title>. <source>Nat. Protoc</source>., <volume>13</volume>, <fpage>599</fpage>–<lpage>604</lpage>.<pub-id pub-id-type="pmid">29494575</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Westoby</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Obstacles to detecting isoforms using full-length scRNA-seq data</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>74</fpage>.<pub-id pub-id-type="pmid">32293520</pub-id></mixed-citation>
    </ref>
    <ref id="btab807-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>G.X.Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>14049</fpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
