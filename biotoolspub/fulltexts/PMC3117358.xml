<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3117358</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btr220</article-id>
    <article-id pub-id-type="publisher-id">btr220</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2011 Proceedings Papers Committee July 17 to July 19, 2011, Vienna, Austria</subject>
      </subj-group>
      <subj-group>
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A folding algorithm for extended RNA secondary structures</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>zu Siederdissen</surname>
          <given-names>Christian Höner</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bernhart</surname>
          <given-names>Stephan H.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stadler</surname>
          <given-names>Peter F.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>5</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hofacker</surname>
          <given-names>Ivo L.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Institute for Theoretical Chemistry, University of Vienna, A-1090 Vienna, Austria, <sup>2</sup>Bioinformatics Group, Department of Computer Science, and Interdisciplinary Center for Bioinformatics, University of Leipzig, D-04107 Leipzig, <sup>3</sup>Max Planck Institute for Mathematics in the Sciences, <sup>4</sup>RNomics Group, Fraunhofer IZI, D-04103 Leipzig, Germany, <sup>5</sup>Center for Non−Coding RNA in Technology and Health, University of Copenhagen, Grønnegårdsvej 3, DK-1870 Frederiksberg, Denmark and <sup>6</sup>The Santa Fe Institute, Santa Fe, 87501 NM, USA</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>7</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>6</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>6</month>
      <year>2011</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>27</volume>
    <issue>13</issue>
    <fpage>i129</fpage>
    <lpage>i136</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2011. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> RNA secondary structure contains many non-canonical base pairs of different pair families. Successful prediction of these structural features leads to improved secondary structures with applications in tertiary structure prediction and simultaneous folding and alignment.</p>
      <p><bold>Results:</bold> We present a theoretical model capturing both RNA pair families and extended secondary structure motifs with shared nucleotides using 2-diagrams. We accompany this model with a number of programs for parameter optimization and structure prediction.</p>
      <p><bold>Availability:</bold> All sources (optimization routines, RNA folding, RNA evaluation, extended secondary structure visualization) are published under the GPLv3 and available at <ext-link ext-link-type="uri" xlink:href="www.tbi.univie.ac.at/software/rnawolf/">www.tbi.univie.ac.at/software/rnawolf/</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>choener@tbi.univie.ac.at</email>
      </p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>The classical RNA secondary structure model considers only the Watson–Crick AU and GC base pairs as well as the GU wobble pair. A detailed analysis of RNA 3D structures, however, reveals that there are 12 basic families of interactions between the bases, all of which appear in nature (<xref ref-type="bibr" rid="B17">Leontis and Westhof, 2001</xref>; <xref ref-type="bibr" rid="B18">Leontis <italic>et al.</italic>, 2002</xref>). Moreover, virtually all known RNA tertiary structures contain the so-called non-Watson–Crick base pairs. This has led to the development of an extended presentation of RNA contact structures with edges labeled by their pairing type (an example can be seen in <xref ref-type="fig" rid="F1">Fig. 1</xref>). This extended description of base pairing is commonly termed after its inventors the Leontis–Westhof (LW) representation.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Example of a structure containing base triplets. The inner part (bases 14–37) of the PDB structure <monospace>1dul</monospace> is shown in a 3D representation and as a 2D structure plot displaying the non-standard base pairs in LW representation. The four bases highlighted in the 3D structure form the two base triplets that can be seen in the upper part of the interior loop in the 2D structure.</p></caption><graphic xlink:href="btr220f1"/></fig></p>
    <p>The LW representation has proved to be a particularly useful means of analyzing 3D structures of RNA as determined by X-ray crystallography and NMR spectroscopy (<xref ref-type="bibr" rid="B20">Leontis and Lescoute, 2006</xref>). In particular, it has led to the discovery of recurrent structural motifs, such as kink-turns and C-loops, that act as distinctive building blocks of 3D structures. The sequence variation in these structural motifs follows combinatorial rules that can be understood by the necessity to maintain the overall geometry when base pairs are exchanged. These isostericity rules are discussed in detail by <xref ref-type="bibr" rid="B19">Lescoute <italic>et al.</italic> (2005</xref>); <xref ref-type="bibr" rid="B26">Stombaugh <italic>et al.</italic> (2009</xref>). As a new level of RNA structure description, the ability to predict non-standard base pairs can be expected to improve the performance of RNA structure prediction. Furthermore, information about evolutionary conservation of the isostericity classes of these non-standard base pairs will improve consensus structure-prediction and structure-dependent RNA gene finding.</p>
    <p>Since many additional interactions beyond the standard base pairs are represented in the LW formalism, what was considered to be a loop in classical secondary structures can now appear as complex structures of non-standard base pairs. These non-standard base pairs effectively divide the long ‘classical’ loops into much shorter ones. <xref ref-type="bibr" rid="B22">Parisien and Major (2008</xref>) proposed a model that contains loops with no more than four unpaired bases. For unbranched structures, the model is scored using a statistical potential estimated from the available 3D structures by counting the relative frequencies of base pairs, short unbranched loops of particular shapes in dependence of their sequences and combinations of loops with a common base pair. An accompanying folding procedure, <monospace>MC-Fold</monospace> (<xref ref-type="bibr" rid="B22">Parisien and Major, 2008</xref>), which exhaustively enumerates stem-loop components, is available and has been used very successfully as a first step toward the <italic>de novo</italic> prediction of RNA 3D structures using <monospace>MC-Sym</monospace> (<xref ref-type="bibr" rid="B22">Parisien and Major, 2008</xref>), which takes as input the proposed secondary structure from <monospace>MC-Fold</monospace>.</p>
  </sec>
  <sec id="SEC2">
    <title>2 MC-FOLD REVISITED</title>
    <sec id="SEC2.1">
      <title>2.1 Algorithm</title>
      <p>Like ordinary secondary structure prediction tools, <monospace>MC-Fold</monospace> (<xref ref-type="bibr" rid="B22">Parisien and Major, 2008</xref>) is based on a decomposition of the RNA structure into ‘loops’. In contrast to the standard energy model, however, it considers the full set of base pair types available in the LW representation. Each base pair, therefore, corresponds to a triple (<italic>i</italic>,<italic>j</italic>;θ) where θ is one of the 12 types of pairs. In this model, ordinary secondary structures are the subset of pairs with Watson-Crick type (θ=<monospace>‘WW’</monospace>) and the two nucleotides form one of the six canonical combinations <monospace>{AU,UA,CG,GC,GU,UG{</monospace>. This extension of the structure model also calls for a more sophisticated energy model. While the standard model assumes the contributions of the loops to be strictly additive, <monospace>MC-Fold</monospace> also considers interactions between adjacent unbranched loops (hairpins, stacked pairs, bulges and general interior loops). This means that the total energy of a structure is not only dependent on the loop types present, but also on the arrangement of these loops. Dispensing with details of the parametrization, the scoring function of <monospace>MC-Fold</monospace> for a structure 𝒮 on sequence <italic>x</italic> can be written as follows (see <xref ref-type="fig" rid="F2">Fig. 2</xref>):
<disp-formula id="M1"><label>(2.1)</label><graphic xlink:href="btr220m1"/></disp-formula>
where 𝒞,𝒞′,𝒞′ are different loops of 𝒮. The additive term <italic>E</italic><sub><italic>c</italic></sub> tabulates the (sequence-dependent) contributions of the loops. The interaction term <italic>E</italic><sub><italic>j</italic>+<italic>h</italic></sub> accounts for the ‘junction’ and ‘hinge’ terms in stem–loop regions. These interaction terms depend on the type of the adjacent loops as well as on the type θ and sequence (<italic>x</italic>[<italic>k</italic>], <italic>x</italic>[<italic>l</italic>]) of the base pair that connects them. For multiloops, only the additive term is considered.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p><monospace>MC-Fold</monospace> and <monospace>MC-Fold-DP</monospace> both consider small loops, like the hairpin <monospace>AAGUG</monospace> (𝒞) and the 2×2 stack <monospace>AAGU</monospace> (𝒟) (read clockwise, starting bottom left). Each loop is scored by a function <italic>E</italic><sub><italic>c</italic></sub>(𝒞|AAGUG). The stack (𝒟) follows analoguously. The interaction term between two loops is calculated as indicated by the arrow (α), where the two loops are overlayed at the common <monospace>AG</monospace> pair. The contribution of the interaction is <italic>E</italic><sub>junction+hinge</sub>(𝒞,𝒟;θ;A,G) with θ the unknown pair family.</p></caption><graphic xlink:href="btr220f2"/></fig></p>
      <p>Let us ignore multiloops for the moment. A basepair (<italic>i</italic>,<italic>j</italic>;θ) then encloses a loop of type ℒ which is either a hairpin or encloses a loop 𝒦. It is connected to 𝒦 by a base pair (<italic>k</italic>,<italic>l</italic>;ψ) with <italic>i</italic>&lt;<italic>k</italic>&lt;<italic>l</italic>&lt;<italic>j</italic>. Let <italic>B</italic><sub><italic>ij</italic></sub>(θ;ℒ) be the minimal energy of a structure on <italic>x</italic>[<italic>i</italic>..<italic>j</italic>] enclosed by a base pair (<italic>i</italic>,<italic>j</italic>;θ) with an outermost loop of type ℒ. Note that, in our notation, the loop type ℒ also specifies its length and hence implicitly determines the coordinates of the inner base pair of an interior loop: (<italic>k</italic>,<italic>l</italic>)=(<italic>i</italic>+ℓ<sub>1</sub>(ℒ),<italic>j</italic>−ℓ<sub>2</sub>(ℒ)). For simplicity, we write (<italic>k</italic>(ℒ),<italic>l</italic>(ℒ)). If ℒ is a hairpin, then <italic>B</italic><sub><italic>ij</italic></sub>(θ;ℒ)=ℋ[<italic>i</italic>,<italic>j</italic>;θ;hairpin], a tabulated energy parameter. Otherwise, we have the recursion
<disp-formula id="M2"><label>(2.2)</label><graphic xlink:href="btr220m2"/></disp-formula></p>
      <p>This can be expanded to a full ‘next-nearest-neighbor’ model by enforcing an explicit dependence on the type of the inner base pair:
<disp-formula id="M3"><label>(2.3)</label><graphic xlink:href="btr220m3"/></disp-formula>
The effort to evaluate this recursion equation for a fixed base pair (<italic>i</italic>,<italic>j</italic>) is <italic>L</italic><sup>3</sup><italic>T</italic><sup>3</sup>, where <italic>L</italic> is the number of loop types and <italic>T</italic> is the number of base pair types. While this prefactor is inconveniently large, we nevertheless obtain an 𝒪(<italic>n</italic><sup>2</sup>) [or 𝒪(<italic>n</italic><sup>3</sup>) with multibranched loops] folding algorithm instead of the exponential runtime of <monospace>MC-Fold</monospace>.</p>
      <p>The problem with this general form of energy parametrization is the unmanageable number of parameters that need to be measured, estimated or learned from a rather limited set of experiments and known RNA structures.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Parametrization and implementation</title>
      <p>Since the folding problem for the <monospace>MC-Fold</monospace> model can be solved in polynomial time, the associated parameter estimation problem becomes amenable to advanced parameter optimization techniques (<xref ref-type="bibr" rid="B2">Andronescu <italic>et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="B13">Do <italic>et al.</italic>, 2008</xref>). At present, however, we have opted to extend the original <monospace>MC-Fold</monospace> parameters only by simple sparse data corrections that can be applied on top of the original <monospace>MC-Fold</monospace> database. This has the advantage of allowing a direct comparison between the original version of <monospace>MC-Fold</monospace> and our dynamic programming version <monospace>MC-Fold-DP</monospace>. In contrast to the original version, <monospace>MC-Fold-DP</monospace> can cope with large data sets and long sequences (3 s for 250 nt, about 24 s for 500 nt with <monospace>MC-Fold-DP</monospace>, compared to 660 s for 100 nt with <monospace>MC-Fold</monospace>).<xref ref-type="fn" rid="FN1"><sup>1</sup></xref></p>
      <p>In terms of algorithmic design, we have made several changes. The grammar underlying <monospace>MC-Fold-DP</monospace> follows the ideas of <xref ref-type="bibr" rid="B30">Wuchty <italic>et al.</italic> (1999</xref>). This makes the generation of all suboptimal structures in an energy band above the ground state possible. The decomposition of interior loops into small loops implies that <monospace>MC-Fold-DP</monospace> runs in 𝒪(<italic>n</italic><sup>3</sup>) time without the need for the usual explicit truncation of long interior loops. The recursion that fills stem loops [<italic>Nucleotide Cyclic Motifs</italic> (NCMs) in the nomenclature of <xref ref-type="bibr" rid="B22">Parisien and Major (2008</xref>)] is now reduced to a function NCM(<italic>i</italic>,<italic>j</italic>,type<sub><italic>i</italic>,<italic>j</italic></sub>,<italic>k</italic>,<italic>l</italic>,type<sub><italic>k</italic>,<italic>l</italic></sub>). For the matrix, entry (<italic>i</italic>,<italic>j</italic>,type<sub><italic>i</italic>,<italic>j</italic></sub>) is minimized over all (<italic>k</italic>,<italic>l</italic>,type<sub><italic>k</italic>,<italic>l</italic></sub>) with (<italic>k</italic>,<italic>l</italic>) determined by the newly inserted motif type<sub><italic>i</italic>,<italic>j</italic></sub>. Hairpins are even simpler: they follow NCM(<italic>i</italic>,<italic>j</italic>,type<sub><italic>i</italic>,<italic>j</italic></sub>,…) but there is no inner part (<italic>k</italic>,<italic>l</italic>,type<sub><italic>k</italic>,<italic>l</italic></sub>).</p>
      <p>The total number of motif types is small (15 in the original set, of which not all are actually used). Both the time and space complexities are, therefore, small enough to handle RNAs with a length of several hundred nucleotides, i.e. in the range that is typically of interest. In fact, the time complexity is similar to ordinary secondary structure prediction where interior loop size is bounded by a constant. Since the grammar is unambiguous, it is also straightforward to compute partition functions and base pairing probabilities, although this feature is not available in the current implementation.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 BEYOND 1-DIAGRAMS</title>
    <sec id="SEC3.1">
      <title>3.1 Base triplets</title>
      <p>An important restriction of secondary structures is that each nucleotide interacts with at most one partner. In combinatorial terms, secondary structures are 1-diagrams. A closer analysis of the available 3D structures, however, reveals that many nucleotides form specific base pairs with two other nucleotides, forming ‘<italic>base triplets</italic>’ or, more generally, ‘<italic>multi-pairings</italic>’. Cross-free <italic>b</italic>-diagrams with maximal number <italic>b</italic> of interaction partners for each nucleotide can be treated combinatorically in complete analogy with (pseudoknot-free) secondary structures by conceptually splitting each node into as many vertices as there are incident base pairs (arcs). As in the case of secondary structures, we say that (<italic>i</italic>,<italic>j</italic>) and (<italic>k</italic>,<italic>l</italic>) cross if <italic>i</italic>&lt;<italic>k</italic>&lt;<italic>j</italic>&lt;<italic>l</italic> or <italic>k</italic>&lt;<italic>i</italic>&lt;<italic>l</italic>&lt;<italic>j</italic>. A <italic>b</italic>-diagram is non-crossing if no two arcs cross. Base pairs can then be well-ordered also in this extended setting: two distinct arcs (<italic>i</italic>,<italic>j</italic>)≠(<italic>k</italic>,<italic>l</italic>) are either <italic>nested</italic> (<italic>i</italic>≤<italic>k</italic>&lt;<italic>l</italic>≤<italic>j</italic>) or <italic>juxtaposed</italic> (<italic>i</italic>&lt;<italic>j</italic>≤<italic>k</italic>&lt;<italic>l</italic>). This observation is used in <monospace>RNAMotifScan</monospace> (<xref ref-type="bibr" rid="B31">Zhong <italic>et al.</italic>, 2010</xref>) to devise a dynamic programming algorithm for sequence structure alignments along the lines of <monospace>RNAscf</monospace> (<xref ref-type="bibr" rid="B5">Bafna <italic>et al.</italic>, 2006</xref>) or <monospace>locarna</monospace> (<xref ref-type="bibr" rid="B29">Will <italic>et al.</italic>, 2007</xref>), which in turn are restricted variants of the Sankoff algorithm (<xref ref-type="bibr" rid="B25">Sankoff, 1985</xref>).</p>
      <p>Here, we consider only structures with at most two base pairs involving the same nucleotide, i.e. 2-diagrams. In this case, there is a convenient string representation generalizing the Vienna (dot-parentheses) notation for secondary structures by introducing three additional symbols <monospace>&lt;</monospace>, <monospace>&gt;</monospace>, <monospace>X</monospace> for positions in which two arcs meet: <monospace>(( = &lt;, )) = &gt;</monospace> and <monospace>)( = X</monospace>. For general <italic>b</italic>, the number of necessary symbols grows quadratically, <italic>s</italic><sub><italic>b</italic></sub>=(<italic>b</italic>+1)(<italic>b</italic>+2)/2, since each must encode <italic>b</italic><sub>1</sub> opening and <italic>b</italic><sub>2</sub> closing pairs with <italic>b</italic><sub>1</sub>,<italic>b</italic><sub>2</sub>≥0 and <italic>b</italic><sub>1</sub>+<italic>b</italic><sub>2</sub>≤<italic>b</italic>. These symbols provide a direct representation of the arc nodes ‘<monospace>⊳,⊲, ×</monospace>’ of <xref ref-type="fig" rid="F3">Figure 3</xref> and are an optional output of the folding program described below to visualize 2-diagrams in the secondary structure.
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>A simple unambiguous grammar for non-crossing 2-diagrams (The symbols used here denote (non-)terminals in a context-free grammar and are not to be confused with the LW notation used in other figures). Connected parts of diagrams correspond to terminal [individual bullet with no arc (closed circle) = unpaired nucleotide; arc with circular end points (closed circle, open circle) = base pair; arc with triangular endpoints (left-faced triangle, right faced triangle, cross) = part of base triple] or non-terminal (horizontal lines and semicircle) symbols of the grammar. It is important to realize that left-faced and right-faced triangles refer to the same nucleotide when they are adjacent. In terms of a recursion, the index for both left-faced and right-faced triangles is therefore the same. One triangle ‘points’ to the outer arc and one to the inner arc incident to the same nucleotide.</p></caption><graphic xlink:href="btr220f3"/></fig></p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 A grammar with base triplets</title>
      <p>In order to design a dynamic programming folding algorithm for cross-free 2-structures we need a decomposition, i.e. a grammar for 2-structures. For practical applications, it is desirable to have not only a minimization algorithm, but also a partition function version. To this end, an unambiguous grammar is required (<xref ref-type="bibr" rid="B11">Dowell and Eddy, 2004</xref>; <xref ref-type="bibr" rid="B23">Reeder <italic>et al.</italic>, 2005</xref>). A simple version, treating base pairs as the elementary entities is shown in <xref ref-type="fig" rid="F3">Figure 3</xref>. It translates into an extension of either a Nussinov-style algorithm for maximizing the number of base pairs or a recursion for counting the number of non-crossing 2-diagrams. Let <italic>F</italic><sub><italic>ij</italic></sub> denote the minimum energy of a structure on the sequence interval <italic>x</italic>[<italic>i</italic>..<italic>j</italic>]. We have
<disp-formula id="M4"><label>(3.1)</label><graphic xlink:href="btr220m4"/></disp-formula>
and analogous recursion for <italic>U</italic><sub><italic>ij</italic></sub>,<italic>V</italic><sub><italic>ij</italic></sub> and <italic>W</italic><sub><italic>ij</italic></sub>, denoting the minimum energies over all structures whose left, right or both ends, are involved in a triplet. The symbol <italic>C</italic><sub><italic>ij</italic></sub> refers to structures enclosed by a non-triplet base pair. In the simplest case, <italic>C</italic><sub><italic>ij</italic></sub>=ϵ<sub><italic>ij</italic></sub>+<italic>F</italic><sub><italic>i</italic>+1,<italic>j</italic>−1</sub> (lower right corner of <xref ref-type="fig" rid="F3">Fig. 3</xref>). The terminal symbols are the unpaired base •, the ordinary base pairs and the three types of base pairs involved in triplets, contributing ϵ<sub><italic>i</italic></sub>=0 sequence−dependent energy increment ϵ<sub><italic>ij</italic></sub> and sequence-dependent energy increments ϵ<sup>a</sup><sub><italic>ij</italic></sub>, ϵ<sup>b</sup><sub><italic>ij</italic></sub> and ϵ<sup>c</sup><sub><italic>ij</italic></sub>, respectively. The recursion is initialized with <italic>F</italic><sub><italic>ii</italic></sub>=0.</p>
      <p>Only certain combinations of types of base pairs can occur in triplets. Thus, in a refined model we need to replace <italic>U</italic><sub><italic>ij</italic></sub>, <italic>V</italic><sub><italic>ij</italic></sub> and <italic>W</italic><sub><italic>ij</italic></sub> by <italic>U</italic><sub><italic>ij</italic></sub>[ν], <italic>U</italic><sub><italic>ij</italic></sub>[μ] and <italic>W</italic><sub><italic>ij</italic></sub>[ξ] explicitly referring to the base pair type(s) of the triplet. Furthermore, the energy parameters also become type dependent ϵ<sup>a</sup><sub><italic>ij</italic></sub>→ϵ<sup>a</sup><sub><italic>ij</italic></sub>[ρ] or even ϵ<sup>a</sup><sub><italic>ij</italic></sub>[ρ, ν] where ρ is the type of the pair itself and ν is type of the second pair of the triplet. The first variant is chosen for Nussinov-like algorithms, where each individual base pair is evaluated, splitting triplets, and the second variant is more fitting for Turner-like nearest neighbor models. In that case, recursion on <italic>W</italic> changes to <italic>W</italic><sub><italic>ij</italic></sub>[ν,μ] to reflect the pairing choice being made.</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Full loop-based model</title>
      <p>The grammar of <xref ref-type="fig" rid="F3">Figure 3</xref> can be extended to incorporate the standard loop-based Turner energy model (<xref ref-type="bibr" rid="B27">Turner and Mathews, 2010</xref>) (which distinguishes hairpin loops, stacks of two base pairs, bulges, interior loops and multibranched loops). The modification of the grammar is tedious but rather straightforward, as seen in <xref ref-type="fig" rid="F4">Figure 4</xref>. Instead of treating the base pairs themselves as terminal symbols (as in <xref ref-type="fig" rid="F3">Fig. 3</xref>), this role is taken over by entire loops. Note that as in the case of ordinary secondary structures, each loop in a given structure is uniquely determined by its closing pair. The energy contributions now depend, in a more complex way, on the characteristics of the loop, hence we also need additional non-terminals to describe e.g. the components of multiloops.
<fig id="F4" position="float"><label>Fig. 4.</label><caption><p>Decomposition of one non-terminal in the full loop-based model with triples. The l.h.s. of the production rule denotes a structure enclosed by a base pair where the base at the 3′ end is part of a triple. The second base pair of this triple ends within the structure. The structural element is either bulge like (first column) or multiloop like. In the first case, we have to distinguish whether the enclosed structure has a normal pair or a triple at its 5′ side. In the multiloop case, we use the linear decomposition into components familiar from the Turner model with a non-terminal denoting a partial multiloop containing at least one base pair. Here, we need to distinguish whether the 5′ end of the rightmost component and 3′end of the left components are triples or not. As the multiloop part is not implemented in our current version, it is grayed out.</p></caption><graphic xlink:href="btr220f4"/></fig></p>
      <p>We use a decomposition that is similar to that of <monospace>MC-Fold</monospace> and in addition encompasses 2-diagrams. A <italic>p</italic>×<italic>q</italic>-loop, <italic>p</italic>≤<italic>q</italic>, consists of <italic>p</italic> nucleotides on one strand and <italic>q</italic> nucleotides on the other one. In particular, 2×2-loops correspond to stacked base pairs, 1×<italic>q</italic>-loops, <italic>q</italic>&gt;1 are triplets and 2×3-loops are stacks with a bulged-out nucleotide. In addition to hairpin loops and these <italic>p</italic>×<italic>q</italic>-loops, we consider generic bulges with and without a shared nucleotide, interior loops of larger sizes and multibranched loops, again possibly with shared nucleotides. <xref ref-type="fig" rid="F4">Figure 4</xref> gives an example for the full loop-based decomposition of one particular non-terminal. In our current implementation, we use several simplifications in particular for multiloops that involve triplets. Some information on the complete grammar used in our implementation can be found in the Appendix A, other information is available on the <monospace>RNAwolf</monospace> homepage.</p>
    </sec>
  </sec>
  <sec id="SEC4">
    <title>4 IMPLEMENTATION</title>
    <sec id="SEC4.1">
      <title>4.1 Folding software</title>
      <p>The implementation available on the <monospace>RNAwolf</monospace> homepage is written in the high-level functional programming language Haskell. While this leads to an increase in running times (by a constant factor), the high-level notation and a library of special functions lead to very concise programs, and enable, e.g. the use of multiple cores.</p>
      <p>Currently, the following algorithms are implemented: (i) an optimizer which takes a set of melting experiments and the PDB database as input and produces a parameter file optimized as described below. (ii) A folding program which expects a sequence of nucleotides as input and produces an extended secondary structure prediction which includes nucleotide pairs of non-canonical types. Furthermore, it can contain motifs with base triplets. (iii) An evaluation program which expects both, a sequence and a secondary structure. The input is then evaluated to return the score of said structure and, if requested, tries to fill the given (canonical) structure with additional pairs. This allows to turn a classical secondary structure into an extended secondary structure by filling large loops with non-canonical pairs.</p>
      <p>At the moment, base triplets have been restricted slightly in that shared nucleotides are only possible in stem structures, not within a multibranched loop motif. Allowing shared nucleotides between two helices of a multiloop would slow down multiloops by a significant factor. Nevertheless, we will lift this restriction for the full nearest neighbor model we plan to implement. In the full model, we will be able to use data gathered from our current model to reduce the combinatorial complexity of the algorithm within multibranched loops.</p>
    </sec>
    <sec id="SEC4.2">
      <title>4.2 Parameter estimation</title>
      <p>In contrast to the Turner model, which considers only canonical base pairs [i.e. Watson–Crick and GU (wobble) pairs], we include all types of base pairs. Thus, we also have to derive parameters for all possible base pair families in our motifs of choice. To this end, we need to find sufficient evidence for each parameter and we need an efficient numerical algorithm for optimizing the parameters.</p>
      <list list-type="roman-lower">
        <list-item>
          <p>Even if a large body of sequence/structure pairs is available to train the parameters, it is still highly unlikely that each parameter is witnessed. A simple calculation for canonical stacked pairs already produces 4<sup>4</sup>×12<sup>2</sup>=36864 (ignoring symmetries) parameters to be trained. While symmetries reduce the number of distinct parameters, canonical stacks still require ~10000 independent parameters. In total, the number of parameters easily reaches 10<sup>5</sup>, which means that only a very small set of parameters will actually be observed in experimentally verified structures.</p>
        </list-item>
        <list-item>
          <p>The second problem is of numerical nature in that it gets hard to estimate a solution in ℝ<sup>100000</sup> even under ideal circumstances. In addition, the computational effort for the computation of the solution vector is rather high. There are two different types of approaches to this problem, described in some detail by <xref ref-type="bibr" rid="B2">Andronescu <italic>et al.</italic> (2007</xref>). In max-margin formulations, parameters are optimized such as to drive them away from wrongly determined structures and toward correctly determined ones. Alternatively, the conditional likelihood of known structures is maximized. <xref ref-type="bibr" rid="B4">Andronescu <italic>et al.</italic> (2010</xref>) described an extension of the algorithm that can deal with unobserved configurations by employing a hierarchical statistical model.</p>
        </list-item>
      </list>
      <p>We have selected yet another way of dealing with the immense number of features. Instead of optimizing the full set of parameters directly, we first optimize the parameters for a restricted model closely following the simple unambiguous grammar given in <xref ref-type="fig" rid="F3">Figure 3</xref>. In short a loop of type <italic>m</italic> (e.g. stacked pair, bulge, etc.) enclosed by two pairs <italic>p</italic><sub>1</sub>, <italic>p</italic><sub>2</sub> is assigned an energy ϵ(<italic>m</italic>)+ϵ<sup><italic>m</italic></sup>(<italic>p</italic><sub>1</sub>)+ϵ<sup><italic>m</italic></sup>(<italic>p</italic><sub>2</sub>), where ϵ(<italic>m</italic>) depends on the type and size of the loop but is independent of sequence, and the pair energies depend on the identity of the nucleotides as well as the LW type (e.g. GC,cWW).</p>
      <p>We call our model <italic>enhanced Nussinov</italic> as it distinguishes between loops of different types (say bulges of different lengths are assigned different scores) but assumes that pair energies are independent as in the Nussinov model.</p>
      <p>This approach has several advantages. First, the resulting algorithm is an accessible ‘toy-model’ that can be employed to test different hypotheses. Second, the estimated parameters provide a useful set of priors for the full model. This is important since, in contrast to the work of <xref ref-type="bibr" rid="B2">Andronescu <italic>et al.</italic> (2007</xref>), we cannot derive a complete set of priors from known data. Finally, the computational requirements are significantly lower. Training a full Boltzmann model for conditional likelihood maximization might easily have taken months of CPU time (<xref ref-type="bibr" rid="B4">Andronescu <italic>et al.</italic>, 2010</xref>).</p>
      <p>Here, we utilize both melting experiments and PDB data for parameter estimation. Melting experiments yield a small set of sequences, structures and corresponding free energies. The structural data, unfortunately, provides almost exclusively canonical Turner features and no information regarding the base pair family, although it can be assumed that all pairs are of the Watson–Crick (cWW) style. The PDB data, on the other hand, contain not only non-canonical base pairs, but also provide information on the base pair family. In addition, PDB entries typically refer to structures that are much larger than those used in melting experiments.</p>
      <p>Together, both sets provide data required for the estimation of an extended set of parameters. In order to keep computation times short, we employ the original no-max-margin constraint-generation approach used by <xref ref-type="bibr" rid="B2">Andronescu <italic>et al.</italic> (2007</xref>). While not providing the most accurate parameters in the original paper, the relatively short runtimes of ~ 1 CPU day are convenient for experimental purposes. In addition, since we are training an enhanced Nussinov-style model, we can assume that the prediction accuracy is limited by the structure of the model. More advanced, and hence computationally more expensive, training methods are therefore unlikely to lead to substantial improvements of the prediction accuracy.</p>
    </sec>
    <sec id="SEC4.3">
      <title>4.3 Optimization</title>
      <p>Our task is to estimate the energy contributions <italic>x</italic><sub><italic>j</italic></sub> for a given collection of features <italic>j</italic>. In this context, a feature corresponds to a terminal symbol in our grammar with a fixed underlying sequence, such as as GC/GC stacked pair or a 1×3-loop with sequence (G—AUC) where GA is a Hoogsteen pair and GC is a Watson–Crick pair. We are given the following types of data: (i) a matrix <italic>A</italic> whose entries <italic>A</italic><sub><italic>i</italic>,<italic>j</italic></sub> encode how often feature <italic>j</italic> occurs in sequence/structure pair <italic>i</italic>, and (ii) a vector <italic>y</italic> containing measured melting temperatures <italic>y</italic><sub><italic>i</italic></sub> for experiment <italic>i</italic>.</p>
      <p>Constraints are now generated as follows. For each entry <italic>k</italic> of the PDB, we extract the (extended) secondary structure features. This means that neither pseudoknots nor intermolecular interactions (which require more complicated grammars) are considered. The entry <italic>f</italic><sup><italic>T</italic></sup><sub><italic>j</italic></sub> of the row vector <italic>f</italic><sup><italic>T</italic></sup> counts how often feature <italic>j</italic> is observed in the structure. Using the current parameter values <italic>x</italic> (see below), the sequence of PDB entry <italic>k</italic> is folded and the corresponding feature vector <italic>g</italic><sup><italic>T</italic></sup> is constructed. If the predicted fold has a lower free energy than the known structure, a new constraint (<italic>f</italic>−<italic>g</italic>)<sup><italic>T</italic></sup><italic>x</italic>≤0 is introduced. Note that <italic>f</italic><sup><italic>T</italic></sup><italic>x</italic> and <italic>g</italic><sup><italic>T</italic></sup><italic>x</italic> are, by construction, the free energies of the known and the predicted structure evaluated with the current parameters <italic>x</italic>. Since the true structure is expected to be the thermodynamic ground state, its free energy must be smaller than that of any other structure. The constraint matrix <italic>D</italic> contains all currently active constraints where <italic>D</italic><sub><italic>k</italic>,.</sub> is the <italic>k</italic>−th active constraint (in this notation <italic>D</italic><sub><italic>k</italic>,.</sub> selects the <italic>k</italic>-th row, while <italic>D</italic><sub>.,<italic>l</italic></sub> would select the <italic>l</italic>-th column).</p>
      <p>Following <xref ref-type="bibr" rid="B2">Andronescu <italic>et al.</italic> (2007</xref>), we use a slack variable <italic>d</italic><sub><italic>k</italic></sub> for each constraint so that <italic>D</italic><sub><italic>k</italic>,.</sub><italic>x</italic>≤<italic>d</italic><sub><italic>k</italic></sub>. This guarantees that the problem remains feasible as otherwise conflicting constraints could reduce the feasible set for <italic>x</italic> to the empty set. The slack variables <italic>d</italic><sub><italic>k</italic></sub> are bounded from below by 0≤<italic>d</italic><sub><italic>k</italic></sub> because (<italic>f</italic>−<italic>g</italic>)<sup><italic>T</italic></sup><italic>x</italic>≥0, with equality for cooptimal structures.</p>
      <p>Norm minimization problems can drive individual variables <italic>x</italic><sub><italic>i</italic></sub> to extreme values. We, therefore, constrain the energy contribution of individual features to |<italic>x</italic><sub><italic>i</italic></sub>|&lt;5 kcal/mol. A subset <italic>S</italic> of features that act as penalties are constrained to positive values, <italic>x</italic><sub><italic>j</italic></sub>&gt;0 for <italic>j</italic>∈<italic>S</italic>. The set <italic>S</italic> is defined along the following principles: unpaired loop regions destabilize the structure relative to a random coil and hence should be penalized. Hairpins, bulges and interior loops fall into this category. In addition, 1×2 and 2×3 stems, which are otherwise modeled as 2×2 stems, are penalized. Hence, for e.g. the 2×3 loop <monospace>CAUGG</monospace> with <monospace>A</monospace> unpaired, we have ϵ(CG)+ϵ(UG)+ϵ(2×3) where ϵ(2×3) is the penalty term.</p>
      <p>Parameter estimation is thus reduced to the constrained norm optimization problem
<disp-formula id="M5"><label>(4.1)</label><graphic xlink:href="btr220m5"/></disp-formula>
with the linear constraints
<disp-formula id="M6"><label>(4.2)</label><graphic xlink:href="btr220m6"/></disp-formula>
Since this optimization problem is convex it can be solved efficiently.</p>
      <p>The parameter vector <italic>x</italic> is optimized iteratively. Initially, <italic>D</italic> is empty and no slack variables <italic>d</italic> are used. After the first step, all PDB sequences have been folded and those for which the predicted structure is different from the known structure are included as a row in <italic>D</italic> as described above. The slack variables are initialized as <italic>d</italic><sub><italic>k</italic></sub>=<italic>D</italic><sub><italic>k</italic>,.</sub><italic>x</italic>+γ for each constraint <italic>k</italic>, where γ∈ℝ<sub>+</sub> is a small constant. Iterations of the optimization procedure continue until no more constraints have to be added.</p>
      <p>The computational effort required, both to estimate the parameters and to fold a single sequence, is higher than what is required for the Turner model. The additional computational effort required by the folding algorithm is mainly a result of the inclusion of the pair family information. In the case of 2-loops (stacks, bulges, interior loops), we incur an additional factor of 12 since each possible pair family has to be considered. More problematic are multibranched loops in the case of shared nucleotides as now there are up to 12×11 possibilities to connect a shared nucleotide with its pairing partners.</p>
    </sec>
    <sec id="SEC4.4">
      <title>4.4 Comparison with turner parameters</title>
      <p>A comparison with the parameter sets by Turner (<xref ref-type="bibr" rid="B27">Turner and Mathews, 2010</xref>) shows that individual contributions are similar enough to make the the ‘enhanced Nussinov’ model a useful prior in the parameter optimization for the full model. Consider, for example, canonical 2×2 stacks, where one pair is of type <bold>GC, cWW</bold> type and the other pair is of type <bold>XY, cWW</bold>, with <bold>XY</bold> ∈{<bold>GC,CG,AU,UA,GU,UG</bold>} and <bold>cWW</bold> stands for <italic>cis/Watson–Crick/Watson–Crick</italic>, the canonical pair type. In the Turner-2004 model, energy contributions range from −1.5 to −3.4 kcal/mol, while the base−pair contribution for the <bold>GC, cWW</bold> pair is −1.36 kcal/mol in the optimized ‘enhanced Nussinov’ model. Depending on the second pair, we observe discrepancies of ≈0.5 when comparing the sum of individual pair energies to the total stacking energy. This level of agreement is expected and suggests that it makes sense in later iterations of parameter estimation to constrain features to tighter intervals than the current setting of using the open interval of ]−5,5[.</p>
    </sec>
  </sec>
  <sec sec-type="results|discussion" id="SEC5">
    <title>5 RESULTS AND DISCUSSION</title>
    <p><italic>MC</italic>-<italic>Fold</italic>-<italic>DP</italic>: <monospace>MC-Fold-DP</monospace> and the original <monospace>MC-Fold</monospace> by (<xref ref-type="bibr" rid="B22">Parisien and Major, 2008</xref>) show comparable performance on a set of 347 sequences selected from the RNAstrand (<xref ref-type="bibr" rid="B3">Andronescu <italic>et al.</italic>, 2008</xref>) database. There are several differences between the two algorithms. First, the runtime, where <monospace>MC-Fold-DP</monospace> is about ×200−×1000 faster for biologically relevant sequences (i.e. &lt;1000 nt). <xref ref-type="table" rid="T1">Table 1</xref> shows a small comparison of the prediction accuracy given different measures. Second, we allow for sparse data correction, which can be disabled by the user. And third, the algorithm accepts non-canonical input (e.g. ‘N’ characters) and can be configured to calculate approximate scores for motifs containing such characters.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Prediction accuracy of <monospace>MC-Fold</monospace>, <monospace>MC-Fold-DP</monospace> and <monospace>RNAfold 1.8.4</monospace> on a set of 347 sequences from the RNAstrand database</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Algorithm</th><th align="left" rowspan="1" colspan="1">Count</th><th align="left" rowspan="1" colspan="1">MCC</th><th align="left" rowspan="1" colspan="1"><italic>F</italic></th><th align="left" rowspan="1" colspan="1">S</th><th align="left" rowspan="1" colspan="1">PPV</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1"><monospace>MC-Fold, ≤50 nt</monospace></td><td align="left" rowspan="1" colspan="1">298</td><td align="left" rowspan="1" colspan="1">0.74</td><td align="left" rowspan="1" colspan="1">0.74</td><td align="left" rowspan="1" colspan="1">0.80</td><td align="left" rowspan="1" colspan="1">0.70</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>MC-Fold, ≤100 nt</monospace></td><td align="left" rowspan="1" colspan="1">37</td><td align="left" rowspan="1" colspan="1">0.54</td><td align="left" rowspan="1" colspan="1">0.54</td><td align="left" rowspan="1" colspan="1">0.66</td><td align="left" rowspan="1" colspan="1">0.46</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>MC-Fold, &gt;100 nt</monospace></td><td align="left" rowspan="1" colspan="1">12</td><td align="left" rowspan="1" colspan="1">0.49</td><td align="left" rowspan="1" colspan="1">0.49</td><td align="left" rowspan="1" colspan="1">0.53</td><td align="left" rowspan="1" colspan="1">0.46</td></tr><tr><td align="left" rowspan="1" colspan="1">[4pt] <monospace>MC-Fold-DP, ≤50 nt</monospace></td><td align="left" rowspan="1" colspan="1">298</td><td align="left" rowspan="1" colspan="1">0.71</td><td align="left" rowspan="1" colspan="1">0.71</td><td align="left" rowspan="1" colspan="1">0.77</td><td align="left" rowspan="1" colspan="1">0.68</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>MC-Fold-DP, ≤100 nt</monospace></td><td align="left" rowspan="1" colspan="1">37</td><td align="left" rowspan="1" colspan="1">0.53</td><td align="left" rowspan="1" colspan="1">0.53</td><td align="left" rowspan="1" colspan="1">0.64</td><td align="left" rowspan="1" colspan="1">0.45</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>MC-Fold-DP, &gt;100 nt</monospace></td><td align="left" rowspan="1" colspan="1">12</td><td align="left" rowspan="1" colspan="1">0.38</td><td align="left" rowspan="1" colspan="1">0.37</td><td align="left" rowspan="1" colspan="1">0.51</td><td align="left" rowspan="1" colspan="1">0.29</td></tr><tr><td align="left" rowspan="1" colspan="1">[4pt] <monospace>RNAfold, ≤50 nt</monospace></td><td align="left" rowspan="1" colspan="1">298</td><td align="left" rowspan="1" colspan="1">0.76</td><td align="left" rowspan="1" colspan="1">0.76</td><td align="left" rowspan="1" colspan="1">0.73</td><td align="left" rowspan="1" colspan="1">0.81</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>RNAfold, ≤100 nt</monospace></td><td align="left" rowspan="1" colspan="1">37</td><td align="left" rowspan="1" colspan="1">0.73</td><td align="left" rowspan="1" colspan="1">0.73</td><td align="left" rowspan="1" colspan="1">0.73</td><td align="left" rowspan="1" colspan="1">0.73</td></tr><tr><td align="left" rowspan="1" colspan="1"><monospace>RNAfold, &gt;100 nt</monospace></td><td align="left" rowspan="1" colspan="1">12</td><td align="left" rowspan="1" colspan="1">0.63</td><td align="left" rowspan="1" colspan="1">0.63</td><td align="left" rowspan="1" colspan="1">0.66</td><td align="left" rowspan="1" colspan="1">0.60</td></tr></tbody></table><table-wrap-foot><fn><p>All sequences are &lt; 200 nt long. The longest sequence took just under an hour of computation time using <monospace>MC-Fold</monospace>. <monospace>MC-Fold-DP</monospace> can compute the predicted structure in ~1 s (loading the <monospace>MC-Fold</monospace> motif database requires an additional 1–2 s). Prediction quality has been measured on canonical base pairs only for comparison purposes. Note the small number of sequences &gt; 100 nt. (MCC, Matthews correlation coefficient; F, F-Measure; S, Sensitivity; PPV, Positive Predictive Value).</p></fn></table-wrap-foot></table-wrap></p>
    <p>Differences in predictions are the result of internals of the orignial algorithm that have remained unknown to us since they are not described in full detail in <xref ref-type="bibr" rid="B22">Parisien and Major (2008</xref>).</p>
    <p>It should be noted that our reformulation makes <monospace>MC-Fold-DP</monospace> amenable for the parameter optimization approaches pioneered by <xref ref-type="bibr" rid="B4">Andronescu <italic>et al.</italic> (2010</xref>) for which a polynomial-time prediction algorithm is crucial. The non-ambiguous grammar allows even the advanced, Boltzmann Likelihood-based, approaches to be employed. This presents an opportunity for future research.</p>
    <p><italic>RNAwolf</italic>: we compared our <italic>enhanced Nussinov</italic> algorithm to three state-of-the-art thermodynamic folding algorithms [RNAfold (<xref ref-type="bibr" rid="B14">Hofacker <italic>et al.</italic>, 1994</xref>), UNAfold (<xref ref-type="bibr" rid="B21">Markham and Zuker, 2008</xref>) and RNAstructure (<xref ref-type="bibr" rid="B24">Reuter and Mathews, 2010</xref>)] to assess the prediction quality of our model. We folded a subset of 550 randomly chosen structures from RNAstrand (<xref ref-type="bibr" rid="B3">Andronescu <italic>et al.</italic>, 2008</xref>) and compared the <italic>F</italic>-measure of our results with those of the other programs. The results in <xref ref-type="fig" rid="F5">Figure 5</xref>A show that, not unexpectedly, the ‘enhanced Nussinov’ algorithm cannot compete with state-of-the-art tools due to its simplified energy model.
<fig id="F5" position="float"><label>Fig. 5.</label><caption><p>(<bold>A</bold>) Histogram of <italic>F</italic>-measures for different folding algorithms, given 550 random RNAstrand entries. (<bold>B</bold>) <italic>F</italic>-measures, given 155 PDB entries from the RNAstrand, which are a subset of the 550 random RNAstrand entries.</p></caption><graphic xlink:href="btr220f5"/></fig></p>
    <p>Interestingly, once we focused on data gathered from the PDB database (<xref ref-type="fig" rid="F5">Fig. 5</xref>B), the results showed a remarkable improvement. This could suggest that the PDB structures used for training do not sufficiently cover the RNA structure space and that additional RNAs (for which only secondary structure information is available) should be included in the training.</p>
    <p>Because of the large number of base pair types, the ‘enhanced Nussinov-algorithm’, has to perform more work than classical secondary structure prediction programs when filling the dynamic programming matrices. This is reflected by rather high runtimes (25 s for 100 nt, 110 s for 200 nt). However, the asymptotic time complexity is still in 𝒪(<italic>n</italic><sup>3</sup>).</p>
    <p>A constrained folding variant of the ‘enhanced-Nussinov’ algorithm can be used, for example, to predict non-canonical base pairs in large interior loops of structures. As an example, <xref ref-type="fig" rid="F6">Figure 6</xref>, shows that <monospace>RNAwolf</monospace> is able to correctly predict the non-canonical base pairs in a situation where the canonical base pairs are already given, i.e. where the input consists of both the sequence and a dot-bracket string representing canonical Watson–Crick base pairs. Only the zig-zag motif (upper part of the interior loop) was not predicted, presumably due to the large penalty of +3.89 for each of the two 1×2 stacks.
<fig id="F6" position="float"><label>Fig. 6.</label><caption><p>Prediction of non-canonical base pairs with <monospace>RNAwolf</monospace>. (<bold>A</bold>) Known structure of PDB entry <monospace>1dul</monospace>. (<bold>B</bold>) Constrained prediction (canonical base pairs were given) of <monospace>1dul</monospace>. Only the central part of the structure is shown. The outer part of the stem contains only canonical base pairs and is not shown.</p></caption><graphic xlink:href="btr220f6"/></fig></p>
    <p>Further results and a semi-automatic system for secondary structure prediction comparison (<monospace>SSPcompare</monospace>) are available on the <monospace>RNAwolf</monospace> homepage. <xref ref-type="table" rid="T1">Table 1</xref> has been created using said program.</p>
  </sec>
  <sec sec-type="conclusions" id="SEC6">
    <title>6 CONCLUSION</title>
    <p>Large experimentally verified RNA structures contain a sizable number of non-canonical base pairs (<xref ref-type="bibr" rid="B26">Stombaugh <italic>et al.</italic>, 2009</xref>). However, only a few RNA folding programs predict non-canonical pairs (<xref ref-type="bibr" rid="B12">Do <italic>et al.</italic>, 2006</xref>; <xref ref-type="bibr" rid="B22">Parisien and Major, 2008</xref>). With the exception of <monospace>MC-Fold</monospace>, the pair families are not explicitly taken into account. Here, we have shown that the prediction of non-canonical pairs together with the corresponding pair families and their possible interactions in base triples is feasible by efficient dynamic programming approaches. Although direct thermodynamic measurements are not available to cover all aspects of such an extended and refined model of RNA structures, meaningful parameter sets can nevertheless be constructed. To this end, the information of the thermodynamic measurements is combined with a feature analysis of 3D structures using one of several approaches to large-scale parameter optimization. The extended combinatorial model, which in essence covers the LW representations of RNA structures, allows a much more detailed modeling of the intrinsic structures in particular of hairpins, interior loops and bulges.</p>
    <p>We emphasize that our contribution does not yet provide a full-fledged loop-based LW-style energy model. In essence, we still lack an implementation for the full model of multiloops. As the example of <xref ref-type="fig" rid="F6">Figure 6</xref> suggests, interactions of adjacent loops as in the MC-Fold model may also be required to obtain satisfactory prediction accuracies for practical applications. Due to the computational cost, it will also make sense to investigate the trade-off between further refinements of the model and speed-ups resulting from additive approximations. Another facet that naturally should be taken into account is coaxial stacking, in particular in the context of multiloops (<xref ref-type="bibr" rid="B28">Tyagi and Mathews, 2007</xref>). We have demonstrated here that the goal of an accurate, practically applicable folding algorithm for LW structures is meaningful and reachable: the work of <xref ref-type="bibr" rid="B22">Parisien and Major (2008</xref>) shows that major improvements of prediction accuracy can be obtained by employing LW-based folding algorithms. Although <monospace>RNAwolf</monospace> does not yet reach the desired levels of accuracy, it allows us to explore the missing components of the energy model in a systematic manner, and it demonstrates that this can be achieved without leaving the realm of fast, efficient and exact dynamic programming approaches. The next step, therefore, is a toolkit for optimizing parameters in the full loop-based model.</p>
    <p>An interesting possibility for further extensions of the model is the explicit incorporation of recurring RNA structural motifs with non-canonical pairs, such as Kink-Turns (<xref ref-type="bibr" rid="B15">Klein <italic>et al.</italic>, 2001</xref>), into the grammar and the energy model. This may be particularly useful in those cases where motifs are not crossing-free and hence would require a pseudoknot version of the folding algorithm. While the inclusion of various types of pseudoknots is conceptually not more difficult than for ordinary secondary structures, the parametrization of such models will be even more plagued by the lack of training data in the LW framework.</p>
    <p>The folding algorithm introduced here, furthermore, sets the stage for a complete suite of bioinformatics tools for LW structures. Simple extension can cover the cofolding of two or more RNAs along the lines of (<xref ref-type="bibr" rid="B6">Bernhart <italic>et al.</italic>, 2006</xref>; <xref ref-type="bibr" rid="B9">Dimitrov and Zuker, 2004</xref>; <xref ref-type="bibr" rid="B10">Dirks <italic>et al.</italic>, 2007</xref>). Consensus structures can be predicted from given sequence alignments using the same recursions. As in <monospace>RNAalifold</monospace> (<xref ref-type="bibr" rid="B7">Bernhart <italic>et al.</italic>, 2008</xref>), it suffices to redefine the energy parameters for alignment columns instead of individual nucleotides. Instead of RIBOSUM-like scores as measures of conservation (<xref ref-type="bibr" rid="B16">Klein and Eddy, 2003</xref>), one naturally would employ the isostericity rules for the individual base pair types (<xref ref-type="bibr" rid="B18">Leontis <italic>et al.</italic>, 2002</xref>; <xref ref-type="bibr" rid="B19">Lescoute <italic>et al.</italic>, 2005</xref>). Inverse folding algorithms (<xref ref-type="bibr" rid="B1">Andronescu <italic>et al.</italic>, 2004</xref>; <xref ref-type="bibr" rid="B8">Busch and Backofen, 2006</xref>; <xref ref-type="bibr" rid="B14">Hofacker <italic>et al.</italic>, 1994</xref>) design RNA sequences that fold into prescribed structures by iteratively modifying and folding sequences to optimize their fit to substructures of the target. This strategy can immediately be generalized to LW structures; in fact, in essence it suffices to replace secondary structure folding by LW style folding. Combining the algorithmic ideas of this contribution with the Sankoff-style alignment approach of <xref ref-type="bibr" rid="B31">Zhong <italic>et al.</italic> (2010</xref>) and the progressive multiple alignment scheme of <monospace>mlocarna</monospace> (<xref ref-type="bibr" rid="B29">Will <italic>et al.</italic>, 2007</xref>) directly leads to an LW variant of structural alignment algorithms.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="FN1">
      <p><sup>1</sup>Note that the implementation of <monospace>MC-Fold-DP</monospace> has <italic>not</italic> been aggressively optimized apart from using the polynomial-time algorithm.</p>
    </fn>
  </fn-group>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors thank the participants of the <italic>Refined presentation of RNA structures</italic> workshop for lively discussions, Marc Parisien for kindly answering questions about <monospace>MC-Fold</monospace>, the curators of the FR3D database, and Ronny Lorenz for providing comparative data for other folding programs.</p>
    <p><italic>Funding</italic>: <funding-source>Austrian GEN-AU</funding-source> projects ‘bioinformatics integration network III’ and ‘regulatory ncRNAs’ in part.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <app-group>
    <app>
      <title>A</title>
      <sec>
        <title>A PAIRFAMILY-AWARE GRAMMAR</title>
        <p>Here, we discuss in some more detail how the base pair types affect the grammar and, hence, the folding algorithm. We start from <xref ref-type="fig" rid="F3">Figure 3</xref> and the corresponding recursion in Equation (<xref ref-type="disp-formula" rid="M4">(3.1)</xref>). Each base pair is now colored by its LW family. In particular, therefore, base pairs have type-dependent energy contributions ϵ<sub><italic>ij</italic></sub>[ϑ] for pairs not involved in base triples and energy contributions depending on the type of the pair and on the type of the incident pairs: ϵ<sub>ij</sub><sup><italic>a</italic></sup>[ϑ,ψ] if the 5′ nucleotide <italic>i</italic> is a triplet, ϵ<sub>ij</sub><sup><italic>a</italic></sup>[ϑ,ϕ] if the 3′ nucleotide <italic>i</italic> is a triplet and ϵ<sub>ij</sub><sup><italic>c</italic></sup>[ϑ,ψ,ϕ] if both delimiting nucleotides are triplets. Similarly, therefore, non-terminals delimited by triples must be colored by the base pair type(s) to allow the evaluation of the energy of the enclosing base pair. In the simplest case, as implemented in <monospace>RNAwolf</monospace>, we may assume that ϵ<sup>b</sup><sub><italic>ij</italic></sub>[θ,ψ] only depends on the pair type θ for permitted combinations of pair types and is +∞ otherwise. With explicit representation of the pair family types, Equation (<xref ref-type="disp-formula" rid="M4">(3.1)</xref>) becomes
<disp-formula><graphic xlink:href="btr220um1"/></disp-formula>
Here, we use the abbreviations
<disp-formula><graphic xlink:href="btr220um2"/></disp-formula>
which are obtained by carrying out the optimization over the combinations of base pairing types at all triples.</p>
        <p>The non-terminal <italic>C</italic>, designating a structure enclosed by an ordinary base pair remains unchanged since the minimization <italic>C</italic><sub><italic>ij</italic></sub>=<italic>F</italic><sub><italic>i</italic>+1,<italic>j</italic>−1</sub>+min<sub>θ</sub> ϵ<sub><italic>ij</italic></sub>[ϑ] can be carried out in the simplified energy model. The triplet terms, however, are now conditioned on the pair family at all nodes represented as triangles in <xref ref-type="fig" rid="F3">Figure 3</xref>. For instance, for a structure delimited by triplet vertices at both ends which are not connected by a pair, we obtain a recursion of the form
<disp-formula><graphic xlink:href="btr220um3"/></disp-formula>
and <italic>W</italic><sub><italic>ij</italic></sub>[θ,ψ]=<italic>W</italic><sup>*</sup><sub><italic>ij</italic></sub>[θ,ψ] if θ≠ψ and <italic>W</italic><sub><italic>ij</italic></sub>[θ,θ]=min{<italic>W</italic><sup>*</sup><sub><italic>ij</italic></sub>[θ,θ], <italic>F</italic><sub><italic>i</italic>+1,<italic>j</italic>−1</sub>+ϵ<sub><italic>ij</italic></sub>[θ].</p>
        <p>Similar recursions are obtained for the full loop-based model. For instance, for the two interloop terms in <xref ref-type="fig" rid="F4">Figure 4</xref> we have to compute
<disp-formula><graphic xlink:href="btr220um4"/></disp-formula>
where the matrices <italic>V</italic>*, <italic>V</italic> and <italic>W</italic> now refer to the non−terminal symbols in <xref ref-type="fig" rid="F4">Figure 4</xref> and ℑ[…] and ℑ′[…] denote the tabulated energy contributions for the two different types of interior loops with 3′-triplet. For more detail, we refer to the Supplementary Material which we will make available together with the full loop-based model on the RNAwolf homepage.</p>
      </sec>
    </app>
  </app-group>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andronescu</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A new algorithm for RNA secondary structure design</article-title>
        <source>J. Mol. Biol.</source>
        <year>2004</year>
        <volume>336</volume>
        <fpage>607</fpage>
        <lpage>624</lpage>
        <pub-id pub-id-type="pmid">15095976</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andronescu</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Efficient parameter estimation for RNA secondary structure prediction</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>i19</fpage>
        <lpage>i28</lpage>
        <pub-id pub-id-type="pmid">17646296</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andronescu</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA STRAND: The RNA secondary structure and statistical analysis database</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>340</fpage>
        <pub-id pub-id-type="pmid">18700982</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andronescu</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational approaches for RNA energy parameter estimation</article-title>
        <source>RNA</source>
        <year>2010</year>
        <volume>16</volume>
        <fpage>2304</fpage>
        <lpage>2318</lpage>
        <pub-id pub-id-type="pmid">20940338</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bafna</surname>
            <given-names>V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Consensus folding of unaligned RNA sequences revisited</article-title>
        <source>J. Comput. Biol.</source>
        <year>2006</year>
        <volume>13</volume>
        <fpage>283</fpage>
        <lpage>295</lpage>
        <pub-id pub-id-type="pmid">16597240</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernhart</surname>
            <given-names>S.H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Partition function and base pairing probabilities of RNA heterodimers</article-title>
        <source>Algorithms Mol. Biol.</source>
        <year>2006</year>
        <volume>1</volume>
        <fpage>3</fpage>
        <pub-id pub-id-type="pmid">16722605</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernhart</surname>
            <given-names>S.H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNAalifold: improved consensus structure prediction for RNA alignments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>474</fpage>
        <pub-id pub-id-type="pmid">19014431</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Busch</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>INFO-RNA — a fast approach to inverse RNA folding</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1823</fpage>
        <lpage>1831</lpage>
        <pub-id pub-id-type="pmid">16709587</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dimitrov</surname>
            <given-names>R.A.</given-names>
          </name>
          <name>
            <surname>Zuker</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Prediction of hybridization and melting for double-stranded nucleic acids</article-title>
        <source>Biophys. J.</source>
        <year>2004</year>
        <volume>87</volume>
        <fpage>215</fpage>
        <lpage>226</lpage>
        <pub-id pub-id-type="pmid">15240459</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dirks</surname>
            <given-names>R.M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Thermodynamic analysis of interacting nucleic acid strands</article-title>
        <source>SIAM Rev.</source>
        <year>2007</year>
        <volume>49</volume>
        <fpage>65</fpage>
        <lpage>88</lpage>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dowell</surname>
            <given-names>R.D.</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>S.R.</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of several lightweight stochastic context-free grammars for RNA secondary structure prediction</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="pmid">14736340</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Do</surname>
            <given-names>C.B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CONTRAfold: RNA secondary structure prediction without physics-based models</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>e90</fpage>
        <lpage>e98</lpage>
        <pub-id pub-id-type="pmid">16873527</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Do</surname>
            <given-names>C.B.</given-names>
          </name>
          <etal/>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Platt</surname>
            <given-names>J.C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Efficient multiple hyperparameter learning for log-linear models</article-title>
        <source>Advances in Neural Information Processing Systems 20. Proceedings of the Twenty-First Annual Conference on Neural Information Processing Systems</source>
        <year>2008</year>
        <publisher-name>Vancouver, British Columbia, Canada, 2007, MIT Press</publisher-name>
        <fpage>3</fpage>
        <lpage>6</lpage>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>I.L.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast folding and comparison of RNA secondary structures</article-title>
        <source>Mh. Chemie/Chem. Mon.</source>
        <year>1994</year>
        <volume>125</volume>
        <fpage>167</fpage>
        <lpage>188</lpage>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>D.J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The kink-turn: a new RNA secondary structure motif</article-title>
        <source>EMBO J.</source>
        <year>2001</year>
        <volume>20</volume>
        <fpage>4214</fpage>
        <lpage>4221</lpage>
        <pub-id pub-id-type="pmid">11483524</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>R.J.</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>S.R.</given-names>
          </name>
        </person-group>
        <article-title>RSEARCH: finding homologs of single structured RNA sequences</article-title>
        <source>BMC Bioinformatics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>44</fpage>
        <pub-id pub-id-type="pmid">14499004</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leontis</surname>
            <given-names>N.B.</given-names>
          </name>
          <name>
            <surname>Westhof</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Geometric nomenclature and classification of RNA base pairs</article-title>
        <source>RNA</source>
        <year>2001</year>
        <volume>7</volume>
        <fpage>499</fpage>
        <lpage>512</lpage>
        <pub-id pub-id-type="pmid">11345429</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leontis</surname>
            <given-names>N.B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The non-Watson-Crick base pairs and their associated isostericity matrices</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>3497</fpage>
        <lpage>3531</lpage>
        <pub-id pub-id-type="pmid">12177293</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lescoute</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recurrent structural RNA motifs, isostericity matrices and sequence alignments</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>2395</fpage>
        <lpage>2409</lpage>
        <pub-id pub-id-type="pmid">15860776</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leontis</surname>
            <given-names>N.B.</given-names>
          </name>
          <name>
            <surname>Lescoute</surname>
            <given-names>A.W.E.</given-names>
          </name>
        </person-group>
        <article-title>The building blocks and motifs of RNA architecture</article-title>
        <source>Curr. Opin. Struct. Biol.</source>
        <year>2006</year>
        <volume>16</volume>
        <fpage>279</fpage>
        <lpage>287</lpage>
        <pub-id pub-id-type="pmid">16713707</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Markham</surname>
            <given-names>N.R.</given-names>
          </name>
          <name>
            <surname>Zuker</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>UNAFold: software for nucleic acid folding and hybridization</article-title>
        <source>Methods Mol. Biol.</source>
        <year>2008</year>
        <volume>453</volume>
        <fpage>3</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="pmid">18712296</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parisien</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Major</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>The MC-Fold and MC-Sym pipeline infers RNA structure from sequence data</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>452</volume>
        <fpage>51</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="pmid">18322526</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reeder</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Effective ambiguity checking in biosequence analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>153</fpage>
        <pub-id pub-id-type="pmid">15967024</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reuter</surname>
            <given-names>J.S.</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>D.H.</given-names>
          </name>
        </person-group>
        <article-title>RNAstructure: software for RNA secondary structure prediction and analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>129</fpage>
        <lpage>129</lpage>
        <pub-id pub-id-type="pmid">20230624</pub-id>
      </element-citation>
    </ref>
    <ref id="B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sankoff</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous solution of the RNA folding, alignment, and proto-sequence problems</article-title>
        <source>SIAM J. Appl. Math.</source>
        <year>1985</year>
        <volume>45</volume>
        <fpage>810</fpage>
        <lpage>825</lpage>
      </element-citation>
    </ref>
    <ref id="B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stombaugh</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Frequency and isostericity of RNA base pairs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>2294</fpage>
        <lpage>2312</lpage>
        <pub-id pub-id-type="pmid">19240142</pub-id>
      </element-citation>
    </ref>
    <ref id="B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turner</surname>
            <given-names>D.H.</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>D.H.</given-names>
          </name>
        </person-group>
        <article-title>NNDB: the nearest neighbor parameter database for predicting stability of nucleic acid secondary structure</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>D280</fpage>
        <lpage>D282</lpage>
        <pub-id pub-id-type="pmid">19880381</pub-id>
      </element-citation>
    </ref>
    <ref id="B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tyagi</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>D.H.</given-names>
          </name>
        </person-group>
        <article-title>Predicting helical coaxial stacking in RNA multibranch loops</article-title>
        <source>RNA</source>
        <year>2007</year>
        <volume>13</volume>
        <fpage>939</fpage>
        <lpage>951</lpage>
        <pub-id pub-id-type="pmid">17507661</pub-id>
      </element-citation>
    </ref>
    <ref id="B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Will</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inferring non-coding RNA families and classes by means of genome-scale structure-based clustering</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e65</fpage>
        <pub-id pub-id-type="pmid">17432929</pub-id>
      </element-citation>
    </ref>
    <ref id="B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wuchty</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Complete suboptimal folding of RNA and the stability of secondary structures</article-title>
        <source>Biopolymers</source>
        <year>1999</year>
        <volume>49</volume>
        <fpage>145</fpage>
        <lpage>165</lpage>
        <pub-id pub-id-type="pmid">10070264</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhong</surname>
            <given-names>C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><monospace>RNAMotifScan</monospace>: automatic identification of RNA structural motifs using secondary structural alignment</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>e176</fpage>
        <pub-id pub-id-type="pmid">20696653</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
