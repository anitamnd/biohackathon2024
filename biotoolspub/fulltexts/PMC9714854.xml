<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS One</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9714854</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0278035</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-22-09901</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Animals</subject>
              <subj-group>
                <subject>Vertebrates</subject>
                <subj-group>
                  <subject>Amniotes</subject>
                  <subj-group>
                    <subject>Mammals</subject>
                    <subj-group>
                      <subject>Primates</subject>
                      <subj-group>
                        <subject>Apes</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Zoology</subject>
          <subj-group>
            <subject>Animals</subject>
            <subj-group>
              <subject>Vertebrates</subject>
              <subj-group>
                <subject>Amniotes</subject>
                <subj-group>
                  <subject>Mammals</subject>
                  <subj-group>
                    <subject>Primates</subject>
                    <subj-group>
                      <subject>Apes</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Discrete Mathematics</subject>
            <subj-group>
              <subject>Combinatorics</subject>
              <subj-group>
                <subject>Permutation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Morphometry</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Animals</subject>
              <subj-group>
                <subject>Vertebrates</subject>
                <subj-group>
                  <subject>Amniotes</subject>
                  <subj-group>
                    <subject>Mammals</subject>
                    <subj-group>
                      <subject>Primates</subject>
                      <subj-group>
                        <subject>Apes</subject>
                        <subj-group>
                          <subject>Gorillas</subject>
                        </subj-group>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Zoology</subject>
          <subj-group>
            <subject>Animals</subject>
            <subj-group>
              <subject>Vertebrates</subject>
              <subj-group>
                <subject>Amniotes</subject>
                <subj-group>
                  <subject>Mammals</subject>
                  <subj-group>
                    <subject>Primates</subject>
                    <subj-group>
                      <subject>Apes</subject>
                      <subj-group>
                        <subject>Gorillas</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Agriculture</subject>
          <subj-group>
            <subject>Animal Management</subject>
            <subj-group>
              <subject>Animal Performance</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
            <subj-group>
              <subject>Open Source Software</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
            <subj-group>
              <subject>Open Source Software</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Science Policy</subject>
        <subj-group>
          <subject>Open Science</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Cluster Analysis</subject>
            <subj-group>
              <subject>K Means Clustering</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Musculoskeletal System</subject>
            <subj-group>
              <subject>Skeleton</subject>
              <subj-group>
                <subject>Skull</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Musculoskeletal System</subject>
            <subj-group>
              <subject>Skeleton</subject>
              <subj-group>
                <subject>Skull</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Automated landmarking via multiple templates</article-title>
      <alt-title alt-title-type="running-head">Automated landmarking via multiple templates</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0418-6354</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Chi</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Porto</surname>
          <given-names>Arthur</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rolfe</surname>
          <given-names>Sara</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kocatulum</surname>
          <given-names>Altan</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7921-9018</contrib-id>
        <name>
          <surname>Maga</surname>
          <given-names>A. Murat</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Center for Development Biology and Regenerative Medicine, Seattle Children’s Research Institute, Seattle, Washington, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Biological Sciences, Louisiana State University, Baton Rouge, Louisiana, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Center for Computation and Technology, Louisiana State University, Baton Rouge, Louisiana, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Friday Harbor Laboratories, University of Washington, San Juan Island, Washington, United States of America</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Alfred University, Alfred, New York, United States of America</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Division of Craniofacial Medicine, Department of Pediatrics, University of Washington, Seattle, Washington, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Charles</surname>
          <given-names>Cyril</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Ecole Normale Supérieure de Lyon, FRANCE</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>maga@uw.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>17</volume>
    <issue>12</issue>
    <elocation-id>e0278035</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 Zhang et al</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Zhang et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0278035.pdf"/>
    <abstract>
      <p>Manually collecting landmarks for quantifying complex morphological phenotypes can be laborious and subject to intra and interobserver errors. However, most automated landmarking methods for efficiency and consistency fall short of landmarking highly variable samples due to the bias introduced by the use of a single template. We introduce a fast and open source automated landmarking pipeline (MALPACA) that utilizes multiple templates for accommodating large-scale variations. We also introduce a K-means method of choosing the templates that can be used in conjunction with MALPACA, when no prior information for selecting templates is available. Our results confirm that MALPACA significantly outperforms single-template methods in landmarking both single and multi-species samples. K-means based template selection can also avoid choosing the worst set of templates when compared to random template selection. We further offer an example of <italic toggle="yes">post-hoc</italic> quality check for each individual template for further refinement. In summary, MALPACA is an efficient and reproducible method that can accommodate large morphological variability, such as those commonly found in evolutionary studies. To support the research community, we have developed open-source and user-friendly software tools for performing K-means multi-templates selection and MALPACA.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000153</institution-id>
            <institution>Division of Biological Infrastructure</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ABI1759883</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7921-9018</contrib-id>
          <name>
            <surname>Maga</surname>
            <given-names>A. Murat</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000072</institution-id>
            <institution>National Institute of Dental and Craniofacial Research</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R03DE027110</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7921-9018</contrib-id>
          <name>
            <surname>Maga</surname>
            <given-names>A. Murat</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>The funding sources of this project are: Division of Biological Infrastructure, National Science Foundation (url: <ext-link xlink:href="https://www.nsf.gov/bio/dbi/about.jsp" ext-link-type="uri">https://www.nsf.gov/bio/dbi/about.jsp</ext-link>). Award Number: ABI1759883. Recipient: A.M.M. National Institute for Dental and Craniofacial Research (url: <ext-link xlink:href="https://www.nidcr.nih.gov/grants-funding" ext-link-type="uri">https://www.nidcr.nih.gov/grants-funding</ext-link>). Award Number: R03DE027110. Recipient: A.M.M. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="10"/>
      <table-count count="2"/>
      <page-count count="23"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value><ext-link xlink:href="https://github.com/SlicerMorph/Mouse_Models" ext-link-type="uri">https://github.com/SlicerMorph/Mouse_Models</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p><ext-link xlink:href="https://github.com/SlicerMorph/Mouse_Models" ext-link-type="uri">https://github.com/SlicerMorph/Mouse_Models</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Landmark data has been increasingly used in biological and biomedical fields to quantify complex phenotypes for investigating underlying genetic, environmental, mechanical, and evolutionary factors through multivariate analyses [<xref rid="pone.0278035.ref001" ref-type="bibr">1</xref>–<xref rid="pone.0278035.ref007" ref-type="bibr">7</xref>]. Nevertheless, collecting landmarks manually, nowadays mostly done by annotating high-resolution 3D images or surface models, can be laborious and time consuming [<xref rid="pone.0278035.ref008" ref-type="bibr">8</xref>–<xref rid="pone.0278035.ref012" ref-type="bibr">12</xref>]. Manual landmarking also inevitably leads to intra- and interobserver errors, which can disrupt detection of biologically meaningful variations [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0278035.ref013" ref-type="bibr">13</xref>–<xref rid="pone.0278035.ref016" ref-type="bibr">16</xref>]. Nowadays, combining landmark data collected by different researchers has become increasingly common when working with big datasets, so proper error control has become more urgent for ensuring accuracy, consistency, and reproducibility [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0278035.ref013" ref-type="bibr">13</xref>, <xref rid="pone.0278035.ref015" ref-type="bibr">15</xref>–<xref rid="pone.0278035.ref017" ref-type="bibr">17</xref>].</p>
    <p>To resolve the limitations in manual landmarking, researchers have developed various automated landmarking techniques based on image registration [<xref rid="pone.0278035.ref009" ref-type="bibr">9</xref>, <xref rid="pone.0278035.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0278035.ref018" ref-type="bibr">18</xref>–<xref rid="pone.0278035.ref020" ref-type="bibr">20</xref>]. However, these methods may not always be convenient for biologists to use because most of them require high-end hardware and knowledge of image-processing [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0278035.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0278035.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0278035.ref019" ref-type="bibr">19</xref>]. We have recently introduced an automatic landmarking method, ALPACA (Automated Landmarking through Point cloud Alignment and Correspondence), as part of the SlicerMorph morphometrics toolkit [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0278035.ref021" ref-type="bibr">21</xref>]. For a detailed explanation of ALPACA and its underlying methods, we refer the readers to the cited papers. In summary, ALPACA is fast and lightweight because it uses sparse point clouds extracted from the 3D surface models of biological specimens [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>]. These point clouds, while retaining sufficient geometric information, greatly reduce the computational burden so that ALPACA can efficiently run on any recent personal computer and does not require access to specialized hardware such as GPUs or high-performance computing cluster. ALPACA is free to download as part of the open-source SlicerMorph extension in the 3D Slicer software [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0278035.ref021" ref-type="bibr">21</xref>, <xref rid="pone.0278035.ref022" ref-type="bibr">22</xref>].</p>
    <p>One limitation of ALPACA and most other registration-based methods lies in the usage of single template for landmarking the entire sample [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>]. This is because the accuracy of automated landmarking depends on how well the registration algorithm optimizes the cost of global registration with local shape differences, which becomes more difficult as the template and target specimens become more different in form [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0278035.ref012" ref-type="bibr">12</xref>]. This limitation is particular well-known in neuroimaging where template-based analysis had been the norm for the last two decades [<xref rid="pone.0278035.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0278035.ref023" ref-type="bibr">23</xref>–<xref rid="pone.0278035.ref025" ref-type="bibr">25</xref>] and is particularly difficult in evolutionary focused biological studies, where researchers frequently deal with highly variable samples from different species. Consequently, it can be difficult to use a single template to landmark a variable study sample while maintaining accuracy of landmarking.</p>
    <p>If one template is insufficient for landmarking a highly variable study sample, a potential solution is to use multiple templates to have a more comprehensive representation of the whole study sample [<xref rid="pone.0278035.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0278035.ref024" ref-type="bibr">24</xref>–<xref rid="pone.0278035.ref026" ref-type="bibr">26</xref>]. The multi-template approach has already been utilized in automated image segmentation to better capture variations of anatomical structures within a sample so that the segmentation of these structures can be more accurate [<xref rid="pone.0278035.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0278035.ref023" ref-type="bibr">23</xref>–<xref rid="pone.0278035.ref027" ref-type="bibr">27</xref>]. Young and Maga [<xref rid="pone.0278035.ref012" ref-type="bibr">12</xref>] adopted the multi-template method from automated segmentation for their image-based automatic landmarking research and have achieved an improvement in accuracy comparing to the single-template method. The main issue with the multi-template methods is the increased computational demand, as each subject now needs to be registered as many times as there are templates. While this is a concern for computationally expensive methods takings hours, in ALPACA a single specimen can be landmarked in a matter of few minutes, making ALPACA an effective tool to implement a multi-template automated landmarking approach [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>].</p>
    <p>In this study, we present a multi-template, automated landmarking pipeline called MALPACA based on the methods of ALPACA. Overall, there are two steps to the MALPACA workflow: the first step is to identify the templates to be used to landmark the rest of the samples. The second step is the execution of the multi-template estimation pipeline, which is essentially running ALPACA independently for each unique template. For each of the three coordinates of a single landmark, we take the median from all corresponding estimates given by each template used in MALPACA as the final output. Therefore, multiple templates can contribute to landmarking one target specimen, depending on the performance of each template. In this way, MALPACA can avoid biases introduced by using a single template to landmark every specimen.</p>
    <p>Identifying the templates to sufficiently capture the variations of the whole sample is critical for any method that relies on them [<xref rid="pone.0278035.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0278035.ref028" ref-type="bibr">28</xref>, <xref rid="pone.0278035.ref029" ref-type="bibr">29</xref>]. This might be particularly difficult if there is no prior information, such as a pilot study with smaller samples sizes, available to the investigator. If the investigator needs to manually landmark even a portion of the study sample to determine the patterns of morphological variations and choose the ones to be used as templates, this time investment may overcome the benefit from automated landmarking. If such a pilot dataset is already in existence, we advise investigators to make use of these priors for template selection. For the cases where no prior information is available, we implemented a K-means based template selection that uses point-clouds of the surface models of the study population to approximate the patterns of overall morphological variations in an unbiased way. A Generalized Procrustes Analysis (GPA) is applied to these point clouds, followed by the PCA decomposition of Procrustes aligned coordinates. Using all PC scores from the GPA we apply K-means clustering to the data to detect the samples that are closest to the centroids of the identified clusters. The investigator can specify how many templates per group (if data consists of multiple groups or species) will be extracted. The investigator then landmarks the selected specimens, and inputs them as the templates for the MALPACA pipeline. More details of how to execute the K-means based template selection procedure can be found in the Material and Methods section and <xref rid="pone.0278035.s022" ref-type="supplementary-material">S1 Appendix</xref>.</p>
    <p>The first goal of this study is to evaluate whether MALPACA outperforms single-template ALPACA in estimating landmark positions with less error when compared to the “gold standard” (GS) manual landmarks. The second goal is, in cases where no prior information about the patterns of variations for a sample is available, to assess whether K-means can be an acceptable alternative for choosing a set of templates for MALPACA. The results confirm our expectations that MALPACA outperforms ALPACA for both the single-population mouse and multi-species ape samples. The K-means based multi-template selection method proposed in this study can also generate a template set with good performance when researchers have no prior knowledge for optimal template selection.</p>
    <p>An advantage of our multi-template pipeline is the ability to implement a <italic toggle="yes">post-hoc</italic> analysis for quality control. In a single template-based analysis, the only way to assess quality is to manually redo the landmarking and compare the result with the estimated landmarks, which defeats the purpose of automation. Therefore, we provide an example that shows how to import estimates for individual templates into R and conduct an analysis to assess how closely they converge. Optionally, subsets of landmark estimates can be removed to potentially improve the result. This demonstrates the flexibility and capability of developing a <italic toggle="yes">post-hoc</italic> quality check. Users are encouraged to design their own <italic toggle="yes">post-hoc</italic> analysis by setting up their own criteria for detecting outliers. For the research community, we provide modules with graphic user-interface for performing K-means multi-template selection and MALPACA (see <xref rid="pone.0278035.s022" ref-type="supplementary-material">S1 Appendix</xref> for instructions) within the SlicerMorph extension of the open-source 3D Slicer platform [<xref rid="pone.0278035.ref021" ref-type="bibr">21</xref>, <xref rid="pone.0278035.ref022" ref-type="bibr">22</xref>]. The structure of the study is summarized in <xref rid="pone.0278035.t001" ref-type="table">Table 1</xref>.</p>
    <table-wrap position="float" id="pone.0278035.t001">
      <object-id pub-id-type="doi">10.1371/journal.pone.0278035.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>A summary of research goals and analyses.</title>
      </caption>
      <alternatives>
        <graphic xlink:href="pone.0278035.t001" id="pone.0278035.t001g" position="float"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Research goals</th>
              <th align="left" rowspan="1" colspan="1">Samples</th>
              <th align="left" rowspan="1" colspan="1">Analysis and Evaluation Metric</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="2" colspan="1">1. Evaluate whether MALPACA outperforms ALPACA</td>
              <td align="left" rowspan="2" colspan="1">Mouse and ape sample</td>
              <td align="left" rowspan="1" colspan="1">1) RMSE and individual landmark errors comparing to manual landmarks (“gold standard” or GS); also comparing to intraobserver manual landmarking errors.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">2) Correlations of morphometric variables such as centroid sizes, pairwise Procrustes distances and PC scores with morphospace derived from GS</td>
            </tr>
            <tr>
              <td align="left" rowspan="2" colspan="1">2. The performance of K-means multi-template selection</td>
              <td align="left" rowspan="1" colspan="1">Mouse sample</td>
              <td align="left" rowspan="1" colspan="1">Permutation test: comparing RMSEs derived from K-means based MALPCA and 100 rounds of MALPACAs, each of which based on a random combination of 7 templates</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Ape sample</td>
              <td align="left" rowspan="1" colspan="1">Permutation test: comparing RMSEs derived from K-means based MALPCA and 50 rounds of MALPACAs using randomly selected templates, each of which based on a random combination of 6 templates</td>
            </tr>
            <tr>
              <td align="left" rowspan="3" colspan="1">3. Examples of quality check for the performance of individual templates and refined MALPACA to show the flexibility of designing <italic toggle="yes">post-hoc</italic> analysis</td>
              <td align="left" rowspan="3" colspan="1">Ape sample</td>
              <td align="left" rowspan="1" colspan="1">1) Extract outlier estimated landmarks of individual templates</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">2) Remove outliers and re-calculate median estimates; compute new RMSEs comparing to GS to assess the performance relative to the original MALPACA</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">3) “Species-specific” MALACA as a potential improvement: one MALPACA for each ape species using the two templates from that species; comparing to the original MALPACA based on RMSEs and correlations in Procrustes distances and PC scores with GS.</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t001fn001">
          <p>For details, please see the <xref rid="sec002" ref-type="sec">Material and methods</xref> session</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Samples</title>
      <p>Our study uses two samples that represent different types of group structure. Each specimen is a 3D model in the PLY format. The first sample consists of 3D skull models of 61 inbred laboratory mice from both classical and wild-derived strains [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0278035.ref020" ref-type="bibr">20</xref>] (See <xref rid="pone.0278035.s010" ref-type="supplementary-material">S1 Table</xref> for list of strains used in the study and <xref rid="pone.0278035.s001" ref-type="supplementary-material">S1 Data</xref> for data availability). This dataset is used to mimic a population level morphometric analysis, where no distinct grouping structure exists (or expected) in the resultant morphospace. All specimens have been manually annotated with 51 landmarks once by single observer (<xref rid="pone.0278035.s002" ref-type="supplementary-material">S1A Fig</xref>; <xref rid="pone.0278035.s001" ref-type="supplementary-material">S1 Data</xref>). Throughout this study we will refer the manually annotated datasets as “gold standard” (GS).</p>
      <p>The second sample contains 3D skull models of 52 great ape specimens from three species: 11 <italic toggle="yes">Pan troglodytes</italic>, 23 <italic toggle="yes">Gorilla gorilla</italic>, and 18 <italic toggle="yes">Pongo pygmaeus</italic> (For details, please see [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0278035.ref030" ref-type="bibr">30</xref>], <xref rid="pone.0278035.s001" ref-type="supplementary-material">S1 Data</xref> and <xref rid="pone.0278035.s011" ref-type="supplementary-material">S2 Table</xref> for a list of the specimens used in this study). The dataset is provided by courtesy of the 3D Digitization program of the Smithsonian Institution (<xref rid="pone.0278035.s001" ref-type="supplementary-material">S1 Data</xref>). Each specimen has been annotated twice manually with 41 landmarks by a single observer (<xref rid="pone.0278035.s002" ref-type="supplementary-material">S1B Fig</xref>, <xref rid="pone.0278035.s001" ref-type="supplementary-material">S1 Data</xref>). The mean of these two manual landmark sets is used as the GS.</p>
    </sec>
    <sec id="sec004">
      <title>K-means based methods for selecting multiple specimens as templates</title>
      <p>This study utilizes K-means clustering as the basis for selecting specimens from the mouse and ape data sets as templates [<xref rid="pone.0278035.ref012" ref-type="bibr">12</xref>]. We used this K-means template selection method to choose seven templates from the mouse sample to landmark the remaining 54 specimens using MALPACA (<xref rid="pone.0278035.t002" ref-type="table">Table 2</xref> and <xref rid="pone.0278035.s010" ref-type="supplementary-material">S1 Table</xref>). For the ape sample, we ran a K-means template selection procedure for each species to identify two templates per species. Consequently, six templates were used to landmark the remaining 46 ape specimens (9 <italic toggle="yes">Pan</italic>, 21 <italic toggle="yes">Gorilla</italic>, and 16 <italic toggle="yes">Pongo</italic>) (<xref rid="pone.0278035.t002" ref-type="table">Table 2</xref> and <xref rid="pone.0278035.s011" ref-type="supplementary-material">S2 Table</xref>).</p>
      <table-wrap position="float" id="pone.0278035.t002">
        <object-id pub-id-type="doi">10.1371/journal.pone.0278035.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>K-means selected templates.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pone.0278035.t002" id="pone.0278035.t002g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Mouse templates</th>
                <th align="left" rowspan="1" colspan="1">Ape templates</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">129S1.SVIMJ</td>
                <td align="left" rowspan="1" colspan="1">USNM084655 (<italic toggle="yes">Pan troglodytes</italic>)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">B6CBAF1.J</td>
                <td align="left" rowspan="1" colspan="1">USNM176236 (<italic toggle="yes">Pan troglodytes</italic>)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">BALB.CBYJ</td>
                <td align="left" rowspan="1" colspan="1">USNM590953 (<italic toggle="yes">Gorilla gorilla</italic>)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CAST.EIJ</td>
                <td align="left" rowspan="1" colspan="1">USNM599167 (<italic toggle="yes">Gorilla gorilla</italic>)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SF.CamEiJ</td>
                <td align="left" rowspan="1" colspan="1">USNM142185 (<italic toggle="yes">Pongo pygmaeus</italic>)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SPRET.EiJ</td>
                <td align="left" rowspan="1" colspan="1">USNM153830 (<italic toggle="yes">Pongo pygmaeus</italic>)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">X129P3.J</td>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t002fn001">
            <p>For a full list of samples and accessing the data, see <xref rid="pone.0278035.s001" ref-type="supplementary-material">S1 Data</xref>, <xref rid="pone.0278035.s010" ref-type="supplementary-material">S1</xref> and <xref rid="pone.0278035.s011" ref-type="supplementary-material">S2</xref> Tables.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The input 3D models for the K-means based method is required to have a filetype that is compatible with 3D Slicer, such as PLY, OBJ, STL, and VTK [<xref rid="pone.0278035.ref022" ref-type="bibr">22</xref>] (also see <xref rid="pone.0278035.s022" ref-type="supplementary-material">S1 Appendix</xref>). The raw data for K-means are the full set of principal component (PC) scores derived from the decomposition of GPA aligned coordinates from sparse point clouds extracted from the input 3D models. To achieve this, point-to-point correspondences must be established across point clouds so that they can be treated as landmark configurations. This is a three-step process:</p>
      <list list-type="order">
        <list-item>
          <p>A reference model is tightly registered to the target(s) using the global and ICP rigid registration steps from ALPACA [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0278035.ref031" ref-type="bibr">31</xref>–<xref rid="pone.0278035.ref033" ref-type="bibr">33</xref>].</p>
        </list-item>
        <list-item>
          <p>A sparse point cloud is extracted from the reference. This is done by deleting points in the reference model until the distance between any pair of points exceeds a user-defined threshold [<xref rid="pone.0278035.ref034" ref-type="bibr">34</xref>]. In our sample, this leads to the reference point clouds with 791 and 674 points for the mouse and ape datasets respectively.</p>
        </list-item>
        <list-item>
          <p>For each point in the reference point cloud, the closest point in the target model is extracted [<xref rid="pone.0278035.ref034" ref-type="bibr">34</xref>]. This results in a sparse point cloud from the target model that has a point-to-point correspondence with the reference point cloud.</p>
        </list-item>
      </list>
      <p>These point clouds are treated as landmark configurations and submitted to a Generalized Procrustes Analysis (GPA) [<xref rid="pone.0278035.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0278035.ref035" ref-type="bibr">35</xref>]. GPA is the most common registration method for geometric morphometrics [<xref rid="pone.0278035.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0278035.ref035" ref-type="bibr">35</xref>]. It registers the landmark configuration of each specimen to each other by removing non-shape factors of size, orientation, and locations. After GPA alignment, only the shape information is retained. The coordinates of the GPA registered landmark sets are called shape coordinates or Procrustes aligned coordinates. We then run a Principal Component Analysis (PCA) based on the covariance matrix of the shape coordinates [<xref rid="pone.0278035.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0278035.ref021" ref-type="bibr">21</xref>, <xref rid="pone.0278035.ref035" ref-type="bibr">35</xref>]. The resultant principal components (PC) scores of each specimen can account for the total variance of the shape coordinates, but with much lower dimensionality. Using the PC scores rather the original shape coordinates for statistical analysis can greatly reduce the computational time yet retain the original shape information.</p>
      <p>The full set of PC scores are input into the K-means algorithm to select a user-defined number (k) of templates. The K-means algorithm, which is implemented using the SciPy Python package, iteratively looks for an optimal way to partition specimens into k clusters so that the mean within-cluster Euclidean distance between specimens and the centroid is minimized [<xref rid="pone.0278035.ref036" ref-type="bibr">36</xref>]. Within each cluster, the specimen closest to the centroid is selected as a template, so that k templates are selected [<xref rid="pone.0278035.ref012" ref-type="bibr">12</xref>]. Step-by-step instructions for executing K-means template selection using the mouse data and landmarks are available in <xref rid="pone.0278035.s022" ref-type="supplementary-material">S1 Appendix</xref>. Parameter settings used for K-means template selection are listed in <xref rid="pone.0278035.s012" ref-type="supplementary-material">S3 Table</xref> (also see <xref rid="pone.0278035.s022" ref-type="supplementary-material">S1 Appendix</xref> for detailed explanations).</p>
      <p>It should be noted that for the K-means template selection procedure to work correctly, 3D models of all specimens should be complete and segmented to contain the same anatomical content. Because the workflow uses the entire model to generate point clouds, inclusion of incomplete specimens or extraneous anatomical elements will create spurious outcome.</p>
    </sec>
    <sec id="sec005">
      <title>MALPACA process</title>
      <p>MALPACA with K-means selected templates was used to landmark both the mouse and ape samples. To initiate MALPACA, the user simply needs to input the location of 3D models, specimens designated as templates, and landmark sets corresponding to the templates (<xref rid="pone.0278035.s022" ref-type="supplementary-material">S1 Appendix</xref>). The 3D models for the MALPACA pipeline should be in the PLY format. For each template, ALPACA is run independently to landmark the target specimens to landmark them (for details of ALPACA, please see [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>]). After a target specimen is landmarked by each template, each of the final x, y, and z coordinates of every landmark on this target specimen is the median of the corresponding estimates generated by all individual templates. The three coordinates (i.e., x, y, and z) of any landmark of a target specimen may come from any of the templates. Therefore, the final MALPACA-derived estimates of a specimen can be contributed by multiple templates. Note that we take the median rather than the mean from the corresponding ALPACA-derived estimates for each landmark estimate. This is to reduce the potential skew may be created by outlier estimates generated due to various factors (registration failure, particular template and subject are too different, etc.) associated with using arithmetic means.</p>
      <p>The MALPACA module returns both the final median landmark estimates and estimates from individual templates as files on disk. Because ALPACA registers the template to a target specimen to project template landmarks to the surface of the target, the estimated landmarks from both ALPACA and MALPACA are in the target specimen’s own coordinate system. While we chose median to estimate final landmark location due to its robustness to outliers, providing all the output gives the user flexibility to implement their own estimation methods or evaluate the performance of each template in estimating certain landmark positions on certain specimens. For example, users can extract the contribution of each template to a particular target specimen. We also provide an example to extract outlier estimates given by specific templates (see later section “<italic toggle="yes">Post-hoc</italic> quality check and refined MALPACA”). Users can opt to remove these outliers to potentially improve the final results. Step-by-step instructions on how to execute the multi-template landmarking can be found in <xref rid="pone.0278035.s022" ref-type="supplementary-material">S1 Appendix</xref> in the Supporting Information. For availability of landmarks estimated by K-means based MALPACA in this study, please also see <xref rid="pone.0278035.s022" ref-type="supplementary-material">S1 Appendix</xref>.</p>
    </sec>
    <sec id="sec006">
      <title>Evaluating MALPACA performance</title>
      <p>Performance evaluation of MALPACA against baseline ALPACA is done by comparing how closely the MALPACA and each template’s ALPACA-derived landmark estimates approximate our gold standard (GS), manual landmarks. This can be conveniently done because our method outputs the landmark estimates given by each selected template. All three groups of landmark coordinates (MALPACA derived, ALPACA derived and manual) are directly comparable without requiring them to be superimposed by GPA. For the mouse sample, in addition to the K-means selected templates, we acquired the synthetic template constructed by Maga et al. [<xref rid="pone.0278035.ref020" ref-type="bibr">20</xref>], which is the average model of the same sample used in their study. This synthetic template was also the template used in the original ALPACA evaluation study [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>]. We then ran ALPACA based on this synthetic template for the mouse sample to compare with the K-means based MALPACA.</p>
      <p>We used the root mean square error (RMSE) to quantify the overall positional deviation between two landmark sets for a given specimen. RMSE represents the square root of the mean sum of squared errors between two landmark sets as shown in the <xref rid="pone.0278035.e001" ref-type="disp-formula">Eq (1)</xref> below.</p>
      <disp-formula id="pone.0278035.e001">
        <alternatives>
          <graphic xlink:href="pone.0278035.e001.jpg" id="pone.0278035.e001g" position="anchor"/>
          <mml:math id="M1" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>R</mml:mi>
              <mml:mi>M</mml:mi>
              <mml:mi>S</mml:mi>
              <mml:mi>E</mml:mi>
              <mml:mspace width="2pt"/>
              <mml:mo>=</mml:mo>
              <mml:msqrt>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:msubsup>
                      <mml:mfenced close="]" open="[">
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mfenced>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mover accent="true">
                                      <mml:mi>x</mml:mi>
                                      <mml:mo>^</mml:mo>
                                    </mml:mover>
                                    <mml:mi>i</mml:mi>
                                  </mml:msub>
                                  <mml:mo>−</mml:mo>
                                  <mml:msub>
                                    <mml:mi>x</mml:mi>
                                    <mml:mi>i</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                          <mml:mo>+</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mfenced>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mover accent="true">
                                      <mml:mi>y</mml:mi>
                                      <mml:mo>^</mml:mo>
                                    </mml:mover>
                                    <mml:mi>i</mml:mi>
                                  </mml:msub>
                                  <mml:mo>−</mml:mo>
                                  <mml:msub>
                                    <mml:mi>y</mml:mi>
                                    <mml:mi>i</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                          <mml:mo>+</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mfenced>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mover accent="true">
                                      <mml:mi>z</mml:mi>
                                      <mml:mo>^</mml:mo>
                                    </mml:mover>
                                    <mml:mi>i</mml:mi>
                                  </mml:msub>
                                  <mml:mo>−</mml:mo>
                                  <mml:msub>
                                    <mml:mi>z</mml:mi>
                                    <mml:mi>i</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mfrac>
                </mml:mrow>
              </mml:msqrt>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>(1)</label>
      </disp-formula>
      <p>In <xref rid="pone.0278035.e001" ref-type="disp-formula">Eq (1)</xref>, <italic toggle="yes">N</italic> represents the sample size, <inline-formula id="pone.0278035.e002"><alternatives><graphic xlink:href="pone.0278035.e002.jpg" id="pone.0278035.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0278035.e003"><alternatives><graphic xlink:href="pone.0278035.e003.jpg" id="pone.0278035.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pone.0278035.e004"><alternatives><graphic xlink:href="pone.0278035.e004.jpg" id="pone.0278035.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> represent the coordinates of the <italic toggle="yes">i</italic>th landmark in one landmark set (e.g., a MALPACA or ALPACA-derived estimated landmark set), and <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">y</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub> represents the coordinates of the <italic toggle="yes">i</italic>th landmark in another landmark set (e.g., the manual landmark set). Thus, RMSE serves as a single value to summarize the overall deviations between all estimated and GS landmarks for a specimen. The smaller the RMSE is, the less deviation it is between an estimated and manual landmark sets (or any two landmark sets) for a specimen.</p>
      <p>The RMSEs reported are in millimeters (mm) because the landmarks are collected in coordinate systems on the scale of millimeters. We also report RMSEs as percentage of the centroid size, calculated from each specimen’s GS (manual) landmark set, so that they can be understood in context of the body size. Statistical significance of the differences between the MALPACA and ALPACA derived RMSE values is assessed via one-sided Welch t-test.</p>
      <p>In addition to RMSEs, we compute the Euclidean distance or error between the estimates of individual landmarks and their corresponding GS landmarks as a comparison of MALPACA and ALPACA performance. One-sided Welch t-tests are used to test the number of MALPACA-GS individual landmark errors that are significantly smaller or larger than the corresponding ALPACA-GS errors. If the MALPACA-GS error for an individual landmark is significantly smaller than the ALPACA-GS errors, MALPACA outperforms ALPACA in estimating the position of this landmark.</p>
      <p>To further evaluate the performance of MALPACA-estimated landmarks in morphometric analysis, we perform separate GPAs for MALPACA-derived estimates, ALPACA-derived estimates, and GS landmarks. We then extract size and shape variables, namely:</p>
      <list list-type="order">
        <list-item>
          <p>pairwise Procrustes distances,</p>
        </list-item>
        <list-item>
          <p>principal components (PCs), and</p>
        </list-item>
        <list-item>
          <p>centroid sizes, from each GPA-aligned landmark set.</p>
        </list-item>
      </list>
      <p>Procrustes distances quantify overall shape differences. PCs are components ranked by proportions of the total variance they explain. Centroid sizes are common size measures for specimens based on their landmark sets. Morphometric analyses use these variables to represent overall shape and size variations [<xref rid="pone.0278035.ref035" ref-type="bibr">35</xref>]. We calculate correlations between estimated and GS landmarks in these size and shape variables. Joint GPA between MALPACA and GS landmarks is also carried out to visualize differences between estimated mean shapes.</p>
    </sec>
    <sec id="sec007">
      <title>Assessing the magnitude of digitation errors in MALPACA</title>
      <p>As indicated above, both intra and interobserver errors are common in manual landmarking [<xref rid="pone.0278035.ref009" ref-type="bibr">9</xref>, <xref rid="pone.0278035.ref013" ref-type="bibr">13</xref>, <xref rid="pone.0278035.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0278035.ref016" ref-type="bibr">16</xref>]. Thus, it is important to evaluate the MALPACA RMSEs in context of manual digitization errors. Our mouse sample has been landmarked only a single time, so it is not possible to calculate observer errors. Instead, we rely on intraobserver errors computed by Percival et al.’s [<xref rid="pone.0278035.ref009" ref-type="bibr">9</xref>] as the reference for manual errors for the thirty-four of the landmarks in their study that are replicated in our analysis. We compare the published mean intraobserver errors for these thirty-four landmarks from Percival et al. [<xref rid="pone.0278035.ref009" ref-type="bibr">9</xref>] with the mean MALPACA-GS and ALPACA-GS errors for the same set of landmarks in our study. No GPA alignment is needed for this comparison because Percival et al. [<xref rid="pone.0278035.ref009" ref-type="bibr">9</xref>] also computed intraobserver errors in their mouse specimen’s own coordinate system. For the ape sample, each specimen has been landmarked twice by the same observer. The RMSEs between the two manual landmark sets are used as an estimate of intraobserver errors. In addition, we compute Euclidean distances between corresponding landmarks from the two manual landmark sets as intraobserver error of individual landmarks.</p>
    </sec>
    <sec id="sec008">
      <title>Robustness of K-means based template selection using permutation tests</title>
      <p>This study uses permutation analysis to evaluate whether K-means is an acceptable method to select templates when no prior information is available, compared to randomly selecting specimens as templates (See <xref rid="pone.0278035.t001" ref-type="table">Table 1</xref> for the K-means selected templates for the mouse and ape samples). Each permutation is based on using a random choice of specimens as templates to run MALPACA. For the mouse sample, 100 permutations are carried out to generate 100 random combinations of seven templates. For each permutation, a MALPACA is carried out to landmark the remaining 54 mouse specimens, generating 54 RMSEs between the estimated and GS landmarks of each specimen. The mean RMSE for each MALPACA run is then calculated, resulting in 100 mean RMSEs for the permutation analysis. We then compare the mean RMSE from the mouse K-means based MALPACA with the pooled 100 mean RMSEs derived from all the permutated MALPACAs. If the mean RMSE of the K-means based MALPACA falls below the majority of the 100 mean RMSEs given by the permutated MALPACAs, the K-means based MALPACA is considered to outperform MALPACAs using randomly selected templates. In addition, we compare the RMSE for each of the 54 target specimen from the K-means based MALPACA to all 5,400 RMSEs (100 permutations × 54 target specimens) derived from the permutated MALPACAs.</p>
      <p>For the ape sample, the same type of permutation analysis is carried out for evaluating the performance of six K-means based templates. We carry out 50 MALPACA runs based on 50 random combinations of six templates given by 50 rounds of the permutation analysis. The mean RMSE from the K-means based MALPACA is compared to the pooled 50 mean RMSEs given by the permutated MALPACAs. We then compare the RMSE of each of the 46 ape target specimens to the pooled 2,300 RMSEs (50 permutations × 46 target specimens).</p>
      <p>The evaluation of MALPACA performance is carried out in R [<xref rid="pone.0278035.ref037" ref-type="bibr">37</xref>]. RMSEs of the data are calculated using the SlicerMorphR package (<ext-link xlink:href="https://github.com/SlicerMorph/SlicerMorphR" ext-link-type="uri">https://github.com/SlicerMorph/SlicerMorphR</ext-link>). Generalized Procrustes Analysis (GPA) is performed using the geomorph R package for calculating correlations between estimated and manually placed landmarks in centroid sizes, pairwise Procrustes distances, and principal component scores [<xref rid="pone.0278035.ref038" ref-type="bibr">38</xref>].</p>
    </sec>
    <sec id="sec009">
      <title><italic toggle="yes">Post-hoc</italic> quality check and refined MALPACA</title>
      <p>To test whether outlier estimates given by individual templates may negatively impact the final output, we perform a <italic toggle="yes">post hoc</italic> analysis to detect and remove outliers as an attempt to further reduce the errors between the MALPACA-derived estimates and GS. In particular, this analysis is applied to the multi-species ape sample, since using the templates from one species to landmark specimens of another morphologically distinct species is more likely to generate poor landmark estimates. Including these poor results may reduce the accuracy of the final estimates. Thus, we expect the outlier extraction analysis can identify these poor estimates as outliers and remove them to enhance landmarking results. Procedures described here are available as R functions incorporated to SlicerMorphR package. See <xref rid="pone.0278035.s022" ref-type="supplementary-material">S1 Appendix</xref> for instructions on use.</p>
      <p>To determine whether an estimated landmark on a specimen derived from a template is an outlier, we first calculate the Euclidean distance between this estimated landmark and its corresponding MALPACA-derived estimate. We then define a heuristic threshold as two standard deviations above the mean of the pooled distances between each estimated landmark from a template and its corresponding MALPACA final output for one specimen. If the distance for an estimated landmark derived from a template exceeds the threshold, this landmark is considered as an outlier. The outliers are then removed from recalculation of the median landmark positions. Accordingly, RMSEs are calculated between these new median estimates and GS landmarks to see if there is an improvement.</p>
      <p>As an attempt to eliminate the potentially negative effect of including poor estimates from the templates of other ape species, we also design a “species-specific” approach that performs three separate MALPACA runs. Each run landmarks one species by directly calculating medians between the ALPACA estimates from the two templates of that species (“species-specific MALPACA” in the main text). RMSEs between landmarks generated by each approach and the GS are calculated to compare the performance of the species-specific MALPACA to the original MALPACA that uses results given by all templates. We also assess correlations in centroid sizes, pairwise Procrustes distances, and PC scores derived from each method.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec010">
    <title>Results and discussion</title>
    <p>All MALPACA analyses were run on a 64-bit Windows 10 desktop with an Intel Core i5 3.10 GHz CPU, and 16 GB RAM. All MALPACA landmark estimates rely on templates selected by the K-means multi-template method. For the mouse dataset, the execution time is 69s for a single sample using ALPACA or 7.2h for the whole sample using all seven templates, which includes the template selection. For the ape sample, the execution time is 240s for a single specimen using ALPACA or 18.4h for the whole sample using all six templates.</p>
    <sec id="sec011">
      <title>MALPACA performance over ALPACA</title>
      <p>The mouse MALPACA landmarking yields significantly smaller RMSEs than those generated by ALPACA based on any K-means selected template or the synthetic template (all p-values from one-sided Welch t-tests &lt; 8.52 × 10<sup>−7</sup>) (<xref rid="pone.0278035.g001" ref-type="fig">Fig 1</xref>, <xref rid="pone.0278035.s003" ref-type="supplementary-material">S2 Fig</xref> and <xref rid="pone.0278035.s013" ref-type="supplementary-material">S4 Table</xref>). For 37 out of 51 landmarks, the MALPACA-based errors are significantly smaller than the ALPACA-based errors using the synthetic template (p-values &lt; 0.05 for one-sided t-tests for assessing if MALPACA-errors are smaller) (<xref rid="pone.0278035.g002" ref-type="fig">Fig 2</xref>, <xref rid="pone.0278035.s004" ref-type="supplementary-material">S3 Fig</xref> and <xref rid="pone.0278035.s014" ref-type="supplementary-material">S5 Table</xref>). For the remaining 14 landmarks, the MALPACA-based errors are not significantly larger than the ALPACA ones (p-values &gt; 0.37 for one-sided Welch t-tests assessing if ALPACA-based errors are smaller) (<xref rid="pone.0278035.g002" ref-type="fig">Fig 2</xref> and <xref rid="pone.0278035.s015" ref-type="supplementary-material">S6 Table</xref>). The joint GPA of MALPACA-based and GS landmarks yields highly consistent mean shapes (<xref rid="pone.0278035.s005" ref-type="supplementary-material">S4 Fig</xref>).</p>
      <fig position="float" id="pone.0278035.g001">
        <object-id pub-id-type="doi">10.1371/journal.pone.0278035.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Comparison of RMSEs for the mouse sample.</title>
          <p>RMSEs calculated between estimated landmarks and the “gold standard”. Each box represents the RMSEs of 54 mouse specimens calculated by a specific analysis. “ALPACA”: Mouse ALPACA landmarks are estimated using the synthetic mouse template used in the original ALPACA paper. Other columns are ALPACA-derived estimates using each specified template. To see RMSEs expressed as percentage of specimen centroid sizes based on “Gold Standard” manual landmarks, please see <xref rid="pone.0278035.s003" ref-type="supplementary-material">S2 Fig</xref>.</p>
        </caption>
        <graphic xlink:href="pone.0278035.g001" position="float"/>
      </fig>
      <fig position="float" id="pone.0278035.g002">
        <object-id pub-id-type="doi">10.1371/journal.pone.0278035.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Comparison of individual landmark errors for the mouse sample.</title>
          <p>Errors represented by Euclidean distances (for errors expressed in percentage of centroid sizes, see <xref rid="pone.0278035.s004" ref-type="supplementary-material">S3 Fig</xref>). Each column represents errors between MALPACA-derived estimates of all 54 mouse specimens for one landmark and their corresponding Gold Standard (GS) landmarks. Red dots: each represents the median of errors between the estimates of the synthetic template ALPACA of all 54 mouse specimens for one landmark and their corresponding GS landmarks.</p>
        </caption>
        <graphic xlink:href="pone.0278035.g002" position="float"/>
      </fig>
      <p>To test for differences in the common morphometric variables (Procrustes distances, centroid sizes, and PC ordination scores), we have investigated correlations of these variables from the separate generalized Procrustes alignments of MALPACA-derived estimates and GS landmarks. For the mouse data, our results show that the Procrustes distances calculated from MALPACA-derived estimates and GS landmarks are highly correlated in pairwise distances with a 0.8 correlation coefficient (denoted as r) (<xref rid="pone.0278035.g003" ref-type="fig">Fig 3A</xref>). Centroid sizes calculated from MALPACA-derived estimates and GS landmarks are almost identical with the correlation coefficients exceed 0.99 (<xref rid="pone.0278035.s016" ref-type="supplementary-material">S7 Table</xref>). For PC scores, Procrustes distances, and centroid sizes, the correlations of MALPAC-derived estimates with GS exceed that of ALPACA and GS (<xref rid="pone.0278035.g003" ref-type="fig">Fig 3B</xref>; <xref rid="pone.0278035.s016" ref-type="supplementary-material">S7 Table</xref>).</p>
      <fig position="float" id="pone.0278035.g003">
        <object-id pub-id-type="doi">10.1371/journal.pone.0278035.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Comparison of the pairwise distances derived from the mouse estimated and GS landmarks.</title>
          <p>(A) MALPACA vs. GS. (B) ALPACA vs. GS based on the synthetic template. “r” = correlation coefficient. The plot is based on distances between all pairs of specimens within the mouse sample derived from separate GPA of estimated and GS landmarks.</p>
        </caption>
        <graphic xlink:href="pone.0278035.g003" position="float"/>
      </fig>
      <p>To compare the similarity of morphospaces derived from MALPACA and GS landmarks, we relied on the strength of the correlations of corresponding PC scores from different datasets. The MALPACA-GS correlation is especially strong in PC 1 scores as the correlation coefficient in PC 1 scores reaches 0.947 (<xref rid="pone.0278035.g004" ref-type="fig">Fig 4A</xref>). MALPACA-derived estimates and GS landmarks also yield high correlation in PC 2 scores (r = 0.83), with a gradual decline of correlation coefficients with the other PC scores. The ALPACA-GS correlations in scores of PC 1 and PC 2 are still strong but relatively weaker than the MALPACA-GS correlations (<xref rid="pone.0278035.g004" ref-type="fig">Fig 4B</xref>).</p>
      <fig position="float" id="pone.0278035.g004">
        <object-id pub-id-type="doi">10.1371/journal.pone.0278035.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Correlations in the first six Principal Components (PCs) between estimated and GS landmarks.</title>
          <p>(A) MALPCA vs. GS. (B) ALPACA (the synthetic template) vs. GS. PC scores are derived from separate GPAs of estimated and manual landmarks. Each grid represents the correlation coefficient between a PC from an automated landmarking analysis and a PC from the GS, depending on its row and column names.</p>
        </caption>
        <graphic xlink:href="pone.0278035.g004" position="float"/>
      </fig>
      <p>Overall, the ape MALPACA-ALPACA performance evaluations are in line with the results from the mouse dataset. MALPACA yields landmark estimates with significantly smaller RMSEs than any ALPACA estimate based on a K-means selected template (all p-values &lt; 0.02) (<xref rid="pone.0278035.g005" ref-type="fig">Fig 5</xref>, <xref rid="pone.0278035.s006" ref-type="supplementary-material">S5 Fig</xref> and <xref rid="pone.0278035.s017" ref-type="supplementary-material">S8 Table</xref>). The mean shapes of MALPACA-based and GS landmarks derived from their joint GPA are highly consistent (<xref rid="pone.0278035.s007" ref-type="supplementary-material">S6 Fig</xref>). All centroid sizes from MALPACA and ALPACA show nearly perfect correlations with the GS as the correlation coefficients exceed 0.99, while the MALPACA-GS correlation is the highest (<xref rid="pone.0278035.s018" ref-type="supplementary-material">S9 Table</xref>). Both pairwise Procrustes distances and PC 1 scores computed from MALPACA-derived estimated landmarks very strongly correlates with those derived from GS (r = 0.912 and 0.985 respectively) (<xref rid="pone.0278035.g006" ref-type="fig">Fig 6A</xref>). The MALPACA-derived estimates and GS also yield strong correlations in PC 2, PC 3 and PC 4 scores as the correlation coefficients all exceed 0.8 (<xref rid="pone.0278035.g006" ref-type="fig">Fig 6B</xref>).</p>
      <fig position="float" id="pone.0278035.g005">
        <object-id pub-id-type="doi">10.1371/journal.pone.0278035.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Comparison of RMSEs for the ape sample.</title>
          <p>RMSEs calculated between estimated landmarks and the GS landmarks. Each column represents the RMSEs of 46 ape specimens calculated by a specific analysis. “Ape Intraobserver” refers to the RMSEs between two manual landmark datasets of the ape sample. See <xref rid="pone.0278035.s005" ref-type="supplementary-material">S4 Fig</xref> for RMSEs as percentage of centroid sizes. See <xref rid="pone.0278035.s011" ref-type="supplementary-material">S2 Table</xref> for the template used for each ALPACA based on a K- means selected template.</p>
        </caption>
        <graphic xlink:href="pone.0278035.g005" position="float"/>
      </fig>
      <fig position="float" id="pone.0278035.g006">
        <object-id pub-id-type="doi">10.1371/journal.pone.0278035.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Ape MALPACA-Gold standard correlations in shape variables.</title>
          <p>(A) Estimated against GS pairwise Procrustes distances. (B) Correlations in the scores of the first six PCs (principal components) between estimated and GS landmarks. Each grid represents the correlation coefficient between a PC from an automated landmarking analysis and a PC from the GS, depending on its row and column names. Procrustes distances and PC scores are derived from separate GPAs of estimated and manual landmarks.</p>
        </caption>
        <graphic xlink:href="pone.0278035.g006" position="float"/>
      </fig>
      <p>Overall, our study confirms the expectation that MALPACA outperforms ALPACA because multiple templates can better capture gross variations within a sample. In both the analyses of the mouse and ape samples, MALPACA outperforms each ALPACA run by estimating landmarks significantly closer to the GS (manual landmarks) and generating size and shape variables in morphometric analyses more similar to those derived from the GS.</p>
      <p>Note that the ALPACA/MALPACA pipeline requires that the models are prepared consistently so that only the same anatomical structures are preserved across samples [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>]. For example, if a few cranial models have floating polygons or extra postcranial components attached, the landmarking accuracy of these models can be negatively impacted [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>]. Nevertheless, the ALPACA/MALPACA pipeline is robust with respect to small missing regions in specimens (e.g., a few broken teeth or small holes at the surface), and such specimens can still be used in the automated landmarking pipeline, provided that the landmark set does not contain any landmark that falls into the missing section (see the original ALPACA study [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>] for detailed discussion about the quality of 3D models). When in doubt of whether small missing parts on a specimen or the quality of a 3D model will impact the ALPACA/MALPACA performance, users can use the ALPACA module in the SlicerMorph extension to conveniently test landmarking performance for this individual specimen [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0278035.ref020" ref-type="bibr">20</xref>] (For tutorials, please see <xref rid="pone.0278035.s022" ref-type="supplementary-material">S1 Appendix</xref> and the ALPACA tutorial at <ext-link xlink:href="https://github.com/SlicerMorph/Tutorials/tree/main/ALPACA" ext-link-type="uri">https://github.com/SlicerMorph/Tutorials/tree/main/ALPACA</ext-link>).</p>
    </sec>
    <sec id="sec012">
      <title>Manual landmark errors</title>
      <p><xref rid="pone.0278035.g007" ref-type="fig">Fig 7</xref> compares the mouse manual landmarking errors (intraobserver errors) calculated by Percival et al [<xref rid="pone.0278035.ref009" ref-type="bibr">9</xref>] to the errors between estimated and GS landmarks in our study for the 34 landmarks that are shared between these two studies. In general, intraobserver errors are the smallest with a mean error 0.163 mm. The ALPACA-GS errors are much larger as the mean error reaches 0.294 mm. The MALPACA-GS method outperforms ALPACA-GS with a mean error 0.2 mm and is more comparable to the manual landmarking error.</p>
      <fig position="float" id="pone.0278035.g007">
        <object-id pub-id-type="doi">10.1371/journal.pone.0278035.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Individual landmark errors of the mouse sample comparing to intraobserver errors.</title>
          <p>Similar to <xref rid="pone.0278035.g002" ref-type="fig">Fig 2</xref>, columns represent errors between MALPACA and the GS for each landmark. Black dots: mean errors of the mouse MALPACA. Green dots: mean intraobserver errors computed by Percival et al. [<xref rid="pone.0278035.ref009" ref-type="bibr">9</xref>]. The labels on the x-axis are landmarks in this study that overlap with those from Percival et al. [<xref rid="pone.0278035.ref009" ref-type="bibr">9</xref>].</p>
        </caption>
        <graphic xlink:href="pone.0278035.g007" position="float"/>
      </fig>
      <p>For the ape sample, manual intraobserver errors are measured by the RMSEs, between two landmark sets. Again, the manual errors are significantly smaller than the errors between any set of estimates and GS landmarks (<xref rid="pone.0278035.g005" ref-type="fig">Fig 5</xref>, <xref rid="pone.0278035.s006" ref-type="supplementary-material">S5 Fig</xref>). The one-sided Welch t-test for assessing whether the manual errors are smaller than the MALPACA-manual errors yields a p-value of 2.381 × 10<sup>−19</sup>. Comparing individual landmark errors show that, for 38 of 41 landmarks, the intraobserver manual errors are significantly smaller than the MALPACA-manual errors (p-values &lt; 0.05 based on the one-sided t-test that assesses if individual intraobserver landmark errors are smaller) (<xref rid="pone.0278035.g008" ref-type="fig">Fig 8</xref>, <xref rid="pone.0278035.s008" ref-type="supplementary-material">S7 Fig</xref> and <xref rid="pone.0278035.s019" ref-type="supplementary-material">S10 Table</xref>).</p>
      <fig position="float" id="pone.0278035.g008">
        <object-id pub-id-type="doi">10.1371/journal.pone.0278035.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Individual landmark errors of the ape sample.</title>
          <p>Errors represented by Euclidean distances (for errors expressed in percentage of centroid sizes, see <xref rid="pone.0278035.s004" ref-type="supplementary-material">S3 Fig</xref>). Each column represents errors between MALPACA-derived estimates of all 46 ape specimens for the one landmark and their corresponding Gold Standard (GS) landmarks. Each green dot represents the median of the intraobserver manual errors of all 46 ape specimens for one landmark between two manual landmark sets.</p>
        </caption>
        <graphic xlink:href="pone.0278035.g008" position="float"/>
      </fig>
      <p>In both the mouse and ape samples, the deviations between MALPACA and GS are obviously much larger than the errors between two manual landmarking trials. This is as expected, as intraobserver errors created by the same expert are usually very small. Still, the MALPACA-GS errors in landmark positions are closer to the intraobserver errors than the ALPACA-GS errors.</p>
      <p>Inter-observer errors are usually larger than intraobserver errors [<xref rid="pone.0278035.ref013" ref-type="bibr">13</xref>, <xref rid="pone.0278035.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0278035.ref016" ref-type="bibr">16</xref>]. These errors can be as significant as some biologically meaningful variations, in particular those that are subtle but biologically meaningful, such as intraspecific variations and sexual dimorphism [<xref rid="pone.0278035.ref009" ref-type="bibr">9</xref>, <xref rid="pone.0278035.ref013" ref-type="bibr">13</xref>, <xref rid="pone.0278035.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0278035.ref016" ref-type="bibr">16</xref>]. This is especially the case when pooling discrete landmarks or a combination of discrete landmarks and sliding semilandmarks collected by different operators [<xref rid="pone.0278035.ref016" ref-type="bibr">16</xref>]. Furthermore, interobserver errors can be unpredictable as they have a variety of causes, including subjective understanding of anatomical variations, vague landmark protocols, and different landmark annotation tools [<xref rid="pone.0278035.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0278035.ref016" ref-type="bibr">16</xref>]. In recent years, pooling data collected by multiple researchers has become increasingly common [<xref rid="pone.0278035.ref013" ref-type="bibr">13</xref>, <xref rid="pone.0278035.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0278035.ref016" ref-type="bibr">16</xref>]. Consequently, while research collaboration and data sharing are greatly increasing time efficiency for data collection and sample size for higher statistical power, controlling interobserver errors is becoming more difficult and complicated. This can create issues in accurately detecting subtle biological meaningful variations, consistency and reproducibility [<xref rid="pone.0278035.ref013" ref-type="bibr">13</xref>, <xref rid="pone.0278035.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0278035.ref016" ref-type="bibr">16</xref>]. MALPACA, by contrasts, produces highly consistent landmarks when the same templates are used. Researchers can focus on carefully landmarking a short list of templates that can be shared with others. In this way, MALPACA can greatly facilitate data sharing while also ensuring consistency and reproducibility.</p>
    </sec>
    <sec id="sec013">
      <title>The performance of K-means selected templates</title>
      <p>Template selection for properly representing the whole sample is a critical factor in determining the performance of any template based method to avoid potential biases in the outcome especially when the sample is highly variable [<xref rid="pone.0278035.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0278035.ref028" ref-type="bibr">28</xref>, <xref rid="pone.0278035.ref029" ref-type="bibr">29</xref>]. For example, in the field of automatic segmentation based on neuroimage registrations, various multi-atlas selection methods have been designed with differential accuracy for delineating organs [<xref rid="pone.0278035.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0278035.ref028" ref-type="bibr">28</xref>]. In this study, we propose a convenient method to identify multiple samples that can be used as templates for a study population by applying K-means clustering to the PCA scores derived from the downsampled point cloud data of their 3D models. It is expected that this approach will be able to capture gross patterns of overall shape variations when there is no prior information available to the investigator to guide the template selection.</p>
      <p>Permutation tests are carried out to assess whether K-means based templates outperform randomly selected templates as a way to determine the efficacy of K-means multi-template selection. For the mouse sample, the mean RMSE from the K-means based MALPACA is smaller than 28 of 100 (28%) mean RMSE scores from the permutated MALPACA runs (<xref rid="pone.0278035.g009" ref-type="fig">Fig 9A</xref>). This suggests that the K-means based MALPACA in general outperforms 28% of the MALPACA runs using randomly selected templates. Furthermore, 25 out of 54 specimens (46.2%) have RMSEs from the K-means based MALPACA smaller than the 50th percentile of the 5,400 RMSEs of individual specimens from the permutation analysis.</p>
      <fig position="float" id="pone.0278035.g009">
        <object-id pub-id-type="doi">10.1371/journal.pone.0278035.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <title>Permutation analyses for evaluating the performance of the K-means template selection method.</title>
          <p>(A) The boxplot shows the mean RMSEs of the 100 MALPACA runs from the mouse permutation analysis. The red horizontal line represents the mean RMSE from the mouse K-means based MALPACA. (B) The boxplot shows the mean RMSEs of the 50 MALPACA runs from the ape permutation analysis. The red horizontal line represents the mean RMSE from the ape K-means based MALPACA.</p>
        </caption>
        <graphic xlink:href="pone.0278035.g009" position="float"/>
      </fig>
      <p>For the ape sample, the mean RMSE from the K-means based MALPACA is smaller than 24 of 50 (48%) mean RMSE scores derived from the permutated MALPACA runs (<xref rid="pone.0278035.g009" ref-type="fig">Fig 9B</xref>). This suggests that the K-means based MALPACA for the mouse sample in general outperforms the 48% of the MALPACA runs based on randomly selected templates. The comparison of individual RMSEs for the ape dataset is consistent with the analysis of the mouse sample. Overall, 20 out of 46 specimens (43.5%) have RMSEs from the K-means based MALPACA below the 50th percentile of the 4,600 RMSEs from the permutation analysis. In addition, the ranges of RMSEs derived from the mouse and ape K-means based MALPACA both overlap with the RMSEs derived from the permutation analysis (<xref rid="pone.0278035.s020" ref-type="supplementary-material">S11 Table</xref>).</p>
      <p>These results show that running MALPACA with K-means selected templates neither outperforms nor underperforms the use of randomly selected templates. Furthermore, as shown in this study, the K-means based MALPACA consistently generates more accurate landmarks than does any single template-based analysis. Therefore, though the K-means template selection method may miss the template sets that are significantly better than the random template sets, it can effectively avoid selection of template sets that significantly underperform the randomly selected templates. As a result, the K-means approach to template selection provides increased consistency in the performance of MALPACA.</p>
      <p>Investigators can skip the template selection procedure if they have other information that can be used to determine the templates to use (e.g., prior data, similar genetic background etc.). However, if there is uncertainty around what templates should be used, our K-means multi-template selection method provides a reasonable and safe solution for choosing specimens as templates for automated landmarking. Furthermore, the K-means template selection method is very efficient and convenient to run with our graphic user-interface (GUI) module, facilitating easy experimentation with this selection method when conducting MALPACA.</p>
      <p>There are certain assumptions behind this approach that are important to consider before using K-means template selection. First, there is no rule for determining the number k for the K-means method. We use seven templates for the mouse sample and six templates for the ape sample for experiment purposes, which approximately reflect 10–12% of our sample sizes. More investigation needs to be done to identify what is the optimal number of templates (k) to use in a study to balance additional computational time versus improvement in estimates. However, we suspect this optimization will be highly dependent on the nature of the dataset being analyzed.</p>
      <p>Second, K-means multi-template selection is determined by the sparse point clouds with point-to-point correspondence, which ultimately depends on the registration between each specimen and the reference. For convenience, this study selects the first one in the specimen list as the reference. If a different specimen is selected as the reference, the registration will be slightly different as will the point clouds. This may lead to a slightly different set of templates. Thus, it is important to assess how different choices of reference in point cloud generation may influence K-means multi-template selection, hence the final results of MALPACA in the future.</p>
      <p>It is also important to note that the input models of the K-means template selection approach should contain the same corresponding structures across samples. For example, if 3D models of skull variably contain pieces of vertebrate, parts of mandibular joint, other non-cranial elements across samples, they will influence the analysis, because ultimately the analysis is dependent on the extracted point cloud. If a sample is partial or broken (e.g., missing a large section alveolar row on maxilla), it should be left out of the template selection analysis, because the correspondence of the point cloud generated from this sample is unlikely to match to that of others.</p>
      <p>If users are uncertain about whether the quality of a 3D model is sufficient for the K-means template selection approach, they can use the GUI module to run the K-means pipeline on a small subset of the sample as a quick test run (see <xref rid="pone.0278035.s022" ref-type="supplementary-material">S1 Appendix</xref> for details). This GUI module will produce a PCA plot that shows the distribution of specimens according to the shape differences in their point cloud data. When an extreme outlier exists in the PCA plot, i.e., a specimen is widely separated from the rest of the sample, it may indicate that the quality of this specimen is too low so that its point cloud does not match well with the others. Because all the point clouds are exported, users can import the problematic one into Slicer to perform a visual check. On the other hand, as discussed previously, the ALPACA/MALPACA pipeline has a higher tolerance for small broken or missing parts on the models. Therefore, if a few models are imperfect for the K-means approach but are still proper for ALPACA/MALPACA (e.g., using the ALPACA module for a quick test as discussed previously), users can simply remove them from the K-means templates selection pipeline and add them back to the automated landmarking process after templates are selected.</p>
    </sec>
    <sec id="sec014">
      <title><italic toggle="yes">Post-hoc</italic> quality check and refined MALPACA performance</title>
      <p>The MALPACA pipeline allows for conveniently designing <italic toggle="yes">post-hoc</italic> analyses to assess landmarking quality for further boosting performance because all estimates given by each template are exported. It is not easy for researchers to evaluate how well the automated landmarking performed without manually landmarking the target specimen and calculating the errors, or alternatively, visualizing the estimate on the target model. Both approaches are too tedious or downright unfeasible for a large study.</p>
      <p>Consequently, we provide an example of how individual estimates can be conveniently used for a <italic toggle="yes">post-hoc</italic> evaluation of the quality of landmark estimates using simple heuristics in lieu of gold standard landmarks. The essence of the <italic toggle="yes">post-hoc</italic> quality check is to determine whether certain estimates generated from a template deviate too much from the corresponding estimates generated by other templates, thus can be treated as outliers.</p>
      <p>The outlier detection and removal functions successfully pinpoint the outlier estimates for the four <italic toggle="yes">Gorilla</italic> specimens with extreme RMSE values derived from the juvenile <italic toggle="yes">Pan</italic> template (USNM176236), along with other outliers given by other templates that exceed the threshold (<xref rid="pone.0278035.g005" ref-type="fig">Fig 5</xref>; <xref rid="pone.0278035.s021" ref-type="supplementary-material">S1 File</xref>). This is because differences between this juvenile <italic toggle="yes">Pan</italic> template and the adult <italic toggle="yes">Gorilla</italic> specimens are large hence the global registration in ALPACA poorly aligned their point clouds. This leads to erroneous landmarking results. After removing the identified outlier estimates, the RMSEs between the new medians and GS are not significantly smaller than the RMSEs derived from the original MALPACA median estimates and GS, suggesting similar performance (p-value = 0.5751; see <xref rid="pone.0278035.g010" ref-type="fig">Fig 10A</xref>). This is because the MALPACA landmark estimates are based on medians, which are more robust to outliers than means.</p>
      <fig position="float" id="pone.0278035.g010">
        <object-id pub-id-type="doi">10.1371/journal.pone.0278035.g010</object-id>
        <label>Fig 10</label>
        <caption>
          <title>RMSEs comparison boxplots for ape refined MALPACAs.</title>
          <p>(A) The boxplot for comparing the performance of the ape MALPACA and the new median estimates achieved after removing outlier estimates demonstrated in <xref rid="pone.0278035.s009" ref-type="supplementary-material">S8 Fig</xref>. Comparison is based on calculating RMSEs between estimates and the GS. Two-sided Welch t-test shows that the RMSEs yielded from these two analyses are not significantly different with a p-value 0.5751. (B) RMSEs between the original ape MALPACA and “species-specific” MALPACA for the ape sample. Species-specific MALPACA refers to performing a MALPACA for one species only using templates of that species. RMSEs are calculated between estimates and the GS.</p>
        </caption>
        <graphic xlink:href="pone.0278035.g010" position="float"/>
      </fig>
      <p>It should be noted that we choose to only remove the outlier estimates derived from this juvenile <italic toggle="yes">Pan</italic> template rather than removing all its estimates because the juvenile <italic toggle="yes">Pan</italic> template may still yield better estimates for certain landmarks on other specimens. If some estimates given by the juvenile <italic toggle="yes">Pan</italic> template deviate much from those given by the other templates, the outlier removal method can also automatically delete them. Users can opt to remove all estimates given by a template, like the <italic toggle="yes">juvenile</italic> Pan, if they find out that it yields poor estimates for many specimens. They can also define their own heuristic standards for outlier detection, such as increasing the heuristic standard to only pinpoint exceptionally worse estimates that can indicate poor alignment between a template and some target specimens.</p>
      <p>Still, the issue derived from using a juvenile <italic toggle="yes">Pan</italic> template to landmark adult <italic toggle="yes">Gorilla</italic> specimens is indicative of situation when morphologically well-differentiated species exist within a study sample and including results from the templates of other species may have the potential to hamper the accuracy of the final estimates for specimens from each species. As a result, when templates from all distinct ape species are used for landmarking the whole sample, the final output of the MALPACA, i.e., the original MALPACA, may be sub-optimal. This motivates us to develop a “species-specific” approach of MALPACA. With the output estimates given by each individual template in hand, the species-specific MALPACA is easily done by calculating median values between the two landmark sets of each ape species derived from its two templates. The original and species-specific MALPACA estimates show largely consistent results, again demonstrating the advantage of using the median to buffer the impact of outlier estimates (<xref rid="pone.0278035.g010" ref-type="fig">Fig 10B</xref> and <xref rid="pone.0278035.s009" ref-type="supplementary-material">S8 Fig</xref>). On the other hand, the species-specific MALPACA-derived estimates do yield scores of PC 2 and PC 3 more correlated to those yielded by manual landmarks as the correlation coefficients both exceed 0.9, suggesting an improvement in morphometric analysis (<xref rid="pone.0278035.s009" ref-type="supplementary-material">S8B Fig</xref>).</p>
      <p>Overall, the quality check of landmark estimates and refined MALPACA results show the flexibility and convenience of designing <italic toggle="yes">post-hoc</italic> analysis based on MALPACA output. We encourage users to try different approaches based on estimates of individual template and the structures of their samples. GUI modules for MALPACA and K-means multi-template selection are included in the existing open-access SlicerMorph module to facilitating the usage and exploration of these methods. For example, users can use the GUI module of MALPACA along with a <italic toggle="yes">post-hoc</italic> outlier detection analysis to conduct pilot studies using a subset of a large sample for efficiently evaluating the performance of K-means selected templates or experimenting with different template choices.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec015">
    <title>Conclusion</title>
    <p>We demonstrate that the multi-template automated landmarking method MALPACA outperforms ALPACA by estimating landmarks significantly closer to the “gold standard” manual landmarks. MALPACA is particularly suitable for landmarking morphologically diverse samples, such as the multi-taxa samples commonly encountered in evolutionary studies. The K-means template selection approach can yield a sufficiently good template set for MALPACA when users have no prior information for choosing templates, though this method is optional. Furthermore, we provide an example to show the flexibility of designing a <italic toggle="yes">post-hoc</italic> quality check for the performance of each template without a “gold standard” landmark set. Users are encouraged to use the accompanying GUI tools in SlicerMorph and the SlicerMorphR R package to explore different template choices and investigate their performance in MALPACA. Overall, MALPACA, as an open-source, lightweight, and user-friendly tool, offers the potential for large-scale collaboration and data sharing for morphometric analysis while ensuring accuracy, consistency, and reproducibility, thus helping to bring morphometrics fully into the “era of big data”.</p>
  </sec>
  <sec id="sec016" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pone.0278035.s001" position="float" content-type="local-data">
      <label>S1 Data</label>
      <caption>
        <title>Data and materials availability.</title>
        <p>The mouse data is freely available as part of <ext-link xlink:href="https://doi.org/10.1111/joa.12645" ext-link-type="uri">https://doi.org/10.1111/joa.12645</ext-link> and is also available at <ext-link xlink:href="https://github.com/SlicerMorph/mouse_models" ext-link-type="uri">SlicerMorph/Mouse_Models (github.com)</ext-link>. The raw DICOM sequences of hominoids used here are free for non-commercial use from the Smithsonian Institution’s National Museum of Natural History (NMNH) (<ext-link xlink:href="http://humanorigins.si.edu/evidence/3d-collection/primate" ext-link-type="uri">http://humanorigins.si.edu/evidence/3d-collection/primate</ext-link>). Please contact the institution at <ext-link xlink:href="https://dpo.si.edu" ext-link-type="uri">https://dpo.si.edu</ext-link> to obtain access to the models. The ape manual landmark data are part of <ext-link xlink:href="https://doi.org/10.1002/ajpa.24214" ext-link-type="uri">https://doi.org/10.1002/ajpa.24214</ext-link>. MALPACA derived LM estimated used in the ape study are available as part of the <ext-link xlink:href="https://github.com/SlicerMorph/mouse_models" ext-link-type="uri">SlicerMorph/Mouse_Models (github.com)</ext-link> repository.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0278035.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s002" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Anatomical landmarks used in this study.</title>
        <p>(A) 51 landmarks for the mouse sample. (B) 41 landmarks for the ape sample. For data availability, see <xref rid="pone.0278035.s001" ref-type="supplementary-material">S1 Data</xref>.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0278035.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s003" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>Comparison of RMSEs (as percentage of centroid sizes) for the mouse sample.</title>
        <p>RMSEs calculated between estimated landmarks and the “gold standard”. Each box represents the RMSEs of 54 mouse specimens calculated by a specific analysis. “ALPACA”: Mouse ALPACA is estimated using the synthetic mouse template used in the original ALPACA paper. Other boxes are ALPACA-derived estimates using specified template. Centroid sizes are calculated from the Gold Standard landmark set.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0278035.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s004" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Individual landmark errors (as percentage of centroid sizes) for the mouse sample.</title>
        <p>Errors represent by Euclidean distance transformed into percentage of centroid sizes. Each box represents errors between MALPACA-derived estimates of all 54 mouse specimens for one landmark and their corresponding Gold Standard (GS) landmarks. Red dots: each represents the median of errors between the estimates of the synthetic template ALPACA of all 54 mouse specimens for one landmark and their corresponding GS landmarks. Centroid sizes are calculated from the Gold Standard landmark set.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0278035.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s005" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>Superimposition of joint GPA for mouse MALPACA and manual landmarks (XY dimensions) based on the mouse sample.</title>
        <p>Light blue dots: all manual landmarks. Dark blue cross: mean manual landmarks. Light red dots: all MALPACA-derived estimated landmarks. Deep red cross: mean MALPACA-derived estimated landmarks.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0278035.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s006" position="float" content-type="local-data">
      <label>S5 Fig</label>
      <caption>
        <title>Comparison of RMSEs (as percentage of centroid sizes) for the ape sample.</title>
        <p>RMSEs calculated between estimated landmarks and the “gold standard”. Each box represents the RMSEs of 46 ape specimens calculated by a specific analysis. “Ape Intraobserver” refers to the RMSEs between two manual landmark datasets of the ape sample. See <xref rid="pone.0278035.s005" ref-type="supplementary-material">S4 Fig</xref> for RMSEs as percentage of centroid sizes. See <xref rid="pone.0278035.t002" ref-type="table">Table 2</xref> for the template used for each ALPACA based on a K- means selected template. Centroid sizes are calculated from the Gold Standard landmark set.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0278035.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s007" position="float" content-type="local-data">
      <label>S6 Fig</label>
      <caption>
        <title>Superimposition of joint GPA for ape MALPACA and manual landmarks (XY dimensions) based on the ape sample.</title>
        <p>Light blue dots: all manual landmarks. Dark blue cross: mean manual landmarks. Light red dots: all MALPACA-derived estimated landmarks. Deep red cross: mean MALPACA-derived estimated landmarks.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0278035.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s008" position="float" content-type="local-data">
      <label>S7 Fig</label>
      <caption>
        <title>Individual landmark errors of the ape sample as in percentage of centroid sizes.</title>
        <p>Boxes represent errors between MALPACA-derived estimates and the Gold Standard (GS) landmarks. Green dots represent median intraobserver manual landmark errors between two manual landmark sets. Centroid sizes are calculated from the Gold Standard landmark set.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0278035.s008.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s009" position="float" content-type="local-data">
      <label>S8 Fig</label>
      <caption>
        <title>Performance of ape species-specific MALPACA comparing to manual landmarks.</title>
        <p>(A) Correlation in the pairwise Procrustes distances derived from species-specific MALPACA and manual landmarks. (B) Correlations in PC scores derived from species-specific MALPACA and manual landmarks. Each grid represents the correlation coefficient between a PC from an automated landmarking analysis and a PC from the Gold Standard, depending on its row and column names.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0278035.s009.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s010" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Specimen ID for the mouse sample.</title>
        <p>Sample size = 61. The K-means selected templates are bold and marked by “template”.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0278035.s010.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s011" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>Specimen IDs and species designation for the ape sample.</title>
        <p>Sample size = 52. The two templates selected by K-means per species (six templates total) are bold and marked by “template” in the parenthesis. The remaining 46 specimens are being landmarked.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0278035.s011.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s012" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>Settings for K-means multi-template selection.</title>
        <p>MALPACA uses the default settings listed in the ALPACA module of the SlicerMorph extension. See Porto et al. [<xref rid="pone.0278035.ref010" ref-type="bibr">10</xref>] for detail. Spacing factor determines the point cloud density for K-means. See section 2 of the supplementary material for details. In general, the settings ensure that each point cloud used for the K-means template selection has 700 to 800 points. Also see <xref rid="pone.0278035.s022" ref-type="supplementary-material">S1 Appendix</xref> for explanations of these settings.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0278035.s012.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s013" position="float" content-type="local-data">
      <label>S4 Table</label>
      <caption>
        <title>P-values from one sided Welch t-tests comparing mouse MALPACA and ALPACA RMSEs.</title>
        <p>One-sided t-tests compare whether mouse MALPACA RMSEs significantly smaller than ALPACA RMSEs using the synthetic template and individual mouse template.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0278035.s013.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s014" position="float" content-type="local-data">
      <label>S5 Table</label>
      <caption>
        <title>P-values of one-sided Welch t-tests that compare if MALPACA individual landmark errors are smaller than ALPACA errors.</title>
        <p>MALPACA errors versus manual landmarks significantly smaller than ALPACA errors in the 37 landmarks listed.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0278035.s014.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s015" position="float" content-type="local-data">
      <label>S6 Table</label>
      <caption>
        <title>P-values of one-sided Welch t-tests that compare if ALPACA individual landmark errors are smaller than MALPACA errors for the mouse sample.</title>
        <p>Only listing landmarks not listed in <xref rid="pone.0278035.s014" ref-type="supplementary-material">S5 Table</xref>, i.e., MALPACA-derived estimates do not show significantly smaller errors than ALPACA ones in these 14 landmarks according to the one-sided t-test in <xref rid="pone.0278035.s014" ref-type="supplementary-material">S5 Table</xref>.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0278035.s015.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s016" position="float" content-type="local-data">
      <label>S7 Table</label>
      <caption>
        <title>Correlations between estimated and manual landmarks in centroid sizes for the mouse sample.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0278035.s016.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s017" position="float" content-type="local-data">
      <label>S8 Table</label>
      <caption>
        <title>P-values from one sided Welch t-tests comparing ape MALPACA and ALPACA RMSEs derived from individual template.</title>
        <p>One-sided t-tests compare whether ape MALPACA RMSEs significantly smaller than ALPACA RMSEs using an individual ape template.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0278035.s017.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s018" position="float" content-type="local-data">
      <label>S9 Table</label>
      <caption>
        <title>Correlations between estimated and manual landmarks in centroid sizes for the ape sample.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0278035.s018.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s019" position="float" content-type="local-data">
      <label>S10 Table</label>
      <caption>
        <title>Correlations between estimated and manual landmarks in centroid sizes for the ape sample.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0278035.s019.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s020" position="float" content-type="local-data">
      <label>S11 Table</label>
      <caption>
        <title>RMSEs of K-means-based MALPACAs comparing to the permutated RMSEs.</title>
        <p>The values in the paratheses are corresponding quantile values of permutation analyses.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0278035.s020.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s021" position="float" content-type="local-data">
      <label>S1 File</label>
      <caption>
        <title>Boxplots for the ape individual estimates and the threshold for choosing outliers.</title>
        <p>Each graph shows the boxplot of distances between individual estimates of one ape specimen to the corresponding MALPACA final output. The red horizontal line represents the threshold, which is two standard deviations above the mean of the distances for that specimen.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0278035.s021.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pone.0278035.s022" position="float" content-type="local-data">
      <label>S1 Appendix</label>
      <caption>
        <title>Step-by-step instructions for running K-means template selection and MALPACA.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0278035.s022.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the Smithsonian’s Division of Mammals and Human Origins Program as well as Dr Matt Tocheri and Dr Kristofer Helgen for the scans of USNM specimens used in this research (<ext-link xlink:href="http://humanorigins.si.edu/evidence/3d-collection/primate" ext-link-type="uri">http://humanorigins.si.edu/evidence/3d-collection/primate</ext-link>). These scans were acquired through the generous support of the Smithsonian 2.0 Fund and the Smithsonian’s Collections Care and Preservation Fund.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0278035.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Adams</surname><given-names>DC</given-names></name>, <name><surname>Rohlf</surname><given-names>FJ</given-names></name>, <name><surname>Slice</surname><given-names>DE</given-names></name>. <article-title>A field comes of age: geometric morphometrics in the 21st century</article-title>. <source>Hystrix</source>. <year>2013</year>;<volume>24</volume>: <fpage>7</fpage>–<lpage>14</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.4404/hystrix-24.1–6283</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Baab</surname><given-names>KL</given-names></name>, <name><surname>McNulty</surname><given-names>KP</given-names></name>, <name><surname>Rohlf</surname><given-names>FJ</given-names></name>. <article-title>The shape of human evolution: a geometric morphometrics perspective</article-title>. <source>Evol Anthropol Issues News Rev</source>. <year>2012</year>;<volume>21</volume>: <fpage>151</fpage>–<lpage>165</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/evan.21320</pub-id><?supplied-pmid 22907868?><pub-id pub-id-type="pmid">22907868</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Latif</surname><given-names>A</given-names></name>, <name><surname>Kuijpers</surname><given-names>MA</given-names></name>, <name><surname>Rachwalski</surname><given-names>M</given-names></name>, <name><surname>Latief</surname><given-names>BS</given-names></name>, <name><surname>Kuijpers-Jagtman</surname><given-names>AM</given-names></name>, <name><surname>Fudalej</surname><given-names>PS</given-names></name>. <article-title>Morphological variability in unrepaired bilateral clefts with and without cleft palate evaluated with geometric morphometrics</article-title>. <source>J Anat</source>. <year>2020</year>;<volume>236</volume>: <fpage>425</fpage>–<lpage>433</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/joa.13118</pub-id><?supplied-pmid 31792971?><pub-id pub-id-type="pmid">31792971</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Motch Perrine</surname><given-names>SM</given-names></name>, <name><surname>Cole</surname><given-names>TM</given-names></name>, <name><surname>Martínez-Abadías</surname><given-names>N</given-names></name>, <name><surname>Aldridge</surname><given-names>K</given-names></name>, <name><surname>Jabs</surname><given-names>EW</given-names></name>, <name><surname>Richtsmeier</surname><given-names>JT</given-names></name>. <article-title>Craniofacial divergence by distinct prenatal growth patterns in Fgfr2 mutant mice</article-title>. <source>BMC Dev Biol</source>. <year>2014</year>;<volume>14</volume>: <fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-213X-14-8</pub-id><?supplied-pmid 24580805?><pub-id pub-id-type="pmid">24580805</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Motch Perrine</surname><given-names>SM</given-names></name>, <name><surname>Wu</surname><given-names>M</given-names></name>, <name><surname>Stephens</surname><given-names>NB</given-names></name>, <name><surname>Kriti</surname><given-names>D</given-names></name>, <name><surname>Van Bakel</surname><given-names>H</given-names></name>, <name><surname>Jabs</surname><given-names>EW</given-names></name>, <etal>et al</etal>. <article-title>Mandibular dysmorphology due to abnormal embryonic osteogenesis in FGFR2-related craniosynostosis mice</article-title>. <source>Dis Model Mech</source>. <year>2019</year>;<volume>12</volume>: dmm038513. <comment>doi: </comment><pub-id pub-id-type="doi">10.1242/dmm.038513</pub-id><?supplied-pmid 31064775?><pub-id pub-id-type="pmid">31064775</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Muñoz</surname><given-names>MM</given-names></name>, <name><surname>Price</surname><given-names>SA</given-names></name>. <article-title>The future is bright for evolutionary morphology and biomechanics in the era of big data</article-title>. <source>Integr Comp Biol</source>. <year>2019</year>;<volume>59</volume>: <fpage>599</fpage>–<lpage>603</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/icb/icz121</pub-id><?supplied-pmid 31353403?><pub-id pub-id-type="pmid">31353403</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Rutland</surname><given-names>JW</given-names></name>, <name><surname>Bellaire</surname><given-names>CP</given-names></name>, <name><surname>Yao</surname><given-names>A</given-names></name>, <name><surname>Arrighi-Allisan</surname><given-names>A</given-names></name>, <name><surname>Napoli</surname><given-names>JG</given-names></name>, <name><surname>Delman</surname><given-names>BN</given-names></name>, <etal>et al</etal>. <article-title>The Expanding Role of Geometric Morphometrics in Craniofacial Surgery</article-title>. <source>J Craniofac Surg</source>. <year>2021</year>;<volume>32</volume>: <fpage>1104</fpage>–<lpage>1109</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1097/SCS.0000000000007362</pub-id><?supplied-pmid 34779599?><pub-id pub-id-type="pmid">34779599</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref008">
      <label>8</label>
      <mixed-citation publication-type="other">Aneja D, Vora SR, Camci ED, Shapiro LG, Cox TC. Automated detection of 3d landmarks for the elimination of non-biological variation in geometric morphometric analyses. 2015 IEEE 28th International Symposium on Computer-Based Medical Systems. IEEE; 2015. pp. 78–83.</mixed-citation>
    </ref>
    <ref id="pone.0278035.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Percival</surname><given-names>CJ</given-names></name>, <name><surname>Devine</surname><given-names>J</given-names></name>, <name><surname>Darwin</surname><given-names>BC</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name>, <name><surname>van Eede</surname><given-names>M</given-names></name>, <name><surname>Henkelman</surname><given-names>RM</given-names></name>, <etal>et al</etal>. <article-title>The effect of automated landmark identification on morphometric analyses</article-title>. <source>J Anat</source>. <year>2019</year>;<volume>234</volume>: <fpage>917</fpage>–<lpage>935</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/joa.12973</pub-id><?supplied-pmid 30901082?><pub-id pub-id-type="pmid">30901082</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Porto</surname><given-names>A</given-names></name>, <name><surname>Rolfe</surname><given-names>S</given-names></name>, <name><surname>Maga</surname><given-names>AM</given-names></name>. <article-title>ALPACA: A fast and accurate computer vision approach for automated landmarking of three-dimensional biological structures</article-title>. <source>Methods Ecol Evol</source>. <year>2021</year>;<volume>12</volume>: <fpage>2129</fpage>–<lpage>2144</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/2041-210X.13689</pub-id><?supplied-pmid 35874971?><pub-id pub-id-type="pmid">35874971</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref011">
      <label>11</label>
      <mixed-citation publication-type="other">Pui S, Minoi J-L. A Non-template Based Automatic Landmarking on 3D Face Data. Proceedings of the 3rd International Conference on Video and Image Processing. 2019. pp. 212–216.</mixed-citation>
    </ref>
    <ref id="pone.0278035.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Young</surname><given-names>R</given-names></name>, <name><surname>Maga</surname><given-names>AM</given-names></name>. <article-title>Performance of single and multi-atlas based automated landmarking methods compared to expert annotations in volumetric microCT datasets of mouse mandibles</article-title>. <source>Front Zool</source>. <year>2015</year>;<volume>12</volume>: <fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12983-015-0127-8</pub-id><?supplied-pmid 26628903?><pub-id pub-id-type="pmid">25628752</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Daboul</surname><given-names>A</given-names></name>, <name><surname>Ivanovska</surname><given-names>T</given-names></name>, <name><surname>Bülow</surname><given-names>R</given-names></name>, <name><surname>Biffar</surname><given-names>R</given-names></name>, <name><surname>Cardini</surname><given-names>A</given-names></name>. <article-title>Procrustes-based geometric morphometrics on MRI images: An example of inter-operator bias in 3D landmarks and its impact on big datasets</article-title>. <source>PloS One</source>. <year>2018</year>;<volume>13</volume>: <fpage>e0197675</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0197675</pub-id><?supplied-pmid 29787586?><pub-id pub-id-type="pmid">29787586</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Percival</surname><given-names>CJ</given-names></name>, <name><surname>Green</surname><given-names>R</given-names></name>, <name><surname>Marcucio</surname><given-names>R</given-names></name>, <name><surname>Hallgrímsson</surname><given-names>B</given-names></name>. <article-title>Surface landmark quantification of embryonic mouse craniofacial morphogenesis</article-title>. <source>BMC Dev Biol</source>. <year>2014</year>;<volume>14</volume>: <fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-213X-14-31</pub-id><?supplied-pmid 25059626?><pub-id pub-id-type="pmid">25059626</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>C</given-names></name>, <name><surname>Terhune</surname><given-names>CE</given-names></name>. <article-title>Error in geometric morphometric data collection: Combining data from multiple sources</article-title>. <source>Am J Phys Anthropol</source>. <year>2017</year>;<volume>164</volume>: <fpage>62</fpage>–<lpage>75</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/ajpa.23257</pub-id><?supplied-pmid 28573732?><pub-id pub-id-type="pmid">28573732</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Evin</surname><given-names>A</given-names></name>, <name><surname>Bonhomme</surname><given-names>V</given-names></name>, <name><surname>Claude</surname><given-names>J</given-names></name>. <article-title>Optimizing digitalization effort in morphometrics</article-title>. <source>Biol Methods Protoc</source>. <year>2020</year>;<volume>5</volume>: bpaa023. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/biomethods/bpaa023</pub-id><?supplied-pmid 33324759?><pub-id pub-id-type="pmid">33324759</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Fruciano</surname><given-names>C.</given-names></name><article-title>Measurement error in geometric morphometrics</article-title>. <source>Dev Genes Evol</source>. <year>2016</year>;<volume>226</volume>: <fpage>139</fpage>–<lpage>158</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00427-016-0537-4</pub-id><?supplied-pmid 27038025?><pub-id pub-id-type="pmid">27038025</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Bromiley</surname><given-names>PA</given-names></name>, <name><surname>Schunke</surname><given-names>AC</given-names></name>, <name><surname>Ragheb</surname><given-names>H</given-names></name>, <name><surname>Thacker</surname><given-names>NA</given-names></name>, <name><surname>Tautz</surname><given-names>D</given-names></name>. <article-title>Semi-automatic landmark point annotation for geometric morphometrics</article-title>. <source>Front Zool</source>. <year>2014</year>;<volume>11</volume>: <fpage>1</fpage>–<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12983-014-0061-1</pub-id><pub-id pub-id-type="pmid">24401080</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Devine</surname><given-names>J</given-names></name>, <name><surname>Aponte</surname><given-names>JD</given-names></name>, <name><surname>Katz</surname><given-names>DC</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name>, <name><surname>Vercio</surname><given-names>LDL</given-names></name>, <name><surname>Forkert</surname><given-names>ND</given-names></name>, <etal>et al</etal>. <article-title>A registration and deep learning approach to automated landmark detection for geometric morphometrics</article-title>. <source>Evol Biol</source>. <year>2020</year>;<volume>47</volume>: <fpage>246</fpage>–<lpage>259</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s11692-020-09508-8</pub-id><?supplied-pmid 33583965?><pub-id pub-id-type="pmid">33583965</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Maga</surname><given-names>AM</given-names></name>, <name><surname>Tustison</surname><given-names>NJ</given-names></name>, <name><surname>Avants</surname><given-names>BB</given-names></name>. <article-title>A population level atlas of Mus musculus craniofacial skeleton and automated image-based shape analysis</article-title>. <source>J Anat</source>. <year>2017</year>;<volume>231</volume>: <fpage>433</fpage>–<lpage>443</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/joa.12645</pub-id><?supplied-pmid 28656622?><pub-id pub-id-type="pmid">28656622</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Rolfe</surname><given-names>S</given-names></name>, <name><surname>Pieper</surname><given-names>S</given-names></name>, <name><surname>Porto</surname><given-names>A</given-names></name>, <name><surname>Diamond</surname><given-names>K</given-names></name>, <name><surname>Winchester</surname><given-names>J</given-names></name>, <name><surname>Shan</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>SlicerMorph: An open and extensible platform to retrieve, visualize and analyze 3D morphology</article-title>. <source>Methods Ecol Evol</source>. <year>2021</year>;<volume>12</volume>: <fpage>1816</fpage>–<lpage>1825</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/2041-210X.13669</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref022">
      <label>22</label>
      <mixed-citation publication-type="book"><name><surname>Kikinis</surname><given-names>R</given-names></name>, <name><surname>Pieper</surname><given-names>SD</given-names></name>, <name><surname>Vosburgh</surname><given-names>KG</given-names></name>. <part-title>3D Slicer: a platform for subject-specific image analysis, visualization, and clinical support</part-title>. <source>Intraoperative imaging and image-guided therapy</source>. <publisher-name>Springer</publisher-name>; <year>2014</year>. pp. <fpage>277</fpage>–<lpage>289</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/978-1-4614-7657-3_19</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Doshi</surname><given-names>J</given-names></name>, <name><surname>Erus</surname><given-names>G</given-names></name>, <name><surname>Ou</surname><given-names>Y</given-names></name>, <name><surname>Resnick</surname><given-names>SM</given-names></name>, <name><surname>Gur</surname><given-names>RC</given-names></name>, <name><surname>Gur</surname><given-names>RE</given-names></name>, <etal>et al</etal>. <article-title>MUSE: Multi-atlas region Segmentation utilizing Ensembles of registration algorithms and parameters, and locally optimal atlas selection</article-title>. <source>Neuroimage</source>. <year>2016</year>;<volume>127</volume>: <fpage>186</fpage>–<lpage>195</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.11.073</pub-id><?supplied-pmid 26679328?><pub-id pub-id-type="pmid">26679328</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Iglesias</surname><given-names>JE</given-names></name>, <name><surname>Sabuncu</surname><given-names>MR</given-names></name>. <article-title>Multi-atlas segmentation of biomedical images: a survey</article-title>. <source>Med Image Anal</source>. <year>2015</year>;<volume>24</volume>: <fpage>205</fpage>–<lpage>219</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.media.2015.06.012</pub-id><?supplied-pmid 26201875?><pub-id pub-id-type="pmid">26201875</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref025">
      <label>25</label>
      <mixed-citation publication-type="book"><name><surname>Rohlfing</surname><given-names>T</given-names></name>, <name><surname>Brandt</surname><given-names>R</given-names></name>, <name><surname>Menzel</surname><given-names>R</given-names></name>, <name><surname>Russakoff</surname><given-names>DB</given-names></name>, <name><surname>Maurer</surname><given-names>CR</given-names></name>. <part-title>Quo vadis, atlas-based segmentation?</part-title><source>Handbook of biomedical image analysis</source>. <publisher-name>Springer</publisher-name>; <year>2005</year>. pp. <fpage>435</fpage>–<lpage>486</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/0-306-48608-3_11</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Schipaanboord</surname><given-names>B</given-names></name>, <name><surname>Boukerroui</surname><given-names>D</given-names></name>, <name><surname>Peressutti</surname><given-names>D</given-names></name>, <name><surname>van Soest</surname><given-names>J</given-names></name>, <name><surname>Lustberg</surname><given-names>T</given-names></name>, <name><surname>Dekker</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>An evaluation of atlas selection methods for atlas-based automatic segmentation in radiotherapy treatment planning</article-title>. <source>IEEE Trans Med Imaging</source>. <year>2019</year>;<volume>38</volume>: <fpage>2654</fpage>–<lpage>2664</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TMI.2019.2907072</pub-id><?supplied-pmid 30969918?><pub-id pub-id-type="pmid">30969918</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>H</given-names></name>, <name><surname>Yushkevich</surname><given-names>P</given-names></name>. <article-title>Multi-atlas segmentation with joint label fusion and corrective learning—an open source implementation</article-title>. <source>Front Neuroinformatics</source>. <year>2013</year>;<volume>7</volume>: <fpage>27</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fninf.2013.00027</pub-id><?supplied-pmid 24319427?><pub-id pub-id-type="pmid">24319427</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Antonelli</surname><given-names>M</given-names></name>, <name><surname>Cardoso</surname><given-names>MJ</given-names></name>, <name><surname>Johnston</surname><given-names>EW</given-names></name>, <name><surname>Appayya</surname><given-names>MB</given-names></name>, <name><surname>Presles</surname><given-names>B</given-names></name>, <name><surname>Modat</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>GAS: A genetic atlas selection strategy in multi-atlas segmentation framework</article-title>. <source>Med Image Anal</source>. <year>2019</year>;<volume>52</volume>: <fpage>97</fpage>–<lpage>108</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.media.2018.11.007</pub-id><?supplied-pmid 30476698?><pub-id pub-id-type="pmid">30476698</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref029">
      <label>29</label>
      <mixed-citation publication-type="book"><name><surname>Gooding</surname><given-names>MJ</given-names></name>. <part-title>Evaluation of Atlas Selection: How Close Are We to Optimal Selection?</part-title><source>Auto-Segmentation for Radiation Oncology</source>. <publisher-name>CRC Press</publisher-name>; <year>2021</year>. pp. <fpage>19</fpage>–<lpage>38</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0278035.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Rolfe</surname><given-names>S</given-names></name>, <name><surname>Davis</surname><given-names>C</given-names></name>, <name><surname>Maga</surname><given-names>AM</given-names></name>. <article-title>Comparing semi-landmarking approaches for analyzing three-dimensional cranial morphology</article-title>. <source>Am J Phys Anthropol</source>. <year>2021</year>;<volume>175</volume>: <fpage>227</fpage>–<lpage>237</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/ajpa.24214</pub-id><?supplied-pmid 33483951?><pub-id pub-id-type="pmid">33483951</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref031">
      <label>31</label>
      <mixed-citation publication-type="other">Rusinkiewicz S, Levoy M. Efficient variants of the ICP algorithm. Proceedings third international conference on 3-D digital imaging and modeling. IEEE; 2001. pp. 145–152.</mixed-citation>
    </ref>
    <ref id="pone.0278035.ref032">
      <label>32</label>
      <mixed-citation publication-type="other">Rusu RB, Blodow N, Beetz M. Fast point feature histograms (FPFH) for 3D registration. 2009 IEEE international conference on robotics and automation. IEEE; 2009. pp. 3212–3217.</mixed-citation>
    </ref>
    <ref id="pone.0278035.ref033">
      <label>33</label>
      <mixed-citation publication-type="other">Zhou Q-Y, Park J, Koltun V. Open3D: A modern library for 3D data processing. ArXiv Prepr ArXiv180109847. 2018.</mixed-citation>
    </ref>
    <ref id="pone.0278035.ref034">
      <label>34</label>
      <mixed-citation publication-type="book"><name><surname>Schroeder</surname><given-names>W</given-names></name>, <name><surname>Martin</surname><given-names>KM</given-names></name>, <name><surname>Lorensen</surname><given-names>WE</given-names></name>. <source>The visualization toolkit: an object-oriented approach to 3D graphics</source>. <edition designator="4">4th ed</edition>. <publisher-name>Prentice-Hall, Inc.</publisher-name>; <year>2006</year>.</mixed-citation>
    </ref>
    <ref id="pone.0278035.ref035">
      <label>35</label>
      <mixed-citation publication-type="book"><name><surname>Zelditch</surname><given-names>ML</given-names></name>, <name><surname>Swiderski</surname><given-names>DL</given-names></name>, <name><surname>Sheets</surname><given-names>HD</given-names></name>. <source>Geometric morphometrics for biologists: a primer</source>. <publisher-name>academic press</publisher-name>; <year>2012</year>.</mixed-citation>
    </ref>
    <ref id="pone.0278035.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Virtanen</surname><given-names>P</given-names></name>, <name><surname>Gommers</surname><given-names>R</given-names></name>, <name><surname>Oliphant</surname><given-names>TE</given-names></name>, <name><surname>Haberland</surname><given-names>M</given-names></name>, <name><surname>Reddy</surname><given-names>T</given-names></name>, <name><surname>Cournapeau</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>. <source>Nat Methods</source>. <year>2020</year>;<volume>17</volume>: <fpage>261</fpage>–<lpage>272</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id><?supplied-pmid 32015543?><pub-id pub-id-type="pmid">32015543</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0278035.ref037">
      <label>37</label>
      <mixed-citation publication-type="other">R Core Team. R: A language and environment for statistical computing. Vienna, Austria: R Foundation for Statistical Computing; 2021. <ext-link xlink:href="https://www.R-project.org/" ext-link-type="uri">https://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0278035.ref038">
      <label>38</label>
      <mixed-citation publication-type="other">Adams DC, Collyer M, Kaliontzopoulou A, Baken EK. Geomorph: Software for geometric morphometric analyses. R package version 4.0. 2021. <ext-link xlink:href="https://cran.r-project.org/package=geomorph" ext-link-type="uri">https://cran.r-project.org/package=geomorph</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
