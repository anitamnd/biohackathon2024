<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6522071</article-id>
    <article-id pub-id-type="pmid">31059559</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01178</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1006976</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Immune Cells</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Blood Cells</subject>
                <subj-group>
                  <subject>White Blood Cells</subject>
                  <subj-group>
                    <subject>T Cells</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Immune Cells</subject>
                <subj-group>
                  <subject>White Blood Cells</subject>
                  <subj-group>
                    <subject>T Cells</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>White Blood Cells</subject>
              <subj-group>
                <subject>T Cells</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>White Blood Cells</subject>
              <subj-group>
                <subject>T Cells</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Bioassays and Physiological Analysis</subject>
          <subj-group>
            <subject>Microarrays</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability Theory</subject>
            <subj-group>
              <subject>Probability Distribution</subject>
              <subj-group>
                <subject>Normal Distribution</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Management Engineering</subject>
          <subj-group>
            <subject>Management Planning and Control</subject>
            <subj-group>
              <subject>Pert</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Lymphatic System</subject>
            <subj-group>
              <subject>Lymph Nodes</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Lymphatic System</subject>
            <subj-group>
              <subject>Lymph Nodes</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Fast and robust deconvolution of tumor infiltrating lymphocyte from expression profiles using least trimmed squares</article-title>
      <alt-title alt-title-type="running-head">FARDEEP is a novel and robust immune deconvolution tool</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8509-3696</contrib-id>
        <name>
          <surname>Hao</surname>
          <given-names>Yuning</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8686-3530</contrib-id>
        <name>
          <surname>Yan</surname>
          <given-names>Ming</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8656-0532</contrib-id>
        <name>
          <surname>Heath</surname>
          <given-names>Blake R.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9868-9824</contrib-id>
        <name>
          <surname>Lei</surname>
          <given-names>Yu L.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1049-2219</contrib-id>
        <name>
          <surname>Xie</surname>
          <given-names>Yuying</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Statistics and Probability, Michigan State University, East Lansing, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Computational Mathematics, Science and Engineering, Michigan State University, East Lansing, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Mathematics, Michigan State University, East Lansing, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Department of Periodontics and Oral Medicine, University of Michigan School of Dentistry Ann Arbor, United States of America</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>University of Michigan Rogel Cancer Center, Ann Arbor, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Ottawa University, CANADA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>leiyuleo@umich.edu</email> (YLL); <email>xyy@msu.edu</email> (YX)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <volume>15</volume>
    <issue>5</issue>
    <elocation-id>e1006976</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>7</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>3</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Hao et al</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Hao et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1006976.pdf"/>
    <abstract>
      <p>Gene-expression deconvolution is used to quantify different types of cells in a mixed population. It provides a highly promising solution to rapidly characterize the tumor-infiltrating immune landscape and identify cold cancers. However, a major challenge is that gene-expression data are frequently contaminated by many outliers that decrease the estimation accuracy. Thus, it is imperative to develop a robust deconvolution method that automatically decontaminates data by reliably detecting and removing outliers. We developed a new machine learning tool, <underline>F</underline>ast <underline>A</underline>nd <underline>R</underline>obust <underline>DE</underline>convolution of <underline>E</underline>xpression <underline>P</underline>rofiles (FARDEEP), to enumerate immune cell subsets from whole tumor tissue samples. To reduce noise in the tumor gene expression datasets, FARDEEP utilizes an adaptive least trimmed square to automatically detect and remove outliers before estimating the cell compositions. We show that FARDEEP is less susceptible to outliers and returns a better estimation of coefficients than the existing methods with both numerical simulations and real datasets. FARDEEP provides an estimate related to the absolute quantity of each immune cell subset in addition to relative percentages. Hence, FARDEEP represents a novel robust algorithm to complement the existing toolkit for the characterization of tissue-infiltrating immune cell landscape. The source code for FARDEEP is implemented in R and available for download at <ext-link ext-link-type="uri" xlink:href="https://github.com/YuningHao/FARDEEP.git">https://github.com/YuningHao/FARDEEP.git</ext-link>.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Rapidly emerging evidence suggests that the tumor immune microenvironment not only predisposes cancer patients to diverse treatment outcomes but also represents a promising source of biomarkers for better patient stratification. Different from the immunohistochemistry-based scoring practice, which focuses on a few selected marker proteins, immune deconvolution pipelines inform a previously untapped method to comprehensively reveal the tumor-infiltrating immune landscape. Recognizing the numerous strengths of existing immune deconvolution algorithms, here we show data outliers, which are inevitable in whole tissue sequencing data sets, substantially skew estimation results. Moreover, an estimate related to the absolute amount of each immune subset offers valuable insight into the nature of the host response in addition to percentage information alone. Thus, we engineered a new immune deconvolution pipeline, coined as Fast and Robust Deconvolution of Expression Profiles (FARDEEP), to automatically detect and remove outliers prior feeding data into the deconvolution algorithm and to provide estimates related to the absolute quantity of each immune subset. Utilizing both synthetic and real data sets, we found that FARDEEP returns superior coefficients and offers a robust tool to reveal the immune landscape of human cancers.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R03 DE027399</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1049-2219</contrib-id>
          <name>
            <surname>Xie</surname>
            <given-names>Yuying</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RO1 DE026728</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9868-9824</contrib-id>
          <name>
            <surname>Lei</surname>
            <given-names>Yu L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R00 DE024173</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9868-9824</contrib-id>
          <name>
            <surname>Lei</surname>
            <given-names>Yu L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DMS-1621798</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8686-3530</contrib-id>
          <name>
            <surname>Yan</surname>
            <given-names>Ming</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution>state key laboratory of oral Diseases Open Fund of China</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1049-2219</contrib-id>
          <name>
            <surname>Xie</surname>
            <given-names>Yuying</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award006">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100007709</institution-id>
            <institution>Michigan State University</institution>
          </institution-wrap>
        </funding-source>
        <award-id>STEM Gateway Fellowship</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1049-2219</contrib-id>
          <name>
            <surname>Xie</surname>
            <given-names>Yuying</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award007">
        <funding-source>
          <institution>University of Michigan Rogel Cancer Center Research Grant</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9868-9824</contrib-id>
          <name>
            <surname>Lei</surname>
            <given-names>Yu L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award008">
        <funding-source>
          <institution>POM Clinical Research Supplement</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9868-9824</contrib-id>
          <name>
            <surname>Lei</surname>
            <given-names>Yu L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award009">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R03 DE027399</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9868-9824</contrib-id>
          <name>
            <surname>Lei</surname>
            <given-names>Yu L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work is supported by National Institutes of Health grants R03 DE027399 (YLL and YX), R01 DE026728 (YLL), R00 DE024173 (YLL) and F31 DE028740 (BRH), National Science Foundation grant DMS-1621798 (MY), the Michigan State University STEM Gateway Fellowship (YX), and University of Michigan Rogel Cancer Center Research Grant (YLL). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="7"/>
      <table-count count="1"/>
      <page-count count="21"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2019-05-16</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the paper and its Supporting Information files. The source codes for FARDEEP and all the results in the paper is available for download at <ext-link ext-link-type="uri" xlink:href="https://github.com/YuningHao/FARDEEP.git">https://github.com/YuningHao/FARDEEP.git</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the paper and its Supporting Information files. The source codes for FARDEEP and all the results in the paper is available for download at <ext-link ext-link-type="uri" xlink:href="https://github.com/YuningHao/FARDEEP.git">https://github.com/YuningHao/FARDEEP.git</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Immune checkpoint blockade has revolutionized the rational design of neoadjuvant cancer therapies. Compelling evidence suggests that a favorable tumor immune microenvironment underpins better clinical responses to radiotherapy, chemotherapy, and immunotherapy [<xref rid="pcbi.1006976.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1006976.ref003" ref-type="bibr">3</xref>]. Immunohistochemistry (IHC)-based immunoscores, which quantify the number of CD8<sup>+</sup> cytotoxic T lymphocytes and CD45RO<sup>+</sup> memory T cells, show better prognostic potential than conventional pathological methods in colon cancer patients [<xref rid="pcbi.1006976.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1006976.ref005" ref-type="bibr">5</xref>]. Hence, harnessing the composition of intra-tumoral immune cell infiltration is a highly promising approach to stratify tumors [<xref rid="pcbi.1006976.ref006" ref-type="bibr">6</xref>–<xref rid="pcbi.1006976.ref011" ref-type="bibr">11</xref>]. The current IHC immunoscoring approach has two limitations. First, the interpretation of immune cell subsets varies among pathologists and institutions, thus lacking a consistent standard for the scoring practice. Second, only a limited number of biomarkers can be assessed simultaneously, which prevents a comprehensive annotation of the immune contexture in the tumor microenvironment (TME). Hence, robust methods for genome data-informed cell type quantitation are in urgent need.</p>
    <p>Immunogenomics presents an unprecedented opportunity to resolve the intra-tumoral immune landscape. Cell type deconvolution using leukocyte signature gene expression profiling is a highly promising approach to estimate the global immune cell composition from whole tumor gene expression data [<xref rid="pcbi.1006976.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1006976.ref017" ref-type="bibr">17</xref>]. However, a significant technical obstacle is that the efficacy and accuracy of gene expression deconvolution are limited by the large number of outliers, which are frequently observed in tumor gene expression datasets [<xref rid="pcbi.1006976.ref018" ref-type="bibr">18</xref>]. The first step towards enhancing the overall gene deconvolution algorithms is to improve methods for outliers identification and processing. Those outliers include genes with abnormal expression value which may be caused by measurement error, environmental effect, expression from non-immune cells, or natural fluctuations in certain type of immune cells. Notably, the current immune deconvolution gene signature matrix relies on the profiling of differentially expressed genes among different immune subsets. Frequent contamination of transcripts reading from cancer cells may significantly bias the algorithms. In this study, we report a novel FAst and Robust DEconvolution of Expression Profiles (FARDEEP) method that significantly improves the estimation of coefficients.</p>
    <p>Let <italic>y</italic><sub><italic>i</italic></sub> be the observed expression value for the <italic>i</italic>th gene; <italic><bold>x</bold></italic><sub><italic><bold>i</bold></italic></sub>, a <italic>p</italic>-dimensional vector, be the expected expression of the <italic>i</italic>th gene for the <italic>p</italic> different cell types; and <italic><bold>X</bold></italic> = [<italic><bold>x</bold></italic><sub>1</sub>, …, <italic><bold>x</bold></italic><sub><italic>n</italic></sub>]′ be the signature matrix. The gene-expression deconvolution problem can be formulated as follows,
<disp-formula id="pcbi.1006976.e001"><alternatives><graphic xlink:href="pcbi.1006976.e001.jpg" id="pcbi.1006976.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(0.1)</label></disp-formula>
where <inline-formula id="pcbi.1006976.e002"><alternatives><graphic xlink:href="pcbi.1006976.e002.jpg" id="pcbi.1006976.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is an unknown parameter corresponding to the compositions of <italic>p</italic> cell types, and <italic>ε</italic><sub><italic>i</italic></sub> is a noise term with a mean of 0. Several methods were proposed to solve this deconvolution problem. To enforce the non-negativity of <italic><bold>β</bold></italic> in (<xref ref-type="disp-formula" rid="pcbi.1006976.e001">0.1</xref>), several algorithms, such as the Non-Negative Least Square (NNLS), Non-negative Maximum Likelihood (NNML) frameworks and the perturbation model (PERT) were developed. They all rely on the signature matrix (<italic>X</italic>) derived from Microarray experiments [<xref rid="pcbi.1006976.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1006976.ref019" ref-type="bibr">19</xref>–<xref rid="pcbi.1006976.ref024" ref-type="bibr">24</xref>]. To extend this work to RNA-seq data, Finotello <italic>et al</italic>. [<xref rid="pcbi.1006976.ref014" ref-type="bibr">14</xref>] proposed a constraint linear model with a signature matrix derived from RNA-seq data. Additionally, the gene expression of each cell may vary depending on its microenvironment and other factors, which will lead to a biased estimation. To address this issue, Microarray Microdissection with Analysis of Differences (MMAD) incorporates the concept of the effective RNA fraction and estimates coefficients using a maximum likelihood approach [<xref rid="pcbi.1006976.ref025" ref-type="bibr">25</xref>]. To further adapt deconvolution to high-dimensional settings, Altboum <italic>et al</italic>. [<xref rid="pcbi.1006976.ref026" ref-type="bibr">26</xref>] proposed a penalized regression framework, Digital Cell Quantifier (DCQ), to encourage sparsity for the estimated <italic><bold>β</bold></italic> using the elastic net [<xref rid="pcbi.1006976.ref027" ref-type="bibr">27</xref>]. Cell-type identification by estimating relative subsets of RNA transcripts (CIBERSORT) uses <italic>ν</italic>-support vector regression (<italic>ν</italic>-SVR) to enhance the robustness of gene expression deconvolution. CIBERSORT performs a regression by finding a hyperplane that fits as many data points as possible within a tube whose vertical length is a constant <italic>ε</italic> [<xref rid="pcbi.1006976.ref012" ref-type="bibr">12</xref>]. The <italic>ε</italic>-tube provides a region in which estimation errors are ignored. This model does not include an intercept to capture contributions of other contents. Additionally, to increase the computational efficiency, CIBERSORT applies Z-normalization to the data before fitting the regression, which may introduce estimation bias. Based on the CIBERSORT framework, several extensions have been proposed to overcome limitations such as platform inconsistency between signature and mixture matrices and low estimation accuracy for <italic>γδ</italic> T cell [<xref rid="pcbi.1006976.ref015" ref-type="bibr">15</xref>–<xref rid="pcbi.1006976.ref017" ref-type="bibr">17</xref>]. However, the quantitative information of cell proportions of these two approaches is built on CIBERSORT whose performance may be challenged by frequent outliers in whole tumor tissue transcriptomes. To reduce the dependence on the signature matrix, xCell utilizes the concept of single-sample gene set enrichment analysis (ssGSEA) to calculate an immune cell score which could predict the enrichment of immune cells [<xref rid="pcbi.1006976.ref013" ref-type="bibr">13</xref>]. Despite its robustness, xCell relies much on the ranking of gene expression value which leads to suboptimal solution for the estimation accuracy. Overall, a robust method that determines both the distribution and absolute volume of tumor-infiltrating lymphocytes (TILs) will further improve the current gene deconvolution pipeline.</p>
    <p>To handle the heavily contaminated gene expression data and provide absolute cell abundance estimation, we developed a robust method based on the Least Trimmed Square (LTS) framework [<xref rid="pcbi.1006976.ref028" ref-type="bibr">28</xref>, <xref rid="pcbi.1006976.ref029" ref-type="bibr">29</xref>]. LTS finds <italic>h</italic> observations with smallest residuals, and the estimator <inline-formula id="pcbi.1006976.e003"><alternatives><graphic xlink:href="pcbi.1006976.e003.jpg" id="pcbi.1006976.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the least squares fit over these <italic>h</italic> observations. LTS is an NP-hard problem, and Rousseeuw and Driessen [<xref rid="pcbi.1006976.ref030" ref-type="bibr">30</xref>] proposed a stochastic FAST-LTS algorithm. Nevertheless, it may give a suboptimal fitting result and get much slower when the sample size and dimension of variables become larger and higher since its accuracy relies on the initial random <italic>h</italic>-subsets and the number of initial subsets. When <italic>n</italic> is the sample size and <italic>p</italic> is the number of coefficients, <italic>h</italic> is suggested to be the smallest integer that is not less than (<italic>n</italic> + <italic>p</italic> + 1)/2 to remove as many outliers as possible while keeping an unbias result. Using the information of only half of the data reduces the power of the estimator because the amount of outliers in the real case cannot be presumed and can be small. Xu <italic>et al</italic>. [<xref rid="pcbi.1006976.ref031" ref-type="bibr">31</xref>] proposed an adaptive least trimmed square which is not limited to the randomness of initial subset but only applied the binary dataset. In this study, we extend the adaptive least trimmed square to introduce a model-free method, which could find the number of outliers automatically based on LTS. FARDEEP provides a flexible framework which is suitable for both Microarray and RNA-seq data using LM22 and Immunostate signature matrices respectively. As evidence of high fidelity and robustness, FARDEEP exhibits superior performance in simulated and real-world datasets.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Model formulation</title>
      <p>The usual linear deconvolution model can be expressed as below,
<disp-formula id="pcbi.1006976.e004"><alternatives><graphic xlink:href="pcbi.1006976.e004.jpg" id="pcbi.1006976.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ε</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1006976.e005"><alternatives><graphic xlink:href="pcbi.1006976.e005.jpg" id="pcbi.1006976.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the observed expression data for <italic>n</italic> immune subset signature genes, <inline-formula id="pcbi.1006976.e006"><alternatives><graphic xlink:href="pcbi.1006976.e006.jpg" id="pcbi.1006976.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> denotes a mean gene expression signature matrix for <italic>p</italic> different cell types, <inline-formula id="pcbi.1006976.e007"><alternatives><graphic xlink:href="pcbi.1006976.e007.jpg" id="pcbi.1006976.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> contains each unknown cell type abundance, and <inline-formula id="pcbi.1006976.e008"><alternatives><graphic xlink:href="pcbi.1006976.e008.jpg" id="pcbi.1006976.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is a vector of random errors with zero mean and variance of <italic>σ</italic><sup>2</sup><italic><bold>I</bold></italic>. To incorporate outliers, we propose the following model
<disp-formula id="pcbi.1006976.e009"><alternatives><graphic xlink:href="pcbi.1006976.e009.jpg" id="pcbi.1006976.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">τ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(0.2)</label></disp-formula>
where parameter <italic><bold>τ</bold></italic> = (<italic>τ</italic><sub>1</sub>, …, <italic>τ</italic><sub><italic>n</italic></sub>)′ is a sparse vector in <inline-formula id="pcbi.1006976.e010"><alternatives><graphic xlink:href="pcbi.1006976.e010.jpg" id="pcbi.1006976.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:math></alternatives></inline-formula> with <italic>τ</italic><sub><italic>i</italic></sub> ≠ 0 indicating the <italic>i</italic>th gene is an outlier.</p>
      <p>Under the formulation of (<xref ref-type="disp-formula" rid="pcbi.1006976.e009">0.2</xref>), let <inline-formula id="pcbi.1006976.e011"><alternatives><graphic xlink:href="pcbi.1006976.e011.jpg" id="pcbi.1006976.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mtext>ols</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> be the Ordinary Least Square (OLS) estimate and <italic><bold>H</bold></italic> = <italic><bold>X</bold></italic>(<italic><bold>X</bold></italic><sup>⊤</sup><italic><bold>X</bold></italic>)<sup>−1</sup><italic><bold>X</bold></italic><sup>⊤</sup> be the projection matrix. The residuals <italic><bold>r</bold></italic> = (<italic>r</italic><sub>1</sub>, …, <italic>r</italic><sub><italic>n</italic></sub>) using OLS could be formulated as
<disp-formula id="pcbi.1006976.e012"><alternatives><graphic xlink:href="pcbi.1006976.e012.jpg" id="pcbi.1006976.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mtext>ols</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">τ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(0.3)</label></disp-formula>
with mean of (<italic><bold>I</bold></italic> − <italic><bold>H</bold></italic>)<italic><bold>τ</bold></italic> and variance of <italic>σ</italic><sup>2</sup>(<italic><bold>I</bold></italic> − <italic><bold>H</bold></italic>).</p>
    </sec>
    <sec id="sec004">
      <title>Adaptive least trimmed square</title>
      <p>From (<xref ref-type="disp-formula" rid="pcbi.1006976.e012">0.3</xref>), the residuals, <italic>r</italic><sub><italic>i</italic></sub> with the corresponding <italic>τ</italic><sub><italic>i</italic></sub> ≠ 0, would deviate from zero, which suggests that the set of outliers can be identified through thresholding as follows
<disp-formula id="pcbi.1006976.e013"><alternatives><graphic xlink:href="pcbi.1006976.e013.jpg" id="pcbi.1006976.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mtext>med</mml:mtext></mml:msub><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(0.4)</label></disp-formula>
where <italic>E</italic> is the set of detected outliers, <italic>k</italic> is a tuning parameter controlling the sensitivity of the model, and <italic>r</italic><sub>med</sub> is the median of <inline-formula id="pcbi.1006976.e014"><alternatives><graphic xlink:href="pcbi.1006976.e014.jpg" id="pcbi.1006976.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mo>|</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. We denote the number of elements in set <italic>E</italic> as |<italic>E</italic>| and let <italic>N</italic> be the number of true outliers in the data. First, we can use least squares and formula (<xref ref-type="disp-formula" rid="pcbi.1006976.e013">0.4</xref>) to obtain a rough estimate of <italic>E</italic> denoted as <inline-formula id="pcbi.1006976.e015"><alternatives><graphic xlink:href="pcbi.1006976.e015.jpg" id="pcbi.1006976.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Let the cardinality of <inline-formula id="pcbi.1006976.e016"><alternatives><graphic xlink:href="pcbi.1006976.e016.jpg" id="pcbi.1006976.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> be <inline-formula id="pcbi.1006976.e017"><alternatives><graphic xlink:href="pcbi.1006976.e017.jpg" id="pcbi.1006976.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Since the model at this moment is inaccurate with contamination of outliers, <inline-formula id="pcbi.1006976.e018"><alternatives><graphic xlink:href="pcbi.1006976.e018.jpg" id="pcbi.1006976.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is an overestimation of <italic>N</italic> which can be used to get an underestimate via <inline-formula id="pcbi.1006976.e019"><alternatives><graphic xlink:href="pcbi.1006976.e019.jpg" id="pcbi.1006976.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mrow><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> with <italic>α</italic><sub>1</sub> ∈ (0, 1). With <inline-formula id="pcbi.1006976.e020"><alternatives><graphic xlink:href="pcbi.1006976.e020.jpg" id="pcbi.1006976.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder></mml:math></alternatives></inline-formula>, we can then update the least square fitting after removing the <inline-formula id="pcbi.1006976.e021"><alternatives><graphic xlink:href="pcbi.1006976.e021.jpg" id="pcbi.1006976.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder></mml:math></alternatives></inline-formula> samples with the largest absolute value of residuals and obtain an improved estimate of <italic>E</italic> and the corresponding <inline-formula id="pcbi.1006976.e022"><alternatives><graphic xlink:href="pcbi.1006976.e022.jpg" id="pcbi.1006976.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. We can improve the model by repeating the procedure, but we need to increase the underestimate of outliers, <inline-formula id="pcbi.1006976.e023"><alternatives><graphic xlink:href="pcbi.1006976.e023.jpg" id="pcbi.1006976.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder></mml:math></alternatives></inline-formula>, by a factor of <italic>α</italic><sub>2</sub> with <italic>α</italic><sub>2</sub> &gt; 1 for each iteration to force the convergence between <inline-formula id="pcbi.1006976.e024"><alternatives><graphic xlink:href="pcbi.1006976.e024.jpg" id="pcbi.1006976.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006976.e025"><alternatives><graphic xlink:href="pcbi.1006976.e025.jpg" id="pcbi.1006976.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder></mml:math></alternatives></inline-formula>. In sum, we initialize our algorithm by setting
<disp-formula id="pcbi.1006976.e026"><alternatives><graphic xlink:href="pcbi.1006976.e026.jpg" id="pcbi.1006976.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
which is the OLS solution. For the <italic>j</italic>th iteration, where <italic>j</italic> ≥ 1, we update <inline-formula id="pcbi.1006976.e027"><alternatives><graphic xlink:href="pcbi.1006976.e027.jpg" id="pcbi.1006976.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> by
<disp-formula id="pcbi.1006976.e028"><alternatives><graphic xlink:href="pcbi.1006976.e028.jpg" id="pcbi.1006976.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mtext>med</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtext>min</mml:mtext><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi><mml:mo>·</mml:mo></mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mtext>med</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>j</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(0.5)</label></disp-formula>
where the min(⋅, ⋅) operator guarantees that <inline-formula id="pcbi.1006976.e029"><alternatives><graphic xlink:href="pcbi.1006976.e029.jpg" id="pcbi.1006976.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, an overestimation of <italic>N</italic>, is non-increasing. Similarly, we update <inline-formula id="pcbi.1006976.e030"><alternatives><graphic xlink:href="pcbi.1006976.e030.jpg" id="pcbi.1006976.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> through
<disp-formula id="pcbi.1006976.e031"><alternatives><graphic xlink:href="pcbi.1006976.e031.jpg" id="pcbi.1006976.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>⌈</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>⌉</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtext>min</mml:mtext><mml:mo>{</mml:mo><mml:mrow><mml:mo>⌈</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>j</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(0.6)</label></disp-formula>
where ⌈<italic>x</italic>⌉ means the ceiling of <inline-formula id="pcbi.1006976.e032"><alternatives><graphic xlink:href="pcbi.1006976.e032.jpg" id="pcbi.1006976.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <italic>α</italic><sub>1</sub> ∈ (0, 1) is used to obtain a lower bound for <italic>N</italic> in the first step, <italic>α</italic><sub>2</sub> &gt; 1 guarantees the monotonicity of <inline-formula id="pcbi.1006976.e033"><alternatives><graphic xlink:href="pcbi.1006976.e033.jpg" id="pcbi.1006976.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, and the min(⋅, ⋅) operator guarantees <inline-formula id="pcbi.1006976.e034"><alternatives><graphic xlink:href="pcbi.1006976.e034.jpg" id="pcbi.1006976.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> is smaller than <inline-formula id="pcbi.1006976.e035"><alternatives><graphic xlink:href="pcbi.1006976.e035.jpg" id="pcbi.1006976.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. Then we update <inline-formula id="pcbi.1006976.e036"><alternatives><graphic xlink:href="pcbi.1006976.e036.jpg" id="pcbi.1006976.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <italic><bold>r</bold></italic> after removing <inline-formula id="pcbi.1006976.e037"><alternatives><graphic xlink:href="pcbi.1006976.e037.jpg" id="pcbi.1006976.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> outliers by
<disp-formula id="pcbi.1006976.e038"><alternatives><graphic xlink:href="pcbi.1006976.e038.jpg" id="pcbi.1006976.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mi>⊤</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mi>⊤</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
We repeat this procedure until <inline-formula id="pcbi.1006976.e039"><alternatives><graphic xlink:href="pcbi.1006976.e039.jpg" id="pcbi.1006976.e039g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M39"><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006976.e040"><alternatives><graphic xlink:href="pcbi.1006976.e040.jpg" id="pcbi.1006976.e040g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M40"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> converge.</p>
      <p>Hence, we hereby report a novel approach, coined as adaptive Least Trimmed Square (aLTS), to automatically detect and remove contaminating outliers. Our aLTS is an extension of the iterative LTS algorithm proposed by Xu <italic>et al</italic>. [<xref rid="pcbi.1006976.ref031" ref-type="bibr">31</xref>] which is designed for binary output such as the comparison between two images or videos.</p>
    </sec>
    <sec id="sec005">
      <title>FARDEEP</title>
      <p>Because the abundance of cell types are always non-negative, we replaced the OLS regression in the aLTS procedure with non-negative least square regression (NNLS). By applying the modified aLTS to the deconvolution model (<xref ref-type="disp-formula" rid="pcbi.1006976.e009">0.2</xref>) and solving the following problem,
<disp-formula id="pcbi.1006976.e041"><alternatives><graphic xlink:href="pcbi.1006976.e041.jpg" id="pcbi.1006976.e041g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mtext>argmin</mml:mtext><mml:mi mathvariant="bold-italic">β</mml:mi></mml:munder><mml:mspace width="4pt"/><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mspace width="4pt"/><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1.em"/><mml:mtext>subject</mml:mtext><mml:mspace width="4pt"/><mml:mtext>to</mml:mtext><mml:mspace width="4pt"/><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
using Lawson-Hanson algorithm [<xref rid="pcbi.1006976.ref019" ref-type="bibr">19</xref>], we developed a robust tool, FARDEEP, for cellular deconvolution summarized in Algorithm 1.</p>
      <p>One unique advantage of FARDEEP is that it is fast and guarantees to converge within finite steps, which is summarized in the following theorem.</p>
      <p><bold>Algorithm 1</bold> FAst and Robust DEconvolution of Expression Profiles</p>
      <p specific-use="line"><bold>Input</bold>: <italic>k</italic> &gt; 0, 0 &lt; <italic>α</italic><sub>1</sub> &lt; 1, <italic>α</italic><sub>2</sub> &gt; 1, <italic><bold>y</bold></italic>, <italic><bold>X</bold></italic></p>
      <p specific-use="line"><bold>Initialization</bold>: solving the following NNLS problem
<disp-formula id="pcbi.1006976.e042"><alternatives><graphic xlink:href="pcbi.1006976.e042.jpg" id="pcbi.1006976.e042g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mtext>argmin</mml:mtext><mml:mi mathvariant="bold-italic">β</mml:mi></mml:munder><mml:mspace width="4pt"/><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1.em"/><mml:mtext>subject</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>to</mml:mtext><mml:mspace width="4pt"/><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
      <p specific-use="line"> 1: compute <inline-formula id="pcbi.1006976.e043"><alternatives><graphic xlink:href="pcbi.1006976.e043.jpg" id="pcbi.1006976.e043g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M43"><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006976.e044"><alternatives><graphic xlink:href="pcbi.1006976.e044.jpg" id="pcbi.1006976.e044g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M44"><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> using (<xref ref-type="disp-formula" rid="pcbi.1006976.e028">0.5</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1006976.e031">0.6</xref>);</p>
      <p specific-use="line"> 2: solving the NNLS problem after removing <inline-formula id="pcbi.1006976.e045"><alternatives><graphic xlink:href="pcbi.1006976.e045.jpg" id="pcbi.1006976.e045g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M45"><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> genes with largest residuals, and update <inline-formula id="pcbi.1006976.e046"><alternatives><graphic xlink:href="pcbi.1006976.e046.jpg" id="pcbi.1006976.e046g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M46"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, <italic><bold>r</bold></italic><sup>(1)</sup>.</p>
      <p specific-use="line"> 3: <bold>repeat</bold></p>
      <p specific-use="line"> 4:  compute <inline-formula id="pcbi.1006976.e047"><alternatives><graphic xlink:href="pcbi.1006976.e047.jpg" id="pcbi.1006976.e047g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M47"><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006976.e048"><alternatives><graphic xlink:href="pcbi.1006976.e048.jpg" id="pcbi.1006976.e048g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M48"><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> using (<xref ref-type="disp-formula" rid="pcbi.1006976.e028">0.5</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1006976.e031">0.6</xref>) for <italic>j</italic> ≥ 2;</p>
      <p specific-use="line"> 5:  solving the NNLS problem after removing <inline-formula id="pcbi.1006976.e049"><alternatives><graphic xlink:href="pcbi.1006976.e049.jpg" id="pcbi.1006976.e049g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M49"><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> genes with largest residuals, and update <inline-formula id="pcbi.1006976.e050"><alternatives><graphic xlink:href="pcbi.1006976.e050.jpg" id="pcbi.1006976.e050g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M50"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, <italic><bold>r</bold></italic><sup>(<italic>j</italic>)</sup>;</p>
      <p specific-use="line"> 6: <bold>until</bold>
<inline-formula id="pcbi.1006976.e051"><alternatives><graphic xlink:href="pcbi.1006976.e051.jpg" id="pcbi.1006976.e051g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M51"><mml:mrow><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder></mml:mrow></mml:math></alternatives></inline-formula>.</p>
      <p specific-use="line"><bold>Output</bold>: Coefficients <inline-formula id="pcbi.1006976.e052"><alternatives><graphic xlink:href="pcbi.1006976.e052.jpg" id="pcbi.1006976.e052g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M52"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, Number of outliers <inline-formula id="pcbi.1006976.e053"><alternatives><graphic xlink:href="pcbi.1006976.e053.jpg" id="pcbi.1006976.e053g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M53"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, Index of outliers</p>
      <p><bold>Theorem 1</bold><italic>Algorithm 1 (FARDEEP) stops in no more than j* steps, where</italic><disp-formula id="pcbi.1006976.e054"><alternatives><graphic xlink:href="pcbi.1006976.e054.jpg" id="pcbi.1006976.e054g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M54"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mo>⌊</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mspace width="2pt"/><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="2pt"/><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>⌋</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula><italic>Here</italic> ⌊⋅⌋ <italic>is the largest integer that is less than or equal to x</italic>.</p>
      <p><italic>Proof</italic>. It follows from the fact that the sequence <inline-formula id="pcbi.1006976.e055"><alternatives><graphic xlink:href="pcbi.1006976.e055.jpg" id="pcbi.1006976.e055g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M55"><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is non-increasing, and <inline-formula id="pcbi.1006976.e056"><alternatives><graphic xlink:href="pcbi.1006976.e056.jpg" id="pcbi.1006976.e056g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M56"><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is a geometrically increasing sequence that is bounded by the smallest component of <inline-formula id="pcbi.1006976.e057"><alternatives><graphic xlink:href="pcbi.1006976.e057.jpg" id="pcbi.1006976.e057g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M57"><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Specifically, assume that <italic>j</italic>* steps have been taken in FARDEEP, then <italic>j</italic> has approached <italic>j</italic>* − 1, and <inline-formula id="pcbi.1006976.e058"><alternatives><graphic xlink:href="pcbi.1006976.e058.jpg" id="pcbi.1006976.e058g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M58"><mml:mrow><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> for 0 ≤ <italic>j</italic> ≤ <italic>j</italic>* − 1, so
<disp-formula id="pcbi.1006976.e059"><alternatives><graphic xlink:href="pcbi.1006976.e059.jpg" id="pcbi.1006976.e059g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M59"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:munder accentunder="true"><mml:mi>N</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:munder><mml:mn>0</mml:mn></mml:msup><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
which leads to the result.</p>
      <p>The <inline-formula id="pcbi.1006976.e060"><alternatives><graphic xlink:href="pcbi.1006976.e060.jpg" id="pcbi.1006976.e060g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M60"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> from FARDEEP, denoted as <italic>TIL subset score</italic>, is the direct estimate of the linear model without any normalization and hence reflects the absolute abundance of TILs. In addition, we can derive the relative TILs abundance from the TIL subset scores through
<disp-formula id="pcbi.1006976.e061"><alternatives><graphic xlink:href="pcbi.1006976.e061.jpg" id="pcbi.1006976.e061g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M61"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mover accent="true"><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mover accent="true"><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(0.7)</label></disp-formula>
where <inline-formula id="pcbi.1006976.e062"><alternatives><graphic xlink:href="pcbi.1006976.e062.jpg" id="pcbi.1006976.e062g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M62"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the <italic>j</italic>th TIL subset score. In practice, the TIL subset score provides important information of patient’s tumor-infiltrating immune landscape, and we have included a discussion in <xref ref-type="supplementary-material" rid="pcbi.1006976.s009">S2 Text</xref>.</p>
    </sec>
    <sec id="sec006">
      <title>Parameter tuning</title>
      <p>There are three tuning parameters <italic>k</italic>, <italic>α</italic><sub>1</sub>, and <italic>α</italic><sub>2</sub> in FARDEEP. Since <italic>α</italic><sub>1</sub> is only used in the first iteration, a relatively small <italic>α</italic><sub>1</sub> is preferred to ensure that FARDEEP does not remove too many outliers at the first step. In practice, FARDEEP is not sensitive to different values of <italic>α</italic><sub>1</sub>, and <italic>α</italic><sub>2</sub>, so we set them to 0.1 and 1.5 respectively by default. However, <italic>k</italic> controls the number of outliers in each iteration and is critical for the performance of FARDEEP. Thus, we tune <italic>k</italic> on a case-by-case basis for each sample to preserve meaningful fluctuations of gene expression levels. Effects for different tuning parameters are shown in <xref ref-type="supplementary-material" rid="pcbi.1006976.s001">S1 Table</xref>. Since the test group may contain outliers that influence the accuracy of the tuning result, cross-validation is not advised. Instead, we applied the Bayesian Information Criterion (BIC) and assume that the errors follow a log-normal distribution instead of a normal distribution among gene expression datasets as suggest by Beal [<xref rid="pcbi.1006976.ref032" ref-type="bibr">32</xref>]. We define the modified BIC referring to the setting of She and Owen [<xref rid="pcbi.1006976.ref033" ref-type="bibr">33</xref>]:
<disp-formula id="pcbi.1006976.e063"><alternatives><graphic xlink:href="pcbi.1006976.e063.jpg" id="pcbi.1006976.e063g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M63"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mtext>BIC</mml:mtext><mml:mo>*</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mspace width="4pt"/><mml:mtext>log</mml:mtext><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mrow><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>∉</mml:mo><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>}</mml:mo></mml:mrow></mml:msub><mml:mspace width="4pt"/><mml:msub><mml:mtext>log</mml:mtext><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(0.8)</label></disp-formula>
where <inline-formula id="pcbi.1006976.e064"><alternatives><graphic xlink:href="pcbi.1006976.e064.jpg" id="pcbi.1006976.e064g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M64"><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> being the set of detected outliers, <italic>b</italic> is number of parameters and equals <inline-formula id="pcbi.1006976.e065"><alternatives><graphic xlink:href="pcbi.1006976.e065.jpg" id="pcbi.1006976.e065g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M65"><mml:mrow><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> with <inline-formula id="pcbi.1006976.e066"><alternatives><graphic xlink:href="pcbi.1006976.e066.jpg" id="pcbi.1006976.e066g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M66"><mml:mrow><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> being the number of outliers, and <italic>m</italic> equals <inline-formula id="pcbi.1006976.e067"><alternatives><graphic xlink:href="pcbi.1006976.e067.jpg" id="pcbi.1006976.e067g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M67"><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. Then, we choose the value of <italic>k</italic> associated with the smallest BIC*.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec007">
    <title>Results</title>
    <p>To test the performance of FARDEEP, we compared our approach with the existing methods using numerical simulations and real datasets. Here, we list the outlier genes detected by FARDEEP for real datasets in <xref ref-type="supplementary-material" rid="pcbi.1006976.s004">S4 Table</xref>. We use LM22 signature matrix containing 22 immune cell types hematopoietic cells for Microarray data and use quanTIseq signature matrix containing 10 immune cell types for RNA-Seq data. To compare the performance of different methods, we report the sum of squared error (SSE), the coefficient of determination denoted as R-squared (<italic>R</italic><sup>2</sup>) and the Pearson correlation (<italic>R</italic>) defined as follows
<disp-formula id="pcbi.1006976.e068"><alternatives><graphic xlink:href="pcbi.1006976.e068.jpg" id="pcbi.1006976.e068g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M68"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mtext>SSE</mml:mtext><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1.em"/><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1.em"/><mml:mover accent="true"><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic><bold>β</bold></italic>* is the ground truth, and <inline-formula id="pcbi.1006976.e069"><alternatives><graphic xlink:href="pcbi.1006976.e069.jpg" id="pcbi.1006976.e069g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M69"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the estimate.</p>
    <sec id="sec008">
      <title><italic>In silico</italic> simulation with varied error types</title>
      <p>To test the robustness of FARDEEP under different error conditions, we simulated three datasets refer to the setting in [<xref rid="pcbi.1006976.ref033" ref-type="bibr">33</xref>, <xref rid="pcbi.1006976.ref034" ref-type="bibr">34</xref>] with normally distributed errors, heavy tailed errors. The observations were generated based on the linear regression model (<xref ref-type="disp-formula" rid="pcbi.1006976.e009">0.2</xref>). The predictor matrix is <italic><bold>X</bold></italic> = (<italic><bold>x</bold></italic><sub>1</sub>, …, <italic><bold>x</bold></italic><sub><italic><bold>n</bold></italic></sub>)′ = <italic><bold>U</bold></italic><bold>Σ</bold><sup>1/2</sup>, where <inline-formula id="pcbi.1006976.e070"><alternatives><graphic xlink:href="pcbi.1006976.e070.jpg" id="pcbi.1006976.e070g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M70"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006976.e071"><alternatives><graphic xlink:href="pcbi.1006976.e071.jpg" id="pcbi.1006976.e071g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M71"><mml:mrow><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> with <italic>ρ</italic> = 0.5. Consider the proportion of outliers <italic>f</italic> ∈ {5%, 10%, 20%, 30%}, sample size <italic>n</italic> = 500, and number of predictors <italic>p</italic> = 20, we added random errors and outliers to the simulated data as follows:
<list list-type="bullet"><list-item><p>Random errors: we generated the random error vector from i) standard normal distribution, ii) <italic>t</italic>-distribution with 3 degrees of freedom.</p></list-item><list-item><p>Vertical outliers: we generated a <italic>n</italic> dimensional zero vector <italic><bold>τ</bold></italic> and randomly selected <italic>nf</italic> elements in <italic><bold>τ</bold></italic> to be the outliers generated from a non-central <italic>t</italic>-distribution with 1 degree of freedom and a non-centrality parameter of 30.</p></list-item><list-item><p>Leverage points: we took 20% of the contaminated data as leverage points, that is, replacing the corresponding predictors by the samples from <inline-formula id="pcbi.1006976.e072"><alternatives><graphic xlink:href="pcbi.1006976.e072.jpg" id="pcbi.1006976.e072g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M72"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mtext>max</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item></list></p>
      <p>The coefficients <italic>β</italic><sub><italic>j</italic></sub> were sampled from <inline-formula id="pcbi.1006976.e073"><alternatives><graphic xlink:href="pcbi.1006976.e073.jpg" id="pcbi.1006976.e073g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M73"><mml:mrow><mml:mi mathvariant="script">U</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>j</italic> = 1, …, <italic>p</italic>. Based on the framework above, the dependent variable could be obtained by
<disp-formula id="pcbi.1006976.e074"><alternatives><graphic xlink:href="pcbi.1006976.e074.jpg" id="pcbi.1006976.e074g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M74"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">τ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ε</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
We simulated each model 50 times. As shown in Figs <xref ref-type="fig" rid="pcbi.1006976.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1006976.g002">2</xref>, FARDEEP outperforms other methods, evidenced by the SSE, <italic>R</italic><sup>2</sup> and <italic>R</italic> values.</p>
      <fig id="pcbi.1006976.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1006976.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>SSE of coefficients for different approaches.</title>
          <p>We simulated different percentage of outliers ({5%, 10%, 20%, 30%}) and compared the SSE for coefficients applying NNLS, DCQ, PERT, CIBERSORT, and FARDEEP. (A) random error with standard normal distribution, (B) random error with <italic>t</italic>-distribution.</p>
        </caption>
        <graphic xlink:href="pcbi.1006976.g001"/>
      </fig>
      <fig id="pcbi.1006976.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1006976.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Compare the estimation accuracy of different deconvolution approaches (the values in parentheses are <italic>R</italic><sup>2</sup> and <italic>R</italic>).</title>
          <p>Based on {5%, 10%, 20%, 30%} percentage of outliers, we computed <italic>R</italic><sup>2</sup> to evaluate how well the estimators fit for a straight line <inline-formula id="pcbi.1006976.e075"><alternatives><graphic id="pcbi.1006976.e075g" xlink:href="pcbi.1006976.e075"/><mml:math id="M75"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. (A) random error with standard normal distribution, (B) random error with <italic>t</italic>-distribution.</p>
        </caption>
        <graphic xlink:href="pcbi.1006976.g002"/>
      </fig>
      <p>To check FARDEEP’s accuracy of outlier detection, we simulated {5%;10%;20%;30%} outliers using the same method as above for a model with both normally distributed and heavy-tailed noise. As shown in <xref rid="pcbi.1006976.t001" ref-type="table">Table 1</xref>, the tuning parameter <italic>k</italic> decreases when the amount of outliers becomes larger, and the true positive rates always stay around 1, indicating that the tunning of k is highly effective.</p>
      <table-wrap id="pcbi.1006976.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1006976.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Tuned <italic>k</italic> for FARDEEP with the adjusted BIC.</title>
          <p>We simulated normally distributed errors and heavy-tailed errors respectively for different proportion of outliers and computed true positive rate and false positive rate to evaluate the tunning result.</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1006976.t001g" xlink:href="pcbi.1006976.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" colspan="2" rowspan="1">Percentage of outliers</th>
                <th align="center" rowspan="1" colspan="1">5%</th>
                <th align="center" rowspan="1" colspan="1">10%</th>
                <th align="center" rowspan="1" colspan="1">20%</th>
                <th align="center" rowspan="1" colspan="1">30%</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="3" colspan="1">Normal</td>
                <td align="center" rowspan="1" colspan="1">True positive rate</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">False positive rate</td>
                <td align="center" rowspan="1" colspan="1">0.005</td>
                <td align="center" rowspan="1" colspan="1">0.009</td>
                <td align="center" rowspan="1" colspan="1">0.02</td>
                <td align="center" rowspan="1" colspan="1">0.05</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Parameter (mean of k)</td>
                <td align="center" rowspan="1" colspan="1">3.63</td>
                <td align="center" rowspan="1" colspan="1">2.43</td>
                <td align="center" rowspan="1" colspan="1">1.46</td>
                <td align="center" rowspan="1" colspan="1">1.19</td>
              </tr>
              <tr>
                <td align="center" rowspan="3" colspan="1">Heavy-tailed</td>
                <td align="center" rowspan="1" colspan="1">True positive rate</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">False positive rate</td>
                <td align="center" rowspan="1" colspan="1">0.05</td>
                <td align="center" rowspan="1" colspan="1">0.05</td>
                <td align="center" rowspan="1" colspan="1">0.08</td>
                <td align="center" rowspan="1" colspan="1">0.11</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Parameter (mean of k)</td>
                <td align="center" rowspan="1" colspan="1">3.03</td>
                <td align="center" rowspan="1" colspan="1">2.06</td>
                <td align="center" rowspan="1" colspan="1">1.35</td>
                <td align="center" rowspan="1" colspan="1">1.14</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>In the supplementary material <xref ref-type="supplementary-material" rid="pcbi.1006976.s010">S3 Text</xref>, we also included another outlier construction scheme with <italic><bold>X</bold></italic> related outliers and a simulation setting with correlated responses. In both scenarios, FARDEEP dominates other methods in terms of SSE, <italic>R</italic><sup>2</sup> and <italic>R</italic> values.</p>
    </sec>
    <sec id="sec009">
      <title><italic>In silico</italic> simulation based on leukocyte gene signature matrix file</title>
      <p>Following the similar procedure as in Newman <italic>et al</italic>., we randomly generated the abundance of different cells from interval [0, 1] [<xref rid="pcbi.1006976.ref012" ref-type="bibr">12</xref>]. Notably, the sum of cell abundance is not necessarily 1. The measurement errors were sampled from <inline-formula id="pcbi.1006976.e076"><alternatives><graphic xlink:href="pcbi.1006976.e076.jpg" id="pcbi.1006976.e076g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M76"><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn><mml:mspace width="2pt"/><mml:msub><mml:mtext>log</mml:mtext><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. To incorporate outliers, we randomly selected <italic>i</italic>/50 of the data and replaced them with data drawn from <inline-formula id="pcbi.1006976.e077"><alternatives><graphic xlink:href="pcbi.1006976.e077.jpg" id="pcbi.1006976.e077g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M77"><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>3</mml:mn><mml:mspace width="2pt"/><mml:msub><mml:mtext>log</mml:mtext><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> where <italic>i</italic> = 1, 2, …, 25 and <italic>s</italic> is the standard deviation of original mixtures.</p>
      <p>We repeated the procedure nine times and estimated the cell type abundance using FARDEEP, CIBERSORT (without converting to percentage), NNLS, PERT, and DCQ. As shown in <xref ref-type="supplementary-material" rid="pcbi.1006976.s002">S2 Table</xref>, we found that the SSE range for FARDEEP is 1.51 × 10<sup>−7</sup> to 1.47 × 10<sup>−4</sup>, <italic>R</italic><sup>2</sup> and <italic>R</italic> keeps being 1 regardless of the number of outliers, while Other methods show significantly larger SSE and smaller <italic>R</italic><sup>2</sup>, <italic>R</italic>.</p>
    </sec>
    <sec id="sec010">
      <title>Synthetic dataset</title>
      <p>We used the cell line dataset GSE11103 generated by Abbas <italic>et al</italic>. [<xref rid="pcbi.1006976.ref035" ref-type="bibr">35</xref>] that contains gene expression profiles of four immune cell lines (Jurkat, IM-9, Raji, and THP-1) and four mixtures (MixA, MixB, MixC, and MixD) with various ratios of cells. Before analysis, we quantile normalized the mixture data for 54675 probesets and downloaded the immune gene signature matrix with 584 probesets from CIBERSORT website. Then, we applied five deconvolution methods, including FARDEEP, CIBERSORT (without converting to percentage), DCQ, NNLS, and PERT, to calculate the sum of squared errors of the estimated abundance of the four immune cell lines. We also compared with CIBERSORT absolute mode, which is a beta version in CIBERSORT website (<xref ref-type="supplementary-material" rid="pcbi.1006976.s005">S1 Fig</xref>). Since the CIBERSORT absolute mode is a beta version and leads to suboptimal results compared with CIBERSORT, we only focused on the comparisons with CIBERSORT. We show that FARDEEP gives the smallest SSE and the largest <italic>R</italic><sup>2</sup>, which indicates the most accurate result (<xref ref-type="fig" rid="pcbi.1006976.g003">Fig 3</xref>).</p>
      <fig id="pcbi.1006976.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1006976.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Applying different deconvolution approaches on the gene expression data of IM-9, Jurkat, Raji, THP-1 and the mixture of these four immune cell lines with known proportion (MixA, MixB, MixC, MixD).</title>
          <p>All of the mixtures were performed and measured in triplicate. (A) SSE of coefficients for FARDEEP, CIBERSORT, NNLS, PERT, DCQ. (B) The abundance of cell lines estimated from different deconvolution approaches vs. Abundance of cell lines truly mixed. The <italic>R</italic><sup>2</sup> and <italic>R</italic> values are also reported at the top of the figures. (C) Deconvolution of individual cell subsets by FARDEEP and CIBERSORT. The correlation coefficients <italic>R</italic>, the corresponding <italic>p</italic>-values against the null hypothesis of <italic>R</italic> = 0, trend lines with 95% confidence intervals are shown in the figures. The black dashed line represents the perfect relationship between the estimate and the true cell abundances with slope 1 and intercept 0.</p>
        </caption>
        <graphic xlink:href="pcbi.1006976.g003"/>
      </fig>
    </sec>
    <sec id="sec011">
      <title>Synthetic dataset with added unknown content</title>
      <p>Both CIBERSORT and FARDEEP are robust deconvolution methods and show advantages in the above datasets, we next sought to compare their performances on mixtures with unknown content. We followed the simulation setting proposed by Newman <italic>et al</italic>. [<xref rid="pcbi.1006976.ref012" ref-type="bibr">12</xref>] and downloaded the signature gene file from CIBERSORT website. The mixture file was constructed from the four immune cell lines data, as mentioned in the previous section, and a colon cancer cell line HCT116 (average of GSM269529 and GSM269530 in GSE10650). Cancer cells were mingled into immune cells at different ratios {0%, 30%, 60%, 90%}. Noise was added by sampling from the distribution <inline-formula id="pcbi.1006976.e078"><alternatives><graphic xlink:href="pcbi.1006976.e078.jpg" id="pcbi.1006976.e078g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M78"><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mspace width="2pt"/><mml:msub><mml:mtext>log</mml:mtext><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, in which <italic>f</italic> ∈ {0%, 30%, 60%, 90%} and <italic>s</italic> is the standard deviation of original mixtures. By applying FARDEEP and CIBERSORT (without converting to percentage) on 64 mixtures, we found that FARDEEP remains an accurate estimation, while the tumor contents skew the results of CIBERSORT with larger deviation from the ground truth (<xref ref-type="fig" rid="pcbi.1006976.g004">Fig 4</xref>).</p>
      <fig id="pcbi.1006976.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1006976.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Performance comparison between CIBERSORT and FARDEEP on mixtures with unknown content.</title>
          <p>(A) SSE for various noise and abundance of tumor contents on 4 different mixtures. (B) Abundance of cell lines estimated by CIBERSORT and FARDEEP vs. Abundance of cell lines truly mixed. The <italic>R</italic><sup>2</sup> and <italic>R</italic> values are also reported in the top of the figures. (C) Deconvolution of individual cell subsets by FARDEEP and CIBERSORT. The correlation coefficients <italic>R</italic>, the corresponding <italic>p</italic>-values against the null hypothesis of <italic>R</italic> = 0, trend lines with 95% confidence intervals are shown in the figures. The black dashed line represents the perfect relationship between the estimate and the true cell abundances with slope 1 and intercept 0.</p>
        </caption>
        <graphic xlink:href="pcbi.1006976.g004"/>
      </fig>
    </sec>
    <sec id="sec012">
      <title>Deconvolution performance on immune-cell-rich datasets</title>
      <p>To evaluate the performance of FARDEEP in immune-cell-rich settings that are less affected by outliers, we downloaded and analyzed two gene expression datasets (GSE65135 [<xref rid="pcbi.1006976.ref012" ref-type="bibr">12</xref>] and GSE20300 [<xref rid="pcbi.1006976.ref036" ref-type="bibr">36</xref>]) generated from the Affymetrix Microarray, which is the same platform used to generate the signature matrix LM22. The GSE65135 dataset consists of (i) surgical lymph node biopsies of 14 follicular lymphoma patients and (ii) purified B and T cells from the tonsils of 5 healthy controls, and the GSE20300 dataset includes 24 blood samples from pediatric renal transplant patients. Flow cytometry or coulter counter data in these studies, which are presented in relative scales, are treated as ground truth. Thus, we normalized the estimated parameters of each method to the sum of 1 before comparison.</p>
      <p>As shown in <xref ref-type="fig" rid="pcbi.1006976.g005">Fig 5A and 5B</xref> for case (i) of GSE65135 and <xref ref-type="fig" rid="pcbi.1006976.g005">Fig 5D and 5E</xref> for GSE20300, FARDEEP outperformed CIBERSORT in terms of <italic>R</italic><sup>2</sup>, <italic>R</italic> and SSE, which is consistent with our findings with simulated datasets. For case (ii) of GSE65136, we estimated the immune cell composition for purified B and T cells with purity level exceeding 95% and 98%, respectively. For purified B cells, CIBERSORT tends to return non-zero estimates for T cell and a large proportion of other cell types, while FARDEEP gave almost all zero estimates for T cell and on average reduced the estimation error by 61%. Similarly, for the purified T cell, although CIBERSORT had a better performance compared to purified B cell, FARDEEP still significantly improves the estimation accuracy by reducing on average 48% of the estimation error (<xref ref-type="fig" rid="pcbi.1006976.g005">Fig 5C</xref>). Furthermore, as shown in <xref ref-type="supplementary-material" rid="pcbi.1006976.s004">S4 Table</xref>, FARDEEP detected gene <italic>CD79A</italic> and <italic>BCL2A1</italic> as outliers for most samples in case (i) of GSE65135. These two genes are known to have high expression levels in follicular lymphoma (B-cell lymphoma) cells [<xref rid="pcbi.1006976.ref037" ref-type="bibr">37</xref>].</p>
      <fig id="pcbi.1006976.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1006976.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Performance assessment on Microarray data with SSE, <italic>R</italic><sup>2</sup> and <italic>R</italic>.</title>
          <p>The follicular lymphoma dataset is evaluated for (A) Overall performance and (B) individual cell subsets. (C) Normal tonsil dataset with purified B cells and T cells. The blood samples from pediatric renal transplant patients are evaluated for (D) Overall performance and (E) individual cell subsets. The black dashed line represents the perfect relationship between the estimate and the true cell abundances with slope 1 and intercept 0.</p>
        </caption>
        <graphic xlink:href="pcbi.1006976.g005"/>
      </fig>
      <p>Overall, even in specimens that are rich in immune cells without contamination by non-hematopoietic malignancy, FARDEEP still outperforms CIBERSORT in immune cell deconvolution.</p>
    </sec>
    <sec id="sec013">
      <title>Deconvolution performance on RNA-seq datasets</title>
      <p>In addition to effectively handling Microarray data, FARDEEP can also deconvolve TILs using RNA-seq data when we replace the signature matrix LM22 with quanTIseq, a signature matrix generated from RNA-seq data containing ten different immune cell types [<xref rid="pcbi.1006976.ref014" ref-type="bibr">14</xref>]. We applied CIBERSORT and FARDEEP using signature matrix quanTIseq to peripheral blood mononuclear cell (PBMC) mixtures (GSE64655) generated by Hoek <italic>et al</italic>. [<xref rid="pcbi.1006976.ref038" ref-type="bibr">38</xref>], and lymph node bulk samples of 4 melanoma patients from GSE93722 [<xref rid="pcbi.1006976.ref039" ref-type="bibr">39</xref>]. Flow cytometry data in these studies are on a relative scale and are treated as ground truth. We normalized the estimated parameters of each method to a relative scale using (<xref ref-type="disp-formula" rid="pcbi.1006976.e061">0.7</xref>) before comparison. The RNA-seq data are usually less noisy compared to Microarray, and PBMC datasets are usually clean with less unknown contents. Therefore, we expect FARDEEP and CIBERSORT will return comparable results, which is the case in <xref ref-type="fig" rid="pcbi.1006976.g006">Fig 6A and 6B</xref>. However, when dealing with noisier data containing more outliers such as lymph node bulk samples, FARDEEP obtained larger advantage over CIBERSORT as shown in <xref ref-type="fig" rid="pcbi.1006976.g006">Fig 6C and 6D</xref>.</p>
      <fig id="pcbi.1006976.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1006976.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Gene-expression deconvolution performance of FARDEEP and CIBERSORT on RNA-seq data.</title>
          <p>(A) Overall and (B) individual cell subsets results for 8 PBMC samples collected from two vaccinated donors at different time points. (C) Overall and (D) individual cell subsets result for lymph node bulk samples. Correlation coeffient <italic>R</italic> and the correspoinding <italic>p</italic>-value are missing for CIBERSORT on NK cell because the CIBERSORT estimations are all zero. The black dashed line represents the perfect relationship between the estimate and the true cell abundances with slope 1 and intercept 0.</p>
        </caption>
        <graphic xlink:href="pcbi.1006976.g006"/>
      </fig>
    </sec>
    <sec id="sec014">
      <title>Ovarian serous cystadenocarcinoma and lung squamous cell carcinoma datasets</title>
      <p>TME of solid carcinomas are different from a lymph node biopsy or peripheral blood, and the highly variable gene expression in cancer cells challenges the accuracy of immune cell deconvolution. It is well-established that immune infiltration profile serves as a promising prognosticator [<xref rid="pcbi.1006976.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1006976.ref005" ref-type="bibr">5</xref>]. Hence, we next utilized survival and gene expression data of ovarian cancer (OV) and lung squamous cell carcinoma (LUSC) from The Cancer Genome Atlas (TCGA) database to assess the prognostic relevance of different deconvolution methods. These two datasets were chosen because only LM22 not the RNA-seq based signature matrix quanTIseq includes <italic>γδ</italic> T cells, and OV and LUSC from TCGA datasets are the only two cancer types with Affymetrix microarray data. Using gene expression data (n = 514 for OV and n = 133 for LUSC), we estimated the immunoscore using ESTIMATE proposed by yoshihara <italic>et al</italic>. [<xref rid="pcbi.1006976.ref040" ref-type="bibr">40</xref>], TILs proportion using CIBERSORT, as well as TILs subset scores using CIBERSORT (without converting to percentage) and FARDEEP. Cold tumors typically harbor lower numbers of CD8<sup>+</sup> T cells, <italic>γδ</italic> T cells, M1-like macrophages, and NK cells [<xref rid="pcbi.1006976.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1006976.ref041" ref-type="bibr">41</xref>–<xref rid="pcbi.1006976.ref043" ref-type="bibr">43</xref>]. Thus, we calculated an anti-tumor immune subsets score by the summation of CD8<sup>+</sup> T cells, <italic>γδ</italic> T cells, M1-macrophages, and NK cells. Then, we partitioned the patients into two groups with equal size using the median of either the immunoscore (ESTIMATE) or anti-tumor immune subsets score (CIBERSORT and FARDEEP). We compared the survival curves between the two groups. As shown in <xref ref-type="fig" rid="pcbi.1006976.g007">Fig 7</xref>, FARDEEP most effectively separates patients into high- and low- risk groups with the smallest p-value (p-value = 0.0065 and 0.059 for OV and LUSC respectively). Recently, CIBERSORT website supports a beta-version of an absolute mode for cell deconvolution. We also included CIBERSORT absolute mode in this survival analysis and showed that it returned a better result (p-value = 0.037) compared to the relative mode in the OV dataset. FARDEEP shows a stronger performance with a smaller p-value under this setting (<xref ref-type="supplementary-material" rid="pcbi.1006976.s006">S2 Fig</xref>). These results demonstrated that the TIL subset scores could provide additional clinical-relevant information compared to the relative abundance.</p>
      <fig id="pcbi.1006976.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1006976.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Kaplan-Meier survival curves are plotted based on ESTIMATE, FARDEEP- and CIBERSORT- assisted TIL profiling.</title>
          <p>Log-Rank test was applied to data classified into two groups according to whether immunoscore (ESTIMATE) or collective anti-tumor immune subsets (CIBERSORT and FARDEEP) was above or below the median. (A) 514 patients with ovarian cancer. (B) 133 patients with lung squamous cell carcinoma.</p>
        </caption>
        <graphic xlink:href="pcbi.1006976.g007"/>
      </fig>
      <p>In addition, we expected the summation of these TIL subset scores would negatively correlate with tumor purity. To prove this hypothesis, we calculated the summation of 22 TIL subset scores for both OV and LUSC datasets and correlated them with the tumor purity estimated from consensus measurement of purity estimations (CPE) [<xref rid="pcbi.1006976.ref044" ref-type="bibr">44</xref>]. Even without taking account of stromal cells, as shown in <xref ref-type="supplementary-material" rid="pcbi.1006976.s007">S3 Fig</xref>. the summation of TIL subset scores is negatively correlated with tumor purity.</p>
      <p>Next, we sought to investigate whether outlier removal reduces contamination by transcripts from cancer cells. We first identified those top outlier-genes, which were consistently removed by FARDEEP in the OV dataset and obtained the average expression values of those outlier-genes from OV cell lines in GSE32474 [<xref rid="pcbi.1006976.ref045" ref-type="bibr">45</xref>]. As shown in <xref ref-type="supplementary-material" rid="pcbi.1006976.s003">S3 Table</xref>, most of these outlier-genes have high expression in cancer cell lines. For example, <italic>CXCL10</italic> gene encodes an important chemokine to recruit CD8<sup>+</sup> T cells and is also highly expressed in ovarian cancer cells. Thus, although some genes in LM22 may play a role in immune cells, they may be also highly expressed and variable among cancer cells. Such cross-contamination likely skews immune deconvolution analysis. As shown in <xref ref-type="supplementary-material" rid="pcbi.1006976.s003">S3 Table</xref>, FARDEEP successfully detected and removed those genes, leading to a more robust and accurate deconvolution analysis.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec015">
    <title>Discussion</title>
    <p>The cancer immune microenvironment has emerged as a critical prognostic dimension that modulates patient responses to neoadjuvant therapy. However, the current clinical TNM staging system does not have a consistent method to stratify cancers based on their immunogenicity. The recent study shows that the RNA-seq datasets of whole tumors contain valuable prognostic information to assess the cancer-immunity interactions [<xref rid="pcbi.1006976.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1006976.ref046" ref-type="bibr">46</xref>]. But the current methods to extract immune signatures are susceptible to the frequent outliers in the datasets, leading to less effective identification of cold tumors. Based on support vector regression, CIBERSORT is one of the most popular robust deconvolution methods. However, this model does not include an intercept to capture possible contribution from other cell types and performs a z-normalization to the data before fitting the regression model, which introduces biases into the output. Discussion of the effect of Z-score normalization for CIBERSORT is included in <xref ref-type="supplementary-material" rid="pcbi.1006976.s008">S1 Text</xref>. In this study, we developed a new machine learning tool, FARDEEP, to streamline the removal of outliers and increase the robustness of gene-expression profile deconvolution. Robustness is an indispensable feature to solve a problem of deconvolution because gene expression data are frequently contaminated by a large amount of outliers. FARDEEP solves the deconvolution problem in a robust way because this tool evaluates all outliers across the datasets and then examines the true immune gene signature using non-negative regression. This feature is especially useful to analyze tumors with significant non-hematopoietic tumor components. Interestingly, although FARDEEP and the current robust methods can both tackle immune-cell-rich specimens such as lymph node and PBMCs, FARDEEP exhibits improved prognostic potential when dealing more complex datasets with significant carcinoma cell content.</p>
    <p>Although FARDEEP provides a robust computational algorithm to better solve the gene-expression deconvolution problem with noisy datasets, its performance and application rely on the choice of the signature matrix. To avoid estimation bias, it is important to choose the signature matrix derived from the same platform as the mixture matrix. For example, if dealing with gene expression data measured by Affymetrix HGU133A, we should use LM22, but if dealing with RNA-seq data, the signature matrix quanTIseq is preferred. Overall, here we show that FARDEEP is a powerful and rapid machine learning tool that outperforms existing robust methods for gene deconvolution in datasets with significant heavy-tailed noise. FARDEEP provides a new technology to interrogate cancer immunogenomics and more accurately map the immune landscape of solid tumors.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec016">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1006976.s001">
      <label>S1 Table</label>
      <caption>
        <title>Parameters of FARDEEP.</title>
        <p>To show that FARDEEP is not sensitive for different values of <italic>α</italic><sub>1</sub>, and <italic>α</italic><sub>2</sub> with tuned value of <italic>k</italic>, we simulated a dataset with sample size <italic>n</italic> = 500, number of predictors <italic>p</italic> = 20, normal distributed error and 20% outliers using the same setting of <italic>in silico</italic> simulation in the paper. Then we ran FARDEEP with following setting and get the number of detected outliers, true and false positive rate: (1) Take <italic>α</italic><sub>2</sub> = 1.1, change <italic>α</italic><sub>1</sub> from 0.1 to 0.5 by 0.05 and tune <italic>k</italic> using BIC*. (2) Take <italic>α</italic><sub>1</sub> = 0.1, change <italic>α</italic><sub>2</sub> from 1.1 to 2 by 0.1 and tune <italic>k</italic> using BIC*. (3) Take <italic>α</italic><sub>1</sub> = 0.1, <italic>α</italic><sub>2</sub> = 1.5, and change <italic>k</italic> from 1 to 10 by 0.1. We can see that the accuracy of the result stays stable with a well tuned <italic>k</italic>.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1006976.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1006976.s002">
      <label>S2 Table</label>
      <caption>
        <title>Performance of FARDEEP, CIBERSORT, NNLS, PERT and DCQ methods under different simulation settings with outliers.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1006976.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1006976.s003">
      <label>S3 Table</label>
      <caption>
        <title>The outlier genes detected by FARDEEP and their average expression values in 7 ovarian cancer cell lines for TCGA OV dataset.</title>
        <p>Here we listed all genes with removal frequency larger than 50% among 514 samples.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1006976.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1006976.s004">
      <label>S4 Table</label>
      <caption>
        <title>Table of removed outlier genes for each real datasets.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1006976.s004.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1006976.s005">
      <label>S1 Fig</label>
      <caption>
        <title>Applying different deconvolution approaches on the gene expression data of IM-9, Jurkat, Raji, THP-1 and the mixture of these four immune cell lines with known proportion (MixA, MixB, MixC, MixD).</title>
        <p>All of the mixtures were performed and measured in triplicate. (A) SSE of coefficients for FARDEEP, CIBERSORT, CIBERSORT under absolute mode (CIBERSORT.abs), NNLS, PERT, DCQ. (B) Abundance of cell lines estimated from different deconvolution approaches vs. Abundance of cell lines truly mixed. The <italic>R</italic><sup>2</sup> and <italic>R</italic> values are also reported at the top of the figures. The black dashed line represents the perfect relationship between the estimate and the true cell abundances with slope 1 and intercept 0.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1006976.s005.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1006976.s006">
      <label>S2 Fig</label>
      <caption>
        <title>Kaplan-Meier survival curves are plotted based on CIBERSORT (absolute mode)- assisted TIL profiling.</title>
        <p>Patients were classified into two groups according to whether immunoscore (ESTIMATE) or collective anti-tumor immune subsets was above or below the median. Log-Rank test was applied to obtain the p-value. (A) 514 patients with ovarian cancer. (B) 133 patients with lung squamous cell carcinoma.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1006976.s006.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1006976.s007">
      <label>S3 Fig</label>
      <caption>
        <title>FARDEEP score of TCGA OV and LUSC datasets are calculated from the summation of 22 TIL subset scores, which show highly negative correlations to the consensus measurement of purity estimations (CPE).</title>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pcbi.1006976.s007.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1006976.s008">
      <label>S1 Text</label>
      <caption>
        <title>Discussion for the effect of Z-score normalization.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1006976.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1006976.s009">
      <label>S2 Text</label>
      <caption>
        <title>Discussion for the importance of TIL subset scores.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1006976.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1006976.s010">
      <label>S3 Text</label>
      <caption>
        <title>Discussion for the <italic>X</italic> related outliers and correlated responses.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1006976.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors acknowledge Dr. Yuehua Cui, Dr. Grace Hong and Dr. Gregory Wolf for helpful discussions.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1006976.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Deng</surname><given-names>L</given-names></name>, <name><surname>Liang</surname><given-names>H</given-names></name>, <name><surname>Xu</surname><given-names>M</given-names></name>, <name><surname>Yang</surname><given-names>X</given-names></name>, <name><surname>Burnette</surname><given-names>B</given-names></name>, <name><surname>Arina</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>STING-Dependent Cytosolic DNA Sensing Promotes Radiation-Induced Type I Interferon-Dependent Antitumor Immunity in Immunogenic Tumors</article-title>. <source>Immunity</source>. <year>2014</year>;<volume>41</volume>(<issue>5</issue>):<fpage>843</fpage>–<lpage>852</lpage>. <pub-id pub-id-type="doi">10.1016/j.immuni.2014.10.019</pub-id><?supplied-pmid 25517616?><pub-id pub-id-type="pmid">25517616</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Nagarsheth</surname><given-names>N</given-names></name>, <name><surname>Wicha</surname><given-names>MS</given-names></name>, <name><surname>Zou</surname><given-names>W</given-names></name>. <article-title>Chemokines in the cancer microenvironment and their relevance in cancer immunotherapy</article-title>. <source>Nature Reviews Immunology</source>. <year>2017</year>;<volume>17</volume>(<issue>9</issue>):<fpage>559</fpage>–<lpage>572</lpage>. <pub-id pub-id-type="doi">10.1038/nri.2017.49</pub-id><?supplied-pmid 28555670?><pub-id pub-id-type="pmid">28555670</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Corrales</surname><given-names>L</given-names></name>, <name><surname>McWhirter</surname><given-names>SM</given-names></name>, <name><surname>Dubensky</surname><given-names>TW</given-names></name>, <name><surname>Gajewski</surname><given-names>TF</given-names></name>. <article-title>The host STING pathway at the interface of cancer and immunity</article-title>. <source>The Journal of Clinical Investigation</source>. <year>2016</year>;<volume>126</volume>(<issue>7</issue>):<fpage>2404</fpage>–<lpage>2411</lpage>. <pub-id pub-id-type="doi">10.1172/JCI86892</pub-id><?supplied-pmid 27367184?><pub-id pub-id-type="pmid">27367184</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Galon</surname><given-names>J</given-names></name>, <name><surname>Costes</surname><given-names>A</given-names></name>, <name><surname>Sanchez-Cabo</surname><given-names>F</given-names></name>, <name><surname>Kirilovsky</surname><given-names>A</given-names></name>, <name><surname>Mlecnik</surname><given-names>B</given-names></name>, <name><surname>Lagorce-Pages</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>Type, density, and location of immune cells within human colorectal tumors predict clinical outcome</article-title>. <source>Science</source>. <year>2006</year>;<volume>313</volume>:<fpage>1960</fpage>–<lpage>1964</lpage>. <pub-id pub-id-type="doi">10.1126/science.1129139</pub-id><?supplied-pmid 17008531?><pub-id pub-id-type="pmid">17008531</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Mlecnik</surname><given-names>B</given-names></name>, <name><surname>Bindea</surname><given-names>G</given-names></name>, <name><surname>Angell</surname><given-names>HK</given-names></name>, <name><surname>Maby</surname><given-names>P</given-names></name>, <name><surname>Angelova</surname><given-names>M</given-names></name>, <name><surname>Tougeron</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Integrative Analyses of Colorectal Cancer Show Immunoscore Is a Stronger Predictor of Patient Survival Than Microsatellite Instability</article-title>. <source>Immunity</source>. <year>2016</year>;<volume>44</volume>:<fpage>698</fpage>–<lpage>711</lpage>. <pub-id pub-id-type="doi">10.1016/j.immuni.2016.02.025</pub-id><?supplied-pmid 26982367?><pub-id pub-id-type="pmid">26982367</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Balermpas</surname><given-names>P</given-names></name>, <name><surname>Michel</surname><given-names>Y</given-names></name>, <name><surname>Wagenblast</surname><given-names>J</given-names></name>, <name><surname>Seitz</surname><given-names>O</given-names></name>, <name><surname>Weiss</surname><given-names>C</given-names></name>, <name><surname>Rodel</surname><given-names>F</given-names></name>, <etal>et al</etal><article-title>Tumour-infiltrating lymphocytes predict response to definitive chemoradiotherapy in head and neck cancer</article-title>. <source>British Journal of Cancer</source>. <year>2014</year>;<volume>110</volume>:<fpage>501</fpage>–<lpage>509</lpage>. <pub-id pub-id-type="doi">10.1038/bjc.2013.640</pub-id><?supplied-pmid 24129245?><pub-id pub-id-type="pmid">24129245</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Balermpas</surname><given-names>P</given-names></name>, <name><surname>Rodel</surname><given-names>F</given-names></name>, <name><surname>Rodel</surname><given-names>C</given-names></name>, <name><surname>Krause</surname><given-names>M</given-names></name>, <name><surname>Linge</surname><given-names>A</given-names></name>, <name><surname>Lohaus</surname><given-names>F</given-names></name>, <etal>et al</etal><article-title>CD8+ tumour-infiltrating lymphocytes in relation to HPV status and clinical outcome in patients with head and neck cancer after postoperative chemoradiotherapy: A multicentre study of the German cancer consortium radiation oncology group (DKTK-ROG)</article-title>. <source>International Journal of Cancer</source>. <year>2016</year>;<volume>138</volume>:<fpage>171</fpage>–<lpage>181</lpage>. <pub-id pub-id-type="doi">10.1002/ijc.29683</pub-id><?supplied-pmid 26178914?><pub-id pub-id-type="pmid">26178914</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Nguyen</surname><given-names>N</given-names></name>, <name><surname>Bellile</surname><given-names>E</given-names></name>, <name><surname>Thomas</surname><given-names>D</given-names></name>, <name><surname>McHugh</surname><given-names>J</given-names></name>, <name><surname>Rozek</surname><given-names>L</given-names></name>, <name><surname>Virani</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Tumor infiltrating lymphocytes and survival in patients with head and neck squamous cell carcinoma</article-title>. <source>Head Neck</source>. <year>2016</year>;<volume>38</volume>:<fpage>1074</fpage>–<lpage>1084</lpage>. <pub-id pub-id-type="doi">10.1002/hed.24406</pub-id><?supplied-pmid 26879675?><pub-id pub-id-type="pmid">26879675</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Pages</surname><given-names>F</given-names></name>, <name><surname>Kirilovsky</surname><given-names>A</given-names></name>, <name><surname>Mlecnik</surname><given-names>B</given-names></name>, <name><surname>Asslaber</surname><given-names>M</given-names></name>, <name><surname>Tosolini</surname><given-names>M</given-names></name>, <name><surname>Bindea</surname><given-names>G</given-names></name>, <etal>et al</etal><article-title>In situ cytotoxic and memory T cells predict outcome in patients with early-stage colorectal cancer</article-title>. <source>Journal of clinical oncology</source>. <year>2009</year>;<volume>27</volume>:<fpage>5944</fpage>–<lpage>5951</lpage>. <pub-id pub-id-type="doi">10.1200/JCO.2008.19.6147</pub-id><?supplied-pmid 19858404?><pub-id pub-id-type="pmid">19858404</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Wolf</surname><given-names>GT</given-names></name>, <name><surname>Chepeha</surname><given-names>DB</given-names></name>, <name><surname>Bellile</surname><given-names>E</given-names></name>, <name><surname>Nguyen</surname><given-names>A</given-names></name>, <name><surname>Thomas</surname><given-names>D</given-names></name>, <name><surname>McHugh</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Tumor infiltrating lymphocytes (TIL) and prognosis in oral cavity squamous carcinoma: a preliminary study</article-title>. <source>Oral oncology</source>. <year>2015</year>;<volume>51</volume>:<fpage>90</fpage>–<lpage>95</lpage>. <pub-id pub-id-type="doi">10.1016/j.oraloncology.2014.09.006</pub-id><?supplied-pmid 25283344?><pub-id pub-id-type="pmid">25283344</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Lei</surname><given-names>Y</given-names></name>, <name><surname>Xie</surname><given-names>Y</given-names></name>, <name><surname>Tan</surname><given-names>YS</given-names></name>, <name><surname>Prince</surname><given-names>ME</given-names></name>, <name><surname>Moyer</surname><given-names>JS</given-names></name>, <name><surname>Nor</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Telltale tumor infiltrating lymphocytes (TIL) in oral, head &amp; neck cancer</article-title>. <source>Oral oncology</source>. <year>2016</year>;<volume>61</volume>:<fpage>159</fpage>–<lpage>165</lpage>. <pub-id pub-id-type="doi">10.1016/j.oraloncology.2016.08.003</pub-id><?supplied-pmid 27553942?><pub-id pub-id-type="pmid">27553942</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Newman</surname><given-names>AM</given-names></name>, <name><surname>Liu</surname><given-names>CL</given-names></name>, <name><surname>Green</surname><given-names>MR</given-names></name>, <name><surname>Gentles</surname><given-names>AJ</given-names></name>, <name><surname>Feng</surname><given-names>W</given-names></name>, <name><surname>Xu</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>. <source>Nature Methods</source>. <year>2015</year>;<volume>12</volume>:<fpage>453</fpage>–<lpage>457</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id><?supplied-pmid 25822800?><pub-id pub-id-type="pmid">25822800</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Aran</surname><given-names>D</given-names></name>, <name><surname>Hu</surname><given-names>Z</given-names></name>, <name><surname>Butte</surname><given-names>AJ</given-names></name>. <article-title>xCell: digitally portraying the tissue cellular heterogeneity landscape</article-title>. <source>Genome Biology</source>. <year>2017</year>;<volume>18</volume>:<fpage>220</fpage><pub-id pub-id-type="doi">10.1186/s13059-017-1349-1</pub-id><?supplied-pmid 29141660?><pub-id pub-id-type="pmid">29141660</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref014">
      <label>14</label>
      <mixed-citation publication-type="other">Finotello F, Mayer C, Miranda N, Trajanoski Z. quanTIseq: quantifying immune contexture of human tumors. bioRxiv. 2017; p. <pub-id pub-id-type="doi">10.1101/223180</pub-id>.</mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Tosolini</surname><given-names>M</given-names></name>, <name><surname>Algans</surname><given-names>C</given-names></name>, <name><surname>Pont</surname><given-names>F</given-names></name>, <name><surname>Ycart</surname><given-names>B</given-names></name>, <name><surname>Fournie</surname><given-names>JJ</given-names></name>. <article-title>Large-scale microarray profiling reveals four stages of immune escape in non-Hodgkin lymphomas</article-title>. <source>Oncoimmunology</source>. <year>2016</year>;<volume>5</volume>(<issue>7</issue>). <pub-id pub-id-type="doi">10.1080/2162402X.2016.1188246</pub-id><?supplied-pmid 27622044?><pub-id pub-id-type="pmid">27622044</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Tosolini</surname><given-names>M</given-names></name>, <name><surname>Pont</surname><given-names>F</given-names></name>, <name><surname>Poupot</surname><given-names>M</given-names></name>, <name><surname>Vergez</surname><given-names>F</given-names></name>, <name><surname>Nicolau-Travers</surname><given-names>ML</given-names></name>, <name><surname>Vermijlen</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Assessment of tumor-infiltrating TCRV<italic>γ</italic>9V<italic>δ</italic>2 <italic>γδ</italic> lymphocyte abundance by deconvolution of human cancers microarrays</article-title>. <source>Oncoimmunology</source>. <year>2017</year>;<volume>6</volume>:<fpage>e1284723</fpage><pub-id pub-id-type="doi">10.1080/2162402X.2017.1284723</pub-id><?supplied-pmid 28405516?><pub-id pub-id-type="pmid">28405516</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Vallania</surname><given-names>F</given-names></name>, <name><surname>Tam</surname><given-names>A</given-names></name>, <name><surname>Lofgren</surname><given-names>S</given-names></name>, <name><surname>Schaffert</surname><given-names>S</given-names></name>, <name><surname>Azad</surname><given-names>TD</given-names></name>, <name><surname>Bongen</surname><given-names>E</given-names></name>, <etal>et al</etal><article-title>Leveraging heterogeneity across multiple datasets increases cell-mixture deconvolution accuracy and reduces biological and technical biases</article-title>. <source>Nature Communications</source>. <year>2018</year>;<volume>9</volume>:<fpage>4735</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-07242-6</pub-id><?supplied-pmid 30413720?><pub-id pub-id-type="pmid">30413720</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Jiang</surname><given-names>D</given-names></name>, <name><surname>Tang</surname><given-names>C</given-names></name>, <name><surname>Zhang</surname><given-names>A</given-names></name>. <article-title>Cluster Analysis for Gene Expression Data: A Survey</article-title>. <source>IEEE Transactions on Knowledge and Data Engineering</source>. <year>2004</year>;<volume>16</volume>:<fpage>1370</fpage>–<lpage>1386</lpage>. <pub-id pub-id-type="doi">10.1109/TKDE.2004.68</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref019">
      <label>19</label>
      <mixed-citation publication-type="book"><name><surname>Lawson</surname><given-names>CL</given-names></name>, <name><surname>Hanson</surname><given-names>RJ</given-names></name>. <chapter-title>Solving Least Squares Problems</chapter-title><source>Classics in Applied Mathematics</source>. <publisher-name>Society for Industrial and Applied Mathematics</publisher-name>; <year>1995</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Gong</surname><given-names>T</given-names></name>, <name><surname>Hartmann</surname><given-names>N</given-names></name>, <name><surname>Kohane</surname><given-names>IS</given-names></name>, <name><surname>Brinkmann</surname><given-names>V</given-names></name>, <name><surname>Staedtler</surname><given-names>F</given-names></name>, <name><surname>Letzkus</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Optimal Deconvolution of Transcriptional Profiling Data Using Quadratic Programming with Application to Complex Clinical Blood Samples</article-title>. <source>PLOS ONE</source>. <year>2011</year>;<volume>6</volume>:<fpage>e27156</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0027156</pub-id><?supplied-pmid 22110609?><pub-id pub-id-type="pmid">22110609</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Gong</surname><given-names>T</given-names></name>, <name><surname>Szustakowski</surname><given-names>J</given-names></name>. <article-title>DeconRNASeq: a statistical framework for deconvolution of heterogeneous tissue samples based on mRNA-Seq data</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>:<fpage>1083</fpage>–<lpage>1085</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt090</pub-id><?supplied-pmid 23428642?><pub-id pub-id-type="pmid">23428642</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>B</given-names></name>, <name><surname>Severson</surname><given-names>E</given-names></name>, <name><surname>Pignon</surname><given-names>JC</given-names></name>, <name><surname>Zhao</surname><given-names>H</given-names></name>, <name><surname>Li</surname><given-names>T</given-names></name>, <name><surname>Novak</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Comprehensive analyses of tumor immunity: implications for cancer immunotherapy</article-title>. <source>Genome Biology</source>. <year>2016</year>;<volume>17</volume>:<fpage>174</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-1028-7</pub-id><?supplied-pmid 27549193?><pub-id pub-id-type="pmid">27549193</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Mackey</surname><given-names>MD</given-names></name>, <name><surname>Mackey</surname><given-names>DJ</given-names></name>, <name><surname>Higgins</surname><given-names>HW</given-names></name>, <name><surname>Wright</surname><given-names>SW</given-names></name>. <article-title>CHEMTAX—a program for estimating class abundances from chemical markers:application to HPLC measurements of phytoplankton</article-title>. <source>Marine Ecology Progress Series</source>. <year>1996</year>;<volume>144</volume>:<fpage>265</fpage>–<lpage>283</lpage>. <pub-id pub-id-type="doi">10.3354/meps144265</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Qiao</surname><given-names>W</given-names></name>, <name><surname>Quon</surname><given-names>G</given-names></name>, <name><surname>Csaszar</surname><given-names>E</given-names></name>, <name><surname>Yu</surname><given-names>M</given-names></name>, <name><surname>Morris</surname><given-names>Q</given-names></name>, <name><surname>Zandstra</surname><given-names>PW</given-names></name>. <article-title>PERT: A Method for Expression Deconvolution of Human Blood Samples from Varied Microenvironmental and Developmental Conditions</article-title>. <source>PLOS Computational Biology</source>. <year>2012</year>;<volume>8</volume>:<fpage>e1002838</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002838</pub-id><?supplied-pmid 23284283?><pub-id pub-id-type="pmid">23284283</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Liebner</surname><given-names>DA</given-names></name>, <name><surname>Huang</surname><given-names>K</given-names></name>, <name><surname>Parvin</surname><given-names>JD</given-names></name>. <article-title>Microarray microdissection with analysis of differences is a computational tool for deconvoluting cell type-specific contributions from tissue samples</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>:<fpage>682</fpage>–<lpage>689</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt566</pub-id><?supplied-pmid 24085566?><pub-id pub-id-type="pmid">24085566</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Altboum</surname><given-names>Z</given-names></name>, <name><surname>Steuerman</surname><given-names>Y</given-names></name>, <name><surname>David</surname><given-names>E</given-names></name>, <name><surname>Barnett-Itzhaki</surname><given-names>Z</given-names></name>, <name><surname>Valadarsky</surname><given-names>L</given-names></name>, <name><surname>Keren-Shaul</surname><given-names>H</given-names></name>, <etal>et al</etal><article-title>Digital cell quantification identifies global immune cell dynamics during influenza infection</article-title>. <source>Molecular Systems Biology</source>. <year>2014</year>;<volume>10</volume>:<fpage>720</fpage><pub-id pub-id-type="doi">10.1002/msb.134947</pub-id><?supplied-pmid 24586061?><pub-id pub-id-type="pmid">24586061</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Zou</surname><given-names>H</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>. <article-title>Regularization and variable selection via the elastic net</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2005</year>;<volume>67</volume>:<fpage>301</fpage>–<lpage>320</lpage>. <pub-id pub-id-type="doi">10.1111/j.1467-9868.2005.00503.x</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Rousseeuw</surname><given-names>PJ</given-names></name>. <article-title>Least median of squares regression</article-title>. <source>Journal of the American Statistical Association</source>. <year>1984</year>;<volume>79</volume>:<fpage>871</fpage>–<lpage>880</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.1984.10477105</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref029">
      <label>29</label>
      <mixed-citation publication-type="book"><name><surname>Rousseeuw</surname><given-names>PJ</given-names></name>, <name><surname>Leroy</surname><given-names>AM</given-names></name>. <source>Robust Regression and Outlier Detection</source>. <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>1987</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Rousseeuw</surname><given-names>PJ</given-names></name>, <name><surname>Driessen</surname><given-names>KV</given-names></name>. <article-title>Computing LTS regression for large data sets</article-title>. <source>Data Mining and Knowledge Discovery</source>. <year>2006</year>;<volume>12</volume>:<fpage>29</fpage>–<lpage>45</lpage>. <pub-id pub-id-type="doi">10.1007/s10618-005-0024-4</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref031">
      <label>31</label>
      <mixed-citation publication-type="other">Xu Q, Yan M, Huang C, Xiong J, Huang Q, Yao Y. Exploring Outliers in Crowdsourced Ranking for QoE. Proceedings of the 25th ACM Multimedia. 2017.</mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Beal</surname><given-names>J</given-names></name>. <article-title>Biochemical complexity drives log-normal variation in genetic expression</article-title>. <source>Engineering Biology</source>. <year>2017</year>;<volume>1</volume>(<issue>1</issue>):<fpage>55</fpage>–<lpage>60</lpage>. <pub-id pub-id-type="doi">10.1049/enb.2017.0004</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>She</surname><given-names>Y</given-names></name>, <name><surname>Owen</surname><given-names>AB</given-names></name>. <article-title>Outlier detection using nonconvex penalized regression</article-title>. <source>Journal of the American Statistical Association</source>. <year>2011</year>;<volume>106</volume>:<fpage>626</fpage>–<lpage>639</lpage>. <pub-id pub-id-type="doi">10.1198/jasa.2011.tm10390</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Alfons</surname><given-names>A</given-names></name>, <name><surname>Croux</surname><given-names>C</given-names></name>, <name><surname>Gelper</surname><given-names>S</given-names></name>. <article-title>Sparse least trimmed squares regression for analyzing high-dimensional large data sets</article-title>. <source>The Annals of Applied Statistics</source>. <year>2013</year>;<volume>7</volume>:<fpage>226</fpage>–<lpage>248</lpage>. <pub-id pub-id-type="doi">10.1214/12-AOAS575</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Abbas</surname><given-names>AR</given-names></name>, <name><surname>Wolslegel</surname><given-names>K</given-names></name>, <name><surname>Seshasayee</surname><given-names>D</given-names></name>, <name><surname>Modrusan</surname><given-names>Z</given-names></name>, <name><surname>Clark</surname><given-names>HF</given-names></name>. <article-title>Deconvolution of blood microarray data identifies cellular activation patterns in systemic lupus erythematosus</article-title>. <source>PLOS ONE</source>. <year>2009</year>;<volume>4</volume>:<fpage>e6098</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0006098</pub-id><?supplied-pmid 19568420?><pub-id pub-id-type="pmid">19568420</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Shen-Orr</surname><given-names>SS</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>, <name><surname>Khatri</surname><given-names>P</given-names></name>, <name><surname>Bodian</surname><given-names>DL</given-names></name>, <name><surname>Staedtler</surname><given-names>F</given-names></name>, <name><surname>Perry</surname><given-names>NM</given-names></name>, <etal>et al</etal><article-title>Cell type–specific gene expression differences in complex tissues</article-title>. <source>Nature Methods</source>. <year>2010</year>;<volume>7</volume>:<fpage>287</fpage>–<lpage>289</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1439</pub-id><?supplied-pmid 20208531?><pub-id pub-id-type="pmid">20208531</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Eray</surname><given-names>M</given-names></name>, <name><surname>Postila</surname><given-names>V</given-names></name>, <name><surname>Eeva</surname><given-names>J</given-names></name>, <name><surname>Ripatti</surname><given-names>A</given-names></name>, <name><surname>Karjalainen-Lindsberg</surname><given-names>ML</given-names></name>, <name><surname>Knuutila</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Follicular Lymphoma Cell Lines, an In Vitro Model for Antigenic Selection and Cytokine-Mediated Growth Regulation of Germinal Centre B Cells</article-title>. <source>Scandinavian Journal of Immunology</source>. <year>2003</year>;<volume>57</volume>(<issue>6</issue>):<fpage>545</fpage>–<lpage>555</lpage>. <pub-id pub-id-type="doi">10.1046/j.1365-3083.2003.01264.x</pub-id><?supplied-pmid 12791092?><pub-id pub-id-type="pmid">12791092</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Hoek</surname><given-names>KL</given-names></name>, <name><surname>Samir</surname><given-names>P</given-names></name>, <name><surname>Howard</surname><given-names>LM</given-names></name>, <name><surname>Niu</surname><given-names>X</given-names></name>, <name><surname>Prasad</surname><given-names>N</given-names></name>, <name><surname>Galassie</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>A cell-based systems biology assessment of human blood to monitor immune responses after influenza vaccination</article-title>. <source>PLoS One</source>. <year>2015</year>;<volume>10</volume>:<fpage>e0118528</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0118528</pub-id><?supplied-pmid 25706537?><pub-id pub-id-type="pmid">25706537</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Racle</surname><given-names>J</given-names></name>, <name><surname>de Jonge</surname><given-names>K</given-names></name>, <name><surname>Baumgaertner</surname><given-names>P</given-names></name>, <name><surname>Speiser</surname><given-names>DE</given-names></name>, <name><surname>Gfeller</surname><given-names>D</given-names></name>. <article-title>Simultaneous enumeration of cancer and immune cell types from bulk tumor gene expression data</article-title>. <source>eLife</source>. <year>2017</year>;<volume>6</volume><pub-id pub-id-type="doi">10.7554/eLife.26476</pub-id><?supplied-pmid 29130882?><pub-id pub-id-type="pmid">29130882</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Yoshihara</surname><given-names>K</given-names></name>, <name><surname>Shahmoradgoli</surname><given-names>M</given-names></name>, <name><surname>Martínez</surname><given-names>E</given-names></name>, <name><surname>Vegesna</surname><given-names>R</given-names></name>, <name><surname>Kim</surname><given-names>H</given-names></name>, <name><surname>Torres-Garcia</surname><given-names>W</given-names></name>, <etal>et al</etal><article-title>Inferring tumour purity and stromal and immune cell admixture from expression data</article-title>. <source>Nature Communications</source>. <year>2013</year>;<volume>4</volume>:<fpage>2612</fpage><pub-id pub-id-type="doi">10.1038/ncomms3612</pub-id><?supplied-pmid 24113773?><pub-id pub-id-type="pmid">24113773</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Qiao</surname><given-names>J</given-names></name>, <name><surname>Tang</surname><given-names>H</given-names></name>, <name><surname>Fu</surname><given-names>YX</given-names></name>. <article-title>DNA sensing and immune responses in cancer therapy</article-title>. <source>Current opinion in immunology</source>. <year>2017</year>;<volume>45</volume>:<fpage>16</fpage>–<lpage>20</lpage>. <pub-id pub-id-type="doi">10.1016/j.coi.2016.12.005</pub-id><?supplied-pmid 28088707?><pub-id pub-id-type="pmid">28088707</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Binnewies</surname><given-names>M</given-names></name>, <name><surname>Roberts</surname><given-names>EW</given-names></name>, <name><surname>Kersten</surname><given-names>K</given-names></name>, <name><surname>Chan</surname><given-names>V</given-names></name>, <name><surname>Fearon</surname><given-names>DF</given-names></name>, <name><surname>Merad</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Understanding the tumor immune microenvironment (TIME) for effective therapy</article-title>. <source>Nature Medicine</source>. <year>2018</year>;<volume>24</volume>:<fpage>541</fpage>–<lpage>550</lpage>. <pub-id pub-id-type="doi">10.1038/s41591-018-0014-x</pub-id><?supplied-pmid 29686425?><pub-id pub-id-type="pmid">29686425</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Corrales</surname><given-names>L</given-names></name>, <name><surname>McWhirter</surname><given-names>SM</given-names></name>, <name><surname>Thomas W Dubensky</surname><given-names>J</given-names></name>, <name><surname>Gajewski</surname><given-names>TF</given-names></name>. <article-title>The host STING pathway at the interface of cancer and immunity</article-title>. <source>The Journal of Clinical Investigation</source>. <year>2016</year>;<volume>126</volume>:<fpage>2404</fpage>–<lpage>2411</lpage>. <pub-id pub-id-type="doi">10.1172/JCI86892</pub-id><?supplied-pmid 27367184?><pub-id pub-id-type="pmid">27367184</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Aran</surname><given-names>D</given-names></name>, <name><surname>Sirota</surname><given-names>M</given-names></name>, <name><surname>Butte</surname><given-names>AJ</given-names></name>. <article-title>Systematic pan-cancer analysis of tumour purity</article-title>. <source>Nature Communications</source>. <year>2015</year>;<volume>6</volume>:<fpage>8971</fpage><pub-id pub-id-type="doi">10.1038/ncomms9971</pub-id><?supplied-pmid 26634437?><pub-id pub-id-type="pmid">26634437</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>H</given-names></name>, <name><surname>Huang</surname><given-names>S</given-names></name>, <name><surname>Shou</surname><given-names>J</given-names></name>, <name><surname>Su</surname><given-names>EW</given-names></name>, <name><surname>Onyia</surname><given-names>JE</given-names></name>, <name><surname>Liao</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>Comparative analysis and integrative classification of NCI60 cell lines and primary tumors using gene expression profiling data</article-title>. <source>BMC Genomics</source>. <year>2006</year>;<volume>7</volume>:<fpage>166</fpage><pub-id pub-id-type="doi">10.1186/1471-2164-7-166</pub-id><?supplied-pmid 16817967?><pub-id pub-id-type="pmid">16817967</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1006976.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>D</given-names></name>, <name><surname>Wu</surname><given-names>YM</given-names></name>, <name><surname>Lonigro</surname><given-names>R</given-names></name>, <name><surname>Vats</surname><given-names>P</given-names></name>, <name><surname>Cobain</surname><given-names>E</given-names></name>, <name><surname>Everett</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Integrative clinical genomics of metastatic cancer</article-title>. <source>Nature</source>. <year>2017</year>;<volume>548</volume>:<fpage>297</fpage>–<lpage>303</lpage>. <pub-id pub-id-type="doi">10.1038/nature23306</pub-id><?supplied-pmid 28783718?><pub-id pub-id-type="pmid">28783718</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
