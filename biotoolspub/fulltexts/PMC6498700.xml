<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6498700</article-id>
    <article-id pub-id-type="publisher-id">2797</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-2797-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>scruff</italic>: an R/Bioconductor package for preprocessing single-cell RNA-sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Zhe</given-names>
        </name>
        <address>
          <email>zhe@bu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Junming</given-names>
        </name>
        <address>
          <email>hjunming@bu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Johnson</surname>
          <given-names>W. Evan</given-names>
        </name>
        <address>
          <email>wej@bu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Campbell</surname>
          <given-names>Joshua D.</given-names>
        </name>
        <address>
          <email>camp@bu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7558</institution-id><institution-id institution-id-type="GRID">grid.189504.1</institution-id><institution>Bioinformatics Program, </institution><institution>Boston University, </institution></institution-wrap>Boston, MA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7558</institution-id><institution-id institution-id-type="GRID">grid.189504.1</institution-id><institution>Section of Computational Biomedicine, Department of Medicine, </institution><institution>Boston University, </institution></institution-wrap>Boston, MA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>222</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>1</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Single-cell RNA sequencing (scRNA-seq) enables the high-throughput quantification of transcriptional profiles in single cells. In contrast to bulk RNA-seq, additional preprocessing steps such as cell barcode identification or unique molecular identifier (UMI) deconvolution are necessary for preprocessing of data from single cell protocols. R packages that can easily preprocess data and rapidly visualize quality metrics and read alignments for individual cells across multiple samples or runs are still lacking.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here we present <italic>scruff</italic>, an R/Bioconductor package that preprocesses data generated from the CEL-Seq or CEL-Seq2 protocols and reports comprehensive data quality metrics and visualizations. <italic>scruff</italic> rapidly demultiplexes, aligns, and counts the reads mapped to genome features with deduplication of unique molecular identifier (UMI) tags. <italic>scruff</italic> also provides novel and extensive functions to visualize both pre- and post-alignment data quality metrics for cells from multiple experiments. Detailed read alignments with corresponding UMI information can be visualized at specific genome coordinates to display differences in isoform usage. The package also supports the visualization of quality metrics for sequence alignment files for multiple experiments generated by <italic>Cell Ranger</italic> from 10X Genomics. <italic>scruff</italic> is available as a free and open-source R/Bioconductor package.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3"><italic>scruff</italic> streamlines the preprocessing of scRNA-seq data in a few simple R commands. It performs data demultiplexing, alignment, counting, quality report and visualization systematically and comprehensively, ensuring reproducible and reliable analysis of scRNA-seq data.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>
        <italic>Scruff</italic>
      </kwd>
      <kwd>Single-cell RNA-sequencing</kwd>
      <kwd>Cell barcode demultiplexing</kwd>
      <kwd>Unique molecular identifier (UMI)</kwd>
      <kwd>Visualization of data quality</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100002192</institution-id>
            <institution>LUNGevity Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Career Development Award</award-id>
        <principal-award-recipient>
          <name>
            <surname>Campbell</surname>
            <given-names>Joshua D.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Informatics Technology for Cancer Research</institution>
        </funding-source>
        <award-id>1U01 CA220413-01</award-id>
        <principal-award-recipient>
          <name>
            <surname>Johnson</surname>
            <given-names>W. Evan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par12">Single-cell RNA sequencing (scRNA-seq) technologies can profile the transcriptome of individual cells allowing for greater characterization of cellular heterogeneity in complex biological systems. In the past decade, the number of cells profiled by scRNA-seq technologies within a single experiment has grown from a single blastomere [<xref ref-type="bibr" rid="CR1">1</xref>] to hundreds of thousands of cells [<xref ref-type="bibr" rid="CR2">2</xref>]. The high throughput is achieved by advanced multiplexing strategies where the mRNA molecules from each cell are barcoded with unique oligonucleotide tags embedded within the reverse transcription (RT) primers. After synthesis, the cDNA is subsequently amplified using PCR or in vitro transcription. These amplification steps prior to sequencing often introduce bias due to different amplification efficiencies for different molecules [<xref ref-type="bibr" rid="CR3">3</xref>]. To alleviate this problem, random molecular barcodes, usually referred to as unique molecular identifiers (UMIs), are often inserted into RT primers which enable the identification of PCR duplicates [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. After barcoding, cells from multiple plates or droplets are sequenced together and then computationally deconvoluted to obtain counts for each individual cell. Samples within a study are often processed in different plates, batches, or runs but ultimately need to be assessed together.</p>
    <p id="Par13">Available computational tools that preprocesses scRNA-seq data generated from CEL-Seq related protocols have limitations. For example, CEL-Seq pipeline [<xref ref-type="bibr" rid="CR6">6</xref>], <italic>umis</italic> [<xref ref-type="bibr" rid="CR7">7</xref>], and <italic>UMI-tools</italic> [<xref ref-type="bibr" rid="CR8">8</xref>] do not report any data quality visualizations. <italic>zUMIs</italic> and <italic>scPipe</italic> only report limited QC metrics and have limited plotting capabilities [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. Furthermore, there is no tool that can view detailed read alignments with UMI information on specified genomic coordinates in a single cell. For assessment of 10X Genomics data quality, <italic>Cell Ranger</italic> does not systematically generate and plot quality control metrics across multiple experiments [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par14"><italic>scruff</italic> performs data preprocessing and reports comprehensive QC metrics and visualizations for data generated by CEL-Seq and CEL-Seq2 protocols. It also supports the visualization of read alignment statistics for BAM files from multiple runs generated by <italic>Cell Ranger</italic> from 10X protocol. <italic>scruff</italic> package reports detailed metrics on measurements on several different aspects of the data, providing a streamlined assessment of quality control.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par15"><italic>scruff</italic> stands for Single Cell RNA-seq UMI Filtering Facilitator and is an R/Bioconductor package [<xref ref-type="bibr" rid="CR11">11</xref>] that demultiplexes cell barcodes, aligns reads to reference genome, and generate gene-level counts with UMI deduplication from scRNA-seq experiments. The main design aim of <italic>scruff</italic> is the ability to 1) preprocess scRNA-seq sequenced reads and generate gene-level count data for individual cells in parallel and 2) summarize and display of comprehensive data quality metrics. <italic>scruff</italic> supports the preprocessing and data quality visualization of sequenced reads from CEL-Seq [<xref ref-type="bibr" rid="CR12">12</xref>], CEL-Seq2 [<xref ref-type="bibr" rid="CR6">6</xref>] and SORT-seq [<xref ref-type="bibr" rid="CR13">13</xref>] protocols. Additionally, <italic>scruff</italic> package complements the report of <italic>Cell Ranger</italic> pipeline by providing the visualization of read alignment information in BAM files from 10X Genomics for multiple runs simultaneously. All functions and procedures in <italic>scruff</italic> package are implemented using R statistical framework.</p>
  </sec>
  <sec id="Sec3">
    <title>Results</title>
    <sec id="Sec4">
      <title>Cell barcode demultiplexing</title>
      <p id="Par16">The <italic>scruff</italic> pipeline starts with the demultiplexing of paired-end reads in FASTQ format (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). In the demultiplex function, cell barcode and UMI sequences are first trimmed from the reads and UMIs are appended to read headers. Reads are filtered according to the Phred quality scores [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>] of their corresponding cell barcode and UMI sequences. Reads with Phred scores lower than a user-defined threshold are removed. In the meantime, cell barcodes are mapped to a user-defined whitelist. Reads with cell barcode mismatches exceeding user-defined threshold are excluded. The remaining reads are stored in cell specific FASTQ files and an annotation table is used to keep track of which experiment the cell is from. <italic>scruff</italic> enables the trimming of read sequences by allowing users to only keep certain number of nucleotides for the reads. This is useful if the sequences at 3′ ends have poor quality scores. Parallelization using the BiocParallel [<xref ref-type="bibr" rid="CR16">16</xref>] package is implemented to allow for simultaneous demultiplexing of multiple samples.<fig id="Fig1"><label>Fig. 1</label><caption><p><italic>scruff</italic> package workflow. <bold>a</bold> Schematic diagram of each step in <italic>scruff</italic>. <bold>b</bold>
<italic>scruff</italic> workflow. Reads from FASTQ files are first demultiplexed into cell-specific FASTQ files according to their cell barcodes. During this process, UMI tags are appended to the read header of the transcript sequences. <italic>scruff</italic> applies the Subread [<xref ref-type="bibr" rid="CR18">18</xref>] algorithm for sequence alignment for each cell. Next, reads mapped to genes are counted according to their UMI. Within each gene, reads with identical UMI (red dashed circle) are counted only once. QC metrics are collected at each of these steps and are used for visualization of data quality</p></caption><graphic xlink:href="12859_2019_2797_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par17"><italic>scruff</italic> makes use of the SingleCellExperiment S4 object [<xref ref-type="bibr" rid="CR17">17</xref>] as a container for both data and data annotation storage. This object keeps track of the directory to cell-specific demultiplexed FASTQ files and their corresponding cell barcodes. Metrics including the number and fraction of reads assigned to each cell are stored in the cell annotation table of the SingleCellExperiment object which is passed to the subsequent alignment step.</p>
    </sec>
    <sec id="Sec5">
      <title>Read alignment</title>
      <p id="Par18">By default, <italic>scruff</italic> package uses the aligner Subread [<xref ref-type="bibr" rid="CR18">18</xref>] and its corresponding R package Rsubread [<xref ref-type="bibr" rid="CR19">19</xref>] for read alignment. The function alignRsubread is a wrapper function to the align function in Rsubread. It parses the FASTQ file paths from the SingleCellExperiment object generated in the demultiplexing step and aligns those files to the reference genome. Sequence alignment files in BAM or SAM formats are generated for each cell and saved to user specified output folder. In the meantime, the locations of these cell specific sequence alignment files and their alignment quality metrics including the number and the fraction of aligned reads are collected and appended to the cell annotation table in the SingleCellExperiment object. Cells can be aligned in parallel to reduce the overall time for this step.</p>
    </sec>
    <sec id="Sec6">
      <title>UMI counting</title>
      <p id="Par19">The SingleCellExperiment object containing the file paths to the sequence alignment files are passed to the countUMI function for quantification of cell specific gene expression. Genomic features are extracted from the input genome annotation file. <italic>scruff</italic> implements a counting paradigm that works in the same way as featureCounts [<xref ref-type="bibr" rid="CR20">20</xref>] and the union counting mode of SummarizeOverlaps [<xref ref-type="bibr" rid="CR21">21</xref>] except that scruff properly counts the UMI tagged reads by deduplication. Specifically, read alignments overlapping the exonic regions of exactly one gene are used for transcript counting. After parsing the UMI sequences from the read headers, the number of unique UMIs are summarized for each gene to get the counts for gene-wise mRNA transcripts. External RNA Controls Consortium (ERCC) spike-in RNA controls are flagged by the isSpike method so they can be handled separately during data analysis. Gene counting for each cell can be run in parallel. The resulting count matrix is saved in a tab delimited file and stored in the assay slot of the SingleCellExperiment object. Gene annotations including gene ID, gene name, and gene biotype are collected from the input gene annotation file and stored in the gene annotation table of the SingleCellExperiment object.</p>
      <p id="Par20">In the UMI counting step, various quality metrics are collected for each cell including the number of reads mapped to the genome, number of reads mapped to genes, total number of transcripts (i.e. number of UMIs), number of transcripts from mitochondrial genes, number of transcripts from protein coding genes, number of transcribed genes detected with at least one count, and number of transcribed protein coding genes detected with at least one count. These metrics are appended to the cell annotation table of the SingleCellExperiment object. Finally, this SingleCellExperiment object containing the count matrix, cell and gene annotation information is returned at the end of the pipeline.</p>
    </sec>
    <sec id="Sec7">
      <title>Data quality visualization</title>
      <p id="Par21"><italic>scruff</italic> provides functions to visualize both pre- and post-alignment data quality for all cells using quality metrics information collected in demultiplexing, alignment, and UMI counting steps. The qcplots function parses the cell annotation table from the SingleCellExperiment object and automatically generates numerous boxplots showing various data quality metrics for individual experiments and cells. These metrics include total number of reads, number of reads mapped to reference genome, number of reads mapped to genes, fraction of mapped reads to total reads, fraction of reads mapped to genes to reads mapped to genome, fraction of reads mapped to genes to total number of reads, total number of transcripts, number of mitochondrial transcripts, fraction of mitochondrial transcripts, number of transcribed genes, fraction of protein coding genes, fraction of protein coding transcripts, median and average number of reads per corrected and uncorrected UMI counts, and the number of detected genes divided by total number of reads sequenced per million. These plots can be used for assessing the sample quality of the experiment and across individual batches. From these plots, poor-quality outlier cells can be identified and flagged for removal.</p>
      <p id="Par22"><italic>scruff</italic> package contains method to look at the detailed read alignment information for specific genes in a cell. The function rview visualizes all reads mapped at specific region of the chromosome. Function gview plots the exonic regions of all gene isoforms between specified genomic coordinates. By combining these two plots vertically using tracks function from the ggbio [<xref ref-type="bibr" rid="CR22">22</xref>] package, users are able to visualize the exact locations of read alignments on the gene.</p>
      <p id="Par23">Finally, <italic>scruff</italic> provides method to visualize read alignment statistics for sequence alignment files from multiple experiments generated by the <italic>Cell Ranger</italic> pipeline from 10X Genomics. tenxBamqc function parses read alignments from sequence alignment files in BAM format. A SingleCellExperiment object containing the number of mapped reads and the number of reads mapped to genes for filtered cells is returned. These metrics can be visualized by passing this object to the qcplots function.</p>
    </sec>
    <sec id="Sec8">
      <title>Application to example datasets</title>
      <p id="Par24">We tested <italic>scruff</italic> on selected experiments from a publicly available scRNA-seq dataset [<xref ref-type="bibr" rid="CR23">23</xref>] generated using the CEL-Seq protocol. Raw FASTQ files containing reads from 1417 single cells across 15 experiments were processed using the scruff function. It generates the final SingleCellExperiment S4 object containing the transcript count matrix and all cell and gene annotations in one function call. On average, 79,509 reads are sequenced per cell (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) and 46.78% of reads aligned to GRCm38 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Cells in experiment mouse c library 2 have similar total number of reads compared with other experiments but significantly lower fraction of aligned reads (median is 4.41%). This is consistent with the mappability (5%) reported in the original study [<xref ref-type="bibr" rid="CR23">23</xref>]. 1342 cells had greater than 80% nonmitochondrial transcripts (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c) with the median fraction of mitochondrial transcripts at 5.93% indicating that the majority of cells were of high quality [<xref ref-type="bibr" rid="CR24">24</xref>].<fig id="Fig2"><label>Fig. 2</label><caption><p>Visualization of example data quality using <italic>scruff</italic>. These are boxplots with overlaid points showing <bold>(a)</bold> the total number of reads, <bold>(b)</bold> the fraction of aligned reads and <bold>(c)</bold> the fraction of mitochondrial transcripts for each experiment. Each point represents a well (unique cell barcode) and is colored by the number of cells sorted in the well by FACS. Each boxplot denotes a different experiment (i.e. plate)</p></caption><graphic xlink:href="12859_2019_2797_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par25"><italic>scruff</italic> package also provides functions to visualize gene isoforms and UMI tagged read alignments at specific genomic coordinates. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows an example of 125 reads mapped to mouse gene Fos in cell 30 of mouse b library 1. In this case, all of the reads mapped to the 3′ end of transcript Fos-201, indicating the mRNAs transcribed from this gene in this cell are from the isoform Fos-201. The fact that most of the reads are mapped to the 3′ end and forward strand demonstrates that reads sequenced by the CEL-Seq protocol are poly-A selected and maintain strand orientation [<xref ref-type="bibr" rid="CR12">12</xref>].<fig id="Fig3"><label>Fig. 3</label><caption><p>Read alignment visualization with UMI information. 125 reads were mapped to the gene <italic>Fos</italic> in cell 30 of mouse b library 1 from the example CEL-Seq dataset [<xref ref-type="bibr" rid="CR23">23</xref>]. Upper panel shows the visualization of read alignments. Reads are represented by arrows and are colored by their UMIs. The direction of the arrow represents the mapping strand of the read. Lower panel shows the visualization of gene isoforms. Gene isoforms are labeled by their transcript names. Grey rectangles represent exons</p></caption><graphic xlink:href="12859_2019_2797_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par26">We also applied the read alignment quality visualization function from the <italic>scruff</italic> package to the BAM files of 6 PBMC data downloaded from 10X Genomics website. The number of reads mapped to reference genome, the number of reads mapped to genes, and the fraction of gene reads out of mapped reads were plotted (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The mean number of aligned reads was 45,000, 92,000, and 56,000 for sequencing libraries prepared with the v1, v2, and v3 reagent kits, respectively. The total number of reads mapped to genes was significantly different between v1 and v2 (p &lt; 2.2 × 10<sup>−16</sup>, two-tailed <italic>t</italic>-test) and v2 and v3 (p &lt; 2.2 × 10<sup>−16</sup>, two-tailed <italic>t</italic>-test) chemistry methods. The proportions of reads mapped to genes were significantly different between v1 and v2 (p = 5.99 × 10<sup>−5</sup>, two-tailed <italic>t</italic>-test), v1 and v3 (p &lt; 2.2 × 10<sup>−16</sup>, two-tailed <italic>t</italic>-test), and v2 and v3 (p &lt; 2.2 × 10<sup>−16</sup>, two-tailed <italic>t</italic>-test) methods. The mean proportion of reads mapped to genes from 1 K and 10 K PBMC v3 chemistry data is 10.20% lower compared to v1 and v2 chemistry data (p &lt; 2.2 × 10<sup>−16</sup>, two-tailed <italic>t</italic>-test).<fig id="Fig4"><label>Fig. 4</label><caption><p>Read alignment quality metrics from 10X Genomics data. BAM files for 6 PBMC datasets were downloaded from 10X Genomics website and processed to obtain <bold>(a)</bold> the number of reads aligned to reference genome, <bold>(b)</bold> the number of reads mapped to genes, and <bold>(c)</bold> the fraction of reads mapped to genes out of total number of aligned reads</p></caption><graphic xlink:href="12859_2019_2797_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec9">
      <title>Package run time benchmark</title>
      <p id="Par27">We compared the speed of <italic>scruff</italic> to two other scRNA-seq preprocessing pipelines <italic>celseq2</italic> v0.5.3 [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] and <italic>scPipe</italic> 1.4.1 [<xref ref-type="bibr" rid="CR10">10</xref>]. FASTQ files from the example dataset [<xref ref-type="bibr" rid="CR23">23</xref>] were subsampled to have a total read number of 0.1, 0.5, 1.0, 5.0, and 10.0 million. Each of the subsampled datasets was processed by <italic>celseq2</italic>, <italic>scPipe</italic>, and <italic>scruff</italic> all using 16 cores to generate the count matrix. The aligners used are Bowtie2 for <italic>celseq2</italic> and Rsubread for <italic>scPipe</italic> and <italic>scruff</italic>. The benchmark job was run on a cluster node with 2 eight-core 2.6 GHz Intel Xeon E5–2670 CPUs and 256 GB memory. In terms of speed, <italic>scruff</italic> outperforms <italic>celseq2</italic> and <italic>scPipe</italic> for datasets of all sizes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). For the dataset with 10 million reads, <italic>scruff</italic> took 34.9 min to finish while <italic>celseq2</italic> and <italic>scPipe</italic> took 143.2 and 69.0 min, which corresponds to a 75.6 and 49.4% increase in speed compared to <italic>celseq2</italic> and <italic>scPipe</italic>.<fig id="Fig5"><label>Fig. 5</label><caption><p>Run time benchmarks for selected scRNA-seq preprocessing packages. FASTQ files from the example dataset [<xref ref-type="bibr" rid="CR23">23</xref>] were subsampled to have a total read number of 0.1, 0.5, 1.0, 5.0, and 10.0 million. Each of the subsampled datasets was processed by <italic>celseq2</italic>, <italic>scPipe</italic>, and <italic>scruff</italic>. All 3 packages were parallelized with 16 cores</p></caption><graphic xlink:href="12859_2019_2797_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Discussion</title>
    <p id="Par28">All three preprocessing functions (demultiplex, alignRsubread, and countUMI) in <italic>scruff</italic> are encapsulated in a single function called scruff to streamline the entire workflow. In terms of modular flexibility, the user has the ability to plug and play different methods to generate custom workflow. For example, instead of aligning the reads with Rsubread, users can run other aligners outside of R such as STAR or Bowtie on the demultiplexed FASTQ files. Because the UMI sequences are encoded in the read header in the demultiplexing step, the downstream UMI counting step can be applied to sequence alignment files generated by any alignment algorithms that do not modify the read headers containing the UMI tag.</p>
    <p id="Par29">For scRNA-seq studies, fast and intuitive assessment of read preprocessing quality across experiments and cells is necessary to ensure the validity of downstream data analysis. <italic>scruff</italic> provides more comprehensive quality metrics report and generates processed count data ready for downstream analysis in a much faster manner compared to other publicly available programs. It is a powerful pipeline for processing scRNA-seq FASTQ files generated by CEL-Seq and CEL-Seq2 protocols.</p>
  </sec>
  <sec id="Sec11">
    <title>Conclusions</title>
    <p id="Par30"><italic>scruff</italic> is an R/Bioconductor package that can preprocess scRNA-seq data including demultiplexing cell specific reads, aligning reads to a reference genome, counting the number of transcripts with UMI deduplication, and generating comprehensive plots for quality control across multiple batches or runs rapidly. Along with reporting gene expression count matrix as a tab delimited file, <italic>scruff</italic> also promotes data accessibility and portability by generating a SingleCellExperiment S4 object which can be passed directly to downstream scRNA-seq data analysis packages including <italic>celda</italic> [<xref ref-type="bibr" rid="CR26">26</xref>] and <italic>singleCellTK</italic> [<xref ref-type="bibr" rid="CR27">27</xref>]. <italic>scruff</italic> is modularized so users can plug and play different tools for performing alignments. Overall, <italic>scruff</italic> improves single-cell analysis by streamlining preprocessing and quality control workflows.</p>
  </sec>
  <sec id="Sec12">
    <title>Availability and requirements</title>
    <p id="Par31"><bold>Project name</bold>: <italic>scruff</italic></p>
    <p id="Par32"><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/scruff">http://bioconductor.org/packages/scruff</ext-link></p>
    <p id="Par33"><bold>Operating system</bold>: Linux, macOS, partially working on Microsoft Windows</p>
    <p id="Par34"><bold>Programming language</bold>: R</p>
    <p id="Par35"><bold>Other requirements</bold>: R &gt; = 3.5, Rsubread.</p>
    <p id="Par36"><bold>License</bold>: MIT License.</p>
    <p id="Par37"><bold>Any restrictions to use by non-academics</bold>: No restrictions.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BAM</term>
        <def>
          <p id="Par4">Binary Alignment Map</p>
        </def>
      </def-item>
      <def-item>
        <term>PBMC</term>
        <def>
          <p id="Par5">Peripheral Blood Mononuclear Cells</p>
        </def>
      </def-item>
      <def-item>
        <term>PCR</term>
        <def>
          <p id="Par6">Polymerase chain reaction</p>
        </def>
      </def-item>
      <def-item>
        <term>RT</term>
        <def>
          <p id="Par7">Reverse transcription</p>
        </def>
      </def-item>
      <def-item>
        <term>SAM</term>
        <def>
          <p id="Par8">Sequence Alignment Map</p>
        </def>
      </def-item>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par9">Single-cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>STAR</term>
        <def>
          <p id="Par10">Spliced Transcripts Alignment to a Reference</p>
        </def>
      </def-item>
      <def-item>
        <term>UMI</term>
        <def>
          <p id="Par11">Unique molecular identifier</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Marc Lenburg for helpful suggestions about the development of the package.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par38">This work was funded by LUNGevity Career Development Award (J.D.C.) and Informatics Technology for Cancer Research (ITCR) 1 U01 CA220413–01 (W.E.J.). The funding bodies played no role in the design of the study and collection, analysis or interpretation of data, nor in writing the manuscript.</p>
    </sec>
    <sec id="FPar2" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par39">The <italic>scruff</italic> package is available on Bioconductor (<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/scruff">http://bioconductor.org/packages/scruff</ext-link>) and on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/campbio/scruff">https://github.com/campbio/scruff</ext-link>). The CEL-Seq dataset analyzed in the study are available in the Gene Expression Omnibus repository with accession number GSE85755 [<xref ref-type="bibr" rid="CR23">23</xref>] (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE85755">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE85755</ext-link>). All PBMC BAM files are downloaded from 10X Genomics website (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>).</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>ZW developed the software package; collected, analyzed and interpreted data; and wrote the manuscript. JH assisted in the package’s development, data analysis and visualization. WEJ critically reviewed the manuscript. JDC conceived the project and wrote the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Barbacioru</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nordman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <issue>5</issue>
        <fpage>377</fpage>
        <lpage>382</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1315</pub-id>
        <?supplied-pmid 19349980?>
        <pub-id pub-id-type="pmid">19349980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GX</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Belgrader</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ryvkin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bent</surname>
            <given-names>ZW</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>14049</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id>
        <?supplied-pmid 28091601?>
        <pub-id pub-id-type="pmid">28091601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aird</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Danielsson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Russ</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analyzing and minimizing PCR amplification bias in Illumina sequencing libraries</article-title>
        <source>Genome Biol</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>R18</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2011-12-2-r18</pub-id>
        <?supplied-pmid 21338519?>
        <pub-id pub-id-type="pmid">21338519</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kivioja</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vaharautio</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Karlsson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bonke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Enge</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Linnarsson</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Counting absolute numbers of molecules using unique molecular identifiers</article-title>
        <source>Nat Methods</source>
        <year>2011</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>72</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1778</pub-id>
        <?supplied-pmid 22101854?>
        <pub-id pub-id-type="pmid">22101854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Islam</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joost</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zajac</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kasper</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>2</issue>
        <fpage>163</fpage>
        <lpage>166</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2772</pub-id>
        <?supplied-pmid 24363023?>
        <pub-id pub-id-type="pmid">24363023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hashimshony</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Senderovich</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Avital</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Klochendler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>de Leeuw</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Anavy</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CEL-Seq2: sensitive highly-multiplexed single-cell RNA-Seq</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>77</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0938-8</pub-id>
        <?supplied-pmid 27121950?>
        <pub-id pub-id-type="pmid">27121950</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Ly</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>Miragaia</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Labalette</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Macaulay</surname>
            <given-names>IC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Power analysis of single-cell RNA-sequencing experiments</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>381</fpage>
        <lpage>387</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4220</pub-id>
        <?supplied-pmid 28263961?>
        <pub-id pub-id-type="pmid">28263961</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Heger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sudbery</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>UMI-tools: modeling sequencing errors in unique molecular identifiers to improve quantification accuracy</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>3</issue>
        <fpage>491</fpage>
        <lpage>499</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.209601.116</pub-id>
        <?supplied-pmid 28100584?>
        <pub-id pub-id-type="pmid">28100584</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parekh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ziegenhain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vieth</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Enard</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hellmann</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>zUMIs - a fast and flexible pipeline to process RNA sequencing data with UMIs</article-title>
        <source>Gigascience.</source>
        <year>2018</year>
        <volume>7</volume>
        <issue>6</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giy059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Amann-Zalcenstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Biben</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Seidi</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>scPipe: a flexible R/Bioconductor preprocessing pipeline for single-cell RNA-sequencing data</article-title>
        <source>PLoS Comput Biol</source>
        <year>2018</year>
        <volume>14</volume>
        <issue>8</issue>
        <fpage>e1006361</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006361</pub-id>
        <?supplied-pmid 30096152?>
        <pub-id pub-id-type="pmid">30096152</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <source>R: a language and environment for statistical computing</source>
        <year>2018</year>
        <publisher-loc>Vienna</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hashimshony</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sher</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Yanai</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>CEL-Seq: single-cell RNA-Seq by multiplexed linear amplification</article-title>
        <source>Cell Rep</source>
        <year>2012</year>
        <volume>2</volume>
        <issue>3</issue>
        <fpage>666</fpage>
        <lpage>673</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2012.08.003</pub-id>
        <?supplied-pmid 22939981?>
        <pub-id pub-id-type="pmid">22939981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Dharmadhikari</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grun</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Groen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dielen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptome atlas of the human pancreas</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>385</fpage>
        <lpage>394</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.09.002</pub-id>
        <?supplied-pmid 27693023?>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hillier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wendl</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Base-calling of automated sequencer traces using phred. I. Accuracy assessment</article-title>
        <source>Genome Res</source>
        <year>1998</year>
        <volume>8</volume>
        <issue>3</issue>
        <fpage>175</fpage>
        <lpage>185</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.8.3.175</pub-id>
        <?supplied-pmid 9521921?>
        <pub-id pub-id-type="pmid">9521921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Base-calling of automated sequencer traces using phred. II. Error probabilities</article-title>
        <source>Genome Res</source>
        <year>1998</year>
        <volume>8</volume>
        <issue>3</issue>
        <fpage>186</fpage>
        <lpage>194</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.8.3.186</pub-id>
        <?supplied-pmid 9521922?>
        <pub-id pub-id-type="pmid">9521922</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Morgan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Obenchain</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Lang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>BiocParallel</surname>
            <given-names>TN</given-names>
          </name>
        </person-group>
        <source>Bioconductor facilities for parallel evaluation</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>SingleCellExperiment: S4 classes for single cell data</source>
        <year>2017</year>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>The subread aligner: fast, accurate and scalable read mapping by seed-and-vote</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>10</issue>
        <fpage>e108</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt214</pub-id>
        <?supplied-pmid 23558742?>
        <pub-id pub-id-type="pmid">23558742</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Liao Y, Smyth GK, Shi W. Rsubread: Subread sequence alignment and counting for R. R package version 1.32.4. 2019.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>
        <source>Bioinformatics.</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>7</issue>
        <fpage>923</fpage>
        <lpage>930</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt656</pub-id>
        <?supplied-pmid 24227677?>
        <pub-id pub-id-type="pmid">24227677</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Pages</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aboyoun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Software for computing and annotating genomic ranges</article-title>
        <source>PLoS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <issue>8</issue>
        <fpage>e1003118</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003118</pub-id>
        <?supplied-pmid 23950696?>
        <pub-id pub-id-type="pmid">23950696</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Ggbio: an R package for extending the grammar of graphics for genomic data</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>8</issue>
        <fpage>R77</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-8-r77</pub-id>
        <?supplied-pmid 22937822?>
        <pub-id pub-id-type="pmid">22937822</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van den Brink</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Sage</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vertesy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Spanjaard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Peterson-Maduro</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Baron</surname>
            <given-names>CS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell sequencing reveals dissociation-induced gene expression in tissue subpopulations</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>10</issue>
        <fpage>935</fpage>
        <lpage>936</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4437</pub-id>
        <?supplied-pmid 28960196?>
        <pub-id pub-id-type="pmid">28960196</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ilicic</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Kolodziejczyk</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Bagger</surname>
            <given-names>FO</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Classification of low quality cells from single-cell RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>29</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0888-1</pub-id>
        <?supplied-pmid 26887813?>
        <pub-id pub-id-type="pmid">26887813</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Yun</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <source>celseq2: A Python framework for generating UMI count matrix from CEL-Seq2 sequencing data</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Corbett</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Koga</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Duclos</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Celda: bi-clustering of transcriptional states and cellular populations in discrete single-cell RNA-seq data</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Jenkins DF, Faits T, Khan MM, Briars E, Pro SC, Johnson WE. singleCellTK: Interactive analysis of single cell RNA-seq data. R package version 1.2.3. 2019.</mixed-citation>
    </ref>
  </ref-list>
</back>
