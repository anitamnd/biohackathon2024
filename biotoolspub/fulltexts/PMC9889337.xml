<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9889337</article-id>
    <article-id pub-id-type="pmid">36720887</article-id>
    <article-id pub-id-type="publisher-id">35945</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-023-35945-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ViralCC retrieves complete viral genomes and virus-host pairs from metagenomic Hi-C data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0568-3838</contrib-id>
        <name>
          <surname>Du</surname>
          <given-names>Yuxuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2361-1985</contrib-id>
        <name>
          <surname>Fuhrman</surname>
          <given-names>Jed A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8552-043X</contrib-id>
        <name>
          <surname>Sun</surname>
          <given-names>Fengzhu</given-names>
        </name>
        <address>
          <email>fsun@usc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.42505.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2156 6853</institution-id><institution>Department of Quantitative and Computational Biology, </institution><institution>University of Southern California, </institution></institution-wrap>Los Angeles, CA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.42505.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2156 6853</institution-id><institution>Department of Biological Sciences, </institution><institution>University of Southern California, </institution></institution-wrap>Los Angeles, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>31</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>31</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>502</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>1</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The introduction of high-throughput chromosome conformation capture (Hi-C) into metagenomics enables reconstructing high-quality metagenome-assembled genomes (MAGs) from microbial communities. Despite recent advances in recovering eukaryotic, bacterial, and archaeal genomes using Hi-C contact maps, few of Hi-C-based methods are designed to retrieve viral genomes. Here we introduce ViralCC, a publicly available tool to recover complete viral genomes and detect virus-host pairs using Hi-C data. Compared to other Hi-C-based methods, ViralCC leverages the virus-host proximity structure as a complementary information source for the Hi-C interactions. Using mock and real metagenomic Hi-C datasets from several different microbial ecosystems, including the human gut, cow fecal, and wastewater, we demonstrate that ViralCC outperforms existing Hi-C-based binning methods as well as state-of-the-art tools specifically dedicated to metagenomic viral binning. ViralCC can also reveal the taxonomic structure of viruses and virus-host pairs in microbial communities. When applied to a real wastewater metagenomic Hi-C dataset, ViralCC constructs a phage-host network, which is further validated using CRISPR spacer analyses. ViralCC is an open-source pipeline available at <ext-link ext-link-type="uri" xlink:href="https://github.com/dyxstat/ViralCC">https://github.com/dyxstat/ViralCC</ext-link>.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Metagenomic Hi-C enables genome retrieval in microbial samples. Here, the authors develop an integrative method to recover complete viral genomes and detect virus-host pairs using metagenomic Hi-C data.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Metagenomics</kwd>
      <kwd>Computational models</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000002</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM120624</award-id>
        <award-id>R01GM131407</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sun</surname>
            <given-names>Fengzhu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000076</institution-id>
            <institution>NSF | Directorate for Biological Sciences (BIO)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>EF-2125142</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sun</surname>
            <given-names>Fengzhu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Viruses constitute the most divergent and ubiquitous biological organism on earth with an estimated global abundance of 10<sup>31</sup>
<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Viruses have enormous impacts on ecosystems as predators and/or parasites within microbial communities through the lysogenic or lytic cycle infecting bacteria and archaea<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref></sup>. For instance, viruses contribute significantly to the biogeochemical cycling of carbon and nitrogen in aquatic habitats<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup> and are implicated in certain diseases such as inflammatory bowel disease and severe acute malnutrition in human systems<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. Therefore, the interest in viromics has risen dramatically in the past two decades.</p>
    <p id="Par4">Since the number of viruses that can be traditionally cultivated in the laboratory is too limited to assess viral diversity<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, metagenomics, as a culture-independent sampling strategy, has been widely exploited to recover viral genomes and to identify the hosts of these newly discovered viruses, one of the most difficult aspects of studying viruses in microbial communities<sup><xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>. Metagenomic whole genome shotgun sequencing (WGS) directly extracts genomic fragments from various environmental samples, generating a large number of short reads that are subsequently assembled into contigs<sup><xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref></sup>. Metagenomic viral contigs are then identified from large assemblies based on sequence composition, sequence similarity, and/or detection of viral proteins<sup><xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR17">17</xref></sup>. However, viral genome assembly from shotgun reads is challenging<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> and short viral contigs may only represent segments of entire viral genomes<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. Incomplete viral fragments have a significantly adverse impact on the downstream analyses, including the characterization of the underlying viral diversity and abundance, prediction of host and functional capacity<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup>. Therefore, metagenomic viral binning, defined as a process to group viral contigs from the same species into viral metagenome-assembled genomes (vMAGs), is valuable, especially for giant viruses<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>.</p>
    <p id="Par5">Most of traditional shotgun-based binning tools are developed to recover eukaryotic, bacterial, and archaeal genomes<sup><xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR26">26</xref></sup> and ignore the challenges associated with viruses, such as the lack of universal single-copy genes and relatively small size of viral genomes. Additionally, those binning tools exploiting microbial marker gene analysis are not applicable for viruses<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR27">27</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup>. CoCoNet<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> and vRhyme<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> are two existing methods specifically dedicated to metagenomic viral binning. CoCoNet trains a neural network using both composition and co-occurrence features of viral contigs across samples to predict the probability that two viral contigs originate from the same genome. vRhyme utilizes single- or multisample coverage effect size comparisons to calculate coverage differences between viral contigs. To process the sequence composition information, vRhyme first pretrains supervised machine-learning-based classification models using genome fragments. Then, the nucleotide feature similarity vector between two viral contigs is input into the classification models to predict the probability value that viral contigs originate from the same genome. Finally, vRhyme constructs a weighted network, where each node is a viral contig and an edge weight is calculated by dividing the coverage difference by the probability value. Networks are further refined into vMAGs. However, both CoCoNet and vRhyme may be critically impaired when there are not enough samples to construct reliable co-abundance profiles of viral contigs, i.e., profiles showing which contigs share consistent abundance values across multiple samples and are therefore likely to come from the same genome.</p>
    <p id="Par6">Metagenomic high-throughput chromosome conformation capture (metagenomic Hi-C) has been developed in recent years to simultaneously recover metagenome-assembled genomes (MAGs) and determine virus-host pairs from a single microbial community sample<sup><xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR37">37</xref></sup>. Combined with the conventional shotgun sequencing, metagenomic Hi-C applies a genomic proximity ligation technique to construct chimeric junctions between metagenomic sequences in close proximity within the same cell. After sequencing, millions of Hi-C read pairs are generated and subsequently aligned to contigs assembled from the shotgun reads. Contigs belonging to the same genome display enriched Hi-C contact frequencies compared to those from different genomes<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, resulting in dozens of nearly complete bacterial genomes retrieved by publicly available Hi-C-based binning tools, such as MetaTOR, bin3C, and HiCBin<sup><xref ref-type="bibr" rid="CR38">38</xref>–<xref ref-type="bibr" rid="CR40">40</xref></sup>. Although recovering high-quality viral genomes is vital and prerequisite for downstream analyses, apart from a proprietary and commercial genome reconstruction service called ProxiPhage<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, Hi-C-based binning methods with open-source pipelines are not developed to retrieve viral genomes. For example, HiCBin requires the taxonomic annotation of some contigs by TAXAassign (<ext-link ext-link-type="uri" xlink:href="https://github.com/umerijaz/TAXAassign">https://github.com/umerijaz/TAXAassign</ext-link>) to generate the intra-species contacts in the normalization step<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> while TAXAassign can hardly annotate viral contigs, resulting in the inability of HiCBin to bin viral contigs.</p>
    <p id="Par7">In addition to the difficulties in recovering vMAGs, tools for benchmarking the performance of viral genome retrieval remains rare in metagenomic Hi-C experiments. CheckV has been widely used to estimate the completeness of vMAGs by comparing them to a large database curated from NCBI GenBank and environmental samples<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. However, unlike the CheckM which takes advantage of universal single-copy marker genes to assess both completeness and contamination of prokaryotic MAGs<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, CheckV is unable to estimate the contamination of vMAGs since there is no such marker gene set available for viruses<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. CheckV is also limited in its ability to assess the completion of vMAGs since randomly grouping two viral contigs together generally increases completion. Moreover, though methods based on simulating known viral contigs from NCBI RefSeq viral genomes<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> have already been employed to estimate the binning results of shotgun-based methods<sup><xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR30">30</xref></sup>, they cannot be generalized to evaluate Hi-C-based binning approaches since few studies have been conducted on modeling Hi-C interactions for viral contigs. Therefore, it is imperative to design a systematic and comprehensive benchmarking strategy for Hi-C-based metagenomic viral binning.</p>
    <p id="Par8">To tackle the problem of a paucity of viral binning methods in metagenomic Hi-C experiments, we developed ViralCC, a Hi-C-based binning method dedicated to recovering complete viral genomes and determining virus-host pairs. The general pipeline of ViralCC is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. ViralCC not only considers the Hi-C interaction graph, but also puts forward a host proximity graph of viral contigs as a complementary source of information to the Hi-C interaction map. Two graphs are then integrated together, followed by Leiden graph clustering<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>, to generate draft viral genomes. We compared ViralCC to VAMB<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, CoCoNet<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, vRhyme<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, MetaTOR<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>, and bin3C<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. Our experiments indicated that ViralCC substantially improved the CheckV completeness of viral genomic bins on real metagenomic Hi-C datasets. Moreover, we put forward a systematic strategy to benchmark the viral genome retrieval performance in metagenomic Hi-C experiments by generating mock metagenomic Hi-C datasets from real samples. The ground truth of all mock viral contigs is known in mock datasets while Hi-C interactions between mock viral contigs can be obtained directly from real samples without simulation. Leveraging mock metagenomic Hi-C datasets derived from three real samples, we further demonstrated that ViralCC outperformed other binning methods and recovered viral genomes with higher completeness and lower contamination. Finally, we showed that the virus-host pairs can be determined based on the recovered viral genomes.<fig id="Fig1"><label>Fig. 1</label><caption><title>Overview of the ViralCC pipeline.</title><p>The general workflow of ViralCC to retrieve high-quality viral genomes and determine virus-host pairs. Shotgun reads are first assembled into contigs, to which Hi-C paired-end reads are aligned. Viral contigs are subsequently identified. Leveraging Hi-C linkages and the virus-host proximity structure to link viral contigs, ViralCC constructs the Hi-C interaction graph and the host proximity graph. After integrating two graphs, ViralCC employs Leiden clustering to reconstruct draft viral genomes, and additionally detects the virus-host pairs based on recovered viral genomes and Hi-C linkages.</p></caption><graphic xlink:href="41467_2023_35945_Fig1_HTML" id="d32e466"/></fig></p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Generating mock metagenomic Hi-C datasets for benchmarking</title>
      <p id="Par9">All viral contigs detected by VirSorter were assessed by CheckV to select single contigs with high completeness as putative reference genomes. As a result, 51 putative reference genomes, with length ranging from 11,410 bp to 194,784 bp were generated from the human dataset; 11 putative reference genomes from 11,452 bp to 42,000 bp were obtained from the cow fecal dataset; and 17 putative reference genomes, ranging from 11,455 bp to 127,910 bp were derived from the wastewater dataset (Supplementary Table <xref rid="MOESM1" ref-type="media">1)</xref>.</p>
      <p id="Par10">We then constructed mock viral contigs by splitting the putative viral genomes and obtained 1010, 94, and 279 fragmented mock viral contigs from the three datasets, respectively (Supplementary Table <xref rid="MOESM1" ref-type="media">1)</xref>. For each real metagenomic Hi-C dataset, mock viral contigs were mixed with all non-viral contigs (i.e., contigs that are not identified as viral contigs by VirSorter), followed by the alignment of Hi-C paired-end reads to construct the mock metagenomic Hi-C dataset. The analyses of binning mock viral contigs on the mock human gut dataset were presented in the main text. We also provided benchmarking results on the mock wastewater and the mock cow fecal datasets in the Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec4">
      <title>Integrating the Hi-C interaction graph and the host proximity graph improves binning performance on the mock human gut dataset</title>
      <p id="Par11">We first constructed the Hi-C interaction graph <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{hic}}}}}}}}}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq1.gif"/></alternatives></inline-formula> and the host proximity graph <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq2.gif"/></alternatives></inline-formula> for 1010 mock viral contigs from the mock human gut dataset. There are 2699 edges in <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{hic}}}}}}}}}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq3.gif"/></alternatives></inline-formula>. The parameter <italic>k</italic> for <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq4.gif"/></alternatives></inline-formula> was tuned to be 30, which means that any two viral contig nodes with an edge in <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq5.gif"/></alternatives></inline-formula> were linked to at least the same 30 host contigs by the Hi-C interaction. This resulted in 2698 edges in <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq6.gif"/></alternatives></inline-formula>. Among these 2698 edges in <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq7.gif"/></alternatives></inline-formula>, 14.5% of the edges were spurious edges, which were defined as the edges that linked two contigs from different putative reference genomes in <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq8.gif"/></alternatives></inline-formula>. We then integrated <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{hic}}}}}}}}}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq10.gif"/></alternatives></inline-formula> into <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{int}}}}}}}}}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">int</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq11.gif"/></alternatives></inline-formula>, which contained 4397 edges. We could observe 1000 common edges between <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{hic}}}}}}}}}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq13.gif"/></alternatives></inline-formula>, accounting for around 37% of the total number of edges in either graph.</p>
      <p id="Par12">We applied the Leiden clustering on <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{hic}}}}}}}}}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq14.gif"/></alternatives></inline-formula>, <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq15.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{int}}}}}}}}}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">int</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq16.gif"/></alternatives></inline-formula>, respectively, and assessed the binning results using four clustering metrics: F-score, ARI, NMI, and homogeneity (Supplementary Table <xref rid="MOESM1" ref-type="media">2)</xref>. <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{int}}}}}}}}}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">int</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq17.gif"/></alternatives></inline-formula> outperformed both <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{hic}}}}}}}}}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq18.gif"/></alternatives></inline-formula> and <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq19.gif"/></alternatives></inline-formula> in terms of all four clustering metrics. We also evaluated the completeness and contamination of each vMAG (Supplementary Table <xref rid="MOESM1" ref-type="media">3)</xref>. Specifically, 8 near-complete, 3 substantially complete, and 5 moderately complete vMAGs were recovered based only on <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{hic}}}}}}}}}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq20.gif"/></alternatives></inline-formula>, while 12 near-complete and 2 substantially complete vMAGs were retrieved based only on <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq21.gif"/></alternatives></inline-formula>. In contrast, employing the integrative graph <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{int}}}}}}}}}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">int</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq22.gif"/></alternatives></inline-formula> for clustering could reconstruct 26 near-complete, 2 substantially complete, and 4 moderately complete vMAGs. The improvement of binning performance by integrating two graphs indicated the Hi-C interaction graph and the host proximity graph were complementary to each other on binning viral contigs.</p>
    </sec>
    <sec id="Sec5">
      <title>ViralCC outperforms other binning methods on the mock human gut dataset</title>
      <p id="Par13">ViralCC was compared to VAMB, CoCoNet, vRhyme, bin3C, and MetaTOR on the mock human gut dataset (see Methods). VAMB is a general shotgun-based binning tool while bin3C and MetaTOR are general Hi-C-based binning pipelines. CoCoNet and vRhyme are two shotgun-based binning methods specifically designed for clustering sequenced viral particles.</p>
      <p id="Par14">As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, VAMB, CoCoNet, vRhyme, bin3C, and MetaTOR achieved 0.198, 0.485, 0.366, 0.404, and 0.750 in terms of F-score, respectively, which was improved to 0.795 by ViralCC. The ARI scores for viral bins produced by VAMB, CoCoNet, vRhyme, bin3C, and MetaTOR were 0.111, 0.471, 0.302, 0.274, and 0.744. In contrast, ViralCC increased the ARI score to 0.787. As for the NMI, VAMB, CoCoNet, vRhyme, bin3C, and MetaTOR obtained 0.724, 0.742, 0.782, 0.817, and 0.928, whereas ViralCC achieved a score of 0.929. ViralCC also improved the homogeneity score to 0.921 from 0.570, 0.723, 0.687, 0.691, and 0.911, achieved by VAMB, CoCoNet, vRhyme, bin3C, and MetaTOR, respectively.<fig id="Fig2"><label>Fig. 2</label><caption><title>ViralCC outperforms other binning methods on the mock human gut dataset.</title><p>Comparison of viral genome retrieval performance according to (<bold>a</bold>) clustering metrics and (<bold>b</bold>) completeness and contamination criteria (Moderately complete: 50% ≤ completeness &lt;70%, contamination ≤ 10%; Substantially complete: 70% ≤ completeness &lt;90%, contamination ≤ 10%; Near-complete: completeness ≥ 90%, contamination ≤ 10%). ViralCC outperforms other binning methods on the mock human gut dataset. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_35945_Fig2_HTML" id="d32e861"/></fig></p>
      <p id="Par15">VAMB, CoCoNet, vRhyme, bin3C, and MetaTOR could recover 1, 5, 0, 5, and 22 near-complete vMAGs, respectively, while ViralCC increased this number to 26 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). In total, ViralCC could retrieve 32 high-quality vMAGs out of 51 reference genomes whereas VAMB, CoCoNet, vRhyme, bin3C, and MetaTOR could reconstruct 7, 11, 7, 6, and 30 high-quality vMAGs, respectively. Moreover, we also found that ViralCC had a better performance than other binners in recovering near-complete vMAGs from large putative viral genomes (Supplementary Note <xref rid="MOESM1" ref-type="media">2)</xref>. Altogether, ViralCC outperformed other binning methods as it recovered viral genomes with higher completeness and lower contamination based on the mock metagenomic Hi-C dataset. Notably, MetaTOR and ViralCC were comparable according to the NMI and the homogeneity scores, indicating that both approaches could recover high-purity viral contig bins. On the other hand, ViralCC achieved better performance than MetaTOR in terms of F-score and ARI (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) while retrieving more complete bins (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) from the mock metagenomic Hi-C dataset. This shows the effectiveness of combining host proximity information with Hi-C interaction information.</p>
    </sec>
    <sec id="Sec6">
      <title>Binning analyses of viral contigs on three real metagenomic Hi-C datasets</title>
      <p id="Par16">VirSorter detected 791, 1338, and 2757 viral contigs from the human gut, cow fecal, and wastewater samples, respectively. Viral contigs were binned using different methods for the three datasets. The CheckV completeness of viral bins was estimated to evaluate the binning quality. We referred to viral bins with CheckV completeness above 90% as draft viral genomes with high completion and denoted bins with CheckV completeness above 50% as draft viral genomes with medium completion.</p>
      <p id="Par17">For the human gut dataset, ViralCC identified 465 viral bins with sizes ranging from 3001 bp to 307,395 bp, and yielded more high and medium-completion draft viral genomes than any other tested methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). For the cow fecal dataset, ViralCC constructed 574 viral bins with sizes ranging from 3002 bp to 157,462 bp. It generated substantially more medium and high-completion draft viral genomes than other methods, specifically exceeding the numbers of high-completion draft genomes from VAMB, CoCoNet, vRhyme, bin3C, and MetaTOR by 161%, 140%, 66.7%, 93.5%, and 62.1%, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). From the wastewater dataset, ViralCC established 1240 viral bins with sizes ranging from 3006 bp to 461,626 bp, and could reconstruct 32.8%, 103%, 141%, 175%, and 75% more high completion draft genomes compared with VAMB, CoCoNet, vRhyme, bin3C, and MetaTOR, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). ViralCC also recovered markedly more draft viral genomes with medium completion.<fig id="Fig3"><label>Fig. 3</label><caption><title>ViralCC outperforms other binners on real metagenomic Hi-C datasets.</title><p>Comparison of draft viral bins retrieved by different binning tools according to the CheckV completeness standard on the (<bold>a</bold>) human gut, (<bold>b</bold>) cow fecal, and (<bold>c</bold>) wastewater datasets. ViralCC can retrieve more complete viral genomes compared to VAMB, CoCoNet, vRhyme, bin3C, and MetaTOR from all three real metagenomic Hi-C samples. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_35945_Fig3_HTML" id="d32e911"/></fig></p>
      <p id="Par18">Altogether, the analyses of three real metagenomic Hi-C datasets demonstrated that ViralCC retrieved more complete viral genomes compared to VAMB, CoCoNet, vRhyme, bin3C, and MetaTOR, which was consistent with our observations from the mock metagenomic Hi-C datasets. We also constructed a random binning model based on the configuration random graph<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> as control experiments (Supplementary Note <xref rid="MOESM1" ref-type="media">3)</xref>. The model randomly assigned edges to match the degree sequence of viral contigs in the integrative graph. ViralCC outperformed the random control according to the CheckV completeness criteria. Moreover, we sorted vMAGs by the number of viral contigs in descending order. If multiple vMAGs contained the same number of viral contigs, they were further sorted by the bin size in descending order. Contigs in each vMAG were also sorted by the contig length in descending order. We then plotted the raw Hi-C contact maps (see Methods) of the top ten vMAGs for the three datasets with either the contig index (Fig. <xref rid="Fig4" ref-type="fig">4</xref>) or the contig size (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1)</xref> as the axis unit, respectively, which confirmed the valid reconstruction of the viral genomes. The specific number of viral contigs and the bin size of these vMAGs are shown in Supplementary Tables <xref rid="MOESM1" ref-type="media">4</xref> to <xref rid="MOESM1" ref-type="media">6</xref>.<fig id="Fig4"><label>Fig. 4</label><caption><title>Heatmaps of raw Hi-C contact matrices of the top ten vMAGs from real metagenomic Hi-C datasets.</title><p>Heatmaps of raw Hi-C contact matrices of the top ten vMAGs from the (<bold>a</bold>) human gut, (<bold>b</bold>) cow fecal, and (<bold>c</bold>) wastewater datasets with the contig index as the axis unit. The vMAGs were first ranked by their numbers of contigs and then the contigs within each vMAG were ranked by their sizes. The scale bar shows the number of raw Hi-C contacts between viral contigs.</p></caption><graphic xlink:href="41467_2023_35945_Fig4_HTML" id="d32e953"/></fig></p>
      <p id="Par19">Finally, we explored the relationships between the quality of Hi-C datasets and the vMAG retrieval performance. The 3D ratio and the qc3C CI were employed to measure the quality of Hi-C datasets (see Methods). Specifically, the 3D ratios were 23.3%, 38.3%, and 54.9% for the human gut, cow fecal, and wastewater datasets, respectively (Supplementary Table <xref rid="MOESM1" ref-type="media">7)</xref>. The midpoints of the qc3C CI for the three datasets were 5.938%, 52.07%, and 30.66%, respectively (Supplementary Table <xref rid="MOESM1" ref-type="media">7)</xref>. Though the higher 3D ratio does not necessarily mean more informative linkages between contigs<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, we still observed that compared to the traditional shotgun-based binning methods, the improvement of binning performance by ViralCC was remarkable on metagenomic datasets with high-quality Hi-C libraries.</p>
    </sec>
    <sec id="Sec7">
      <title>Annotation of vMAGs demonstrated the high purity of the vMAGs at the family level</title>
      <p id="Par20">We annotated 191, 320, and 693 vMAGs in total at the family level for the human gut, cow fecal, and wastewater datasets, respectively. We found that 173 (90.6%) out of 191 vMAGs in the human gut sample, 265 (82.8%) out of 320 vMAGs in the cow fecal sample, and 592 (85.4%) out of 693 vMAGs in the wastewater sample contained only viral contigs from the same family, demonstrating the high purity of vMAGs at the family level.</p>
      <p id="Par21">As shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the vMAGs were dominated by tailed bacteriophages of the order <italic>Caudovirales</italic> and vMAGs belonging to the families <italic>Myoviridae</italic>, <italic>Siphoviridae</italic>, and <italic>Podoviridae</italic> were found in all three samples<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. Bacteriophages, mainly <italic>Siphoviridae</italic>, dominated the two gut samples<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>. Compared to the other samples that were more dominated by <italic>Siphoviridae</italic>, <italic>Myoviridae</italic> and <italic>Siphoviridae</italic> vMAGs were of similar abundance in the wastewater sample, as reported for water environments<sup><xref ref-type="bibr" rid="CR50">50</xref>–<xref ref-type="bibr" rid="CR53">53</xref></sup>.<fig id="Fig5"><label>Fig. 5</label><caption><title>Taxonomy statistics of annotated vMAGs from real metagenomic Hi-C datasets.</title><p>Taxonomy statistics of annotated vMAGs on the (<bold>a</bold>) human gut, (<bold>b</bold>) cow fecal, and (<bold>c</bold>) wastewater datasets. The numbers on the graph indicate the number of vMAGs belonging to different families. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_35945_Fig5_HTML" id="d32e1036"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Phage-host network in the wastewater sample</title>
      <p id="Par22">We discovered virus-host pairs based on the vMAGs recovered by ViralCC, and showed the results from the wastewater dataset in the main text below. The results of virus-host detection from the human gut and cow fecal datasets are shown in the Supplementary Notes <xref rid="MOESM1" ref-type="media">4</xref> and <xref rid="MOESM1" ref-type="media">5</xref>.</p>
      <p id="Par23">For non-viral contigs, expected to be largely bacterial, HiCBin generated 1253 MAGs, which were assessed by CheckM (v1.1.3, parameter: lineage wf)<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. The quality evaluation results are shown in Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>. Among 1253 MAGs, 600 MAGs could be unambiguously annotated by GTDB-TK<sup><xref ref-type="bibr" rid="CR54">54</xref></sup> and the taxonomy classification results were visualized using ITOL<sup><xref ref-type="bibr" rid="CR55">55</xref></sup> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). <italic>Burkholderiales</italic>, <italic>Pseudomonadales</italic>, <italic>Lachnospirales</italic>, <italic>Bacteroidales</italic>, and <italic>Oscillospirales</italic> were the predominant orders in the wastewater sample. <italic>Burkholderiales</italic> and <italic>Pseudomonadales</italic> were common orders reported in water environments<sup><xref ref-type="bibr" rid="CR56">56</xref>,<xref ref-type="bibr" rid="CR57">57</xref></sup>. <italic>Lachnospirales</italic>, <italic>Bacteroidales</italic>, and <italic>Oscillospirales</italic> were reported in the gut microbiomes<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>; these are reasonable to be detected in this domestic wastewater sample from around 25,000 people<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>.<fig id="Fig6"><label>Fig. 6</label><caption><title>Taxonomic annotations of MAGs and the apparent infection spectrum of vMAGs from the domestic wastewater sample.</title><p>(<bold>a</bold>) Taxonomic annotations of MAGs recovered by HiCBin from the domestic wastewater sample. <italic>Burkholderiales</italic>, <italic>Pseudomonadales</italic>, <italic>Lachnospirales</italic>, <italic>Bacteroidales</italic>, and <italic>Oscillospirales</italic> were the predominant orders. (<bold>b</bold>) The apparent infection spectrum of vMAGs from the wastewater sample. vMAGs belonging to the family <italic>Myoviridae</italic> mainly targeted hosts from the order <italic>Burkholderiales</italic> and a large number of vMAGs from the family <italic>Siphoviridae</italic> could infect <italic>Bacteroidales</italic> bacteria. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_35945_Fig6_HTML" id="d32e1160"/></fig></p>
      <p id="Par24">A total of 1065 (85%) out of 1253 MAGs were associated with at least one viral MAG. We then explored the infection spectrum of annotated vMAGs on hosts from different orders (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b). We observed that vMAGs from the family <italic>Myoviridae</italic> mainly targeted hosts from the order <italic>Burkholderiales</italic>, which is consistent with previous findings that some phages belonging to the family <italic>Myoviridae</italic> could lyse bacteria from <italic>Burkholderia</italic><sup><xref ref-type="bibr" rid="CR59">59</xref></sup>. A large number of vMAGs belonging to the family <italic>Siphoviridae</italic> could infect <italic>Bacteroidales</italic> bacteria<sup><xref ref-type="bibr" rid="CR60">60</xref></sup>. Moreover, we unexpectedly observed that 4 vMAGs apparently infecting members of the order <italic>Burkholderiales</italic> came from the family <italic>Herpesviridae</italic>, which previously has been reported only to infect animals, including human-beings<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>. Further research is needed to determine if these reveal a true infection or if the proximity ligation occurred in a non-infection situation (e.g. extracellularly).</p>
    </sec>
    <sec id="Sec9">
      <title>Validate virus-host pairs using CRISPR spacer analysis on the wastewater dataset</title>
      <p id="Par25">We predicted the CRISPR spacers in host MAGs using PILER-CR (v1.06)<sup><xref ref-type="bibr" rid="CR62">62</xref></sup> and 925 CRISPR spacers were detected. Then, we aligned these spacers to vMAGs using BLAST<sup><xref ref-type="bibr" rid="CR63">63</xref></sup> with parameters ‘-task blastn-short -evalue 1e-5’. The alignments with bitscore below 45 were further filtered out<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. In this way, 16 robust hits between host MAGs and virus MAGs were found using CRISPR spacer analysis.</p>
      <p id="Par26">Among those 16 hits, 13 virus-host MAG pairs (81.3%) were also associated by the Hi-C linkages. Noticeably, according to CRISPR spacer analysis, we observed that vMAG 1198 (family: <italic>Siphoviridae</italic>) was associated with two host MAGs from the <italic>Fusobacteriales</italic> order while these two host MAGs were the only two associated hosts of vMAG 1198 predicted by the Hi-C interactions.</p>
    </sec>
    <sec id="Sec10">
      <title>Running time of ViralCC</title>
      <p id="Par27">ViralCC was executed on one computing node of a 2.40 GHz Intel Xeon Processor E5-2665 with 50,000 MB RAM provided by the Advanced Research Computing platform at University of Southern California. ViralCC consumed 22.5 min, 76.6 min, and 21.7 min running time on the human gut, cow fecal, and wastewater samples, respectively.</p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par28">ViralCC is an open-source Hi-C-based binning method for viral genome retrieval. Unlike other Hi-C-based binning tools using only Hi-C contact maps. ViralCC exploits a host proximity graph based on the virus-host proximity structure as a supplementary source of connections between viral contigs. We demonstrate that ViralCC outperformed other tools on real metagenomic Hi-C datasets according to the CheckV completeness criteria. Notably, considering that randomly binning viral contigs into vMAG does not reduce the CheckV completeness compared to the completeness of each of the individual contigs, it is necessary to construct a random binning model as control experiments when the CheckV completeness is used as the evaluation metric. Moreover, we observe that the improvement of binning performance by ViralCC was significant from metagenomic datasets with high-quality Hi-C libraries compared to the shotgun-based binning methods, indicating the potential importance of good-quality Hi-C libraries on viral genome retrieval.</p>
    <p id="Par29">Since the assessment by CheckV software is not comprehensive, we put forward a systematic benchmarking strategy to assess the performance of binning viral contigs using mock metagenomic Hi-C datasets. We expect that this benchmarking strategy can facilitate the evaluation of any Hi-C-based binning tools in viral genome retrieval studies. However, there are also limitations and biases in the benchmarking strategy. Since we only choose viral genomes that can be recovered by a single contig from the whole community, our benchmarking method inevitably underestimates the true diversity of the virus community. The effectiveness of the benchmarking is also less convincing if there are few putative viral genomes. Moreover, though we have shown the low fraction of spurious contacts in the host proximity graph using the mock metagenomic Hi-C datasets, we cannot obtain the results from the real datasets because it is challenging to know the true labels of viral contigs from the real datasets. Finally, we observe that the sizes of putative viral genomes tend to be small in the benchmarking method (Supplementary Note <xref rid="MOESM1" ref-type="media">6)</xref>. Though all pipelines are treated equally on the same set of mock viral contigs derived from the selected putative viral genomes, the sizes of putative viral genomes should be accounted for in the benchmarking considering that the full recovery of a larger putative viral genome requires a binner to correctly group more viral contigs into a single bin from the mock datasets.</p>
    <p id="Par30">Apart from the direct binning of viral contigs as we discussed here, training a classification model to distinguish confidently labelled viral bins and bacterial bins can also contribute to providing a highly enriched candidate set of viral bins from bulk metagenome data<sup><xref ref-type="bibr" rid="CR64">64</xref></sup>. Viral genome retrieval, combined with the Hi-C proximity ligation also sheds light on the infection mechanisms and unveils entirely active virus-host interactions.</p>
    <p id="Par31">Compared to a popular approach, CRISPR spacer analysis, which can reflect historic linkages between viruses and hosts<sup><xref ref-type="bibr" rid="CR65">65</xref>,<xref ref-type="bibr" rid="CR66">66</xref></sup>, metagenomic Hi-C experiments are able to detect active virus-host pairs at a single time point. Chen et al.<sup><xref ref-type="bibr" rid="CR67">67</xref></sup> used metagenomic Hi-C experiments to validate virus-host associated pairs predicted by CRISPR in activated sludge (AS) samples using Illumina sequencing and Nanopore sequencing separately. They validated 11 out of 21 and 16 out of 28 virus-host associated pairs predicted by CRISPR based on the Illumina and combined Illumina/Nanopore sequenced samples, respectively, leveraging Hi-C linkages. In our study, we validated 13 out of 16, 3 out of 4, and 2 out of 2 virus-host pairs predicted by CRISPR based on the wastewater, human gut, and cow fecal datasets, respectively (see Results, Supplementary Notes <xref rid="MOESM1" ref-type="media">4</xref> and <xref rid="MOESM1" ref-type="media">5)</xref>. Both studies clearly show how analyses of metagenomic Hi-C data can be a powerful tool in recovering virus-host pairs that are otherwise difficult to determine (e.g. from non-cultured organisms). It should be noted that some CRISPR-predicted virus-host associations indicate historical associations that may not be present in a given sample, and such pairs cannot be detected by Hi-C<sup><xref ref-type="bibr" rid="CR67">67</xref></sup>. And it must also be kept in mind that some virus-bacteria associations apparent from proximity ligation might be a result of proximity of bacterial and viral DNA from a mechanism other than infection; thus, unexpected results like our reported apparent herpesvirus infection of <italic>Burkholderiales</italic> should be validated before jumping to extraordinary conclusions.</p>
    <p id="Par32">In the future, it will be interesting to explore whether existing binning methods can resolve closely related viruses residing in the same bacterial host based on virus-host proximities. Moreover, recent studies have found that specific viruses have mechanisms enabling multiple viral genomes to infect the same host cell, which is called the co-infection<sup><xref ref-type="bibr" rid="CR68">68</xref></sup>. Leveraging the Hi-C proximity ligation to discover the existence of co-infection for multiple phages within the same cell is another potential topic for future research.</p>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <sec id="Sec13">
      <title>Real metagenomic Hi-C datasets</title>
      <p id="Par33">Three real metagenomic Hi-C datasets, all previously published, were employed to validate the performance of viral genome retrieval and to discover virus-host pairs. Experiments from the previously published papers are briefly repeated here.</p>
      <sec id="Sec14">
        <title>The human gut dataset</title>
        <p id="Par34">This dataset was derived from the microbiome of a human gut and was composed of one WGS library (NCBI accession: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR6131123">SRR6131123</ext-link>) and two separate Hi-C libraries constructed by two four-cutter restriction enzymes, MluCI and Sau3AI (NCBI accession: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR6131122">SRR6131122</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR6131124">SRR6131124</ext-link>)<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. The Illumina HiSeqX Ten was used to sequence the shotgun and Hi-C libraries, creating 151 bp paired-end reads. The two Hi-C libraries consisted of 48.8 million (MluCI library) and 41.7 million (Sau3AI library) read pairs, respectively. The sequencing of the raw WGS library produced 250.9 million read pairs (ratio Hi-C:shotgun = 0.36).</p>
      </sec>
      <sec id="Sec15">
        <title>The cow fecal dataset</title>
        <p id="Par35">The cow fecal sample was collected and processed at the Beef and Sheep Research Centre of Scotland’s Rural College<sup><xref ref-type="bibr" rid="CR69">69</xref></sup>, generating one shotgun library (NCBI accession: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=ERX2333418">ERX2333418</ext-link>) and two Hi-C libraries fragmented using either the Sau3AI or MluCI restriction enzymes (NCBI accession: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=ERX2548555">ERX2548555</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=ERX2548556">ERX2548556</ext-link>). After sequencing all libraries by the Illumina HiSeqX platform at 150 bp, 159.5 million paired-end reads were obtained in the shotgun library while the two Hi-C libraries contained 86.2 million (Sau3AI library) and 59.3 million (MluCI library) paired-end reads, respectively (ratio Hi-C:shotgun = 0.91).</p>
      </sec>
      <sec id="Sec16">
        <title>The wastewater dataset</title>
        <p id="Par36">In the wastewater (WW) sample<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>, the shotgun library (NCBI accession: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR8239393">SRR8239393</ext-link>) was prepared using the DNeasy PowerWater kit while the Hi-C library (NCBI accession: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR8239392">SRR8239392</ext-link>) was produced by a proprietary Hi-C preparation kit (Phase Genomics, Inc). The cutting enzymes utilized in the experiment were Sau3AI and MluCI. All read-sets were sequenced by the HiSeq 4000 at the length of 150 bp. There were 269.3 million and 95.3 million paired-end reads for the WW shotgun metagenomic and Hi-C read-sets, respectively (ratio Hi-C:shotgun = 0.35).</p>
      </sec>
    </sec>
    <sec id="Sec17">
      <title>Initial processing</title>
      <p id="Par37">We applied bbduk from the BBTools suite (v37.25)<sup><xref ref-type="bibr" rid="CR70">70</xref></sup> to thoroughly clean raw WGS and Hi-C read libraries (Supplementary Note <xref rid="MOESM1" ref-type="media">7)</xref>. Processed shotgun reads were assembled into contigs using MEGAHIT (v1.2.9)<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> with options ‘-min-contig-len 1000 -k-min 21 -k-max 141 -k-step 12 -merge-level 20, 0.95’ (Supplementary Table <xref rid="MOESM1" ref-type="media">9)</xref>. Then, processed Hi-C paired-end reads were mapped to assembled contigs by BWA MEM (v0.7.17)<sup><xref ref-type="bibr" rid="CR71">71</xref></sup> with parameter ‘-5SP’. After the alignment, we removed unmapped reads, secondary alignments, supplementary alignments and alignments with low quality (mapping score or nucleotide match length &lt;30). Raw Hi-C contact maps between two contigs were constructed by counting the number of Hi-C read pairs separately aligned to these two contigs.</p>
    </sec>
    <sec id="Sec18">
      <title>Viral contig detection</title>
      <p id="Par38">Long contigs (≥ 3 kbp) assembled from shotgun reads were screened by VirSorter (v1.0.6)<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> with default parameter to identify viral contigs. VirSorter achieved the best F1 score in a recent benchmarking study<sup><xref ref-type="bibr" rid="CR72">72</xref></sup>. Contigs annotated as prophages were removed from the viral sequences (Supplementary Table <xref rid="MOESM1" ref-type="media">10)</xref>. We refer to the contigs that are not identified by VirSorter as potential host contigs.</p>
    </sec>
    <sec id="Sec19">
      <title>Construct the Hi-C interaction graph for viral contigs</title>
      <p id="Par39">We define the Hi-C interaction graph for viral contigs as <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{hic}}}}}}}}}(V,{E}_{{{{{{{{\rm{hic}}}}}}}}})$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hic</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hic</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq23.gif"/></alternatives></inline-formula>, where the vertex <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{i}\in {{{{{{{\mathcal{V}}}}}}}}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq24.gif"/></alternatives></inline-formula> represents the <italic>i</italic>-th identified viral contig, and an edge <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{ij}\in {{{{{{{{\mathcal{E}}}}}}}}}_{{{{{{{{\rm{hic}}}}}}}}}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq25.gif"/></alternatives></inline-formula> exists if <italic>v</italic><sub><italic>i</italic></sub> and <italic>v</italic><sub><italic>j</italic></sub> are linked by at least one Hi-C link.</p>
    </sec>
    <sec id="Sec20">
      <title>Construct the host proximity graph for viral contigs</title>
      <p id="Par40">Besides the Hi-C interaction graph, we also take advantage of virus-host proximity structure to link viral contigs. Specifically, we define two viral contigs as associated by <italic>k</italic> shared host contigs if these two viral contigs are linked to at least the same <italic>k</italic> host contigs by the Hi-C interaction. Based on this metric to measure the linkage between viral contigs, we construct the host proximity graph for viral contigs, denoted by <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}(V,{E}_{{{{{{{{\rm{host}}}}}}}}})$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq26.gif"/></alternatives></inline-formula>, where the vertex <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{i}\in {{{{{{{\mathcal{V}}}}}}}}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq27.gif"/></alternatives></inline-formula> still represents the <italic>i</italic>-th identified viral contig while an edge <italic>e</italic><sub><italic>i</italic><italic>j</italic></sub> exists in <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{E}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq28.gif"/></alternatives></inline-formula> if <italic>v</italic><sub><italic>i</italic></sub> and <italic>v</italic><sub><italic>j</italic></sub> are associated by <italic>k</italic> shared host contigs. Formally, let <italic>H</italic><sub><italic>i</italic></sub> denote the set of host contigs for viral contig <italic>v</italic><sub><italic>i</italic></sub>. Then, <italic>v</italic><sub><italic>i</italic></sub> and <italic>v</italic><sub><italic>j</italic></sub> are connected in the host proximity graph <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq29.gif"/></alternatives></inline-formula> if<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|{H}_{i}\cap {H}_{j}\right|\ge k,$$\end{document}</tex-math><mml:math id="M60"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>≥</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2023_35945_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq30"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|\cdot \right|$$\end{document}</tex-math><mml:math id="M62"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mo>⋅</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq30.gif"/></alternatives></inline-formula> denotes the cardinality of a set and the parameter <italic>k</italic> here is automatically determined such that<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{ll}&amp;\mathop{\max }\limits_{k}\,\left|{{{{{{{{\mathcal{E}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}\right|\\ &amp;s.t.\,\left|{{{{{{{{\mathcal{E}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}\right|\le \left|{{{{{{{{\mathcal{E}}}}}}}}}_{{{{{{{{\rm{hic}}}}}}}}}\right|;\ \,k\ge {k}_{\min },\end{array}$$\end{document}</tex-math><mml:math id="M64"><mml:mtable><mml:mtr><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mspace width="0.25em"/><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mspace width="0.25em"/><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hic</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>;</mml:mo><mml:mspace width="0.33em"/><mml:mspace width="0.25em"/><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2023_35945_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq31"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{\min }$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq31.gif"/></alternatives></inline-formula> (default 4) is the lower bound of parameter <italic>k</italic>. Note that decreasing <italic>k</italic> relaxes the requirement for the existence of an association by shared host contigs, leading to more edges in <inline-formula id="IEq32"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq32.gif"/></alternatives></inline-formula>. Thus in formula (<xref rid="Equ2" ref-type="disp-formula">2</xref>), maximizing the number of edges in <inline-formula id="IEq33"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq33.gif"/></alternatives></inline-formula> is equivalent to minimize the value of <italic>k</italic>. Though smaller <italic>k</italic> provides a larger number of connections for viral contigs in <inline-formula id="IEq34"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq34.gif"/></alternatives></inline-formula>, the value of <italic>k</italic> cannot be too small, which may introduce false positive associations due to the experimental noise. Therefore, two constraints that the number of edges in <inline-formula id="IEq35"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq35.gif"/></alternatives></inline-formula> is less than or equal to that in <inline-formula id="IEq36"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{hic}}}}}}}}}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq36.gif"/></alternatives></inline-formula> and <italic>k</italic> is no less than <inline-formula id="IEq37"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{\min }$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq37.gif"/></alternatives></inline-formula> are utilized to control the value of <italic>k</italic>. We found that the vast majority of edges within the host proximity graph linked the viral contigs from the same genome on the three mock metagenomic Hi-C datasets, demonstrating the reliability of the host proximity graph (see Results).</p>
    </sec>
    <sec id="Sec21">
      <title>Integrate the Hi-C interaction graph and the host proximity graph</title>
      <p id="Par41">We have constructed the Hi-C interaction graph and the host proximity graph to link viral contigs. Then, we would like to integrate these two graphs. Let <inline-formula id="IEq38"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{int}}}}}}}}}(V,\,{E}_{{{{{{{{\rm{int}}}}}}}}})$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">int</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">int</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq38.gif"/></alternatives></inline-formula> denote the final integrative graph, where the vertex set still represents all viral contigs and an edge <italic>e</italic><sub><italic>i</italic><italic>j</italic></sub> belongs to the edge set <inline-formula id="IEq39"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{E}}}}}}}}}_{{{{{{{{\rm{int}}}}}}}}}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">int</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq39.gif"/></alternatives></inline-formula> if <italic>v</italic><sub><italic>i</italic></sub> and <italic>v</italic><sub><italic>j</italic></sub> are linked through any one of the Hi-C interaction graph <inline-formula id="IEq40"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{hic}}}}}}}}}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">hic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq40.gif"/></alternatives></inline-formula> or the host proximity graph <inline-formula id="IEq41"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{host}}}}}}}}}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">host</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq41.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec22">
      <title>Leiden graph clustering based on the integrative graph</title>
      <p id="Par42">We cluster the viral contigs using the Leiden graph clustering algorithm<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> based on the integrative graph <inline-formula id="IEq42"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{int}}}}}}}}}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">int</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq42.gif"/></alternatives></inline-formula>. The Leiden algorithm is a modularity-based community detection algorithm. It takes a three-stage greedy approach to optimizing the modularity function. Specifically, in each iteration, the algorithm assigns each node to a community such that the modularity function will increase after the local movement, followed by refining the partition into sub-communities and aggregating the network. Moreover, a general modularity function based on the Reichardt and Bornholdt’s Potts model<sup><xref ref-type="bibr" rid="CR73">73</xref></sup> is selected for the Leiden algorithm to overcome the resolution limit<sup><xref ref-type="bibr" rid="CR74">74</xref></sup> and is defined as:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop{\sum}\limits_{\{i,j|{c}_{i}={c}_{j}\}}({M}_{ij}-r\frac{{d}_{i}{d}_{j}}{2n}),$$\end{document}</tex-math><mml:math id="M90"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2023_35945_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <italic>M</italic> is the adjacency matrix of graph <inline-formula id="IEq43"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{{\mathcal{G}}}}}}}}}_{{{{{{{{\rm{int}}}}}}}}}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">int</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq43.gif"/></alternatives></inline-formula>, <italic>c</italic> denotes the community of viral vertices, <italic>r</italic> is a resolution parameter, <italic>d</italic> represents the degree of viral vertices and <italic>n</italic> is the total number of edges in graph. The resolution parameter <italic>r</italic> is tuned using the silhouette coefficient<sup><xref ref-type="bibr" rid="CR75">75</xref></sup> of the binning results, which is a popular clustering evaluation metric without true labels by measuring the cohesion and the separation of the clusters. The candidate resolution that yields the highest silhouette coefficient is selected as the optimal value for the Leiden clustering.</p>
    </sec>
    <sec id="Sec23">
      <title>Evaluate the CheckV completeness of vMAGs on real metagenomic Hi-C datasets</title>
      <p id="Par43">We used one popular tool CheckV (v0.7.0)<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> to estimate the completeness quality of viral MAGs recovered from three real metagenomic Hi-C datasets. Since CheckV was originally designed for assessing the quality of single-contig viral genomes, viral contigs from each vMAG were concatenated into a single sequence as required by CheckV. CheckV applies two algorithms to compute the completeness of vMAGs based on amino acid identity (AAI) or hidden Markov model (HMM) (Supplementary Note <xref rid="MOESM1" ref-type="media">8)</xref>. The AAI-based approach reports a confidence level of estimation based on the alignment quality to the CheckV genome database and the contig length, and high- and medium-confidence estimates are demonstrated to be accurate and can be trusted<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. Therefore, we combined the results estimated by two approaches to determine the completeness of vMAGs. Specifically, for each vMAG, CheckV AAI-based estimation of completeness was utilized if this estimation was qualified as medium or high confidence. Otherwise, the HMM-based estimate was used if available.</p>
    </sec>
    <sec id="Sec24">
      <title>A systematic benchmarking strategy to evaluate the performance of binning viral contigs</title>
      <sec id="Sec25">
        <title>Rationale of the benchmarking framework</title>
        <p id="Par44">Though CheckV has been widely exploited to evaluate the binning performance for viral contigs, the inability to assess the contamination renders the CheckV evaluation less comprehensive on vMAGs. Moreover, benchmarking the viral genome retrieval through simulation is challenging since few studies have been conducted on modeling Hi-C interactions for viral contigs. To solve these problems, we put forward a benchmarking strategy to comprehensively evaluate the binning performance of Hi-C-based tools on viral contigs without the need for simulating Hi-C interactions for viral contigs.</p>
      </sec>
      <sec id="Sec26">
        <title>Generate mock viral contigs with ground truth in a mock metagenomic Hi-C dataset directly from the real metagenomic Hi-C sample</title>
        <p id="Par45">Instead of simulating viral contigs using known viral reference genomes, we designed a strategy to directly generate mock viral contigs with ground truth from the real metagenomic Hi-C sample. Though viral genome assemblies from shotgun reads are commonly plagued by insufficiently long contigs, there are still a few single contigs that can individually represent the viral genome with relatively high completeness. Therefore, we first applied CheckV to all identified viral contigs. Contigs above 10,000 bp and marked as ‘high-quality’ or ‘complete’ by CheckV were considered relatively complete viral genomes and served as the putative reference genomes. Then, we directly simulated mock viral contigs from real metagenomic Hi-C datasets using these putative reference genomes. Specifically, we extracted subsequences from putative reference genomes in sliding windows of a 3 kbp length moving from the left to right without overlaps. As a result, putative reference genomes were split into non-overlapping fragments of 3 kbp. Fragments at the edges of putative reference genomes were retained if they were longer than 1 kbp. All fragmented contigs were regarded as mock viral contigs and labeled based on which putative reference genomes they originated from. We then mixed the obtained mock viral contigs with all potential host contigs and aligned the Hi-C read pairs to the mixed contig set using BWA MEM with parameter ‘-5SP’ to create a mock metagenomic Hi-C dataset. In this way, we generated mock viral contigs with ground truth and constructed valid Hi-C interactions without simulating the Hi-C experiments for viral contigs in a mock metagenomic Hi-C dataset. We were subsequently able to validate the binning performance based on mock metagenomic Hi-C datasets for Hi-C-based binning approaches as well as shotgun-based binning tools.</p>
      </sec>
      <sec id="Sec27">
        <title>Gold standards to evaluate binning performance using mock metagenomic Hi-C datasets</title>
        <p id="Par46">Since the true labels of all mock viral contigs in the mock metagenomic Hi-C dataset were known, we employed four comprehensive evaluation metrics of the clustering performance (Supplementary Note <xref rid="MOESM1" ref-type="media">9)</xref>: Fowlkes-Mallows scores (F-scores), Adjusted Rand Index (ARI), Normalized Mutual Information (NMI), and Homogeneity. These four metrics were used to evaluate binning performance.</p>
        <p id="Par47">Moreover, we defined the completeness and contamination of each vMAG. Specifically, for each vMAG, we summed the lengths of contigs from different reference genomes separately and assigned the vMAG to the reference genome with the largest query length, denoted by <italic>L</italic>(<italic>q</italic>). We also denoted the length of corresponding reference genome as <italic>L</italic>(<italic>r</italic>) and referred to the total length of the vMAG as <italic>L</italic>(<italic>v</italic>). The completeness of a vMAG is defined as <inline-formula id="IEq44"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{L(q)}{L(r)}$$\end{document}</tex-math><mml:math id="M94"><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq44.gif"/></alternatives></inline-formula> and the contamination of a vMAG is defined as <inline-formula id="IEq45"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{L(v)-L(q)}{L(v)}$$\end{document}</tex-math><mml:math id="M96"><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2023_35945_Article_IEq45.gif"/></alternatives></inline-formula>. Then, we assigned the high-quality vMAGs into three ranks, i.e., near-complete (completeness ≥ 90%, contamination ≤ 10%), substantially complete (70% ≤ completeness &lt;90%, contamination ≤ 10%), and moderately complete (50% ≤ completeness &lt;70%, contamination ≤ 10%), which is similar to the CheckM evaluation criteria<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>.</p>
      </sec>
    </sec>
    <sec id="Sec28">
      <title>The quality control of metagenomic Hi-C datasets</title>
      <p id="Par48">As in<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, we defined the inter-contig Hi-C contacts as the paired-end Hi-C reads mapped to different viral contigs. Then the 3D ratio was calculated by dividing the number of inter-contig Hi-C contacts by the total number of paired-end Hi-C reads aligned to viral contigs. We also performed an additional quality control step on processed paired-end Hi-C reads using qc3C (v0.5)<sup><xref ref-type="bibr" rid="CR76">76</xref></sup> in k-mer mode with default parameters. We defined the qc3C CI as the 95% confidence interval of the proportion of observed junction sequences considered to be the product of proximity ligation estimated by the qc3C software. Detailed results of qc3C for each dataset were listed in Supplementary Data <xref rid="MOESM3" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec29">
      <title>Annotate vMAGs at the order and family levels</title>
      <p id="Par49">We first employed DemoVir (<ext-link ext-link-type="uri" xlink:href="https://github.com/feargalr/Demovir">https://github.com/feargalr/Demovir</ext-link>) to classify viral contigs to the order and family taxonomic levels by comparing genes on contigs against the curated viral protein database (<ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/NR_Viral_TrEMBL/5822166">https://figshare.com/articles/NR_Viral_TrEMBL/5822166</ext-link>). Contigs whose genes were consistently classified to the same family were finally annotated. Then, we defined the vMAG family as the family to which the majority of contigs in the vMAG belonged.</p>
    </sec>
    <sec id="Sec30">
      <title>Detect virus-host pairs between vMAGs and host MAGs</title>
      <p id="Par50">All non-viral contigs for each sample were binned using HiCBin (v1.1.0)<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> with default parameters to generate potential host MAGs, which were subsequently annotated by GTDB-TK (v2.1.0, Release: R207_v2)<sup><xref ref-type="bibr" rid="CR54">54</xref></sup> with default parameters and the taxonomic classification results were visualized using ITOL (v5)<sup><xref ref-type="bibr" rid="CR55">55</xref></sup>. vMAGs were associated with potential host MAGs if they were linked by at least two Hi-C read-pairs as in<sup><xref ref-type="bibr" rid="CR77">77</xref></sup>.</p>
    </sec>
    <sec id="Sec31">
      <title>Additional validation of ViralCC on a meta 3C/Hi-C dataset</title>
      <p id="Par51">Unlike widely used metagenomic Hi-C technique combining shotgun sequencing with Hi-C sequencing<sup><xref ref-type="bibr" rid="CR34">34</xref>,<xref ref-type="bibr" rid="CR57">57</xref>,<xref ref-type="bibr" rid="CR67">67</xref>,<xref ref-type="bibr" rid="CR69">69</xref>,<xref ref-type="bibr" rid="CR77">77</xref></sup>, Marbouty et al.<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> showed that meta3C, another proximity ligation-based approach, allowed the assembly and scaffolding and thus utilized meta3C reads rather than shotgun reads to assemble contigs, which were subsequently linked by Hi-C paired-end reads in their recent experiments on human gut samples<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. We refer to such datasets as meta 3C/Hi-C datasets. We further validated ViralCC on a meta 3C/Hi-C sample from the human gut microbiome, which consisted of one meta3C library (NCBI accession: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR11853875">SRR11853875</ext-link>) and two separate Hi-C libraries (NCBI accession: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR13435230">SRR13435230</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR13435231">SRR13435231</ext-link>). Considering the short length of Hi-C reads (35 bp), we neither discarded any Hi-C reads using minimal length option of bbduk<sup><xref ref-type="bibr" rid="CR70">70</xref></sup> nor trimmed Hi-C reads during the read cleaning step. More details of data processing and the results of validation were shown in Supplementary Note <xref rid="MOESM1" ref-type="media">10</xref>.</p>
    </sec>
    <sec id="Sec32">
      <title>Compare ViralCC to other pipelines</title>
      <p id="Par52">VAMB (v3.0.3)<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> was executed with option ‘-t 40’. vRhyme (v1.0.0)<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, MetaTOR (v1.1.4)<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>, and bin3C (v0.1.1)<sup><xref ref-type="bibr" rid="CR39">39</xref></sup> were run with default parameters. The input coverage files of viral contigs for VAMB and vRhyme were generated using script ‘jgi_summarize_bam_contig_depths’ provided by MetaBAT2 (v2.12.1)<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. Since CoCoNet<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> removed contigs occurring in only one sample, we used the mode ‘composition’ to recover the viral genomes. The other parameters were set to default values.</p>
    </sec>
    <sec id="Sec33">
      <title>Statistics &amp; Reproducibility</title>
      <p id="Par53">No statistical method was used to predetermine sample size. No data were excluded from the analyses. The experiments were not randomized except for the random binning model where configuration graphs were constructed by randomly assigning edges to match the degree sequence of viral contigs in integrative graphs. The investigators were not blinded to allocation during experiments and outcome assessment.</p>
    </sec>
    <sec id="Sec34">
      <title>Reporting summary</title>
      <p id="Par54">Further information on research design is available in the <xref rid="MOESM4" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec35">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2023_35945_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2023_35945_MOESM2_ESM.pdf">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2023_35945_MOESM3_ESM.xlsx">
            <caption>
              <p>Supplementary Data 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2023_35945_MOESM4_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec36">
        <title>Source data</title>
        <p id="Par58">
          <media position="anchor" xlink:href="41467_2023_35945_MOESM5_ESM.zip" id="MOESM5">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-023-35945-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The research is partially funded by NIH grants (R01GM120624 and R01GM131407), Simons Foundation grant #549943, and NSF EF-2125142. YD is supported by the Viterbi Fellowship.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Y.D. and F.S. conceived the ideas and designed the study. J.F. provided the ideas on analyzing metagenomic Hi-C data and virus-host pairs. Y.D. implemented the methods, carried out the computational analyses, and drafted the manuscript. F.S., J.F., and Y.D. modified and finalized the paper.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par55"><italic>Nature Communications</italic> thanks the anonymous reviewer(s) for their contribution to the peer review of this work.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>All the datasets used in this study are publicly available from the NCBI Sequence Read Archive database (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/sra">http://www.ncbi.nlm.nih.gov/sra</ext-link>). The human gut dataset is available under accession codes: shotgun library <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR6131123">SRR6131123</ext-link>, Hi-C libraries <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR6131122">SRR6131122</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR6131124">SRR6131124</ext-link>. The cow fecal dataset used in this study is under accession codes: shotgun library <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=ERX2333418">ERX2333418</ext-link>, Hi-C libraries <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=ERX2548555">ERX2548555</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=ERX2548556">ERX2548556</ext-link>. The wastewater dataset is available under accession codes: shotgun library <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR8239393">SRR8239393</ext-link> and Hi-C library <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR8239392">SRR8239392</ext-link>. The meta 3C/Hi-C dataset used in this study is available under accession codes: meta3C library <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR11853875">SRR11853875</ext-link>, Hi-C libraries <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR13435230">SRR13435230</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR13435231">SRR13435231</ext-link>. The databases required by VirSorter can be downloaded at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/1168727/files/virsorter-data-v2.tar.gz">https://zenodo.org/record/1168727/files/virsorter-data-v2.tar.gz</ext-link>. The CheckV reference database is available at <ext-link ext-link-type="uri" xlink:href="https://portal.nersc.gov/CheckV/checkv-db-v1.0.tar.gz">https://portal.nersc.gov/CheckV/checkv-db-v1.0.tar.gz</ext-link>. The GTDB-TK reference database can be downloaded at <ext-link ext-link-type="uri" xlink:href="https://data.gtdb.ecogenomic.org/releases/latest/auxillary_files/gtdbtk_v2_data.tar.gz">https://data.gtdb.ecogenomic.org/releases/latest/auxillary_files/gtdbtk_v2_data.tar.gz</ext-link>. The curated viral protein database for DemoVir is available at <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/NRViralTrEMBL/5822166">https://figshare.com/articles/NRViralTrEMBL/5822166</ext-link>. The remaining data are available within the Article, <xref rid="MOESM1" ref-type="media">Supplementary Information</xref>, or <xref rid="MOESM5" ref-type="media">Source data</xref>. Source data are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The ViralCC software is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/dyxstat/ViralCC">https://github.com/dyxstat/ViralCC</ext-link>under the GNU General Public License version v3. The ViralCC code used in this work<sup><xref ref-type="bibr" rid="CR78">78</xref></sup> is also archived on Zenodo under 10.5281/zenodo.7449911. Scripts to process the intermediate data and plot figures of our ViralCC paper are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/dyxstat/Reproduce_ViralCC/tree/main/Scripts">https://github.com/dyxstat/Reproduce_ViralCC/tree/main/Scripts</ext-link>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par56">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breitbart</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rohwer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Here a virus, there a virus, everywhere the same virus?</article-title>
        <source>Trends Microbiol.</source>
        <year>2005</year>
        <volume>13</volume>
        <fpage>278</fpage>
        <lpage>284</lpage>
        <pub-id pub-id-type="pmid">15936660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gobler</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Hutchins</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Cosper</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Saňudo-Wilhelmy</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Release and bioavailability of C, N, P Se, and Fe following viral lysis of a marine chrysophyte</article-title>
        <source>Limnol. Oceanogr.</source>
        <year>1997</year>
        <volume>42</volume>
        <fpage>1492</fpage>
        <lpage>1504</lpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suttle</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Marine viruses-major players in the global ecosystem</article-title>
        <source>Nat. Rev. Microbiol.</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>801</fpage>
        <lpage>812</lpage>
        <pub-id pub-id-type="pmid">17853907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fuhrman</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Marine viruses and their biogeochemical and ecological effects</article-title>
        <source>Nature</source>
        <year>1999</year>
        <volume>399</volume>
        <fpage>541</fpage>
        <lpage>548</lpage>
        <pub-id pub-id-type="pmid">10376593</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiao</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Microbial production of recalcitrant dissolved organic matter: long-term carbon storage in the global ocean</article-title>
        <source>Nat. Rev. Microbiol.</source>
        <year>2010</year>
        <volume>8</volume>
        <fpage>593</fpage>
        <lpage>599</lpage>
        <pub-id pub-id-type="pmid">20601964</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Norman</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Disease-specific alterations in the enteric virome in inflammatory bowel disease</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>160</volume>
        <fpage>447</fpage>
        <lpage>460</lpage>
        <pub-id pub-id-type="pmid">25619688</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reyes</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gut DNA viromes of Malawian twins discordant for severe acute malnutrition</article-title>
        <source>Proc. Natl. Acad. Sci. U S A</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>11941</fpage>
        <lpage>11946</lpage>
        <pub-id pub-id-type="pmid">26351661</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Uncovering Earth’s virome</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>536</volume>
        <fpage>425</fpage>
        <lpage>430</lpage>
        <pub-id pub-id-type="pmid">27533034</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emerson</surname>
            <given-names>JB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Host-linked soil viral ecology along a permafrost thaw gradient</article-title>
        <source>Nat. Microbiol.</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>870</fpage>
        <lpage>880</lpage>
        <pub-id pub-id-type="pmid">30013236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gregory</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Marine DNA viral macro-and microdiversity from pole to pole</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1109</fpage>
        <lpage>1123</lpage>
        <pub-id pub-id-type="pmid">31031001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gregory</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The gut virome database reveals age-dependent patterns of virome diversity in the human gut</article-title>
        <source>Cell Host Microbe.</source>
        <year>2020</year>
        <volume>28</volume>
        <fpage>724</fpage>
        <lpage>740</lpage>
        <pub-id pub-id-type="pmid">32841606</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Albertsen</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome sequences of rare, uncultured bacteria obtained by differential coverage binning of multiple metagenomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>533</fpage>
        <lpage>538</lpage>
        <pub-id pub-id-type="pmid">23707974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C-M</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sadakane</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>T-W</given-names>
          </name>
        </person-group>
        <article-title>MEGAHIT: an ultra-fast single-node solution for large and complex metagenomics assembly via succinct de Bruijn graph</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1674</fpage>
        <lpage>1676</lpage>
        <pub-id pub-id-type="pmid">25609793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meleshko</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Korobeynikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>metaSPAdes: a new versatile metagenomic assembler</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>824</fpage>
        <lpage>834</lpage>
        <pub-id pub-id-type="pmid">28298430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Enault</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hurwitz</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>VirSorter: mining viral signal from microbial genomic data</article-title>
        <source>PeerJ</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>e985</fpage>
        <pub-id pub-id-type="pmid">26038737</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ahlgren</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Fuhrman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>VirFinder: a novel k-mer based tool for identifying viral sequences from assembled metagenomic data</article-title>
        <source>Microbiome</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>69</fpage>
        <pub-id pub-id-type="pmid">28683828</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kieft</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Anantharaman</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>VIBRANT: automated recovery, annotation and curation of microbial viruses, and evaluation of viral community function from genomic sequences</article-title>
        <source>Microbiome</source>
        <year>2020</year>
        <volume>8</volume>
        <fpage>90</fpage>
        <pub-id pub-id-type="pmid">32522236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smits</surname>
            <given-names>SL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembly of viral genomes from metagenomes</article-title>
        <source>Front. Microbiol.</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>714</fpage>
        <pub-id pub-id-type="pmid">25566226</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>García-López</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vázquez-Castellanos</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Moya</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Fragmentation and coverage variation in viral metagenome assemblies, and their effect in diversity calculations</article-title>
        <source>Front. Bioeng. Biotechnol.</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>141</fpage>
        <pub-id pub-id-type="pmid">26442255</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vázquez-Castellanos</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>García-López</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pérez-Brocal</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pignatelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moya</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Comparison of different assembly and annotation tools on analysis of simulated viral metagenomic communities in the gut</article-title>
        <source>BMC Genomics</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>37</fpage>
        <pub-id pub-id-type="pmid">24438450</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Minimum information about an uncultivated virus genome (MIUViG)</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>29</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="pmid">30556814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schulz</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Advantages and limits of metagenomic assembly and binning of a giant virus</article-title>
        <source>mSystems</source>
        <year>2020</year>
        <volume>5</volume>
        <fpage>e00048</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="pmid">32576649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alneberg</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Binning metagenomic contigs by coverage and composition</article-title>
        <source>Nat. Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>1144</fpage>
        <lpage>1146</lpage>
        <pub-id pub-id-type="pmid">25218180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Y-W</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Y-H</given-names>
          </name>
          <name>
            <surname>Tringe</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>SW</given-names>
          </name>
        </person-group>
        <article-title>MaxBin: an automated binning method to recover individual genomes from metagenomes using an expectation-maximization algorithm</article-title>
        <source>Microbiome</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>26</fpage>
        <pub-id pub-id-type="pmid">25136443</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>DD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MetaBAT2: an adaptive binning algorithm for robust and efficient genome reconstruction from metagenome assemblies</article-title>
        <source>PeerJ</source>
        <year>2019</year>
        <volume>7</volume>
        <fpage>e7359</fpage>
        <pub-id pub-id-type="pmid">31388474</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nissen</surname>
            <given-names>JN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved metagenome binning and assembly using deep variational autoencoders</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>555</fpage>
        <lpage>560</lpage>
        <pub-id pub-id-type="pmid">33398153</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>H-H</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>Y-C</given-names>
          </name>
        </person-group>
        <article-title>Accurate binning of metagenomic contigs via automated clustering sequences using information of genomic signatures and marker genes</article-title>
        <source>Sci. Rep.</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>24175</fpage>
        <pub-id pub-id-type="pmid">27067514</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sieber</surname>
            <given-names>CM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recovery of genomes from metagenomes via a dereplication, aggregation and scoring strategy</article-title>
        <source>Nat. Microbiol.</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>836</fpage>
        <lpage>843</lpage>
        <pub-id pub-id-type="pmid">29807988</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arisdakessian</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Nigro</surname>
            <given-names>OD</given-names>
          </name>
          <name>
            <surname>Steward</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>Poisson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Belcaid</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>CoCoNet: an efficient deep learning tool for viral metagenome binning</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>2803</fpage>
        <lpage>2810</lpage>
        <pub-id pub-id-type="pmid">33822891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kieft</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Salamzade</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kalan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Anantharaman</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>vRhyme enables binning of viral genomes from metagenomes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2022</year>
        <volume>50</volume>
        <fpage>e83</fpage>
        <pub-id pub-id-type="pmid">35544285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burton</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Liachko</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Dunham</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Species-level deconvolution of metagenome assemblies with Hi-C–based contact probability maps</article-title>
        <source>G3 (Bethesda)</source>
        <year>2014</year>
        <volume>4</volume>
        <fpage>1339</fpage>
        <lpage>1346</lpage>
        <pub-id pub-id-type="pmid">24855317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beitel</surname>
            <given-names>CW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Strain-and plasmid-level deconvolution of a synthetic metagenome by sequencing proximity ligation products</article-title>
        <source>PeerJ</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>e415</fpage>
        <pub-id pub-id-type="pmid">24918035</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marbouty</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic chromosome conformation capture (meta3C) unveils the diversity of chromosome organization in microorganisms</article-title>
        <source>eLife</source>
        <year>2014</year>
        <volume>3</volume>
        <fpage>e03318</fpage>
        <pub-id pub-id-type="pmid">25517076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Press, M. O. et al. Hi-C deconvolution of a human gut microbiome yields high-quality draft genomes and reveals plasmid-genome interactions. <italic>bioRxiv</italic> (2017). 10.1101/198713.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marbouty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Baudry</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cournac</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koszul</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Scaffolding bacterial genomes and probing host-virus interactions in gut microbiome by proximity ligation (chromosome capture) assay</article-title>
        <source>Sci. Adv.</source>
        <year>2017</year>
        <volume>3</volume>
        <fpage>e1602105</fpage>
        <pub-id pub-id-type="pmid">28232956</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marbouty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thierry</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Millot</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Koszul</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>MetaHiC phage-bacteria infection network reveals active cycling phages of the healthy human gut</article-title>
        <source>eLife</source>
        <year>2021</year>
        <volume>10</volume>
        <fpage>e60608</fpage>
        <pub-id pub-id-type="pmid">33634788</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Du</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>HiFine: integrating Hi-C-based and shotgun-based methods to refine binning of metagenomic contigs</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>2973</fpage>
        <lpage>2979</lpage>
        <pub-id pub-id-type="pmid">35482530</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baudry</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Foutel-Rodier</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Thierry</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koszul</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Marbouty</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MetaTOR: a computational pipeline to recover high-quality metagenomic bins from mammalian gut proximity-ligation (me) libraries</article-title>
        <source>Front. Genet.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>753</fpage>
        <pub-id pub-id-type="pmid">31481973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeMaere</surname>
            <given-names>MZ</given-names>
          </name>
          <name>
            <surname>Darling</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>bin3C: exploiting Hi-C sequencing data to accurately resolve metagenome-assembled genomes</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>46</fpage>
        <pub-id pub-id-type="pmid">30808380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Du</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>HiCBin: binning metagenomic contigs and recovering metagenome-assembled genomes using Hi-C contact maps</article-title>
        <source>Genome Biol</source>
        <year>2022</year>
        <volume>23</volume>
        <fpage>63</fpage>
        <pub-id pub-id-type="pmid">35227283</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Uritskiy, G. et al. Accurate viral genome reconstruction and host assignment with proximity-ligation sequencing. <italic>bioRxiv</italic> (2021). 10.1101/2021.06.14.448389.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Du</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Laperriere</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Fuhrman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Normalizing Metagenomic Hi-C Data and Detecting Spurious Contacts Using Zero-Inflated Negative Binomial Regression</article-title>
        <source>J. Comput. Biol.</source>
        <year>2022</year>
        <volume>29</volume>
        <fpage>106</fpage>
        <lpage>120</lpage>
        <pub-id pub-id-type="pmid">35020412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CheckV assesses the quality and completeness of metagenome-assembled viral genomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>578</fpage>
        <lpage>585</lpage>
        <pub-id pub-id-type="pmid">33349699</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Imelfort</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Skennerton</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>CheckM: assessing the quality of microbial genomes recovered from isolates, single cells, and metagenomes</article-title>
        <source>Genome Res.</source>
        <year>2015</year>
        <volume>25</volume>
        <fpage>1043</fpage>
        <lpage>1055</lpage>
        <pub-id pub-id-type="pmid">25977477</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Leary</surname>
            <given-names>NA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Traag</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Waltman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Van Eck</surname>
            <given-names>NJ</given-names>
          </name>
        </person-group>
        <article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>
        <source>Sci. Rep.</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>5233</fpage>
        <pub-id pub-id-type="pmid">30914743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>The structure and function of complex networks</article-title>
        <source>SIAM Rev.</source>
        <year>2003</year>
        <volume>45</volume>
        <fpage>167</fpage>
        <lpage>256</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ackermann</surname>
            <given-names>H-W</given-names>
          </name>
        </person-group>
        <article-title>5500 Phages examined in the electron microscope</article-title>
        <source>Arch. Virol.</source>
        <year>2007</year>
        <volume>152</volume>
        <fpage>227</fpage>
        <lpage>243</lpage>
        <pub-id pub-id-type="pmid">17051420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beller</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Matthijnssens</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>What is (not) known about the dynamics of the human gut virome in health and disease</article-title>
        <source>Curr. Opin. Virol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>52</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="pmid">31255903</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williamson</surname>
            <given-names>SJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Sorcerer II Global Ocean Sampling Expedition: metagenomic characterization of viruses within aquatic microbial samples</article-title>
        <source>PLoS one</source>
        <year>2008</year>
        <volume>3</volume>
        <fpage>e1456</fpage>
        <pub-id pub-id-type="pmid">18213365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thurber</surname>
            <given-names>RV</given-names>
          </name>
        </person-group>
        <article-title>Current insights into phage biodiversity and biogeography</article-title>
        <source>Curr. Opin. Microbiol.</source>
        <year>2009</year>
        <volume>12</volume>
        <fpage>582</fpage>
        <lpage>587</lpage>
        <pub-id pub-id-type="pmid">19811946</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hurwitz</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>The Pacific Ocean Virome (POV): a marine viral metagenomic dataset and associated protein clusters for quantitative viral ecology</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e57355</fpage>
        <pub-id pub-id-type="pmid">23468974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jasna</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Parvathi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dash</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Genetic and functional diversity of double-stranded DNA viruses in a tropical monsoonal estuary, India</article-title>
        <source>Sci. Rep.</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>16036</fpage>
        <pub-id pub-id-type="pmid">30375431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaumeil</surname>
            <given-names>P-A</given-names>
          </name>
          <name>
            <surname>Mussig</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>GTDB-Tk: a toolkit to classify genomes with the Genome Taxonomy Database</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>1925</fpage>
        <lpage>1927</lpage>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Interactive Tree Of Life (iTOL) v5: an online tool for phylogenetic tree display and annotation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>W293</fpage>
        <lpage>W296</lpage>
        <pub-id pub-id-type="pmid">33885785</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>W-W</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J-F</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>J-D</given-names>
          </name>
          <name>
            <surname>Mu</surname>
            <given-names>B-Z</given-names>
          </name>
        </person-group>
        <article-title>Nitrate-reducing community in production water of three oil reservoirs and their responses to different carbon sources revealed by nitrate-reductase encoding gene (napA)</article-title>
        <source>Int. Biodeterior Biodegradation</source>
        <year>2011</year>
        <volume>65</volume>
        <fpage>1081</fpage>
        <lpage>1086</lpage>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stalder</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Press</surname>
            <given-names>MO</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liachko</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Top</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>Linking the resistome and plasmidome to the microbiome</article-title>
        <source>ISME J.</source>
        <year>2019</year>
        <volume>13</volume>
        <fpage>2437</fpage>
        <lpage>2446</lpage>
        <pub-id pub-id-type="pmid">31147603</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gubert</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene-environment-gut interactions in huntington’s disease mice are associated with environmental modulation of the gut microbiome</article-title>
        <source>iScience</source>
        <year>2022</year>
        <volume>25</volume>
        <fpage>103687</fpage>
        <pub-id pub-id-type="pmid">35059604</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yordpratum</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Tattawasart</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Wongratanacheewin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sermswan</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>Novel lytic bacteriophages from soil that lyse Burkholderia pseudomallei</article-title>
        <source>FEMS Microbiol. Lett.</source>
        <year>2011</year>
        <volume>314</volume>
        <fpage>81</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="pmid">21091532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ogilvie</surname>
            <given-names>LA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome signature-based dissection of human gut metagenomes to extract subliminal viral sequences</article-title>
        <source>Nat. Commun.</source>
        <year>2013</year>
        <volume>4</volume>
        <fpage>2420</fpage>
        <pub-id pub-id-type="pmid">24036533</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mettenleiter</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Klupp</surname>
            <given-names>BG</given-names>
          </name>
          <name>
            <surname>Granzow</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Herpesvirus assembly: an update</article-title>
        <source>Virus Res.</source>
        <year>2009</year>
        <volume>143</volume>
        <fpage>222</fpage>
        <lpage>234</lpage>
        <pub-id pub-id-type="pmid">19651457</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>PILER-CR: fast and accurate identification of CRISPR repeats</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>18</fpage>
        <pub-id pub-id-type="pmid">17239253</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NCBI BLAST: a better web interface</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>W5</fpage>
        <lpage>W9</lpage>
        <pub-id pub-id-type="pmid">18440982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johansen</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome binning of viral entities from bulk metagenomics data</article-title>
        <source>Nat. Commun.</source>
        <year>2022</year>
        <volume>13</volume>
        <fpage>965</fpage>
        <pub-id pub-id-type="pmid">35181661</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Puschnik</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Majzoub</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ooi</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Carette</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>A CRISPR toolbox to study virus–host interactions</article-title>
        <source>Nat. Rev. Microbiol.</source>
        <year>2017</year>
        <volume>15</volume>
        <fpage>351</fpage>
        <lpage>364</lpage>
        <pub-id pub-id-type="pmid">28420884</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hille</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The biology of CRISPR-Cas: backward and forward</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>172</volume>
        <fpage>1239</fpage>
        <lpage>1259</lpage>
        <pub-id pub-id-type="pmid">29522745</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Paez-Espino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Polz</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Prokaryotic viruses impact functional microorganisms in nutrient removal and carbon cycle in wastewater treatment plants</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>5398</fpage>
        <pub-id pub-id-type="pmid">34518545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanjuán</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Thoulouze</surname>
            <given-names>M-I</given-names>
          </name>
        </person-group>
        <article-title>Why viruses sometimes disperse in groups</article-title>
        <source>Virus Evol.</source>
        <year>2019</year>
        <volume>5</volume>
        <fpage>vez014</fpage>
        <pub-id pub-id-type="pmid">31249695</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stewart</surname>
            <given-names>RD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembly of 913 microbial genomes from metagenomic sequencing of the cow rumen</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>870</fpage>
        <pub-id pub-id-type="pmid">29491419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <mixed-citation publication-type="other">Bushnell, B. BBMap: a fast, accurate, splice-aware aligner. Tech. Rep., Lawrence Berkeley National Lab.(LBNL), Berkeley, CA (United States) (2014).</mixed-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <mixed-citation publication-type="other">Li, H. Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. <italic>arXiv</italic> (2013). 10.48550/arXiv.1303.3997.</mixed-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Glickman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hendrix</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Strong</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Simulation study and comparative evaluation of viral contiguous sequence identification tools</article-title>
        <source>BMC bioinformatics</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>329</fpage>
        <pub-id pub-id-type="pmid">34130621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reichardt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bornholdt</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Statistical mechanics of community detection</article-title>
        <source>Phys. Rev. E</source>
        <year>2006</year>
        <volume>74</volume>
        <fpage>016110</fpage>
      </element-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fortunato</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Barthelemy</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Resolution limit in community detection</article-title>
        <source>Proc. Natl. Acad. Sci. U S A</source>
        <year>2007</year>
        <volume>104</volume>
        <fpage>36</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="pmid">17190818</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J. Comput. Appl. Math.</source>
        <year>1987</year>
        <volume>20</volume>
        <fpage>53</fpage>
        <lpage>65</lpage>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeMaere</surname>
            <given-names>MZ</given-names>
          </name>
          <name>
            <surname>Darling</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>qc3C: reference-free quality control for Hi-C sequencing data</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2021</year>
        <volume>17</volume>
        <fpage>e1008839</fpage>
        <pub-id pub-id-type="pmid">34634030</pub-id>
      </element-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Vill</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Satlin</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Brito</surname>
            <given-names>IL</given-names>
          </name>
        </person-group>
        <article-title>Widespread transfer of mobile antibiotic resistance genes within individual gut microbiomes revealed through bacterial Hi-C</article-title>
        <source>Nat. Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>4379</fpage>
        <pub-id pub-id-type="pmid">32873785</pub-id>
      </element-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <mixed-citation publication-type="other">Du, Y., Fuhrman, J. A. &amp; Sun, F. ViralCC retrieves complete viral genomes and virus-host pairs from metagenomic Hi-C data. <italic>Zenodo</italic> (2022). 10.5281/zenodo.7449911.</mixed-citation>
    </ref>
  </ref-list>
</back>
