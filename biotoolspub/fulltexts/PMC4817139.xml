<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4817139</article-id>
    <article-id pub-id-type="pmid">26163694</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv408</article-id>
    <article-id pub-id-type="publisher-id">btv408</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SomaticSignatures: inferring mutational signatures from single-nucleotide variants</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gehring</surname>
          <given-names>Julian S.</given-names>
        </name>
        <xref ref-type="aff" rid="btv408-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv408-AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btv408-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fischer</surname>
          <given-names>Bernd</given-names>
        </name>
        <xref ref-type="aff" rid="btv408-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv408-AFF3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lawrence</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="btv408-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huber</surname>
          <given-names>Wolfgang</given-names>
        </name>
        <xref ref-type="aff" rid="btv408-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btv408-COR1">*</xref>
      </contrib>
      <aff id="btv408-AFF1"><sup>1</sup>European Molecular Biology Laboratory, Genome Biology Unit, 69117 Heidelberg, Germany,</aff>
      <aff id="btv408-AFF2"><sup>2</sup>Department of Bioinformatics and Computational Biology, Genentech Inc., South San Francisco, CA 94080, USA and</aff>
      <aff id="btv408-AFF3"><sup>3</sup>Computational Genome Biology, German Cancer Research Center, 69120 Heidelberg, Germany</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv408-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="btv408-FN1">
        <p>Associate Editor: John Hancock</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>11</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>7</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>7</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>22</issue>
    <fpage>3673</fpage>
    <lpage>3675</lpage>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>3</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>9</day>
        <month>6</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>7</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Mutational signatures are patterns in the occurrence of somatic single-nucleotide variants that can reflect underlying mutational processes. The <italic>SomaticSignatures</italic> package provides flexible, interoperable and easy-to-use tools that identify such signatures in cancer sequencing data. It facilitates large-scale, cross-dataset estimation of mutational signatures, implements existing methods for pattern decomposition, supports extension through user-defined approaches and integrates with existing Bioconductor workflows.</p>
      <p><bold>Availability and implementation:</bold> The R package <italic>SomaticSignatures</italic> is available as part of the Bioconductor project. Its documentation provides additional details on the methods and demonstrates applications to biological datasets.</p>
      <p><bold>Contact:</bold><email>julian.gehring@embl.de</email>, <email>whuber@embl.de</email></p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv408/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Mutational signatures link observed somatic single-nucleotide variants to mutation generating processes (<xref rid="btv408-B1" ref-type="bibr">Alexandrov <italic>et al.</italic>, 2013a</xref>). The identification of these signatures offers insights into the evolution, heterogeneity and developmental mechanisms of cancer (<xref rid="btv408-B5" ref-type="bibr">Fischer <italic>et al.</italic>, 2013</xref>; <xref rid="btv408-B2" ref-type="bibr">Alexandrov <italic>et al.</italic>, 2013b</xref>; <xref rid="btv408-B8" ref-type="bibr">Nik-Zainal <italic>et al.</italic>, 2012</xref>). Existing softwares offer specialized functionality for this approach and have contributed to the characterization of signatures in multiple cancer types (<xref rid="btv408-B8" ref-type="bibr">Nik-Zainal <italic>et al.</italic>, 2012</xref>; <xref rid="btv408-B5" ref-type="bibr">Fischer <italic>et al.</italic>, 2013</xref>), while their reliance on custom data input and output formats limits integration into common workflows.</p>
    <p>The <italic>SomaticSignatures</italic> package aims to encourage wider adoption of mutational signatures in tumor genome analysis by providing an accessible R implementation that supports multiple statistical approaches, scales to large datasets and closely interacts with the data structures and tools of Bioconductor (<xref rid="btv408-B10" ref-type="bibr">R Core Team, 2015</xref>; <xref rid="btv408-B7" ref-type="bibr">Gentleman <italic>et al.</italic>, 2004</xref>).</p>
  </sec>
  <sec>
    <title>2 Approach</title>
    <p>The probability of a somatic single-nucleotide variant (SNV) to occur can depend on the sequence neighborhood, and a fruitful approach is to analyze SNV frequencies together with their immediate sequence context, the flanking 3<inline-formula><mml:math id="MM1"><mml:mo>′</mml:mo></mml:math></inline-formula> and 5<inline-formula><mml:math id="MM2"><mml:mo>′</mml:mo></mml:math></inline-formula> bases (<xref rid="btv408-B2" ref-type="bibr">Alexandrov <italic>et al.</italic>, 2013b</xref>). As an example, the mutation of A to G in the sequence TAC defines the mutational motif T[A&gt;G]C. The occurrence patterns of such motifs capture characteristics of mutational mechanisms, and the frequencies of the 96 possible motifs across all samples define the mutational spectrum. It is represented by the matrix <italic>M</italic>, with <italic>M<sub>ij</sub></italic> enumerating over the motifs <italic>i</italic> and the samples <italic>j.</italic> The mutational spectrum can be interpreted by decomposing <italic>M</italic> into two matrices of smaller size (<xref rid="btv408-B8" ref-type="bibr">Nik-Zainal <italic>et al.</italic>, 2012</xref>),
<disp-formula id="btv408-M1"><label>(1)</label><mml:math id="MM3"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>r</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where the number of signatures <italic>r</italic> is typically small compared to the number of samples, and the elements of the residual matrix <italic>ε</italic> are minimized such that <italic>WH</italic> is a useful approximation of the data. The columns of <italic>W</italic> describe the composition of a signature: <italic>W<sub>ik</sub></italic> is the relative frequency of somatic motif <italic>i</italic> in the <italic>k</italic>th signature. The rows of <italic>H</italic> indicate the contribution of each signature to a particular sample <italic>j.</italic> A primary goal of the <italic>SomaticSignatures</italic> package is the easy application of this approach to datasets in an environment that provides users with powerful visualizations and algorithms.</p>
  </sec>
  <sec>
    <title>3 Methods</title>
    <p>Several approaches exist for the decomposition [<xref ref-type="disp-formula" rid="btv408-M1">Equation (1)</xref>] that differ in their constraints and computational complexity. In principal component analysis (PCA), for a given <italic>r</italic>, <italic>W</italic> and <italic>H</italic> are chosen such that the norm <inline-formula><mml:math id="MM4"><mml:mrow><mml:mstyle displaystyle="false"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> is minimal and <italic>W</italic> is orthonormal. Non-negative matrix factorization (NMF) (<xref rid="btv408-B3" ref-type="bibr">Brunet <italic>et al.</italic>, 2004</xref>) is motivated by the fact that the mutational spectrum fulfills <inline-formula><mml:math id="MM5"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and imposes the same requirement on the elements of <italic>W</italic> and <italic>H.</italic> Different NMF and PCA algorithms allow additional constraints on the results, such as sparsity. To deduce the number <italic>r</italic> of signatures present in the data, information theoretical criteria as well as prior biological knowledge can be employed (<xref rid="btv408-B8" ref-type="bibr">Nik-Zainal <italic>et al.</italic>, 2012</xref>; <xref rid="btv408-B1" ref-type="bibr">Alexandrov <italic>et al.</italic>, 2013a</xref>).</p>
  </sec>
  <sec>
    <title>4 Results</title>
    <p><italic>SomaticSignatures</italic> is a flexible and efficient tool for inferring characteristics of mutational mechanisms, based on the methodology developed by <xref rid="btv408-B8" ref-type="bibr">Nik-Zainal <italic>et al.</italic> (2012)</xref>. It integrates with Bioconductor tools for processing and annotating genomic variants. An analysis starts with a set of SNV calls, typically imported from a VCF file and represented as a VRanges object (<xref rid="btv408-B9" ref-type="bibr">Obenchain <italic>et al.</italic>, 2014</xref>). Since the original calls do not contain information about the sequence context, we construct the mutational motifs first, based on the sequence of a reference or personalized genome.
<disp-formula><graphic xlink:href="btv408um1.jpg" position="float" orientation="portrait"/></disp-formula>
</p>
    <p>Subsequently, we define the mutational spectrum <italic>M.</italic> While its columns are by default defined by the sample labels, users can specify an alternative grouping covariate, for example tumor type.
<disp-formula><graphic xlink:href="btv408um2.jpg" position="float" orientation="portrait"/></disp-formula>
</p>
    <p>Mutational signatures and their contribution to each sample’s mutational spectrum are estimated with a chosen decomposition method for a defined number of signatures. We provide convenient access to implementations for NMF and PCA, and users can apply functions with alternative decomposition methods through the API.
<disp-formula><graphic xlink:href="btv408um3.jpg" position="float" orientation="portrait"/></disp-formula>
</p>
    <p>The user interface and library of plotting functions facilitate subsequent analysis and presentation of results (<xref ref-type="fig" rid="btv408-F1">Fig. 1</xref>). Accounting for technical biases is often essential, particularly when analyzing across multiple datasets. For this purpose, we provide methods to normalize for the background distribution of sequence motifs and demonstrate the adjustment for batch effects.
<fig id="btv408-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Analysis of mutational signatures for eight TCGA studies (<xref rid="btv408-B6" ref-type="bibr">Gehring, 2014</xref>). The observed mutational spectrum of each study (panel a) was decomposed into five distinct mutational signatures S1–S5 (panel b) with NMF. The presence of these signatures in the studies (panel c), as shown by hierarchical clustering, underlines the similarities in mutational processes of biologically related cancer types. An annotated high-resolution version of this figure is available as <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv408/-/DC1">Supplementary Figure S1</ext-link></p></caption><graphic xlink:href="btv408f1p"/></fig>
</p>
    <p>In the documentation of the software, we illustrate a use case by analyzing 594 607 somatic SNV calls from 2408 TCGA whole-exome sequenced samples (<xref rid="btv408-B6" ref-type="bibr">Gehring, 2014</xref>). The analysis, including NMF, PCA and hierarchical clustering, completes within minutes on a standard desktop computer. The different approaches yield a biologically meaningful grouping of the eight cancer types according to the estimated signatures (<xref ref-type="fig" rid="btv408-F1">Fig. 1</xref>).</p>
    <p>We have applied this approach to the characterization of kidney cancer and have shown that classification of subtypes according to mutational signatures is consistent with classification based on RNA expression profiling and mutation rates (<xref rid="btv408-B4" ref-type="bibr">Durinck <italic>et al.</italic>, 2015</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_22_3673__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btv408_somatic-signatures-figS1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="FN100">
      <p>A version of btv408 has been published to include the PDF article and missing figures from the original article.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgement</title>
    <p>We thank Leonard Goldstein and Oleg Mayba at Genentech Inc. for their insights and suggestions.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the <funding-source>NSF</funding-source> award <award-id>1247813</award-id> and <funding-source>Genentech Inc</funding-source>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btv408-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexandrov</surname><given-names>L.B.</given-names></name><etal/></person-group> (<year>2013a</year>) <article-title>Deciphering signatures of mutational processes operative in human cancer</article-title>. <source>Cell Rep.</source>, <volume>3</volume>, <fpage>246</fpage>–<lpage>259</lpage>.<pub-id pub-id-type="pmid">23318258</pub-id></mixed-citation>
    </ref>
    <ref id="btv408-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexandrov</surname><given-names>L.B.</given-names></name><etal/></person-group> (<year>2013b</year>) <article-title>Signatures of mutational processes in human cancer</article-title>. <source>Nature</source>, <volume>500</volume>, <fpage>415</fpage>–<lpage>421</lpage>.<pub-id pub-id-type="pmid">23945592</pub-id></mixed-citation>
    </ref>
    <ref id="btv408-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunet</surname><given-names>J.P.</given-names></name><etal/></person-group> (<year>2004</year>) <article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title>. <source>Proc. Natl. Acad. Sci. USA.</source>, <volume>101</volume>, <fpage>4164</fpage>–<lpage>4169</lpage>.<pub-id pub-id-type="pmid">15016911</pub-id></mixed-citation>
    </ref>
    <ref id="btv408-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durinck</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2015</year>) <article-title>Spectrum of diverse genomic alterations define non-clear cell renal carcinoma subtypes</article-title>. <source>Nat. Genet.</source>, <volume>47</volume>, <fpage>13</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">25401301</pub-id></mixed-citation>
    </ref>
    <ref id="btv408-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fischer</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>EMu: probabilistic inference of mutational processes and their localization in the cancer genome</article-title>. <source>Genome Biol.</source>, <volume>14</volume>, <fpage>R39</fpage>.<pub-id pub-id-type="pmid">23628380</pub-id></mixed-citation>
    </ref>
    <ref id="btv408-B6">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gehring</surname><given-names>J.S.</given-names></name></person-group> (<year>2014</year>) <comment>SomaticCancerAlterations. Bioconductor package, version: 1.1.0. <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/SomaticCancerAlterations/">http://bioconductor.org/packages/SomaticCancerAlterations/</ext-link></comment></mixed-citation>
    </ref>
    <ref id="btv408-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gentleman</surname><given-names>R.C.</given-names></name><etal/></person-group> (<year>2004</year>) <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>. <source>Genome Biol.</source>, <volume>5</volume>, <fpage>R80</fpage>.<pub-id pub-id-type="pmid">15461798</pub-id></mixed-citation>
    </ref>
    <ref id="btv408-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nik-Zainal</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Mutational processes molding the genomes of 21 breast cancers</article-title>. <source>Cell</source>, <volume>149</volume>, <fpage>979</fpage>–<lpage>993</lpage>.<pub-id pub-id-type="pmid">22608084</pub-id></mixed-citation>
    </ref>
    <ref id="btv408-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Obenchain</surname><given-names>V.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>VariantAnnotation: a bioconductor package for exploration and annotation of genetic variants</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>2076</fpage>–<lpage>2078</lpage>.<pub-id pub-id-type="pmid">24681907</pub-id></mixed-citation>
    </ref>
    <ref id="btv408-B10">
      <mixed-citation publication-type="book"><collab>R Core Team</collab> (<year>2015</year>) <source>R: a language and environment for statistical computing</source>. <publisher-name>R Foundation for Statistical Computing</publisher-name>, <publisher-loc>Vienna, Austria</publisher-loc>.</mixed-citation>
    </ref>
  </ref-list>
</back>
