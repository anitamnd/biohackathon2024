<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4640541</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-15-21307</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0137859</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RNA Thermodynamic Structural Entropy</article-title>
      <alt-title alt-title-type="running-head">RNA Thermodynamic Structural Entropy</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Garcia-Martin</surname>
          <given-names>Juan Antonio</given-names>
        </name>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Clote</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="corresp" rid="cor001">*</xref>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Department of Biology, Boston College, Chestnut Hill, MA 02467, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Paci</surname>
          <given-names>Emanuele</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Leeds, UNITED KINGDOM</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con" id="contrib001">
        <p>Conceived and designed the experiments: PC. Performed the experiments: JAGM PC. Analyzed the data: JAGM PC. Contributed reagents/materials/analysis tools: JAGM PC. Wrote the paper: PC.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>clote@bc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>11</month>
      <year>2015</year>
    </pub-date>
    <volume>10</volume>
    <issue>11</issue>
    <elocation-id>e0137859</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>5</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>8</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2015 Garcia-Martin, Clote</copyright-statement>
      <copyright-year>2015</copyright-year>
      <copyright-holder>Garcia-Martin, Clote</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="pone.0137859.pdf"/>
    <abstract>
      <p>Conformational entropy for atomic-level, three dimensional biomolecules is known experimentally to play an important role in protein-ligand discrimination, yet reliable computation of entropy remains a difficult problem. Here we describe the first two accurate and efficient algorithms to compute the conformational entropy for RNA secondary structures, with respect to the Turner energy model, where free energy parameters are determined from UV absorption experiments. An algorithm to compute the derivational entropy for RNA secondary structures had previously been introduced, using stochastic context free grammars (SCFGs). However, the numerical value of derivational entropy depends heavily on the chosen context free grammar and on the training set used to estimate rule probabilities. Using data from the Rfam database, we determine that both of our thermodynamic methods, which agree in numerical value, are substantially faster than the SCFG method. Thermodynamic structural entropy is much smaller than derivational entropy, and the correlation between length-normalized thermodynamic entropy and derivational entropy is moderately weak to poor. In applications, we plot the structural entropy as a function of temperature for known thermoswitches, such as the repression of heat shock gene expression (ROSE) element, we determine that the correlation between hammerhead ribozyme cleavage activity and total free energy is improved by including an additional free energy term arising from conformational entropy, and we plot the structural entropy of windows of the HIV-1 genome. Our software <monospace>RNAentropy</monospace> can compute structural entropy for any user-specified temperature, and supports both the Turner’99 and Turner’04 energy parameters. It follows that <monospace>RNAentropy</monospace> is state-of-the-art software to compute RNA secondary structure conformational entropy. Source code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/clotelab/RNAentropy/">https://github.com/clotelab/RNAentropy/</ext-link>; a full web server is available at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/clotelab/RNAentropy">http://bioinformatics.bc.edu/clotelab/RNAentropy</ext-link>, including source code and ancillary programs.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported by National Science Foundation DBI-1262439.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="5"/>
      <page-count count="32"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The source code and all relevant files are available at: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.31399">http://dx.doi.org/10.5281/zenodo.31399</ext-link></meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The source code and all relevant files are available at: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.31399">http://dx.doi.org/10.5281/zenodo.31399</ext-link></p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Conformational (or configurational) entropy is defined by
<disp-formula id="pone.0137859.e001"><alternatives><graphic xlink:href="pone.0137859.e001.jpg" id="pone.0137859.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo form="prefix">ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic>k</italic>
<sub><italic>B</italic></sub> denotes the Boltzmann constant, and the sum is taken over all structures. As shown experimentally to be the case for calmodulin [<xref rid="pone.0137859.ref001" ref-type="bibr">1</xref>], conformational entropy plays an important role for the discrimination observed in protein-ligand binding. Since conformational entropy is well-known to be difficult to measure, this recent experimental advance involves using NMR relaxation as a proxy for entropy, a technique reviewed in [<xref rid="pone.0137859.ref002" ref-type="bibr">2</xref>].</p>
    <p>It is currently not possible to reliably compute the conformational entropy for 3-dimensional molecular structures [<xref rid="pone.0137859.ref002" ref-type="bibr">2</xref>]; nevertheless, various methods have been developed, employing approaches from molecular, harmonic, and quasiharmonic dynamics [<xref rid="pone.0137859.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0137859.ref004" ref-type="bibr">4</xref>]. It appears likely that such computational methods will continue to improve, especially with the availability now of experimentally determined values by using NMR relaxation [<xref rid="pone.0137859.ref002" ref-type="bibr">2</xref>].</p>
    <p>In contrast to the complex situation for 3-dimensional molecular structures, we show here that it is possible to accurately and efficiently compute the exact value of conformational entropy for RNA secondary structures, with respect to the Turner energy model [<xref rid="pone.0137859.ref005" ref-type="bibr">5</xref>], whose free energy parameters are experimentally determined from UV absorption experiments [<xref rid="pone.0137859.ref006" ref-type="bibr">6</xref>]. Our resulting algorithm, <monospace>RNAentropy</monospace>, runs in cubic time with quadratic memory requirements, thus answering a question raised by M. Zuker (personal communication, 2009).</p>
    <p>The <italic>nearest neighbor</italic> or <italic>Turner</italic> energy model is a coarse-grained RNA secondary structure model that includes free energy parameters for base stacking and various loops (hairpins, bulges, internal loops, multiloops) [<xref rid="pone.0137859.ref005" ref-type="bibr">5</xref>]. The exact definition of these loops can be found in the description of Zuker’s algorithm [<xref rid="pone.0137859.ref007" ref-type="bibr">7</xref>] which computes the minimum free energy (MFE) secondary structure with respect to the Turner energy model. As explained in [<xref rid="pone.0137859.ref006" ref-type="bibr">6</xref>], values for base stacking enthalpy and entropy can be determined by plotting the experimentally measured UV absorption values of various double-stranded RNA oligonucleotide sequences at 280 nm (also 260 nm) as a function of RNA concentration. By least-squares fitting of the data, free energy parameters for base stacking, hairpins, bulges, etc. can be determined. Free energy and enthalpy parameters for an earlier model (Turner 1999) and a more recent model (Turner 2004) are described at the Nearest Neighbor Database (NNDB) [<xref rid="pone.0137859.ref005" ref-type="bibr">5</xref>]. For instance, the base stacking free energy for <inline-formula id="pone.0137859.e002"><alternatives><graphic xlink:href="pone.0137859.e002.jpg" id="pone.0137859.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>5</mml:mn><mml:mo>′</mml:mo><mml:mo>−</mml:mo><mml:mtext>GC</mml:mtext><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo>′</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>3</mml:mn><mml:mo>′</mml:mo><mml:mo>−</mml:mo><mml:mtext>CG</mml:mtext><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mo>′</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></inline-formula> is −3.4 kcal/mol in the Turner 2004 parameter set. MFOLD [<xref rid="pone.0137859.ref008" ref-type="bibr">8</xref>], UNAFOLD [<xref rid="pone.0137859.ref009" ref-type="bibr">9</xref>] and the Vienna RNA Package [<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>] are software packages that implement the Zuker dynamic programming algorithm [<xref rid="pone.0137859.ref007" ref-type="bibr">7</xref>] to compute the MFE structure as well as the McCaskill algorithm [<xref rid="pone.0137859.ref011" ref-type="bibr">11</xref>] to compute the partition function over all secondary structures. Applications of such software are far-reaching, ranging from the prediction of microRNA target sites [<xref rid="pone.0137859.ref012" ref-type="bibr">12</xref>] to the design of synthetic RNA [<xref rid="pone.0137859.ref013" ref-type="bibr">13</xref>, <xref rid="pone.0137859.ref014" ref-type="bibr">14</xref>].</p>
    <p>Throughout this paper, for a given RNA sequence <bold>a</bold> = <italic>a</italic>
<sub>1</sub>, …, <italic>a<sub>n</sub></italic>, <italic>structural entropy</italic>, denoted by <italic>H</italic>(<bold>a</bold>), is defined to be (Shannon) entropy
<disp-formula id="pone.0137859.e003"><alternatives><graphic xlink:href="pone.0137859.e003.jpg" id="pone.0137859.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo form="prefix">ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where the sum is taken over all secondary structures <italic>s</italic> of <bold>a</bold>, <italic>p</italic>(<italic>s</italic>) denotes the Boltzmann probability <inline-formula id="pone.0137859.e004"><alternatives><graphic xlink:href="pone.0137859.e004.jpg" id="pone.0137859.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">a</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic>R</italic> denotes the universal gas constant (Boltzmann constant times Avagadro’s number), <italic>E</italic>(<bold>a</bold>, <italic>s</italic>) is the free energy of the secondary structure <italic>s</italic> of <bold>a</bold> with respect to the Turner energy model [<xref rid="pone.0137859.ref005" ref-type="bibr">5</xref>], and Z(<bold>a</bold>) denotes the partition function, defined as the sum of all Boltzmann factors <inline-formula id="pone.0137859.e005"><alternatives><graphic xlink:href="pone.0137859.e005.jpg" id="pone.0137859.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">a</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> over all secondary structures <italic>s</italic>. When the RNA sequence a is clear from the context, we generally write <italic>E</italic>(<italic>s</italic>), <italic>H</italic> and <italic>Z</italic>, rather than <italic>E</italic>(<bold>a</bold>, s), <italic>H</italic>(<bold>a</bold>) and <italic>Z</italic>(<bold>a</bold>). It follows that the conformational entropy is equal to the Boltzmann constant times the structural entropy: <italic>S</italic> = <italic>k</italic>
<sub><italic>B</italic></sub>
<italic>H</italic>.</p>
    <p>Before presenting our results and methods, we first survey several distinct notions of entropy that have appeared in the literature of RNA secondary structures—each quite different from the notion of thermodynamic structural entropy described in this paper.</p>
    <sec id="sec002">
      <title>Pointwise entropy in multiple alignments</title>
      <p>Shannon entropy is used to quantify the variability of positions in a multiple sequence alignment. This application is particularly widespread due to the ubiquitous use of sequence logos [<xref rid="pone.0137859.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0137859.ref016" ref-type="bibr">16</xref>] to present motifs in proteins, DNA and RNA. Letting <inline-formula id="pone.0137859.e006"><alternatives><graphic xlink:href="pone.0137859.e006.jpg" id="pone.0137859.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mi mathvariant="double-struck">A</mml:mi></mml:math></alternatives></inline-formula> denote the 4-letter alphabet {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>U</italic>}, the pointwise entropy <italic>H</italic>
<sub>1</sub>(<italic>k</italic>) at position <italic>k</italic> in the alignment is defined by <inline-formula id="pone.0137859.e007"><alternatives><graphic xlink:href="pone.0137859.e007.jpg" id="pone.0137859.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">A</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo form="prefix">ln</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>p</italic>
<sub><italic>a</italic></sub> is the proportion of nucleotide <italic>a</italic> at position <italic>k</italic>. Entropy values range from 0 to log 4, where high entropy entails uncertainty or disagreement of the nucleotides at position <italic>k</italic>. Average pointwise sequence entropy is often expressed in bits, where logarithm base 2 is used instead of the natural logarithm. The concept of sequence logo has many generalizations; indeed, logos for DNA major groove binding are described in [<xref rid="pone.0137859.ref016" ref-type="bibr">16</xref>], logos for tertiary structure alignment of proteins are described in [<xref rid="pone.0137859.ref017" ref-type="bibr">17</xref>], logos for RNA alignments including mutual information on base pair covariation are described in [<xref rid="pone.0137859.ref018" ref-type="bibr">18</xref>], and logos with secondary structure context of RNAs that bind to specific riboproteins are described in [<xref rid="pone.0137859.ref019" ref-type="bibr">19</xref>, <xref rid="pone.0137859.ref020" ref-type="bibr">20</xref>].</p>
    </sec>
    <sec id="sec003">
      <title>Positional entropy</title>
      <p>For a given RNA sequence <inline-formula id="pone.0137859.e008"><alternatives><graphic xlink:href="pone.0137859.e008.jpg" id="pone.0137859.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:mi mathvariant="bold">a</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and for 1 ≤ <italic>i</italic> &lt; <italic>j</italic> ≤ <italic>n</italic>, define the base pairing probability <italic>p</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> to be the sum of Boltzmann factors of all secondary structures that contain base pair (<italic>i</italic>, <italic>j</italic>), divided by the partition function, i.e.
<disp-formula id="pone.0137859.e009"><alternatives><graphic xlink:href="pone.0137859.e009.jpg" id="pone.0137859.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>s</mml:mi><mml:mo>:</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>s</mml:mi><mml:mo>:</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:msub><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>Z</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
</p>
      <p>Here <italic>p</italic>(<italic>s</italic>) is the Boltzmann probability of structure <italic>s</italic> of <inline-formula id="pone.0137859.e010"><alternatives><graphic xlink:href="pone.0137859.e010.jpg" id="pone.0137859.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mi mathvariant="bold">a</mml:mi></mml:math></alternatives></inline-formula>, <italic>E</italic>(<italic>s</italic>) is the Turner free energy of secondary structure <italic>s</italic>[<xref rid="pone.0137859.ref005" ref-type="bibr">5</xref>], <italic>R</italic> ≈ 0.001987 kcal/mol.K is the universal gas constant, <italic>T</italic> is absolute temperature, and the <italic>partition function</italic>
<italic>Z</italic> = ∑<sub><italic>s</italic></sub> exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>), where the sum is taken over all secondary structures <italic>s</italic> of <bold>a</bold>. Base pairing probabilities can be computed in cubic time by McCaskill’s algorithm [<xref rid="pone.0137859.ref011" ref-type="bibr">11</xref>], as implemented in various software, including the Vienna RNA Package <monospace>RNAfold -p</monospace>[<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>].</p>
      <p>Define the positional base pairing probability distribution at fixed position 1 ≤ <italic>i</italic> ≤ <italic>n</italic> by
<disp-formula id="pone.0137859.e011"><alternatives><graphic xlink:href="pone.0137859.e011.jpg" id="pone.0137859.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mspace width="1pt"/><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="1pt"/><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="1pt"/><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:msup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mtext>​</mml:mtext></mml:msup></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="1pt"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives><label>(4)</label></disp-formula>
</p>
      <p>For each fixed value of <italic>i</italic>, <inline-formula id="pone.0137859.e012"><alternatives><graphic xlink:href="pone.0137859.e012.jpg" id="pone.0137859.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> is a probability distribution, where <italic>j</italic> ranges over 1,…,<italic>n</italic>, the positional structural entropy <italic>H</italic>
<sub>2</sub>(<italic>i</italic>) at position <italic>i</italic> is defined by
<disp-formula id="pone.0137859.e013"><alternatives><graphic xlink:href="pone.0137859.e013.jpg" id="pone.0137859.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo form="prefix">ln</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
</p>
      <p>Low values of positional entropy at position <italic>i</italic> indicate that there is a strong agreement among low energy structures in the Boltzmann ensemble that either <italic>i</italic> is unpaired, or that <italic>i</italic> is paired with the same position <italic>j</italic>. The <italic>average positional entropy</italic> 〈<italic>H</italic>
<sub>2</sub>〉 is the average <inline-formula id="pone.0137859.e014"><alternatives><graphic xlink:href="pone.0137859.e014.jpg" id="pone.0137859.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> taken over all positions of the sequence. Structural positional entropy was first defined by Huynen et al. [<xref rid="pone.0137859.ref021" ref-type="bibr">21</xref>], who used the term <italic>S</italic>-value for average positional entropy, and showed that RNA nucleotide positions having low entropy correspond to positions where the minimum free energy (MFE) structure tends to agree with that determined by comparative sequence analysis. In [<xref rid="pone.0137859.ref022" ref-type="bibr">22</xref>], Mathews made a similar analysis, where in place of <italic>S</italic>-value, a normalized pseudo-entropy value was used, defined by −∑<sub>1 ≤ <italic>i</italic> &lt; <italic>j</italic> ≤ <italic>n</italic></sub>
<italic>p</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> ln <italic>p</italic>
<sub><italic>i</italic>,<italic>j</italic></sub>/<italic>n</italic>. Positional entropy of RNA secondary structures can be presented by color-coding each nucleotide, where the color of the <italic>k</italic>th nucleotide reflects the positional entropy <italic>H</italic>
<sub>2</sub>(<italic>k</italic>) as defined in <xref ref-type="disp-formula" rid="pone.0137859.e013">Eq (5)</xref>. The Rfam 12.0 database [<xref rid="pone.0137859.ref023" ref-type="bibr">23</xref>] uses such color-coded secondary structures, since the base-pairing of positions having low entropy is likely to be correct [<xref rid="pone.0137859.ref021" ref-type="bibr">21</xref>, <xref rid="pone.0137859.ref022" ref-type="bibr">22</xref>].</p>
    </sec>
    <sec id="sec004">
      <title>Derivational entropy using stochastic context free grammars</title>
      <p>Manzourolajdad et al. [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>], Sukosd et al. [<xref rid="pone.0137859.ref025" ref-type="bibr">25</xref>] and Anderson et al. [<xref rid="pone.0137859.ref026" ref-type="bibr">26</xref>] describe the computation of structural entropy for stochastic context free grammars (SCFGs), defined by −∑<sub><italic>s</italic></sub>
<italic>p</italic>(<italic>s</italic>) ln <italic>p</italic>(<italic>s</italic>), where the sum is taken over all secondary structures <italic>s</italic> of a given RNA sequence, and <italic>p</italic>(<italic>s</italic>) is the probability of deriving the structure <italic>s</italic> in a particular grammar <italic>G</italic>, defined as follows. Suppose that <italic>S</italic> = <italic>S</italic>
<sub>0</sub> is the starting nonterminal for the grammar <italic>G</italic>, <italic>s</italic> = <italic>S</italic>
<sub><italic>m</italic></sub> is the secondary structure <italic>s</italic> consisting only of terminal symbols belonging to the alphabet <inline-formula id="pone.0137859.e015"><alternatives><graphic xlink:href="pone.0137859.e015.jpg" id="pone.0137859.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>•</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and that <italic>S</italic>
<sub>1</sub>,…,<italic>S</italic>
<sub><italic>m</italic>−1</sub> are expressions consisting of a mix of nonterminal and terminal symbols. If <italic>S</italic>
<sub>0</sub> →<sub><italic>G</italic></sub>
<italic>S</italic>
<sub>1</sub> →<sub><italic>G</italic></sub>
<italic>S</italic>
<sub>2</sub> →<sub><italic>G</italic></sub>⋯ →<sub><italic>G</italic></sub>
<italic>S</italic>
<sub><italic>m</italic></sub> is a leftmost derivation using production rules from grammar <italic>G</italic> and for each <italic>i</italic> = 0, …, <italic>m</italic>−1, we let <italic>p</italic>
<sub><italic>i</italic></sub> denote the probability of applying the rule <italic>S</italic>
<sub><italic>i</italic></sub> → <italic>S</italic>
<sub><italic>i</italic>+1</sub>, then <italic>p</italic>(<italic>s</italic>) is defined to be the product <inline-formula id="pone.0137859.e016"><alternatives><graphic xlink:href="pone.0137859.e016.jpg" id="pone.0137859.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. It should be noted that the derivational probability <italic>p</italic>(<italic>s</italic>) heavily depends on the choice of grammar <italic>G</italic> as well as on the rule application probabilities <italic>p</italic>
<sub><italic>i</italic></sub>, obtained by applying expectation maximization to a chosen training set of secondary structures.</p>
      <p>Anderson et al. [<xref rid="pone.0137859.ref026" ref-type="bibr">26</xref>] are motivated to compute derivational entropy of a multiple alignment of RNAs, in order to provide a numerical quantification for the quality of the alignment—specifically, their paper shows that accurate alignment quality corresponds to low derivational entropy. In [<xref rid="pone.0137859.ref027" ref-type="bibr">27</xref>], Sukosd et al. describe the software <monospace>PPfold</monospace>, a multithreaded version of the <monospace>Pfold</monospace> RNA secondary structure prediction algorithm. Subsequently, Sukosd et al. [<xref rid="pone.0137859.ref025" ref-type="bibr">25</xref>] describe how to compute the derivational entropy for the grammar used in the <monospace>PFold</monospace> algorithm (grammar G6 as defined in [<xref rid="pone.0137859.ref028" ref-type="bibr">28</xref>]), and show that derivational entropy is correlated with the accuracy of <monospace>PPfold</monospace> structure predictions, as measured by F-scores. In contrast, Manzourolajdad et al. [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>] computed the derivational entropy of various families of noncoding RNAs, using the trained stochastic context free grammars G4,G5,G6 [<xref rid="pone.0137859.ref028" ref-type="bibr">28</xref>], which they denote respectively as RUN (G4), IVO (G5) and BJK (G6). The Linux executable and trained models can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://rna-informatics.uga.edu/malmberg/">http://rna-informatics.uga.edu/malmberg/</ext-link> for three RNA stochastic context free grammars, each with three trained models using the training sets ‘Rfam5’, ‘Mixed80’, and ‘Benchmark’—see [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>] for description.</p>
      <p>The plan of the remainder of this paper is as follows. In the Methods, we provide a description of our novel entropy algorithms, beginning with an overview in Section “Statistical mechanics”, where we derive a relation between structural entropy <italic>H</italic> and expected energy 〈<italic>E</italic>〉. This relation allows us to provide a crude estimate of <italic>H</italic> by sampling. Expected energy can be computed from the derivative of the logarithm of the partition function with respect to temperature; a finite difference computation then yields our first algorithm to compute structural entropy, while a dynamic programming approach for the expected energy yields our second algorithm. In the Results, we compare our structural entropy software, <monospace>RNAentropy</monospace>, with software for SCFG derivational entropy, and then use <monospace>RNAentropy</monospace> in several applications. Section “Comparison of structural entropy and derivational entropy” benchmarks the time required to compute structural entropy using our two algorithms, versus the time required to compute derivational entropy using the program of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>]. Numerical values for structural and derivational entropies are compared, along with their distributions. In addition to a comparison of run times and entropy values, we compute the correlation of structural entropy, derivational entropy, and a variety of measures, such as ensemble defect [<xref rid="pone.0137859.ref029" ref-type="bibr">29</xref>], positional entropy [<xref rid="pone.0137859.ref021" ref-type="bibr">21</xref>], structural diversity [<xref rid="pone.0137859.ref030" ref-type="bibr">30</xref>], etc. Such measures have recently been used in the design of experimentally validated RNA molecules [<xref rid="pone.0137859.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0137859.ref031" ref-type="bibr">31</xref>]. Motivated by the fact that calmodulin-ligand binding has been shown to depend on conformational entropy [<xref rid="pone.0137859.ref001" ref-type="bibr">1</xref>], in Section “Correlation with hammerhead cleavage activity”, we show an improvement in the correlation between hammerhead ribozyme cleavage activity and total change of energy [<xref rid="pone.0137859.ref032" ref-type="bibr">32</xref>], if conformational entropy is also taken into account. In Section “Structural entropy of HIV-1 genomic regions”, we compute the entropy of genomic portions of the HIV-1 genome and compare entropy Z-scores with known HIV-1 noncoding elements. Finally, in the Discussion, we describe differences between the methods and discuss the numerical discrepancy between thermodynamic structural entropy values and SCFG derivational entropy values. For more background on RNA, an excellent, though somewhat outdated, review of computational and physical aspects of RNA is given by Higgs [<xref rid="pone.0137859.ref033" ref-type="bibr">33</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="materials|methods" id="sec005">
    <title>Methods</title>
    <p>In this section, we describe the two novel algorithms to compute RNA thermodynamic structural entropy using the Turner energy model [<xref rid="pone.0137859.ref005" ref-type="bibr">5</xref>]. Section “Statistical mechanics” describes the relation between entropy and expected energy, and provides two variants of a simple sampling method to approximate the value of structural entropy. The approximation does not yield accurate entropy values, so two accurate methods are described: (1) formal temperature derivative (FTD) method, (2) dynamic programming (DP) method. An overview of both algorithms is provided in this section. Full details of each algorithm are then provided in Sections “Entropy by statistical physics” and “Entropy by dynamic programming”.</p>
    <sec id="sec006">
      <title>Statistical mechanics</title>
      <p>Shannon entropy for the Boltzmann ensemble of secondary structures of a given RNA sequence <inline-formula id="pone.0137859.e017"><alternatives><graphic xlink:href="pone.0137859.e017.jpg" id="pone.0137859.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mrow><mml:mi mathvariant="bold">a</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is defined by
<disp-formula id="pone.0137859.e018"><alternatives><graphic xlink:href="pone.0137859.e018.jpg" id="pone.0137859.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>s</mml:mi></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext>ln</mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>s</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>Z</mml:mi></mml:mfrac><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>Z</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>s</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>Z</mml:mi></mml:mfrac><mml:mspace width="1pt"/><mml:mo>·</mml:mo><mml:mspace width="1pt"/><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mtext>ln</mml:mtext><mml:mi>Z</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>s</mml:mi></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mtext>ln</mml:mtext><mml:mi>Z</mml:mi></mml:mrow><mml:mi>Z</mml:mi></mml:mfrac><mml:mspace width="1pt"/><mml:mo>·</mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>s</mml:mi></mml:munder><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>E</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mtext>ln</mml:mtext><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>E</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives><label>(6)</label></disp-formula>
where <italic>G</italic> denotes the ensemble free energy −<italic>RT</italic> ln <italic>Z</italic>. It follows that if the energy <italic>E</italic>(<italic>s</italic>) of every structure <italic>s</italic> is zero, or if the temperature <italic>T</italic> is infinite, then entropy is equal to the logarithm of the number of structures. Note as well that in the Nussinov energy model [<xref rid="pone.0137859.ref034" ref-type="bibr">34</xref>], where each base pair has an energy of −1, it follows that the expected energy is equal to −1 times the expected number of base pairs, i.e. 〈<italic>E</italic>〉 = −∑<sub><italic>i</italic> &lt; <italic>j</italic></sub>
<italic>p</italic>
<sub><italic>i</italic>,<italic>j</italic></sub>, where <italic>p</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> is the probability of base pair (<italic>i</italic>, <italic>j</italic>) in the Nussinov model.</p>
      <p>By sampling RNA structures with the <monospace>RNAsubopt</monospace> program from Vienna RNA Package [<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>], we can approximate the value of expected energy, and hence obtain an approximation of the thermodynamic entropy by using <xref ref-type="disp-formula" rid="pone.0137859.e018">Eq (6)</xref>. This can be done in two distinct manners.</p>
      <p>In the first approach, a user-specified number <monospace>N</monospace> of low energy structures from the thermodynamic ensemble can be sampled by using the algorithm of Ding and Lawrence [<xref rid="pone.0137859.ref035" ref-type="bibr">35</xref>], as implemented in <monospace>RNAsubopt -p N</monospace>. A sampling approximation for the expected energy is then defined to be the arithmetic average of the free energy of the <monospace>N</monospace> sampled structures. In the second approach, all structures can be generated, whose free energy lies within a user-specified range <monospace>E</monospace> of the minimum free energy, by using the algorithm of Wuchty [<xref rid="pone.0137859.ref036" ref-type="bibr">36</xref>], as implemented in <monospace>RNAsubopt -e E</monospace>. Let <italic>Z</italic>
<sub>0</sub> be an approximation of the partition function, defined by summing the Boltzmann factors exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>) for all generated structures. Define the (approximate) Boltzmann probability of a generated structure <italic>s</italic> to be <italic>p</italic>(<italic>s</italic>) = exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>)/<italic>Z</italic>
<sub>0</sub>. An approximation for the expected energy is in this case taken to be ∑<sub><italic>s</italic></sub>
<italic>p</italic>(<italic>s</italic>) ⋅ <italic>E</italic>(<italic>s</italic>), where the sum is taken over all structures <italic>s</italic>, whose free energy is within <monospace>E</monospace> kcal/mol of the minimum free energy. In either case, the resulting entropy approximation is not particularly good. For instance, the thermodynamic entropy of the 78 nt arginyl-tRNA from <italic>Aeropyrum pernix</italic> (accession code tdbR00000589 in the <italic>Transfer RNA database</italic> tRNAdb [<xref rid="pone.0137859.ref037" ref-type="bibr">37</xref>]) is 5.44, as computed by the algorithm <monospace>RNAentropy</monospace> described in this paper, while the entropy approximation by the first sampling approach with <italic>N</italic> = 10,000 is 4.71 and that of the second sampling approach with <italic>E</italic> = 10 is 4.68. Since the estimate from each sampling approach has greater than 13% relative error, sampling cannot be used to provide accurate entropy values. For that reason, we now briefly describe two novel, cubic time algorithms to compute the exact value of structural entropy—details of the algorithms are further described in Sections “Entropy by statistical physics” and “Entropy by dynamic programming”.</p>
    </sec>
    <sec id="sec007">
      <title>Algorithm 1: Formal temperature derivative (FTD)</title>
      <p>It is well-known from statistical physics that the average energy 〈<italic>E</italic>〉 of <italic>N</italic> independent and distinguishable particles is given by the following formula (cf equation (10.36) of [<xref rid="pone.0137859.ref038" ref-type="bibr">38</xref>]):
<disp-formula id="pone.0137859.e019"><alternatives><graphic xlink:href="pone.0137859.e019.jpg" id="pone.0137859.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>E</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mtext>ln</mml:mtext><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(7)</label></disp-formula>
</p>
      <p>This equation does not hold in the case of RNA secondary structures with the Turner energy model; however, <xref ref-type="disp-formula" rid="pone.0137859.e019">Eq (7)</xref> is close to being correct. The idea of Algorithm 1 is to use finite differences <inline-formula id="pone.0137859.e020"><alternatives><graphic xlink:href="pone.0137859.e020.jpg" id="pone.0137859.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mfrac><mml:mrow><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> to approximate the derivative <inline-formula id="pone.0137859.e021"><alternatives><graphic xlink:href="pone.0137859.e021.jpg" id="pone.0137859.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, thus obtaining the expected energy 〈<italic>E</italic>〉, from which we obtain the structural entropy by applying <xref ref-type="disp-formula" rid="pone.0137859.e018">Eq (6)</xref>. As shown later, certain technically subtle issues arise in this approach; in particular, the derivative <inline-formula id="pone.0137859.e022"><alternatives><graphic xlink:href="pone.0137859.e022.jpg" id="pone.0137859.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> must be taken with respect to the <italic>formal temperature</italic>, which represents only those occurrences of the temperature variable within the expression <italic>RT</italic>. Formal temperature is distinct from <italic>table temperature</italic>, which latter designates all occurrences of the temperature variable in the Turner energy parameters. This will be fully explained in Section “Entropy by statistical physics”. For this reason, Algorithm 1 is named <monospace>FTD</monospace>, for formal temperature derivative.</p>
    </sec>
    <sec id="sec008">
      <title>Algorithm 2: Dynamic Programming (DP)</title>
      <p>Recall that the partition function for a given RNA sequence <bold>a</bold> is defined by <italic>Z</italic> = ∑<sub><italic>s</italic></sub> exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>), where the sum is taken over all secondary structures of <bold>a</bold>. Letting <italic>BF</italic>(<italic>s</italic>) = exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>) denote the Boltzmann factor of <italic>s</italic>, it follows that the Boltzmann probality of secondary structure <italic>s</italic> satisfies <italic>p</italic>(<italic>s</italic>) = <italic>BF</italic>(<italic>s</italic>)/<italic>Z</italic>, and hence
<disp-formula id="pone.0137859.e023"><alternatives><graphic xlink:href="pone.0137859.e023.jpg" id="pone.0137859.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>E</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>s</mml:mi></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>s</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>Z</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mi>Q</mml:mi><mml:mi>Z</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives><label>(8)</label></disp-formula>
where <italic>Q</italic> = ∑<sub><italic>s</italic></sub>
<italic>BF</italic>(<italic>s</italic>) ⋅ <italic>E</italic>(<italic>s</italic>). The partition function <italic>Z</italic> can be computed by McCaskill’s algorithm [<xref rid="pone.0137859.ref011" ref-type="bibr">11</xref>], while in Sections “Entropy by dynamic programming”, we describe a dynamic programming algorithm to compute <italic>Q</italic>(<italic>a</italic>). Since this method uses dynamic programming, Algorithm 2 is named <monospace>DP</monospace>.</p>
      <p>Both FTD and DP support the Turner’99 and Turner’04 energy models [<xref rid="pone.0137859.ref005" ref-type="bibr">5</xref>], and all references to FTD and DP mean FTD’04 and DP’04, unless otherwise stated (there are small numerical differences in the entropy, depending on the choice of Turner parameters). Moreover, both algorithms allow the user to specify an arbitrary temperature <italic>T</italic> for the computation of structural entropy. This latter feature could prove useful in the investigation of thermoswitches, also called RNA thermometers, discussed later. The software <monospace>RNAentropy</monospace> implements both algorithms, and is available at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/clotelab/RNAentropy">http://bioinformatics.bc.edu/clotelab/RNAentropy</ext-link>.</p>
    </sec>
    <sec id="sec009">
      <title>Entropy by statistical physics</title>
      <p>Here we show that for the Turner energy model of RNA secondary structures, expected energy satisfies
<disp-formula id="pone.0137859.e024"><alternatives><graphic xlink:href="pone.0137859.e024.jpg" id="pone.0137859.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>E</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mtext>ln</mml:mtext><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives><label>(9)</label></disp-formula>
although equality does not strictly hold. Indeed,
<disp-formula id="pone.0137859.e025"><alternatives><graphic xlink:href="pone.0137859.e025.jpg" id="pone.0137859.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold">a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold">a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mo>{</mml:mo><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo><mml:mo>·</mml:mo><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold">a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mo form="prefix">exp</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>-</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>T</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold">a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mo form="prefix">exp</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>E</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>T</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mi>E</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula>
</p>
      <p>Let <italic>formal temperature</italic> denote each occurrence of the temperature variable <italic>T</italic> within the expression <italic>RT</italic>, while <italic>table temperature</italic> denotes all other occurrences (i.e. table temperature refers to the temperature-dependent Turner free energy parameters [<xref rid="pone.0137859.ref005" ref-type="bibr">5</xref>]). This will shortly be explained in greater detail. From <xref ref-type="disp-formula" rid="pone.0137859.e025">Eq (10)</xref>, it follows that expected energy 〈<italic>E</italic>〉 is equal to <italic>RT</italic>
<sup>2</sup> times the derivative of ln <italic>Z</italic>(<italic>T</italic>) with respect to <italic>formal temperature</italic>, which latter we define to be the <italic>formal temperature derivative</italic> of ln <italic>Z</italic>(<italic>T</italic>).</p>
      <p>If we treat the energy <italic>E</italic>(<italic>s</italic>) of structure <italic>s</italic> as a constant (computed at either the default temperature of 37°C, or at a user-specified temperature <italic>T</italic>), then the second term of <xref ref-type="disp-formula" rid="pone.0137859.e034">Eq (12)</xref> disappears, and we can approximate <inline-formula id="pone.0137859.e026"><alternatives><graphic xlink:href="pone.0137859.e026.jpg" id="pone.0137859.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mrow><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> by the finite difference <inline-formula id="pone.0137859.e027"><alternatives><graphic xlink:href="pone.0137859.e027.jpg" id="pone.0137859.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:mrow><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, where for instance Δ<italic>T</italic> = 10<sup>−7</sup>. This requires a modification of McCaskill’s algorithm [<xref rid="pone.0137859.ref011" ref-type="bibr">11</xref>] for the partition function <italic>Z</italic>(<italic>T</italic>), where we distinguish between <italic>formal temperature</italic> and <italic>table temperature</italic>. Our software <monospace>RNAentropy</monospace> implements such a modification, and thus supports the formal temperature derivative (FTD) method of computing thermodynamic structural entropy.</p>
      <p>Note that the function ln <italic>Z</italic>(<italic>T</italic>) is decreasing and concave down, so barring numerical precision errors, the finite difference <inline-formula id="pone.0137859.e028"><alternatives><graphic xlink:href="pone.0137859.e028.jpg" id="pone.0137859.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mfrac><mml:mrow><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> is negative and slightly larger in absolute value than the formal temperature derivative <inline-formula id="pone.0137859.e029"><alternatives><graphic xlink:href="pone.0137859.e029.jpg" id="pone.0137859.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. From <xref ref-type="disp-formula" rid="pone.0137859.e018">Eq (6)</xref>, structural entropy <italic>H</italic> is equal to 〈<italic>E</italic>〉/<italic>RT</italic> + ln <italic>Z</italic> and so there will be a small numerical deviation between the value of <italic>H</italic>, computed by the FTD (formal temperature derivative) method currently described, and the exact value of <italic>H</italic> computed by the DP (dynamic programming) method, described in Section “Entropy by dynamic programming”. In particular, entropy values computed by FTD should be slightly smaller than those computed by DP, where the discrepancy will be visible only for large sequence length. This is indeed observed in <xref ref-type="fig" rid="pone.0137859.g001">Fig 1B</xref> and in data not shown.</p>
      <fig id="pone.0137859.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137859.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <p><italic>(A)</italic> Average run times, with (tiny) error-bars of ±1 standard deviation, for each of the five methods DP, FTD (Δ<italic>T</italic> = 10<sup>−7</sup>), SCFG(G6,Benchmark), SCFG(G4,Benchmark), and SCFG(G5,Benchmark). Averages were determined for 100 random RNA sequences of length <italic>n</italic>, each having expected compositional frequency of 0.25 for A,C,G,U, where <italic>n</italic> ranges from 20 to 500 with increments of 5. Methods tested are as follows: (1) DP: dynamic programming computation of expected energy 〈<italic>E</italic>〉 and partition function to yield <italic>H</italic> = 〈<italic>E</italic>〉/<italic>RT</italic> + ln <italic>Z</italic>, with Turner 2004 energy parameters. (2) FTD: formal temperature derivative method which computes <inline-formula id="pone.0137859.e030"><alternatives><graphic id="pone.0137859.e030g" xlink:href="pone.0137859.e030"/><mml:math id="M30"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>E</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, where the temperature increment <italic>T</italic>+Δ<italic>T</italic> is applied only to occurrences of <italic>T</italic> within the expression <italic>RT</italic>—i.e. <italic>formal temperature</italic>, as explained in the text. Increment Δ<italic>T</italic> is 10<sup>−7</sup>, and Turner 2004 energy parameters are used. (3) SCFG: computation of derivational entropy using the method of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>], for the grammars G4, G5, G6 with grammar rule probabilities from ‘Benchmark’ data (see [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>, <xref rid="pone.0137859.ref028" ref-type="bibr">28</xref>]). SCFG executables and models downloaded from <monospace><ext-link ext-link-type="uri" xlink:href="http://rna-informatics.uga.edu/malmberg/">http://rna-informatics.uga.edu/malmberg/</ext-link></monospace>. The methods, ordered from fastest to slowest, are as follows: FTD, DP, G5, G6, G4, where FTD and DP are approximately equally fast, while the slowest methods, G6 and G4, have almost identical run times. DP and FTD are an order of magnitude faster than G6. <italic>(B)</italic> Average entropy values, with error bars of ±1 standard deviation, computed by the methods DP, FTD (Δ<italic>T</italic> = 10<sup>−7</sup>), SCFG(G4,Benchmark), SCFG(G5,Benchmark), and SCFG(G6,Benchmark) for the same data set as in the left panel. The methods, ordered from those returning smallest entropy values to largest, are as follows: FTD, DP, G6, G4, G5. FTD and DP return essentially identical values, with a small deviation for larger sequences due to the finite approximation of the formal temperature derivative.</p>
        </caption>
        <graphic xlink:href="pone.0137859.g001"/>
      </fig>
      <p>We now show that the expression, <inline-formula id="pone.0137859.e031"><alternatives><graphic xlink:href="pone.0137859.e031.jpg" id="pone.0137859.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:mrow><mml:mo>〈</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, occurring as the second term in the last line of <xref ref-type="disp-formula" rid="pone.0137859.e025">Eq (10)</xref>, is equal to −<italic>T</italic> ⋅ 〈<italic>S</italic>
<sub><italic>t</italic></sub>〉 where 〈<italic>S</italic>
<sub><italic>t</italic></sub>〉 denotes the expected change in entropy using the Turner parameters [<xref rid="pone.0137859.ref005" ref-type="bibr">5</xref>], determined as follows. From statistical physics, the free energy <italic>E</italic>(<italic>s</italic>) of a secondary structure <italic>s</italic> satisfies
<disp-formula id="pone.0137859.e032"><alternatives><graphic xlink:href="pone.0137859.e032.jpg" id="pone.0137859.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>T</mml:mi><mml:mspace width="1pt"/><mml:mo>·</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula>
where <italic>H</italic>
<sub><italic>t</italic></sub>(<italic>s</italic>) [resp. <italic>S</italic>
<sub><italic>t</italic></sub>(<italic>s</italic>)] denotes change in enthalpy [resp. entropy] from the empty structure to structure <italic>s</italic> using the Turner parameters. The term <italic>S</italic>
<sub><italic>t</italic></sub> measures the entropic loss due to stacked base pairs, hairpins, bulges, internal loops and multiloops using parameters obtained from least-squares fitting of UV absorption data. In the Turner energy model, entropy <italic>S</italic>
<sub><italic>t</italic></sub> and enthalpy <italic>H</italic>
<sub><italic>t</italic></sub> are assumed to be independent of temperature, so it follows from <xref ref-type="disp-formula" rid="pone.0137859.e032">Eq (11)</xref> that <inline-formula id="pone.0137859.e033"><alternatives><graphic xlink:href="pone.0137859.e033.jpg" id="pone.0137859.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and hence
<disp-formula id="pone.0137859.e034"><alternatives><graphic xlink:href="pone.0137859.e034.jpg" id="pone.0137859.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>〈</mml:mo><mml:mi>E</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mo>·</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula>
</p>
      <p>To compute <italic>S</italic>
<sub><italic>t</italic></sub>(<italic>s</italic>) for a given secondary structure <italic>s</italic> of an RNA sequence <bold>a</bold>, determine the the free energy <italic>E</italic>(<italic>s</italic>, 37) [resp. <italic>E</italic>(<italic>s</italic>, 38)] of structure <italic>s</italic> at 37°C [resp. 38°C] by using Vienna RNA Package <monospace>RNAeval</monospace>[<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>]; it then follows from <xref ref-type="disp-formula" rid="pone.0137859.e032">Eq (11)</xref> that <italic>S</italic>
<sub><italic>t</italic></sub>(<italic>s</italic>) = <italic>E</italic>(<italic>s</italic>, 37)−<italic>E</italic>(<italic>s</italic>, 38). Throughout this paragraph, the reader should not confuse the notion of <italic>conformational entropy</italic> from <xref ref-type="disp-formula" rid="pone.0137859.e001">Eq (1)</xref>, which is always non-zero and is computed by the novel algorithms described in this paper, with the notion of <italic>Turner change of entropy</italic>
<italic>S</italic>
<sub><italic>t</italic></sub>(<italic>s</italic>) of secondary structure <italic>s</italic>, which is always negative due to entropic loss in going from the empty structure to a fixed structure <italic>s</italic>. Nor should the reader confuse the notion of <italic>structural entropy</italic>, denoted by <italic>H</italic> and defined in <xref ref-type="disp-formula" rid="pone.0137859.e003">Eq (2)</xref>, with <italic>Turner change of enthalpy</italic>
<italic>H</italic>
<sub><italic>t</italic></sub>(<italic>s</italic>) of secondary structure <italic>s</italic>.</p>
    </sec>
    <sec id="sec010">
      <title>Entropy by dynamic programming</title>
      <p>Throughout this section, <inline-formula id="pone.0137859.e035"><alternatives><graphic xlink:href="pone.0137859.e035.jpg" id="pone.0137859.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:mrow><mml:mi mathvariant="bold">a</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> denotes an arbitrary but fixed RNA sequence. Below, we give recursions for <italic>Q</italic>(<italic>a</italic>), defined by <italic>Q</italic>(<italic>a</italic>) = ∑<sub><italic>s</italic></sub>
<italic>BF</italic>(<italic>s</italic>) ⋅ <italic>E</italic>(<italic>s</italic>), where the sum is taken over all secondary structures <italic>s</italic> of RNA sequence <bold>a</bold>, <italic>E</italic>(<italic>s</italic>) is the free energy of <italic>s</italic>, using the Turner 2004 parameters, <italic>BF</italic>(<italic>s</italic>) = exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>) is the Boltzmann factor of structure <italic>s</italic>, where <italic>R</italic> is the universal gas constant and <italic>T</italic> the temperature in Kelvin.</p>
      <p>Recursions are also given for the partition function <italic>Z</italic>(<italic>a</italic>) = ∑<sub><italic>s</italic></sub>exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>), where the sum is taken over all secondary structures of <bold>a</bold>. It follows that the expected energy
<disp-formula id="pone.0137859.e036"><alternatives><graphic xlink:href="pone.0137859.e036.jpg" id="pone.0137859.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>E</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>Z</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(13)</label></disp-formula>
</p>
      <p>For 1 ≤ <italic>i</italic> ≤ <italic>j</italic> ≤ <italic>n</italic>, the collection of all secondary structures of <inline-formula id="pone.0137859.e037"><alternatives><graphic xlink:href="pone.0137859.e037.jpg" id="pone.0137859.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:mrow><mml:mi mathvariant="bold">a</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is denoted <inline-formula id="pone.0137859.e038"><alternatives><graphic xlink:href="pone.0137859.e038.jpg" id="pone.0137859.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:mrow><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. In contrast, if <italic>s</italic> is a secondary structure of <italic>a</italic>
<sub>1</sub>, …, <italic>a</italic>
<sub><italic>n</italic></sub>, then <italic>s</italic>[<italic>i</italic>, <italic>j</italic>] is the <italic>restriction</italic> of <italic>s</italic> to the interval [<italic>i</italic>, <italic>j</italic>], defined by <italic>s</italic>[<italic>i</italic>, <italic>j</italic>] = {(<italic>x</italic>, <italic>y</italic>): <italic>i</italic> ≤ <italic>x</italic> ≤ <italic>y</italic> ≤ <italic>j</italic>, (<italic>x</italic>, <italic>y</italic>) ∈ <italic>s</italic>.</p>
    </sec>
    <sec id="sec011">
      <title>Initial steps</title>
      <p>For notational convenience, we define <italic>Q</italic>
<sub><italic>i</italic>,<italic>i</italic>−1</sub> = 0 and <italic>Z</italic>
<sub><italic>i</italic>,<italic>i</italic>−1</sub> = 1. If <italic>i</italic> ≤ <italic>j</italic> &lt; <italic>i</italic> + 4, then for any secondary structure <italic>s</italic>, the restriction <italic>s</italic>[<italic>i</italic>,<italic>j</italic>] is the empty structure, denoted by <italic>j</italic> − <italic>i</italic> + 1 dots with zero energy, and so <italic>Q</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> = 0. As well, the only secondary structure on [<italic>i</italic>,<italic>j</italic>] is the empty structure, so <italic>Z</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> = 1.</p>
      <p>Now assume that <italic>i</italic> + 4 ≤ <italic>j</italic>. Since
<disp-formula id="pone.0137859.e039"><alternatives><graphic xlink:href="pone.0137859.e039.jpg" id="pone.0137859.e039g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M39"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>j</mml:mi><mml:mspace width="4.pt"/><mml:mtext>unpaired</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>in</mml:mtext><mml:mspace width="4.pt"/><mml:mi>s</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(14)</label></disp-formula>
we treat each sum in a separate case. Let <italic>bp</italic>(<italic>k</italic>, <italic>j</italic>) be a boolean valued function with the value 1 if <italic>k</italic> can base-pair with <italic>j</italic>; i.e. <italic>a</italic>
<sub><italic>k</italic></sub>
<italic>a</italic>
<sub><italic>j</italic></sub> ∈ {<italic>AU</italic>, <italic>UA</italic>, <italic>CG</italic>, <italic>GC</italic>, <italic>GU</italic>, <italic>UG</italic>}. For secondary structure <inline-formula id="pone.0137859.e040"><alternatives><graphic xlink:href="pone.0137859.e040.jpg" id="pone.0137859.e040g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M40"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, let <italic>bp</italic>(<italic>k</italic>, <italic>j</italic>, <italic>s</italic>) be a boolean function with value 1 if it is possible to add the base pair (<italic>k</italic>, <italic>j</italic>) to <italic>s</italic> and obtain a valid secondary structure; i.e. without creating a base triple or pseudoknot.</p>
      <p>C<sc>ase</sc> 1: <italic>j</italic> is unpaired in [<italic>i</italic>, <italic>j</italic>]. For <inline-formula id="pone.0137859.e041"><alternatives><graphic xlink:href="pone.0137859.e041.jpg" id="pone.0137859.e041g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M41"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in which <italic>j</italic> is unpaired, <italic>s</italic> = <italic>s</italic>[<italic>i</italic>, <italic>j</italic> − 1], <italic>BF</italic>(<italic>s</italic>) = <italic>BF</italic>(<italic>s</italic>[<italic>i</italic>, <italic>j</italic> − 1]), and <italic>E</italic>(<italic>s</italic>) = <italic>E</italic>(<italic>s</italic>[<italic>i</italic>, <italic>j</italic>−1]). The contribution to <italic>Q</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> in this case is given by <italic>Q</italic>
<sub><italic>i</italic>,<italic>j</italic>−1</sub>.</p>
      <p>C<sc>ase</sc> 2: <italic>j</italic> is paired in [<italic>i</italic>, <italic>j</italic>]. The contribution to <italic>Q</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> in this case is given by
<disp-formula id="pone.0137859.e042"><alternatives><graphic xlink:href="pone.0137859.e042.jpg" id="pone.0137859.e042g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mo>+</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>[</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>[</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munderover><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mo>{</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="4.pt"/></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:munder><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>[</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munderover><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mo>{</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="4.pt"/></mml:mrow></mml:munder><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:munder><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mo/><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="4.pt"/></mml:mrow></mml:munder><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:munder><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munderover><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mi>Z</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mi>Q</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(15)</label></disp-formula>
</p>
      <p>Putting together the contributions from both cases, we have
<disp-formula id="pone.0137859.e043"><alternatives><graphic xlink:href="pone.0137859.e043.jpg" id="pone.0137859.e043g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munderover><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>Q</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(16)</label></disp-formula>
</p>
    </sec>
    <sec id="sec012">
      <title>Recursions for the Turner nearest neighbor energy model</title>
      <p>In the nearest neighbor energy model [<xref rid="pone.0137859.ref005" ref-type="bibr">5</xref>, <xref rid="pone.0137859.ref039" ref-type="bibr">39</xref>], free energies are defined not for base pairs, but rather for <italic>loops</italic> in the loop decomposition of a secondary structure. In particular, there are stabilizing, negative free energies for stacked base pairs and destabilizing, positive free energies for hairpins, bulges, internal loops, and multiloops.</p>
      <p>In this section, free energy parameters for base stacking and loops are from the Turner 2004 energy model [<xref rid="pone.0137859.ref005" ref-type="bibr">5</xref>]. As in the previous subsection, <italic>Q</italic>, <italic>Z</italic> are defined, but now with respect to the Turner model.</p>
      <disp-formula id="pone.0137859.e044">
        <alternatives>
          <graphic xlink:href="pone.0137859.e044.jpg" id="pone.0137859.e044g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M44">
            <mml:mtable displaystyle="true">
              <mml:mtr>
                <mml:mtd columnalign="right">
                  <mml:msub>
                    <mml:mi>Q</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mtd>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                </mml:mtd>
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                        <mml:mo>∈</mml:mo>
                        <mml:mtext mathvariant="double-struck">SS</mml:mtext>
                        <mml:mo>[</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>j</mml:mi>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mi>E</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mi>s</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>·</mml:mo>
                    <mml:mo form="prefix">exp</mml:mo>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mo>-</mml:mo>
                      <mml:mi>E</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>s</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>/</mml:mo>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </alternatives>
        <label>(17)</label>
      </disp-formula>
      <disp-formula id="pone.0137859.e045">
        <alternatives>
          <graphic xlink:href="pone.0137859.e045.jpg" id="pone.0137859.e045g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M45">
            <mml:mtable displaystyle="true">
              <mml:mtr>
                <mml:mtd columnalign="right">
                  <mml:msub>
                    <mml:mi>Z</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mtd>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                </mml:mtd>
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                        <mml:mo>∈</mml:mo>
                        <mml:mtext mathvariant="double-struck">SS</mml:mtext>
                        <mml:mo>[</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>j</mml:mi>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mo form="prefix">exp</mml:mo>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mo>-</mml:mo>
                      <mml:mi>E</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>s</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>/</mml:mo>
                      <mml:mi>R</mml:mi>
                      <mml:mi>T</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>.</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </alternatives>
      </disp-formula>
      <p>It follows that <italic>Z</italic> = <italic>Z</italic>
<sub>1,<italic>n</italic></sub> is the partition function for secondary structures (the Boltzmann weighted counting of all structures of <inline-formula id="pone.0137859.e046"><alternatives><graphic xlink:href="pone.0137859.e046.jpg" id="pone.0137859.e046g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M46"><mml:mi mathvariant="bold">a</mml:mi></mml:math></alternatives></inline-formula>) and
<disp-formula id="pone.0137859.e047"><alternatives><graphic xlink:href="pone.0137859.e047.jpg" id="pone.0137859.e047g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M47"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">S</mml:mi><mml:mi mathvariant="double-struck">S</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">S</mml:mi><mml:mi mathvariant="double-struck">S</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>Z</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(18)</label></disp-formula>
</p>
      <p>To complete the derivation of recursions, we must define <italic>QB</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> and <italic>ZB</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> for the Turner model.</p>
      <p>To provide a self-contained treatment, we recall McCaskill’s algorithm [<xref rid="pone.0137859.ref011" ref-type="bibr">11</xref>], which efficiently computes the partition function. For RNA nucleotide sequence <inline-formula id="pone.0137859.e048"><alternatives><graphic xlink:href="pone.0137859.e048.jpg" id="pone.0137859.e048g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M48"><mml:mrow><mml:mi mathvariant="bold">a</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, let <italic>H</italic>(<italic>i</italic>,<italic>j</italic>) denote the free energy of a hairpin closed by base pair (<italic>i</italic>, <italic>j</italic>), while <italic>IL</italic>(<italic>i</italic>, <italic>j</italic>, <italic>i</italic>′, <italic>j</italic>′) denotes the free energy of an <italic>internal loop</italic> enclosed by the base pairs (<italic>i</italic>, <italic>j</italic>) and (<italic>i</italic>′, <italic>j</italic>′), where <italic>i</italic> &lt; <italic>i</italic>′ &lt; <italic>j</italic>′ &lt; <italic>j</italic>. Internal loops comprise the cases of stacked base pairs, left/right bulges and proper internal loops. The free energy for a multiloop containing <italic>N</italic>
<sub><italic>b</italic></sub> base pairs and <italic>N</italic>
<sub><italic>u</italic></sub> unpaired bases is given by the affine approximation <italic>a</italic> + <italic>bN</italic>
<sub><italic>b</italic></sub> + <italic>cN</italic>
<sub><italic>u</italic></sub>.</p>
      <p><bold>Definition 1</bold> (Partition function <italic>Z</italic> and related function <italic>Q</italic>)
<list list-type="bullet"><list-item><p><italic>Z</italic><sub><italic>i</italic>,<italic>j</italic></sub> = ∑<sub><italic>s</italic></sub>exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>) <italic>where the sum is taken over all structures</italic>
<inline-formula id="pone.0137859.e049"><alternatives><graphic xlink:href="pone.0137859.e049.jpg" id="pone.0137859.e049g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M49"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item><list-item><p><italic>ZB</italic><sub><italic>i</italic>,<italic>j</italic></sub> = ∑<sub><italic>s</italic></sub>exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>) <italic>where the sum is taken over all structures</italic>
<inline-formula id="pone.0137859.e050"><alternatives><graphic xlink:href="pone.0137859.e050.jpg" id="pone.0137859.e050g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M50"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<italic>which contain the base pair</italic> (<italic>i</italic>,<italic>j</italic>).</p></list-item><list-item><p><italic>ZM</italic><sub><italic>i</italic>,<italic>j</italic></sub> = ∑<sub><italic>s</italic></sub>exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>) <italic>where the sum is taken over all structures</italic>
<inline-formula id="pone.0137859.e051"><alternatives><graphic xlink:href="pone.0137859.e051.jpg" id="pone.0137859.e051g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M51"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext mathvariant="double-struck">SS</mml:mtext><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<italic>which are contained within an enclosing multiloop having</italic> at <italic>least one component.</italic>
</p></list-item><list-item><p><italic>ZM</italic>1<sub><italic>i</italic>,<italic>j</italic></sub> = ∑<sub><italic>s</italic></sub>exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>) <italic>where the sum is taken over all structures s ∈ Q[i,j] which are contained within an enclosing multiloop having</italic> exactly <italic>one component. Moreover, it is</italic> required <italic>that (i,r) is a base pair of x, for some i &lt; r ≤ j.</italic>
</p></list-item><list-item><p><italic>Q</italic><sub><italic>i</italic>,<italic>j</italic></sub> = ∑<sub><italic>s</italic></sub>
<italic>E</italic>(<italic>s</italic>)⋅exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>) <italic>where the sum is taken over all structures</italic>
<italic>s</italic> ∈ <italic>ss</italic>[<italic>i</italic>,<italic>j</italic>].</p></list-item><list-item><p><italic>QB</italic><sub><italic>i</italic>,<italic>j</italic></sub> = ∑<sub><italic>s</italic></sub>
<italic>E</italic>(<italic>s</italic>)⋅exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>) <italic>where the sum is taken over all structures</italic>
<italic>s</italic> ∈ <italic>ss</italic>[<italic>i</italic>,<italic>j</italic>] <italic>which contain the base pair</italic> (<italic>i</italic>,<italic>j</italic>).</p></list-item><list-item><p><italic>QM</italic><sub><italic>i</italic>,<italic>j</italic></sub> = ∑<sub><italic>s</italic></sub>
<italic>E</italic>(<italic>s</italic>)⋅exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>) <italic>where the sum is taken over all structures</italic>
<italic>s</italic> ∈ <italic>ss</italic>[<italic>i</italic>,<italic>j</italic>] <italic>which are contained within an enclosing multiloop having</italic> at least <italic>one component</italic>.</p></list-item><list-item><p><italic>QM</italic>1<sub><italic>i</italic>,<italic>j</italic></sub> = ∑<sub><italic>s</italic></sub>
<italic>E</italic>(<italic>s</italic>)⋅exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>) <italic>where the sum is taken over all structures</italic>
<italic>s</italic> ∈ <italic>ss</italic>[<italic>i</italic>,<italic>j</italic>] <italic>which are contained within an enclosing multiloop having</italic> exactly <italic>one component. Moreover, it is</italic> required <italic>that</italic> (<italic>i</italic>,<italic>r</italic>) <italic>is a base pair of</italic>
<italic>s</italic>, <italic>for some</italic>
<italic>i</italic> &lt; <italic>r</italic> ≤ <italic>j</italic>.</p></list-item></list>
</p>
      <p>For <italic>j</italic> − <italic>i</italic> ∈ {0, 1, 2, 3}, <italic>Z</italic>(<italic>i</italic>,<italic>j</italic>) = 1, since the empty structure is the only possible secondary structure. For <italic>j</italic>−<italic>i</italic> &gt; <italic>θ</italic> = 3, we have
<disp-formula id="pone.0137859.e052"><alternatives><graphic xlink:href="pone.0137859.e052.jpg" id="pone.0137859.e052g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M52"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>Z</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mi>Z</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(19)</label></disp-formula>
<disp-formula id="pone.0137859.e053"><alternatives><graphic xlink:href="pone.0137859.e053.jpg" id="pone.0137859.e053g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Z</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mrow><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mi>H</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mi>Z</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mi>θ</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mi>Z</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mi>Z</mml:mi><mml:mi>M</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(20)</label></disp-formula>
<disp-formula id="pone.0137859.e054"><alternatives><graphic xlink:href="pone.0137859.e054.jpg" id="pone.0137859.e054g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M54"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Z</mml:mi><mml:mi>M</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>j</mml:mi></mml:munderover><mml:mi>Z</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(21)</label></disp-formula>
<disp-formula id="pone.0137859.e055"><alternatives><graphic xlink:href="pone.0137859.e055.jpg" id="pone.0137859.e055g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M55"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Z</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mi>θ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>Z</mml:mi><mml:mi>M</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mi>θ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>Z</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mi>Z</mml:mi><mml:mi>M</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo form="prefix">exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mi>b</mml:mi><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(22)</label></disp-formula>
</p>
      <p>B<sc>ase</sc> C<sc>ase</sc>: For <italic>j</italic> − <italic>i</italic> ∈ {−1, 0, 1, 2, 3}, <italic>Q</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> = <italic>QB</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> = 0, <italic>Z</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> = 1, <italic>ZB</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> = <italic>ZM</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> = <italic>ZM</italic>1<sub><italic>i</italic>,<italic>j</italic></sub> = 0.</p>
      <p>I<sc>nductive</sc> C<sc>ase</sc>: Assume that <italic>j</italic> − <italic>i</italic> &gt; 3.</p>
      <p>C<sc>ase</sc> A: (<italic>i</italic>,<italic>j</italic>) closes a hairpin.</p>
      <p>In this case, the contribution to <italic>QB</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> is given by
<disp-formula id="pone.0137859.e056"><alternatives><graphic xlink:href="pone.0137859.e056.jpg" id="pone.0137859.e056g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M56"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo form="prefix">exp</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mspace width="1pt"/><mml:mo>·</mml:mo><mml:mspace width="1pt"/><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(23)</label></disp-formula>
</p>
      <p>C<sc>ase</sc> B: (<italic>i</italic>,<italic>j</italic>) closes a stacked base pair, bulge or internal loop, whose other closing base pair is (ℓ,<italic>r</italic>), where <italic>i</italic> &lt; ℓ &lt; <italic>r</italic> &lt; <italic>j</italic>.</p>
      <p>In this case, the contribution to <italic>QB</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> is given by the following
<disp-formula id="pone.0137859.e057"><alternatives><graphic xlink:href="pone.0137859.e057.jpg" id="pone.0137859.e057g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M57"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo movablelimits="true" form="prefix">min</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>30</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>5</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo><mml:mo>(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:mn>30</mml:mn><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>[</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>]</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mspace width="1pt"/><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mo form="prefix">exp</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>·</mml:mo><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mo>[</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(24)</label></disp-formula>
<disp-formula id="pone.0137859.e058"><alternatives><graphic xlink:href="pone.0137859.e058.jpg" id="pone.0137859.e058g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M58"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo movablelimits="true" form="prefix">min</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>31</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>5</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo><mml:mo>(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:mn>30</mml:mn><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mo form="prefix">exp</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>·</mml:mo><mml:mi>Z</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo form="prefix">exp</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mi>Q</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(25)</label></disp-formula>
</p>
      <p>In the summation notation <inline-formula id="pone.0137859.e059"><alternatives><graphic xlink:href="pone.0137859.e059.jpg" id="pone.0137859.e059g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M59"><mml:mstyle scriptlevel="0" displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:munderover></mml:mstyle></mml:math></alternatives></inline-formula>, if upper bound <italic>b</italic> is smaller than lower bound <italic>a</italic>, then we intend a loop of the form: FOR <italic>i</italic> = <italic>b</italic> downto <italic>a</italic>.</p>
      <p>C<sc>ase</sc> C: (<italic>i</italic>,<italic>j</italic>) closes a multiloop.</p>
      <p>In this case, the contribution to <italic>QB</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> is given by the following
<disp-formula id="pone.0137859.e060"><alternatives><graphic xlink:href="pone.0137859.e060.jpg" id="pone.0137859.e060g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M60"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="4.pt"/><mml:mtext>closes</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>a</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>multiloop</mml:mtext></mml:mrow></mml:munder><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives><label>(26)</label></disp-formula>
<disp-formula id="pone.0137859.e061"><alternatives><graphic xlink:href="pone.0137859.e061.jpg" id="pone.0137859.e061g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M61"><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:munderover><mml:mo form="prefix">exp</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mspace width="4.pt"/><mml:mtext>base-paired</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>in</mml:mtext><mml:mspace width="4.pt"/><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:munder><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo></mml:mrow><mml:mo>[</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:math></alternatives><label>(27)</label></disp-formula>
<disp-formula id="pone.0137859.e062"><alternatives><graphic xlink:href="pone.0137859.e062.jpg" id="pone.0137859.e062g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M62"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mtext>exp</mml:mtext></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>r</mml:mi><mml:mtext>base-paired in</mml:mtext><mml:mspace width="1pt"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mi>B</mml:mi></mml:mstyle><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mtext>exp</mml:mtext></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo/></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mi>B</mml:mi></mml:mstyle><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>r</mml:mi><mml:mtext>base-paired in</mml:mtext><mml:mspace width="1pt"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mi>B</mml:mi></mml:mstyle><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mtext>exp</mml:mtext></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo/></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mi>B</mml:mi></mml:mstyle><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>r</mml:mi><mml:mtext>base-paired in</mml:mtext><mml:mspace width="1pt"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mi>B</mml:mi></mml:mstyle><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mtext>exp</mml:mtext></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>Z</mml:mi><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>Z</mml:mi><mml:mi>M</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>Z</mml:mi><mml:mi>M</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>Z</mml:mi><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>Q</mml:mi><mml:mi>M</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(28)</label></disp-formula>
</p>
      <p>Now <italic>QB</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> = <italic>A</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> + <italic>B</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> + <italic>C</italic>
<sub><italic>i</italic>,<italic>j</italic></sub>. It nevertheless remains to define the recursions for <italic>QM</italic>1<sub><italic>i</italic>,<italic>j</italic></sub> and <italic>QM</italic>
<sub><italic>i</italic>,<italic>j</italic></sub>. These satisfy the following.</p>
      <disp-formula id="pone.0137859.e063">
        <alternatives>
          <graphic xlink:href="pone.0137859.e063.jpg" id="pone.0137859.e063g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M63">
            <mml:mtable displaystyle="true">
              <mml:mtr>
                <mml:mtd columnalign="right">
                  <mml:mrow>
                    <mml:mi>Q</mml:mi>
                    <mml:mi>M</mml:mi>
                    <mml:msub>
                      <mml:mn>1</mml:mn>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mtd>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                </mml:mtd>
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>4</mml:mn>
                      </mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:munderover>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd>
                              <mml:mi>s</mml:mi>
                              <mml:mo>∈</mml:mo>
                              <mml:mi>s</mml:mi>
                              <mml:mi>s</mml:mi>
                              <mml:mo>[</mml:mo>
                              <mml:mi>i</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>k</mml:mi>
                              <mml:mo>]</mml:mo>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>k</mml:mi>
                                <mml:mo>)</mml:mo>
                                <mml:mo>∈</mml:mo>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mo form="prefix">exp</mml:mo>
                    <mml:mo>(</mml:mo>
                    <mml:mo>-</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                        <mml:mo>(</mml:mo>
                        <mml:mi>j</mml:mi>
                        <mml:mo>-</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>R</mml:mi>
                        <mml:mi>T</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>)</mml:mo>
                    <mml:mo>·</mml:mo>
                    <mml:mi>B</mml:mi>
                    <mml:mi>F</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mi>s</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>·</mml:mo>
                    <mml:mo>[</mml:mo>
                    <mml:mi>c</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>j</mml:mi>
                    <mml:mo>-</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>+</mml:mo>
                    <mml:mi>E</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd/>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                </mml:mtd>
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>4</mml:mn>
                      </mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:munderover>
                    <mml:mo form="prefix">exp</mml:mo>
                    <mml:mo>(</mml:mo>
                    <mml:mo>-</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                        <mml:mo>(</mml:mo>
                        <mml:mi>j</mml:mi>
                        <mml:mo>-</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>R</mml:mi>
                        <mml:mi>T</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>)</mml:mo>
                    <mml:mo>·</mml:mo>
                    <mml:mo>[</mml:mo>
                    <mml:mi>c</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mi>j</mml:mi>
                      <mml:mo>-</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>·</mml:mo>
                    <mml:mi>Z</mml:mi>
                    <mml:mi>B</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>+</mml:mo>
                    <mml:mi>Q</mml:mi>
                    <mml:msub>
                      <mml:mi>B</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>]</mml:mo>
                    <mml:mo>.</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </alternatives>
        <label>(29)</label>
      </disp-formula>
      <disp-formula id="pone.0137859.e064">
        <alternatives>
          <graphic xlink:href="pone.0137859.e064.jpg" id="pone.0137859.e064g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M64">
            <mml:mrow>
              <mml:mi>Q</mml:mi>
              <mml:msub>
                <mml:mi>M</mml:mi>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mspace width="1pt"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="1pt"/>
              <mml:mi>Q</mml:mi>
              <mml:mi>M</mml:mi>
              <mml:msub>
                <mml:mi>A</mml:mi>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:mi>Q</mml:mi>
              <mml:mi>M</mml:mi>
              <mml:msub>
                <mml:mi>B</mml:mi>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>(30)</label>
      </disp-formula>
      <disp-formula id="pone.0137859.e065">
        <alternatives>
          <graphic xlink:href="pone.0137859.e065.jpg" id="pone.0137859.e065g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M65">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>Q</mml:mi>
                  <mml:mi>M</mml:mi>
                  <mml:msub>
                    <mml:mi>A</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mtd>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                </mml:mtd>
                <mml:mtd>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mi>θ</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mtable>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mo>∈</mml:mo>
                                  <mml:mi>s</mml:mi>
                                  <mml:mi>s</mml:mi>
                                  <mml:mo stretchy="false">[</mml:mo>
                                  <mml:mi>r</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>j</mml:mi>
                                  <mml:mo stretchy="false">]</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                  <mml:mtext>pairs in</mml:mtext>
                                  <mml:mspace width="1pt"/>
                                  <mml:mo stretchy="false">[</mml:mo>
                                  <mml:mi>r</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>j</mml:mi>
                                  <mml:mo stretchy="false">]</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:munder>
                        <mml:mrow>
                          <mml:mtext>exp</mml:mtext>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>c</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>r</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>⋅</mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>E</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>s</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>⋅</mml:mo>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>c</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>r</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>+</mml:mo>
                      <mml:mi>E</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>s</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd/>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                </mml:mtd>
                <mml:mtd>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mi>θ</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mtext>exp</mml:mtext>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>c</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>r</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>⋅</mml:mo>
                  <mml:mrow>
                    <mml:mo>{</mml:mo>
                    <mml:mrow>
                      <mml:mi>Z</mml:mi>
                      <mml:mi>M</mml:mi>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>r</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>j</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>⋅</mml:mo>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>b</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>c</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>r</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>+</mml:mo>
                      <mml:mi>Q</mml:mi>
                      <mml:mi>M</mml:mi>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>r</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>j</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>}</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>Q</mml:mi>
                  <mml:mi>M</mml:mi>
                  <mml:msub>
                    <mml:mi>B</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mtd>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                </mml:mtd>
                <mml:mtd>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>5</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mi>θ</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mtable>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mi>s</mml:mi>
                                    <mml:mn>1</mml:mn>
                                  </mml:msub>
                                  <mml:mo>∈</mml:mo>
                                  <mml:mi>s</mml:mi>
                                  <mml:mi>s</mml:mi>
                                  <mml:mo stretchy="false">[</mml:mo>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>r</mml:mi>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo stretchy="false">]</mml:mo>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mo/>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:munder>
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:munder>
                              <mml:mo>∑</mml:mo>
                              <mml:mtable>
                                <mml:mtr>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mi>s</mml:mi>
                                        <mml:mn>2</mml:mn>
                                      </mml:msub>
                                      <mml:mo>∈</mml:mo>
                                      <mml:mi>s</mml:mi>
                                      <mml:mi>s</mml:mi>
                                      <mml:mo stretchy="false">[</mml:mo>
                                      <mml:mi>r</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo stretchy="false">]</mml:mo>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                                <mml:mtr>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                      <mml:mtext>pairs in</mml:mtext>
                                      <mml:mspace width="1pt"/>
                                      <mml:mo stretchy="false">[</mml:mo>
                                      <mml:mi>r</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo stretchy="false">]</mml:mo>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                              </mml:mtable>
                            </mml:munder>
                            <mml:mrow>
                              <mml:mtext>exp</mml:mtext>
                            </mml:mrow>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mi>b</mml:mi>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>⋅</mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>E</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>⋅</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd/>
                <mml:mtd/>
                <mml:mtd>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>E</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msub>
                            <mml:mi>s</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>⋅</mml:mo>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>E</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>+</mml:mo>
                      <mml:mi>E</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd/>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                </mml:mtd>
                <mml:mtd>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mi>b</mml:mi>
                        <mml:mrow>
                          <mml:mi>R</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>⋅</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>5</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>4</mml:mn>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mo>⋅</mml:mo>
                          <mml:mi>Z</mml:mi>
                          <mml:mi>M</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>r</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>⋅</mml:mo>
                          <mml:mi>Z</mml:mi>
                          <mml:mi>M</mml:mi>
                          <mml:mn>1</mml:mn>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>r</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>+</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd/>
                <mml:mtd/>
                <mml:mtd>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mi>Q</mml:mi>
                      <mml:mi>M</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>r</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>⋅</mml:mo>
                      <mml:mi>Z</mml:mi>
                      <mml:mi>M</mml:mi>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>r</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>j</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>+</mml:mo>
                      <mml:mi>Z</mml:mi>
                      <mml:mi>M</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>r</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>⋅</mml:mo>
                      <mml:mi>Q</mml:mi>
                      <mml:mi>M</mml:mi>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>r</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>j</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>}</mml:mo>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </alternatives>
        <label>(31)</label>
      </disp-formula>
      <p>This completes the derivation of the recursions for expected energy.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec013">
    <title>Results</title>
    <p>In this section, we describe a detailed comparison of our thermodynamic entropy algorithms FTD and DP, both implemented in the publicly available program <monospace>RNAentropy</monospace>, with the algorithm of Manzourolajdad et al. [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>] which computes the derivational entropy for trained RNA stochastic context free grammars. Subsequently, we show that by accounting for structural entropy, there is an improvement in the correlation between hammerhead ribozyme cleavage activity and total free energy, extending a result of Shao et al. [<xref rid="pone.0137859.ref032" ref-type="bibr">32</xref>].</p>
    <sec id="sec014">
      <title>Comparison of structural entropy and derivational entropy</title>
      <p>Using random RNA, 960 seed alignment sequences from Rfam family RF00005, and a collection of 2450 sequences obtained by selecting the first RNA from the seed alignment of each family from the Rfam 11.0 database [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>], we show the following.
<list list-type="order"><list-item><p>The thermodynamic structural entropy algorithms DP, FTD compute the same structural entropy values with the same efficiency, although as sequence length increases, FTD runs somewhat faster and returns slightly smaller values than does DP, since FTD uses a finite difference to approximate the derivative of the logarithm of the partition function.</p></list-item><list-item><p>DP and FTD appear to be an order of magnitude faster than the SCFG method of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>], which latter requires two minutes for RNA sequences of length 500 that require only a few seconds for DP and FTD.</p></list-item><list-item><p>Derivational entropy values computed by the method of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>] are much larger than thermodynamic structural entropy values of DP and FTD, ranging from about 4–8 times larger,depending on the SCFG chosen.</p></list-item><list-item><p>The length-normalized correlation between thermodynamic structural entropy values and derivational entropy values is poor to moderately weak.</p></list-item></list>
</p>
      <p>Unless otherwise specified, throughout this paper, FTD, DP and SCFG refer to the formal temperature derivative method (Algorithm 1, with Turner’04 parameters), the dynamic programming method (Algorithm 2, with Turner’04 parameters), and the stochastic context free grammar method of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>]. SCFG(G4), SCFG(G5), SCFG(G6) respectively refer to the SCFG method of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>] using the stochastic context free grammars G4, G5, and G6. Additionally, there are three different training sets for each grammar: Rfam5, Mixed80 and Benchmark—see [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>] for explanations of the training sets. Thus SCFG(G6,Benchmark) refers to derivational entropy, computed by the algorithm of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>], using grammar G6 with training set Benchmark, etc.</p>
      <p><xref rid="pone.0137859.t001" ref-type="table">Table 1</xref> lists the average values, plus or minus one standard deviation, for the entropy values and run time (in seconds) for 960 transfer RNAs from the seed alignment of family RF00005 from Rfam 11.0 [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>]. Results for five methods are presented: (1) the dynamic programming method of this paper, using the Turner 2004 free energy parameters (DP), (2) approximating the formal temperature derivative <inline-formula id="pone.0137859.e066"><alternatives><graphic xlink:href="pone.0137859.e066.jpg" id="pone.0137859.e066g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M66"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> by finite differences, and subsequently applying Eqs (<xref ref-type="disp-formula" rid="pone.0137859.e025">10</xref> and <xref ref-type="disp-formula" rid="pone.0137859.e018">6</xref>), using Turner 2004 free energy parameters (FTD); (3,4,5) using the program of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>] respectively with the stochastic context free grammars G4, G5, and G6 trained on the dataset ‘Rfam5’. For the 960 transfer RNAs from the Rfam database, this table shows that entropy values computed by DP and FTD are four to eight times smaller than derivational entropy values returned by the program of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>], while DP and FTD run five to ten times faster than the program of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>]—run times and derivational entropy values heavily depend on the grammar chosen and the training set used for production rule probabilities.</p>
      <table-wrap id="pone.0137859.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137859.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Average values for structural entropy and run time (in seconds) for the 960 transfer RNA sequences from the seed alignment of Rfam family RF00005.</title>
          <p>Methods include: DP: dynamic programming algorithm from our program <monospace>RNAentropy</monospace>, using the Turner 2004 energy parameters; FTD (Δ<italic>T</italic> = 10<sup>−7</sup>): finite difference computation of <inline-formula id="pone.0137859.e067"><alternatives><graphic id="pone.0137859.e067g" xlink:href="pone.0137859.e067"/><mml:math id="M67"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>E</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="normal">ln</mml:mi><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, where formal and table temperature are <italic>uncoupled</italic>, and formal temperature increment is 10<sup>−7</sup>; SCFG(G4,Rfam5): SCFG method [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>] using grammar G4 with training dataset ‘Rfam5’ SCFG(G5,Rfam5): SCFG method using grammar G5 with training dataset ‘Rfam5’ SCFG(G6,Rfam5): SCFG method using grammar G6 with training dataset ‘Rfam5’. FTD returns very similar values for temperature increments 10<sup>−7</sup> ≤ Δ<italic>T</italic> ≤ 10<sup>−11</sup>; however, for smaller temperature increments, there is a slight deviation due to numerical precision issues—for example, average entropy of FTD with Δ<italic>T</italic> = 10<sup>−12</sup> is 5.238878±1.504748, with similar run times as other FTD runs.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0137859.t001g" xlink:href="pone.0137859.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Method</th>
                <th align="left" rowspan="1" colspan="1">Entropy (<italic>μ</italic>±<italic>σ</italic>)</th>
                <th align="left" rowspan="1" colspan="1">Run Time (<italic>μ</italic>±<italic>σ</italic>)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">DP</td>
                <td align="left" rowspan="1" colspan="1">5.953±1.381</td>
                <td align="left" rowspan="1" colspan="1">0.074±0.017</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">FTD (Δ<italic>T</italic> = 10<sup>−7</sup>)</td>
                <td align="left" rowspan="1" colspan="1">5.532±1.342</td>
                <td align="left" rowspan="1" colspan="1">0.058±0.014</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SCFG(G4,Rfam5)</td>
                <td align="left" rowspan="1" colspan="1">39.917±2.885</td>
                <td align="left" rowspan="1" colspan="1">0.437±0.096</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SCFG(G5,Rfam5)</td>
                <td align="left" rowspan="1" colspan="1">40.682±3.053</td>
                <td align="left" rowspan="1" colspan="1">0.204±0.046</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SCFG(G6,Rfam5)</td>
                <td align="left" rowspan="1" colspan="1">21.207±2.412</td>
                <td align="left" rowspan="1" colspan="1">0.433±0.096</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p><xref rid="pone.0137859.t002" ref-type="table">Table 2</xref> presents the Pearson correlation for entropy values of 960 transfer RNAs from the seed alignment of family RF00005 from the database Rfam 11.0 [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>]. The upper-triangular [resp. lower-triangular] entries are correlations for <italic>unnormalized</italic> [resp. <italic>length-normalized</italic>] entropy values. Entropy values were computed for the same methods as in <xref rid="pone.0137859.t001" ref-type="table">Table 1</xref>. Since there is little variation in sequence length for the transfer RNAs in the seed alignment of RF00005 (average length is 73.41±5.13), any correlation due to sequence length is eliminated. The table shows the poor correlation between SCFG structural entropy, as computed by each grammar, with thermodynamic structural entropy.</p>
      <table-wrap id="pone.0137859.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137859.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Pearson correlation for entropy values of 960 transfer RNAs from the seed alignment of family RF00005 from the database Rfam 11.0 [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>].</title>
          <p>Upper-triangular entries are for <italic>unnormalized</italic> entropy values, while lower-triangular entries are for <italic>length-normalized</italic> entropy values. Entropy values were computed for the same methods described in <xref ref-type="fig" rid="pone.0137859.g001">Fig 1</xref>; in particular, all SCFGs were trained with RF00005, as described in [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>].</p>
        </caption>
        <alternatives>
          <graphic id="pone.0137859.t002g" xlink:href="pone.0137859.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Norm ∖ Unnorm</th>
                <th align="left" rowspan="1" colspan="1">DP</th>
                <th align="left" rowspan="1" colspan="1">FTD (Δ<italic>T</italic> = 10<sup>−7</sup>)</th>
                <th align="left" rowspan="1" colspan="1">G4</th>
                <th align="left" rowspan="1" colspan="1">G5</th>
                <th align="left" rowspan="1" colspan="1">G6</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">DP</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">0.905</td>
                <td align="left" rowspan="1" colspan="1">0.294</td>
                <td align="left" rowspan="1" colspan="1">0.256</td>
                <td align="left" rowspan="1" colspan="1">0.451</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">FTD (Δ<italic>T</italic> = 10<sup>−7</sup>)</td>
                <td align="left" rowspan="1" colspan="1">0.919</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">0.142</td>
                <td align="left" rowspan="1" colspan="1">0.116</td>
                <td align="left" rowspan="1" colspan="1">0.398</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SCFG(G4,Rfam5)</td>
                <td align="left" rowspan="1" colspan="1">0.314</td>
                <td align="left" rowspan="1" colspan="1">0.301</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">0.969</td>
                <td align="left" rowspan="1" colspan="1">0.666</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SCFG(G5,Rfam5)</td>
                <td align="left" rowspan="1" colspan="1">0.247</td>
                <td align="left" rowspan="1" colspan="1">0.263</td>
                <td align="left" rowspan="1" colspan="1">0.720</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">0.619</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SCFG(G6,Rfam5)</td>
                <td align="left" rowspan="1" colspan="1">0.428</td>
                <td align="left" rowspan="1" colspan="1">0.458</td>
                <td align="left" rowspan="1" colspan="1">0.541</td>
                <td align="left" rowspan="1" colspan="1">0.462</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p><xref rid="pone.0137859.t003" ref-type="table">Table 3</xref> presents the average positional entropy, length-normalized structural entropy, and corresponding Z-scores for a small collection of experimentally confirmed conformational switches, collected by Giegerich et al. [<xref rid="pone.0137859.ref041" ref-type="bibr">41</xref>], and available on the <monospace>RNAentropy</monospace> web server. There appears to be no clear entropic signal for conformational switches, at least with respect to this small collection of sequences.</p>
      <table-wrap id="pone.0137859.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137859.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Thermodynamic structural entropy, positional entropy, and corresponding Z-scores for a small collection of experimentally confirmed conformational switches, collected in [<xref rid="pone.0137859.ref041" ref-type="bibr">41</xref>]—sequences available at the <monospace>RNAentropy</monospace> web site.</title>
          <p>For each sequence, the positional (resp. structural) entropy <italic>x</italic> was computed, along with the mean <italic>μ</italic> and standard deviation <italic>σ</italic> of 1000 dinucleotide shuffles of the sequence. The Z-score is then <inline-formula id="pone.0137859.e068"><alternatives><graphic id="pone.0137859.e068g" xlink:href="pone.0137859.e068"/><mml:math id="M68"><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula>. Dinucleotide shuffles were computed, using the Altschul-Erikson algorithm [<xref rid="pone.0137859.ref042" ref-type="bibr">42</xref>] as implemented in [<xref rid="pone.0137859.ref043" ref-type="bibr">43</xref>]. Pearson correlation between Z-scores for positional and structural entropy is 0.4103.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0137859.t003g" xlink:href="pone.0137859.t003"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">RNA</th>
                <th align="left" rowspan="1" colspan="1">Seq len</th>
                <th align="left" rowspan="1" colspan="1">Pos Ent</th>
                <th align="left" rowspan="1" colspan="1">Norm str ent</th>
                <th align="left" rowspan="1" colspan="1">Z-score, pos ent</th>
                <th align="left" rowspan="1" colspan="1">Z-score, str ent</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Spliced-Leader</td>
                <td align="right" rowspan="1" colspan="1">56</td>
                <td align="char" char="." rowspan="1" colspan="1">0.802</td>
                <td align="char" char="." rowspan="1" colspan="1">0.075</td>
                <td align="char" char="." rowspan="1" colspan="1">0.755</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.697</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Attenuator</td>
                <td align="right" rowspan="1" colspan="1">73</td>
                <td align="char" char="." rowspan="1" colspan="1">0.326</td>
                <td align="char" char="." rowspan="1" colspan="1">0.054</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.871</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.983</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">MS2</td>
                <td align="right" rowspan="1" colspan="1">73</td>
                <td align="char" char="." rowspan="1" colspan="1">0.076</td>
                <td align="char" char="." rowspan="1" colspan="1">0.061</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.660</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.366</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">S15</td>
                <td align="right" rowspan="1" colspan="1">74</td>
                <td align="char" char="." rowspan="1" colspan="1">0.191</td>
                <td align="char" char="." rowspan="1" colspan="1">0.079</td>
                <td align="char" char="." rowspan="1" colspan="1">-2.242</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.734</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">E coli dsrA</td>
                <td align="right" rowspan="1" colspan="1">85</td>
                <td align="char" char="." rowspan="1" colspan="1">0.331</td>
                <td align="char" char="." rowspan="1" colspan="1">0.096</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.557</td>
                <td align="char" char="." rowspan="1" colspan="1">1.444</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HDV ribozyme</td>
                <td align="right" rowspan="1" colspan="1">107</td>
                <td align="char" char="." rowspan="1" colspan="1">0.326</td>
                <td align="char" char="." rowspan="1" colspan="1">0.034</td>
                <td align="char" char="." rowspan="1" colspan="1">-2.037</td>
                <td align="char" char="." rowspan="1" colspan="1">-2.424</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Tetrahymena Group I intron</td>
                <td align="right" rowspan="1" colspan="1">108</td>
                <td align="char" char="." rowspan="1" colspan="1">0.515</td>
                <td align="char" char="." rowspan="1" colspan="1">0.076</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.062</td>
                <td align="char" char="." rowspan="1" colspan="1">0.434</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">E. coli alpha operon mRNA</td>
                <td align="right" rowspan="1" colspan="1">130</td>
                <td align="char" char="." rowspan="1" colspan="1">0.251</td>
                <td align="char" char="." rowspan="1" colspan="1">0.059</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.448</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.865</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">hok</td>
                <td align="right" rowspan="1" colspan="1">142</td>
                <td align="char" char="." rowspan="1" colspan="1">0.340</td>
                <td align="char" char="." rowspan="1" colspan="1">0.087</td>
                <td align="char" char="." rowspan="1" colspan="1">0.700</td>
                <td align="char" char="." rowspan="1" colspan="1">0.608</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">3’-UTR of AMV RNA</td>
                <td align="right" rowspan="1" colspan="1">145</td>
                <td align="char" char="." rowspan="1" colspan="1">0.336</td>
                <td align="char" char="." rowspan="1" colspan="1">0.077</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.517</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.316</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">T4 td gene intron</td>
                <td align="right" rowspan="1" colspan="1">163</td>
                <td align="char" char="." rowspan="1" colspan="1">0.542</td>
                <td align="char" char="." rowspan="1" colspan="1">0.042</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.129</td>
                <td align="char" char="." rowspan="1" colspan="1">-2.365</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">thiM-Leader</td>
                <td align="right" rowspan="1" colspan="1">165</td>
                <td align="char" char="." rowspan="1" colspan="1">0.515</td>
                <td align="char" char="." rowspan="1" colspan="1">0.085</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.660</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.474</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">btuB</td>
                <td align="right" rowspan="1" colspan="1">202</td>
                <td align="char" char="." rowspan="1" colspan="1">0.830</td>
                <td align="char" char="." rowspan="1" colspan="1">0.092</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.691</td>
                <td align="char" char="." rowspan="1" colspan="1">0.362</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Sbox-metE</td>
                <td align="right" rowspan="1" colspan="1">247</td>
                <td align="char" char="." rowspan="1" colspan="1">0.237</td>
                <td align="char" char="." rowspan="1" colspan="1">0.097</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.350</td>
                <td align="char" char="." rowspan="1" colspan="1">0.727</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV-1 leader</td>
                <td align="right" rowspan="1" colspan="1">280</td>
                <td align="char" char="." rowspan="1" colspan="1">0.324</td>
                <td align="char" char="." rowspan="1" colspan="1">0.086</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.425</td>
                <td align="char" char="." rowspan="1" colspan="1">0.109</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">B. subtilis ribD leader</td>
                <td align="right" rowspan="1" colspan="1">304</td>
                <td align="char" char="." rowspan="1" colspan="1">0.471</td>
                <td align="char" char="." rowspan="1" colspan="1">0.067</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.835</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.460</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">B. subtilis ypaA leader</td>
                <td align="right" rowspan="1" colspan="1">342</td>
                <td align="char" char="." rowspan="1" colspan="1">0.428</td>
                <td align="char" char="." rowspan="1" colspan="1">0.076</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.659</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.184</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p><xref rid="pone.0137859.t004" ref-type="table">Table 4</xref> presents the number of sequences, average <italic>length-normalized</italic> thermodynamic entropy, average entropy Z-score, average <italic>length-normalized</italic> ensemble defect, and average Z-score for for sequences in the seed alignment of several RNA familes from the Rfam 11.0 [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>], as well as the precursor microRNAs from the repository MIRBASE [<xref rid="pone.0137859.ref044" ref-type="bibr">44</xref>]. Average values are given, plus or minus one standard deviation. The Z-score is defined as <inline-formula id="pone.0137859.e069"><alternatives><graphic xlink:href="pone.0137859.e069.jpg" id="pone.0137859.e069g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M69"><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula>, where <italic>x</italic> is the entropy (resp. ensemble defect) of a given sequence, and <italic>μ</italic> (resp. <italic>σ</italic> denotes the mean (resp. standard deviation) of corresponding values for 100 random sequences having the same dinucleotides, obtained by using the Altschul-Erikson dinucleotide shuffling algorithm [<xref rid="pone.0137859.ref042" ref-type="bibr">42</xref>]. As shown by this table, Rfam family members appear to have lower structural entropy as well as ensemble defect than random RNA having the same dinucleotides, although the family RF00005 of transfer RNAs shows an exception to this rule for structural entropy. The most pronounced Z-scores for structural entropy and ensemble defect are for precursor microRNAs, which have very stable stem-loop structures. These results are generally comparable, with the exception of entropy Z-scores for RF00005, with results concerning minimum free energy (MFE) Z-scores from [<xref rid="pone.0137859.ref043" ref-type="bibr">43</xref>, <xref rid="pone.0137859.ref045" ref-type="bibr">45</xref>]. Indeed, the particularly low MFE Z-scores of precursor miRNAs is used as a feature in the support vector machine <monospace>miPred</monospace> to detect microRNAs [<xref rid="pone.0137859.ref046" ref-type="bibr">46</xref>].</p>
      <table-wrap id="pone.0137859.t004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137859.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>For several large families from the Rfam 11.0 database [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>], and for MIRBASE precursor microRNA [<xref rid="pone.0137859.ref044" ref-type="bibr">44</xref>], the table presents the number of sequences (seq), length-normalized values of thermodynamic structural entropy (H) and ensemble defect (ens def), and the corresponding Z-scores for entropy and ensemble defect.</title>
          <p>For each sequence from a given RNA family, 100 random sequences were generated with the same dinucleotides, using the Altschul-Erikson dinucleotide shuffling algorithm [<xref rid="pone.0137859.ref042" ref-type="bibr">42</xref>] as implemented in [<xref rid="pone.0137859.ref043" ref-type="bibr">43</xref>]—in the case of MIRBASE, only 10 random sequences were generated for each sequence. Subsequently, Z-scores were computed as <inline-formula id="pone.0137859.e070"><alternatives><graphic id="pone.0137859.e070g" xlink:href="pone.0137859.e070"/><mml:math id="M70"><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula>, where <italic>x</italic> is the entropy (resp. ensemble defect) of a given sequence, and <italic>μ</italic> (resp. <italic>σ</italic>) is the mean (standard deviation) of 100 random sequences having the same dinucleotides.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0137859.t004g" xlink:href="pone.0137859.t004"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">RNA family</th>
                <th align="left" rowspan="1" colspan="1">seq</th>
                <th align="left" rowspan="1" colspan="1">H</th>
                <th align="left" rowspan="1" colspan="1">Z-score, H</th>
                <th align="left" rowspan="1" colspan="1">ens def</th>
                <th align="left" rowspan="1" colspan="1">Z-score, ens def</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">RF00001</td>
                <td align="right" rowspan="1" colspan="1">712</td>
                <td align="left" rowspan="1" colspan="1">0.071 ± 0.016</td>
                <td align="left" rowspan="1" colspan="1">−0.354 ± 1.056</td>
                <td align="left" rowspan="1" colspan="1">0.198 ± 0.123</td>
                <td align="left" rowspan="1" colspan="1">−0.423 ± 0.965</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RF00004</td>
                <td align="right" rowspan="1" colspan="1">208</td>
                <td align="left" rowspan="1" colspan="1">0.068 ± 0.014</td>
                <td align="left" rowspan="1" colspan="1">−1.425 ± 1.018</td>
                <td align="left" rowspan="1" colspan="1">0.177 ± 0.103</td>
                <td align="left" rowspan="1" colspan="1">−0.901 ± 0.863</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RF00005</td>
                <td align="right" rowspan="1" colspan="1">960</td>
                <td align="left" rowspan="1" colspan="1">0.081 ± 0.019</td>
                <td align="left" rowspan="1" colspan="1">−0.049 ± 0.949</td>
                <td align="left" rowspan="1" colspan="1">0.189 ± 0.105</td>
                <td align="left" rowspan="1" colspan="1">−0.405 ± 0.820</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RF00167</td>
                <td align="right" rowspan="1" colspan="1">133</td>
                <td align="left" rowspan="1" colspan="1">0.077 ± 0.020</td>
                <td align="left" rowspan="1" colspan="1">−0.606 ± 1.111</td>
                <td align="left" rowspan="1" colspan="1">0.164 ± 0.105</td>
                <td align="left" rowspan="1" colspan="1">−0.782 ± 0.858</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">MIRBASE</td>
                <td align="right" rowspan="1" colspan="1">28645</td>
                <td align="left" rowspan="1" colspan="1">0.056 ± 0.018</td>
                <td align="left" rowspan="1" colspan="1">−1.791 ± 1.491</td>
                <td align="left" rowspan="1" colspan="1">0.101 ± 0.076</td>
                <td align="left" rowspan="1" colspan="1">−1.324 ± 0.791</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>We now turn to the figures that support each of the four assertions made at the beginning of Section “Comparison of structural entropy and derivational entropy”. <xref ref-type="fig" rid="pone.0137859.g001">Fig 1</xref> shows the average run times and entropy values for for DP, FTD (Δ<italic>T</italic> = 10<sup>−7</sup>), and the SCFG method of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>] using each of the grammars G4, G5 and G6 with training data from the set ‘Benchmark’. According to benchmarking work of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>] and [<xref rid="pone.0137859.ref047" ref-type="bibr">47</xref>], the grammar G6 seems somewhat better than G4 and G5. It is for this reason that we focus principally on the grammar G6, which was first introduced in the SCFG algorithm <monospace>Pfold</monospace> for RNA secondary structure prediction—see [<xref rid="pone.0137859.ref027" ref-type="bibr">27</xref>]. <xref ref-type="fig" rid="pone.0137859.g001">Fig 1A</xref> depicts average run times for DP, FTD, and SCFG methods, for 100 random RNA sequences of length <italic>n</italic>, where <italic>n</italic> ranges from 20 to 500 with an increment of 5. This figure shows that FTD and DP run faster by an order of magnitude than the SCFG methods—indeed, for length 500 RNAs, derivational entropy is computed in two minutes, while thermodynamic structural entropy is computed in a few seconds. The <xref ref-type="fig" rid="pone.0137859.g001">Fig 1B</xref> depicts the entropy values computed by DP, FTD (Δ<italic>T</italic> = 10<sup>−7</sup>), and SCFG methods. Note that for large RNA sequence length, entropy values returned by FTD are slightly smaller than those returned by DP, in agreement with the discussion in Section “Entropy by statistical physics”. Entropy values for the grammar G5 are considerably larger than those of FTD and DP, while entropy values for G4 and G6 are almost identical and approximately twice the size of those from G5.</p>
      <p><xref ref-type="fig" rid="pone.0137859.g002">Fig 2A</xref> presents graphs of length-normalized entropy values, computed by DP and SCFG. Using methods from algebraic combinatorics [<xref rid="pone.0137859.ref048" ref-type="bibr">48</xref>, <xref rid="pone.0137859.ref049" ref-type="bibr">49</xref>], it is possible to prove that the length-normalized asymptotic structural entropy is constant, as observed in this figure. By numerical fitting, we find that the slope of the DP line is 0.087, while that of G6 is 0.329; i.e. SCFG entropy values using the G6 grammar are 3.78 times those of DP entropy. This is supported by <xref rid="pone.0137859.t001" ref-type="table">Table 1</xref>, which suggests that G6 entropy values are 3.56 times larger than DP, while G4 and G5 entropy values are 6.71 resp. 6.85 times larger than DP entropy values. <xref ref-type="fig" rid="pone.0137859.g002">Fig 2B</xref> depicts the relative frequency of structural entropy values for DP, FTD, and SCFG methods for 960 transfer RNA sequences from the seed alignment of the Rfam 11.0 database [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>].</p>
      <fig id="pone.0137859.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137859.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <p><italic>(A)</italic> The average of length-normalized entropy values, as computed by DP and SCFG (G6,Benchmark), using the same data as described in the caption of <xref ref-type="fig" rid="pone.0137859.g001">Fig 1</xref>. Using methods from algebraic combinatorics, it can be proven that the length-normalized entropy for a homopolymer is asymptotically constant. By numerical fitting, we find that SCFG values are roughly four times as large as DP values (approximate fitted value 3.78). <italic>(B)</italic> Relative frequency of entropy values for the 960 transfer RNA sequences in the seed alignment of RF00005 family from Rfam 11.0 [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>], as computed for each of the five methods DP, FTD (Δ<italic>T</italic> = 10<sup>−7</sup>), SCFG(G4,Rfam5), SCFG(G5,Rfam5) and SCFG(G6,Rfam5). See the caption from <xref ref-type="fig" rid="pone.0137859.g001">Fig 1</xref> for explanation of each method, where in contrast to previous figures, the training set ‘Rfam5’ was used in place of ‘Benchmark’. Average entropy values for RF00005 are given as follows. FTD (Δ<italic>T</italic> = 10<sup>−7</sup>): 5.53±1.34. DP: 5.95±1.38; G4: 39.92±2.88; G5: 40.68±3.05; G6: 21.21±2.41. Note the bimodal distribution of entropy values computed with the SCFGs G4 and G5. Relative frequency plot for 712 5S ribosomal RNAs from RF00001 is very similar (data not shown).</p>
        </caption>
        <graphic xlink:href="pone.0137859.g002"/>
      </fig>
      <p><xref ref-type="fig" rid="pone.0137859.g003">Fig 3</xref> presents scatter plots and Pearson correlation of length-normalized entropy values and several notions of structural diversity that have been used for RNA design [<xref rid="pone.0137859.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0137859.ref031" ref-type="bibr">31</xref>]. Values were computed in this figure for a set of 2450 RNAs of various lengths, by selecting the first sequence from the seed alignment of each family from the Rfam 11.0 database [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>], after discarding a few families having too few sequences. <xref ref-type="fig" rid="pone.0137859.g003">Fig 3A</xref> depicts the Pearson correlation between length-normalized structural entropy values, as computed by DP, FTD, and the SCFG method using grammars G4, G5, G6. Length-normalized derivational entropy values remain highly correlated, regardless of training set, but the correlation of all SCFG methods is poor with DP. The Pearson correlation of 0.79 for length-normalized entropy values obtained by G4 and G5 is high; however the correlation with G6 drops to 0.56 (G4-G6) and 0.34 (G5-G6). <xref ref-type="fig" rid="pone.0137859.g003">Fig 3B</xref> depicts scatter plots and Pearson correlation for 960 transfer RNAs from family RF00005 of Rfam 11.0, for length-normalized structural entropy, as computed by DP, and various notions of structural diversity used in synthetic RNA design. (By minimizing values such as the positional entropy, structural entropy, ensemble defect, expected base pair distance, it is more likely that computationally designed RNAs will fold into their predicted structures when experimentally validated.) Brief definitions of the notions of structural diversity that are compared in <xref ref-type="fig" rid="pone.0137859.g003">Fig 3B</xref> are given as follows. <italic>Native Contacts</italic>: proportion of base pairs in the Rfam consensus structure that appear in the low energy Boltzmann ensemble, defined by <inline-formula id="pone.0137859.e071"><alternatives><graphic xlink:href="pone.0137859.e071.jpg" id="pone.0137859.e071g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M71"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mspace width="1pt"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>s</mml:mi><mml:mo>∩</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>s</italic>
<sub>0</sub> is the Rfam consensus structure. <italic>Positional Entropy</italic>: average positional entropy <inline-formula id="pone.0137859.e072"><alternatives><graphic xlink:href="pone.0137859.e072.jpg" id="pone.0137859.e072g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M72"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>H</italic>
<sub>2</sub>(<italic>i</italic>) is defined by <xref ref-type="disp-formula" rid="pone.0137859.e013">Eq (5)</xref>. <italic>Expected base pair distance</italic>: length-normalized value determined from ∑<sub><italic>s</italic></sub>
<italic>p</italic>(<italic>s</italic>) ⋅ <italic>d</italic>
<sub> BP</sub>(<italic>s</italic>, <italic>s</italic>
<sub>0</sub>), where <italic>s</italic>
<sub>0</sub> is the Rfam consensus structure, computed by ∑<sub>1 ≤ <italic>i</italic> &lt; <italic>j</italic> ≤ <italic>n</italic></sub>
<italic>I</italic>[(<italic>i</italic>, <italic>j</italic>) ∉ <italic>s</italic>
<sub>0</sub>] ⋅ <italic>p</italic>
<sub><italic>i</italic>, <italic>j</italic></sub> + <italic>I</italic>[(<italic>i</italic>, <italic>j</italic>) ∈ <italic>s</italic>
<sub>0</sub>] ⋅ (1−<italic>p</italic>
<sub><italic>i</italic>,<italic>j</italic></sub>) where <italic>I</italic> denotes the indicator function—see [<xref rid="pone.0137859.ref014" ref-type="bibr">14</xref>]. <italic>Ensemble defect</italic>: length-normalized value determined from <inline-formula id="pone.0137859.e073"><alternatives><graphic xlink:href="pone.0137859.e073.jpg" id="pone.0137859.e073g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M73"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>·</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>·</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mspace width="4.pt"/><mml:mtext>unpaired</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>in</mml:mtext><mml:mspace width="4.pt"/><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>s</italic>
<sub>0</sub> is the Rfam consensus structure, <italic>I</italic> denotes the indicator function, and <inline-formula id="pone.0137859.e074"><alternatives><graphic xlink:href="pone.0137859.e074.jpg" id="pone.0137859.e074g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M74"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> is defined in <xref ref-type="disp-formula" rid="pone.0137859.e011">Eq (4)</xref>. <italic>Vienna structural diversity</italic>: Boltzmann average base pair distance between each pair of structures in the ensemble, called <italic>ensemble diversity</italic> in the output of <monospace>RNAfold -p</monospace>[<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>], formally defined by ∑<sub><italic>i</italic> &lt; <italic>j</italic></sub>
<italic>p</italic>
<sub><italic>i</italic>,<italic>j</italic></sub>(1−<italic>p</italic>
<sub><italic>i</italic>,<italic>j</italic></sub>)+(1−<italic>p</italic>
<sub><italic>i</italic>,<italic>j</italic></sub>)<italic>p</italic>
<sub><italic>i</italic>,<italic>j</italic></sub>, where <italic>p</italic>
<sub><italic>i</italic>,<italic>j</italic></sub> and output as <italic>ensemble diversity</italic> by <monospace>RNAfold -p</monospace>. <italic>Morgan-Higgs structural diversity</italic>: Boltzmann average Hamming distance between each pair of structures in the ensemble, where a structure <italic>s</italic> is represented by an array where <italic>s</italic>[<italic>i</italic>] = <italic>j</italic> if (<italic>i</italic>,<italic>j</italic>) or (<italic>j</italic>,<italic>i</italic>) is a base pair, and otherwise <italic>s</italic>[<italic>i</italic>] = <italic>i</italic>, formally defined by <inline-formula id="pone.0137859.e075"><alternatives><graphic xlink:href="pone.0137859.e075.jpg" id="pone.0137859.e075g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M75"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>·</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Length-normalized DP entropy values are moderately highly correlated with positional entropy, but not with the other measures. In synthetic design of RNAs, it is our opinion that one should prioritize for experimental validation those synthetically designed RNAs by consideration of ensemble defect, structural entropy, etc., where the measures selected are not highly correlated. From this standpoint, one might use ensemble defect, structural entropy and proportion of native contacts as suitable measures for synthetic RNA design—see [<xref rid="pone.0137859.ref050" ref-type="bibr">50</xref>].</p>
      <fig id="pone.0137859.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137859.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <p><italic>(A)</italic> Correlation between length-normalized structural entropy values, as computed by DP and five stochastic context free grammars: grammars G4, G5 and G6 for the ‘Benchmark’ training set, and G6 for ‘Rfam5’ and ‘Mixed80’ training sets (see [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>]). Low correlation is shown between length-normalized thermodynamic structural and derivational entropies. For the fixed grammar G6, very high correlation is displayed between length-normalized entropy values for each of the training sets ‘Benchmark’, ‘Rfam5’, ‘Mixed80’ (similar results for fixed grammars G4,G5—data not shown). Although grammars G4 and G5 display a moderately high correlation together, there is low correlation with length-normalized entropy values determined by the grammar G6. Benchmarking set consists of the first sequence in the seed alignment from each family in the database Rfam 11.0 [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>]. <italic>(B)</italic> Scatter plots and correlation between thermodynamic structural entropy and several measures of <italic>structural diversity</italic>, computed from 960 tRNA sequences in the seed alignment of family RF00005 from from the Rfam 11.0 database [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>]. Correlation is computed between the following normalized values: (1) DP: length-normalized thermodynamic structural entropy computed by DP algorithm. (2) Native Contacts: proportion of base pairs in the Rfam consensus structure that appear in the low energy Boltzmann ensemble, defined by <inline-formula id="pone.0137859.e076"><alternatives><graphic id="pone.0137859.e076g" xlink:href="pone.0137859.e076"/><mml:math id="M76"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>s</mml:mi><mml:mo>∩</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>s</italic>
<sub>0</sub> is the Rfam consensus structure. (3) Positional Entropy: average positional entropy, defined by <inline-formula id="pone.0137859.e077"><alternatives><graphic id="pone.0137859.e077g" xlink:href="pone.0137859.e077"/><mml:math id="M77"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>H</italic>
<sub>2</sub>(<italic>i</italic>) is defined by <xref ref-type="disp-formula" rid="pone.0137859.e013">Eq (5)</xref>. (4) Expected base pair distance: length-normalized value determined from ∑<sub><italic>s</italic></sub>
<italic>p</italic>(<italic>s</italic>)⋅<italic>d</italic>
<sub>BP</sub>(<italic>s</italic>,<italic>s</italic>
<sub>0</sub>), where <italic>s</italic>
<sub>0</sub> is the Rfam consensus structure, which equals ∑<sub>1 ≤ <italic>i</italic> &lt; <italic>j</italic> ≤ <italic>n</italic></sub>
<italic>I</italic>[(<italic>i</italic>,<italic>j</italic>) ∉ <italic>s</italic>
<sub>0</sub>]⋅<italic>p</italic>
<sub><italic>i</italic>,<italic>j</italic></sub>+<italic>I</italic>[(<italic>i</italic>,<italic>j</italic>) ∈ <italic>s</italic>
<sub>0</sub>]⋅(1−<italic>p</italic>
<sub><italic>i</italic>,<italic>j</italic></sub>) where <italic>I</italic> denotes the indicator function—see [<xref rid="pone.0137859.ref014" ref-type="bibr">14</xref>]. (5) Ensemble defect: length-normalized value determined from <inline-formula id="pone.0137859.e078"><alternatives><graphic id="pone.0137859.e078g" xlink:href="pone.0137859.e078"/><mml:math id="M78"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>·</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>·</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mspace width="4.pt"/><mml:mtext>unpaired</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>in</mml:mtext><mml:mspace width="4.pt"/><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>I</italic> denotes the indicator function, and <inline-formula id="pone.0137859.e079"><alternatives><graphic id="pone.0137859.e079g" xlink:href="pone.0137859.e079"/><mml:math id="M79"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> is defined in <xref ref-type="disp-formula" rid="pone.0137859.e011">Eq (4)</xref>—see [<xref rid="pone.0137859.ref050" ref-type="bibr">50</xref>]. (6) Str. Div. (V): Vienna structural diversity, output as <italic>ensemble diversity</italic> by <monospace>RNAfold -p</monospace>[<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>]. (7) Str. Div. (MH): Morgan-Higgs structural diversity [<xref rid="pone.0137859.ref030" ref-type="bibr">30</xref>], defined in the text. Positional entropy is moderately correlated with DP; ensemble defect and expected base pair distance are highly correlated, and each is moderately correlated with the proportion of native contacts. Structural diversity (Vienna and Morgan-Higgs) are highly correlated with positional entropy, but only (surprisingly) only moderately correlated with conformational entropy DP, in spite of the fact that all these measures concern properties of the ensemble of structures. Ensemble defect, expected base pair distance and expected number of native contacts are all highly correlated; this is unsurprising, since all measures concern the deviation of structures in the ensemble from the minimum free energy structure. Note that positional entropy is poorly correlated with the proportion of native contacts, although Huynen et al. [<xref rid="pone.0137859.ref021" ref-type="bibr">21</xref>] show that base pairs in the MFE structure of 16S rRNA tend to belong to the structure determined by comparative sequence analysis when the nucleotides have low positional entropy.</p>
        </caption>
        <graphic xlink:href="pone.0137859.g003"/>
      </fig>
      <p><xref ref-type="fig" rid="pone.0137859.g004">Fig 4</xref> displays the heat capacity and structural entropy for a thermoswitch (also called RNA thermometer) from the ROSE 3 family RF02523 from the Rfam 11.0 database [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>], with EMBL accession code AEAZ 01000032.1/24229-24162. The heat capacity, computed by Vienna RNA Package <monospace>RNAheat</monospace>, presents two peaks, corresponding to two critical temperatures <italic>T</italic>
<sub>1</sub>,<italic>T</italic>
<sub>2</sub>, where one of the two conformations of this thermoswitch is stable in the temperature range between <italic>T</italic>
<sub>1</sub> and <italic>T</italic>
<sub>2</sub>. The entropy plot also suggests the presence of a stable structure in the temperature range between <italic>T</italic>
<sub>1</sub> and <italic>T</italic>
<sub>2</sub>, since small entropy values entail small diversity in the Boltzmann ensemble of structures.</p>
      <fig id="pone.0137859.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137859.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Heat capacity (left) and thermodynamic structural entropy (right) for a
thermoswitch, or RNA thermometer, from the ROSE 3 family RF02523 from the Rfam 11.0 database [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>], with EMBL accession code AEAZ01000032.1/24229-24162.</title>
          <p>Lighter curves in the background correspond to the heat capacity (left) and thermodynamic structural entropy (right) of random RNAs having the same dinucleotides, obtained by the implementation in [<xref rid="pone.0137859.ref043" ref-type="bibr">43</xref>] of the Altschul-Erikson dinucleotide shuffle algorithm [<xref rid="pone.0137859.ref042" ref-type="bibr">42</xref>]. Since structural entropy <inline-formula id="pone.0137859.e080"><alternatives><graphic id="pone.0137859.e080g" xlink:href="pone.0137859.e080"/><mml:math id="M80"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mtext>ln</mml:mtext><mml:mspace width="1pt"/><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and heat capacity <inline-formula id="pone.0137859.e081"><alternatives><graphic id="pone.0137859.e081g" xlink:href="pone.0137859.e081"/><mml:math id="M81"><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mo>=</mml:mo><mml:mspace width="1pt"/><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></alternatives></inline-formula> the derivative of entropy <italic>H</italic> with respect to temperature closely follows the curve of the heat capacity (data not shown). Heat capacity computed using Vienna RNA Package RNAheat [<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>], and entropy computed by method DP.</p>
        </caption>
        <graphic xlink:href="pone.0137859.g004"/>
      </fig>
      <p>As shown in the tables and figures, the DP and FTD methods return almost identical values and have very similar (fast) run times, contrasted with the SCFG method, which is slow and whose values are much larger than those of DP and FTD. For a sequence of length 500, SCFG(G6,Benchmark) takes 2 minutes, compared with a few seconds for DP and FTD. Since FTD approximates a derivative by a finite difference, one expects a small discrepancy in the values of DP and FTD for thermodynamic structural entropy. According to [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>], the sensitivity and specificity of G4 and G6 grammars are “significantly” higher than that of the G5 grammar. Since G6 is the underlying grammar of the <monospace>Pfold</monospace> software, for many of our comparisons, we compute derivational entropy using grammar G6 with the ‘Benchmark’ training set. (In data not shown, we benchmarked all nine combinations of grammars and training sets.)</p>
    </sec>
    <sec id="sec015">
      <title>Using <monospace>RNAfold</monospace> to compute conformational entropy</title>
      <p>We have recently learned that newer versions of Vienna RNA Package [<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>] allow the user to modify the value <italic>RT</italic> by using the flag <monospace>––betaScale</monospace> (kindly pointed out by Ivo Hofacker). It follows that <monospace>RNAfold</monospace> can easily be used to compute conformational entropy by using the FTD method. Let <italic>T</italic> = 310.15 be the absolute temperature corresponding to 37°C, let Δ<italic>T</italic> = 0.01, let <italic>T</italic>
<sub>2</sub> = <italic>T</italic> + Δ<italic>T</italic> = 310.16 and <italic>T</italic>
<sub>1</sub> = <italic>T</italic> − Δ<italic>T</italic> = 310.14. Define the scaling factors <inline-formula id="pone.0137859.e082"><alternatives><graphic xlink:href="pone.0137859.e082.jpg" id="pone.0137859.e082g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M82"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>0000322424633241</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pone.0137859.e083"><alternatives><graphic xlink:href="pone.0137859.e083.jpg" id="pone.0137859.e083g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M83"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>9999677575366759</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Run <monospace>RNAsubopt -p ––betaScale <italic>β</italic><sub>2</sub></monospace> to compute the ensemble free energy −<italic>R</italic>(<italic>T</italic> + Δ<italic>T</italic>) ln <italic>Z</italic>(<italic>T</italic> + Δ<italic>T</italic>), and <monospace>RNAsubopt -p ––betaScale <italic>β</italic><sub>1</sub></monospace> to compute the ensemble free energy −<italic>R</italic>(<italic>T</italic> − Δ<italic>T</italic>) ln <italic>Z</italic>(<italic>T</italic> − Δ<italic>T</italic>), where <italic>Z</italic>(<italic>T</italic> + Δ<italic>T</italic>) [resp. <italic>Z</italic>(<italic>T</italic> − Δ<italic>T</italic>)] temporarily denotes the value of the partition function where table temperature is 37°C (as usual), and formal temperature is <italic>T</italic> + Δ<italic>T</italic> [resp. <italic>T</italic> − Δ<italic>T</italic>] in Kelvin. It follows that the <italic>uncentered finite difference</italic>
<xref ref-type="disp-formula" rid="pone.0137859.e084">Eq (32)</xref>
<disp-formula id="pone.0137859.e084"><alternatives><graphic xlink:href="pone.0137859.e084.jpg" id="pone.0137859.e084g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M84"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(32)</label></disp-formula>
as well as the <italic>centered finite difference</italic>
<disp-formula id="pone.0137859.e085"><alternatives><graphic xlink:href="pone.0137859.e085.jpg" id="pone.0137859.e085g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M85"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(33)</label></disp-formula>
both provide good approximations for the expected energy 〈<italic>E</italic>〉. Now run <monospace>RNAsubopt -p</monospace> to compute the ensemble free energy <italic>G</italic> = −<italic>RT</italic> ln <italic>Z</italic> where table and formal temperature are (as usual) 310.15 in Kelvin, and so compute the entropy
<disp-formula id="pone.0137859.e086"><alternatives><graphic xlink:href="pone.0137859.e086.jpg" id="pone.0137859.e086g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M86"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi>H</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>〈</mml:mo><mml:mi>E</mml:mi><mml:mo>〉</mml:mo><mml:mo>−</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(34)</label></disp-formula>
</p>
      <p>Let <monospace>ViennaRNA</monospace> [resp. <monospace>ViennaRNA</monospace>*] denote the entropy computation just described, where expected energy is approximated by the uncentered <xref ref-type="disp-formula" rid="pone.0137859.e084">Eq (32)</xref> [resp. centered <xref ref-type="disp-formula" rid="pone.0137859.e085">Eq (33)</xref>]. Similarly, we let <monospace>FTD</monospace> [resp. <monospace>FTD</monospace>*] denote the uncentered [resp. centered] version of our code from Algorithm 1 in Section “Statistical Mechanics” in Methods. In computing entropy for Rfam family RF00005, both <monospace>ViennaRNA</monospace> and <monospace>ViennaRNA</monospace>* sometimes return entropy values that are <italic>larger</italic> than the correct values computed by <monospace>DP</monospace>, while entropy values of <monospace>FTD</monospace> [resp. <monospace>FTD</monospace>*] are always smaller than [essentially always smaller] than those of <monospace>DP</monospace>, as expected when using finite differences to approximate the derivative of the strictly decreasing, concave-down function ln <italic>Z</italic>(<italic>T</italic>).</p>
      <p><xref ref-type="fig" rid="pone.0137859.g005">Fig 5A</xref> shows that <monospace>ViennaRNA</monospace> is somewhat faster than <monospace>FTD</monospace>, and for each method, the <italic>uncentered</italic> version is faster than the <italic>centered</italic> version, which is clear since the former [resp. latter] computes the partition function twice [resp. three times]. <xref ref-type="fig" rid="pone.0137859.g005">Fig 5B</xref> shows that the standard deviation of entropy values for 100 random RNA is larger for <monospace>ViennaRNA</monospace> than <monospace>FTD</monospace>, and the uncentered form of <monospace>ViennaRNA</monospace> displays the largest standard deviation when Δ<italic>T</italic> = 10<sup>−4</sup> (for Δ<italic>T</italic> = 0.01, all four finite derivative methods are comparable). These results are unsurprising due to numerical precision issues; e.g. for the 98 nt purine riboswitch with EMBL accession code AE005176.1/1159509-1159606, the algorithm <monospace>DP</monospace> determines a value of conformational entropy 9.975439, whereas by using (centered) <monospace>ViennaRNA</monospace>* with version 2.1.8 of <monospace>RNAfold</monospace> with Δ<italic>T</italic> = 10<sup>−2</sup>, we obtain 9.93425742505. For Δ<italic>T</italic> = 10<sup>−4</sup>, 10<sup>−5</sup> and 10<sup>−6</sup>, <monospace>ViennaRNA</monospace>* computes entropies of 9.59831636855, 6.94285165005⋅10<sup>−8</sup>, −5.9169597422⋅10<sup>−7</sup>. Such numerical instability issues are of much less concern to our method <monospace>FTD</monospace> and <monospace>FTD</monospace>*, as <xref ref-type="fig" rid="pone.0137859.g001">Fig 1</xref> demonstrates for the uncentered method <monospace>FTD</monospace> with Δ<italic>T</italic> = 10<sup>−7</sup>.</p>
      <fig id="pone.0137859.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137859.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Average values for the run time and the entropy values for 100 random RNA sequences of length <italic>n</italic>, each having expected compositional frequency of 0:25 for A,C,G,U, where <italic>n</italic> ranges from 20 to 500 with increments of 5 for conformational entropy.</title>
          <p><italic>(A)</italic> Average run times as a function of sequence length, where error bars represent ±1 standard deviation. Methods used: <monospace>DP</monospace>, <monospace>FTD</monospace>, <monospace>FTD</monospace>*, <monospace>ViennaRNA</monospace>, <monospace>ViennaRNA</monospace>*. For random RNAs of length 500 nt, <monospace>Vienna RNA Package</monospace> is about three times faster than our code. <italic>(B)</italic> Standard deviation of the entropy values computed for 100 random RNA, displayed as a function of sequence length. From top to bottom, the first three curves represent uncentered <monospace>ViennaRNA</monospace> with Δ<italic>T</italic> = 10<sup>−4</sup>, centered <monospace>ViennaRNA</monospace>* with Δ<italic>T</italic> = 10<sup>−4</sup>, and DP. The bottom curve represents centered <monospace>FTD</monospace> with Δ<italic>T</italic> = 10<sup>−4</sup>, centered <monospace>FTD</monospace>* with Δ<italic>T</italic> = 10<sup>−2</sup>, uncentered <monospace>ViennaRNA</monospace> with Δ<italic>T</italic> = 10<sup>−2</sup>, centered <monospace>ViennaRNA</monospace>* with Δ<italic>T</italic> = 10<sup>−2</sup>. The average entropy values computed by <monospace>FTD</monospace>, <monospace>FTD</monospace>*, <monospace>ViennaRNA</monospace>, and <monospace>ViennaRNA</monospace>* are indistinguishable and since <monospace>FTD</monospace> values are shown in the right panel of <xref ref-type="fig" rid="pone.0137859.g001">Fig 1</xref>, they are not shown here.</p>
        </caption>
        <graphic xlink:href="pone.0137859.g005"/>
      </fig>
      <p><xref ref-type="fig" rid="pone.0137859.g006">Fig 6</xref> shows the distribution of entropy differences (DP-FTD, DP-FTD*, DP-ViennaRNA, DP-ViennaRNA*) for 960 transfer RNAs from family RF00005 from the Rfam 11.0 database [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>]. Reasons for the behavior of <monospace>ViennaRNA</monospace> and <monospace>ViennaRNA</monospace>* are presumably due to numerical precision issues. These differences are small, so when plotted as a function of sequence length in a manner analogous to <xref ref-type="fig" rid="pone.0137859.g001">Fig 1</xref> (not shown), average entropy values computed by <monospace>FTD</monospace>, <monospace>FTD</monospace>*, <monospace>ViennaRNA</monospace>, and <monospace>ViennaRNA</monospace>* for Δ<italic>T</italic> = 10<sup>−2</sup> and 10<sup>−4</sup> are visually indistinguishable.</p>
      <fig id="pone.0137859.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137859.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <p><italic>(A)</italic> Relative frequency of the difference in entropy values for 960 transfer RNAs from the RF00005 family of the Rfam 11.0 database. (1) DP-FTD with average entropy difference 0.2512 ± 0.4935 with maximum of 3.1622 and minimum of 0. (2) DP-FTD* with average entropy difference 0.2502 ± 0.4934 with maximum of 3.1602 and minimum of -0.0020. (3) DP-ViennaRNA with average entropy difference 0.2475 ± 0.4975 with maximum of 3.1520 and minimum of -0.1743. (4) DP-ViennaRNA* with average entropy difference 0.2494 ± 0.4946 with maximum of 3.1572 and minimum of -0.0777. It is noteworthy that FTD is <italic>always</italic> less than DP, FTD* exceeds DP by a tiny margin only rarely, while ViennaRNA and ViennaRNA* more often exceed DP. Recall that the average deviation DP-FTD increases with increasing sequence length, as shown in the right panel of <xref ref-type="fig" rid="pone.0137859.g001">Fig 1</xref>. The same is true for DP-FTD*, DP-ViennaRNA, DP-ViennaRNA* (data not shown). (<italic>B</italic>) Free energy of arginyl-transfer RNA from <italic>Aeropyrum pernix</italic> with tRNAdb accession code tdbR00000589 [<xref rid="pone.0137859.ref037" ref-type="bibr">37</xref>] for temperatures ranging from 37°C to 38°C in increments of 0.01. The blue piecewise linear curve was created using <monospace>RNAeval -T</monospace> from the Vienna RNA Package [<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>]. The red linear curve was created by (1) calculating the entropy <italic>S</italic>
<sub><italic>t</italic></sub> = <italic>G</italic>(37) − <italic>G</italic>(38) of the tRNA cloverleaf structure by subtracting the free energy at 38°C from the free energy at 37°C, as determined using <monospace>RNAeval -T</monospace>, (2) computing the enthalpy <italic>H</italic>
<sub>t</sub> = <italic>G</italic>(37) + (273.15 + 37) · S<sub>t</sub>, and then (3) computing the free energy at temperature <italic>T</italic> by <italic>G</italic>(<italic>T</italic>) = <italic>H</italic>
<sub><italic>t</italic></sub> − <italic>T</italic> · <italic>S</italic>
<sub><italic>t</italic></sub>. The jagged free energy curve is due to the fact that Vienna RNA Package represents energies as integers (multiples of 0.01 kcal/mol), so that loop energies jump at particular temperatures.</p>
        </caption>
        <graphic xlink:href="pone.0137859.g006"/>
      </fig>
      <p>Due to numerical stability issues, <monospace>ViennaRNA</monospace> and <monospace>ViennaRNA</monospace>* perform optimally with Δ<italic>T</italic> = 10<sup>−2</sup>. Note that when using <monospace>RNAfold</monospace>, it is essential to use <monospace>––betaScale</monospace>; indeed, if one attempts to compute the entropy using <xref ref-type="disp-formula" rid="pone.0137859.e086">Eq (34)</xref> where expected energy is computed from <xref ref-type="disp-formula" rid="pone.0137859.e084">Eq (32)</xref> [resp. <xref ref-type="disp-formula" rid="pone.0137859.e085">Eq (33)</xref>] by running <monospace>RNAfold -p -T 37.01</monospace> and <monospace>RNAfold -p -T 37</monospace> [resp. <monospace>RNAfold -p -T 37.01</monospace> and <monospace>RNAfold -p -T 36.99</monospace>], then the resulting entropy for the 98 nt purine riboswitch with EMBL accession code AE005176.1/1159509-1159606 is the impossible, <italic>negative</italic> value of -208.13 [resp. -210.61]. The large negative entropy values in this case are not only due to the lack of distinction between formal and table temperature, but as well to the fact that Vienna RNA Package represents energies as integers (multiples of 0.01 kcal/mol), so that loop energies jump at particular temperatures, as shown in the right panel of <xref ref-type="fig" rid="pone.0137859.g006">Fig 6</xref>. These issues should not be construed as shortcomings of the Vienna RNA Package, designed for great speed and high performance, but rather as a use of the program outside its intended parameters. As shown by <xref ref-type="fig" rid="pone.0137859.g005">Fig 5</xref>, the methods <monospace>ViennaRNA</monospace> and <monospace>ViennaRNA</monospace>* can rapidly compute accurate approximations of the conformational entropy.</p>
    </sec>
    <sec id="sec016">
      <title>Correlation with hammerhead cleavage activity</title>
      <p>In [<xref rid="pone.0137859.ref032" ref-type="bibr">32</xref>], Shao et al. considered a 2-state thermodynamic model to describe the hybridization of hammerhead ribozymes to messenger RNA with subsequent cleavage at the mRNA GUC-cleavage site. In that paper, they define the total free energy
<disp-formula id="pone.0137859.e087"><alternatives><graphic xlink:href="pone.0137859.e087.jpg" id="pone.0137859.e087g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M87"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mtext>total</mml:mtext></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mtext>hybrid</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mtext>switch</mml:mtext></mml:msub><mml:mo>-</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mtext>disrupt</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives><label>(35)</label></disp-formula>
where each of these energies is defined on p. 10 of [<xref rid="pone.0137859.ref032" ref-type="bibr">32</xref>], and obtained by averaging over 1000 low energy structures sampled by <monospace>Sfold</monospace>[<xref rid="pone.0137859.ref051" ref-type="bibr">51</xref>]. The authors show a (negative) high correlation between Δ<italic>G</italic>
<sub>total</sub> and the cleavage activity of 13 hammerhead enzymes for GUC cleavage sites in ABCG2 messenger RNA (GenBank NM_004827.2) of <italic>H. sapiens</italic>; i.e. the lower the total change in free energy, the more active is the ribozyme. (Shao et al. originally considered 15 hammerheads; however two outlier hammerheads were removed from consideration.) Here, we show that the correlation with cleavage activity can be improved slightly by taking secondary structure conformational entropy into consideration.</p>
      <p>To fix ideas, we consider the first GUC cleavage site considered by Shao et al. The minimum free energy (MFE) hybridization complex, as predicted by <monospace>RNAcofold</monospace> from the Vienna RNA Package [<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>] is shown in <xref ref-type="fig" rid="pone.0137859.g007">Fig 7A</xref>. The MFE structure of the 21 nt portion of mRNA, followed by a linker region of five adenines, followed by the hammerhead ribozyme, as computed by <monospace>RNAfold</monospace> from the Vienna RNA Package yields the same structure (where the linker region appears in a hairpin). It follows that to a first approximation, MFE hybridization structures can be predicted from MFE structure predictions of a chimeric sequence that includes a linker region. (Before the introduction of hybridization MFE software [<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0137859.ref052" ref-type="bibr">52</xref>], this approach was used to predict hybridization structures.)</p>
      <fig id="pone.0137859.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137859.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <p><italic>(A)</italic> Hybridization structure predicted by <monospace>RNAcofold</monospace>[<xref rid="pone.0137859.ref059" ref-type="bibr">59</xref>] of a 21 nt portion of messenger RNA for <italic>H. sapiens</italic> ABC transporter ABCG2 messenger RNA (GenBank. NM_004827.2) hybridized with a hammerhead ribozyme (data from the first line of <xref rid="pone.0137859.t001" ref-type="table">Table 1</xref> of [<xref rid="pone.0137859.ref032" ref-type="bibr">32</xref>]). The 21 nt portion of mRNA is 5′-UGCUUGGUGG UCUUGUUAAG U-3′ and the 42 nt hammerhead rizozyme is 5′-ACUUAACAAC UGAUGAGUCC GUGAGGACGA AACCACCAAG CA-3′. Messenger RNA is shown in green, while the hammerhead appears in red. In data not shown, we determined the secondary structure of the 21 nt mRNA portion, followed by a linker region of 5 adenines, followed by the 42 nt hammerhead ribozyme, by using <monospace>RNAfold</monospace>[<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>]. The base pairs in the hybridization complex are identical to the base pairs in the chimeric single-stranded sequence (not shown)—i.e. except for the unpaired adenines from the added linker region, the structures are identical. This fact permits us to approximate the structural entropy for the hybridization of two RNAs by using <monospace>RNAentropy</monospace> to compute the entropy of the concatenation of the sequences, separated by a linker region. <italic>(B)</italic> Correlation between hammerhead cleavage activity, as assayed by Shao et al. [<xref rid="pone.0137859.ref032" ref-type="bibr">32</xref>], with Δ<italic>G</italic>
<sub><italic>d</italic></sub> (change in free energy due to disruption of mRNA, denoted Δ<italic>G</italic>
<sub> disrupt</sub> in text), Δ<italic>G</italic> (change in total free energy, denoted Δ<italic>G</italic>
<sub> total</sub> in text), both taken from [<xref rid="pone.0137859.ref032" ref-type="bibr">32</xref>], with Δ<italic>S</italic> (change in conformational entropy <italic>k</italic>
<sub><italic>B</italic></sub>⋅Δ<italic>H</italic>), and Δ<italic>G</italic>(total) − T Δ<italic>S</italic>. Cleavage activity was measured by Shao et al. for the cleavage of GUC sites in ABC transporter ABCG2 messenger RNA (GenBank NM_004827.2). Values of Δ<italic>G</italic>
<sub><italic>d</italic></sub>, Δ<italic>G</italic> were taken from <xref rid="pone.0137859.t001" ref-type="table">Table 1</xref> of [<xref rid="pone.0137859.ref032" ref-type="bibr">32</xref>], while the change in conformational entropy Δ<italic>S</italic> was computed by <monospace>RNAentropy</monospace>. Note modest increase in the correlation of cleavage activity with Δ<italic>G</italic>, when adding the free energy contribution −<italic>T</italic>Δ<italic>S</italic>, due to conformational entropy.</p>
        </caption>
        <graphic xlink:href="pone.0137859.g007"/>
      </fig>
      <p>In this case, enzyme activity is 0.843, Δ<italic>G</italic>
<sub> total</sub> = −5.423 kcal/mol, structural entropy of the hammerhead is 2.830, structural entropy of the 21 nt portion of mRNA is 2.146, and structural entropy of the 21 nt portion of mRNA portion with linker and hammerhead is 2.328. Assuming that the entropy of a rigid structure is zero, the change in structural entropy Δ<italic>H</italic>(hammerhead) is 0 − 2.830 = −2.830, and similarly Δ<italic>H</italic>(21 nt mRNA + linker) is −2.146, Δ<italic>H</italic>(21 nt mRNA + linker + hammerhead) is −2.328. The net change in structural entropy Δ<italic>H</italic> is Δ<italic>H</italic>(21 nt mRNA + linker + hammerhead) minus Δ<italic>H</italic>(21 nt mRNA + linker) minus Δ<italic>H</italic>(hammerhead), so Δ<italic>H</italic> = −2.328 − (−2.146 − 2.830) = 2.648. The net change in conformational entropy Δ<italic>S</italic> = <italic>k</italic>
<sub><italic>B</italic></sub> ⋅ Δ<italic>H</italic> is then 0.00526, hence the free energy contribution −<italic>T</italic>Δ<italic>S</italic> = −<italic>RT</italic>Δ<italic>H</italic> = −1.632. The correlation between Δ<italic>G</italic>
<sub> total</sub> and −<italic>T</italic>Δ<italic>S</italic> is the value of 0.108, while the correlation value of −0.788 between hammerhead activity and Δ<italic>G</italic>
<sub> total</sub> is increase in absolute value to −0.806 (p-value 0.000878) when also taking into account −<italic>T</italic>Δ<italic>S</italic>. See <xref ref-type="fig" rid="pone.0137859.g007">Fig 7</xref> for a scatter plot and correlations between enzyme activity and Δ<italic>G</italic> [resp. Δ<italic>G</italic> − <italic>T</italic>Δ<italic>S</italic>], which correspond to the total free energy change without [resp. with] a contribution from conformational entropy.</p>
      <p><xref ref-type="fig" rid="pone.0137859.g007">Fig 7A</xref> depicts the minimum free energy <italic>hybridization</italic> structure of a 21 nt portion of the ABC transporter ABCG2 messenger RNA from <italic>H. sapiens</italic> (GenBank NM_004827.2), hybridized with a hammerhead ribozyme (data from the first line of <xref rid="pone.0137859.t001" ref-type="table">Table 1</xref> of [<xref rid="pone.0137859.ref032" ref-type="bibr">32</xref>]). The MFE hybridization structure was computed by Vienna RNA Package <monospace>RNAcofold</monospace>[<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>]. We obtain the same structure by applying <monospace>RNAfold</monospace> to the chimeric sequence obtained by concatenating the 21 nt portion of mRNA, given by 5′-UGCUUGGUGG UCUUGUUAAG U-3′, with a 5 nt linker region consisting of adenines, with the 42 nt hammerhead rizozyme, given by 5′-ACUUAACAAC UGAUGAGUCC GUGAGGACGA AACCACCAAG CA-3′ (data not shown). By such concatenations with a separating 5 nt linker region, we can compute the structural entropy of hybridizations of the 21 nt mRNA with the hammerhead ribozyme. (In future work, we may extend <monospace>RNAentropy</monospace> to compute the entropy of hybridization complexes without using such linker regions.)</p>
    </sec>
    <sec id="sec017">
      <title>Structural entropy of HIV-1 genomic regions</title>
      <p><xref ref-type="fig" rid="pone.0137859.g008">Fig 8A</xref> depicts the structural entropy, computed as a moving average of 100 nt portions of the HIV-1 complete genome (GenBank AF033819.3). Using <monospace>RNAentropy</monospace>, the structural entropy was computed for each 100 nt portion of the HIV-1 genome, by increments of 10 nt; i.e. entropy was computed at genomic positions 1, 11, 21, etc. for 100 nt windows. To smooth the data, moving averages were computed over five successive windows. The figure displays the moving average entropy values, as a function of genome position (top dotted curve), entropy Z-scores, defined by <inline-formula id="pone.0137859.e088"><alternatives><graphic xlink:href="pone.0137859.e088.jpg" id="pone.0137859.e088g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M88"><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula>, where <italic>x</italic> is the (moving window average) entropy at a genomic position, and <italic>μ</italic> [resp. <italic>σ</italic>] is the mean [resp. standard deviation] of the entropy for all computed 100 nt windows. <xref ref-type="fig" rid="pone.0137859.g008">Fig 8B</xref> is a portion of the NCBI graphics format presentation of GenBank file AF033819.3. Regions of low Z-score are position 4060 (Z-score of -2.69), position 8700 (Z-score of -2.46) and position 4040 (Z-score of -1.95). Since positions do not appear to correspond to the start/stop position of annotated genes, we ran <monospace>cmscan</monospace> from <monospace>Infernal 1.1</monospace> software [<xref rid="pone.0137859.ref053" ref-type="bibr">53</xref>] on the HIV-1 genome (GenBank AF033819.3). We obtained 11 predicted noncoding elements as listed in <xref rid="pone.0137859.t005" ref-type="table">Table 5</xref>, including the trans-activation response (TAR) element. Many of the predicted noncoding RNAs are much shorter than the 100 nt window used in the <monospace>RNAentropy</monospace> genome-scanning approach just described—it follows that low entropy Z-scores cannot be expected for such elements. Nevertheless, certain elements have quite low entropy Z-scores, such as the 5′-UTR and TAR element, both of which are known to be involved in the packaging of two copies of the HIV-1 genome in the viral capsid [<xref rid="pone.0137859.ref054" ref-type="bibr">54</xref>].</p>
      <fig id="pone.0137859.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137859.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Structural entropy plot for the HIV-1 genome (GenBank AF033819.3).</title>
          <p>Using<monospace>RNAentropy</monospace>, the structural entropy was computed for each 100 nt portion of the HIV-1 genome, by increments of 10 nt; i.e. for 100 nt windows starting at genome position 1, 11, 21, etc. To smooth the curve, moving averages were computed over five successive windows. <italic>(A)</italic> Dotted-line displays moving average values of structural entropy; solid curve displays entropy Z-scores, defined by <inline-formula id="pone.0137859.e089"><alternatives><graphic id="pone.0137859.e089g" xlink:href="pone.0137859.e089"/><mml:math id="M89"><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula>, where <italic>x</italic> represents the (moving window average) entropy at a genomic position, and <italic>μ</italic> [resp. <italic>σ</italic>] represents the mean [resp. standard deviation] of the entropy for 100 nt windows. Some of the lowest entropy Z-scores are -2.69 at position 4060, -2.46 at position 8700, -1.95 at position 4040. <italic>(B)</italic> NCBI graphics display of the HIV-1 genome, for comparison purposes. Low entropy (negative Z-score) regions do not appear to correspond with the start/stop location for annotated genes. In data not shown, we also computed <italic>positional entropy</italic> values [<xref rid="pone.0137859.ref021" ref-type="bibr">21</xref>] for the same windows, and determined a Pearson correlation of 0.7025 [resp. Spearman correlation of 0.6829] between (moving window average) values of entropy and positional entropy.</p>
        </caption>
        <graphic xlink:href="pone.0137859.g008"/>
      </fig>
      <table-wrap id="pone.0137859.t005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0137859.t005</object-id>
        <label>Table 5</label>
        <caption>
          <title>Computationally annotated RNA noncoding elements from the HIV-1 genome with corresponding entropy Z-scores.</title>
          <p>Running <monospace>cmscan</monospace> from <monospace>Infernal 1.1</monospace> [<xref rid="pone.0137859.ref053" ref-type="bibr">53</xref>] on the HIV-1 genome (GenBank AF033819.3), we obtain 11 noncoding elements as listed in the table, along with the nucleotide beginning and ending positions, length of noncoding element, E-score, and entropy Z-score. Entropy Z-scores were computed using <monospace>RNAentropy</monospace> as explained in the text. Many of the annotated noncoding elements are much shorter than 100 nt, the length of the window size used; however, sporadic checking of entropy Z-scores computed for a moving window of size 50 does not seem to radically change the entropy Z-scores. Nevertheless, certain elements have low entropies and corresponding entropy Z-scores, such as the 5′-UTR and TAR (trans-activation response) element, both of which are known to be involved in the packaging of the HIV-1 genome in the viral capsid [<xref rid="pone.0137859.ref054" ref-type="bibr">54</xref>].</p>
        </caption>
        <alternatives>
          <graphic id="pone.0137859.t005g" xlink:href="pone.0137859.t005"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
              <col align="left" valign="top" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Name</th>
                <th align="left" rowspan="1" colspan="1">Start</th>
                <th align="left" rowspan="1" colspan="1">Stop</th>
                <th align="left" rowspan="1" colspan="1">Len</th>
                <th align="left" rowspan="1" colspan="1">E-score</th>
                <th align="left" rowspan="1" colspan="1">entropy Z-score</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">RRE</td>
                <td align="right" rowspan="1" colspan="1">7265</td>
                <td align="right" rowspan="1" colspan="1">7601</td>
                <td align="right" rowspan="1" colspan="1">66</td>
                <td align="right" rowspan="1" colspan="1">7.6e-125</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.389</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV PBL</td>
                <td align="right" rowspan="1" colspan="1">125</td>
                <td align="right" rowspan="1" colspan="1">223</td>
                <td align="right" rowspan="1" colspan="1">99</td>
                <td align="right" rowspan="1" colspan="1">1.6e-30</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.589</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV POL-1 SL</td>
                <td align="right" rowspan="1" colspan="1">2012</td>
                <td align="right" rowspan="1" colspan="1">2124</td>
                <td align="right" rowspan="1" colspan="1">113</td>
                <td align="right" rowspan="1" colspan="1">3.1e-29</td>
                <td align="char" char="." rowspan="1" colspan="1">+0.066</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV GSL3</td>
                <td align="right" rowspan="1" colspan="1">400</td>
                <td align="right" rowspan="1" colspan="1">483</td>
                <td align="right" rowspan="1" colspan="1">84</td>
                <td align="right" rowspan="1" colspan="1">1.2e-23</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.299</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mir-TAR</td>
                <td align="right" rowspan="1" colspan="1">9085</td>
                <td align="right" rowspan="1" colspan="1">9145</td>
                <td align="right" rowspan="1" colspan="1">61</td>
                <td align="right" rowspan="1" colspan="1">7e-21</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.528</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mir-TAR</td>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="right" rowspan="1" colspan="1">60</td>
                <td align="right" rowspan="1" colspan="1">60</td>
                <td align="right" rowspan="1" colspan="1">1.1e-18</td>
                <td align="char" char="." rowspan="1" colspan="1">-1.759</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV FE</td>
                <td align="right" rowspan="1" colspan="1">1631</td>
                <td align="right" rowspan="1" colspan="1">1682</td>
                <td align="right" rowspan="1" colspan="1">52</td>
                <td align="right" rowspan="1" colspan="1">3.6e-11</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.506</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV-1 DIS</td>
                <td align="right" rowspan="1" colspan="1">240</td>
                <td align="right" rowspan="1" colspan="1">279</td>
                <td align="right" rowspan="1" colspan="1">40</td>
                <td align="right" rowspan="1" colspan="1">3.7e-11</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.205</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV-1 SL3</td>
                <td align="right" rowspan="1" colspan="1">309</td>
                <td align="right" rowspan="1" colspan="1">331</td>
                <td align="right" rowspan="1" colspan="1">23</td>
                <td align="right" rowspan="1" colspan="1">7.1e-09</td>
                <td align="char" char="." rowspan="1" colspan="1">+0.907</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV-1 SL4</td>
                <td align="right" rowspan="1" colspan="1">337</td>
                <td align="right" rowspan="1" colspan="1">356</td>
                <td align="right" rowspan="1" colspan="1">20</td>
                <td align="right" rowspan="1" colspan="1">1.9e-05</td>
                <td align="char" char="." rowspan="1" colspan="1">+0.907</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV-1 SD</td>
                <td align="right" rowspan="1" colspan="1">282</td>
                <td align="right" rowspan="1" colspan="1">300</td>
                <td align="right" rowspan="1" colspan="1">19</td>
                <td align="right" rowspan="1" colspan="1">3.7e-05</td>
                <td align="char" char="." rowspan="1" colspan="1">-0.529</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec018">
    <title>Discussion</title>
    <p>In this paper, we have introduced two cubic time algorithms, both implemented in the publicly available program <monospace>RNAentropy</monospace>, to compute the RNA <italic>thermodynamic structural entropy</italic>, <italic>H</italic> = −∑<sub><italic>s</italic></sub>
<italic>p</italic>(<italic>s</italic>) ln <italic>p</italic>(<italic>s</italic>), where <italic>p</italic>(<italic>s</italic>) = exp(−<italic>E</italic>(<italic>s</italic>)/<italic>RT</italic>)/<italic>Z</italic> is the Boltzmann probability of secondary structure <italic>s</italic>, and the sum is taken over all structures of a given RNA sequence <inline-formula id="pone.0137859.e090"><alternatives><graphic xlink:href="pone.0137859.e090.jpg" id="pone.0137859.e090g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M90"><mml:mrow><mml:mi mathvariant="bold">a</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. This answers a question raised by M. Zuker (personal communication, 2009). Taking a benchmarking set that consists of the first RNA from each of the 2450 families from database Rfam 11.0 [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>], we determined the correlation of thermodynamic structural entropy with a variety of other measures used in the computational design and experimental validation of synthetic RNA [<xref rid="pone.0137859.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0137859.ref031" ref-type="bibr">31</xref>].</p>
    <p>In [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>], Manzourolajdad et al. described an algorithm to compute RNA structural entropy <italic>H</italic> = −∑<sub><italic>s</italic></sub>
<italic>p</italic>(<italic>s</italic>) ln <italic>p</italic>(<italic>s</italic>), where <italic>p</italic>(<italic>s</italic>) is the probability of the (unique) leftmost derivation of the sequence-structure pair <inline-formula id="pone.0137859.e091"><alternatives><graphic xlink:href="pone.0137859.e091.jpg" id="pone.0137859.e091g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M91"><mml:mrow><mml:mi mathvariant="bold">a</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <italic>conditioned</italic> on the probability of deriving the sequence <inline-formula id="pone.0137859.e092"><alternatives><graphic xlink:href="pone.0137859.e092.jpg" id="pone.0137859.e092g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M92"><mml:mi mathvariant="bold">a</mml:mi></mml:math></alternatives></inline-formula>. Using random RNA, the 960 seed alignment sequences from Rfam family RF00005, and a collection of 2450 sequences obtained by selecting the first RNA from the seed alignment of each family from the Rfam 11.0 database [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>], we show the following: (1) the thermodynamic structural entropy algorithms DP, FTD compute the same structural entropy values with the same efficiency, although as sequence length increases, FTD runs somewhat faster and returns slightly smaller values than does DP. (2) DP and FTD appear to be an order of magnitude faster than the SCFG method of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>], which latter requires two minutes for RNA sequences of length 500 that require only a few seconds for DP and FTD. (3) Derivational entropy values computed by the method of [<xref rid="pone.0137859.ref024" ref-type="bibr">24</xref>] are much larger than thermodynamic structural entropy values of DP and FTD, ranging from about 4-8 times larger,depending on the SCFG chosen. (4) The length-normalized correlation between thermodynamic structural entropy values and derivational entropy values is poor to moderately weak.</p>
    <p>Why are SCFG structural entropy values much larger than thermodynamic structural entropy values knowing that all entropies are computed with the natural logarithm? Indeed, by numerical fitting of DP and SCFG entropy values for random RNA depicted in <xref ref-type="fig" rid="pone.0137859.g001">Fig 1B</xref>, we determine that SCFG(G6) entropy values are 3.56 times larger than DP, while G4 and G5 entropy values are 6.71 resp. 6.85 times larger than DP entropy values. From results and discussion in [<xref rid="pone.0137859.ref025" ref-type="bibr">25</xref>, <xref rid="pone.0137859.ref026" ref-type="bibr">26</xref>], one might speculate that derivational entropy of a given RNA sequence <inline-formula id="pone.0137859.e093"><alternatives><graphic xlink:href="pone.0137859.e093.jpg" id="pone.0137859.e093g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M93"><mml:mi mathvariant="bold">a</mml:mi></mml:math></alternatives></inline-formula> might be smaller if the SCFG correctly captured the ‘essence’ of particular training set of RNAs, and that <inline-formula id="pone.0137859.e094"><alternatives><graphic xlink:href="pone.0137859.e094.jpg" id="pone.0137859.e094g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M94"><mml:mi mathvariant="bold">a</mml:mi></mml:math></alternatives></inline-formula> resembles the RNAs of the training set. However this cannot be correct, since <xref ref-type="fig" rid="pone.0137859.g002">Fig 2B</xref> presents derivational entropy values for 960 transfer RNAs from family RF00005 from the Rfam 11.0 database [<xref rid="pone.0137859.ref040" ref-type="bibr">40</xref>], where grammars G4, G5 and G6 were <italic>trained</italic> on the dataset ‘Rfam5’. At present, there is no clear answer to the question of why derivational entropy values are so much larger than thermodynamic structural entropy values. At the very least, the difference in entropy values indicates that secondary structures have very different probabilities, depending on the algorithm used.</p>
    <p>We now discuss the relation with work of Miklos et al. [<xref rid="pone.0137859.ref055" ref-type="bibr">55</xref>], who described a dynamic programming algorithm to compute the expected energy of an RNA sequence. In personal communications, the main authors, I. Miklos and I.M. Meyer, have both reported that their original dynamic programming code appears to be lost. Moreover, only the general idea
<disp-formula id="pone.0137859.e095"><alternatives><graphic xlink:href="pone.0137859.e095.jpg" id="pone.0137859.e095g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M95"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munderover><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives><label>(36)</label></disp-formula>
of their algorithm is described in [<xref rid="pone.0137859.ref055" ref-type="bibr">55</xref>], corresponding approximately, but not exactly, with <xref ref-type="disp-formula" rid="pone.0137859.e043">Eq (16)</xref> in Section “Entropy by dynamic programming”
<disp-formula id="pone.0137859.e096"><alternatives><graphic xlink:href="pone.0137859.e096.jpg" id="pone.0137859.e096g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M96"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munderover><mml:mi>b</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>Z</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>Q</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(37)</label></disp-formula>
</p>
    <p>In particular, none of the explicit details of Section “Recursions for the Turner nearest neighbor energy model” concerning the recursions for treating hairpins, bulges, internal loops, and multiloops appear in [<xref rid="pone.0137859.ref055" ref-type="bibr">55</xref>]. For these reasons, we developed our own recursions and implemented our own DP algorithm to compute expected energy. As shown in <xref ref-type="fig" rid="pone.0137859.g001">Fig 1</xref>, it takes only a few seconds to compute the entropy of an RNA sequence of length 500 nt on a Core2Duo PC (2.8 GHz; a 2 Gbyte memory; CentOS 5.5). In contrast, Miklos et al. [<xref rid="pone.0137859.ref055" ref-type="bibr">55</xref>] state that their code took about 10 minutes to compute the entropy and <italic>variance</italic> for an RNA sequence of length 120 nt, using a Pentium4 2.0 GHz computer. As the presumably slower program of Miklos et al. is no longer available, the public availability of our program <monospace>RNAentropy</monospace> may be of benefit to other researchers.</p>
    <p>In [<xref rid="pone.0137859.ref056" ref-type="bibr">56</xref>] Salari et al. describe a dynamic programming algorithm to compute the <italic>relative entropy</italic>, or Kullbach-Liebler distance, <italic>P</italic>∣∣<italic>Q</italic>, where <italic>P</italic> is the Boltzmann probability distribution for all secondary structures of a given RNA sequence, and <italic>Q</italic> is the Boltzmann probability distribution for all secondary structures of single point mutant of that sequence (an energy assumption is made to avoid zeros in the denominator when computing relative entropy). The recursions given in [<xref rid="pone.0137859.ref056" ref-type="bibr">56</xref>] are similar to but distinct from those given in the current paper, and to our knowledge, the software of Salari et al., which would need modification to compute entropy, is not available.</p>
    <p>There are three future additions that may make our code, <monospace>RNAentropy</monospace>, more useful. First, it is possible to extend the code in order to compute expected energy and the structural entropy of a hybridization complex. Second, it is possible to incorporate <italic>hard constraints</italic>, where all structures are required to have certain positions base-paired together, or certain positions to be unpaired. Such hard constraints were first introduced in [<xref rid="pone.0137859.ref057" ref-type="bibr">57</xref>]. Third, it is possible to incorporate <italic>soft constraints</italic>, where Boltzmann weights penalize positions that deviate from chemical footprinting data, such as in-line probing or selective 2’-hydroxyl acylation analyzed by primer extension (SHAPE). For details on soft constraints, see Zarringhalam et al. [<xref rid="pone.0137859.ref058" ref-type="bibr">58</xref>], as well as the web server <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/clotelab/RNAsc">http://bioinformatics.bc.edu/clotelab/RNAsc</ext-link>. Although entropy can be computed using a simple script that calls <monospace>RNAfold -p ––betaScale</monospace>, both hard and soft constraints are handled quite differently by the Vienna RNA Package, so the suggested enhancements of <monospace>RNAentropy</monospace> may prove useful.</p>
    <p>Our program, <monospace>RNAentropy</monospace>, has two versions, depending on whether the user wishes to use the Turner 1999 parameters, or the newer Turner 2004 parameters [<xref rid="pone.0137859.ref005" ref-type="bibr">5</xref>] (in both cases, energy parameters do not include dangle or coaxial stacking, and were obtained from the Vienna RNA Package [<xref rid="pone.0137859.ref010" ref-type="bibr">10</xref>]). Additionally, <monospace>RNAentropy</monospace> implements the method described in Section “Entropy by statistical physics”, which computes expected energy <inline-formula id="pone.0137859.e097"><alternatives><graphic xlink:href="pone.0137859.e097.jpg" id="pone.0137859.e097g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M97"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>E</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo form="prefix">ln</mml:mo><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, by <italic>uncoupling</italic> formal and table temperatures. For convenience, we also make available a script to compute entropy by calling <monospace>RNAfold ––betaScale</monospace>. For relatively short RNAs, the uncentered formal temperature derivative method is fast and accurate, as implemented in methods <monospace>FTD</monospace> and <monospace>ViennaRNA</monospace>, while the centered versions <monospace>FTD</monospace>* and <monospace>ViennaRNA</monospace>* are somewhat slower. Since <monospace>Vienna RNA Package</monospace> has been under constant development, refinement and extension for approximately 30 years, the software enjoys an efficiency and speed that is remarkable (see <xref ref-type="fig" rid="pone.0137859.g005">Fig 5A</xref>). When using methods <monospace>ViennaRNA</monospace> and <monospace>ViennaRNA</monospace>*, it is recommended to use Δ<italic>T</italic> = 10<sup>−2</sup> since smaller values lead to increasingly incorrect values. In contrast, <monospace>FTD</monospace> and <monospace>FTD</monospace>* may be used with Δ<italic>T</italic> as small as 10<sup>−7</sup>, although when benchmarking against random RNA of length 20-500, the data (not shown) suggest that differences between <monospace>DP</monospace> and <monospace>FTD</monospace> [resp. <monospace>FTD</monospace>*] are minimized for Δ<italic>T</italic> = 10<sup>−2</sup> [resp. Δ<italic>T</italic> = 10<sup>−9</sup>] (nevertheless, the choice of Δ<italic>T</italic> makes little difference for <monospace>FTD</monospace> and <monospace>FTD</monospace>*). For larger sequences, real entropy values, as computed by <monospace>DP</monospace> exceed the approximate methods by a larger margin, hence we recommend that <monospace>DP</monospace> should be used. Our code is available at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/clotelab/RNAentropy">http://bioinformatics.bc.edu/clotelab/RNAentropy</ext-link>.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to thank I.L. Hofacker for kindly pointing out the flag <monospace>––betaScale</monospace> in <monospace>RNAfold</monospace>, and for suggesting to consider a centered finite difference when approximating the derivative of ln <italic>Z</italic>. We would also like to thank both I. Miklos and I.M. Meyer for correspondence concerning the availability of their code from [<xref rid="pone.0137859.ref055" ref-type="bibr">55</xref>], Y. Ding for generously providing the hammerhead and mRNA data from [<xref rid="pone.0137859.ref032" ref-type="bibr">32</xref>], and E. Rivas for a discussion about SCFGs.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0137859.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Marlow</surname><given-names>MS</given-names></name>, <name><surname>Dogan</surname><given-names>J</given-names></name>, <name><surname>Frederick</surname><given-names>KK</given-names></name>, <name><surname>Valentine</surname><given-names>KG</given-names></name>, <name><surname>Wand</surname><given-names>AJ</given-names></name>. <article-title>The role of conformational entropy in molecular recognition by calmodulin</article-title>. <source>Nat Chem Biol</source>. <year>2010</year><month>5</month>;<volume>6</volume>(<issue>5</issue>):<fpage>352</fpage>–<lpage>358</lpage>. <pub-id pub-id-type="doi">10.1038/nchembio.347</pub-id><?supplied-pmid 20383153?><pub-id pub-id-type="pmid">20383153</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Wand</surname><given-names>AJ</given-names></name>. <article-title>The dark energy of proteins comes to light: conformational entropy and its role in protein function revealed by NMR relaxation</article-title>. <source>Curr Opin Struct Biol</source>. <year>2013</year><month>2</month>;<volume>23</volume>(<issue>1</issue>):<fpage>75</fpage>–<lpage>81</lpage>. <pub-id pub-id-type="doi">10.1016/j.sbi.2012.11.005</pub-id><?supplied-pmid 23246280?><pub-id pub-id-type="pmid">23246280</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Karplus</surname><given-names>M</given-names></name>, <name><surname>Ichiye</surname><given-names>T</given-names></name>, <name><surname>Pettitt</surname><given-names>BM</given-names></name>. <article-title>Configurational entropy of native proteins</article-title>. <source>Biophys J</source>. <year>1987</year><month>12</month>;<volume>52</volume>(<issue>6</issue>):<fpage>1083</fpage>–<lpage>1085</lpage>. <pub-id pub-id-type="doi">10.1016/S0006-3495(87)83303-9</pub-id><?supplied-pmid 3427197?><pub-id pub-id-type="pmid">3427197</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Harpole</surname><given-names>KW</given-names></name>, <name><surname>Sharp</surname><given-names>KA</given-names></name>. <article-title>Calculation of configurational entropy with a Boltzmann-quasiharmonic model: the origin of high-affinity protein-ligand binding</article-title>. <source>J Phys Chem B</source>. <year>2011</year><month>8</month>;<volume>115</volume>(<issue>30</issue>):<fpage>9461</fpage>–<lpage>9472</lpage>. <pub-id pub-id-type="doi">10.1021/jp111176x</pub-id><?supplied-pmid 21678965?><pub-id pub-id-type="pmid">21678965</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Turner</surname><given-names>DH</given-names></name>, <name><surname>Mathews</surname><given-names>DH</given-names></name>. <article-title>NNDB: the nearest neighbor parameter database for predicting stability of nucleic acid secondary structure</article-title>. <source>Nucleic Acids Res</source>. <year>2010</year><month>1</month>;<volume>38</volume>(<issue>Database</issue>):<fpage>D280</fpage>–<lpage>D282</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkp892</pub-id><?supplied-pmid 19880381?><pub-id pub-id-type="pmid">19880381</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref006">
      <label>6</label>
      <mixed-citation publication-type="book"><name><surname>I Tinoco</surname><given-names>J</given-names></name>, <name><surname>Schmitz</surname><given-names>M</given-names></name>. <chapter-title>Thermodynamics of formation of secondary structure in nucleic acids</chapter-title> In: <name><surname>Cera</surname><given-names>ED</given-names></name>, editor. <source>Thermodynamics in Biology</source>. <publisher-name>Oxford University Press</publisher-name>; <year>2000</year> p. <fpage>131</fpage>–<lpage>176</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0137859.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Zuker</surname><given-names>M</given-names></name>, <name><surname>Stiegler</surname><given-names>P</given-names></name>. <article-title>Optimal computer folding of large RNA sequences using thermodynamics and auxiliary information</article-title>. <source>Nucleic Acids Res</source>. <year>1981</year>;<volume>9</volume>:<fpage>133</fpage>–<lpage>148</lpage>. <pub-id pub-id-type="doi">10.1093/nar/9.1.133</pub-id><?supplied-pmid 6163133?><pub-id pub-id-type="pmid">6163133</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Zuker</surname><given-names>M</given-names></name>. <article-title>Mfold web server for nucleic acid folding and hybridization prediction</article-title>. <source>Nucleic Acids Res</source>. <year>2003</year>;<volume>31</volume>(<issue>13</issue>):<fpage>3406</fpage>–<lpage>3415</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkg595</pub-id><?supplied-pmid 12824337?><pub-id pub-id-type="pmid">12824337</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Markham</surname><given-names>NR</given-names></name>, <name><surname>Zuker</surname><given-names>M</given-names></name>. <article-title>UNAFold: software for nucleic acid folding and hybridization</article-title>. <source>Methods Mol Biol</source>. <year>2008</year>;<volume>453</volume>:<fpage>3</fpage>–<lpage>31</lpage>. <pub-id pub-id-type="doi">10.1007/978-1-60327-429-6_1</pub-id><?supplied-pmid 18712296?><pub-id pub-id-type="pmid">18712296</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Lorenz</surname><given-names>R</given-names></name>, <name><surname>Bernhart</surname><given-names>SH</given-names></name>, <name><surname>Honer Zu Siederdissen</surname><given-names>C</given-names></name>, <name><surname>Tafer</surname><given-names>H</given-names></name>, <name><surname>Flamm</surname><given-names>C</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <etal>et al</etal><article-title>ViennaRNA Package 2.0</article-title>. <source>Algorithms Mol Biol</source>. <year>2011</year>;<volume>6</volume>:<fpage>26</fpage><pub-id pub-id-type="doi">10.1186/1748-7188-6-26</pub-id><?supplied-pmid 22115189?><pub-id pub-id-type="pmid">22115189</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>McCaskill</surname><given-names>JS</given-names></name>. <article-title>The equilibrium partition function and base pair binding probabilities for RNA secondary structure</article-title>. <source>Biopolymers</source>. <year>1990</year>;<volume>29</volume>:<fpage>1105</fpage>–<lpage>1119</lpage>. <pub-id pub-id-type="doi">10.1002/bip.360290621</pub-id><?supplied-pmid 1695107?><pub-id pub-id-type="pmid">1695107</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Hammell</surname><given-names>M</given-names></name>, <name><surname>Long</surname><given-names>D</given-names></name>, <name><surname>Zhang</surname><given-names>L</given-names></name>, <name><surname>Lee</surname><given-names>A</given-names></name>, <name><surname>Carmack</surname><given-names>CS</given-names></name>, <name><surname>Han</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>mirWIP: microRNA target prediction based on microRNA-containing ribonucleoprotein-enriched transcripts</article-title>. <source>Nat Methods</source>. <year>2008</year><month>9</month>;<volume>5</volume>(<issue>9</issue>):<fpage>813</fpage>–<lpage>819</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1247</pub-id><?supplied-pmid 19160516?><pub-id pub-id-type="pmid">19160516</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Choi</surname><given-names>HM</given-names></name>, <name><surname>Chang</surname><given-names>JY</given-names></name>, <name><surname>Trinh le</surname><given-names>A</given-names></name>, <name><surname>Padilla</surname><given-names>JE</given-names></name>, <name><surname>Fraser</surname><given-names>SE</given-names></name>, <name><surname>Pierce</surname><given-names>NA</given-names></name>. <article-title>Programmable in situ amplification for multiplexed imaging of mRNA expression</article-title>. <source>Nat Biotechnol</source>. <year>2010</year><month>11</month>;<volume>28</volume>(<issue>11</issue>):<fpage>1208</fpage>–<lpage>1212</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.1692</pub-id><?supplied-pmid 21037591?><pub-id pub-id-type="pmid">21037591</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Dotu</surname><given-names>I</given-names></name>, <name><surname>Garcia-Martin</surname><given-names>JA</given-names></name>, <name><surname>Slinger</surname><given-names>BL</given-names></name>, <name><surname>Mechery</surname><given-names>V</given-names></name>, <name><surname>Meyer</surname><given-names>MM</given-names></name>, <name><surname>Clote</surname><given-names>P</given-names></name>. <article-title>Complete RNA inverse folding: computational design of functional hammerhead ribozymes</article-title>. <source>Nucleic Acids Res</source>. <year>2015</year><month>2</month>;<volume>42</volume>(<issue>18</issue>):<fpage>11752</fpage>–<lpage>11762</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gku740</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Schneider</surname><given-names>TD</given-names></name>, <name><surname>Stephens</surname><given-names>RM</given-names></name>. <article-title>Sequence logos: a new way to display consensus sequences</article-title>. <source>Nucleic Acids Res</source>. <year>1990</year><month>10</month>;<volume>18</volume>(<issue>20</issue>):<fpage>6097</fpage>–<lpage>6100</lpage>. <pub-id pub-id-type="doi">10.1093/nar/18.20.6097</pub-id><?supplied-pmid 2172928?><pub-id pub-id-type="pmid">2172928</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Crooks</surname><given-names>GE</given-names></name>, <name><surname>Hon</surname><given-names>G</given-names></name>, <name><surname>Chandonia</surname><given-names>JM</given-names></name>, <name><surname>Brenner</surname><given-names>SE</given-names></name>. <article-title>WebLogo: a sequence logo generator</article-title>. <source>Genome Res</source>. <year>2004</year><month>6</month>;<volume>14</volume>(<issue>6</issue>):<fpage>1188</fpage>–<lpage>1190</lpage>. <pub-id pub-id-type="doi">10.1101/gr.849004</pub-id><?supplied-pmid 15173120?><pub-id pub-id-type="pmid">15173120</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Bindewald</surname><given-names>E</given-names></name>, <name><surname>Schneider</surname><given-names>TD</given-names></name>, <name><surname>Shapiro</surname><given-names>BA</given-names></name>. <article-title>CorreLogo: an online server for 3D sequence logos of RNA and DNA alignments</article-title>. <source>Nucleic Acids Res</source>. <year>2006</year><month>7</month>;<volume>34</volume>(<issue>Web</issue>):<fpage>W405</fpage>–<lpage>W411</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkl269</pub-id><?supplied-pmid 16845037?><pub-id pub-id-type="pmid">16845037</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Gorodkin</surname><given-names>J</given-names></name>, <name><surname>Heyer</surname><given-names>LJ</given-names></name>, <name><surname>Brunak</surname><given-names>S</given-names></name>, <name><surname>Stormo</surname><given-names>GD</given-names></name>. <article-title>Displaying the information contents of structural RNA alignments: the structure logos</article-title>. <source>Comput Appl Biosci</source>. <year>1997</year><month>12</month>;<volume>13</volume>(<issue>6</issue>):<fpage>583</fpage>–<lpage>586</lpage>.
<?supplied-pmid 9475985?><pub-id pub-id-type="pmid">9475985</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Kazan</surname><given-names>H</given-names></name>, <name><surname>Ray</surname><given-names>D</given-names></name>, <name><surname>Chan</surname><given-names>ET</given-names></name>, <name><surname>Hughes</surname><given-names>TR</given-names></name>, <name><surname>Morris</surname><given-names>Q</given-names></name>. <article-title>RNAcontext: a new method for learning the sequence and structure binding preferences of RNA-binding proteins</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>:<fpage>e1000832</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000832</pub-id><?supplied-pmid 20617199?><pub-id pub-id-type="pmid">20617199</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Kazan</surname><given-names>H</given-names></name>, <name><surname>Morris</surname><given-names>Q</given-names></name>. <article-title>RBPmotif: a web server for the discovery of sequence and structure preferences of RNA-binding proteins</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year><month>7</month>;<volume>41</volume>(<issue>Web</issue>):<fpage>W180</fpage>–<lpage>W186</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkt463</pub-id><?supplied-pmid 23754853?><pub-id pub-id-type="pmid">23754853</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Huynen</surname><given-names>M</given-names></name>, <name><surname>Gutell</surname><given-names>R</given-names></name>, <name><surname>Konings</surname><given-names>D</given-names></name>. <article-title>Assessing the reliability of RNA folding using statistical mechanics</article-title>. <source>J Mol Biol</source>. <year>1997</year><month>4</month>;<volume>267</volume>(<issue>5</issue>):<fpage>1104</fpage>–<lpage>1112</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.1997.0889</pub-id><?supplied-pmid 9150399?><pub-id pub-id-type="pmid">9150399</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Mathews</surname><given-names>DH</given-names></name>. <article-title>Using an RNA secondary structure partition function to determine confidence in base pairs predicted by free energy minimization</article-title>. <source>RNA</source>. <year>2004</year><month>8</month>;<volume>10</volume>(<issue>8</issue>):<fpage>1178</fpage>–<lpage>1190</lpage>. <pub-id pub-id-type="doi">10.1261/rna.7650904</pub-id><?supplied-pmid 15272118?><pub-id pub-id-type="pmid">15272118</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Nawrocki</surname><given-names>EP</given-names></name>, <name><surname>Burge</surname><given-names>SW</given-names></name>, <name><surname>Bateman</surname><given-names>A</given-names></name>, <name><surname>Daub</surname><given-names>J</given-names></name>, <name><surname>Eberhardt</surname><given-names>RY</given-names></name>, <name><surname>Eddy</surname><given-names>SR</given-names></name>, <etal>et al</etal><article-title>Rfam 12.0: updates to the RNA families database</article-title>. <source>Nucleic Acids Res</source>. <year>2015</year><month>11</month>;<volume>43</volume>(<issue>Database issue</issue>):<fpage>D130</fpage>–<lpage>D137</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gku1063</pub-id><?supplied-pmid 25392425?><pub-id pub-id-type="pmid">25392425</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Manzourolajdad</surname><given-names>A</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Shaw</surname><given-names>TI</given-names></name>, <name><surname>Malmberg</surname><given-names>RL</given-names></name>. <article-title>Information-theoretic uncertainty of SCFG-modeled folding space of the non-coding RNA</article-title>. <source>J theor Biol</source>. <year>2013</year><month>2</month>;<volume>318</volume>:<fpage>140</fpage>–<lpage>163</lpage>. <pub-id pub-id-type="doi">10.1016/j.jtbi.2012.10.023</pub-id><?supplied-pmid 23160142?><pub-id pub-id-type="pmid">23160142</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Sukosd</surname><given-names>Z</given-names></name>, <name><surname>Knudsen</surname><given-names>B</given-names></name>, <name><surname>Anderson</surname><given-names>JW</given-names></name>, <name><surname>Novak</surname><given-names>A</given-names></name>, <name><surname>Kjems</surname><given-names>J</given-names></name>, <name><surname>Pedersen</surname><given-names>CN</given-names></name>. <article-title>Characterising RNA secondary structure space using information entropy</article-title>. <source>BMC Bioinformatics</source>. <year>2013</year>;<volume>14</volume>:<fpage>S22</fpage><?supplied-pmid 23368905?><pub-id pub-id-type="pmid">23368905</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Anderson</surname><given-names>JW</given-names></name>, <name><surname>Novak</surname><given-names>A</given-names></name>, <name><surname>Sukosd</surname><given-names>Z</given-names></name>, <name><surname>Golden</surname><given-names>M</given-names></name>, <name><surname>Arunapuram</surname><given-names>P</given-names></name>, <name><surname>Edvardsson</surname><given-names>I</given-names></name>, <etal>et al</etal><article-title>Quantifying variances in comparative RNA secondary structure prediction</article-title>. <source>BMC Bioinformatics</source>. <year>2013</year>;<volume>14</volume>:<fpage>149</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-14-149</pub-id><?supplied-pmid 23634662?><pub-id pub-id-type="pmid">23634662</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Sukosd</surname><given-names>Z</given-names></name>, <name><surname>Knudsen</surname><given-names>B</given-names></name>, <name><surname>Vaerum</surname><given-names>M</given-names></name>, <name><surname>Kjems</surname><given-names>J</given-names></name>, <name><surname>Andersen</surname><given-names>ES</given-names></name>. <article-title>Multithreaded comparative RNA secondary structure prediction using stochastic context-free grammars</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>:<fpage>103</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-12-103</pub-id><?supplied-pmid 21501497?><pub-id pub-id-type="pmid">21501497</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Dowell</surname><given-names>RD</given-names></name>, <name><surname>Eddy</surname><given-names>SR</given-names></name>. <article-title>Evaluation of several lightweight stochastic context-free grammars for RNA secondary structure prediction</article-title>. <source>BMC Bioinformatics</source>. <year>2004</year><month>6</month>;<volume>5</volume>:<fpage>71</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-5-71</pub-id><?supplied-pmid 15180907?><pub-id pub-id-type="pmid">15180907</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Dirks</surname><given-names>RM</given-names></name>, <name><surname>Lin</surname><given-names>M</given-names></name>, <name><surname>Winfree</surname><given-names>E</given-names></name>, <name><surname>Pierce</surname><given-names>NA</given-names></name>. <article-title>Paradigms for computational nucleic acid design</article-title>. <source>Nucleic Acids Res</source>. <year>2004</year>;<volume>32</volume>(<issue>4</issue>):<fpage>1392</fpage>–<lpage>1403</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkh291</pub-id><?supplied-pmid 14990744?><pub-id pub-id-type="pmid">14990744</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Morgan</surname><given-names>SR</given-names></name>, <name><surname>Higgs</surname><given-names>PG</given-names></name>. <article-title>Barrier heights between ground states in a model of RNA secondary structure</article-title>. <source>J Phys A: Math Gen</source>. <year>1998</year>;<volume>31</volume>:<fpage>3153</fpage>–<lpage>3170</lpage>. <pub-id pub-id-type="doi">10.1088/0305-4470/31/14/005</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Zadeh</surname><given-names>JN</given-names></name>, <name><surname>Wolfe</surname><given-names>BR</given-names></name>, <name><surname>Pierce</surname><given-names>NA</given-names></name>. <article-title>Nucleic acid sequence design via efficient ensemble defect optimization</article-title>. <source>J Comput Chem</source>. <year>2011</year><month>2</month>;<volume>32</volume>(<issue>3</issue>):<fpage>439</fpage>–<lpage>452</lpage>. <pub-id pub-id-type="doi">10.1002/jcc.21633</pub-id><?supplied-pmid 20717905?><pub-id pub-id-type="pmid">20717905</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Shao</surname><given-names>Y</given-names></name>, <name><surname>Wu</surname><given-names>S</given-names></name>, <name><surname>Chan</surname><given-names>CY</given-names></name>, <name><surname>Klapper</surname><given-names>JR</given-names></name>, <name><surname>Schneider</surname><given-names>E</given-names></name>, <name><surname>Ding</surname><given-names>Y</given-names></name>. <article-title>A structural analysis of in vitro catalytic activities of hammerhead ribozymes</article-title>. <source>BMC Bioinformatics</source>. <year>2007</year>;<volume>8</volume>:<fpage>469</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-8-469</pub-id><?supplied-pmid 18053134?><pub-id pub-id-type="pmid">18053134</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Higgs</surname><given-names>PG</given-names></name>. <article-title>RNA secondary structure: physical and computational aspects</article-title>. <source>Q Rev Biophys</source>. <year>2000</year><month>8</month>;<volume>33</volume>(<issue>3</issue>):<fpage>199</fpage>–<lpage>253</lpage>. <pub-id pub-id-type="doi">10.1017/S0033583500003620</pub-id><?supplied-pmid 11191843?><pub-id pub-id-type="pmid">11191843</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Nussinov</surname><given-names>R</given-names></name>, <name><surname>Jacobson</surname><given-names>AB</given-names></name>. <article-title>Fast Algorithm for Predicting the Secondary Structure of Single Stranded RNA</article-title>. <source>Proceedings of the National Academy of Sciences, USA</source>. <year>1980</year>;<volume>77</volume>(<issue>11</issue>):<fpage>6309</fpage>–<lpage>6313</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.77.11.6309</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Ding</surname><given-names>Y</given-names></name>, <name><surname>Lawrence</surname><given-names>CE</given-names></name>. <article-title>A statistical sampling algorithm for RNA secondary structure prediction</article-title>. <source>Nucleic Acids Res</source>. <year>2003</year>;<volume>31</volume>:<fpage>7280</fpage>–<lpage>7301</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkg938</pub-id><?supplied-pmid 14654704?><pub-id pub-id-type="pmid">14654704</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Wuchty</surname><given-names>S</given-names></name>, <name><surname>Fontana</surname><given-names>W</given-names></name>, <name><surname>Hofacker</surname><given-names>IL</given-names></name>, <name><surname>Schuster</surname><given-names>P</given-names></name>. <article-title>Complete suboptimal folding of RNA and the stability of secondary structures</article-title>. <source>Biopolymers</source>. <year>1999</year>;<volume>49</volume>:<fpage>145</fpage>–<lpage>164</lpage>. <pub-id pub-id-type="doi">10.1002/(SICI)1097-0282(199902)49:2&lt;145::AID-BIP4&gt;3.0.CO;2-G</pub-id><?supplied-pmid 10070264?><pub-id pub-id-type="pmid">10070264</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Juhling</surname><given-names>F</given-names></name>, <name><surname>Morl</surname><given-names>M</given-names></name>, <name><surname>Hartmann</surname><given-names>RK</given-names></name>, <name><surname>Sprinzl</surname><given-names>M</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <name><surname>Putz</surname><given-names>J</given-names></name>. <article-title>tRNAdb 2009: compilation of tRNA sequences and tRNA genes</article-title>. <source>Nucleic Acids Res</source>. <year>2009</year><month>1</month>;<volume>37</volume>(<issue>Database</issue>):<fpage>D159</fpage>–<lpage>D162</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkn772</pub-id><?supplied-pmid 18957446?><pub-id pub-id-type="pmid">18957446</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref038">
      <label>38</label>
      <mixed-citation publication-type="book"><name><surname>Dill</surname><given-names>KA</given-names></name>, <name><surname>Bromberg</surname><given-names>S</given-names></name>. <source>Molecular Driving Forces: Statistical Thermodynamics in Chemistry and Biology</source>. <publisher-name>Garland Publishing Inc</publisher-name>; <year>2002</year><fpage>704</fpage> pages.</mixed-citation>
    </ref>
    <ref id="pone.0137859.ref039">
      <label>39</label>
      <mixed-citation publication-type="book"><name><surname>Zuker</surname><given-names>M</given-names></name>, <name><surname>Mathews</surname><given-names>DH</given-names></name>, <name><surname>Turner</surname><given-names>DH</given-names></name>. <chapter-title>Algorithms and Thermodynamics for RNA Secondary Structure Prediction: A Practical Guide</chapter-title> In: <name><surname>Barciszewski</surname><given-names>J</given-names></name>, <name><surname>Clark</surname><given-names>BFC</given-names></name>, editors. <source>RNA Biochemistry and Biotechnology</source>. NATO ASI Series. <publisher-name>Kluwer Academic Publishers</publisher-name>; <year>1999</year> p. <fpage>11</fpage>–<lpage>43</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0137859.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Burge</surname><given-names>SW</given-names></name>, <name><surname>Daub</surname><given-names>J</given-names></name>, <name><surname>Eberhardt</surname><given-names>R</given-names></name>, <name><surname>Tate</surname><given-names>J</given-names></name>, <name><surname>Barquist</surname><given-names>L</given-names></name>, <name><surname>Nawrocki</surname><given-names>EP</given-names></name>, <etal>et al</etal><article-title>Rfam 11.0: 10 years of RNA families</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year><month>1</month>;<volume>41</volume>(<issue>Database</issue>):<fpage>D226</fpage>–<lpage>D232</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1005</pub-id><?supplied-pmid 23125362?><pub-id pub-id-type="pmid">23125362</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref041">
      <label>41</label>
      <mixed-citation publication-type="book"><name><surname>Giegerich</surname><given-names>R</given-names></name>, <name><surname>Haase</surname><given-names>D</given-names></name>, <name><surname>Rehmsmeier</surname><given-names>M</given-names></name>. <chapter-title>Prediction and visualization of structural switches in RNA</chapter-title> In: <name><surname>Altman</surname><given-names>RB</given-names></name>, <name><surname>Dunker</surname><given-names>AK</given-names></name>, <name><surname>Hunter</surname><given-names>L</given-names></name>, <name><surname>Klein</surname><given-names>TE</given-names></name>, editors. <source>Pacific Symposium on Biocomputing</source>. <publisher-name>World Scientific</publisher-name>; <year>1999</year> p. <fpage>126</fpage>–<lpage>137</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0137859.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Erikson</surname><given-names>BW</given-names></name>. <article-title>Significance of Nucleotide Sequence Alignments: A Method for Random Sequence Permutation That Preserves Dinucleotide and Codon Usage</article-title>. <source>Mol Biol Evol</source>. <year>1985</year>;<volume>2</volume>(<issue>6</issue>):<fpage>526</fpage>–<lpage>538</lpage>.
<?supplied-pmid 3870875?><pub-id pub-id-type="pmid">3870875</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Clote</surname><given-names>P</given-names></name>, <name><surname>Ferré</surname><given-names>F</given-names></name>, <name><surname>Kranakis</surname><given-names>E</given-names></name>, <name><surname>Krizanc</surname><given-names>D</given-names></name>. <article-title>Structural RNA has lower folding energy than random RNA of the same dinucleotide frequency</article-title>. <source>RNA</source>. <year>2005</year>;<volume>11</volume>(<issue>5</issue>):<fpage>578</fpage>–<lpage>591</lpage>. <pub-id pub-id-type="doi">10.1261/rna.7220505</pub-id><?supplied-pmid 15840812?><pub-id pub-id-type="pmid">15840812</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Griffiths-Jones</surname><given-names>S</given-names></name>, <name><surname>Saini</surname><given-names>HK</given-names></name>, <name><surname>Van Dongen</surname><given-names>S</given-names></name>, <name><surname>Enright</surname><given-names>AJ</given-names></name>. <article-title>miRBase: tools for microRNA genomics</article-title>. <source>Nucleic Acids Res</source>. <year>2008</year><month>1</month>;<volume>36</volume>(<issue>Database</issue>):<fpage>D154</fpage>–<lpage>D158</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkm952</pub-id><?supplied-pmid 17991681?><pub-id pub-id-type="pmid">17991681</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Rivas</surname><given-names>E</given-names></name>, <name><surname>Eddy</surname><given-names>S</given-names></name>. <article-title>Secondary structure alone is generally not statistically significant for the detection of noncoding RNA</article-title>. <source>Bioinformatics</source>. <year>2000</year>;<volume>16</volume>:<fpage>573</fpage>–<lpage>585</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/16.7.583</pub-id><pub-id pub-id-type="pmid">11038328</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Ng</surname><given-names>KL</given-names></name>, <name><surname>Mishra</surname><given-names>SK</given-names></name>. <article-title>De novo SVM classification of precursor microRNAs from genomic pseudo hairpins using global and intrinsic folding measures</article-title>. <source>Bioinformatics</source>. <year>2007</year><month>6</month>;<volume>23</volume>(<issue>11</issue>):<fpage>1321</fpage>–<lpage>1330</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btm026</pub-id><?supplied-pmid 17267435?><pub-id pub-id-type="pmid">17267435</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Rivas</surname><given-names>E</given-names></name>, <name><surname>Lang</surname><given-names>R</given-names></name>, <name><surname>Eddy</surname><given-names>SR</given-names></name>. <article-title>A range of complex probabilistic models for RNA secondary structure prediction that includes the nearest-neighbor model and more</article-title>. <source>RNA</source>. <year>2012</year><month>2</month>;<volume>18</volume>(<issue>2</issue>):<fpage>193</fpage>–<lpage>212</lpage>. <pub-id pub-id-type="doi">10.1261/rna.030049.111</pub-id><?supplied-pmid 22194308?><pub-id pub-id-type="pmid">22194308</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Lorenz</surname><given-names>WA</given-names></name>, <name><surname>Ponty</surname><given-names>Y</given-names></name>, <name><surname>Clote</surname><given-names>P</given-names></name>. <article-title>Asymptotics of RNA shapes</article-title>. <source>J Comput Biol</source>. <year>2008</year>;<volume>15</volume>(<issue>1</issue>):<fpage>31</fpage>–<lpage>63</lpage>. <pub-id pub-id-type="doi">10.1089/cmb.2006.0153</pub-id><?supplied-pmid 18257676?><pub-id pub-id-type="pmid">18257676</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Fusy</surname><given-names>E</given-names></name>, <name><surname>Clote</surname><given-names>P</given-names></name>. <article-title>Combinatorics of locally optimal RNA secondary structures</article-title>. <source>J Math Biol</source>. <year>2014</year><month>1</month>;<volume>68</volume>(<issue>1-2</issue>):<fpage>341</fpage>–<lpage>375</lpage>. <pub-id pub-id-type="doi">10.1007/s00285-012-0631-9</pub-id><?supplied-pmid 23263300?><pub-id pub-id-type="pmid">23263300</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Dirks</surname><given-names>RM</given-names></name>, <name><surname>Lin</surname><given-names>M</given-names></name>, <name><surname>Winfree</surname><given-names>E</given-names></name>, <name><surname>Pierce</surname><given-names>NA</given-names></name>. <article-title>Paradigms for computational nucleic acid design</article-title>. <source>Nucleic Acids Res</source>. <year>2004</year>;<volume>32</volume>(<issue>4</issue>):<fpage>1392</fpage>–<lpage>1403</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkh291</pub-id><?supplied-pmid 14990744?><pub-id pub-id-type="pmid">14990744</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Ding</surname><given-names>Y</given-names></name>, <name><surname>Chan</surname><given-names>CY</given-names></name>, <name><surname>Lawrence</surname><given-names>CE</given-names></name>. <article-title>Sfold web server for statistical folding and rational design of nucleic acids</article-title>. <source>Nucleic Acids Res</source>. <year>2004</year>;<volume>32</volume>:<issue>0</issue>.</mixed-citation>
    </ref>
    <ref id="pone.0137859.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Dimitrov</surname><given-names>R</given-names></name>, <name><surname>Zuker</surname><given-names>M</given-names></name>. <article-title>Prediction of hybridization and melting for double-stranded nucleic acids</article-title>. <source>Biophys J</source>. <year>2004</year>;<volume>87</volume>(<issue>1</issue>):<fpage>215</fpage>–<lpage>226</lpage>. <pub-id pub-id-type="doi">10.1529/biophysj.103.020743</pub-id><?supplied-pmid 15240459?><pub-id pub-id-type="pmid">15240459</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Nawrocki</surname><given-names>EP</given-names></name>, <name><surname>Eddy</surname><given-names>SR</given-names></name>. <article-title>Infernal 1.1: 100-fold faster RNA homology searches</article-title>. <source>Bioinformatics</source>. <year>2013</year><month>11</month>;<volume>29</volume>(<issue>22</issue>):<fpage>2933</fpage>–<lpage>2935</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt509</pub-id><?supplied-pmid 24008419?><pub-id pub-id-type="pmid">24008419</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Lu</surname><given-names>K</given-names></name>, <name><surname>Heng</surname><given-names>X</given-names></name>, <name><surname>Summers</surname><given-names>MF</given-names></name>. <article-title>Structural determinants and mechanism of HIV-1 genome packaging</article-title>. <source>J Mol Biol</source>. <year>2011</year><month>7</month>;<volume>410</volume>(<issue>4</issue>):<fpage>609</fpage>–<lpage>633</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmb.2011.04.029</pub-id><?supplied-pmid 21762803?><pub-id pub-id-type="pmid">21762803</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Miklos</surname><given-names>I</given-names></name>, <name><surname>Meyer</surname><given-names>IM</given-names></name>, <name><surname>Nagy</surname><given-names>B</given-names></name>. <article-title>Moments of the Boltzmann distribution for RNA secondary structures</article-title>. <source>Bull Math Biol</source>. <year>2005</year><month>9</month>;<volume>67</volume>(<issue>5</issue>):<fpage>1031</fpage>–<lpage>1047</lpage>. <pub-id pub-id-type="doi">10.1016/j.bulm.2004.12.003</pub-id><?supplied-pmid 15998494?><pub-id pub-id-type="pmid">15998494</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Salari</surname><given-names>R</given-names></name>, <name><surname>Kimchi-Sarfaty</surname><given-names>C</given-names></name>, <name><surname>Gottesman</surname><given-names>MM</given-names></name>, <name><surname>Przytycka</surname><given-names>TM</given-names></name>. <article-title>Sensitive measurement of single-nucleotide polymorphism-induced changes of RNA conformation: application to disease studies</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year><month>1</month>;<volume>41</volume>(<issue>1</issue>):<fpage>44</fpage>–<lpage>53</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1009</pub-id><?supplied-pmid 23125360?><pub-id pub-id-type="pmid">23125360</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Mathews</surname><given-names>DH</given-names></name>, <name><surname>Disney</surname><given-names>MD</given-names></name>, <name><surname>Childs</surname><given-names>JL</given-names></name>, <name><surname>Schroeder</surname><given-names>SJ</given-names></name>, <name><surname>Zuker</surname><given-names>M</given-names></name>, <name><surname>Turner</surname><given-names>DH</given-names></name>. <article-title>Incorporating chemical modification constraints into a dynamic programming algorithm for prediction of RNA secondary structure</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2004</year>;<volume>101</volume>:<fpage>7287</fpage>–<lpage>7292</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0401799101</pub-id><?supplied-pmid 15123812?><pub-id pub-id-type="pmid">15123812</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Zarringhalam</surname><given-names>K</given-names></name>, <name><surname>Meyer</surname><given-names>MM</given-names></name>, <name><surname>Dotu</surname><given-names>I</given-names></name>, <name><surname>Chuang</surname><given-names>JH</given-names></name>, <name><surname>Clote</surname><given-names>P</given-names></name>. <article-title>Integrating chemical footprinting data into RNA secondary structure prediction</article-title>. <source>PLoS One</source>. <year>2012</year>;<volume>7</volume>(<issue>10</issue>):<fpage>e45160</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0045160</pub-id><?supplied-pmid 23091593?><pub-id pub-id-type="pmid">23091593</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0137859.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Bernhart</surname><given-names>SH</given-names></name>, <name><surname>Tafer</surname><given-names>H</given-names></name>, <name><surname>Mückstein</surname><given-names>U</given-names></name>, <name><surname>Flamm</surname><given-names>C</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <name><surname>Hofacker</surname><given-names>IL</given-names></name>. <article-title>Partition function and base pairing probabilities of RNA heterodimers</article-title>. <source>Algorithms Mol Biol</source>. <year>2006</year>;<volume>1</volume>(<issue>1</issue>):<fpage>3</fpage><pub-id pub-id-type="doi">10.1186/1748-7188-1-3</pub-id><?supplied-pmid 16722605?><pub-id pub-id-type="pmid">16722605</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
