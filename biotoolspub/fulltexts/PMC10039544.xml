<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10039544</article-id>
    <article-id pub-id-type="pmid">36964502</article-id>
    <article-id pub-id-type="publisher-id">5233</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05233-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>multiWGCNA: an R package for deep mining gene co-expression networks in multi-trait expression data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tommasini</surname>
          <given-names>Dario</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9831-1576</contrib-id>
        <name>
          <surname>Fogel</surname>
          <given-names>Brent L.</given-names>
        </name>
        <address>
          <email>bfogel@ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution>Department of Neurology, UCLA David Geffen School of Medicine, </institution><institution>University of California, Los Angeles, </institution></institution-wrap>695 Charles E. Young Drive South, Gonda Room 6554A, Los Angeles, CA 90095 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution>Department of Human Genetics, UCLA David Geffen School of Medicine, </institution><institution>University of California, Los Angeles, </institution></institution-wrap>Los Angeles, CA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.19006.3e</institution-id><institution-id institution-id-type="ISNI">0000 0000 9632 6718</institution-id><institution>Bioinformatics Interdepartmental Program, </institution><institution>University of California, Los Angeles, </institution></institution-wrap>Los Angeles, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>115</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Gene co-expression networks represent modules of genes with shared biological function, and have been widely used to model biological pathways in gene expression data. Co-expression networks associated with a specific trait can be constructed and identified using weighted gene co-expression network analysis (WGCNA), which is especially useful for the study of transcriptional signatures in disease. WGCNA networks are typically constructed using both disease and wildtype samples, so molecular pathways associated with disease are identified. However, it would be advantageous to study such co-expression networks in their disease context across spatiotemporal conditions, but currently there is no comprehensive software implementation for this type of analysis.
</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we introduce a WGCNA-based procedure, multiWGCNA, that is tailored to datasets with variable spatial or temporal traits. As well as constructing the combined network, multiWGCNA also generates a network for each condition separately, and subsequently maps these modules between and across designs, and performs relevant downstream analyses, including module-trait correlation and module preservation. When applied to astrocyte-specific RNA-sequencing (RNA-seq) data from various brain regions of mice with experimental autoimmune encephalitis, multiWGCNA resolved the de novo formation of the neurotoxic astrocyte transcriptional program exclusively in the disease setting. Using time-course RNA-seq from mice with tau pathology (rTg4510), we demonstrate how multiWGCNA can also be used to study the temporal evolution of pathological modules over the course of disease progression.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">The multiWGCNA R package can be applied to expression data with two dimensions, which is especially useful for the study of disease-associated modules across time or space. The source code and functions are freely available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/fogellab/multiWGCNA">https://github.com/fogellab/multiWGCNA</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05233-z.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Co-expression network</kwd>
      <kwd>WGCNA</kwd>
      <kwd>Neurological disease</kwd>
      <kwd>Preservation</kwd>
      <kwd>Differential co-expression</kwd>
      <kwd>Astrocyte reactivity</kwd>
      <kwd>EAE</kwd>
      <kwd>rTg4510</kwd>
      <kwd>Tau pathology</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par9">Network analysis has been widely applied to gene expression data as a systems genetics approach to understand the coordinated activity of many genes [<xref ref-type="bibr" rid="CR1">1</xref>]. For this purpose, weighted gene co-expression network analysis (WGCNA) is a popular tool that has been used to identify development-specific transcriptional programs [<xref ref-type="bibr" rid="CR2">2</xref>], regional [<xref ref-type="bibr" rid="CR3">3</xref>] and pathological [<xref ref-type="bibr" rid="CR4">4</xref>] gene networks, and much more.</p>
    <p id="Par10">In a typical WGCNA, to resolve disease-specific alterations, both wildtype and disease samples are used for network construction, using correlation to binary disease status to resolve co-expression networks associated with disease. This approach is particularly effective at identifying cases where disease alters a critical network’s expression level. However, since both wildtype and disease samples are used for network construction, this approach provides no information on changes in network topology, such as whether the network is differentially preserved across conditions [<xref ref-type="bibr" rid="CR5">5</xref>]. Furthermore, for many disorders, it would be especially useful to analyze how the associated biological networks behave across various conditions beyond simply expression levels. Two key examples of this would be how the module changes across space (e.g., anatomical location, cell type, etc.) or time (e.g., timepoint, age).</p>
    <p id="Par11">When expression profiling experiments include two or more sample traits, multiple experimental designs are possible, and sample selection for network construction becomes more complex. In these cases, most protocols opt for using the entire dataset—regardless of disease status, time, age, tissue, etc.—for network construction [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. This is reasonable, as correlation-based methods benefit from larger sample sizes. However, other valid designs are possible, such as: (1) subsetting by disease status [<xref ref-type="bibr" rid="CR4">4</xref>], which enables study of the secondary trait across wildtype and disease samples separately, or (2) subsetting by the secondary trait itself, which enables study of disease across this other trait, which is useful for considerations involving varying space or time. A biologically relevant module should be robust and detectable across these different experimental designs [<xref ref-type="bibr" rid="CR7">7</xref>]. Currently, a comprehensive software implementation for this type of analysis is not available.</p>
    <p id="Par12">To address this gap, we developed a software tool that constructs all the individual networks for each possible design and subsequently integrates the resulting networks between these designs. Using astrocyte-specific RNA-seq from various brain regions of mice with experimentally induced autoimmune encephalitis (EAE) [<xref ref-type="bibr" rid="CR8">8</xref>], we demonstrate that our approach can identify disease-specific network topology that is highly relevant to EAE pathology. We also show that this procedure can facilitate selection of biologically interesting modules, a laborious step of standard network analysis. Lastly, we demonstrate how multiWGCNA can be used to study the evolution of pathological modules over time using a previously published module associated with tau accumulation in the rTg4510 mouse model [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>The multiWGCNA workflow</title>
      <p id="Par13">We devised a WGCNA-based procedure that can leverage the multidimensionality of experimental designs to study co-expression networks across variable conditions, such as space or time. As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, a typical multidimensional dataset has two sample traits: one of which is often disease status, and the other which is usually space (tissue/region) or time (timepoint/age). We refer to this additional trait as the secondary trait (ST). Broadly, the workflow consists of network construction, module mapping, and level-specific analyses (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). In the first step, we perform WGCNA to construct the networks (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a), which yields three levels of networks: (1) the combined network, (2) the disease-status networks, and (3) the ST networks. After network construction, we perform module mapping, which maps all modules across and between levels 1, 2, and 3 using module member overlap as a measure of correspondence (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, there are cross-design comparisons (gray) and between-design comparisons (white). Unlike between-design module pairs, cross-design pairs are confounded by shared biological samples and therefore their gene overlap cannot be used to assess biological relationships. However, these comparisons are useful in mapping modules so that a specific network can be traced at each design level. Lastly, we perform level-specific analyses, including module-trait association, module preservation, and analysis of module dynamics (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c).<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the multiWGCNA workflow. (<bold>a</bold>) multiWGCNA requires a dataset with two sample traits, such as disease versus a secondary trait like time or space. From this data, co-expression networks are constructed using WGCNA. (<bold>b</bold>) Three levels of networks are constructed from this design: (1) the combined network, (2) the disease and wildtype (WT) networks, and (3) the secondary trait (ST) networks. From these networks, modules can be mapped both across levels (gray arrows) and within levels (white arrows). (<bold>c</bold>) For each network level, appropriate analysis is performed, including differential module expression, module preservation, and module dynamics</p></caption><graphic xlink:href="12859_2023_5233_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par14">For convenience, module-trait association is performed in level 1 (the combined network), as it includes all samples and conditions. We summarize module expression using the first principal component (module eigengene) and apply the linear model, <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Module\,eigengene = disease\,status + secondary\,trait + disease\,status*secondary\,trait$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.166667em"/><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.166667em"/><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.166667em"/><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.166667em"/><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mrow/><mml:mo>∗</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.166667em"/><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5233_Article_IEq1.gif"/></alternatives></inline-formula>, and significance for each term is tested using factorial ANOVA as has been done previously [<xref ref-type="bibr" rid="CR6">6</xref>]. However, it is important to note that performing ANOVA using module eigengenes can potentially be misleading as eigengenes are a univariate projection of multivariate data [<xref ref-type="bibr" rid="CR9">9</xref>]. To address this, we provide users with the option of using PERMANOVA (Permutational Multivariate Analysis of Variance), which provides a non-parametric multivariate analysis of variance [<xref ref-type="bibr" rid="CR10">10</xref>], as a means for performing multivariate data comparisons in complex experimental designs. Additional multivariate analytic methods, such as the R package resampleWGCNA [<xref ref-type="bibr" rid="CR9">9</xref>], could also be employed at the user’s discretion.</p>
      <p id="Par15">In level 2 and 3 networks, we study module preservation and module dynamics. Preservation analysis is performed within each level—for example, using the disease networks as reference and the wildtype data as test or vice versa. Based on the previous implementation [<xref ref-type="bibr" rid="CR5">5</xref>], we define a differentially preserved module as any module with low or no preservation (Z<sub>summary</sub> &lt; 10) in the test dataset. To test if preservation scores are lower than expected by chance, we implemented a permutation test (see Methods) that can be used to test the probability of observing the biological preservation score when phenotype labels are randomly assigned. Module dynamics is a more subtle analysis that consists of analyzing the flow of module genes across conditions to identify interesting module-membership patterns.</p>
    </sec>
    <sec id="Sec4">
      <title>multiWGCNA identifies an EAE-induced network in astrocytes</title>
      <p id="Par16">To test whether multiWGCNA can reveal biologically meaningful relationships from expression profiling experiments, we performed multiWGCNA on an astrocyte-specific Ribotag dataset that compared mice with EAE (n = 20) to wildtype controls (n = 16) across the cerebral cortex, cerebellum, hippocampus, and spinal cord [<xref ref-type="bibr" rid="CR8">8</xref>]. After filtering modules driven by a single sample (see Methods), multiWGCNA identified a single module from the disease network (dM15, d = disease network) that exhibited weak preservation (Z<sub>summary</sub> = 9.16) in wildtype astrocytes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). Permutation testing with random phenotype assignment revealed that the preservation score of dM15 is significantly lower than that expected by chance (<italic>p</italic> = 0.0195 by 2000 permutations, Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Using a subsampling procedure, we independently validated that the sample size of the wildtype dataset (n = 16) was large enough to obtain accurate preservation scores (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1, see Methods).<fig id="Fig2"><label>Fig. 2</label><caption><p>multiWGCNA reveals an EAE-specific network in astrocytes. (<bold>a</bold>) Preservation scores of modules from EAE network in wildtype network, using astrocyte Ribotag data. (<bold>b</bold>) Distribution of expected preservation scores for modules of similar size to dM15 when phenotype labels are randomly assigned (2000 permutations). (<bold>c</bold>) Network view of the correspondence (based on hypergeometric overlap <italic>p</italic> value) between dM15 and the other modules constructed by multiWGCNA. (<bold>d</bold>) Expression patterns of the top 20 connected genes in dM15, showing highly unsynchronized expression in the wildtype samples</p></caption><graphic xlink:href="12859_2023_5233_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par17">In addition, dM15 could only be detected in the combined network (M13, FDR = 3.8 × 10<sup>–306</sup>, 249/303 genes), but not the wildtype network, or any region-specific network (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c), and thus appears to require many EAE astrocyte samples for detection. Importantly, genes in dM15 show tightly coordinated expression in EAE astrocytes, but largely unsynchronized expression in wildtype astrocytes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). In agreement with these results, we performed differential co-expression analysis [<xref ref-type="bibr" rid="CR11">11</xref>] and found that 99.86% (5894/5902) differentially co-expressed pairs (FDR &lt; 0.05) of module genes had higher co-expression in EAE astrocytes than wildtype astrocytes (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2A). In contrast, no differentially co-expressed genes between disease and wildtype conditions were observed for a similarly sized module, dM14 (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2B). Therefore, multiWGCNA identified a co-expression network that is induced in astrocytes by EAE.</p>
    </sec>
    <sec id="Sec5">
      <title>multiWGCNA improves prioritization of key biological networks</title>
      <p id="Par18">Selection and prioritization of co-expression networks remains a laborious step of the standard workflow. If one were to use only the combined network as in standard WGCNA, there are two modules (M13 and M16) that have a significant association to EAE or the interaction between EAE and region at an FDR &lt; 0.05, and six modules (M13, M16, M22, M33, M32, M20) that have a significant association to EAE at an FDR &lt; 0.1 by factorial ANOVA (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). However, multiWGCNA clearly indicates that M13 in the combined network (dM15 in the disease network) is the module most relevant to EAE, as it is the only module with a disease-specific co-expression pattern (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). Since modules are thought to represent shared biological processes, we used gene ontology (GO) [<xref ref-type="bibr" rid="CR12">12</xref>] to validate that the module identified using multiWGCNA is indeed the most relevant EAE-associated network. Indeed, M13 dominated the top of the enrichment results and was enriched for GO terms like immune system process and defense response, which are highly relevant to EAE pathology (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). We also cross-referenced our modules with the original published lists of differentially expressed genes (DEGs) [<xref ref-type="bibr" rid="CR8">8</xref>]. Strikingly, M13 was the co-expression network that best defined the EAE-induced transcriptional response of astrocytes across all four regions profiled, suggesting that the transcriptional responses of astrocytes to EAE across the CNS are actually part of a convergent molecular pathway that can be delineated by a single co-expression network (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Ultimately, these findings indicate that multiWGCNA can indeed facilitate the module selection step of the network analysis workflow, rapidly identifying biologically-relevant disease-associated networks across anatomical regions.<fig id="Fig3"><label>Fig. 3</label><caption><p>The module identified by multiWGCNA is the most biologically relevant to EAE. (<bold>a</bold>) Top GO terms for all modules of the combined EAE network. A maximum of 6 terms were allowed per module. M13/dM15 dominates the top of the list and has terms most relevant to EAE. (<bold>b</bold>) Overlap analysis between combined EAE network modules and DEGs from Itoh et al. [<xref ref-type="bibr" rid="CR8">8</xref>]. Only M13 is enriched for genes upregulated in EAE across all CNS regions profiled</p></caption><graphic xlink:href="12859_2023_5233_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>The module identified by multiWGCNA corresponds to the A1 neurotoxic phenotype</title>
      <p id="Par19">Since multiple sclerotic lesions are specifically associated with astrocytes that have undergone reactive astrocytosis [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR13">13</xref>], we hypothesized that M13/dM15 might correspond to the reactive astrocytic cell state. We used the reactive astrocyte transcriptional markers from Liddelow et al. [<xref ref-type="bibr" rid="CR13">13</xref>], which included transcripts specific to neurotoxic A1 and neuroprotective A2 astrocytes as well as pan-reactive transcripts. We confirmed these reactive astrocyte transcripts exhibited higher expression in EAE astrocytes, suggesting that gliosis can be detected in the Ribotag dataset (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). Next, we tested whether our EAE modules were enriched for reactive astrocyte markers (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). dM15 was highly enriched for all 36 reactive astrocyte markers (FDR = 1.0 × 10<sup>–13</sup>, 13/36 genes), and was also enriched for the neurotoxic A1-specific transcripts (FDR = 2.3 × 10<sup>–7</sup>, 6/11 genes) as well as pan-reactive transcripts (FDR = 3.2 × 10<sup>–5</sup>, 5/13 genes). Importantly, no other modules in the EAE network were enriched for any of these gene sets at an FDR of 1%, indicating that dM15 is the network most representative of the reactive astrocyte cell state in the EAE Ribotag data (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Likewise, no modules from the wildtype network were enriched for reactive astrocyte transcripts, indicating that the reactive astrocyte co-expression signature can only be detected in astrocytes from mice with EAE (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a).<fig id="Fig4"><label>Fig. 4</label><caption><p>The immune astrocyte module corresponds to the A1 neurotoxic phenotype. (<bold>a</bold>) Overlap analysis between modules from EAE/wildtype networks and the reactive astrocyte transcripts used in Liddelow et al. [<xref ref-type="bibr" rid="CR13">13</xref>]. The only network enriched for reactive astrocyte transcripts across all disease and wildtype modules is dM15. (<bold>b</bold>) Left heatmap shows the Pearson correlation between reactive astrocyte transcripts in the EAE astrocyte samples from Itoh et al. [<xref ref-type="bibr" rid="CR8">8</xref>]. Middle heatmap shows the Pearson correlation between reactive astrocyte transcripts in the wildtype astrocyte samples from Itoh et al. [<xref ref-type="bibr" rid="CR8">8</xref>]. Right heatmap shows the differential co-expression of reactive astrocyte transcripts between EAE and wildtype conditions, where high z-scores represent higher co-expression in EAE. Boxes around heatmap cells signify significantly different correlations (FDR &lt; 0.05). Right boxplots show the quantification of the Pearson correlations from the first two heatmaps</p></caption><graphic xlink:href="12859_2023_5233_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par20">Since dM15 was lowly preserved in wildtype astrocytes, we reasoned that the reactive astrocyte-specific transcripts themselves may be differentially co-expressed between wildtype and EAE astrocytes. We performed differential co-expression analysis [<xref ref-type="bibr" rid="CR11">11</xref>], which found that 53 out of 53 differentially co-expressed pairs of these 36 reactive astrocyte transcripts have higher co-expression (FDR &lt; 0.05) in EAE than in wildtype astrocytes (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). This is especially true of pan- and A1-reactive transcripts, which exhibited a very strong differential co-expression signature, and less so for A2 markers (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). This is in line with the finding that dM15 is enriched for A1- and pan-reactive transcripts but not A2 reactive transcripts (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). In sum, by splitting samples by disease status and performing differential network analysis, multiWGCNA was able to resolve an EAE-induced transcriptional program that corresponds to the neurotoxic A1 phenotype.</p>
    </sec>
    <sec id="Sec7">
      <title>Module dynamics reveals evolution of pathological modules over disease course</title>
      <p id="Par21">Next, we applied multiWGCNA to an RNA-seq dataset from the entorhinal cortex of the rTg4510 mouse model of the tau pathology in Alzheimer’s Disease, with ages ranging from 2 to 8 months, covering the onset of tau accumulation in the cortex [<xref ref-type="bibr" rid="CR6">6</xref>]. In the original study, a WGCNA module turquoise was identified as being positively correlated to tau accumulation in both the entorhinal cortex and the hippocampus as measured by immunohistochemistry [<xref ref-type="bibr" rid="CR6">6</xref>]. Since we used the same parameters as the original paper (see Methods), the modules from our combined network (n = 58) were identical to theirs (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>). To resolve temporal network changes related to tau pathology, we focused on the level three networks, in which each timepoint (2, 4, 6, and 8 month) is subjected to an individual network analysis (n = 15, 15, 13, and 15, respectively). Overlap analysis revealed that the turquoise module (M1 in the combined network) is the equivalent of module 4m-4 in the 4 month network (FDR = 3.4 × 10<sup>–306</sup>, 1110/3091 genes), 6m-2 in the 6 month network (FDR = 6.1 × 10<sup>–306</sup>, 1680/3091 genes), and 8m-1 (FDR = 4.5 × 10<sup>–306</sup>, 1825/3091 genes) in the 8 month network, but has no clear corresponding module in the 2 month network. Comparative analysis of these level three networks (Fig. <xref rid="Fig5" ref-type="fig">5</xref>) revealed that 4m-4, 6m-2, and 8m-1 correlate with disease. Interestingly, these late timepoint modules have no clear origin in the 2 month network.<fig id="Fig5"><label>Fig. 5</label><caption><p>Module dynamics of the timepoint-specific networks from rTg4510 + mice exhibiting tau pathology. Sankey flow diagram showing the transfer of genes from one timepoint to the next timepoint across the 2–8 month timecourse. The y-axis represents genes while the x-axis represents the different timepoint networks in order of time. The color of the edges represents module correspondence (based on hypergeometric overlap <italic>p</italic> value)</p></caption><graphic xlink:href="12859_2023_5233_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par22">To get gene-level resolution, we plotted the topological overlap clustering trees for the four networks constructed with wildtype and rTg4510 mice at 2, 4, 6, and 8 months (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Figure <xref rid="Fig6" ref-type="fig">6</xref> shows where the genes of the 8 month version of the turquoise module (8m-1) are located in the gene clustering of earlier timepoints. This revealed a stepwise recruitment of genes to this pathological cluster over the course of tau pathology, such that peripheral genes from other modules are recruited to become part of the turquoise network (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). The hubs are well-preserved from 4 to 8 months (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4-6, also see Additional file <xref rid="MOESM3" ref-type="media">3</xref>). At 2 months of age, turquoise genes are interspersed across the topological overlap clustering tree, but their position in the tree is greatly refined at 4 months of age, indicating that the formation of the turquoise module follows tau accumulation, which is also detected in the entorhinal cortex at 4 months of age [<xref ref-type="bibr" rid="CR6">6</xref>]. Another interesting feature revealed by the analysis in Fig. <xref rid="Fig6" ref-type="fig">6</xref> is that part of the 8m-1 module originates from a group of genes that is tightly connected throughout the time-course. These genes are enriched for GO terms blood vessel development (<italic>p</italic> = 1.28 × 10<sup>–13</sup>) and cell migration (<italic>p</italic> = 5.30 × 10<sup>–13</sup>), and only join this pathological module at month 8 (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Interestingly, the late timepoint modules are all well-preserved at 2 months (8m-1 Z<sub>summary</sub> = 26.5; 6m-2 Z<sub>summary</sub> = 28.3; 4m-4 Z<sub>summary</sub> = 25.5) suggesting that the turquoise module is a constitutive transcriptional network that may be rewired in disease rather than developing de novo like M13/dM15 in EAE. Ultimately, these are subtleties of module dynamics that would be entirely missed when performing a standard WGCNA.<fig id="Fig6"><label>Fig. 6</label><caption><p>Genesis of the module associated with tau pathology mimics tau burden in the entorhinal cortex. Gene-level sankey flow plot showing flow of genes originating from 8 month equivalent of the turquoise module (8m-1) from Castanho et al. [<xref ref-type="bibr" rid="CR6">6</xref>]. The topological clustering tree for each timepoint network is shown along with module colors. Most of the gene recruitment to the turquoise module occurs at 4 months of age, which is the onset of tau pathology in the entorhinal cortex</p></caption><graphic xlink:href="12859_2023_5233_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par23">In summary, our proposed software tool, multiWGCNA, performs all the network constructions possible in a multi-trait expression dataset to maximize the amount of data extracted from large-scale RNA-seq experiments and identify interesting co-expression relationships. This package provides several key features that build on the existing WGCNA R package [<xref ref-type="bibr" rid="CR1">1</xref>]. A notable advantage of multiWGCNA is that it uses a linear model and ANOVA to identify significant associations between module expression and disease status along with a secondary spatiotemporal trait, functions which are not directly available in the standard WGCNA package. The multiWGCNA tool also provides a comprehensive, automated workflow for resolving modules that have trait-specific expression, preservation, and gene recruitment (described in Fig. <xref rid="Fig1" ref-type="fig">1</xref>), and can be easily integrated into existing WGCNA pipelines without a need for detailed customization. Lastly, multiWGCNA provides additional useful functions for data visualization. These include module tracing diagrams (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c, available through the function drawMultiWGCNAnetwork), which constructs a graph of all modules clustered by design level where edges signify correspondence between a module of interest and modules from other designs. multiWGCNA also provides module dynamics plots (Fig. <xref rid="Fig5" ref-type="fig">5</xref>, available through the function moduleComparisonPlot), which draw a sankey diagram of the movement of genes across networks. Lastly, the TOM-flow plot (Fig. <xref rid="Fig6" ref-type="fig">6</xref>, available through the function TOMFlowPlot) allows users to track the movement of individual genes across the topological overlap clustering tree of different networks. Collectively, these functions complement the purpose of the WGCNA package by extending the analysis and visualization of co-expression networks across multiple dimensions in a comprehensive, accessible, and easily integrated format for both new and sophisticated WGCNA users.</p>
    <p id="Par24">When considering the methodology behind the development of the networks, given that we find WGCNA to be very sensitive to the state of the biological samples used for network construction, other network-based methods may also generate different results depending on the tissue, timepoint, and/or treatment groups included in the analysis. Therefore, the subset-and-integrate procedure we apply here might prove useful for such methods as well. Furthermore, such integration could prove to be complimentary to the analysis. For example, since WGCNA does not aim to identify causal regulatory relationships, the network construction procedure we describe could instead be applied using one of the various gene regulatory network inference algorithms currently available [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR17">17</xref>] for network construction instead of WGCNA, potentially revealing regulatory interactions that may be conditional on a specific sample trait. Although such integration is not presently incorporated in the multiWGCNA package, it could be added to future implementations.</p>
    <p id="Par25">We provide two examples of how multiWGCNA can be applied to real experimental data. Importantly, we show that multiWGCNA is able to resolve the induction of reactive astrocytes in EAE, a well-established feature of EAE pathology. We note that, while the network identified by multiWGCNA is highly similar to that identified by the standard workflow, there are two important differences. First of all, we show that selection of interesting modules is more rapidly achieved through multiWGCNA (Figs. <xref rid="Fig2" ref-type="fig">2</xref>, <xref rid="Fig3" ref-type="fig">3</xref>). Second and more importantly, the interpretation of the multiWGCNA results is quite different from the interpretation of the results from the combined network alone. In standard WGCNA, the module derived from the combined network (M13) is presumed to be preserved in the entire dataset as both wildtype and EAE samples were used for network construction. However, in multiWGCNA, we construct separate networks for EAE and wildtype samples, which reveals that M13 is recapitulated only in EAE astrocytes (dM15) and not in wildtype astrocytes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). Together with the finding that dM15 is differentially preserved, our results indicate that M13/dM15 is a de novo disease-associated network that is gained in EAE. multiWGCNA can therefore differentiate biological pathways as being over- or underexpressed versus being entirely inactive under different experimental conditions related to disease. It should be noted that in bulk RNA-sequencing from heterogenous tissue, modules are often interpreted as reflecting different cell types [<xref ref-type="bibr" rid="CR3">3</xref>]. Thus, it is rather appropriate that in an astrocyte-specific Ribotag dataset, the pathological module identified maps to a specific cell subtype—neurotoxic A1 astrocytes—rather than a cell type, as the expression data itself is already astrocyte-specific.</p>
    <p id="Par26">Interestingly, the authors of the original EAE Ribotag dataset identified cholesterol biosynthesis as a therapeutic target in EAE and were able to mitigate symptoms by increasing efflux of cholesterol to extracellular apolipoprotein (APOE) [<xref ref-type="bibr" rid="CR8">8</xref>]. It was recently discovered that neurotoxic reactive astrocytes secrete saturated lipids in APOE and APOJ lipoparticles that induce cell death in neurons and oligodendrocytes [<xref ref-type="bibr" rid="CR18">18</xref>]. Thus, it may be that the biosynthesis pathway in A1 neurotoxic astrocytes is redirected to produce these toxic lipids at the expense of normal cholesterol biosynthesis, explaining the downregulation of this pathway. This would suggest that A1 astrocyte reactivity has a two-pronged deleterious effect: (1) depletion of the cholesterol that neurons and oligodendrocytes rely on for building synapses and myelin respectively [<xref ref-type="bibr" rid="CR8">8</xref>], and (2) secretion of saturated lipids that directly kill neurons and oligodendrocytes [<xref ref-type="bibr" rid="CR18">18</xref>]. These observations may also explain why eliminating long-chain saturated lipids only partially reduces astrocyte-mediated cell death after axon crush, while preventing neurotoxic astrocyte induction by genomic deletion of <italic>Il1a</italic>, <italic>Tnf</italic> and <italic>C1qa</italic> completely reduced astrocyte-mediated cell death [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par27">Naturally, the question arises of which network constructed by multiWGCNA is the most accurate. In our opinion, it depends on the biological question at hand. In the case of M13/dM15, the level 2 EAE network (dM15) is more biologically interesting as its co-expression structure is not obfuscated by the wildtype samples. In cases where it is less obvious, we suggest use of the key module(s) derived from the combined network for a larger sample size and more robust correlations. Ultimately, this may be of less importance because the modules should be highly similar and downstream analyses will yield almost identical results. In general, we recommend large sample sizes to allow enough power (at least 12 samples per condition) for level 2 and level 3 analyses.</p>
    <p id="Par28">In this report, we also introduce the idea of module dynamics, and demonstrate its use on time-course data in a module correlated with tau accumulation in the rTg4510 mouse model of tau pathology (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The pathological transformation of this module, both in terms of disease correlation (Fig. <xref rid="Fig5" ref-type="fig">5</xref>) and gene recruitment (Fig. <xref rid="Fig6" ref-type="fig">6</xref>), is mirrored by tau accumulation in the entorhinal cortex and hippocampus, which also occurs at 4 months of age.</p>
    <p id="Par29">In summary, we have developed a WGCNA software tool, multiWGCNA, that is tailored to analyzing multi-trait expression data. Because this approach is especially powerful at analyzing biological networks with temporal or spatial variance, we recommend multiWGCNA for future studies that include these conditions in their experimental design.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusion</title>
    <p id="Par30">The multiWGCNA R package provides a comprehensive set of high-level software tools for analyzing co-expression networks in datasets where samples have two variable traits. We expect the multiWGCNA R package will reveal interesting and novel network characteristics associated with spatical or temporal aspects, such as anatomy, development, and/or pathology.</p>
  </sec>
  <sec id="Sec10">
    <title>Materials and methods</title>
    <sec id="Sec11">
      <title>Module nomenclature</title>
      <p id="Par31">For combined networks, we named each modules using a capital M followed by the numeric identifier from the combined network (i.e. M13). For disease networks, we added c- to signify control and a d- prefix to signify disease (i.e. dM15). Level three networks use a prefix (i.e. 8m-1) to signify the originating WGCNA dataset.</p>
    </sec>
    <sec id="Sec12">
      <title>Permutation testing to determine trait-specific preservation</title>
      <p id="Par32">The standard WGCNA framework [<xref ref-type="bibr" rid="CR5">5</xref>] determines the degree to which a module is preserved by computing a Z<sub>summary</sub> score that combines several measures of preservation. In the case of multiWGCNA, to confirm biological relevance, we want to determine if a module detected in a subset of the data has lower preservation than expected by chance in a different subset of the data. To this end, we developed a novel permutation test (available using the function diseasePreservationPtest) based on the previous implementation. First, phenotype labels (e.g., disease and wildtype) are randomly assigned to samples, then WGCNA is performed in the randomized reference set (e.g., disease), and preservation of the resulting modules is assessed in the randomized test set (e.g., wildtype) by performing module preservation analysis and retrieving Z<sub>summary</sub> values. Since Z<sub>summary</sub> preservation scores tend to be higher for larger modules [<xref ref-type="bibr" rid="CR5">5</xref>], the null distribution of preservation scores must be calculated using modules of comparable sizes. Therefore, in each permuted set, we first remove modules driven by single samples (see Materials and Methods) as these outlier modules reflect noise, and we then select the preservation score of the module whose size is closest to the module of interest. This allows us to compute an empirical distribution of preservation scores under the null hypothesis where phenotype has no effect on preservation. A <italic>p</italic> value is computed by taking the proportion of preservation scores that are lower than or equal to the observed score (e.g., one-tailed), as this reflects biological relevance under these conditions.</p>
      <p id="Par33">To illustrate, we applied this permutation procedure to the astrocyte Ribotag data, where we sought to determine if the dM15 module from the EAE network had lower preservation in the wildtype network than expected by chance (see Results). To answer this question, we performed 2000 permutations of the procedure described above. For each permutation, we constructed the reference network from twenty randomly selected samples, tested for network preservation in the remaining sixteen samples, filtered out modules driven by single samples, and extracted the preservation score of the module whose size was closest to dM15 (303 genes) in that network (the resulting modules ranged from 225 to 366 genes in size). This generated a null distribution of preservation scores assuming that EAE status has no effect on network preservation. Out of 2000 permutations, there were 39 scores lower than or equal to the observed score for dM15 (9.16), which corresponds to a <italic>p</italic> value of 0.0195 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) thus indicating biological significance.</p>
    </sec>
    <sec id="Sec13">
      <title>Analysis of reactive astrocyte markers</title>
      <p id="Par34">36 of the 37 reactive astrocyte markers from Liddelow et al. [<xref ref-type="bibr" rid="CR13">13</xref>] were used here because Ugt1a1 was not expressed in any sample from the astrocyte Ribotag dataset. Differential co-expression analysis was performed using dcanR [<xref ref-type="bibr" rid="CR11">11</xref>], which applies Fisher’s transformation to transform correlation coefficients to z-scores and tests for a significant difference in z-scores using the z-distribution. For consistency with the WGCNA networks, we used Pearson correlation as a measure of co-expression for this analysis as well.</p>
    </sec>
    <sec id="Sec14">
      <title>Estimating the minimum number of biological samples required for reliable module preservation analysis</title>
      <p id="Par35">We independently validated that the number of biological replicates used for module preservation analysis in this paper are sufficient to obtain reliable preservation scores of network preservation (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). Using a large dataset of 100 wildtype mouse hippocampus samples [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], we randomly selected 50 samples to build a reference network. We tested for network preservation in the other half of the dataset (n = 48, two sample outliers were removed). After excluding modules driven by single samples, all large modules (&gt; 150 genes) were strongly preserved (Z<sub>summary</sub> &gt; 10) and all small modules (&lt; 150 genes) were fairly preserved (Z<sub>summary</sub> &gt; 8). This is as expected as the test samples were selected from the sample phenotypic group used to build the reference network, so all modules should be preserved. We defined these preservation statistics as the ground truth and asked how small we could make the sample groups until the resulting conclusions deviated from these classifications. We developed a scoring scheme, where modules with Z<sub>summary</sub> &lt; 2 receive a 0, modules with Z<sub>summary</sub> &gt; 2 but Z<sub>summary</sub> &lt; 10 receive a 1, and modules with Z<sub>summary</sub> &gt; 10 receive a 2 and accuracy is measured by the percent difference between the module preservation score of the subsample relative to the ground truth. This scoring scheme takes into account the degree to which conclusions of preservation differ. We randomly sampled 100 combinations of 24 samples from the 48 test samples and repeated network preservation (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). We repeated this procedure with sample sizes of 15, 12, 10, 8, and 5 and found that 12 biological samples was the lowest number of samples that could be used while retaining a high classification accuracy (90%).</p>
    </sec>
    <sec id="Sec15">
      <title>multiWGCNA of astrocyte-specific Ribotag data from EAE mouse model</title>
      <p id="Par36">Astrocyte-specific RNA-seq from various regions of the mouse CNS was retrieved from GSE100329. Raw counts were converted to RPKM and log2 transformed. MultiWGCNA was performed using a soft threshold power of 12, a minimum module size of 100 genes, and merge cut height of 0 (no merging) for all seven networks (the combined network, the disease status networks, and the region-specific networks).</p>
    </sec>
    <sec id="Sec16">
      <title>multiWGCNA of entorhinal cortex timecourse data from rTg4510 mouse model</title>
      <p id="Par37">RNA-seq from entorhinal cortex of mice with tau pathology (rTg4510) at various ages was retrieved from GSE125957. The data was processed and WGCNA was performed using the same function and parameters as Castanho et al. [<xref ref-type="bibr" rid="CR6">6</xref>] described (<ext-link ext-link-type="uri" xlink:href="https://git.exeter.ac.uk/ic322/ad-mice-rna-seq-cell-reports">https://git.exeter.ac.uk/ic322/ad-mice-rna-seq-cell-reports</ext-link>). Briefly, genes with a count sum of less than 7 were removed and the sample outlier, S19, was dropped. For network construction, the blockwiseModules function was run with a soft threshold power of 10, a minimum module size of 30 genes, a max block size of 25,000, and a merge cut height of 0.25. The resulting combined network yielded modules identical to those reported by Castanho et al. [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    </sec>
    <sec id="Sec17">
      <title>Filtering modules in multiWGCNA</title>
      <p id="Par38">Modules that are driven by a single sample were filtered out as outlier modules in the multiWGCNA workflow. We define an outlier module as any module where the variance of module eigengenes is less than 0.02 upon removing the sample with the largest absolute module eigengene. We find that this method performs better than interquartile range or z-score based methods for identifying outlier modules.</p>
    </sec>
    <sec id="Sec18">
      <title>Availability and requirements</title>
      <p id="Par39">
        <list list-type="bullet">
          <list-item>
            <p id="Par40">Project name: multiWGCNA</p>
          </list-item>
          <list-item>
            <p id="Par41">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/fogellab/multiWGCNA">https://github.com/fogellab/multiWGCNA</ext-link></p>
          </list-item>
          <list-item>
            <p id="Par42">Operating system(s): Platform independent</p>
          </list-item>
          <list-item>
            <p id="Par43">Programming language: R</p>
          </list-item>
          <list-item>
            <p id="Par44">Other requirements: none</p>
          </list-item>
          <list-item>
            <p id="Par45">License: GNU GPL 3</p>
          </list-item>
          <list-item>
            <p id="Par46">Any restrictions to use by non-academics: none</p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec19">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5233_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1. </bold>Supplemental Data. Figures S1–S6, Table S1.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5233_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2. </bold>Network Comparison. Comparison of multiWGCNA combined network modules to Castanho et al. 2020 standard WGCNA modules.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2023_5233_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3. </bold>Module Dynamics. MultiWGCNA temporal gene rank comparisons related to Castanho et al. 2020 data.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>EAE</term>
        <def>
          <p id="Par4">Experimental autoimmune encephalitis</p>
        </def>
      </def-item>
      <def-item>
        <term>GO</term>
        <def>
          <p id="Par5">Gene ontology</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA-seq</term>
        <def>
          <p id="Par6">RNA-sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>ST</term>
        <def>
          <p id="Par7">Secondary trait</p>
        </def>
      </def-item>
      <def-item>
        <term>WGCNA</term>
        <def>
          <p id="Par8">Weighted gene co-expression network analysis</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank J. Mill and I. Castanho for providing tau and amyloid pathology data from Castanho et al. [<xref ref-type="bibr" rid="CR6">6</xref>]. We also thank K. Ngo for testing the multiWGCNA R package.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>DT developed the concept, wrote the relevant code, performed the analysis, and wrote the manuscript. BLF developed the concept, supervised the analysis, and wrote the manuscript. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>No specific sources of funding were utilized for this work.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets used and/or analyzed during the current study are available from the corresponding author on reasonable request.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par47">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par48">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par49">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langfelder</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>WGCNA: an R package for weighted correlation network analysis</article-title>
        <source>BMC Bioinform</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xue</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic programs in human and mouse early embryos revealed by single-cell RNA sequencing</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>500</volume>
        <fpage>593</fpage>
        <lpage>597</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12364</pub-id>
        <?supplied-pmid 23892778?>
        <pub-id pub-id-type="pmid">23892778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oldham</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Konopka</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Iwamoto</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Langfelder</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kato</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Functional organization of the transcriptome in human brain</article-title>
        <source>Nat Neurosci</source>
        <year>2008</year>
        <volume>11</volume>
        <fpage>1271</fpage>
        <lpage>1282</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.2207</pub-id>
        <?supplied-pmid 18849986?>
        <pub-id pub-id-type="pmid">18849986</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Voineagu</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Johnston</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptomic analysis of autistic brain reveals convergent molecular pathology</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>474</volume>
        <fpage>380</fpage>
        <lpage>384</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10110</pub-id>
        <?supplied-pmid 21614001?>
        <pub-id pub-id-type="pmid">21614001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langfelder</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Oldham</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Is my network module preserved and reproducible?</article-title>
        <source>PLoS Comput Biol</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1001057</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1001057</pub-id>
        <?supplied-pmid 21283776?>
        <pub-id pub-id-type="pmid">21283776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castanho</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Hannon</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Jeffries</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Laing</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional signatures of tau and amyloid neuropathology</article-title>
        <source>Cell Rep</source>
        <year>2020</year>
        <volume>30</volume>
        <fpage>2040</fpage>
        <lpage>2054.e5</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2020.01.063</pub-id>
        <?supplied-pmid 32049030?>
        <pub-id pub-id-type="pmid">32049030</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yip</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Gene network interconnectedness and the generalized topological overlap measure</article-title>
        <source>BMC Bioinform</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>22</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-22</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Itoh</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Itoh</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tassoni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kaito</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ohno</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell-specific and region-specific transcriptomics in the multiple sclerosis model: focus on astrocytes</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2018</year>
        <volume>115</volume>
        <fpage>E302</fpage>
        <lpage>E309</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1716032115</pub-id>
        <?supplied-pmid 29279367?>
        <pub-id pub-id-type="pmid">29279367</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fruciano</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Franchini</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Divergent allometric trajectories in gene expression and coexpression produce species differences in sympatrically speciating midas cichlid fish</article-title>
        <source>Genome Biol Evol</source>
        <year>2019</year>
        <volume>11</volume>
        <fpage>1644</fpage>
        <lpage>1657</lpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evz108</pub-id>
        <?supplied-pmid 31124568?>
        <pub-id pub-id-type="pmid">31124568</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>A new method for non-parametric multivariate analysis of variance</article-title>
        <source>Austral Ecol</source>
        <year>2001</year>
        <volume>26</volume>
        <fpage>32</fpage>
        <lpage>46</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bhuva</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Cursons</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Differential co-expression-based detection of conditional relationships in transcriptional data: comparative analysis and application to breast cancer</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>236</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1851-8</pub-id>
        <?supplied-pmid 31727119?>
        <pub-id pub-id-type="pmid">31727119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Young</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Wakefield</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Gene ontology analysis for RNA-seq: accounting for selection bias</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R14</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-2-r14</pub-id>
        <?supplied-pmid 20132535?>
        <pub-id pub-id-type="pmid">20132535</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liddelow</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Guttenplan</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>FC</given-names>
          </name>
          <name>
            <surname>Bohlen</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Schirmer</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Neurotoxic reactive astrocytes are induced by activated microglia</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>541</volume>
        <fpage>481</fpage>
        <lpage>487</lpage>
        <pub-id pub-id-type="doi">10.1038/nature21029</pub-id>
        <?supplied-pmid 28099414?>
        <pub-id pub-id-type="pmid">28099414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paull</surname>
            <given-names>EO</given-names>
          </name>
          <name>
            <surname>Carlin</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Niepel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sorger</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stuart</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Discovering causal pathways linking genomic events to transcriptional states using Tied Diffusion Through Interacting Events (TieDIE)</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2757</fpage>
        <lpage>2764</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt471</pub-id>
        <?supplied-pmid 23986566?>
        <pub-id pub-id-type="pmid">23986566</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Margolin</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Nemenman</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Basso</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wiggins</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stolovitzky</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Favera</surname>
            <given-names>RD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ARACNE: an algorithm for the reconstruction of gene regulatory networks in a mammalian cellular context</article-title>
        <source>BMC Bioinform</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>S7</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-S1-S7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Deep learning for inferring gene relationships from single-cell expression data</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>27151</fpage>
        <lpage>27158</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1911536116</pub-id>
        <?supplied-pmid 31822622?>
        <pub-id pub-id-type="pmid">31822622</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Küffner</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Petri</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tavakkolkhah</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Windhager</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Inferring gene regulatory networks by ANOVA</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1376</fpage>
        <lpage>1382</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts143</pub-id>
        <?supplied-pmid 22467911?>
        <pub-id pub-id-type="pmid">22467911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guttenplan</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Weigel</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Prakash</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wijewardhane</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Hasel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rufen-Blanchette</surname>
            <given-names>U</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Neurotoxic reactive astrocytes induce cell death via saturated lipids</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>599</volume>
        <fpage>102</fpage>
        <lpage>107</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03960-y</pub-id>
        <?supplied-pmid 34616039?>
        <pub-id pub-id-type="pmid">34616039</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Srivastava</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Bagnati</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Delahaye-Duriez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ko</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Rotival</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Langley</surname>
            <given-names>SR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide analysis of differential RNA editing in epilepsy</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>440</fpage>
        <lpage>450</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.210740.116</pub-id>
        <?supplied-pmid 28250018?>
        <pub-id pub-id-type="pmid">28250018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Behmoaras</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bottolo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Krishnan</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Pernhorst</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Santoscoy</surname>
            <given-names>PLM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systems genetics identifies Sestrin 3 as a regulator of a proconvulsant gene network in human epileptic hippocampus</article-title>
        <source>Nat Commun</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>6031</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms7031</pub-id>
        <?supplied-pmid 25615886?>
        <pub-id pub-id-type="pmid">25615886</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
