<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4491876</article-id>
    <article-id pub-id-type="pmid">25990960</article-id>
    <article-id pub-id-type="publisher-id">590</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-015-0590-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Software for the analysis and visualization of deep mutational scanning data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Bloom</surname>
          <given-names>Jesse D</given-names>
        </name>
        <address>
          <email>jbloom@fredhutch.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2180 1622</institution-id><institution-id institution-id-type="GRID">grid.270240.3</institution-id><institution>Division of Basic Sciences and Computational Biology Program, </institution><institution>Fred Hutchinson Cancer Research Center, </institution></institution-wrap>1100 Fairview Ave N, Seattle, 98109 WA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>5</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>168</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>1</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>4</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Bloom; licensee BioMed Central. 2015</copyright-statement>
      <license license-type="open-access">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Deep mutational scanning is a technique to estimate the impacts of mutations on a gene by using deep sequencing to count mutations in a library of variants before and after imposing a functional selection. The impacts of mutations must be inferred from changes in their counts after selection.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>I describe a software package, dms_tools, to infer the impacts of mutations from deep mutational scanning data using a likelihood-based treatment of the mutation counts. I show that dms_tools yields more accurate inferences on simulated data than simply calculating ratios of counts pre- and post-selection. Using dms_tools, one can infer the preference of each site for each amino acid given a single selection pressure, or assess the extent to which these preferences change under different selection pressures. The preferences and their changes can be intuitively visualized with sequence-logo-style plots created using an extension to weblogo.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>
dms_tools implements a statistically principled approach for the analysis and subsequent visualization of deep mutational scanning data.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Deep mutational scanning</kwd>
      <kwd>Sequence logo</kwd>
      <kwd>Amino-acid preferences</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Deep mutational scanning is a high-throughput experimental technique to assess the impacts of mutations on a protein-coding gene [<xref ref-type="bibr" rid="CR1">1</xref>]. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows a schematic of deep mutational scanning. A gene is mutagenized, and the library of resulting variants is introduced into cells or viruses, which are then subjected to an experimental selection that enriches for functional variants and depletes non-functional ones. Deep sequencing of the variants pre- and post-selection provides information about the functional impacts of mutations. Since the original description of deep mutational scanning by Fowler <italic>et al.</italic> [<xref ref-type="bibr" rid="CR2">2</xref>], the technique has been applied to a wide range of genes [<xref ref-type="bibr" rid="CR3">3</xref>-<xref ref-type="bibr" rid="CR15">15</xref>], both to measure mutational tolerance given a single selection pressure as in Figure <xref rid="Fig1" ref-type="fig">1</xref>A, or to identify mutations that have different effects under alternative selections as in Figure <xref rid="Fig1" ref-type="fig">1</xref>B. New techniques to create comprehensive codon-mutant libraries of genes make it possible to profile all amino-acid mutations [<xref ref-type="bibr" rid="CR8">8</xref>-<xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR15">15</xref>-<xref ref-type="bibr" rid="CR17">17</xref>], while new techniques for targeted mutagenesis of mammalian genomes enable deep mutational scanning to be applied across the biological spectrum from viruses and bacteria to human cells [<xref ref-type="bibr" rid="CR18">18</xref>].
<fig id="Fig1"><label>Figure 1</label><caption><p>A deep mutational scanning experiment.<bold>(A)</bold> A gene is mutagenized to create a library that contains all single codon mutations. The mutant library is introduced into cells or viruses and subjected to a functional selection that enriches beneficial mutations and depletes deleterious ones. Deep sequencing is used to count mutations in a sample of the variants present pre- and post-selection. Using dms_tools, the data can be analyzed to infer the “preference” of each site for each amino acid; in the visualization, letter heights are proportional to the preference for that amino acid. <bold>(B)</bold> The experiment can be extended by subjecting the library of functional variants to two different selection pressures, and using deep sequencing to assess which variants are favored in one condition versus the other. Using dms_tools, the data can be analyzed to infer the “differential preference” of each site for each amino acid in the alternative selection <italic>s</italic>2 versus the control selection <italic>s</italic>1; in the visualization, letter heights above or below the line are proportional to the differential preference for or against that amino acid.</p></caption><graphic xlink:href="12859_2015_590_Fig1_HTML" id="MO1"/></fig>
</p>
    <p>A key component of deep mutational scanning is analysis of the data: First, raw reads from the deep sequencing must be processed to count mutations pre- and post-selection. Next, the biological effects of mutations must be inferred from these counts. The first task of processing the reads is idiosyncratic to the specific sequencing strategy used. But the second task of inferring mutational effects from sequencing counts is amenable to more general algorithms. However, only a few such algorithms have been described [<xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref>]. Here I present user-friendly software, dms_tools, that infers mutational effects from sequencing counts. Before describing the algorithms implemented in dms_tools and illustrating its use on existing and simulated data, I first discuss issues associated with inferring mutational effects from sequencing counts.</p>
    <sec id="Sec2">
      <title>The nature of deep mutational scanning data.</title>
      <p>The data consist of counts of variants pre- and post-selection. The approach presented here treats each site in the gene separately, ignoring epistatic coupling among mutations. This aspect of the approach should not be construed as a suggestion that interactions among mutations are unimportant; indeed, several studies have used deep mutational scanning to examine pairwise epistasis [<xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref>], and techniques have been described to obtain linkage between distant sites [<xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR24">24</xref>]. However, the exploding combinatorics of multiple mutations (a 500-residue protein has only 19×500≈10<sup>4</sup> single mutants, but <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$19^{2} \times \frac {500 \times 499}{2} \approx 4 \times 10^{7}$
\end{document}</tex-math><mml:math id="M2"><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mn>500</mml:mn><mml:mo>×</mml:mo><mml:mn>499</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq1.gif"/></alternatives></inline-formula> double mutants and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$19^{3} \times \frac {500!}{497! \times 3!} \approx 10^{11}$
\end{document}</tex-math><mml:math id="M4"><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mn>500</mml:mn><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mn>497</mml:mn><mml:mo>!</mml:mo><mml:mo>×</mml:mo><mml:mn>3</mml:mn><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq2.gif"/></alternatives></inline-formula> triple mutants) make it currently plausible to comprehensively characterize only single mutations to all but the shortest genes. Treating sites independently is therefore not a major limitation for most current datasets. Eventually the approach here might be extended to include coupling among mutations.</p>
      <p>The data for each site <italic>r</italic> is characterized by the sequencing <italic>depth</italic> (total number of counts); let <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$N_{r}^{\text {pre}}$
\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>pre</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq3.gif"/></alternatives></inline-formula>, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$N_{r}^{\text {post}}$
\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>post</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq4.gif"/></alternatives></inline-formula>, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$N_{r}^{s1}$
\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq5.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$N_{r}^{s2}$
\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq6.gif"/></alternatives></inline-formula> denote the depth at <italic>r</italic> for each of the four libraries in Figure <xref rid="Fig1" ref-type="fig">1</xref> (pre-selection, post-selection, selection <italic>s</italic>1, and selection <italic>s</italic>2). Typical depths for current experiments are <italic>N</italic>∼10<sup>6</sup>. Denote the counts of character <italic>x</italic> (characters might be nucleotides, amino acids, or codons) at <italic>r</italic> as <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$n_{r,x}^{\text {pre}}$
\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>pre</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq7.gif"/></alternatives></inline-formula>, <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$n_{r,x}^{\text {post}}$
\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>post</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq8.gif"/></alternatives></inline-formula>, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$n_{r,x}^{s1}$
\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq9.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$n_{r,x}^{s2}$
\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq10.gif"/></alternatives></inline-formula>. The values of <italic>n</italic>
<sub><italic>r</italic>,<italic>x</italic></sub> for characters <italic>x</italic> that differ from the wildtype identity wt(<italic>r</italic>) depend on both the depth <italic>N</italic> and the average per-site mutation rate <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\overline {\mu }$
\end{document}</tex-math><mml:math id="M22"><mml:mover accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_590_IEq11.gif"/></alternatives></inline-formula>. Since the mutations are intentionally introduced into the mutant library by the experimentalist, in principle <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\overline {\mu }$
\end{document}</tex-math><mml:math id="M24"><mml:mover accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_590_IEq12.gif"/></alternatives></inline-formula> could have any value. But typically, deep mutational scanning experiments aim to introduce about one mutation per gene to avoid filling the mutant library with highly mutated genes – so the average mutation rate is usually <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\overline {\mu } \sim 1/L$
\end{document}</tex-math><mml:math id="M26"><mml:mover accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="12859_2015_590_IEq13.gif"/></alternatives></inline-formula> where <italic>L</italic> is the length of the gene. Therefore, if a 500-codon gene is sequenced at depth <italic>N</italic>∼10<sup>6</sup>, we expect <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$N \overline {\mu } \sim 2000$
\end{document}</tex-math><mml:math id="M28"><mml:mi>N</mml:mi><mml:mover accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mn>2000</mml:mn></mml:math><inline-graphic xlink:href="12859_2015_590_IEq14.gif"/></alternatives></inline-formula> counts of non-wildtype codons at each site. Since there are 63 mutant codons, the average pre-selection counts for a mutation to a specific <italic>x</italic>≠ wt(<italic>r</italic>) will be <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$n_{r,x}^{\text {pre}} \sim 30$
\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>pre</mml:mtext></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mn>30</mml:mn></mml:math><inline-graphic xlink:href="12859_2015_590_IEq15.gif"/></alternatives></inline-formula>, with counts for most mutations deviating from this average due to biases in creation of the mutant library and randomness in which molecules are sequenced. Counts in the post-selection libraries will further deviate from this average due to selection. Therefore, even at depths <italic>N</italic>∼10<sup>6</sup>, the actual counts of most mutations will be quite modest.</p>
      <p>The rest of this paper assumes that the sequencing depth is less than the number of unique molecules in the mutant library, such that the deep sequencing randomly subsamples the set of molecules. If this assumption is false (i.e. if the number of unique molecules is substantially less than the sequencing depth), then the accuracy of inferences about mutational effects will be fundamentally limited by this aspect of the experimental design. Properly done experiments should quantify the number of unique molecules in the library so that it is obvious whether this assumption holds. In the absence of such information, the analysis can be repeated using only a random fraction of the deep sequencing data to assess whether inferences are limited by sequencing depth or the underlying molecular diversity in the mutant library.</p>
    </sec>
    <sec id="Sec3">
      <title>The goal: inferring site-specific amino-acid preferences</title>
      <p>The goal is to estimate the effects of mutations from changes in their counts after selection. Let <italic>μ</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>, <italic>f</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>, <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$f_{r,x}^{s1}$
\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq16.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$f_{r,x}^{s2}$
\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq17.gif"/></alternatives></inline-formula> denote the <italic>true</italic> frequencies at site <italic>r</italic> of all mutant characters <italic>x</italic>≠ wt(<italic>r</italic>) that would be observed for the four libraries in Figure <xref rid="Fig1" ref-type="fig">1</xref> if we sampled at infinite depth in both the actual experiment and the sequencing. The definition of these frequencies for the wildtype character wt(<italic>r</italic>) depends on how the mutant library is constructed. If the mutant library is constructed so that there is a Poisson distribution of the number of mutations per gene (as is the case for error-prone PCR or the codon-mutagenesis in [<xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR11">11</xref>]), then <italic>μ</italic>
<sub><italic>r</italic>,wt(<italic>r</italic>)</sub>, <italic>f</italic>
<sub><italic>r</italic>,wt(<italic>r</italic>)</sub>, <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$f_{r,\operatorname {wt}\left (r\right)}^{s1}$
\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq18.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$f_{r,\operatorname {wt}\left (r\right)}^{s2}$
\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq19.gif"/></alternatives></inline-formula> are defined as for all other characters <italic>x</italic>, and denote the frequencies of wt(<italic>r</italic>) at site <italic>r</italic> that would be observed if sampling at infinite depth. The reason we can make this definition for libraries containing genes with Poisson-distributed numbers of mutations is that for any reasonable-length gene (<italic>L</italic>≫1), the marginal distribution of the number of mutations in a gene is virtually unchanged by the knowledge that there is a mutation at site <italic>r</italic>. On the other hand, if the mutant library is constructed so that there is exactly zero or one mutation per gene (as in [<xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR15">15</xref>]), then the marginal distribution of the total number of mutations in a gene is changed by the knowledge that there is a mutation at <italic>r</italic>. In this case, the wildtype-character frequencies <italic>μ</italic>
<sub><italic>r</italic>,wt(<italic>r</italic>)</sub>, <italic>f</italic>
<sub><italic>r</italic>,wt(<italic>r</italic>)</sub>, <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$f_{r,\operatorname {wt}\left (r\right)}^{s1}$
\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq20.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$f_{r,\operatorname {wt}\left (r\right)}^{s2}$
\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq21.gif"/></alternatives></inline-formula> are correctly defined as the frequency of unmutated genes in the library, and the counts <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$n_{r,\operatorname {wt}\left (r\right)}^{\text {pre}}$
\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>pre</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq22.gif"/></alternatives></inline-formula>, etc. are defined as the number of reads at <italic>r</italic> attributable to unmutated genes. In this case, measurement of these counts requires sequencing with linkage as in [<xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR24">24</xref>]. The proper analysis of libraries containing only unmutated and singly mutated clones sequenced without linkage is beyond the scope of this paper.</p>
      <p>If we knew the frequencies <italic>μ</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>, <italic>f</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>, <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$f_{r,x}^{s1}$
\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq23.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$f_{r,x}^{s2}$
\end{document}</tex-math><mml:math id="M48"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq24.gif"/></alternatives></inline-formula>, we could calculate parameters that reflect the effects of mutations. One parameter that characterizes the effect of mutating <italic>r</italic> from wt(<italic>r</italic>) to <italic>x</italic> for the experiment in Figure <xref rid="Fig1" ref-type="fig">1</xref>A is the <italic>enrichment ratio</italic>, which is the relative frequency of mutations to <italic>x</italic> after selection versus before selection:
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$  \phi_{r,x} = \frac{f_{r,x} / f_{r,\operatorname{wt}\left(r\right)}}{\mu_{r,x} / \mu_{r,\operatorname{wt}\left(r\right)}}.  $$
\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2015_590_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>Beneficial mutations have <italic>ϕ</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>&gt;1, while deleterious ones have <italic>ϕ</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>&lt;1. A related parameter is the <italic>preference</italic>
<italic>π</italic>
<sub><italic>r</italic>,<italic>x</italic></sub> of <italic>r</italic> for <italic>x</italic>. At each site, the preferences are simply the enrichment ratios rescaled to sum to one:
<disp-formula id="Equ2"><label>(2)</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$  \pi_{r,x} = \frac{\phi_{r,x}}{\sum_{y} \phi_{r,y}} = \frac{f_{r,x} / \mu_{r,x}}{\sum_{y} f_{r,y} / \mu_{r,y}},  $$
\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2015_590_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>or equivalently
<disp-formula id="Equ3"><label>(3)</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$  f_{r,x} = \frac{\pi_{r,x} \times \mu_{r,x}}{\sum_{y} \pi_{r,y} \times \mu_{r,y}},  $$
\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2015_590_Equ3.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>where <italic>y</italic> is summed over all character identities (all nucleotides, codons, or amino acids). The preferences can be intuitively visualized (Figure <xref rid="Fig1" ref-type="fig">1</xref>A) and interpreted as the equilibrium frequencies in substitution models for gene evolution [<xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR25">25</xref>] (after accounting for uneven mutational rates [<xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR27">27</xref>]).</p>
    </sec>
    <sec id="Sec4">
      <title>The challenge of statistical inference from finite counts</title>
      <p>Equations <xref rid="Equ1" ref-type="">1</xref> and <xref rid="Equ2" ref-type="">2</xref> are in terms of the true frequencies <italic>μ</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>, <italic>f</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>, etc. But in practice, we only observe the counts in the finite sample of sequenced molecules. The computational challenge is to estimate the preferences (or enrichment ratios) from these counts.</p>
      <p>The most naive approach is to simply substitute the counts for the frequencies, replacing Equation <xref rid="Equ1" ref-type="">1</xref> with
<disp-formula id="Equ4"><label>(4)</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$  \phi_{r,x} = \frac{\frac{n_{r,x}^{\text{post}} + \mathcal{P}}{n_{r,\operatorname{wt}\left(r\right)}^{\text{post}} + \mathcal{P}}}{\frac{n_{r,x}^{\text{pre}} + \mathcal{P}}{n_{r,\operatorname{wt}\left(r\right)}^{\text{pre}} + \mathcal{P}}}  $$
\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>post</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>post</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>pre</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>pre</mml:mtext></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2015_590_Equ4.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>where <inline-graphic xlink:href="12859_2015_590_Figa_HTML.gif" id="d30e1674"/> (often chosen to be one) is a pseudocount added to each count to avoid ratios of zero or infinity.</p>
      <p>However, Equation <xref rid="Equ4" ref-type="">4</xref> involves ratios of counts with values ∼10 to 100 – and as originally noted by Karl Pearson [<xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref>], ratios estimated from finite counts are statistically biased, with the bias increasing as the magnitude of the counts decrease. This bias can propagate into subsequent analyses, since many statistical tests assume symmetric errors. The problems caused by biases in uncorrected ratios have been noted even in applications such as isotope-ratio mass spectrometry [<xref ref-type="bibr" rid="CR30">30</xref>] and fluorescent imaging [<xref ref-type="bibr" rid="CR31">31</xref>], where the counts usually far exceed those in deep mutational scanning.</p>
      <p>Taking ratios also abrogates our ability to use the magnitude of the counts to assess our certainty about conclusions. For instance, imagine that at a fixed depth, the counts of a mutation increase from a pre-selection value of 5 to a post-selection value of 10. While this doubling suggests that the mutation might be beneficial, the small counts make us somewhat uncertain of this conclusion. But if the counts increased from 20 to 40 we would be substantially more certain, and if they increased from 100 to 200 we would be quite sure. So only by an explicit statistical treatment of the counts can we fully leverage the data.</p>
      <p>Here I describe a software package, dms_tools, that infers mutational effects in a Bayesian framework using a likelihood-based treatment of the counts. This software can be used to infer and visualize site-specific preferences from experiments like Figure <xref rid="Fig1" ref-type="fig">1</xref>A, and to infer and visualize differences in preferences under alternative selections from experiments like Figure <xref rid="Fig1" ref-type="fig">1</xref>B.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Implementation and results</title>
    <sec id="Sec6">
      <title>Algorithm to infer site-specific preferences</title>
      <p>
dms_tools uses a Bayesian approach to infer site-specific preferences from experiments like those in Figure <xref rid="Fig1" ref-type="fig">1</xref>A. The algorithm calculates the likelihoods of the counts given the unknown preferences and mutation/error rates, placing plausible priors over these unknown parameters. The priors correspond to the assumption that all possible identities (e.g. amino acids) have equal preferences, and that the mutation and error rates for each site are equal to the overall average for the gene. MCMC is used to calculate the posterior probability of the preferences given the counts.</p>
      <p>This algorithm is a slight modification of that in the <italic>Methods</italic> of [<xref ref-type="bibr" rid="CR9">9</xref>]; here the algorithm is described anew to explain the implementation in dms_tools.</p>
      <sec id="Sec7">
        <title>Optional controls to quantify error rates</title>
        <p>Some sequencing reads that report a mutation may actually reflect an error introduced during sequencing or PCR rather than an actual mutation that experienced selection. Errors can be quantified by sequencing an unmutated gene, so that any counts at <italic>r</italic> of <italic>x</italic>≠ wt(<italic>r</italic>) for this control reflect errors. In some cases (e.g. sequencing an RNA virus where the post-selection libraries must be reverse-transcribed), error rates for the pre- and post-selection libraries may differ and so be described by different controls. Let <inline-formula id="IEq25"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$N_{r}^{\text {errpre}}$
\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>errpre</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$N_{r}^{\text {errpost}}$
\end{document}</tex-math><mml:math id="M60"><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>errpost</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq26.gif"/></alternatives></inline-formula> be the depth and <inline-formula id="IEq27"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$n_{r,x}^{\text {errpre}}$
\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>errpre</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq27.gif"/></alternatives></inline-formula> and <inline-formula id="IEq28"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$n_{r,x}^{\text {errpost}}$
\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>errpost</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq28.gif"/></alternatives></inline-formula> be the counts of <italic>x</italic> in the pre-selection and post-selection error controls, respectively. Define <italic>ε</italic>
<sub><italic>r</italic>,<italic>x</italic></sub> and <italic>ρ</italic>
<sub><italic>r</italic>,<italic>x</italic></sub> to be the true frequencies of errors at <italic>r</italic> from wt(<italic>r</italic>) to <italic>x</italic> in the pre- and post-selection controls, respectively.</p>
      </sec>
      <sec id="Sec8">
        <title>Likelihoods of observing specific mutational counts</title>
        <p>Define vectors of the counts and frequencies for all characters at each site <italic>r</italic>, i.e. <inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {n_{r}^{\textbf {pre}}}= \left (\cdots, n_{r,x}^{\text {pre}}, \cdots \right)$
\end{document}</tex-math><mml:math id="M66"><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">pre</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>pre</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq29.gif"/></alternatives></inline-formula>, <inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {n_{r}^{\textbf {post}}}= \left (\cdots, n_{r,x}^{\text {post}}, \cdots \right)$
\end{document}</tex-math><mml:math id="M68"><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">post</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>post</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq30.gif"/></alternatives></inline-formula>, <bold><italic>μ</italic></bold>
<sub><bold><italic>r</italic></bold></sub>=(⋯,<italic>μ</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>,⋯), <bold><italic>f</italic></bold>
<sub><bold><italic>r</italic></bold></sub>=(⋯,<italic>f</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>,⋯), etc. Also define <bold><italic>π</italic></bold>
<sub><bold><italic>r</italic></bold></sub>=(⋯,<italic>π</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>,⋯) of the preferences for each <italic>r</italic>, noting that Equation <xref rid="Equ3" ref-type="">3</xref> implies <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\boldsymbol {\mathbf {f_{r}}} = \frac {\boldsymbol {\mathbf {\mu _{r}}}\circ \boldsymbol {\mathbf {\pi _{r}}}}{\boldsymbol {\mathbf {\mu _{r}}}\cdot \boldsymbol {\mathbf {\pi _{r}}}}$
\end{document}</tex-math><mml:math id="M70"><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle><mml:mo>∘</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle><mml:mo>·</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2015_590_IEq31.gif"/></alternatives></inline-formula> where ∘ is the Hadamard product.</p>
        <p>The likelihoods of some specific set of counts are:
<disp-formula id="Equ5"><label>(5)</label><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \begin{aligned} \Pr&amp;\left(\mathbf{n_{r}^{\textbf{errpre}}} \mid N_{r}^{\text{errpre}}, \boldsymbol{\mathbf{\epsilon_{r}}}\right) = \\&amp; \operatorname{Multi}\left(\mathbf{n_{r}^{\textbf{errpre}}}; N_{r}^{\text{errpre}}, \boldsymbol{\mathbf{\epsilon_{r}}}\right) \end{aligned}  $$
\end{document}</tex-math><mml:math id="M72"><mml:mtable><mml:mtr><mml:mtd><mml:mo>Pr</mml:mo></mml:mtd><mml:mtd><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">errpre</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>∣</mml:mo><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>errpre</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle></mml:mrow></mml:mfenced><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>Multi</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold"><mml:munderover><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">errpre</mml:mtext></mml:mrow></mml:munderover></mml:mstyle><mml:mo>;</mml:mo><mml:munderover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>errpre</mml:mtext></mml:mrow></mml:munderover><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_590_Equ5.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>
          <disp-formula id="Equ6">
            <label>(6)</label>
            <alternatives>
              <tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \begin{aligned} \Pr&amp;\left(\mathbf{n_{r}^{\textbf{errpost}}} \mid N_{r}^{\text{errpost}}, \boldsymbol{\mathbf{\rho_{r}}}\right) = \\ &amp; \operatorname{Multi}\left(\mathbf{n_{r}^{\textbf{errpost}}}; N_{r}^{\text{errpost}}, \boldsymbol{\mathbf{\rho_{r}}}\right) \end{aligned}  $$
\end{document}</tex-math>
              <mml:math id="M74">
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Pr</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="bold">errpost</mml:mtext>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mstyle>
                          <mml:mo>∣</mml:mo>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>errpost</mml:mtext>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ρ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Multi</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:munderover>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="bold">errpost</mml:mtext>
                              </mml:mrow>
                            </mml:munderover>
                          </mml:mstyle>
                          <mml:mo>;</mml:mo>
                          <mml:munderover>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>errpost</mml:mtext>
                            </mml:mrow>
                          </mml:munderover>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ρ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ6.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ7">
            <label>(7)</label>
            <alternatives>
              <tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \begin{aligned} \Pr&amp;\left(\mathbf{n_{r}^{\textbf{pre}}}\mid N_{r}^{\text{pre}}, \boldsymbol{\mathbf{\mu_{r}}}, \boldsymbol{\mathbf{\epsilon_{r}}}\right) = \\ &amp;\operatorname{Multi}\left(\mathbf{n_{r}^{\textbf{pre}}}; N_{r}^{\text{pre}}, \boldsymbol{\mathbf{\mu_{r}}}+ \boldsymbol{\mathbf{\epsilon_{r}}}- \boldsymbol{\mathbf{\delta_{r}}}\right) \end{aligned}  $$
\end{document}</tex-math>
              <mml:math id="M76">
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Pr</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="bold">pre</mml:mtext>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mstyle>
                          <mml:mo>∣</mml:mo>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>pre</mml:mtext>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ε</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Multi</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:munderover>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="bold">pre</mml:mtext>
                              </mml:mrow>
                            </mml:munderover>
                          </mml:mstyle>
                          <mml:mo>;</mml:mo>
                          <mml:munderover>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>pre</mml:mtext>
                            </mml:mrow>
                          </mml:munderover>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>+</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ε</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>−</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>δ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ7.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ8">
            <label>(8)</label>
            <alternatives>
              <tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \begin{aligned} \Pr&amp;\left(\mathbf{n_{r}^{\textbf{post}}} \mid N_{r}^{\text{post}}, \boldsymbol{\mathbf{\mu_{r}}}, \boldsymbol{\mathbf{\pi_{r}}}, \boldsymbol{\mathbf{\rho_{r}}}\right) = \\ &amp;\operatorname{Multi}\left(\mathbf{n_{r}^{\textbf{post}}}; N_{r}^{\text{post}}, \frac{\boldsymbol{\mathbf{\mu_{r}}}\circ \boldsymbol{\mathbf{\pi_{r}}}}{\boldsymbol{\mathbf{\mu_{r}}}\cdot \boldsymbol{\mathbf{\pi_{r}}}} + \boldsymbol{\mathbf{\rho_{r}}}- \boldsymbol{\mathbf{\delta_{r}}}\right) \end{aligned}  $$
\end{document}</tex-math>
              <mml:math id="M78">
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Pr</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="bold">post</mml:mtext>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mstyle>
                          <mml:mo>∣</mml:mo>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>post</mml:mtext>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ρ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Multi</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:munderover>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="bold">post</mml:mtext>
                              </mml:mrow>
                            </mml:munderover>
                          </mml:mstyle>
                          <mml:mo>;</mml:mo>
                          <mml:munderover>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>post</mml:mtext>
                            </mml:mrow>
                          </mml:munderover>
                          <mml:mo>,</mml:mo>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mstyle mathvariant="bold">
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>μ</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mstyle>
                              </mml:mstyle>
                              <mml:mo>∘</mml:mo>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mstyle mathvariant="bold">
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>π</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mstyle>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mstyle mathvariant="bold">
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>μ</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mstyle>
                              </mml:mstyle>
                              <mml:mo>·</mml:mo>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mstyle mathvariant="bold">
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>π</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mstyle>
                              </mml:mstyle>
                            </mml:mrow>
                          </mml:mfrac>
                          <mml:mo>+</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ρ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>−</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>δ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ8.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>where Multi is the multinomial distribution, <bold><italic>δ</italic></bold>
<sub><bold><italic>r</italic></bold></sub>=(⋯,<italic>δ</italic>
<sub><italic>x</italic>,wt(<italic>r</italic>)</sub>,⋯) is a vector with the element corresponding to wt(<italic>r</italic>) equal to one and all other elements zero (<italic>δ</italic>
<sub><italic>xy</italic></sub> is the Kronecker delta), and we have assumed that the probability that a site experiences both a mutation and an error is negligibly small.</p>
      </sec>
      <sec id="Sec9">
        <title>Priors over the unknown parameters</title>
        <p>We specify Dirichlet priors over the parameter vectors:
<disp-formula id="Equ9"><label>(9)</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{*{20}l} \Pr\left(\boldsymbol{\mathbf{\pi_{r}}}\right) = \operatorname{Dirichlet}\left(\boldsymbol{\mathbf{\pi_{r}}}; \alpha_{\pi} \times \mathbf{1}\right) \end{array} $$
\end{document}</tex-math><mml:math id="M80"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mo>Pr</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>Dirichlet</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_590_Equ9.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>
          <disp-formula id="Equ10">
            <label>(10)</label>
            <alternatives>
              <tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{*{20}l}  \Pr\left(\boldsymbol{\mathbf{\mu_{r}}}\right) = \operatorname{Dirichlet}\left(\boldsymbol{\mathbf{\mu_{r}}}; \alpha_{\mu} \times \mathcal{N}_{x} \times \boldsymbol{\mathbf{a_{r,\mu}}} \right) \end{array} $$
\end{document}</tex-math>
              <mml:math id="M82">
                <mml:mtable class="align" columnalign="left">
                  <mml:mtr>
                    <mml:mtd class="align-1">
                      <mml:mo>Pr</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>=</mml:mo>
                      <mml:mo>Dirichlet</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>;</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>μ</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>×</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi mathvariant="script">N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>×</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>a</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ10.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ11">
            <label>(11)</label>
            <alternatives>
              <tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{*{20}l} \Pr\left(\boldsymbol{\mathbf{\epsilon_{r}}}\right) = \operatorname{Dirichlet}\left(\boldsymbol{\mathbf{\epsilon_{r}}}; \alpha_{\epsilon} \times \mathcal{N}_{x} \times \boldsymbol{\mathbf{a_{r,\epsilon}}} \right) \end{array} $$
\end{document}</tex-math>
              <mml:math id="M84">
                <mml:mtable class="align" columnalign="left">
                  <mml:mtr>
                    <mml:mtd class="align-1">
                      <mml:mo>Pr</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ε</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>=</mml:mo>
                      <mml:mo>Dirichlet</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ε</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>;</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>ε</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>×</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi mathvariant="script">N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>×</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>a</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>ε</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ11.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ12">
            <label>(12)</label>
            <alternatives>
              <tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{*{20}l} \Pr\left(\boldsymbol{\mathbf{\rho_{r}}}\right) = \operatorname{Dirichlet}\left(\boldsymbol{\mathbf{\rho_{r}}}; \alpha_{\rho} \times \mathcal{N}_{x} \times \boldsymbol{\mathbf{a_{r,\rho}}}\right) \end{array} $$
\end{document}</tex-math>
              <mml:math id="M86">
                <mml:mtable class="align" columnalign="left">
                  <mml:mtr>
                    <mml:mtd class="align-1">
                      <mml:mo>Pr</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ρ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>=</mml:mo>
                      <mml:mo>Dirichlet</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ρ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>;</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>ρ</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>×</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi mathvariant="script">N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>×</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>a</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>ρ</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ12.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <bold>1</bold> is a vector of ones, <inline-formula id="IEq32"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {N}_{x}$
\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_590_IEq32.gif"/></alternatives></inline-formula> is the number of characters (64 for codons, 20 for amino acids, 4 for nucleotides), the <italic>α</italic>’s are scalar concentration parameters &gt;0 (by default dms_tools sets the <italic>α</italic>’s to one). For codons, the error rate depends on the number of nucleotides being changed. The average error rates <inline-formula id="IEq33"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\overline {\epsilon _{m}}$
\end{document}</tex-math><mml:math id="M90"><mml:mover accent="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_590_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\overline {\rho _{m}}$
\end{document}</tex-math><mml:math id="M92"><mml:mover accent="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_590_IEq34.gif"/></alternatives></inline-formula> for codon mutations with <italic>m</italic> nucleotide changes are estimated as
<disp-formula id="Equ13"><label>(13)</label><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{*{20}l} \overline{\epsilon_{m}} = \frac{1}{L}\sum\limits_{r} \frac{1}{N_{r}^{\text{errpre}}}\sum\limits_{x} n_{r,x}^{\text{errpre}}\times \delta_{m,D_{x,\operatorname{wt}\left(r\right)}}  \end{array} $$
\end{document}</tex-math><mml:math id="M94"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mover accent="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>errpre</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>errpre</mml:mtext></mml:mrow></mml:msubsup><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_590_Equ13.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>
          <disp-formula id="Equ14">
            <label>(14)</label>
            <alternatives>
              <tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{*{20}l} \overline{\rho_{m}} = \frac{1}{L}\sum\limits_{r} \frac{1}{N_{r}^{\text{errpost}}}\sum\limits_{x} n_{r,x}^{\text{errpost}}\times \delta_{m,D_{x,\operatorname{wt}\left(r\right)}}  \end{array} $$
\end{document}</tex-math>
              <mml:math id="M96">
                <mml:mtable class="align" columnalign="left">
                  <mml:mtr>
                    <mml:mtd class="align-1">
                      <mml:mover accent="false">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ρ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>m</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo accent="true">¯</mml:mo>
                      </mml:mover>
                      <mml:mo>=</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>L</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mo mathsize="big">∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>errpost</mml:mtext>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mo mathsize="big">∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                      </mml:munder>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext>errpost</mml:mtext>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mo>×</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>δ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>D</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mo>wt</mml:mo>
                              <mml:mfenced close=")" open="(" separators="">
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ14.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <italic>D</italic>
<sub><italic>x</italic>,wt(<italic>r</italic>)</sub> is the number of nucleotide differences between <italic>x</italic> and wt(<italic>r</italic>). Given these definitions,
<disp-formula id="Equ15"><label>(15)</label><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{*{20}l} \boldsymbol{\mathbf{a_{r,\epsilon}}} = \left(\cdots, \sum\limits_{m} \frac{\overline{\epsilon}_{m}}{\mathcal{C}_{m}} \times \delta_{m,D_{x,\operatorname{wt}\left(r\right)}},\cdots\right)  \end{array} $$
\end{document}</tex-math><mml:math id="M98"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_590_Equ15.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>
          <disp-formula id="Equ16">
            <label>(16)</label>
            <alternatives>
              <tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{*{20}l} \boldsymbol{\mathbf{a_{r,\rho}}} = \left(\cdots, \sum\limits_{m} \frac{\overline{\rho}_{m}}{\mathcal{C}_{m}} \times \delta_{m,D_{x,\operatorname{wt}\left(r\right)}}, \cdots\right)  \end{array} $$
\end{document}</tex-math>
              <mml:math id="M100">
                <mml:mtable class="align" columnalign="left">
                  <mml:mtr>
                    <mml:mtd class="align-1">
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mstyle mathvariant="bold">
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>a</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>ρ</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mstyle>
                      </mml:mstyle>
                      <mml:mo>=</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mo>⋯</mml:mo>
                          <mml:mspace width="0.3em"/>
                          <mml:mo>,</mml:mo>
                          <mml:munder>
                            <mml:mrow>
                              <mml:mo mathsize="big">∑</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>m</mml:mi>
                            </mml:mrow>
                          </mml:munder>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mover accent="false">
                                    <mml:mrow>
                                      <mml:mi>ρ</mml:mi>
                                    </mml:mrow>
                                    <mml:mo accent="true">¯</mml:mo>
                                  </mml:mover>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>m</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi mathvariant="script">C</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>m</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mfrac>
                          <mml:mo>×</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>δ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>m</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>D</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>x</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mo>wt</mml:mo>
                                  <mml:mfenced close=")" open="(" separators="">
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                  </mml:mfenced>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:mo>⋯</mml:mo>
                          <mml:mspace width="0.3em"/>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ16.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <inline-formula id="IEq35"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {C}_{m}$
\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_590_IEq35.gif"/></alternatives></inline-formula> is the number of mutant characters with <italic>m</italic> changes relative to wildtype (for nucleotides <inline-formula id="IEq36"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {C}_{0} = 1$
\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2015_590_IEq36.gif"/></alternatives></inline-formula> and <inline-formula id="IEq37"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {C}_{1} = 3$
\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="12859_2015_590_IEq37.gif"/></alternatives></inline-formula>; for codons <inline-formula id="IEq38"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {C}_{0} = 1$
\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2015_590_IEq38.gif"/></alternatives></inline-formula>, <inline-formula id="IEq39"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {C}_{1} = 9$
\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:math><inline-graphic xlink:href="12859_2015_590_IEq39.gif"/></alternatives></inline-formula>, <inline-formula id="IEq40"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {C}_{2} = \mathcal {C}_{3} = 27$
\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>27</mml:mn></mml:math><inline-graphic xlink:href="12859_2015_590_IEq40.gif"/></alternatives></inline-formula>).</p>
        <p>Our prior assumption is that the mutagenesis introduces all mutant characters at equal frequency (this assumption is only plausible for codons if the mutagenesis is at the codon level as in [<xref ref-type="bibr" rid="CR8">8</xref>-<xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR15">15</xref>-<xref ref-type="bibr" rid="CR17">17</xref>]; if mutations are made at the nucleotide level such as by error-prone PCR then characters should be defined as nucleotides). The average per-site mutagenesis rate is estimated as
<disp-formula id="Equ17"><label>(17)</label><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \overline{\mu} = \left(\frac{1}{L}\sum\limits_{r} \frac{1}{N_{r}^{\text{pre}}}\sum\limits_{x\ne \operatorname{wt}\left(r\right)} n_{r,x}^{\text{pre}}\right) - \sum\limits_{m \ge 1} \overline{\epsilon_{m}},  $$
\end{document}</tex-math><mml:math id="M114"><mml:mover accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>pre</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>≠</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>pre</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mover accent="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2015_590_Equ17.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>so that
<disp-formula id="Equ18"><label>(18)</label><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \boldsymbol{\mathbf{a_{r,\mu}}} = \left(\cdots, \frac{\overline{\mu}}{\mathcal{N}_{x} - 1} + \delta_{x,\operatorname{wt}\left(r\right)} \times \left[1 - \overline{\mu}\right],\cdots\right).  $$
\end{document}</tex-math><mml:math id="M116"><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mover accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2015_590_Equ18.gif" position="anchor"/></alternatives></disp-formula>
</p>
      </sec>
      <sec id="Sec10">
        <title>Character types: nucleotides, amino acids, or codons</title>
        <p>
dms_tools allows four possibilities for the type of character for the counts and preferences. The first three possibilities are simple: the counts and preferences can both be for any of nucleotides, amino acids, or codons.</p>
        <p>The fourth possibility is that the counts are for codons, but the preferences for amino acids. In this case, define a function mapping codons to amino acids,
<disp-formula id="Equ19"><label>(19)</label><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \mathbf{A}\left(\mathbf{w}\right) = \left(\cdots, \sum\limits_{x} \delta_{a,\mathcal{A}\left(x\right)} \times w_{x}, \cdots\right)  $$
\end{document}</tex-math><mml:math id="M118"><mml:mi mathvariant="bold">A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2015_590_Equ19.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>where <bold>w</bold> is a 64-element vector of codons <italic>x</italic>, <bold>A</bold>(<bold>w</bold>) is a 20- or 21-element (depending on the treatment of stop codons) vector of amino acids <italic>a</italic>, and <inline-formula id="IEq41"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {A}\left (x\right)$
\end{document}</tex-math><mml:math id="M120"><mml:mi mathvariant="script">A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq41.gif"/></alternatives></inline-formula> is the amino acid encoded by <italic>x</italic>. The prior over the preferences <bold><italic>π</italic></bold>
<sub><bold><italic>r</italic></bold></sub> is still a symmetric Dirichlet (now only of length 20 or 21), but the priors for <bold><italic>μ</italic></bold>
<sub><bold><italic>r</italic></bold></sub>, <bold><italic>ε</italic></bold>
<sub><bold><italic>r</italic></bold></sub>, and <bold><italic>ρ</italic></bold>
<sub><bold><italic>r</italic></bold></sub> are now Dirichlets parameterized by <bold>A</bold>(<bold><italic>a</italic></bold>
<sub><bold><italic>r,μ</italic></bold></sub>), <bold>A</bold>(<bold><italic>a</italic></bold>
<sub><bold><italic>r,ε</italic></bold></sub>) and <bold>A</bold>(<bold><italic>a</italic></bold>
<sub><bold><italic>r,ρ</italic></bold></sub>) rather than <bold><italic>a</italic></bold>
<sub><bold><italic>r,μ</italic></bold></sub>, <bold><italic>a</italic></bold>
<sub><bold><italic>r,ε</italic></bold></sub>, and <bold><italic>a</italic></bold>
<sub><bold><italic>r,ρ</italic></bold></sub>. The likelihoods are computed in terms of these transformed vectors after similarly transforming the counts to <inline-formula id="IEq42"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {A}\left (\mathbf {n_{r}^{\textbf {pre}}}\right)$
\end{document}</tex-math><mml:math id="M122"><mml:mi mathvariant="bold">A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">pre</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq42.gif"/></alternatives></inline-formula>, <inline-formula id="IEq43"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {A}\left (\mathbf {n_{r}^{\textbf {post}}}\right)$
\end{document}</tex-math><mml:math id="M124"><mml:mi mathvariant="bold">A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">post</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq43.gif"/></alternatives></inline-formula>, <inline-formula id="IEq44"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {A}\left (\mathbf {n_{r}^{\textbf {errpre}}}\right)$
\end{document}</tex-math><mml:math id="M126"><mml:mi mathvariant="bold">A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">errpre</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq44.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq45"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {A}\left (\mathbf {n_{r}^{\textbf {errpost}}}\right)$
\end{document}</tex-math><mml:math id="M128"><mml:mi mathvariant="bold">A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">errpost</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq45.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec11">
        <title>Implementation</title>
        <p>The program dms_inferprefs in the dms_tools package infers the preferences by using pystan [<xref ref-type="bibr" rid="CR32">32</xref>] to perform MCMC over the posterior defined by the product of the likelihoods and priors in Equations <xref rid="Equ5" ref-type="">5</xref>, <xref rid="Equ6" ref-type="">6</xref>, <xref rid="Equ7" ref-type="">7</xref>, <xref rid="Equ8" ref-type="">8</xref>, <xref rid="Equ9" ref-type="">9</xref>, <xref rid="Equ10" ref-type="">10</xref>, <xref rid="Equ11" ref-type="">11</xref>, and <xref rid="Equ12" ref-type="">12</xref>. The program runs four chains from different initial values, and checks for convergence by ensuring that the Gelman-Rubin statistic <inline-formula id="IEq46"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\hat {R}$
\end{document}</tex-math><mml:math id="M130"><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_590_IEq46.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR33">33</xref>] is &lt;1.1 and the effective sample size is &gt;100; the number of MCMC iterations is increased until convergence is achieved. The program dms_logoplot in the dms_tools package visualizes the posterior mean preferences via an extension to weblogo [<xref ref-type="bibr" rid="CR34">34</xref>]. The program dms_merge can be used to average preferences inferred from different experimental replicates that have individually been analyzed by dms_inferprefs, and the program dms_correlate can be used to compute the correlations among inferences from different replicates.</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Inferring preferences with dms_tools</title>
      <sec id="Sec13">
        <title>Application to actual datasets</title>
        <p>Figures <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref> illustrate application of dms_tools to two existing datasets [<xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR11">11</xref>]. The programs require as input only simple text files listing the counts of each character identity at each site. As the figures show, the dms_inferprefs and dms_logoplot programs can process these input files to infer and visualize the preferences with a few simple commands. Error controls can be included when available (they are not for Figure <xref rid="Fig2" ref-type="fig">2</xref>, but are for Figure <xref rid="Fig3" ref-type="fig">3</xref>). The runtime for the MCMC depends on the gene length and character type (codons are slowest, nucleotides fastest) – but if the inference is parallelized across multiple CPUs (using the –ncpus option of dms_inferprefs), the inference should take no more than a few hours. As shown in Figures <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>, the visualizations can overlay information about protein structure onto the preferences.
<fig id="Fig2"><label>Figure 2</label><caption><p>Site-specific preferences from deep mutational scanning of a Tn5 transposon. Melnikov <italic>et al.</italic> [<xref ref-type="bibr" rid="CR10">10</xref>] performed deep mutational scanning on a Tn5 transposon using kanamycin selection, and reported the counts of amino-acid mutations for two biological replicates of the experiment. Here I have used dms_tools to infer the preferences. <bold>(A)</bold> Visualization of the preferences averaged across the two replicates. <bold>(B)</bold> Correlation between the preferences inferred from each of the two replicates. Given files containing the mutation counts, the plots can be generated as logoplot.pdf and corr.pdf with the following commands:<inline-graphic xlink:href="12859_2015_590_Figb_HTML.gif" id="d30e4162"/>.</p></caption><graphic xlink:href="12859_2015_590_Fig2_HTML" id="MO2"/></fig>
<fig id="Fig3"><label>Figure 3</label><caption><p>Site-specific preferences from deep mutational scanning of influenza hemagglutinin. Thyagarajan and Bloom [<xref ref-type="bibr" rid="CR11">11</xref>] performed deep mutational scanning on influenza hemagglutinin, and reported the counts of codon mutations for three biological replicates of the experiment. Here I have used dms_tools to infer the preferences. <bold>(A)</bold> Visualization of the preferences averaged across the three replicates. <bold>(B)</bold> Correlations between the preferences from each pair of replicates. Given files containing the mutation counts, the plots can be generated as logoplot.pdf, corr_1_2.pdf, corr_1_3.pdf, and corr_2_3.pdf with the following commands:<inline-graphic xlink:href="12859_2015_590_Figc_HTML.gif" id="d30e4200"/>.</p></caption><graphic xlink:href="12859_2015_590_Fig3_HTML" id="MO3"/></fig>
</p>
        <p>Figures <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref> also illustrate use of dms_correlate to assess the correlation between preferences inferred from different biological replicates [<xref ref-type="bibr" rid="CR35">35</xref>] of the experiment. The inclusion and analysis of such replicates is the only sure way to fully assess the sources of noise associated with deep mutational scanning.</p>
      </sec>
      <sec id="Sec14">
        <title>Testing on simulated data</title>
        <p>To test the accuracy of preference-inference by dms_tools, I simulated deep mutational scanning counts using the preferences in Figure <xref rid="Fig2" ref-type="fig">2</xref>, both with and without errors quantified by appropriate controls. Importantly, the error and mutation rates for these simulations were <italic>not</italic> uniform across sites and characters, but were simulated to have a level of unevenness comparable to that observed in real experiments. I then used dms_tools to infer preferences from the simulated data, and also made similar inferences using simple ratio estimation (Equation <xref rid="Equ4" ref-type="">4</xref>). Figure <xref rid="Fig4" ref-type="fig">4</xref> shows the inferred preferences versus the actual values used to simulate the data. For simulations with mutation counts (quantified by the product <inline-formula id="IEq47"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$N\overline {\mu }$
\end{document}</tex-math><mml:math id="M132"><mml:mi>N</mml:mi><mml:mover accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_590_IEq47.gif"/></alternatives></inline-formula> of the depth and average per-site mutation rate) ∼1000 to 2000, the inferences are quite accurate. Inferences made by dms_tools are always more accurate than those obtained by simply taking ratios of mutation counts.
<fig id="Fig4"><label>Figure 4</label><caption><p>Accuracy of preference inference on simulated data. Deep mutational scanning counts were simulated using the preferences in Figure <xref rid="Fig2" ref-type="fig">2</xref>A and realistic mutation and error rates that were uneven across sites and characters as in actual experiments. The simulations were done <bold>(A)</bold> without or <bold>(B)</bold> with sequencing errors quantified by control libraries. Plots show the correlation between the actual and inferred preferences as a function of the product of the sequencing depth <italic>N</italic> and the average per-site mutation rate <inline-formula id="IEq48"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\overline {\mu }$
\end{document}</tex-math><mml:math id="M134"><mml:mover accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_590_IEq48.gif"/></alternatives></inline-formula>; real experiments typically have <inline-formula id="IEq49"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$N\overline {\mu } \sim 1000$
\end{document}</tex-math><mml:math id="M136"><mml:mi>N</mml:mi><mml:mover accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mn>1000</mml:mn></mml:math><inline-graphic xlink:href="12859_2015_590_IEq49.gif"/></alternatives></inline-formula> to 2000 depending on the sequencing depth and gene length. Preferences are inferred using the full algorithm in dms_tools (top panels) or by simply calculating ratios of counts (bottom panels) using Equation <xref rid="Equ4" ref-type="">4</xref> and its logical extension to include errors, both with a pseudocount of one. The dms_tools inferences are more accurate than the simple ratio estimation, with both methods converging to the actual values with increasing <inline-formula id="IEq50"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$N\overline {\mu }$
\end{document}</tex-math><mml:math id="M138"><mml:mi>N</mml:mi><mml:mover accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_590_IEq50.gif"/></alternatives></inline-formula>. Given files with the mutation counts, the plots in this figure can be generated as prefs_corr.pdf and ratio_corr.pdf with commands such as:<inline-graphic xlink:href="12859_2015_590_Figd_HTML.gif" id="d30e4349"/>.</p></caption><graphic xlink:href="12859_2015_590_Fig4_HTML" id="MO4"/></fig>
</p>
      </sec>
      <sec id="Sec15">
        <title>Is the Bayesian inference worthwhile?</title>
        <p>The foregoing sections explain why the Bayesian inference of preferences implemented in dms_tools is conceptually preferable to estimating mutational effects via direct ratio estimation using Equation <xref rid="Equ4" ref-type="">4</xref>. However, do the practical benefits of this Bayesian inference justify its increased complexity? The simulations in the previous section show that the Bayesian inference is more accurate, but in the absence of background errors (Figure <xref rid="Fig4" ref-type="fig">4</xref>A) the magnitude of the improvement becomes negligible once the mutation counts per site <inline-formula id="IEq51"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$N \overline {\mu }$
\end{document}</tex-math><mml:math id="M140"><mml:mi>N</mml:mi><mml:mover accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_590_IEq51.gif"/></alternatives></inline-formula> start to exceed ∼10<sup>3</sup>. When there is a need to correct for background errors (Figure <xref rid="Fig4" ref-type="fig">4</xref>B), meaningful benefits of the Bayesian inference over enrichment ratios extend to somewhat higher sequencing depths. Overall, it appears that Bayesian inference will always perform as well or better than ratio estimation, but that the tangible benefit becomes negligible at high sequencing depth. In that case, the user will have to decide if the increased computational runtime and complexity of the Bayesian inference is worth a small improvement in accuracy. Simpler ratio estimation can be performed using the –ratio_estimation option of dms_inferprefs or using an alternative program such as Enrich [<xref ref-type="bibr" rid="CR19">19</xref>]. When applying ratio estimation to data where some mutations have low counts, it is important to include pseudocounts (denoted by <inline-graphic xlink:href="12859_2015_590_Fige_HTML.gif" id="d30e4404"/> in Equation <xref rid="Equ4" ref-type="">4</xref>) as a form of regularization to avoid estimating excessively high or low preferences at sites with limited counts.</p>
      </sec>
    </sec>
    <sec id="Sec16">
      <title>Algorithm to infer differential preferences</title>
      <p>As shown in Figure <xref rid="Fig1" ref-type="fig">1</xref>B, a useful extension to the experiment in Figure <xref rid="Fig1" ref-type="fig">1</xref>A is to subject the functional variants to two different selection pressures to identify mutations favored by one pressure versus the other. While this experiment could in principle by analyzed by simply comparing the initial unselected mutants to the final variants after the two alternative selections, this approach is non-ideal. In experiments like Figure <xref rid="Fig1" ref-type="fig">1</xref>A, many mutations are enriched or depleted to some extent by selection, since a large fraction of random mutations affect protein function [<xref ref-type="bibr" rid="CR36">36</xref>-<xref ref-type="bibr" rid="CR40">40</xref>]. Therefore, the assumption that all mutations are equally tolerated (i.e. the preferences for a site are all equal, or the enrichment ratios are all one) is not a plausible null hypothesis for Figure <xref rid="Fig1" ref-type="fig">1</xref>A. For this reason, dms_tools simply infers the preferences given a uniform Dirichlet prior rather than trying to pinpoint some subset of sites with unequal preferences.</p>
      <p>But in Figure <xref rid="Fig1" ref-type="fig">1</xref>B, the assumption that most mutations will be similarly selected is a plausible null hypothesis, since we expect alternative selections to have markedly different effects on only a small subset of mutations (typically, major constraints related to protein folding and stability will be conserved across different selections on the same protein). Therefore, dms_tools uses a different algorithm to infer the differential preferences under the two selections. This algorithm combines a prior that mildly favors differential preferences of zero with a likelihood-based analysis of the mutation counts to estimate posterior probabilities over the differential preferences.</p>
      <sec id="Sec17">
        <title>Definition of the differential preferences</title>
        <p>Given an experiment like Figure <xref rid="Fig1" ref-type="fig">1</xref>B, let <inline-formula id="IEq52"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$f_{r,x}^{\text {start}}$
\end{document}</tex-math><mml:math id="M142"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>start</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq52.gif"/></alternatives></inline-formula> be the true frequency of character <italic>x</italic> at site <italic>r</italic> in the starting library (equivalent to the frequency <inline-formula id="IEq53"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$f_{r,x}^{\text {post}}$
\end{document}</tex-math><mml:math id="M144"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>post</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq53.gif"/></alternatives></inline-formula> in the figure), and let <inline-formula id="IEq54"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$f_{r,x}^{s1}$
\end{document}</tex-math><mml:math id="M146"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq54.gif"/></alternatives></inline-formula> and <inline-formula id="IEq55"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$f_{r,x}^{s2}$
\end{document}</tex-math><mml:math id="M148"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq55.gif"/></alternatives></inline-formula> be the frequencies after selections <italic>s</italic>1 and <italic>s</italic>2, respectively. The differential preference <italic>Δ</italic>
<italic>π</italic>
<sub><italic>r</italic>,<italic>x</italic></sub> for <italic>x</italic> at <italic>r</italic> in <italic>s</italic>2 versus <italic>s</italic>1 is defined by:
<disp-formula id="Equ20"><label>(20)</label><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \begin{aligned} f_{r,x}^{s1} = \frac{f_{r,x}^{\text{start}} \times \pi_{r,x}^{s1}}{\sum_{y} f_{r,y}^{\text{start}} \times \pi_{r,y}^{s1}} \end{aligned}  $$
\end{document}</tex-math><mml:math id="M150"><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>start</mml:mtext></mml:mrow></mml:msubsup><mml:mo>×</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>start</mml:mtext></mml:mrow></mml:msubsup><mml:mo>×</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_590_Equ20.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>
          <disp-formula id="Equ21">
            <label>(21)</label>
            <alternatives>
              <tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \begin{aligned} f_{r,x}^{s2} = \frac{f_{r,x}^{\text{start}} \times \left(\pi_{r,x}^{s1} + \Delta\pi_{r,x}\right)}{\sum_{y} f_{r,y}^{\text{start}} \times \left(\pi_{r,y}^{s1} + \Delta\pi_{r,y}\right)} \end{aligned}  $$
\end{document}</tex-math>
              <mml:math id="M152">
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mo>=</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>f</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>start</mml:mtext>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mo>×</mml:mo>
                          <mml:mfenced close=")" open="(" separators="">
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>x</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                              <mml:mo>+</mml:mo>
                              <mml:mi>Δ</mml:mi>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>x</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mfenced>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:munder>
                            <mml:mrow>
                              <mml:mo>∑</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>y</mml:mi>
                            </mml:mrow>
                          </mml:munder>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>f</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>y</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>start</mml:mtext>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mo>×</mml:mo>
                          <mml:mfenced close=")" open="(" separators="">
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>y</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                              <mml:mo>+</mml:mo>
                              <mml:mi>Δ</mml:mi>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>y</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mfenced>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ21.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <inline-formula id="IEq56"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\pi _{r,x}^{s1}$
\end{document}</tex-math><mml:math id="M154"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2015_590_IEq56.gif"/></alternatives></inline-formula> is the “control preference” and is treated as a nuisance parameter, and we have the constraints
<disp-formula id="Equ22"><label>(22)</label><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \begin{aligned} 0 = \sum\limits_{x} \Delta\pi_{r,x} \end{aligned}  $$
\end{document}</tex-math><mml:math id="M156"><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:munder><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_590_Equ22.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>
          <disp-formula id="Equ23">
            <label>(23)</label>
            <alternatives>
              <tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \begin{aligned} 0 \le \pi_{r,x}^{s1} + \Delta\pi_{r,x} \le 1. \end{aligned}  $$
\end{document}</tex-math>
              <mml:math id="M158">
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mn>0</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>π</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mo>+</mml:mo>
                      <mml:mi>Δ</mml:mi>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>π</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>≤</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mi>.</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ23.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>If there is no difference in the effect of <italic>x</italic> at <italic>r</italic> between selections <italic>s</italic>1 and <italic>s</italic>2, then <italic>Δ</italic>
<italic>π</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>=0. If <italic>x</italic> at <italic>r</italic> is more preferred by <italic>s</italic>2 than <italic>s</italic>1, then <italic>Δ</italic>
<italic>π</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>&gt;0; conversely if <italic>x</italic> at <italic>r</italic> is more preferred by <italic>s</italic>1 than <italic>s</italic>2, then <italic>Δ</italic>
<italic>π</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>&lt;0 (see Figure <xref rid="Fig5" ref-type="fig">5</xref>A).
<fig id="Fig5"><label>Figure 5</label><caption><p>Inference of differential preferences on simulated data. To illustrate and test the inference of differential preferences, the experiment in Figure <xref rid="Fig1" ref-type="fig">1</xref>B was simulated at the codon level starting with the post-selection library that yielded the preferences in Figure <xref rid="Fig2" ref-type="fig">2</xref>. In the simulations, 20% of sites had different preferences between the control and alternative selection. <bold>(A)</bold>, dms_tools was used to infer the differential preferences from the data simulated at <italic>N</italic>=10<sup>7</sup>, and the resulting inferences were visualized. The overlay bars indicate which sites had non-zero differential preferences in the simulation. <bold>(B)</bold> The correlations between the inferred and actual differential preferences as a function of <inline-formula id="IEq57"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$N\overline {\mu }$
\end{document}</tex-math><mml:math id="M160"><mml:mi>N</mml:mi><mml:mover accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_590_IEq57.gif"/></alternatives></inline-formula> show that the inferred values converge to the true ones. Given files with the mutation counts, the plots in this figure can be generated as logoplot.pdf and corr.pdf with the following commands:<inline-graphic xlink:href="12859_2015_590_Figf_HTML.gif" id="d30e5084"/>.</p></caption><graphic xlink:href="12859_2015_590_Fig5_HTML" id="MO5"/></fig>
</p>
      </sec>
      <sec id="Sec18">
        <title>Likelihoods of observing specific mutational counts</title>
        <p>Define vectors of the counts as <inline-formula id="IEq58"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {n_{r}^{start}}= \left (\cdots, n_{r,x}^{\text {start}}, \cdots \right)$
\end{document}</tex-math><mml:math id="M162"><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">start</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>start</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq58.gif"/></alternatives></inline-formula> for the post-selection functional variants that are subjected to the further selections, and as <inline-formula id="IEq59"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {n_{r}^{s1}}= \left (\cdots, n_{r,x}^{s1}, \cdots \right)$
\end{document}</tex-math><mml:math id="M164"><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq59.gif"/></alternatives></inline-formula> and <inline-formula id="IEq60"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {n_{r}^{s2}}= \left (\cdots, n_{r,x}^{s2}, \cdots \right)$
\end{document}</tex-math><mml:math id="M166"><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq60.gif"/></alternatives></inline-formula> for selections <italic>s</italic>1 and <italic>s</italic>2. We again allow an error control, but now assume that the same control applies to all three libraries (since they are all sequenced after a selection), and define the counts for this control as <inline-formula id="IEq61"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {n_{r}^{\textbf {err}}}= \left (\cdots, n_{r,x}^{\text {err}}, \cdots \right)$
\end{document}</tex-math><mml:math id="M168"><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">err</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>err</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq61.gif"/></alternatives></inline-formula>; the true error frequencies are denoted by <italic>ξ</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>. Define vectors of the frequencies, errors, control preferences, and differential preferences: <inline-formula id="IEq62"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {f_{r}^{\,\textbf {start}}}= \left (\cdots, f_{r,x}^{\text {start}}, \cdots \right)$
\end{document}</tex-math><mml:math id="M170"><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext mathvariant="bold">start</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>start</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq62.gif"/></alternatives></inline-formula>, <inline-formula id="IEq63"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {f_{r}^{\,s1}}= \left (\cdots, f_{r,x}^{s1}, \cdots \right)$
\end{document}</tex-math><mml:math id="M172"><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq63.gif"/></alternatives></inline-formula>, <inline-formula id="IEq64"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {f_{r}^{\,s2}}= \left (\cdots, f_{r,x}^{s2}, \cdots \right)$
\end{document}</tex-math><mml:math id="M174"><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq64.gif"/></alternatives></inline-formula>, <bold><italic>ξ</italic></bold>
<sub><bold><italic>r</italic></bold></sub>=(⋯,<italic>ξ</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>,⋯), <inline-formula id="IEq65"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\boldsymbol {\mathbf {\pi ^{s1}_{r}}}= \left (\cdots, \pi ^{s1}_{r,x}, \cdots \right)$
\end{document}</tex-math><mml:math id="M176"><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2015_590_IEq65.gif"/></alternatives></inline-formula>, and <bold><italic>Δπ</italic></bold>
<sub><bold><italic>r</italic></bold></sub>=(⋯,<italic>Δ</italic>
<italic>π</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>,⋯). Equations <xref rid="Equ20" ref-type="">20</xref> and <xref rid="Equ21" ref-type="">21</xref> imply <inline-formula id="IEq66"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {f_{r}^{\,s1}}= \frac {\mathbf {f_{r}^{\,\textbf {start}}}\circ \mathbf {\pi _{r}^{s1}}}{\mathbf {f_{r}^{\,\textbf {start}}}\cdot \mathbf {\pi _{r}^{s1}}}$
\end{document}</tex-math><mml:math id="M178"><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext mathvariant="bold">start</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>∘</mml:mo><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext mathvariant="bold">start</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>·</mml:mo><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2015_590_IEq66.gif"/></alternatives></inline-formula> and <inline-formula id="IEq67"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathbf {f_{r}^{\,s2}} = \frac {\mathbf {f_{r}^{\textbf {start}}}\circ \left (\mathbf {\pi _{r}^{s1}} + \mathbf {\Delta \pi _{r}}\right)}{\mathbf {f_{r}^{\,\textbf {start}}}\cdot \left (\mathbf {\pi _{r}^{s1}} + \mathbf {\Delta \pi _{r}}\right)}$
\end{document}</tex-math><mml:math id="M180"><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">start</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>∘</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext mathvariant="bold">start</mml:mtext></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>·</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2015_590_IEq67.gif"/></alternatives></inline-formula>.</p>
        <p>The likelihoods of the counts will be multinomially distributed around the “true” frequencies, so
<disp-formula id="Equ24"><label>(24)</label><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \begin{aligned}  \Pr\left(\mathbf{n_{r}^{\textbf{err}}}\mid N_{r}^{\text{err}}, \boldsymbol{\mathbf{\xi_{r}}}\right) = \operatorname{Multi}\left(\mathbf{n_{r}^{\textbf{err}}}; N_{r}^{\text{err}}, \boldsymbol{\mathbf{\xi_{r}}}\right) \end{aligned}  $$
\end{document}</tex-math><mml:math id="M182"><mml:mtable><mml:mtr><mml:mtd><mml:mo>Pr</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold"><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">err</mml:mtext></mml:mrow></mml:munderover></mml:mstyle><mml:mo>∣</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>err</mml:mtext></mml:mrow></mml:munderover><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>Multi</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold"><mml:munderover><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">err</mml:mtext></mml:mrow></mml:munderover></mml:mstyle><mml:mo>;</mml:mo><mml:munderover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>err</mml:mtext></mml:mrow></mml:munderover><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_590_Equ24.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>
          <disp-formula id="Equ25">
            <label>(25)</label>
            <alternatives>
              <tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \begin{aligned}  \Pr&amp;\left(\mathbf{n_{r}^{\textbf{start}}}\mid N_{r}^{\text{start}}, \boldsymbol{\mathbf{f_{r}^{\textbf{\,start}}}}, \boldsymbol{\mathbf{\xi_{r}}}\right) = \\ &amp; \operatorname{Multi}\left(\mathbf{n_{r}^{\textbf{start}}}; N_{r}^{\text{start}}, \boldsymbol{\mathbf{f_{r}^{\textbf{\,start}}}} + \boldsymbol{\mathbf{\xi_{r}}}- \boldsymbol{\mathbf{\delta_{r}}}\right) \end{aligned}  $$
\end{document}</tex-math>
              <mml:math id="M184">
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Pr</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="bold">start</mml:mtext>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mstyle>
                          <mml:mo>∣</mml:mo>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>start</mml:mtext>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>f</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext mathvariant="bold">start</mml:mtext>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ξ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Multi</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:munderover>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext mathvariant="bold">start</mml:mtext>
                              </mml:mrow>
                            </mml:munderover>
                          </mml:mstyle>
                          <mml:mo>;</mml:mo>
                          <mml:munderover>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>start</mml:mtext>
                            </mml:mrow>
                          </mml:munderover>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>f</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext mathvariant="bold">start</mml:mtext>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>+</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ξ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>−</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>δ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ25.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ26">
            <label>(26)</label>
            <alternatives>
              <tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \begin{aligned}  \Pr&amp;\left(\mathbf{n_{r}^{s1}}\mid N_{r}^{s1}, \boldsymbol{\mathbf{f_{r}^{\textbf{\,start}}}}, \boldsymbol{\mathbf{\pi_{r}^{s1}}}, \boldsymbol{\mathbf{\xi_{r}}}\right) = \\ &amp; \operatorname{Multi}\left(\mathbf{n_{r}^{s1}}; N_{r}^{s1}, \frac{\boldsymbol{\mathbf{f_{r}^{\textbf{\,start}}}}\circ \boldsymbol{\mathbf{\pi_{r}^{s1}}}}{\boldsymbol{\mathbf{f_{r}^{\textbf{\,start}}}}\cdot \boldsymbol{\mathbf{\pi_{r}^{s1}}}} + \boldsymbol{\mathbf{\xi_{r}}}- \boldsymbol{\mathbf{\delta_{r}}}\right) \end{aligned}  $$
\end{document}</tex-math>
              <mml:math id="M186">
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Pr</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mstyle>
                          <mml:mo>∣</mml:mo>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>f</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext mathvariant="bold">start</mml:mtext>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ξ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Multi</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:munderover>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:munderover>
                          </mml:mstyle>
                          <mml:mo>;</mml:mo>
                          <mml:munderover>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:munderover>
                          <mml:mo>,</mml:mo>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mstyle mathvariant="bold">
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>f</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext mathvariant="bold">start</mml:mtext>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mstyle>
                              </mml:mstyle>
                              <mml:mo>∘</mml:mo>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mstyle mathvariant="bold">
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>π</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mstyle>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mstyle mathvariant="bold">
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>f</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext mathvariant="bold">start</mml:mtext>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mstyle>
                              </mml:mstyle>
                              <mml:mo>·</mml:mo>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mstyle mathvariant="bold">
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>π</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mstyle>
                              </mml:mstyle>
                            </mml:mrow>
                          </mml:mfrac>
                          <mml:mo>+</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ξ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>−</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>δ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ26.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ27">
            <label>(27)</label>
            <alternatives>
              <tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$${} \begin{aligned}  \Pr&amp;\left(\mathbf{n_{r}^{s2}}\mid N_{r}^{s2}, \boldsymbol{\mathbf{f_{r}^{\textbf{\,start}}}}, \boldsymbol{\mathbf{\pi_{r}^{s1}}}, \boldsymbol{\mathbf{\Delta\pi_{r}}}, \boldsymbol{\mathbf{\xi_{r}}}\right) = \\ &amp; \operatorname{Multi}\left(\mathbf{n_{r}^{s2}}; N_{r}^{s2}, \frac{\boldsymbol{\mathbf{f_{r}^{\textbf{\,start}}}}\circ \left(\boldsymbol{\mathbf{\Delta\pi_{r}}} + \boldsymbol{\mathbf{\pi_{r}^{s1}}}\right)}{\boldsymbol{\mathbf{f_{r}^{\textbf{\,start}}}}\cdot \left(\boldsymbol{\mathbf{\Delta\pi_{r}}} + \boldsymbol{\mathbf{\pi_{r}^{s1}}}\right)} + \boldsymbol{\mathbf{\xi_{r}}}- \boldsymbol{\mathbf{\delta_{r}}}\right) \end{aligned}  $$
\end{document}</tex-math>
              <mml:math id="M188">
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Pr</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mstyle>
                          <mml:mo>∣</mml:mo>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>f</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext mathvariant="bold">start</mml:mtext>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:mi>Δ</mml:mi>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>,</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ξ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Multi</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:munderover>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>r</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:munderover>
                          </mml:mstyle>
                          <mml:mo>;</mml:mo>
                          <mml:munderover>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:munderover>
                          <mml:mo>,</mml:mo>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mstyle mathvariant="bold">
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>f</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext mathvariant="bold">start</mml:mtext>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mstyle>
                              </mml:mstyle>
                              <mml:mo>∘</mml:mo>
                              <mml:mfenced close=")" open="(" separators="">
                                <mml:mrow>
                                  <mml:mstyle mathvariant="bold-italic">
                                    <mml:mstyle mathvariant="bold">
                                      <mml:mi>Δ</mml:mi>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mi>π</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>r</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mstyle>
                                  </mml:mstyle>
                                  <mml:mo>+</mml:mo>
                                  <mml:mstyle mathvariant="bold-italic">
                                    <mml:mstyle mathvariant="bold">
                                      <mml:msubsup>
                                        <mml:mrow>
                                          <mml:mi>π</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>r</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>s</mml:mi>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                      </mml:msubsup>
                                    </mml:mstyle>
                                  </mml:mstyle>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mstyle mathvariant="bold">
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>f</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mtext mathvariant="bold">start</mml:mtext>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mstyle>
                              </mml:mstyle>
                              <mml:mo>·</mml:mo>
                              <mml:mfenced close=")" open="(" separators="">
                                <mml:mrow>
                                  <mml:mstyle mathvariant="bold-italic">
                                    <mml:mstyle mathvariant="bold">
                                      <mml:mi>Δ</mml:mi>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mi>π</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>r</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mstyle>
                                  </mml:mstyle>
                                  <mml:mo>+</mml:mo>
                                  <mml:mstyle mathvariant="bold-italic">
                                    <mml:mstyle mathvariant="bold">
                                      <mml:msubsup>
                                        <mml:mrow>
                                          <mml:mi>π</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>r</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>s</mml:mi>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                      </mml:msubsup>
                                    </mml:mstyle>
                                  </mml:mstyle>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                          </mml:mfrac>
                          <mml:mo>+</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ξ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>−</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>δ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ27.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>where we have assumed that the probability that a site experiences a mutation and an error in the same molecule is negligibly small.</p>
      </sec>
      <sec id="Sec19">
        <title>Priors over the unknown parameters</title>
        <p>We specify Dirichlet priors over the parameter vectors:
<disp-formula id="Equ28"><label>(28)</label><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{@{}rcl@{}} \Pr\left(\boldsymbol{\mathbf{\pi_{r}^{s1}}}\right) = \operatorname{Dirichlet}\left(\boldsymbol{\mathbf{\pi_{r}^{s1}}}; \alpha_{\pi^{s1}} \times \mathbf{1}\right) \end{array} $$
\end{document}</tex-math><mml:math id="M190"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mo>Pr</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mstyle></mml:mstyle></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>Dirichlet</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:munderover><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mstyle></mml:mstyle><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_590_Equ28.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>
          <disp-formula id="Equ29">
            <label>(29)</label>
            <alternatives>
              <tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{@{}rcl@{}}  \Pr\left(\boldsymbol{\mathbf{\xi_{r}}}\right) = \operatorname{Dirichlet}\left(\boldsymbol{\mathbf{\xi_{r}}}; \alpha_{\xi} \times \mathcal{N}_{x} \times \boldsymbol{\mathbf{a_{r,\xi}}}\right) \end{array} $$
\end{document}</tex-math>
              <mml:math id="M192">
                <mml:mtable class="eqnarray" columnalign="left center right">
                  <mml:mtr>
                    <mml:mtd class="eqnarray-1">
                      <mml:mo>Pr</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ξ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>=</mml:mo>
                      <mml:mo>Dirichlet</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ξ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>;</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>ξ</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>×</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi mathvariant="script">N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>×</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>a</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>ξ</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ29.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equa">
            <alternatives>
              <tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{@{}rcl@{}}  \Pr\left(\boldsymbol{\mathbf{f_{r}^{\,\textbf{start}}}}\right) = \notag \end{array} $$
\end{document}</tex-math>
              <mml:math id="M194">
                <mml:mtable class="eqnarray" columnalign="left center right">
                  <mml:mtr>
                    <mml:mtd class="eqnarray-1">
                      <mml:mo>Pr</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:munderover accent="false" accentunder="false">
                                <mml:mrow>
                                  <mml:mi>f</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mspace width="0.3em"/>
                                  <mml:mtext mathvariant="bold">start</mml:mtext>
                                </mml:mrow>
                              </mml:munderover>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                    <mml:mtd class="eqnarray-2"/>
                    <mml:mtd class="eqnarray-3"/>
                    <mml:mtd>
                      <mml:mtext/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equa.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ30">
            <label>(30)</label>
            <alternatives>
              <tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{@{}rcl@{}} \quad\;\operatorname{Dirichlet}\left(\boldsymbol{\mathbf{f_{r}^{\,\textbf{start}}}}; \alpha_{\text{start}} \times \mathcal{N}_{x} \times \boldsymbol{\mathbf{a_{r,\textbf{start}}}}\right)~~~~ \end{array} $$
\end{document}</tex-math>
              <mml:math id="M196">
                <mml:mtable class="eqnarray" columnalign="left center right">
                  <mml:mtr>
                    <mml:mtd class="eqnarray-1">
                      <mml:mspace width="1em"/>
                      <mml:mspace width="2.77626pt"/>
                      <mml:mo>Dirichlet</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:munderover>
                                <mml:mrow>
                                  <mml:mi>f</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mspace width="0.3em"/>
                                  <mml:mtext mathvariant="bold">start</mml:mtext>
                                </mml:mrow>
                              </mml:munderover>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>;</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>start</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>×</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi mathvariant="script">N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>×</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>a</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mtext mathvariant="bold">start</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mspace width="1em"/>
                      <mml:mspace width="1em"/>
                      <mml:mspace width="1em"/>
                      <mml:mspace width="1em"/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ30.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ31">
            <label>(31)</label>
            <alternatives>
              <tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \begin{aligned} \Pr&amp;\left(\boldsymbol{\mathbf{\Delta\pi_{r}}} \mid \boldsymbol{\mathbf{\pi_{r}^{s1}}}\right) = \\ &amp; \operatorname{Dirichlet}\left(\boldsymbol{\mathbf{\Delta\pi_{r}}}; \alpha_{\Delta\pi} \times \mathcal{N}_{x} \times \boldsymbol{\mathbf{\pi_{r}^{s1}}}\right) - \boldsymbol{\mathbf{\pi_{r}^{s1}}} \end{aligned}  $$
\end{document}</tex-math>
              <mml:math id="M198">
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Pr</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:mi>Δ</mml:mi>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>∣</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>=</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>Dirichlet</mml:mo>
                      <mml:mfenced close=")" open="(" separators="">
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:mi>Δ</mml:mi>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mstyle>
                          </mml:mstyle>
                          <mml:mo>;</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>Δπ</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>×</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi mathvariant="script">N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>×</mml:mo>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mstyle mathvariant="bold">
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mstyle>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo>−</mml:mo>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mstyle mathvariant="bold">
                          <mml:munderover>
                            <mml:mrow>
                              <mml:mi>π</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:munderover>
                        </mml:mstyle>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ31.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>where dms_tools by default sets all the scalar concentration parameters (<italic>α</italic>’s) to one except <italic>α</italic>
<sub><italic>Δ</italic><italic>π</italic></sub>, which is set to two corresponding to a weak expectation that the <italic>Δ</italic>
<italic>π</italic> values are close to zero. The average error rate <inline-formula id="IEq68"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\overline {\xi _{m}}$
\end{document}</tex-math><mml:math id="M200"><mml:mover accent="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_590_IEq68.gif"/></alternatives></inline-formula> for mutations with <italic>m</italic> nucleotide changes is</p>
        <p>
          <disp-formula id="Equ32">
            <label>(32)</label>
            <alternatives>
              <tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \overline{\xi_{m}} = \frac{1}{L}\sum\limits_{r} \frac{1}{N_{r}^{\text{err}}}\sum\limits_{x} n_{r,x}^{\text{err}}\times \delta_{m,D_{x,\operatorname{wt}\left(r\right)}},  $$
\end{document}</tex-math>
              <mml:math id="M202">
                <mml:mover accent="false">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ξ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo accent="true">¯</mml:mo>
                </mml:mover>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>L</mml:mi>
                  </mml:mrow>
                </mml:mfrac>
                <mml:munder>
                  <mml:mrow>
                    <mml:mo>∑</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                </mml:munder>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>err</mml:mtext>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mrow>
                </mml:mfrac>
                <mml:munder>
                  <mml:mrow>
                    <mml:mo>∑</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                </mml:munder>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext>err</mml:mtext>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>×</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>δ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mo>wt</mml:mo>
                        <mml:mfenced close=")" open="(" separators="">
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
              </mml:math>
              <graphic xlink:href="12859_2015_590_Equ32.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>and so
<disp-formula id="Equ33"><label>(33)</label><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \boldsymbol{\mathbf{a_{r,\xi}}} = \left(\cdots, \sum\limits_{m} \frac{\overline{\xi}_{m}}{\mathcal{C}_{m}} \times \delta_{m,D_{x,\operatorname{wt}\left(r\right)}},\cdots\right).  $$
\end{document}</tex-math><mml:math id="M204"><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>ξ</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2015_590_Equ33.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>Our prior assumption is that all mutations are at equal frequency in the starting library (this assumption is unlikely to be true if the starting library has already been subjected to some selection, but we lack a rationale for a more informative prior). The average mutation frequency in the starting library is
<disp-formula id="Equ34"><label>(34)</label><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \overline{f^{\text{start}}} = \left(\frac{1}{L}\sum\limits_{r} \frac{1}{N_{r}^{\text{start}}}\sum\limits_{x\ne \operatorname{wt}\left(r\right)} n_{r,x}^{\text{start}}\right) - \sum\limits_{m \ge 1} \overline{\xi_{m}},  $$
\end{document}</tex-math><mml:math id="M206"><mml:mover accent="false"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>start</mml:mtext></mml:mrow></mml:msup></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>start</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>≠</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>start</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mover accent="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2015_590_Equ34.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>and so
<disp-formula id="Equ35"><label>(35)</label><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \boldsymbol{\mathbf{a_{r,\textbf{start}}}}= \left(\cdots, \frac{\overline{f^{\text{start}}}}{\mathcal{N}_{x} - 1} + \delta_{x,\operatorname{wt}\left(r\right)} \times \left[1 - \overline{f^{\text{start}}}\right],\cdots\right).  $$
\end{document}</tex-math><mml:math id="M208"><mml:mstyle mathvariant="bold-italic"><mml:mstyle mathvariant="bold"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mtext mathvariant="bold">start</mml:mtext></mml:mrow></mml:msub></mml:mstyle></mml:mstyle><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="false"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>start</mml:mtext></mml:mrow></mml:msup></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mo>wt</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mover accent="false"><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>start</mml:mtext></mml:mrow></mml:msup></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2015_590_Equ35.gif" position="anchor"/></alternatives></disp-formula>
</p>
      </sec>
      <sec id="Sec20">
        <title>Implementation</title>
        <p>The program dms_inferdiffprefs in the dms_
tools package infers the differential preferences by performing MCMC over the posterior defined by the product of the likelihoods and priors in Equations <xref rid="Equ24" ref-type="">24</xref>, <xref rid="Equ25" ref-type="">25</xref>, <xref rid="Equ26" ref-type="">26</xref>, <xref rid="Equ27" ref-type="">27</xref>, <xref rid="Equ28" ref-type="">28</xref>, <xref rid="Equ29" ref-type="">29</xref>, <xref rid="Equ30" ref-type="">30</xref>, and <xref rid="Equ31" ref-type="">31</xref>. The MCMC is performed as described for the preferences, and characters can again be any of nucleotides, amino acids, or codons. The program dms_logoplot visualizes the posterior mean differential preferences via an extension to weblogo [<xref ref-type="bibr" rid="CR34">34</xref>]. In addition, dms_inferdiffprefs creates text files that give the posterior probability that <italic>Δ</italic>
<italic>π</italic>
<sub><italic>r</italic>,<italic>x</italic></sub>&gt;0 or &lt;0. These posterior probabilities are <italic>not</italic> corrected to account for the fact that multiple sites are typically being examined, although by default the inferences are made using the regularizing prior in Equation <xref rid="Equ31" ref-type="">31</xref>.</p>
      </sec>
    </sec>
    <sec id="Sec21">
      <title>Inferring differential preference with dms_tools</title>
      <p>To test the accuracy of differential preference inference by dms_tools, I simulated an experiment like that in Figure <xref rid="Fig1" ref-type="fig">1</xref>B with the starting counts based on Melnikov <italic>et al.</italic>’s actual deep mutational scanning data of a Tn5 transposon [<xref ref-type="bibr" rid="CR10">10</xref>]. As shown by Figure <xref rid="Fig5" ref-type="fig">5</xref>, dms_inferdiffprefs accurately infers the differential preferences at typical experimental depths. The results are easily visualized with dms_logoplot. To provide a second illustration of differential preferences, Figure <xref rid="Fig6" ref-type="fig">6</xref> shows an analysis of the data obtained by Wu <italic>et al.</italic> when they performed an experiment like that in Figure <xref rid="Fig1" ref-type="fig">1</xref>B on nucleotide mutants of the influenza NS gene in the presence or absence of interferon treatment.
<fig id="Fig6"><label>Figure 6</label><caption><p>Differential preferences following selection of influenza NS1 in the presence or absence of interferon. Wu <italic>et al.</italic> [<xref ref-type="bibr" rid="CR13">13</xref>] generated libraries of influenza viruses carrying nucleotide mutations in the NS segment. They passaged these viruses in the presence or absence of interferon pre-treatment. Here, dms_tools was used to analyze and visualize the data to identify sites where different nucleotides are preferred in the presence versus the absence of interferon. Because the mutations were made at the nucleotide level, the data must also be analyzed at that level (unlike in Figures <xref rid="Fig2" ref-type="fig">2</xref>, <xref rid="Fig3" ref-type="fig">3</xref>, and <xref rid="Fig5" ref-type="fig">5</xref>, where codon mutagenesis means that the data can be analyzed at the amino-acid level). The plot can be generated as logoplot.pdf with the following commands:<inline-graphic xlink:href="12859_2015_590_Figg_HTML.gif" id="d30e7403"/>.</p></caption><graphic xlink:href="12859_2015_590_Fig6_HTML" id="MO6"/></fig>
</p>
    </sec>
  </sec>
  <sec id="Sec22" sec-type="conclusion">
    <title>Conclusions</title>
    <p>
dms_tools is a freely available software package that uses a statistically principled approach to analyze deep mutational scanning data. This paper shows that dms_tools accurately infers preferences and differential preferences from data simulated under realistic parameters. As the figures illustrate, dms_tools can also be applied to actual data with a few simple commands. The intuitive visualizations created by dms_tools assist in interpreting the results. As deep mutational scanning continues to proliferate as an experimental technique [<xref ref-type="bibr" rid="CR1">1</xref>], dms_tools can be applied to analyze the data for purposes such as guiding protein engineering [<xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR10">10</xref>], understanding sequence-structure-function relationships [<xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR21">21</xref>], informing the development of better evolutionary models for sequence analysis [<xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR25">25</xref>], and probing the biology of viruses and cells [<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR11">11</xref>-<xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR18">18</xref>].</p>
  </sec>
  <sec id="Sec23">
    <title>Availability and requirements</title>
    <p>
      <list list-type="bullet">
        <list-item>
          <p><bold>Project name:</bold>
dms_tools
</p>
        </list-item>
        <list-item>
          <p>
            <bold>Project home page:</bold>
            <list list-type="bullet">
              <list-item>
                <p>Documentation and installation instructions: <ext-link ext-link-type="uri" xlink:href="http://jbloom.github.io/dms_tools/">http://jbloom.github.io/dms_tools/</ext-link>
</p>
              </list-item>
              <list-item>
                <p>Source code: <ext-link ext-link-type="uri" xlink:href="https://github.com/jbloom/dms_tools">https://github.com/jbloom/dms_tools</ext-link>
</p>
              </list-item>
            </list>
          </p>
        </list-item>
        <list-item>
          <p><bold>Operating system(s):</bold> Linux</p>
        </list-item>
        <list-item>
          <p><bold>Programming language:</bold>
Python
</p>
        </list-item>
        <list-item>
          <p><bold>Other requirements:</bold>
pystan, weblogo
</p>
        </list-item>
        <list-item>
          <p><bold>License:</bold> GNU GPLv3</p>
        </list-item>
        <list-item>
          <p><bold>Restrictions to use by non-academics:</bold> None</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec id="Sec24">
    <title>Data and code for figures in this paper</title>
    <p>The data and computer code used to generate the figures are in version 1.01 of the dms_tools source code (which is tagged on Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/jbloom/dms_tools/tree/1.0.1">https://github.com/jbloom/dms_tools/tree/1.0.1</ext-link>) in the examples subdirectory. The LaTex source for this paper is in the paper subdirectory.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The author declares that he has no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>JDB designed the algorithms, wrote the software, performed the analyses, and wrote the paper.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Thanks to Alec Heckert for assistance in testing dms_tools, to Erick Matsen for the excellent suggestion to use pystan for MCMC, to Nicholas Wu for providing the mutational counts data from [<xref ref-type="bibr" rid="CR13">13</xref>], and to Orr Ashenberg and Hugh Haddox for helpful comments on the manuscript. This work was supported by the NIGMS of the NIH under grant R01GM102198.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fowler</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Deep mutational scanning: a new style of protein science</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>8</issue>
        <fpage>801</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3027</pub-id>
        <pub-id pub-id-type="pmid">25075907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fowler</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Araya</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Fleishman</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Kellogg</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Stephany</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-resolution mapping of protein sequence-function relationships</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>9</issue>
        <fpage>741</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1492</pub-id>
        <pub-id pub-id-type="pmid">20711194</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Traxlmayr</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Hasenhindl</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hackl</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stadlmayr</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rybka</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Borth</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Construction of a stability landscape of the CH3 domain of human IgG1 by combining directed evolution with high throughput sequencing</article-title>
        <source>J Mol Biol.</source>
        <year>2012</year>
        <volume>423</volume>
        <fpage>397</fpage>
        <lpage>412</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2012.07.017</pub-id>
        <pub-id pub-id-type="pmid">22846908</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLaughlin Jr</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Poelwijk</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Raman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gosal</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Ranganathan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The spatial architecture of protein function and adaptation</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>491</volume>
        <issue>7422</issue>
        <fpage>138</fpage>
        <pub-id pub-id-type="doi">10.1038/nature11500</pub-id>
        <pub-id pub-id-type="pmid">23041932</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Starita</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Pruneda</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Fowler</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Hiatt</surname>
            <given-names>JB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Activity-enhancing mutations in an E3 ubiquitin ligase identified by high-throughput mutagenesis</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2013</year>
        <volume>110</volume>
        <issue>14</issue>
        <fpage>1263</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1303309110</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Melamed</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Gamble</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Deep mutational scanning of an RRM domain of the <italic>Saccharomyces cerevisiae</italic> poly (A)-binding protein</article-title>
        <source>RNA</source>
        <year>2013</year>
        <volume>19</volume>
        <issue>11</issue>
        <fpage>1537</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.040709.113</pub-id>
        <pub-id pub-id-type="pmid">24064791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roscoe</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Thayer</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Zeldovich</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Fushman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bolon</surname>
            <given-names>DN</given-names>
          </name>
        </person-group>
        <article-title>Analyses of the effects of all ubiquitin point mutants on yeast growth rate</article-title>
        <source>J Mol Biol.</source>
        <year>2013</year>
        <volume>425</volume>
        <fpage>1363</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2013.01.032</pub-id>
        <pub-id pub-id-type="pmid">23376099</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Firnberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Labonte</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Ostermeier</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive, high-resolution map of a gene’s fitness landscape</article-title>
        <source>Mol Biol Evol</source>
        <year>2014</year>
        <volume>31</volume>
        <issue>6</issue>
        <fpage>1581</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msu081</pub-id>
        <pub-id pub-id-type="pmid">24567513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bloom</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>An experimentally determined evolutionary model dramatically improves phylogenetic fit</article-title>
        <source>Mol Biol Evol</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1956</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msu173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Melnikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rogov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>TS</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive mutational scanning of a kinase <italic>in vivo</italic> reveals context-dependent fitness landscapes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>112</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku511</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thyagarajan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bloom</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>The inherent mutational tolerance and antigenic evolvability of influenza hemagglutinin</article-title>
        <source>eLife</source>
        <year>2014</year>
        <volume>3</volume>
        <fpage>03300</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.03300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Al-Mawsawi</surname>
            <given-names>LQ</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-throughput profiling of influenza A virus hemagglutinin gene at single-nucleotide resolution</article-title>
        <source>Sci Rep</source>
        <year>2014</year>
        <volume>4</volume>
        <fpage>4942</fpage>
        <pub-id pub-id-type="pmid">24820965</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Al-Mawsawi</surname>
            <given-names>LQ</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-throughput identification of loss-of-function mutations for anti-interferon activity in the influenza A virus NS segment</article-title>
        <source>J Virol</source>
        <year>2014</year>
        <volume>88</volume>
        <issue>17</issue>
        <fpage>10157</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1128/JVI.01494-14</pub-id>
        <pub-id pub-id-type="pmid">24965464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olson</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive biophysical description of pairwise epistasis throughout an entire protein domain</article-title>
        <source>Curr Biol</source>
        <year>2014</year>
        <volume>24</volume>
        <issue>22</issue>
        <fpage>2643</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2014.09.072</pub-id>
        <pub-id pub-id-type="pmid">25455030</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kitzman</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Starita</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Massively parallel single-amino-acid mutagenesis</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>203</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3223</pub-id>
        <pub-id pub-id-type="pmid">25559584</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Firnberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ostermeier</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>PFunkel: efficient, expansive, user-defined mutagenesis</article-title>
        <source>PLoS One</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>52031</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0052031</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Varadarajan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A rapid, efficient, and economical inverse polymerase chain reaction-based method for generating a site saturation mutant library</article-title>
        <source>Anal Biochem</source>
        <year>2014</year>
        <volume>449</volume>
        <fpage>90</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ab.2013.12.002</pub-id>
        <pub-id pub-id-type="pmid">24333246</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Findlay</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Boyle</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Hause</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Saturation editing of genomic regions by multiplex homology-directed repair</article-title>
        <source>Nat</source>
        <year>2014</year>
        <volume>513</volume>
        <issue>7516</issue>
        <fpage>120</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13695</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fowler</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Araya</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Gerard</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Enrich: software for analysis of protein function by enrichment and depletion of variants</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>24</issue>
        <fpage>3430</fpage>
        <lpage>1</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr577</pub-id>
        <pub-id pub-id-type="pmid">22006916</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bank</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hietpas</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bolon</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>A bayesian mcmc approach to assess the complete distribution of fitness effects of new mutations: uncovering the potential for adaptive walks in challenging environments</article-title>
        <source>Genet</source>
        <year>2014</year>
        <volume>196</volume>
        <issue>3</issue>
        <fpage>841</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.113.156190</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Araya</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Fowler</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Muniez</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kelly</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A fundamental protein property, thermodynamic stability, revealed solely from large-scale measurements of protein function</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>42</issue>
        <fpage>16858</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1209751109</pub-id>
        <pub-id pub-id-type="pmid">23035249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bank</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hietpas</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Bolon</surname>
            <given-names>DN</given-names>
          </name>
        </person-group>
        <article-title>A systematic survey of an intragenic epistatic landscape</article-title>
        <source>Mol Biol Evol</source>
        <year>2015</year>
        <volume>32</volume>
        <issue>1</issue>
        <fpage>229</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msu301</pub-id>
        <pub-id pub-id-type="pmid">25371431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hiatt</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Patwardhan</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Parallel, tag-directed assembly of locally derived short sequence reads</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>2</issue>
        <fpage>119</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1416</pub-id>
        <pub-id pub-id-type="pmid">20081835</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>De La Cruz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Al-Mawsawi</surname>
            <given-names>LQ</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Luan</surname>
            <given-names>HH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HIV-1 quasispecies delineation by tag linkage deep sequencing</article-title>
        <source>PloS one</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>5</issue>
        <fpage>97505</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0097505</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bloom</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>An experimentally informed evolutionary model improves phylogenetic fit to divergent lactamase homologs</article-title>
        <source>Mol Biol Evol</source>
        <year>2014</year>
        <volume>31</volume>
        <fpage>2753</fpage>
        <lpage>769</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msu220</pub-id>
        <pub-id pub-id-type="pmid">25063439</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yampolsky</surname>
            <given-names>LY</given-names>
          </name>
          <name>
            <surname>Stoltzfus</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The exchangeability of amino acids in proteins</article-title>
        <source>Genet</source>
        <year>2005</year>
        <volume>170</volume>
        <issue>4</issue>
        <fpage>1459</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.104.039107</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoltzfus</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yampolsky</surname>
            <given-names>LY</given-names>
          </name>
        </person-group>
        <article-title>Climbing mount probable: mutation as a cause of nonrandomness in evolution</article-title>
        <source>J Hered</source>
        <year>2009</year>
        <volume>100</volume>
        <issue>5</issue>
        <fpage>637</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1093/jhered/esp048</pub-id>
        <pub-id pub-id-type="pmid">19625453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pearson</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Mathematical contributions to the theory of evolution. On a form of spurious correlation which may arise when indices are used in the measurement of organs</article-title>
        <source>Proc Royal Society London</source>
        <year>1896</year>
        <volume>60</volume>
        <issue>359–367</issue>
        <fpage>489</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1098/rspl.1896.0076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pearson</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>On the constants of index-distributions as deduced from the like constants for the components of the ratio, with special reference to the opsonic index</article-title>
        <source>Biometrika</source>
        <year>1910</year>
        <volume>7</volume>
        <issue>4</issue>
        <fpage>531</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/7.4.531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ogliore</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huss</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Nagashima</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Ratio estimation in SIMS analysis</article-title>
        <source>Nuclear instruments and methods in physics research section B: beam interactions with materials and atoms</source>
        <year>2011</year>
        <volume>269</volume>
        <issue>17</issue>
        <fpage>1910</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1016/j.nimb.2011.04.120</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Kempen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Van Vliet</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Mean and variance of ratio estimators used in fluorescence ratio imaging</article-title>
        <source>Cytometry</source>
        <year>2000</year>
        <volume>39</volume>
        <issue>4</issue>
        <fpage>300</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1097-0320(20000401)39:4&lt;300::AID-CYTO8&gt;3.0.CO;2-O</pub-id>
        <pub-id pub-id-type="pmid">10738283</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <mixed-citation publication-type="other">Stan Development Team. PyStan: the Python interface to Stan, Version 2.5.0. 2014. <ext-link ext-link-type="uri" xlink:href="http://mc-stan.org/pystan.html">http://mc-stan.org/pystan.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Inference from iterative simulation using multiple sequences</article-title>
        <source>Stat Sci</source>
        <year>1992</year>
        <volume>7</volume>
        <fpage>457</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1214/ss/1177011136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crooks</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Hon</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chandonia</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <article-title>Weblogo: a sequence logo generator</article-title>
        <source>Genome Res</source>
        <year>2004</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>1188</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.849004</pub-id>
        <pub-id pub-id-type="pmid">15173120</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blainey</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Krzywinski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Altman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Points of significance: replication</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>9</issue>
        <fpage>879</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3091</pub-id>
        <pub-id pub-id-type="pmid">25317452</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shortle</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Genetic analysis of staphylococcal nuclease: identification of three intragenic “global” suppressors of nuclease-minus mutations</article-title>
        <source>Genet</source>
        <year>1985</year>
        <volume>110</volume>
        <fpage>539</fpage>
        <lpage>55</lpage>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rennell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bouvier</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Hardy</surname>
            <given-names>LW</given-names>
          </name>
          <name>
            <surname>Poteete</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Systematic mutation of bacteriophage T4 lysozyme</article-title>
        <source>J Mol Biol</source>
        <year>1991</year>
        <volume>222</volume>
        <fpage>67</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-2836(91)90738-R</pub-id>
        <pub-id pub-id-type="pmid">1942069</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafikhani</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Siegel</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Ferrari</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schellenberger</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Generation of large libraries of random mutants in <italic>Bacillus subtilis</italic> by PCR-based plasmid multimerization</article-title>
        <source>Biotechniques</source>
        <year>1997</year>
        <volume>23</volume>
        <fpage>304</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">9266088</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Choe</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Loeb</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Protein tolerance to random amino acid change</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2004</year>
        <volume>101</volume>
        <fpage>9205</fpage>
        <lpage>210</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0403255101</pub-id>
        <pub-id pub-id-type="pmid">15197260</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bloom</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Silberg</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Wilke</surname>
            <given-names>CO</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Adami</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Arnold</surname>
            <given-names>FH</given-names>
          </name>
        </person-group>
        <article-title>Thermodynamic prediction of protein neutrality</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>606</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0406744102</pub-id>
        <pub-id pub-id-type="pmid">15644440</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
