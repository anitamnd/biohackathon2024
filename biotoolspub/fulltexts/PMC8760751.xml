<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8760751</article-id>
    <article-id pub-id-type="publisher-id">582</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-022-00582-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LEADD: Lamarckian evolutionary algorithm for de novo drug design</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kerstjens</surname>
          <given-names>Alan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4450-7677</contrib-id>
        <name>
          <surname>De Winter</surname>
          <given-names>Hans</given-names>
        </name>
        <address>
          <email>hans.dewinter@uantwerpen.be</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.5284.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 0790 3681</institution-id><institution>Department of Pharmaceutical Sciences, Faculty of Pharmaceutical, Biomedical and Veterinary Sciences, </institution><institution>University of Antwerp, </institution></institution-wrap>Universiteitsplein 1A, 2610 Wilrijk, Belgium </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>3</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>11</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <title>Graphical Abstract</title>
      <p id="Par1">Given an objective function that predicts key properties of a molecule, goal-directed de novo molecular design is a useful tool to identify molecules that maximize or minimize said objective function. Nonetheless, a common drawback of these methods is that they tend to design synthetically unfeasible molecules. In this paper we describe a Lamarckian evolutionary algorithm for de novo drug design (LEADD). LEADD attempts to strike a balance between optimization power, synthetic accessibility of designed molecules and computational efficiency. To increase the likelihood of designing synthetically accessible molecules, LEADD represents molecules as graphs of molecular fragments, and limits the bonds that can be formed between them through knowledge-based pairwise atom type compatibility rules. A reference library of drug-like molecules is used to extract fragments, fragment preferences and compatibility rules. A novel set of genetic operators that enforce these rules in a computationally efficient manner is presented. To sample chemical space more efficiently we also explore a Lamarckian evolutionary mechanism that adapts the reproductive behavior of molecules. LEADD has been compared to both standard virtual screening and a comparable evolutionary algorithm using a standardized benchmark suite and was shown to be able to identify fitter molecules more efficiently. Moreover, the designed molecules are predicted to be easier to synthesize than those designed by other evolutionary algorithms.</p>
      <p>
        <graphic position="anchor" xlink:href="13321_2022_582_Figa_HTML" id="MO1"/>
      </p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13321-022-00582-y.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>De novo drug design</kwd>
      <kwd>Evolutionary algorithm</kwd>
      <kwd>Synthetic accessibility</kwd>
      <kwd>Fragment-based</kwd>
      <kwd>Graph-based</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003130</institution-id>
            <institution>Fonds Wetenschappelijk Onderzoek</institution>
          </institution-wrap>
        </funding-source>
        <award-id>39461</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kerstjens</surname>
            <given-names>Alan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par15">Many computational drug discovery projects employ virtual objective functions (also termed fitness or scoring functions) to predict a molecule’s properties of interest, including its biological activity. In virtual screening (VS) one evaluates the objective function for all molecules in a virtual library to find the most promising ones. Commonly the molecules being screened are either commercially available [<xref ref-type="bibr" rid="CR1">1</xref>] or predicted to be easy to synthesize [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>], enabling a fast transition from in silico to in vitro studies.</p>
    <p id="Par16">However, given that even the largest virtual libraries [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR4">4</xref>] dwarf in size compared to drug-like chemical space, which is commonly cited to contain somewhere between 10<sup>23</sup> and 10<sup>60</sup> [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>], it’s unlikely that the library will contain the most active molecules possible. Preferences for certain chemotypes and synthetic reactions [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>] often make their way to virtual libraries, leading to a small and non-uniform coverage of chemical space [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. This, coupled to the fact that publicly available libraries may have been screened previously or even contain patent-protected molecules, raises concerns about a lack of chemical novelty. Last but not least, the enumeration, storage, maintenance and screening of virtual libraries is a resource intensive process.</p>
    <p id="Par17">Computational de novo drug design (DNDD), that is, the computational design of molecules without a problem-relevant molecular starting point, has the potential to solve some of these problems. The traditional approach to DNDD [<xref ref-type="bibr" rid="CR12">12</xref>], sometimes termed goal-directed design [<xref ref-type="bibr" rid="CR13">13</xref>], is the progressive construction or modification of a molecule to optimize the value of a fitness function, according to some optimization algorithm. While this approach can succeed at finding highly fit molecules efficiently, if applied naively the designed molecules tend to be hard to synthesize [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. Different solutions have been applied to tackle this problem.</p>
    <p id="Par18">Some solutions revolve around the use of synthetic accessibility (SA) metrics. These metrics may have to be calculated many times throughout the design process, often limiting the user to rather crude rules [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] or heuristics [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref>] and precluding the use of more reliable retrosynthetic analyses [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Post-hoc filtering [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>], while simple and modular, is computationally inefficient as it might discard solutions in which significant amounts of costs were already sunk. Employing the SA descriptors as a heuristic score bias instead [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] can partially solve this problem. However, both approaches create hard or soft boundaries within the search space respectively. Given that the fitness landscape of a typical drug discovery project can be very rugged, this may impede the discovery of good solutions. Alternatively, one may attempt to optimize both the fitness and SA simultaneously with multi-objective optimization algorithms [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]. Since these objectives may counteract each other, the algorithm attempts to find suitable compromises between them, but it’s the decision-maker’s responsibility to define which balances are desired or acceptable.</p>
    <p id="Par19">A second group of approaches attempts to incorporate some chemical awareness into the design algorithm itself. Ways of achieving this include fragmentation/recombination rules [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>] and simulating virtual chemical reactions [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref>]. These have the advantage of considering SA implicitly as part of the molecular construction process. The likelihood of such an algorithm succeeding at designing SA molecules depends on how well it captures chemical reality. Typically, the better a construction scheme resembles organic synthesis, the higher the SA of the designed molecules, but also the computational cost to find them. Reducing the number of bonds created by the algorithm, for instance by using predefined multi-atomic molecular fragments, can be an effective way of increasing the SA of designed molecules while avoiding expensive construction schemes.</p>
    <p id="Par20">More recently, generative models such as variational autoencoders [<xref ref-type="bibr" rid="CR31">31</xref>], recurrent neural networks [<xref ref-type="bibr" rid="CR32">32</xref>] and generative adversarial networks [<xref ref-type="bibr" rid="CR33">33</xref>] have been applied to DNDD. When trained on datasets of molecules with some desirable properties, including synthesizability, these models can suggest new molecules with similar properties. These technologies have shown great promise in designing synthetically feasible molecules [<xref ref-type="bibr" rid="CR14">14</xref>]. However, the amount of available training data can hamper the approach.</p>
    <p id="Par21">In this paper we describe LEADD, an evolutionary algorithm (EA) for de novo drug design and optimization. EAs have a rich history of being applied to DNDD [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR39">39</xref>]. They draw inspiration from Darwinian evolution and natural selection, stochastically breeding a population of solutions through the use of genetic operators (i.e. mutation and crossover). Over the course of generations, the objective function exerts selective pressure on the population driving it towards optimality.</p>
    <p id="Par22">LEADD designs molecules as combinations of molecular fragments, bonded according to the topology of a graph. Knowledge-based atom pair compatibility rules, defining which fragments can be bonded and how, are enforced by a novel set of genetic operators. Both the fragments and compatibility rules are extracted from a library of drug-like molecules, and the outcomes of the genetic operations are biased according to the frequency of the fragments in drug-like matter. Additionally, a Lamarckian evolutionary mechanism adjusts the future reproductive behavior of molecules based on the outcome of previous generations. LEADD attempts to strike a balance between optimization power (OP), SA of designed molecules and computational performance.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Fragment library creation</title>
      <p id="Par23">A virtual library, assumed to be representative of drug-like chemical space, is fragmented to yield the fragments employed by LEADD during the design process.</p>
      <p id="Par24">Within this context, a fragment is a connectivity-encoding molecular subgraph of the source molecule from which it was extracted. A connection is an object describing the bond between two atoms and is directional by nature. It can be represented as a three-integer tuple, where the integers describe the starting atom type, ending atom type and bond type respectively. Bonds are classified into either single, double or triple bond type (aromatic bond types don’t occur since rings aren’t fragmented; see below). While any atom typing scheme may be used, we have implemented into LEADD MMFF94 [<xref ref-type="bibr" rid="CR40">40</xref>] and Morgan atom types. Morgan atom types derive their name from the Morgan algorithm [<xref ref-type="bibr" rid="CR41">41</xref>], a variant of which is used in ECFP [<xref ref-type="bibr" rid="CR42">42</xref>] and RDKit Morgan fingerprints [<xref ref-type="bibr" rid="CR43">43</xref>] to generate canonical atomic identifiers. These atomic identifiers are 32-bit integers describing the atom’s topological circular chemical environment of a given radius <italic>r</italic>. Said integer is taken as the atom’s Morgan atom type. For clarity, the examples and figures in this paper use MMFF94 atom types.</p>
      <p id="Par25">We distinguish between connections, which are generic objects describing the type of an atom–atom bond, and connectors, which are specific instances of a connection centered on a fragment’s atom. During molecule fragmentation, the bonds between the fragment’s molecular subgraph and its extra-fragment adjacent atoms are recorded as connectors (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Fragmentation example of two molecules. The input molecules (<bold>A</bold>) are assigned MMFF94 atom types (<bold>B</bold>). Ring systems and all possible subgraphs from the remaining linkers and side chains of a given size (in this example s ϵ [0 .. 1]) are extracted as fragments (<bold>C</bold>). The bonds that were cut to extract fragments become connectors, and are represented as three-membered tuples in parenthesis. The number in bold below each fragment is its ID</p></caption><graphic xlink:href="13321_2022_582_Fig1_HTML" id="MO2"/></fig></p>
      <p id="Par26">For each molecule, fragmentation starts by isolating ring systems from the acyclic regions. Rings pertaining to the Smallest Set of Smallest Rings (SSSR) [<xref ref-type="bibr" rid="CR44">44</xref>] are considered to be part of the same ring system if they share at least one atom. Given the complexities of designing drug-like ring systems, we decided to consider whole ring systems as fragments. The remaining acyclic structures may either be taken as fragments as a whole or subjected to systematic fragmentation by extracting all possible molecular subgraphs of a given size from them, with each subgraph becoming a fragment (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Hydrogens are treated implicitly. The size of the extracted subgraphs (<italic>s</italic>), given in number of bonds within the subgraph, is provided by the user. When <italic>s</italic> = <italic>0</italic>, single atom fragments are generated. Fragments of different sizes can be combined by specifying a range of sizes.</p>
      <p id="Par27">Two fragments are considered equivalent only if both their molecular graph and connectors are the same. Both attributes are encoded as canonical ChemAxon extended SMILES (CXSMILES) [<xref ref-type="bibr" rid="CR45">45</xref>] and molecular identity is assessed as canonical CXSMILES identity.</p>
      <p id="Par28">The generated fragments, their connectors, frequencies, sizes and other convenience information are stored in a relational SQLite3 database [<xref ref-type="bibr" rid="CR46">46</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). When a generated fragment is already present in the database its frequency is incremented by one.</p>
    </sec>
    <sec id="Sec4">
      <title>Connection compatibility rules</title>
      <p id="Par29">Fragment compatibility is defined at the connection level. Two fragments can be bonded together if two of their free connectors are compatible. Whether two connections are compatible is determined by a set of pairwise and symmetric compatibility rules.</p>
      <p id="Par30">The compatibility rules are extracted from the connections table of the fragment database according to a user-specified compatibility definition. We employ two of those definitions, termed the “strict” and “lax” compatibility definitions. Both definitions are illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><p>Connection compatibilities of the connections in Fig. <xref rid="Fig1" ref-type="fig">1</xref> according to the strict (<bold>A</bold>) and lax (<bold>B</bold>) compatibility definitions. Since in the lax definition the end atom type is irrelevant it is omitted</p></caption><graphic xlink:href="13321_2022_582_Fig2_HTML" id="MO3"/></fig></p>
      <p id="Par31">According to the strict definition two connections are compatible only if (a) their bond types are the same, and (b) their atom types are mirrored (i.e. the start atom type of one is the end atom type of the other and vice versa). Consequently, only a single connection is compatible with each connection. During molecule design this entails that the connectivity of fragments to their flanking atoms in their source molecules is preserved. In other words, a fragment must be connected to atoms of the same atom type as those that flanked the fragment in the source molecule.</p>
      <p id="Par32">When following the lax compatibility definition two connections are compatible if (a) their bond types are the same, and (b) if the starting atom type of one has been previously observed paired with the starting atom type of the other in any connection. This definition expands the connectivity scope from the fragment’s source molecule to the entire source molecules pool. In other words, two atom types can be connected if they have been observed paired together in any of the database’s connections, which means they were bonded in at least one of the source molecules. As such, the strict compatibility definition is a subset of its lax counterpart.</p>
    </sec>
    <sec id="Sec5">
      <title>Chromosomal representation and initialization</title>
      <p id="Par33">Molecules are represented internally as meta-graphs [<xref ref-type="bibr" rid="CR38">38</xref>], where each vertex is a molecular graph corresponding to a fragment, and the edges describe which connectors bind the fragments (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Due to the complexities of designing drug-like ring systems we treat ring systems as whole fragments, represented as a single vertex in the meta-graph. However, while the genetic operators don’t create cycles in the meta-graph, they would work on existing cycles if one were to add a cyclization operator in the future.<fig id="Fig3"><label>Fig. 3</label><caption><p>Chromosomal representation of a molecule created through combination of fragments in Fig. <xref rid="Fig1" ref-type="fig">1</xref> using the lax compatibility definition. <bold>a</bold> Chromosomal meta-graph. Numbered vertices correspond to fragment IDs. Numbers between parenthesis represent connector tuples. Bonds between connectors are represented as rectangles. <bold>b</bold> The chromosome with fragments shown as their molecular graphs. <bold>c</bold> Translation of the chromosome to the molecule seen by the user</p></caption><graphic xlink:href="13321_2022_582_Fig3_HTML" id="MO4"/></fig></p>
      <p id="Par34">The meta-graph chromosome can be translated into a single molecular graph by connecting the molecular graphs of all fragments (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Thereafter, hydrogens are added to satisfy all incomplete valences. For elements with more than one valid valence like sulphur or phosphorus hydrogens are added up to the closest valid valence.</p>
      <p id="Par35">Upon initialization, for true de novo drug design random chromosomes are generated by successively combining random fragments. However, in some instances the user may want to perform molecule optimization instead, starting from a known population of molecules. In this case, it’s possible to convert regular molecular graphs into meta-graphs by following the previously laid out fragmentation procedure using single atom acyclic fragments (<italic>s</italic> = <italic>0</italic>). If any of the connections generated during the fragmentation of starting molecules don't appear in the database, connection compatibility information won't be available for them and the molecule will therefore be skipped.</p>
    </sec>
    <sec id="Sec6">
      <title>Genetic operators</title>
      <p id="Par36">LEADD employs eight distinct genetic operators to modify the chromosome and generate offspring (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Some of these operators have a peripheral and internal variant, referring to the location of fragments on which they operate. Peripheral fragments are those connected to one or less other fragments (vertex degree <italic>d</italic> ≤ <italic>1</italic>), while internal fragments are those connected to two or more fragments (<italic>d</italic> ≥ <italic>2</italic>). While peripheral operators are theoretically sufficient to access the entirety of the search space, in practice this relies on statistically unlikely sequences of operations, since to modify the core of the molecule one would have to “backtrack” and remove all peripheral fragments obstructing it. Hence, the algorithm would be very likely to get stuck in local minima on the fitness landscape.<fig id="Fig4"><label>Fig. 4</label><caption><p>Illustration of the resulting chromosomes after applying each of the eight genetic operators to the chromosome given in Fig. <xref rid="Fig3" ref-type="fig">3</xref>a</p></caption><graphic xlink:href="13321_2022_582_Fig4_HTML" id="MO5"/></fig></p>
      <p id="Par37">The function of peripheral variants is mostly self-explanatory: peripheral expansions attach a fragment sampled from the database to a free connector, while peripheral deletions delete a peripheral fragment.</p>
      <p id="Par38">In internal expansions a fragment is inserted between a target fragment and one or more of its adjacent fragments. For this purpose, connectors involved in bonding the target fragment to the adjacent fragments are considered free.</p>
      <p id="Par39">In an internal deletion an internal target fragment is deleted. This is only possible if one of the fragments adjacent to the target fragment can “take its place” and bond to the remainder of the adjacent fragments.</p>
      <p id="Par40">In a substitution a target fragment is replaced by a fragment in the database. Connectors bonding the target fragment to its neighboring fragments are deemed free.</p>
      <p id="Par41">Transfections derive their name from the corresponding biochemical technique of inserting genetic material into cells. Transfections are similar to substitutions in that they replace one fragment with another, with the difference being that the replacement fragments are sourced from the molecule population instead of the fragments database. Hence, they exploit the internal variability of the population, fulfilling a similar role to crossover operators in traditional genetic algorithms. We opted out of traditional crossover operators because crossing over graphs is non-trivial. Historically graph crossover operations have been implemented as exchanges of subgraphs [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>], or of side chains around a maximum common substructure [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. If we were to implement one of these approaches it would have to operate on our chromosomal meta-graph without infringing on the connection compatibility rules. The former approach would be error prone, whereas the latter assumes the presence of a large common substructure, which is unlikely if the fragments are diverse and the number of fragments is large. While the transfection operator is less disruptive than a crossover operator, the unidirectional flow of genetic material in transfections is easier to implement, guarantees the success of the operation and reduces the time complexity from O(n<sup>2</sup>) to O(n) compared to a bidirectional crossover.</p>
      <p id="Par42">Translations/rotations move a fragment from one position and orientation to another within the same molecule. They operate similar to a deletion and expansion in tandem. By inserting the fragment back in its starting position but with a different orientation it can effectively be rotated in place.</p>
      <p id="Par43">Lastly, for those scoring functions operating on 3D molecular structures, a stereochemistry flip operator is available. This operator chooses a random chiral atom or stereochemical double bond and inverts its stereochemistry.</p>
      <sec id="Sec7">
        <title>Connection rules enforcement</title>
        <p id="Par44">LEADD’s genetic operators satisfy the connection compatibility rules by searching for fragments that can bond simultaneously to a given combination of fragments. Whether a specific query fragment fulfils the above condition can be expressed as a Maximum Bipartite Matching problem (MBPM). We construct the bipartite graph by placing the query fragment’s free connectors in one vertex set, and the fragments within the combination in the other vertex set (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The edges between both vertex sets are drawn according to the lax connection compatibility rules (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B), with an edge representing that a connection is compatible with a fragment. This MBPM is then solved with a modified version of the Hopcroft-Karp algorithm [<xref ref-type="bibr" rid="CR48">48</xref>]. The standard version of the algorithm is deterministic and always returns the same matching, even if multiple matchings with the same cardinality exist. By randomizing the order in which it iterates over vertices and edges it returns a random maximum cardinality matching instead. If the cardinality of the resulting matching is equal to the number of fragments within the combination, the query fragment is compatible with said combination of fragments.<fig id="Fig5"><label>Fig. 5</label><caption><p>MBPM constructed to query whether a hypothetical fragment with a given set of connectors (left) is compatible with a combination of fragments (right). Black and orange edges represent compatibility relationships. The solution to the MBPM (i.e. the matching) is shown as the orange highlighted edges. Since the cardinality of the matching is equal to the number of flanking fragments our hypothetical fragment is compatible</p></caption><graphic xlink:href="13321_2022_582_Fig5_HTML" id="MO6"/></fig></p>
        <p id="Par45">To find all fragments that could bond to a combination of fragments one must interrogate all candidate fragments separately, which entails solving MBPM multiple times. This is computationally reasonable when the number of candidates is small, namely during internal deletions, transfections and translations/rotations. However, it becomes unreasonable for operations that sample fragments from the large fragments database, namely expansions and substitutions.</p>
        <p id="Par46">In those cases, we solve the problem through Multiple Set Intersection (MSI). Before LEADD is executed we precompute which fragments are compatible with each connection according to the strict connection compatibility rules and store their IDs in sets (Fig. <xref rid="Fig6" ref-type="fig">6</xref>A). Since a connection combination may have repeats of the same connection, the compatible fragment IDs are stored stratified according to how many instances of compatible connections they have. If a fragment is compatible with <italic>n</italic> instances of a connection it is also compatible with <italic>1</italic> to <italic>n−1</italic> instances. To be able to control the number of ring fragments within the designed molecules, fragments are also stratified according to whether these are cyclic or acyclic.<fig id="Fig6"><label>Fig. 6</label><caption><p>Connection-fragment compatibilities of the fragments in Fig. <xref rid="Fig1" ref-type="fig">1</xref> according to (<bold>a</bold>) the strict compatibility rules and (<bold>b</bold>) lax compatibility rules, as described in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. Fragment weights are omitted for clarity purposes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). Fragments are stratified according to their cyclicity, and in the case of the strict compatibility definition (<bold>a</bold>) also according to how many instances (n) of the connection the fragment has. In (<bold>b</bold>), “e” denotes any ending atom type. Note that in (<bold>a</bold>) higher strata are subsets of the lower strata, and that (<bold>a</bold>) is a subset of (<bold>b</bold>)</p></caption><graphic xlink:href="13321_2022_582_Fig6_HTML" id="MO7"/></fig></p>
        <p id="Par47">At runtime these arrays are loaded, and the list of fragments compatible with a combination of connections is calculated as the intersection of the fragment IDs compatible with each of its connections separately (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). Note that since fragments may have more than one free connector, if we wish to find fragments compatible with a combination of fragments, we must define all unique combinations of their free connectors and solve the MSI problem for each of them. The final result is the union of all resulting sets.<fig id="Fig7"><label>Fig. 7</label><caption><p>Venn diagram of the multiple intersection result for acyclic fragments compatible with the connections combination [(1,1,1), (1,1,1), (7,3,2), (37,3,1)], using the precalculated compatible fragments according to the strict compatibility definition (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a)</p></caption><graphic xlink:href="13321_2022_582_Fig7_HTML" id="MO8"/></fig></p>
        <p id="Par48">The MSI connection-fragment compatibilities must be computed using the strict connection compatibility definition to ensure that the same connector doesn’t contribute to a fragment showing up in more than one set of compatible fragments. Because of this, the MSI approach returns a subset of all fragments that would be deemed compatible according to the MBPM approach (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Nonetheless, the final orientation of fragments retrieved with the MSI approach can still be determined through MBPM.</p>
      </sec>
      <sec id="Sec8">
        <title>Operation outcome sampling</title>
        <p id="Par49">In the event that an operator finds multiple suitable operation outcomes a random one is chosen, typically through roulette wheel selection. For expansions, deletions and substitutions the weight <italic>W</italic> of a fragment <italic>F</italic> is calculated based on its frequency <italic>q</italic> in the database and its size <italic>N</italic>, in numbers of heavy atoms, according to the following equation:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{F} = q_{F}^{\gamma } \cdot N_{F}^{\lambda }$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>γ</mml:mi></mml:msubsup><mml:mo>·</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msubsup></mml:mrow></mml:math><graphic xlink:href="13321_2022_582_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
where the exponents <italic>γ</italic> and <italic>λ</italic> are user parameters. <italic>γ</italic> determines how much the fragment selection should be guided by the fragment frequencies, with the default being <italic>γ</italic> = <italic>1</italic>. If the user wishes true random fragment selection this can be done by setting <italic>γ</italic> = <italic>0</italic>. <italic>λ</italic> is a size biasing term intended to be used when mixing fragments of different sizes. For efficiency reasons they are precalculated and stored alongside the connection-fragment compatibilities (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2).</p>
        <p id="Par51">For transfections the weight is calculated following the same formula but with the score <italic>S</italic> of the fragment’s owner molecule <italic>R</italic> as an additional variable term:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{F} = q_{F}^{\gamma } \cdot N_{F}^{\lambda } \cdot S_{R}^{\zeta }$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>γ</mml:mi></mml:msubsup><mml:mo>·</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msubsup><mml:mo>·</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>ζ</mml:mi></mml:msubsup></mml:mrow></mml:math><graphic xlink:href="13321_2022_582_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>
where <italic>ζ</italic> is a user specified parameter signifying the transfection bias towards fragments contained in high scoring molecules.</p>
        <p id="Par53">The translation/rotation and stereo flip operators select operation outcomes through uniform random sampling instead.</p>
      </sec>
      <sec id="Sec9">
        <title>Cyclicity control</title>
        <p id="Par54">Fragment identity comprises both the molecular graph and connectors. Generally, the number of unique fragments increases with (1) the size of the fragments and (2) the atom type and connector diversity (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Differences in fragmentation procedure between acyclic and cyclic regions of source molecules can cause imbalances in the number of unique fragments, as well as their frequencies, which can lead to fragment sampling biases. Since cyclic fragments tend to outnumber their acyclic counterparts (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1), if fragments were sampled uniformly (γ = 0, Eq. <xref rid="Equ1" ref-type="">1</xref>) it would be more likely to sample cyclic fragments. Conversely, under weighted sampling (γ &gt; 1), and when defining acyclic fragments as subgraphs of <italic>s</italic> &gt; <italic>0,</italic> certain acyclic atoms are represented in more than one fragment. Since ring systems aren’t fragmented, this causes an overrepresentation of acyclic atoms in the fragment frequencies with respect to the cyclic ones. If these factors aren’t accounted for during fragment sampling, we risk designing either very rigid or very flexible and non-druglike molecules.</p>
        <p id="Par55">To circumvent this issue the genetic operators with the capacity to modulate the number of ring atoms in a molecule (<italic>N</italic><sub><italic>r</italic></sub>), namely expansions, deletions, substitutions and transfections, decide whether and how <italic>N</italic><sub><italic>r</italic></sub> ought to be changed prior to selecting a suitable acyclic or cyclic fragment to do so, according to the current <italic>N</italic><sub><italic>r</italic></sub>.</p>
        <p id="Par56">How the operator will modulate <italic>N</italic><sub><italic>r</italic></sub> is based on the probabilities returned by up to two functions operating in tandem. In first instance, a Gaussian function describes the probabilities of keeping <italic>N</italic><sub><italic>r</italic></sub> constant. For expansions and deletions this function suffices to decide how to modulate <italic>N</italic><sub><italic>r</italic></sub>. However, for substitutions and transfections, if in the preceding step it was decided to change <italic>N</italic><sub><italic>r</italic></sub>, a second logistic function returns the probability of increasing <italic>N</italic><sub><italic>r</italic></sub>. Further details can be found in the supplementary material.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Lamarckian evolution guidance</title>
      <p id="Par57">Given that the database fragment weights are static, so are the likelihoods of genetic operation outcomes, regardless of whether the same or similar operations proved beneficial or not in the past. In an attempt to improve the efficiency of the algorithm, as an extension, we conferred it with a certain ability to “learn” from the outcomes of previous genetic operations in hopes of increasing the likelihood of carrying out productive operations in the future. To this end, each connector within a molecule is endowed with a pair of arrays: one storing the IDs of compatible fragments <italic>F</italic> and one storing their corresponding weights <italic>W</italic><sub><italic>F</italic></sub>. The weights array is initialized to a copy of the database fragment weights (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2), but it’s free to change with each generation.</p>
      <p id="Par58">During evolution, a copy of a parent molecule <italic>P</italic> is subjected to a genetic operation, targeting some fragment <italic>V</italic>, to generate a child molecule <italic>C</italic>. The score <italic>S</italic> of <italic>C</italic> is compared to that of <italic>P</italic>:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta S = S_{c} - S_{P}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:math><graphic xlink:href="13321_2022_582_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par59">Molecules keep track of which fragments were placed and/or removed from each connector during the operation. For each connector involved in the operation, based on the nature of the operation and its outcome (Table <xref rid="Tab1" ref-type="table">1</xref>), the weights array of both the <italic>P</italic> and <italic>C</italic>’s connectors are modified according to the following expression:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{F} = W_{F} \cdot \left( {1 + g \cdot l \cdot Tc_{FV} } \right)$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo>·</mml:mo><mml:mi>l</mml:mi><mml:mo>·</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">FV</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13321_2022_582_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><table-wrap id="Tab1"><label>Table 1</label><caption><p>Learning rate sign of Eq. <xref rid="Equ4" ref-type="">4</xref> for bond creations (i.e. attaching a fragment to a connector) and destructions (i.e. deleting a fragment from a connector) based on the score change associated with the operation</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Operation</th><th align="left">ΔS</th><th align="left">Learning rate sign (<italic>g</italic>)</th></tr></thead><tbody><tr><td align="left" rowspan="2">Bond creation</td><td align="left">&gt; 0</td><td align="left">+ 1</td></tr><tr><td align="left">≤ 0</td><td align="left">− 1</td></tr><tr><td align="left" rowspan="2">Bond destruction</td><td align="left">&gt; 0</td><td align="left">− 1</td></tr><tr><td align="left">≤ 0</td><td align="left">+ 1</td></tr></tbody></table></table-wrap> where <italic>g</italic> is the reinforcement sign, <italic>l</italic> is a user-specified reinforcement rate and <italic>Tc</italic><sub><italic>FV</italic></sub> is the Tanimoto topological similarity coefficient of fragments <italic>F</italic> and <italic>V</italic> according to ECFP4 fingerprints [<xref ref-type="bibr" rid="CR42">42</xref>]. For performance reasons, all pairwise fragment similarity coefficients are precalculated and stored as a square symmetrical matrix in a HDF5 file [<xref ref-type="bibr" rid="CR49">49</xref>].</p>
      <p id="Par61">Whether the change in weight is positive or negative (<italic>g</italic>) depends on the nature of the operator and the change in score (Table <xref rid="Tab1" ref-type="table">1</xref>). LEADD maximizes strictly positive scores. The general principle is that if a newly placed fragment at a given connector increased the molecule’s score (i.e. improved the score), the weights of similar fragments are increased, whereas if it stayed the same or decreased, the weights of similar fragments are decreased. The opposite paradigm is true for fragments being removed from a given connector.</p>
      <p id="Par62">This guided evolution serves two purposes. On one hand it can accelerate convergence by focusing the sampling on fragments that have been shown to be associated with good scores. On the other hand, since weights of similar fragments are decreased also when the score doesn’t change, given enough time it could help the algorithm in escaping local fitness minima.</p>
      <p id="Par63">One could interpret a molecule’s connectors’ weights arrays as its reproductive behavior or its memory regarding which chemotypes at which positions are linked to better scores. Parents adapt their reproductive behavior to increase the likelihood of generating fit offspring based on the outcome of their previous reproductive events. Hence, the reproductive behavior is an acquired trait. This, coupled to the fact that the connector arrays are an integral part of the chromosome, and therefore inherited by the offspring, constitutes a Lamarckian evolutionary mechanism.</p>
    </sec>
    <sec id="Sec11">
      <title>Evolutionary algorithm</title>
      <p id="Par64">Over the course of a number of generations (or until some convergence criterion is met) the molecules within the population are bred to generate offspring. Each generation a number of parent molecules is chosen to generate an equal number of child molecules. Parents reproduce asexually, and the same parent may reproduce more than once in the same generation. A copy of the chosen parent is subjected to a genetic operator to yield the child molecule. Molecules are chosen to be parents through fitness proportionate selection, with the weight of a molecule <italic>R</italic> being given by Eq. <xref rid="Equ5" ref-type="">5</xref>. Note that the <italic>ζ</italic> parameter takes the same value as in Eq. <xref rid="Equ2" ref-type="">2</xref>.<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{R} = S_{R}^{\zeta }$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>ζ</mml:mi></mml:msubsup></mml:mrow></mml:math><graphic xlink:href="13321_2022_582_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par65">Optionally, the user may enforce population topological diversity through means of an internal similarity filter. The topological similarity between two molecules is calculated as the Tanimoto coefficient between their ECFP4 fingerprint [<xref ref-type="bibr" rid="CR42">42</xref>]. If the similarity of a child molecule to any of the current members of the population surpasses a given threshold, the child is discarded. Otherwise, it’s added to the population.</p>
      <p id="Par66">The child molecules are scored, and a specified number of best scoring molecules within the population, including parents, is retained. If guided evolution is enabled the connector weights are adjusted based on the change in score caused by the operation. Lastly, the surviving molecules are fed to the next generation of the algorithm.</p>
      <p id="Par67">While the use of fragments and connection compatibility rules is meant to reduce the likelihood of designing synthetically unfeasible molecules, this may not be sufficient to achieve this goal. For users wishing to consider synthetic accessibility on a higher level a SAScore [<xref ref-type="bibr" rid="CR18">18</xref>] filter and heuristic score modifier [<xref ref-type="bibr" rid="CR14">14</xref>] are provided.</p>
      <p id="Par68">A flowchart of the algorithm can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4.</p>
    </sec>
    <sec id="Sec12">
      <title>API</title>
      <p id="Par69">LEADD is scoring function agnostic, the only requirements being strictly positive floating point molecule scores, with higher scores being better. The recommended way of coupling a problem-specific scoring function is using the C++ or Python API. An instance of a molecule design class is initialized using a settings file and output directory path. This class has member functions to expand the population with children, get their SMILES, set their scores, and wrap up the generation by selecting the fittest individuals. A Python example of how these functions can be used in conjunction with a user scoring function <italic>ScoreMolecule()</italic> is shown below.<graphic position="anchor" xlink:href="13321_2022_582_Figb_HTML" id="MO9"/></p>
    </sec>
    <sec id="Sec13">
      <title>Benchmark</title>
      <p id="Par70">LEADD’s performance was evaluated with the goal-directed GuacaMol benchmark suites [<xref ref-type="bibr" rid="CR13">13</xref>]. Specifically, we used the “trivial” and “version 2” (V2) benchmark suites. Briefly, these benchmark suites consist of 7 and 20 objective functions respectively that assign scores between 0 and 1 to populations of molecules. The overall score of the benchmark suite can be calculated as the sum of all individual benchmark scores. We chose to include the trivial benchmarks in our analysis because the majority of the V2 objective functions point towards topologies of known and synthetically feasible drugs. Hence, the objective functions implicitly provide some notions of drug-likeness, potentially occluding some SA issues.</p>
      <p id="Par71">For standardization purposes we used GuacaMol’s training set, which is a subset of ChEMBL [<xref ref-type="bibr" rid="CR50">50</xref>], as fragmentation input. Fragment databases were created for each investigated combination of fragmentation and atom typing scheme (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1).</p>
      <p id="Par72">The benchmark suite was used to find a set of reasonable default parameters for LEADD. Given the large number of parameters an exhaustive parameter exploration was unfeasible. We resorted largely to a trial-and-error approach. Some parameters, including the population size and convergence criteria were fixed. Additionally, since LEADD requires a guess of the number of ring atoms in the ideal solution, where possible, we used the benchmark goals to set reasonable values for these parameters (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). The rest of the parameters were sorted according to their perceived importance. For parameters assumed to be uncorrelated we tested multiple values for each one and fixed it to the value that yielded the best results. If this wasn’t the case, we evaluated combinations of the correlated parameters in a multi-factorial design.</p>
      <p id="Par73">Ten replicas were ran for each combination of settings. Benchmark scores and SAScores of designed molecules were taken as OP and SA metrics respectively. ChEMBL [<xref ref-type="bibr" rid="CR50">50</xref>] feature counts were used for SAScore calculations. For statistical analysis the results of all benchmarks were pooled per setting. Since OP was found to be distributed non-normally, differences in it were evaluated with non-parametric statistical tests: either the Wilcoxon-Mann–Whitney U-test [<xref ref-type="bibr" rid="CR51">51</xref>] or the Kruskal–Wallis [<xref ref-type="bibr" rid="CR52">52</xref>]/Schreirer-Ray-Hare [<xref ref-type="bibr" rid="CR53">53</xref>] H-test followed by pairwise Conover-Iman tests [<xref ref-type="bibr" rid="CR54">54</xref>] with Šidák correction [<xref ref-type="bibr" rid="CR55">55</xref>]. SAScores were distributed normally and analyzed with t-tests or one- or two-way analysis of variance (ANOVA) with interaction followed by Tukey’s Honestly Significant Differences test. α = 0.05 was taken as significance level and family-wise error rate (FWER) for all tests.</p>
      <p id="Par74">LEADD’s performance was compared to that of GB-GA [<xref ref-type="bibr" rid="CR35">35</xref>], an atom- and graph-based genetic algorithm for molecular design which has previously been shown to be a powerful optimizer [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR23">23</xref>], and a standard virtual screen of GuacaMol’s training set using the benchmark’s objective function. GB-GA’s mutation rate was set to the default 0.01. Both algorithms used a population size of 100 and were granted a maximum of 10,000 generations. Evolution terminated prematurely after a number of generations without improvements in the population’s scores: 1000 for LEADD and 5 for GB-GA. We explored granting GB-GA 1000 generations without improvement but found that its lack of convergence guards caused the population diversity, and ultimately the benchmark scores, to degrade during long runs.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Results and discussion</title>
    <p id="Par75">LEADD was found to be quite robust to changes in most of its construction parameters, as different values didn’t influence its performance greatly. As an exception, LEADD was sensitive to the internal similarity threshold since it’s the algorithm’s main premature convergence guard (data not shown). LEADDs base parameters can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3. Fragmentation parameters had larger effects on both OP and SA of designed molecules.</p>
    <sec id="Sec15">
      <title>Effect of atom typing scheme</title>
      <p id="Par76">One of the main questions we wanted to answer was if the knowledge-based atom compatibility rules aided the algorithm in designing SA molecules. To that end, we measured the SAScores of molecules designed using the MMFF and Morgan (r = 1 and r = 2) atom typing schemes. As a control, we included “dummy” atom types (i.e. all atoms have the same atom type), whereby all connections with the same bond order are compatible. All tests used single-atom acyclic fragments (s = 0). Molecules with lower SAScores are predicted to be easier to synthesize. Figure <xref rid="Fig8" ref-type="fig">8</xref> shows that molecules designed with Morgan atom types, regardless of the radius, have lower SAScores than those designed with dummy or MMFF atom types. Differences between all other pairs of atom typing schemes were of little practical significance (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). It’s interesting to note that the mean SAScore values for Morgan atom types fall well below 4.5, which has been suggested as a cut-off for easy to synthesize molecules [<xref ref-type="bibr" rid="CR19">19</xref>]. By contrast, the mean SAScore values for dummy and MMFF atom types are approximately 4.6.<fig id="Fig8"><label>Fig. 8</label><caption><p>Comparison of designed molecules’ SAScore distributions using different atom typing schemes. Includes molecules of all benchmarks and replicas. Molecules with lower SAScores are predicted to be easier to synthesize</p></caption><graphic xlink:href="13321_2022_582_Fig8_HTML" id="MO10"/></fig></p>
      <p id="Par77">Unfortunately, we also noted that Morgan atom types were associated with significantly lower OP compared to dummy and MMFF atom types (Fig. <xref rid="Fig9" ref-type="fig">9</xref>). The differences between dummy and MMFF atom types and between Morgan atom types of different radii were not statistically significant (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5).<fig id="Fig9"><label>Fig. 9</label><caption><p>LEADD optimization power comparison between atom typing schemes. Benchmark scores range between 0 and 1, with higher scores being better. Boxes represent interquartile ranges (IQR), the black line within them medians and the whiskers Q ± 1.5IQR. Data beyond the whiskers are considered outliers and represented as dots. Colored dots represent maximum benchmark scores</p></caption><graphic xlink:href="13321_2022_582_Fig9_HTML" id="MO11"/></fig></p>
      <p id="Par78">Taken together these results suggest that the choice of atom typing scheme defines a trade-off between OP and SA. The chemical diversity of atomic environments is vast, and classifying them into a small number of atom types means that atom typing schemes are degenerate, much like the human genetic code. The number of distinct atom types can be taken as an approximate measure of the scheme’s degree of degeneracy. LEADD tries to replicate the molecular connectivity of molecules seen in a library of drug-like molecules, but if a very degenerate atom typing scheme mischaracterizes this connectivity the algorithm’s ability to replicate it falters. In our fragment databases we recorded 64 MMFF, 14,811 Morgan (r = 1) and 381,252 Morgan (r = 2) atom types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Unique Morgan atom types greatly outnumber their MMFF counterparts, explaining the better SA associated with them.</p>
      <p id="Par79">The atom typing scheme’s degree of degeneracy also defines the observed OP-SA trade-off. LEADD considers two atom types to be compatible, and therefore suitable for bonding, if they have been observed bonded in reference molecules at least once. Given the same set of reference molecules, the probability of observing any specific pair of atom types bonded is larger when the number of distinct atom types is small. Consequently, the more degenerate an atom typing scheme, the more promiscuous its atom types, in the sense that atom types will be deemed compatible with a larger number of other atom types. Ultimately, this also affects the number of fragments that are compatible with each connection. In the case of MMFF atom types, 85.96% of all fragments are compatible with the average connection according to the lax compatibility definition. This number drops to 1.53% and 0.05% for Morgan (r = 1) and Morgan (r = 2) atom types respectively. Even more dramatic differences are observed when considering the strict compatibility definition (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). This highlights that atom type promiscuity enables the algorithm to access a larger number of states (i.e. molecules) from the current state, aiding it in the escape of local fitness minima and explaining the associated greater OP.</p>
      <p id="Par80">Out of the tested atom typing schemes, we believe that for most use cases Morgan (r = 1) atom types represent the best OP-SA compromise. Other compromises of interest may be achievable with alternative atom typing schemes. LEADD can be readily expanded to use other atom typing schemes. For instance, one could collapse Morgan atom types into a smaller number of atom types with some type of hashing function. However, as this would inevitably cause collisions, the hashing function would need to be locality sensitive to avoid merging completely unrelated atom types. An alternative approach might be to cluster atomic environments and use cluster assignments as atom types. This approach could allow fine control over the OP-SA trade-off by modulating the number of clusters. We would like to remark however that the number of unique atom types is only a good metric for atom typing degeneracy when atomic environments are distributed uniformly across atom types. This is likely to be the case for Morgan atom types since they are calculated using hashing functions, which are designed to distribute inputs uniformly over an integer range, but may not be the case for other schemes. Instead, it would be more appropriate to use metrics that measure the information content of atom types (i.e. within atom type atomic environment similarities).</p>
    </sec>
    <sec id="Sec16">
      <title>Implications of compatibility binarization</title>
      <p id="Par81">LEADD’s approach to find suitable fragments for genetic operators requires that connection compatibility be expressed as a binary property. However, it may be argued that connection pairs are on a compatibility spectrum based on the observed frequency of said pair: if a pairing is observed thousands of times it’s more compatible than if it’s observed just once, yet they are deemed equally compatible. Consequently, infrequent connections may misrepresent molecular connectivity. We regularly observed large disparities among compatible connection pairing frequencies and wanted to measure the extent to which this is detrimental to the SA of designed molecules. By default the MBPM approach uses the lax compatibility definition, but this may be changed to the strict definition. Under the strict compatibility definition each connection is compatible with exactly one other connection, eliminating compatible connection pairing frequency imbalances. We found no practically significant differences in SAScore when using the strict compatibility definition for MBPM as opposed to the lax one (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). Considering that a fragment’s connectivity is part of its identity, infrequent connections are contained to infrequent fragments. Since LEADD samples fragments with a probability proportional to their frequency we hypothesize that, while the binarization of connection compatibility does misrepresent the molecular connectivity of the reference library, this rarely manifests itself in designed molecules.</p>
    </sec>
    <sec id="Sec17">
      <title>Effect of fragmentation scheme</title>
      <p id="Par82">The atom typing scheme degeneracy, the binarization of connection compatibility, and other factors such as connection compatibility being expressed only as pairwise relationships, all contribute towards LEADD’s description of molecular connectivity being imperfect. Each bond created by the algorithm has a probability of being non-drug-like. While we have discussed approaches to decrease this probability, an alternative approach to improve the drug-likeness of designed molecules is to reduce the number of bonds created by the algorithm. This can be achieved using larger fragments. To prove this we ran the benchmark using different types of acyclic fragments: single-atom fragments (s = 0), fragments with 0 to 2 bonds (s ϵ [0 .. 2]) and whole side chains and linkers resulting from the deletion of ring systems. In general, the SAScores of molecules designed using larger fragments were lower than those designed using smaller fragments (Fig. <xref rid="Fig10" ref-type="fig">10</xref>). While the SAScore differences between s = 0 and s ϵ [0 .. 2] were almost negligible, using monolithic acyclic fragments did lead to substantial improvements in SAScore (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S6, S7). It’s interesting to note that the observed improvements in SAScore were larger for dummy atom types than for Morgan atom types, highlighting that the bonds created when using Morgan atom types are more drug-like.<fig id="Fig10"><label>Fig. 10</label><caption><p>Comparison of designed molecules’ SAScore distributions using different atom typing schemes. Includes molecules of all benchmarks and replicas. Molecules with lower SAScores are predicted to be easier to synthesize</p></caption><graphic xlink:href="13321_2022_582_Fig10_HTML" id="MO12"/></fig></p>
      <p id="Par83">The use of larger fragments didn’t affect LEADD’s OP when using dummy atom types. However, we did observe significant improvements in OP when using large fragments coupled with Morgan (r = 1) atom types (Fig. <xref rid="Fig11" ref-type="fig">11</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S8, S9). Genetic operations using larger fragments are associated with bigger step sizes in chemical space, which allows the algorithm to escape local fitness minima. Because the number of chemical states accessible from a given state is much smaller when using Morgan atom types as compared to dummy atom types, the probability of getting stuck in local fitness minima is larger in the former case. This explains why a bigger step size is beneficial for Morgan, but not dummy atom types. It’s worth noting that the step size associated with larger fragments isn’t longer solely because of the bigger number of atoms per fragment, but also due to the greater degree of branching in larger fragments. While we implemented internal operators that attempt to mitigate this, there still is a risk that the algorithm may design certain highly branched topologies that are difficult to modify with genetic operators without unwinding the entire stack of operations. Since large fragments can capture branched motifs as a single unit, the risk of this happening is reduced. Future algorithms could improve upon this by implementing operators that target entire sections or branches of the meta-graph instead of a single vertex.<fig id="Fig11"><label>Fig. 11</label><caption><p>LEADD optimization power comparison between different combinations of atom typing and fragmentation schemes. Benchmark scores range between 0 and 1, with higher scores being better. Boxes represent interquartile ranges (IQR), the black line within them medians and the whiskers Q ± 1.5IQR. Data beyond the whiskers are considered outliers and represented as dots. Colored dots represent maximum benchmark scores</p></caption><graphic xlink:href="13321_2022_582_Fig11_HTML" id="MO13"/></fig></p>
      <p id="Par84">Given that larger fragments improve SA and either increase OP or don’t affect it, it’s tempting to conclude that the use of large fragments is always preferable. However, it should be noted that the larger step sizes associated with big fragments also carry the risk of “jumping” over good solutions. This can be partially overcome by mixing fragments of different sizes (e.g. s ϵ [0.. 2]). A more pressing issue is that the use of large fragments requires a very extensive and diverse library of fragments to adequately represent chemical space. Besides dictating greater amounts of memory to store the pre-calculated compatible fragments, as the number of fragments grows so does the size of the search space, and with it the number of operations and generations necessary to adequately explore it. For Morgan atom types, we believe that the improved SA and OP tied to monolithic fragments justify their use. However, for dummy atom types we think that the minor SA improvements aren’t sufficient justification.</p>
    </sec>
    <sec id="Sec18">
      <title>Handling fragment numerosity</title>
      <p id="Par85">A large number of fragments also poses the question of how to prioritize fragments to explore chemical space efficiently. We opted to use the fragments’ frequencies in drug-like matter as biasing weights to determine the outcomes of genetic operations. In an attempt to improve upon this, we also implemented a Lamarckian evolutionary mechanism that biases the exploration towards certain areas of the search space based on the outcomes of previous operations. A similar concept was explored in the particle swarm optimizer Colibree [<xref ref-type="bibr" rid="CR56">56</xref>], where each molecule has preferences towards certain fragments, encoded as a floating point number array. In Colibree these preferences apply to the entire molecule, which is computationally more efficient and enables straightforward communication of preferences among molecules within the swarm, but lacks the spatial resolution that one would desire when working with structure-based scoring functions. Our Lamarckian evolutionary mechanism attempts to improve on this by assigning fragment preferences to connectors instead. Unfortunately, with the explored settings, the Lamarckian guided evolution mechanism failed to significantly improve the optimization power of the algorithm (data not shown). One possible explanation for the shortcomings of the approach is that, given the large number of fragments (10<sup>5</sup>–10<sup>6</sup> compared to the 7196 of Colibree), the number of generations for which LEADD runs (i.e. 1000–10,000) is insufficient to resolve connector-fragment preferences. The impermanence of connectors may exacerbate the problem. When a fragment is deleted or substituted the knowledge accumulated in its connector arrays is erased, effectively resetting the progress of the Lamarckian evolution. A potential solution could be mapping fragment preferences to points in space instead, which also would allow molecules to share their preferences among each other. However, the observed slower runtimes and larger memory footprints discourage us from exploring this approach further.</p>
    </sec>
    <sec id="Sec19">
      <title>Comparison of SA improvement approaches</title>
      <p id="Par86">LEADD also ships with more traditional means of improving the SA of designed molecules, namely a simple filter that deletes molecules with SAScores above a given threshold and a SAScore-based heuristic score modifier that biases the objective function towards molecules with lower SAScores, as described by Gao and Coley [<xref ref-type="bibr" rid="CR14">14</xref>]. As a reminder, the SAScore is a composite metric based on (a) how much the molecular connectivity of a molecule resembles that of reference drug-like molecules (i.e. FeatureScore) and (b) the number of synthetic nuisances within that molecule, for example stereo centers, spiro-, bridged- and macro-cycles (i.e. ComplexityPenalty). Because the atom type approach to increase SA only tries to improve the FeatureScore it can be of interest to combine it with the SAScore filter or heuristic. We were interested in comparing how these different approaches to increase SA fare on their own. The parameters for the SAScore filter (SAScore ≤ 4.5) and heuristic (µ = 2.23, σ = 0.65) were taken from the literature, where they have been described as effective means to design SA molecules [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. Our results confirm that all approaches can be used to design more SA molecules (Fig. <xref rid="Fig12" ref-type="fig">12</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S10) and that, with the exception of the SAScore filter, this was accompanied by a significant loss of optimization power (Fig. <xref rid="Fig13" ref-type="fig">13</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S11). There appears to be an inverse correlation between SA and OP, and the observed OP-SA compromises seem to define a FeatureScore Pareto front (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6). However, it should be noted that each approach has a different SA target. We didn’t manage to find SAScore filter and heuristic parameters that replicate the SAScore distribution of Morgan (r = 1) atom types. Hence, which approach provides the best OP-SA trade-off, if any, is inconclusive.<fig id="Fig12"><label>Fig. 12</label><caption><p>Comparison of designed molecules’ SAScore distributions using different SA optimization strategies. Includes molecules of all benchmarks and replicas. Molecules with lower SAScores are predicted to be easier to synthesize</p></caption><graphic xlink:href="13321_2022_582_Fig12_HTML" id="MO14"/></fig><fig id="Fig13"><label>Fig. 13</label><caption><p>LEADD optimization power comparison using different SA optimization strategies. Benchmark scores range between 0 and 1, with higher scores being better. Boxes represent interquartile ranges (IQR), the black line within them medians and the whiskers Q ± 1.5IQR. Data beyond the whiskers are considered outliers and represented as dots. Colored dots represent maximum benchmark scores</p></caption><graphic xlink:href="13321_2022_582_Fig13_HTML" id="MO15"/></fig></p>
    </sec>
    <sec id="Sec20">
      <title>Comparison to other algorithms and virtual screening</title>
      <p id="Par87">Lastly, we wanted to compare LEADD’s performance to that of GB-GA [<xref ref-type="bibr" rid="CR35">35</xref>] and a VS of the GuacaMol virtual library. In terms of OP, LEADD with dummy atom types outperformed the VS in 26/27 benchmarks, with the only exception being the Valsartan SMARTS benchmark which uses a binary scoring function ill-suited for goal-directed optimization approaches. LEADD with the use of dummy atom types is comparable to GB-GA, in the sense that both are graph-based EAs with very few restrictions on how atoms can be connected. Correspondingly, the SA (Fig. <xref rid="Fig14" ref-type="fig">14</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S12) and OP (Fig. <xref rid="Fig16" ref-type="fig">16</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S13) of these two systems are comparable. The key difference between both algorithms is that LEADD modifies molecules on a fragment level as opposed to the atom level of GB-GA. Although we paired dummy atom types with single-atom acyclic fragments, ring systems are always treated as monolithic fragments. We expected this to yield improved SA and smaller OP, yet found the opposite. LEADD has better OP than GB-GA, outperforming it in 18/27 benchmarks and performing equally well or better in 23/27 benchmarks. We attribute this to the bigger step size associated with fragments and the internal topological similarity threshold to enforce population diversity, giving it an edge at escaping local fitness minima. It’s also possible that the same factors explain the better SA of molecules designed by GB-GA. Most GuacaMol benchmarks incorporate topological similarity to a reference drug-like molecule in their objective functions, implicitly capturing some SA notions. Because of LEADD’s internal similarity threshold only the best individual within the population can assume the identity of the reference molecule, whereas the rest are forced to diverge from it. In GB-GA all individuals are allowed to approach the target molecule as much as possible, benefitting to a greater extent from the implicit SA target of the objective function. Moreover, GB-GA doesn’t allow the creation of SSSR cycles bigger than six-membered rings whereas some of the fragments used by LEADD do include bigger cycles. Since the SAScore incorporates a macrocycle penalty this could account for some of the observed differences. Ultimately, the magnitude of the SA changes associated with the use of fragments, be it cyclic or acyclic, are small (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S7, S12). This calls into the question the widespread practice of fragment-based molecular construction as a means to improve SA, and we hypothesize that its effectiveness depends on how well in silico fragments and their assembly rules correlate with <italic>ex silico</italic> reactants and chemical reactions.<fig id="Fig14"><label>Fig. 14</label><caption><p>Comparison of SAScore distributions between molecules designed by LEADD and GB-GA and those found through a VS. Includes molecules of all benchmarks and replicas. Molecules with lower SAScores are predicted to be easier to synthesize</p></caption><graphic xlink:href="13321_2022_582_Fig14_HTML" id="MO16"/></fig></p>
      <p id="Par88">When using Morgan (r = 1) atom types and monolithic acyclic fragments LEADD designs molecules with much better SA than GB-GA (Fig. <xref rid="Fig14" ref-type="fig">14</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S12). This is to be expected since GB-GA doesn’t take SA into account intrinsically. However, it’s possible to design SA molecules with GB-GA by using the previously discussed extrinsic SAScore-based heuristic score modifier [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. Doing so yields a similar OP-SA trade-off to the one observed for LEADD and the same heuristic (Figs. <xref rid="Fig12" ref-type="fig">12</xref>, <xref rid="Fig13" ref-type="fig">13</xref>), strongly favoring SA over OP (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S7, S8). The SA of molecules designed by LEADD using Morgan (r = 1) atom types is almost on par with those found by a VS (Fig. <xref rid="Fig14" ref-type="fig">14</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S12). We would like to remark that the feature set we used to calculate SAScores was extracted from ChEMBL [<xref ref-type="bibr" rid="CR50">50</xref>], and that the screened GuacaMol library is a subset of ChEMBL [<xref ref-type="bibr" rid="CR13">13</xref>]. It’s therefore to be expected that molecules found through VS have better SAScores. Since SAScores are a rather crude way of assessing SA, to confirm our findings we ran retrosynthetic analyses on the top 10 scoring molecules of each benchmark replica using AiZynthFinder [<xref ref-type="bibr" rid="CR21">21</xref>] with the ZINC [<xref ref-type="bibr" rid="CR1">1</xref>] reactant stock and USPTO-derived reaction template policy provided by the authors. Both LEADD and GB-GA designed less synthesizable molecules than those found by the VS, but when using Morgan atom types LEADD designed considerably more synthesizable molecules than GB-GA (Fig. <xref rid="Fig15" ref-type="fig">15</xref>). It’s worth noting that only 60% of the molecules selected by the VS from the ChEMBL subset were deemed synthesizable by the retrosynthetic analyses. If we assume that all molecules in ChEMBL are synthesizable this would suggest that we might be underestimating the SA of molecules, including those designed by the EAs.<fig id="Fig15"><label>Fig. 15</label><caption><p>Fraction of top-10 scored molecules per replica synthesizable by LEADD (with different settings), GB-GA and VS in <italic>N</italic> or less steps using ZINC reactants and USPTO reaction templates, as assessed by AiZynthFinder. Molecules requiring more than 8 synthetic steps are considered not synthesizable</p></caption><graphic xlink:href="13321_2022_582_Fig15_HTML" id="MO18"/></fig></p>
      <p id="Par89">Interestingly, we didn’t observe a statistically significant difference in OP stochastic dominance between LEADD with Morgan atom types and GB-GA (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S13). Given that EAs are stochastic in nature, one would typically run multiple replicas and keep the best results. This justifies comparing maximum instead of average benchmark scores. In terms of maximum score, LEADD with Morgan atom types performed comparably or better than GB-GA in 16/27 benchmarks and comparably or better than the VS in 23/27 benchmarks (Fig. <xref rid="Fig16" ref-type="fig">16</xref>). Crucially, LEADD performed better than GB-GA in the Deco Hop and Scaffold Hop benchmarks, which are arguably the most representative of real drug discovery problems.<fig id="Fig16"><label>Fig. 16</label><caption><p>Optimization power comparison between LEADD, GB-GA and a VS. Benchmark scores range between 0 and 1, with higher scores being better. Boxes represent interquartile ranges (IQR), the black line within them medians and the whiskers Q ± 1.5IQR. Data beyond the whiskers are considered outliers and represented as dots. Colored dots represent maximum benchmark scores. Note that VS results are deterministic and have null variability</p></caption><graphic xlink:href="13321_2022_582_Fig16_HTML" id="MO17"/></fig></p>
      <p id="Par90">We would like to note that goal-directed design employing structure-based scoring functions is associated with an additional set of challenges that isn’t posed by the ligand-based GuacaMol benchmark suite, including the handling of stereochemistry, pose inversion and the typical bias of these scoring functions towards large, hydrophobic and flexible molecules. Indeed, preliminary results using OpenEye ROCS [<xref ref-type="bibr" rid="CR57">57</xref>, <xref ref-type="bibr" rid="CR58">58</xref>] as LEADD’s scoring function show a tendency towards designing large and very cyclic molecules. This also makes it challenging to compare 2D molecular design algorithms like LEADD and GB-GA to their 3D counterparts [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR39">39</xref>].</p>
      <p id="Par91">It’s also important to consider the amount of computational resources spent by each approach to achieve its results. Figure <xref rid="Fig17" ref-type="fig">17</xref> shows how an average EA replica finds higher scoring molecules than a VS with a smaller number of scoring function calls. While one should keep in mind that it’s generally desirable to run multiple EA replicas, EAs make better use of computational resources than a VS, especially if evaluating the scoring function is expensive. It’s also worth noting that LEADD, despite its use of fragments, didn’t find solutions much slower than GB-GA (Fig. <xref rid="Fig17" ref-type="fig">17</xref>). Naturally, there is an overhead associated with the design algorithm. On a single core of a Xeon E5-2680v2 CPU (2.8 GHz), LEADD designed on average 272 mol/s. Assuming that about 10<sup>4</sup>–10<sup>5</sup> molecules must be designed to find good solutions (Fig. <xref rid="Fig17" ref-type="fig">17</xref>) this corresponds to an overhead of just a couple CPU minutes. For comparison GB-GA designed 98 mol/s. This difference in performance is mostly due to implementation optimizations rather than due to algorithmic differences since LEADD is considerably more complex algorithmically. When using fast scoring functions molecule generation can become the rate limiting step. During the GuacaMol benchmark suite LEADD generated molecules slower than they were scored in 25/27 benchmarks. On average, molecules were designed eightfold slower than they were scored, with differences exceeding 20-fold in some benchmarks. This showcases the need for fast molecular design algorithms. Note that the reported values are averages, and that execution times depend heavily on the number of possibilities the algorithm has to consider. For instance, when using a smaller database of fragments or smaller population the algorithm is faster. Similarly, the computational resources spent per operation increase with molecular complexity, specifically degree of branching.<fig id="Fig17"><label>Fig. 17</label><caption><p>Score of best found molecule as a function of the number of scored molecules. For LEADD and GB-GA each line represents a replica. VS results were shuffled 100 times and averaged to account for the effects of molecule screening order. Note that these are individual molecule scores and not population/benchmark scores and therefore don’t correspond to the values in Fig. <xref rid="Fig16" ref-type="fig">16.</xref></p></caption><graphic xlink:href="13321_2022_582_Fig17_HTML" id="MO19"/></fig></p>
      <p id="Par92">If one wishes to achieve even greater OP it’s possible to use the results of a VS as the starting population for EAs. While we don’t believe this qualifies as de novo molecular design, this type of molecular optimization may be interesting when computational resources are abundant. Unsurprisingly, we found that using VS results as starting populations decreased the variability between replicas and increased the mean replica score (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). However, when using Morgan atom types this didn’t always translate into higher maximum scores, as the starting population may already be close to local fitness minima in which the algorithm might get stuck. It’s interesting to note that, while the molecules designed this way have better SA than those in a true de novo design setting, it’s worse than that of the starting population (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10). The SA loss is small for LEADD with Morgan atom types, but substantial for GB-GA and LEADD with dummy atom types, in the latter case almost reverting to the de novo design values. This showcases a tendency to design synthetically complex molecules when algorithms form bonds carelessly.</p>
    </sec>
    <sec id="Sec21">
      <title>Meaning of synthetic accessibility</title>
      <p id="Par93">Something all SA assessment tools have in common is that their judgements aren’t absolute but rather relative to the current chemical state of the art. Many DNDD algorithms, including LEADD, try to optimize the values of these SA predictions. One of the main appeals of DNDD is that it can suggest novel molecules. But if we constrict our search to the known types of chemistry that boast good SA predictions, how novel will these molecules truly be? Could our favor of the familiar lead us to neglect large areas of (potentially interesting) chemical space? Given the large uncertainty surrounding molecular activity predictions focusing research efforts on familiar chemistry is a reasonable way of increasing a project’s chances of success, but at a larger scale we risk creating a self-perpetuating cycle that could lead to academic stagnation. If we are confident enough in the accuracy of our scoring functions perhaps we shouldn’t hold historic data in such high regard and occasionally venture into unknown territory.</p>
    </sec>
  </sec>
  <sec id="Sec22">
    <title>Conclusions</title>
    <p id="Par94">We describe a novel set of genetic operators for fragment- and graph-based evolutionary molecular design algorithms that can enforce an arbitrary set of atom compatibility rules in a computationally efficient manner. Here we applied these genetic operators to achieve an improvement in OP and SA of designed molecules compared to other EAs.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec24">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13321_2022_582_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1. </bold> Additional figures, tables and methodology, including fragment database information, LEADD settings and statistical test results.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>VS</term>
        <def>
          <p id="Par3">Virtual screen/virtual screening</p>
        </def>
      </def-item>
      <def-item>
        <term>SA</term>
        <def>
          <p id="Par4">Synthetically accessible/synthetic accessibility</p>
        </def>
      </def-item>
      <def-item>
        <term>OP</term>
        <def>
          <p id="Par5">Optimization power</p>
        </def>
      </def-item>
      <def-item>
        <term>EA</term>
        <def>
          <p id="Par6">Evolutionary algorithm</p>
        </def>
      </def-item>
      <def-item>
        <term>DNDD</term>
        <def>
          <p id="Par7">De novo drug design</p>
        </def>
      </def-item>
      <def-item>
        <term>SSSR</term>
        <def>
          <p id="Par8">Smallest Set of Smallest Rings</p>
        </def>
      </def-item>
      <def-item>
        <term>CXSMILES</term>
        <def>
          <p id="Par9">ChemAxon extended SMILES</p>
        </def>
      </def-item>
      <def-item>
        <term>MBPM</term>
        <def>
          <p id="Par10">Maximum Bipartite Matching Problem</p>
        </def>
      </def-item>
      <def-item>
        <term>MSI</term>
        <def>
          <p id="Par11">Multiple set intersection</p>
        </def>
      </def-item>
      <def-item>
        <term>ANOVA</term>
        <def>
          <p id="Par12">Analysis of variance</p>
        </def>
      </def-item>
      <def-item>
        <term>FWER</term>
        <def>
          <p id="Par13">Family-wise error rate</p>
        </def>
      </def-item>
      <def-item>
        <term>USPTO</term>
        <def>
          <p id="Par14">United States Patent and Trademark Office</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The computational resources and services used in this work were provided by the Flemish Supercomputer Center (VSC), funded by the Research Foundation Flanders (FWO) and the Flemish Government. We would like to thank Engelbert Tijskens for assisting with the creation of LEADD’s Python bindings and the CalcUA staff for providing technical support.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>AK developed and benchmarked the algorithm and software. HDW supervised the research. Both authors contributed in writing the publication. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by a PhD Grant to Alan Kerstjens from the Research Foundation Flanders (FWO) (FWO-project 39461).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>LEADD’s source code can be found on the project’s GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/UAMCAntwerpen/LEADD">https://github.com/UAMCAntwerpen/LEADD</ext-link>). Fragments and compatibility rules were extracted from the GuacaMol “all SMILES” (v1) dataset, available at the GuacaMol GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/BenevolentAI/guacamol">https://github.com/BenevolentAI/guacamol</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes notes-type="COI-statement">
      <title>Competing interests</title>
      <p>Not applicable.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sterling</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Irwin</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>ZINC 15—ligand discovery for everyone</article-title>
        <source>J Chem Inf Model</source>
        <year>2015</year>
        <volume>55</volume>
        <fpage>2324</fpage>
        <lpage>2337</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00559</pub-id>
        <?supplied-pmid 26479676?>
        <pub-id pub-id-type="pmid">26479676</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>SC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pfizer global virtual library (PGVL): a chemistry design tool powered by experimentally validated parallel synthesis information</article-title>
        <source>ACS Comb Sci</source>
        <year>2012</year>
        <volume>14</volume>
        <fpage>579</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1021/co300096q</pub-id>
        <?supplied-pmid 23020747?>
        <pub-id pub-id-type="pmid">23020747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chevillard</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kolb</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>SCUBIDOO: a Large yet screenable and easily searchable database of computationally created chemical compounds optimized toward high likelihood of synthetic tractability</article-title>
        <source>J Chem Inf Model</source>
        <year>2015</year>
        <volume>55</volume>
        <fpage>1824</fpage>
        <lpage>1835</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00203</pub-id>
        <?supplied-pmid 26282054?>
        <pub-id pub-id-type="pmid">26282054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruddigkeit</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Van Deursen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Blum</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Reymond</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Enumeration of 166 billion organic small molecules in the chemical universe database GDB-17</article-title>
        <source>J Chem Inf Model</source>
        <year>2012</year>
        <volume>52</volume>
        <fpage>2864</fpage>
        <lpage>2875</lpage>
        <pub-id pub-id-type="doi">10.1021/ci300415d</pub-id>
        <?supplied-pmid 23088335?>
        <pub-id pub-id-type="pmid">23088335</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ertl</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Cheminformatics analysis of organic substituents: identification of the most common substituents, calculation of substituent properties, and automatic identification of drug-like bioisosteric groups</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2003</year>
        <volume>34</volume>
        <fpage>374</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1002/chin.200321198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Polishchuk</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Madzhidov</surname>
            <given-names>TI</given-names>
          </name>
          <name>
            <surname>Varnek</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Estimation of the size of drug-like chemical space based on GDB-17 data</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2013</year>
        <volume>27</volume>
        <fpage>675</fpage>
        <lpage>679</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-013-9672-4</pub-id>
        <?supplied-pmid 23963658?>
        <pub-id pub-id-type="pmid">23963658</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bohacek</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>McMartin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Guida</surname>
            <given-names>WC</given-names>
          </name>
        </person-group>
        <article-title>The art and practice of structure-based drug design: a molecular modeling perspective</article-title>
        <source>Med Res Rev</source>
        <year>1996</year>
        <volume>16</volume>
        <fpage>3</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1098-1128(199601)16:1&lt;3::AID-MED1&gt;3.0.CO;2-6</pub-id>
        <?supplied-pmid 8788213?>
        <pub-id pub-id-type="pmid">8788213</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Boström</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Analysis of past and present synthetic methodologies on medicinal chemistry: where have all the new reactions gone?</article-title>
        <source>J Med Chem</source>
        <year>2016</year>
        <volume>59</volume>
        <fpage>4443</fpage>
        <lpage>4458</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jmedchem.5b01409</pub-id>
        <?supplied-pmid 26571338?>
        <pub-id pub-id-type="pmid">26571338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schneider</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Sayle</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Big data from pharmaceutical patents: a computational analysis of medicinal chemists bread and butter</article-title>
        <source>J Med Chem</source>
        <year>2016</year>
        <volume>59</volume>
        <fpage>4385</fpage>
        <lpage>4402</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jmedchem.6b00153</pub-id>
        <?supplied-pmid 27028220?>
        <pub-id pub-id-type="pmid">27028220</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Virshup</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Contreras-García</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wipf</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Stochastic voyages into uncharted chemical space produce a representative library of all possible drug-like compounds</article-title>
        <source>J Am Chem Soc</source>
        <year>2013</year>
        <volume>135</volume>
        <fpage>7296</fpage>
        <lpage>7303</lpage>
        <pub-id pub-id-type="doi">10.1021/ja401184g</pub-id>
        <?supplied-pmid 23548177?>
        <pub-id pub-id-type="pmid">23548177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Afonina</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping of the available chemical space versus the chemical universe of lead-like compounds</article-title>
        <source>ChemMedChem</source>
        <year>2018</year>
        <volume>13</volume>
        <fpage>540</fpage>
        <lpage>554</lpage>
        <pub-id pub-id-type="doi">10.1002/cmdc.201700561</pub-id>
        <?supplied-pmid 29154440?>
        <pub-id pub-id-type="pmid">29154440</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schneider</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fechner</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Computer-based de novo design of drug-like molecules</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2005</year>
        <volume>4</volume>
        <fpage>649</fpage>
        <lpage>663</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd1799</pub-id>
        <?supplied-pmid 16056391?>
        <pub-id pub-id-type="pmid">16056391</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fiscato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Segler</surname>
            <given-names>MHS</given-names>
          </name>
          <name>
            <surname>Vaucher</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>GuacaMol: benchmarking models for de novo molecular design</article-title>
        <source>J Chem Inf Model</source>
        <year>2019</year>
        <volume>59</volume>
        <fpage>1096</fpage>
        <lpage>1108</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.8b00839</pub-id>
        <?supplied-pmid 30887799?>
        <pub-id pub-id-type="pmid">30887799</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Coley</surname>
            <given-names>CW</given-names>
          </name>
        </person-group>
        <article-title>The synthesizability of molecules proposed by generative models</article-title>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <fpage>5714</fpage>
        <lpage>5723</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.0c00174</pub-id>
        <?supplied-pmid 32250616?>
        <pub-id pub-id-type="pmid">32250616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rotstein</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Murcko</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>GroupBuild: a fragment-based method for de novo drug design</article-title>
        <source>J Med Chem</source>
        <year>1993</year>
        <volume>36</volume>
        <fpage>1700</fpage>
        <lpage>1710</lpage>
        <pub-id pub-id-type="doi">10.1021/jm00064a003</pub-id>
        <pub-id pub-id-type="pmid">8510098</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Glen</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Payne</surname>
            <given-names>AWR</given-names>
          </name>
        </person-group>
        <article-title>A genetic algorithm for the automated generation of molecules within constraints</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>1995</year>
        <volume>9</volume>
        <fpage>181</fpage>
        <lpage>202</lpage>
        <pub-id pub-id-type="doi">10.1007/BF00124408</pub-id>
        <?supplied-pmid 7608749?>
        <pub-id pub-id-type="pmid">7608749</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gillet</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Myatt</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zsoldos</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>SPROUT, HIPPO and CAESA: tools for de novo structure generation and estimation of synthetic accessibility</article-title>
        <source>Perspect Drug Discov Des</source>
        <year>1995</year>
        <volume>3</volume>
        <fpage>34</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02174466</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ertl</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schuffenhauer</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Estimation of synthetic accessibility score of drug-like molecules based on molecular complexity and fragment contributions</article-title>
        <source>J Cheminform</source>
        <year>2009</year>
        <volume>1</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-1-8</pub-id>
        <pub-id pub-id-type="pmid">20142984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Voršilák</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kolář</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Čmelo</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Svozil</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>SYBA: Bayesian estimation of synthetic accessibility of organic compounds</article-title>
        <source>J Cheminform</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>35</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-020-00439-2</pub-id>
        <?supplied-pmid 33431015?>
        <pub-id pub-id-type="pmid">33431015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segler</surname>
            <given-names>MHS</given-names>
          </name>
          <name>
            <surname>Preuss</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Waller</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Planning chemical syntheses with deep neural networks and symbolic AI</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>555</volume>
        <fpage>604</fpage>
        <lpage>610</lpage>
        <pub-id pub-id-type="doi">10.1038/nature25978</pub-id>
        <?supplied-pmid 29595767?>
        <pub-id pub-id-type="pmid">29595767</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Genheden</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Thakkar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chadimová</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>AiZynthFinder: a fast, robust and flexible open-source software for retrosynthetic planning</article-title>
        <source>J Cheminform</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-020-00472-1</pub-id>
        <pub-id pub-id-type="pmid">33430988</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pei</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>LigBuilder 2: a practical de novo drug design approach</article-title>
        <source>J Chem Inf Model.</source>
        <year>2011</year>
        <volume>51</volume>
        <fpage>1083</fpage>
        <lpage>1091</lpage>
        <pub-id pub-id-type="doi">10.1021/ci100350u</pub-id>
        <?supplied-pmid 21513346?>
        <pub-id pub-id-type="pmid">21513346</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinmann</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Using a genetic algorithm to find molecules with good docking scores</article-title>
        <source>PeerJ Phys Chem</source>
        <year>2021</year>
        <volume>3</volume>
        <fpage>e18</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj-pchem.18</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dey</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Caflisch</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Fragment-based de novo ligand design by multi-objective evolutionary optimization</article-title>
        <source>Supporting Information J Chem Inf Model</source>
        <year>2008</year>
        <volume>48</volume>
        <fpage>679</fpage>
        <lpage>690</lpage>
        <pub-id pub-id-type="doi">10.1021/ci700424b</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicolaou</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Apostolakis</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pattichis</surname>
            <given-names>CS</given-names>
          </name>
        </person-group>
        <article-title>De novo drug design using multiobjective evolutionary graphs</article-title>
        <source>J Chem Inf Model</source>
        <year>2009</year>
        <volume>49</volume>
        <fpage>295</fpage>
        <lpage>307</lpage>
        <pub-id pub-id-type="doi">10.1021/ci800308h</pub-id>
        <?supplied-pmid 19434831?>
        <pub-id pub-id-type="pmid">19434831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schneider</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Stahl</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>De novo design of molecular architectures by evolutionary assembly of drug-derived building blocks</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2000</year>
        <volume>14</volume>
        <fpage>487</fpage>
        <lpage>494</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1008184403558</pub-id>
        <?supplied-pmid 10896320?>
        <pub-id pub-id-type="pmid">10896320</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fechner</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Flux (1): A virtual synthesis scheme for fragment-based de novo design</article-title>
        <source>J Chem Inf Model</source>
        <year>2006</year>
        <volume>46</volume>
        <fpage>699</fpage>
        <lpage>707</lpage>
        <pub-id pub-id-type="doi">10.1021/ci0503560</pub-id>
        <?supplied-pmid 16563000?>
        <pub-id pub-id-type="pmid">16563000</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vinkers</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>De Jonge</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Daeyaert</surname>
            <given-names>FFD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SYNOPSIS: SYNthesize and OPtimize system in silico</article-title>
        <source>J Med Chem</source>
        <year>2003</year>
        <volume>46</volume>
        <fpage>2765</fpage>
        <lpage>2773</lpage>
        <pub-id pub-id-type="doi">10.1021/jm030809x</pub-id>
        <?supplied-pmid 12801239?>
        <pub-id pub-id-type="pmid">12801239</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hartenfeller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zettl</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dogs: reaction-driven de novo design of bioactive compounds</article-title>
        <source>PLoS Comput Biol</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>e1002380</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002380</pub-id>
        <?supplied-pmid 22359493?>
        <pub-id pub-id-type="pmid">22359493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spiegel</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Durrant</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>AutoGrow4: an open-source genetic algorithm for de novo drug design and lead optimization</article-title>
        <source>J Cheminform</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1186/s13321-020-00429-4</pub-id>
        <pub-id pub-id-type="pmid">33430988</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gómez-Bombarelli</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Duvenaud</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic chemical design using a data-driven continuous representation of molecules</article-title>
        <source>ACS Cent Sci</source>
        <year>2018</year>
        <volume>4</volume>
        <fpage>268</fpage>
        <lpage>276</lpage>
        <pub-id pub-id-type="doi">10.1021/acscentsci.7b00572</pub-id>
        <?supplied-pmid 29532027?>
        <pub-id pub-id-type="pmid">29532027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grisoni</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Moret</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lingwood</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Bidirectional molecule generation with recurrent neural networks</article-title>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <fpage>1175</fpage>
        <lpage>1183</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.9b00943</pub-id>
        <?supplied-pmid 31904964?>
        <pub-id pub-id-type="pmid">31904964</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Putin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Asadulaev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ivanenkov</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reinforced adversarial neural computer for de novo molecular design</article-title>
        <source>J Chem Inf Model</source>
        <year>2018</year>
        <volume>58</volume>
        <fpage>1194</fpage>
        <lpage>1204</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.7b00690</pub-id>
        <?supplied-pmid 29762023?>
        <pub-id pub-id-type="pmid">29762023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kawai</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nagata</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>De novo design of drug-like molecules by a fragment-based molecular evolutionary approach</article-title>
        <source>J Chem Inf Model</source>
        <year>2014</year>
        <volume>54</volume>
        <fpage>49</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.1021/ci400418c</pub-id>
        <?supplied-pmid 24372539?>
        <pub-id pub-id-type="pmid">24372539</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jensen</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>A graph-based genetic algorithm and generative model/Monte Carlo tree search for the exploration of chemical space</article-title>
        <source>Chem Sci</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>3567</fpage>
        <lpage>3572</lpage>
        <pub-id pub-id-type="doi">10.1039/c8sc05372c</pub-id>
        <?supplied-pmid 30996948?>
        <pub-id pub-id-type="pmid">30996948</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Douguet</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Thoreau</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Grassy</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>A genetic algorithm for the automated generation of small organic molecules: drug design using an evolutionary algorithm</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2000</year>
        <volume>14</volume>
        <fpage>449</fpage>
        <lpage>466</lpage>
        <pub-id pub-id-type="doi">10.1023/a:1008108423895</pub-id>
        <?supplied-pmid 10896317?>
        <pub-id pub-id-type="pmid">10896317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pegg</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Haresco</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Kuntz</surname>
            <given-names>ID</given-names>
          </name>
        </person-group>
        <article-title>A genetic algorithm for structure-based de novo design</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2001</year>
        <volume>15</volume>
        <fpage>911</fpage>
        <lpage>933</lpage>
        <pub-id pub-id-type="doi">10.1023/a:1014389729000</pub-id>
        <?supplied-pmid 11918076?>
        <pub-id pub-id-type="pmid">11918076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>McKay</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gilardoni</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gasteiger</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A graph-based genetic algorithm and its application to the multiobjective evolution of median molecules</article-title>
        <source>ChemInform</source>
        <year>2004</year>
        <volume>35</volume>
        <fpage>1079</fpage>
        <lpage>1087</lpage>
        <pub-id pub-id-type="doi">10.1002/chin.200431198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Douguet</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Munier-Lehmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Labesse</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pochet</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>LEA3D: a computer-aided ligand design for structure-based drug design</article-title>
        <source>J Med Chem</source>
        <year>2005</year>
        <volume>48</volume>
        <fpage>2457</fpage>
        <lpage>2468</lpage>
        <pub-id pub-id-type="doi">10.1021/jm0492296</pub-id>
        <?supplied-pmid 15801836?>
        <pub-id pub-id-type="pmid">15801836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Halgren</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>Merck molecular force field</article-title>
        <source>J Comput Chem</source>
        <year>1996</year>
        <volume>17</volume>
        <fpage>490</fpage>
        <lpage>519</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1096-987X(199604)17:5/6&lt;520::AID-JCC2&gt;3.0.CO;2-W</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morgan</surname>
            <given-names>HL</given-names>
          </name>
        </person-group>
        <article-title>The generation of a unique machine description for chemical structures—a technique developed at chemical abstracts service</article-title>
        <source>J Chem Doc</source>
        <year>1965</year>
        <volume>5</volume>
        <fpage>107</fpage>
        <lpage>113</lpage>
        <pub-id pub-id-type="doi">10.1021/c160017a018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rogers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hahn</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Extended-connectivity fingerprints</article-title>
        <source>J Chem Inf Model</source>
        <year>2010</year>
        <volume>50</volume>
        <fpage>742</fpage>
        <lpage>754</lpage>
        <pub-id pub-id-type="doi">10.1021/ci100050t</pub-id>
        <?supplied-pmid 20426451?>
        <pub-id pub-id-type="pmid">20426451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">RDKit: Open-source cheminformatics. <ext-link ext-link-type="uri" xlink:href="http://www.rdkit.org/">http://www.rdkit.org/</ext-link></mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Flamm</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gleiss</surname>
            <given-names>PM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Counterexamples in chemical ring perception</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2004</year>
        <volume>44</volume>
        <fpage>323</fpage>
        <lpage>331</lpage>
        <pub-id pub-id-type="doi">10.1021/ci030405d</pub-id>
        <?supplied-pmid 15032507?>
        <pub-id pub-id-type="pmid">15032507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">ChemAxon ChemAxon Extended SMILES and SMARTS - CXSMILES and CXSMARTS. <ext-link ext-link-type="uri" xlink:href="https://docs.chemaxon.com/display/docs/chemaxon-extended-smiles-and-smarts-cxsmiles-and-cxsmarts.md">https://docs.chemaxon.com/display/docs/chemaxon-extended-smiles-and-smarts-cxsmiles-and-cxsmarts.md</ext-link>. Accessed 10 Sep 2021</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Hipp DR SQLite. <ext-link ext-link-type="uri" xlink:href="https://www.sqlite.org">https://www.sqlite.org</ext-link></mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lindert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Durrant</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Mccammon</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>LigMerge: a fast algorithm to generate models of novel potential ligands from sets of known binders</article-title>
        <source>Chem Biol Drug Des</source>
        <year>2012</year>
        <volume>80</volume>
        <fpage>358</fpage>
        <lpage>365</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1747-0285.2012.01414.x</pub-id>
        <?supplied-pmid 22594624?>
        <pub-id pub-id-type="pmid">22594624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Hopcroft JE, Karp RM (1971) N5/2 Algorithm for Maximum Matchings in Bipartite Graphs. pp 122–125</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">The HDF Group HDF5. <ext-link ext-link-type="uri" xlink:href="https://www.hdfgroup.org/solutions/hdf5">https://www.hdfgroup.org/solutions/hdf5</ext-link></mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaulton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bellis</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Bento</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChEMBL: a large-scale bioactivity database for drug discovery</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>1100</fpage>
        <lpage>1107</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr777</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mann</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Whitney</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>On a test of whether one of two random variables is stochastically larger than the other</article-title>
        <source>Ann Math Stat</source>
        <year>1947</year>
        <volume>18</volume>
        <fpage>50</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177730491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kruskal</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Wallis</surname>
            <given-names>WA</given-names>
          </name>
        </person-group>
        <article-title>Use of ranks in one-criterion variance analysis</article-title>
        <source>J Am Stat Assoc</source>
        <year>1952</year>
        <volume>47</volume>
        <fpage>583</fpage>
        <lpage>621</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1952.10483441</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scheirer</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Ray</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Hare</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>The analysis of ranked data derived from completely randomized factorial designs</article-title>
        <source>Biometrics</source>
        <year>1976</year>
        <volume>32</volume>
        <fpage>429</fpage>
        <lpage>434</lpage>
        <pub-id pub-id-type="doi">10.2307/2529511</pub-id>
        <pub-id pub-id-type="pmid">953139</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conover</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Iman</surname>
            <given-names>RL</given-names>
          </name>
        </person-group>
        <article-title>Rank transformations as a bridge between parametric and nonparametric statistics</article-title>
        <source>Am Stat</source>
        <year>1981</year>
        <volume>35</volume>
        <fpage>124</fpage>
        <lpage>129</lpage>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Šidák</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Rectangular confidence regions for the means of multivariate normal distributions</article-title>
        <source>J Am Stat Assoc</source>
        <year>1967</year>
        <volume>62</volume>
        <fpage>626</fpage>
        <lpage>633</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1967.10482935</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hartenfeller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Proschak</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schüller</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Concept of combinatorial de novo design of drug-like molecules by particle swarm optimization</article-title>
        <source>Chem Biol Drug Des</source>
        <year>2008</year>
        <volume>72</volume>
        <fpage>16</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1747-0285.2008.00672.x</pub-id>
        <?supplied-pmid 18564216?>
        <pub-id pub-id-type="pmid">18564216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hawkins</surname>
            <given-names>PCD</given-names>
          </name>
          <name>
            <surname>Skillman</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Nicholls</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Comparison of shape-matching and docking as virtual screening tools</article-title>
        <source>J Med Chem</source>
        <year>2007</year>
        <volume>50</volume>
        <fpage>74</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1021/jm0603365</pub-id>
        <pub-id pub-id-type="pmid">17201411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">OpenEye Scientific Software ROCS. <ext-link ext-link-type="uri" xlink:href="https://www.eyesopen.com">https://www.eyesopen.com</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
