<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11021805</article-id>
    <article-id pub-id-type="pmid">38552327</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae172</article-id>
    <article-id pub-id-type="publisher-id">btae172</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>shinyExprPortal: a configurable ‘shiny’ portal for sharing analysis of molecular expression data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5511-5230</contrib-id>
        <name>
          <surname>Henkin</surname>
          <given-names>Rafael</given-names>
        </name>
        <aff><institution>Centre for Translational Bioinformatics, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Digital Environment Research Institute, Queen Mary University of London</institution>, London E1 1HH, <country country="GB">United Kingdom</country></aff>
        <xref rid="btae172-cor1" ref-type="corresp"/>
        <!--r.henkin@qmul.ac.uk-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Goldmann</surname>
          <given-names>Katriona</given-names>
        </name>
        <aff><institution>Centre for Experimental Medicine and Rheumatology, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Alan Turing Institute</institution>, London NW1 2DB, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9365-5345</contrib-id>
        <name>
          <surname>Lewis</surname>
          <given-names>Myles</given-names>
        </name>
        <aff><institution>Centre for Translational Bioinformatics, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Centre for Experimental Medicine and Rheumatology, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barnes</surname>
          <given-names>Michael R</given-names>
        </name>
        <aff><institution>Centre for Translational Bioinformatics, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Digital Environment Research Institute, Queen Mary University of London</institution>, London E1 1HH, <country country="GB">United Kingdom</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Nikolski</surname>
          <given-names>Macha</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae172-cor1">Corresponding author. Centre for Translational Bioinformatics, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square, London EC1M 6BQ, United Kingdom. E-mail: <email>r.henkin@qmul.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-03-29">
      <day>29</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>4</issue>
    <elocation-id>btae172</elocation-id>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>17</day>
        <month>3</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>3</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>16</day>
        <month>4</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae172.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The scale of omics research presents many obstacles to full sharing and access to analysis results. Current publication models impose limits on the number of pages and figures, requiring careful preparation and selection of content. At the same time, depositing data in open repositories significantly shifts the burden of access and reproduction to readers, who may include people who are not programmers or analysts.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce shinyExprPortal, an R package that implements omics web portals with minimal coding effort. The portals allow exploration of transcriptomic or proteomic expression data and phenotypes, showcasing results of various types of analysis including differential expression, co-expression and pathways analysis. The integration with bioinformatics workflows enables researchers to focus on their results and share findings using interactive and publication-quality plots.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The shinyExprPortal package is available to download and install from CRAN and <ext-link xlink:href="https://github.com/C4TB/shinyExprPortal" ext-link-type="uri">https://github.com/C4TB/shinyExprPortal</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Health Data Research UK</institution>
            <institution-id institution-id-type="DOI">10.13039/501100023699</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Bioinformatics researchers have many interactive tools at their disposal to conduct omics analysis without having to learn how to code (<xref rid="btae172-B1" ref-type="bibr">Barrett <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btae172-B8" ref-type="bibr">Lonsdale <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btae172-B16" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> 2019</xref>). However, when it comes to sharing the results of those analyses, the traditional publication model still imposes limits on the number of pages and figures, thus requiring the careful preparation of content that will convey the key messages of the paper and capture the attention of readers. Other potentially relevant figures, e.g. showing alternative analyses, are relegated to a supplementary material document or are not shown at all. Researchers can also share materials such as raw data, analysis scripts and other documents in repositories such as figshare (<ext-link xlink:href="https://figshare.com" ext-link-type="uri">https://figshare.com</ext-link>), Zenodo (<xref rid="btae172-B3" ref-type="bibr">European Organization For Nuclear Research and OpenAIRE 2013</xref>), and OSF (<ext-link xlink:href="https://osf.io" ext-link-type="uri">https://osf.io</ext-link>). Readers who are interested in exploring results or expression data, technically minded or not, are then left with the task of sorting through folders and files to hopefully find what is needed to reproduce an analysis.</p>
    <p>For transcriptomics data, repositories such as the Gene Expression Omnibus (GEO) allow users to browse and search data from published papers and conduct relatively simple analysis with R scripts, whilst tools that connect to GEO through an application programming interface (API), such as GEOExplorer (<xref rid="btae172-B4" ref-type="bibr">Hunt <italic toggle="yes">et al.</italic> 2022</xref>), ease the programming demands from the users. In this case, the original researchers no longer have control over the analysis parameters and presentation of their work, possibly leading to misleading findings. To maintain the researcher’s original analysis framework whilst still allowing user exploration, researchers can use packages such as Shiny (<xref rid="btae172-B2" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> 2022</xref>) and Streamlit (<ext-link xlink:href="https://streamlit.io/" ext-link-type="uri">https://streamlit.io/</ext-link>) to create web applications that effectively serve as interactive supplements or data portals (<xref rid="btae172-B7" ref-type="bibr">Lewis <italic toggle="yes">et al.</italic> 2019</xref>). Creating high-quality portals, however, requires significant effort, expertise and time, with an ongoing maintenance burden. Depending on the structure and timeline of the projects, the long-term sustainability of software also becomes an issue if there is a lack of funding or even interest from authors.</p>
    <p>To address these issues, this paper introduces shinyExprPortal, an R package that enables the deployment of web portals for molecular expression data using a text-based configuration file and requiring minimal coding. The package and resulting portal were designed with two general goals in mind: allowing simple data exploration and showcasing analysis results as the original researchers intended them to be presented. Both goals are supported by the use of interactive and publication-quality plots in modules for the exploration of correlations between expression and phenotype data, such as clinical measures of patients, as well as modules for showcasing differential expression analysis, gene co-expression and regulatory networks, and groups of genes in general. The package, therefore, is compatible with the outputs of typical bioinformatics tools such as limma, edgeR, WGCNA, and ARACNe (<xref rid="btae172-B10" ref-type="bibr">Margolin <italic toggle="yes">et al.</italic> 2006</xref>, <xref rid="btae172-B6" ref-type="bibr">Langfelder and Horvath 2008</xref>, <xref rid="btae172-B12" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic> 2010</xref>, <xref rid="btae172-B11" ref-type="bibr">Ritchie <italic toggle="yes">et al.</italic> 2015</xref>), as well as any lists of genes produced by pathway analysis tools. In principle, any molecular expression matrix can be accommodated, so the portal can support both transcriptomics, proteomics and potentially metabolomics, although different data types cannot be integrated, due to differing data scales. The modular structure of the package means that it can be used as soon as data is available and new analysis results can be included by different members of a research team. It is also easy to extend the deployed portal with custom modules.</p>
  </sec>
  <sec>
    <title>2 Design rationale</title>
    <p>The design of the package followed the workflow of a typical omic analysis project, starting after the initial preprocessing and quality control steps. It was designed in conversation with researchers across three different projects, based on their workflows and requirements: <italic toggle="yes">minimal programming</italic>, <italic toggle="yes">modularity</italic> and <italic toggle="yes">focus on showcase</italic>. The first principle was translated into the use of a text-based configuration file rather than numerous R functions to set up a portal. The second principle enables portals to be incrementally set up as new results emerge, whilst the third one sets the scope for the package: facilitating the sharing of findings rather than being a tool for bioinformatics analysis workflows.</p>
    <p>Visitors of the portal can investigate sample subsets of interest and explore correlations between gene expression and observed measures, such as clinical data from trials (e.g. lab tests), or compare changes in clinical data and gene expression over time, e.g. an important measure goes down along with expression. This helps people who do not conduct the actual analysis to think about their data and formulate hypotheses. The showcase modules address the lack of interactivity in typical supplementary materials and the difficulty of reproducing figures.</p>
  </sec>
  <sec>
    <title>3 Implementation</title>
    <p>The package was developed primarily using the shiny package from the R ecosystem. It also relies on sveral surrounding packages that add or extend functionality to web apps created with shiny. The visualizations are primarily rendered using the Vega-lite library (<xref rid="btae172-B13" ref-type="bibr">Satyanarayan <italic toggle="yes">et al.</italic> 2017</xref>) via the vegawidget (<xref rid="btae172-B9" ref-type="bibr">Lyttle 2023</xref>) package, with additional views using the iheatmapr (<xref rid="btae172-B14" ref-type="bibr">Schep and Kummerfeld 2017</xref>) package. Interaction with tabular displays is done using the DT (<xref rid="btae172-B15" ref-type="bibr">Xie <italic toggle="yes">et al.</italic> 2023</xref>) package. Additional dependencies are found in the package metadata either on CRAN or GitHub.</p>
    <sec>
      <title>3.1 Data files</title>
      <p>Three main data files are required: an expression matrix with samples in columns and genes (or molecules) in rows, a table with rows containing phenotype data (e.g. blood tests, disease activity assessments) for each subject and a lookup/metadata table with rows for samples and subjects identifiers, also including sample/subject metadata (e.g. cell types, time points, control groups). The expression matrix can contain any kind of numeric value that quantifies expression, from counts to abundance. For simple projects where a subject only has one sample, the lookup table is not required in advance and is automatically created by the package. The package does minimal checks, such as ensuring that there are no samples without a subject and vice-versa, but extended quality control tests must be performed by the study authors, as it would be done when performing any downstream analysis.</p>
    </sec>
    <sec>
      <title>3.2 Configuration file</title>
      <p>The configuration file, based on the YAML data interchange format, is the other primary file that the package depends on to run. It contains all the definitions used to assemble the portal and is the main file that users must edit. The format is based on tab stop indentations and has a human-readable syntax. The package includes a step-by-step interactive function to create a configuration file and a function to create a local example; users can also refer to the complete configuration guide in the package documentation or the configuration file used in the live demo. Once the file is created and edited, the portal can be run with a single line of code that points to its location. As such, the portal can be deployed early in the lifecycle of a project and incremented as it progresses. This setup also enables easy versioning of portal and data as no code needs to be re-run or compiled if the file changes.</p>
      <p>In a minimal setup, users add portal metadata (name, logo file, landing page text file), information about the expression and measures data and define which modules should appear in the portal. Users must also indicate the columns in their data that identify subjects, samples and metadata for the selection of subsets in the interface. <xref rid="btae172-F1" ref-type="fig">Figure 1</xref> shows an example of the portal metadata followed by the data information.</p>
      <fig position="float" id="btae172-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Schematic representation of package use. On the left side, researchers who are setting up the portal create (at least) five files: the expression matrix, the measures (phenotype) data, the lookup table that matches potentially multiple samples to subjects, the configuration file and the app. R file. Visitors accessing the portal can navigate between the modules defined in the configuration file. The example shows a visitor exploring changes between baseline and 6 months, first for one gene, measure and cell type, then switching to another</p>
        </caption>
        <graphic xlink:href="btae172f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Data exploration modules</title>
      <p>The data exploration modules include two overview modules for time-varying data and three correlation-based modules. These modules do not require additional files beyond the expression matrix and measures data. The cohort overview module shows a grid of small lines, where each line corresponds to a patient’s trajectory for a measure over time (e.g. disease activity). The trajectory comparison between groups module displays scatterplots of expression and an observed measure over time, with one scatterplot per a defined subset of samples. In this view, it is possible to see if changes in expression in a gene are associated with changes in measure over time, and if these changes vary or not between groups of samples. The three correlation modules enable exploring the association between a single gene and various measures, all genes and a single measure and all genes and multiple measures. These associations are displayed through scatterplots, tables and heatmaps, respectively. Portal visitors can choose between different correlation measures (Pearson or Spearman), show or hide a fit line and assign variables from the measures data to colours in the scatterplot.</p>
    </sec>
    <sec>
      <title>3.4 Analysis showcase modules</title>
      <p>The showcase modules include support for differential expression results, heatmaps for groups of genes and precomputed projections of genes with average expression overlays. Some of these modules are directly compatible with the outputs of the packages and tools that are used to compute results, whilst others require additional formatting, e.g. using Excel spreadsheets. The detailed DEG module includes volcano plots to display results, with threshold lines indicating the significance of the genes. This module also includes a table to dig deeper into the results, and it is also used as the default view if a differential expression analysis result is incompatible with a volcano plot. The DEG summary module can be used to show aggregate numbers of differentially expressed genes, with adjusted and unadjusted <italic toggle="yes">P</italic>-values, across multiple models.</p>
      <p>Groups of genes extracted from tools such as weighted gene co-expression network analysis (WGCNA), pathways [e.g. KEGG <xref rid="btae172-B5" ref-type="bibr">Kanehisa and Goto (2000)</xref>] or gene expression signatures can be visualized in the gene modules heatmap, with scatterplots displaying the association between module eigengenes and measures. Finally, the gene projection overlay supports displaying pre-computed projections of genes with annotated clusters and analysing the variation of expression across subsets of samples (e.g. how the expression between clusters varies for a subset of high-disease burden patients).</p>
      <p>Each of these modules must have a corresponding section in the configuration file. Some of the fields are required, whilst others can be added for customization (e.g. colours) or to expose or hide certain functions from users (e.g. fit lines in scatterplots). The package documentation includes a complete guide for creating the configuration file, with the required and optional fields as well as examples of how additional files must be created for each module.</p>
    </sec>
    <sec>
      <title>3.5 Navigation example</title>
      <p><xref rid="btae172-F1" ref-type="fig">Figure 1</xref> illustrates an example of how the package works in practice, as seen in the live demonstration portal (<ext-link xlink:href="https://c4tb.github.io/ramap_demo/" ext-link-type="uri">https://c4tb.github.io/ramap_demo/</ext-link>). With the configuration file created and three main data files ready (highlighted by the dashed lines), the portal is set up and a visitor can navigate between the modules. In the figure, the module for comparing changes over time is shown: visitors can choose a gene, a subset of samples and a clinical variable to compare. The interface is populated from the configuration file: the clinical variables that visitors can select are defined by the study authors who are setting up the portal.</p>
    </sec>
    <sec>
      <title>3.6 Extension and customisation</title>
      <p>One of the key aspects of the portal is the support for the addition of new custom modules. By following the examples in the source code, users can extend existing modules and create new ones with additional functionality. Whilst the package has been created with specific goals in mind, this feature allows users to integrate their own plots or analyses, e.g. co-expression networks. As part of the shiny ecosystem, the package also supports the use of Bootswatch themes (<ext-link xlink:href="https://bootswatch.com/" ext-link-type="uri">https://bootswatch.com/</ext-link>) to change the overall look of the portal. Many of the implemented modules also include options to change palettes in plots to align the portal with figures published in the papers.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>We described an R package that facilitates the sharing of analysis of molecular expression data through interactive web portals. By focusing on the creation of a text-based configuration file, it enables easier deployment and maintenance without significant programming requirements. The package contains a set of core visualization modules but can be extensible by researchers who want to display other kinds of results or plots that are not currently supported.</p>
    <p>Unlike current alternatives for sharing findings, such as static documents for supplementary materials and open repositories, shinyExprPortal allows researchers to comment and curate their findings whilst still enabling interested readers to explore alternatives and interact with the results.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Dennis Lendrem, Graham Smith, Sara Masarone and other researchers in the RA-MAP and PSORT consortia for their helpful feedback.</p>
  </ack>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was funded by the Health Data Research UK [LOND1 to R.H. and M.R.B.].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Complete documentation available at <ext-link xlink:href="https://c4tb.github.io/shinyExprPortal/index.html" ext-link-type="uri">https://c4tb.github.io/shinyExprPortal/index.html</ext-link> and live demonstration available at <ext-link xlink:href="https://c4tb.github.io/ramap_demo/" ext-link-type="uri">https://c4tb.github.io/ramap_demo/</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae172-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barrett</surname><given-names>T</given-names></string-name>, <string-name><surname>Wilhite</surname><given-names>SE</given-names></string-name>, <string-name><surname>Ledoux</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>NCBI GEO: archive for functional genomics data sets—update</article-title>. <source>Nucleic Acids Res</source><year>2012</year>;<volume>41</volume>:<fpage>D991</fpage>–<lpage>95</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1193</pub-id><pub-id pub-id-type="pmid">23193258</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>W</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J</given-names></string-name>, <string-name><surname>Allaire</surname><given-names>JJ</given-names></string-name></person-group><etal>et al</etal><italic toggle="yes">Shiny: Web Application Framework for R</italic>. <year>2022</year>.</mixed-citation>
    </ref>
    <ref id="btae172-B3">
      <mixed-citation publication-type="other"><collab>European Organization For Nuclear Research and OpenAIRE</collab>. <italic toggle="yes">Zenodo: Research. Shared</italic>. <year>2013</year>. <pub-id pub-id-type="doi">10.25495/7GXK-RD71</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hunt</surname><given-names>GP</given-names></string-name>, <string-name><surname>Grassi</surname><given-names>L</given-names></string-name>, <string-name><surname>Henkin</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>GEOexplorer: a webserver for gene expression analysis and visualisation</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>W367</fpage>–<lpage>74</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkac364</pub-id><pub-id pub-id-type="pmid">35609980</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M</given-names></string-name>, <string-name><surname>Goto</surname><given-names>S.</given-names></string-name></person-group><article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title>. <source>Nucleic Acids Res</source><year>2000</year>;<volume>28</volume>:<fpage>27</fpage>–<lpage>30</lpage>. <pub-id pub-id-type="doi">10.1093/nar/28.1.27</pub-id><pub-id pub-id-type="pmid">10592173</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Langfelder</surname><given-names>P</given-names></string-name>, <string-name><surname>Horvath</surname><given-names>S.</given-names></string-name></person-group><article-title>WGCNA: an R package for weighted correlation network analysis</article-title>. <source>BMC Bioinformatics</source><year>2008</year>;<volume>9</volume>:<fpage>559</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-9-559</pub-id><pub-id pub-id-type="pmid">19114008</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lewis</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Barnes</surname><given-names>MR</given-names></string-name>, <string-name><surname>Blighe</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular portraits of early rheumatoid arthritis identify clinical and treatment response phenotypes</article-title>. <source>Cell Rep</source><year>2019</year>;<volume>28</volume>:<fpage>2455</fpage>–<lpage>70.e5</lpage>. <pub-id pub-id-type="doi">10.1016/j.celrep.2019.07.091</pub-id><pub-id pub-id-type="pmid">31461658</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lonsdale</surname><given-names>J</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>J</given-names></string-name>, <string-name><surname>Salvatore</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>The genotype-tissue expression (GTEx) project</article-title>. <source>Nat Genet</source><year>2013</year>;<volume>45</volume>:<fpage>580</fpage>–<lpage>5</lpage>. <pub-id pub-id-type="doi">10.1038/ng.2653</pub-id><pub-id pub-id-type="pmid">23715323</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lyttle</surname><given-names>I,</given-names></string-name></person-group><collab>Vega/Vega-Lite Developers</collab>. <italic toggle="yes">Vegawidget: ’htmlwidget’ for ’Vega’ and ’Vega-Lite’</italic>. <year>2023</year>.</mixed-citation>
    </ref>
    <ref id="btae172-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Margolin</surname><given-names>AA</given-names></string-name>, <string-name><surname>Nemenman</surname><given-names>I</given-names></string-name>, <string-name><surname>Basso</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>ARACNE: an algorithm for the reconstruction of gene regulatory networks in a mammalian cellular context</article-title>. <source>BMC Bioinformatics</source><year>2006</year>;<volume>7</volume>:<fpage>S7</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-7-S1-S7</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ritchie</surname><given-names>ME</given-names></string-name>, <string-name><surname>Phipson</surname><given-names>B</given-names></string-name>, <string-name><surname>Wu</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>e47</fpage>. <pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id><pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>MD</given-names></string-name>, <string-name><surname>McCarthy</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>GK</given-names></string-name></person-group><etal>et al</etal><article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source><year>2010</year>;<volume>26</volume>:<fpage>139</fpage>–<lpage>40</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id><pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satyanarayan</surname><given-names>A</given-names></string-name>, <string-name><surname>Moritz</surname><given-names>D</given-names></string-name>, <string-name><surname>Wongsuphasawat</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Vega-Lite: a grammar of interactive graphics</article-title>. <source>IEEE Trans Vis Comput Graph</source><year>2017</year>;<volume>23</volume>:<fpage>341</fpage>–<lpage>50</lpage>. <pub-id pub-id-type="doi">10.1109/TVCG.2016.2599030</pub-id><pub-id pub-id-type="pmid">27875150</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schep</surname><given-names>AN</given-names></string-name>, <string-name><surname>Kummerfeld</surname><given-names>SK.</given-names></string-name></person-group><article-title>Iheatmapr: interactive complex heatmaps in R</article-title>. <source>J Open Source Softw</source><year>2017</year>;<volume>2</volume>:<fpage>359</fpage>. <pub-id pub-id-type="doi">10.21105/joss.00359</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Xie</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J</given-names></string-name>, <string-name><surname>Tan</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><italic toggle="yes">DT: A Wrapper of the JavaScript Library ‘DataTables’</italic>. <year>2023</year>.</mixed-citation>
    </ref>
    <ref id="btae172-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>B</given-names></string-name>, <string-name><surname>Pache</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Metascape provides a biologist-oriented resource for the analysis of systems-level datasets</article-title>. <source>Nat Commun</source><year>2019</year>;<volume>10</volume>:<fpage>1523</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-019-09234-6</pub-id><pub-id pub-id-type="pmid">30944313</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11021805</article-id>
    <article-id pub-id-type="pmid">38552327</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae172</article-id>
    <article-id pub-id-type="publisher-id">btae172</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>shinyExprPortal: a configurable ‘shiny’ portal for sharing analysis of molecular expression data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5511-5230</contrib-id>
        <name>
          <surname>Henkin</surname>
          <given-names>Rafael</given-names>
        </name>
        <aff><institution>Centre for Translational Bioinformatics, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Digital Environment Research Institute, Queen Mary University of London</institution>, London E1 1HH, <country country="GB">United Kingdom</country></aff>
        <xref rid="btae172-cor1" ref-type="corresp"/>
        <!--r.henkin@qmul.ac.uk-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Goldmann</surname>
          <given-names>Katriona</given-names>
        </name>
        <aff><institution>Centre for Experimental Medicine and Rheumatology, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Alan Turing Institute</institution>, London NW1 2DB, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9365-5345</contrib-id>
        <name>
          <surname>Lewis</surname>
          <given-names>Myles</given-names>
        </name>
        <aff><institution>Centre for Translational Bioinformatics, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Centre for Experimental Medicine and Rheumatology, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barnes</surname>
          <given-names>Michael R</given-names>
        </name>
        <aff><institution>Centre for Translational Bioinformatics, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Digital Environment Research Institute, Queen Mary University of London</institution>, London E1 1HH, <country country="GB">United Kingdom</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Nikolski</surname>
          <given-names>Macha</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae172-cor1">Corresponding author. Centre for Translational Bioinformatics, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square, London EC1M 6BQ, United Kingdom. E-mail: <email>r.henkin@qmul.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-03-29">
      <day>29</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>4</issue>
    <elocation-id>btae172</elocation-id>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>17</day>
        <month>3</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>3</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>16</day>
        <month>4</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae172.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The scale of omics research presents many obstacles to full sharing and access to analysis results. Current publication models impose limits on the number of pages and figures, requiring careful preparation and selection of content. At the same time, depositing data in open repositories significantly shifts the burden of access and reproduction to readers, who may include people who are not programmers or analysts.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce shinyExprPortal, an R package that implements omics web portals with minimal coding effort. The portals allow exploration of transcriptomic or proteomic expression data and phenotypes, showcasing results of various types of analysis including differential expression, co-expression and pathways analysis. The integration with bioinformatics workflows enables researchers to focus on their results and share findings using interactive and publication-quality plots.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The shinyExprPortal package is available to download and install from CRAN and <ext-link xlink:href="https://github.com/C4TB/shinyExprPortal" ext-link-type="uri">https://github.com/C4TB/shinyExprPortal</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Health Data Research UK</institution>
            <institution-id institution-id-type="DOI">10.13039/501100023699</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Bioinformatics researchers have many interactive tools at their disposal to conduct omics analysis without having to learn how to code (<xref rid="btae172-B1" ref-type="bibr">Barrett <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btae172-B8" ref-type="bibr">Lonsdale <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btae172-B16" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> 2019</xref>). However, when it comes to sharing the results of those analyses, the traditional publication model still imposes limits on the number of pages and figures, thus requiring the careful preparation of content that will convey the key messages of the paper and capture the attention of readers. Other potentially relevant figures, e.g. showing alternative analyses, are relegated to a supplementary material document or are not shown at all. Researchers can also share materials such as raw data, analysis scripts and other documents in repositories such as figshare (<ext-link xlink:href="https://figshare.com" ext-link-type="uri">https://figshare.com</ext-link>), Zenodo (<xref rid="btae172-B3" ref-type="bibr">European Organization For Nuclear Research and OpenAIRE 2013</xref>), and OSF (<ext-link xlink:href="https://osf.io" ext-link-type="uri">https://osf.io</ext-link>). Readers who are interested in exploring results or expression data, technically minded or not, are then left with the task of sorting through folders and files to hopefully find what is needed to reproduce an analysis.</p>
    <p>For transcriptomics data, repositories such as the Gene Expression Omnibus (GEO) allow users to browse and search data from published papers and conduct relatively simple analysis with R scripts, whilst tools that connect to GEO through an application programming interface (API), such as GEOExplorer (<xref rid="btae172-B4" ref-type="bibr">Hunt <italic toggle="yes">et al.</italic> 2022</xref>), ease the programming demands from the users. In this case, the original researchers no longer have control over the analysis parameters and presentation of their work, possibly leading to misleading findings. To maintain the researcher’s original analysis framework whilst still allowing user exploration, researchers can use packages such as Shiny (<xref rid="btae172-B2" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> 2022</xref>) and Streamlit (<ext-link xlink:href="https://streamlit.io/" ext-link-type="uri">https://streamlit.io/</ext-link>) to create web applications that effectively serve as interactive supplements or data portals (<xref rid="btae172-B7" ref-type="bibr">Lewis <italic toggle="yes">et al.</italic> 2019</xref>). Creating high-quality portals, however, requires significant effort, expertise and time, with an ongoing maintenance burden. Depending on the structure and timeline of the projects, the long-term sustainability of software also becomes an issue if there is a lack of funding or even interest from authors.</p>
    <p>To address these issues, this paper introduces shinyExprPortal, an R package that enables the deployment of web portals for molecular expression data using a text-based configuration file and requiring minimal coding. The package and resulting portal were designed with two general goals in mind: allowing simple data exploration and showcasing analysis results as the original researchers intended them to be presented. Both goals are supported by the use of interactive and publication-quality plots in modules for the exploration of correlations between expression and phenotype data, such as clinical measures of patients, as well as modules for showcasing differential expression analysis, gene co-expression and regulatory networks, and groups of genes in general. The package, therefore, is compatible with the outputs of typical bioinformatics tools such as limma, edgeR, WGCNA, and ARACNe (<xref rid="btae172-B10" ref-type="bibr">Margolin <italic toggle="yes">et al.</italic> 2006</xref>, <xref rid="btae172-B6" ref-type="bibr">Langfelder and Horvath 2008</xref>, <xref rid="btae172-B12" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic> 2010</xref>, <xref rid="btae172-B11" ref-type="bibr">Ritchie <italic toggle="yes">et al.</italic> 2015</xref>), as well as any lists of genes produced by pathway analysis tools. In principle, any molecular expression matrix can be accommodated, so the portal can support both transcriptomics, proteomics and potentially metabolomics, although different data types cannot be integrated, due to differing data scales. The modular structure of the package means that it can be used as soon as data is available and new analysis results can be included by different members of a research team. It is also easy to extend the deployed portal with custom modules.</p>
  </sec>
  <sec>
    <title>2 Design rationale</title>
    <p>The design of the package followed the workflow of a typical omic analysis project, starting after the initial preprocessing and quality control steps. It was designed in conversation with researchers across three different projects, based on their workflows and requirements: <italic toggle="yes">minimal programming</italic>, <italic toggle="yes">modularity</italic> and <italic toggle="yes">focus on showcase</italic>. The first principle was translated into the use of a text-based configuration file rather than numerous R functions to set up a portal. The second principle enables portals to be incrementally set up as new results emerge, whilst the third one sets the scope for the package: facilitating the sharing of findings rather than being a tool for bioinformatics analysis workflows.</p>
    <p>Visitors of the portal can investigate sample subsets of interest and explore correlations between gene expression and observed measures, such as clinical data from trials (e.g. lab tests), or compare changes in clinical data and gene expression over time, e.g. an important measure goes down along with expression. This helps people who do not conduct the actual analysis to think about their data and formulate hypotheses. The showcase modules address the lack of interactivity in typical supplementary materials and the difficulty of reproducing figures.</p>
  </sec>
  <sec>
    <title>3 Implementation</title>
    <p>The package was developed primarily using the shiny package from the R ecosystem. It also relies on sveral surrounding packages that add or extend functionality to web apps created with shiny. The visualizations are primarily rendered using the Vega-lite library (<xref rid="btae172-B13" ref-type="bibr">Satyanarayan <italic toggle="yes">et al.</italic> 2017</xref>) via the vegawidget (<xref rid="btae172-B9" ref-type="bibr">Lyttle 2023</xref>) package, with additional views using the iheatmapr (<xref rid="btae172-B14" ref-type="bibr">Schep and Kummerfeld 2017</xref>) package. Interaction with tabular displays is done using the DT (<xref rid="btae172-B15" ref-type="bibr">Xie <italic toggle="yes">et al.</italic> 2023</xref>) package. Additional dependencies are found in the package metadata either on CRAN or GitHub.</p>
    <sec>
      <title>3.1 Data files</title>
      <p>Three main data files are required: an expression matrix with samples in columns and genes (or molecules) in rows, a table with rows containing phenotype data (e.g. blood tests, disease activity assessments) for each subject and a lookup/metadata table with rows for samples and subjects identifiers, also including sample/subject metadata (e.g. cell types, time points, control groups). The expression matrix can contain any kind of numeric value that quantifies expression, from counts to abundance. For simple projects where a subject only has one sample, the lookup table is not required in advance and is automatically created by the package. The package does minimal checks, such as ensuring that there are no samples without a subject and vice-versa, but extended quality control tests must be performed by the study authors, as it would be done when performing any downstream analysis.</p>
    </sec>
    <sec>
      <title>3.2 Configuration file</title>
      <p>The configuration file, based on the YAML data interchange format, is the other primary file that the package depends on to run. It contains all the definitions used to assemble the portal and is the main file that users must edit. The format is based on tab stop indentations and has a human-readable syntax. The package includes a step-by-step interactive function to create a configuration file and a function to create a local example; users can also refer to the complete configuration guide in the package documentation or the configuration file used in the live demo. Once the file is created and edited, the portal can be run with a single line of code that points to its location. As such, the portal can be deployed early in the lifecycle of a project and incremented as it progresses. This setup also enables easy versioning of portal and data as no code needs to be re-run or compiled if the file changes.</p>
      <p>In a minimal setup, users add portal metadata (name, logo file, landing page text file), information about the expression and measures data and define which modules should appear in the portal. Users must also indicate the columns in their data that identify subjects, samples and metadata for the selection of subsets in the interface. <xref rid="btae172-F1" ref-type="fig">Figure 1</xref> shows an example of the portal metadata followed by the data information.</p>
      <fig position="float" id="btae172-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Schematic representation of package use. On the left side, researchers who are setting up the portal create (at least) five files: the expression matrix, the measures (phenotype) data, the lookup table that matches potentially multiple samples to subjects, the configuration file and the app. R file. Visitors accessing the portal can navigate between the modules defined in the configuration file. The example shows a visitor exploring changes between baseline and 6 months, first for one gene, measure and cell type, then switching to another</p>
        </caption>
        <graphic xlink:href="btae172f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Data exploration modules</title>
      <p>The data exploration modules include two overview modules for time-varying data and three correlation-based modules. These modules do not require additional files beyond the expression matrix and measures data. The cohort overview module shows a grid of small lines, where each line corresponds to a patient’s trajectory for a measure over time (e.g. disease activity). The trajectory comparison between groups module displays scatterplots of expression and an observed measure over time, with one scatterplot per a defined subset of samples. In this view, it is possible to see if changes in expression in a gene are associated with changes in measure over time, and if these changes vary or not between groups of samples. The three correlation modules enable exploring the association between a single gene and various measures, all genes and a single measure and all genes and multiple measures. These associations are displayed through scatterplots, tables and heatmaps, respectively. Portal visitors can choose between different correlation measures (Pearson or Spearman), show or hide a fit line and assign variables from the measures data to colours in the scatterplot.</p>
    </sec>
    <sec>
      <title>3.4 Analysis showcase modules</title>
      <p>The showcase modules include support for differential expression results, heatmaps for groups of genes and precomputed projections of genes with average expression overlays. Some of these modules are directly compatible with the outputs of the packages and tools that are used to compute results, whilst others require additional formatting, e.g. using Excel spreadsheets. The detailed DEG module includes volcano plots to display results, with threshold lines indicating the significance of the genes. This module also includes a table to dig deeper into the results, and it is also used as the default view if a differential expression analysis result is incompatible with a volcano plot. The DEG summary module can be used to show aggregate numbers of differentially expressed genes, with adjusted and unadjusted <italic toggle="yes">P</italic>-values, across multiple models.</p>
      <p>Groups of genes extracted from tools such as weighted gene co-expression network analysis (WGCNA), pathways [e.g. KEGG <xref rid="btae172-B5" ref-type="bibr">Kanehisa and Goto (2000)</xref>] or gene expression signatures can be visualized in the gene modules heatmap, with scatterplots displaying the association between module eigengenes and measures. Finally, the gene projection overlay supports displaying pre-computed projections of genes with annotated clusters and analysing the variation of expression across subsets of samples (e.g. how the expression between clusters varies for a subset of high-disease burden patients).</p>
      <p>Each of these modules must have a corresponding section in the configuration file. Some of the fields are required, whilst others can be added for customization (e.g. colours) or to expose or hide certain functions from users (e.g. fit lines in scatterplots). The package documentation includes a complete guide for creating the configuration file, with the required and optional fields as well as examples of how additional files must be created for each module.</p>
    </sec>
    <sec>
      <title>3.5 Navigation example</title>
      <p><xref rid="btae172-F1" ref-type="fig">Figure 1</xref> illustrates an example of how the package works in practice, as seen in the live demonstration portal (<ext-link xlink:href="https://c4tb.github.io/ramap_demo/" ext-link-type="uri">https://c4tb.github.io/ramap_demo/</ext-link>). With the configuration file created and three main data files ready (highlighted by the dashed lines), the portal is set up and a visitor can navigate between the modules. In the figure, the module for comparing changes over time is shown: visitors can choose a gene, a subset of samples and a clinical variable to compare. The interface is populated from the configuration file: the clinical variables that visitors can select are defined by the study authors who are setting up the portal.</p>
    </sec>
    <sec>
      <title>3.6 Extension and customisation</title>
      <p>One of the key aspects of the portal is the support for the addition of new custom modules. By following the examples in the source code, users can extend existing modules and create new ones with additional functionality. Whilst the package has been created with specific goals in mind, this feature allows users to integrate their own plots or analyses, e.g. co-expression networks. As part of the shiny ecosystem, the package also supports the use of Bootswatch themes (<ext-link xlink:href="https://bootswatch.com/" ext-link-type="uri">https://bootswatch.com/</ext-link>) to change the overall look of the portal. Many of the implemented modules also include options to change palettes in plots to align the portal with figures published in the papers.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>We described an R package that facilitates the sharing of analysis of molecular expression data through interactive web portals. By focusing on the creation of a text-based configuration file, it enables easier deployment and maintenance without significant programming requirements. The package contains a set of core visualization modules but can be extensible by researchers who want to display other kinds of results or plots that are not currently supported.</p>
    <p>Unlike current alternatives for sharing findings, such as static documents for supplementary materials and open repositories, shinyExprPortal allows researchers to comment and curate their findings whilst still enabling interested readers to explore alternatives and interact with the results.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Dennis Lendrem, Graham Smith, Sara Masarone and other researchers in the RA-MAP and PSORT consortia for their helpful feedback.</p>
  </ack>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was funded by the Health Data Research UK [LOND1 to R.H. and M.R.B.].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Complete documentation available at <ext-link xlink:href="https://c4tb.github.io/shinyExprPortal/index.html" ext-link-type="uri">https://c4tb.github.io/shinyExprPortal/index.html</ext-link> and live demonstration available at <ext-link xlink:href="https://c4tb.github.io/ramap_demo/" ext-link-type="uri">https://c4tb.github.io/ramap_demo/</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae172-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barrett</surname><given-names>T</given-names></string-name>, <string-name><surname>Wilhite</surname><given-names>SE</given-names></string-name>, <string-name><surname>Ledoux</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>NCBI GEO: archive for functional genomics data sets—update</article-title>. <source>Nucleic Acids Res</source><year>2012</year>;<volume>41</volume>:<fpage>D991</fpage>–<lpage>95</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1193</pub-id><pub-id pub-id-type="pmid">23193258</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>W</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J</given-names></string-name>, <string-name><surname>Allaire</surname><given-names>JJ</given-names></string-name></person-group><etal>et al</etal><italic toggle="yes">Shiny: Web Application Framework for R</italic>. <year>2022</year>.</mixed-citation>
    </ref>
    <ref id="btae172-B3">
      <mixed-citation publication-type="other"><collab>European Organization For Nuclear Research and OpenAIRE</collab>. <italic toggle="yes">Zenodo: Research. Shared</italic>. <year>2013</year>. <pub-id pub-id-type="doi">10.25495/7GXK-RD71</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hunt</surname><given-names>GP</given-names></string-name>, <string-name><surname>Grassi</surname><given-names>L</given-names></string-name>, <string-name><surname>Henkin</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>GEOexplorer: a webserver for gene expression analysis and visualisation</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>W367</fpage>–<lpage>74</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkac364</pub-id><pub-id pub-id-type="pmid">35609980</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M</given-names></string-name>, <string-name><surname>Goto</surname><given-names>S.</given-names></string-name></person-group><article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title>. <source>Nucleic Acids Res</source><year>2000</year>;<volume>28</volume>:<fpage>27</fpage>–<lpage>30</lpage>. <pub-id pub-id-type="doi">10.1093/nar/28.1.27</pub-id><pub-id pub-id-type="pmid">10592173</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Langfelder</surname><given-names>P</given-names></string-name>, <string-name><surname>Horvath</surname><given-names>S.</given-names></string-name></person-group><article-title>WGCNA: an R package for weighted correlation network analysis</article-title>. <source>BMC Bioinformatics</source><year>2008</year>;<volume>9</volume>:<fpage>559</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-9-559</pub-id><pub-id pub-id-type="pmid">19114008</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lewis</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Barnes</surname><given-names>MR</given-names></string-name>, <string-name><surname>Blighe</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular portraits of early rheumatoid arthritis identify clinical and treatment response phenotypes</article-title>. <source>Cell Rep</source><year>2019</year>;<volume>28</volume>:<fpage>2455</fpage>–<lpage>70.e5</lpage>. <pub-id pub-id-type="doi">10.1016/j.celrep.2019.07.091</pub-id><pub-id pub-id-type="pmid">31461658</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lonsdale</surname><given-names>J</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>J</given-names></string-name>, <string-name><surname>Salvatore</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>The genotype-tissue expression (GTEx) project</article-title>. <source>Nat Genet</source><year>2013</year>;<volume>45</volume>:<fpage>580</fpage>–<lpage>5</lpage>. <pub-id pub-id-type="doi">10.1038/ng.2653</pub-id><pub-id pub-id-type="pmid">23715323</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lyttle</surname><given-names>I,</given-names></string-name></person-group><collab>Vega/Vega-Lite Developers</collab>. <italic toggle="yes">Vegawidget: ’htmlwidget’ for ’Vega’ and ’Vega-Lite’</italic>. <year>2023</year>.</mixed-citation>
    </ref>
    <ref id="btae172-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Margolin</surname><given-names>AA</given-names></string-name>, <string-name><surname>Nemenman</surname><given-names>I</given-names></string-name>, <string-name><surname>Basso</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>ARACNE: an algorithm for the reconstruction of gene regulatory networks in a mammalian cellular context</article-title>. <source>BMC Bioinformatics</source><year>2006</year>;<volume>7</volume>:<fpage>S7</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-7-S1-S7</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ritchie</surname><given-names>ME</given-names></string-name>, <string-name><surname>Phipson</surname><given-names>B</given-names></string-name>, <string-name><surname>Wu</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>e47</fpage>. <pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id><pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>MD</given-names></string-name>, <string-name><surname>McCarthy</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>GK</given-names></string-name></person-group><etal>et al</etal><article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source><year>2010</year>;<volume>26</volume>:<fpage>139</fpage>–<lpage>40</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id><pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satyanarayan</surname><given-names>A</given-names></string-name>, <string-name><surname>Moritz</surname><given-names>D</given-names></string-name>, <string-name><surname>Wongsuphasawat</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Vega-Lite: a grammar of interactive graphics</article-title>. <source>IEEE Trans Vis Comput Graph</source><year>2017</year>;<volume>23</volume>:<fpage>341</fpage>–<lpage>50</lpage>. <pub-id pub-id-type="doi">10.1109/TVCG.2016.2599030</pub-id><pub-id pub-id-type="pmid">27875150</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schep</surname><given-names>AN</given-names></string-name>, <string-name><surname>Kummerfeld</surname><given-names>SK.</given-names></string-name></person-group><article-title>Iheatmapr: interactive complex heatmaps in R</article-title>. <source>J Open Source Softw</source><year>2017</year>;<volume>2</volume>:<fpage>359</fpage>. <pub-id pub-id-type="doi">10.21105/joss.00359</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Xie</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J</given-names></string-name>, <string-name><surname>Tan</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><italic toggle="yes">DT: A Wrapper of the JavaScript Library ‘DataTables’</italic>. <year>2023</year>.</mixed-citation>
    </ref>
    <ref id="btae172-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>B</given-names></string-name>, <string-name><surname>Pache</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Metascape provides a biologist-oriented resource for the analysis of systems-level datasets</article-title>. <source>Nat Commun</source><year>2019</year>;<volume>10</volume>:<fpage>1523</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-019-09234-6</pub-id><pub-id pub-id-type="pmid">30944313</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11021805</article-id>
    <article-id pub-id-type="pmid">38552327</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae172</article-id>
    <article-id pub-id-type="publisher-id">btae172</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>shinyExprPortal: a configurable ‘shiny’ portal for sharing analysis of molecular expression data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5511-5230</contrib-id>
        <name>
          <surname>Henkin</surname>
          <given-names>Rafael</given-names>
        </name>
        <aff><institution>Centre for Translational Bioinformatics, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Digital Environment Research Institute, Queen Mary University of London</institution>, London E1 1HH, <country country="GB">United Kingdom</country></aff>
        <xref rid="btae172-cor1" ref-type="corresp"/>
        <!--r.henkin@qmul.ac.uk-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Goldmann</surname>
          <given-names>Katriona</given-names>
        </name>
        <aff><institution>Centre for Experimental Medicine and Rheumatology, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Alan Turing Institute</institution>, London NW1 2DB, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9365-5345</contrib-id>
        <name>
          <surname>Lewis</surname>
          <given-names>Myles</given-names>
        </name>
        <aff><institution>Centre for Translational Bioinformatics, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Centre for Experimental Medicine and Rheumatology, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barnes</surname>
          <given-names>Michael R</given-names>
        </name>
        <aff><institution>Centre for Translational Bioinformatics, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square</institution>, London EC1M 6BQ, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Digital Environment Research Institute, Queen Mary University of London</institution>, London E1 1HH, <country country="GB">United Kingdom</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Nikolski</surname>
          <given-names>Macha</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae172-cor1">Corresponding author. Centre for Translational Bioinformatics, William Harvey Research Institute, Queen Mary University of London, Charterhouse Square, London EC1M 6BQ, United Kingdom. E-mail: <email>r.henkin@qmul.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-03-29">
      <day>29</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>4</issue>
    <elocation-id>btae172</elocation-id>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>17</day>
        <month>3</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>3</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>16</day>
        <month>4</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae172.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The scale of omics research presents many obstacles to full sharing and access to analysis results. Current publication models impose limits on the number of pages and figures, requiring careful preparation and selection of content. At the same time, depositing data in open repositories significantly shifts the burden of access and reproduction to readers, who may include people who are not programmers or analysts.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce shinyExprPortal, an R package that implements omics web portals with minimal coding effort. The portals allow exploration of transcriptomic or proteomic expression data and phenotypes, showcasing results of various types of analysis including differential expression, co-expression and pathways analysis. The integration with bioinformatics workflows enables researchers to focus on their results and share findings using interactive and publication-quality plots.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The shinyExprPortal package is available to download and install from CRAN and <ext-link xlink:href="https://github.com/C4TB/shinyExprPortal" ext-link-type="uri">https://github.com/C4TB/shinyExprPortal</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Health Data Research UK</institution>
            <institution-id institution-id-type="DOI">10.13039/501100023699</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Bioinformatics researchers have many interactive tools at their disposal to conduct omics analysis without having to learn how to code (<xref rid="btae172-B1" ref-type="bibr">Barrett <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btae172-B8" ref-type="bibr">Lonsdale <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btae172-B16" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> 2019</xref>). However, when it comes to sharing the results of those analyses, the traditional publication model still imposes limits on the number of pages and figures, thus requiring the careful preparation of content that will convey the key messages of the paper and capture the attention of readers. Other potentially relevant figures, e.g. showing alternative analyses, are relegated to a supplementary material document or are not shown at all. Researchers can also share materials such as raw data, analysis scripts and other documents in repositories such as figshare (<ext-link xlink:href="https://figshare.com" ext-link-type="uri">https://figshare.com</ext-link>), Zenodo (<xref rid="btae172-B3" ref-type="bibr">European Organization For Nuclear Research and OpenAIRE 2013</xref>), and OSF (<ext-link xlink:href="https://osf.io" ext-link-type="uri">https://osf.io</ext-link>). Readers who are interested in exploring results or expression data, technically minded or not, are then left with the task of sorting through folders and files to hopefully find what is needed to reproduce an analysis.</p>
    <p>For transcriptomics data, repositories such as the Gene Expression Omnibus (GEO) allow users to browse and search data from published papers and conduct relatively simple analysis with R scripts, whilst tools that connect to GEO through an application programming interface (API), such as GEOExplorer (<xref rid="btae172-B4" ref-type="bibr">Hunt <italic toggle="yes">et al.</italic> 2022</xref>), ease the programming demands from the users. In this case, the original researchers no longer have control over the analysis parameters and presentation of their work, possibly leading to misleading findings. To maintain the researcher’s original analysis framework whilst still allowing user exploration, researchers can use packages such as Shiny (<xref rid="btae172-B2" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> 2022</xref>) and Streamlit (<ext-link xlink:href="https://streamlit.io/" ext-link-type="uri">https://streamlit.io/</ext-link>) to create web applications that effectively serve as interactive supplements or data portals (<xref rid="btae172-B7" ref-type="bibr">Lewis <italic toggle="yes">et al.</italic> 2019</xref>). Creating high-quality portals, however, requires significant effort, expertise and time, with an ongoing maintenance burden. Depending on the structure and timeline of the projects, the long-term sustainability of software also becomes an issue if there is a lack of funding or even interest from authors.</p>
    <p>To address these issues, this paper introduces shinyExprPortal, an R package that enables the deployment of web portals for molecular expression data using a text-based configuration file and requiring minimal coding. The package and resulting portal were designed with two general goals in mind: allowing simple data exploration and showcasing analysis results as the original researchers intended them to be presented. Both goals are supported by the use of interactive and publication-quality plots in modules for the exploration of correlations between expression and phenotype data, such as clinical measures of patients, as well as modules for showcasing differential expression analysis, gene co-expression and regulatory networks, and groups of genes in general. The package, therefore, is compatible with the outputs of typical bioinformatics tools such as limma, edgeR, WGCNA, and ARACNe (<xref rid="btae172-B10" ref-type="bibr">Margolin <italic toggle="yes">et al.</italic> 2006</xref>, <xref rid="btae172-B6" ref-type="bibr">Langfelder and Horvath 2008</xref>, <xref rid="btae172-B12" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic> 2010</xref>, <xref rid="btae172-B11" ref-type="bibr">Ritchie <italic toggle="yes">et al.</italic> 2015</xref>), as well as any lists of genes produced by pathway analysis tools. In principle, any molecular expression matrix can be accommodated, so the portal can support both transcriptomics, proteomics and potentially metabolomics, although different data types cannot be integrated, due to differing data scales. The modular structure of the package means that it can be used as soon as data is available and new analysis results can be included by different members of a research team. It is also easy to extend the deployed portal with custom modules.</p>
  </sec>
  <sec>
    <title>2 Design rationale</title>
    <p>The design of the package followed the workflow of a typical omic analysis project, starting after the initial preprocessing and quality control steps. It was designed in conversation with researchers across three different projects, based on their workflows and requirements: <italic toggle="yes">minimal programming</italic>, <italic toggle="yes">modularity</italic> and <italic toggle="yes">focus on showcase</italic>. The first principle was translated into the use of a text-based configuration file rather than numerous R functions to set up a portal. The second principle enables portals to be incrementally set up as new results emerge, whilst the third one sets the scope for the package: facilitating the sharing of findings rather than being a tool for bioinformatics analysis workflows.</p>
    <p>Visitors of the portal can investigate sample subsets of interest and explore correlations between gene expression and observed measures, such as clinical data from trials (e.g. lab tests), or compare changes in clinical data and gene expression over time, e.g. an important measure goes down along with expression. This helps people who do not conduct the actual analysis to think about their data and formulate hypotheses. The showcase modules address the lack of interactivity in typical supplementary materials and the difficulty of reproducing figures.</p>
  </sec>
  <sec>
    <title>3 Implementation</title>
    <p>The package was developed primarily using the shiny package from the R ecosystem. It also relies on sveral surrounding packages that add or extend functionality to web apps created with shiny. The visualizations are primarily rendered using the Vega-lite library (<xref rid="btae172-B13" ref-type="bibr">Satyanarayan <italic toggle="yes">et al.</italic> 2017</xref>) via the vegawidget (<xref rid="btae172-B9" ref-type="bibr">Lyttle 2023</xref>) package, with additional views using the iheatmapr (<xref rid="btae172-B14" ref-type="bibr">Schep and Kummerfeld 2017</xref>) package. Interaction with tabular displays is done using the DT (<xref rid="btae172-B15" ref-type="bibr">Xie <italic toggle="yes">et al.</italic> 2023</xref>) package. Additional dependencies are found in the package metadata either on CRAN or GitHub.</p>
    <sec>
      <title>3.1 Data files</title>
      <p>Three main data files are required: an expression matrix with samples in columns and genes (or molecules) in rows, a table with rows containing phenotype data (e.g. blood tests, disease activity assessments) for each subject and a lookup/metadata table with rows for samples and subjects identifiers, also including sample/subject metadata (e.g. cell types, time points, control groups). The expression matrix can contain any kind of numeric value that quantifies expression, from counts to abundance. For simple projects where a subject only has one sample, the lookup table is not required in advance and is automatically created by the package. The package does minimal checks, such as ensuring that there are no samples without a subject and vice-versa, but extended quality control tests must be performed by the study authors, as it would be done when performing any downstream analysis.</p>
    </sec>
    <sec>
      <title>3.2 Configuration file</title>
      <p>The configuration file, based on the YAML data interchange format, is the other primary file that the package depends on to run. It contains all the definitions used to assemble the portal and is the main file that users must edit. The format is based on tab stop indentations and has a human-readable syntax. The package includes a step-by-step interactive function to create a configuration file and a function to create a local example; users can also refer to the complete configuration guide in the package documentation or the configuration file used in the live demo. Once the file is created and edited, the portal can be run with a single line of code that points to its location. As such, the portal can be deployed early in the lifecycle of a project and incremented as it progresses. This setup also enables easy versioning of portal and data as no code needs to be re-run or compiled if the file changes.</p>
      <p>In a minimal setup, users add portal metadata (name, logo file, landing page text file), information about the expression and measures data and define which modules should appear in the portal. Users must also indicate the columns in their data that identify subjects, samples and metadata for the selection of subsets in the interface. <xref rid="btae172-F1" ref-type="fig">Figure 1</xref> shows an example of the portal metadata followed by the data information.</p>
      <fig position="float" id="btae172-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Schematic representation of package use. On the left side, researchers who are setting up the portal create (at least) five files: the expression matrix, the measures (phenotype) data, the lookup table that matches potentially multiple samples to subjects, the configuration file and the app. R file. Visitors accessing the portal can navigate between the modules defined in the configuration file. The example shows a visitor exploring changes between baseline and 6 months, first for one gene, measure and cell type, then switching to another</p>
        </caption>
        <graphic xlink:href="btae172f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Data exploration modules</title>
      <p>The data exploration modules include two overview modules for time-varying data and three correlation-based modules. These modules do not require additional files beyond the expression matrix and measures data. The cohort overview module shows a grid of small lines, where each line corresponds to a patient’s trajectory for a measure over time (e.g. disease activity). The trajectory comparison between groups module displays scatterplots of expression and an observed measure over time, with one scatterplot per a defined subset of samples. In this view, it is possible to see if changes in expression in a gene are associated with changes in measure over time, and if these changes vary or not between groups of samples. The three correlation modules enable exploring the association between a single gene and various measures, all genes and a single measure and all genes and multiple measures. These associations are displayed through scatterplots, tables and heatmaps, respectively. Portal visitors can choose between different correlation measures (Pearson or Spearman), show or hide a fit line and assign variables from the measures data to colours in the scatterplot.</p>
    </sec>
    <sec>
      <title>3.4 Analysis showcase modules</title>
      <p>The showcase modules include support for differential expression results, heatmaps for groups of genes and precomputed projections of genes with average expression overlays. Some of these modules are directly compatible with the outputs of the packages and tools that are used to compute results, whilst others require additional formatting, e.g. using Excel spreadsheets. The detailed DEG module includes volcano plots to display results, with threshold lines indicating the significance of the genes. This module also includes a table to dig deeper into the results, and it is also used as the default view if a differential expression analysis result is incompatible with a volcano plot. The DEG summary module can be used to show aggregate numbers of differentially expressed genes, with adjusted and unadjusted <italic toggle="yes">P</italic>-values, across multiple models.</p>
      <p>Groups of genes extracted from tools such as weighted gene co-expression network analysis (WGCNA), pathways [e.g. KEGG <xref rid="btae172-B5" ref-type="bibr">Kanehisa and Goto (2000)</xref>] or gene expression signatures can be visualized in the gene modules heatmap, with scatterplots displaying the association between module eigengenes and measures. Finally, the gene projection overlay supports displaying pre-computed projections of genes with annotated clusters and analysing the variation of expression across subsets of samples (e.g. how the expression between clusters varies for a subset of high-disease burden patients).</p>
      <p>Each of these modules must have a corresponding section in the configuration file. Some of the fields are required, whilst others can be added for customization (e.g. colours) or to expose or hide certain functions from users (e.g. fit lines in scatterplots). The package documentation includes a complete guide for creating the configuration file, with the required and optional fields as well as examples of how additional files must be created for each module.</p>
    </sec>
    <sec>
      <title>3.5 Navigation example</title>
      <p><xref rid="btae172-F1" ref-type="fig">Figure 1</xref> illustrates an example of how the package works in practice, as seen in the live demonstration portal (<ext-link xlink:href="https://c4tb.github.io/ramap_demo/" ext-link-type="uri">https://c4tb.github.io/ramap_demo/</ext-link>). With the configuration file created and three main data files ready (highlighted by the dashed lines), the portal is set up and a visitor can navigate between the modules. In the figure, the module for comparing changes over time is shown: visitors can choose a gene, a subset of samples and a clinical variable to compare. The interface is populated from the configuration file: the clinical variables that visitors can select are defined by the study authors who are setting up the portal.</p>
    </sec>
    <sec>
      <title>3.6 Extension and customisation</title>
      <p>One of the key aspects of the portal is the support for the addition of new custom modules. By following the examples in the source code, users can extend existing modules and create new ones with additional functionality. Whilst the package has been created with specific goals in mind, this feature allows users to integrate their own plots or analyses, e.g. co-expression networks. As part of the shiny ecosystem, the package also supports the use of Bootswatch themes (<ext-link xlink:href="https://bootswatch.com/" ext-link-type="uri">https://bootswatch.com/</ext-link>) to change the overall look of the portal. Many of the implemented modules also include options to change palettes in plots to align the portal with figures published in the papers.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>We described an R package that facilitates the sharing of analysis of molecular expression data through interactive web portals. By focusing on the creation of a text-based configuration file, it enables easier deployment and maintenance without significant programming requirements. The package contains a set of core visualization modules but can be extensible by researchers who want to display other kinds of results or plots that are not currently supported.</p>
    <p>Unlike current alternatives for sharing findings, such as static documents for supplementary materials and open repositories, shinyExprPortal allows researchers to comment and curate their findings whilst still enabling interested readers to explore alternatives and interact with the results.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Dennis Lendrem, Graham Smith, Sara Masarone and other researchers in the RA-MAP and PSORT consortia for their helpful feedback.</p>
  </ack>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was funded by the Health Data Research UK [LOND1 to R.H. and M.R.B.].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Complete documentation available at <ext-link xlink:href="https://c4tb.github.io/shinyExprPortal/index.html" ext-link-type="uri">https://c4tb.github.io/shinyExprPortal/index.html</ext-link> and live demonstration available at <ext-link xlink:href="https://c4tb.github.io/ramap_demo/" ext-link-type="uri">https://c4tb.github.io/ramap_demo/</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae172-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barrett</surname><given-names>T</given-names></string-name>, <string-name><surname>Wilhite</surname><given-names>SE</given-names></string-name>, <string-name><surname>Ledoux</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>NCBI GEO: archive for functional genomics data sets—update</article-title>. <source>Nucleic Acids Res</source><year>2012</year>;<volume>41</volume>:<fpage>D991</fpage>–<lpage>95</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1193</pub-id><pub-id pub-id-type="pmid">23193258</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>W</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J</given-names></string-name>, <string-name><surname>Allaire</surname><given-names>JJ</given-names></string-name></person-group><etal>et al</etal><italic toggle="yes">Shiny: Web Application Framework for R</italic>. <year>2022</year>.</mixed-citation>
    </ref>
    <ref id="btae172-B3">
      <mixed-citation publication-type="other"><collab>European Organization For Nuclear Research and OpenAIRE</collab>. <italic toggle="yes">Zenodo: Research. Shared</italic>. <year>2013</year>. <pub-id pub-id-type="doi">10.25495/7GXK-RD71</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hunt</surname><given-names>GP</given-names></string-name>, <string-name><surname>Grassi</surname><given-names>L</given-names></string-name>, <string-name><surname>Henkin</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>GEOexplorer: a webserver for gene expression analysis and visualisation</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>W367</fpage>–<lpage>74</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkac364</pub-id><pub-id pub-id-type="pmid">35609980</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M</given-names></string-name>, <string-name><surname>Goto</surname><given-names>S.</given-names></string-name></person-group><article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title>. <source>Nucleic Acids Res</source><year>2000</year>;<volume>28</volume>:<fpage>27</fpage>–<lpage>30</lpage>. <pub-id pub-id-type="doi">10.1093/nar/28.1.27</pub-id><pub-id pub-id-type="pmid">10592173</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Langfelder</surname><given-names>P</given-names></string-name>, <string-name><surname>Horvath</surname><given-names>S.</given-names></string-name></person-group><article-title>WGCNA: an R package for weighted correlation network analysis</article-title>. <source>BMC Bioinformatics</source><year>2008</year>;<volume>9</volume>:<fpage>559</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-9-559</pub-id><pub-id pub-id-type="pmid">19114008</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lewis</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Barnes</surname><given-names>MR</given-names></string-name>, <string-name><surname>Blighe</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular portraits of early rheumatoid arthritis identify clinical and treatment response phenotypes</article-title>. <source>Cell Rep</source><year>2019</year>;<volume>28</volume>:<fpage>2455</fpage>–<lpage>70.e5</lpage>. <pub-id pub-id-type="doi">10.1016/j.celrep.2019.07.091</pub-id><pub-id pub-id-type="pmid">31461658</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lonsdale</surname><given-names>J</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>J</given-names></string-name>, <string-name><surname>Salvatore</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>The genotype-tissue expression (GTEx) project</article-title>. <source>Nat Genet</source><year>2013</year>;<volume>45</volume>:<fpage>580</fpage>–<lpage>5</lpage>. <pub-id pub-id-type="doi">10.1038/ng.2653</pub-id><pub-id pub-id-type="pmid">23715323</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lyttle</surname><given-names>I,</given-names></string-name></person-group><collab>Vega/Vega-Lite Developers</collab>. <italic toggle="yes">Vegawidget: ’htmlwidget’ for ’Vega’ and ’Vega-Lite’</italic>. <year>2023</year>.</mixed-citation>
    </ref>
    <ref id="btae172-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Margolin</surname><given-names>AA</given-names></string-name>, <string-name><surname>Nemenman</surname><given-names>I</given-names></string-name>, <string-name><surname>Basso</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>ARACNE: an algorithm for the reconstruction of gene regulatory networks in a mammalian cellular context</article-title>. <source>BMC Bioinformatics</source><year>2006</year>;<volume>7</volume>:<fpage>S7</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-7-S1-S7</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ritchie</surname><given-names>ME</given-names></string-name>, <string-name><surname>Phipson</surname><given-names>B</given-names></string-name>, <string-name><surname>Wu</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>e47</fpage>. <pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id><pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>MD</given-names></string-name>, <string-name><surname>McCarthy</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>GK</given-names></string-name></person-group><etal>et al</etal><article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source><year>2010</year>;<volume>26</volume>:<fpage>139</fpage>–<lpage>40</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id><pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satyanarayan</surname><given-names>A</given-names></string-name>, <string-name><surname>Moritz</surname><given-names>D</given-names></string-name>, <string-name><surname>Wongsuphasawat</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Vega-Lite: a grammar of interactive graphics</article-title>. <source>IEEE Trans Vis Comput Graph</source><year>2017</year>;<volume>23</volume>:<fpage>341</fpage>–<lpage>50</lpage>. <pub-id pub-id-type="doi">10.1109/TVCG.2016.2599030</pub-id><pub-id pub-id-type="pmid">27875150</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schep</surname><given-names>AN</given-names></string-name>, <string-name><surname>Kummerfeld</surname><given-names>SK.</given-names></string-name></person-group><article-title>Iheatmapr: interactive complex heatmaps in R</article-title>. <source>J Open Source Softw</source><year>2017</year>;<volume>2</volume>:<fpage>359</fpage>. <pub-id pub-id-type="doi">10.21105/joss.00359</pub-id></mixed-citation>
    </ref>
    <ref id="btae172-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Xie</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J</given-names></string-name>, <string-name><surname>Tan</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><italic toggle="yes">DT: A Wrapper of the JavaScript Library ‘DataTables’</italic>. <year>2023</year>.</mixed-citation>
    </ref>
    <ref id="btae172-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>B</given-names></string-name>, <string-name><surname>Pache</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Metascape provides a biologist-oriented resource for the analysis of systems-level datasets</article-title>. <source>Nat Commun</source><year>2019</year>;<volume>10</volume>:<fpage>1523</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-019-09234-6</pub-id><pub-id pub-id-type="pmid">30944313</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
