<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microbiome</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microbiome</journal-id>
    <journal-title-group>
      <journal-title>Microbiome</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2049-2618</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6547473</article-id>
    <article-id pub-id-type="publisher-id">684</article-id>
    <article-id pub-id-type="doi">10.1186/s40168-019-0684-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>NG-meta-profiler: fast processing of metagenomes using NGLess, a domain-specific language</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9280-7885</contrib-id>
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <address>
          <email>coelho@embl.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Alves</surname>
          <given-names>Renato</given-names>
        </name>
        <address>
          <email>renato.alves@embl.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Monteiro</surname>
          <given-names>Paulo</given-names>
        </name>
        <address>
          <email>paulomonteiro7.pm@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huerta-Cepas</surname>
          <given-names>Jaime</given-names>
        </name>
        <address>
          <email>huerta@embl.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Freitas</surname>
          <given-names>Ana Teresa</given-names>
        </name>
        <address>
          <email>ana.freitas@tecnico.ulisboa.pt</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Bork</surname>
          <given-names>Peer</given-names>
        </name>
        <address>
          <email>bork@embl.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0495 846X</institution-id><institution-id institution-id-type="GRID">grid.4709.a</institution-id><institution>Structural and Computational Biology Unit, </institution><institution>European Molecular Biology Laboratory, </institution></institution-wrap>Heidelberg, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0125 2443</institution-id><institution-id institution-id-type="GRID">grid.8547.e</institution-id><institution>Institute of Science and Technology for Brain-Inspired Intelligence, </institution><institution>Fudan University, </institution></institution-wrap>Shanghai, China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0369 313X</institution-id><institution-id institution-id-type="GRID">grid.419897.a</institution-id><institution>Key Laboratory of Computational Neuroscience and Brain-Inspired Intelligence (Fudan University), Ministry of Education, </institution></institution-wrap>Shanghai, China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2190 4373</institution-id><institution-id institution-id-type="GRID">grid.7700.0</institution-id><institution>Collaboration for joint PhD degree between EMBL and Heidelberg University, Faculty of Biosciences, </institution></institution-wrap>Heidelberg, Germany </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2181 4263</institution-id><institution-id institution-id-type="GRID">grid.9983.b</institution-id><institution>INESC-ID, Instituto Superior Técnico, </institution><institution>University of Lisbon, </institution></institution-wrap>Lisbon, Portugal </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2151 2978</institution-id><institution-id institution-id-type="GRID">grid.5690.a</institution-id><institution>Centro de Biotecnología y Genómica de Plantas, </institution><institution>Universidad Politécnica de Madrid (UPM), Instituto Nacional de Investigación y Tecnología Agraria y Alimentaria (INIA), </institution></institution-wrap>Madrid, Spain </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1014 0849</institution-id><institution-id institution-id-type="GRID">grid.419491.0</institution-id><institution>Max Delbrück Centre for Molecular Medicine, </institution></institution-wrap>Berlin, Germany </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0495 846X</institution-id><institution-id institution-id-type="GRID">grid.4709.a</institution-id><institution>Molecular Medicine Partnership Unit, </institution><institution>University of Heidelberg and European Molecular Biology Laboratory, </institution></institution-wrap>Heidelberg, Germany </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1958 8658</institution-id><institution-id institution-id-type="GRID">grid.8379.5</institution-id><institution>Department of Bioinformatics, Biocenter, </institution><institution>University of Würzburg, </institution></institution-wrap>Würzburg, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>6</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>6</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>84</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>7</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Shotgun metagenomes contain a sample of all the genomic material in an environment, allowing for the characterization of a microbial community. In order to understand these communities, bioinformatics methods are crucial. A common first step in processing metagenomes is to compute abundance estimates of different taxonomic or functional groups from the raw sequencing data.</p>
        <p id="Par2">Given the breadth of the field, computational solutions need to be flexible and extensible, enabling the combination of different tools into a larger pipeline.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">We present NGLess and <italic>NG-meta-profiler</italic>. NGLess is a domain specific language for describing next-generation sequence processing pipelines. It was developed with the goal of enabling user-friendly computational reproducibility. It provides built-in support for many common operations on sequencing data and is extensible with external tools with configuration files.</p>
        <p id="Par4">Using this framework, we developed <italic>NG-meta-profiler</italic>, a fast profiler for metagenomes which performs sequence preprocessing, mapping to bundled databases, filtering of the mapping results, and profiling (taxonomic and functional). It is significantly faster than either MOCAT2 or htseq-count and (as it builds on NGLess) its results are perfectly reproducible.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par5"><italic>NG-meta-profiler</italic> is a high-performance solution for metagenomics processing built on NGLess. It can be used as-is to execute standard analyses or serve as the starting point for customization in a perfectly reproducible fashion.</p>
        <p id="Par6">NGLess and NG-meta-profiler are open source software (under the liberal MIT license) and can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://ngless.embl.de">https://ngless.embl.de</ext-link> or installed through bioconda.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s40168-019-0684-8) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Metagenomics</kwd>
      <kwd>Next-generation sequencing</kwd>
      <kwd>Domain-specific language</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010661</institution-id>
            <institution>Horizon 2020 Framework Programme</institution>
          </institution-wrap>
        </funding-source>
        <award-id>686070</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bork</surname>
            <given-names>Peer</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id>
            <institution>European Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ERC-AdG-669830</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bork</surname>
            <given-names>Peer</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001871</institution-id>
            <institution>Fundação para a Ciência e a Tecnologia</institution>
          </institution-wrap>
        </funding-source>
        <award-id>EXCL/EEI-ESS/0257/2012</award-id>
        <principal-award-recipient>
          <name>
            <surname>Freitas</surname>
            <given-names>Ana Teresa</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par7">Over the last decade, metagenomics has increasingly been applied to the study of microbial communities. Most work has focused on human-associated habitats [<xref ref-type="bibr" rid="CR1">1</xref>] with a particular emphasis on the human gut microbiome [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. However, the same methodologies have been used for studying other host-associated microbiota [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>] or the marine microbiome [<xref ref-type="bibr" rid="CR7">7</xref>]. Due to its size and complexity, several computational approaches have been proposed to handle these data, including bioinformatic pipelines combining different tools and approaches [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par8">A typical metagenomics processing workflow can be divided into two distinct phases: in the first phase, raw data is processed (often using prebuilt reference databases) to generate a table of feature abundances (a profile). These features can be either taxonomic or functional annotations. Secondly, these profiles are analyzed (often in regards to relevant metadata) using statistical methods and packages such as phyloseq [<xref ref-type="bibr" rid="CR12">12</xref>], vegan [<xref ref-type="bibr" rid="CR13">13</xref>], or LEfSe [<xref ref-type="bibr" rid="CR14">14</xref>]. In this work, we are focused on the first phase: namely obtaining functional and taxonomic profiles from raw metagenomic reads.</p>
    <p id="Par9">To this end, we present <italic>NG-meta-profiler</italic>, a collection of pre-configured pipelines based on the domain-specific language NGLess (Next Generation Language for less effortful analysis). Although <italic>NG-meta-profiler</italic> can be used as a standalone tool, the syntax and semantics of NGLess have been designed to be simple and human readable, allowing users to read or create their own pipelines, even without deep bioinformatics and programming knowledge. In other scientific contexts, domain-specific languages have been empirically found to increase productivity and user satisfaction [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. At the same time, NGLess is designed to enable perfect reproducibility of the computational process, an increasingly important concern [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>NGLess, a domain-specific language for NGS processing</title>
      <p id="Par10">NGLess is a domain-specific language which was designed specifically for next-generation sequence (NGS) processing. NGLess was initially designed by analyzing the intended use cases with potential users. NGLess is an imperative programming language, given that most bioinformaticians are familiar with languages using this paradigm [<xref ref-type="bibr" rid="CR20">20</xref>]. The result contains types for concepts that were found to be important in the problem domain, such as <italic>ShortRead</italic> (representing a single short read) or <italic>ShortReadSet</italic> (representing a set of, possibly paired-end, short reads). Unlike most programming languages, values of these types are often represented by files on disk and not values in memory due to their large size.</p>
      <p id="Par11">We also conducted a user study (with a sample of convenience, with participants recruited locally and through social media) on an earlier version of the language, which revealed some issues in those earlier versions. Experience from tutorials on using the language was also used to simplify some aspects of the language. For example, in an earlier version of NGLess, there existed a construct to preprocess short-reads using pass-by-reference, where the argument to the <italic>preprocess</italic> function was modified. We found that changing this to pass-by-value led to fewer misunderstandings. Thus, the language now uses exclusively pass-by-value semantics. Another area where progress benefited from user input on beta versions is the quality of the error messages. Even when usage reports were due to user errors or malformed input files, we took this opportunity to improve the error reporting in NGLess to help the users diagnose and debug the underlying issue.</p>
      <p id="Par12">The built-in knowledge of the sequence processing domain allows for best-practices to be automatic. For example, our tool always collects quality control statistics without the user having to specify it as an additional computational step.</p>
      <p id="Par13">Domain knowledge enables the interpreter to perform computations more efficiently. For example, even though users write their pipeline script in a purely linear fashion, the interpreter can automatically detect when parallelization opportunities are available and take advantage of multiple processors in shared memory machines. In particular, loops are automatically parallelized, and format conversions (e.g., compression/decompression) use separate threads. When relying on external tools, NGLess can automatically detect possibilities to avoid intermediate files, while handling all format conversions internally.</p>
      <p id="Par14">Finally, error detection and reporting are significantly improved by having the tool be semantically aware of its goals. Given that debugging consumes a significant fraction of the time invested in developing computational pipelines, fast error detection can speed up the overall project. For example, it is possible to check whether inputs are readable and outputs are writable prior to starting interpretation. This benefits the user whenever they have made a mistake as errors are detected and reported immediately.</p>
      <p id="Par15">While introducing a novel language implies that the user needs to learn a new tool, the language is designed to be easily understandable to scientists familiar with the field. Alternatively, a Python interface to NGLess allows users familiar with that programming language to access NGLess functionality. Similarly, <italic>NG-meta-profiler</italic> is a command line tool that can be used directly without knowledge of NGLess.</p>
      <p id="Par16">In version 1.0, NGLess implements the following tasks: (1) preprocessing, (2) assembly, (3) open-reading frame (ORF) finding, (4) mapping to sequence databases, (5) filtering of mapping results, (6) profiling (up-to-date taxonomic and functional profiling databases are provided), and (7) summary plots. See Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Text S1 and the online manual for a full description of the language, including the complete grammar in extended Back-Naur notation as well as documentation for all the built-in types, functions, and modules.</p>
    </sec>
    <sec id="Sec4">
      <title>NG-meta-profiler: a fast metagenomics profiler</title>
      <p id="Par17">Using the NGLess framework, we have developed <italic>NG-meta-profiler</italic>, a collection of pipelines for taxonomic and functional profiling of metagenomes. These standard analyses can be run with a single command. However, they can also serve as a starting point for customization by the user, including extending them with novel tools.</p>
      <p id="Par18">These pipelines are defined in the NGLess language, and currently, there are workflows available for human, mouse, pig, and dog gut as well as marine metagenomes. In the future, we plan to continually update the resources (annotated gene catalogs and other databases) for these environments, as well as providing resources for other environments.</p>
      <p id="Par19">At a high level, NG-meta-profiler, performs the following operations: (1) preprocess the reads (performing quality-based trimming and filtering of short reads and, if appropriate, discarding reads that align to the host), (2) map the reads against a predefined gene catalog selected for that biome, and (3) use the predefined gene annotations to build a profile (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic illustration of <italic>NG-meta-profiler</italic></p></caption><graphic xlink:href="40168_2019_684_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par20">For preprocessing the short-reads, we use built-in NGLess constructs to perform quality based trimming and filtering of short reads. In NG-meta-profiler, we use the <italic>substrim</italic> function to trim reads. This function is built into NGLess and trims the sequence to the longest substring of its input such that all bases have at least the requested quality (the same approach was initially introduced by SolexaQA [<xref ref-type="bibr" rid="CR21">21</xref>]). We keep only reads above quality value 25, which is the central point of the recommended range (20 to 30) in a previous study of the effects of read trimming [<xref ref-type="bibr" rid="CR22">22</xref>]. Finally, we discard reads shorter than 45 base pairs as shorter reads are significantly more likely to align in multiple locations. These defaults can easily be changed by the user.</p>
      <p id="Par21">After preprocessing, it is necessary to remove reads that match the human genome. For this operation, we will first align the reads against the hg19 built-in reference.</p>
      <p id="Par22">As the default mapper is a local aligner (bwa-mem), it aligns reads even when only a short substring maps. To remove these spurious alignments, we remove very short alignments, namely those below 45 bp (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1).</p>
      <p id="Par23">To obtain functional profiles from metagenomes, we use pre-classified gene catalogs as references, an approach that was previously shown to outperform per-read classification [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>].</p>
      <sec id="Sec5">
        <title>Bundled databases and modules</title>
        <p id="Par24">As part of the first release of NG-meta-profiler, we bundle several genomes (including human and mouse) as well as gene catalogs for the human gut microbiome [<xref ref-type="bibr" rid="CR25">25</xref>], the marine microbiome [<xref ref-type="bibr" rid="CR7">7</xref>], and three non-human mammal microbiomes (pig [<xref ref-type="bibr" rid="CR5">5</xref>], dog [<xref ref-type="bibr" rid="CR6">6</xref>], and mouse [<xref ref-type="bibr" rid="CR4">4</xref>]). These gene catalogs have been functionally annotated with eggnog-mapper [<xref ref-type="bibr" rid="CR23">23</xref>] so that functional profiles can be generated by NGLess (see Table <xref rid="Tab1" ref-type="table">1</xref>). In the current version, <italic>NG-meta-profiler</italic> can produce eggNOG orthologous group [<xref ref-type="bibr" rid="CR26">26</xref>], KEGG orthologous groups (KO) [<xref ref-type="bibr" rid="CR27">27</xref>], SEED [<xref ref-type="bibr" rid="CR28">28</xref>], and BiGG [<xref ref-type="bibr" rid="CR29">29</xref>] abundance profiles. Additionally, genomes of several organisms (see Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Text S1) are also provided. These are used for filtering out host reads in host-associated metagenomes in <italic>NG-meta-profiler</italic>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Gene catalogs bundled with NG-meta-profiler</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Database</th><th>Size (million genes)</th><th>Comment</th></tr></thead><tbody><tr><td>igc</td><td>9.9</td><td>Integrated gene catalog for the human gut [<xref ref-type="bibr" rid="CR25">25</xref>]</td></tr><tr><td>om-rgc</td><td>40</td><td>Ocean microbial gene catalog [<xref ref-type="bibr" rid="CR7">7</xref>]</td></tr><tr><td>mouse-gut</td><td>2.6</td><td>Gene catalog of the mouse gut [<xref ref-type="bibr" rid="CR4">4</xref>]</td></tr><tr><td>pig-gut</td><td>7.7</td><td>Gene catalog of the pig gut [<xref ref-type="bibr" rid="CR4">4</xref>]</td></tr><tr><td>dog-gut</td><td>1.2</td><td>Gene catalog of the dog gut [<xref ref-type="bibr" rid="CR6">6</xref>]</td></tr></tbody></table></table-wrap></p>
        <p id="Par25">All of these resources are automatically downloaded by NGLess the first time they are used so that the initial download is small (currently 15 MiB) and each user only downloads those resources they effectively use. In addition to these, the user can provide external references by specifying the file paths to the resources on disk or writing an external module (which can be defined using a text file).</p>
        <p id="Par26">Several operations in NGLess are performed with bundled software. De novo assembly is performed using MEGAHIT [<xref ref-type="bibr" rid="CR30">30</xref>], which has been found to perform well for metagenomics [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. Open reading frame (ORF) finding is performed with Prodigal [<xref ref-type="bibr" rid="CR33">33</xref>]. By default, mapping is performed using bwa [<xref ref-type="bibr" rid="CR34">34</xref>], but minimap2 [<xref ref-type="bibr" rid="CR35">35</xref>] is also provided and SOAPaligner [<xref ref-type="bibr" rid="CR36">36</xref>] can be used. Additional built-in modules provide extra functionality as shown in Table <xref rid="Tab2" ref-type="table">2</xref>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>NGLess built-in modules that add extra functionality</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Module name</th><th>Comment</th></tr></thead><tbody><tr><td>parallel</td><td>Process multiple samples in parallel</td></tr><tr><td>mocat</td><td>Compatibility with MOCAT/MOCAT2 [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]</td></tr><tr><td>specI</td><td>specI profiling (reference based metagenomics taxonomic profiling [<xref ref-type="bibr" rid="CR54">54</xref>])</td></tr><tr><td>motu</td><td>mOTU profiling (taxonomic profiling of metagenomes [<xref ref-type="bibr" rid="CR55">55</xref>])</td></tr><tr><td>minimap2</td><td>minimap2 mapper [<xref ref-type="bibr" rid="CR35">35</xref>]</td></tr></tbody></table></table-wrap></p>
        <p id="Par27">The bundled databases and modules were chosen because of their wide use at the time that NGLess 1.0 was released. However, they will be updated as appropriate (e.g., when new versions of the underlying databases are available).</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results and discussion</title>
    <sec id="Sec7">
      <title>Benchmarking</title>
      <p id="Par28">We compared the performance of <italic>NG-meta-profiler</italic> with both MOCAT2 [<xref ref-type="bibr" rid="CR9">9</xref>] and a pipeline based on calling bwa without preprocessing data and htseq-count [<xref ref-type="bibr" rid="CR37">37</xref>] for profiling human gut [<xref ref-type="bibr" rid="CR38">38</xref>] and ocean metagenomes [<xref ref-type="bibr" rid="CR7">7</xref>]. For this benchmark, eight threads were used (except for the htseq-count software which only supports a single thread).</p>
      <p id="Par29">Results are presented in Fig. <xref rid="Fig2" ref-type="fig">2</xref> (see also Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). <italic>NG-meta-profiler</italic> clearly outperforms the other solutions in this task. When compared to MOCAT2, the <italic>NG-meta-profiler</italic> runs 11× faster in the marine benchmark, and 2.6× in the human gut metagenome benchmark. Compared to htseq-count, NGLess is 20–25× faster at building profiles from mapping results (for the marine and the human gut metagenomes, respectively). Even when limited to a single core (for a more direct comparison, as htseq-count does not support multiple cores), NGLess is still 11–16× faster (for the human gut and marine metagenomes, respectively).<fig id="Fig2"><label>Fig. 2</label><caption><p>Timing comparison of NGLess and other tools. Three replicates are shown for each tool. The bwa/htseq-count pipeline does not include preprocess and filtering steps</p></caption><graphic xlink:href="40168_2019_684_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par30">The larger ratio in the larger ocean microbial gene catalog (40 million genes) compared to the integrated gene catalog used for profiling the human gut (10 million genes) is evidence that NGLess scales better to very large catalogs.</p>
      <p id="Par31">Note that running the full <italic>NG-meta-profiler</italic> pipeline takes less time than the sum of the individual steps as the pipeline is optimized as a whole (e.g., it avoids generating unnecessary intermediate files).</p>
      <p id="Par32">The three pipelines can perform the same computation, with some minor differences. MOCAT2 defaults to using SOAPAligner [<xref ref-type="bibr" rid="CR36">36</xref>], while NGLess defaults to using bwa [<xref ref-type="bibr" rid="CR34">34</xref>], although both tools support both aligners. To test the quality of the results, metagenomes with known taxonomic composition were simulated using abundance and quality distributions derived from real samples. In particular, species distributions were taken from real samples, and reads were simulated from the corresponding genomes. The eggNOG-mapper [<xref ref-type="bibr" rid="CR23">23</xref>] annotation of the genomes, weighted by the abundance of the corresponding species, was then considered the ground truth. All the three pipelines considered produce results in high agreement with the ground truth (see Table <xref rid="Tab3" ref-type="table">3</xref> and Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2).<table-wrap id="Tab3"><label>Table 3</label><caption><p>Quality of results based on simulated data</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Environment</th><th>Tool</th><th>Mean</th><th>Std. dev.</th></tr></thead><tbody><tr><td rowspan="3">Human gut</td><td>NGLess</td><td>88.44</td><td>2.07</td></tr><tr><td>MOCAT2</td><td>87.32</td><td>2.04</td></tr><tr><td>bwa/htseq-count</td><td>85.96</td><td>1.84</td></tr><tr><td rowspan="3">Marine</td><td>NGLess</td><td>82.26</td><td>6.29</td></tr><tr><td>MOCAT2</td><td>83.07</td><td>6.42</td></tr><tr><td>bwa/htseq-count</td><td>82.46</td><td>6.32</td></tr></tbody></table><table-wrap-foot><p>Shown are the average and std. dev. (over 8 simulations for each environment) of the Spearman rho between the output of each tool and the ground truth</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec8">
      <title>Pipeline design with NGLess</title>
      <p id="Par33">Using NGLess allows the user to work at a higher level of abstraction than is the case when working directly with traditional command-line tools or generic workflow engines, by using a domain-specific language (DSL). Several tools had already used a DSL to define a computational pipeline. The classical Make tool, which was originally designed for compiling software, but has been used as the basis of a scientific pipeline system [<xref ref-type="bibr" rid="CR39">39</xref>], uses its own internal language, as do the more modern pipelining tools Snakemake [<xref ref-type="bibr" rid="CR40">40</xref>] and nextflow [<xref ref-type="bibr" rid="CR41">41</xref>]. These tools operate by organizing the computation around calls to command-line software. As such, they are fully generic and can be used in a wide range of problems. NGLess trades off this generality to achieve higher usability and performance within its problem domain.</p>
      <p id="Par34">In this section, we illustrate the implementation in NGLess of elements of the human gut profiler (see Figs. <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig3" ref-type="fig">3</xref>) to demonstrate the language and the advantages of using NGLess.<fig id="Fig3"><label>Fig. 3</label><caption><p>Abridged version of the human profiler, written in the NGLess language</p></caption><graphic xlink:href="40168_2019_684_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par35">The first element in an NGLess script is the version declaration:<graphic position="anchor" xlink:href="40168_2019_684_Figa_HTML" id="MO4"/></p>
      <p id="Par37">This documents which version of the language the user wants to use. This allows the language to be updated while keeping backward compatibility for older scripts. Already, the current version of the interpreter can run more than one version of the language.</p>
      <p id="Par38">The user can then import helper modules. Specifying versions is required for reproducibility. The first module that needs to be imported is the <italic>mocat</italic> module. This module provides functions to load data that is organized such that each biological sample corresponds to a directory on disk, possibly containing multiple input files. This structure was used in MOCAT/MOCAT2 [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], hence the name of the module. Secondly, we import the <italic>igc</italic> module to be able to use the integrated gene catalog (IGC) of the human gut [<xref ref-type="bibr" rid="CR25">25</xref>].<graphic position="anchor" xlink:href="40168_2019_684_Figb_HTML" id="MO5"/></p>
      <p id="Par41">The first step in the pipeline is to load the data. The input directory is given as the first of the command line arguments (which are stored in an array named <italic>ARGV</italic>, following the convention from other programming languages), using the <italic>load_mocat_sample</italic> from the <italic>mocat</italic> module imported above:<graphic position="anchor" xlink:href="40168_2019_684_Figc_HTML" id="MO6"/></p>
      <p id="Par43">This function can read the FastQ data format in different configurations (single-end, paired-end, multi-lane), which allows transparently handling heterogeneity in read depth and different sequencing strategies.</p>
      <p id="Par44">NGLess is a statically typed language, with automatically inferred types. As such, <italic>input</italic> has type <italic>ShortReadSet</italic>, representing a variable number of paired-end and/or single-end files on disk. To perform quality based trimming and filtering of short reads, the built-in <italic>preprocess</italic> function is used to loop over all the input data:<graphic position="anchor" xlink:href="40168_2019_684_Figd_HTML" id="MO7"/></p>
      <p id="Par49">As described above, <italic>substrim</italic> is a built-in NGLess function to trim short-reads based on quality. Alternatively, the user can opt for two additional trimming algorithms, <italic>endtrim</italic> and <italic>smoothtrim</italic>, depending on the sequencing platform and technology used to obtain the raw data (see Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Text S1 and the online documentation for details on these functions). While performing the <italic>preprocess</italic> operation, the interpreter will also estimate qualities and generate quality-control plots for both the input and the preprocessed data. These are computed on the data as reads are loaded from disk for preprocessing and before writing it back to disk, so there is no extra input/output (I/O) generated. This behavior would be hard to achieve in standard pipelines where different tasks are often performed by independent software, requiring the same data to be loaded several times.</p>
      <p id="Par50">After preprocessing the short reads, it is necessary to remove reads that match the human genomes as they are not relevant for microbiome studies. For this operation, we will first align the reads against one of the human built-in references, namely <italic>hg19</italic>:<graphic position="anchor" xlink:href="40168_2019_684_Fige_HTML" id="MO8"/></p>
      <p id="Par52">As no aligner is specified explicitly, the default, bwa-mem [<xref ref-type="bibr" rid="CR34">34</xref>], is used. Independently of which aligner is used, NGLess will ensure that the reference is correctly downloaded and indexed the first time it is used. NGLess will also uncompress and merge multiple input read files before passing the reads to the aligner, while streaming the data so that no additional intermediate files are generated. This is the case not just for the <italic>map</italic> function, but for all tools in NGLess. By using NGLess-based pipelines, the user does not need to be aware of whether these tools support compressed inputs or about subformat issues (e.g., interleaved FastQ files or SAM/BAM distinctions) as these transformations are implicit.</p>
      <p id="Par53">To remove spurious alignments (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1), we filter the these aligned reads:<graphic position="anchor" xlink:href="40168_2019_684_Figf_HTML" id="MO9"/></p>
      <p id="Par60">The <italic>nhuman</italic> object is of type <italic>MappedShortReadSet</italic> (the NGLess representation of the information in a SAM/BAM file [<xref ref-type="bibr" rid="CR42">42</xref>]). In order to extract only the sequences (effectively, converting it back to a set of FastQ files), the <italic>as_reads</italic> function is used:<graphic position="anchor" xlink:href="40168_2019_684_Figg_HTML" id="MO10"/></p>
      <p id="Par62">Now, these sequences are mapped to the <italic>igc</italic> reference (the integrated gene catalog, imported earlier). To obtain an abundance table, the <italic>count</italic> function summarizes the mappings:<graphic position="anchor" xlink:href="40168_2019_684_Figh_HTML" id="MO11"/></p>
      <p id="Par67">In this case, we quantify eggNOG orthologs groups [<xref ref-type="bibr" rid="CR43">43</xref>], relying on gene annotations that are part of the <italic>igc</italic> reference. As the annotations are bundled together with the sequence databases, the user does not need to be concerned with the possibility of mismatched identifiers, or even specify the exact paths on disk to the corresponding file.</p>
      <p id="Par68">Finally, the <italic>igc_counts</italic> object can now be saved to disk.<graphic position="anchor" xlink:href="40168_2019_684_Figi_HTML" id="MO12"/></p>
      <p id="Par70">In this case, the file is saved to a subdirectory, namely <italic>outputs/</italic>. If the directory does not exist or if the user does not have permission to write to it, an error will be produced, as would be the case in any other pipeline design. With NGLess, however, the interpreter checks whether this directory exists and can be written to, as early as possible, namely before starting the execution of the pipeline. Thus, in case of error, the user receives a readable error immediately instead of needing to wait for that step of the process to be reached.</p>
    </sec>
    <sec id="Sec9">
      <title>Pipelines developed with NGLess are reproducible</title>
      <p id="Par71">Unlike tools which are based on traditional programming languages, NGLess is designed from the ground up with reproducibility as a goal.</p>
      <p id="Par72">Every pipeline defined with NGLess includes a version declaration and every imported module specifies the particular version which is being imported. Documenting the version of all the tools and dependencies used for a given analysis is considered a best practice [<xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR45">45</xref>], but is not always followed. By making it a requirement within the script, NGLess ensures that this best practice is adopted. At the same time, NGLess lowers the necessary effort when compared to having to record the version of all tools and dependencies manually. For example, the versions of samtools [<xref ref-type="bibr" rid="CR42">42</xref>] and bwa [<xref ref-type="bibr" rid="CR34">34</xref>] used internally (and shipped with NGLess) are implicitly fixed by specifying the NGLess version. To encourage that credit be given to the original authors, NGLess will print out references for any tools that are used, asking the user to cite them in publications.</p>
      <p id="Par73">Furthermore, although external configuration and command line options may change <italic>how</italic> results are computed (e.g., how many threads to use, where to store temporary files), the results do not depend on any information outside the script. This separation of implementation details from the data processing specification has the added potential of making the resulting code easier to port between systems [<xref ref-type="bibr" rid="CR46">46</xref>].</p>
    </sec>
    <sec id="Sec10">
      <title>Extensibility and integration into the wider ecosystem of bioinformatics tools</title>
      <p id="Par74">Pipelines defined with NGLess are easily extensible. We encourage users of <italic>NG-meta-profiler</italic> to customize these pipelines to their specific problems and to extend them as desired. Functions can be added to the language based on external software by specifying the interface in a text format and importing it from the main script.</p>
      <p id="Par75">In May 2018, we opened up to the community a repository of external modules (<ext-link ext-link-type="uri" xlink:href="https://github.com/ngless-toolkit/ngless-contrib">https://github.com/ngless-toolkit/ngless-contrib</ext-link>) where contributions of new integrations are accepted. At the moment, integration of MetaPhlAn2 (a tool for profiling microbial species based on taxa-specific marker genes [<xref ref-type="bibr" rid="CR47">47</xref>]), mOTUs2 (an updated metagenomics profiler based on univeral marker genes [<xref ref-type="bibr" rid="CR48">48</xref>]), and salmon (a tool which generates abundance profiles based on k-mers [<xref ref-type="bibr" rid="CR49">49</xref>]) are available.</p>
      <p id="Par76">Alternatively, NGLess-based analyses can be integrated into larger pipelines. Most existing bioinformatics pipelines are performed with command-line based software. To facilitate integration with existing tools, we provide several tools based on NGLess with a command line interface. In addition, we provide Common Workflow Language (CWL) descriptions of these tools which enable their use as part of CWL workflows [<xref ref-type="bibr" rid="CR50">50</xref>].</p>
      <p id="Par77">NGLess scripts can (with some limitations) be automatically exported as CWL tools in order to be embedded in larger projects. When passed the <italic>--export-cwl</italic> option, NGLess will output a CWL description of a given script which can then be embedded in a larger CWL-based pipeline.</p>
      <p id="Par78">Finally, NGLess can also be used as an embedded language within Python, a programming language that is widely used for scientific computing [<xref ref-type="bibr" rid="CR15">15</xref>]. With this interface, NGLess-based pipelines can be defined by Python-based scripts.</p>
    </sec>
    <sec id="Sec11">
      <title>Future developments</title>
      <p id="Par79">In addition to maintenance releases consisting of updates to the databases and their annotations, we plan to keep developing <italic>NG-meta-profiler</italic> and the underlying NGLess framework with a focus on readability and reproducibility. For example, one planned feature is to add support for automatic downloading data from public reference repositories such as the European Nucleotide Archive. Users will then be able to share a small readable script that would access publicly deposited data and process it in a perfectly reproducible fashion. Additionally, several improvements to performance are in progress.</p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Conclusions</title>
    <p id="Par80">NGLess puts forward a different approach for defining data analysis pipelines: the use of a domain-specific language for sequence analysis with reproducibility as a design concern.</p>
    <p id="Par81">Using this framework, we developed <italic>NG-meta-profiler</italic> which generates taxonomic and functional profiles from metagenomes based on prebuilt gene catalogs that are provided with the tool and downloaded on first use. When compared with other alternatives, <italic>NG-meta-profiler</italic> performs reference-based functional and taxonomic profiling much faster. Furthermore, this collection of scripts can be easily adapted and extended by the users within the NGLess framework to perform novel functions.</p>
  </sec>
  <sec id="Sec13">
    <title>Availability and requirements</title>
    <p id="Par82">Project name: NG-meta-profiler and NGLess</p>
    <p id="Par83">Project home page: <ext-link ext-link-type="uri" xlink:href="https://ngless.embl.de">https://ngless.embl.de</ext-link></p>
    <p id="Par84">Operating system(s): Linux, Mac OS X, and Windows</p>
    <p id="Par85">Programming language: Haskell/NGLess/Python/Bash</p>
    <p id="Par86">Other requirements: None</p>
    <p id="Par87">License: MIT License</p>
    <p id="Par88">Any restrictions to use by non-academics: None</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec14">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="40168_2019_684_MOESM1_ESM.pdf">
            <label>Additional file 1:</label>
            <caption>
              <p><bold>Figure S1.</bold> Fraction of spurious hits to the human genome that is incorrectly kept as a function of the minimum size of the alignment used to consider it a valid alignment. The benchmark simulated dataset was aligned to the human genome. As in this simulated dataset there should be no human reads, any alignment was considered spurious. (PDF 52 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="40168_2019_684_MOESM2_ESM.xlsx">
            <label>Additional file 2:</label>
            <caption>
              <p><bold>Table S1.</bold> Complete timing information for benchmark on real data for NGLess, MOCAT2, and bwa/htseq-count. (XLSX 11 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="40168_2019_684_MOESM3_ESM.xlsx">
            <label>Additional file 3:</label>
            <caption>
              <p><bold>Table S2.</bold> Full results on the synthetic benchmark, shown are the Spearman correlation values between the estimated OG abundances and the distribution being simulated. (XLSX 6 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="40168_2019_684_MOESM4_ESM.pdf">
            <label>Additional file 4:</label>
            <caption>
              <p>Text S1. The NGLess Language and Standard Library (PDF 129 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank João Carriço (Instituto de Medicina Molecular, University of Lisbon) as well as the members of the Bork lab for helpful comments. We thank Anna Głazek (EMBL) for several patches to the code. Beta users of NGLess are thanked for their feedback and bug reports.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par89">Funding was provided by the European Union’s Horizon 2020 Research and Innovation Programme (grant #686070; DD-DeCaF), the European Research Council (ERC) MicrobioS (ERC-AdG-669830), the Fundação para a Ciência e a Tecnologia (grant EXCL/EEI-ESS/0257/2012; DataStorm: Large-Scale Data management in cloud environments), and the European Molecular Biology Laboratory (EMBL).</p>
    </sec>
    <sec id="FPar2" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par90">NGLess is available as open source software at <ext-link ext-link-type="uri" xlink:href="https://github.com/ngless-toolkit/ngless">https://github.com/ngless-toolkit/ngless</ext-link> and releases are archived under DOI 10.5281/zenodo.1040241. Additionally, NGLess is available as a bioconda package [<xref ref-type="bibr" rid="CR51">51</xref>] and in container form (through biocontainers [<xref ref-type="bibr" rid="CR52">52</xref>]). Documentation and tutorials can be found at <ext-link ext-link-type="uri" xlink:href="https://ngless.embl.de">https://ngless.embl.de</ext-link>. <italic>NG-meta-profiler</italic> is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ngless-toolkit/ng-meta-profiler">https://github.com/ngless-toolkit/ng-meta-profiler</ext-link> and released versions are archived under DOI 10.5281/zenodo.1310745. All the databases mentioned can be downloaded automatically with the NGLess tool or accessed using the DOI 10.5281/zenodo.1299267.</p>
      <p id="Par91">Jug [<xref ref-type="bibr" rid="CR53">53</xref>] based scripts to download the data and run the benchmarks are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ngless-toolkit/NGLess2018benchmark">https://github.com/ngless-toolkit/NGLess2018benchmark</ext-link>. This repository also contains the results of running the benchmarks on our servers and all downstream processing. The benchmarks were run on an Intel Xeon (CPU model “E7- 4830 @ 2.13GHz”) with 32 cores (64 virtual cores).</p>
      <p id="Par92">The sequence datasets used for the benchmark are available from the European Nucleotide Archive (ENA) (accession numbers: SAMEA2621229, SAMEA2621155, SAMEA2621033, SAMEA2467039, SAMEA2466896, and SAMEA2466965). The simulated datasets are available on Zenodo (DOI: 10.5281/zenodo.2539431). That resource contains the metagenomes, the underlying ground truth values, and a more complete description of the generation process.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>LPC conceived of the project and wrote the first draft of the manuscript. LPC, ATF, and PB coordinated and oversaw the study. LPC, RA, JHC, and PM developed the software and associated databases. LPC, RA, PM, JHC, and PB drafted the manuscript and Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Text S1. LPC and RA designed and performed the benchmark studies. All authors contributed to the review of the manuscript before submission for publication. All authors read and approved the final manuscript.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par93">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par94">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par95">The authors declare that they have no competing interests.</p>
  </notes>
  <notes>
    <title>Publisher’s Note</title>
    <p id="Par96">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grice</surname>
            <given-names>EA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Topographical and temporal diversity of the human skin microbiome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>324</volume>
        <fpage>1190</fpage>
        <lpage>1192</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1171700</pub-id>
        <pub-id pub-id-type="pmid">19478181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>TSB</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The human gut microbiome: from association to modulation</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>172</volume>
        <fpage>1198</fpage>
        <lpage>1215</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.02.044</pub-id>
        <pub-id pub-id-type="pmid">29522742</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilbert</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Current understanding of the human microbiome</article-title>
        <source>Nat. Med.</source>
        <year>2018</year>
        <volume>24</volume>
        <fpage>392</fpage>
        <lpage>400</lpage>
        <pub-id pub-id-type="doi">10.1038/nm.4517</pub-id>
        <pub-id pub-id-type="pmid">29634682</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A catalog of the mouse gut metagenome</article-title>
        <source>Nature Biotechnology</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>1103</fpage>
        <lpage>1108</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3353</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A reference gene catalogue of the pig gut microbiome</article-title>
        <source>Nature Microbiology</source>
        <year>2016</year>
        <volume>1</volume>
        <fpage>16161</fpage>
        <pub-id pub-id-type="doi">10.1038/nmicrobiol.2016.161</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coelho</surname>
            <given-names>LP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Similarity of the dog and human gut microbiomes in gene content and response to diet</article-title>
        <source>Microbiome</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>72</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-018-0450-3</pub-id>
        <pub-id pub-id-type="pmid">29669589</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure and function of the global ocean microbiome</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>1261359</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1261359</pub-id>
        <pub-id pub-id-type="pmid">25999513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kultima</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MOCAT: A metagenomics assembly and gene prediction toolkit</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>e47656</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0047656</pub-id>
        <pub-id pub-id-type="pmid">23082188</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kultima</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MOCAT2: A metagenomic assembly, annotation and profiling framework</article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>2520</fpage>
        <lpage>2523</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw183</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Treangen</surname>
            <given-names>TJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MetAMOS: A modular and open source metagenomic assembly and analysis pipeline</article-title>
        <source>Genome biology</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>R2</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-1-r2</pub-id>
        <pub-id pub-id-type="pmid">23320958</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Narayanasamy</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IMP: A pipeline for reproducible reference-independent integrated metagenomic and metatranscriptomic analyses</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>260</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1116-8</pub-id>
        <pub-id pub-id-type="pmid">27986083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e61217</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0061217</pub-id>
        <pub-id pub-id-type="pmid">23630581</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oksanen</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The vegan package</article-title>
        <source>Community ecology package</source>
        <year>2007</year>
        <volume>10</volume>
        <fpage>631</fpage>
        <lpage>637</lpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic biomarker discovery and explanation</article-title>
        <source>Genome Biol.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>R60</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2011-12-6-r60</pub-id>
        <pub-id pub-id-type="pmid">21702898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Prabhu, P. et al. A survey of the practice of computational science. in SC ’11: Proceedings of 2011 international conference for high performance computing, networking, storage and analysis 1–12 (2011). 10.1145/2063348.2063374</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johanson</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Hasselbring</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Effectiveness and efficiency of a domain-specific language for high-performance marine ecosystem simulation: a controlled experiment</article-title>
        <source>Empirical Software Engineering</source>
        <year>2017</year>
        <volume>22</volume>
        <fpage>2206</fpage>
        <lpage>2236</lpage>
        <pub-id pub-id-type="doi">10.1007/s10664-016-9483-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donoho</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Maleki</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rahman</surname>
            <given-names>IU</given-names>
          </name>
          <name>
            <surname>Shahram</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stodden</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Reproducible research in computational harmonic analysis</article-title>
        <source>Computing in Science &amp; Engineering</source>
        <year>2009</year>
        <volume>11</volume>
        <fpage>8</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2009.15</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vandewalle</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kovacevic</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vetterli</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Reproducible research in signal processing</article-title>
        <source>Signal Process Mag IEEE</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>37</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1109/MSP.2009.932122</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fomel</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Reproducible research as a community effort: Lessons from the madagascar project</article-title>
        <source>Computing in Science &amp; Engineering</source>
        <year>2015</year>
        <volume>17</volume>
        <fpage>20</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2014.94</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carey</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Papin</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Ten simple rules for biologists learning to program</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>e1005871</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005871</pub-id>
        <pub-id pub-id-type="pmid">29300745</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Biggs</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>SolexaQA</surname>
          </name>
        </person-group>
        <article-title>At-a-glance quality assessment of illumina second-generation sequencing data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>485</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-485</pub-id>
        <pub-id pub-id-type="pmid">20875133</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Del Fabbro</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Scalabrin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Morgante</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Giorgi</surname>
            <given-names>FM</given-names>
          </name>
        </person-group>
        <article-title>An extensive evaluation of read trimming effects on illumina NGS data analysis</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e85024</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0085024</pub-id>
        <pub-id pub-id-type="pmid">24376861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast genome-wide functional annotation through orthology assignment by eggNOG-mapper</article-title>
        <source>Molecular Biology and Evolution</source>
        <year>2017</year>
        <volume>34</volume>
        <fpage>2115</fpage>
        <lpage>2122</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msx148</pub-id>
        <pub-id pub-id-type="pmid">28460117</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ugarte</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vicedomini</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bernardes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Carbone</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A multi-source domain annotation pipeline for quantitative metagenomic and metatranscriptomic functional profiling</article-title>
        <source>Microbiome</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>149</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-018-0532-2</pub-id>
        <pub-id pub-id-type="pmid">30153857</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrated catalog of reference genes in the human gut microbiome</article-title>
        <source>Nature Biotechnology</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>834</fpage>
        <lpage>841</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2942</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>eggNOG 4.5: A hierarchical orthology framework with improved functional annotations for eukaryotic, prokaryotic and viral sequences</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D286</fpage>
        <lpage>D293</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1248</pub-id>
        <pub-id pub-id-type="pmid">26582926</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Data, information, knowledge and principle: Back to metabolism in KEGG</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>D199</fpage>
        <lpage>D205</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1076</pub-id>
        <pub-id pub-id-type="pmid">24214961</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Overbeek</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The subsystems approach to genome annotation and its use in the project to annotate 1000 genomes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>5691</fpage>
        <lpage>5702</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gki866</pub-id>
        <pub-id pub-id-type="pmid">16214803</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>King</surname>
            <given-names>ZA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BiGG models: A platform for integrating, standardizing and sharing genome-scale models</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D515</fpage>
        <lpage>D522</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1049</pub-id>
        <pub-id pub-id-type="pmid">26476456</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C-M</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sadakane</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>T-W</given-names>
          </name>
        </person-group>
        <article-title>MEGAHIT: an ultra-fast single-node solution for large and complex metagenomics assembly via succinct de bruijn graph</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1674</fpage>
        <lpage>1676</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv033</pub-id>
        <pub-id pub-id-type="pmid">25609793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darling</surname>
            <given-names>AE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Critical assessment of metagenome interpretation—a benchmark of metagenomics software</article-title>
        <source>Nature Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>1063</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4458</pub-id>
        <pub-id pub-id-type="pmid">28967888</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Awad S, Irber L, Titus Brown C. Evaluating metagenome assembly on a simple defined community with many strain variants. bioRxiv. 2017;155358.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hyatt</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prodigal: Prokaryotic gene recognition and translation initiation site identification</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id>
        <pub-id pub-id-type="pmid">20043860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Li H. Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. arXiv preprint arXiv. 2013;1303.3997.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: Pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SOAP2: An improved ultrafast tool for short read alignment</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1966</fpage>
        <lpage>1967</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp336</pub-id>
        <pub-id pub-id-type="pmid">19497933</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pyl</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>HTSeq–a python framework to work with high-throughput sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>166</fpage>
        <lpage>169</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu638</pub-id>
        <pub-id pub-id-type="pmid">25260700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeller</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Tap</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Voigt</surname>
            <given-names>A. Y.</given-names>
          </name>
          <name>
            <surname>Sunagawa</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Kultima</surname>
            <given-names>J. R.</given-names>
          </name>
          <name>
            <surname>Costea</surname>
            <given-names>P. I.</given-names>
          </name>
          <name>
            <surname>Amiot</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bohm</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Brunetti</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Habermann</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Hercog</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Koch</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Luciani</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Mende</surname>
            <given-names>D. R.</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>M. A.</given-names>
          </name>
          <name>
            <surname>Schrotz-King</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Tournigand</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Tran Van Nhieu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Yamada</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Zimmermann</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Benes</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Kloor</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ulrich</surname>
            <given-names>C. M.</given-names>
          </name>
          <name>
            <surname>von Knebel Doeberitz</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Sobhani</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Potential of fecal microbiota for early-stage detection of colorectal cancer</article-title>
        <source>Molecular Systems Biology</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>11</issue>
        <fpage>766</fpage>
        <lpage>766</lpage>
        <pub-id pub-id-type="doi">10.15252/msb.20145645</pub-id>
        <pub-id pub-id-type="pmid">25432777</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwab</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Karrenbach</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Claerbout</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Making scientific computations reproducible</article-title>
        <source>Comput Sci Eng</source>
        <year>2000</year>
        <volume>2</volume>
        <fpage>61</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1109/5992.881708</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Snakemake–a scalable bioinformatics workflow engine</article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2520</fpage>
        <lpage>2522</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Tommaso</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nextflow enables reproducible computational workflows</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>316</fpage>
        <lpage>319</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3820</pub-id>
        <pub-id pub-id-type="pmid">28398311</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and samtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>eggNOG 5.0: A hierarchical, functionally and phylogenetically annotated orthology resource based on 5090 organisms and 2502 viruses</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D309</fpage>
        <lpage>D314</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1085</pub-id>
        <pub-id pub-id-type="pmid">30418610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilson</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Best practices for scientific computing</article-title>
        <source>PLoS Biology</source>
        <year>2014</year>
        <volume>12</volume>
        <fpage>e1001745</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.1001745</pub-id>
        <pub-id pub-id-type="pmid">24415924</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Niemeyer</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>Software citation principles</article-title>
        <source>Peer J Comput Sci.</source>
        <year>2016</year>
        <volume>2</volume>
        <fpage>e86</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj-cs.86</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Johanson A, Hasselbring W. Software engineering for computational science: Past, present, future. Computing in Science Engineering. 2018:1–1.</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Truong</surname>
            <given-names>DT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MetaPhlAn2 for enhanced metagenomic taxonomic profiling</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>902</fpage>
        <lpage>903</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3589</pub-id>
        <pub-id pub-id-type="pmid">26418763</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Milanese</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Microbial abundance, activity and population genomic profiling with mOTUs2</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1014</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-08844-4</pub-id>
        <pub-id pub-id-type="pmid">30833550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Duggal</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>417</fpage>
        <lpage>419</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4197</pub-id>
        <pub-id pub-id-type="pmid">28263959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Amstutz, P. et al. Common workflow language, v1.0. (2016). 10.6084/m9.figshare.3115156.v2</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grüning</surname>
            <given-names>Björn</given-names>
          </name>
          <name>
            <surname>Dale</surname>
            <given-names>Ryan</given-names>
          </name>
          <name>
            <surname>Sjödin</surname>
            <given-names>Andreas</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>Brad A.</given-names>
          </name>
          <name>
            <surname>Rowe</surname>
            <given-names>Jillian</given-names>
          </name>
          <name>
            <surname>Tomkins-Tinch</surname>
            <given-names>Christopher H.</given-names>
          </name>
          <name>
            <surname>Valieris</surname>
            <given-names>Renan</given-names>
          </name>
          <name>
            <surname>Köster</surname>
            <given-names>Johannes</given-names>
          </name>
        </person-group>
        <article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>
        <source>Nature Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>7</issue>
        <fpage>475</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0046-7</pub-id>
        <pub-id pub-id-type="pmid">29967506</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>da Veiga Leprevost</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BioContainers: an open-source and community-driven framework for software standardization</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>2580</fpage>
        <lpage>2582</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx192</pub-id>
        <pub-id pub-id-type="pmid">28379341</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Coelho LP. Jug: Software for parallel reproducible computation in python. Journal of Open Research Software. 2017;5.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mende</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zeller</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Accurate and universal delineation of prokaryotic species</article-title>
        <source>Nature Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>881</fpage>
        <lpage>884</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2575</pub-id>
        <pub-id pub-id-type="pmid">23892899</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic species profiling using universal phylogenetic marker genes</article-title>
        <source>Nature Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1196</fpage>
        <lpage>1199</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2693</pub-id>
        <pub-id pub-id-type="pmid">24141494</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
