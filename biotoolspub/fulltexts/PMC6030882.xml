<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6030882</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gky431</article-id>
    <article-id pub-id-type="publisher-id">gky431</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Web Server Issue</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The BaMM web server for <italic>de-novo</italic> motif discovery and regulatory sequence analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kiesel</surname>
          <given-names>Anja</given-names>
        </name>
        <xref ref-type="author-notes" rid="FN1"/>
        <xref ref-type="aff" rid="AFF1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Roth</surname>
          <given-names>Christian</given-names>
        </name>
        <xref ref-type="author-notes" rid="FN1"/>
        <xref ref-type="aff" rid="AFF1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ge</surname>
          <given-names>Wanwan</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wess</surname>
          <given-names>Maximilian</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meier</surname>
          <given-names>Markus</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Söding</surname>
          <given-names>Johannes</given-names>
        </name>
        <!--<email>soeding@mpibpc.mpg.de</email>-->
        <xref ref-type="aff" rid="AFF1"/>
        <xref ref-type="corresp" rid="COR1"/>
      </contrib>
    </contrib-group>
    <aff id="AFF1">Quantitative and Computational Biology, Max Planck Institute for Biophysical Chemistry, Am Fassberg 11, 37077 Göttingen, Germany</aff>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +49 551 201 2890; Fax: +49 551 201 2803; Email: <email>soeding@mpibpc.mpg.de</email></corresp>
      <fn id="FN1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>02</day>
      <month>7</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-05-28">
      <day>28</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>46</volume>
    <issue>Web Server issue</issue>
    <fpage>W215</fpage>
    <lpage>W220</lpage>
    <history>
      <date date-type="accepted">
        <day>09</day>
        <month>5</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>5</month>
        <year>2018</year>
      </date>
      <date date-type="received">
        <day>14</day>
        <month>2</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gky431.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The BaMM web server offers four tools: (i) <italic>de-novo</italic> discovery of enriched motifs in a set of nucleotide sequences, (ii) scanning a set of nucleotide sequences with motifs to find motif occurrences, (iii) searching with an input motif for similar motifs in our BaMM database with motifs for &gt;1000 transcription factors, trained from the GTRD ChIP-seq database and (iv) browsing and keyword searching the motif database. In contrast to most other servers, we represent sequence motifs not by position weight matrices (PWMs) but by Bayesian Markov Models (BaMMs) of order 4, which we showed previously to perform substantially better in ROC analyses than PWMs or first order models. To address the inadequacy of P- and E-values as measures of motif quality, we introduce the AvRec score, the average recall over the TP-to-FP ratio between 1 and 100. The BaMM server is freely accessible without registration at <ext-link ext-link-type="uri" xlink:href="https://bammmotif.mpibpc.mpg.de">https://bammmotif.mpibpc.mpg.de</ext-link>.</p>
    </abstract>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Many methods such as ChIP-seq or high-throughput SELEX (<xref rid="B1" ref-type="bibr">1</xref>) produce a set of nucleotide sequences that are preferentially bound by a protein of interest <italic>in vitro</italic> or <italic>in vivo</italic>. From such data, a motif model for the sequence dependence of the binding affinity of the protein to the DNA or RNA can be derived. This model can then be used to predict binding sites and their strengths in other sequences.</p>
    <p>Position weight matrices (PWMs) are the standard model to describe binding motifs. In the PWM every motif position contributes additively and independently from other positions to the total binding energy. Even though the approximation of independence of positions works well for many transcription factors, dependencies do occur (<xref rid="B2" ref-type="bibr">2</xref>,<xref rid="B3" ref-type="bibr">3</xref>), for example due to bendability or shape constraints during binding (<xref rid="B4" ref-type="bibr">4</xref>), to multiple binding configurations of the protein (<xref rid="B5" ref-type="bibr">5</xref>), or to cooperative interactions between closely binding factors that can modulate each others’ binding affinities (<xref rid="B6" ref-type="bibr">6</xref>).</p>
    <p>PWMs can be generalized to Markov models of order <italic>k</italic> that account for nucleotide dependencies by conditioning the probability for the four nucleotides at each motif position on the previous k nucleotides. First-order Markov models have been added to the popular motif databases JASPAR and HOCOMOCO (<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B8" ref-type="bibr">8</xref>). Models of order 2 and higher have not yet been adopted in the major databases, probably due to the difficulties to robustly train the many parameters of these models on limited data.</p>
    <p>We recently developed Bayesian Markov Models (BaMMs) (<xref rid="B9" ref-type="bibr">9</xref>), which efficiently prevent overfitting by automatically learning conditional probabilities only up to an order <italic>k</italic> at which they can still be estimated reliably. The key idea is that the conditional probabilities of order <italic>k</italic> − 1 are used as prior probabilities for the conditional probabilities of order <italic>k</italic>. We have shown that BaMMs of order 4 and 5 systematically outperform PWMs and first-order models in distinguishing bound sequences from negative sequences generated by a second-order Markov model (<xref rid="B9" ref-type="bibr">9</xref>).</p>
    <p>A very popular web server for regulatory sequence analysis based on PWMs offering a wide choice of tools is the MEME server (<xref rid="B10" ref-type="bibr">10</xref>). The RSAT web server (<xref rid="B11" ref-type="bibr">11</xref>) provides a general toolbox for the analysis of regulatory sequences including motif-based analyses. Furthermore, other web resources and databases are available for training first-order models (<xref rid="B12" ref-type="bibr">12</xref>,<xref rid="B13" ref-type="bibr">13</xref>).</p>
    <p>The BaMMmotif server brings the improved quality of BaMM motif models within reach of users unfamiliar with command-line tools, in a largely self-explanatory web interface designed for ease of use. The user can discover BaMM models enriched in a set of input sequences, scan sequence sets with BaMM models for motif occurrences, and compare discovered or uploaded motifs with a database of BaMM models learned from ChIP-seq datasets.</p>
  </sec>
  <sec id="SEC2">
    <title>BAMM TOOLS</title>
    <p>In the following we describe the four tools offered by the BaMM server (Figure <xref ref-type="fig" rid="F1">1</xref>).</p>
    <fig id="F1" orientation="portrait" position="float">
      <label>Figure 1.</label>
      <caption>
        <p>Tools offered by the BaMM server: (i) de-novo discovery of motifs enriched in a nucleotide sequence set. Motifs are represented by higher order BaMMs, which capture correlations between nucleotides. (ii) Searching with an input BaMM or PWM motif for similar motifs in our database of over 1000 fourth-order BaMM motifs. (iii) Browsing and keyword searching in our motif database. (iv) Scanning a set of nucleotide sequences with BaMM or PWM motifs to find motif occurrences.</p>
      </caption>
      <graphic xlink:href="gky431fig1"/>
    </fig>
    <sec id="SEC2-1">
      <title>De-novo motif discovery using higher-order BaMMs</title>
      <p>This tool discovers the motifs enriched in an input set of nucleotide sequences in comparison to the expectation from a background model. For example in sequences obtained from a ChIP-seq or HT-SELEX experiment, the BaMM motif models will approximately describe the sequence dependence of the binding energy of the protein to DNA (see <xref ref-type="supplementary-material" rid="sup1">page 2 of supplementary material</xref> in (<xref rid="B9" ref-type="bibr">9</xref>)). The motif model can be used to scan other sequences for motif occurrences (see next subsection).</p>
      <sec id="SEC2-1-1">
        <title>Method</title>
        <p>The motif discovery proceeds in two stages, seed pattern discovery and motif refinement. For the pattern discovery we developed a fast and sensitive algorithm (PEnGmotif) that will be described in detail elsewhere. Briefly, it finds all locally optimal <italic>W</italic>-mers (default <italic>W</italic> = 8) over an alphabet of 11 IUPAC letters (A, C, G, T, R = A or G, Y = C or T, W = A or T, S = C or G, M= A or C, K = G or T, N = A, C, G or T), where locally optimal patterns are those for which changing any single one of its letters would result in a decreased enrichment relative to the random expectation from the background model. (Alternatively, the <italic>P</italic>-value or the mutual information between presence/absence of motifs and input versus background sequence can be optimized.) With each locally optimal pattern, a PWM of length <italic>W</italic> is initialized and optimized using an expectation maximization (EM) algorithm. PWMs that have very similar overlapping regions are merged and ranked by our new AvRec score (next section).</p>
        <p>The seed motifs are then refined using BaMM!motif (<xref rid="B9" ref-type="bibr">9</xref>). It learns the parameters of the BaMMs with an EM algorithm that maximizes the log likelihood of the motif model under a zero-or-one-occurrence-per-sequence (ZOOPS) model (<xref rid="B14" ref-type="bibr">14</xref>). The BaMM server offers to train motifs of up to fourth order.</p>
        <p>By default, BaMM learns a second order Markov model from the input sequences as a background model. The background model is needed first in the motif discovery to model the sequence stretches not modeled by the motif model and second in the motif quality assessment step to generate negative sequences to estimate motif occurrence <italic>P</italic>-values. A second order model is generally preferable to first or zeroth order as it can better describe sequence biases observed in open versus closed chromatin, ChIPped versus unChIPped sequences etc. (<xref rid="B15" ref-type="bibr">15</xref>). A model of order 1 or 0 is recommended for the discovery of very short motifs (e.g. four to five nucleotides) such as to RNA-binding sites, as such short motifs could be learned to some extent even by a second order background model, severely reducing the sensitivity to discover them.</p>
      </sec>
      <sec id="SEC2-1-2">
        <title>Usage of de-novo motif discovery</title>
        <p>After uploading a FASTA file of up to 50 MB with the input sequences, the motif discovery can be started. A drop-down menu offers advanced options in four categories: general settings, seeding stage, model refinement stage and settings for plots and analyses.</p>
        <p>In the general settings category the user can choose whether the motif can be present on both strands, set the order of the background model (default 2) and upload an optional sequence set to train the background model on. Settings of the seeding stage include the initial pattern length <italic>W</italic>, the <italic>z</italic>-score significance threshold for refining a motif, and the objective function to optimize in the search for locally optimal patterns. For the refinement stage the user can choose the motif model order (default 2) and the number of flanking positions on the left and right of the core model found in the seed stage. Finally, the user can choose to skip motif scanning, motif performance evaluation or motif annotation, and change the significance thresholds for scanning and annotation.</p>
        <p>By default up to four best-performing seed patterns are refined to higher-order models. Seed patterns are ranked by their average recall (AvRec) score (see below). Alternatively, the user can choose to select seed patterns manually for refinement after the seeding stage.</p>
        <p>The results page (Figure <xref ref-type="fig" rid="F2">2A</xref>) lists in a summary table the discovered enriched motifs with their IUPAC patterns, the sequence logos of the 0th-order model (forward and reverse complement), the AvRec motif quality score and the fraction of sequences with motifs (‘frac. occurrence’), estimated using the fdrtool (<xref rid="B16" ref-type="bibr">16</xref>) (explained in subsection ‘Dataset AvRec and motif AvRec’). By clicking on the motifs or scrolling down, detailed results for the motifs are shown: 0th-order (forward and reverse complement), first- and second-order sequence logos (Figure <xref ref-type="fig" rid="F2">2B</xref>); four motif quality assessment plots and a plot of the positional distribution of the motif occurrences relative to the center of the sequences (Figure <xref ref-type="fig" rid="F2">2C</xref>). (Sequences do not have to be of the same length.) Clicking on the download button in the summary table above saves a zip file containing motif files in BaMM format with the extension ihbcp and all analysis plots for the motif. Last, the database motifs found similar to the discovered motif are listed (see ‘motif-motif comparison’ below) with links to the database entry (‘Best matches with our motif database’, Figure <xref ref-type="fig" rid="F2">2D</xref>). The results page can later be retrieved by giving the job ID on the ‘Find my job’ page. Results are stored for up to 3 months.</p>
        <fig id="F2" orientation="portrait" position="float">
          <label>Figure 2.</label>
          <caption>
            <p>Selected results from a de-novo motif discovery run. (<bold>A</bold>) Summary table of discovered motifs. (<bold>B</bold>) Sequence logos of order 0, 1 and 2 for one discovered motif. (<bold>C</bold>) Motif quality analysis and positional distribution. In the dataset-centered analysis (left) all input sequences are defined as positives. In the motif-centered analysis (right), only input sequences carrying a motif occurrence are positives. Their fraction is estimated using fdrtool (orange broken line on the upper right). The quality of motifs is quantified by average recall (AvRec), the blue area under the TP-to-FP-versus-recall curves. The curves for positive-to-negative ratios in the dataset of 1:1, 1:10 and 1:100 are plotted. Recall = TP/(TP + FN), where TP = true positives, FP = false positives, FN = false negatives. Positional distribution of the motif occurrences relative to the center of the sequences is shown on the bottom. (<bold>D</bold>) List of database motifs similar to discovered motif.</p>
          </caption>
          <graphic xlink:href="gky431fig2"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec id="SEC2-2">
    <title>Scan sequences for motif occurrences</title>
    <p>A set of input sequences can be scanned with a motif or a set of motifs for motif occurrences. The input motifs can be in MEME (version 4 and above) or BaMM format and could have been discovered de-novo by BaMM or they could come from the BaMM database or some other database.</p>
    <p>We developed a motif scanning tool that evaluates the log odds score for BaMMs (and PWMs) of any order. A table with the motif occurrences can be downloaded in a zip file, together with the motif analysis on the supplied sequences. The table of motif occurrences contains in each line the sequence length, motif position, binding sites, <italic>P</italic>-value, and E-value of the occurrence. The <italic>P</italic>-values are computed by maximum-likelihood fitting of the high-scoring tail of the log-odds score distribution on sequences generated with the background model with an exponential function, which gave good fits (see PhD thesis at <ext-link ext-link-type="uri" xlink:href="https://edoc.ub.uni-muenchen.de/21504/">https://edoc.ub.uni-muenchen.de/21504/</ext-link>). Each motif is also evaluated using the dataset and motif-based average recall (AvRec, see below) and the positional distribution of the motif occurrences around the center of the sequences (Figure <xref ref-type="fig" rid="F2">2C</xref>).</p>
  </sec>
  <sec id="SEC2-3">
    <title>BaMM motif database</title>
    <p>Our database contains 1021 fourth-order BaMMs trained on ChIP-seq datasets of 620 human transcription factors (TFs), 345 mouse TFs, 19 rat TFs, 16 zebrafish TFs and 21 yeast TFs from the GTRD database (<xref rid="B17" ref-type="bibr">17</xref>). For each motif, a meta table, details with higher-order sequence logos, positional enrichment around the centers of training sequences, and motif quality assessment plots, evaluated on the ChIP-seq training sequences, are presented. The user can browse the database or perform a text search through the list of names of the transcription factor.</p>
  </sec>
  <sec id="SEC2-4">
    <title>Search with query motifs through the motif database</title>
    <p>This tool searches for motifs in our BaMM motif database that are similar to the query motifs (in MEME or BaMM format). This motif-motif search is automatically run after de-novo motif discovery using each of discovered motifs as query. The query motifs can also be provided by the user. The output of this tool is shown in Figure <xref ref-type="fig" rid="F2">2D</xref>.</p>
    <p>Motif-motif similarities are computed between the zeroth order contribution of the motifs. The distance between two motifs is the minimum distance for any gapless alignment of their columns that leaves at least four columns aligned. The similarity between aligned motifs <italic>M</italic><sub>1</sub> and <italic>M</italic><sub>2</sub> is defined as
<disp-formula><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \sum _j \left( - d^\mathrm{JS}(M_{1j}, M_{2j}) + d^\mathrm{JS}(M_{1j}, M_{\mathrm{bg}}) + d^\mathrm{JS}(M_{2j}, M_{\mathrm{bg}}) \right).\nonumber \end{equation*}\end{document}</tex-math></disp-formula>Here, the sum runs over all aligned columns <italic>j. d</italic><sup>JS</sup>(<italic>M</italic><sub>1<italic>j</italic></sub>, <italic>M</italic><sub>2<italic>j</italic></sub>) is the Jenssen-Shannon divergence between the four nucleotide probabilities of model 1 and of model 2 at aligned column <italic>j</italic>, and <italic>M</italic><sub>bg</sub> is the zeroth order background distribution in the set on which the query model was learned.</p>
    <p>The <italic>E</italic>-values for the motif-motif matches are computed from these similarity scores by fitting the density of scores computed between 100 randomized query motifs and the databases motifs and fitting the high-scoring tail with an exponential distribution (see PhD thesis of Anja Kiesel at <ext-link ext-link-type="uri" xlink:href="https://edoc.ub.uni-muenchen.de/21504/">https://edoc.ub.uni-muenchen.de/21504/</ext-link>). The randomization of the query motif is achieved by exchanging A with T probabilities of each position with probability 0.5, and analogously for C and G. In addition columns within 2 positions of each other were randomly swapped. This motif randomization keeps the local GC vs. AT content conserved. In our benchmarks, this score performed as well as the best of the TOMTOM scores (Pearson correlation) (<xref rid="B18" ref-type="bibr">18</xref>). An example of results of the motif search is shown in Figure <xref ref-type="fig" rid="F2">2D</xref>.</p>
  </sec>
  <sec id="SEC3">
    <title>MOTIF QUALITY ASSESSMENT AND RANKING</title>
    <sec id="SEC3-1">
      <title><italic>P</italic>-values do not assess biological relevance of motifs</title>
      <p><italic>P</italic>-values and <italic>E</italic>-values have a severe drawback for ranking motif models: They can be very significant and yet the motifs have no biological relevance at all. For a fixed <italic>x</italic>-fold enrichment of motif occurrences on the input set in comparison to the background model, the <italic>P</italic>-value decreases exponentially with the number of sequences in the zero-or-one-occurrence-per-sequence (ZOOPS) model. For that reason, even biologically irrelevant motifs with very slight enrichment factors (e.g. 1.1) can obtain an extremely significant <italic>E</italic>-value if the input set is large enough. Small enrichment factors can occur frequently in practice simply due to an imperfect background model that slightly underestimates the expected frequency of occurrence.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Precision, recall and false discovery rate</title>
      <p>To get a more relevant measure of how well the motif model can separate sequences with a motif (positives) from the background sequences (negatives), we first generate for each input sequence one random sequence of the same length sampled with the second-order Markov background model learned from the input sequences. The score for an input or background sequence is the maximum of the log odds scores of the BaMM over all possible motif positions (ZOOPS model). Every sequence with a score above a cut-off is predicted to carry a motif. We rank all sequences by their score and, for each cut-off score, we count the number of correct predictions above that score, called true positives (TP), and the number of incorrect predictions above the cut-off score, called false positives (FP). The precision is the fraction of predictions that are correct, TP/(TP + FP), and the recall (=sensitivity) is the fraction of positive sequences that are actually predicted, TP/(TP + FN). The false discovery rate is FDR = 1 − precision = FP/(TP + FP).</p>
      <p>If we did this analysis on the same sequences from which we had trained the model, we could easily overestimate the motif model performance by overtraining. We therefore use four-fold cross-validation to assess the motif model performance: We split the input and background sequences into four equal-sized parts, retrain the model on three. The results from the four hold-out sets are then combined.</p>
    </sec>
    <sec id="SEC3-3">
      <title>The AUPRC assesses models partly in irrelevant regimes</title>
      <p>The area under the recall-precision curve (AUPRC) (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2B</xref>) can be interpreted as mean model recall (=sensitivity) averaged over the entire range of precision from 0 to 1. Consider two models: one achieves a maximum precision of 0.99 and the other achieves at any recall a 1% higher precision, with a maximum at 0.9999. Even though the two models have AUPRCs that only differ by 1%, their minimum false discovery rates differ by two orders of magnitude (0.01 and 0.0001), which can make a huge difference in practice.</p>
      <p>Consider two application cases. In the first, the expected ratio of sequences with and without true binding sites is ∼1:1, e.g. for a ChIP-seq experiment, and in the second case it is 1:100, e.g. when scanning 10<sup>4</sup> promoter regions in the human genome for motif occurrences, of which 100 are expected to carry the motif. In the first case, an FDR of 0.1, determined at ratio 1:1 between positive and negative (background) sequences, is quite satisfactory to identify sequences with true binding sites. In the second case, an FDR of 0.1 would result in 0.1 × 10<sup>4</sup> = 1000 false predictions, which would swamp the expected 100 true binding occurrences. A model with an FDR of 0.001 determined at ratio 1:1 between positive and negative sequences would give us 0.001 × 10<sup>4</sup> = 10 false predictions, which would result in an acceptable FDR of 10/110.</p>
      <p>So the FDR (estimated for a ratio 1:1 of positives to negatives) that is relevant to assess the quality of motif models depends on the application, more precisely, on the expected ratio of positives to negatives in the sequence data. In contrast, the AUPRC puts much weight on very high FDRs, e.g. the range between 0.9 and 1 has as much weight as the range between 0 and 0.1. Another popular measure, the area under the receiver operator curve (AUROC), can be shown to be even less relevant and difficult to interpret for motif model assessment.</p>
    </sec>
    <sec id="SEC3-4">
      <title>Average recall (AvRec)</title>
      <p>We sought a motif quality analysis plot and associated quality measure (i) that covers the range of FDRs most relevant in practical applications and (ii) that allows the user to easily estimate the performance of the motif in her particular application, that is, given the ratio between positive and negative sequences expected for her application.</p>
      <p>We replace the precision in the precision-recall plot by log<sub>10</sub> of the ratio <italic>R</italic> = TP/FP between true and false positives, log<sub>10</sub>TP/FP (Figure <xref ref-type="fig" rid="F2">2C</xref>, middle). From the ratio <italic>R</italic> one can immediately obtain the false discovery rate, FDR = 1/(1 + <italic>R</italic>), and vice versa, <italic>R</italic> = (1 − FDR)/FDR. <italic>R</italic> = 100 corresponds to FDR = 1/101, <italic>R</italic> = 1 corresponds to FDR = 0.5. We define the AvRec quality measure as the average recall computed over a range of log<sub>10</sub><italic>R</italic>-values from 0 to 2, which corresponds to an FDR-range from 1/101 to 0.5. We argue that this range of FDRs is most relevant in practice, as illustrated by the two previous examples.</p>
      <p>The new quality measure also satisfies the second requirement. The user can simply pick the curve in the AvRec plot that corresponds to the ratio of positive to negative sequences that she expects in her application. Nicely, the curve at ratio 1:10 is the curve at ratio 1:1 shifted down by one unit (log<sub>10</sub>10), because <italic>R</italic> is proportional to the ratio of positive to negative sequences in the dataset: When the number of negative sequences is amplified by 10, the number of false positive predictions will also be increased by a factor of 10. On the web server, we show the curves with ratios of 1:1, 1:10 and 1:100 (if visible on the <italic>y</italic>-scale).</p>
    </sec>
    <sec id="SEC3-5">
      <title>Dataset AvRec and motif AvRec</title>
      <p>We used two definitions of positive and negative sequences. In the <italic>dataset-centered analysis</italic> (Figure <xref ref-type="fig" rid="F2">2C</xref>, left), the true positive sequences are all sequences from the input set above the cut-off score and the false positive sequences are all background sequences above the cut-off score. The upper left plot in Figure <xref ref-type="fig" rid="F2">2C</xref> shows the distribution of the motif occurrence <italic>P</italic>-values computed from their scores. The curve below shows the log<sub>10</sub>TP/FP values over the recall for this definition of true and false positives.</p>
      <p>In the <italic>motif-centered analysis</italic> (Figure <xref ref-type="fig" rid="F2">2C</xref>, right), we consider only those sequences as true positives that actually contain a motif instance. In order to estimate the number of TPs for a given score cut-off, we first estimate the fraction of input sequences that contain motif instances using the fdrtool (<xref rid="B16" ref-type="bibr">16</xref>). This tool assumes that the negative sequences in the positive set are uniformly distributed over all <italic>P</italic>-values between 0 and 1 and fits a horizontal line giving the fraction of negatives in the input set to the distribution (orange broken line in Figure <xref ref-type="fig" rid="F2">2C</xref>, top right). The definition of TPs and FPs illustrated in the top right graph of Figure <xref ref-type="fig" rid="F2">2C</xref> results in the motif-based AvRec analysis plot below.</p>
      <p>When the fraction of motifs in the input sequences is near 100%, both approaches yield very similar results. But when this fraction is small, the motif model may still be very accurate. The motif-centered analysis takes account of that, while the dataset-centered analysis severely underestimates the model performance in these cases.</p>
    </sec>
  </sec>
  <sec id="SEC4">
    <title>DOCUMENTATION, USABILITY AND SPEED</title>
    <p>Each input parameter is briefly explained in a mouse-over text. A detailed documentation is accessible via the ‘Documentation’ tab on the top of each page. A motif discovery run with 10k (100k) sequences of length 200nt takes around 3.0 (12.5) min. Scanning 100k sequences of length 200nt on both strands for motif matches takes about 6 min per three motifs. A motif-motif search through the largest subcollection of motifs in our database (620 models) takes around 3.5 min per three motifs.</p>
  </sec>
  <sec id="SEC5">
    <title>IMPLEMENTATION</title>
    <p>The BaMM web server is built on the Django Web framework using Nginx as reverse proxy. Jobs are scheduled via Celery’s asynchronous task queuing system, with the help of Redis as a message broker, and executed on a Linux computer with 28 physical cores using 4 cores per job. MySQL is used as back end database to store results and job parameters. The web front end, back end and the database run in separate Docker containers, enabling easy deployment (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>).</p>
  </sec>
  <sec sec-type="conclusions" id="SEC6">
    <title>CONCLUSION</title>
    <p>We hope the BaMM web server will enable many users to exploit the greater descriptive power of BaMMs for motif discovery and regulatory sequence analysis. In the future we will work on extending the database of motifs, especially by training on HT-SELEX datasets.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="gky431_supplemental_figures.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank our beta users for testing and feedback and Fëdor Kolpakov of BioUML (<ext-link ext-link-type="uri" xlink:href="http://gtrd.biouml.org">http://gtrd.biouml.org</ext-link>) for support with their GTRD database.</p>
  </ack>
  <sec id="SEC7">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gky431#supplementary-data">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC8">
    <title>FUNDING</title>
    <p>German Federal Ministry of Education and Research (BMBF) within the frameworks of e:Bio [SysCore, project 0316176A]; SPP 1935 (project CR 227/6-1) of the German Research Foundation (DFG); International Max Planck Research School for Genome Science (IMPRS-GS). Funding for open access charge: Institutional.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lambert</surname><given-names>S.A.</given-names></name>, <name name-style="western"><surname>Jolma</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Campitelli</surname><given-names>L.F.</given-names></name>, <name name-style="western"><surname>Das</surname><given-names>P.K.</given-names></name>, <name name-style="western"><surname>Yin</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Albu</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Taipale</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Hughes</surname><given-names>T.R.</given-names></name>, <name name-style="western"><surname>Weirauch</surname><given-names>M.T.</given-names></name></person-group><article-title>The human transcription factors</article-title>. <source>Cell</source>. <year>2018</year>; <volume>172</volume>:<fpage>650</fpage>–<lpage>665</lpage>.<pub-id pub-id-type="pmid">29425488</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bulyk</surname><given-names>M.L.</given-names></name>, <name name-style="western"><surname>Johnson</surname><given-names>P.L.</given-names></name>, <name name-style="western"><surname>Church</surname><given-names>G.M.</given-names></name></person-group><article-title>Nucleotides of transcription factor binding sites exert interdependent effects on the binding affinities of transcription factors</article-title>. <source>Nucleic Acids Res.</source><year>2002</year>; <volume>30</volume>:<fpage>1255</fpage>–<lpage>1261</lpage>.<pub-id pub-id-type="pmid">11861919</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Jolma</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Taipale</surname><given-names>J.</given-names></name></person-group><article-title>Methods for analysis of transcription factor DNA-binding specificity in vitro</article-title>. <source>A Handbook of Transcription Factors</source>. <year>2011</year>; <publisher-name>Springer</publisher-name><fpage>155</fpage>–<lpage>173</lpage>.</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rohs</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>West</surname><given-names>S.M.</given-names></name>, <name name-style="western"><surname>Sosinsky</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Mann</surname><given-names>R.S.</given-names></name>, <name name-style="western"><surname>Honig</surname><given-names>B.</given-names></name></person-group><article-title>The role of DNA shape in protein–DNA recognition</article-title>. <source>Nature</source>. <year>2009</year>; <volume>461</volume>:<fpage>1248</fpage>.<pub-id pub-id-type="pmid">19865164</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Badis</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Berger</surname><given-names>M.F.</given-names></name>, <name name-style="western"><surname>Philippakis</surname><given-names>A.A.</given-names></name>, <name name-style="western"><surname>Talukder</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Gehrke</surname><given-names>A.R.</given-names></name>, <name name-style="western"><surname>Jaeger</surname><given-names>S.A.</given-names></name>, <name name-style="western"><surname>Chan</surname><given-names>E.T.</given-names></name>, <name name-style="western"><surname>Metzler</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Vedenko</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>X.</given-names></name><etal/></person-group><article-title>Diversity and complexity in DNA recognition by transcription factors</article-title>. <source>Science</source>. <year>2009</year>; <volume>324</volume>:<fpage>1720</fpage>–<lpage>1723</lpage>.<pub-id pub-id-type="pmid">19443739</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jolma</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Yin</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Nitta</surname><given-names>K.R.</given-names></name>, <name name-style="western"><surname>Dave</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Popov</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Taipale</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Enge</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Kivioja</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Morgunova</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Taipale</surname><given-names>J.</given-names></name></person-group><article-title>DNA-dependent formation of transcription factor pairs alters their binding specificity</article-title>. <source>Nature</source>. <year>2015</year>; <volume>527</volume>:<fpage>384</fpage>.<pub-id pub-id-type="pmid">26550823</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Khan</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Fornes</surname><given-names>O.</given-names></name>, <name name-style="western"><surname>Stigliani</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Gheorghe</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Castro-Mondragon</surname><given-names>J.A.</given-names></name>, <name name-style="western"><surname>van der Lee</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Bessy</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Chèneby</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Kulkarni</surname><given-names>S.R.</given-names></name>, <name name-style="western"><surname>Tan</surname><given-names>G.</given-names></name><etal/></person-group><article-title>JASPAR 2018: update of the open-access database of transcription factor binding profiles and its web framework</article-title>. <source>Nucleic Acids Res.</source><year>2017</year>; <volume>46</volume>:<fpage>D260</fpage>–<lpage>D266</lpage>.</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kulakovskiy</surname><given-names>I.V.</given-names></name>, <name name-style="western"><surname>Vorontsov</surname><given-names>I.E.</given-names></name>, <name name-style="western"><surname>Yevshin</surname><given-names>I.S.</given-names></name>, <name name-style="western"><surname>Sharipov</surname><given-names>R.N.</given-names></name>, <name name-style="western"><surname>Fedorova</surname><given-names>A.D.</given-names></name>, <name name-style="western"><surname>Rumynskiy</surname><given-names>E.I.</given-names></name>, <name name-style="western"><surname>Medvedeva</surname><given-names>Y.A.</given-names></name>, <name name-style="western"><surname>Magana-Mora</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Bajic</surname><given-names>V.B.</given-names></name>, <name name-style="western"><surname>Papatsenko</surname><given-names>D.A.</given-names></name><etal/></person-group><article-title>HOCOMOCO: towards a complete collection of transcription factor binding models for human and mouse via large-scale ChIP-Seq analysis</article-title>. <source>Nucleic Acids Res.</source><year>2018</year>; <volume>46</volume>:<fpage>D252</fpage>–<lpage>D259</lpage>.<pub-id pub-id-type="pmid">29140464</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Siebert</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Söding</surname><given-names>J.</given-names></name></person-group><article-title>Bayesian Markov models consistently outperform PWMs at predicting motifs in nucleotide sequences</article-title>. <source>Nucleic Acids Res.</source><year>2016</year>; <volume>44</volume>:<fpage>6055</fpage>–<lpage>6069</lpage>.<pub-id pub-id-type="pmid">27288444</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bailey</surname><given-names>T.L.</given-names></name>, <name name-style="western"><surname>Boden</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Buske</surname><given-names>F.A.</given-names></name>, <name name-style="western"><surname>Frith</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Grant</surname><given-names>C.E.</given-names></name>, <name name-style="western"><surname>Clementi</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Ren</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>W.W.</given-names></name>, <name name-style="western"><surname>Noble</surname><given-names>W.S.</given-names></name></person-group><article-title>MEME SUITE: tools for motif discovery and searching</article-title>. <source>Nucleic Acids Res.</source><year>2009</year>; <volume>37</volume>:<fpage>W202</fpage>–<lpage>W208</lpage>.<pub-id pub-id-type="pmid">19458158</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Medina-Rivera</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Defrance</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Sand</surname><given-names>O.</given-names></name>, <name name-style="western"><surname>Herrmann</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Castro-Mondragon</surname><given-names>J.A.</given-names></name>, <name name-style="western"><surname>Delerce</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Jaeger</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Blanchet</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Vincens</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Caron</surname><given-names>C.</given-names></name><etal/></person-group><article-title>RSAT 2015: regulatory sequence analysis tools</article-title>. <source>Nucleic Acids Res.</source><year>2015</year>; <volume>43</volume>:<fpage>W50</fpage>–<lpage>W56</lpage>.<pub-id pub-id-type="pmid">25904632</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mathelier</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Wasserman</surname><given-names>W.W.</given-names></name></person-group><article-title>The next generation of transcription factor binding site prediction</article-title>. <source>PLOS Comput. Biol.</source><year>2013</year>; <volume>9</volume>:<fpage>e1003214</fpage>.<pub-id pub-id-type="pmid">24039567</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kulakovskiy</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Levitsky</surname><given-names>V.</given-names></name>, <name name-style="western"><surname>Oshchepkov</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Bryzgalov</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Vorontsov</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Makeev</surname><given-names>V.</given-names></name></person-group><article-title>From binding motifs in ChIP-Seq data to improved models of transcription factor binding sites</article-title>. <source>J. Bioinf. Comput. Biol.</source><year>2013</year>; <volume>11</volume>:<fpage>1340004</fpage>.</mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bailey</surname><given-names>T.L.</given-names></name>, <name name-style="western"><surname>Elkan</surname><given-names>C.</given-names></name><etal/></person-group><article-title>Fitting a mixture model by expectation maximization to discover motifs in bipolymers</article-title>. <source>Proc. Int. Conf. Intell. Syst. Mol. Biol.</source><year>1994</year>; <volume>2</volume>:<fpage>28</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">7584402</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hartmann</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Guthöhrlein</surname><given-names>E.W.</given-names></name>, <name name-style="western"><surname>Siebert</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Luehr</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Söding</surname><given-names>J.</given-names></name></person-group><article-title><italic>P</italic>-value-based regulatory motif discovery using positional weight matrices</article-title>. <source>Genome Res.</source><year>2013</year>; <volume>23</volume>:<fpage>181</fpage>–<lpage>194</lpage>.<pub-id pub-id-type="pmid">22990209</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Strimmer</surname><given-names>K.</given-names></name></person-group><article-title>fdrtool: a versatile R package for estimating local and tail area-based false discovery rates</article-title>. <source>Bioinformatics</source>. <year>2008</year>; <volume>24</volume>:<fpage>1461</fpage>–<lpage>1462</lpage>.<pub-id pub-id-type="pmid">18441000</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yevshin</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Sharipov</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Valeev</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Kel</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Kolpakov</surname><given-names>F.</given-names></name></person-group><article-title>GTRD: a database of transcription factor binding sites identified by ChIP-seq experiments</article-title>. <source>Nucleic Acids Res.</source><year>2017</year>; <volume>45</volume>:<fpage>D61</fpage>–<lpage>D67</lpage>.<pub-id pub-id-type="pmid">27924024</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gupta</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Stamatoyannopoulos</surname><given-names>J.A.</given-names></name>, <name name-style="western"><surname>Bailey</surname><given-names>T.L.</given-names></name>, <name name-style="western"><surname>Noble</surname><given-names>W.S.</given-names></name></person-group><article-title>Quantifying similarity between motifs</article-title>. <source>Genome Biol.</source><year>2007</year>; <volume>8</volume>:<fpage>R24</fpage>.<pub-id pub-id-type="pmid">17324271</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
