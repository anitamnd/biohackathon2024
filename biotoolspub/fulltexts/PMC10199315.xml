<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10199315</article-id>
    <article-id pub-id-type="pmid">36961337</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad150</article-id>
    <article-id pub-id-type="publisher-id">btad150</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>nf-core/isoseq: simple gene and isoform annotation with PacBio Iso-Seq long-read sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5116-4150</contrib-id>
        <name>
          <surname>Guizard</surname>
          <given-names>Sébastien</given-names>
        </name>
        <aff><institution>The Roslin Institute and R(D)SVS, University of Edinburgh</institution>, Edinburgh EH25 9RG, <country country="GB">United Kingdom</country></aff>
        <xref rid="btad150-cor1" ref-type="corresp"/>
        <!--sguizard@ed.ac.uk-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Miedzinska</surname>
          <given-names>Katarzyna</given-names>
        </name>
        <aff><institution>The Roslin Institute and R(D)SVS, University of Edinburgh</institution>, Edinburgh EH25 9RG, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Smith</surname>
          <given-names>Jacqueline</given-names>
        </name>
        <aff><institution>The Roslin Institute and R(D)SVS, University of Edinburgh</institution>, Edinburgh EH25 9RG, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Smith</surname>
          <given-names>Jonathan</given-names>
        </name>
        <aff><institution>The Roslin Institute and R(D)SVS, University of Edinburgh</institution>, Edinburgh EH25 9RG, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kuo</surname>
          <given-names>Richard I</given-names>
        </name>
        <aff><institution>Wobble Genomics, University of Edinburgh</institution>, Edinburgh EH25 9RG, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Davey</surname>
          <given-names>Megan</given-names>
        </name>
        <aff><institution>The Roslin Institute and R(D)SVS, University of Edinburgh</institution>, Edinburgh EH25 9RG, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Archibald</surname>
          <given-names>Alan</given-names>
        </name>
        <aff><institution>The Roslin Institute and R(D)SVS, University of Edinburgh</institution>, Edinburgh EH25 9RG, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4211-0358</contrib-id>
        <name>
          <surname>Watson</surname>
          <given-names>Mick</given-names>
        </name>
        <aff><institution>The Roslin Institute and R(D)SVS, University of Edinburgh</institution>, Edinburgh EH25 9RG, <country country="GB">United Kingdom</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad150-cor1">Corresponding author. The Roslin Institute and R(D)SVS, University of Edinburgh, Edinburgh EH25 9RG, United Kingdom E-mail: <email>sguizard@ed.ac.uk</email> (S.G.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-03-24">
      <day>24</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>5</issue>
    <elocation-id>btad150</elocation-id>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>19</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad150.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Iso-Seq RNA long-read sequencing enables the identification of full-length transcripts and isoforms, removing the need for complex analysis such as transcriptome assembly. However, the raw sequencing data need to be processed in a series of steps before annotation is complete. Here, we present nf-core/isoseq, a pipeline for automatic read processing and genome annotation. Following nf-core guidelines, the pipeline has few dependencies and can be run on any of platforms.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The pipeline is freely available online on the nf-core website (<ext-link xlink:href="https://nf-co.re/isoseq" ext-link-type="uri">https://nf-co.re/isoseq</ext-link>) and on GitHub (<ext-link xlink:href="https://github.com/nf-core/isoseq" ext-link-type="uri">https://github.com/nf-core/isoseq</ext-link>) under MIT License (DOI: 10.5281/zenodo.7116979).</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s Horizon 2020 Research and Innovation Programme</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Genome annotation is the process of identifying transcribed and functional regions of the genome. Since the invention of high-throughput sequencing, gene, and transcript discovery has predominantly relied on the sequencing and mapping of expressed transcripts. Short-read sequencing can produce a very high number of sequences for a reasonable cost. However, as the reads are shorter than most transcripts, transcript annotation must be predicted using either <italic toggle="yes">de novo</italic> or reference-guided assembly. This step requires a lot of computation and is prone to create errors. Pacific Bioscience’s (PacBio) Iso-Seq is a long-read technology dedicated to RNA sequencing which can produce accurate full-length sequences of RNA molecules. RNA is transformed into circular double-stranded DNA, by reverse transcription, template switching, and addition of SMRTbell adapters. The molecule is sequenced continuously to produce a long sequence containing one or more copies of the original mRNA (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). As the copies are error prone, a multiple alignment of these copies is used to create an accurate consensus sequence of the full-length transcript. This method does not require any assembly steps, saving computation, avoiding assembly errors, and allows the direct detection of exon/intron boundaries and full-length transcript isoforms.</p>
    <p>Numerous studies have used Iso-Seq to annotate animal (<xref rid="btad150-B5" ref-type="bibr">Kuo <italic toggle="yes">et al.</italic> 2017</xref>), and plant (<xref rid="btad150-B2" ref-type="bibr">Chao <italic toggle="yes">et al.</italic> 2019</xref>) and fish (<xref rid="btad150-B8" ref-type="bibr">Naftaly <italic toggle="yes">et al.</italic> 2021</xref>) genomes. Strategies vary, but all begin with the generation of Full Length Non Chimeric (FLNC) or High-Fidelity (Hi-Fi) reads using isoseq3 tools (<ext-link xlink:href="https://github.com/PacificBiosciences/IsoSeq" ext-link-type="uri">https://github.com/PacificBiosciences/IsoSeq</ext-link>), followed by a mapping step and alignment post-process to compute transcript and gene models. The workflow uses several programs: <monospace>ccs</monospace> to compute the circular consensus sequences (CCS), <monospace>lima</monospace> and <monospace>isoseq refine</monospace> to select and clean CCS, an aligner [<monospace>minimap2</monospace> (<xref rid="btad150-B7" ref-type="bibr">Li, 2021</xref>)], <monospace>GMAP</monospace> (<xref rid="btad150-B10" ref-type="bibr">Wu and Watanabe, 2005</xref>) and a collapsing tool such as <monospace>TAMA</monospace> (<xref rid="btad150-B6" ref-type="bibr">Kuo et al. 2020</xref>) or <monospace>cupcake</monospace> (<ext-link xlink:href="https://isoseq.how" ext-link-type="uri">https://isoseq.how</ext-link>).</p>
    <p>To date, no Iso-Seq pipeline has been published. Applying this method manually by splitting data and running each program individually would be long, laborious, and prone to errors. Moreover, using FLNCs has two important advantages: (i) it avoids information compression into HiFi reads and (ii) users can run the complete workflow in parallel. Here we present <monospace>nf-core/isoseq</monospace>, a new nf-core pipeline (<xref rid="btad150-B4" ref-type="bibr">Ewels et al. 2020</xref>) for simple and hassle-free genome annotation, based on the NextFlow software. From the raw Iso-Seq subreads, it generates FLNC reads, maps them on to a reference genome, and collapses alignments to produce a genome annotation in BED format.</p>
  </sec>
  <sec>
    <title>2 Pipeline description and implementation</title>
    <sec>
      <title>2.1 Implementation</title>
      <p>The pipeline is based on nf-core guidelines and template files. It is written using <monospace>Nextflow DSL2</monospace>. Each individual program in the pipeline is implemented as a module and is available as a container (<monospace>Singularity</monospace>, <monospace>Docker,</monospace> or <monospace>Conda</monospace>). Therefore, <monospace>nf-core/isoseq</monospace> requires very few dependencies to run: <monospace>Java</monospace> to run <monospace>Nextflow</monospace> (<xref rid="btad150-B3" ref-type="bibr">Di Tommaso et al. 2017</xref>), <monospace>Nextflow</monospace> to run the pipeline, and <monospace>Docker</monospace> or <monospace>Singularity</monospace> to run modules. The pipeline is composed of three parts (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>) (i) Iso-Seq subread preprocessing; (ii) FLNC mapping; and (iii) Alignment post-processing. The input data are provided through a three-column text file listing all samples to be analysed. The columns are a unique identifier, the location of subreads in bam format, and their associated PacBio index.</p>
    </sec>
    <sec>
      <title>2.2 Subread preprocessing</title>
      <p>Iso-Seq subreads are long nucleotide sequences created from single-pass sequencing of the original mRNA molecule (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>), available as a BAM file. As single-pass reads, they contain errors shaped by the error rate of the PacBio machine and chemistry from which they were generated. Each BAM file is processed with PacBio’s <monospace>ccs</monospace> program. <monospace>ccs</monospace> combines multiple subreads of the same molecule to produce one highly accurate consensus sequence. It can be run in parallel as it allows for splitting sequences into batches. These batches of data help to reduce execution time and are conserved until the last program (<monospace>TAMA merge</monospace>) of the pipeline. The generated consensus reads (“CCS reads”) still include primer sequences and polyA tails. The <monospace>lima</monospace> program is used to select CCS with matching primer pairs, and <monospace>isoseq3 refine</monospace> is used to detect and discard chimeric sequences. A final cleaning step is done by removing the remaining polyA tails using <monospace>TAMA polyAcleanup</monospace> helper script (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>) after a conversion of the sequences from BAM to FASTA format with bamtools (<xref rid="btad150-B1" ref-type="bibr">Barnett et al. 2011</xref>).</p>
    </sec>
    <sec>
      <title>2.3 Mapping</title>
      <p><monospace>nf-core/isoseq</monospace> allows the user to choose between two different aligners. <monospace>uLTRA</monospace> (<xref rid="btad150-B9" ref-type="bibr">Sahlin and Mäkinen, 2021</xref>) is a long-read aligner that outperforms other splice-aware aligners at small exon detection (&lt;30 nucleotides). It uses the reference exon annotation to improve small exon detection and it uses <monospace>minimap2</monospace> to discover unannotated genes. If no reference annotation is available for the genome, the user can map reads using <monospace>minimap2</monospace>.</p>
    </sec>
    <sec>
      <title>2.4 Alignment post-processing</title>
      <p>To obtain isoform annotation, each BAM file must be processed to collapse alignments (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). Because the data have been split at the CCS stage, collapsed annotation files must be merged by sample to create the final annotation. <monospace>TAMA</monospace> provides the tools for this purpose: <monospace>TAMA collapse</monospace> and <monospace>TAMA merge</monospace>. The former is used to collapse similar alignments into transcript models. The latter merges multiple annotations in one common annotation. These processes can be tuned using options to adjust identity percentage, coverage, or wobbles at 5′ end, 3′ end, and exon extremities. Resulting annotation remains unfiltered. It is up to the user to decide whether to filter the annotation, for example, based on read counts or to remove putative fused transcripts or cDNA sequences potentially primed from internal polyA sequences.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>Iso-Seq technology can be used to detect full-length transcript isoforms. The <monospace>nf-core/isoseq</monospace> offers a simple solution for Iso-Seq data analysis with the execution of a series of software tools to maximize accurate extraction of information from Iso-Seq data. The produced annotation remains unfiltered, which means that no information is hidden, and users have the freedom to apply their preferred filters to improve the accuracy of the inferred transcriptome and tailor it to their study’s goals. Available online (<ext-link xlink:href="https://nf-co.re/isoseq" ext-link-type="uri">https://nf-co.re/isoseq</ext-link>), the pipeline can be tested with nf-core test dataset.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad150_Supplementary_Data</label>
      <media xlink:href="btad150_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the nf-core community for their support during the development of the pipeline and their reviewers, Jose Espinosa-Carrasco, Daniel Schreyer, Gisela Gabernet for the comments and the help they provided. For the purpose of open access, the author has applied a creative commons attribution (CC BY) licence to any author-accepted manuscript version arising.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> is available at <italic toggle="yes">Bioinformatics</italic> online.</p>
    <p>Conflict of interest: None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This pipeline has been developed as part of the GENE-SWitCH project. This project has received funding from the European Union’s Horizon 2020 Research and Innovation Programme grant agreement no. [817998]. This research was funded in whole, or in part, by Research Councils UK’s Biotechnology and Biological Sciences Research Council [BBS/E/D/10002070].</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad150-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barnett</surname><given-names>DW</given-names></string-name>, <string-name><surname>Garrison</surname><given-names>EK</given-names></string-name>, <string-name><surname>Quinlan</surname><given-names>AR</given-names></string-name></person-group><etal>et al</etal><article-title>BamTools: a C++ API and toolkit for analyzing and managing BAM files</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>1691</fpage>–<lpage>2</lpage>.<pub-id pub-id-type="pmid">21493652</pub-id></mixed-citation>
    </ref>
    <ref id="btad150-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chao</surname><given-names>Q</given-names></string-name>, <string-name><surname>Gao</surname><given-names>Z-F</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>The developmental dynamics of the populus stem transcriptome</article-title>. <source>Plant Biotechnol J</source><year>2019</year>;<volume>17</volume>:<fpage>206</fpage>–<lpage>19</lpage>.<pub-id pub-id-type="pmid">29851301</pub-id></mixed-citation>
    </ref>
    <ref id="btad150-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Di Tommaso</surname><given-names>P</given-names></string-name>, <string-name><surname>Chatzou</surname><given-names>M</given-names></string-name>, <string-name><surname>Floden</surname><given-names>EW</given-names></string-name></person-group><etal>et al</etal><article-title>Nextflow enables reproducible computational workflows</article-title>. <source>Nat Biotechnol</source><year>2017</year>;<volume>35</volume>:<fpage>316</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28398311</pub-id></mixed-citation>
    </ref>
    <ref id="btad150-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ewels</surname><given-names>PA</given-names></string-name>, <string-name><surname>Peltzer</surname><given-names>A</given-names></string-name>, <string-name><surname>Fillinger</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>The nf-core framework for community-curated bioinformatics pipelines</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>:<fpage>276</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">32055031</pub-id></mixed-citation>
    </ref>
    <ref id="btad150-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuo</surname><given-names>RI</given-names></string-name>, <string-name><surname>Tseng</surname><given-names>E</given-names></string-name>, <string-name><surname>Eory</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Normalized long read RNA sequencing in chicken reveals transcriptome complexity similar to human</article-title>. <source>BMC Genomics</source><year>2017</year>;<volume>18</volume>:<fpage>323</fpage>.<pub-id pub-id-type="pmid">28438136</pub-id></mixed-citation>
    </ref>
    <ref id="btad150-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuo</surname><given-names>RI</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Illuminating the dark side of the human transcriptome with long read transcript sequencing</article-title>. <source>BMC Genomics</source><year>2020</year>;<volume>21</volume>:<fpage>751</fpage>.<pub-id pub-id-type="pmid">33126848</pub-id></mixed-citation>
    </ref>
    <ref id="btad150-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group><article-title>New strategies to improve minimap2 alignment accuracy</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>4572</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">34623391</pub-id></mixed-citation>
    </ref>
    <ref id="btad150-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Naftaly</surname><given-names>AS</given-names></string-name>, <string-name><surname>Pau</surname><given-names>S</given-names></string-name>, <string-name><surname>White</surname><given-names>MA.</given-names></string-name></person-group><article-title>Long-read RNA sequencing reveals widespread sex-specific alternative splicing in threespine stickleback fish</article-title>. <source>Genome Res</source><year>2021</year>;<volume>31</volume>:<fpage>1486</fpage>–<lpage>97</lpage>.<pub-id pub-id-type="pmid">34131005</pub-id></mixed-citation>
    </ref>
    <ref id="btad150-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sahlin</surname><given-names>K</given-names></string-name>, <string-name><surname>Mäkinen</surname><given-names>V.</given-names></string-name></person-group><article-title>Accurate spliced alignment of long RNA sequencing reads</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>4643</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">34302453</pub-id></mixed-citation>
    </ref>
    <ref id="btad150-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>TD</given-names></string-name>, <string-name><surname>Watanabe</surname><given-names>CK.</given-names></string-name></person-group><article-title>GMAP: a genomic mapping and alignment program for mRNA and EST sequences</article-title>. <source>Bioinformatics</source><year>2005</year>;<volume>21</volume>:<fpage>1859</fpage>–<lpage>75</lpage>.<pub-id pub-id-type="pmid">15728110</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
