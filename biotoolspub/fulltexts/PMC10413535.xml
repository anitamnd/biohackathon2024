<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10413535</article-id>
    <article-id pub-id-type="pmid">37559015</article-id>
    <article-id pub-id-type="publisher-id">5438</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05438-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>ggcoverage</italic>: an R package to visualize and annotate genome coverage for various NGS data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Song</surname>
          <given-names>Yabing</given-names>
        </name>
        <address>
          <email>songyb18@mails.tsinghua.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Jianbin</given-names>
        </name>
        <address>
          <email>jianbinwang@tsinghua.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/03cve4549</institution-id><institution-id institution-id-type="GRID">grid.12527.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 0662 3178</institution-id><institution>School of Life Sciences, </institution><institution>Tsinghua University, </institution></institution-wrap>Beijing, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>309</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Visualizing genome coverage is of vital importance to inspect and interpret various next-generation sequencing (NGS) data. Besides genome coverage, genome annotations are also crucial in the visualization. While different NGS data require different annotations, how to visualize genome coverage and add the annotations appropriately and conveniently is challenging. Many tools have been developed to address this issue. However, existing tools are often inflexible, complicated, lack necessary preprocessing steps and annotations, and the figures generated support limited customization.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we introduce <italic>ggcoverage</italic>, an R package to visualize and annotate genome coverage of multi-groups and multi-omics. The input files for <italic>ggcoverage</italic> can be in BAM, BigWig, BedGraph and TSV formats. For better usability, <italic>ggcoverage</italic> provides reliable and efficient ways to perform read normalization, consensus peaks generation and track data loading with state-of-the-art tools. <italic>ggcoverage</italic> provides various available annotations to adapt to different NGS data (e.g. WGS/WES, RNA-seq, ChIP-seq) and all the available annotations can be easily superimposed with ‘ + ’. <italic>ggcoverage</italic> can generate publication-quality plots and users can customize the plots with <italic>ggplot2</italic>. In addition, <italic>ggcoverage</italic> supports the visualization and annotation of protein coverage.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3"><italic>ggcoverage</italic> provides a flexible, programmable, efficient and user-friendly way to visualize and annotate genome coverage of multi-groups and multi-omics. The <italic>ggcoverage</italic> package is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/showteeth/ggcoverage">https://github.com/showteeth/ggcoverage</ext-link> under the MIT license, and the vignettes are available at <ext-link ext-link-type="uri" xlink:href="https://showteeth.github.io/ggcoverage/">https://showteeth.github.io/ggcoverage/</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05438-2.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Genome coverage</kwd>
      <kwd>Genome annotation</kwd>
      <kwd>Visualization</kwd>
      <kwd>Next-generation sequencing</kwd>
      <kwd>Multi-omics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>22050004</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wang</surname>
            <given-names>Jianbin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par11">Visualizing genome coverage is of vital importance to inspect and interpret various next-generation sequencing (NGS) data. Besides genome coverage, genome annotations are also crucial in the visualization. When analyzing whole-genome sequencing (WGS) data to get copy number variations (CNV), genome coverage plot can check for possible confounding factors, such as GC content bias, telomeres and centromeres proximity [<xref ref-type="bibr" rid="CR1">1</xref>]. When dealing with RNA-sequencing (RNA-seq) data, we can utilize genome coverage plot to inspect the gene or exon knockout efficiency, 5’ or 3’ bias and visualize the read counts of differentially expressed genes, transcripts or exons [<xref ref-type="bibr" rid="CR2">2</xref>]. In processing chromatin immunoprecipitation followed by sequencing (ChIP-seq) data, genome coverage plot can help to obtain and verify the peaks by comparing the signal of ChIP and input samples and visualize the relative distance between identified peaks and nearby genes [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par12">Many tools have been developed to visualize genome coverage. However, existing tools are often inflexible, complicated, lack necessary preprocessing steps and annotations, and the figures generated support limited customization. For example, <italic>UCSC genome browser</italic> [<xref ref-type="bibr" rid="CR4">4</xref>] and <italic>IGV Browser</italic> [<xref ref-type="bibr" rid="CR5">5</xref>] require file upload or data transmission, which usually takes time, and are not accessible programmatically. <italic>Gviz</italic> [<xref ref-type="bibr" rid="CR6">6</xref>] offers limited customization of plot aesthetics and themes. <italic>ggbio </italic>[<xref ref-type="bibr" rid="CR7">7</xref>] and <italic>GenVisR</italic> [<xref ref-type="bibr" rid="CR8">8</xref>] provide limited annotations. <italic>karyoploteR</italic> [<xref ref-type="bibr" rid="CR9">9</xref>] focuses on visualizing chromosome ideogram and is complicated to create genome coverage plot. See Table <xref rid="Tab1" ref-type="table">1</xref> for a detailed comparison of <italic>ggcoverage</italic> to other visualization tools.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of <italic>ggcoverage</italic> to other visualization tools</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"><italic>ggcoverage</italic></th><th align="left"><italic>ggbio</italic></th><th align="left"><italic>Gviz</italic></th><th align="left"><italic>GenVisR</italic></th><th align="left"><italic>karyoploteR</italic></th><th align="left"><italic>UCSC</italic></th><th align="left"><italic>IGV</italic></th></tr><tr><th align="left">Platform</th><th align="left">R</th><th align="left">R</th><th align="left">R</th><th align="left">R</th><th align="left">R</th><th align="left">Web</th><th align="left">Application</th></tr></thead><tbody><tr><td align="left">Data transmission</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left" colspan="8"><italic>Input file formats</italic></td></tr><tr><td align="left"> BAM</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> BigWig</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> BedGraph</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> TSV/Excel</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left"/></tr><tr><td align="left">Sample group</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left" colspan="8"><italic>Preprocessing</italic></td></tr><tr><td align="left"> Normalize reads</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"> Consensus peak</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"><p> Track loading</p><p>(region subset)</p></td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left"/><td align="left"/></tr><tr><td align="left">Protein coverage</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left" colspan="8"><italic>Annotations</italic></td></tr><tr><td align="left"> GC content</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">*</td></tr><tr><td align="left"> Base</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> Base frequency</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left"/><td align="left">✓</td></tr><tr><td align="left"> Amino acid</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> CNV</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"> Gene</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> Transcript</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> Peak</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> Ideogram</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> Contact map</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"> Link</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left"/><td align="left"/></tr><tr><td align="left"> Feature</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">Superimpose annotations (‘+’)</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">Customize figure (<italic>ggplot2</italic>)</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr></tbody></table><table-wrap-foot><p>*IGV can load GC content from server, but has limited supported species</p></table-wrap-foot></table-wrap></p>
    <p id="Par13">Here, we present <italic>ggcoverage</italic>, an R package providing a flexible, programmable, efficient and user-friendly way to visualize genome coverage of multi-groups and multi-omics. It supports multiple input file formats and provides several functions to perform data preprocessing, including parallel read normalization, consensus peak generation and track data loading. It also provides various available annotations, which can be superimposed conveniently to better inspect and interpret different NGS data. Furthermore, <italic>ggcoverage</italic> can generate publication-ready plots and users can customize the plots with <italic>ggplot2</italic> [<xref ref-type="bibr" rid="CR10">10</xref>]. In addition, <italic>ggcoverage</italic> supports the visualization of protein coverage based on peptides obtained by mass spectrometry and adds protein feature annotation to the coverage plot.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Inputs</title>
      <p id="Par14">The input file for <italic>ggcoverage</italic> to visualize genome coverage can be in BAM, BigWig, BedGraph and TSV formats. For TSV file, it should contain columns to specify chromosome, start, end, sample type and sample group. <italic>ggcoverage</italic> also requires additional files to generate annotation, such as FASTA file for GC content annotation, gene transfer format (GTF) file for gene and transcript annotations, and peak file for peak annotation. For the visualization of protein coverage, the input file should be Excel spreadsheets exported from an analyzer such as <italic>Proteome Discoverer</italic>.</p>
    </sec>
    <sec id="Sec4">
      <title>Data preprocessing</title>
      <p id="Par15">Read normalization, consensus peak generation and track data loading are usually prerequisites for visualization. However, this requires users to learn to use different tools and possibly switch between different platforms. To facilitate users, <italic>ggcoverage</italic> provides functions to perform data preprocessing with state-of-the-art tools. For read normalization, <italic>ggcoverage</italic> provides multiple normalization methods to adapt to different NGS data using <italic>deeptools</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] and parallelize this process with <italic>BiocParallel</italic> [<xref ref-type="bibr" rid="CR12">12</xref>]. When providing peak files from replicates, <italic>ggcoverage</italic> can generate consensus peaks with <italic>MSPC</italic>, which can run with more than two replicates and combine evidence (e.g. P-value) from multiple replicates to obtain more reliable peaks [<xref ref-type="bibr" rid="CR13">13</xref>]. To load track data, <italic>ggcoverage</italic> extracts the visualized region specified by users instead of loading the whole files and then extracting the visualized region.</p>
    </sec>
    <sec id="Sec5">
      <title>Visualization</title>
      <p id="Par16"><italic>ggcoverage</italic> introduces twelve layers to visualize and annotate coverage plot (Table <xref rid="Tab2" ref-type="table">2</xref>). Besides these layers, <italic>ggcoverage</italic> also provides corresponding themes to beautify figures. geom_coverage will generate coverage plot of a specified region for different samples across different groups and provide ‘joint’ and ‘facet’ display styles (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). When mark regions are available, geom_coverage will also highlight these regions. geom_base is used to show base frequency and reference base for each locus, and it will also show amino acids of given region in <italic>IGV</italic> style. When SNVs exist, geom_base will highlight them with three styles (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). geom_cnv will show the normalized bin count and estimated copy number. geom_gc will calculate and visualize GC content of every bin, and it will also add a line to indicate mean GC content or user-specified GC content. geom_gene will obtain all genes in given region and classify these genes to different groups to avoid overlap when plotting. In gene annotation, the arrow direction indicates the strand of genes, the height of different elements indicates different gene parts, the color of line indicates gene strand or user-specified group information (e.g. gene type). geom_transcript is similar to geom_gene, but it shows all transcripts of a gene rather than the whole gene structure. geom_peak will show the peaks identified, so that the peaks and the nearby genes can be well visualized. geom_ideogram will show chromosome ideogram to illustrate the relative position of the displayed regions on the chromosome based on <italic>ggbio</italic> [<xref ref-type="bibr" rid="CR7">7</xref>]. geom_tad will show 3D chromatin contact maps based on <italic>HiCBricks</italic> [<xref ref-type="bibr" rid="CR14">14</xref>]. geom_link will create links of peak-gene or DNA-DNA. geom_protein will generate coverage plot of protein based on peptides obtained by mass spectrometry (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). geom_feature will show characteristics of protein or genome (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3).<table-wrap id="Tab2"><label>Table 2</label><caption><p><italic>ggcoverage</italic> layers</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Layer</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">geom_coverage</td><td align="left">Coverage</td><td align="left">Create genome coverage plot</td></tr><tr><td align="left">geom_base</td><td align="left">Annotation</td><td align="left">Add base, base frequency and amino acid annotations</td></tr><tr><td align="left">geom_cnv</td><td align="left">Annotation</td><td align="left">Add CNV annotation</td></tr><tr><td align="left">geom_gc</td><td align="left">Annotation</td><td align="left">Add GC content annotation</td></tr><tr><td align="left">geom_gene</td><td align="left">Annotation</td><td align="left">Add gene annotation</td></tr><tr><td align="left">geom_transcript</td><td align="left">Annotation</td><td align="left">Add gene’s transcripts annotation</td></tr><tr><td align="left">geom_peak</td><td align="left">Annotation</td><td align="left">Add peak annotation</td></tr><tr><td align="left">geom_ideogram</td><td align="left">Annotation</td><td align="left">Add chromosome ideogram annotation</td></tr><tr><td align="left">geom_tad</td><td align="left">Annotation</td><td align="left">Add contact map annotation</td></tr><tr><td align="left">geom_link</td><td align="left">Annotation</td><td align="left">Add link annotation</td></tr><tr><td align="left">geom_protein</td><td align="left">Coverage</td><td align="left">Create protein coverage plot</td></tr><tr><td align="left">geom_feature</td><td align="left">Annotation</td><td align="left">Add protein/genome feature annotation</td></tr></tbody></table></table-wrap></p>
      <p id="Par100">Similar to graphical language implemented in <italic>ggplot2</italic>, users can superimpose the above layers by the ‘ + ’ operator with the help of <italic>patchwork</italic> [<xref ref-type="bibr" rid="CR15">15</xref>]. For example, ggcoverage() + geom_gc() + geom_gene() + geom_ideogram() will create genome coverage plot and add GC content, gene structure and chromosome ideogram annotations.</p>
    </sec>
    <sec id="Sec6">
      <title>Customization</title>
      <p id="Par17"><italic>ggcoverage</italic> is based on <italic>ggplot2</italic>, so users can easily customize the generated figures with <italic>ggplot2</italic>. In general, customization mainly includes modifying the elements of existing figures and adding new layers. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4 shows the examples of these two kinds of customization.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results</title>
    <p id="Par18">Here, we show several practical use cases of applying <italic>ggcoverage</italic> to multi-omics, including WGS, ChIP-seq and RNA-seq. The code used to generate the figures without typesetting for Fig. <xref rid="Fig1" ref-type="fig">1</xref> is available in Additional file <xref rid="MOESM2" ref-type="media">2</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Visualizations of <italic>ggcoverage</italic> on selected NGS datasets. <bold>A</bold>
<italic>ggcoverage</italic> on WGS data to visualize CNV. Genome coverage plot shows read counts of all bins. GC content annotation shows GC content of every bin (red line: mean GC content of the whole region). Copy number annotation shows normalized read counts of all bins in grey dot, estimated copy number in red line and ploidy in black line. Chromosome ideogram annotation shows the displayed region on the chromosome with red rectangle and highlights the centromeres with green rectangle. <bold>B</bold>
<italic>ggcoverage</italic> on WGS data to visualize SNV. Genome coverage plot shows read counts of every locus. Base annotation shows base frequency (red line: 0.5) and reference base of every locus. Candidate SNV is highlighted with the twill mark. Amino acid annotation shows corresponding amino acids with 0, 1, 2 offsets. <bold>C</bold>
<italic>ggcoverage</italic> on ChIP-seq data. Different from (<bold>A</bold>), genome coverage plot discriminates sample groups (the first track in red is the ChIP sample and the last track in grey is the control sample), the light grey rectangle indicates the highlight region. Gene annotation shows genes in given region (rightwards arrow with dark green: gene on plus strand, leftwards arrow with dark blue: gene on minus strand; element height: gene part (exon &gt; UTR &gt; intron)). Peak annotation shows all peaks identified. <bold>D</bold>
<italic>ggcoverage</italic> on RNA-seq data with <italic>HNRNPC</italic> knockdown. Different from (<bold>A</bold>), we use transcript annotation instead of gene annotation to visualize gene’s all transcripts</p></caption><graphic xlink:href="12859_2023_5438_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par19">In CNV analysis, common confounding factors include GC content bias, telomeres and centromeres proximity. Figure <xref rid="Fig1" ref-type="fig">1</xref>A shows genome coverage with all these confounding factors to inspect the data. When applying <italic>ggcoverage</italic> on WGS data to visualize SNV (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B), we can see that there is a candidate single nucleotide variant (SNV) with T to A transversion at coordinate hg19 chr4:62,474,264 (highlight with twill), the variant allele frequency is 100%, and this may affect Y (Tyrosine), I (Isoleucine) and * (stop codon). When applying <italic>ggcoverage</italic> on ChIP-seq data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C), we can see that the ChIP sample has an enriched signal in the promoter region of the <italic>ATP9B</italic> gene compared to the input control, which is consistent with the results of called peaks. When applying <italic>ggcoverage</italic> on RNA-seq data with <italic>HNRNPC</italic> knockdown (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D), we can see that there is a significant reduction in read coverage of <italic>HNRNPC</italic>.</p>
  </sec>
  <sec id="Sec8">
    <title>Conclusions</title>
    <p id="Par20">We have developed <italic>ggcoverage</italic>, an R package dedicated to visualizing and annotating genome coverage of multi-groups and multi-omics. It allows users to visualize genome coverage with flexible input file formats, and annotate the genome coverage with various annotations to meet the needs of different NGS data. In addition to visualization, <italic>ggcoverage</italic> also provides reliable and efficient ways to perform data preprocessing, including parallel reads normalization per bin, consensus peaks generation from replicates and track data loading by extracting subsets. And owing to the multi-platform support of R, users do not need to transmit data. Finally, it is very convenient to generate high-quality and publication-ready plots, users can also customize the figures with <italic>ggplot2</italic>.</p>
  </sec>
  <sec id="Sec9">
    <title>Availability and requirements</title>
    <p id="Par21">
      <list list-type="bullet">
        <list-item>
          <p id="Par22">Project name: <italic>ggcoverage</italic></p>
        </list-item>
        <list-item>
          <p id="Par23">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/showteeth/ggcoverage">https://github.com/showteeth/ggcoverage</ext-link></p>
        </list-item>
        <list-item>
          <p id="Par24">Operating system(s): Unix, Linux, and Windows</p>
        </list-item>
        <list-item>
          <p id="Par25">Programming language: R</p>
        </list-item>
        <list-item>
          <p id="Par26">Other requirements: None</p>
        </list-item>
        <list-item>
          <p id="Par27">License: MIT License</p>
        </list-item>
        <list-item>
          <p id="Par28">Any restrictions to use by non-academics: None</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec10">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5438_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1. Additional figures. Fig. S1.</bold> Three styles of genome coverage plot. <bold>Fig. S2.</bold> Highlight SNV with three styles. <bold>Fig. S3.</bold> Protein coverage plot based on peptides obtained by mass spectrometry and annotation of protein characteristics. <bold>Fig. S4.</bold> Examples of figure customization.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5438_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> The codes used to generate the figures without typesetting for Fig. <xref rid="Fig1" ref-type="fig">1</xref>.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>NGS</term>
        <def>
          <p id="Par4">Next-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par5">Whole-genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>CNV</term>
        <def>
          <p id="Par6">Copy number variations</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA-seq</term>
        <def>
          <p id="Par7">RNA-sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>ChIP-seq</term>
        <def>
          <p id="Par8">Chromatin immunoprecipitation followed by sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>GTF</term>
        <def>
          <p id="Par9">Gene transfer format</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p id="Par10">Single nucleotide variant</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We appreciate the valuable feedback provided by Jiaxin Gao.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>YS developed <italic>ggcoverage</italic> and prepared the manuscript. JW provided supervision and secured funding. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the National Natural Science Foundation of China (Grant No. 22050004).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets analyzed during the current study are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/showteeth/ggcoverage">https://github.com/showteeth/ggcoverage</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par29">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par30">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par31">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>D-Q</given-names>
          </name>
          <name>
            <surname>Webber</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ponting</surname>
            <given-names>CP</given-names>
          </name>
        </person-group>
        <article-title>Bias of selection on human copy-number variants</article-title>
        <source>PLoS Genet</source>
        <year>2006</year>
        <volume>2</volume>
        <issue>2</issue>
        <fpage>e20</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.0020020</pub-id>
        <?supplied-pmid 16482228?>
        <pub-id pub-id-type="pmid">16482228</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conesa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Madrigal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tarazona</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gomez-Cabrero</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cervera</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A survey of best practices for RNA-seq data analysis</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>13</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0881-8</pub-id>
        <?supplied-pmid 26813401?>
        <pub-id pub-id-type="pmid">26813401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>ChIP–seq: advantages and challenges of a maturing technology</article-title>
        <source>Nat Rev Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>10</issue>
        <fpage>669</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2641</pub-id>
        <?supplied-pmid 19736561?>
        <pub-id pub-id-type="pmid">19736561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Furey</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Roskin</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Pringle</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Zahler</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.229102</pub-id>
        <?supplied-pmid 12045153?>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Thorvaldsdóttir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Winckler</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative genomics viewer</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>24</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id>
        <?supplied-pmid 21221095?>
        <pub-id pub-id-type="pmid">21221095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Hahne F, Ivanek R. Visualizing genomic data using Gviz and bioconductor. In: Methods in molecular biology<italic>.</italic> 2016. pp. 335–51.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title><italic>ggbio</italic>: an R package for extending the grammar of graphics for genomic data</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>8</issue>
        <fpage>R77</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-8-r77</pub-id>
        <?supplied-pmid 22937822?>
        <pub-id pub-id-type="pmid">22937822</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skidmore</surname>
            <given-names>ZL</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Lesurf</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Kunisaki</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Griffith</surname>
            <given-names>OL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GenVisR: genomic visualizations in R</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>19</issue>
        <fpage>3012</fpage>
        <lpage>3014</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw325</pub-id>
        <?supplied-pmid 27288499?>
        <pub-id pub-id-type="pmid">27288499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gel</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Serra</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>karyoploteR: an R/Bioconductor package to plot customizable genomes displaying arbitrary data</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>19</issue>
        <fpage>3088</fpage>
        <lpage>3090</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx346</pub-id>
        <?supplied-pmid 28575171?>
        <pub-id pub-id-type="pmid">28575171</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source><italic>ggplot2</italic>: elegant graphics for data analysis</source>
        <year>2016</year>
        <publisher-loc>Springer</publisher-loc>
        <publisher-name>Verlag New York</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramírez</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ryan</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Grüning</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bhardwaj</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kilpert</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Richter</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>deepTools2: a next generation web server for deep-sequencing data analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>W1</issue>
        <fpage>W160</fpage>
        <lpage>W165</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw257</pub-id>
        <?supplied-pmid 27079975?>
        <pub-id pub-id-type="pmid">27079975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Morgan M, Obenchain V, Lang M, Thompson R, Turaga N. BiocParallel: Bioconductor facilities for parallel evaluation. R package version 1.24.1. 2020.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jalili</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Matteucci</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Masseroli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Morelli</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Using combined evidence from replicates to evaluate ChIP-seq peaks</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>17</issue>
        <fpage>2761</fpage>
        <lpage>2769</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv293</pub-id>
        <?supplied-pmid 25957351?>
        <pub-id pub-id-type="pmid">25957351</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tagliaferri</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Livi</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Ferrari</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>HiCBricks: building blocks for efficient handling of large Hi-C datasets</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>36</volume>
        <issue>6</issue>
        <fpage>1917</fpage>
        <lpage>1919</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz808</pub-id>
        <?supplied-pmid 31697323?>
        <pub-id pub-id-type="pmid">31697323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Pedersen TL. Patchwork: The composer of plots. R package version 1.0.0. 2020.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10413535</article-id>
    <article-id pub-id-type="pmid">37559015</article-id>
    <article-id pub-id-type="publisher-id">5438</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05438-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>ggcoverage</italic>: an R package to visualize and annotate genome coverage for various NGS data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Song</surname>
          <given-names>Yabing</given-names>
        </name>
        <address>
          <email>songyb18@mails.tsinghua.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Jianbin</given-names>
        </name>
        <address>
          <email>jianbinwang@tsinghua.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/03cve4549</institution-id><institution-id institution-id-type="GRID">grid.12527.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 0662 3178</institution-id><institution>School of Life Sciences, </institution><institution>Tsinghua University, </institution></institution-wrap>Beijing, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>309</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Visualizing genome coverage is of vital importance to inspect and interpret various next-generation sequencing (NGS) data. Besides genome coverage, genome annotations are also crucial in the visualization. While different NGS data require different annotations, how to visualize genome coverage and add the annotations appropriately and conveniently is challenging. Many tools have been developed to address this issue. However, existing tools are often inflexible, complicated, lack necessary preprocessing steps and annotations, and the figures generated support limited customization.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we introduce <italic>ggcoverage</italic>, an R package to visualize and annotate genome coverage of multi-groups and multi-omics. The input files for <italic>ggcoverage</italic> can be in BAM, BigWig, BedGraph and TSV formats. For better usability, <italic>ggcoverage</italic> provides reliable and efficient ways to perform read normalization, consensus peaks generation and track data loading with state-of-the-art tools. <italic>ggcoverage</italic> provides various available annotations to adapt to different NGS data (e.g. WGS/WES, RNA-seq, ChIP-seq) and all the available annotations can be easily superimposed with ‘ + ’. <italic>ggcoverage</italic> can generate publication-quality plots and users can customize the plots with <italic>ggplot2</italic>. In addition, <italic>ggcoverage</italic> supports the visualization and annotation of protein coverage.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3"><italic>ggcoverage</italic> provides a flexible, programmable, efficient and user-friendly way to visualize and annotate genome coverage of multi-groups and multi-omics. The <italic>ggcoverage</italic> package is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/showteeth/ggcoverage">https://github.com/showteeth/ggcoverage</ext-link> under the MIT license, and the vignettes are available at <ext-link ext-link-type="uri" xlink:href="https://showteeth.github.io/ggcoverage/">https://showteeth.github.io/ggcoverage/</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05438-2.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Genome coverage</kwd>
      <kwd>Genome annotation</kwd>
      <kwd>Visualization</kwd>
      <kwd>Next-generation sequencing</kwd>
      <kwd>Multi-omics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>22050004</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wang</surname>
            <given-names>Jianbin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par11">Visualizing genome coverage is of vital importance to inspect and interpret various next-generation sequencing (NGS) data. Besides genome coverage, genome annotations are also crucial in the visualization. When analyzing whole-genome sequencing (WGS) data to get copy number variations (CNV), genome coverage plot can check for possible confounding factors, such as GC content bias, telomeres and centromeres proximity [<xref ref-type="bibr" rid="CR1">1</xref>]. When dealing with RNA-sequencing (RNA-seq) data, we can utilize genome coverage plot to inspect the gene or exon knockout efficiency, 5’ or 3’ bias and visualize the read counts of differentially expressed genes, transcripts or exons [<xref ref-type="bibr" rid="CR2">2</xref>]. In processing chromatin immunoprecipitation followed by sequencing (ChIP-seq) data, genome coverage plot can help to obtain and verify the peaks by comparing the signal of ChIP and input samples and visualize the relative distance between identified peaks and nearby genes [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par12">Many tools have been developed to visualize genome coverage. However, existing tools are often inflexible, complicated, lack necessary preprocessing steps and annotations, and the figures generated support limited customization. For example, <italic>UCSC genome browser</italic> [<xref ref-type="bibr" rid="CR4">4</xref>] and <italic>IGV Browser</italic> [<xref ref-type="bibr" rid="CR5">5</xref>] require file upload or data transmission, which usually takes time, and are not accessible programmatically. <italic>Gviz</italic> [<xref ref-type="bibr" rid="CR6">6</xref>] offers limited customization of plot aesthetics and themes. <italic>ggbio </italic>[<xref ref-type="bibr" rid="CR7">7</xref>] and <italic>GenVisR</italic> [<xref ref-type="bibr" rid="CR8">8</xref>] provide limited annotations. <italic>karyoploteR</italic> [<xref ref-type="bibr" rid="CR9">9</xref>] focuses on visualizing chromosome ideogram and is complicated to create genome coverage plot. See Table <xref rid="Tab1" ref-type="table">1</xref> for a detailed comparison of <italic>ggcoverage</italic> to other visualization tools.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of <italic>ggcoverage</italic> to other visualization tools</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"><italic>ggcoverage</italic></th><th align="left"><italic>ggbio</italic></th><th align="left"><italic>Gviz</italic></th><th align="left"><italic>GenVisR</italic></th><th align="left"><italic>karyoploteR</italic></th><th align="left"><italic>UCSC</italic></th><th align="left"><italic>IGV</italic></th></tr><tr><th align="left">Platform</th><th align="left">R</th><th align="left">R</th><th align="left">R</th><th align="left">R</th><th align="left">R</th><th align="left">Web</th><th align="left">Application</th></tr></thead><tbody><tr><td align="left">Data transmission</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left" colspan="8"><italic>Input file formats</italic></td></tr><tr><td align="left"> BAM</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> BigWig</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> BedGraph</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> TSV/Excel</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left"/></tr><tr><td align="left">Sample group</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left" colspan="8"><italic>Preprocessing</italic></td></tr><tr><td align="left"> Normalize reads</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"> Consensus peak</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"><p> Track loading</p><p>(region subset)</p></td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left"/><td align="left"/></tr><tr><td align="left">Protein coverage</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left" colspan="8"><italic>Annotations</italic></td></tr><tr><td align="left"> GC content</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">*</td></tr><tr><td align="left"> Base</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> Base frequency</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left"/><td align="left">✓</td></tr><tr><td align="left"> Amino acid</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> CNV</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"> Gene</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> Transcript</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> Peak</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left"/><td align="left"/><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> Ideogram</td><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left">✓</td><td align="left">✓</td><td align="left">✓</td></tr><tr><td align="left"> Contact map</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"> Link</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left">✓</td><td align="left"/><td align="left"/></tr><tr><td align="left"> Feature</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">Superimpose annotations (‘+’)</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">Customize figure (<italic>ggplot2</italic>)</td><td align="left">✓</td><td align="left">✓</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr></tbody></table><table-wrap-foot><p>*IGV can load GC content from server, but has limited supported species</p></table-wrap-foot></table-wrap></p>
    <p id="Par13">Here, we present <italic>ggcoverage</italic>, an R package providing a flexible, programmable, efficient and user-friendly way to visualize genome coverage of multi-groups and multi-omics. It supports multiple input file formats and provides several functions to perform data preprocessing, including parallel read normalization, consensus peak generation and track data loading. It also provides various available annotations, which can be superimposed conveniently to better inspect and interpret different NGS data. Furthermore, <italic>ggcoverage</italic> can generate publication-ready plots and users can customize the plots with <italic>ggplot2</italic> [<xref ref-type="bibr" rid="CR10">10</xref>]. In addition, <italic>ggcoverage</italic> supports the visualization of protein coverage based on peptides obtained by mass spectrometry and adds protein feature annotation to the coverage plot.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Inputs</title>
      <p id="Par14">The input file for <italic>ggcoverage</italic> to visualize genome coverage can be in BAM, BigWig, BedGraph and TSV formats. For TSV file, it should contain columns to specify chromosome, start, end, sample type and sample group. <italic>ggcoverage</italic> also requires additional files to generate annotation, such as FASTA file for GC content annotation, gene transfer format (GTF) file for gene and transcript annotations, and peak file for peak annotation. For the visualization of protein coverage, the input file should be Excel spreadsheets exported from an analyzer such as <italic>Proteome Discoverer</italic>.</p>
    </sec>
    <sec id="Sec4">
      <title>Data preprocessing</title>
      <p id="Par15">Read normalization, consensus peak generation and track data loading are usually prerequisites for visualization. However, this requires users to learn to use different tools and possibly switch between different platforms. To facilitate users, <italic>ggcoverage</italic> provides functions to perform data preprocessing with state-of-the-art tools. For read normalization, <italic>ggcoverage</italic> provides multiple normalization methods to adapt to different NGS data using <italic>deeptools</italic> [<xref ref-type="bibr" rid="CR11">11</xref>] and parallelize this process with <italic>BiocParallel</italic> [<xref ref-type="bibr" rid="CR12">12</xref>]. When providing peak files from replicates, <italic>ggcoverage</italic> can generate consensus peaks with <italic>MSPC</italic>, which can run with more than two replicates and combine evidence (e.g. P-value) from multiple replicates to obtain more reliable peaks [<xref ref-type="bibr" rid="CR13">13</xref>]. To load track data, <italic>ggcoverage</italic> extracts the visualized region specified by users instead of loading the whole files and then extracting the visualized region.</p>
    </sec>
    <sec id="Sec5">
      <title>Visualization</title>
      <p id="Par16"><italic>ggcoverage</italic> introduces twelve layers to visualize and annotate coverage plot (Table <xref rid="Tab2" ref-type="table">2</xref>). Besides these layers, <italic>ggcoverage</italic> also provides corresponding themes to beautify figures. geom_coverage will generate coverage plot of a specified region for different samples across different groups and provide ‘joint’ and ‘facet’ display styles (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). When mark regions are available, geom_coverage will also highlight these regions. geom_base is used to show base frequency and reference base for each locus, and it will also show amino acids of given region in <italic>IGV</italic> style. When SNVs exist, geom_base will highlight them with three styles (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). geom_cnv will show the normalized bin count and estimated copy number. geom_gc will calculate and visualize GC content of every bin, and it will also add a line to indicate mean GC content or user-specified GC content. geom_gene will obtain all genes in given region and classify these genes to different groups to avoid overlap when plotting. In gene annotation, the arrow direction indicates the strand of genes, the height of different elements indicates different gene parts, the color of line indicates gene strand or user-specified group information (e.g. gene type). geom_transcript is similar to geom_gene, but it shows all transcripts of a gene rather than the whole gene structure. geom_peak will show the peaks identified, so that the peaks and the nearby genes can be well visualized. geom_ideogram will show chromosome ideogram to illustrate the relative position of the displayed regions on the chromosome based on <italic>ggbio</italic> [<xref ref-type="bibr" rid="CR7">7</xref>]. geom_tad will show 3D chromatin contact maps based on <italic>HiCBricks</italic> [<xref ref-type="bibr" rid="CR14">14</xref>]. geom_link will create links of peak-gene or DNA-DNA. geom_protein will generate coverage plot of protein based on peptides obtained by mass spectrometry (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). geom_feature will show characteristics of protein or genome (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3).<table-wrap id="Tab2"><label>Table 2</label><caption><p><italic>ggcoverage</italic> layers</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Layer</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">geom_coverage</td><td align="left">Coverage</td><td align="left">Create genome coverage plot</td></tr><tr><td align="left">geom_base</td><td align="left">Annotation</td><td align="left">Add base, base frequency and amino acid annotations</td></tr><tr><td align="left">geom_cnv</td><td align="left">Annotation</td><td align="left">Add CNV annotation</td></tr><tr><td align="left">geom_gc</td><td align="left">Annotation</td><td align="left">Add GC content annotation</td></tr><tr><td align="left">geom_gene</td><td align="left">Annotation</td><td align="left">Add gene annotation</td></tr><tr><td align="left">geom_transcript</td><td align="left">Annotation</td><td align="left">Add gene’s transcripts annotation</td></tr><tr><td align="left">geom_peak</td><td align="left">Annotation</td><td align="left">Add peak annotation</td></tr><tr><td align="left">geom_ideogram</td><td align="left">Annotation</td><td align="left">Add chromosome ideogram annotation</td></tr><tr><td align="left">geom_tad</td><td align="left">Annotation</td><td align="left">Add contact map annotation</td></tr><tr><td align="left">geom_link</td><td align="left">Annotation</td><td align="left">Add link annotation</td></tr><tr><td align="left">geom_protein</td><td align="left">Coverage</td><td align="left">Create protein coverage plot</td></tr><tr><td align="left">geom_feature</td><td align="left">Annotation</td><td align="left">Add protein/genome feature annotation</td></tr></tbody></table></table-wrap></p>
      <p id="Par100">Similar to graphical language implemented in <italic>ggplot2</italic>, users can superimpose the above layers by the ‘ + ’ operator with the help of <italic>patchwork</italic> [<xref ref-type="bibr" rid="CR15">15</xref>]. For example, ggcoverage() + geom_gc() + geom_gene() + geom_ideogram() will create genome coverage plot and add GC content, gene structure and chromosome ideogram annotations.</p>
    </sec>
    <sec id="Sec6">
      <title>Customization</title>
      <p id="Par17"><italic>ggcoverage</italic> is based on <italic>ggplot2</italic>, so users can easily customize the generated figures with <italic>ggplot2</italic>. In general, customization mainly includes modifying the elements of existing figures and adding new layers. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4 shows the examples of these two kinds of customization.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results</title>
    <p id="Par18">Here, we show several practical use cases of applying <italic>ggcoverage</italic> to multi-omics, including WGS, ChIP-seq and RNA-seq. The code used to generate the figures without typesetting for Fig. <xref rid="Fig1" ref-type="fig">1</xref> is available in Additional file <xref rid="MOESM2" ref-type="media">2</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Visualizations of <italic>ggcoverage</italic> on selected NGS datasets. <bold>A</bold>
<italic>ggcoverage</italic> on WGS data to visualize CNV. Genome coverage plot shows read counts of all bins. GC content annotation shows GC content of every bin (red line: mean GC content of the whole region). Copy number annotation shows normalized read counts of all bins in grey dot, estimated copy number in red line and ploidy in black line. Chromosome ideogram annotation shows the displayed region on the chromosome with red rectangle and highlights the centromeres with green rectangle. <bold>B</bold>
<italic>ggcoverage</italic> on WGS data to visualize SNV. Genome coverage plot shows read counts of every locus. Base annotation shows base frequency (red line: 0.5) and reference base of every locus. Candidate SNV is highlighted with the twill mark. Amino acid annotation shows corresponding amino acids with 0, 1, 2 offsets. <bold>C</bold>
<italic>ggcoverage</italic> on ChIP-seq data. Different from (<bold>A</bold>), genome coverage plot discriminates sample groups (the first track in red is the ChIP sample and the last track in grey is the control sample), the light grey rectangle indicates the highlight region. Gene annotation shows genes in given region (rightwards arrow with dark green: gene on plus strand, leftwards arrow with dark blue: gene on minus strand; element height: gene part (exon &gt; UTR &gt; intron)). Peak annotation shows all peaks identified. <bold>D</bold>
<italic>ggcoverage</italic> on RNA-seq data with <italic>HNRNPC</italic> knockdown. Different from (<bold>A</bold>), we use transcript annotation instead of gene annotation to visualize gene’s all transcripts</p></caption><graphic xlink:href="12859_2023_5438_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par19">In CNV analysis, common confounding factors include GC content bias, telomeres and centromeres proximity. Figure <xref rid="Fig1" ref-type="fig">1</xref>A shows genome coverage with all these confounding factors to inspect the data. When applying <italic>ggcoverage</italic> on WGS data to visualize SNV (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B), we can see that there is a candidate single nucleotide variant (SNV) with T to A transversion at coordinate hg19 chr4:62,474,264 (highlight with twill), the variant allele frequency is 100%, and this may affect Y (Tyrosine), I (Isoleucine) and * (stop codon). When applying <italic>ggcoverage</italic> on ChIP-seq data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C), we can see that the ChIP sample has an enriched signal in the promoter region of the <italic>ATP9B</italic> gene compared to the input control, which is consistent with the results of called peaks. When applying <italic>ggcoverage</italic> on RNA-seq data with <italic>HNRNPC</italic> knockdown (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D), we can see that there is a significant reduction in read coverage of <italic>HNRNPC</italic>.</p>
  </sec>
  <sec id="Sec8">
    <title>Conclusions</title>
    <p id="Par20">We have developed <italic>ggcoverage</italic>, an R package dedicated to visualizing and annotating genome coverage of multi-groups and multi-omics. It allows users to visualize genome coverage with flexible input file formats, and annotate the genome coverage with various annotations to meet the needs of different NGS data. In addition to visualization, <italic>ggcoverage</italic> also provides reliable and efficient ways to perform data preprocessing, including parallel reads normalization per bin, consensus peaks generation from replicates and track data loading by extracting subsets. And owing to the multi-platform support of R, users do not need to transmit data. Finally, it is very convenient to generate high-quality and publication-ready plots, users can also customize the figures with <italic>ggplot2</italic>.</p>
  </sec>
  <sec id="Sec9">
    <title>Availability and requirements</title>
    <p id="Par21">
      <list list-type="bullet">
        <list-item>
          <p id="Par22">Project name: <italic>ggcoverage</italic></p>
        </list-item>
        <list-item>
          <p id="Par23">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/showteeth/ggcoverage">https://github.com/showteeth/ggcoverage</ext-link></p>
        </list-item>
        <list-item>
          <p id="Par24">Operating system(s): Unix, Linux, and Windows</p>
        </list-item>
        <list-item>
          <p id="Par25">Programming language: R</p>
        </list-item>
        <list-item>
          <p id="Par26">Other requirements: None</p>
        </list-item>
        <list-item>
          <p id="Par27">License: MIT License</p>
        </list-item>
        <list-item>
          <p id="Par28">Any restrictions to use by non-academics: None</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec10">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5438_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1. Additional figures. Fig. S1.</bold> Three styles of genome coverage plot. <bold>Fig. S2.</bold> Highlight SNV with three styles. <bold>Fig. S3.</bold> Protein coverage plot based on peptides obtained by mass spectrometry and annotation of protein characteristics. <bold>Fig. S4.</bold> Examples of figure customization.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5438_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> The codes used to generate the figures without typesetting for Fig. <xref rid="Fig1" ref-type="fig">1</xref>.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>NGS</term>
        <def>
          <p id="Par4">Next-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par5">Whole-genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>CNV</term>
        <def>
          <p id="Par6">Copy number variations</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA-seq</term>
        <def>
          <p id="Par7">RNA-sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>ChIP-seq</term>
        <def>
          <p id="Par8">Chromatin immunoprecipitation followed by sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>GTF</term>
        <def>
          <p id="Par9">Gene transfer format</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p id="Par10">Single nucleotide variant</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We appreciate the valuable feedback provided by Jiaxin Gao.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>YS developed <italic>ggcoverage</italic> and prepared the manuscript. JW provided supervision and secured funding. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the National Natural Science Foundation of China (Grant No. 22050004).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets analyzed during the current study are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/showteeth/ggcoverage">https://github.com/showteeth/ggcoverage</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par29">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par30">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par31">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>D-Q</given-names>
          </name>
          <name>
            <surname>Webber</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ponting</surname>
            <given-names>CP</given-names>
          </name>
        </person-group>
        <article-title>Bias of selection on human copy-number variants</article-title>
        <source>PLoS Genet</source>
        <year>2006</year>
        <volume>2</volume>
        <issue>2</issue>
        <fpage>e20</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.0020020</pub-id>
        <?supplied-pmid 16482228?>
        <pub-id pub-id-type="pmid">16482228</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conesa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Madrigal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tarazona</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gomez-Cabrero</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cervera</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A survey of best practices for RNA-seq data analysis</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>13</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0881-8</pub-id>
        <?supplied-pmid 26813401?>
        <pub-id pub-id-type="pmid">26813401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>ChIP–seq: advantages and challenges of a maturing technology</article-title>
        <source>Nat Rev Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>10</issue>
        <fpage>669</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2641</pub-id>
        <?supplied-pmid 19736561?>
        <pub-id pub-id-type="pmid">19736561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Furey</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Roskin</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Pringle</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Zahler</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.229102</pub-id>
        <?supplied-pmid 12045153?>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Thorvaldsdóttir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Winckler</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative genomics viewer</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>24</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id>
        <?supplied-pmid 21221095?>
        <pub-id pub-id-type="pmid">21221095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Hahne F, Ivanek R. Visualizing genomic data using Gviz and bioconductor. In: Methods in molecular biology<italic>.</italic> 2016. pp. 335–51.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title><italic>ggbio</italic>: an R package for extending the grammar of graphics for genomic data</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>8</issue>
        <fpage>R77</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-8-r77</pub-id>
        <?supplied-pmid 22937822?>
        <pub-id pub-id-type="pmid">22937822</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skidmore</surname>
            <given-names>ZL</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Lesurf</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Kunisaki</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Griffith</surname>
            <given-names>OL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GenVisR: genomic visualizations in R</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>19</issue>
        <fpage>3012</fpage>
        <lpage>3014</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw325</pub-id>
        <?supplied-pmid 27288499?>
        <pub-id pub-id-type="pmid">27288499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gel</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Serra</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>karyoploteR: an R/Bioconductor package to plot customizable genomes displaying arbitrary data</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>19</issue>
        <fpage>3088</fpage>
        <lpage>3090</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx346</pub-id>
        <?supplied-pmid 28575171?>
        <pub-id pub-id-type="pmid">28575171</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source><italic>ggplot2</italic>: elegant graphics for data analysis</source>
        <year>2016</year>
        <publisher-loc>Springer</publisher-loc>
        <publisher-name>Verlag New York</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramírez</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ryan</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Grüning</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bhardwaj</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kilpert</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Richter</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>deepTools2: a next generation web server for deep-sequencing data analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>W1</issue>
        <fpage>W160</fpage>
        <lpage>W165</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw257</pub-id>
        <?supplied-pmid 27079975?>
        <pub-id pub-id-type="pmid">27079975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Morgan M, Obenchain V, Lang M, Thompson R, Turaga N. BiocParallel: Bioconductor facilities for parallel evaluation. R package version 1.24.1. 2020.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jalili</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Matteucci</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Masseroli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Morelli</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Using combined evidence from replicates to evaluate ChIP-seq peaks</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>17</issue>
        <fpage>2761</fpage>
        <lpage>2769</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv293</pub-id>
        <?supplied-pmid 25957351?>
        <pub-id pub-id-type="pmid">25957351</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tagliaferri</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Livi</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Ferrari</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>HiCBricks: building blocks for efficient handling of large Hi-C datasets</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>36</volume>
        <issue>6</issue>
        <fpage>1917</fpage>
        <lpage>1919</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz808</pub-id>
        <?supplied-pmid 31697323?>
        <pub-id pub-id-type="pmid">31697323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Pedersen TL. Patchwork: The composer of plots. R package version 1.0.0. 2020.</mixed-citation>
    </ref>
  </ref-list>
</back>
