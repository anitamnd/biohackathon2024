<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10699847</article-id>
    <article-id pub-id-type="pmid">37995286</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad712</article-id>
    <article-id pub-id-type="publisher-id">btad712</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DeepFold: enhancing protein structure prediction through optimized loss functions, improved template features, and re-optimized energy function</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Jae-Won</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Won</surname>
          <given-names>Jong-Hyun</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jeon</surname>
          <given-names>Seonggwang</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Choo</surname>
          <given-names>Yujin</given-names>
        </name>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <aff><institution>Department of Artificial intelligence, Hanyang University, </institution>Seoul 04763, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yeon</surname>
          <given-names>Yubin</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Oh</surname>
          <given-names>Jin-Seon</given-names>
        </name>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <aff><institution>Department of Artificial intelligence, Hanyang University, </institution>Seoul 04763, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Minsoo</given-names>
        </name>
        <aff><institution>Department of Physics, Sungkyunkwan University</institution>, Suwon 16419, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>SeonHwa</given-names>
        </name>
        <aff><institution>School of Electrical Engineering, Korea University</institution>, Seoul 02841, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Joung</surname>
          <given-names>InSuk</given-names>
        </name>
        <aff><institution>Standigm Inc.</institution>, Seoul 06234, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jang</surname>
          <given-names>Cheongjae</given-names>
        </name>
        <aff><institution>Artificial Intelligence Institute, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Sung Jong</given-names>
        </name>
        <aff><institution>Basic Science Research Institute, Changwon National University</institution>, Changwon 51140, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Tae Hyun</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jin</surname>
          <given-names>Kyong Hwan</given-names>
        </name>
        <aff><institution>School of Electrical Engineering, Korea University</institution>, Seoul 02841, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8796-4678</contrib-id>
        <name>
          <surname>Song</surname>
          <given-names>Giltae</given-names>
        </name>
        <aff><institution>School of Computer Science and Engineering, Pusan National University</institution>, Busan 46241, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Eun-Sol</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yoo</surname>
          <given-names>Jejoong</given-names>
        </name>
        <aff><institution>Department of Physics, Sungkyunkwan University</institution>, Suwon 16419, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3655-9749</contrib-id>
        <name>
          <surname>Paek</surname>
          <given-names>Eunok</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Noh</surname>
          <given-names>Yung-Kyun</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>School of Computational Sciences, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-cor1" ref-type="corresp"/>
        <!--nohyung@hanyang.ac.kr-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4612-0927</contrib-id>
        <name>
          <surname>Joo</surname>
          <given-names>Keehyoung</given-names>
        </name>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-cor1" ref-type="corresp"/>
        <!--newton@kias.re.kr-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad712-cor1">Corresponding authors. Center for Advanced Computation, Korea Institute for Advanced Study, Seoul 02455, Korea. E-mail: <email>newton@kias.re.kr</email> (K.J.); Department of Computer Science, Hanyang University, Seoul 04763, Korea. E-mail: <email>nohyung@hanyang.ac.kr</email> (Y.-K.N.)</corresp>
      <fn id="btad712-FM1">
        <p>Jae-Won Lee, Jong-Hyun Won, Yujin Choo, Yubin Yeon, Jin-Seon Oh and Minsoo Kim Equal contribution</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-23">
      <day>23</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>12</issue>
    <elocation-id>btad712</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>20</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>06</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad712.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Predicting protein structures with high accuracy is a critical challenge for the broad community of life sciences and industry. Despite progress made by deep neural networks like AlphaFold2, there is a need for further improvements in the quality of detailed structures, such as side-chains, along with protein backbone structures.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Building upon the successes of AlphaFold2, the modifications we made include changing the losses of side-chain torsion angles and frame aligned point error, adding loss functions for side chain confidence and secondary structure prediction, and replacing template feature generation with a new alignment method based on conditional random fields. We also performed re-optimization by conformational space annealing using a molecular mechanics energy function which integrates the potential energies obtained from distogram and side-chain prediction. In the CASP15 blind test for single protein and domain modeling (109 domains), DeepFold ranked fourth among 132 groups with improvements in the details of the structure in terms of backbone, side-chain, and Molprobity. In terms of protein backbone accuracy, DeepFold achieved a median GDT-TS score of 88.64 compared with 85.88 of AlphaFold2. For TBM-easy/hard targets, DeepFold ranked at the top based on Z-scores for GDT-TS. This shows its practical value to the structural biology community, which demands highly accurate structures. In addition, a thorough analysis of 55 domains from 39 targets with publicly available structures indicates that DeepFold shows superior side-chain accuracy and Molprobity scores among the top-performing groups.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>DeepFold tools are open-source software available at <ext-link xlink:href="https://github.com/newtonjoo/deepfold" ext-link-type="uri">https://github.com/newtonjoo/deepfold</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Institute of Information &amp; communications Technology Planning &amp; Evaluation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Korea government</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Research Foundation of Korea</institution>
            <institution-id institution-id-type="DOI">10.13039/501100003725</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ministry of Science and ICT</institution>
            <institution-id institution-id-type="DOI">10.13039/501100014188</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Proteins serve as the essential building blocks of biological organisms, acting as the machinery of life. Protein functionality is highly dependent on their 3D structures; therefore, predicting and understanding these structures is crucial. The prediction of complete protein structures from their amino acid sequences alone has been a long-standing challenge, as demonstrated by the biennial CASP competition since 1994.</p>
    <p>Two primary computational approaches have been employed to address this challenge: template-based modeling (TBM) and free modeling (FM). TBM constructs a protein structure by using structures of homologous sequences, initially introduced in a study by Browne <italic toggle="yes">et al.</italic> (<xref rid="btad712-B7" ref-type="bibr">Browne <italic toggle="yes">et al.</italic> 1969</xref>). In TBM methods, finding a highly similar sequence from a given sequence is critical to producing accurate structures (<xref rid="btad712-B40" ref-type="bibr">Pearce and Zhang 2021</xref>). A conventional method for this is to align sequences using a position-specific score matrix (PSSM) (<xref rid="btad712-B3" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1997</xref>), or sequence profile Hidden Markov Models (HMMs) (<xref rid="btad712-B21" ref-type="bibr">Krogh <italic toggle="yes">et al.</italic> 1994</xref>) which made huge impact on searches for similar sequences and structures. These template structures serve as structural restraints for target structure modeling through sequence-structure alignment and optimization of empirical molecular mechanics force fields (<xref rid="btad712-B48" ref-type="bibr">Šali and Blundell 1993</xref>, <xref rid="btad712-B8" ref-type="bibr">Case <italic toggle="yes">et al.</italic> 2005</xref>, <xref rid="btad712-B16" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2016</xref>). Subsequent refinement, particularly of side-chain structures, is performed using empirical potentials employing molecular dynamics refinement or more efficient global optimization algorithms (<xref rid="btad712-B18" ref-type="bibr">Joo <italic toggle="yes">et al.</italic> 2007</xref>, <xref rid="btad712-B15" ref-type="bibr">Hong <italic toggle="yes">et al.</italic> 2017</xref>). Numerous groups have contributed to this field up until CASP12 (<xref rid="btad712-B18" ref-type="bibr">Joo <italic toggle="yes">et al.</italic> 2007</xref>, <xref rid="btad712-B1" ref-type="bibr">Adhikari <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad712-B15" ref-type="bibr">Hong <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad712-B39" ref-type="bibr">Ovchinnikov <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad712-B56" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2017b</xref>, <xref rid="btad712-B61" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2017</xref>).</p>
    <p>As an alternative, FM does not require known templates and instead exploits thermo-physical properties of protein structures. Molecular dynamics methods are predominant in this area (<xref rid="btad712-B62" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad712-B47" ref-type="bibr">Robustelli <italic toggle="yes">et al.</italic> 2018</xref>). Based on the assumption that native structures exhibit the lowest energy conformations (<xref rid="btad712-B4" ref-type="bibr">Anfinsen 1973</xref>), researchers attempt to identify the lowest energy conformations. However, this approach is practical only for short sequence lengths (<xref rid="btad712-B11" ref-type="bibr">Duan and Kollman 1998</xref>).</p>
    <p>Another route to protein structure modeling without template structures has been prediction of contacts between residues which typically utilizes the correlated mutations of residues from multiple sequence alignments for the target sequence (<xref rid="btad712-B35" ref-type="bibr">Morcos <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad712-B12" ref-type="bibr">Ekeberg <italic toggle="yes">et al.</italic> 2013</xref>). An important breakthrough has been an idea to incorporate deep neural networks to harness the contact information hidden in the MSA’s (Wang <italic toggle="yes">et al.</italic><xref rid="btad712-B55" ref-type="bibr">2017a, b</xref>) which led to the surprising appearance and success of AlphaFold1 in CASP13 (<xref rid="btad712-B49" ref-type="bibr">Senior <italic toggle="yes">et al.</italic> 2020</xref>). Recently, deep neural network models called AlphaFold2 (<xref rid="btad712-B19" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>) (AF2) and RoseTTAFold (<xref rid="btad712-B5" ref-type="bibr">Baek <italic toggle="yes">et al.</italic> 2021</xref>) have made significant breakthroughs in this problem. These neural networks use attention modules (<xref rid="btad712-B6" ref-type="bibr">Bahdanau <italic toggle="yes">et al.</italic> 2014</xref>, <xref rid="btad712-B54" ref-type="bibr">Vaswani <italic toggle="yes">et al.</italic> 2017</xref>) to inject long-range contact information from MSAs and templates into vector representations, successfully constructing a complete protein structure based on the representation. In CASP14, AF2 demonstrated striking prediction performance, showing high accuracy in predicted protein structures on most of the targets (<xref rid="btad712-B22" ref-type="bibr">Kwon <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad712-B43" ref-type="bibr">Pereira <italic toggle="yes">et al.</italic> 2021</xref>). However, despite AF2’s remarkable results on average, there still remain some targets for which the predictions of AF2 are rather poor, especially in the cases when MSAs are insufficient for proper modeling. Therefore there are still rooms for further improvement in deep neural network models, both in terms of efficiency and quality of the predicted structures. In particular, improving the accuracy of side-chain modeling would be important for high accuracy modeling and real applications.</p>
    <p>Several attempts have been made to improve AF2 in various ways since its advent. One avenue is to address the efficiency of training and inference. UniFold (<xref rid="btad712-B25" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2022</xref>) and OpenFold (<xref rid="btad712-B2" ref-type="bibr">Ahdritz <italic toggle="yes">et al.</italic> 2022</xref>) are the two initial works in this field. While UniFold is a slightly modified model of AF2 with its own training system, OpenFold is a reconstructed version of AF2 with accelerated training/inference time. ColabFold (<xref rid="btad712-B34" ref-type="bibr">Mirdita <italic toggle="yes">et al.</italic> 2022</xref>), ParaFold (<xref rid="btad712-B65" ref-type="bibr">Zhong <italic toggle="yes">et al.</italic> 2021</xref>), and FastFold (<xref rid="btad712-B9" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2022</xref>) are another model that demonstrated fast MSA searches and inference speed. Some works have attempted to build models that cover certain limitations of AF2. ESMFold (<xref rid="btad712-B26" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>), EMBER2 (<xref rid="btad712-B58" ref-type="bibr">Weissenow <italic toggle="yes">et al.</italic> 2022</xref>), and HelixFold (<xref rid="btad712-B13" ref-type="bibr">Fang <italic toggle="yes">et al.</italic> 2023</xref>) presented end-to-end models that can predict complete structures without MSAs or templates, which is not possible with AF2. With the recent success of diffusion models (<xref rid="btad712-B14" ref-type="bibr">Ho <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad712-B50" ref-type="bibr">Song <italic toggle="yes">et al.</italic> 2021</xref>), various efforts have been made toward predicting protein structures using generative models (<xref rid="btad712-B28" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad712-B53" ref-type="bibr">Trippe <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btad712-B57" ref-type="bibr">Watson <italic toggle="yes">et al.</italic> 2023</xref>). These models showed some potentials but still have limitations compared to AF2-based methods in terms of accuracy and effectiveness.</p>
    <p>Even with such a long history and remarkable advances in protein structure prediction, improvement in the quality of detailed structures such as side-chains has always been in strong demand, along with the quality of protein backbone structures, especially in the larger community of life sciences and industry. In this study, we address this problem by constructing a protein structure prediction model called DeepFold. In order to achieve more accurate backbone and side-chains with enhancement of the overall quality of protein structures, we modified the losses of the side-chain torsion angles and FAPE (frame aligned point error). And we introduced new loss functions for side chain confidence and secondary structure prediction. In addition, we replaced the template feature generation of AF2 by integrating a refined version of the alignment method, CRFalign (<xref rid="btad712-B24" ref-type="bibr">Lee <italic toggle="yes">et al.</italic> 2022</xref>), which builds upon the established principles of conditional random fields (<xref rid="btad712-B41" ref-type="bibr">Peng and Xu 2009</xref>). This refined version incorporates new feature vectors and gradient boosted regression trees. Lastly, re-optimization of the predicted structures is performed using a powerful global optimization algorithm called conformational space annealing (CSA) (<xref rid="btad712-B23" ref-type="bibr">Lee <italic toggle="yes">et al.</italic> 1997</xref>, <xref rid="btad712-B18" ref-type="bibr">Joo <italic toggle="yes">et al.</italic> 2007</xref>). We used a molecular mechanics energy function that integrates the potential energies obtained from the distogram and side-chain prediction. For validation, we benchmarked the prediction protocol of DeepFold on CASP13/14 targets which showed consistent improvement in side-chain torsions of proteins with a modest increase in backbone accuracy. In CASP15 blind competition, DeepFold achieved quite promising result, ranking fourth out of 132 teams in the assessors’ formula metric. Further analysis revealed that DeepFold outperformed top-performing groups in terms of detailed protein structure, including side-chains and Molprobity scores.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p><xref rid="btad712-F1" ref-type="fig">Figure 1</xref> shows the flow diagram of DeepFold for protein structure prediction. Given an amino acid sequence, DeepFold starts with generating MSAs and templates, which are processed as input to the DeepFold network. Then, Evoformer (<xref rid="btad712-B19" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>) network generates single and pair representations for the sequence that are fed into Structure modules to produce protein 3D structures. Those structures are re-optimized by CSA with an energy function including molecular mechanics force field and additional potentials from distogram and side-chain predictions. Details of DeepFold, with focus on modifications of AF2 are described below.</p>
    <fig position="float" id="btad712-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Prediction flow diagram of DeepFold. Given an amino acid sequence, the method first generates input features using MSAs and templates, where the MSAs are obtained from HHBlits, JackHMMER, and HHpred, and the templates/alignments are generated by CRFalign. Protein 3D structures are predicted by DeepFold network and then final structures are re-optimized by conformational space annealing (CSA). (See the main text for details.)</p>
      </caption>
      <graphic xlink:href="btad712f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 MSA and template feature generation</title>
      <p>The input features for DeepFold are generated from MSAs and templates. For the MSAs, DeepFold uses standard MSA generation procedure of AF2 using JackHMMER (<xref rid="btad712-B17" ref-type="bibr">Johnson <italic toggle="yes">et al.</italic> 2010</xref>) with MGnify (<xref rid="btad712-B46" ref-type="bibr">Richardson <italic toggle="yes">et al.</italic> 2023</xref>), JackHMMER with UniRef90 (<xref rid="btad712-B52" ref-type="bibr">Suzek <italic toggle="yes">et al.</italic> 2015</xref>), and HHblits (<xref rid="btad712-B45" ref-type="bibr">Remmert <italic toggle="yes">et al.</italic> 2012</xref>) with Uniclust30 (<xref rid="btad712-B33" ref-type="bibr">Mirdita <italic toggle="yes">et al.</italic> 2017</xref>)/BFD (<xref rid="btad712-B51" ref-type="bibr">Steinegger <italic toggle="yes">et al.</italic> 2019</xref>). As for the templates, we collected template candidates from HHPRED. In addition, we ranked all the structures in the PDB40 database (see Dataset section) based on their structural similarity to our query protein using DeepAlign (<xref rid="btad712-B36" ref-type="bibr">Nolle <italic toggle="yes">et al.</italic> 2020</xref>) with the AF2 model. From these ranked results, we selected the top 20 structures as additional template candidates. These aggregated template candidates were then re-ranked using CRFalign (<xref rid="btad712-B24" ref-type="bibr">Lee <italic toggle="yes">et al.</italic> 2022</xref>), a sequence-structure alignment method based on pairwise conditional random fields and gradient boosted regression trees. We utilized up to four of these templates and their respective alignments as input for the DeepFold network. In protein structure prediction, templates have been shown to be especially beneficial for targets with similar templates (<xref rid="btad712-B59" ref-type="bibr">Wu <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Sequentially conditioned torsion angle loss</title>
      <p>Since the side-chain torsion angles <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> are sequentially dependent in terms of 3D coordinates, we modified the torsion angle loss considering this sequential relationship in side chain angles by introducing the pre-torsion angle error <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>:</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mi>E</mml:mi>
                        <mml:mo>˜</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>χ</mml:mo>
                      </mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>:</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>E</mml:mi>
                            <mml:mo>˜</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>E</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mi>E</mml:mi>
                                  <mml:mo>˜</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>χ</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>⋅</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>E</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>χ</mml:mo>
                                </mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msqrt>
                        <mml:mn>2</mml:mn>
                      </mml:msqrt>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mo> </mml:mo>
            <mml:mtext>for</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mi>k</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mn>2</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>3</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>4</mml:mn>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>with the initial condition <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where the <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the square-root angle error defined as:</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>E</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>χ</mml:mo>
                      </mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>:</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:msqrt>
              <mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>α</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>α</mml:mi>
                            <mml:mo>^</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>|</mml:mo>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:mrow>
            </mml:msqrt>
            <mml:mo> </mml:mo>
            <mml:mtext>for</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mi>k</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>2</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>3</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>4.</mml:mn>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>Here, <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is a cosine/sine vector representation of <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> in a single residue:</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>α</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>χ</mml:mo>
                      </mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd>
                              <mml:mrow>
                                <mml:mo> </mml:mo>
                                <mml:mtext>cos</mml:mtext>
                                <mml:mo> </mml:mo>
                                <mml:mrow>
                                  <mml:msup>
                                    <mml:mrow>
                                      <mml:mo>χ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>k</mml:mi>
                                  </mml:msup>
                                </mml:mrow>
                                <mml:mo>,</mml:mo>
                                <mml:mo> </mml:mo>
                                <mml:mtext>sin</mml:mtext>
                                <mml:mo> </mml:mo>
                                <mml:mrow>
                                  <mml:msup>
                                    <mml:mrow>
                                      <mml:mo>χ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>k</mml:mi>
                                  </mml:msup>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo>⊤</mml:mo>
              </mml:msup>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>The sequential properties of the pre-torsion angle error <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> can be seen as follows. In the case of <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> where no preceding angles exist, the error is reduced to just the angle error <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. For the case of <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, or <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, the error references the previous error <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> in the calculation of the current error, such that the current error <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> increases (i.e. is nonzero) even if the current angle difference <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is zero. Therefore, even though the model predicts correctly <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> angles, if it predicts <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> incorrectly, the torsion error of <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> will be increased. Lastly, summing the pre-torsion angle error <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for each of the <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mo>χ</mml:mo></mml:math></inline-formula> angles, we can define the overall angle loss as follows</p>
      <disp-formula id="E4">
        <label>(4)</label>
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>angle</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mi>N</mml:mi>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:mo stretchy="true">(</mml:mo>
              <mml:mrow>
                <mml:mo>Σ</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>E</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mo>Σ</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>E</mml:mi>
                            <mml:mo>˜</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mo>Σ</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>E</mml:mi>
                            <mml:mo>˜</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mn>3</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mo>Σ</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>E</mml:mi>
                            <mml:mo>˜</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mn>4</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mrow>
              <mml:mo stretchy="true">)</mml:mo>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <italic toggle="yes">N</italic> is the number of residues and the summations are over the numbers of <italic toggle="yes">k</italic>th side-chain torsion angles respectively (<inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>⋯</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>).</p>
    </sec>
    <sec>
      <title>2.3 The weighted FAPE loss</title>
      <p>The Frame-aligned point error (FAPE) in AF2 plays an essential role in aligning atom positions in the generated rigid frame of each residue (i.e. the predicted local frame of each residue). The FAPE loss of AF2 is defined as</p>
      <disp-formula id="E5">
        <label>(5)</label>
        <mml:math id="M5" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>FAPE</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold">x</mml:mi>
                </mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>min</mml:mi>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>T</mml:mi>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mo>⋅</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">x</mml:mi>
                    </mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>T</mml:mi>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi mathvariant="italic">true</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mo>⋅</mml:mo>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">x</mml:mi>
                    </mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi mathvariant="italic">true</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>|</mml:mo>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mn>10</mml:mn>
                <mml:mo>Å</mml:mo>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the predicted local frame (which represents the rotation <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and translation <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> of <italic toggle="yes">i</italic>th residue) and atom coordinates <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, which measures the squared error between local coordinates <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and its ground truth <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">true</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">true</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Note that the loss has a clamping value of 10 Å that washes out the loss values larger than 10 Å. In DeepFold, we introduce the weighted FAPE loss as follows:</p>
      <disp-formula id="E6">
        <label>(6)</label>
        <mml:math id="M6" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>WFAPE</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold">x</mml:mi>
                </mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>w</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>FAPE</mml:mtext>
                  <mml:mo> </mml:mo>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold">x</mml:mi>
                </mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where the weight <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is determined by following sigmoid-type function</p>
      <disp-formula id="E7">
        <label>(7)</label>
        <mml:math id="M7" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>w</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mi>v</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mi>h</mml:mi>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>in which <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the distance with maximal probability from the distogram, between <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>β</mml:mo></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> atoms of residues <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>. The hyperparameters <italic toggle="yes">v</italic>, <italic toggle="yes">h</italic> control the inflection point of the sigmoid function and an additional weighting constant, respectively. In this work, we used <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>12.0</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula> which were determined by iterative grid searches. This modified loss gives larger weight on the closer atoms.</p>
    </sec>
    <sec>
      <title>2.4 Secondary structure loss</title>
      <p>We introduce secondary structure loss in DeepFold network by implementing small multi-layer perceptrons in the structure module as shown in <xref rid="btad712-F1" ref-type="fig">Fig. 1</xref>. This network uses single representations as inputs which were obtained by IPA (Invariant Point Attention) in structure module (<xref rid="btad712-B19" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>). And they return as output the prediction results of 8-state secondary structure of each residue (<xref rid="btad712-B20" ref-type="bibr">Kabsch and Sander 1983</xref>). To train this network, we defined a loss function for the secondary structure by cross-entropy as follows:</p>
      <disp-formula id="E8">
        <label>(8)</label>
        <mml:math id="M8" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>secondary</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mi>N</mml:mi>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:munderover>
                <mml:mo>∑</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mi>N</mml:mi>
              </mml:munderover>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:munderover>
                  <mml:mo>∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mn>8</mml:mn>
                </mml:munderover>
              </mml:mrow>
              <mml:mrow>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>y</mml:mi>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>c</mml:mi>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
            <mml:mo> </mml:mo>
            <mml:mtext>log</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>c</mml:mi>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the true secondary structure of <italic toggle="yes">i-</italic>th residue with <italic toggle="yes">c</italic>-state, and <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the predicted probability that the 8-state secondary structure of the <italic toggle="yes">i-</italic>th residue is in <italic toggle="yes">c</italic>-state.</p>
    </sec>
    <sec>
      <title>2.5 Side-chain confidence loss</title>
      <p>Similarly to the plddt in AF2, we defined another confidence measure focussing on the side chains of protein structure as follows. Side chain confidence <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for each residue <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> is defined as:</p>
      <disp-formula id="E9">
        <label>(9)</label>
        <mml:math id="M9" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mo>δ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>/</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mo>δ</mml:mo>
                                  </mml:mrow>
                                  <mml:mn>0</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the difference between the true and predicted <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> angles <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">true</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">pred</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Here, <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is a reference value of angle difference which was set as <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> in this work. In order to predict <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, we implemented another multi-layer perceptron network in the structure module which returns as output the probability <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to be in the specific bin among 50 bins in the interval [0,1]. This can be compared with the true values of <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, from which a loss function can be formed. The loss function is defined as the cross-entropy loss between one-hot encoded <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and predictions:</p>
      <disp-formula id="E10">
        <label>(10)</label>
        <mml:math id="M10" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>sc</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>:</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mi>N</mml:mi>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:munderover>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi>N</mml:mi>
              </mml:munderover>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>s</mml:mi>
                </mml:msubsup>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow/>
                  <mml:mo>⊤</mml:mo>
                </mml:msup>
              </mml:mrow>
            </mml:mrow>
            <mml:mo> </mml:mo>
            <mml:mtext>log</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mi>p</mml:mi>
                        <mml:mo>^</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>s</mml:mi>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where the <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are one-hot encoded representations of <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and prediction <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively. In this work, the side chain confidence score for a single sequence is defined by the average score over all residues.</p>
      <p>With the modified loss functions and newly added loss terms, we arrive at the following combined loss <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula> which can be used for training the DeepFold model:</p>
      <disp-formula id="E11">
        <label>(11)</label>
        <mml:math id="M11" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi mathvariant="script">L</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>angle</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>WFAPE</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mn>3</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>secondary</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mn>4</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>sc</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mi mathvariant="bold">c</mml:mi>
                </mml:mrow>
                <mml:mo>⊤</mml:mo>
              </mml:msup>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>others</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where the <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>others</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>aux</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>dist</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>msa</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>resolved</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>vio</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are the other losses in AF2 with the default weights <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>0.3</mml:mn><mml:mo>,</mml:mo><mml:mn>2.0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>1.0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as they used in (<xref rid="btad712-B19" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>). <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> shows the relative weights of various loss terms in our modifications.</p>
    </sec>
    <sec>
      <title>2.6 Dataset, training, and validation</title>
      <p>We used the latest PDB database (Feb. 2022) for training. We clustered the sequences of PDB using CD-HIT with 40% sequence identity, which resulted in 31,911 protein chains. We further filtered 23,366 chains of high-resolution (with &lt; 2.5 Å) for a fine-tuning dataset. The obtained sequences were cropped to 256 and 384 residue sizes as in the AF2 for training. Five DeepFold models were selected from training with various training schedules. For all the trained models, we employed the Uni-fold (a trainable version of AF2) training system, where the trainings were started from the AF2 parameters and then further optimized in the style of transfer learning. Full details are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref>.</p>
    </sec>
    <sec>
      <title>2.7 Re-optimization by conformational space annealing</title>
      <p>Once 3D structures are inferred from the DeepFold networks, we perform global optimization using conformational space annealing (CSA) with the full atom force field, distance restraints, and side chain torsion restraints generated by the networks. Full details are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>In order to evaluate the performance of DeepFold, we conducted a blind test in the CASP15 competition. As our Group Names, we used DFolding and DFolding-server, where the latter was a server prediction protocol which was performed without the final CSA re-optimization due to the 3-day deadline. We present our results obtained from the official evaluation data, which was provided by CASP15 assessors of Single Protein and Domain Modeling category [15th Community Wide Experiment on the Critical Assessment of Techniques for Protein Structure Prediction (<ext-link xlink:href="https://predictioncenter.org/casp15/" ext-link-type="uri">https://predictioncenter.org/casp15/</ext-link>)]. Traditionally, all targets are divided into domains, which are classified as TBM and FM domains. In the CASP15, total of 109 domains, which were officially assessed, consist of 62 TBM domains (including 47 TBM-easy and 14 TBM-hard), and 47 FM domains (8 FM/TBM and 39 FM). We also present our own assessment of 55 domains (39 targets) including 27 TBM, 27 FM domains, and 1 domain that was not classified, for which native structures were publicly available.</p>
    <p>The official metric to compare the performance of all Groups is called <italic toggle="yes">sum</italic> Z-score which is a weighted sum of the Z-scores for each of the domains as in the following CASP15 assessor’s formula (<xref rid="btad712-B44" ref-type="bibr">Read and Chavali 2007</xref>, <xref rid="btad712-B29" ref-type="bibr">Mariani <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad712-B38" ref-type="bibr">Olechnovič <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad712-B10" ref-type="bibr">Croll <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad712-B32" ref-type="bibr">Millán <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad712-B43" ref-type="bibr">Pereira <italic toggle="yes">et al.</italic> 2021</xref>) [GDT-HA (Global Distance Test for High Accuracy), reLLG (Relative eLLG score), ASE (Accuracy Self Estimate), LDDT (Local Distance Difference Test), AA (CAD-score, all atoms), SG (The average value of Sphere Grinder Score), SC<inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (Side Chain Dihedral Error Score), Molprobity (Aggregated Molprobity Score), BB<inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (Backbone Dihedral Error Score), DipDiff (The average difference between the local DipScores)],</p>
    <disp-formula id="E12">
      <label>(12)</label>
      <mml:math id="M12" display="block" overflow="scroll">
        <mml:mrow>
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mi mathvariant="italic">sum</mml:mi>
                  <mml:mo> </mml:mo>
                  <mml:mi mathvariant="normal">Z</mml:mi>
                  <mml:mo>-</mml:mo>
                  <mml:mtext>score</mml:mtext>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>6</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo stretchy="true">(</mml:mo>
                  <mml:mtext>GDT-HA</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>reLLG</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>ASE</mml:mtext>
                  <mml:mo stretchy="true">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mrow>
                        <mml:mn>16</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo stretchy="true">(</mml:mo>
                  <mml:mtext>LDDT</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>AA</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>SG</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mtext>SC</mml:mtext>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>error</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="true">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mrow>
                        <mml:mn>12</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo stretchy="true">(</mml:mo>
                  <mml:mtext>Molprb</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mtext>BB</mml:mtext>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>error</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>DipDiff</mml:mtext>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>In addition to the above metric, GDT-TS is typically used as a standard measure of modeling accuracy (Global Distance Test for Tertiary Structure) to evaluate the accuracy of global backbone trace of the structure. <xref rid="btad712-F2" ref-type="fig">Figure 2</xref> illustrates the official rankings of DFolding, together with other top 50 among 132 Groups including BAKER (RosettaFold), ColabFold, NBIS-AF2-standard and OpenFold (the latter three are basically standard AF2-based protocols with modification of MSA generation). In <xref rid="btad712-F2" ref-type="fig">Fig. 2a</xref>, DFolding was ranked fourth according to the assessor’s formula, while in (b), DFolding was at the top in terms of <italic toggle="yes">sum</italic> Z-score of GDT-TS for 64 domains, classified in the TBM-easy and TBM-hard target. In the figure, DFolding-server was also included, indicating the performance difference in comparison with DFolding. Note that CSA re-optimization is not used in DFolding-server protocol due to the time limit of three-days.</p>
    <fig position="float" id="btad712-F2">
      <label>Figure 2.</label>
      <caption>
        <p>CASP15 rankings in terms of sum Z of (a) the assessor’s formula [<xref rid="E12" ref-type="disp-formula">Equation (12)</xref>] and (b) GDT-TS for TBM easy/hard targets (62 domains in total). In each figure, only top 50 out of 132 teams are shown.</p>
      </caption>
      <graphic xlink:href="btad712f2" position="float"/>
    </fig>
    <p><xref rid="btad712-T1" ref-type="table">Table 1</xref> shows the results of top 10 performing groups from the <xref rid="btad712-F2" ref-type="fig">Fig. 2a</xref>, in addition to three AF2 based methods. All metrics used in assessor’s formula are shown in the average values instead of Z-scores. Despite the differences of backbone accuracies, the values of the metrics such as SC<inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, AA, BB<inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and DipDiff are showing very little differences between groups. In particular, the value of SC<inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (which means side-chain error for protein structure models, where lower is better) is not very distinguishable in spite of a significant difference in backbone accuracy such as GDT-TS. This is because the criterion of correctness in the metric of SC<inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is too broad. Below, we will discuss our own evaluation for side-chain accuracies for 55 domains, where native structures are available in public. In the Molprobity score showing protein-likeness, DeepFold achieved a score of 0.97 (lower is better) and performed well among the top groups.</p>
    <table-wrap position="float" id="btad712-T1">
      <label>Table 1.</label>
      <caption>
        <p>The official CASP15 results of top 10 performing groups, in addition to three AF2 based methods sorted by assessor’s formula in <xref rid="E12" ref-type="disp-formula">Equation (12)</xref>.<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Rank</th>
            <th rowspan="1" colspan="1">Methods</th>
            <th rowspan="1" colspan="1">sum Z</th>
            <th rowspan="1" colspan="1">GDT-TS</th>
            <th rowspan="1" colspan="1">GDT-HA</th>
            <th rowspan="1" colspan="1">reLLG</th>
            <th rowspan="1" colspan="1">ASE</th>
            <th rowspan="1" colspan="1">LDDT</th>
            <th rowspan="1" colspan="1">AA</th>
            <th rowspan="1" colspan="1">SG</th>
            <th rowspan="1" colspan="1">SC<inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></th>
            <th rowspan="1" colspan="1">Molprobity</th>
            <th rowspan="1" colspan="1">BB<inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></th>
            <th rowspan="1" colspan="1">DipDiff</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">PEZYFoldings</td>
            <td rowspan="1" colspan="1">
              <bold>70.83</bold>
            </td>
            <td rowspan="1" colspan="1">81.89</td>
            <td rowspan="1" colspan="1">68.00</td>
            <td rowspan="1" colspan="1">12.65</td>
            <td rowspan="1" colspan="1">88.39</td>
            <td rowspan="1" colspan="1">0.79</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">90.10</td>
            <td rowspan="1" colspan="1">9.59</td>
            <td rowspan="1" colspan="1">1.34</td>
            <td rowspan="1" colspan="1">9.38</td>
            <td rowspan="1" colspan="1">0.02</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">UM-TBM</td>
            <td rowspan="1" colspan="1">68.56</td>
            <td rowspan="1" colspan="1">83.75</td>
            <td rowspan="1" colspan="1">
              <bold>69.49</bold>
            </td>
            <td rowspan="1" colspan="1">12.26</td>
            <td rowspan="1" colspan="1">89.04</td>
            <td rowspan="1" colspan="1">
              <bold>0.81</bold>
            </td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">
              <bold>92.06</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>9.42</bold>
            </td>
            <td rowspan="1" colspan="1">1.22</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">Yang-Server</td>
            <td rowspan="1" colspan="1">61.28</td>
            <td rowspan="1" colspan="1">
              <bold>83.92</bold>
            </td>
            <td rowspan="1" colspan="1">69.48</td>
            <td rowspan="1" colspan="1">12.45</td>
            <td rowspan="1" colspan="1">85.89</td>
            <td rowspan="1" colspan="1">0.79</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">91.76</td>
            <td rowspan="1" colspan="1">9.50</td>
            <td rowspan="1" colspan="1">1.36</td>
            <td rowspan="1" colspan="1">9.29</td>
            <td rowspan="1" colspan="1">0.02</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">4</td>
            <td rowspan="1" colspan="1">DFolding (DeepFold)</td>
            <td rowspan="1" colspan="1">61.07</td>
            <td rowspan="1" colspan="1">80.33</td>
            <td rowspan="1" colspan="1">66.39</td>
            <td rowspan="1" colspan="1">10.53</td>
            <td rowspan="1" colspan="1">87.22</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">88.79</td>
            <td rowspan="1" colspan="1">9.44</td>
            <td rowspan="1" colspan="1">0.97</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.03</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">5</td>
            <td rowspan="1" colspan="1">Yang</td>
            <td rowspan="1" colspan="1">59.01</td>
            <td rowspan="1" colspan="1">83.07</td>
            <td rowspan="1" colspan="1">68.92</td>
            <td rowspan="1" colspan="1">
              <bold>12.99</bold>
            </td>
            <td rowspan="1" colspan="1">86.13</td>
            <td rowspan="1" colspan="1">0.79</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">91.01</td>
            <td rowspan="1" colspan="1">9.51</td>
            <td rowspan="1" colspan="1">1.38</td>
            <td rowspan="1" colspan="1">9.29</td>
            <td rowspan="1" colspan="1">0.02</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">6</td>
            <td rowspan="1" colspan="1">McGuffin</td>
            <td rowspan="1" colspan="1">49.73</td>
            <td rowspan="1" colspan="1">79.82</td>
            <td rowspan="1" colspan="1">66.34</td>
            <td rowspan="1" colspan="1">11.28</td>
            <td rowspan="1" colspan="1">85.22</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">88.24</td>
            <td rowspan="1" colspan="1">9.43</td>
            <td rowspan="1" colspan="1">1.59</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">7</td>
            <td rowspan="1" colspan="1">MULTICOM</td>
            <td rowspan="1" colspan="1">48.83</td>
            <td rowspan="1" colspan="1">80.20</td>
            <td rowspan="1" colspan="1">66.41</td>
            <td rowspan="1" colspan="1">11.99</td>
            <td rowspan="1" colspan="1">75.55</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">89.98</td>
            <td rowspan="1" colspan="1">9.44</td>
            <td rowspan="1" colspan="1">1.38</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">8</td>
            <td rowspan="1" colspan="1">MULTICOM_refine</td>
            <td rowspan="1" colspan="1">48.83</td>
            <td rowspan="1" colspan="1">79.25</td>
            <td rowspan="1" colspan="1">65.46</td>
            <td rowspan="1" colspan="1">11.37</td>
            <td rowspan="1" colspan="1">85.75</td>
            <td rowspan="1" colspan="1">0.79</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">89.75</td>
            <td rowspan="1" colspan="1">9.43</td>
            <td rowspan="1" colspan="1">1.16</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">9</td>
            <td rowspan="1" colspan="1">BAKER</td>
            <td rowspan="1" colspan="1">47.99</td>
            <td rowspan="1" colspan="1">79.33</td>
            <td rowspan="1" colspan="1">63.81</td>
            <td rowspan="1" colspan="1">8.59</td>
            <td rowspan="1" colspan="1">85.72</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">0.75</td>
            <td rowspan="1" colspan="1">89.20</td>
            <td rowspan="1" colspan="1">9.46</td>
            <td rowspan="1" colspan="1">
              <bold>0.75</bold>
            </td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.03</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">10</td>
            <td rowspan="1" colspan="1">MULTICOM_human</td>
            <td rowspan="1" colspan="1">47.90</td>
            <td rowspan="1" colspan="1">79.99</td>
            <td rowspan="1" colspan="1">66.13</td>
            <td rowspan="1" colspan="1">11.08</td>
            <td rowspan="1" colspan="1">75.81</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">89.68</td>
            <td rowspan="1" colspan="1">9.44</td>
            <td rowspan="1" colspan="1">1.38</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">17</td>
            <td rowspan="1" colspan="1">ColabFold</td>
            <td rowspan="1" colspan="1">44.02</td>
            <td rowspan="1" colspan="1">75.36</td>
            <td rowspan="1" colspan="1">62.33</td>
            <td rowspan="1" colspan="1">10.77</td>
            <td rowspan="1" colspan="1">89.75</td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">0.75</td>
            <td rowspan="1" colspan="1">86.57</td>
            <td rowspan="1" colspan="1">9.43</td>
            <td rowspan="1" colspan="1">1.34</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">45</td>
            <td rowspan="1" colspan="1">NBIS-AF2-standard</td>
            <td rowspan="1" colspan="1">34.63</td>
            <td rowspan="1" colspan="1">75.81</td>
            <td rowspan="1" colspan="1">61.74</td>
            <td rowspan="1" colspan="1">9.59</td>
            <td rowspan="1" colspan="1">
              <bold>89.84</bold>
            </td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">0.75</td>
            <td rowspan="1" colspan="1">87.21</td>
            <td rowspan="1" colspan="1">9.44</td>
            <td rowspan="1" colspan="1">1.28</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">53</td>
            <td rowspan="1" colspan="1">OpenFold</td>
            <td rowspan="1" colspan="1">33.25</td>
            <td rowspan="1" colspan="1">73.71</td>
            <td rowspan="1" colspan="1">60.34</td>
            <td rowspan="1" colspan="1">9.13</td>
            <td rowspan="1" colspan="1">87.79</td>
            <td rowspan="1" colspan="1">0.74</td>
            <td rowspan="1" colspan="1">0.74</td>
            <td rowspan="1" colspan="1">84.72</td>
            <td rowspan="1" colspan="1">9.53</td>
            <td rowspan="1" colspan="1">1.72</td>
            <td rowspan="1" colspan="1">9.30</td>
            <td rowspan="1" colspan="1">0.00</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <label>a</label>
          <p>All of the 11 metrics in the formula are also shown as the average (over all the target) of the raw scores. References for each of the predictors listed are as follows: PEZYFoldings (<xref rid="btad712-B37" ref-type="bibr">Oda 2023</xref>), UM-TBM (<xref rid="btad712-B42" ref-type="bibr">Peng <italic toggle="yes">et al.</italic> 2023</xref>), Yang-Server (<xref rid="btad712-B64" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2023</xref>), McGuffin (<xref rid="btad712-B30" ref-type="bibr">McGuffin <italic toggle="yes">et al.</italic> 2023</xref>), MULTICOM (<xref rid="btad712-B27" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2023</xref>), ColabFold (<xref rid="btad712-B34" ref-type="bibr">Mirdita <italic toggle="yes">et al.</italic> 2022</xref>), and OpenFold (<xref rid="btad712-B2" ref-type="bibr">Ahdritz <italic toggle="yes">et al.</italic> 2022</xref>). The top scores in each metric are marked in bold.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p><xref rid="btad712-F3" ref-type="fig">Figure 3</xref> shows the effect of CSA re-optimization by comparing DFolding (<italic toggle="yes">y</italic>-axis) versus DFolding-server (<italic toggle="yes">x</italic>-axis) in terms of GDT-TS, LDDT, SC error, and Molprobity, where we used the official metrics provided by CASP15 assessors. DFolding prediction exhibits better performance in average scores for GDT-TS, LDDT, and Molprobity, while difference of SC<inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is very minor. It is due to the same reason mentioned above that the criterion of side-chain error is too broad. In GDT-TS, DFolding performed well for the relatively hard targets (GDT-TS less than about 70), which can be attributed to the result of CSA re-optimization. It also shows significant improvement in Molprobity score.</p>
    <fig position="float" id="btad712-F3">
      <label>Figure 3.</label>
      <caption>
        <p>Comparison between the accuracies of DFolding (<italic toggle="yes">y</italic>-axis) versus DFolding-server (without CSA re-optimization, <italic toggle="yes">x</italic>-axis). The CASP15 official results of GDT-TS, LDDT, SC error, and Molprobity are used. Higher values are better for GDT-TS, LDDT, while lower values are better for SC<inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and Molprobity. All numbers within the figures are average values over 109 domains.</p>
      </caption>
      <graphic xlink:href="btad712f3" position="float"/>
    </fig>
    <p>We now apply further analysis of our own on the performance of DeepFold with the 55 domains for which the native structures are available. In <xref rid="btad712-T2" ref-type="table">Table 2</xref>, GDT-TS and GDT-HA were calculated by using the TM-score program instead of using the official data. Side-chain accuracies of <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> were calculated by using 10° criterion of correctness, instead of using SC<inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> used in the official results. All values presented in the table are cumulative Z-scores for each metric, in line with the CASP15 assessor’s methodology (higher values are better). The results from DFolding demonstrate a balanced performance in both backbone and side-chain metrics when compared to leading groups. The table shows that the sum Z-score of DFolding in Molprobity value is significantly higher than all the other top performing groups. Furthermore, the table shows that DFolding achieved higher scores in LDDT, GDT-TS, and GDT-HA than the well-known methods such as AF2, BAKER, ColabFold, and OpenFold.</p>
    <table-wrap position="float" id="btad712-T2">
      <label>Table 2.</label>
      <caption>
        <p>CASP15 results of top 10 teams in <xref rid="btad712-T1" ref-type="table">Table 1</xref>, evaluated on 55 domains, for which the native structures are publicly available.<xref rid="tblfn2" ref-type="table-fn"><sup>a</sup></xref></p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Methods</th>
            <th rowspan="1" colspan="1">LDDT</th>
            <th rowspan="1" colspan="1">GDT-TS</th>
            <th rowspan="1" colspan="1">GDT-HA</th>
            <th rowspan="1" colspan="1">
              <inline-formula id="IE67">
                <mml:math id="IM67" display="inline" overflow="scroll">
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>χ</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="italic">acc</mml:mi>
                        </mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </th>
            <th rowspan="1" colspan="1">
              <inline-formula id="IE68">
                <mml:math id="IM68" display="inline" overflow="scroll">
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>χ</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="italic">acc</mml:mi>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </th>
            <th rowspan="1" colspan="1">Molprobity</th>
            <th rowspan="1" colspan="1">counts</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">PEZYFoldings</td>
            <td rowspan="1" colspan="1">38.19</td>
            <td rowspan="1" colspan="1">51.80</td>
            <td rowspan="1" colspan="1">54.93</td>
            <td rowspan="1" colspan="1">27.73</td>
            <td rowspan="1" colspan="1">27.22</td>
            <td rowspan="1" colspan="1">26.99</td>
            <td rowspan="1" colspan="1">53</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">UM-TBM</td>
            <td rowspan="1" colspan="1">36.41</td>
            <td rowspan="1" colspan="1">47.91</td>
            <td rowspan="1" colspan="1">53.86</td>
            <td rowspan="1" colspan="1">27.49</td>
            <td rowspan="1" colspan="1">31.27</td>
            <td rowspan="1" colspan="1">27.71</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Yang-Server</td>
            <td rowspan="1" colspan="1">24.69</td>
            <td rowspan="1" colspan="1">49.19</td>
            <td rowspan="1" colspan="1">52.44</td>
            <td rowspan="1" colspan="1">35.14</td>
            <td rowspan="1" colspan="1">35.80</td>
            <td rowspan="1" colspan="1">17.34</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <bold>DFolding (DeepFold)</bold>
            </td>
            <td rowspan="1" colspan="1">31.98</td>
            <td rowspan="1" colspan="1">46.76</td>
            <td rowspan="1" colspan="1">48.99</td>
            <td rowspan="1" colspan="1">29.00</td>
            <td rowspan="1" colspan="1">29.42</td>
            <td rowspan="1" colspan="1">50.51</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Yang</td>
            <td rowspan="1" colspan="1">22.78</td>
            <td rowspan="1" colspan="1">45.03</td>
            <td rowspan="1" colspan="1">47.66</td>
            <td rowspan="1" colspan="1">33.65</td>
            <td rowspan="1" colspan="1">40.38</td>
            <td rowspan="1" colspan="1">24.81</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">McGuffin</td>
            <td rowspan="1" colspan="1">29.75</td>
            <td rowspan="1" colspan="1">44.32</td>
            <td rowspan="1" colspan="1">49.21</td>
            <td rowspan="1" colspan="1">24.56</td>
            <td rowspan="1" colspan="1">29.05</td>
            <td rowspan="1" colspan="1">17.03</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MULTICOM</td>
            <td rowspan="1" colspan="1">29.41</td>
            <td rowspan="1" colspan="1">38.33</td>
            <td rowspan="1" colspan="1">43.88</td>
            <td rowspan="1" colspan="1">22.78</td>
            <td rowspan="1" colspan="1">27.23</td>
            <td rowspan="1" colspan="1">24.20</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MULTICOM_refine</td>
            <td rowspan="1" colspan="1">29.70</td>
            <td rowspan="1" colspan="1">28.98</td>
            <td rowspan="1" colspan="1">30.73</td>
            <td rowspan="1" colspan="1">23.98</td>
            <td rowspan="1" colspan="1">23.32</td>
            <td rowspan="1" colspan="1">31.21</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">BAKER</td>
            <td rowspan="1" colspan="1">15.93</td>
            <td rowspan="1" colspan="1">30.73</td>
            <td rowspan="1" colspan="1">27.01</td>
            <td rowspan="1" colspan="1">35.14</td>
            <td rowspan="1" colspan="1">32.44</td>
            <td rowspan="1" colspan="1">28.81</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MULTICOM_human</td>
            <td rowspan="1" colspan="1">27.20</td>
            <td rowspan="1" colspan="1">37.32</td>
            <td rowspan="1" colspan="1">41.77</td>
            <td rowspan="1" colspan="1">22.03</td>
            <td rowspan="1" colspan="1">22.98</td>
            <td rowspan="1" colspan="1">24.34</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">ColabFold</td>
            <td rowspan="1" colspan="1">24.93</td>
            <td rowspan="1" colspan="1">20.42</td>
            <td rowspan="1" colspan="1">21.60</td>
            <td rowspan="1" colspan="1">21.40</td>
            <td rowspan="1" colspan="1">22.57</td>
            <td rowspan="1" colspan="1">21.17</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">NBIS-AF2-standard</td>
            <td rowspan="1" colspan="1">21.52</td>
            <td rowspan="1" colspan="1">14.87</td>
            <td rowspan="1" colspan="1">14.57</td>
            <td rowspan="1" colspan="1">22.69</td>
            <td rowspan="1" colspan="1">20.29</td>
            <td rowspan="1" colspan="1">23.74</td>
            <td rowspan="1" colspan="1">54</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">OpenFold</td>
            <td rowspan="1" colspan="1">16.46</td>
            <td rowspan="1" colspan="1">14.09</td>
            <td rowspan="1" colspan="1">15.16</td>
            <td rowspan="1" colspan="1">18.03</td>
            <td rowspan="1" colspan="1">21.07</td>
            <td rowspan="1" colspan="1">19.67</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn2">
          <label>a</label>
          <p>All scores in the table are Z-sum scores. GDT-TS and GDT-HA in the table are calculated by TM-score (<xref rid="btad712-B63" ref-type="bibr">Zhang and Skolnick 2005</xref>). The top scores in each metric are marked in bold.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p><xref rid="btad712-F4" ref-type="fig">Figure 4</xref> shows a comparison between the accuracies of DFolding and DFolding-server for 55 domains. On average, DFolding outperforms DFolding-server in terms of GDT-TS and Molprobity value, while the sidechain scores are similar in terms of <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">acc</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">acc</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. This indicates that CSA re-optimization process of DFolding resulted in a minor improvement for the overall structure of the 55 protein domains.</p>
    <fig position="float" id="btad712-F4">
      <label>Figure 4.</label>
      <caption>
        <p>Comparison between the accuracies of DFolding (<italic toggle="yes">y</italic>-axis) and DFolding-server (<italic toggle="yes">x</italic>-axis) for publicly available 55 domains. All numbers within the figures are average values over 55 domains. Lower value is better for Molprobity.</p>
      </caption>
      <graphic xlink:href="btad712f4" position="float"/>
    </fig>
    <p>As mentioned in the Section 2, DFolding used CRFalign for the generation of template features. We can evaluate the quality of template features for 55 domains where the native structures are available. <xref rid="btad712-F5" ref-type="fig">Figure 5</xref> shows the difference between template features of DFolding and those of AF2. In order to show the difference between DFolding and AF2 in terms of the quality of templates, we used the best template among the (up to) four templates for each target. <xref rid="btad712-F5" ref-type="fig">Figure 5a</xref> shows the TM-scores of the templates of DFolding in comparison with those of AF2’s templates. Average TM-score of DFolding templates was 0.6042 while that of AF2 was 0.5521. <xref rid="btad712-F5" ref-type="fig">Figure 5b</xref> shows a comparison of the quality of CRFalign alignments and those of AF2’s. The alignment quality was measured based on the pairwise distance of residues. First, for the native sequence, collect pairs of residues and measure pairwise distances. The collected pairs are &gt;3 in sequence separation, with mutual distances &lt;8 Å. Second, for the residue pairs at the same location with the native sequence, pairwise distance is calculated for the aligned template sequence. Then, we calculate the ratio of the template residue pairs that have a similar distance to the native residue pairs’ distance. If the difference of a residue pair distance between native and template is less than a threshold, we label that the template residue pair distance is similar to that of native’s. In the case of (b), we set the threshold as 3 Å. We can see that the alignment quality of DFolding using CRFalign shows significant improvement over that of AF2, especially in the cases of hard targets (when the ratio of alignment quality is less than about 0.7). However, because the predicted structure is greatly affected by the quality of the MSA, the superiority of template information does not guarantee the improvement of the final structure. To further verify this, we added the final results of the 18 domains in <xref rid="btad712-F5" ref-type="fig">Fig. 5b</xref> where the difference in values is &gt;0.15 in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S7</xref>. For example, Target T1123, which belongs to the FM/TBM class, was among the relatively well-predicted cases. As illustrated in <xref rid="btad712-F6" ref-type="fig">Fig. 6a</xref>, DFolding ranked first with a GDT-TS score of 86.80, while DFolding-server was placed in the third position with a GDT-TS score of 83.64, outperforming other groups. <xref rid="btad712-F6" ref-type="fig">Figure 6c</xref> shows the best template, 5EWO (<xref rid="btad712-B60" ref-type="bibr">York <italic toggle="yes">et al.</italic> 2016</xref>), which was found using CRFalign. The template exhibited higher structural similarity to the native structure (TM-score = 0.69) than AF2 (TM-score = 0.31). <xref rid="btad712-F6" ref-type="fig">Figure 6b</xref> displays the predictions of DFolding and AF2 in cartoon style with the native structure. It can be observed that our models successfully generated <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>-sheets (shown in blue color) near the C-terminal, while AF2 failed to predict that region.</p>
    <fig position="float" id="btad712-F5">
      <label>Figure 5.</label>
      <caption>
        <p>Comparison of the templates of the 55 domains in CASP15. (a) TM-score comparison is shown between the templates found by DeepFold (through CRFalign) versus the ones found by AF2. Each point represents the template with the highest TM-score obtained by the respective method for a given target. Orange colors are the domains with a lower TM-score for CRFalign than the AF2 method, and cyan colors indicate the domains for which the same templates are found by both methods. Red color is the target T1123. (b) A comparison of the alignment qualities of CRFalign and AF2 is shown. All numbers within the figures are average values over 55 domains. The dotted line is indicating a difference <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mo>&gt;</mml:mo></mml:math></inline-formula> 0.15, and as a result, we had significantly better template information for 18 domains.</p>
      </caption>
      <graphic xlink:href="btad712f5" position="float"/>
    </fig>
    <fig position="float" id="btad712-F6">
      <label>Figure 6.</label>
      <caption>
        <p>The target T1123 in CASP15 for which DeepFold predictions showed the best GDT-TS scores. (a) DeepFold human and server models ranked at the top three in a row. (b) The predicted 3D structures of T1123 and the native structure (colored as green). Compared to AF2, the DeepFold prediction correctly predicts helix and <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>-sheets near the C-terminal region, highlighted in blue. (c) The template 5EWO obtained by CRFalign shows a high structural similarity to the native structures (TM = 0.69) compared with the template in AF2 (TM = 0.31).</p>
      </caption>
      <graphic xlink:href="btad712f6" position="float"/>
    </fig>
    <sec>
      <title>3.1 What went wrong</title>
      <p>DFolding failed to generate correct fold for some targets especially for T1125 and T1130. T1125 was a challenging target, likely due to its large size of 1200 residues, which consists of 6 domains (five FM domains and one TBM-hard). Only a few groups achieved good scores (<ext-link xlink:href="https://predictioncenter.org/casp15/results.cgi?view=tb-sel" ext-link-type="uri">https://predictioncenter.org/casp15/results.cgi?view=tb-sel</ext-link>). For T1125-D1, the average GDT-TS of all groups was 28.44, but that of top three groups had scores around 80. The Neff score of MSA [i.e. represents a measure of the diversity or the effective number of sequences within the alignment, with higher scores indicating a more diverse set of sequences in the MSA (<xref rid="btad712-B31" ref-type="bibr">Meier and Söding 2014</xref>).] generated by AF2 standard was 1.39 with only five sequences including the target itself, resulting in low plddt scores ranging from 0.39 to 0.44. For the single domain target T1130 with 198 residues (FM domain), DFolding exhibited poor performance with 29.40 of GDT-TS along with most of the groups, while only 3 groups achieved around 95. For this target, the Neff score of AF2 is 0.0 with no additional homologous sequences. And no template structures were found as can be expected for an FM domain. It is highly probable that the three successful groups identified high-quality MSAs through their extended efforts for the target. We also attempted to generate MSAs using other available web servers, but with limited success. As a result, it appears that MSA quality is crucial for the successful prediction of structures using AF2-based methods.</p>
    </sec>
    <sec>
      <title>3.2 What went right</title>
      <p>We found that the improvement of DeepFold’s prediction accuracy can be attributed to the following three elements: modified loss functions, choice of better templates, and CSA re-optimizations. To begin with, the positive effect of modified loss functions is confirmed by ablation studies, as shown in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref>. To summarize, modified loss functions improved the side-chain accuracy while maintaining the backbone accuracy. The choice of better templates and alignments (partly through CRFalign) improved the backbone accuracy of the specific targets. Finally, CSA re-optimization improved backbone accuracy and molprobity scores through structure optimization.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>In this work, we have presented DeepFold, a pipeline for predicting protein structures. Our primary objective was to improve the accuracy of backbone and side-chain prediction, and we achieved this by making several modifications to the AF2 pipeline. These modifications included optimizing the loss functions with focus on torsion angle losses and additional loss functions introduced to improve side chain accuracy and secondary structure prediction with updated template features. Further re-optimization was performed by CSA using a molecular mechanics energy function which integrates the potential energies obtained from distogram and side-chain prediction. In the blind test at the CASP15 competition, DeepFold improves the details of the protein structure in both backbone and side-chains, ranking fourth in the category of Single Protein and Domain Modeling (109 domains). In addition, DeepFold’s structure prediction showed the best results in terms of backbone accuracy of GDT-TS for the targets in the TBM class (62 among 109 domains), which are more important in practical applications. Our thorough analysis of 55 domains with publicly available ground-truth structures revealed that DeepFold showed the best side-chain accuracy and Molprobity scores in the top-performing groups. It can be seen that the effect of modification and retraining of the DeepFold network and the final re-optimization have made significant differences. In particular, it can be seen that re-optimization further improves the details of protein structure such as backbone, side-chain and Molprobity.</p>
    <p>There remain limitations in predicting certain targets, such as very large target like T1125, and T1130 both with low-quality MSAs. This is due to the well-known fact that the performance of AF2-based methods is heavily dependent on the quality of MSAs. It is essential to evaluate the quality of the obtained MSA and enhance the quality of low-quality MSAs by employing techniques such as protein language models (<xref rid="btad712-B26" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>) or generative models (<xref rid="btad712-B28" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2022</xref>). Furthermore, in order to predict larger protein structures properly, reliable protein domain parsing must be considered.</p>
    <p>In conclusion, our work on DeepFold represents an improvement upon the foundation laid by AF2. Through our modifications to the AF2 pipeline, we have achieved higher accuracy in terms of backbones and side-chains. We believe that our work has advanced the field of protein structure prediction, which we expect to be a valuable tool for the protein modeling community.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad712_Supplementary_Data</label>
      <media xlink:href="btad712_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>We thank the KIAS Center for Advanced Computation for providing computing resources.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government (MSIT) [2021-0-02068, 2020-0-01373]; the Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Science and ICT (MSIT) [NRF-2018R1D1A1B07049312] and the 2023 KT ICT AI2XL Laboratory R&amp;D Fund project funded by KT [KT award B230000177].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article is available at <ext-link xlink:href="https://github.com/newtonjoo/deepfold" ext-link-type="uri">https://github.com/newtonjoo/deepfold</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad712-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adhikari</surname><given-names>B</given-names></string-name>, <string-name><surname>Hou</surname><given-names>J</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Protein contact prediction by integrating deep multiple sequence alignments, coevolution and machine learning</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017</year>;<volume>86</volume>:<fpage>84</fpage>–<lpage>96</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ahdritz</surname><given-names>G</given-names></string-name>, <string-name><surname>Bouatta</surname><given-names>N</given-names></string-name>, <string-name><surname>Kadyan</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal> Openfold: retraining alphafold2 yields new insights into its learning mechanisms and capacity for generalization. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.11.20.517210</pub-id>, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>, <string-name><surname>Madden</surname><given-names>TL</given-names></string-name>, <string-name><surname>Schäffer</surname><given-names>AA</given-names></string-name></person-group><etal>et al</etal><article-title>Gapped blast and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res</source><year>1997</year>;<volume>25</volume>:<fpage>3389</fpage>–<lpage>402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anfinsen</surname><given-names>CB.</given-names></string-name></person-group><article-title>Principles that govern the folding of protein chains</article-title>. <source>Science</source><year>1973</year>;<volume>181</volume>:<fpage>223</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">4124164</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baek</surname><given-names>M</given-names></string-name>, <string-name><surname>DiMaio</surname><given-names>F</given-names></string-name>, <string-name><surname>Anishchenko</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>Accurate prediction of protein structures and interactions using a three-track neural network</article-title>. <source>Science</source><year>2021</year>;<volume>373</volume>:<fpage>871</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">34282049</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bahdanau</surname><given-names>D</given-names></string-name>, <string-name><surname>Cho</surname><given-names>K</given-names></string-name>, <string-name><surname>Bengio</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal> Neural machine translation by jointly learning to align and translate. arXiv, arXiv:1409.0473, <year>2014</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Browne</surname><given-names>WJ</given-names></string-name>, <string-name><surname>North</surname><given-names>ACT</given-names></string-name>, <string-name><surname>Phillips</surname><given-names>DC</given-names></string-name></person-group><etal>et al</etal><article-title>A possible three-dimensional structure of bovine <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>-lactalbumin based on that of hen’s egg-white lysozyme</article-title>. <source>J Mol Biol</source><year>1969</year>;<volume>42</volume>:<fpage>65</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">5817651</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Case</surname><given-names>DA</given-names></string-name>, <string-name><surname>Cheatham</surname><given-names>TE</given-names></string-name>, <string-name><surname>Darden</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>The amber biomolecular simulation programs</article-title>. <source>J Comput Chem</source><year>2005</year>;<volume>26</volume>:<fpage>1668</fpage>–<lpage>88</lpage>.<pub-id pub-id-type="pmid">16200636</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>S</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>X</given-names></string-name>, <string-name><surname>Lu</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal> Fastfold: reducing alphafold training time from 11 days to 67 hours. arXiv, arXiv: 2203.00854, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Croll</surname><given-names>TI</given-names></string-name>, <string-name><surname>Sammito</surname><given-names>MD</given-names></string-name>, <string-name><surname>Kryshtafovych</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Evaluation of template-based modeling in CASP13</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2019</year>;<volume>87</volume>:<fpage>1113</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kollman</surname><given-names>PA.</given-names></string-name></person-group><article-title>Pathways to a protein folding intermediate observed in a 1-microsecond simulation in aqueous solution</article-title>. <source>Science</source><year>1998</year>;<volume>282</volume>:<fpage>740</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">9784131</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ekeberg</surname><given-names>M</given-names></string-name>, <string-name><surname>Lövkvist</surname><given-names>C</given-names></string-name>, <string-name><surname>Lan</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Improved contact prediction in proteins: using pseudolikelihoods to infer potts models</article-title>. <source>Phys Rev E</source><year>2013</year>;<volume>87</volume>:<fpage>012707</fpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fang</surname><given-names>X</given-names></string-name>, <string-name><surname>Wang</surname><given-names>F</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>A method for multiple-sequence-alignment-free protein structure prediction using a protein language model</article-title>. <source>Nat Mach Intell</source><year>2023</year>;<volume>5</volume>:<fpage>1087</fpage>–<lpage>96</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ho</surname><given-names>J</given-names></string-name>, <string-name><surname>Jain</surname><given-names>A</given-names></string-name>, <string-name><surname>Abbeel</surname><given-names>P.</given-names></string-name></person-group> Denoising diffusion probabilistic models. <italic toggle="yes">Adv Neural Info Process Syst</italic> 2020;<volume>33</volume>:<fpage>6840</fpage>–<lpage>51</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hong</surname><given-names>SH</given-names></string-name>, <string-name><surname>Joung</surname><given-names>I</given-names></string-name>, <string-name><surname>Flores-Canales</surname><given-names>JC</given-names></string-name></person-group><etal>et al</etal><article-title>Protein structure modeling and refinement by global optimization in CASP12</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017</year>;<volume>86</volume>:<fpage>122</fpage>–<lpage>35</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>J</given-names></string-name>, <string-name><surname>Rauscher</surname><given-names>S</given-names></string-name>, <string-name><surname>Nawrocki</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>CHARMM36m: an improved force field for folded and intrinsically disordered proteins</article-title>. <source>Nat Methods</source><year>2016</year>;<volume>14</volume>:<fpage>71</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">27819658</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Johnson</surname><given-names>LS</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR</given-names></string-name>, <string-name><surname>Portugaly</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Hidden markov model speed heuristic and iterative hmm search procedure</article-title>. <source>BMC Bioinformatics</source><year>2010</year>;<volume>11</volume>:<fpage>431</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">20718988</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Joo</surname><given-names>K</given-names></string-name>, <string-name><surname>Lee</surname><given-names>J</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>High accuracy template based modeling by global optimization</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2007</year>;<volume>69</volume>:<fpage>83</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Highly accurate protein structure prediction with alphafold</article-title>. <source>Nature</source><year>2021</year>;<volume>596</volume>:<fpage>583</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kabsch</surname><given-names>W</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C.</given-names></string-name></person-group><article-title>Dictionary of protein secondary structure: pattern recognition of hydrogen-bonded and geometrical features</article-title>. <source>Biopolymers</source><year>1983</year>;<volume>22</volume>:<fpage>2577</fpage>–<lpage>637</lpage>.<pub-id pub-id-type="pmid">6667333</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krogh</surname><given-names>A</given-names></string-name>, <string-name><surname>Brown</surname><given-names>M</given-names></string-name>, <string-name><surname>Mian</surname><given-names>IS</given-names></string-name></person-group><etal>et al</etal><article-title>Hidden Markov Models in computational biology: applications to protein modeling</article-title>. <source>J Mol Biol</source><year>1994</year>;<volume>235</volume>:<fpage>1501</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">8107089</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kwon</surname><given-names>S</given-names></string-name>, <string-name><surname>Won</surname><given-names>J</given-names></string-name>, <string-name><surname>Kryshtafovych</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Assessment of protein model structure accuracy estimation in CASP14: old and new challenges</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2021</year>;<volume>89</volume>:<fpage>1940</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>J</given-names></string-name>, <string-name><surname>Scheraga</surname><given-names>HA</given-names></string-name>, <string-name><surname>Rackovsky</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>New optimization method for conformational energy calculations on polypeptides: conformational space annealing</article-title>. <source>J Comput Chem</source><year>1997</year>;<volume>18</volume>:<fpage>1222</fpage>–<lpage>32</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Joo</surname><given-names>K</given-names></string-name>, <string-name><surname>Sim</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Crfalign: a sequence-structure alignment of proteins based on a combination of hmm-hmm comparison and conditional random fields</article-title>. <source>Molecules</source><year>2022</year>;<volume>27</volume>:<fpage>3711</fpage>.<pub-id pub-id-type="pmid">35744836</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B25">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Uni-fold: an open-source platform for developing protein folding models beyond alphafold</article-title>. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.08.04.502811</pub-id>, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Z</given-names></string-name>, <string-name><surname>Akin</surname><given-names>H</given-names></string-name>, <string-name><surname>Rao</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>. <source>Science</source><year>2023</year>;<volume>379</volume>:<fpage>1123</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">36927031</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Guo</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wu</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Improving alphafold2-based protein tertiary structure prediction with multicom in CASP15</article-title>. <source>Commun Chem</source><year>2023</year>;<volume>6</volume>:<fpage>188</fpage>.<pub-id pub-id-type="pmid">37679431</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B28">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>L</given-names></string-name>, <string-name><surname>Liu</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal> De novo protein backbone generation based on diffusion with structured priors and adversarial training. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.12.17.520847</pub-id>, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mariani</surname><given-names>V</given-names></string-name>, <string-name><surname>Kiefer</surname><given-names>F</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Assessment of template based protein structure predictions in CASP9</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2011</year>;<volume>79</volume>:<fpage>37</fpage>–<lpage>58</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McGuffin</surname><given-names>LJ</given-names></string-name>, <string-name><surname>Edmunds</surname><given-names>NS</given-names></string-name>, <string-name><surname>Genc</surname><given-names>AG</given-names></string-name></person-group><etal>et al</etal><article-title>Prediction of protein structures, functions and interactions using the intFOLD7, multifold and modfolddock servers</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>W274</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">37102670</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meier</surname><given-names>A</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J.</given-names></string-name></person-group><article-title>Context similarity scoring improves protein sequence alignments in the midnight zone</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>31</volume>:<fpage>674</fpage>–<lpage>81</lpage>.<pub-id pub-id-type="pmid">25338715</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Millán</surname><given-names>C</given-names></string-name>, <string-name><surname>Keegan</surname><given-names>RM</given-names></string-name>, <string-name><surname>Pereira</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Assessing the utility of CASP14 models for molecular replacement</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2021</year>;<volume>89</volume>:<fpage>1752</fpage>–<lpage>69</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mirdita</surname><given-names>M</given-names></string-name>, <string-name><surname>von den Driesch</surname><given-names>L</given-names></string-name>, <string-name><surname>Galiez</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Uniclust databases of clustered and deeply annotated protein sequences and alignments</article-title>. <source>Nucleic Acids Res</source><year>2017</year>;<volume>45</volume>:<fpage>D170</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">27899574</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mirdita</surname><given-names>M</given-names></string-name>, <string-name><surname>Schütze</surname><given-names>K</given-names></string-name>, <string-name><surname>Moriwaki</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Colabfold: making protein folding accessible to all</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>679</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">35637307</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morcos</surname><given-names>F</given-names></string-name>, <string-name><surname>Pagnani</surname><given-names>A</given-names></string-name>, <string-name><surname>Lunt</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>. <source>Proc Natl Acad Sci USA</source><year>2011</year>;<volume>108</volume>:<fpage>E1293</fpage>–<lpage>301</lpage>.<pub-id pub-id-type="pmid">22106262</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B36">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Nolle</surname><given-names>T</given-names></string-name>, <string-name><surname>Seeliger</surname><given-names>A</given-names></string-name>, <string-name><surname>Thoma</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal> Deepalign: alignment-based process anomaly correction using recurrent neural networks. In: Dustdar S, Yu E, Salinesi C et al. (eds), <italic toggle="yes">Advanced Information Systems Engineering: 32nd International Conference, CAiSE 2020</italic>, June 8–12, 2020. Grenoble, France: Springer, <year>2020</year>, <fpage>319</fpage>–<lpage>33</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oda</surname><given-names>T.</given-names></string-name></person-group><article-title>Improving protein structure prediction with extended sequence similarity searches and deep-learning-based refinement in CASP15</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2023</year>;<volume>91</volume>:<fpage>1712</fpage>–<lpage>23</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Olechnovič</surname><given-names>K</given-names></string-name>, <string-name><surname>Kulberkytė</surname><given-names>E</given-names></string-name>, <string-name><surname>Venclovas</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Cad-score: a new contact area difference-based function for evaluation of protein structural models</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2013</year>;<volume>81</volume>:<fpage>149</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ovchinnikov</surname><given-names>S</given-names></string-name>, <string-name><surname>Park</surname><given-names>H</given-names></string-name>, <string-name><surname>Kim</surname><given-names>DE</given-names></string-name></person-group><etal>et al</etal><article-title>Protein structure prediction using rosetta in CASP12</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017</year>;<volume>86</volume>:<fpage>113</fpage>–<lpage>21</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pearce</surname><given-names>R</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name></person-group><article-title>Toward the solution of the protein structure prediction problem</article-title>. <source>J Biol Chem</source><year>2021</year>;<volume>297</volume>:<fpage>100870</fpage>.<pub-id pub-id-type="pmid">34119522</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B41">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>J</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J.</given-names></string-name></person-group> Boosting protein threading accuracy. In: Batzoglou S (ed.), <italic toggle="yes">Research in Computational Molecular Biology: 13th Annual International Conference, RECOMB 2009</italic>, May 18–21, 2009. Tucson, AZ, USA: Springer, <year>2009</year>, <fpage>31</fpage>–<lpage>45</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Hong</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Improved protein structure prediction with trrosettaX2, alphafold2, and optimized msas in CASP15</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2023</year>;<volume>91</volume>:<fpage>1704</fpage>–<lpage>11</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pereira</surname><given-names>J</given-names></string-name>, <string-name><surname>Simpkin</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Hartmann</surname><given-names>MD</given-names></string-name></person-group><etal>et al</etal><article-title>High-accuracy protein structure prediction in CASP14</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2021</year>;<volume>89</volume>:<fpage>1687</fpage>–<lpage>99</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Read</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Chavali</surname><given-names>G.</given-names></string-name></person-group><article-title>Assessment of CASP7 predictions in the high accuracy template-based modeling category</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2007</year>;<volume>69</volume>:<fpage>27</fpage>–<lpage>37</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Remmert</surname><given-names>M</given-names></string-name>, <string-name><surname>Biegert</surname><given-names>A</given-names></string-name>, <string-name><surname>Hauser</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Hhblits: lightning-fast iterative protein sequence searching by hmm-hmm alignment</article-title>. <source>Nat Methods</source><year>2012</year>;<volume>9</volume>:<fpage>173</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Richardson</surname><given-names>L</given-names></string-name>, <string-name><surname>Allen</surname><given-names>B</given-names></string-name>, <string-name><surname>Baldi</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>MGnify: the microbiome sequence data analysis resource in 2023</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>D753</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">36477304</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robustelli</surname><given-names>P</given-names></string-name>, <string-name><surname>Piana</surname><given-names>S</given-names></string-name>, <string-name><surname>Shaw</surname><given-names>DE</given-names></string-name></person-group><etal>et al</etal><article-title>Developing a molecular dynamics force field for both folded and disordered protein states</article-title>. <source>Proc Natl Acad Sci USA</source><year>2018</year>;<volume>115</volume>:<fpage>E4758</fpage>–<lpage>66</lpage>.<pub-id pub-id-type="pmid">29735687</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Šali</surname><given-names>A</given-names></string-name>, <string-name><surname>Blundell</surname><given-names>TL.</given-names></string-name></person-group><article-title>Comparative protein modelling by satisfaction of spatial restraints</article-title>. <source>J Mol Biol</source><year>1993</year>;<volume>234</volume>:<fpage>779</fpage>–<lpage>815</lpage>.<pub-id pub-id-type="pmid">8254673</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Senior</surname><given-names>AW</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Jumper</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Improved protein structure prediction using potentials from deep learning</article-title>. <source>Nature</source><year>2020</year>;<volume>577</volume>:<fpage>706</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">31942072</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B50">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>Y</given-names></string-name>, <string-name><surname>Sohl-Dickstein</surname><given-names>J</given-names></string-name>, <string-name><surname>Kingma</surname><given-names>DP</given-names></string-name></person-group><etal>et al</etal> Score-based generative modeling through stochastic differential equations. <italic toggle="yes">International Conference on Learning Representations,</italic> 2021.</mixed-citation>
    </ref>
    <ref id="btad712-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M</given-names></string-name>, <string-name><surname>Mirdita</surname><given-names>M</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Protein-level assembly increases protein sequence recovery from metagenomic samples manyfold</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>:<fpage>603</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">31235882</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Suzek</surname><given-names>BE</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Huang</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal>; <collab>UniProt Consortium</collab>. <article-title>Uniref clusters: a comprehensive and scalable alternative for improving sequence similarity searches</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>926</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">25398609</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B53">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Trippe</surname><given-names>BL</given-names></string-name>, <string-name><surname>Yim</surname><given-names>J</given-names></string-name>, <string-name><surname>Tischer</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal> Diffusion probabilistic modeling of protein backbones in 3d for the motif-scaffolding problem. <italic toggle="yes">International Conference on Learning Representations,</italic> 2023.</mixed-citation>
    </ref>
    <ref id="btad712-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vaswani</surname><given-names>A</given-names></string-name>, <string-name><surname>Shazeer</surname><given-names>N</given-names></string-name>, <string-name><surname>Parmar</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>Attention is all you need</article-title>. <source>Adv Neural Inf Process Syst</source><year>2017</year>;<volume>30</volume>. <ext-link xlink:href="https://papers.nips.cc/paper_files/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html" ext-link-type="uri">https://papers.nips.cc/paper_files/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad712-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>S</given-names></string-name>, <string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Accurate de novo prediction of protein contact map by ultra-deep learning model</article-title>. <source>PLoS Comput Biol</source><year>2017a</year>;<volume>13</volume>:<fpage>e1005324</fpage>.<pub-id pub-id-type="pmid">28056090</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>S</given-names></string-name>, <string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Analysis of deep learning methods for blind protein contact prediction in CASP12</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017b</year>;<volume>86</volume>:<fpage>67</fpage>–<lpage>77</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Watson</surname><given-names>JL</given-names></string-name>, <string-name><surname>Juergens</surname><given-names>D</given-names></string-name>, <string-name><surname>Bennett</surname><given-names>NR</given-names></string-name></person-group><etal>et al</etal><article-title>De novo design of protein structure and function with RFdiffusion</article-title>. <source>Nature</source><year>2023</year>;<volume>620</volume>:<fpage>1089</fpage>–<lpage>100</lpage>.<pub-id pub-id-type="pmid">37433327</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weissenow</surname><given-names>K</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Protein language-model embeddings for fast, accurate, and alignment-free protein structure prediction</article-title>. <source>Structure</source><year>2022</year>;<volume>30</volume>:<fpage>1169</fpage>–<lpage>77.e4</lpage>.<pub-id pub-id-type="pmid">35609601</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>F</given-names></string-name>, <string-name><surname>Jing</surname><given-names>X</given-names></string-name>, <string-name><surname>Luo</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>Improving protein structure prediction using templates and sequence embedding</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>39</volume>:<fpage>btac723</fpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>York</surname><given-names>RL</given-names></string-name>, <string-name><surname>Yousefi</surname><given-names>PA</given-names></string-name>, <string-name><surname>Bogdanoff</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Structural, mechanistic, and antigenic characterization of the human astrovirus capsid</article-title>. <source>J Virol</source><year>2016</year>;<volume>90</volume>:<fpage>2254</fpage>–<lpage>63</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C</given-names></string-name>, <string-name><surname>Mortuza</surname><given-names>SM</given-names></string-name>, <string-name><surname>He</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Template-based and free modeling of i-TASSER and QUARK pipelines using predicted contact maps in CASP12</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017</year>;<volume>86</volume>:<fpage>136</fpage>–<lpage>51</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Liang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Atomic-level protein structure refinement using fragment-guided molecular dynamics conformation sampling</article-title>. <source>Structure</source><year>2011</year>;<volume>19</volume>:<fpage>1784</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">22153501</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Skolnick</surname><given-names>J.</given-names></string-name></person-group><article-title>TM-align: a protein structure alignment algorithm based on the TM-score</article-title>. <source>Nucleic Acids Res</source><year>2005</year>;<volume>33</volume>:<fpage>2302</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">15849316</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>W</given-names></string-name>, <string-name><surname>Wuyun</surname><given-names>Q</given-names></string-name>, <string-name><surname>Freddolino</surname><given-names>PL</given-names></string-name></person-group><etal>et al</etal><article-title>Integrating deep learning, threading alignments, and a multi-msa strategy for high-quality protein monomer and complex structure prediction in CASP15</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2023</year>;<volume>91</volume>:<fpage>1684</fpage>–<lpage>703</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B65">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zhong</surname><given-names>B</given-names></string-name>, <string-name><surname>Su</surname><given-names>X</given-names></string-name>, <string-name><surname>Wen</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal> Parafold: paralleling alphafold for large-scale predictions. <italic toggle="yes">International Conference on High Performance Computing in Asia-Pacific Region Workshops,</italic> 2021.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10699847</article-id>
    <article-id pub-id-type="pmid">37995286</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad712</article-id>
    <article-id pub-id-type="publisher-id">btad712</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DeepFold: enhancing protein structure prediction through optimized loss functions, improved template features, and re-optimized energy function</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Jae-Won</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Won</surname>
          <given-names>Jong-Hyun</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jeon</surname>
          <given-names>Seonggwang</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Choo</surname>
          <given-names>Yujin</given-names>
        </name>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <aff><institution>Department of Artificial intelligence, Hanyang University, </institution>Seoul 04763, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yeon</surname>
          <given-names>Yubin</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Oh</surname>
          <given-names>Jin-Seon</given-names>
        </name>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <aff><institution>Department of Artificial intelligence, Hanyang University, </institution>Seoul 04763, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Minsoo</given-names>
        </name>
        <aff><institution>Department of Physics, Sungkyunkwan University</institution>, Suwon 16419, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>SeonHwa</given-names>
        </name>
        <aff><institution>School of Electrical Engineering, Korea University</institution>, Seoul 02841, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Joung</surname>
          <given-names>InSuk</given-names>
        </name>
        <aff><institution>Standigm Inc.</institution>, Seoul 06234, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jang</surname>
          <given-names>Cheongjae</given-names>
        </name>
        <aff><institution>Artificial Intelligence Institute, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Sung Jong</given-names>
        </name>
        <aff><institution>Basic Science Research Institute, Changwon National University</institution>, Changwon 51140, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Tae Hyun</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jin</surname>
          <given-names>Kyong Hwan</given-names>
        </name>
        <aff><institution>School of Electrical Engineering, Korea University</institution>, Seoul 02841, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8796-4678</contrib-id>
        <name>
          <surname>Song</surname>
          <given-names>Giltae</given-names>
        </name>
        <aff><institution>School of Computer Science and Engineering, Pusan National University</institution>, Busan 46241, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Eun-Sol</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yoo</surname>
          <given-names>Jejoong</given-names>
        </name>
        <aff><institution>Department of Physics, Sungkyunkwan University</institution>, Suwon 16419, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3655-9749</contrib-id>
        <name>
          <surname>Paek</surname>
          <given-names>Eunok</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Noh</surname>
          <given-names>Yung-Kyun</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>School of Computational Sciences, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-cor1" ref-type="corresp"/>
        <!--nohyung@hanyang.ac.kr-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4612-0927</contrib-id>
        <name>
          <surname>Joo</surname>
          <given-names>Keehyoung</given-names>
        </name>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-cor1" ref-type="corresp"/>
        <!--newton@kias.re.kr-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad712-cor1">Corresponding authors. Center for Advanced Computation, Korea Institute for Advanced Study, Seoul 02455, Korea. E-mail: <email>newton@kias.re.kr</email> (K.J.); Department of Computer Science, Hanyang University, Seoul 04763, Korea. E-mail: <email>nohyung@hanyang.ac.kr</email> (Y.-K.N.)</corresp>
      <fn id="btad712-FM1">
        <p>Jae-Won Lee, Jong-Hyun Won, Yujin Choo, Yubin Yeon, Jin-Seon Oh and Minsoo Kim Equal contribution</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-23">
      <day>23</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>12</issue>
    <elocation-id>btad712</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>20</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>06</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad712.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Predicting protein structures with high accuracy is a critical challenge for the broad community of life sciences and industry. Despite progress made by deep neural networks like AlphaFold2, there is a need for further improvements in the quality of detailed structures, such as side-chains, along with protein backbone structures.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Building upon the successes of AlphaFold2, the modifications we made include changing the losses of side-chain torsion angles and frame aligned point error, adding loss functions for side chain confidence and secondary structure prediction, and replacing template feature generation with a new alignment method based on conditional random fields. We also performed re-optimization by conformational space annealing using a molecular mechanics energy function which integrates the potential energies obtained from distogram and side-chain prediction. In the CASP15 blind test for single protein and domain modeling (109 domains), DeepFold ranked fourth among 132 groups with improvements in the details of the structure in terms of backbone, side-chain, and Molprobity. In terms of protein backbone accuracy, DeepFold achieved a median GDT-TS score of 88.64 compared with 85.88 of AlphaFold2. For TBM-easy/hard targets, DeepFold ranked at the top based on Z-scores for GDT-TS. This shows its practical value to the structural biology community, which demands highly accurate structures. In addition, a thorough analysis of 55 domains from 39 targets with publicly available structures indicates that DeepFold shows superior side-chain accuracy and Molprobity scores among the top-performing groups.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>DeepFold tools are open-source software available at <ext-link xlink:href="https://github.com/newtonjoo/deepfold" ext-link-type="uri">https://github.com/newtonjoo/deepfold</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Institute of Information &amp; communications Technology Planning &amp; Evaluation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Korea government</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Research Foundation of Korea</institution>
            <institution-id institution-id-type="DOI">10.13039/501100003725</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ministry of Science and ICT</institution>
            <institution-id institution-id-type="DOI">10.13039/501100014188</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Proteins serve as the essential building blocks of biological organisms, acting as the machinery of life. Protein functionality is highly dependent on their 3D structures; therefore, predicting and understanding these structures is crucial. The prediction of complete protein structures from their amino acid sequences alone has been a long-standing challenge, as demonstrated by the biennial CASP competition since 1994.</p>
    <p>Two primary computational approaches have been employed to address this challenge: template-based modeling (TBM) and free modeling (FM). TBM constructs a protein structure by using structures of homologous sequences, initially introduced in a study by Browne <italic toggle="yes">et al.</italic> (<xref rid="btad712-B7" ref-type="bibr">Browne <italic toggle="yes">et al.</italic> 1969</xref>). In TBM methods, finding a highly similar sequence from a given sequence is critical to producing accurate structures (<xref rid="btad712-B40" ref-type="bibr">Pearce and Zhang 2021</xref>). A conventional method for this is to align sequences using a position-specific score matrix (PSSM) (<xref rid="btad712-B3" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1997</xref>), or sequence profile Hidden Markov Models (HMMs) (<xref rid="btad712-B21" ref-type="bibr">Krogh <italic toggle="yes">et al.</italic> 1994</xref>) which made huge impact on searches for similar sequences and structures. These template structures serve as structural restraints for target structure modeling through sequence-structure alignment and optimization of empirical molecular mechanics force fields (<xref rid="btad712-B48" ref-type="bibr">Šali and Blundell 1993</xref>, <xref rid="btad712-B8" ref-type="bibr">Case <italic toggle="yes">et al.</italic> 2005</xref>, <xref rid="btad712-B16" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2016</xref>). Subsequent refinement, particularly of side-chain structures, is performed using empirical potentials employing molecular dynamics refinement or more efficient global optimization algorithms (<xref rid="btad712-B18" ref-type="bibr">Joo <italic toggle="yes">et al.</italic> 2007</xref>, <xref rid="btad712-B15" ref-type="bibr">Hong <italic toggle="yes">et al.</italic> 2017</xref>). Numerous groups have contributed to this field up until CASP12 (<xref rid="btad712-B18" ref-type="bibr">Joo <italic toggle="yes">et al.</italic> 2007</xref>, <xref rid="btad712-B1" ref-type="bibr">Adhikari <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad712-B15" ref-type="bibr">Hong <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad712-B39" ref-type="bibr">Ovchinnikov <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad712-B56" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2017b</xref>, <xref rid="btad712-B61" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2017</xref>).</p>
    <p>As an alternative, FM does not require known templates and instead exploits thermo-physical properties of protein structures. Molecular dynamics methods are predominant in this area (<xref rid="btad712-B62" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad712-B47" ref-type="bibr">Robustelli <italic toggle="yes">et al.</italic> 2018</xref>). Based on the assumption that native structures exhibit the lowest energy conformations (<xref rid="btad712-B4" ref-type="bibr">Anfinsen 1973</xref>), researchers attempt to identify the lowest energy conformations. However, this approach is practical only for short sequence lengths (<xref rid="btad712-B11" ref-type="bibr">Duan and Kollman 1998</xref>).</p>
    <p>Another route to protein structure modeling without template structures has been prediction of contacts between residues which typically utilizes the correlated mutations of residues from multiple sequence alignments for the target sequence (<xref rid="btad712-B35" ref-type="bibr">Morcos <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad712-B12" ref-type="bibr">Ekeberg <italic toggle="yes">et al.</italic> 2013</xref>). An important breakthrough has been an idea to incorporate deep neural networks to harness the contact information hidden in the MSA’s (Wang <italic toggle="yes">et al.</italic><xref rid="btad712-B55" ref-type="bibr">2017a, b</xref>) which led to the surprising appearance and success of AlphaFold1 in CASP13 (<xref rid="btad712-B49" ref-type="bibr">Senior <italic toggle="yes">et al.</italic> 2020</xref>). Recently, deep neural network models called AlphaFold2 (<xref rid="btad712-B19" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>) (AF2) and RoseTTAFold (<xref rid="btad712-B5" ref-type="bibr">Baek <italic toggle="yes">et al.</italic> 2021</xref>) have made significant breakthroughs in this problem. These neural networks use attention modules (<xref rid="btad712-B6" ref-type="bibr">Bahdanau <italic toggle="yes">et al.</italic> 2014</xref>, <xref rid="btad712-B54" ref-type="bibr">Vaswani <italic toggle="yes">et al.</italic> 2017</xref>) to inject long-range contact information from MSAs and templates into vector representations, successfully constructing a complete protein structure based on the representation. In CASP14, AF2 demonstrated striking prediction performance, showing high accuracy in predicted protein structures on most of the targets (<xref rid="btad712-B22" ref-type="bibr">Kwon <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad712-B43" ref-type="bibr">Pereira <italic toggle="yes">et al.</italic> 2021</xref>). However, despite AF2’s remarkable results on average, there still remain some targets for which the predictions of AF2 are rather poor, especially in the cases when MSAs are insufficient for proper modeling. Therefore there are still rooms for further improvement in deep neural network models, both in terms of efficiency and quality of the predicted structures. In particular, improving the accuracy of side-chain modeling would be important for high accuracy modeling and real applications.</p>
    <p>Several attempts have been made to improve AF2 in various ways since its advent. One avenue is to address the efficiency of training and inference. UniFold (<xref rid="btad712-B25" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2022</xref>) and OpenFold (<xref rid="btad712-B2" ref-type="bibr">Ahdritz <italic toggle="yes">et al.</italic> 2022</xref>) are the two initial works in this field. While UniFold is a slightly modified model of AF2 with its own training system, OpenFold is a reconstructed version of AF2 with accelerated training/inference time. ColabFold (<xref rid="btad712-B34" ref-type="bibr">Mirdita <italic toggle="yes">et al.</italic> 2022</xref>), ParaFold (<xref rid="btad712-B65" ref-type="bibr">Zhong <italic toggle="yes">et al.</italic> 2021</xref>), and FastFold (<xref rid="btad712-B9" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2022</xref>) are another model that demonstrated fast MSA searches and inference speed. Some works have attempted to build models that cover certain limitations of AF2. ESMFold (<xref rid="btad712-B26" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>), EMBER2 (<xref rid="btad712-B58" ref-type="bibr">Weissenow <italic toggle="yes">et al.</italic> 2022</xref>), and HelixFold (<xref rid="btad712-B13" ref-type="bibr">Fang <italic toggle="yes">et al.</italic> 2023</xref>) presented end-to-end models that can predict complete structures without MSAs or templates, which is not possible with AF2. With the recent success of diffusion models (<xref rid="btad712-B14" ref-type="bibr">Ho <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad712-B50" ref-type="bibr">Song <italic toggle="yes">et al.</italic> 2021</xref>), various efforts have been made toward predicting protein structures using generative models (<xref rid="btad712-B28" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad712-B53" ref-type="bibr">Trippe <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btad712-B57" ref-type="bibr">Watson <italic toggle="yes">et al.</italic> 2023</xref>). These models showed some potentials but still have limitations compared to AF2-based methods in terms of accuracy and effectiveness.</p>
    <p>Even with such a long history and remarkable advances in protein structure prediction, improvement in the quality of detailed structures such as side-chains has always been in strong demand, along with the quality of protein backbone structures, especially in the larger community of life sciences and industry. In this study, we address this problem by constructing a protein structure prediction model called DeepFold. In order to achieve more accurate backbone and side-chains with enhancement of the overall quality of protein structures, we modified the losses of the side-chain torsion angles and FAPE (frame aligned point error). And we introduced new loss functions for side chain confidence and secondary structure prediction. In addition, we replaced the template feature generation of AF2 by integrating a refined version of the alignment method, CRFalign (<xref rid="btad712-B24" ref-type="bibr">Lee <italic toggle="yes">et al.</italic> 2022</xref>), which builds upon the established principles of conditional random fields (<xref rid="btad712-B41" ref-type="bibr">Peng and Xu 2009</xref>). This refined version incorporates new feature vectors and gradient boosted regression trees. Lastly, re-optimization of the predicted structures is performed using a powerful global optimization algorithm called conformational space annealing (CSA) (<xref rid="btad712-B23" ref-type="bibr">Lee <italic toggle="yes">et al.</italic> 1997</xref>, <xref rid="btad712-B18" ref-type="bibr">Joo <italic toggle="yes">et al.</italic> 2007</xref>). We used a molecular mechanics energy function that integrates the potential energies obtained from the distogram and side-chain prediction. For validation, we benchmarked the prediction protocol of DeepFold on CASP13/14 targets which showed consistent improvement in side-chain torsions of proteins with a modest increase in backbone accuracy. In CASP15 blind competition, DeepFold achieved quite promising result, ranking fourth out of 132 teams in the assessors’ formula metric. Further analysis revealed that DeepFold outperformed top-performing groups in terms of detailed protein structure, including side-chains and Molprobity scores.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p><xref rid="btad712-F1" ref-type="fig">Figure 1</xref> shows the flow diagram of DeepFold for protein structure prediction. Given an amino acid sequence, DeepFold starts with generating MSAs and templates, which are processed as input to the DeepFold network. Then, Evoformer (<xref rid="btad712-B19" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>) network generates single and pair representations for the sequence that are fed into Structure modules to produce protein 3D structures. Those structures are re-optimized by CSA with an energy function including molecular mechanics force field and additional potentials from distogram and side-chain predictions. Details of DeepFold, with focus on modifications of AF2 are described below.</p>
    <fig position="float" id="btad712-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Prediction flow diagram of DeepFold. Given an amino acid sequence, the method first generates input features using MSAs and templates, where the MSAs are obtained from HHBlits, JackHMMER, and HHpred, and the templates/alignments are generated by CRFalign. Protein 3D structures are predicted by DeepFold network and then final structures are re-optimized by conformational space annealing (CSA). (See the main text for details.)</p>
      </caption>
      <graphic xlink:href="btad712f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 MSA and template feature generation</title>
      <p>The input features for DeepFold are generated from MSAs and templates. For the MSAs, DeepFold uses standard MSA generation procedure of AF2 using JackHMMER (<xref rid="btad712-B17" ref-type="bibr">Johnson <italic toggle="yes">et al.</italic> 2010</xref>) with MGnify (<xref rid="btad712-B46" ref-type="bibr">Richardson <italic toggle="yes">et al.</italic> 2023</xref>), JackHMMER with UniRef90 (<xref rid="btad712-B52" ref-type="bibr">Suzek <italic toggle="yes">et al.</italic> 2015</xref>), and HHblits (<xref rid="btad712-B45" ref-type="bibr">Remmert <italic toggle="yes">et al.</italic> 2012</xref>) with Uniclust30 (<xref rid="btad712-B33" ref-type="bibr">Mirdita <italic toggle="yes">et al.</italic> 2017</xref>)/BFD (<xref rid="btad712-B51" ref-type="bibr">Steinegger <italic toggle="yes">et al.</italic> 2019</xref>). As for the templates, we collected template candidates from HHPRED. In addition, we ranked all the structures in the PDB40 database (see Dataset section) based on their structural similarity to our query protein using DeepAlign (<xref rid="btad712-B36" ref-type="bibr">Nolle <italic toggle="yes">et al.</italic> 2020</xref>) with the AF2 model. From these ranked results, we selected the top 20 structures as additional template candidates. These aggregated template candidates were then re-ranked using CRFalign (<xref rid="btad712-B24" ref-type="bibr">Lee <italic toggle="yes">et al.</italic> 2022</xref>), a sequence-structure alignment method based on pairwise conditional random fields and gradient boosted regression trees. We utilized up to four of these templates and their respective alignments as input for the DeepFold network. In protein structure prediction, templates have been shown to be especially beneficial for targets with similar templates (<xref rid="btad712-B59" ref-type="bibr">Wu <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Sequentially conditioned torsion angle loss</title>
      <p>Since the side-chain torsion angles <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> are sequentially dependent in terms of 3D coordinates, we modified the torsion angle loss considering this sequential relationship in side chain angles by introducing the pre-torsion angle error <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>:</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mi>E</mml:mi>
                        <mml:mo>˜</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>χ</mml:mo>
                      </mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>:</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>E</mml:mi>
                            <mml:mo>˜</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>E</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mi>E</mml:mi>
                                  <mml:mo>˜</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>χ</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>⋅</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>E</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>χ</mml:mo>
                                </mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msqrt>
                        <mml:mn>2</mml:mn>
                      </mml:msqrt>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mo> </mml:mo>
            <mml:mtext>for</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mi>k</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mn>2</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>3</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>4</mml:mn>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>with the initial condition <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where the <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the square-root angle error defined as:</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>E</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>χ</mml:mo>
                      </mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>:</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:msqrt>
              <mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>α</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>α</mml:mi>
                            <mml:mo>^</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>|</mml:mo>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:mrow>
            </mml:msqrt>
            <mml:mo> </mml:mo>
            <mml:mtext>for</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mi>k</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>2</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>3</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>4.</mml:mn>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>Here, <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is a cosine/sine vector representation of <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> in a single residue:</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>α</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>χ</mml:mo>
                      </mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd>
                              <mml:mrow>
                                <mml:mo> </mml:mo>
                                <mml:mtext>cos</mml:mtext>
                                <mml:mo> </mml:mo>
                                <mml:mrow>
                                  <mml:msup>
                                    <mml:mrow>
                                      <mml:mo>χ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>k</mml:mi>
                                  </mml:msup>
                                </mml:mrow>
                                <mml:mo>,</mml:mo>
                                <mml:mo> </mml:mo>
                                <mml:mtext>sin</mml:mtext>
                                <mml:mo> </mml:mo>
                                <mml:mrow>
                                  <mml:msup>
                                    <mml:mrow>
                                      <mml:mo>χ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>k</mml:mi>
                                  </mml:msup>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo>⊤</mml:mo>
              </mml:msup>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>The sequential properties of the pre-torsion angle error <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> can be seen as follows. In the case of <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> where no preceding angles exist, the error is reduced to just the angle error <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. For the case of <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, or <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, the error references the previous error <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> in the calculation of the current error, such that the current error <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> increases (i.e. is nonzero) even if the current angle difference <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is zero. Therefore, even though the model predicts correctly <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> angles, if it predicts <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> incorrectly, the torsion error of <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> will be increased. Lastly, summing the pre-torsion angle error <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for each of the <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mo>χ</mml:mo></mml:math></inline-formula> angles, we can define the overall angle loss as follows</p>
      <disp-formula id="E4">
        <label>(4)</label>
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>angle</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mi>N</mml:mi>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:mo stretchy="true">(</mml:mo>
              <mml:mrow>
                <mml:mo>Σ</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>E</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mo>Σ</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>E</mml:mi>
                            <mml:mo>˜</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mo>Σ</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>E</mml:mi>
                            <mml:mo>˜</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mn>3</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mo>Σ</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>E</mml:mi>
                            <mml:mo>˜</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mn>4</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mrow>
              <mml:mo stretchy="true">)</mml:mo>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <italic toggle="yes">N</italic> is the number of residues and the summations are over the numbers of <italic toggle="yes">k</italic>th side-chain torsion angles respectively (<inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>⋯</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>).</p>
    </sec>
    <sec>
      <title>2.3 The weighted FAPE loss</title>
      <p>The Frame-aligned point error (FAPE) in AF2 plays an essential role in aligning atom positions in the generated rigid frame of each residue (i.e. the predicted local frame of each residue). The FAPE loss of AF2 is defined as</p>
      <disp-formula id="E5">
        <label>(5)</label>
        <mml:math id="M5" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>FAPE</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold">x</mml:mi>
                </mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>min</mml:mi>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>T</mml:mi>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mo>⋅</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">x</mml:mi>
                    </mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>T</mml:mi>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi mathvariant="italic">true</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mo>⋅</mml:mo>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">x</mml:mi>
                    </mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi mathvariant="italic">true</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>|</mml:mo>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mn>10</mml:mn>
                <mml:mo>Å</mml:mo>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the predicted local frame (which represents the rotation <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and translation <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> of <italic toggle="yes">i</italic>th residue) and atom coordinates <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, which measures the squared error between local coordinates <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and its ground truth <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">true</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">true</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Note that the loss has a clamping value of 10 Å that washes out the loss values larger than 10 Å. In DeepFold, we introduce the weighted FAPE loss as follows:</p>
      <disp-formula id="E6">
        <label>(6)</label>
        <mml:math id="M6" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>WFAPE</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold">x</mml:mi>
                </mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>w</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>FAPE</mml:mtext>
                  <mml:mo> </mml:mo>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold">x</mml:mi>
                </mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where the weight <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is determined by following sigmoid-type function</p>
      <disp-formula id="E7">
        <label>(7)</label>
        <mml:math id="M7" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>w</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mi>v</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mi>h</mml:mi>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>in which <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the distance with maximal probability from the distogram, between <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>β</mml:mo></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> atoms of residues <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>. The hyperparameters <italic toggle="yes">v</italic>, <italic toggle="yes">h</italic> control the inflection point of the sigmoid function and an additional weighting constant, respectively. In this work, we used <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>12.0</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula> which were determined by iterative grid searches. This modified loss gives larger weight on the closer atoms.</p>
    </sec>
    <sec>
      <title>2.4 Secondary structure loss</title>
      <p>We introduce secondary structure loss in DeepFold network by implementing small multi-layer perceptrons in the structure module as shown in <xref rid="btad712-F1" ref-type="fig">Fig. 1</xref>. This network uses single representations as inputs which were obtained by IPA (Invariant Point Attention) in structure module (<xref rid="btad712-B19" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>). And they return as output the prediction results of 8-state secondary structure of each residue (<xref rid="btad712-B20" ref-type="bibr">Kabsch and Sander 1983</xref>). To train this network, we defined a loss function for the secondary structure by cross-entropy as follows:</p>
      <disp-formula id="E8">
        <label>(8)</label>
        <mml:math id="M8" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>secondary</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mi>N</mml:mi>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:munderover>
                <mml:mo>∑</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mi>N</mml:mi>
              </mml:munderover>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:munderover>
                  <mml:mo>∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mn>8</mml:mn>
                </mml:munderover>
              </mml:mrow>
              <mml:mrow>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>y</mml:mi>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>c</mml:mi>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
            <mml:mo> </mml:mo>
            <mml:mtext>log</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>c</mml:mi>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the true secondary structure of <italic toggle="yes">i-</italic>th residue with <italic toggle="yes">c</italic>-state, and <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the predicted probability that the 8-state secondary structure of the <italic toggle="yes">i-</italic>th residue is in <italic toggle="yes">c</italic>-state.</p>
    </sec>
    <sec>
      <title>2.5 Side-chain confidence loss</title>
      <p>Similarly to the plddt in AF2, we defined another confidence measure focussing on the side chains of protein structure as follows. Side chain confidence <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for each residue <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> is defined as:</p>
      <disp-formula id="E9">
        <label>(9)</label>
        <mml:math id="M9" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mo>δ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>/</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mo>δ</mml:mo>
                                  </mml:mrow>
                                  <mml:mn>0</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the difference between the true and predicted <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> angles <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">true</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">pred</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Here, <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is a reference value of angle difference which was set as <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> in this work. In order to predict <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, we implemented another multi-layer perceptron network in the structure module which returns as output the probability <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to be in the specific bin among 50 bins in the interval [0,1]. This can be compared with the true values of <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, from which a loss function can be formed. The loss function is defined as the cross-entropy loss between one-hot encoded <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and predictions:</p>
      <disp-formula id="E10">
        <label>(10)</label>
        <mml:math id="M10" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>sc</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>:</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mi>N</mml:mi>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:munderover>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi>N</mml:mi>
              </mml:munderover>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>s</mml:mi>
                </mml:msubsup>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow/>
                  <mml:mo>⊤</mml:mo>
                </mml:msup>
              </mml:mrow>
            </mml:mrow>
            <mml:mo> </mml:mo>
            <mml:mtext>log</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mi>p</mml:mi>
                        <mml:mo>^</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>s</mml:mi>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where the <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are one-hot encoded representations of <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and prediction <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively. In this work, the side chain confidence score for a single sequence is defined by the average score over all residues.</p>
      <p>With the modified loss functions and newly added loss terms, we arrive at the following combined loss <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula> which can be used for training the DeepFold model:</p>
      <disp-formula id="E11">
        <label>(11)</label>
        <mml:math id="M11" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi mathvariant="script">L</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>angle</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>WFAPE</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mn>3</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>secondary</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mn>4</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>sc</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mi mathvariant="bold">c</mml:mi>
                </mml:mrow>
                <mml:mo>⊤</mml:mo>
              </mml:msup>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>others</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where the <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>others</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>aux</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>dist</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>msa</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>resolved</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>vio</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are the other losses in AF2 with the default weights <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>0.3</mml:mn><mml:mo>,</mml:mo><mml:mn>2.0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>1.0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as they used in (<xref rid="btad712-B19" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>). <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> shows the relative weights of various loss terms in our modifications.</p>
    </sec>
    <sec>
      <title>2.6 Dataset, training, and validation</title>
      <p>We used the latest PDB database (Feb. 2022) for training. We clustered the sequences of PDB using CD-HIT with 40% sequence identity, which resulted in 31,911 protein chains. We further filtered 23,366 chains of high-resolution (with &lt; 2.5 Å) for a fine-tuning dataset. The obtained sequences were cropped to 256 and 384 residue sizes as in the AF2 for training. Five DeepFold models were selected from training with various training schedules. For all the trained models, we employed the Uni-fold (a trainable version of AF2) training system, where the trainings were started from the AF2 parameters and then further optimized in the style of transfer learning. Full details are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref>.</p>
    </sec>
    <sec>
      <title>2.7 Re-optimization by conformational space annealing</title>
      <p>Once 3D structures are inferred from the DeepFold networks, we perform global optimization using conformational space annealing (CSA) with the full atom force field, distance restraints, and side chain torsion restraints generated by the networks. Full details are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>In order to evaluate the performance of DeepFold, we conducted a blind test in the CASP15 competition. As our Group Names, we used DFolding and DFolding-server, where the latter was a server prediction protocol which was performed without the final CSA re-optimization due to the 3-day deadline. We present our results obtained from the official evaluation data, which was provided by CASP15 assessors of Single Protein and Domain Modeling category [15th Community Wide Experiment on the Critical Assessment of Techniques for Protein Structure Prediction (<ext-link xlink:href="https://predictioncenter.org/casp15/" ext-link-type="uri">https://predictioncenter.org/casp15/</ext-link>)]. Traditionally, all targets are divided into domains, which are classified as TBM and FM domains. In the CASP15, total of 109 domains, which were officially assessed, consist of 62 TBM domains (including 47 TBM-easy and 14 TBM-hard), and 47 FM domains (8 FM/TBM and 39 FM). We also present our own assessment of 55 domains (39 targets) including 27 TBM, 27 FM domains, and 1 domain that was not classified, for which native structures were publicly available.</p>
    <p>The official metric to compare the performance of all Groups is called <italic toggle="yes">sum</italic> Z-score which is a weighted sum of the Z-scores for each of the domains as in the following CASP15 assessor’s formula (<xref rid="btad712-B44" ref-type="bibr">Read and Chavali 2007</xref>, <xref rid="btad712-B29" ref-type="bibr">Mariani <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad712-B38" ref-type="bibr">Olechnovič <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad712-B10" ref-type="bibr">Croll <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad712-B32" ref-type="bibr">Millán <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad712-B43" ref-type="bibr">Pereira <italic toggle="yes">et al.</italic> 2021</xref>) [GDT-HA (Global Distance Test for High Accuracy), reLLG (Relative eLLG score), ASE (Accuracy Self Estimate), LDDT (Local Distance Difference Test), AA (CAD-score, all atoms), SG (The average value of Sphere Grinder Score), SC<inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (Side Chain Dihedral Error Score), Molprobity (Aggregated Molprobity Score), BB<inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (Backbone Dihedral Error Score), DipDiff (The average difference between the local DipScores)],</p>
    <disp-formula id="E12">
      <label>(12)</label>
      <mml:math id="M12" display="block" overflow="scroll">
        <mml:mrow>
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mi mathvariant="italic">sum</mml:mi>
                  <mml:mo> </mml:mo>
                  <mml:mi mathvariant="normal">Z</mml:mi>
                  <mml:mo>-</mml:mo>
                  <mml:mtext>score</mml:mtext>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>6</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo stretchy="true">(</mml:mo>
                  <mml:mtext>GDT-HA</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>reLLG</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>ASE</mml:mtext>
                  <mml:mo stretchy="true">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mrow>
                        <mml:mn>16</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo stretchy="true">(</mml:mo>
                  <mml:mtext>LDDT</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>AA</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>SG</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mtext>SC</mml:mtext>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>error</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="true">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mrow>
                        <mml:mn>12</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo stretchy="true">(</mml:mo>
                  <mml:mtext>Molprb</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mtext>BB</mml:mtext>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>error</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>DipDiff</mml:mtext>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>In addition to the above metric, GDT-TS is typically used as a standard measure of modeling accuracy (Global Distance Test for Tertiary Structure) to evaluate the accuracy of global backbone trace of the structure. <xref rid="btad712-F2" ref-type="fig">Figure 2</xref> illustrates the official rankings of DFolding, together with other top 50 among 132 Groups including BAKER (RosettaFold), ColabFold, NBIS-AF2-standard and OpenFold (the latter three are basically standard AF2-based protocols with modification of MSA generation). In <xref rid="btad712-F2" ref-type="fig">Fig. 2a</xref>, DFolding was ranked fourth according to the assessor’s formula, while in (b), DFolding was at the top in terms of <italic toggle="yes">sum</italic> Z-score of GDT-TS for 64 domains, classified in the TBM-easy and TBM-hard target. In the figure, DFolding-server was also included, indicating the performance difference in comparison with DFolding. Note that CSA re-optimization is not used in DFolding-server protocol due to the time limit of three-days.</p>
    <fig position="float" id="btad712-F2">
      <label>Figure 2.</label>
      <caption>
        <p>CASP15 rankings in terms of sum Z of (a) the assessor’s formula [<xref rid="E12" ref-type="disp-formula">Equation (12)</xref>] and (b) GDT-TS for TBM easy/hard targets (62 domains in total). In each figure, only top 50 out of 132 teams are shown.</p>
      </caption>
      <graphic xlink:href="btad712f2" position="float"/>
    </fig>
    <p><xref rid="btad712-T1" ref-type="table">Table 1</xref> shows the results of top 10 performing groups from the <xref rid="btad712-F2" ref-type="fig">Fig. 2a</xref>, in addition to three AF2 based methods. All metrics used in assessor’s formula are shown in the average values instead of Z-scores. Despite the differences of backbone accuracies, the values of the metrics such as SC<inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, AA, BB<inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and DipDiff are showing very little differences between groups. In particular, the value of SC<inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (which means side-chain error for protein structure models, where lower is better) is not very distinguishable in spite of a significant difference in backbone accuracy such as GDT-TS. This is because the criterion of correctness in the metric of SC<inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is too broad. Below, we will discuss our own evaluation for side-chain accuracies for 55 domains, where native structures are available in public. In the Molprobity score showing protein-likeness, DeepFold achieved a score of 0.97 (lower is better) and performed well among the top groups.</p>
    <table-wrap position="float" id="btad712-T1">
      <label>Table 1.</label>
      <caption>
        <p>The official CASP15 results of top 10 performing groups, in addition to three AF2 based methods sorted by assessor’s formula in <xref rid="E12" ref-type="disp-formula">Equation (12)</xref>.<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Rank</th>
            <th rowspan="1" colspan="1">Methods</th>
            <th rowspan="1" colspan="1">sum Z</th>
            <th rowspan="1" colspan="1">GDT-TS</th>
            <th rowspan="1" colspan="1">GDT-HA</th>
            <th rowspan="1" colspan="1">reLLG</th>
            <th rowspan="1" colspan="1">ASE</th>
            <th rowspan="1" colspan="1">LDDT</th>
            <th rowspan="1" colspan="1">AA</th>
            <th rowspan="1" colspan="1">SG</th>
            <th rowspan="1" colspan="1">SC<inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></th>
            <th rowspan="1" colspan="1">Molprobity</th>
            <th rowspan="1" colspan="1">BB<inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></th>
            <th rowspan="1" colspan="1">DipDiff</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">PEZYFoldings</td>
            <td rowspan="1" colspan="1">
              <bold>70.83</bold>
            </td>
            <td rowspan="1" colspan="1">81.89</td>
            <td rowspan="1" colspan="1">68.00</td>
            <td rowspan="1" colspan="1">12.65</td>
            <td rowspan="1" colspan="1">88.39</td>
            <td rowspan="1" colspan="1">0.79</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">90.10</td>
            <td rowspan="1" colspan="1">9.59</td>
            <td rowspan="1" colspan="1">1.34</td>
            <td rowspan="1" colspan="1">9.38</td>
            <td rowspan="1" colspan="1">0.02</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">UM-TBM</td>
            <td rowspan="1" colspan="1">68.56</td>
            <td rowspan="1" colspan="1">83.75</td>
            <td rowspan="1" colspan="1">
              <bold>69.49</bold>
            </td>
            <td rowspan="1" colspan="1">12.26</td>
            <td rowspan="1" colspan="1">89.04</td>
            <td rowspan="1" colspan="1">
              <bold>0.81</bold>
            </td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">
              <bold>92.06</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>9.42</bold>
            </td>
            <td rowspan="1" colspan="1">1.22</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">Yang-Server</td>
            <td rowspan="1" colspan="1">61.28</td>
            <td rowspan="1" colspan="1">
              <bold>83.92</bold>
            </td>
            <td rowspan="1" colspan="1">69.48</td>
            <td rowspan="1" colspan="1">12.45</td>
            <td rowspan="1" colspan="1">85.89</td>
            <td rowspan="1" colspan="1">0.79</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">91.76</td>
            <td rowspan="1" colspan="1">9.50</td>
            <td rowspan="1" colspan="1">1.36</td>
            <td rowspan="1" colspan="1">9.29</td>
            <td rowspan="1" colspan="1">0.02</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">4</td>
            <td rowspan="1" colspan="1">DFolding (DeepFold)</td>
            <td rowspan="1" colspan="1">61.07</td>
            <td rowspan="1" colspan="1">80.33</td>
            <td rowspan="1" colspan="1">66.39</td>
            <td rowspan="1" colspan="1">10.53</td>
            <td rowspan="1" colspan="1">87.22</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">88.79</td>
            <td rowspan="1" colspan="1">9.44</td>
            <td rowspan="1" colspan="1">0.97</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.03</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">5</td>
            <td rowspan="1" colspan="1">Yang</td>
            <td rowspan="1" colspan="1">59.01</td>
            <td rowspan="1" colspan="1">83.07</td>
            <td rowspan="1" colspan="1">68.92</td>
            <td rowspan="1" colspan="1">
              <bold>12.99</bold>
            </td>
            <td rowspan="1" colspan="1">86.13</td>
            <td rowspan="1" colspan="1">0.79</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">91.01</td>
            <td rowspan="1" colspan="1">9.51</td>
            <td rowspan="1" colspan="1">1.38</td>
            <td rowspan="1" colspan="1">9.29</td>
            <td rowspan="1" colspan="1">0.02</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">6</td>
            <td rowspan="1" colspan="1">McGuffin</td>
            <td rowspan="1" colspan="1">49.73</td>
            <td rowspan="1" colspan="1">79.82</td>
            <td rowspan="1" colspan="1">66.34</td>
            <td rowspan="1" colspan="1">11.28</td>
            <td rowspan="1" colspan="1">85.22</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">88.24</td>
            <td rowspan="1" colspan="1">9.43</td>
            <td rowspan="1" colspan="1">1.59</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">7</td>
            <td rowspan="1" colspan="1">MULTICOM</td>
            <td rowspan="1" colspan="1">48.83</td>
            <td rowspan="1" colspan="1">80.20</td>
            <td rowspan="1" colspan="1">66.41</td>
            <td rowspan="1" colspan="1">11.99</td>
            <td rowspan="1" colspan="1">75.55</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">89.98</td>
            <td rowspan="1" colspan="1">9.44</td>
            <td rowspan="1" colspan="1">1.38</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">8</td>
            <td rowspan="1" colspan="1">MULTICOM_refine</td>
            <td rowspan="1" colspan="1">48.83</td>
            <td rowspan="1" colspan="1">79.25</td>
            <td rowspan="1" colspan="1">65.46</td>
            <td rowspan="1" colspan="1">11.37</td>
            <td rowspan="1" colspan="1">85.75</td>
            <td rowspan="1" colspan="1">0.79</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">89.75</td>
            <td rowspan="1" colspan="1">9.43</td>
            <td rowspan="1" colspan="1">1.16</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">9</td>
            <td rowspan="1" colspan="1">BAKER</td>
            <td rowspan="1" colspan="1">47.99</td>
            <td rowspan="1" colspan="1">79.33</td>
            <td rowspan="1" colspan="1">63.81</td>
            <td rowspan="1" colspan="1">8.59</td>
            <td rowspan="1" colspan="1">85.72</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">0.75</td>
            <td rowspan="1" colspan="1">89.20</td>
            <td rowspan="1" colspan="1">9.46</td>
            <td rowspan="1" colspan="1">
              <bold>0.75</bold>
            </td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.03</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">10</td>
            <td rowspan="1" colspan="1">MULTICOM_human</td>
            <td rowspan="1" colspan="1">47.90</td>
            <td rowspan="1" colspan="1">79.99</td>
            <td rowspan="1" colspan="1">66.13</td>
            <td rowspan="1" colspan="1">11.08</td>
            <td rowspan="1" colspan="1">75.81</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">89.68</td>
            <td rowspan="1" colspan="1">9.44</td>
            <td rowspan="1" colspan="1">1.38</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">17</td>
            <td rowspan="1" colspan="1">ColabFold</td>
            <td rowspan="1" colspan="1">44.02</td>
            <td rowspan="1" colspan="1">75.36</td>
            <td rowspan="1" colspan="1">62.33</td>
            <td rowspan="1" colspan="1">10.77</td>
            <td rowspan="1" colspan="1">89.75</td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">0.75</td>
            <td rowspan="1" colspan="1">86.57</td>
            <td rowspan="1" colspan="1">9.43</td>
            <td rowspan="1" colspan="1">1.34</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">45</td>
            <td rowspan="1" colspan="1">NBIS-AF2-standard</td>
            <td rowspan="1" colspan="1">34.63</td>
            <td rowspan="1" colspan="1">75.81</td>
            <td rowspan="1" colspan="1">61.74</td>
            <td rowspan="1" colspan="1">9.59</td>
            <td rowspan="1" colspan="1">
              <bold>89.84</bold>
            </td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">0.75</td>
            <td rowspan="1" colspan="1">87.21</td>
            <td rowspan="1" colspan="1">9.44</td>
            <td rowspan="1" colspan="1">1.28</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">53</td>
            <td rowspan="1" colspan="1">OpenFold</td>
            <td rowspan="1" colspan="1">33.25</td>
            <td rowspan="1" colspan="1">73.71</td>
            <td rowspan="1" colspan="1">60.34</td>
            <td rowspan="1" colspan="1">9.13</td>
            <td rowspan="1" colspan="1">87.79</td>
            <td rowspan="1" colspan="1">0.74</td>
            <td rowspan="1" colspan="1">0.74</td>
            <td rowspan="1" colspan="1">84.72</td>
            <td rowspan="1" colspan="1">9.53</td>
            <td rowspan="1" colspan="1">1.72</td>
            <td rowspan="1" colspan="1">9.30</td>
            <td rowspan="1" colspan="1">0.00</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <label>a</label>
          <p>All of the 11 metrics in the formula are also shown as the average (over all the target) of the raw scores. References for each of the predictors listed are as follows: PEZYFoldings (<xref rid="btad712-B37" ref-type="bibr">Oda 2023</xref>), UM-TBM (<xref rid="btad712-B42" ref-type="bibr">Peng <italic toggle="yes">et al.</italic> 2023</xref>), Yang-Server (<xref rid="btad712-B64" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2023</xref>), McGuffin (<xref rid="btad712-B30" ref-type="bibr">McGuffin <italic toggle="yes">et al.</italic> 2023</xref>), MULTICOM (<xref rid="btad712-B27" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2023</xref>), ColabFold (<xref rid="btad712-B34" ref-type="bibr">Mirdita <italic toggle="yes">et al.</italic> 2022</xref>), and OpenFold (<xref rid="btad712-B2" ref-type="bibr">Ahdritz <italic toggle="yes">et al.</italic> 2022</xref>). The top scores in each metric are marked in bold.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p><xref rid="btad712-F3" ref-type="fig">Figure 3</xref> shows the effect of CSA re-optimization by comparing DFolding (<italic toggle="yes">y</italic>-axis) versus DFolding-server (<italic toggle="yes">x</italic>-axis) in terms of GDT-TS, LDDT, SC error, and Molprobity, where we used the official metrics provided by CASP15 assessors. DFolding prediction exhibits better performance in average scores for GDT-TS, LDDT, and Molprobity, while difference of SC<inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is very minor. It is due to the same reason mentioned above that the criterion of side-chain error is too broad. In GDT-TS, DFolding performed well for the relatively hard targets (GDT-TS less than about 70), which can be attributed to the result of CSA re-optimization. It also shows significant improvement in Molprobity score.</p>
    <fig position="float" id="btad712-F3">
      <label>Figure 3.</label>
      <caption>
        <p>Comparison between the accuracies of DFolding (<italic toggle="yes">y</italic>-axis) versus DFolding-server (without CSA re-optimization, <italic toggle="yes">x</italic>-axis). The CASP15 official results of GDT-TS, LDDT, SC error, and Molprobity are used. Higher values are better for GDT-TS, LDDT, while lower values are better for SC<inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and Molprobity. All numbers within the figures are average values over 109 domains.</p>
      </caption>
      <graphic xlink:href="btad712f3" position="float"/>
    </fig>
    <p>We now apply further analysis of our own on the performance of DeepFold with the 55 domains for which the native structures are available. In <xref rid="btad712-T2" ref-type="table">Table 2</xref>, GDT-TS and GDT-HA were calculated by using the TM-score program instead of using the official data. Side-chain accuracies of <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> were calculated by using 10° criterion of correctness, instead of using SC<inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> used in the official results. All values presented in the table are cumulative Z-scores for each metric, in line with the CASP15 assessor’s methodology (higher values are better). The results from DFolding demonstrate a balanced performance in both backbone and side-chain metrics when compared to leading groups. The table shows that the sum Z-score of DFolding in Molprobity value is significantly higher than all the other top performing groups. Furthermore, the table shows that DFolding achieved higher scores in LDDT, GDT-TS, and GDT-HA than the well-known methods such as AF2, BAKER, ColabFold, and OpenFold.</p>
    <table-wrap position="float" id="btad712-T2">
      <label>Table 2.</label>
      <caption>
        <p>CASP15 results of top 10 teams in <xref rid="btad712-T1" ref-type="table">Table 1</xref>, evaluated on 55 domains, for which the native structures are publicly available.<xref rid="tblfn2" ref-type="table-fn"><sup>a</sup></xref></p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Methods</th>
            <th rowspan="1" colspan="1">LDDT</th>
            <th rowspan="1" colspan="1">GDT-TS</th>
            <th rowspan="1" colspan="1">GDT-HA</th>
            <th rowspan="1" colspan="1">
              <inline-formula id="IE67">
                <mml:math id="IM67" display="inline" overflow="scroll">
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>χ</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="italic">acc</mml:mi>
                        </mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </th>
            <th rowspan="1" colspan="1">
              <inline-formula id="IE68">
                <mml:math id="IM68" display="inline" overflow="scroll">
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>χ</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="italic">acc</mml:mi>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </th>
            <th rowspan="1" colspan="1">Molprobity</th>
            <th rowspan="1" colspan="1">counts</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">PEZYFoldings</td>
            <td rowspan="1" colspan="1">38.19</td>
            <td rowspan="1" colspan="1">51.80</td>
            <td rowspan="1" colspan="1">54.93</td>
            <td rowspan="1" colspan="1">27.73</td>
            <td rowspan="1" colspan="1">27.22</td>
            <td rowspan="1" colspan="1">26.99</td>
            <td rowspan="1" colspan="1">53</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">UM-TBM</td>
            <td rowspan="1" colspan="1">36.41</td>
            <td rowspan="1" colspan="1">47.91</td>
            <td rowspan="1" colspan="1">53.86</td>
            <td rowspan="1" colspan="1">27.49</td>
            <td rowspan="1" colspan="1">31.27</td>
            <td rowspan="1" colspan="1">27.71</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Yang-Server</td>
            <td rowspan="1" colspan="1">24.69</td>
            <td rowspan="1" colspan="1">49.19</td>
            <td rowspan="1" colspan="1">52.44</td>
            <td rowspan="1" colspan="1">35.14</td>
            <td rowspan="1" colspan="1">35.80</td>
            <td rowspan="1" colspan="1">17.34</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <bold>DFolding (DeepFold)</bold>
            </td>
            <td rowspan="1" colspan="1">31.98</td>
            <td rowspan="1" colspan="1">46.76</td>
            <td rowspan="1" colspan="1">48.99</td>
            <td rowspan="1" colspan="1">29.00</td>
            <td rowspan="1" colspan="1">29.42</td>
            <td rowspan="1" colspan="1">50.51</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Yang</td>
            <td rowspan="1" colspan="1">22.78</td>
            <td rowspan="1" colspan="1">45.03</td>
            <td rowspan="1" colspan="1">47.66</td>
            <td rowspan="1" colspan="1">33.65</td>
            <td rowspan="1" colspan="1">40.38</td>
            <td rowspan="1" colspan="1">24.81</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">McGuffin</td>
            <td rowspan="1" colspan="1">29.75</td>
            <td rowspan="1" colspan="1">44.32</td>
            <td rowspan="1" colspan="1">49.21</td>
            <td rowspan="1" colspan="1">24.56</td>
            <td rowspan="1" colspan="1">29.05</td>
            <td rowspan="1" colspan="1">17.03</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MULTICOM</td>
            <td rowspan="1" colspan="1">29.41</td>
            <td rowspan="1" colspan="1">38.33</td>
            <td rowspan="1" colspan="1">43.88</td>
            <td rowspan="1" colspan="1">22.78</td>
            <td rowspan="1" colspan="1">27.23</td>
            <td rowspan="1" colspan="1">24.20</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MULTICOM_refine</td>
            <td rowspan="1" colspan="1">29.70</td>
            <td rowspan="1" colspan="1">28.98</td>
            <td rowspan="1" colspan="1">30.73</td>
            <td rowspan="1" colspan="1">23.98</td>
            <td rowspan="1" colspan="1">23.32</td>
            <td rowspan="1" colspan="1">31.21</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">BAKER</td>
            <td rowspan="1" colspan="1">15.93</td>
            <td rowspan="1" colspan="1">30.73</td>
            <td rowspan="1" colspan="1">27.01</td>
            <td rowspan="1" colspan="1">35.14</td>
            <td rowspan="1" colspan="1">32.44</td>
            <td rowspan="1" colspan="1">28.81</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MULTICOM_human</td>
            <td rowspan="1" colspan="1">27.20</td>
            <td rowspan="1" colspan="1">37.32</td>
            <td rowspan="1" colspan="1">41.77</td>
            <td rowspan="1" colspan="1">22.03</td>
            <td rowspan="1" colspan="1">22.98</td>
            <td rowspan="1" colspan="1">24.34</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">ColabFold</td>
            <td rowspan="1" colspan="1">24.93</td>
            <td rowspan="1" colspan="1">20.42</td>
            <td rowspan="1" colspan="1">21.60</td>
            <td rowspan="1" colspan="1">21.40</td>
            <td rowspan="1" colspan="1">22.57</td>
            <td rowspan="1" colspan="1">21.17</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">NBIS-AF2-standard</td>
            <td rowspan="1" colspan="1">21.52</td>
            <td rowspan="1" colspan="1">14.87</td>
            <td rowspan="1" colspan="1">14.57</td>
            <td rowspan="1" colspan="1">22.69</td>
            <td rowspan="1" colspan="1">20.29</td>
            <td rowspan="1" colspan="1">23.74</td>
            <td rowspan="1" colspan="1">54</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">OpenFold</td>
            <td rowspan="1" colspan="1">16.46</td>
            <td rowspan="1" colspan="1">14.09</td>
            <td rowspan="1" colspan="1">15.16</td>
            <td rowspan="1" colspan="1">18.03</td>
            <td rowspan="1" colspan="1">21.07</td>
            <td rowspan="1" colspan="1">19.67</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn2">
          <label>a</label>
          <p>All scores in the table are Z-sum scores. GDT-TS and GDT-HA in the table are calculated by TM-score (<xref rid="btad712-B63" ref-type="bibr">Zhang and Skolnick 2005</xref>). The top scores in each metric are marked in bold.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p><xref rid="btad712-F4" ref-type="fig">Figure 4</xref> shows a comparison between the accuracies of DFolding and DFolding-server for 55 domains. On average, DFolding outperforms DFolding-server in terms of GDT-TS and Molprobity value, while the sidechain scores are similar in terms of <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">acc</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">acc</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. This indicates that CSA re-optimization process of DFolding resulted in a minor improvement for the overall structure of the 55 protein domains.</p>
    <fig position="float" id="btad712-F4">
      <label>Figure 4.</label>
      <caption>
        <p>Comparison between the accuracies of DFolding (<italic toggle="yes">y</italic>-axis) and DFolding-server (<italic toggle="yes">x</italic>-axis) for publicly available 55 domains. All numbers within the figures are average values over 55 domains. Lower value is better for Molprobity.</p>
      </caption>
      <graphic xlink:href="btad712f4" position="float"/>
    </fig>
    <p>As mentioned in the Section 2, DFolding used CRFalign for the generation of template features. We can evaluate the quality of template features for 55 domains where the native structures are available. <xref rid="btad712-F5" ref-type="fig">Figure 5</xref> shows the difference between template features of DFolding and those of AF2. In order to show the difference between DFolding and AF2 in terms of the quality of templates, we used the best template among the (up to) four templates for each target. <xref rid="btad712-F5" ref-type="fig">Figure 5a</xref> shows the TM-scores of the templates of DFolding in comparison with those of AF2’s templates. Average TM-score of DFolding templates was 0.6042 while that of AF2 was 0.5521. <xref rid="btad712-F5" ref-type="fig">Figure 5b</xref> shows a comparison of the quality of CRFalign alignments and those of AF2’s. The alignment quality was measured based on the pairwise distance of residues. First, for the native sequence, collect pairs of residues and measure pairwise distances. The collected pairs are &gt;3 in sequence separation, with mutual distances &lt;8 Å. Second, for the residue pairs at the same location with the native sequence, pairwise distance is calculated for the aligned template sequence. Then, we calculate the ratio of the template residue pairs that have a similar distance to the native residue pairs’ distance. If the difference of a residue pair distance between native and template is less than a threshold, we label that the template residue pair distance is similar to that of native’s. In the case of (b), we set the threshold as 3 Å. We can see that the alignment quality of DFolding using CRFalign shows significant improvement over that of AF2, especially in the cases of hard targets (when the ratio of alignment quality is less than about 0.7). However, because the predicted structure is greatly affected by the quality of the MSA, the superiority of template information does not guarantee the improvement of the final structure. To further verify this, we added the final results of the 18 domains in <xref rid="btad712-F5" ref-type="fig">Fig. 5b</xref> where the difference in values is &gt;0.15 in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S7</xref>. For example, Target T1123, which belongs to the FM/TBM class, was among the relatively well-predicted cases. As illustrated in <xref rid="btad712-F6" ref-type="fig">Fig. 6a</xref>, DFolding ranked first with a GDT-TS score of 86.80, while DFolding-server was placed in the third position with a GDT-TS score of 83.64, outperforming other groups. <xref rid="btad712-F6" ref-type="fig">Figure 6c</xref> shows the best template, 5EWO (<xref rid="btad712-B60" ref-type="bibr">York <italic toggle="yes">et al.</italic> 2016</xref>), which was found using CRFalign. The template exhibited higher structural similarity to the native structure (TM-score = 0.69) than AF2 (TM-score = 0.31). <xref rid="btad712-F6" ref-type="fig">Figure 6b</xref> displays the predictions of DFolding and AF2 in cartoon style with the native structure. It can be observed that our models successfully generated <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>-sheets (shown in blue color) near the C-terminal, while AF2 failed to predict that region.</p>
    <fig position="float" id="btad712-F5">
      <label>Figure 5.</label>
      <caption>
        <p>Comparison of the templates of the 55 domains in CASP15. (a) TM-score comparison is shown between the templates found by DeepFold (through CRFalign) versus the ones found by AF2. Each point represents the template with the highest TM-score obtained by the respective method for a given target. Orange colors are the domains with a lower TM-score for CRFalign than the AF2 method, and cyan colors indicate the domains for which the same templates are found by both methods. Red color is the target T1123. (b) A comparison of the alignment qualities of CRFalign and AF2 is shown. All numbers within the figures are average values over 55 domains. The dotted line is indicating a difference <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mo>&gt;</mml:mo></mml:math></inline-formula> 0.15, and as a result, we had significantly better template information for 18 domains.</p>
      </caption>
      <graphic xlink:href="btad712f5" position="float"/>
    </fig>
    <fig position="float" id="btad712-F6">
      <label>Figure 6.</label>
      <caption>
        <p>The target T1123 in CASP15 for which DeepFold predictions showed the best GDT-TS scores. (a) DeepFold human and server models ranked at the top three in a row. (b) The predicted 3D structures of T1123 and the native structure (colored as green). Compared to AF2, the DeepFold prediction correctly predicts helix and <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>-sheets near the C-terminal region, highlighted in blue. (c) The template 5EWO obtained by CRFalign shows a high structural similarity to the native structures (TM = 0.69) compared with the template in AF2 (TM = 0.31).</p>
      </caption>
      <graphic xlink:href="btad712f6" position="float"/>
    </fig>
    <sec>
      <title>3.1 What went wrong</title>
      <p>DFolding failed to generate correct fold for some targets especially for T1125 and T1130. T1125 was a challenging target, likely due to its large size of 1200 residues, which consists of 6 domains (five FM domains and one TBM-hard). Only a few groups achieved good scores (<ext-link xlink:href="https://predictioncenter.org/casp15/results.cgi?view=tb-sel" ext-link-type="uri">https://predictioncenter.org/casp15/results.cgi?view=tb-sel</ext-link>). For T1125-D1, the average GDT-TS of all groups was 28.44, but that of top three groups had scores around 80. The Neff score of MSA [i.e. represents a measure of the diversity or the effective number of sequences within the alignment, with higher scores indicating a more diverse set of sequences in the MSA (<xref rid="btad712-B31" ref-type="bibr">Meier and Söding 2014</xref>).] generated by AF2 standard was 1.39 with only five sequences including the target itself, resulting in low plddt scores ranging from 0.39 to 0.44. For the single domain target T1130 with 198 residues (FM domain), DFolding exhibited poor performance with 29.40 of GDT-TS along with most of the groups, while only 3 groups achieved around 95. For this target, the Neff score of AF2 is 0.0 with no additional homologous sequences. And no template structures were found as can be expected for an FM domain. It is highly probable that the three successful groups identified high-quality MSAs through their extended efforts for the target. We also attempted to generate MSAs using other available web servers, but with limited success. As a result, it appears that MSA quality is crucial for the successful prediction of structures using AF2-based methods.</p>
    </sec>
    <sec>
      <title>3.2 What went right</title>
      <p>We found that the improvement of DeepFold’s prediction accuracy can be attributed to the following three elements: modified loss functions, choice of better templates, and CSA re-optimizations. To begin with, the positive effect of modified loss functions is confirmed by ablation studies, as shown in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref>. To summarize, modified loss functions improved the side-chain accuracy while maintaining the backbone accuracy. The choice of better templates and alignments (partly through CRFalign) improved the backbone accuracy of the specific targets. Finally, CSA re-optimization improved backbone accuracy and molprobity scores through structure optimization.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>In this work, we have presented DeepFold, a pipeline for predicting protein structures. Our primary objective was to improve the accuracy of backbone and side-chain prediction, and we achieved this by making several modifications to the AF2 pipeline. These modifications included optimizing the loss functions with focus on torsion angle losses and additional loss functions introduced to improve side chain accuracy and secondary structure prediction with updated template features. Further re-optimization was performed by CSA using a molecular mechanics energy function which integrates the potential energies obtained from distogram and side-chain prediction. In the blind test at the CASP15 competition, DeepFold improves the details of the protein structure in both backbone and side-chains, ranking fourth in the category of Single Protein and Domain Modeling (109 domains). In addition, DeepFold’s structure prediction showed the best results in terms of backbone accuracy of GDT-TS for the targets in the TBM class (62 among 109 domains), which are more important in practical applications. Our thorough analysis of 55 domains with publicly available ground-truth structures revealed that DeepFold showed the best side-chain accuracy and Molprobity scores in the top-performing groups. It can be seen that the effect of modification and retraining of the DeepFold network and the final re-optimization have made significant differences. In particular, it can be seen that re-optimization further improves the details of protein structure such as backbone, side-chain and Molprobity.</p>
    <p>There remain limitations in predicting certain targets, such as very large target like T1125, and T1130 both with low-quality MSAs. This is due to the well-known fact that the performance of AF2-based methods is heavily dependent on the quality of MSAs. It is essential to evaluate the quality of the obtained MSA and enhance the quality of low-quality MSAs by employing techniques such as protein language models (<xref rid="btad712-B26" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>) or generative models (<xref rid="btad712-B28" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2022</xref>). Furthermore, in order to predict larger protein structures properly, reliable protein domain parsing must be considered.</p>
    <p>In conclusion, our work on DeepFold represents an improvement upon the foundation laid by AF2. Through our modifications to the AF2 pipeline, we have achieved higher accuracy in terms of backbones and side-chains. We believe that our work has advanced the field of protein structure prediction, which we expect to be a valuable tool for the protein modeling community.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad712_Supplementary_Data</label>
      <media xlink:href="btad712_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>We thank the KIAS Center for Advanced Computation for providing computing resources.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government (MSIT) [2021-0-02068, 2020-0-01373]; the Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Science and ICT (MSIT) [NRF-2018R1D1A1B07049312] and the 2023 KT ICT AI2XL Laboratory R&amp;D Fund project funded by KT [KT award B230000177].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article is available at <ext-link xlink:href="https://github.com/newtonjoo/deepfold" ext-link-type="uri">https://github.com/newtonjoo/deepfold</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad712-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adhikari</surname><given-names>B</given-names></string-name>, <string-name><surname>Hou</surname><given-names>J</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Protein contact prediction by integrating deep multiple sequence alignments, coevolution and machine learning</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017</year>;<volume>86</volume>:<fpage>84</fpage>–<lpage>96</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ahdritz</surname><given-names>G</given-names></string-name>, <string-name><surname>Bouatta</surname><given-names>N</given-names></string-name>, <string-name><surname>Kadyan</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal> Openfold: retraining alphafold2 yields new insights into its learning mechanisms and capacity for generalization. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.11.20.517210</pub-id>, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>, <string-name><surname>Madden</surname><given-names>TL</given-names></string-name>, <string-name><surname>Schäffer</surname><given-names>AA</given-names></string-name></person-group><etal>et al</etal><article-title>Gapped blast and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res</source><year>1997</year>;<volume>25</volume>:<fpage>3389</fpage>–<lpage>402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anfinsen</surname><given-names>CB.</given-names></string-name></person-group><article-title>Principles that govern the folding of protein chains</article-title>. <source>Science</source><year>1973</year>;<volume>181</volume>:<fpage>223</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">4124164</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baek</surname><given-names>M</given-names></string-name>, <string-name><surname>DiMaio</surname><given-names>F</given-names></string-name>, <string-name><surname>Anishchenko</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>Accurate prediction of protein structures and interactions using a three-track neural network</article-title>. <source>Science</source><year>2021</year>;<volume>373</volume>:<fpage>871</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">34282049</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bahdanau</surname><given-names>D</given-names></string-name>, <string-name><surname>Cho</surname><given-names>K</given-names></string-name>, <string-name><surname>Bengio</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal> Neural machine translation by jointly learning to align and translate. arXiv, arXiv:1409.0473, <year>2014</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Browne</surname><given-names>WJ</given-names></string-name>, <string-name><surname>North</surname><given-names>ACT</given-names></string-name>, <string-name><surname>Phillips</surname><given-names>DC</given-names></string-name></person-group><etal>et al</etal><article-title>A possible three-dimensional structure of bovine <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>-lactalbumin based on that of hen’s egg-white lysozyme</article-title>. <source>J Mol Biol</source><year>1969</year>;<volume>42</volume>:<fpage>65</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">5817651</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Case</surname><given-names>DA</given-names></string-name>, <string-name><surname>Cheatham</surname><given-names>TE</given-names></string-name>, <string-name><surname>Darden</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>The amber biomolecular simulation programs</article-title>. <source>J Comput Chem</source><year>2005</year>;<volume>26</volume>:<fpage>1668</fpage>–<lpage>88</lpage>.<pub-id pub-id-type="pmid">16200636</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>S</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>X</given-names></string-name>, <string-name><surname>Lu</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal> Fastfold: reducing alphafold training time from 11 days to 67 hours. arXiv, arXiv: 2203.00854, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Croll</surname><given-names>TI</given-names></string-name>, <string-name><surname>Sammito</surname><given-names>MD</given-names></string-name>, <string-name><surname>Kryshtafovych</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Evaluation of template-based modeling in CASP13</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2019</year>;<volume>87</volume>:<fpage>1113</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kollman</surname><given-names>PA.</given-names></string-name></person-group><article-title>Pathways to a protein folding intermediate observed in a 1-microsecond simulation in aqueous solution</article-title>. <source>Science</source><year>1998</year>;<volume>282</volume>:<fpage>740</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">9784131</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ekeberg</surname><given-names>M</given-names></string-name>, <string-name><surname>Lövkvist</surname><given-names>C</given-names></string-name>, <string-name><surname>Lan</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Improved contact prediction in proteins: using pseudolikelihoods to infer potts models</article-title>. <source>Phys Rev E</source><year>2013</year>;<volume>87</volume>:<fpage>012707</fpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fang</surname><given-names>X</given-names></string-name>, <string-name><surname>Wang</surname><given-names>F</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>A method for multiple-sequence-alignment-free protein structure prediction using a protein language model</article-title>. <source>Nat Mach Intell</source><year>2023</year>;<volume>5</volume>:<fpage>1087</fpage>–<lpage>96</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ho</surname><given-names>J</given-names></string-name>, <string-name><surname>Jain</surname><given-names>A</given-names></string-name>, <string-name><surname>Abbeel</surname><given-names>P.</given-names></string-name></person-group> Denoising diffusion probabilistic models. <italic toggle="yes">Adv Neural Info Process Syst</italic> 2020;<volume>33</volume>:<fpage>6840</fpage>–<lpage>51</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hong</surname><given-names>SH</given-names></string-name>, <string-name><surname>Joung</surname><given-names>I</given-names></string-name>, <string-name><surname>Flores-Canales</surname><given-names>JC</given-names></string-name></person-group><etal>et al</etal><article-title>Protein structure modeling and refinement by global optimization in CASP12</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017</year>;<volume>86</volume>:<fpage>122</fpage>–<lpage>35</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>J</given-names></string-name>, <string-name><surname>Rauscher</surname><given-names>S</given-names></string-name>, <string-name><surname>Nawrocki</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>CHARMM36m: an improved force field for folded and intrinsically disordered proteins</article-title>. <source>Nat Methods</source><year>2016</year>;<volume>14</volume>:<fpage>71</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">27819658</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Johnson</surname><given-names>LS</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR</given-names></string-name>, <string-name><surname>Portugaly</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Hidden markov model speed heuristic and iterative hmm search procedure</article-title>. <source>BMC Bioinformatics</source><year>2010</year>;<volume>11</volume>:<fpage>431</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">20718988</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Joo</surname><given-names>K</given-names></string-name>, <string-name><surname>Lee</surname><given-names>J</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>High accuracy template based modeling by global optimization</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2007</year>;<volume>69</volume>:<fpage>83</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Highly accurate protein structure prediction with alphafold</article-title>. <source>Nature</source><year>2021</year>;<volume>596</volume>:<fpage>583</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kabsch</surname><given-names>W</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C.</given-names></string-name></person-group><article-title>Dictionary of protein secondary structure: pattern recognition of hydrogen-bonded and geometrical features</article-title>. <source>Biopolymers</source><year>1983</year>;<volume>22</volume>:<fpage>2577</fpage>–<lpage>637</lpage>.<pub-id pub-id-type="pmid">6667333</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krogh</surname><given-names>A</given-names></string-name>, <string-name><surname>Brown</surname><given-names>M</given-names></string-name>, <string-name><surname>Mian</surname><given-names>IS</given-names></string-name></person-group><etal>et al</etal><article-title>Hidden Markov Models in computational biology: applications to protein modeling</article-title>. <source>J Mol Biol</source><year>1994</year>;<volume>235</volume>:<fpage>1501</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">8107089</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kwon</surname><given-names>S</given-names></string-name>, <string-name><surname>Won</surname><given-names>J</given-names></string-name>, <string-name><surname>Kryshtafovych</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Assessment of protein model structure accuracy estimation in CASP14: old and new challenges</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2021</year>;<volume>89</volume>:<fpage>1940</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>J</given-names></string-name>, <string-name><surname>Scheraga</surname><given-names>HA</given-names></string-name>, <string-name><surname>Rackovsky</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>New optimization method for conformational energy calculations on polypeptides: conformational space annealing</article-title>. <source>J Comput Chem</source><year>1997</year>;<volume>18</volume>:<fpage>1222</fpage>–<lpage>32</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Joo</surname><given-names>K</given-names></string-name>, <string-name><surname>Sim</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Crfalign: a sequence-structure alignment of proteins based on a combination of hmm-hmm comparison and conditional random fields</article-title>. <source>Molecules</source><year>2022</year>;<volume>27</volume>:<fpage>3711</fpage>.<pub-id pub-id-type="pmid">35744836</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B25">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Uni-fold: an open-source platform for developing protein folding models beyond alphafold</article-title>. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.08.04.502811</pub-id>, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Z</given-names></string-name>, <string-name><surname>Akin</surname><given-names>H</given-names></string-name>, <string-name><surname>Rao</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>. <source>Science</source><year>2023</year>;<volume>379</volume>:<fpage>1123</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">36927031</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Guo</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wu</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Improving alphafold2-based protein tertiary structure prediction with multicom in CASP15</article-title>. <source>Commun Chem</source><year>2023</year>;<volume>6</volume>:<fpage>188</fpage>.<pub-id pub-id-type="pmid">37679431</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B28">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>L</given-names></string-name>, <string-name><surname>Liu</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal> De novo protein backbone generation based on diffusion with structured priors and adversarial training. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.12.17.520847</pub-id>, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mariani</surname><given-names>V</given-names></string-name>, <string-name><surname>Kiefer</surname><given-names>F</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Assessment of template based protein structure predictions in CASP9</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2011</year>;<volume>79</volume>:<fpage>37</fpage>–<lpage>58</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McGuffin</surname><given-names>LJ</given-names></string-name>, <string-name><surname>Edmunds</surname><given-names>NS</given-names></string-name>, <string-name><surname>Genc</surname><given-names>AG</given-names></string-name></person-group><etal>et al</etal><article-title>Prediction of protein structures, functions and interactions using the intFOLD7, multifold and modfolddock servers</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>W274</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">37102670</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meier</surname><given-names>A</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J.</given-names></string-name></person-group><article-title>Context similarity scoring improves protein sequence alignments in the midnight zone</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>31</volume>:<fpage>674</fpage>–<lpage>81</lpage>.<pub-id pub-id-type="pmid">25338715</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Millán</surname><given-names>C</given-names></string-name>, <string-name><surname>Keegan</surname><given-names>RM</given-names></string-name>, <string-name><surname>Pereira</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Assessing the utility of CASP14 models for molecular replacement</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2021</year>;<volume>89</volume>:<fpage>1752</fpage>–<lpage>69</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mirdita</surname><given-names>M</given-names></string-name>, <string-name><surname>von den Driesch</surname><given-names>L</given-names></string-name>, <string-name><surname>Galiez</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Uniclust databases of clustered and deeply annotated protein sequences and alignments</article-title>. <source>Nucleic Acids Res</source><year>2017</year>;<volume>45</volume>:<fpage>D170</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">27899574</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mirdita</surname><given-names>M</given-names></string-name>, <string-name><surname>Schütze</surname><given-names>K</given-names></string-name>, <string-name><surname>Moriwaki</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Colabfold: making protein folding accessible to all</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>679</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">35637307</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morcos</surname><given-names>F</given-names></string-name>, <string-name><surname>Pagnani</surname><given-names>A</given-names></string-name>, <string-name><surname>Lunt</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>. <source>Proc Natl Acad Sci USA</source><year>2011</year>;<volume>108</volume>:<fpage>E1293</fpage>–<lpage>301</lpage>.<pub-id pub-id-type="pmid">22106262</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B36">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Nolle</surname><given-names>T</given-names></string-name>, <string-name><surname>Seeliger</surname><given-names>A</given-names></string-name>, <string-name><surname>Thoma</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal> Deepalign: alignment-based process anomaly correction using recurrent neural networks. In: Dustdar S, Yu E, Salinesi C et al. (eds), <italic toggle="yes">Advanced Information Systems Engineering: 32nd International Conference, CAiSE 2020</italic>, June 8–12, 2020. Grenoble, France: Springer, <year>2020</year>, <fpage>319</fpage>–<lpage>33</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oda</surname><given-names>T.</given-names></string-name></person-group><article-title>Improving protein structure prediction with extended sequence similarity searches and deep-learning-based refinement in CASP15</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2023</year>;<volume>91</volume>:<fpage>1712</fpage>–<lpage>23</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Olechnovič</surname><given-names>K</given-names></string-name>, <string-name><surname>Kulberkytė</surname><given-names>E</given-names></string-name>, <string-name><surname>Venclovas</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Cad-score: a new contact area difference-based function for evaluation of protein structural models</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2013</year>;<volume>81</volume>:<fpage>149</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ovchinnikov</surname><given-names>S</given-names></string-name>, <string-name><surname>Park</surname><given-names>H</given-names></string-name>, <string-name><surname>Kim</surname><given-names>DE</given-names></string-name></person-group><etal>et al</etal><article-title>Protein structure prediction using rosetta in CASP12</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017</year>;<volume>86</volume>:<fpage>113</fpage>–<lpage>21</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pearce</surname><given-names>R</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name></person-group><article-title>Toward the solution of the protein structure prediction problem</article-title>. <source>J Biol Chem</source><year>2021</year>;<volume>297</volume>:<fpage>100870</fpage>.<pub-id pub-id-type="pmid">34119522</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B41">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>J</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J.</given-names></string-name></person-group> Boosting protein threading accuracy. In: Batzoglou S (ed.), <italic toggle="yes">Research in Computational Molecular Biology: 13th Annual International Conference, RECOMB 2009</italic>, May 18–21, 2009. Tucson, AZ, USA: Springer, <year>2009</year>, <fpage>31</fpage>–<lpage>45</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Hong</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Improved protein structure prediction with trrosettaX2, alphafold2, and optimized msas in CASP15</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2023</year>;<volume>91</volume>:<fpage>1704</fpage>–<lpage>11</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pereira</surname><given-names>J</given-names></string-name>, <string-name><surname>Simpkin</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Hartmann</surname><given-names>MD</given-names></string-name></person-group><etal>et al</etal><article-title>High-accuracy protein structure prediction in CASP14</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2021</year>;<volume>89</volume>:<fpage>1687</fpage>–<lpage>99</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Read</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Chavali</surname><given-names>G.</given-names></string-name></person-group><article-title>Assessment of CASP7 predictions in the high accuracy template-based modeling category</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2007</year>;<volume>69</volume>:<fpage>27</fpage>–<lpage>37</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Remmert</surname><given-names>M</given-names></string-name>, <string-name><surname>Biegert</surname><given-names>A</given-names></string-name>, <string-name><surname>Hauser</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Hhblits: lightning-fast iterative protein sequence searching by hmm-hmm alignment</article-title>. <source>Nat Methods</source><year>2012</year>;<volume>9</volume>:<fpage>173</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Richardson</surname><given-names>L</given-names></string-name>, <string-name><surname>Allen</surname><given-names>B</given-names></string-name>, <string-name><surname>Baldi</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>MGnify: the microbiome sequence data analysis resource in 2023</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>D753</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">36477304</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robustelli</surname><given-names>P</given-names></string-name>, <string-name><surname>Piana</surname><given-names>S</given-names></string-name>, <string-name><surname>Shaw</surname><given-names>DE</given-names></string-name></person-group><etal>et al</etal><article-title>Developing a molecular dynamics force field for both folded and disordered protein states</article-title>. <source>Proc Natl Acad Sci USA</source><year>2018</year>;<volume>115</volume>:<fpage>E4758</fpage>–<lpage>66</lpage>.<pub-id pub-id-type="pmid">29735687</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Šali</surname><given-names>A</given-names></string-name>, <string-name><surname>Blundell</surname><given-names>TL.</given-names></string-name></person-group><article-title>Comparative protein modelling by satisfaction of spatial restraints</article-title>. <source>J Mol Biol</source><year>1993</year>;<volume>234</volume>:<fpage>779</fpage>–<lpage>815</lpage>.<pub-id pub-id-type="pmid">8254673</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Senior</surname><given-names>AW</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Jumper</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Improved protein structure prediction using potentials from deep learning</article-title>. <source>Nature</source><year>2020</year>;<volume>577</volume>:<fpage>706</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">31942072</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B50">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>Y</given-names></string-name>, <string-name><surname>Sohl-Dickstein</surname><given-names>J</given-names></string-name>, <string-name><surname>Kingma</surname><given-names>DP</given-names></string-name></person-group><etal>et al</etal> Score-based generative modeling through stochastic differential equations. <italic toggle="yes">International Conference on Learning Representations,</italic> 2021.</mixed-citation>
    </ref>
    <ref id="btad712-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M</given-names></string-name>, <string-name><surname>Mirdita</surname><given-names>M</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Protein-level assembly increases protein sequence recovery from metagenomic samples manyfold</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>:<fpage>603</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">31235882</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Suzek</surname><given-names>BE</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Huang</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal>; <collab>UniProt Consortium</collab>. <article-title>Uniref clusters: a comprehensive and scalable alternative for improving sequence similarity searches</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>926</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">25398609</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B53">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Trippe</surname><given-names>BL</given-names></string-name>, <string-name><surname>Yim</surname><given-names>J</given-names></string-name>, <string-name><surname>Tischer</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal> Diffusion probabilistic modeling of protein backbones in 3d for the motif-scaffolding problem. <italic toggle="yes">International Conference on Learning Representations,</italic> 2023.</mixed-citation>
    </ref>
    <ref id="btad712-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vaswani</surname><given-names>A</given-names></string-name>, <string-name><surname>Shazeer</surname><given-names>N</given-names></string-name>, <string-name><surname>Parmar</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>Attention is all you need</article-title>. <source>Adv Neural Inf Process Syst</source><year>2017</year>;<volume>30</volume>. <ext-link xlink:href="https://papers.nips.cc/paper_files/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html" ext-link-type="uri">https://papers.nips.cc/paper_files/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad712-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>S</given-names></string-name>, <string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Accurate de novo prediction of protein contact map by ultra-deep learning model</article-title>. <source>PLoS Comput Biol</source><year>2017a</year>;<volume>13</volume>:<fpage>e1005324</fpage>.<pub-id pub-id-type="pmid">28056090</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>S</given-names></string-name>, <string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Analysis of deep learning methods for blind protein contact prediction in CASP12</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017b</year>;<volume>86</volume>:<fpage>67</fpage>–<lpage>77</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Watson</surname><given-names>JL</given-names></string-name>, <string-name><surname>Juergens</surname><given-names>D</given-names></string-name>, <string-name><surname>Bennett</surname><given-names>NR</given-names></string-name></person-group><etal>et al</etal><article-title>De novo design of protein structure and function with RFdiffusion</article-title>. <source>Nature</source><year>2023</year>;<volume>620</volume>:<fpage>1089</fpage>–<lpage>100</lpage>.<pub-id pub-id-type="pmid">37433327</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weissenow</surname><given-names>K</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Protein language-model embeddings for fast, accurate, and alignment-free protein structure prediction</article-title>. <source>Structure</source><year>2022</year>;<volume>30</volume>:<fpage>1169</fpage>–<lpage>77.e4</lpage>.<pub-id pub-id-type="pmid">35609601</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>F</given-names></string-name>, <string-name><surname>Jing</surname><given-names>X</given-names></string-name>, <string-name><surname>Luo</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>Improving protein structure prediction using templates and sequence embedding</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>39</volume>:<fpage>btac723</fpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>York</surname><given-names>RL</given-names></string-name>, <string-name><surname>Yousefi</surname><given-names>PA</given-names></string-name>, <string-name><surname>Bogdanoff</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Structural, mechanistic, and antigenic characterization of the human astrovirus capsid</article-title>. <source>J Virol</source><year>2016</year>;<volume>90</volume>:<fpage>2254</fpage>–<lpage>63</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C</given-names></string-name>, <string-name><surname>Mortuza</surname><given-names>SM</given-names></string-name>, <string-name><surname>He</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Template-based and free modeling of i-TASSER and QUARK pipelines using predicted contact maps in CASP12</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017</year>;<volume>86</volume>:<fpage>136</fpage>–<lpage>51</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Liang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Atomic-level protein structure refinement using fragment-guided molecular dynamics conformation sampling</article-title>. <source>Structure</source><year>2011</year>;<volume>19</volume>:<fpage>1784</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">22153501</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Skolnick</surname><given-names>J.</given-names></string-name></person-group><article-title>TM-align: a protein structure alignment algorithm based on the TM-score</article-title>. <source>Nucleic Acids Res</source><year>2005</year>;<volume>33</volume>:<fpage>2302</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">15849316</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>W</given-names></string-name>, <string-name><surname>Wuyun</surname><given-names>Q</given-names></string-name>, <string-name><surname>Freddolino</surname><given-names>PL</given-names></string-name></person-group><etal>et al</etal><article-title>Integrating deep learning, threading alignments, and a multi-msa strategy for high-quality protein monomer and complex structure prediction in CASP15</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2023</year>;<volume>91</volume>:<fpage>1684</fpage>–<lpage>703</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B65">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zhong</surname><given-names>B</given-names></string-name>, <string-name><surname>Su</surname><given-names>X</given-names></string-name>, <string-name><surname>Wen</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal> Parafold: paralleling alphafold for large-scale predictions. <italic toggle="yes">International Conference on High Performance Computing in Asia-Pacific Region Workshops,</italic> 2021.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10699847</article-id>
    <article-id pub-id-type="pmid">37995286</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad712</article-id>
    <article-id pub-id-type="publisher-id">btad712</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DeepFold: enhancing protein structure prediction through optimized loss functions, improved template features, and re-optimized energy function</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Jae-Won</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Won</surname>
          <given-names>Jong-Hyun</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jeon</surname>
          <given-names>Seonggwang</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Choo</surname>
          <given-names>Yujin</given-names>
        </name>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <aff><institution>Department of Artificial intelligence, Hanyang University, </institution>Seoul 04763, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yeon</surname>
          <given-names>Yubin</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Oh</surname>
          <given-names>Jin-Seon</given-names>
        </name>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <aff><institution>Department of Artificial intelligence, Hanyang University, </institution>Seoul 04763, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Minsoo</given-names>
        </name>
        <aff><institution>Department of Physics, Sungkyunkwan University</institution>, Suwon 16419, <country country="KR">Korea</country></aff>
        <xref rid="btad712-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>SeonHwa</given-names>
        </name>
        <aff><institution>School of Electrical Engineering, Korea University</institution>, Seoul 02841, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Joung</surname>
          <given-names>InSuk</given-names>
        </name>
        <aff><institution>Standigm Inc.</institution>, Seoul 06234, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jang</surname>
          <given-names>Cheongjae</given-names>
        </name>
        <aff><institution>Artificial Intelligence Institute, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Sung Jong</given-names>
        </name>
        <aff><institution>Basic Science Research Institute, Changwon National University</institution>, Changwon 51140, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Tae Hyun</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jin</surname>
          <given-names>Kyong Hwan</given-names>
        </name>
        <aff><institution>School of Electrical Engineering, Korea University</institution>, Seoul 02841, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8796-4678</contrib-id>
        <name>
          <surname>Song</surname>
          <given-names>Giltae</given-names>
        </name>
        <aff><institution>School of Computer Science and Engineering, Pusan National University</institution>, Busan 46241, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Eun-Sol</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yoo</surname>
          <given-names>Jejoong</given-names>
        </name>
        <aff><institution>Department of Physics, Sungkyunkwan University</institution>, Suwon 16419, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3655-9749</contrib-id>
        <name>
          <surname>Paek</surname>
          <given-names>Eunok</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Noh</surname>
          <given-names>Yung-Kyun</given-names>
        </name>
        <aff><institution>Department of Computer Science, Hanyang University</institution>, Seoul 04763, <country country="KR">Korea</country></aff>
        <aff><institution>School of Computational Sciences, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-cor1" ref-type="corresp"/>
        <!--nohyung@hanyang.ac.kr-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4612-0927</contrib-id>
        <name>
          <surname>Joo</surname>
          <given-names>Keehyoung</given-names>
        </name>
        <aff><institution>Center for Advanced Computation, Korea Institute for Advanced Study</institution>, Seoul 02455, <country country="KR">Korea</country></aff>
        <xref rid="btad712-cor1" ref-type="corresp"/>
        <!--newton@kias.re.kr-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad712-cor1">Corresponding authors. Center for Advanced Computation, Korea Institute for Advanced Study, Seoul 02455, Korea. E-mail: <email>newton@kias.re.kr</email> (K.J.); Department of Computer Science, Hanyang University, Seoul 04763, Korea. E-mail: <email>nohyung@hanyang.ac.kr</email> (Y.-K.N.)</corresp>
      <fn id="btad712-FM1">
        <p>Jae-Won Lee, Jong-Hyun Won, Yujin Choo, Yubin Yeon, Jin-Seon Oh and Minsoo Kim Equal contribution</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-23">
      <day>23</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>12</issue>
    <elocation-id>btad712</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>20</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>06</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad712.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Predicting protein structures with high accuracy is a critical challenge for the broad community of life sciences and industry. Despite progress made by deep neural networks like AlphaFold2, there is a need for further improvements in the quality of detailed structures, such as side-chains, along with protein backbone structures.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Building upon the successes of AlphaFold2, the modifications we made include changing the losses of side-chain torsion angles and frame aligned point error, adding loss functions for side chain confidence and secondary structure prediction, and replacing template feature generation with a new alignment method based on conditional random fields. We also performed re-optimization by conformational space annealing using a molecular mechanics energy function which integrates the potential energies obtained from distogram and side-chain prediction. In the CASP15 blind test for single protein and domain modeling (109 domains), DeepFold ranked fourth among 132 groups with improvements in the details of the structure in terms of backbone, side-chain, and Molprobity. In terms of protein backbone accuracy, DeepFold achieved a median GDT-TS score of 88.64 compared with 85.88 of AlphaFold2. For TBM-easy/hard targets, DeepFold ranked at the top based on Z-scores for GDT-TS. This shows its practical value to the structural biology community, which demands highly accurate structures. In addition, a thorough analysis of 55 domains from 39 targets with publicly available structures indicates that DeepFold shows superior side-chain accuracy and Molprobity scores among the top-performing groups.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>DeepFold tools are open-source software available at <ext-link xlink:href="https://github.com/newtonjoo/deepfold" ext-link-type="uri">https://github.com/newtonjoo/deepfold</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Institute of Information &amp; communications Technology Planning &amp; Evaluation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Korea government</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Research Foundation of Korea</institution>
            <institution-id institution-id-type="DOI">10.13039/501100003725</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ministry of Science and ICT</institution>
            <institution-id institution-id-type="DOI">10.13039/501100014188</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Proteins serve as the essential building blocks of biological organisms, acting as the machinery of life. Protein functionality is highly dependent on their 3D structures; therefore, predicting and understanding these structures is crucial. The prediction of complete protein structures from their amino acid sequences alone has been a long-standing challenge, as demonstrated by the biennial CASP competition since 1994.</p>
    <p>Two primary computational approaches have been employed to address this challenge: template-based modeling (TBM) and free modeling (FM). TBM constructs a protein structure by using structures of homologous sequences, initially introduced in a study by Browne <italic toggle="yes">et al.</italic> (<xref rid="btad712-B7" ref-type="bibr">Browne <italic toggle="yes">et al.</italic> 1969</xref>). In TBM methods, finding a highly similar sequence from a given sequence is critical to producing accurate structures (<xref rid="btad712-B40" ref-type="bibr">Pearce and Zhang 2021</xref>). A conventional method for this is to align sequences using a position-specific score matrix (PSSM) (<xref rid="btad712-B3" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1997</xref>), or sequence profile Hidden Markov Models (HMMs) (<xref rid="btad712-B21" ref-type="bibr">Krogh <italic toggle="yes">et al.</italic> 1994</xref>) which made huge impact on searches for similar sequences and structures. These template structures serve as structural restraints for target structure modeling through sequence-structure alignment and optimization of empirical molecular mechanics force fields (<xref rid="btad712-B48" ref-type="bibr">Šali and Blundell 1993</xref>, <xref rid="btad712-B8" ref-type="bibr">Case <italic toggle="yes">et al.</italic> 2005</xref>, <xref rid="btad712-B16" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2016</xref>). Subsequent refinement, particularly of side-chain structures, is performed using empirical potentials employing molecular dynamics refinement or more efficient global optimization algorithms (<xref rid="btad712-B18" ref-type="bibr">Joo <italic toggle="yes">et al.</italic> 2007</xref>, <xref rid="btad712-B15" ref-type="bibr">Hong <italic toggle="yes">et al.</italic> 2017</xref>). Numerous groups have contributed to this field up until CASP12 (<xref rid="btad712-B18" ref-type="bibr">Joo <italic toggle="yes">et al.</italic> 2007</xref>, <xref rid="btad712-B1" ref-type="bibr">Adhikari <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad712-B15" ref-type="bibr">Hong <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad712-B39" ref-type="bibr">Ovchinnikov <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad712-B56" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2017b</xref>, <xref rid="btad712-B61" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2017</xref>).</p>
    <p>As an alternative, FM does not require known templates and instead exploits thermo-physical properties of protein structures. Molecular dynamics methods are predominant in this area (<xref rid="btad712-B62" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad712-B47" ref-type="bibr">Robustelli <italic toggle="yes">et al.</italic> 2018</xref>). Based on the assumption that native structures exhibit the lowest energy conformations (<xref rid="btad712-B4" ref-type="bibr">Anfinsen 1973</xref>), researchers attempt to identify the lowest energy conformations. However, this approach is practical only for short sequence lengths (<xref rid="btad712-B11" ref-type="bibr">Duan and Kollman 1998</xref>).</p>
    <p>Another route to protein structure modeling without template structures has been prediction of contacts between residues which typically utilizes the correlated mutations of residues from multiple sequence alignments for the target sequence (<xref rid="btad712-B35" ref-type="bibr">Morcos <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad712-B12" ref-type="bibr">Ekeberg <italic toggle="yes">et al.</italic> 2013</xref>). An important breakthrough has been an idea to incorporate deep neural networks to harness the contact information hidden in the MSA’s (Wang <italic toggle="yes">et al.</italic><xref rid="btad712-B55" ref-type="bibr">2017a, b</xref>) which led to the surprising appearance and success of AlphaFold1 in CASP13 (<xref rid="btad712-B49" ref-type="bibr">Senior <italic toggle="yes">et al.</italic> 2020</xref>). Recently, deep neural network models called AlphaFold2 (<xref rid="btad712-B19" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>) (AF2) and RoseTTAFold (<xref rid="btad712-B5" ref-type="bibr">Baek <italic toggle="yes">et al.</italic> 2021</xref>) have made significant breakthroughs in this problem. These neural networks use attention modules (<xref rid="btad712-B6" ref-type="bibr">Bahdanau <italic toggle="yes">et al.</italic> 2014</xref>, <xref rid="btad712-B54" ref-type="bibr">Vaswani <italic toggle="yes">et al.</italic> 2017</xref>) to inject long-range contact information from MSAs and templates into vector representations, successfully constructing a complete protein structure based on the representation. In CASP14, AF2 demonstrated striking prediction performance, showing high accuracy in predicted protein structures on most of the targets (<xref rid="btad712-B22" ref-type="bibr">Kwon <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad712-B43" ref-type="bibr">Pereira <italic toggle="yes">et al.</italic> 2021</xref>). However, despite AF2’s remarkable results on average, there still remain some targets for which the predictions of AF2 are rather poor, especially in the cases when MSAs are insufficient for proper modeling. Therefore there are still rooms for further improvement in deep neural network models, both in terms of efficiency and quality of the predicted structures. In particular, improving the accuracy of side-chain modeling would be important for high accuracy modeling and real applications.</p>
    <p>Several attempts have been made to improve AF2 in various ways since its advent. One avenue is to address the efficiency of training and inference. UniFold (<xref rid="btad712-B25" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2022</xref>) and OpenFold (<xref rid="btad712-B2" ref-type="bibr">Ahdritz <italic toggle="yes">et al.</italic> 2022</xref>) are the two initial works in this field. While UniFold is a slightly modified model of AF2 with its own training system, OpenFold is a reconstructed version of AF2 with accelerated training/inference time. ColabFold (<xref rid="btad712-B34" ref-type="bibr">Mirdita <italic toggle="yes">et al.</italic> 2022</xref>), ParaFold (<xref rid="btad712-B65" ref-type="bibr">Zhong <italic toggle="yes">et al.</italic> 2021</xref>), and FastFold (<xref rid="btad712-B9" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2022</xref>) are another model that demonstrated fast MSA searches and inference speed. Some works have attempted to build models that cover certain limitations of AF2. ESMFold (<xref rid="btad712-B26" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>), EMBER2 (<xref rid="btad712-B58" ref-type="bibr">Weissenow <italic toggle="yes">et al.</italic> 2022</xref>), and HelixFold (<xref rid="btad712-B13" ref-type="bibr">Fang <italic toggle="yes">et al.</italic> 2023</xref>) presented end-to-end models that can predict complete structures without MSAs or templates, which is not possible with AF2. With the recent success of diffusion models (<xref rid="btad712-B14" ref-type="bibr">Ho <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad712-B50" ref-type="bibr">Song <italic toggle="yes">et al.</italic> 2021</xref>), various efforts have been made toward predicting protein structures using generative models (<xref rid="btad712-B28" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad712-B53" ref-type="bibr">Trippe <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btad712-B57" ref-type="bibr">Watson <italic toggle="yes">et al.</italic> 2023</xref>). These models showed some potentials but still have limitations compared to AF2-based methods in terms of accuracy and effectiveness.</p>
    <p>Even with such a long history and remarkable advances in protein structure prediction, improvement in the quality of detailed structures such as side-chains has always been in strong demand, along with the quality of protein backbone structures, especially in the larger community of life sciences and industry. In this study, we address this problem by constructing a protein structure prediction model called DeepFold. In order to achieve more accurate backbone and side-chains with enhancement of the overall quality of protein structures, we modified the losses of the side-chain torsion angles and FAPE (frame aligned point error). And we introduced new loss functions for side chain confidence and secondary structure prediction. In addition, we replaced the template feature generation of AF2 by integrating a refined version of the alignment method, CRFalign (<xref rid="btad712-B24" ref-type="bibr">Lee <italic toggle="yes">et al.</italic> 2022</xref>), which builds upon the established principles of conditional random fields (<xref rid="btad712-B41" ref-type="bibr">Peng and Xu 2009</xref>). This refined version incorporates new feature vectors and gradient boosted regression trees. Lastly, re-optimization of the predicted structures is performed using a powerful global optimization algorithm called conformational space annealing (CSA) (<xref rid="btad712-B23" ref-type="bibr">Lee <italic toggle="yes">et al.</italic> 1997</xref>, <xref rid="btad712-B18" ref-type="bibr">Joo <italic toggle="yes">et al.</italic> 2007</xref>). We used a molecular mechanics energy function that integrates the potential energies obtained from the distogram and side-chain prediction. For validation, we benchmarked the prediction protocol of DeepFold on CASP13/14 targets which showed consistent improvement in side-chain torsions of proteins with a modest increase in backbone accuracy. In CASP15 blind competition, DeepFold achieved quite promising result, ranking fourth out of 132 teams in the assessors’ formula metric. Further analysis revealed that DeepFold outperformed top-performing groups in terms of detailed protein structure, including side-chains and Molprobity scores.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p><xref rid="btad712-F1" ref-type="fig">Figure 1</xref> shows the flow diagram of DeepFold for protein structure prediction. Given an amino acid sequence, DeepFold starts with generating MSAs and templates, which are processed as input to the DeepFold network. Then, Evoformer (<xref rid="btad712-B19" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>) network generates single and pair representations for the sequence that are fed into Structure modules to produce protein 3D structures. Those structures are re-optimized by CSA with an energy function including molecular mechanics force field and additional potentials from distogram and side-chain predictions. Details of DeepFold, with focus on modifications of AF2 are described below.</p>
    <fig position="float" id="btad712-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Prediction flow diagram of DeepFold. Given an amino acid sequence, the method first generates input features using MSAs and templates, where the MSAs are obtained from HHBlits, JackHMMER, and HHpred, and the templates/alignments are generated by CRFalign. Protein 3D structures are predicted by DeepFold network and then final structures are re-optimized by conformational space annealing (CSA). (See the main text for details.)</p>
      </caption>
      <graphic xlink:href="btad712f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 MSA and template feature generation</title>
      <p>The input features for DeepFold are generated from MSAs and templates. For the MSAs, DeepFold uses standard MSA generation procedure of AF2 using JackHMMER (<xref rid="btad712-B17" ref-type="bibr">Johnson <italic toggle="yes">et al.</italic> 2010</xref>) with MGnify (<xref rid="btad712-B46" ref-type="bibr">Richardson <italic toggle="yes">et al.</italic> 2023</xref>), JackHMMER with UniRef90 (<xref rid="btad712-B52" ref-type="bibr">Suzek <italic toggle="yes">et al.</italic> 2015</xref>), and HHblits (<xref rid="btad712-B45" ref-type="bibr">Remmert <italic toggle="yes">et al.</italic> 2012</xref>) with Uniclust30 (<xref rid="btad712-B33" ref-type="bibr">Mirdita <italic toggle="yes">et al.</italic> 2017</xref>)/BFD (<xref rid="btad712-B51" ref-type="bibr">Steinegger <italic toggle="yes">et al.</italic> 2019</xref>). As for the templates, we collected template candidates from HHPRED. In addition, we ranked all the structures in the PDB40 database (see Dataset section) based on their structural similarity to our query protein using DeepAlign (<xref rid="btad712-B36" ref-type="bibr">Nolle <italic toggle="yes">et al.</italic> 2020</xref>) with the AF2 model. From these ranked results, we selected the top 20 structures as additional template candidates. These aggregated template candidates were then re-ranked using CRFalign (<xref rid="btad712-B24" ref-type="bibr">Lee <italic toggle="yes">et al.</italic> 2022</xref>), a sequence-structure alignment method based on pairwise conditional random fields and gradient boosted regression trees. We utilized up to four of these templates and their respective alignments as input for the DeepFold network. In protein structure prediction, templates have been shown to be especially beneficial for targets with similar templates (<xref rid="btad712-B59" ref-type="bibr">Wu <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Sequentially conditioned torsion angle loss</title>
      <p>Since the side-chain torsion angles <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> are sequentially dependent in terms of 3D coordinates, we modified the torsion angle loss considering this sequential relationship in side chain angles by introducing the pre-torsion angle error <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>:</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mi>E</mml:mi>
                        <mml:mo>˜</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>χ</mml:mo>
                      </mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>:</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>E</mml:mi>
                            <mml:mo>˜</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>E</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mi>E</mml:mi>
                                  <mml:mo>˜</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>χ</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>⋅</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>E</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>χ</mml:mo>
                                </mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msqrt>
                        <mml:mn>2</mml:mn>
                      </mml:msqrt>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mo> </mml:mo>
            <mml:mtext>for</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mi>k</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mn>2</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>3</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>4</mml:mn>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>with the initial condition <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where the <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the square-root angle error defined as:</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>E</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>χ</mml:mo>
                      </mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>:</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:msqrt>
              <mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>α</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>α</mml:mi>
                            <mml:mo>^</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>|</mml:mo>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:mrow>
            </mml:msqrt>
            <mml:mo> </mml:mo>
            <mml:mtext>for</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mi>k</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>2</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>3</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:mn>4.</mml:mn>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>Here, <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is a cosine/sine vector representation of <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> in a single residue:</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>α</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>χ</mml:mo>
                      </mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd>
                              <mml:mrow>
                                <mml:mo> </mml:mo>
                                <mml:mtext>cos</mml:mtext>
                                <mml:mo> </mml:mo>
                                <mml:mrow>
                                  <mml:msup>
                                    <mml:mrow>
                                      <mml:mo>χ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>k</mml:mi>
                                  </mml:msup>
                                </mml:mrow>
                                <mml:mo>,</mml:mo>
                                <mml:mo> </mml:mo>
                                <mml:mtext>sin</mml:mtext>
                                <mml:mo> </mml:mo>
                                <mml:mrow>
                                  <mml:msup>
                                    <mml:mrow>
                                      <mml:mo>χ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>k</mml:mi>
                                  </mml:msup>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo>⊤</mml:mo>
              </mml:msup>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>The sequential properties of the pre-torsion angle error <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> can be seen as follows. In the case of <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> where no preceding angles exist, the error is reduced to just the angle error <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. For the case of <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, or <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, the error references the previous error <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> in the calculation of the current error, such that the current error <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> increases (i.e. is nonzero) even if the current angle difference <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is zero. Therefore, even though the model predicts correctly <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> angles, if it predicts <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> incorrectly, the torsion error of <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> will be increased. Lastly, summing the pre-torsion angle error <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for each of the <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mo>χ</mml:mo></mml:math></inline-formula> angles, we can define the overall angle loss as follows</p>
      <disp-formula id="E4">
        <label>(4)</label>
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>angle</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mi>N</mml:mi>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:mo stretchy="true">(</mml:mo>
              <mml:mrow>
                <mml:mo>Σ</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>E</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mo>Σ</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>E</mml:mi>
                            <mml:mo>˜</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mo>Σ</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>E</mml:mi>
                            <mml:mo>˜</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mn>3</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mo>Σ</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi>E</mml:mi>
                            <mml:mo>˜</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>χ</mml:mo>
                          </mml:mrow>
                          <mml:mn>4</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mrow>
              <mml:mo stretchy="true">)</mml:mo>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <italic toggle="yes">N</italic> is the number of residues and the summations are over the numbers of <italic toggle="yes">k</italic>th side-chain torsion angles respectively (<inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>⋯</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>).</p>
    </sec>
    <sec>
      <title>2.3 The weighted FAPE loss</title>
      <p>The Frame-aligned point error (FAPE) in AF2 plays an essential role in aligning atom positions in the generated rigid frame of each residue (i.e. the predicted local frame of each residue). The FAPE loss of AF2 is defined as</p>
      <disp-formula id="E5">
        <label>(5)</label>
        <mml:math id="M5" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>FAPE</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold">x</mml:mi>
                </mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>min</mml:mi>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>T</mml:mi>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mo>⋅</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">x</mml:mi>
                    </mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>T</mml:mi>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi mathvariant="italic">true</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mo>⋅</mml:mo>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">x</mml:mi>
                    </mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi mathvariant="italic">true</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>|</mml:mo>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mn>10</mml:mn>
                <mml:mo>Å</mml:mo>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the predicted local frame (which represents the rotation <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and translation <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> of <italic toggle="yes">i</italic>th residue) and atom coordinates <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, which measures the squared error between local coordinates <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and its ground truth <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">true</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">true</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Note that the loss has a clamping value of 10 Å that washes out the loss values larger than 10 Å. In DeepFold, we introduce the weighted FAPE loss as follows:</p>
      <disp-formula id="E6">
        <label>(6)</label>
        <mml:math id="M6" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>WFAPE</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold">x</mml:mi>
                </mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>w</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>FAPE</mml:mtext>
                  <mml:mo> </mml:mo>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold">x</mml:mi>
                </mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where the weight <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is determined by following sigmoid-type function</p>
      <disp-formula id="E7">
        <label>(7)</label>
        <mml:math id="M7" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>w</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mi>v</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mi>h</mml:mi>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>in which <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the distance with maximal probability from the distogram, between <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>β</mml:mo></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> atoms of residues <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>. The hyperparameters <italic toggle="yes">v</italic>, <italic toggle="yes">h</italic> control the inflection point of the sigmoid function and an additional weighting constant, respectively. In this work, we used <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>12.0</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula> which were determined by iterative grid searches. This modified loss gives larger weight on the closer atoms.</p>
    </sec>
    <sec>
      <title>2.4 Secondary structure loss</title>
      <p>We introduce secondary structure loss in DeepFold network by implementing small multi-layer perceptrons in the structure module as shown in <xref rid="btad712-F1" ref-type="fig">Fig. 1</xref>. This network uses single representations as inputs which were obtained by IPA (Invariant Point Attention) in structure module (<xref rid="btad712-B19" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>). And they return as output the prediction results of 8-state secondary structure of each residue (<xref rid="btad712-B20" ref-type="bibr">Kabsch and Sander 1983</xref>). To train this network, we defined a loss function for the secondary structure by cross-entropy as follows:</p>
      <disp-formula id="E8">
        <label>(8)</label>
        <mml:math id="M8" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>secondary</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mi>N</mml:mi>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:munderover>
                <mml:mo>∑</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mi>N</mml:mi>
              </mml:munderover>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:munderover>
                  <mml:mo>∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mn>8</mml:mn>
                </mml:munderover>
              </mml:mrow>
              <mml:mrow>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>y</mml:mi>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>c</mml:mi>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
            <mml:mo> </mml:mo>
            <mml:mtext>log</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>c</mml:mi>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the true secondary structure of <italic toggle="yes">i-</italic>th residue with <italic toggle="yes">c</italic>-state, and <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the predicted probability that the 8-state secondary structure of the <italic toggle="yes">i-</italic>th residue is in <italic toggle="yes">c</italic>-state.</p>
    </sec>
    <sec>
      <title>2.5 Side-chain confidence loss</title>
      <p>Similarly to the plddt in AF2, we defined another confidence measure focussing on the side chains of protein structure as follows. Side chain confidence <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for each residue <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> is defined as:</p>
      <disp-formula id="E9">
        <label>(9)</label>
        <mml:math id="M9" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mo>δ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>/</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mo>δ</mml:mo>
                                  </mml:mrow>
                                  <mml:mn>0</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the difference between the true and predicted <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> angles <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">true</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">pred</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Here, <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is a reference value of angle difference which was set as <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> in this work. In order to predict <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, we implemented another multi-layer perceptron network in the structure module which returns as output the probability <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to be in the specific bin among 50 bins in the interval [0,1]. This can be compared with the true values of <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, from which a loss function can be formed. The loss function is defined as the cross-entropy loss between one-hot encoded <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and predictions:</p>
      <disp-formula id="E10">
        <label>(10)</label>
        <mml:math id="M10" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>sc</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>:</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mi>N</mml:mi>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:munderover>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi>N</mml:mi>
              </mml:munderover>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>s</mml:mi>
                </mml:msubsup>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow/>
                  <mml:mo>⊤</mml:mo>
                </mml:msup>
              </mml:mrow>
            </mml:mrow>
            <mml:mo> </mml:mo>
            <mml:mtext>log</mml:mtext>
            <mml:mo> </mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mi>p</mml:mi>
                        <mml:mo>^</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mi>s</mml:mi>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where the <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are one-hot encoded representations of <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and prediction <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively. In this work, the side chain confidence score for a single sequence is defined by the average score over all residues.</p>
      <p>With the modified loss functions and newly added loss terms, we arrive at the following combined loss <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mi mathvariant="script">L</mml:mi></mml:math></inline-formula> which can be used for training the DeepFold model:</p>
      <disp-formula id="E11">
        <label>(11)</label>
        <mml:math id="M11" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi mathvariant="script">L</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>angle</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>WFAPE</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mn>3</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>secondary</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mn>4</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>sc</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mi mathvariant="bold">c</mml:mi>
                </mml:mrow>
                <mml:mo>⊤</mml:mo>
              </mml:msup>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="script">L</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>others</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where the <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>others</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>aux</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>dist</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>msa</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>conf</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>resolved</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mtext>vio</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are the other losses in AF2 with the default weights <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>0.3</mml:mn><mml:mo>,</mml:mo><mml:mn>2.0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>1.0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as they used in (<xref rid="btad712-B19" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>). <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> shows the relative weights of various loss terms in our modifications.</p>
    </sec>
    <sec>
      <title>2.6 Dataset, training, and validation</title>
      <p>We used the latest PDB database (Feb. 2022) for training. We clustered the sequences of PDB using CD-HIT with 40% sequence identity, which resulted in 31,911 protein chains. We further filtered 23,366 chains of high-resolution (with &lt; 2.5 Å) for a fine-tuning dataset. The obtained sequences were cropped to 256 and 384 residue sizes as in the AF2 for training. Five DeepFold models were selected from training with various training schedules. For all the trained models, we employed the Uni-fold (a trainable version of AF2) training system, where the trainings were started from the AF2 parameters and then further optimized in the style of transfer learning. Full details are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref>.</p>
    </sec>
    <sec>
      <title>2.7 Re-optimization by conformational space annealing</title>
      <p>Once 3D structures are inferred from the DeepFold networks, we perform global optimization using conformational space annealing (CSA) with the full atom force field, distance restraints, and side chain torsion restraints generated by the networks. Full details are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>In order to evaluate the performance of DeepFold, we conducted a blind test in the CASP15 competition. As our Group Names, we used DFolding and DFolding-server, where the latter was a server prediction protocol which was performed without the final CSA re-optimization due to the 3-day deadline. We present our results obtained from the official evaluation data, which was provided by CASP15 assessors of Single Protein and Domain Modeling category [15th Community Wide Experiment on the Critical Assessment of Techniques for Protein Structure Prediction (<ext-link xlink:href="https://predictioncenter.org/casp15/" ext-link-type="uri">https://predictioncenter.org/casp15/</ext-link>)]. Traditionally, all targets are divided into domains, which are classified as TBM and FM domains. In the CASP15, total of 109 domains, which were officially assessed, consist of 62 TBM domains (including 47 TBM-easy and 14 TBM-hard), and 47 FM domains (8 FM/TBM and 39 FM). We also present our own assessment of 55 domains (39 targets) including 27 TBM, 27 FM domains, and 1 domain that was not classified, for which native structures were publicly available.</p>
    <p>The official metric to compare the performance of all Groups is called <italic toggle="yes">sum</italic> Z-score which is a weighted sum of the Z-scores for each of the domains as in the following CASP15 assessor’s formula (<xref rid="btad712-B44" ref-type="bibr">Read and Chavali 2007</xref>, <xref rid="btad712-B29" ref-type="bibr">Mariani <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btad712-B38" ref-type="bibr">Olechnovič <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad712-B10" ref-type="bibr">Croll <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad712-B32" ref-type="bibr">Millán <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad712-B43" ref-type="bibr">Pereira <italic toggle="yes">et al.</italic> 2021</xref>) [GDT-HA (Global Distance Test for High Accuracy), reLLG (Relative eLLG score), ASE (Accuracy Self Estimate), LDDT (Local Distance Difference Test), AA (CAD-score, all atoms), SG (The average value of Sphere Grinder Score), SC<inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (Side Chain Dihedral Error Score), Molprobity (Aggregated Molprobity Score), BB<inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (Backbone Dihedral Error Score), DipDiff (The average difference between the local DipScores)],</p>
    <disp-formula id="E12">
      <label>(12)</label>
      <mml:math id="M12" display="block" overflow="scroll">
        <mml:mrow>
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mi mathvariant="italic">sum</mml:mi>
                  <mml:mo> </mml:mo>
                  <mml:mi mathvariant="normal">Z</mml:mi>
                  <mml:mo>-</mml:mo>
                  <mml:mtext>score</mml:mtext>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>6</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo stretchy="true">(</mml:mo>
                  <mml:mtext>GDT-HA</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>reLLG</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>ASE</mml:mtext>
                  <mml:mo stretchy="true">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mrow>
                        <mml:mn>16</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo stretchy="true">(</mml:mo>
                  <mml:mtext>LDDT</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>AA</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>SG</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mtext>SC</mml:mtext>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>error</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="true">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mrow>
                        <mml:mn>12</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo stretchy="true">(</mml:mo>
                  <mml:mtext>Molprb</mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mtext>BB</mml:mtext>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>error</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>DipDiff</mml:mtext>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>In addition to the above metric, GDT-TS is typically used as a standard measure of modeling accuracy (Global Distance Test for Tertiary Structure) to evaluate the accuracy of global backbone trace of the structure. <xref rid="btad712-F2" ref-type="fig">Figure 2</xref> illustrates the official rankings of DFolding, together with other top 50 among 132 Groups including BAKER (RosettaFold), ColabFold, NBIS-AF2-standard and OpenFold (the latter three are basically standard AF2-based protocols with modification of MSA generation). In <xref rid="btad712-F2" ref-type="fig">Fig. 2a</xref>, DFolding was ranked fourth according to the assessor’s formula, while in (b), DFolding was at the top in terms of <italic toggle="yes">sum</italic> Z-score of GDT-TS for 64 domains, classified in the TBM-easy and TBM-hard target. In the figure, DFolding-server was also included, indicating the performance difference in comparison with DFolding. Note that CSA re-optimization is not used in DFolding-server protocol due to the time limit of three-days.</p>
    <fig position="float" id="btad712-F2">
      <label>Figure 2.</label>
      <caption>
        <p>CASP15 rankings in terms of sum Z of (a) the assessor’s formula [<xref rid="E12" ref-type="disp-formula">Equation (12)</xref>] and (b) GDT-TS for TBM easy/hard targets (62 domains in total). In each figure, only top 50 out of 132 teams are shown.</p>
      </caption>
      <graphic xlink:href="btad712f2" position="float"/>
    </fig>
    <p><xref rid="btad712-T1" ref-type="table">Table 1</xref> shows the results of top 10 performing groups from the <xref rid="btad712-F2" ref-type="fig">Fig. 2a</xref>, in addition to three AF2 based methods. All metrics used in assessor’s formula are shown in the average values instead of Z-scores. Despite the differences of backbone accuracies, the values of the metrics such as SC<inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, AA, BB<inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and DipDiff are showing very little differences between groups. In particular, the value of SC<inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (which means side-chain error for protein structure models, where lower is better) is not very distinguishable in spite of a significant difference in backbone accuracy such as GDT-TS. This is because the criterion of correctness in the metric of SC<inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is too broad. Below, we will discuss our own evaluation for side-chain accuracies for 55 domains, where native structures are available in public. In the Molprobity score showing protein-likeness, DeepFold achieved a score of 0.97 (lower is better) and performed well among the top groups.</p>
    <table-wrap position="float" id="btad712-T1">
      <label>Table 1.</label>
      <caption>
        <p>The official CASP15 results of top 10 performing groups, in addition to three AF2 based methods sorted by assessor’s formula in <xref rid="E12" ref-type="disp-formula">Equation (12)</xref>.<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Rank</th>
            <th rowspan="1" colspan="1">Methods</th>
            <th rowspan="1" colspan="1">sum Z</th>
            <th rowspan="1" colspan="1">GDT-TS</th>
            <th rowspan="1" colspan="1">GDT-HA</th>
            <th rowspan="1" colspan="1">reLLG</th>
            <th rowspan="1" colspan="1">ASE</th>
            <th rowspan="1" colspan="1">LDDT</th>
            <th rowspan="1" colspan="1">AA</th>
            <th rowspan="1" colspan="1">SG</th>
            <th rowspan="1" colspan="1">SC<inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></th>
            <th rowspan="1" colspan="1">Molprobity</th>
            <th rowspan="1" colspan="1">BB<inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></th>
            <th rowspan="1" colspan="1">DipDiff</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">1</td>
            <td rowspan="1" colspan="1">PEZYFoldings</td>
            <td rowspan="1" colspan="1">
              <bold>70.83</bold>
            </td>
            <td rowspan="1" colspan="1">81.89</td>
            <td rowspan="1" colspan="1">68.00</td>
            <td rowspan="1" colspan="1">12.65</td>
            <td rowspan="1" colspan="1">88.39</td>
            <td rowspan="1" colspan="1">0.79</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">90.10</td>
            <td rowspan="1" colspan="1">9.59</td>
            <td rowspan="1" colspan="1">1.34</td>
            <td rowspan="1" colspan="1">9.38</td>
            <td rowspan="1" colspan="1">0.02</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">2</td>
            <td rowspan="1" colspan="1">UM-TBM</td>
            <td rowspan="1" colspan="1">68.56</td>
            <td rowspan="1" colspan="1">83.75</td>
            <td rowspan="1" colspan="1">
              <bold>69.49</bold>
            </td>
            <td rowspan="1" colspan="1">12.26</td>
            <td rowspan="1" colspan="1">89.04</td>
            <td rowspan="1" colspan="1">
              <bold>0.81</bold>
            </td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">
              <bold>92.06</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>9.42</bold>
            </td>
            <td rowspan="1" colspan="1">1.22</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">3</td>
            <td rowspan="1" colspan="1">Yang-Server</td>
            <td rowspan="1" colspan="1">61.28</td>
            <td rowspan="1" colspan="1">
              <bold>83.92</bold>
            </td>
            <td rowspan="1" colspan="1">69.48</td>
            <td rowspan="1" colspan="1">12.45</td>
            <td rowspan="1" colspan="1">85.89</td>
            <td rowspan="1" colspan="1">0.79</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">91.76</td>
            <td rowspan="1" colspan="1">9.50</td>
            <td rowspan="1" colspan="1">1.36</td>
            <td rowspan="1" colspan="1">9.29</td>
            <td rowspan="1" colspan="1">0.02</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">4</td>
            <td rowspan="1" colspan="1">DFolding (DeepFold)</td>
            <td rowspan="1" colspan="1">61.07</td>
            <td rowspan="1" colspan="1">80.33</td>
            <td rowspan="1" colspan="1">66.39</td>
            <td rowspan="1" colspan="1">10.53</td>
            <td rowspan="1" colspan="1">87.22</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">88.79</td>
            <td rowspan="1" colspan="1">9.44</td>
            <td rowspan="1" colspan="1">0.97</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.03</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">5</td>
            <td rowspan="1" colspan="1">Yang</td>
            <td rowspan="1" colspan="1">59.01</td>
            <td rowspan="1" colspan="1">83.07</td>
            <td rowspan="1" colspan="1">68.92</td>
            <td rowspan="1" colspan="1">
              <bold>12.99</bold>
            </td>
            <td rowspan="1" colspan="1">86.13</td>
            <td rowspan="1" colspan="1">0.79</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">91.01</td>
            <td rowspan="1" colspan="1">9.51</td>
            <td rowspan="1" colspan="1">1.38</td>
            <td rowspan="1" colspan="1">9.29</td>
            <td rowspan="1" colspan="1">0.02</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">6</td>
            <td rowspan="1" colspan="1">McGuffin</td>
            <td rowspan="1" colspan="1">49.73</td>
            <td rowspan="1" colspan="1">79.82</td>
            <td rowspan="1" colspan="1">66.34</td>
            <td rowspan="1" colspan="1">11.28</td>
            <td rowspan="1" colspan="1">85.22</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">88.24</td>
            <td rowspan="1" colspan="1">9.43</td>
            <td rowspan="1" colspan="1">1.59</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">7</td>
            <td rowspan="1" colspan="1">MULTICOM</td>
            <td rowspan="1" colspan="1">48.83</td>
            <td rowspan="1" colspan="1">80.20</td>
            <td rowspan="1" colspan="1">66.41</td>
            <td rowspan="1" colspan="1">11.99</td>
            <td rowspan="1" colspan="1">75.55</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">89.98</td>
            <td rowspan="1" colspan="1">9.44</td>
            <td rowspan="1" colspan="1">1.38</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">8</td>
            <td rowspan="1" colspan="1">MULTICOM_refine</td>
            <td rowspan="1" colspan="1">48.83</td>
            <td rowspan="1" colspan="1">79.25</td>
            <td rowspan="1" colspan="1">65.46</td>
            <td rowspan="1" colspan="1">11.37</td>
            <td rowspan="1" colspan="1">85.75</td>
            <td rowspan="1" colspan="1">0.79</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">89.75</td>
            <td rowspan="1" colspan="1">9.43</td>
            <td rowspan="1" colspan="1">1.16</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">9</td>
            <td rowspan="1" colspan="1">BAKER</td>
            <td rowspan="1" colspan="1">47.99</td>
            <td rowspan="1" colspan="1">79.33</td>
            <td rowspan="1" colspan="1">63.81</td>
            <td rowspan="1" colspan="1">8.59</td>
            <td rowspan="1" colspan="1">85.72</td>
            <td rowspan="1" colspan="1">0.77</td>
            <td rowspan="1" colspan="1">0.75</td>
            <td rowspan="1" colspan="1">89.20</td>
            <td rowspan="1" colspan="1">9.46</td>
            <td rowspan="1" colspan="1">
              <bold>0.75</bold>
            </td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.03</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">10</td>
            <td rowspan="1" colspan="1">MULTICOM_human</td>
            <td rowspan="1" colspan="1">47.90</td>
            <td rowspan="1" colspan="1">79.99</td>
            <td rowspan="1" colspan="1">66.13</td>
            <td rowspan="1" colspan="1">11.08</td>
            <td rowspan="1" colspan="1">75.81</td>
            <td rowspan="1" colspan="1">0.78</td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">89.68</td>
            <td rowspan="1" colspan="1">9.44</td>
            <td rowspan="1" colspan="1">1.38</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">17</td>
            <td rowspan="1" colspan="1">ColabFold</td>
            <td rowspan="1" colspan="1">44.02</td>
            <td rowspan="1" colspan="1">75.36</td>
            <td rowspan="1" colspan="1">62.33</td>
            <td rowspan="1" colspan="1">10.77</td>
            <td rowspan="1" colspan="1">89.75</td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">0.75</td>
            <td rowspan="1" colspan="1">86.57</td>
            <td rowspan="1" colspan="1">9.43</td>
            <td rowspan="1" colspan="1">1.34</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.01</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">45</td>
            <td rowspan="1" colspan="1">NBIS-AF2-standard</td>
            <td rowspan="1" colspan="1">34.63</td>
            <td rowspan="1" colspan="1">75.81</td>
            <td rowspan="1" colspan="1">61.74</td>
            <td rowspan="1" colspan="1">9.59</td>
            <td rowspan="1" colspan="1">
              <bold>89.84</bold>
            </td>
            <td rowspan="1" colspan="1">0.76</td>
            <td rowspan="1" colspan="1">0.75</td>
            <td rowspan="1" colspan="1">87.21</td>
            <td rowspan="1" colspan="1">9.44</td>
            <td rowspan="1" colspan="1">1.28</td>
            <td rowspan="1" colspan="1">9.21</td>
            <td rowspan="1" colspan="1">0.00</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">53</td>
            <td rowspan="1" colspan="1">OpenFold</td>
            <td rowspan="1" colspan="1">33.25</td>
            <td rowspan="1" colspan="1">73.71</td>
            <td rowspan="1" colspan="1">60.34</td>
            <td rowspan="1" colspan="1">9.13</td>
            <td rowspan="1" colspan="1">87.79</td>
            <td rowspan="1" colspan="1">0.74</td>
            <td rowspan="1" colspan="1">0.74</td>
            <td rowspan="1" colspan="1">84.72</td>
            <td rowspan="1" colspan="1">9.53</td>
            <td rowspan="1" colspan="1">1.72</td>
            <td rowspan="1" colspan="1">9.30</td>
            <td rowspan="1" colspan="1">0.00</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <label>a</label>
          <p>All of the 11 metrics in the formula are also shown as the average (over all the target) of the raw scores. References for each of the predictors listed are as follows: PEZYFoldings (<xref rid="btad712-B37" ref-type="bibr">Oda 2023</xref>), UM-TBM (<xref rid="btad712-B42" ref-type="bibr">Peng <italic toggle="yes">et al.</italic> 2023</xref>), Yang-Server (<xref rid="btad712-B64" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2023</xref>), McGuffin (<xref rid="btad712-B30" ref-type="bibr">McGuffin <italic toggle="yes">et al.</italic> 2023</xref>), MULTICOM (<xref rid="btad712-B27" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2023</xref>), ColabFold (<xref rid="btad712-B34" ref-type="bibr">Mirdita <italic toggle="yes">et al.</italic> 2022</xref>), and OpenFold (<xref rid="btad712-B2" ref-type="bibr">Ahdritz <italic toggle="yes">et al.</italic> 2022</xref>). The top scores in each metric are marked in bold.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p><xref rid="btad712-F3" ref-type="fig">Figure 3</xref> shows the effect of CSA re-optimization by comparing DFolding (<italic toggle="yes">y</italic>-axis) versus DFolding-server (<italic toggle="yes">x</italic>-axis) in terms of GDT-TS, LDDT, SC error, and Molprobity, where we used the official metrics provided by CASP15 assessors. DFolding prediction exhibits better performance in average scores for GDT-TS, LDDT, and Molprobity, while difference of SC<inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is very minor. It is due to the same reason mentioned above that the criterion of side-chain error is too broad. In GDT-TS, DFolding performed well for the relatively hard targets (GDT-TS less than about 70), which can be attributed to the result of CSA re-optimization. It also shows significant improvement in Molprobity score.</p>
    <fig position="float" id="btad712-F3">
      <label>Figure 3.</label>
      <caption>
        <p>Comparison between the accuracies of DFolding (<italic toggle="yes">y</italic>-axis) versus DFolding-server (without CSA re-optimization, <italic toggle="yes">x</italic>-axis). The CASP15 official results of GDT-TS, LDDT, SC error, and Molprobity are used. Higher values are better for GDT-TS, LDDT, while lower values are better for SC<inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and Molprobity. All numbers within the figures are average values over 109 domains.</p>
      </caption>
      <graphic xlink:href="btad712f3" position="float"/>
    </fig>
    <p>We now apply further analysis of our own on the performance of DeepFold with the 55 domains for which the native structures are available. In <xref rid="btad712-T2" ref-type="table">Table 2</xref>, GDT-TS and GDT-HA were calculated by using the TM-score program instead of using the official data. Side-chain accuracies of <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> were calculated by using 10° criterion of correctness, instead of using SC<inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>error</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> used in the official results. All values presented in the table are cumulative Z-scores for each metric, in line with the CASP15 assessor’s methodology (higher values are better). The results from DFolding demonstrate a balanced performance in both backbone and side-chain metrics when compared to leading groups. The table shows that the sum Z-score of DFolding in Molprobity value is significantly higher than all the other top performing groups. Furthermore, the table shows that DFolding achieved higher scores in LDDT, GDT-TS, and GDT-HA than the well-known methods such as AF2, BAKER, ColabFold, and OpenFold.</p>
    <table-wrap position="float" id="btad712-T2">
      <label>Table 2.</label>
      <caption>
        <p>CASP15 results of top 10 teams in <xref rid="btad712-T1" ref-type="table">Table 1</xref>, evaluated on 55 domains, for which the native structures are publicly available.<xref rid="tblfn2" ref-type="table-fn"><sup>a</sup></xref></p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Methods</th>
            <th rowspan="1" colspan="1">LDDT</th>
            <th rowspan="1" colspan="1">GDT-TS</th>
            <th rowspan="1" colspan="1">GDT-HA</th>
            <th rowspan="1" colspan="1">
              <inline-formula id="IE67">
                <mml:math id="IM67" display="inline" overflow="scroll">
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>χ</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="italic">acc</mml:mi>
                        </mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </th>
            <th rowspan="1" colspan="1">
              <inline-formula id="IE68">
                <mml:math id="IM68" display="inline" overflow="scroll">
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>χ</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="italic">acc</mml:mi>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </th>
            <th rowspan="1" colspan="1">Molprobity</th>
            <th rowspan="1" colspan="1">counts</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">PEZYFoldings</td>
            <td rowspan="1" colspan="1">38.19</td>
            <td rowspan="1" colspan="1">51.80</td>
            <td rowspan="1" colspan="1">54.93</td>
            <td rowspan="1" colspan="1">27.73</td>
            <td rowspan="1" colspan="1">27.22</td>
            <td rowspan="1" colspan="1">26.99</td>
            <td rowspan="1" colspan="1">53</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">UM-TBM</td>
            <td rowspan="1" colspan="1">36.41</td>
            <td rowspan="1" colspan="1">47.91</td>
            <td rowspan="1" colspan="1">53.86</td>
            <td rowspan="1" colspan="1">27.49</td>
            <td rowspan="1" colspan="1">31.27</td>
            <td rowspan="1" colspan="1">27.71</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Yang-Server</td>
            <td rowspan="1" colspan="1">24.69</td>
            <td rowspan="1" colspan="1">49.19</td>
            <td rowspan="1" colspan="1">52.44</td>
            <td rowspan="1" colspan="1">35.14</td>
            <td rowspan="1" colspan="1">35.80</td>
            <td rowspan="1" colspan="1">17.34</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <bold>DFolding (DeepFold)</bold>
            </td>
            <td rowspan="1" colspan="1">31.98</td>
            <td rowspan="1" colspan="1">46.76</td>
            <td rowspan="1" colspan="1">48.99</td>
            <td rowspan="1" colspan="1">29.00</td>
            <td rowspan="1" colspan="1">29.42</td>
            <td rowspan="1" colspan="1">50.51</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Yang</td>
            <td rowspan="1" colspan="1">22.78</td>
            <td rowspan="1" colspan="1">45.03</td>
            <td rowspan="1" colspan="1">47.66</td>
            <td rowspan="1" colspan="1">33.65</td>
            <td rowspan="1" colspan="1">40.38</td>
            <td rowspan="1" colspan="1">24.81</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">McGuffin</td>
            <td rowspan="1" colspan="1">29.75</td>
            <td rowspan="1" colspan="1">44.32</td>
            <td rowspan="1" colspan="1">49.21</td>
            <td rowspan="1" colspan="1">24.56</td>
            <td rowspan="1" colspan="1">29.05</td>
            <td rowspan="1" colspan="1">17.03</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MULTICOM</td>
            <td rowspan="1" colspan="1">29.41</td>
            <td rowspan="1" colspan="1">38.33</td>
            <td rowspan="1" colspan="1">43.88</td>
            <td rowspan="1" colspan="1">22.78</td>
            <td rowspan="1" colspan="1">27.23</td>
            <td rowspan="1" colspan="1">24.20</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MULTICOM_refine</td>
            <td rowspan="1" colspan="1">29.70</td>
            <td rowspan="1" colspan="1">28.98</td>
            <td rowspan="1" colspan="1">30.73</td>
            <td rowspan="1" colspan="1">23.98</td>
            <td rowspan="1" colspan="1">23.32</td>
            <td rowspan="1" colspan="1">31.21</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">BAKER</td>
            <td rowspan="1" colspan="1">15.93</td>
            <td rowspan="1" colspan="1">30.73</td>
            <td rowspan="1" colspan="1">27.01</td>
            <td rowspan="1" colspan="1">35.14</td>
            <td rowspan="1" colspan="1">32.44</td>
            <td rowspan="1" colspan="1">28.81</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">MULTICOM_human</td>
            <td rowspan="1" colspan="1">27.20</td>
            <td rowspan="1" colspan="1">37.32</td>
            <td rowspan="1" colspan="1">41.77</td>
            <td rowspan="1" colspan="1">22.03</td>
            <td rowspan="1" colspan="1">22.98</td>
            <td rowspan="1" colspan="1">24.34</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">ColabFold</td>
            <td rowspan="1" colspan="1">24.93</td>
            <td rowspan="1" colspan="1">20.42</td>
            <td rowspan="1" colspan="1">21.60</td>
            <td rowspan="1" colspan="1">21.40</td>
            <td rowspan="1" colspan="1">22.57</td>
            <td rowspan="1" colspan="1">21.17</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">NBIS-AF2-standard</td>
            <td rowspan="1" colspan="1">21.52</td>
            <td rowspan="1" colspan="1">14.87</td>
            <td rowspan="1" colspan="1">14.57</td>
            <td rowspan="1" colspan="1">22.69</td>
            <td rowspan="1" colspan="1">20.29</td>
            <td rowspan="1" colspan="1">23.74</td>
            <td rowspan="1" colspan="1">54</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">OpenFold</td>
            <td rowspan="1" colspan="1">16.46</td>
            <td rowspan="1" colspan="1">14.09</td>
            <td rowspan="1" colspan="1">15.16</td>
            <td rowspan="1" colspan="1">18.03</td>
            <td rowspan="1" colspan="1">21.07</td>
            <td rowspan="1" colspan="1">19.67</td>
            <td rowspan="1" colspan="1">55</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn2">
          <label>a</label>
          <p>All scores in the table are Z-sum scores. GDT-TS and GDT-HA in the table are calculated by TM-score (<xref rid="btad712-B63" ref-type="bibr">Zhang and Skolnick 2005</xref>). The top scores in each metric are marked in bold.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p><xref rid="btad712-F4" ref-type="fig">Figure 4</xref> shows a comparison between the accuracies of DFolding and DFolding-server for 55 domains. On average, DFolding outperforms DFolding-server in terms of GDT-TS and Molprobity value, while the sidechain scores are similar in terms of <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">acc</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">acc</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. This indicates that CSA re-optimization process of DFolding resulted in a minor improvement for the overall structure of the 55 protein domains.</p>
    <fig position="float" id="btad712-F4">
      <label>Figure 4.</label>
      <caption>
        <p>Comparison between the accuracies of DFolding (<italic toggle="yes">y</italic>-axis) and DFolding-server (<italic toggle="yes">x</italic>-axis) for publicly available 55 domains. All numbers within the figures are average values over 55 domains. Lower value is better for Molprobity.</p>
      </caption>
      <graphic xlink:href="btad712f4" position="float"/>
    </fig>
    <p>As mentioned in the Section 2, DFolding used CRFalign for the generation of template features. We can evaluate the quality of template features for 55 domains where the native structures are available. <xref rid="btad712-F5" ref-type="fig">Figure 5</xref> shows the difference between template features of DFolding and those of AF2. In order to show the difference between DFolding and AF2 in terms of the quality of templates, we used the best template among the (up to) four templates for each target. <xref rid="btad712-F5" ref-type="fig">Figure 5a</xref> shows the TM-scores of the templates of DFolding in comparison with those of AF2’s templates. Average TM-score of DFolding templates was 0.6042 while that of AF2 was 0.5521. <xref rid="btad712-F5" ref-type="fig">Figure 5b</xref> shows a comparison of the quality of CRFalign alignments and those of AF2’s. The alignment quality was measured based on the pairwise distance of residues. First, for the native sequence, collect pairs of residues and measure pairwise distances. The collected pairs are &gt;3 in sequence separation, with mutual distances &lt;8 Å. Second, for the residue pairs at the same location with the native sequence, pairwise distance is calculated for the aligned template sequence. Then, we calculate the ratio of the template residue pairs that have a similar distance to the native residue pairs’ distance. If the difference of a residue pair distance between native and template is less than a threshold, we label that the template residue pair distance is similar to that of native’s. In the case of (b), we set the threshold as 3 Å. We can see that the alignment quality of DFolding using CRFalign shows significant improvement over that of AF2, especially in the cases of hard targets (when the ratio of alignment quality is less than about 0.7). However, because the predicted structure is greatly affected by the quality of the MSA, the superiority of template information does not guarantee the improvement of the final structure. To further verify this, we added the final results of the 18 domains in <xref rid="btad712-F5" ref-type="fig">Fig. 5b</xref> where the difference in values is &gt;0.15 in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S7</xref>. For example, Target T1123, which belongs to the FM/TBM class, was among the relatively well-predicted cases. As illustrated in <xref rid="btad712-F6" ref-type="fig">Fig. 6a</xref>, DFolding ranked first with a GDT-TS score of 86.80, while DFolding-server was placed in the third position with a GDT-TS score of 83.64, outperforming other groups. <xref rid="btad712-F6" ref-type="fig">Figure 6c</xref> shows the best template, 5EWO (<xref rid="btad712-B60" ref-type="bibr">York <italic toggle="yes">et al.</italic> 2016</xref>), which was found using CRFalign. The template exhibited higher structural similarity to the native structure (TM-score = 0.69) than AF2 (TM-score = 0.31). <xref rid="btad712-F6" ref-type="fig">Figure 6b</xref> displays the predictions of DFolding and AF2 in cartoon style with the native structure. It can be observed that our models successfully generated <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>-sheets (shown in blue color) near the C-terminal, while AF2 failed to predict that region.</p>
    <fig position="float" id="btad712-F5">
      <label>Figure 5.</label>
      <caption>
        <p>Comparison of the templates of the 55 domains in CASP15. (a) TM-score comparison is shown between the templates found by DeepFold (through CRFalign) versus the ones found by AF2. Each point represents the template with the highest TM-score obtained by the respective method for a given target. Orange colors are the domains with a lower TM-score for CRFalign than the AF2 method, and cyan colors indicate the domains for which the same templates are found by both methods. Red color is the target T1123. (b) A comparison of the alignment qualities of CRFalign and AF2 is shown. All numbers within the figures are average values over 55 domains. The dotted line is indicating a difference <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mo>&gt;</mml:mo></mml:math></inline-formula> 0.15, and as a result, we had significantly better template information for 18 domains.</p>
      </caption>
      <graphic xlink:href="btad712f5" position="float"/>
    </fig>
    <fig position="float" id="btad712-F6">
      <label>Figure 6.</label>
      <caption>
        <p>The target T1123 in CASP15 for which DeepFold predictions showed the best GDT-TS scores. (a) DeepFold human and server models ranked at the top three in a row. (b) The predicted 3D structures of T1123 and the native structure (colored as green). Compared to AF2, the DeepFold prediction correctly predicts helix and <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula>-sheets near the C-terminal region, highlighted in blue. (c) The template 5EWO obtained by CRFalign shows a high structural similarity to the native structures (TM = 0.69) compared with the template in AF2 (TM = 0.31).</p>
      </caption>
      <graphic xlink:href="btad712f6" position="float"/>
    </fig>
    <sec>
      <title>3.1 What went wrong</title>
      <p>DFolding failed to generate correct fold for some targets especially for T1125 and T1130. T1125 was a challenging target, likely due to its large size of 1200 residues, which consists of 6 domains (five FM domains and one TBM-hard). Only a few groups achieved good scores (<ext-link xlink:href="https://predictioncenter.org/casp15/results.cgi?view=tb-sel" ext-link-type="uri">https://predictioncenter.org/casp15/results.cgi?view=tb-sel</ext-link>). For T1125-D1, the average GDT-TS of all groups was 28.44, but that of top three groups had scores around 80. The Neff score of MSA [i.e. represents a measure of the diversity or the effective number of sequences within the alignment, with higher scores indicating a more diverse set of sequences in the MSA (<xref rid="btad712-B31" ref-type="bibr">Meier and Söding 2014</xref>).] generated by AF2 standard was 1.39 with only five sequences including the target itself, resulting in low plddt scores ranging from 0.39 to 0.44. For the single domain target T1130 with 198 residues (FM domain), DFolding exhibited poor performance with 29.40 of GDT-TS along with most of the groups, while only 3 groups achieved around 95. For this target, the Neff score of AF2 is 0.0 with no additional homologous sequences. And no template structures were found as can be expected for an FM domain. It is highly probable that the three successful groups identified high-quality MSAs through their extended efforts for the target. We also attempted to generate MSAs using other available web servers, but with limited success. As a result, it appears that MSA quality is crucial for the successful prediction of structures using AF2-based methods.</p>
    </sec>
    <sec>
      <title>3.2 What went right</title>
      <p>We found that the improvement of DeepFold’s prediction accuracy can be attributed to the following three elements: modified loss functions, choice of better templates, and CSA re-optimizations. To begin with, the positive effect of modified loss functions is confirmed by ablation studies, as shown in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref>. To summarize, modified loss functions improved the side-chain accuracy while maintaining the backbone accuracy. The choice of better templates and alignments (partly through CRFalign) improved the backbone accuracy of the specific targets. Finally, CSA re-optimization improved backbone accuracy and molprobity scores through structure optimization.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>In this work, we have presented DeepFold, a pipeline for predicting protein structures. Our primary objective was to improve the accuracy of backbone and side-chain prediction, and we achieved this by making several modifications to the AF2 pipeline. These modifications included optimizing the loss functions with focus on torsion angle losses and additional loss functions introduced to improve side chain accuracy and secondary structure prediction with updated template features. Further re-optimization was performed by CSA using a molecular mechanics energy function which integrates the potential energies obtained from distogram and side-chain prediction. In the blind test at the CASP15 competition, DeepFold improves the details of the protein structure in both backbone and side-chains, ranking fourth in the category of Single Protein and Domain Modeling (109 domains). In addition, DeepFold’s structure prediction showed the best results in terms of backbone accuracy of GDT-TS for the targets in the TBM class (62 among 109 domains), which are more important in practical applications. Our thorough analysis of 55 domains with publicly available ground-truth structures revealed that DeepFold showed the best side-chain accuracy and Molprobity scores in the top-performing groups. It can be seen that the effect of modification and retraining of the DeepFold network and the final re-optimization have made significant differences. In particular, it can be seen that re-optimization further improves the details of protein structure such as backbone, side-chain and Molprobity.</p>
    <p>There remain limitations in predicting certain targets, such as very large target like T1125, and T1130 both with low-quality MSAs. This is due to the well-known fact that the performance of AF2-based methods is heavily dependent on the quality of MSAs. It is essential to evaluate the quality of the obtained MSA and enhance the quality of low-quality MSAs by employing techniques such as protein language models (<xref rid="btad712-B26" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>) or generative models (<xref rid="btad712-B28" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2022</xref>). Furthermore, in order to predict larger protein structures properly, reliable protein domain parsing must be considered.</p>
    <p>In conclusion, our work on DeepFold represents an improvement upon the foundation laid by AF2. Through our modifications to the AF2 pipeline, we have achieved higher accuracy in terms of backbones and side-chains. We believe that our work has advanced the field of protein structure prediction, which we expect to be a valuable tool for the protein modeling community.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad712_Supplementary_Data</label>
      <media xlink:href="btad712_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>We thank the KIAS Center for Advanced Computation for providing computing resources.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government (MSIT) [2021-0-02068, 2020-0-01373]; the Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Science and ICT (MSIT) [NRF-2018R1D1A1B07049312] and the 2023 KT ICT AI2XL Laboratory R&amp;D Fund project funded by KT [KT award B230000177].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article is available at <ext-link xlink:href="https://github.com/newtonjoo/deepfold" ext-link-type="uri">https://github.com/newtonjoo/deepfold</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad712-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adhikari</surname><given-names>B</given-names></string-name>, <string-name><surname>Hou</surname><given-names>J</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Protein contact prediction by integrating deep multiple sequence alignments, coevolution and machine learning</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017</year>;<volume>86</volume>:<fpage>84</fpage>–<lpage>96</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ahdritz</surname><given-names>G</given-names></string-name>, <string-name><surname>Bouatta</surname><given-names>N</given-names></string-name>, <string-name><surname>Kadyan</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal> Openfold: retraining alphafold2 yields new insights into its learning mechanisms and capacity for generalization. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.11.20.517210</pub-id>, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>, <string-name><surname>Madden</surname><given-names>TL</given-names></string-name>, <string-name><surname>Schäffer</surname><given-names>AA</given-names></string-name></person-group><etal>et al</etal><article-title>Gapped blast and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res</source><year>1997</year>;<volume>25</volume>:<fpage>3389</fpage>–<lpage>402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anfinsen</surname><given-names>CB.</given-names></string-name></person-group><article-title>Principles that govern the folding of protein chains</article-title>. <source>Science</source><year>1973</year>;<volume>181</volume>:<fpage>223</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">4124164</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baek</surname><given-names>M</given-names></string-name>, <string-name><surname>DiMaio</surname><given-names>F</given-names></string-name>, <string-name><surname>Anishchenko</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>Accurate prediction of protein structures and interactions using a three-track neural network</article-title>. <source>Science</source><year>2021</year>;<volume>373</volume>:<fpage>871</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">34282049</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bahdanau</surname><given-names>D</given-names></string-name>, <string-name><surname>Cho</surname><given-names>K</given-names></string-name>, <string-name><surname>Bengio</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal> Neural machine translation by jointly learning to align and translate. arXiv, arXiv:1409.0473, <year>2014</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Browne</surname><given-names>WJ</given-names></string-name>, <string-name><surname>North</surname><given-names>ACT</given-names></string-name>, <string-name><surname>Phillips</surname><given-names>DC</given-names></string-name></person-group><etal>et al</etal><article-title>A possible three-dimensional structure of bovine <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula>-lactalbumin based on that of hen’s egg-white lysozyme</article-title>. <source>J Mol Biol</source><year>1969</year>;<volume>42</volume>:<fpage>65</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">5817651</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Case</surname><given-names>DA</given-names></string-name>, <string-name><surname>Cheatham</surname><given-names>TE</given-names></string-name>, <string-name><surname>Darden</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>The amber biomolecular simulation programs</article-title>. <source>J Comput Chem</source><year>2005</year>;<volume>26</volume>:<fpage>1668</fpage>–<lpage>88</lpage>.<pub-id pub-id-type="pmid">16200636</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>S</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>X</given-names></string-name>, <string-name><surname>Lu</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal> Fastfold: reducing alphafold training time from 11 days to 67 hours. arXiv, arXiv: 2203.00854, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Croll</surname><given-names>TI</given-names></string-name>, <string-name><surname>Sammito</surname><given-names>MD</given-names></string-name>, <string-name><surname>Kryshtafovych</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Evaluation of template-based modeling in CASP13</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2019</year>;<volume>87</volume>:<fpage>1113</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kollman</surname><given-names>PA.</given-names></string-name></person-group><article-title>Pathways to a protein folding intermediate observed in a 1-microsecond simulation in aqueous solution</article-title>. <source>Science</source><year>1998</year>;<volume>282</volume>:<fpage>740</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">9784131</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ekeberg</surname><given-names>M</given-names></string-name>, <string-name><surname>Lövkvist</surname><given-names>C</given-names></string-name>, <string-name><surname>Lan</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Improved contact prediction in proteins: using pseudolikelihoods to infer potts models</article-title>. <source>Phys Rev E</source><year>2013</year>;<volume>87</volume>:<fpage>012707</fpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fang</surname><given-names>X</given-names></string-name>, <string-name><surname>Wang</surname><given-names>F</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>A method for multiple-sequence-alignment-free protein structure prediction using a protein language model</article-title>. <source>Nat Mach Intell</source><year>2023</year>;<volume>5</volume>:<fpage>1087</fpage>–<lpage>96</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ho</surname><given-names>J</given-names></string-name>, <string-name><surname>Jain</surname><given-names>A</given-names></string-name>, <string-name><surname>Abbeel</surname><given-names>P.</given-names></string-name></person-group> Denoising diffusion probabilistic models. <italic toggle="yes">Adv Neural Info Process Syst</italic> 2020;<volume>33</volume>:<fpage>6840</fpage>–<lpage>51</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hong</surname><given-names>SH</given-names></string-name>, <string-name><surname>Joung</surname><given-names>I</given-names></string-name>, <string-name><surname>Flores-Canales</surname><given-names>JC</given-names></string-name></person-group><etal>et al</etal><article-title>Protein structure modeling and refinement by global optimization in CASP12</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017</year>;<volume>86</volume>:<fpage>122</fpage>–<lpage>35</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>J</given-names></string-name>, <string-name><surname>Rauscher</surname><given-names>S</given-names></string-name>, <string-name><surname>Nawrocki</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>CHARMM36m: an improved force field for folded and intrinsically disordered proteins</article-title>. <source>Nat Methods</source><year>2016</year>;<volume>14</volume>:<fpage>71</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">27819658</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Johnson</surname><given-names>LS</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR</given-names></string-name>, <string-name><surname>Portugaly</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Hidden markov model speed heuristic and iterative hmm search procedure</article-title>. <source>BMC Bioinformatics</source><year>2010</year>;<volume>11</volume>:<fpage>431</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">20718988</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Joo</surname><given-names>K</given-names></string-name>, <string-name><surname>Lee</surname><given-names>J</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>High accuracy template based modeling by global optimization</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2007</year>;<volume>69</volume>:<fpage>83</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Highly accurate protein structure prediction with alphafold</article-title>. <source>Nature</source><year>2021</year>;<volume>596</volume>:<fpage>583</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kabsch</surname><given-names>W</given-names></string-name>, <string-name><surname>Sander</surname><given-names>C.</given-names></string-name></person-group><article-title>Dictionary of protein secondary structure: pattern recognition of hydrogen-bonded and geometrical features</article-title>. <source>Biopolymers</source><year>1983</year>;<volume>22</volume>:<fpage>2577</fpage>–<lpage>637</lpage>.<pub-id pub-id-type="pmid">6667333</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krogh</surname><given-names>A</given-names></string-name>, <string-name><surname>Brown</surname><given-names>M</given-names></string-name>, <string-name><surname>Mian</surname><given-names>IS</given-names></string-name></person-group><etal>et al</etal><article-title>Hidden Markov Models in computational biology: applications to protein modeling</article-title>. <source>J Mol Biol</source><year>1994</year>;<volume>235</volume>:<fpage>1501</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">8107089</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kwon</surname><given-names>S</given-names></string-name>, <string-name><surname>Won</surname><given-names>J</given-names></string-name>, <string-name><surname>Kryshtafovych</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Assessment of protein model structure accuracy estimation in CASP14: old and new challenges</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2021</year>;<volume>89</volume>:<fpage>1940</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>J</given-names></string-name>, <string-name><surname>Scheraga</surname><given-names>HA</given-names></string-name>, <string-name><surname>Rackovsky</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>New optimization method for conformational energy calculations on polypeptides: conformational space annealing</article-title>. <source>J Comput Chem</source><year>1997</year>;<volume>18</volume>:<fpage>1222</fpage>–<lpage>32</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Joo</surname><given-names>K</given-names></string-name>, <string-name><surname>Sim</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Crfalign: a sequence-structure alignment of proteins based on a combination of hmm-hmm comparison and conditional random fields</article-title>. <source>Molecules</source><year>2022</year>;<volume>27</volume>:<fpage>3711</fpage>.<pub-id pub-id-type="pmid">35744836</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B25">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Uni-fold: an open-source platform for developing protein folding models beyond alphafold</article-title>. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.08.04.502811</pub-id>, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Z</given-names></string-name>, <string-name><surname>Akin</surname><given-names>H</given-names></string-name>, <string-name><surname>Rao</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>. <source>Science</source><year>2023</year>;<volume>379</volume>:<fpage>1123</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">36927031</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Guo</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wu</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Improving alphafold2-based protein tertiary structure prediction with multicom in CASP15</article-title>. <source>Commun Chem</source><year>2023</year>;<volume>6</volume>:<fpage>188</fpage>.<pub-id pub-id-type="pmid">37679431</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B28">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>L</given-names></string-name>, <string-name><surname>Liu</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal> De novo protein backbone generation based on diffusion with structured priors and adversarial training. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.12.17.520847</pub-id>, <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad712-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mariani</surname><given-names>V</given-names></string-name>, <string-name><surname>Kiefer</surname><given-names>F</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Assessment of template based protein structure predictions in CASP9</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2011</year>;<volume>79</volume>:<fpage>37</fpage>–<lpage>58</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McGuffin</surname><given-names>LJ</given-names></string-name>, <string-name><surname>Edmunds</surname><given-names>NS</given-names></string-name>, <string-name><surname>Genc</surname><given-names>AG</given-names></string-name></person-group><etal>et al</etal><article-title>Prediction of protein structures, functions and interactions using the intFOLD7, multifold and modfolddock servers</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>W274</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">37102670</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meier</surname><given-names>A</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J.</given-names></string-name></person-group><article-title>Context similarity scoring improves protein sequence alignments in the midnight zone</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>31</volume>:<fpage>674</fpage>–<lpage>81</lpage>.<pub-id pub-id-type="pmid">25338715</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Millán</surname><given-names>C</given-names></string-name>, <string-name><surname>Keegan</surname><given-names>RM</given-names></string-name>, <string-name><surname>Pereira</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Assessing the utility of CASP14 models for molecular replacement</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2021</year>;<volume>89</volume>:<fpage>1752</fpage>–<lpage>69</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mirdita</surname><given-names>M</given-names></string-name>, <string-name><surname>von den Driesch</surname><given-names>L</given-names></string-name>, <string-name><surname>Galiez</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Uniclust databases of clustered and deeply annotated protein sequences and alignments</article-title>. <source>Nucleic Acids Res</source><year>2017</year>;<volume>45</volume>:<fpage>D170</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">27899574</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mirdita</surname><given-names>M</given-names></string-name>, <string-name><surname>Schütze</surname><given-names>K</given-names></string-name>, <string-name><surname>Moriwaki</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Colabfold: making protein folding accessible to all</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>679</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">35637307</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morcos</surname><given-names>F</given-names></string-name>, <string-name><surname>Pagnani</surname><given-names>A</given-names></string-name>, <string-name><surname>Lunt</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>. <source>Proc Natl Acad Sci USA</source><year>2011</year>;<volume>108</volume>:<fpage>E1293</fpage>–<lpage>301</lpage>.<pub-id pub-id-type="pmid">22106262</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B36">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Nolle</surname><given-names>T</given-names></string-name>, <string-name><surname>Seeliger</surname><given-names>A</given-names></string-name>, <string-name><surname>Thoma</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal> Deepalign: alignment-based process anomaly correction using recurrent neural networks. In: Dustdar S, Yu E, Salinesi C et al. (eds), <italic toggle="yes">Advanced Information Systems Engineering: 32nd International Conference, CAiSE 2020</italic>, June 8–12, 2020. Grenoble, France: Springer, <year>2020</year>, <fpage>319</fpage>–<lpage>33</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oda</surname><given-names>T.</given-names></string-name></person-group><article-title>Improving protein structure prediction with extended sequence similarity searches and deep-learning-based refinement in CASP15</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2023</year>;<volume>91</volume>:<fpage>1712</fpage>–<lpage>23</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Olechnovič</surname><given-names>K</given-names></string-name>, <string-name><surname>Kulberkytė</surname><given-names>E</given-names></string-name>, <string-name><surname>Venclovas</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Cad-score: a new contact area difference-based function for evaluation of protein structural models</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2013</year>;<volume>81</volume>:<fpage>149</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ovchinnikov</surname><given-names>S</given-names></string-name>, <string-name><surname>Park</surname><given-names>H</given-names></string-name>, <string-name><surname>Kim</surname><given-names>DE</given-names></string-name></person-group><etal>et al</etal><article-title>Protein structure prediction using rosetta in CASP12</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017</year>;<volume>86</volume>:<fpage>113</fpage>–<lpage>21</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pearce</surname><given-names>R</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name></person-group><article-title>Toward the solution of the protein structure prediction problem</article-title>. <source>J Biol Chem</source><year>2021</year>;<volume>297</volume>:<fpage>100870</fpage>.<pub-id pub-id-type="pmid">34119522</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B41">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>J</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J.</given-names></string-name></person-group> Boosting protein threading accuracy. In: Batzoglou S (ed.), <italic toggle="yes">Research in Computational Molecular Biology: 13th Annual International Conference, RECOMB 2009</italic>, May 18–21, 2009. Tucson, AZ, USA: Springer, <year>2009</year>, <fpage>31</fpage>–<lpage>45</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Hong</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Improved protein structure prediction with trrosettaX2, alphafold2, and optimized msas in CASP15</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2023</year>;<volume>91</volume>:<fpage>1704</fpage>–<lpage>11</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pereira</surname><given-names>J</given-names></string-name>, <string-name><surname>Simpkin</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Hartmann</surname><given-names>MD</given-names></string-name></person-group><etal>et al</etal><article-title>High-accuracy protein structure prediction in CASP14</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2021</year>;<volume>89</volume>:<fpage>1687</fpage>–<lpage>99</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Read</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Chavali</surname><given-names>G.</given-names></string-name></person-group><article-title>Assessment of CASP7 predictions in the high accuracy template-based modeling category</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2007</year>;<volume>69</volume>:<fpage>27</fpage>–<lpage>37</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Remmert</surname><given-names>M</given-names></string-name>, <string-name><surname>Biegert</surname><given-names>A</given-names></string-name>, <string-name><surname>Hauser</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Hhblits: lightning-fast iterative protein sequence searching by hmm-hmm alignment</article-title>. <source>Nat Methods</source><year>2012</year>;<volume>9</volume>:<fpage>173</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Richardson</surname><given-names>L</given-names></string-name>, <string-name><surname>Allen</surname><given-names>B</given-names></string-name>, <string-name><surname>Baldi</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>MGnify: the microbiome sequence data analysis resource in 2023</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>D753</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">36477304</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robustelli</surname><given-names>P</given-names></string-name>, <string-name><surname>Piana</surname><given-names>S</given-names></string-name>, <string-name><surname>Shaw</surname><given-names>DE</given-names></string-name></person-group><etal>et al</etal><article-title>Developing a molecular dynamics force field for both folded and disordered protein states</article-title>. <source>Proc Natl Acad Sci USA</source><year>2018</year>;<volume>115</volume>:<fpage>E4758</fpage>–<lpage>66</lpage>.<pub-id pub-id-type="pmid">29735687</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Šali</surname><given-names>A</given-names></string-name>, <string-name><surname>Blundell</surname><given-names>TL.</given-names></string-name></person-group><article-title>Comparative protein modelling by satisfaction of spatial restraints</article-title>. <source>J Mol Biol</source><year>1993</year>;<volume>234</volume>:<fpage>779</fpage>–<lpage>815</lpage>.<pub-id pub-id-type="pmid">8254673</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Senior</surname><given-names>AW</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Jumper</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Improved protein structure prediction using potentials from deep learning</article-title>. <source>Nature</source><year>2020</year>;<volume>577</volume>:<fpage>706</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">31942072</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B50">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>Y</given-names></string-name>, <string-name><surname>Sohl-Dickstein</surname><given-names>J</given-names></string-name>, <string-name><surname>Kingma</surname><given-names>DP</given-names></string-name></person-group><etal>et al</etal> Score-based generative modeling through stochastic differential equations. <italic toggle="yes">International Conference on Learning Representations,</italic> 2021.</mixed-citation>
    </ref>
    <ref id="btad712-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M</given-names></string-name>, <string-name><surname>Mirdita</surname><given-names>M</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Protein-level assembly increases protein sequence recovery from metagenomic samples manyfold</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>:<fpage>603</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">31235882</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Suzek</surname><given-names>BE</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Huang</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal>; <collab>UniProt Consortium</collab>. <article-title>Uniref clusters: a comprehensive and scalable alternative for improving sequence similarity searches</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>926</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">25398609</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B53">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Trippe</surname><given-names>BL</given-names></string-name>, <string-name><surname>Yim</surname><given-names>J</given-names></string-name>, <string-name><surname>Tischer</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal> Diffusion probabilistic modeling of protein backbones in 3d for the motif-scaffolding problem. <italic toggle="yes">International Conference on Learning Representations,</italic> 2023.</mixed-citation>
    </ref>
    <ref id="btad712-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vaswani</surname><given-names>A</given-names></string-name>, <string-name><surname>Shazeer</surname><given-names>N</given-names></string-name>, <string-name><surname>Parmar</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>Attention is all you need</article-title>. <source>Adv Neural Inf Process Syst</source><year>2017</year>;<volume>30</volume>. <ext-link xlink:href="https://papers.nips.cc/paper_files/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html" ext-link-type="uri">https://papers.nips.cc/paper_files/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad712-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>S</given-names></string-name>, <string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Accurate de novo prediction of protein contact map by ultra-deep learning model</article-title>. <source>PLoS Comput Biol</source><year>2017a</year>;<volume>13</volume>:<fpage>e1005324</fpage>.<pub-id pub-id-type="pmid">28056090</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>S</given-names></string-name>, <string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Analysis of deep learning methods for blind protein contact prediction in CASP12</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017b</year>;<volume>86</volume>:<fpage>67</fpage>–<lpage>77</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Watson</surname><given-names>JL</given-names></string-name>, <string-name><surname>Juergens</surname><given-names>D</given-names></string-name>, <string-name><surname>Bennett</surname><given-names>NR</given-names></string-name></person-group><etal>et al</etal><article-title>De novo design of protein structure and function with RFdiffusion</article-title>. <source>Nature</source><year>2023</year>;<volume>620</volume>:<fpage>1089</fpage>–<lpage>100</lpage>.<pub-id pub-id-type="pmid">37433327</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weissenow</surname><given-names>K</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Protein language-model embeddings for fast, accurate, and alignment-free protein structure prediction</article-title>. <source>Structure</source><year>2022</year>;<volume>30</volume>:<fpage>1169</fpage>–<lpage>77.e4</lpage>.<pub-id pub-id-type="pmid">35609601</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>F</given-names></string-name>, <string-name><surname>Jing</surname><given-names>X</given-names></string-name>, <string-name><surname>Luo</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>Improving protein structure prediction using templates and sequence embedding</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>39</volume>:<fpage>btac723</fpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>York</surname><given-names>RL</given-names></string-name>, <string-name><surname>Yousefi</surname><given-names>PA</given-names></string-name>, <string-name><surname>Bogdanoff</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Structural, mechanistic, and antigenic characterization of the human astrovirus capsid</article-title>. <source>J Virol</source><year>2016</year>;<volume>90</volume>:<fpage>2254</fpage>–<lpage>63</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C</given-names></string-name>, <string-name><surname>Mortuza</surname><given-names>SM</given-names></string-name>, <string-name><surname>He</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Template-based and free modeling of i-TASSER and QUARK pipelines using predicted contact maps in CASP12</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2017</year>;<volume>86</volume>:<fpage>136</fpage>–<lpage>51</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Liang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Atomic-level protein structure refinement using fragment-guided molecular dynamics conformation sampling</article-title>. <source>Structure</source><year>2011</year>;<volume>19</volume>:<fpage>1784</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">22153501</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Skolnick</surname><given-names>J.</given-names></string-name></person-group><article-title>TM-align: a protein structure alignment algorithm based on the TM-score</article-title>. <source>Nucleic Acids Res</source><year>2005</year>;<volume>33</volume>:<fpage>2302</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">15849316</pub-id></mixed-citation>
    </ref>
    <ref id="btad712-B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>W</given-names></string-name>, <string-name><surname>Wuyun</surname><given-names>Q</given-names></string-name>, <string-name><surname>Freddolino</surname><given-names>PL</given-names></string-name></person-group><etal>et al</etal><article-title>Integrating deep learning, threading alignments, and a multi-msa strategy for high-quality protein monomer and complex structure prediction in CASP15</article-title>. <source>Proteins Struct Funct Bioinform</source><year>2023</year>;<volume>91</volume>:<fpage>1684</fpage>–<lpage>703</lpage>.</mixed-citation>
    </ref>
    <ref id="btad712-B65">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zhong</surname><given-names>B</given-names></string-name>, <string-name><surname>Su</surname><given-names>X</given-names></string-name>, <string-name><surname>Wen</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal> Parafold: paralleling alphafold for large-scale predictions. <italic toggle="yes">International Conference on High Performance Computing in Asia-Pacific Region Workshops,</italic> 2021.</mixed-citation>
    </ref>
  </ref-list>
</back>
