<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7355301</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa458</article-id>
    <article-id pub-id-type="publisher-id">btaa458</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics of Microbes and Microbiomes</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ganon: precise metagenomics classification against large and up-to-date sets of reference sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Piro</surname>
          <given-names>Vitor C</given-names>
        </name>
        <xref ref-type="aff" rid="btaa458-aff1">b1</xref>
        <xref ref-type="aff" rid="btaa458-aff2">b2</xref>
        <xref ref-type="aff" rid="btaa458-aff3">b3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dadi</surname>
          <given-names>Temesgen H</given-names>
        </name>
        <xref ref-type="aff" rid="btaa458-aff4">b4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Seiler</surname>
          <given-names>Enrico</given-names>
        </name>
        <xref ref-type="aff" rid="btaa458-aff4">b4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reinert</surname>
          <given-names>Knut</given-names>
        </name>
        <xref ref-type="aff" rid="btaa458-aff4">b4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Renard</surname>
          <given-names>Bernhard Y</given-names>
        </name>
        <xref ref-type="aff" rid="btaa458-aff1">b1</xref>
        <xref ref-type="aff" rid="btaa458-aff3">b3</xref>
        <xref ref-type="corresp" rid="btaa458-cor1"/>
        <!--<email>bernhard.renard@hpi.de</email>-->
      </contrib>
    </contrib-group>
    <aff id="btaa458-aff1"><label>b1</label><institution>Bioinformatics Unit (MF1), Robert Koch Institute</institution>, Berlin 13353, <country country="DE">Germany</country></aff>
    <aff id="btaa458-aff2"><label>b2</label><institution>CAPES Foundation, Ministry of Education of Brazil</institution>, Brasília 70040-020, <country country="BR">Brazil</country></aff>
    <aff id="btaa458-aff3"><label>b3</label><institution>Data Analytics and Computational Statistics</institution>, Hasso Plattner Insititute, Digital Engineering Faculty, University of Potsdam, Potsdam 14482, <country country="DE">Germany</country></aff>
    <aff id="btaa458-aff4"><label>b4</label><institution>Department of Mathematics and Computer Science, Freie Universität Berlin</institution>, Berlin 14195, <country country="DE">Germany</country></aff>
    <author-notes>
      <corresp id="btaa458-cor1">To whom correspondence should be addressed. E-mail: <email>bernhard.renard@hpi.de</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-07-13">
      <day>13</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISMB 2020 Proceedings</issue-title>
    <fpage>i12</fpage>
    <lpage>i20</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa458.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The exponential growth of assembled genome sequences greatly benefits metagenomics studies. However, currently available methods struggle to manage the increasing amount of sequences and their frequent updates. Indexing the current RefSeq can take days and hundreds of GB of memory on large servers. Few methods address these issues thus far, and even though many can theoretically handle large amounts of references, time/memory requirements are prohibitive in practice. As a result, many studies that require sequence classification use often outdated and almost never truly up-to-date indices.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Motivated by those limitations, we created ganon, a <italic>k</italic>-mer-based read classification tool that uses Interleaved Bloom Filters in conjunction with a taxonomic clustering and a <italic>k</italic>-mer counting/filtering scheme. Ganon provides an efficient method for indexing references, keeping them updated. It requires &lt;55 min to index the complete RefSeq of bacteria, archaea, fungi and viruses. The tool can further keep these indices up-to-date in a fraction of the time necessary to create them. Ganon makes it possible to query against very large reference sets and therefore it classifies significantly more reads and identifies more species than similar methods. When classifying a high-complexity CAMI challenge dataset against complete genomes from RefSeq, ganon shows strongly increased precision with equal or better sensitivity compared with state-of-the-art tools. With the same dataset against the complete RefSeq, ganon improved the <italic>F</italic>1-score by 65% at the genus level. It supports taxonomy- and assembly-level classification, multiple indices and hierarchical classification.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The software is open-source and available at: <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/rki_bioinformatics/ganon">https://gitlab.com/rki_bioinformatics/ganon</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>CAPES - Ciência sem Fronteiras</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BEX 13472/13-5</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>BMBF</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002347</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>BMBF</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002347</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Network for Bioinformatics Infrastructure</institution>
          </institution-wrap>
        </funding-source>
        <award-id>031A537B</award-id>
        <award-id>031A533A</award-id>
        <award-id>031A538A</award-id>
        <award-id>031A533B</award-id>
        <award-id>031A535A</award-id>
        <award-id>031A537C</award-id>
        <award-id>031A534A</award-id>
        <award-id>031A532B</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Reference- and taxonomy-based short-read classification is a fundamental task in metagenomics. Defining the origin of each read from an environmental sample, which can be done during (<xref rid="btaa458-B29" ref-type="bibr">Tausch <italic>et al.</italic>, 2018</xref>) or after sequencing, is usually the first step prior to abundance estimation, profiling and assembly. Over the last years many tools have been specifically developed for this task (<xref rid="btaa458-B16" ref-type="bibr">Lindgreen <italic>et al.</italic>, 2016</xref>; <xref rid="btaa458-B17" ref-type="bibr">McIntyre <italic>et al.</italic>, 2017</xref>; <xref rid="btaa458-B22" ref-type="bibr">Oulas <italic>et al.</italic>, 2015</xref>; <xref rid="btaa458-B25" ref-type="bibr">Peabody <italic>et al.</italic>, 2015</xref>; <xref rid="btaa458-B28" ref-type="bibr">Sczyrba <italic>et al.</italic>, 2017</xref>) with different strategies to achieve good performance classifying a large amount of short reads against a predefined and static set of reference sequences. Many of those approaches are taxonomy-based (<xref rid="btaa458-B1" ref-type="bibr">Balvočiūtė and Huson, 2017</xref>) and use this classification to better understand the composition of samples.</p>
    <p>The amount of complete or draft genomic sequences in public repositories is rapidly growing due to advances in genome sequencing, improvements in read quality, length and coverage and also better algorithms for genome assembly. In addition, many partial and complete genome sequences come directly from metagenome-assembled genomes (<xref rid="btaa458-B20" ref-type="bibr">Mukherjee <italic>et al.</italic>, 2017</xref>; <xref rid="btaa458-B24" ref-type="bibr">Parks <italic>et al.</italic>, 2017</xref>; <xref rid="btaa458-B31" ref-type="bibr">Tully <italic>et al.</italic>, 2018</xref>), a technique that boosts the growth of public repositories. This considerable amount of references poses a sizeable challenge for current tools that, in general, are not designed to deal with such amounts of data (<xref rid="btaa458-B21" ref-type="bibr">Nasko <italic>et al.</italic>, 2018</xref>). They also increase the already high computational cost of assigning millions of short reads to taxonomic targets.</p>
    <p>Using GenBank (<xref rid="btaa458-B2" ref-type="bibr">Benson <italic>et al.</italic>, 2018</xref>) and RefSeq (<xref rid="btaa458-B11" ref-type="bibr">Haft <italic>et al.</italic>, 2018</xref>) repositories as an example, we see an exponential data growth (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). Within an interval of two and a half years (from June 2015 to December 2018) the RefSeq Microbial of complete genomes (CG) grew more than 4 times, with 2.5 times more species represented in the most recent set (1529–3850). Looking at the same data point (end of 2018), the complete RefSeq Microbial has &gt;12 times base pairs and &gt;5 times species compared to the CG set. These data exemplify that databases are growing fast and the variation among them is significant. These repositories are becoming too big to be analyzed by standard hardware and if the observed growth continues, all this wealth of data will be constrained to just a few groups with resources available to process them.</p>
    <p>The choice of the data to perform reference-based classification is an important step and a known issue in metagenomics (<xref rid="btaa458-B4" ref-type="bibr">Breitwieser <italic>et al.</italic>, 2019</xref>). As a rule of thumb, the more sequences the better the classification. But even complete sets of sequences are not evenly distributed throughout the taxonomic tree, such that different taxa are represented in different levels of quantity and quality. In addition, most of the taxa are still unknown and do not have any genomic sequence or entry in the taxonomic tree. This requires the tools to consistently remain up-to-date with the latest releases of public repositories, a task that is not trivial when dealing with very large amounts of sequences. Most of the tools lack the ability to update their own indices and databases, and currently many analyses are performed with outdated resources.</p>
    <p>For example, the RefSeq Microbial repository from the beginning of 2018 is 10% less taxonomic diverse than it is today (mid-2019). An even older RefSeq release from June 2015 lacks 27% of today’s taxonomic diversity. Further, a commonly used subset of RefSeq, the microbialCG, covers only 15% of the available diversity of the full repository (December 2018). As an example, the latest release of kraken’s (<xref rid="btaa458-B32" ref-type="bibr">Wood and Salzberg, 2014</xref>) MiniKraken database (as of October 18, 2017) based on complete bacterial, archaeal and viral genomes, although helpful to obtain fast insights on community composition, comprises only 11% of the total taxonomic diversity available on the latest RefSeq release from January 4, 2019. Metagenomics analyses based on those releases are prone to underperform and miss potential species of interest. However, the use of outdated references or ‘pre-built’ indices is still common practice (<xref rid="btaa458-B15" ref-type="bibr">Li <italic>et al.</italic>, 2018</xref>). Most methods are able to build custom databases but unable to update them. Weekly or daily updates with the most recent data are almost impossible given the time requirements to re-build those indices.</p>
    <p>The sequence classifiers MetaPhlAn (<xref rid="btaa458-B30" ref-type="bibr">Truong <italic>et al.</italic>, 2015</xref>) and Kaiju (<xref rid="btaa458-B18" ref-type="bibr">Menzel <italic>et al.</italic>, 2016</xref>) created alternatives to cover most of the diversity contained in public sequence repositories by selecting a subset of marker genes and protein sequences, respectively. On one hand, those methods are very powerful, such that they provide fast and precise community profiles given their reduced index sizes. On the other hand, when analyzing whole-genome sequences of complex environments, organisms with low abundance are easily missed due to their lack of complete genomic coverage. In addition, current methods using complete genome sequences struggle with the present amount of available data (<xref rid="btaa458-B21" ref-type="bibr">Nasko <italic>et al.</italic>, 2018</xref>).</p>
    <p>Given these limitations, we developed ganon, a new reference and taxonomy-based short-read classification tool for metagenomics. Ganon uses Interleaved Bloom Filters (IBFs) (<xref rid="btaa458-B8" ref-type="bibr">Dadi <italic>et al.</italic>, 2018</xref>) to represent very large amounts of sequences into a searchable index. This enables the indexing of large sets of references (e.g. complete RefSeq) in faster time and with low memory consumption, consequently improving read classification for whole metagenomics sequencing experiments. Ganon also provides updatable indices, which can incorporate new released sequences in short time. The classification method, which is based on the <italic>k</italic>-mer counting lemma and a progressive filtering step, improves sensitivity and precision compared to state-of-the-art tools when using larger sets of references. Ganon was developed in C++ using the SeqAn library (<xref rid="btaa458-B27" ref-type="bibr">Reinert <italic>et al.</italic>, 2017</xref>) and Python. The code is open-source and freely available from: <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/rki_bioinformatics/ganon">https://gitlab.com/rki_bioinformatics/ganon</ext-link>.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Overview</title>
      <p>Ganon classifies reads against a set of reference sequences to find their exact or closest taxonomic origin. The method can also work in a further specialized level (e.g. assembly). Clustering and indexing steps are necessary before classification, where the reference sequences will be grouped into taxonomic groups and processed into a searchable index. Ganon indices store all <italic>k</italic>-mers present in the reference sequences into a specialized type of Bloom filter. Once the index is created, ganon classifies the reads based on the <italic>k</italic>-mer counting lemma together with a post-filtering step providing a unique or multiple classifications for each read. Multiple classifications are solved optionally with the lowest common ancestor (LCA) algorithm (<xref rid="btaa458-B12" ref-type="bibr">Huson <italic>et al.</italic>, 2007</xref>). The following sections will further explain each of these steps in detail.</p>
    </sec>
    <sec>
      <title>2.2 Indexing</title>
      <p>Ganon indices are based on the <italic>k</italic>-mer content of the reference sequences, in other words, it uses all possible substrings of length <italic>k</italic> of the given sequences. Instead of using standard methods for <italic>k</italic>-mer storage, which can have high memory and space consumption when <italic>k</italic> is high (&gt;15), we opted for Bloom filters (<xref rid="btaa458-B3" ref-type="bibr">Bloom, 1970</xref>), a space-efficient probabilistic data structure. Since the goal of the tool is to classify sequences based on their taxonomic origin, multiple Bloom filters would be necessary to represent each distinct group of sequences belonging to a certain taxonomic level (e.g. species). This approach provides a straightforward but impractical solution since it requires classification against multiple filters. This is solved by interleaving the Bloom filters, a technique previously described for the DREAM-Yara tool (<xref rid="btaa458-B8" ref-type="bibr">Dadi <italic>et al.</italic>, 2018</xref>) and also part of the SeqAn library (<xref rid="btaa458-B27" ref-type="bibr">Reinert <italic>et al.</italic>, 2017</xref>). TaxSBP is used to separate sequences into taxonomic groups and to distribute them better into equal-sized clusters.</p>
      <sec>
        <label>2.2.1</label>
        <title>TaxSBP</title>
        <p>TaxSBP (<ext-link ext-link-type="uri" xlink:href="https://github.com/pirovc/taxsbp">https://github.com/pirovc/taxsbp</ext-link>) uses the NCBI Taxonomy database (<xref rid="btaa458-B9" ref-type="bibr">Federhen, 2012</xref>) to generate clusters of sequences that are close together in the taxonomic tree. It does this based on an implementation of the approximation algorithm for the hierarchically structured bin packing problem (<xref rid="btaa458-B7" ref-type="bibr">Codenotti <italic>et al.</italic>, 2004</xref>). As defined by Codenotti <italic>et al.</italic> this clustering method ‘[..] can be defined as the problem of distributing hierarchically structured objects into different repositories in a way that the access to subsets of related objects involves as few repositories as possible’, where the objects are sequences assigned to taxonomic nodes of the taxonomic tree. Sequences are clustered together into groups limited by a maximum sequence length size of its components. Splitting sequences into smaller chunks with overlapping ends is supported. TaxSBP supports one level of specialization after the leaf nodes of the tree, making it possible to further cluster sequences by strain or assembly information that is not directly contained in the NCBI Taxonomy database (<xref ref-type="fig" rid="btaa458-F1">Fig. 1A</xref>). TaxSBP can also pre-cluster members of a certain taxonomic level, preventing them to be split among clusters. It can further generate clusters with exclusive ranks, which are guaranteed to be unique in their cluster. The tool was developed alongside the distributed indices concept (<xref rid="btaa458-B8" ref-type="bibr">Dadi <italic>et al.</italic>, 2018</xref>) and supports the update of pre-generated clusters. Since TaxSBP uses the ‘pre-clustered’ taxonomic tree information, the algorithm is very efficient and requires very few computational resources, thus, having potential use in many other bioinformatics applications.
</p>
        <fig id="btaa458-F1" orientation="portrait" position="float">
          <label>Fig. 1.</label>
          <caption>
            <p>Ganon methodology overview. (<bold>A</bold>) Empty circles are inner nodes of the tree; ‘x’ circles are leaf nodes (referenced in this manuscript as taxid nodes); full lines represent taxonomic relations, dotted lines represent the extension of the taxonomy to the assembly and sequence levels. Species+ represents all taxonomic groups that are more specific than species with species in the lineage (e.g. subspecies, species group, no rank). (<bold>B</bold>) A toy example of sequences clustered by species into equal-sized groups, performed by TaxSBP. (<bold>C</bold>) Sequences are fragmented into <italic>k</italic>-mers and with a given number of hash functions, those <italic>k</italic>-mers are inserted into equal-sized bit vectors (Bloom Filters). (<bold>D</bold>) The IBF, representing the previously generated bit vectors with each bit interleaved. (<bold>E</bold>) Classification of short reads (black lines) against the IBF. Reads are fragmented into <italic>k</italic>-mers, counted with the same hash functions against the IBF, filtered and assigned to one or more species followed by LCA assignment for multiple matches</p>
          </caption>
          <graphic xlink:href="btaa458f1"/>
        </fig>
      </sec>
      <sec>
        <label>2.2.2</label>
        <title>IBF</title>
        <p>A Bloom filter is a probabilistic data structure that comprises a bit vector and a set of hash functions. Each of the functions maps a key value (<italic>k</italic>-mer in our application) to one of the bit positions in the vector. Collisions in the vector are possible, meaning that distinct <italic>k</italic>-mers can be set to the same bit positions in the vector. Those overlaps can be avoided with a larger bit vector, thus, reducing the probability of false positives.</p>
        <p>An IBF is a combination of several (<italic>b</italic>) Bloom filters of the same size (<italic>n</italic>) with the same hash functions into one bit vector (<xref ref-type="fig" rid="btaa458-F1">Fig. 1D</xref>). Each <italic>i</italic>-th bit of every Bloom filter is interleaved, resulting in a final IBF of size <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mi>b</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>. Querying in this data structure is possible by retrieving the sub-bit vectors for every hash function and merging them with a logical <italic>AND</italic> operation, which will result in a final bit vector indicating the membership for the query, as depicted in <xref ref-type="fig" rid="btaa458-F2">Figure 2</xref> in the DREAM-Yara manuscript by Dadi <italic>et al.</italic><xref rid="btaa458-B8" ref-type="bibr">(2018)</xref>.
</p>
        <fig id="btaa458-F2" orientation="portrait" position="float">
          <label>Fig. 2.</label>
          <caption>
            <p>Cumulative-based precision, sensitivity and <italic>F</italic>1-score values at all ranks for the simulated reads against all evaluated reference sets (blue = RefSeq-OLD, orange = RefSeq-CG-top-3 and red = RefSeq-ALL-top-3)</p>
          </caption>
          <graphic xlink:href="btaa458f2"/>
        </fig>
        <p>Aiming at the classification based on taxonomic levels (e.g. species, genus,…) or assembly level, TaxSBP is set to cluster the input sequences into exclusive groups (<xref ref-type="fig" rid="btaa458-F1">Fig. 1B</xref>). Every group will contain only sequences belonging to the same taxon or assembly unit, but the same unit can be split into several groups. Groups are limited by a predefined threshold of the sum of the base pair length of its elements and sequences can be sliced into smaller pieces to better generate equal-sized clusters.</p>
        <p>Each of those clusters will correspond to a single Bloom filter that is interleaved in a final IBF (<xref ref-type="fig" rid="btaa458-F1">Fig. 1C and D</xref>). Here, a trade-off between the number of groups, their maximum size and the <italic>k</italic>-mer content of each group is important. The false-positive rate of a Bloom filter depends mainly on its bit-vector size and the number of inserted elements. In general, the more base pairs a particular cluster has, the higher the number of distinct <italic>k</italic>-mers. This requires the Bloom filter to be bigger in order to achieve low false-positive rates when querying. In ganon indices, the group with the most unique <italic>k</italic>-mers will define the size and the maximum false-positive rate of the final IBF since all groups have to be equal-sized by definition. Thus, the previous clustering step is crucial to achieve a good trade-off between the number of groups, their sizes and <italic>k</italic>-mer content. The lower the taxonomic level, the more fragmented the clusters. For example, if a reference set has 2000 species groups, there will be at least the same number of clusters when building at the species level. The higher the taxonomic level, the fewer the number of clusters, since they can be grouped together, thereby producing smaller filters. This trade-off and parameterization is automatically calculated by ganon, with a single option to define the maximum memory available to build an index.</p>
        <p>The IBF has an inherent capability of updating since it is fragmented into many sub-parts. Adding new sequences to a previously generated IBF is as easy as setting the bit positions of the <italic>k</italic>-mers from the new sequences to their known clusters or appending new clusters to the existing filter. To remove sequences from the IBF, all bit positions of the updated cluster are set to zero and the cluster is re-created from the updated content.</p>
        <p>The IBF is the main data structure for ganon indices to perform alignment-free classification while DREAM-Yara, the tool that originally proposed the IBF, is a read mapper that uses the same data structure to filter reads to further perform distributed alignment. At the end of the building process, the ganon index will consist of an IBF based on a maximum classification level chosen (taxonomic rank or assembly) and auxiliary files for the classification step.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Classifying</title>
      <p>The read classification is based on the well-studied <italic>k</italic>-mer counting lemma [<italic>q</italic>-gram lemma (<xref rid="btaa458-B13" ref-type="bibr">Jokinen and Ukkonen, 1991</xref>; <xref rid="btaa458-B26" ref-type="bibr">Reinert <italic>et al.</italic>, 2015</xref>)]. All <italic>k</italic>-mers from given reads are looked up on the indices previously generated. If a minimum number of matches between the read and the reference is achieved, a read is considered classified. Based on incremental error rates, multiple classifications for each read are filtered out and only the best ones are selected. When the filtering cannot define a single origin for a read, an optional LCA step is applied to join multiple matching reads into their LCA node in the taxonomic tree.</p>
      <sec>
        <label>2.3.1</label>
        <title><italic>K</italic>-mer counting lemma</title>
        <p>The <italic>k</italic>-mer counting lemma can be defined as the minimum number of <italic>k</italic>-mer sequences of a read that should match against reference <italic>k</italic>-mers in order to be considered present in a set with a certain number of errors allowed. Given a read, <italic>R</italic>, with length <italic>l</italic>, the number of possible <italic>k</italic>-mers with length <italic>k</italic> in this read can be defined as:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mi mathvariant="normal">kmer</mml:mi><mml:msub><mml:mi mathvariant="normal">s</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1.</mml:mn></mml:mrow></mml:math></disp-formula></p>
        <p>Based on the <italic>q</italic>-gram lemma, an approximate occurrence of <italic>R</italic> in a set of references has to share at least
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mi mathvariant="normal">kcoun</mml:mi><mml:msub><mml:mi mathvariant="normal">t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">kmer</mml:mi><mml:msub><mml:mi mathvariant="normal">s</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>·</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></disp-formula><italic>k</italic>-mers, where <italic>e</italic> is the maximum number of errors/mismatches allowed.</p>
      </sec>
      <sec>
        <label>2.3.2</label>
        <title>Filtering</title>
        <p>A read can be assigned to multiple references with different error rates, thus, a filtering step is necessary to decrease the number of false assignments. The applied <italic>k</italic>-mer counting lemma provides <italic>k</italic>-mer counts for each read against the reference sequences. From this count, it is possible to estimate the number of mismatches a read has. For example, for <italic>k</italic> = 19 and length =100, a read with 50 19-mers matching a certain reference will optimally have 2 mismatches. This calculation can be achieved by solving the <xref ref-type="disp-formula" rid="E2">Equation (2)</xref> for <italic>e</italic>.</p>
        <p>Assuming that reads with fewer mismatches have a higher chance of being correct, the following filtering is applied: first, only matches against references with no mismatches are kept (all <italic>k</italic>-mers matching). If there are no such assignments, matches with only one error are kept. If there are none, matches with only two errors are kept and so on up to the maximum number of errors allowed [<italic>e</italic> in <xref ref-type="disp-formula" rid="E2">Equation (2)]</xref>. Similar filtration methods (also known as mapping by strata) were previously used in read mappers, such as Yara (<xref rid="btaa458-B8" ref-type="bibr">Dadi <italic>et al.</italic>, 2018</xref>). If a read is classified in several references within the same range of errors, they are all reported since it is not possible to define which one has a higher chance of being correct based on the <italic>k</italic>-mer count information. Given our clustering approach, some groups can share the same identification target (e.g. one species was split in two or more clusters due to a large amount of sequences). These cases are treated specially by reporting only the match with more <italic>k</italic>-mer similarities since they belong to the same classification group.</p>
        <p>Ganon also provides a way to further filter the unique classifications with a different error rate for reads that matched against just one reference group. This filter will be applied after the standard filtration and will re-classify a low-scored read to its parent taxonomic level if it scores below a certain threshold. This can be applied for filtering at low levels (e.g. assembly) since the classification in those levels should be more precise with less mismatches. This feature is also useful to avoid classifications that only happen due to a lack of related genomes (e.g. a low score match on the only representative species of a lineage).</p>
        <p>In summary, ganon indices represent groups of reference sequences clustered by taxonomy or assembly group. All <italic>k</italic>-mers from the reads are extracted and compared against an index by applying the <italic>k</italic>-mer counting lemma to select candidates. This is done based on a user-defined optimal number of errors. All matches within the error rate are filtered and one or more matches are reported. At the end, an optional LCA method can be applied for reads with multiple matches with a more conservative and less precise taxonomic classification, thus, resulting in one match for each read. Additionally, ganon supports classification based on multiple indices in a user-defined hierarchy, with independent error rates for each index (<xref ref-type="supplementary-material" rid="sup1">Supplementary Section S3.4</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We evaluated ganon against a set of well-established methods from recent benchmarks (<xref rid="btaa458-B16" ref-type="bibr">Lindgreen <italic>et al.</italic>, 2016</xref>; <xref rid="btaa458-B17" ref-type="bibr">McIntyre <italic>et al.</italic>, 2017</xref>; <xref rid="btaa458-B28" ref-type="bibr">Sczyrba <italic>et al.</italic>, 2017</xref>) that performs short-read classification and supports indexing of large sets of reference sequences. The aim here is to compare in equal conditions the methods regarding input data, reference sequences and taxonomy. We compared ganon against kraken (<xref rid="btaa458-B32" ref-type="bibr">Wood and Salzberg, 2014</xref>), one of the most used <italic>k</italic>-mer based methods for metagenomics short-read classification and its newer version, kraken2 (<xref rid="btaa458-B33" ref-type="bibr">Wood <italic>et al.</italic>, 2019</xref>). We also included krakenuniq (<xref rid="btaa458-B5" ref-type="bibr">Breitwieser <italic>et al.</italic>, 2018</xref>), which uses the basic kraken algorithm and also allows classification on more specific levels after taxonomic assignments (e.g. up to assembly or sequence level). We further compare the results against centrifuge (<xref rid="btaa458-B14" ref-type="bibr">Kim <italic>et al.</italic>, 2016</xref>) that uses the Burrows–Wheeler transform and the Full-text index in Minute space (FM-)index for indexing and aims to reduce the index size by compressing similar sequences together. Clark (<xref rid="btaa458-B23" ref-type="bibr">Ounit <italic>et al.</italic>, 2015</xref>), another <italic>k</italic>-mer approach that uses common <italic>k</italic>-mers between reference sequences was also evaluated. Diamond (<xref rid="btaa458-B6" ref-type="bibr">Buchfink <italic>et al.</italic>, 2015</xref>) an alignment tool for short DNA-sequencing reads against protein reference databases was also included. Here, we consider only the direct read classification capabilities of the tools. Further functionalities, such as the estimation of a presence of a certain organism or abundance estimation, were not covered. All steps performed in the evaluation were compiled in a benchmark pipeline (version 1.1.0) available from <ext-link ext-link-type="uri" xlink:href="https://github.com/pirovc/ganon_benchmark">https://github.com/pirovc/ganon_benchmark</ext-link>.</p>
    <p>Ganon and the other evaluated tools are reference-based, meaning all classifications are made based on previously generated sequence data. The choice of the underlying database is therefore crucial. We use the same sequences and taxonomic database version for all tools when creating their indices to guarantee a fair comparison. The NCBI RefSeq repository was the chosen source of sequences since it provides a curated and very extensive set of references. Two subsets of RefSeq were extracted: a set of only CG from the groups Archaea, Bacteria, Fungi and Viral (RefSeq-CG) and a complete set of all genomes from the same groups (RefSeq-ALL) both dating from December 19, 2018 (<xref rid="btaa458-T1" ref-type="table">Table 1</xref>). Genomic DNA data was obtained for all tools. Protein sequence data from annotated genome assemblies was obtained for diamond (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S5</xref>). Taxonomic information was obtained at the same dates as the sequences. Additionally, an old set of only Bacterial CG from June 2, 2015 (RefSeq-OLD) was included to evaluate the tool’s performance on an outdated and less diverse set of references.
</p>
    <table-wrap id="btaa458-T1" orientation="portrait" position="float">
      <label>Table 1.</label>
      <caption>
        <p>Genomic DNA of reference sequences used for evaluations</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1">Base pairs</th>
            <th rowspan="1" colspan="1"># assemblies</th>
            <th rowspan="1" colspan="1"># sequences</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">RefSeq-OLD</td>
            <td rowspan="1" colspan="1">9 632 441 987</td>
            <td rowspan="1" colspan="1">3042</td>
            <td rowspan="1" colspan="1">5242</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">RefSeq-CG</td>
            <td rowspan="1" colspan="1">46 986 899 184</td>
            <td rowspan="1" colspan="1">19 623</td>
            <td rowspan="1" colspan="1">33 029</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">RefSeq-ALL</td>
            <td rowspan="1" colspan="1">587 607 072 429</td>
            <td rowspan="1" colspan="1">147 713</td>
            <td rowspan="1" colspan="1">15 201 684</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <p><italic>Note</italic>: Protein data information can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S5</xref>. Detailed information of each dataset can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S2.5.1</xref>. Data were downloaded using <ext-link ext-link-type="uri" xlink:href="https://github.com/pirovc/genome_updater">https://github.com/pirovc/genome_updater</ext-link>.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>The selected reference sets contain over-represented taxonomic groups with several assemblies for a single species. For example, the <italic>Escherichia coli</italic> species group is represented by 634 assemblies, accounting for almost 7% of all base pairs in the RefSeq-CG. This is even more pronounced on RefSeq-ALL, with 13 259 <italic>E.coli</italic> assemblies representing more than 11% of the base pairs in the whole set. In RefSeq-CG, the 92 most over-represented species have as many base pairs as the remaining 11 372 species. In RefSeq-ALL, this ratio is 14–29 047 (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>). This unbalanced distribution of references may not only bias analysis but also introduces redundancy to the set when aiming classification at taxonomic levels. Therefore, when not classifying at assembly level, we removed over-represented assemblies from our reference set, keeping only the three biggest assemblies of each taxonomic group (<xref rid="btaa458-T2" ref-type="table">Table 2</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>).
</p>
    <table-wrap id="btaa458-T2" orientation="portrait" position="float">
      <label>Table 2.</label>
      <caption>
        <p>Reference sequences after over-representation filtering</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1">Base pairs</th>
            <th rowspan="1" colspan="1"># species</th>
            <th rowspan="1" colspan="1"># leaf taxids</th>
            <th rowspan="1" colspan="1"># assemblies</th>
            <th rowspan="1" colspan="1"># sequences</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">RefSeq-CG-</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE2">
                <mml:math id="IM2">
                  <mml:mrow>
                    <mml:mn>2.9</mml:mn>
                    <mml:mi>e</mml:mi>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">11 464</td>
            <td rowspan="1" colspan="1">14 071</td>
            <td rowspan="1" colspan="1">15 171</td>
            <td rowspan="1" colspan="1">24 290</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">top-3</td>
            <td rowspan="1" colspan="1">(62%)</td>
            <td rowspan="1" colspan="1">(100%)</td>
            <td rowspan="1" colspan="1">(100%)</td>
            <td rowspan="1" colspan="1">(77%)</td>
            <td rowspan="1" colspan="1">(74%)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">RefSeq-ALL-</td>
            <td rowspan="1" colspan="1">
              <inline-formula id="IE3">
                <mml:math id="IM3">
                  <mml:mrow>
                    <mml:mn>2.1</mml:mn>
                    <mml:mi>e</mml:mi>
                    <mml:mn>11</mml:mn>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </td>
            <td rowspan="1" colspan="1">29 061</td>
            <td rowspan="1" colspan="1">51 292</td>
            <td rowspan="1" colspan="1">56 805</td>
            <td rowspan="1" colspan="1">4 400 402</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">top-3</td>
            <td rowspan="1" colspan="1">(36%)</td>
            <td rowspan="1" colspan="1">(100%)</td>
            <td rowspan="1" colspan="1">(100%)</td>
            <td rowspan="1" colspan="1">(38%)</td>
            <td rowspan="1" colspan="1">(29%)</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn2">
          <p><italic>Note</italic>: Percentages in brackets show the amount of data left compared to the original set (<xref rid="btaa458-T1" ref-type="table">Table 1</xref>). Protein data information can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S5</xref>.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>For classification, we used reads from the first CAMI Challenge (<xref rid="btaa458-B28" ref-type="bibr">Sczyrba <italic>et al.</italic>, 2017</xref>). Sets of simulated datasets mimicking commonly used environments and settings were obtained, representing multiple closely related strains, plasmids and viral sequences. These samples were divided into three categories: low, medium and high complexity with increasing number of organisms and different sequencing profiles providing a well-produced and challenging dataset to analyze. The pre-challenge-simulated reads were generated based on public data (NCBI, SILVA46) and an exact ground truth assignment is provided for each read down to sequence level. The challenge datasets were more realistic and obtained from newly sequenced genomes of 700 microbial isolates and 600 circular elements and a ground truth is provided at taxonomic levels. Here, we used one high-complexity sample from both the pre-challenge dataset (simulated) and the realistic challenge dataset (real) categories to perform evaluations and benchmark the tools (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S6</xref>).</p>
    <p>The classification results were evaluated in terms of sensitivity and precision in two different ways: cumulative- and rank-based. Details on their differences can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S2.7</xref>. In short, the cumulative-based evaluation will compare how well tools perform up to a certain taxonomic level, considering only the taxon of their final classification level. The rank-based evaluation considers the full lineage of each classification. For example, in a cumulative-based evaluation, values of sensitivity and precision at family level will account cumulatively for all sequences classified at subsequent taxonomic levels (genus, species and species+) up to (and including) the family level. In a rank-based evaluation, family-level sensitivity and precision values are calculated based on the family assignment from the lineage of the classified sequences. The cumulative-based evaluation provides a better way to compare tools and their ability to correctly classify sequences to their targets. The rank-based approach will better compare how tools perform at a specific taxonomic level. In this work, we will use both methodologies to compare the results of the evaluated methods. Additionally, we evaluated all scenarios with AMBER (<xref rid="btaa458-B19" ref-type="bibr">Meyer <italic>et al.</italic>, 2018</xref>), an independent tool for assessment of metagenome binners with a similar approach to the rank-based evaluation. The complete cumulative-based, rank-based and amber results are in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material S2</xref>.</p>
    <p>The results for the CAMI simulated and real datasets should be interpreted considering the depth of classification. Most tools classify at a certain taxonomic level, either specific rank (e.g. species) or any taxon. Clark provides only species assignments and it was evaluated together with all other tools providing results at any taxonomic level (centrifuge, diamond, ganon, kraken, kraken2). Centrifuge, ganon and krakenuniq are also able to classify sequences at assembly level. Centrifuge outputs at sequence level, thus, an extra step of applying an LCA algorithm for non-unique matches was necessary to generate results at assembly and taxonomic levels. Given the availability of the ground truth, only simulated data were evaluated up to assembly level while real data were evaluated at taxonomic levels.</p>
    <sec>
      <title>3.1 Indexing</title>
      <p>The set of reference sequences from RefSeq-OLD/CG/ALL (<xref rid="btaa458-T1" ref-type="table">Table 1</xref>) and RefSeq-CG/ALL-top-3 (<xref rid="btaa458-T2" ref-type="table">Table 2</xref>) were used as inputs to generate the indices for each evaluated tool. Here, evaluation is done by total run-time, memory consumption and final index size (<xref rid="btaa458-T3" ref-type="table">Tables 3</xref> and <xref rid="btaa458-T4" ref-type="table">4</xref>).
</p>
      <table-wrap id="btaa458-T3" orientation="portrait" position="float">
        <label>Table 3.</label>
        <caption>
          <p>Build times, memory consumption and index sizes at taxonomic level</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Reference</th>
              <th rowspan="1" colspan="1">Method</th>
              <th rowspan="1" colspan="1">Time</th>
              <th rowspan="1" colspan="1">Memory</th>
              <th rowspan="1" colspan="1">Index size</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-OLD</td>
              <td rowspan="1" colspan="1">Centrifuge</td>
              <td rowspan="1" colspan="1">02:51:03</td>
              <td rowspan="1" colspan="1">98</td>
              <td rowspan="1" colspan="1">4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Clark</td>
              <td rowspan="1" colspan="1">04:07:56</td>
              <td rowspan="1" colspan="1">150</td>
              <td rowspan="1" colspan="1">32</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Diamond</td>
              <td rowspan="1" colspan="1">00:08:07</td>
              <td rowspan="1" colspan="1">28</td>
              <td rowspan="1" colspan="1">3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">00:02:08</td>
              <td rowspan="1" colspan="1">22</td>
              <td rowspan="1" colspan="1">15</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken</td>
              <td rowspan="1" colspan="1">02:04:16</td>
              <td rowspan="1" colspan="1">87</td>
              <td rowspan="1" colspan="1">73</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken2</td>
              <td rowspan="1" colspan="1">00:17:28</td>
              <td rowspan="1" colspan="1">13</td>
              <td rowspan="1" colspan="1">10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-CG-top-3</td>
              <td rowspan="1" colspan="1">Centrifuge</td>
              <td rowspan="1" colspan="1">06:51:25</td>
              <td rowspan="1" colspan="1">262</td>
              <td rowspan="1" colspan="1">12</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Clark</td>
              <td rowspan="1" colspan="1">08:45:31</td>
              <td rowspan="1" colspan="1">243</td>
              <td rowspan="1" colspan="1">81</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Diamond</td>
              <td rowspan="1" colspan="1">00:10:33</td>
              <td rowspan="1" colspan="1">27</td>
              <td rowspan="1" colspan="1">9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">00:07:01</td>
              <td rowspan="1" colspan="1">68</td>
              <td rowspan="1" colspan="1">62</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken</td>
              <td rowspan="1" colspan="1">04:53:31</td>
              <td rowspan="1" colspan="1">195</td>
              <td rowspan="1" colspan="1">184</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken2</td>
              <td rowspan="1" colspan="1">00:45:25</td>
              <td rowspan="1" colspan="1">29</td>
              <td rowspan="1" colspan="1">26</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-ALL-top-3</td>
              <td rowspan="1" colspan="1">Diamond</td>
              <td rowspan="1" colspan="1">00:36:23</td>
              <td rowspan="1" colspan="1">30</td>
              <td rowspan="1" colspan="1">70</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">00:54:48</td>
              <td rowspan="1" colspan="1">248</td>
              <td rowspan="1" colspan="1">249</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken2</td>
              <td rowspan="1" colspan="1">05:04:24</td>
              <td rowspan="1" colspan="1">124</td>
              <td rowspan="1" colspan="1">123</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <p><italic>Note</italic>: Memory and index size in GiB. All tools build at taxonomic leaf nodes (taxid) besides clark building at species level. Tools running more than 24 h to build were not considered. A total of 48 threads were used for all tools. Computer specifications and parameters used are in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Sections S2.1 and S2.4</xref>. Krakenuniq was not evaluated on taxonomic level since it runs exactly the same base algorithm as kraken in this configuration.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap id="btaa458-T4" orientation="portrait" position="float">
        <label>Table 4.</label>
        <caption>
          <p>Build times, memory consumption and index sizes at assembly level</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Reference</th>
              <th rowspan="1" colspan="1">Method</th>
              <th rowspan="1" colspan="1">Time</th>
              <th rowspan="1" colspan="1">Memory</th>
              <th rowspan="1" colspan="1">Index size</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-OLD</td>
              <td rowspan="1" colspan="1">Centrifuge</td>
              <td rowspan="1" colspan="1">02:51:03</td>
              <td rowspan="1" colspan="1">98</td>
              <td rowspan="1" colspan="1">4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">00:02:22</td>
              <td rowspan="1" colspan="1">30</td>
              <td rowspan="1" colspan="1">23</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Krakenuniq</td>
              <td rowspan="1" colspan="1">02:06:41</td>
              <td rowspan="1" colspan="1">87</td>
              <td rowspan="1" colspan="1">73</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-CG</td>
              <td rowspan="1" colspan="1">Centrifuge</td>
              <td rowspan="1" colspan="1">12:32:08</td>
              <td rowspan="1" colspan="1">428</td>
              <td rowspan="1" colspan="1">20</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">00:10:49</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">93</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Krakenuniq</td>
              <td rowspan="1" colspan="1">08:54:56</td>
              <td rowspan="1" colspan="1">321</td>
              <td rowspan="1" colspan="1">190</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-ALL</td>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">02:30:47</td>
              <td rowspan="1" colspan="1">493</td>
              <td rowspan="1" colspan="1">501</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn4">
            <p><italic>Note</italic>: Memory and Index size in GiB. Tools running more than 24 h to build were not considered. A total of 48 threads were used for all tools. Computer specifications and parameters used are in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Sections S2.1 and S2.4</xref>.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>When indexing the RefSeq-CG-top-3 at taxonomic levels (<xref rid="btaa458-T3" ref-type="table">Table 3</xref>), the evaluated tools took between 7 min and 8 h, resulting in ganon being the fastest and clark the slowest. We do not consider runs taking more than 24 h to build indices, given that they clearly do not scale well enough to index high amounts of data and will not be able to keep indices up-to-date in a reasonable amount of time for new data (<xref ref-type="supplementary-material" rid="sup1">Supplementary Section S3.2</xref>). Ganon shows a significant overall reduction in run-time compared to the other tools besides diamond. However, diamond is the only tool using protein data, accounting approximately for a third of the volume of the genomic data. Ganon builds six times faster than kraken2, the second fastest using the same data source. Centrifuge achieves the lowest index size with the cost of having the highest memory consumption. Additionally, ganon is able to generate smaller indices and use less memory at the cost of speed in the classification step, without harming sensitivity (<xref ref-type="supplementary-material" rid="sup1">Supplementary Section S3.5</xref>). Ganon indices for RefSeq-CG-top-3 can be as small as 21 GiB. RefSeq-ALL-top-3 was built in under an hour for diamond and ganon with kraken2 taking more than 5 h. Diamond generated the smallest filter and achieved the lowest memory consumption. We could not run centrifuge, clark, kraken and krakenuniq for RefSeq-ALL on our infrastructure, given computational limitations or long execution time. A recent publication (<xref rid="btaa458-B21" ref-type="bibr">Nasko <italic>et al.</italic>, 2018</xref>) reported that kraken and consequently krakenuniq both need 11 days to build a database for the bacterial RefSeq version 80, an approximate of the RefSeq-ALL here evaluated, with a more powerful server consisting of 64 cores of E7-8860v4 CPUs and 3 TB of memory. Estimated run-times for these tools in the evaluated datasets can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S7</xref>.</p>
      <p>When building indices on assembly level (<xref rid="btaa458-T4" ref-type="table">Table 4</xref>), ganon took around 10 min to index RefSeq-CG while the second fastest tool, krakenuniq, took almost 9 h. Given our computational and time limitations, ganon was the only tool able to build indices on assembly level for the RefSeq-ALL dataset, taking 2 h and 30 min.</p>
    </sec>
    <sec>
      <title>3.2 Updating</title>
      <p>Ganon is the only tool among the evaluated ones that allows for incremental updates on previously generated indices. We evaluated this functionality on Bacterial sequences added to RefSeq-CG dating from December 19, 2018 to January 21, 2019, comprising 2.77 Gbp, 1307 sequences, 370 species from which 213 are new to the reference set and 716 new assemblies (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>). Updating the ganon index based on RefSeq-CG with this dataset finished under 5 min, less than half of the time necessary to create the index (<xref rid="btaa458-T4" ref-type="table">Table 4</xref>).</p>
    </sec>
    <sec>
      <title>3.3 Classifying</title>
      <p><xref ref-type="fig" rid="btaa458-F2">Figure 2</xref> compares in a cumulative-based fashion, the results of one simulated high-complexity dataset (CAMI toy set) classified against the indices based on RefSeq-OLD, RefSeq-CG-top-3 and RefSeq-ALL-top-3. In this analysis, we can observe how each method performs classifying reads to their ground truth targets up to a certain taxonomic level. The overall improvement in terms of sensitivity and precision is clear when using a more complete and up-to-date set of references (RefSeq-ALL-top-3), since they provide higher coverage for the evaluated ground truth targets (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S6</xref>). The highest <italic>F</italic>1-score at any taxonomic level is achieved by ganon and kraken2, both performing similarly using RefSeq-ALL-top-3. Diamond shows an increase in performance at higher taxonomic levels but performs poorly at species level. Clark classifies only at species level and has no improvements in higher taxonomic levels. Metrics for the complete RefSeq-CG and RefSeq-ALL differ slightly from the respective top-3 sets; therefore, they were not included in the evaluations (<xref ref-type="supplementary-material" rid="sup1">Supplementary Section S3.3.1</xref>). This indicates that over-representation filtering does not affect the results but it can be used to speed up analysis.</p>
      <p>When looking at the metrics by each rank individually (<xref rid="btaa458-T5" ref-type="table">Table 5</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S8</xref>), the overall precision and sensitivity values are greater, since incorrect classifications at lower levels are not penalized in this type of evaluation. Besides diamond, which underperforms at species level, all tools have overall similar performance values using RefSeq-OLD and RefSeq-CG-top-3. However, tools show improvement on sensitivity on all levels with RefSeq-ALL-top-3. Ganon is 12% more sensitive at species level with this dataset and reaches 99.54% precision at genus level (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material S2</xref>). For lower ranks (species and species+), results were mainly limited by the availability of reference sequences (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S6</xref>).
</p>
      <table-wrap id="btaa458-T5" orientation="portrait" position="float">
        <label>Table 5.</label>
        <caption>
          <p>Rank-based precision, sensitivity and <italic>F</italic>1-score values for the simulated reads at species level</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Reference</th>
              <th align="center" rowspan="1" colspan="1">Method</th>
              <th align="center" rowspan="1" colspan="1">Sensitivity (%)</th>
              <th align="center" rowspan="1" colspan="1">Precision (%)</th>
              <th align="center" rowspan="1" colspan="1"><italic>F</italic>1-score (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-OLD</td>
              <td rowspan="1" colspan="1">Centrifuge</td>
              <td rowspan="1" colspan="1">
                <bold>41.48</bold>
              </td>
              <td rowspan="1" colspan="1">79.59</td>
              <td rowspan="1" colspan="1">54.54</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Clark</td>
              <td rowspan="1" colspan="1">41.13</td>
              <td rowspan="1" colspan="1">84.28</td>
              <td rowspan="1" colspan="1">55.28</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Diamond</td>
              <td rowspan="1" colspan="1">4.91</td>
              <td rowspan="1" colspan="1">29.01</td>
              <td rowspan="1" colspan="1">8.40</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">40.57</td>
              <td rowspan="1" colspan="1">
                <bold>89.41</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>55.82</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken</td>
              <td rowspan="1" colspan="1">41.23</td>
              <td rowspan="1" colspan="1">83.91</td>
              <td rowspan="1" colspan="1">55.29</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken2</td>
              <td rowspan="1" colspan="1">41.43</td>
              <td rowspan="1" colspan="1">78.40</td>
              <td rowspan="1" colspan="1">54.21</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-CG-top-3</td>
              <td rowspan="1" colspan="1">Centrifuge</td>
              <td rowspan="1" colspan="1">
                <bold>43.66</bold>
              </td>
              <td rowspan="1" colspan="1">79.28</td>
              <td rowspan="1" colspan="1">56.31</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Clark</td>
              <td rowspan="1" colspan="1">43.01</td>
              <td rowspan="1" colspan="1">82.59</td>
              <td rowspan="1" colspan="1">56.57</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Diamond</td>
              <td rowspan="1" colspan="1">11.30</td>
              <td rowspan="1" colspan="1">74.43</td>
              <td rowspan="1" colspan="1">19.62</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">41.87</td>
              <td rowspan="1" colspan="1">
                <bold>88.00</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>56.74</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken</td>
              <td rowspan="1" colspan="1">43.23</td>
              <td rowspan="1" colspan="1">82.49</td>
              <td rowspan="1" colspan="1">56.73</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken2</td>
              <td rowspan="1" colspan="1">43.61</td>
              <td rowspan="1" colspan="1">79.01</td>
              <td rowspan="1" colspan="1">56.20</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-ALL-top-3</td>
              <td rowspan="1" colspan="1">Diamond</td>
              <td rowspan="1" colspan="1">13.10</td>
              <td rowspan="1" colspan="1">88.64</td>
              <td rowspan="1" colspan="1">22.82</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">
                <bold>54.44</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>94.63</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>69.12</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken2</td>
              <td rowspan="1" colspan="1">53.78</td>
              <td rowspan="1" colspan="1">91.60</td>
              <td rowspan="1" colspan="1">67.77</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn5">
            <p><italic>Note</italic>: Numbers in bold denote the best results for each reference set. The use of a larger reference set with RefSeq-ALL-top-3 significantly improves results. Only ganon and diamond indexed the RefSeq-ALL-top-3 in &lt;24 h, thus, centrifuge, clark and kraken were excluded. Results for all taxonomic levels are in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S8</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> S2.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The same analysis was performed on real data (CAMI challenge set). This set is more challenging since most of the species in the sample are novel and, still to this date, mostly not present in the analyzed repositories of reference sequences (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S6</xref>). As stated by the CAMI results (<xref rid="btaa458-B28" ref-type="bibr">Sczyrba <italic>et al.</italic>, 2017</xref>), tools performed poorly in this dataset in terms of sensitivity (<xref ref-type="fig" rid="btaa458-F3">Fig. 3</xref>). Here, the impact of a larger and up-to-date set of references (RefSeq-ALL-top-3) is more evident, thus, significantly improving the results on both sensitivity and precision. The same trend from the simulated data analysis is present, with ganon and kraken2 achieving best results up to species level. Diamond improves classifications at higher levels but has poor resolution at lower ranks, showing a very conservative approach. Diamond classifies more reads at lower taxonomic ranks (family and above) than the other methods. However, on a rank-based evaluation diamond is overall less sensitive than ganon and kraken2.
</p>
      <fig id="btaa458-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Cumulative-based precision, sensitivity and <italic>F</italic>1-score values at all ranks for the real reads against all evaluated reference sets (blue = RefSeq-OLD, orange = RefSeq-CG-top-3 and red = RefSeq-ALL-top-3)</p>
        </caption>
        <graphic xlink:href="btaa458f3"/>
      </fig>
      <p>In the rank-based analysis (<xref rid="btaa458-T6" ref-type="table">Table 6</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S9</xref>), ganon and kraken2 have 10% higher <italic>F</italic>1-score compared to diamond with the RefSeq-ALL-top-3 at species level. Sensitivity has a peak of 10 and 25% at species+ and species levels, respectively, which are not far from the maximum possible using this reference set (12 and 32%, respectively). The high peak in precision at species+ level can be explained by the reduced number of reads in the ground truth assigned to taxonomic entries of those ranks (e.g. subspecies), being 17% of the real reads and 63% of the simulated reads. In addition, fewer reads are classified uniquely among similar genomes at this level, resulting in a higher level LCA classification. Comparing results between RefSeq-CG-top-3 and RefSeq-ALL-top-3, genus-level sensitivity went from 13% to 83% with a significant improvement in precision, reinforcing the need for bigger and more diverse reference sets to analyze metagenomics data. Similar results can be seen in amber evaluation (<xref ref-type="fig" rid="btaa458-F4">Fig. 4</xref>).
</p>
      <fig id="btaa458-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>AMBER average completeness/sensitivity (green) and purity/precision (blue) values for real reads. Results for diamond (left), ganon (middle) and kraken2 (right) using RefSeq-ALL-top-3 set of references. Strain level in AMBER plots is equivalent to species+ in our evaluations</p>
        </caption>
        <graphic xlink:href="btaa458f4"/>
      </fig>
      <table-wrap id="btaa458-T6" orientation="portrait" position="float">
        <label>Table 6.</label>
        <caption>
          <p>Rank-based precision, sensitivity and <italic>F</italic>1-score values for the real reads at species level</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Reference</th>
              <th align="center" rowspan="1" colspan="1">Method</th>
              <th align="center" rowspan="1" colspan="1">Sensitivity (%)</th>
              <th align="center" rowspan="1" colspan="1">Precision (%)</th>
              <th align="center" rowspan="1" colspan="1"><italic>F</italic>1-score (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-OLD</td>
              <td rowspan="1" colspan="1">Centrifuge</td>
              <td rowspan="1" colspan="1">0.51</td>
              <td rowspan="1" colspan="1">2.24</td>
              <td rowspan="1" colspan="1">0.84</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Clark</td>
              <td rowspan="1" colspan="1">0.49</td>
              <td rowspan="1" colspan="1">3.21</td>
              <td rowspan="1" colspan="1">0.86</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Diamond</td>
              <td rowspan="1" colspan="1">0.00</td>
              <td rowspan="1" colspan="1">0.00</td>
              <td rowspan="1" colspan="1">0.00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">0.43</td>
              <td rowspan="1" colspan="1">
                <bold>7.75</bold>
              </td>
              <td rowspan="1" colspan="1">0.82</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken</td>
              <td rowspan="1" colspan="1">0.50</td>
              <td rowspan="1" colspan="1">3.13</td>
              <td rowspan="1" colspan="1">0.86</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken2</td>
              <td rowspan="1" colspan="1">
                <bold>0.55</bold>
              </td>
              <td rowspan="1" colspan="1">2.19</td>
              <td rowspan="1" colspan="1">
                <bold>0.87</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-CG-top-3</td>
              <td rowspan="1" colspan="1">Centrifuge</td>
              <td rowspan="1" colspan="1">2.41</td>
              <td rowspan="1" colspan="1">7.03</td>
              <td rowspan="1" colspan="1">3.59</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Clark</td>
              <td rowspan="1" colspan="1">2.34</td>
              <td rowspan="1" colspan="1">9.57</td>
              <td rowspan="1" colspan="1">3.76</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Diamond</td>
              <td rowspan="1" colspan="1">1.74</td>
              <td rowspan="1" colspan="1">11.23</td>
              <td rowspan="1" colspan="1">3.02</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">1.77</td>
              <td rowspan="1" colspan="1">
                <bold>0.89</bold>
              </td>
              <td rowspan="1" colspan="1">3.26</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken</td>
              <td rowspan="1" colspan="1">2.39</td>
              <td rowspan="1" colspan="1">9.61</td>
              <td rowspan="1" colspan="1">
                <bold>3.83</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken2</td>
              <td rowspan="1" colspan="1">
                <bold>2.59</bold>
              </td>
              <td rowspan="1" colspan="1">7.22</td>
              <td rowspan="1" colspan="1">3.82</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-ALL-top-3</td>
              <td rowspan="1" colspan="1">Diamond</td>
              <td rowspan="1" colspan="1">12.38</td>
              <td rowspan="1" colspan="1">
                <bold>55.84</bold>
              </td>
              <td rowspan="1" colspan="1">20.27</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">24.78</td>
              <td rowspan="1" colspan="1">38.67</td>
              <td rowspan="1" colspan="1">30.20</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken2</td>
              <td rowspan="1" colspan="1">
                <bold>25.83</bold>
              </td>
              <td rowspan="1" colspan="1">37.84</td>
              <td rowspan="1" colspan="1">
                <bold>30.70</bold>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn6">
            <p><italic>Note</italic>: Numbers in bold denote the best results for each reference set. The use of a larger reference set with RefSeq-ALL-top-3 significantly improves results. Only ganon and diamond indexed the RefSeq-ALL-top-3 in &lt;24 h, thus, centrifuge, clark and kraken were excluded. Results for all taxonomic levels are in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S9</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> S2.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p><xref rid="btaa458-T7" ref-type="table">Table 7</xref> compares the assembly-level classification between centrifuge, ganon and krakenuniq. There is an overall decrease in precision and sensitivity from RefSeq-OLD to RefSeq-CG. Precision is greater using RefSeq-ALL but sensitivity is still greater with RefSeq-OLD. However, RefSeq-CG has more than 6 times the number of assemblies of RefSeq-OLD, while RefSeq-ALL has almost 50 times more assemblies (<xref rid="btaa458-T1" ref-type="table">Table 1</xref>). As reported before (<xref rid="btaa458-B21" ref-type="bibr">Nasko <italic>et al.</italic>, 2018</xref>), higher diversity in the references does not always translate to an improved accuracy in the classification. This was also noticed when using the complete NCBI-nt database to analyze the same dataset (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S14</xref>).
</p>
      <table-wrap id="btaa458-T7" orientation="portrait" position="float">
        <label>Table 7.</label>
        <caption>
          <p>Rank-based precision, sensitivity and <italic>F</italic>1-score values for the simulated reads at assembly level</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Reference</th>
              <th align="center" rowspan="1" colspan="1">Method</th>
              <th align="center" rowspan="1" colspan="1">Sensitivity (%)</th>
              <th align="center" rowspan="1" colspan="1">Precision (%)</th>
              <th align="center" rowspan="1" colspan="1"><italic>F</italic>1-score (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-OLD</td>
              <td rowspan="1" colspan="1">Centrifuge</td>
              <td rowspan="1" colspan="1">
                <bold>22.78</bold>
              </td>
              <td rowspan="1" colspan="1">64.54</td>
              <td rowspan="1" colspan="1">33.68</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">22.32</td>
              <td rowspan="1" colspan="1">
                <bold>77.95</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>34.70</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Krakenuniq</td>
              <td rowspan="1" colspan="1">22.68</td>
              <td rowspan="1" colspan="1">69.66</td>
              <td rowspan="1" colspan="1">34.22</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-CG</td>
              <td rowspan="1" colspan="1">Centrifuge</td>
              <td rowspan="1" colspan="1">
                <bold>11.82</bold>
              </td>
              <td rowspan="1" colspan="1">30.77</td>
              <td rowspan="1" colspan="1">17.08</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">11.52</td>
              <td rowspan="1" colspan="1">
                <bold>37.25</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>17.60</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Krakenuniq</td>
              <td rowspan="1" colspan="1">11.67</td>
              <td rowspan="1" colspan="1">32.45</td>
              <td rowspan="1" colspan="1">17.17</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-ALL</td>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">21.56</td>
              <td rowspan="1" colspan="1">87.89</td>
              <td rowspan="1" colspan="1">34.62</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn7">
            <p><italic>Note</italic>: Numbers in bold denote the best results for each reference set. Only ganon indexed the RefSeq-ALL in &lt;24 h, thus, centrifuge, clark and kraken were excluded. Results for all taxonomic levels are in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> S2.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>In the specific case of methods evaluated here, small differences between very similar assemblies are difficult to be identified due to the resolution of each method. This means that they, in general, can correctly classify sequences to target assemblies given a certain similarity threshold. However, they are unable to select the correct assembly, thus, providing the LCA at a lower resolution. This can be seen in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S13</xref>, where the overall sensitivity and precision of all tools executing in assembly mode did not affect the taxonomic metrics and are comparable to the same tools running in taxonomic mode. Even though the assembly step does not provide accurate enough results, centrifuge and ganon are the only tools that can provide a list of all matches/candidates that can be further analyzed with high-resolution methods (<xref rid="btaa458-B10" ref-type="bibr">Fischer <italic>et al.</italic>, 2017</xref>).</p>
      <p>In most scenarios evaluated, ganon consistently provides greater precision classifying reads to their ground truth targets within the same reference set, while keeping sensitivity values high, with little variation to the other methods. High precision translates to fewer reads with a wrong classification. Sensitivity is strongly improved in more diverse reference sets, especially with RefSeq-ALL-top-3. Looking at rank-by-rank performance, ganon and kraken2 improved F1-score in every taxonomic rank (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S8 and S9</xref>), with <italic>F</italic>1-score up to 46% higher than diamond with the same reference at species level (<xref rid="btaa458-T5" ref-type="table">Table 5</xref>).</p>
      <p><xref rid="btaa458-T8" ref-type="table">Table 8</xref> compares the performance of the analyzed tools in terms of how many base pairs they can classify per minute (Mbp/m), wall/elapsed time and memory usage. Kraken2 is the tool with the fastest run-time on classification step and diamond with the slowest. Although comparisons with diamond were made, it is important to notice that the tool works in a very different way using protein data and performing alignments, thus, explaining the huge difference in execution times and results. Ganon can be configured to run in <italic>offset</italic> mode, thus, skipping a certain number of <italic>k</italic>-mers and speeding up classification. <italic>offset</italic> =1 means that all <italic>k</italic>-mers are being evaluated while <italic>offset</italic> =2 means that every second <italic>k</italic>-mer is being skipped. The trade-off between offset and precision/sensitivity for ganon results can be seen in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S12</xref>. Speed variation between simulated and real reads is partly explained due to their classification rate: on average 70% of the simulated reads are classified while only 20% of the real reads are classified. Memory consumption is mainly based on the index size of each tool (<xref rid="btaa458-T3" ref-type="table">Table 3</xref>), with little variation besides that.
</p>
      <table-wrap id="btaa458-T8" orientation="portrait" position="float">
        <label>Table 8.</label>
        <caption>
          <p>Classification performance</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th colspan="3" align="center" rowspan="1">Simulated<hr/></th>
              <th colspan="3" align="center" rowspan="1">Real<hr/></th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">Reference</th>
              <th align="center" rowspan="1" colspan="1">Method</th>
              <th align="center" rowspan="1" colspan="1">Mbp/m</th>
              <th align="center" rowspan="1" colspan="1">Wall time</th>
              <th align="center" rowspan="1" colspan="1">Memory</th>
              <th align="center" rowspan="1" colspan="1">Mbp/m</th>
              <th align="center" rowspan="1" colspan="1">Wall time</th>
              <th align="center" rowspan="1" colspan="1">Memory</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-CG-top-3</td>
              <td rowspan="1" colspan="1">Centrifuge</td>
              <td rowspan="1" colspan="1">298</td>
              <td rowspan="1" colspan="1">00:24:59 (±51 s)</td>
              <td rowspan="1" colspan="1">13</td>
              <td rowspan="1" colspan="1">802</td>
              <td rowspan="1" colspan="1">00:09:19 (±4 s)</td>
              <td rowspan="1" colspan="1">13</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Clark</td>
              <td rowspan="1" colspan="1">1104</td>
              <td rowspan="1" colspan="1">00:06:44 (±5 s)</td>
              <td rowspan="1" colspan="1">101</td>
              <td rowspan="1" colspan="1">1208</td>
              <td rowspan="1" colspan="1">00:06:11 (±4 s)</td>
              <td rowspan="1" colspan="1">100</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Diamond</td>
              <td rowspan="1" colspan="1">36</td>
              <td rowspan="1" colspan="1">03:27:00 (±259 s)</td>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">33</td>
              <td rowspan="1" colspan="1">03:40:55 (±170 s)</td>
              <td rowspan="1" colspan="1">15</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">380</td>
              <td rowspan="1" colspan="1">00:20:31 (±8 s)</td>
              <td rowspan="1" colspan="1">61</td>
              <td rowspan="1" colspan="1">538</td>
              <td rowspan="1" colspan="1">00:14:50 (±1 s)</td>
              <td rowspan="1" colspan="1">61</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken</td>
              <td rowspan="1" colspan="1">2113</td>
              <td rowspan="1" colspan="1">00:03:46 (±1 s)</td>
              <td rowspan="1" colspan="1">177</td>
              <td rowspan="1" colspan="1">2734</td>
              <td rowspan="1" colspan="1">00:02:57 (±3 s)</td>
              <td rowspan="1" colspan="1">177</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken2</td>
              <td rowspan="1" colspan="1">3085</td>
              <td rowspan="1" colspan="1">00:02:47 (±1 s)</td>
              <td rowspan="1" colspan="1">27</td>
              <td rowspan="1" colspan="1">3833</td>
              <td rowspan="1" colspan="1">00:02:19 (±1 s)</td>
              <td rowspan="1" colspan="1">27</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RefSeq-ALL-top-3</td>
              <td rowspan="1" colspan="1">Diamond</td>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">18:23:09 (±729 s)</td>
              <td rowspan="1" colspan="1">21</td>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">21:23:00 (±181 s)</td>
              <td rowspan="1" colspan="1">22</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Ganon</td>
              <td rowspan="1" colspan="1">107</td>
              <td rowspan="1" colspan="1">01:13:44 (±7s)</td>
              <td rowspan="1" colspan="1">243</td>
              <td rowspan="1" colspan="1">153</td>
              <td rowspan="1" colspan="1">00:53:13 (±12 s)</td>
              <td rowspan="1" colspan="1">243</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">Kraken2</td>
              <td rowspan="1" colspan="1">2991</td>
              <td rowspan="1" colspan="1">00:04:11 (±4s)</td>
              <td rowspan="1" colspan="1">123</td>
              <td rowspan="1" colspan="1">3659</td>
              <td rowspan="1" colspan="1">00:03:52 (±1 s)</td>
              <td rowspan="1" colspan="1">122</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn8">
            <p><italic>Note</italic>: Memory in GiB. Full set of simulated and real reads classified with 48 threads. Centrifuge, clark and diamond performance in Mbp/m calculated from wall time. Values are the average of four out five consecutive runs (excluding the slowest run), with SD for the run-time in parentheses. Computer specifications and parameters used are in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Sections S2.1 and S2.4</xref>.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We presented ganon, a novel method to index big sets of genomic sequences and classify short reads against them in a taxonomic oriented scheme. Ganon’s strengths are an ultra-fast indexing method for large sets of reference sequences that incorporates a novel application of IBFs and a precise classification with <italic>k</italic>-mer counting and filtering. Unlike DREAM-Yara, an alignment-based read mapper that uses the IBF as a pre-filter for the distributed Yara mapper, ganon uses the IBF as the main index structure to provide an alignment-free assignment of sequences. This is only possible by creating taxonomic constrained clusters with TaxSBP in any desired taxonomic level. Ganon additionally applies an LCA algorithm as a final step to have one classification per sequence. In addition, it also provides updatability of indices, multi-hierarchy support for classification, assembly-level support and taxonomic reports.</p>
    <p>By indexing large sets of reference sequences and turn them into searchable indices, ganon allows scientists to make most of their data. Short turnaround times for index building and updating are crucial for many bioinformatics applications (e.g. outbreak investigation). In our evaluations, building the complete RefSeq and classifying 49 million reads against it performed under 2 h with ganon, from raw reference sequences and reads to taxonomic reports, while kraken2 required more than 5 h and diamond more than 22 h to index and classify the same set. Other methods required at least 24 h to build the indices. Without a dedicated infrastructure for constant reconstruction of indices and databases, tools evaluated in this work are unable to keep-up with the fast growing rate of reference sequence repositories. That results in either long time to start analysis or use of outdated reference sets. Ganon facilitates database maintenance, allowing short increments on a daily basis being a realistic option to keep-up with the fast pace of data generation. In addition, ganon indices are flexible and can be built for different taxonomic levels (e.g. genus), requiring less space and memory, consequently improving classification speed. A trade-off between filter size, clustering and false-positive rate is also possible, simply by sacrificing precision over performance or disk usage over classification speed (<xref ref-type="supplementary-material" rid="sup1">Supplementary Section S3.5</xref>).</p>
    <p>Classification results presented here are on par with state-of-the-art methods with regards to sensitivity, while improving precision rates in almost every scenario of our cumulative-based evaluations. Results are consistent across all three evaluation methods (cumulative- and rank-based and amber) indicating the robustness of findings. We attribute this improvement to an application of the <italic>k</italic>-mer counting lemma together with a progressive filtering step, which can better separate false from true positives. The unique filtering step also allows for better selection of false positives when taxonomic groups are underrepresented in the reference set. In addition, instead of only reporting reads at a fixed LCA level, ganon provides every output for a read at a taxonomic or assembly level. This is crucial for strain level analysis, where candidate organisms are more insightful for further investigations than a conservative identification.</p>
    <p>Even with ganon achieving improved results in classification, in general terms, the methods tested here perform similarly when based on the same underlying set of reference sequences. The difference in sensitivity when using a high quality set (RefSeq-ALL) compared to only CG (RefSeq-CG) or an outdated set (RefSeq-OLD) is very significant and tends to get bigger with more sequences added to this repository. Thus, the choice of the database is crucial and should not be overlooked when analyzing metagenomics data. Even though centrifuge, clark, kraken and krakenuniq could potentially perform well with more reference sequences, their indexing times are highly prohibitive.</p>
    <p>When using highly diverse reference sets or when aiming at high-resolution classification (e.g. assembly level), the evaluated methods shown decreased performance. However, in a scenario of data exploration of an unknown environmental sample, the ability to classify reads against huge sets of very diverse reference sequences (e.g. NCBI-nt) can be helpful. Therefore, in those scenarios, we recommend to perform analysis hierarchically, first classifying reads against high quality references and only using high diverse reference sets for unclassified sequences, adjusting error rates accordingly. This approach can be easily done with ganon’s implementation of multi-filter and multi-hierarchy classification. This functionality tied to fast indexing of reference sets make ganon a powerful tool for exploratory data analysis, enabling multiple combinations of indices and error rates in an iterative manner. An example of this functionality can be found in <xref ref-type="supplementary-material" rid="sup1">Supplementary Section S3.4</xref>, where we analyzed real data from TARA oceans (<xref rid="btaa458-B31" ref-type="bibr">Tully <italic>et al.</italic>, 2018</xref>), building several indices and classifying reads against them in an exploratory-fashion.</p>
    <p>Ganon’s fast indexing performance is mainly due to the fact that <italic>k</italic>-mers are not being counted. Instead, all of them are inserted into a space-efficient data structure (IBF) that also provides quick look-up times. However, data generation is constantly increasing and in the long term this approach will reach a limit. For that reason, a <italic>k</italic>-mer aware clustering combined with a minimizer implementation could improve performance in the data structure as well as memory consumption. These features are planned for future releases. Even though we based our analysis on large and realistic datasets, time efficiency purely based on data can be misleading. Thus, the scalability of the methods can only be deduced. As a future work, we propose a comparison of time and space complexities of each methodology and how they would perform in the long term, considering a continuous and exponential data growth.</p>
    <p>Ganon manages to index large sets of reference sequences while keeping them updated in very short time. In addition, classification results for ganon are as good as or better than the evaluated tools and it runs in competitive time. To the best of our knowledge, ganon is the only tool with update capabilities, which is performed in a fraction of the complete build time. This poses as an advantage to maintain up-to-date with the public repositories of genomic data and their frequent updates. To conclude, we believe that ganon can be a useful tool for metagenomics analysis in a time where reference sequence repositories are growing fast.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btaa458_Supplementary_Data</label>
      <media xlink:href="btaa458_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to thank Tobias Loka for helpful discussions, Diogo Andrei Benvenutti and Fabio Malcher Miranda for git project improvements and C++ contributions and Robert Rentzsch and Elizabeth Yuu for revising the manuscript.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the CAPES - Ciência sem Fronteiras [BEX 13472/13-5 to V.C.P.]; by the BMBF (InfectControl 2020); and by the BMBF-funded de. NBI Cloud within the German Network for Bioinformatics Infrastructure (de.NBI) [031A537B, 031A533A, 031A538A, 031A533B, 031A535A, 031A537C, 031A534A and 031A532B].</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa458-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Balvočiūtė</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Huson</surname><given-names>D.H.</given-names></name></person-group> (<year>2017</year>) 
<article-title>SILVA, RDP, Greengenes, NCBI and OTT—how do these taxonomies compare?</article-title><source>BMC Genomics</source>, <volume>18</volume>, <fpage>114</fpage>.<pub-id pub-id-type="pmid">28361695</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Benson</surname><given-names>D.A.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>GenBank</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>D41</fpage>–<lpage>D47</lpage>.<pub-id pub-id-type="pmid">29140468</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bloom</surname><given-names>B.H.</given-names></name></person-group> (<year>1970</year>) 
<article-title>Space/time trade-offs in hash coding with allowable errors</article-title>. <source>Commun. ACM</source>, <volume>13</volume>, <fpage>422</fpage>–<lpage>426</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa458-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Breitwieser</surname><given-names>F.P.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>A review of methods and databases for metagenomic classification and assembly</article-title>. <source>Brief. Bioinform</source>., <volume>20</volume>, <fpage>1125</fpage>–<lpage>1136</lpage>.<pub-id pub-id-type="pmid">29028872</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Breitwieser</surname><given-names>F.P.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>KrakenUniq: confident and fast metagenomics classification using unique k-mer counts</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>198</fpage>.<pub-id pub-id-type="pmid">30445993</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Buchfink</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>59</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">25402007</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Codenotti</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>Approximation algorithms for a hierarchically structured bin packing problem</article-title>. <source>Inform. Process. Lett</source>., <volume>89</volume>, <fpage>215</fpage>–<lpage>221</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa458-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dadi</surname><given-names>T.H.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>DREAM-Yara: an exact read mapper for very large databases with short update time</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>i766</fpage>–<lpage>i772</lpage>.<pub-id pub-id-type="pmid">30423080</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Federhen</surname><given-names>S.</given-names></name></person-group> (<year>2012</year>) 
<article-title>The NCBI Taxonomy database</article-title>. <source>Nucleic Acids Res</source>., <volume>40</volume>, <fpage>D136</fpage>–<lpage>D143</lpage>.<pub-id pub-id-type="pmid">22139910</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fischer</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Abundance estimation and differential testing on strain level in metagenomics data</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>i124</fpage>–<lpage>i132</lpage>.<pub-id pub-id-type="pmid">28881972</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Haft</surname><given-names>D.H.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>RefSeq: an update on prokaryotic genome annotation and curation</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>D851</fpage>–<lpage>D860</lpage>.<pub-id pub-id-type="pmid">29112715</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huson</surname><given-names>D.H.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>MEGAN analysis of metagenomic data</article-title>. <source>Genome Res</source>., <volume>17</volume>, <fpage>377</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">17255551</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B13">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Jokinen</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Ukkonen</surname><given-names>E.</given-names></name></person-group> (<year>1991</year>) <chapter-title><italic>Two</italic> <italic>Algorithms for</italic> <italic>Approximate</italic> <italic>String</italic> <italic>Matching in</italic> <italic>Static</italic> <italic>Texts</italic></chapter-title> In: <person-group person-group-type="editor"><name name-style="western"><surname>Tarlecki</surname><given-names>A.</given-names></name></person-group> (ed.) <source>Mathematical Foundations of Computer Science 1991, Lecture Notes in Computer Science</source>. 
<publisher-name>Springer</publisher-name>, 
<publisher-loc>Berlin Heidelberg</publisher-loc>, pp. <fpage>240</fpage>–<lpage>248</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa458-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Centrifuge: rapid and sensitive classification of metagenomic sequences</article-title>. <source>Genome Res</source>., <volume>26</volume>, <fpage>1721</fpage>–<lpage>1729</lpage>.<pub-id pub-id-type="pmid">27852649</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>When old metagenomic data meet newly sequenced genomes, a case study</article-title>. <source>PLoS One</source>, <volume>13</volume>, <fpage>e0198773</fpage>.<pub-id pub-id-type="pmid">29902201</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lindgreen</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>An evaluation of the accuracy and speed of metagenome analysis tools</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>19233</fpage>.<pub-id pub-id-type="pmid">26778510</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McIntyre</surname><given-names>A.B.R.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Comprehensive benchmarking and ensemble approaches for metagenomic classifiers</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>182</fpage>.<pub-id pub-id-type="pmid">28934964</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Menzel</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Fast and sensitive taxonomic classification for metagenomics with Kaiju</article-title>. <source>Nat. Commun</source>., <volume>7</volume>, <fpage>11257</fpage>.<pub-id pub-id-type="pmid">27071849</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Meyer</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>AMBER: assessment of metagenome BinnERs</article-title>. <source>Gigascience</source>, <volume>7</volume>(6).</mixed-citation>
    </ref>
    <ref id="btaa458-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mukherjee</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>1,003 reference genomes of bacterial and archaeal isolates expand coverage of the tree of life</article-title>. <source>Nat. Biotechnol</source>., <volume>35</volume>, <fpage>676</fpage>–<lpage>683</lpage>.<pub-id pub-id-type="pmid">28604660</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nasko</surname><given-names>D.J.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>RefSeq database growth influences the accuracy of k-mer-based lowest common ancestor species identification</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>165</fpage>.<pub-id pub-id-type="pmid">30373669</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Oulas</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Metagenomics: tools and insights for analyzing next-generation sequencing data derived from biodiversity studies</article-title>. <source>Bioinform. Biol. Insights</source>, <volume>9</volume>, <fpage>75</fpage>–<lpage>88</lpage>.<pub-id pub-id-type="pmid">25983555</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ounit</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>CLARK: fast and accurate classification of metagenomic and genomic sequences using discriminative k-mers</article-title>. <source>BMC Genomics</source>, <volume>16</volume>, <fpage>236</fpage>.<pub-id pub-id-type="pmid">25879410</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Parks</surname><given-names>D.H.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Recovery of nearly 8,000 metagenome-assembled genomes substantially expands the tree of life</article-title>. <source>Nat. Microbiol</source>., <volume>2</volume>, <fpage>1533</fpage>–<lpage>1542</lpage>.<pub-id pub-id-type="pmid">28894102</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Peabody</surname><given-names>M.A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Evaluation of shotgun metagenomics sequence classification methods using in silico and in vitro simulated communities</article-title>. <source>BMC Bioinformatics</source>, <volume>16</volume>, <fpage>362</fpage>.</mixed-citation>
    </ref>
    <ref id="btaa458-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Reinert</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Alignment of next-generation sequencing reads</article-title>. <source>Annu. Rev. Genomics Hum. Genet</source>., <volume>16</volume>, <fpage>133</fpage>–<lpage>151</lpage>.<pub-id pub-id-type="pmid">25939052</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Reinert</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>The SeqAn C++ template library for efficient sequence analysis: a resource for programmers</article-title>. <source>J. Biotechnol</source>., <volume>261</volume>, <fpage>157</fpage>–<lpage>168</lpage>.<pub-id pub-id-type="pmid">28888961</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sczyrba</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Critical assessment of metagenome interpretation–a benchmark of metagenomics software</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>1063</fpage>–<lpage>1071</lpage>.<pub-id pub-id-type="pmid">28967888</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tausch</surname><given-names>S.H.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Livekraken - real-time metagenomic classification of illumina data</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>3750</fpage>–<lpage>3752</lpage>.<pub-id pub-id-type="pmid">29868852</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Truong</surname><given-names>D.T.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>MetaPhlAn2 for enhanced metagenomic taxonomic profiling</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>902</fpage>–<lpage>903</lpage>.<pub-id pub-id-type="pmid">26418763</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tully</surname><given-names>B.J.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>The reconstruction of 2,631 draft metagenome-assembled genomes from the global oceans</article-title>. <source>Sci. Data</source>, <volume>5</volume>, <fpage>170203</fpage>.<pub-id pub-id-type="pmid">29337314</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wood</surname><given-names>D.E.</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>R46</fpage>.<pub-id pub-id-type="pmid">24580807</pub-id></mixed-citation>
    </ref>
    <ref id="btaa458-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wood</surname><given-names>D.E.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Improved metagenomic analysis with Kraken 2</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>257</fpage>.<pub-id pub-id-type="pmid">31779668</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
