<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8796377</article-id>
    <article-id pub-id-type="pmid">34718411</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab732</article-id>
    <article-id pub-id-type="publisher-id">btab732</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LocalNgsRelate: a software tool for inferring IBD sharing along the genome between pairs of individuals from low-depth NGS data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9586-1027</contrib-id>
        <name>
          <surname>Severson</surname>
          <given-names>Alissa L</given-names>
        </name>
        <aff><institution>Department of Genetics, Stanford University</institution>, Stanford, CA 94305-5020, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Korneliussen</surname>
          <given-names>Thorfinn Sand</given-names>
        </name>
        <aff><institution>GLOBE Institute, University of Copenhagen</institution>, 1350 Copenhagen K, <country country="DK">Denmark</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7052-8554</contrib-id>
        <name>
          <surname>Moltke</surname>
          <given-names>Ida</given-names>
        </name>
        <xref rid="btab732-cor1" ref-type="corresp"/>
        <aff><institution>Department of Biology, University of Copenhagen</institution>, 2200 Copenhagen N, <country country="DK">Denmark</country></aff>
        <!--ida@binf.ku.dk-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab732-cor1">To whom correspondence should be addressed. <email>ida@binf.ku.dk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>2</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-10-28">
      <day>28</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <volume>38</volume>
    <issue>4</issue>
    <fpage>1159</fpage>
    <lpage>1161</lpage>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>9</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>05</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>22</day>
        <month>11</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab732.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Inference of identity-by-descent (IBD) sharing along the genome between pairs of individuals has important uses. But all existing inference methods are based on genotypes, which is not ideal for low-depth Next Generation Sequencing (NGS) data from which genotypes can only be called with high uncertainty.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present a new probabilistic software tool, LocalNgsRelate, for inferring IBD sharing along the genome between pairs of individuals from low-depth NGS data. Its inference is based on genotype likelihoods instead of genotypes, and thereby it takes the uncertainty of the genotype calling into account. Using real data from the 1000 Genomes project, we show that LocalNgsRelate provides more accurate IBD inference for low-depth NGS data than two state-of-the-art genotype-based methods, <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref> and hap-IBD. We also show that the method works well for NGS data down to a depth of 2×. </p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>LocalNgsRelate is freely available at <ext-link xlink:href="https://github.com/idamoltke/LocalNgsRelate" ext-link-type="uri">https://github.com/idamoltke/LocalNgsRelate</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NSF Graduate Research Fellowship and the NIH</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01 HG005855</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/100010663</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>ERC-2018-STG-804679</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Inference of identity-by-descent (IBD), i.e. allelic identity due to recent common ancestry, along the genome for pairs of individuals has proven useful in several research fields, ranging from medical genetics, where it can be used to map disease associated genes (<xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic>, 2009</xref>) to evolutionary genetics where it can be used to detect natural selection (<xref rid="btab732-B2" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.,</italic> 2010</xref>). There are numerous methods for such inference, e.g. the Hidden Markov Model (HMM)-based method by <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref> and hap-IBD (<xref rid="btab732-B7" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic>, 2020</xref>). However, they are all based on genotype data, which makes them ill-suited for the increasingly common low-depth Next Generation Sequencing (NGS) data, because genotypes cannot be called with high certainty for such data (<xref rid="btab732-B6" ref-type="bibr">O’Rawe <italic toggle="yes">et al.</italic>, 2015</xref>). Motivated by this, we here present a new HMM-based method, LocalNgsRelate. It is similar to <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref>, but instead of basing its inference on genotypes and taking genotype uncertainty into account via a global user-supplied error rate, it bases its inference on genotype likelihoods (GLs) and accounts for genotype uncertainty via these, like NgsRelate (<xref rid="btab732-B4" ref-type="bibr">Korneliussen and Moltke, 2015</xref>). To investigate its performance, we apply it to low-depth NGS data from the 1000 Genomes project and compare it to <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref> and hap-IBD.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>At any given genomic locus in a diploid species, two noninbred individuals <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> share either 0, 1 or 2 alleles IBD. Based on NGS data, we aim to be able to infer this IBD state at each locus along the genome using the following framework: let <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> denote the observed NGS data for <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> at <italic toggle="yes">L</italic> diallelic loci and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> denote their true unobserved genotypes at these same loci. Also, let <italic toggle="yes">A</italic> and <italic toggle="yes">a</italic> denote the two alleles at locus <italic toggle="yes">l</italic> and <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> denote the frequencies of <italic toggle="yes">A</italic>. Finally, let <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> denote the unobserved IBD states each with the value 0, 1 or 2. As in <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref>, we then assume <italic toggle="yes">X</italic> can be described using a continuous time Markov chain with instantaneous rate matrix
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>-</mml:mo><mml:mo>α</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>α</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>α</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>-</mml:mo><mml:mo>α</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>α</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>α</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>-</mml:mo><mml:mo>α</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> are the relatedness coefficients, i.e. the genome-wide proportion of loci where the two individuals share 0, 1 and 2 alleles IBD, respectively, and where <italic toggle="yes">α</italic> is the overall rate of change in IBD state. This model has <italic toggle="yes">R</italic> as stationary distribution and leads to closed form expressions for transition probabilities that depend on the distance between consecutive loci, <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> (<xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic>, 2009</xref>). We also assume that the genotypes are independent conditional on the IBD states, i.e. that there is no linkage disequilibrium (LD), and that the frequencies <italic toggle="yes">f<sup>A</sup></italic> are known. Under these assumptions, the likelihood <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> can be written as the following sum over all possible values <italic toggle="yes">x</italic> of <italic toggle="yes">X</italic>
 <disp-formula id="E2"><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mo>∑</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mi>R</mml:mi></mml:mfenced><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mi>P</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref> and <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> are GLs. Based on this, we first perform maximum likelihood estimation of <italic toggle="yes">R</italic> and <italic toggle="yes">α</italic> with the numerical optimization algorithm BFGS and then make inferences about the IBD states, <italic toggle="yes">X</italic>, with standard HMM algorithms Viterbi and posterior decoding. For details about the performance assessment, including example run times, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Data</xref>.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We investigated the performance of LocalNgsRelate on 1000 Genomes NGS data for five pairs of LWK individuals with different degrees of relatedness: a parent-offspring (PO), a full-sibling (FS), a half-sibling (HS), a first cousin (C1), and an unrelated (UR) pair and used NGS data from 94 additional LWK individuals for allele frequency estimation (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). We downsampled the NGS data from ∼6× to 4×, 2× and 1×, estimated GLs and allele frequencies at each sequencing depth using ANGSD (<xref rid="btab732-B5" ref-type="bibr">Korneliussen <italic toggle="yes">et al.</italic>, 2014</xref>), and applied LocalNgsRelate. Then we compared these results to those from <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref>, applied to high-quality genotype data from the same samples, which we used as a proxy for the truth. We performed this comparison using a set of loci obtained by quality filtering and LD pruning the high-quality genotype data. Encouragingly, LocalNgsRelate accurately estimates <italic toggle="yes">R</italic> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>) as well as IBD states down to depths of at least 2× (<xref rid="btab732-F1" ref-type="fig">Fig.  1</xref>). Moreover, performing the same assessment of <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref> and hap-IBD applied to genotypes called from the low-depth NGS datasets showed that LocalNgsRelate has higher accuracy, lower false negative rates, and only modestly higher false positive rate than both these methods for all related pairs (<xref rid="btab732-F1" ref-type="fig">Fig.  1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3A</xref>). As <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref> takes a user-supplied genotype error rate, we not only performed this comparison using the default error rate, but also a range of other values. As expected, the performance of <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref> depends on the error rate; however, the optimal error rate depends both on sequencing depth and the degree of relatedness (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S4 and S5</xref>) and in all cases LocalNgsRelate performed better.</p>
    <fig position="float" id="btab732-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Performance of LocalNgsRelate, <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref> and hap-IBD for five pairs of individuals at different sequencing depths. Performance was assessed by comparing the IBD state assigned by each method when applied to NGS data to the IBD state assigned by <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref> applied to high-quality genotype data for the same individuals</p>
      </caption>
      <graphic xlink:href="btab732f1" position="float"/>
    </fig>
    <p>Next, we considered the effect of reduced sample size, which impacts allele frequency estimation, on LocalNgsRelate. From the 101 NGS samples, we took subsets of size 50, 25, 15 and 7 (including the 7 samples that make up the related pairs), and repeated the analyses (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>). Interestingly, the performance is not affected much until only 15 samples are available. Then the accuracy starts to decrease, especially at 1× depth. Similarly, we investigated how robust the method is to the use of allele frequencies from other populations more or less similar to the population the samples of interest are from, here represented by YRI and CEU, respectively. Not surprisingly, this showed that the method can be used with allele frequencies from a similar population without much loss in performance, but that its performance is markedly decreased if the allele frequencies are from a less similar population (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>).</p>
    <p>We also evaluated the importance of accurate LD pruning for the performance of LocalNgsRelate. To do so we called SNPs from the NGS data, and then thinned the new SNPs based on distance as an approximation for LD pruning. When we applied LocalNgsRelate to this set of SNPs instead we did not see a substantial performance effect, and this result was robust across several choices of distances (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S8–S11</xref>). If anything, at lower depths and samples sizes LocalNgsRelate actually performs better on this less accurately LD pruned dataset.</p>
    <p>Finally, we note that the above results for LocalNgsRelate were obtained using Viterbi inference; however, when using posterior decoding and a posterior cutoff, we observed comparable results (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S12 and S13</xref>).</p>
  </sec>
  <sec>
    <title>4 Discussion and conclusion</title>
    <p>We have presented LocalNgsRelate, a new method for inferring IBD sharing along the genome of two individuals. We have shown that it performs well and outperforms the state-of-the-art genotype-based methods <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref> and hap-IBD on low-depth NGS data. For hap-IBD, this result is not surprising as this method is designed for phased genotype data, and, like genotype calling, phasing is difficult for low-depth NGS data. In fact, hap-IBD’s performance is likely markedly worse when, unlike in our example, there is no reference panel available for phasing, as is often the case for nonmodel organisms. On the other hand, to be fair it should be noted that the hap-IBD results are based on genotypes imputed using GLIMPSE and thus part of the reduced performance may be due to the performance of GLIMPSE rather than hap-IBD itself.</p>
    <p>For <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref>, the result is perhaps more surprising since this method basically only differs from LocalNgsRelate in the way genotype uncertainty is handled. However, our results suggest that using GLs not only makes a user-supplied error rate obsolete, it also better reflects the nature of uncertainty in low-depth NGS data. It should be noted that <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref> has one feature that LocalNgsRelate does not: an ad hoc correction for LD based on LD estimates obtained from genotype data. LocalNgsRelate instead requires LD pruned data. Because it is challenging to estimate LD from low-depth NGS data (<xref rid="btab732-B3" ref-type="bibr">Fox <italic toggle="yes">et al.</italic>, 2019</xref>), it is difficult to use the same correction as <xref rid="btab732-B1" ref-type="bibr">Albrechtsen <italic toggle="yes">et al.</italic> (2009)</xref> and it may even be difficult to prune for LD. However, encouragingly, we obtained comparable results when we LD pruned simply by thinning SNPs based on distance, suggesting that LocalNgsRelate can be used even when LD cannot be estimated.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>A.L.S. was supported by the NSF Graduate Research Fellowship and the NIH [R01 HG005855]. I.M. was funded by the European Research Council [ERC-2018-STG-804679]. </p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared. </p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab732_supplementary_data</label>
      <media xlink:href="btab732_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab732-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Albrechtsen</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>Relatedness mapping and tracts of relatedness for genome-wide data in the presence of LD</article-title>. <source>Genet. Epidemiol</source>., <volume>33</volume>, <fpage>266</fpage>–<lpage>274</lpage>.<pub-id pub-id-type="pmid">19025785</pub-id></mixed-citation>
    </ref>
    <ref id="btab732-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Albrechtsen</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Natural selection and the distribution of identity-by-descent in the human genome</article-title>. <source>Genetics</source>, <volume>186</volume>, <fpage>295</fpage>–<lpage>308</lpage>.<pub-id pub-id-type="pmid">20592267</pub-id></mixed-citation>
    </ref>
    <ref id="btab732-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fox</surname><given-names>E.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>ngsLD: evaluating linkage disequilibrium using genotype likelihoods</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>3855</fpage>–<lpage>3856</lpage>.<pub-id pub-id-type="pmid">30903149</pub-id></mixed-citation>
    </ref>
    <ref id="btab732-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korneliussen</surname><given-names>T.S.</given-names></string-name>, <string-name><surname>Moltke</surname><given-names>I.</given-names></string-name></person-group> (<year>2015</year>) <article-title>NgsRelate: a software tool for estimating pairwise relatedness from NGS data</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>4009</fpage>–<lpage>4011</lpage>.<pub-id pub-id-type="pmid">26323718</pub-id></mixed-citation>
    </ref>
    <ref id="btab732-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korneliussen</surname><given-names>T.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>ANGSD: analysis of Next Generation Sequencing Data</article-title>. <source>BMC Bioinform</source>., <volume>15</volume>, <fpage>356</fpage>.</mixed-citation>
    </ref>
    <ref id="btab732-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Rawe</surname><given-names>J.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Accounting for uncertainty in DNA sequencing data</article-title>. <source>Trends Genet</source>., <volume>31</volume>, <fpage>61</fpage>–<lpage>66</lpage>.<pub-id pub-id-type="pmid">25579994</pub-id></mixed-citation>
    </ref>
    <ref id="btab732-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>A fast and simple method for detecting identity by descent segments in large-scale data</article-title>. <source>Am. J. Hum. Genet</source>., <volume>106</volume>, <fpage>426</fpage>–<lpage>437</lpage>.<pub-id pub-id-type="pmid">32169169</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
