<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9116035</article-id>
    <article-id pub-id-type="publisher-id">4723</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04723-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DeSP: a systematic DNA storage error simulation pipeline</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yuan</surname>
          <given-names>Lekang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Zhen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ye</given-names>
        </name>
        <address>
          <email>wangy17@mails.tsinghua.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Xiaowo</given-names>
        </name>
        <address>
          <email>xwwang@tsinghua.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.12527.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 0662 3178</institution-id><institution>Ministry of Education Key Laboratory of Bioinformatics; Center for Synthetic and Systems Biology; Beijing National Research Center for Information Science and Technology; Department of Automation, Tsinghua University, </institution></institution-wrap>Beijing, China 100084 </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.12527.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 0662 3178</institution-id><institution>Tsinghua-Berkeley Shenzhen Institute, </institution><institution>Tsinghua University, </institution></institution-wrap>Shenzhen, 518055 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>185</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>5</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Using DNA as a storage medium is appealing due to the information density and longevity of DNA, especially in the era of data explosion. A significant challenge in the DNA data storage area is to deal with the noises introduced in the channel and control the trade-off between the redundancy of error correction codes and the information storage density. As running DNA data storage experiments in vitro is still expensive and time-consuming, a simulation model is needed to systematically optimize the redundancy to combat the channel's particular noise structure.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we present DeSP, a systematic DNA storage error Simulation Pipeline, which simulates the errors generated from all DNA storage stages and systematically guides the optimization of encoding redundancy. It covers both the sequence lost and the within-sequence errors in the particular context of the data storage channel. With this model, we explained how errors are generated and passed through different stages to form final sequencing results, analyzed the influence of error rate and sampling depth to final error rates, and demonstrated how to systemically optimize redundancy design in silico with the simulation model. These error simulation results are consistent with the in vitro experiments.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">DeSP implemented in Python is freely available on Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/WangLabTHU/DeSP">https://github.com/WangLabTHU/DeSP</ext-link>). It is a flexible framework for systematic error simulation in DNA storage and can be adapted to a wide range of experiment pipelines.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-04723-w.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>DeSP</kwd>
      <kwd>DNA storage</kwd>
      <kwd>Systematic error simulation</kwd>
      <kwd>Encoding optimization</kwd>
      <kwd>Web application</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>62050152</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wang</surname>
            <given-names>Xiaowo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100012166</institution-id>
            <institution>National Key Research and Development Program of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2020YFA0906900</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wang</surname>
            <given-names>Xiaowo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">In the era of data explosion, DNA emerged as a promising data storage medium due to its high information density and longevity [<xref ref-type="bibr" rid="CR1">1</xref>]. The process of DNA storage is complicated and each stage produces noises and errors, which might lead to data corruption. Faced with this challenge, a series of error-correcting codes were introduced to recover the files from erroneous data by adding redundancy while encoding [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par5">To find the optimal encoding method and redundancy level, the redundancy must be introduced in a proper way to combat the particular noise structure [<xref ref-type="bibr" rid="CR7">7</xref>]. A deep understanding of the noise structure for a given DNA data storage channel is thus required for optimizing encoding methods accordingly. As running DNA data storage experiments in vitro is still expensive and time-consuming, a simulation pipeline is needed to reveal the particular noise structure of the DNA data storage channel in silico and optimize the redundancy design systematically.</p>
    <p id="Par6">To build a systematic error simulation pipeline for the DNA data storage channel, some important factors must be considered:<list list-type="order"><list-item><p id="Par7">A systematic end-to-end model is desired which covers all the key stages of the storage process to reveal how errors are generated and propagated to form final sequencing results.</p></list-item><list-item><p id="Par8">Both sequence-lost errors and errors within a sequence should be simulated.</p></list-item><list-item><p id="Par9">When simulating within-sequence errors, the unique character of the DNA data storage process should be addressed: a sequence is stored in the pool with several copies instead of one and retrieved by combing several sequencing readouts, so the proportion of errors in the population instead of the raw error rate of a single sequencing read should be analyzed.</p></list-item></list></p>
    <p id="Par10">In the previous literature, extensive experiments were performed to characterize each stage from synthesis to Polymerase Chain Reaction (PCR) to sequencing [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>]. These single-stage characterization studies build up the foundations for building a model for DNA data storage but can't be directly used when stages are combined. In the DNA data storage area, Hamoum put forward a channel model for the Nanopore Sequencing platform [<xref ref-type="bibr" rid="CR12">12</xref>]. The model experts in simulating one stage accurately, but can’t capture the evolution of errors across stages in the end-to-end process systematically. For the end-to-end simulation, the sequence lost errors have been studied by Heckel and Chen [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>], but within-sequence errors were not well addressed. Schwarz simulated within-sequence errors in a more general context [<xref ref-type="bibr" rid="CR15">15</xref>] but only performed simulations on a single sequence, making it not suitable for DNA data storage based on the oligo pool which consists of multiple sequences copies. By now, we still lack a systematic model that can simulate both the sequence lost and the within-sequence errors across all stages in the particular context of the DNA data storage channel.</p>
    <p id="Par11">Here, we present DeSP, a systematic DNA storage error Simulation Pipeline. Addressing the requirements mentioned above, we established a model for the end-to-end simulation of the DNA data storage process, to reveal noise structures for a given channel quantitively. The model is flexible, as it can adapt to diverse experiment conditions, such as different sequencing platform and PCR conditions, by changing parameters accordingly and modeling different stages separately or as a whole. Based on the model's simulation functions, we put forward a method for optimizing the redundancy level systematically, finding the suitable trade-off point between information density and success probability (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). To make the platform easy to use for the community, we provided source code, testing notebooks, and a demonstrative web application. We showed the platform can be used to generate simulated sequencing results consistent with real experiments, and demonstrated its usage for noise structure analysis and encoding optimization. With systematic in silico simulation, we hope this pipeline can boost the DNA data storage area's development, bringing a deeper understanding of the DNA data storage channel and optimal designs.<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the proposed error simulation framework. A systematic error simulation model is established to model both the whole sequence lost error and the within-sequence error in the special context of DNA data storage. The model takes encoded DNA sequences as inputs and generated simulated sequencing results similar to real experiments. By analyzing the error profile and decoding status of the simulated results, redundancy of the error correction code can be optimized, providing a systematic approach for optimizing encoding designs</p></caption><graphic xlink:href="12859_2022_4723_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par12">To validate the model and demonstrate its usage, we compared the simulation results against real experiment data, analyzed noise structures of DNA data storage channel using the error simulation system, and demonstrated the process of choosing proper redundancy with the encoding optimization methods.</p>
    <p id="Par13">We implemented the simulation pipeline in Python, and the package can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/WangLabTHU/DeSP">https://github.com/WangLabTHU/DeSP</ext-link>. Users can easily construct a model fitting their needs by linking the building modules and customizing the parameters following the instructions on GitHub. The model receives DNA sequences prepared to be synthesized as input and provides raw DNA readouts as output, and we also provide functions to inspect the simulation results. A demonstrative web application is available to show how the model works (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6 and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note 2). Users may visit the application at the link updated on the GitHub page or deploy it locally in several minutes.</p>
  </sec>
  <sec id="Sec3">
    <title>Abstraction of the DNA data storage channel</title>
    <p id="Par14"><italic>Data input of the simulation model:</italic> Current technology enables the high-throughput synthesis of short oligonucleotides. To store a file into DNA library, the data must be split, indexed, and encoded into multiple DNA sequences. Therefore, the input of the DNA simulation model can be viewed as <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M2"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq1.gif"/></alternatives></inline-formula> DNA sequences generated from the upstream encoding process.</p>
    <p id="Par15"><italic>Data representation in a DNA pool:</italic> After synthesis, one DNA sequence will have multiple copies in the DNA library pool, and errors might be introduced in those copies due to the imperfectness of the process (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). We choose such data representation accordingly: sequence <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M4"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq2.gif"/></alternatives></inline-formula> has <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{i}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq3.gif"/></alternatives></inline-formula> corresponding oligonucleotides, which is composited of <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M8"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq4.gif"/></alternatives></inline-formula> error types <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{i1},{e}_{i2}\dots {e}_{ik}$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq5.gif"/></alternatives></inline-formula>, with copy numbers of each error type <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{i1},{n}_{i2}\dots {n}_{ik}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq6.gif"/></alternatives></inline-formula> as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a.<fig id="Fig2"><label>Fig. 2</label><caption><p>Building modules and noise source considered in DeSP. <bold>a</bold> Abstractions of the DNA data storage channel. A file will be split into several DNA sequences, one DNA sequence has multiple copies in the synthesized pool, and sequence information will be recovered with the voting result of multiple sequencing reads. <bold>b</bold> Two kinds of basic modules. E module: error generation module; D module: distribution changing module. <bold>c</bold> Full DNA data storage channel model built by composing basic modules. <bold>d</bold> A summary of how each stage influences the oligonucleotides composition in terms of introducing new errors and changing copy number distribution</p></caption><graphic xlink:href="12859_2022_4723_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par16"><italic>Data output and generation of voting errors:</italic> The data is retrieved from the DNA pool by sequencing, and one sequence will have multiple sequencing readouts. The simulation model will provide the original sequencing readouts as output, following the representation similar to that in the pool (several error types with corresponding readout numbers). The raw sequencing readouts can be further combined with different methods to obtain the final consensus sequences (“<xref rid="Sec11" ref-type="sec">Methods</xref>”). After this step, two types of errors might be produced: the whole sequence might be lost if no reads are found, and a voting error is formed if a wrong base has a stronger signal than the real base in the population.</p>
    <sec id="Sec4">
      <title>Combining basic modules to build a complete pipeline</title>
      <p id="Par17">To reveal the noise structures, the model needs to simulate how each stage in the data storage process influences the composition of each sequence to form the final voting errors. We abstracted two basic modules to model two kinds of influence (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b):</p>
      <p id="Par18"><italic>The Error Generation Module:</italic> Errors might be introduced within a sequence when synthesis, decay, and sequencing, generating new error types: <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{e}_{i1},{e}_{i2}\dots {e}_{ik}\}\to$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">→</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq7.gif"/></alternatives></inline-formula>
<inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\{e}_{i1},{e}_{i2}\dots {e}_{ik},\dots {e}_{ik+j}\}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq8.gif"/></alternatives></inline-formula>. We simulated the error generation process with a stochastic mutation process. The base substitution events were first simulated with possibilities controlled by substitution rate <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{sub}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq9.gif"/></alternatives></inline-formula> (the transformation matrix, as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b. Deletion and insertion events were then simulated according to deletion rate <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{del}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">del</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq10.gif"/></alternatives></inline-formula> and insertion rate <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{ins}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">ins</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq11.gif"/></alternatives></inline-formula>. The default <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${T}_{sub}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">sub</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq12.gif"/></alternatives></inline-formula>, <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{del}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">del</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{ins}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">ins</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq14.gif"/></alternatives></inline-formula> for a given platform were obtained from the literature [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR21">21</xref>].</p>
      <p id="Par19"><italic>The Distribution changing module:</italic> The number distribution of each error type might change in almost all stages from synthesis, decay, PCR, sampling to sequencing:<inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\{n}_{i1},{n}_{i2}\dots {n}_{ik}\to {n}_{i1}^{^{\prime}},{n}_{i2}^{^{\prime}}\dots {n}_{ik}^{^{\prime}}\}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq15.gif"/></alternatives></inline-formula>.In the simulation,<inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{ij}^{^{\prime}}$$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq16.gif"/></alternatives></inline-formula> is obtained by computing a distribution with <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{ij}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq17.gif"/></alternatives></inline-formula> and the corresponding parameters of the given stage, and sampling a number from the distribution.</p>
      <p id="Par20">The model was built hierarchically with these two basic modules. One stage might be composed of one or more modules. Figure <xref rid="Fig2" ref-type="fig">2</xref>c, d provide a summary of how each stage influences the oligonucleotides composition in terms of introducing new errors and changing copy number distribution, and how this was modeled accordingly. For example, an uneven initial copy number distribution is generated when synthesizing due to the imperfect coupling efficiency, and nucleosides insertion, deletion, and substitution might occur due to the improper activation of nucleoside printing. To illustrate the two modules and the composition of modules intuitionally, we also provided an example using real simulation data in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2. A more detailed description about how we modeled each stage from synthesis [<xref ref-type="bibr" rid="CR9">9</xref>], decay [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR16">16</xref>], PCR [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>], sampling and sequencing [<xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR21">21</xref>] is provided in the Additional file <xref rid="MOESM1" ref-type="media">1</xref> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). These stages are further connected in series to form the entire DNA data storage channel (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c).</p>
    </sec>
    <sec id="Sec5">
      <title>Comparison between simulation results and real data</title>
      <p id="Par21">To test the validity of the model, we compared the simulation data against the real data obtained from an in vitro experiment. In the experiment, we encoded a compressed file of five baseball images into 1891 DNA sequences with DNA Fountain code and synthesized them into DNA sequences by the iGeneTech oligonucleotides pool. Each DNA sequence contains 126 bases, including 64 bp (base pairs) data payload, 16 bp RS code, 16 bp seed, and 15 bp primer on both sides. The synthesized DNA sequences were then sampled, PCR amplified, and finally readout using the Illumina NextSeq500 platform.</p>
      <p id="Par22">Corresponding in silico modules were linked to build a simulation model of this process; most parameters of the simulation model were set identical to the real experiment, and some unclear parameters (such as PCR bias) were determined by parameter fitting (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). The same encoded sequences as the real experiment were passed to the established model to get simulated sequencing results under several sequencing depths, and the sequencing reads from the real experiment were also down-sampled to the same depths for comparison. According to Fig. <xref rid="Fig3" ref-type="fig">3</xref>, the trends of numbers of loss sequences and sequences with errors in the simulated data are consistent with the actual data. Examples of simulated sequencing readouts against actual sequencing readouts are also provided in the Additional file <xref rid="MOESM1" ref-type="media">1</xref> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4).<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison between simulation results and real data. The relationship between simulated sequencing depth and lost sequences is consistent with the experimental DNA storage sequencing result (left). The relationship between simulated sequencing depth and the number of sequences with errors is consistent with corresponding result in experimental DNA storage sequencing (right)</p></caption><graphic xlink:href="12859_2022_4723_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Noise structures of DNA data storage channel</title>
      <p id="Par23">To reveal the DNA data storage channel’s noise structure, we used an image file of DNA double helix from the Unsplash website (“<xref rid="Sec11" ref-type="sec">Methods</xref>”) and encode it into about two thousand strands of DNA with a length of 104 bp and passed the strands to the model. We first provided an intuitional explanation about how errors are formed by analyzing simulation results after each stage. With the observed phenomenon, we then examined how error rate, sampling, and sequencing depth influence lost number and final error rate via quantitative repeated simulations.</p>
      <p id="Par24">The distribution of oligonucleotides number in different stages are shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a. The distribution started from a Binomial distribution of a synthesized pool and skewed when going through the decay and PCR process due to uneven amplification/decay ratio arising from the stochastic process. When sampling from the uneven distribution under low sampling depth, the distribution was significantly changed, and some sequences might be lost. <fig id="Fig4"><label>Fig. 4</label><caption><p>Noise structures of DNA data storage channel. <bold>a</bold> The Evolvement of oligonucleotides number distribution and error number distribution across the channel. The first row shows the distribution change of the copy numbers of about two thousand oligonucleotides that encode a file. A sequence will be lost if the copy number of the sequence falls to zero, and the percentages of lost sequence are denoted in the figure. In the second row, error number = 1 means the oligonucleotides sequence contains one error after voting all its copies. The percentages of sequences with more than one error are denoted. <bold>b</bold> Influence of sampling/sequencing depth and sequencing error rate to final voting error rate obtained from quantitative repeated experiments. <bold>c</bold> Copy numbers of different error types of one sequence after different stages, corresponding final voting result, and the final voting result obtained under Nanopore sequencing platform with the same sample</p></caption><graphic xlink:href="12859_2022_4723_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par25">Sequence lost might happen both in the sampling stage and the sequencing stage. Increasing the sampling ratio would decrease the number of lost sequences (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). At a given sampling ratio, the number of lost sequences would decrease first with the increase of the sequencing depth, and finally coverages to a certain value. The value corresponds to the number of sequences lost in the previous stages. For example, at a 0.1% sampling rate, when the sequencing depth is higher than 40, the number of lost sequences would coverage to approximately 16, which is the number of lost sequences after sampling. According to the results, it is crucial to guarantee both the sampling ratio and the sequencing depth higher than a certain level in experiments.</p>
    </sec>
    <sec id="Sec7">
      <title>Base composition and voting error</title>
      <p id="Par26">To illustrate how final voting errors are formed, we chose one sequence and depicted the copy numbers of its different error types after passing through different stages, along with the final voting result in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c. New errors were generated in synthesis, decay, and sequencing stages, and errors introduced in previous stages were passed to later stages when sampling. If an error base dominated in a spot, a voting error would occur.</p>
      <p id="Par27">Only changing one parameter might not lead to a change in the final error rate. For example, after replacing the sequencing method with the Nanopore sequencing, which has a much higher error rate, more errors were generated, but with enough sequencing depth, none of the new errors dominated, and there was still only one error in the final voting result.</p>
      <p id="Par28">Simulations showed that improving sequencing depth or sampling depth will lead to fewer errors, and voting errors in the sampling stage are likely to maintain in the sequencing stage. A higher sequencing error rate will lead to more errors when sequencing depth is low, but the number will decrease with increased sequencing depth to a level similar to that of the low error rate NGS platform (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b).</p>
    </sec>
    <sec id="Sec8">
      <title>Choosing proper redundancy for encoding</title>
      <p id="Par29">For the encoding optimization part, we tested the task of choosing suitable <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq18.gif"/></alternatives></inline-formula> and <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M38"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq19.gif"/></alternatives></inline-formula> for decoding the image file of DNA double helix from the Unsplash website (“<xref rid="Sec11" ref-type="sec">Methods</xref>”) with a successful decoding probability higher than 99%. We used Eq. (<xref rid="Equ1" ref-type="">1</xref>) in the Additional file <xref rid="MOESM1" ref-type="media">1</xref> to estimate information density under different <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq20.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq21.gif"/></alternatives></inline-formula> =2 was found to be optimal to achieve an information density of 76% (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a).<fig id="Fig5"><label>Fig. 5</label><caption><p>Encoding design with the model. <bold>a</bold> Oligonucleotides number and error number distributions of the simulated result. <bold>b</bold> Number distribution of total lost(left). Droplets for decoding obtained with 200 repeated experiments, and corresponding approximation computed from all the 200 experiments and 10 of the experiments(right). <bold>c</bold> Probability distribution of total lost (red) and permitted lost (blue) for different <inline-formula id="IEq87"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M44"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq87.gif"/></alternatives></inline-formula>, and the relationship between failing probability and <inline-formula id="IEq88"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M46"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq88.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2022_4723_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par30">Distribution types of total lost number and droplets number for successful decoding <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta M$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi>β</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq22.gif"/></alternatives></inline-formula> are required when fitting data. With 200 repeated experiments, Poisson distribution was found to be a good approximation for total lost number distribution, possibly because every sequence has a small chance to be lost, which formed a Poisson process. The distribution for droplet numbers used for decoding is more complicated, so we empirically chose the right-skewed Gumbel distribution (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b) that fitted the data best under the Anderson–Darling test [<xref ref-type="bibr" rid="CR22">22</xref>].</p>
      <p id="Par31">We fitted the distributions with data obtained from 10 repeated experiments and compute the distribution of <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\alpha - \beta )M$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq23.gif"/></alternatives></inline-formula> for different <inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M52"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq24.gif"/></alternatives></inline-formula> with the distribution of <inline-formula id="IEq25"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta M$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>β</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq25.gif"/></alternatives></inline-formula>, the distribution of total lost number with <inline-formula id="IEq26"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda = ptl(1+\alpha )N$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq26.gif"/></alternatives></inline-formula>. The failing probability was computed according to Eq. (<xref rid="Equ3" ref-type="">3</xref>). Depicting the relationship between failing probability and <inline-formula id="IEq27"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M58"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq27.gif"/></alternatives></inline-formula> in Fig. <xref rid="Fig5" ref-type="fig">5</xref>c, 0.25–0.28 was found to be the acceptable range for <inline-formula id="IEq28"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M60"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq28.gif"/></alternatives></inline-formula>.</p>
      <p id="Par33">In this experiment, the redundancy level is set optimal for a given DNA data storage channel (“<xref rid="Sec11" ref-type="sec">Methods</xref>”). If some parts of the channel are changed, the optimal redundancy level can also be updated by rerunning the above process. For example, if we want to save some budget by choosing a lower sequencing depth, more voting errors might occur within a sequence and the total lost number <inline-formula id="IEq29"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{tl}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">tl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq29.gif"/></alternatives></inline-formula> might increase. To guarantee the decoding probability will still be higher than 99%, we can use the above optimization methods to update the redundancy to a higher level while keeping the information density as high as possible.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par34">DNA storage become an increasingly active field due to the information density and longevity of DNA. Therefore, how to control the trade-off between the information density and successful information recovery rate is essential in practice. DeSP is a systematic error simulation pipeline, which analyses how errors are generated and passed through different stages to form final sequencing results. We also demonstrated the process of choosing optimal redundancy systemically in silico before running the real experiment in vitro.</p>
    <p id="Par35">With the model, we explained how errors are generated and passed through different stages to form final sequencing results, analyzed the influence of error rate and sampling depth to final voting error rates, and demonstrated the process of choosing optimal redundancy systemically in silico before running the real experiment in vitro. We hope the model can deepen the understanding of the DNA data storage channel's noise structures and facilitate designing encoding methods for this particular noise channel.</p>
    <p id="Par36">In the future, the simulation model can be further improved in terms of efficiency and fidelity with optimized simulation algorithms and results from real experiments. With the simulation model, methods for optimizing encoding designs for other types of codes can be added under the general framework, and the optimizing targets can be extended from the encoding system to both the encoding system and the data channel, optimizing encoding success probability, information density and experiment cost.</p>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par37">DeSP is a systematic pipeline that can simulate both the sequence lost and the within-sequence errors across all stages in the particular context of DNA data storage. Most importantly, the simulation pipeline helps to deepen the understanding of the DNA data storage channel's noise structures and facilitate designing encoding methods for this particular noise channel. DeSP also provides an easy-to-use demonstrative web application version for diverse users.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Flexibility and expansibility of the model</title>
      <p id="Par38"><italic>Modularity brings flexibility for using the model.</italic> Using the simulation model, users may pass the data through separate stages to explore what happens in different stages to understand the DNA data storage channel (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). They can also use a composed model to examine how different parameters influence the final error rate.</p>
      <p id="Par39"><italic>The model also enjoys high expansibility.</italic> It can be configured to model various experiment setups, serves as a general simulation framework for the DNA data storage area. Users can choose individual modules and link them properly (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c), assign parameters to selected modules, and even create a new module without changing other modules. With a minor modification of the code, users can establish a whole model to suit their needs.</p>
      <p id="Par40">The established model can also be embedded in various encoding–decoding pipelines. The in silico simulation model shares the same data input and output with the real experiment process: it receives encoded DNA sequences as input and generates raw erroneous copies for each sequence as outputs. As no assumptions are made about the external encoding/decoding modules when building the simulation model, it can receive encoded sequences from any encoding methods as input. The raw output can be combined with different clustering/consensus methods to obtain retrieved sequences, which are then passed to the decoding module to retrieve the original data. Decoupling with external modules brings more flexibility to the model, enabling it to serve as a general simulation platform in a wide range of experiment pipelines.</p>
    </sec>
    <sec id="Sec13">
      <title>Encoding design optimization principles in DNA storage channel</title>
      <p id="Par41">Noise might be generated in the storage process, causing data corruption. Introducing redundancy with certain encoding methods could combat the noise with the cost of low efficiency. An ideal encoding design should be suitable for the storage process’ noise structure, with minimum redundancy just enough to combat the noise level. This part will discuss how to choose the optimal redundancy level for a given channel with the model.</p>
      <p id="Par42">The optimal redundancy should be set to a proper level to balance two goals: a. maximizing information density (the number of bits stored in one base). b. maximizing the probability for successful data retrieval. Two factors are needed to compute the success probability: noise level of the channel (how many errors might be generated in a given channel) and error-correction ability of the code (how many errors can be corrected with the introduced redundancy). The model can be used to estimate both factors to compute the relationship between information density and probability. Then the redundancy level can be easily selected to meet a specific need.</p>
      <p id="Par43">Here, we provide a case for choosing the proper redundancy level for the DNA fountain code [<xref ref-type="bibr" rid="CR5">5</xref>] as an example (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). We used an image file of DNA double helix from the Unsplash website (<ext-link ext-link-type="uri" xlink:href="https://unsplash.com/license">https://unsplash.com/license</ext-link>) and resized it into 9 KB. Methods can also be developed for other types of code to find optimal redundancy levels with the general simulation model.<fig id="Fig6"><label>Fig. 6</label><caption><p>Optimizing redundancy for the encoding method including Fountain code and RS code. <bold>a</bold> The error rate was simulated by DeSP and guided the adjustment of parameter α and <inline-formula id="IEq89"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq89.gif"/></alternatives></inline-formula>. <bold>b</bold> The target optimization parameter α determines how many extra sequences are generated when encoding with the fountain code. The parameter <inline-formula id="IEq90"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq90.gif"/></alternatives></inline-formula> is the length of the RS code</p></caption><graphic xlink:href="12859_2022_4723_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>Choose redundancy level for DNA Fountain code</title>
      <p id="Par44">DNA Fountain code is one of the most popular encoding methods used in the DNA data storage area. It uses fountain code to deal with the sequence lost error and RS (Reed-Solomon) code to combat the within-sequence errors. The redundancy level of DNA Fountain code is related to the parameter of the fountain code, <inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M68"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq30.gif"/></alternatives></inline-formula>, and the length of the RS code <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq31.gif"/></alternatives></inline-formula>.</p>
      <p id="Par45">The parameter <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M72"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq32.gif"/></alternatives></inline-formula> determines how many extra sequences are generated when encoding with the fountain code. When encoding, data are divided into <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M74"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq33.gif"/></alternatives></inline-formula> chunks and encoded into <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(1+\alpha )M$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq34.gif"/></alternatives></inline-formula> droplets, which are then synthesized into DNA. To recover the data, only <inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(1+\beta )M$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq35.gif"/></alternatives></inline-formula> droplets are needed, which permits <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\alpha -\beta )M$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq36.gif"/></alternatives></inline-formula> sequences to be lost. Increasing <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M82"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq37.gif"/></alternatives></inline-formula> will provide higher tolerance to the sequence loss, but will also lead to a lower information density.</p>
      <p id="Par46">The parameter <inline-formula id="IEq38"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq38.gif"/></alternatives></inline-formula> means how many bytes of RS code are added within the sequence. Before decoding the fountain code, we need to make sure every droplet used for decoding is errorless, so we need to correct the within-sequence errors of each droplet. This is achieved by adding RS code to the generated droplets while encoding to protect a sequence from within-sequence noise under a certain level: by adding <inline-formula id="IEq39"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq39.gif"/></alternatives></inline-formula> bytes of RS code, <inline-formula id="IEq40"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[{L}_{RS}/2\right]$$\end{document}</tex-math><mml:math id="M88"><mml:mfenced close="]" open="["><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq40.gif"/></alternatives></inline-formula> bytes of error can be detected and corrected. When decoding, for each sequence, if the sequence contains no error or the error can be corrected with the RS code, it will be passed to the fountain code. Otherwise, it will be discarded, leading to the same effect as sequence lost, and the total lost number <inline-formula id="IEq41"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{tl}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">tl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq41.gif"/></alternatives></inline-formula> can be calculated by adding the numbers of lost and discarded sequences together. Similar to <inline-formula id="IEq42"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M92"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq42.gif"/></alternatives></inline-formula>, longer <inline-formula id="IEq43"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq43.gif"/></alternatives></inline-formula> means higher tolerance to within-sequence errors but lower information density. Note there is a correlation between <inline-formula id="IEq44"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M96"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq44.gif"/></alternatives></inline-formula> and <inline-formula id="IEq45"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq45.gif"/></alternatives></inline-formula>: if <inline-formula id="IEq46"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq46.gif"/></alternatives></inline-formula> is set higher, sequences with more errors can also be corrected and we will have more valid droplets for decoding, so smaller <inline-formula id="IEq47"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M102"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq47.gif"/></alternatives></inline-formula> might be enough to deal with the fewer total droplets lost.</p>
    </sec>
    <sec id="Sec15">
      <title>Optimizing <inline-formula id="IEq48"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\boldsymbol{\alpha }$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{L}}}_{{\varvec{R}}{\varvec{S}}}$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq49.gif"/></alternatives></inline-formula> with the model</title>
      <p id="Par47">When trying to obtain the highest information density while guaranteeing a certain level of success probability, both <inline-formula id="IEq50"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq50.gif"/></alternatives></inline-formula> and <inline-formula id="IEq51"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M110"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq51.gif"/></alternatives></inline-formula> should be optimized.</p>
      <p id="Par48"><inline-formula id="IEq52"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq52.gif"/></alternatives></inline-formula> can be optimized first according to error number distribution. As an intuitive example, among the sequences with errors, if most sequences contain only one error, it might be a wise choice to set <inline-formula id="IEq53"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq53.gif"/></alternatives></inline-formula> = 2 to correct only one error, as discarding sequences with more than one error won’t bring too much burden on <inline-formula id="IEq54"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M116"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq54.gif"/></alternatives></inline-formula>.To choose <inline-formula id="IEq55"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq55.gif"/></alternatives></inline-formula> quantitatively, information densities <inline-formula id="IEq56"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D(k)$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq56.gif"/></alternatives></inline-formula> under different RS code lengths <inline-formula id="IEq57"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M122"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq57.gif"/></alternatives></inline-formula> can be estimated. The overall information density is a combination of the within-sequence information density (the left part, in which <inline-formula id="IEq58"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{d}$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mi>L</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq58.gif"/></alternatives></inline-formula> denotes the length of the data in bytes, <inline-formula id="IEq59"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M126"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq59.gif"/></alternatives></inline-formula> denotes the length of the RS code in bytes) and the across-sequence information density (the right part, in which <inline-formula id="IEq60"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M128"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq60.gif"/></alternatives></inline-formula> is the number of data chunks before encoding, <inline-formula id="IEq61"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(1+\beta )N$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq61.gif"/></alternatives></inline-formula> is the number of droplets needed for decoding, <inline-formula id="IEq62"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{l}$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mi>N</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq62.gif"/></alternatives></inline-formula> is the number of the lost sequences, and <inline-formula id="IEq63"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sum }_{i=k}^{\infty }{N}_{e}(i)$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq63.gif"/></alternatives></inline-formula> is the number of sequences that contain too many errors for the RS code to correct and are abandoned.</p>
      <p id="Par49">From Eq. (<xref rid="Equ1" ref-type="">1</xref>), we can also see the trade-off when choosing the proper <inline-formula id="IEq64"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq64.gif"/></alternatives></inline-formula>: if we want to obtain a high within-sequence information density by setting RS code length <inline-formula id="IEq65"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M138"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq65.gif"/></alternatives></inline-formula> low, the number of sequences that can not be corrected (<inline-formula id="IEq66"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum_{i=k}^{\infty }{N}_{e}\left(i\right)$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq66.gif"/></alternatives></inline-formula>) will increase, so more droplets need to be generated, leading to a low across-sequence information density. According to Eqs. (<xref rid="Equ1" ref-type="">1</xref>) and (<xref rid="Equ2" ref-type="">2</xref>), <inline-formula id="IEq67"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq67.gif"/></alternatives></inline-formula> was chosen to obtain the highest information density. The parameter <inline-formula id="IEq68"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M144"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq68.gif"/></alternatives></inline-formula> was then optimized under a given <inline-formula id="IEq69"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{RS}$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq69.gif"/></alternatives></inline-formula>.</p>
      <p id="Par50">To choose proper <inline-formula id="IEq70"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M148"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq70.gif"/></alternatives></inline-formula>, the relationship between the total lost number <inline-formula id="IEq71"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{tl}$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">tl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq71.gif"/></alternatives></inline-formula> and permitted lost number <inline-formula id="IEq72"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\alpha -\beta )M$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq72.gif"/></alternatives></inline-formula> should be considered: only when <inline-formula id="IEq73"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\alpha -\beta )M$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq73.gif"/></alternatives></inline-formula> &gt;<inline-formula id="IEq74"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{tl}$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">tl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq74.gif"/></alternatives></inline-formula> the data can be recovered. <inline-formula id="IEq75"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{tl}$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">tl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq75.gif"/></alternatives></inline-formula> and <inline-formula id="IEq76"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\alpha -\beta )M$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq76.gif"/></alternatives></inline-formula> are not constants in different trials, both follow certain distributions, which can be computed by estimating parameters of a certain type of distribution with samples from 5–10 repeat experiments.</p>
      <p id="Par51">In detail, the distribution functions are obtained by the following two steps:<list list-type="order"><list-item><p id="Par52">Obtaining the prior about the distribution family. The distribution prior can be determined with theoretical derivation or empirically with experimental results. Here, we found <inline-formula id="IEq77"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${f}_{{N}_{tl}}(k)$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">tl</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq77.gif"/></alternatives></inline-formula>, follows the Poisson distribution, and <inline-formula id="IEq78"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${f}_{(\alpha -\beta )M}(k)$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq78.gif"/></alternatives></inline-formula>, follows the right-skewed Gumbel distribution by repeated experimental results, as discussed in the second paragraph in part “Choosing proper redundancy for encoding” and Fig. <xref rid="Fig5" ref-type="fig">5</xref>b.</p></list-item><list-item><p id="Par53">Fitting the parameters of the distribution with data obtained from 10 repeated experiments. For example, for <inline-formula id="IEq79"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${f}_{{N}_{tl}}(k)$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">tl</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq79.gif"/></alternatives></inline-formula>, sequence lost numbers of 10 repeated simulations are calculated to fit the λ of the Poisson distribution.</p></list-item></list></p>
      <p id="Par54">With both distributions <inline-formula id="IEq80"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${f}_{{N}_{tl}}(k)$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">tl</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq80.gif"/></alternatives></inline-formula> and <inline-formula id="IEq81"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${f}_{\left(\alpha -\beta \right)M}(k)$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mfenced close=")" open="("><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mfenced><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq81.gif"/></alternatives></inline-formula>,the relationship between the failing probability <inline-formula id="IEq82"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{f}$$\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mi>p</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq82.gif"/></alternatives></inline-formula> and <inline-formula id="IEq83"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M174"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq83.gif"/></alternatives></inline-formula> can now be calculated following Eq. (<xref rid="Equ3" ref-type="">3</xref>). The decoding will fail if the lost number <inline-formula id="IEq84"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M176"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq84.gif"/></alternatives></inline-formula> is higher than the number of droplets permitted to be lost <inline-formula id="IEq85"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M178"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq85.gif"/></alternatives></inline-formula>:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D(k) = \left( {\frac{{L_{d} }}{{L_{d} + 2k}}} \right)\left( {\frac{N}{{(1 + \beta )N + N_{l} + \sum\nolimits_{i = k}^{\infty } {N_{e} (i)} }}} \right)$$\end{document}</tex-math><mml:math id="M180" display="block"><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>L</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2022_4723_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{RS} = 2\,argmax[D(k)]$$\end{document}</tex-math><mml:math id="M182" display="block"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant="italic">RS</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.166667em"/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2022_4723_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{f} (\alpha ) = \sum\limits_{j = 0}^{{T_{max} }} {\sum\limits_{i = 0}^{j} {f_{{N_{tl} }} (i)f_{(\alpha - \beta )M} (j)} }$$\end{document}</tex-math><mml:math id="M184" display="block"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>j</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">tl</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2022_4723_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par55">The value of <inline-formula id="IEq86"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M186"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4723_Article_IEq86.gif"/></alternatives></inline-formula> can be determined accordingly to make the tradeoff between information density and success probability optimal for the application.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4723_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary methods, figures and user guideline for DeSP.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Haoxiao Cai for the positive discussions.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>LKY, YW and ZX wrote the main manuscript text and LKY and prepared Figs. <xref rid="Fig1" ref-type="fig">1</xref>–<xref rid="Fig6" ref-type="fig">6</xref>. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the National Key R&amp;D Program of China (No. 2020YFA0906900), and National Natural Science Foundation of China (Nos. 62050152, 61773230, 61721003).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>DeSP implemented in Python is freely available on Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/WangLabTHU/DeSP">https://github.com/WangLabTHU/DeSP</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par56">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par57">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par58">Not applicable.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhirnov</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Zadegan</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Sandhu</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>WL</given-names>
          </name>
        </person-group>
        <article-title>Nucleic acid memory</article-title>
        <source>Nat Mater</source>
        <year>2016</year>
        <volume>15</volume>
        <issue>4</issue>
        <fpage>366</fpage>
        <lpage>370</lpage>
        <pub-id pub-id-type="doi">10.1038/nmat4594</pub-id>
        <pub-id pub-id-type="pmid">27005909</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kosuri</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Next-generation digital information storage in DNA</article-title>
        <source>Science</source>
        <year>2012</year>
        <volume>337</volume>
        <issue>6102</issue>
        <fpage>1628</fpage>
        <lpage>1628</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1226355</pub-id>
        <pub-id pub-id-type="pmid">22903519</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bertone</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>LeProust</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Sipos</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Towards practical, high-capacity, low-maintenance information storage in synthesized DNA</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>494</volume>
        <issue>7435</issue>
        <fpage>77</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11875</pub-id>
        <pub-id pub-id-type="pmid">23354052</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grass</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Heckel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Puddu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paunescu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stark</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Robust chemical preservation of digital information on DNA in silica with error-correcting codes</article-title>
        <source>Angew Chem Int Ed</source>
        <year>2015</year>
        <volume>54</volume>
        <issue>8</issue>
        <fpage>2552</fpage>
        <lpage>2555</lpage>
        <pub-id pub-id-type="doi">10.1002/anie.201411378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Erlich</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zielinski</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>DNA fountain enables a robust and efficient storage architecture</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>355</volume>
        <issue>6328</issue>
        <fpage>950</fpage>
        <lpage>954</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaj2038</pub-id>
        <pub-id pub-id-type="pmid">28254941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Organick</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ang</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y-J</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yekhanin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Makarychev</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Racz</surname>
            <given-names>MZ</given-names>
          </name>
          <name>
            <surname>Kamath</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gopalan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Random access in large-scale DNA data storage</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>3</issue>
        <fpage>242</fpage>
        <lpage>248</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4079</pub-id>
        <pub-id pub-id-type="pmid">29457795</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shannon</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>A mathematical theory of communication</article-title>
        <source>Bell Syst Tech J</source>
        <year>1948</year>
        <volume>27</volume>
        <issue>3</issue>
        <fpage>379</fpage>
        <lpage>423</lpage>
        <pub-id pub-id-type="doi">10.1002/j.1538-7305.1948.tb01338.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Yazdi SMHT, et al. DNA-based storage: trends and methods. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1507.01611">arXiv:1507.01611</ext-link> [cs, math].</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kosuri</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Large-scale de novo DNA synthesis: technologies and applications</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>5</issue>
        <fpage>499</fpage>
        <lpage>507</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2918</pub-id>
        <pub-id pub-id-type="pmid">24781323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Byrne-Steele</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Clemmons</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zahorchak</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>DNA polymerase preference determines PCR priming efficiency</article-title>
        <source>BMC Biotechnol</source>
        <year>2014</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1186/1472-6750-14-10</pub-id>
        <pub-id pub-id-type="pmid">24400649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Metzker</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Sequencing technologies—the next generation</article-title>
        <source>Nat Rev Genet</source>
        <year>2009</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>31</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2626</pub-id>
        <pub-id pub-id-type="pmid">19997069</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Hamoum B, Dupraz E, Conde-Canencia E, Lavenier D. Channel model with memory for DNA data storage with nanopore sequencing. In: 2021 11th International Symposium on Topics in Coding (ISTC). 2021. p. 1–5.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heckel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mikutis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grass</surname>
            <given-names>RN</given-names>
          </name>
        </person-group>
        <article-title>A characterization of the DNA data storage channel</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-45832-6</pub-id>
        <pub-id pub-id-type="pmid">30626917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y-J</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Organick</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ang</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Peck</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Seelig</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ceze</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Strauss</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Quantifying molecular bias in DNA data storage</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-13993-7</pub-id>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Welzel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kabdullayeva</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Freisleben</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Heider</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>MESA: automated assessment of synthetic DNA fragments and simulation of DNA synthesis, storage, sequencing and PCR errors</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>11</issue>
        <fpage>3322</fpage>
        <lpage>3326</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa140</pub-id>
        <pub-id pub-id-type="pmid">32129840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>An</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Nonenzymatic depurination of nucleic acids: factors and mechanisms</article-title>
        <source>PLoS ONE</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>12</issue>
        <fpage>e115950</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0115950</pub-id>
        <pub-id pub-id-type="pmid">25546310</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jagers</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Klebaner</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Random variation and concentration effects in PCR</article-title>
        <source>J Theor Biol</source>
        <year>2003</year>
        <volume>224</volume>
        <issue>3</issue>
        <fpage>299</fpage>
        <lpage>304</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-5193(03)00166-8</pub-id>
        <pub-id pub-id-type="pmid">12941588</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cline</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Braman</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Hogrefe</surname>
            <given-names>HH</given-names>
          </name>
        </person-group>
        <article-title>PCR fidelity of pfu DNA polymerase and other thermostable DNA polymerases</article-title>
        <source>Nucleic Acids Res</source>
        <year>1996</year>
        <volume>24</volume>
        <issue>18</issue>
        <fpage>3546</fpage>
        <lpage>3551</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/24.18.3546</pub-id>
        <pub-id pub-id-type="pmid">8836181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Si</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Identification of single nucleotides in sin nanopore</article-title>
        <source>Biophys J</source>
        <year>2017</year>
        <volume>112</volume>
        <issue>3</issue>
        <fpage>25a</fpage>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schirmer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>D’Amore</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ijaz</surname>
            <given-names>UZ</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Illumina error profiles: resolving fine-scale variation in metagenomic sequencing data</article-title>
        <source>BMC Bioinform</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-0976-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weirather</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>de Cesare</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Piazza</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sebastiano</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X-J</given-names>
          </name>
          <name>
            <surname>Buck</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Au</surname>
            <given-names>KF</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive comparison of pacific biosciences and oxford nanopore technologies and their applications to transcriptome analysis</article-title>
        <source>F1000Research</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>100</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.10571.2</pub-id>
        <pub-id pub-id-type="pmid">28868132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Darling</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>Asymptotic theory of certain “Goodness of Fit” criteria based on stochastic processes</article-title>
        <source>Ann Math Stat</source>
        <year>1952</year>
        <volume>23</volume>
        <issue>2</issue>
        <fpage>193</fpage>
        <lpage>212</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177729437</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
