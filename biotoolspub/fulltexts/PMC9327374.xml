<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9327374</article-id>
    <article-id pub-id-type="publisher-id">4835</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04835-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Multivariate estimation of factor structures of complex traits using SNP-based genomic relationships</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6416-6067</contrib-id>
        <name>
          <surname>De Vlaming</surname>
          <given-names>Ronald</given-names>
        </name>
        <address>
          <email>r.devlaming@vu.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Slob</surname>
          <given-names>Eric A. W.</given-names>
        </name>
        <address>
          <email>eric.slob@mrc-bsu.cam.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Groenen</surname>
          <given-names>Patrick J. F.</given-names>
        </name>
        <address>
          <email>groenen@ese.eur.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rietveld</surname>
          <given-names>Cornelius A.</given-names>
        </name>
        <address>
          <email>nrietveld@ese.eur.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.12380.38</institution-id><institution-id institution-id-type="ISNI">0000 0004 1754 9227</institution-id><institution>Department of Economics, School of Business and Economics, </institution><institution>Vrije Universiteit Amsterdam, </institution></institution-wrap>Amsterdam, The Netherlands </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.5335.0</institution-id><institution-id institution-id-type="ISNI">0000000121885934</institution-id><institution>Medical Research Council Biostatistics Unit, School of Clinical Medicine, </institution><institution>University of Cambridge, </institution></institution-wrap>Cambridge, UK </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.6906.9</institution-id><institution-id institution-id-type="ISNI">0000000092621349</institution-id><institution>Department of Applied Economics, Erasmus School of Economics, </institution><institution>Erasmus University Rotterdam, </institution></institution-wrap>Rotterdam, The Netherlands </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.6906.9</institution-id><institution-id institution-id-type="ISNI">0000000092621349</institution-id><institution>Erasmus University Rotterdam Institute for Behavior and Biology, </institution><institution>Erasmus School of Economics, </institution></institution-wrap>Rotterdam, The Netherlands </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.6906.9</institution-id><institution-id institution-id-type="ISNI">0000000092621349</institution-id><institution>Econometric Institute, Erasmus School of Economics, </institution><institution>Erasmus University Rotterdam, </institution></institution-wrap>Rotterdam, The Netherlands </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>305</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>7</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Heritability and genetic correlation can be estimated from genome-wide single-nucleotide polymorphism (SNP) data using various methods. We recently developed multivariate genomic-relatedness-based restricted maximum likelihood (MGREML) for statistically and computationally efficient estimation of SNP-based heritability (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2_{\text{SNP}}$$\end{document}</tex-math><mml:math id="M2"><mml:msubsup><mml:mi>h</mml:mi><mml:mtext>SNP</mml:mtext><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq1.gif"/></alternatives></inline-formula>) and genetic correlation (<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq2.gif"/></alternatives></inline-formula>) across many traits in large datasets. Here, we extend MGREML by allowing it to fit and perform tests on user-specified factor models, while preserving the low computational complexity.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Using simulations, we show that MGREML yields consistent estimates and valid inferences for such factor models at low computational cost (e.g., for data on 50 traits and 20,000 individuals, a saturated model involving 50 <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2_{\text{SNP}}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mi>h</mml:mi><mml:mtext>SNP</mml:mtext><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq3.gif"/></alternatives></inline-formula>’s, 1225 <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq4.gif"/></alternatives></inline-formula>’s, and 50 fixed effects is estimated and compared to a restricted model in less than one hour on a single notebook with two 2.7 GHz cores and 16 GB of RAM). Using repeated measures of height and body mass index from the US Health and Retirement Study, we illustrate the ability of MGREML to estimate a factor model and test whether it fits the data better than a nested model. The MGREML tool, the simulation code, and an extensive tutorial are freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/devlaming/mgreml/">https://github.com/devlaming/mgreml/</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">MGREML can now be used to estimate multivariate factor structures and perform inferences on such factor models at low computational cost. This new feature enables simple structural equation modeling using MGREML, allowing researchers to specify, estimate, and compare genetic factor models of their choosing using SNP data.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>SNP heritability</kwd>
      <kwd>Genetic correlation</kwd>
      <kwd>GREML</kwd>
      <kwd>Genetic factor model</kwd>
      <kwd>Genomic SEM</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>European Research Council</institution>
        </funding-source>
        <award-id>Starting Grant 946647 GEPSI</award-id>
        <principal-award-recipient>
          <name>
            <surname>Rietveld</surname>
            <given-names>Cornelius A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>NIHR Cambridge BRC</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000049</institution-id>
            <institution>National Institute on Aging</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Grant NIA U01AG009740</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par21">Narrow-sense heritability (<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2$$\end{document}</tex-math><mml:math id="M10"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq5.gif"/></alternatives></inline-formula>) quantifies the relative importance of additive genetic variance for a trait. Genetic correlation (<inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq6.gif"/></alternatives></inline-formula>) reflects the shared genetic architecture between two traits. Genomic-relatedness-based restricted maximum likelihood (GREML) estimation [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>] is widely used to estimate <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2$$\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq8.gif"/></alternatives></inline-formula> using genome-wide single-nucleotide polymorphism (SNP) data for unrelated individuals [<xref ref-type="bibr" rid="CR5">5</xref>]. As the heritability captured by SNPs provides a reasonable lower bound for <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2$$\end{document}</tex-math><mml:math id="M18"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq9.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], the former is often referred to as SNP-based heritability and denoted by <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2_{\text{SNP}}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mi>h</mml:mi><mml:mtext>SNP</mml:mtext><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq10.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par22">We recently developed MGREML, a computationally and statistically efficient approach for multivariate GREML [<xref ref-type="bibr" rid="CR9">9</xref>]. Importantly, MGREML resolves inconsistencies when combining bivariate estimates into a multivariate <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq11.gif"/></alternatives></inline-formula> matrix. By default, MGREML assumes the <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq12.gif"/></alternatives></inline-formula> matrix is shaped by a so-called saturated model [<xref ref-type="bibr" rid="CR10">10</xref>], which can fit any conceivable proper correlation matrix.</p>
    <p id="Par23">Here, we derive an extension of the statistical framework of MGREML (1) to estimate user-specified genetic and environmental factor models (e.g., a model with just one genetic factor for all traits) and (2) to test whether the given factor model fits the data better than a nested model (also user-specified).</p>
    <p id="Par24">Whereas Genomic SEM [<xref ref-type="bibr" rid="CR11">11</xref>], another method to estimate genetic factor models, relies on preexisting summary statistics from large-scale genome-wide association studies (GWAS) for all traits of interest, MGREML uses individual-level data, giving users (1) more statistical power for a fixed sample size [<xref ref-type="bibr" rid="CR9">9</xref>] and (2) more direct control over model specification and estimation (e.g., being able to control for an additional covariate in the MGREML analysis itself, rather than having to obtain a new set of GWAS results).</p>
    <p id="Par25">In short, we enable MGREML to estimate genetic and environmental factor structures using individual-level data, and to test whether a given factor structure fits the data better than a nested model. We validate this approach using simulations and an empirical application.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Model</title>
      <p id="Par26">Consider a set of <italic>N</italic> unrelated individuals for whom we observe <italic>T</italic> traits, <italic>k</italic> covariates, and <italic>M</italic> SNPs. Let <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}$$\end{document}</tex-math><mml:math id="M26"><mml:mi mathvariant="bold">X</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq13.gif"/></alternatives></inline-formula> denote the <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \times k$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq14.gif"/></alternatives></inline-formula> matrix of covariates, <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{G}}$$\end{document}</tex-math><mml:math id="M30"><mml:mi mathvariant="bold">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq15.gif"/></alternatives></inline-formula> the <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \times M$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq16.gif"/></alternatives></inline-formula> matrix of standardized SNPs, and <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Y}}$$\end{document}</tex-math><mml:math id="M34"><mml:mi mathvariant="bold">Y</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq17.gif"/></alternatives></inline-formula> the <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \times T$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq18.gif"/></alternatives></inline-formula> matrix of traits, for which column <italic>t</italic> corresponds to Trait <italic>t</italic> and is denoted by <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{y}}_t$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi mathvariant="bold">y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq19.gif"/></alternatives></inline-formula>. Furthermore, let <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{S}}_t$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq20.gif"/></alternatives></inline-formula> denote a binary <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_t \times k$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq21.gif"/></alternatives></inline-formula> matrix indicating which of the <italic>k</italic> covariates in <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}$$\end{document}</tex-math><mml:math id="M44"><mml:mi mathvariant="bold">X</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq22.gif"/></alternatives></inline-formula> apply to Trait <italic>t</italic>. Now, the matrix of covariates for Trait <italic>t</italic> can be defined as <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_t = {\textbf{X}} {{\textbf{S}}}^{\top }_t$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq23.gif"/></alternatives></inline-formula>.</p>
      <p id="Par27">When applying univariate GREML as implemented in GCTA [<xref ref-type="bibr" rid="CR1">1</xref>] to Trait <italic>t</italic>, the following linear mixed model (LMM) is estimated using restricted maximum likelihood (REML) [<xref ref-type="bibr" rid="CR12">12</xref>]:<disp-formula id="Equ1"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{y}}_t \sim {\mathcal {N}} \left( {\textbf{X}}_t \varvec{\beta }_t, {\textbf{A}} \sigma _{G_{tt}} + {\textbf{I}} \sigma _{E_{tt}} \right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M48" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">tt</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">tt</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4835_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>In this model, <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }_t$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq24.gif"/></alternatives></inline-formula> is the <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_t \times 1$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq25.gif"/></alternatives></inline-formula> vector of fixed effects of the covariates that apply to Trait <italic>t</italic> and the <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \times N$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq26.gif"/></alternatives></inline-formula> matrix <inline-formula id="IEq27"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{A}}$$\end{document}</tex-math><mml:math id="M56"><mml:mi mathvariant="bold">A</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq27.gif"/></alternatives></inline-formula> is the so-called genomic-relatedness matrix (GRM) reflecting the subtle genetic similarities between unrelated individuals.</p>
      <p id="Par28">Typically, the GRM is calculated as <inline-formula id="IEq28"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{A}} = M^{-1} {\textbf{G}}{{\textbf{G}}}^{\top }$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">G</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq28.gif"/></alternatives></inline-formula> using tools such as GCTA or PLINK [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. Calculation of the GRM requires <inline-formula id="IEq29"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N^2M)$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq29.gif"/></alternatives></inline-formula> time. However, as this calculation can be massively parallelized, it places little practical limitation on either <italic>N</italic> or <italic>M</italic>.</p>
      <p id="Par29">By giving standardized SNPs the same weight, the preceding definition of the GRM makes tacit assumptions about the relationship between allele frequency and linkage disequilibrium on the one hand and SNP effect sizes on the other. Other tools, such as LDAK [<xref ref-type="bibr" rid="CR14">14</xref>], can be used to construct a GRM that assigns different weights to the SNPs, thereby incorporating different assumptions about SNP effect sizes. Importantly, MGREML can use any valid GRM in binary format as input, irrespective of its precise definition and irrespective of whether it is calculated using PLINK, GCTA, or LDAK.</p>
      <p id="Par30">The parameters of interest in the univariate model are <inline-formula id="IEq30"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{G_{tt}}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">tt</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq30.gif"/></alternatives></inline-formula> and <inline-formula id="IEq31"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{E_{tt}}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">tt</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq31.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq32"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{G_{tt}}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">tt</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq32.gif"/></alternatives></inline-formula> denotes the additive genetic variance of Trait <italic>t</italic> captured by the available SNPs and <inline-formula id="IEq33"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{E_{tt}}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">tt</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq33.gif"/></alternatives></inline-formula> the remaining variance in Trait <italic>t</italic>. The latter quantity is sometimes referred to as the environmental variance, even though this name can be somewhat misguiding, since <inline-formula id="IEq34"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{E_{tt}}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">tt</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq34.gif"/></alternatives></inline-formula> simply reflects all variance in Trait <italic>t</italic> that is not tagged by the additive linear effects of the available SNPs and covariates [<xref ref-type="bibr" rid="CR6">6</xref>]. In spite of the subtleties in its definition, we stick to the convention of calling this term the environmental variance.</p>
      <p id="Par31">In this model, <inline-formula id="IEq35"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2_{\text{SNP}}$$\end{document}</tex-math><mml:math id="M72"><mml:msubsup><mml:mi>h</mml:mi><mml:mtext>SNP</mml:mtext><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq35.gif"/></alternatives></inline-formula> of Trait <italic>t</italic> can be defined as <inline-formula id="IEq36"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2_{\text{SNP}}(t) = \sigma _{G_{tt}} \left( \sigma _{G_{tt}} + \sigma _{E_{tt}} \right) ^{-1}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mtext>SNP</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">tt</mml:mi></mml:mrow></mml:msub></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">tt</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">tt</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq36.gif"/></alternatives></inline-formula>. In essence, univariate GREML quantifies the degree to which genetic similarity between individuals, as tagged by the SNPs used to construct the GRM, maps to trait similarity.</p>
      <p id="Par32">Notice here that REML does not estimate <inline-formula id="IEq37"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }_t$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq37.gif"/></alternatives></inline-formula> directly. Instead, REML controls for the fixed-effect covariates by considering so-called error contrasts [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. More specifically, REML estimation is equivalent to maximum-likelihood estimation applied to <inline-formula id="IEq38"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{K}}_t{\textbf{y}}_t$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:msub><mml:mi mathvariant="bold">K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq38.gif"/></alternatives></inline-formula>, where the rows of matrix <inline-formula id="IEq39"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{K}}_t$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi mathvariant="bold">K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq39.gif"/></alternatives></inline-formula> form a basis of the left null space of <inline-formula id="IEq40"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}}_t$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq40.gif"/></alternatives></inline-formula>. However, once REML estimates of <inline-formula id="IEq41"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{G_{tt}}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">tt</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq41.gif"/></alternatives></inline-formula> and <inline-formula id="IEq42"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{E_{tt}}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">tt</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq42.gif"/></alternatives></inline-formula> are obtained, one can readily calculate the generalized least squares estimator of the fixed effects <inline-formula id="IEq43"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }_t$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq43.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. This option is implemented in both GCTA and MGREML.</p>
      <p id="Par33">The univariate LMM can be generalized to a multivariate LMM [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>], which can be used to jointly estimate genetic covariance and environmental covariance between Traits <inline-formula id="IEq44"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=1,\ldots ,T$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq44.gif"/></alternatives></inline-formula> and <inline-formula id="IEq45"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s=1,\ldots ,T$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq45.gif"/></alternatives></inline-formula>, denoted by <inline-formula id="IEq46"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{G_{ts}}$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">ts</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq46.gif"/></alternatives></inline-formula> and <inline-formula id="IEq47"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{E_{ts}}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">ts</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq47.gif"/></alternatives></inline-formula> respectively. Using the same notation as seen in the original derivations of MGREML [<xref ref-type="bibr" rid="CR9">9</xref>], this multivariate LMM can be written as follows:<disp-formula id="Equ2"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left( \begin{array}{c} {\textbf{y}}_1 \\ \vdots \\ {\textbf{y}}_T \end{array} \right) \sim {\mathcal {N}} \left( \left( \begin{array}{ccc} {\textbf{X}}_1 &amp;{} &amp;{} {\textbf{0}} \\ &amp;{} \ddots &amp;{} \\ {\textbf{0}} &amp;{} &amp;{} {\textbf{X}}_T \end{array} \right) \left( \begin{array}{c} \varvec{\beta }_1 \\ \vdots \\ \varvec{\beta }_T \end{array} \right) , {\textbf{V}}_G \otimes {\textbf{A}} + {\textbf{V}}_E \otimes {\textbf{I}}_{N} \right) , \end{aligned}$$\end{document}</tex-math><mml:math id="M98" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">y</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋱</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋮</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4835_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where ‘<inline-formula id="IEq48"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\otimes$$\end{document}</tex-math><mml:math id="M100"><mml:mo>⊗</mml:mo></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq48.gif"/></alternatives></inline-formula>’ denotes the Kronecker product. In this model, <inline-formula id="IEq49"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_G$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq49.gif"/></alternatives></inline-formula> is the <inline-formula id="IEq50"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T \times T$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi>T</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq50.gif"/></alternatives></inline-formula> genetic variance matrix and <inline-formula id="IEq51"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_E$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq51.gif"/></alternatives></inline-formula> the <inline-formula id="IEq52"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T \times T$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi>T</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq52.gif"/></alternatives></inline-formula> environmental variance matrix. Now, the genetic correlation between Traits <italic>t</italic> and <italic>s</italic> is defined as <inline-formula id="IEq53"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _{G} (t,s) = \sigma _{G_{ts}} \left( \sigma _{G_{tt}} \sigma _{G_{ss}} \right) ^{-0.5}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">ts</mml:mi></mml:mrow></mml:msub></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">tt</mml:mi></mml:mrow></mml:msub></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">ss</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq53.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR2">2</xref>], where <inline-formula id="IEq54"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _{G_{ts}}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">ts</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq54.gif"/></alternatives></inline-formula> is element <italic>t</italic>, <italic>s</italic> from <inline-formula id="IEq55"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_G$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq55.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec4">
      <title>Computational complexity</title>
      <p id="Par34">The variance matrix of the multivariate model (i.e., <inline-formula id="IEq56"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_G \otimes {\textbf{A}} + {\textbf{V}}_E \otimes {\textbf{I}}_{N}$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq56.gif"/></alternatives></inline-formula>) is dense, rendering naïve REML estimation infeasible for large <italic>N</italic> and <italic>T</italic>, as mere evaluation of the log-likelihood function already requires <inline-formula id="IEq57"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N^3T^3)$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq57.gif"/></alternatives></inline-formula> time. However, the time complexity can be drastically reduced by transforming the data using the eigenvalue decomposition (EVD) of the GRM [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR9">9</xref>].</p>
      <p id="Par35">Let <inline-formula id="IEq58"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Q}} \varvec{\Phi }{{\textbf{Q}}}^{\top }$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq58.gif"/></alternatives></inline-formula> denote the EVD of <inline-formula id="IEq59"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{A}}$$\end{document}</tex-math><mml:math id="M122"><mml:mi mathvariant="bold">A</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq59.gif"/></alternatives></inline-formula>. Here, <inline-formula id="IEq60"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Q}}$$\end{document}</tex-math><mml:math id="M124"><mml:mi mathvariant="bold">Q</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq60.gif"/></alternatives></inline-formula> denotes the matrix of eigenvectors and <inline-formula id="IEq61"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\Phi }$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq61.gif"/></alternatives></inline-formula> the diagonal matrix of eigenvalues. MGREML defines matrix <inline-formula id="IEq62"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{P}}$$\end{document}</tex-math><mml:math id="M128"><mml:mi mathvariant="bold">P</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq62.gif"/></alternatives></inline-formula> as the <inline-formula id="IEq63"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n = N-L$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq63.gif"/></alternatives></inline-formula> columns from <inline-formula id="IEq64"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Q}}$$\end{document}</tex-math><mml:math id="M132"><mml:mi mathvariant="bold">Q</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq64.gif"/></alternatives></inline-formula> that correspond to the eigenvalues that are not among the <italic>L</italic> largest, and <inline-formula id="IEq65"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{D}}$$\end{document}</tex-math><mml:math id="M134"><mml:mi mathvariant="bold">D</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq65.gif"/></alternatives></inline-formula> as the diagonal matrix with corresponding eigenvalues, <inline-formula id="IEq66"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_1, \ldots , d_n$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq66.gif"/></alternatives></inline-formula>.</p>
      <p id="Par36">Using this matrix <inline-formula id="IEq67"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{P}}$$\end{document}</tex-math><mml:math id="M138"><mml:mi mathvariant="bold">P</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq67.gif"/></alternatives></inline-formula>, MGREML transforms the data, and then reorders it such that (<italic>i</italic>) the variance matrix is block diagonal, enabling significant computational improvements, and (<italic>ii</italic>) the contribution of the <italic>L</italic> leading principal components from the genetic data to the variance matrix are eliminated, thus, correcting for population stratification [<xref ref-type="bibr" rid="CR19">19</xref>] without introducing any additional fixed-effect covariates [<xref ref-type="bibr" rid="CR9">9</xref>]. By default <inline-formula id="IEq68"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L=20$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq68.gif"/></alternatives></inline-formula>, causing MGREML to control for even quite subtle population stratification. Users can specify a different value for <italic>L</italic> using the ––adjust-pcs option.</p>
      <p id="Par37">More specifically, the following model holds for <inline-formula id="IEq69"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Tn \times 1$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mi>T</mml:mi><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq69.gif"/></alternatives></inline-formula> vector <inline-formula id="IEq70"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{y}} = \textrm{vec} ( {{\textbf{Y}}}^{\top } {\textbf{P}})$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>=</mml:mo><mml:mtext>vec</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:mi mathvariant="bold">P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq70.gif"/></alternatives></inline-formula> (where vec() denotes the vectorization operator):<disp-formula id="Equ3"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{y}} \sim {\mathcal {N}} \left( {\textbf{Z}} \varvec{\beta }, {\textbf{V}} \right) \textrm{ with \, } {\textbf{V}} = {\textbf{D}} \otimes {\textbf{V}}_G + {\textbf{I}}_{n} \otimes {\textbf{V}}_E, \end{aligned}$$\end{document}</tex-math><mml:math id="M146" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">Z</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="bold">V</mml:mi></mml:mfenced><mml:mspace width="0.333333em"/><mml:mtext>with</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.166667em"/><mml:mspace width="0.333333em"/><mml:mi mathvariant="bold">V</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo>⊗</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4835_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq71"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}} = ({{\textbf{Z}}}^{\top }_1 \; \cdots \; {{\textbf{Z}}}^{\top }_{n})^{\top }$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>⊤</mml:mi></mml:msubsup><mml:mspace width="0.277778em"/><mml:mo>⋯</mml:mo><mml:mspace width="0.277778em"/><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>⊤</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq71.gif"/></alternatives></inline-formula>, <inline-formula id="IEq72"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Z}}_j = \left( {\textbf{I}}_T \otimes {{\textbf{x}}}^{\top }_j \right) {{\textbf{S}}}^{\top }$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq72.gif"/></alternatives></inline-formula>, <inline-formula id="IEq73"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\textbf{x}}}^{\top }_j$$\end{document}</tex-math><mml:math id="M152"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq73.gif"/></alternatives></inline-formula> is <inline-formula id="IEq74"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \times k$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq74.gif"/></alternatives></inline-formula> row <italic>j</italic> from <inline-formula id="IEq75"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\textbf{P}}}^{\top } {\textbf{X}}$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq75.gif"/></alternatives></inline-formula>, and<disp-formula id="Equ4"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{S}} = \left( \begin{array}{ccc} {\textbf{S}}_1 &amp;{} &amp;{} {\textbf{0}} \\ &amp;{} \ddots &amp;{} \\ {\textbf{0}} &amp;{} &amp;{} {\textbf{S}}_T \end{array} \right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M158" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋱</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4835_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>Omitting the constant, the corresponding log-likelihood function is given by<disp-formula id="Equ5"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \ell \left( {\textbf{y}}, \varvec{\theta }\right) = -\frac{1}{2}\left( \textrm{log} \left| {\textbf{V}} \right| + \textrm{log} \left| {\textbf{Z}}^{\top } {\textbf{V}}^{-1} {\textbf{Z}} \right| + {{\textbf{y}}}^{\top } {\textbf{M}} {\textbf{y}} \right) , \end{aligned}$$\end{document}</tex-math><mml:math id="M160" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mtext>log</mml:mtext><mml:mfenced close="|" open="|"><mml:mi mathvariant="bold">V</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mtext>log</mml:mtext><mml:mfenced close="|" open="|"><mml:msup><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">Z</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:mi mathvariant="bold">M</mml:mi><mml:mi mathvariant="bold">y</mml:mi></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4835_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq76"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{M}} = {\textbf{V}}^{-1} - {\textbf{V}}^{-1} {\textbf{Z}} \left( {\textbf{Z}}^{\top } {\textbf{V}}^{-1} {\textbf{Z}} \right) ^{-1} {\textbf{Z}}^{\top } {\textbf{V}}^{-1}$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">Z</mml:mi><mml:msup><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">Z</mml:mi></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq76.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR1">1</xref>]. This log-likelihood function depends on <inline-formula id="IEq77"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{log} \left| {\textbf{V}} \right|$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mtext>log</mml:mtext><mml:mfenced close="|" open="|"><mml:mi mathvariant="bold">V</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq77.gif"/></alternatives></inline-formula> and quadratic forms of the type <inline-formula id="IEq78"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q = {{\textbf{w}}}^{\top } {\textbf{V}}^{-1} {\textbf{w}}$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">w</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq78.gif"/></alternatives></inline-formula>. Importantly, <inline-formula id="IEq79"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}$$\end{document}</tex-math><mml:math id="M168"><mml:mi mathvariant="bold">V</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq79.gif"/></alternatives></inline-formula> is a highly sparse, block-diagonal matrix, where diagonal block <italic>j</italic> equals <inline-formula id="IEq80"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_j = d_j {\textbf{V}}_G + {\textbf{V}}_E$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq80.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq81"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_G$$\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq81.gif"/></alternatives></inline-formula> and <inline-formula id="IEq82"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_E$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq82.gif"/></alternatives></inline-formula> being functions of the parameter vector <inline-formula id="IEq83"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\theta }$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq83.gif"/></alternatives></inline-formula>.</p>
      <p id="Par38">As a result of this block-diagonal structure, these quadratic forms and log-determinants can be written as a sum of <italic>n</italic> independent contributions, where each contribution comes from a <inline-formula id="IEq84"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T \times T$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mi>T</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq84.gif"/></alternatives></inline-formula> block. MGREML can calculate the contribution of any given block in <inline-formula id="IEq85"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(T^2)$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq85.gif"/></alternatives></inline-formula> time. Concordantly, the log-likelihood function can be evaluated in <inline-formula id="IEq86"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(NT^2)$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq86.gif"/></alternatives></inline-formula> time. Similarly, the gradient (i.e., the vector of partial derivatives of the log-likelihood function with respect to <inline-formula id="IEq87"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\theta }$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq87.gif"/></alternatives></inline-formula>) can also be calculated in <inline-formula id="IEq88"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(NT^2)$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq88.gif"/></alternatives></inline-formula> time.</p>
      <p id="Par39">MGREML retains its computational efficiency in case there are a limited number of fixed effects covariates. However, if the number of covariates grows large, MGREML will get slower. Nevertheless, as MGREML controls for population stratification without having to introduce any fixed effects for that purpose, a limited number of fixed-effect covariates suffices in a typical empirical application.</p>
      <p id="Par40">The average information (AI) algorithm, a variation on Newton’s method [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], is ill-suited for MGREML estimation for large <italic>T</italic>, since that algorithm involves repeated calculation of the AI matrix, which requires <inline-formula id="IEq89"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(NT^4)$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq89.gif"/></alternatives></inline-formula> time per iteration for a saturated model [<xref ref-type="bibr" rid="CR9">9</xref>]. Specifically, a saturated model has <inline-formula id="IEq90"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T(T-1)$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq90.gif"/></alternatives></inline-formula> free parameters. Thus, the AI matrix has <inline-formula id="IEq91"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T(T-1) \times T(T-1)$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq91.gif"/></alternatives></inline-formula> elements, where each element involves a calculation requiring <italic>O</italic>(<italic>N</italic>) time, placing overall complexity at <inline-formula id="IEq92"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(NT^4)$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq92.gif"/></alternatives></inline-formula>.</p>
      <p id="Par41">To avoid having to calculate the AI matrix in every iteration, MGREML instead uses a Broyden–Fletcher–Goldfarb–Shanno (BFGS) algorithm [<xref ref-type="bibr" rid="CR21">21</xref>] in combination with a golden-section line search to estimate <inline-formula id="IEq93"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\theta }$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq93.gif"/></alternatives></inline-formula>. Importantly, a BFGS iteration has roughly the same computational complexity as a gradient-descent iteration yet a higher rate of convergence across iterations. Thus, a BFGS algorithm balances computational complexity per iteration and rate of convergence across iterations.</p>
      <p id="Par42">The BFGS algorithm is initialized such that the first iteration is equivalent to a gradient-descent iteration with golden-section search. Evaluations of the log-likelihood function and its gradient suffice for application of the golden-section search and BFGS algorithm, putting the overall time complexity of MGREML at <inline-formula id="IEq94"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(NT^2)$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq94.gif"/></alternatives></inline-formula> per iteration.</p>
      <p id="Par43">For large <italic>T</italic>, the BFGS algorithm can exhibit unstable behavior, in which case relevant quantities are reinitialized such that first next BFGS iteration is again equivalent to a gradient-descent iteration with golden-section search. If instability persists, MGREML switches to the AI algorithm for a single iteration. In our experience, such expensive ‘interventions’ are needed only sparingly and are effective in resolving numerical instabilities in MGREML estimation.</p>
      <p id="Par44">Once MGREML has converged, the variance matrix of <inline-formula id="IEq95"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\varvec{\theta }}}$$\end{document}</tex-math><mml:math id="M200"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq95.gif"/></alternatives></inline-formula> is estimated using the AI matrix [<xref ref-type="bibr" rid="CR20">20</xref>]. In addition, a delta method is used to obtain the standard error (SE) of <inline-formula id="IEq96"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2_{\text{SNP}}$$\end{document}</tex-math><mml:math id="M202"><mml:msubsup><mml:mi>h</mml:mi><mml:mtext>SNP</mml:mtext><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq96.gif"/></alternatives></inline-formula> and <inline-formula id="IEq97"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq97.gif"/></alternatives></inline-formula> estimates. Although calculation of the AI matrix, as indicated, is expensive, this calculation only needs to be carried out once. Moreover, MGREML users can specify the ––no-se option to forgo calculation of the AI matrix and SEs altogether after convergence of the BFGS algorithm.</p>
    </sec>
    <sec id="Sec5">
      <title>Factor structures</title>
      <p id="Par45">By default, MGREML assumes a saturated model for both <inline-formula id="IEq98"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_G$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq98.gif"/></alternatives></inline-formula> and <inline-formula id="IEq99"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_E$$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq99.gif"/></alternatives></inline-formula>. An example of such a saturated model for <inline-formula id="IEq100"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T=3$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq100.gif"/></alternatives></inline-formula> traits is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Letting <inline-formula id="IEq101"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _{tf}$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">tf</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq101.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq102"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{tf}$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi mathvariant="italic">tf</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq102.gif"/></alternatives></inline-formula>) denote the effect of genetic (environmental) Factor <italic>f</italic> on Trait <italic>t</italic>, the saturated model for <inline-formula id="IEq103"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T=3$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq103.gif"/></alternatives></inline-formula> traits can be written as follows:<disp-formula id="Equ6"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{V}}_G&amp;= {\textbf{C}}_G {{\textbf{C}}}^{\top }_G \text{ and } {\textbf{V}}_E = {\textbf{C}}_E {{\textbf{C}}}^{\top }_E, \text{ where } \\ {\textbf{C}}_G&amp;= \left( \begin{array}{ccc} \gamma _{11} &amp;{} 0 &amp;{} 0 \\ \gamma _{21} &amp;{} \gamma _{22} &amp;{} 0 \\ \gamma _{31} &amp;{} \gamma _{32} &amp;{} \gamma _{33} \end{array} \right) \text{ and } {\textbf{C}}_E = \left( \begin{array}{ccc} \varepsilon _{11} &amp;{} 0 &amp;{} 0 \\ \varepsilon _{21} &amp;{} \varepsilon _{22} &amp;{} 0 \\ \varepsilon _{31} &amp;{} \varepsilon _{32} &amp;{} \varepsilon _{33} \end{array} \right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M218" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi>G</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:mspace width="0.333333em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi>E</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>where</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>γ</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>γ</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>γ</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>γ</mml:mi><mml:mn>31</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>γ</mml:mi><mml:mn>32</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>γ</mml:mi><mml:mn>33</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mspace width="0.333333em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.333333em"/><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>ε</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>ε</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>ε</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>ε</mml:mi><mml:mn>31</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>ε</mml:mi><mml:mn>32</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>ε</mml:mi><mml:mn>33</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4835_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>For <italic>T</italic> traits in general, a saturated model for <inline-formula id="IEq104"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_G$$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq104.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq105"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_E$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq105.gif"/></alternatives></inline-formula>) can be described in terms of a lower triangular matrix of free genetic (environmental) coefficients <inline-formula id="IEq106"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{C}}_G$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq106.gif"/></alternatives></inline-formula> (<inline-formula id="IEq107"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{C}}_E$$\end{document}</tex-math><mml:math id="M226"><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq107.gif"/></alternatives></inline-formula>) where <inline-formula id="IEq108"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_G = {\textbf{C}}_G {{\textbf{C}}}^{\top }_G$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi>G</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq108.gif"/></alternatives></inline-formula> (<inline-formula id="IEq109"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_E = {\textbf{C}}_E {{\textbf{C}}}^{\top }_E$$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi>E</mml:mi><mml:mi>⊤</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq109.gif"/></alternatives></inline-formula>).<fig id="Fig1"><label>Fig. 1</label><caption><p>A saturated genetic and environmental factor model for three traits</p></caption><graphic xlink:href="12859_2022_4835_Fig1_HTML" id="MO7"/></fig></p>
      <p id="Par46">Here, we generalize this approach by allowing <inline-formula id="IEq110"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{C}}_G$$\end{document}</tex-math><mml:math id="M232"><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq110.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq111"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{C}}_E$$\end{document}</tex-math><mml:math id="M234"><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq111.gif"/></alternatives></inline-formula>) to be a <inline-formula id="IEq112"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T \times F_G$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:mi>T</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq112.gif"/></alternatives></inline-formula> (<inline-formula id="IEq113"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T\times F_E$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mi>T</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq113.gif"/></alternatives></inline-formula>) matrix of which a pre-defined subset of the <inline-formula id="IEq114"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$TF_G$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq114.gif"/></alternatives></inline-formula> (<inline-formula id="IEq115"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$TF_E$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq115.gif"/></alternatives></inline-formula>) elements are free, while the other elements are constrained to zero, reflecting an arbitrary factor model with <inline-formula id="IEq116"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_G$$\end{document}</tex-math><mml:math id="M244"><mml:msub><mml:mi>F</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq116.gif"/></alternatives></inline-formula> (<inline-formula id="IEq117"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_E$$\end{document}</tex-math><mml:math id="M246"><mml:msub><mml:mi>F</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq117.gif"/></alternatives></inline-formula>) genetic (environmental) factors. Both factor models need to satisfy standard identification requirements in structural equation modeling [<xref ref-type="bibr" rid="CR22">22</xref>]. Under this framework, the implied genetic (resp. environmental) variance matrix <inline-formula id="IEq118"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_G$$\end{document}</tex-math><mml:math id="M248"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq118.gif"/></alternatives></inline-formula> (<inline-formula id="IEq119"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_E$$\end{document}</tex-math><mml:math id="M250"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq119.gif"/></alternatives></inline-formula>) is always at least positive (semi)-definite. In other words, provided the user-specified model is identified, MGREML always yields valid correlation matrices.</p>
      <p id="Par47">MGREML users can specify a main model, comprising a genetic factor model and an environmental factor model. In case a user also specifies a nested model, MGREML performs a classical likelihood-ratio test (LRT) [<xref ref-type="bibr" rid="CR23">23</xref>], to infer whether the fit of the main factor model is significantly better than that of the nested model.</p>
      <p id="Par48">In total, users can specify at most four factor models: (<italic>1A</italic>) the main genetic factor model, (<italic>1B</italic>) the main environmental factor model, (<italic>2A</italic>) the nested genetic factor model, and (<italic>2B</italic>) the nested environmental factor model. For example, a user can specify a main genetic factor model where there is only one genetic factor for all traits and a nested genetic factor model, where the traits have no genetic variance at all (i.e., there is no genetic factor), while the environmental factor model is saturated both in the main model as well as the nested model.</p>
      <p id="Par49">A factor model specification for MGREML is effectively a binary <inline-formula id="IEq120"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T \times F$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:mi>T</mml:mi><mml:mo>×</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq120.gif"/></alternatives></inline-formula> matrix stored as a plain text file, where <italic>F</italic> denotes the number of factors. More specifically, in a given model, for <inline-formula id="IEq121"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f=1,\ldots ,F$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq121.gif"/></alternatives></inline-formula> and <inline-formula id="IEq122"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=1,\ldots ,T$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq122.gif"/></alternatives></inline-formula>, if Factor <italic>f</italic> has a free path coefficient to Trait <italic>t</italic>, element <italic>t</italic>, <italic>f</italic> of the binary matrix equals one and otherwise that element equals zero.</p>
      <p id="Par50">Let <inline-formula id="IEq123"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{G_A}$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq123.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq124"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{E_A}$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq124.gif"/></alternatives></inline-formula>) denote the number of free coefficients in the main genetic (environmental) factor model and let <inline-formula id="IEq125"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{G_0}$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq125.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq126"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{E_0}$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq126.gif"/></alternatives></inline-formula>) be defined analogously for the nested model. Finally, let <inline-formula id="IEq127"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{A}$$\end{document}</tex-math><mml:math id="M266"><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq127.gif"/></alternatives></inline-formula> (resp. <inline-formula id="IEq128"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell _{0}$$\end{document}</tex-math><mml:math id="M268"><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq128.gif"/></alternatives></inline-formula>) denote the log-likelihood of the main (nested) model. Now, the LRT statistic is calculated by MGREML as <inline-formula id="IEq129"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{LRT} = 2(\ell _{A}-\ell _{0})$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:mtext>LRT</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq129.gif"/></alternatives></inline-formula>, which under standard maximum likelihood estimation (MLE) assumptions [<xref ref-type="bibr" rid="CR24">24</xref>] and nestedness of the models is <inline-formula id="IEq130"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\chi ^2\left( (C_{G_A} + C_{E_A}) - (C_{G_0} + C_{E_0}) \right)$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq130.gif"/></alternatives></inline-formula> distributed.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Specification of a genetic factor model for height and body mass index (BMI) observed at five different points in time (denoted by subscripts indicating waves 7, 8, ..., 11)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Trait</th><th align="left"><italic>G</italic><inline-formula id="IEq131"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{height }$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mrow/><mml:mrow><mml:mi mathvariant="italic">height</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq131.gif"/></alternatives></inline-formula></th><th align="left"><italic>G</italic><inline-formula id="IEq132"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{BMI }$$\end{document}</tex-math><mml:math id="M276"><mml:msub><mml:mrow/><mml:mrow><mml:mi mathvariant="italic">BMI</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq132.gif"/></alternatives></inline-formula></th><th align="left"><italic>G</italic><inline-formula id="IEq133"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{shared }$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mrow/><mml:mrow><mml:mi mathvariant="italic">shared</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq133.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left"><italic>height</italic><inline-formula id="IEq134"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{7}$$\end{document}</tex-math><mml:math id="M280"><mml:msub><mml:mrow/><mml:mn>7</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq134.gif"/></alternatives></inline-formula></td><td align="left">1</td><td align="left">0</td><td align="left">1</td></tr><tr><td align="left"><italic>height</italic><inline-formula id="IEq135"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{8}$$\end{document}</tex-math><mml:math id="M282"><mml:msub><mml:mrow/><mml:mn>8</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq135.gif"/></alternatives></inline-formula></td><td align="left">1</td><td align="left">0</td><td align="left">1</td></tr><tr><td align="left"><italic>height</italic><inline-formula id="IEq136"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{9}$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mrow/><mml:mn>9</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq136.gif"/></alternatives></inline-formula></td><td align="left">1</td><td align="left">0</td><td align="left">1</td></tr><tr><td align="left"><italic>height</italic><inline-formula id="IEq137"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{10}$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mrow/><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq137.gif"/></alternatives></inline-formula></td><td align="left">1</td><td align="left">0</td><td align="left">1</td></tr><tr><td align="left"><italic>height</italic><inline-formula id="IEq138"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{11}$$\end{document}</tex-math><mml:math id="M288"><mml:msub><mml:mrow/><mml:mn>11</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq138.gif"/></alternatives></inline-formula></td><td align="left">1</td><td align="left">0</td><td align="left">1</td></tr><tr><td align="left"><italic>BMI</italic><inline-formula id="IEq139"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{7}$$\end{document}</tex-math><mml:math id="M290"><mml:msub><mml:mrow/><mml:mn>7</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq139.gif"/></alternatives></inline-formula></td><td align="left">0</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left"><italic>BMI</italic><inline-formula id="IEq140"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{8}$$\end{document}</tex-math><mml:math id="M292"><mml:msub><mml:mrow/><mml:mn>8</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq140.gif"/></alternatives></inline-formula></td><td align="left">0</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left"><italic>BMI</italic><inline-formula id="IEq141"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{9}$$\end{document}</tex-math><mml:math id="M294"><mml:msub><mml:mrow/><mml:mn>9</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq141.gif"/></alternatives></inline-formula></td><td align="left">0</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left"><italic>BMI</italic><inline-formula id="IEq142"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{10}$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mrow/><mml:mn>10</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq142.gif"/></alternatives></inline-formula></td><td align="left">0</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left"><italic>BMI</italic><inline-formula id="IEq143"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{11}$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mrow/><mml:mn>11</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq143.gif"/></alternatives></inline-formula></td><td align="left">0</td><td align="left">1</td><td align="left">1</td></tr></tbody></table></table-wrap></p>
      <p id="Par51">An example of a genetic factor model that MGREML users can specify is shown in Table <xref rid="Tab1" ref-type="table">1</xref>. The corresponding structural equation model for <inline-formula id="IEq144"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_G$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq144.gif"/></alternatives></inline-formula> which MGREML fits under that specification is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The environmental factors shaping <inline-formula id="IEq145"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{V}}_E$$\end{document}</tex-math><mml:math id="M302"><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq145.gif"/></alternatives></inline-formula> are not shown here, for clarity of the figure. We use this genetic factor model in our empirical application. In this example, the first genetic factor captures the genetic signal shared between all height measurements, the second genetic factor captures the genetic signal shared between all measurements of body mass index (BMI), and the third factor captures the genetic overlap between height and BMI (i.e., the genetic correlation).<fig id="Fig2"><label>Fig. 2</label><caption><p>A genetic factor model for height and body mass index (BMI) observed at five different points in time (denoted by subscripts indicating waves 7, 8, ..., 11)</p></caption><graphic xlink:href="12859_2022_4835_Fig2_HTML" id="MO8"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results</title>
    <sec id="Sec7">
      <title>Simulation study</title>
      <p id="Par52">To test the validity of MGREML estimates of genetic correlations and underlying factor structures, we generated 100 independent datasets with <inline-formula id="IEq146"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=20,000$$\end{document}</tex-math><mml:math id="M304"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq146.gif"/></alternatives></inline-formula> individuals and <inline-formula id="IEq147"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T=10$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq147.gif"/></alternatives></inline-formula> traits with SNP-based <inline-formula id="IEq148"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2 = 50\%$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq148.gif"/></alternatives></inline-formula>. In Simulation 1, we set <inline-formula id="IEq149"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M310"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq149.gif"/></alternatives></inline-formula> to the same value across all combinations of traits. In Simulation 2, we simulate two clusters of five traits by setting <inline-formula id="IEq150"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M312"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq150.gif"/></alternatives></inline-formula> to random values within clusters and to zero between clusters. In Simulation 3, we consider one additional dataset with <inline-formula id="IEq151"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=20,000$$\end{document}</tex-math><mml:math id="M314"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq151.gif"/></alternatives></inline-formula> individuals and <inline-formula id="IEq152"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T=50$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq152.gif"/></alternatives></inline-formula> traits with SNP-based <inline-formula id="IEq153"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2 = 50\%$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq153.gif"/></alternatives></inline-formula> and <inline-formula id="IEq154"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G=0$$\end{document}</tex-math><mml:math id="M320"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq154.gif"/></alternatives></inline-formula>. The simulation design is fully described in the Supplementary Information [see Additional File <xref rid="MOESM1" ref-type="media">1</xref>].</p>
      <p id="Par53">As MGREML estimation is a specific form of MLE, we expect MGREML to yield consistent estimates of the population parameters, provided standard MLE assumptions hold [<xref ref-type="bibr" rid="CR24">24</xref>]. That is, as <italic>N</italic> increases, each parameter estimate converges to the true value. The results of Simulation 1 support the claim that MGREML yields consistent estimates of <inline-formula id="IEq155"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2_{\text{SNP}}$$\end{document}</tex-math><mml:math id="M322"><mml:msubsup><mml:mi>h</mml:mi><mml:mtext>SNP</mml:mtext><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq155.gif"/></alternatives></inline-formula> and <inline-formula id="IEq156"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq156.gif"/></alternatives></inline-formula> across the full range of feasible values for <inline-formula id="IEq157"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq157.gif"/></alternatives></inline-formula> [see Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1–S4]. The SEs of estimates also align with the standard deviations of estimates across the generated datasets. Estimates have lower SEs when interdependence across traits is higher (i.e., higher <inline-formula id="IEq158"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\vert \rho _G \vert$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq158.gif"/></alternatives></inline-formula>).<fig id="Fig3"><label>Fig. 3</label><caption><p>Typical MGREML estimate of a genetic correlation (<inline-formula id="IEq159"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M330"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq159.gif"/></alternatives></inline-formula>) matrix in Simulation 2. True genetic correlations (<inline-formula id="IEq160"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq160.gif"/></alternatives></inline-formula>’s) are shown above the diagonal. Estimated <inline-formula id="IEq161"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq161.gif"/></alternatives></inline-formula>’s (standard error between parentheses) are shown below the diagonal</p></caption><graphic xlink:href="12859_2022_4835_Fig3_HTML" id="MO9"/></fig></p>
      <p id="Par54">The results of Simulation 2 show that MGREML also yields consistent estimates when the degrees of freedom in the model is larger than necessary [see Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Table S5]. Estimates closely reflect the implied factor structure, as illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref> which shows MGREML estimation results for the first dataset. When comparing the fit of the appropriate factor model and the saturated model using an LRT, we find that resulting <italic>p</italic>-values closely follow the correct theoretical distribution [see Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1].</p>
      <p id="Par55">The results of Simulation 3 show that MGREML can readily estimate and compare factor models for <inline-formula id="IEq162"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T=50$$\end{document}</tex-math><mml:math id="M336"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq162.gif"/></alternatives></inline-formula> traits observed in <inline-formula id="IEq163"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=20,000$$\end{document}</tex-math><mml:math id="M338"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq163.gif"/></alternatives></inline-formula> individuals, involving 50 fixed effects and including calculation of SEs, on a single notebook with two 2.7 GHz cores and 16 GB of RAM in less than one hour. In addition, on more powerful machines, MGREML estimation can handle at least up until <inline-formula id="IEq164"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T=200$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq164.gif"/></alternatives></inline-formula> traits and <inline-formula id="IEq165"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=20,000$$\end{document}</tex-math><mml:math id="M342"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq165.gif"/></alternatives></inline-formula> individuals [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
    </sec>
    <sec id="Sec8">
      <title>Empirical application</title>
      <p id="Par56">To illustrate the ability of MGREML to estimate a factor model and test whether it fits the data better than a nested model, we use data on <inline-formula id="IEq166"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=6,425$$\end{document}</tex-math><mml:math id="M344"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>425</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq166.gif"/></alternatives></inline-formula> unrelated individuals from the US Health and Retirement Study (HRS) [<xref ref-type="bibr" rid="CR25">25</xref>], for whom we analyze repeated measures of height and BMI in five consecutive waves of data collection (Waves 7–11). The HRS is a longitudinal panel study that surveys a representative sample of approximately 20,000 individuals aged 51 years and older (and their spouses) in the United States. Further details (e.g., quality control filters and descriptive statistics) are provided in the Supplementary Information [see Additional File <xref rid="MOESM1" ref-type="media">1</xref>].</p>
      <p id="Par57">As a baseline model, we start by assuming height and BMI both have no genetic variance (Model I). Given that previous <inline-formula id="IEq167"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2_{\text{SNP}}$$\end{document}</tex-math><mml:math id="M346"><mml:msubsup><mml:mi>h</mml:mi><mml:mtext>SNP</mml:mtext><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq167.gif"/></alternatives></inline-formula> estimates for height and BMI are considerably greater than zero [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>] (e.g., <inline-formula id="IEq168"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{h}}^2_{\text{SNP}} (\text{height}) = 43\%$$\end{document}</tex-math><mml:math id="M348"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mtext>SNP</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>height</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>43</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq168.gif"/></alternatives></inline-formula> with <inline-formula id="IEq169"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{SE} = 2\%$$\end{document}</tex-math><mml:math id="M350"><mml:mrow><mml:mtext>SE</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq169.gif"/></alternatives></inline-formula> and <inline-formula id="IEq170"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{h}}^2_{\text{SNP}} (\text{BMI}) = 21\%$$\end{document}</tex-math><mml:math id="M352"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mtext>SNP</mml:mtext><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>BMI</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>21</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq170.gif"/></alternatives></inline-formula> with <inline-formula id="IEq171"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{SE} = 2\%$$\end{document}</tex-math><mml:math id="M354"><mml:mrow><mml:mtext>SE</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq171.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR28">28</xref>]), we also consider an alternative model with one genetic factor for the height observations and one genetic factor for the BMI observations (Model II), which corresponds to the first two columns of the factor model shown in Table <xref rid="Tab1" ref-type="table">1</xref> labeled <italic>G</italic><inline-formula id="IEq172"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{height }$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mrow/><mml:mrow><mml:mi mathvariant="italic">height</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq172.gif"/></alternatives></inline-formula> and <italic>G</italic><inline-formula id="IEq173"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{BMI }$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mrow/><mml:mrow><mml:mi mathvariant="italic">BMI</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq173.gif"/></alternatives></inline-formula>.</p>
      <p id="Par58">Although we expect Model II to have a far better fit than Model I, Model II still assumes there is no genetic correlation between height and BMI. Yet, there is ample evidence that height and BMI are genetically correlated traits [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR29">29</xref>] (e.g., <inline-formula id="IEq174"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\rho }}_G ( \text{height},\text{BMI}) = -0.14$$\end{document}</tex-math><mml:math id="M360"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>G</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>height</mml:mtext><mml:mo>,</mml:mo><mml:mtext>BMI</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>0.14</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq174.gif"/></alternatives></inline-formula> with <inline-formula id="IEq175"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{SE} = 0.04$$\end{document}</tex-math><mml:math id="M362"><mml:mrow><mml:mtext>SE</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.04</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq175.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR9">9</xref>]). Therefore, we also consider a third model in which we introduce a shared genetic factor that affects both the height and BMI observations (Model III), accounting for the genetic overlap between these two traits. Model III corresponds to the factor model shown in Table <xref rid="Tab1" ref-type="table">1</xref> (where the shared factor is labeled <italic>G</italic><inline-formula id="IEq176"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_{shared }$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mrow/><mml:mrow><mml:mi mathvariant="italic">shared</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq176.gif"/></alternatives></inline-formula>) and equivalently in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. In all three models, we assume a saturated environmental factor model.</p>
      <p id="Par59">With the HRS surveying a representative sample of individuals aged 51 years and older (and their spouses), it seems unlikely that the unique and the shared genetic architecture of height and BMI will drastically change for individuals in our analysis sample between the biennial waves of data collection. Therefore, we <italic>a priori</italic> believe Model III to be most suitable for the data. That is, we expect this to be the most parsimonious model that is able to capture both the unique and the shared genetic component of height and BMI across waves. At the same time, taking aforementioned estimates of <inline-formula id="IEq177"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^2_{\text{SNP}}$$\end{document}</tex-math><mml:math id="M366"><mml:msubsup><mml:mi>h</mml:mi><mml:mtext>SNP</mml:mtext><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq177.gif"/></alternatives></inline-formula> and <inline-formula id="IEq178"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G$$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq178.gif"/></alternatives></inline-formula> for height and BMI at face value, and using the online GCTA-GREML power calculator [<xref ref-type="bibr" rid="CR30">30</xref>], we find that the statistical power to detect <inline-formula id="IEq179"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _G (\text{height},\text{BMI}) \ne 0$$\end{document}</tex-math><mml:math id="M370"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>height</mml:mtext><mml:mo>,</mml:mo><mml:mtext>BMI</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq179.gif"/></alternatives></inline-formula> in this sample is only 21.8%. Hence, Model II might not be rejected in favor of Model III simply due to lack of statistical power. Details of this power calculation are described in the Supplementary Information [see Additional File <xref rid="MOESM1" ref-type="media">1</xref>].</p>
      <p id="Par60">In the application to data on repeated measures of height and BMI, we first compare the fit of Model I and Model II. We find that Model II, as expected, fits the data better than Model I (LRT=72.03, degrees of freedom=10, <italic>p</italic>-value=<inline-formula id="IEq180"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.79 \times 10^{-11}$$\end{document}</tex-math><mml:math id="M372"><mml:mrow><mml:mn>1.79</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4835_Article_IEq180.gif"/></alternatives></inline-formula>). Thus, the null model of no genetic variance is rejected in favor of a model in which (1) height has genetic variance, (2) BMI has genetic variance, yet (3) height and BMI have no genetic correlation. When we compare the fit of Model II and Model III, we do not find an improvement in fit (LRT=11.11, degrees of freedom=10, <italic>p</italic>-value=0.349). Thus, the model without genetic correlation between height and BMI is not rejected in favor of a model with genetic overlap, in line with our power calculation.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Conclusion</title>
    <p id="Par61">Accurate estimates of genetic correlations and genetic factor structures across multiple traits help to understand their shared etiology and aid in finding likely causal relationships [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. As such, estimation and inference based on genetic and environmental factor models may contribute to the design of future genetic and functional studies.</p>
    <p id="Par62">Here, we derived a statistical framework (1) to model and estimate such factor models using individual-level SNP data and (2) to test hypotheses regarding these factor models. Using simulations and an empirical application, we confirmed the validity of this statistical framework.</p>
    <p id="Par63">This framework is implemented in our freely available command-line tool MGREML, which has simple input options for this purpose. MGREML accepts user-specified genetic and environmental factor models as input, and performs estimation and inference based thereon. Even on a single machine, this tool can readily be applied to data on 20,000 individuals and 50 traits.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec10">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4835_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary Information.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AI</term>
        <def>
          <p id="Par4">Average information</p>
        </def>
      </def-item>
      <def-item>
        <term>BFGS algorithm</term>
        <def>
          <p id="Par5">Broyden–Fletcher–Goldfarb–Shanno algorithm</p>
        </def>
      </def-item>
      <def-item>
        <term>BMI</term>
        <def>
          <p id="Par6">Body mass index</p>
        </def>
      </def-item>
      <def-item>
        <term>EVD</term>
        <def>
          <p id="Par7">Eigenvalue decomposition</p>
        </def>
      </def-item>
      <def-item>
        <term>GCTA</term>
        <def>
          <p id="Par8">Genome-wide complex trait analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>GREML</term>
        <def>
          <p id="Par9">Genomic-relatedness-based restricted maximum likelihood</p>
        </def>
      </def-item>
      <def-item>
        <term>GRM</term>
        <def>
          <p id="Par10">Genomic-relatedness matrix</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p id="Par11">Genome-wide association study</p>
        </def>
      </def-item>
      <def-item>
        <term>HRS</term>
        <def>
          <p id="Par12">Health and Retirement Study</p>
        </def>
      </def-item>
      <def-item>
        <term>LMM</term>
        <def>
          <p id="Par13">Linear mixed model</p>
        </def>
      </def-item>
      <def-item>
        <term>LRT</term>
        <def>
          <p id="Par14">Likelihood-ratio test</p>
        </def>
      </def-item>
      <def-item>
        <term>MGREML</term>
        <def>
          <p id="Par15">Multivariate genomic-relatedness-based restricted maximum likelihood</p>
        </def>
      </def-item>
      <def-item>
        <term>MLE</term>
        <def>
          <p id="Par16">Maximum likelihood estimation</p>
        </def>
      </def-item>
      <def-item>
        <term>RAM</term>
        <def>
          <p id="Par17">Random-access memory</p>
        </def>
      </def-item>
      <def-item>
        <term>REML</term>
        <def>
          <p id="Par18">Restricted maximum likelihood</p>
        </def>
      </def-item>
      <def-item>
        <term>SE</term>
        <def>
          <p id="Par19">Standard error</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par20">Single-nucleotide polymorphism</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1186/s12859-022-04835-3.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors are grateful for computational resources provided by the Dutch national e-infrastructure with support of the SURF cooperative (Project EINF-607).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>Conceptualization: all authors. Methodology: all authors. Software: RDV, EAWS. Formal analysis: RDV, EAWS, CAR. Data Curation: CAR. Writing—Original Draft: RDV, EAWS, CAR. Visualization: RDV, EAWS, CAR. Writing—Review and Editing: all authors. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the European Research Council (Starting Grant 946647 GEPSI to CAR). EAWS is funded by the NIHR Cambridge BRC. The Health and Retirement Study (HRS) is sponsored by the National Institute on Aging (Grant NIA U01AG009740) and is conducted by the University of Michigan. These funding bodies did not play any role in the design of the study, in the collection, analysis, and interpretation of data, and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p><italic>Mandated data deposition</italic> All data used in this manuscript are freely available via public-access repositories. Specifically, we obtained access to the genetic data of the Health and Retirement Study (HRS) through the Database of Genotypes and Phenotypes (dbGaP): <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/gap/">https://www.ncbi.nlm.nih.gov/gap/</ext-link> (dbGaP application 3544). The RAND HRS data, produced by the RAND Center for the Study of Aging, containing the phenotype data, can be accessed via the HRS website: <ext-link ext-link-type="uri" xlink:href="https://hrsdata.isr.umich.edu/data-products/rand/">https://hrsdata.isr.umich.edu/data-products/rand/</ext-link>. Researchers who wish to link genotype and phenotype data from the HRS must apply for access via the HRS website: <ext-link ext-link-type="uri" xlink:href="https://hrsdata.isr.umich.edu/data-products/genetic-cross-reference/">https://hrsdata.isr.umich.edu/data-products/genetic-cross-reference/</ext-link>.</p>
    <p><italic>Software and code</italic> The MGREML tool and the code for the simulation study are freely available via the GitHub repository for this project:</p>
    <p>· <bold>Project name:</bold> MGREML</p>
    <p>· <bold>Project home page (including tutorial):</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/devlaming/mgreml">https://github.com/devlaming/mgreml</ext-link>/</p>
    <p>· <bold>Operating system:</bold> platform independent</p>
    <p>· <bold>Programming language:</bold> Python 3.x.</p>
    <p>· <bold>Other requirements:</bold> Python packages networkx, numpy, pandas, psutil, scipy, and tqdm</p>
    <p>· <bold>License:</bold> GNU GPL v3</p>
    <p>· <bold>Any restrictions to use by non-academics:</bold> as stipulated by GNU GPL v3</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par64">The Health and Retirement Study (HRS) has been approved by the University of Michigan Health Sciences/Behavioral Sciences Institutional Review Board (IRB Protocol: HUM0006112). The research project in which this manuscript is embedded has been approved by the Erasmus Research Institute of Management Institutional Review Board (IRB-E approval 2014-04). In accordance with the stated approval by the University of Michigan Health Sciences/Behavioral Sciences Institutional Review Board of the HRS, informed consent to participate has been obtained from the participants.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par65">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par66">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>GCTA: a tool for genome-wide complex trait analysis</article-title>
        <source>Am J Hum Genet</source>
        <year>2011</year>
        <volume>88</volume>
        <fpage>76</fpage>
        <lpage>82</lpage>
        <?supplied-pmid 21167468?>
        <pub-id pub-id-type="pmid">21167468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Wray</surname>
            <given-names>NR</given-names>
          </name>
        </person-group>
        <article-title>Estimation of pleiotropy between complex diseases using single-nucleotide polymorphism-derived genomic relationships and restricted maximum likelihood</article-title>
        <source>Bioinformatics.</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2540</fpage>
        <lpage>2542</lpage>
        <?supplied-pmid 22843982?>
        <pub-id pub-id-type="pmid">22843982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamin</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Cesarini</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chabris</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Glaeser</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Laibson</surname>
            <given-names>DI</given-names>
          </name>
          <name>
            <surname>Gudnason</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The promises and pitfalls of genoeconomics</article-title>
        <source>Annu Rev Econ.</source>
        <year>2012</year>
        <volume>4</volume>
        <fpage>627</fpage>
        <lpage>662</lpage>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Van der Werf</surname>
            <given-names>JHJ</given-names>
          </name>
        </person-group>
        <article-title>MTG2: an efficient algorithm for multivariate linear mixed model analysis based on genomic information</article-title>
        <source>Bioinformatics.</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>1420</fpage>
        <lpage>1422</lpage>
        <?supplied-pmid 26755623?>
        <pub-id pub-id-type="pmid">26755623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evans</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Tahmasbi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vrieze</surname>
            <given-names>SI</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gazal</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of methods that use whole genome data to estimate the heritability and genetic architecture of complex traits</article-title>
        <source>Nat Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>737</fpage>
        <lpage>745</lpage>
        <?supplied-pmid 29700474?>
        <pub-id pub-id-type="pmid">29700474</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Chow</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Conditions for the validity of SNP-based heritability estimation</article-title>
        <source>Hum Genet.</source>
        <year>2014</year>
        <volume>133</volume>
        <fpage>1011</fpage>
        <lpage>1022</lpage>
        <?supplied-pmid 24744256?>
        <pub-id pub-id-type="pmid">24744256</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Witte</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Wray</surname>
            <given-names>NR</given-names>
          </name>
        </person-group>
        <article-title>The contribution of genetic variants to disease depends on the ruler</article-title>
        <source>Nat Rev Genet.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>765</fpage>
        <lpage>776</lpage>
        <?supplied-pmid 25223781?>
        <pub-id pub-id-type="pmid">25223781</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Wray</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>Concepts, estimation and interpretation of SNP-based heritability</article-title>
        <source>Nat Genet.</source>
        <year>2017</year>
        <volume>49</volume>
        <fpage>1304</fpage>
        <lpage>1310</lpage>
        <?supplied-pmid 28854176?>
        <pub-id pub-id-type="pmid">28854176</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Vlaming</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Slob</surname>
            <given-names>EAW</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Dagher</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koellinger</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Groenen</surname>
            <given-names>PJF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multivariate analysis reveals shared genetic architecture of brain morphology and human behavior</article-title>
        <source>Commun Biol.</source>
        <year>2021</year>
        <volume>4</volume>
        <fpage>1180</fpage>
        <?supplied-pmid 34642422?>
        <pub-id pub-id-type="pmid">34642422</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Schumacker</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Lomax</surname>
            <given-names>RG</given-names>
          </name>
        </person-group>
        <source>A beginner’s guide to structural equation modeling</source>
        <year>2016</year>
        <edition>4</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Routledge</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grotzinger</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Rhemtulla</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>de Vlaming</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Mallard</surname>
            <given-names>TT</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>WD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic structural equation modelling provides insights into the multivariate genetic architecture of complex traits</article-title>
        <source>Nat Hum Behav.</source>
        <year>2019</year>
        <volume>3</volume>
        <fpage>513</fpage>
        <lpage>525</lpage>
        <?supplied-pmid 30962613?>
        <pub-id pub-id-type="pmid">30962613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patterson</surname>
            <given-names>HD</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Recovery of inter-block information when block sizes are unequal</article-title>
        <source>Biometrika.</source>
        <year>1971</year>
        <volume>58</volume>
        <fpage>545</fpage>
        <lpage>554</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Chow</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Tellier</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Vattikuti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Purcell</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Second-generation PLINK: rising to the challenge of larger and richer datasets</article-title>
        <source>GigaScience.</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>s13742</fpage>
        <lpage>015</lpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Speed</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hemani</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Improved heritability estimation from genome-wide SNPs</article-title>
        <source>Am J Hum Genet.</source>
        <year>2012</year>
        <volume>91</volume>
        <fpage>1011</fpage>
        <lpage>1021</lpage>
        <?supplied-pmid 23217325?>
        <pub-id pub-id-type="pmid">23217325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harville</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>Bayesian inference for variance components using only error contrasts</article-title>
        <source>Biometrika.</source>
        <year>1974</year>
        <volume>61</volume>
        <fpage>383</fpage>
        <lpage>385</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Casella G, Searle SR. On a matrix identity useful in variance component estimation. Biometrics Unit Technical Reports. 1985; p. BU-875-M.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood estimation of variance components for a multivariate mixed model with equal design matrices</article-title>
        <source>Biometrics.</source>
        <year>1985</year>
        <volume>41</volume>
        <fpage>153</fpage>
        <lpage>165</lpage>
        <?supplied-pmid 4005372?>
        <pub-id pub-id-type="pmid">4005372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lynch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Walsh</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <source>Genetics and analysis of quantitative traits</source>
        <year>1998</year>
        <edition>1</edition>
        <publisher-loc>Sunderland</publisher-loc>
        <publisher-name>Sinauer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Plenge</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Weinblatt</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Shadick</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>
        <source>Nat Genet.</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>904</fpage>
        <lpage>909</lpage>
        <?supplied-pmid 16862161?>
        <pub-id pub-id-type="pmid">16862161</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilmour</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cullis</surname>
            <given-names>BR</given-names>
          </name>
        </person-group>
        <article-title>Average information REML: an efficient algorithm for variance parameter estimation in linear mixed models</article-title>
        <source>Biometrics.</source>
        <year>1995</year>
        <volume>51</volume>
        <fpage>1440</fpage>
        <lpage>1450</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Nocedal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <source>Numerical optimization</source>
        <year>2006</year>
        <edition>2</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bollen</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <source>Structural equations with latent variables</source>
        <year>1989</year>
        <edition>1</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilks</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>The large-sample distribution of the likelihood ratio for testing composite hypotheses</article-title>
        <source>Ann Math Stat.</source>
        <year>1938</year>
        <volume>9</volume>
        <fpage>60</fpage>
        <lpage>62</lpage>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Newey WK, McFadden D. Chapter 36: Large sample estimation and hypothesis testing. vol. 4 of Handbook of Econometrics. Elsevier; 1994. p. 2111–2245.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sonnega</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Faul</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Ofstedal</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Langa</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>JWR</given-names>
          </name>
          <name>
            <surname>Weir</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Cohort profile: the Health and Retirement Study (HRS)</article-title>
        <source>Int J Epidemiol.</source>
        <year>2014</year>
        <volume>43</volume>
        <fpage>576</fpage>
        <lpage>585</lpage>
        <?supplied-pmid 24671021?>
        <pub-id pub-id-type="pmid">24671021</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Benyamin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>McEvoy</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Henders</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Nyholt</surname>
            <given-names>DR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Common SNPs explain a large proportion of the heritability for human height</article-title>
        <source>Nat Genet.</source>
        <year>2010</year>
        <volume>42</volume>
        <fpage>565</fpage>
        <lpage>569</lpage>
        <?supplied-pmid 20562875?>
        <pub-id pub-id-type="pmid">20562875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Manolio</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Pasquale</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Boerwinkle</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Caporaso</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Cunningham</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome partitioning of genetic variation for complex traits using common SNPs</article-title>
        <source>Nat Genet.</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>519</fpage>
        <lpage>525</lpage>
        <?supplied-pmid 21552263?>
        <pub-id pub-id-type="pmid">21552263</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Vlaming</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Okbay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rietveld</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Johannesson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Magnusson</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Uitterlinden</surname>
            <given-names>AG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Meta-GWAS Accuracy and Power (MetaGAP) calculator shows that hiding heritability is partially due to imperfect genetic correlations across studies</article-title>
        <source>PLoS Genet.</source>
        <year>2017</year>
        <volume>13</volume>
        <fpage>e1006495</fpage>
        <?supplied-pmid 28095416?>
        <pub-id pub-id-type="pmid">28095416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bulik-Sullivan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Finucane</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Anttila</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Gusev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Day</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Loh</surname>
            <given-names>PR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An atlas of genetic correlations across human diseases and traits</article-title>
        <source>Nat Genet.</source>
        <year>2015</year>
        <volume>47</volume>
        <fpage>1236</fpage>
        <lpage>1241</lpage>
        <?supplied-pmid 26414676?>
        <pub-id pub-id-type="pmid">26414676</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Hemani</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Vinkhuyzen</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Wray</surname>
            <given-names>NR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statistical power to detect genetic (co) variance of complex traits using SNP data in unrelated samples</article-title>
        <source>PLoS Genet.</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>e1004269</fpage>
        <?supplied-pmid 24721987?>
        <pub-id pub-id-type="pmid">24721987</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Connor</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Distinguishing genetic correlation from causation across 52 diseases and complex traits</article-title>
        <source>Nat Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>1728</fpage>
        <lpage>1734</lpage>
        <?supplied-pmid 30374074?>
        <pub-id pub-id-type="pmid">30374074</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
