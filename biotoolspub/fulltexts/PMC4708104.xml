<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4708104</article-id>
    <article-id pub-id-type="pmid">26424858</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv562</article-id>
    <article-id pub-id-type="publisher-id">btv562</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>regioneR: an R/Bioconductor package for the association analysis of genomic regions based on permutation tests</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gel</surname>
          <given-names>Bernat</given-names>
        </name>
        <xref ref-type="aff" rid="btv562-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="btv562-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Díez-Villanueva</surname>
          <given-names>Anna</given-names>
        </name>
        <xref ref-type="aff" rid="btv562-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="btv562-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Serra</surname>
          <given-names>Eduard</given-names>
        </name>
        <xref ref-type="aff" rid="btv562-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Buschbeck</surname>
          <given-names>Marcus</given-names>
        </name>
        <xref ref-type="aff" rid="btv562-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv562-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Peinado</surname>
          <given-names>Miguel A.</given-names>
        </name>
        <xref ref-type="aff" rid="btv562-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Malinverni</surname>
          <given-names>Roberto</given-names>
        </name>
        <xref ref-type="aff" rid="btv562-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv562-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btv562-COR1">*</xref>
      </contrib>
      <aff id="btv562-AFF1"><label>1</label><sup>1</sup>Institute of Predictive and Personalized Medicine of Cancer (IMPPC), Campus Can Ruti, Badalona, Spain and</aff>
      <aff id="btv562-AFF2"><label>2</label><sup>2</sup>Josep Carreras Institute for Leukaemia Research (IJC), Campus ICO-HGTP, Campus Can Ruti, Badalona, Spain</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv562-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="btv562-FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <fn id="btv562-FN2">
        <p>Associate Editor: Alfonso Valencia</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>1</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>9</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>9</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>32</volume>
    <issue>2</issue>
    <fpage>289</fpage>
    <lpage>291</lpage>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>5</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>4</day>
        <month>9</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>9</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Statistically assessing the relation between a set of genomic regions and other genomic features is a common challenging task in genomic and epigenomic analyses. Randomization based approaches implicitly take into account the complexity of the genome without the need of assuming an underlying statistical model.</p>
      <p><bold>Summary:</bold> regioneR is an R package that implements a permutation test framework specifically designed to work with genomic regions. In addition to the predefined randomization and evaluation strategies, regioneR is fully customizable allowing the use of custom strategies to adapt it to specific questions. Finally, it also implements a novel function to evaluate the local specificity of the detected association.</p>
      <p><bold>Availability and implementation:</bold> regioneR is an R package released under Artistic-2.0 License. The source code and documents are freely available through Bioconductor (<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/regioneR">http://www.bioconductor.org/packages/regioneR</ext-link>).</p>
      <p>
        <bold>Contact:</bold>
        <email>rmalinverni@carrerasresearch.org</email>
      </p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Sets of genomic regions are the output of many different genomic and epigenomic analyses like ChIP-seq peaks, regions with copy number alterations or differentially methylated regions. The identification of meaningful associations between a set of genomic regions and other genomic features is an important part of downstream analysis. The genomic features can be of different types: other region sets, intrinsic properties of the genome—e.g. GC content—or functions defined over the genome—e.g. DNA methylation levels, phylogenetic conservation. In addition, different metrics can be used to evaluate the associations. Thus, while counting the number of overlaps between two region sets is a widely used evaluation strategy, with regioneR it is possible to answer a wider range of biological questions beyond region overlapping with the use of other combinations of metrics and genomic features.</p>
    <p>Computing any of these evaluations can be straightforward but assigning a statistical significance to the association levels is far from trivial. Due to the complexity of the genome, statistical models relying on strict assumptions can only be used in certain circumstances. Empirical approaches such as permutation tests might overcome these limitations but they require the use of the appropriate strategies to generate meaningful results and usually have higher computational costs.</p>
    <p>Existing software tools to evaluate the association of region sets and other genomic features such as Geometricorr (<xref rid="btv562-B2" ref-type="bibr">Favorov <italic>et</italic>
<italic>al.</italic>, 2012</xref>) or GAT (<xref rid="btv562-B3" ref-type="bibr">Heger <italic>et</italic>
<italic>al.</italic>, 2013</xref>) are either based on statistical modelling or only applicable to a limited number of situations.</p>
    <p>regioneR has been created to address this problem providing a fully customizable permutation test framework specifically designed to work with genomic regions. It includes a number of predefined randomization and evaluation functions covering the most frequent use cases, but the user can also provide custom functions to extend its functionality.</p>
  </sec>
  <sec>
    <title>2 Features</title>
    <p>The core functionality of regioneR is a permutation test framework specifically designed to work in a genomic environment. It includes multiple randomization and evaluation strategies and the possibility to use custom functions. It can take into account the underlying structure of the genome using a genome definition and a mask. The result of performing a permutation test with regioneR is an object with the random distribution of the evaluation function, the <italic>P</italic> value (<xref rid="btv562-B7" ref-type="bibr">Phipson and Smyth, 2010</xref>) and the z-score of the test (<xref ref-type="fig" rid="btv562-F1">Fig. 1</xref>A).
<fig id="btv562-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>(<bold>A</bold>) Plot of the results of a permutation test assessing the association between a subset of 1000 HepG2 CTCF narrow peaks (ENCODE/Broad Institute) and CpG islands (<xref rid="btv562-B8" ref-type="bibr">Wu <italic>et al.</italic>, 2010</xref>), using a per chromosome randomization of CTCF peaks, the number of overlaps as the evaluation function and 5000 permutations. The association is highly significant with the observed value far from the limit of significance of the random distribution. (<bold>B</bold>) Plot of the local z-score of the permutation test in A. The association is strongly related to the exact position of the CTCF peaks since the z-score drops sharply as soon as the regions are shifted a few hundreds of bases</p></caption><graphic xlink:href="btv562f1p"/></fig>
</p>
    <p>In addition, regionerR includes a set of helper functions based on Bioconductor’s GenomicRanges (<xref rid="btv562-B5" ref-type="bibr">Lawrence <italic>et</italic>
<italic>al.</italic>, 2013</xref>) infrastructure to manage and manipulate region sets with a simple and consistent interface.</p>
    <sec>
      <title>2.1 Randomization</title>
      <p>Choosing a good randomization strategy is crucial when performing a permutation test (<xref rid="btv562-B1" ref-type="bibr">De <italic>et</italic>
<italic>al.</italic>, 2013</xref>). The ideal strategy randomizes the regions with respect to the association being evaluated while maintaining their intrinsic structure. regioneR implements different randomization strategies: one that randomly places all regions independently along the genome with or without overlaps, one randomizing them in a per chromosome basis, a circular randomization that maintains the relative distances between the regions and a resampling strategy useful when a finite universe of possible regions is available. It is also possible to provide new randomization strategies adapted to specific problems. An expanded discussion about the built-in randomization strategies and how to create custom ones is available in the ‘Randomization Functions’ section of the package vignette.</p>
    </sec>
    <sec>
      <title>2.2 Evaluation</title>
      <p>The evaluation functions, those quantifying the association under study, are even more problem specific. A set of evaluation functions for the most common use cases has been included in the package. With them it is possible to determine either the number of overlaps or the distance between two regions sets, or to evaluate a function over the regions: methylation levels, GC content, etc. Again, it is possible to implement a custom evaluation function when needed. The ‘Evaluation Functions’ section of the package vignette includes more information about the available functions an how to create new ones.</p>
    </sec>
    <sec>
      <title>2.3 Input formats</title>
      <p>Different BED-like R objects and file formats can be used as input to any function in regioneR. The package implements a function to create a region set from different data sources: data.frame or GRanges R objects, BED or GFF files, either local or remote, and in general, any source accepted by the rtracklayer package (<xref rid="btv562-B4" ref-type="bibr">Lawrence <italic>et</italic>
<italic>al.</italic>, 2009</xref>).</p>
    </sec>
    <sec>
      <title>2.4 Genome and mask</title>
      <p>Most functions in regioneR are prepared to work with genomes and masks, respectively, the complete set of chromosomes and the set of genomic regions ‘not available’ to work with e.g. centromeres, repetitive regions. The most suitable mask is case specific and might have an important impact on the final results. All genomes and masks provided by BSGenome (<xref rid="btv562-B6" ref-type="bibr">Pagès, 2012</xref>) can be used and custom genomes and masks can also be easily defined.</p>
    </sec>
    <sec>
      <title>2.5 Local z-score</title>
      <p>When performing an association analysis it is possible to detect associations that, while statistically significant, are not specific or even not biologically relevant. For example, with ChIP-seq data, it is common to detect a significant overlap between transcription factors and chromatin marks broadly distributed over gene-rich regions. This association can be true, however, it might be indirect and based on the fact that both regions tend to cluster around genes. Although we cannot decide whether an association is biologically relevant or not, with the local z-score we can at least check if the association is specifically linked to the exact position of the regions. By shifting the regions around their original position and plotting their evaluations when shifted, we can study how the value of the z-score varies. While a flat profile suggests a regional association, a sharp peak, as the one shown in <xref ref-type="fig" rid="btv562-F1">Figure 1</xref>B, indicates that the association is highly dependent on the exact position of the regions. The package vignette includes a number of complete biological examples, some of which make use of the local z-score computation to further characterize the relation between two region sets.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>regioneR provides a permutation test based framework to statistically assess the association between a set of regions and any other genomic features or annotations. It implements a number of randomization and evaluation strategies addressing the most common use cases. In addition it can also be easily adapted to specific questions by using custom functions. The package also contains a set of helper functions to simplify the management of sets of genomic regions. regioneR is a new and customizable tool to manage and analyze sets of regions, and a useful addition to the NGS and genome wide analysis toolbox.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Judith Flo and Iñaki Martinez for their technical support and Ana Rojas and Ildefonso Cases for their insightful discussions and comments.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work has been supported by the <funding-source>Spanish Ministry of Economy and Competitiveness</funding-source> (<award-id>SAF2012/39749</award-id>; <award-id>SAF2011/23638</award-id>; <award-id>RYC2010/07337</award-id>; <award-id>PTC2011/1091</award-id>) and the <funding-source>Carlos III Health Institute</funding-source> (<award-id>ISCIII-RTICC RD12/0036/008</award-id>; <award-id>PI11/1609</award-id>; <award-id>PI14/00577</award-id>) all within the ‘Plan Nacional de I + D + I 2008-2011’ and ‘Plan Estatal de I + D + I 2013-2016’ and co-financed with FEDER funds; the <funding-source>Government of Catalonia</funding-source> (<award-id>2009 SGR 290</award-id>; <award-id>2014 SGR 338</award-id>) and the <funding-source>Asociación Española Contra el Cáncer (AECC)</funding-source>. M.B. is a Ramón y Cajal fellow.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btv562-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2013</year>) 
<article-title>The dilemma of choosing the ideal permutation strategy while estimating statistical significance of genome-wide enrichment</article-title>. <source>Brief. Bioinform.</source></mixed-citation>
    </ref>
    <ref id="btv562-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Favorov</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2012</year>) 
<article-title>Exploring massive, genome scale datasets with the genometricorr package</article-title>. <source>PLoS Comput. Biol.</source>, <volume>8</volume>, <fpage>e1002529</fpage>.<pub-id pub-id-type="pmid">22693437</pub-id></mixed-citation>
    </ref>
    <ref id="btv562-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heger</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2013</year>) 
<article-title>GAT: a simulation framework for testing the association of genomic intervals</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>2046</fpage>–<lpage>2048</lpage>.<pub-id pub-id-type="pmid">23782611</pub-id></mixed-citation>
    </ref>
    <ref id="btv562-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2009</year>) 
<article-title>rtracklayer: An R package for interfacing with genome browsers</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1841</fpage>–<lpage>1842</lpage>.<pub-id pub-id-type="pmid">19468054</pub-id></mixed-citation>
    </ref>
    <ref id="btv562-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2013</year>) 
<article-title>Software for computing and annotating genomic ranges</article-title>. <source>PLoS Comput. Biol.</source>, <volume>9</volume>, <fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btv562-B6">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pagès</surname><given-names>H.</given-names></name></person-group> (<year>2012</year>) <comment>BSgenome: infrastructure for Biostrings-based genome data packages. R package version 1.30.0</comment>.</mixed-citation>
    </ref>
    <ref id="btv562-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phipson</surname><given-names>B.</given-names></name><name><surname>Smyth</surname><given-names>G.K.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Permutation P-values should never be zero: calculating exact p-values when permutations are randomly drawn</article-title>. <source>Stat. Appl. Genet. Mol. Biol.</source><italic>, </italic><volume>9</volume>, <fpage>39</fpage>.</mixed-citation>
    </ref>
    <ref id="btv562-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2010</year>) 
<article-title>Redefining CpG islands using hidden Markov models</article-title>. <source>Biostatistics</source>, <volume>11</volume>, <fpage>499</fpage>–<lpage>514</lpage>.<pub-id pub-id-type="pmid">20212320</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
