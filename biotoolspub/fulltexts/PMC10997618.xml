<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10997618</article-id>
    <article-id pub-id-type="pmid">38580638</article-id>
    <article-id pub-id-type="publisher-id">47349</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-024-47349-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>De novo diploid genome assembly using long noisy reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Nie</surname>
          <given-names>Fan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0801-7574</contrib-id>
        <name>
          <surname>Ni</surname>
          <given-names>Peng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Neng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Jun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Zhenyu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4680-0682</contrib-id>
        <name>
          <surname>Xiao</surname>
          <given-names>Chuanle</given-names>
        </name>
        <address>
          <email>xiaochuanle@126.com</email>
        </address>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4813-2403</contrib-id>
        <name>
          <surname>Luo</surname>
          <given-names>Feng</given-names>
        </name>
        <address>
          <email>luofeng@clemson.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1516-0480</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Jianxin</given-names>
        </name>
        <address>
          <email>jxwang@mail.csu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f1zfq44</institution-id><institution-id institution-id-type="GRID">grid.216417.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0379 7164</institution-id><institution>School of Computer Science and Engineering, </institution><institution>Central South University, </institution></institution-wrap>Changsha, 410083 China </aff>
      <aff id="Aff2"><label>2</label>Xiangjiang Laboratory, Changsha, 410205 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00xsfaz62</institution-id><institution-id institution-id-type="GRID">grid.412982.4</institution-id><institution-id institution-id-type="ISNI">0000 0000 8633 7608</institution-id><institution>National Center for Applied Mathematics in Hunan and Key Laboratory of Intelligent Computing and Information Processing of Ministry of Education, </institution><institution>Xiangtan University, </institution></institution-wrap>Xiangtan, Hunan 411105 China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f1zfq44</institution-id><institution-id institution-id-type="GRID">grid.216417.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0379 7164</institution-id><institution>Hunan Provincial Key Lab on Bioinformatics, </institution><institution>Central South University, </institution></institution-wrap>Changsha, 410083 China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01g9hkj35</institution-id><institution-id institution-id-type="GRID">grid.464309.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 6431 5677</institution-id><institution>Institute of Nanfan &amp; Seed Industry, </institution><institution>Guangdong Academy of Sciences, </institution></institution-wrap>Guangdong, 510316 China </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/003mfbe21</institution-id><institution>State Key Laboratory of Ophthalmology, Zhongshan Ophthalmic Center, </institution><institution>Sun Yat-sen University #7 Jinsui Road, Tianhe District, </institution></institution-wrap>Guangzhou, China </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/037s24f05</institution-id><institution-id institution-id-type="GRID">grid.26090.3d</institution-id><institution-id institution-id-type="ISNI">0000 0001 0665 0280</institution-id><institution>School of Computing, </institution><institution>Clemson University, </institution></institution-wrap>Clemson, SC 29634-0974 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>2964</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The high sequencing error rate has impeded the application of long noisy reads for diploid genome assembly. Most existing assemblers failed to generate high-quality phased assemblies using long noisy reads. Here, we present PECAT, a <bold>P</bold>hased <bold>E</bold>rror <bold>C</bold>orrection and <bold>A</bold>ssembly <bold>T</bold>ool, for reconstructing diploid genomes from long noisy reads. We design a haplotype-aware error correction method that can retain heterozygote alleles while correcting sequencing errors. We combine a corrected read SNP caller and a raw read SNP caller to further improve the identification of inconsistent overlaps in the string graph. We use a grouping method to assign reads to different haplotype groups. PECAT efficiently assembles diploid genomes using Nanopore R9, PacBio CLR or Nanopore R10 reads only. PECAT generates more contiguous haplotype-specific contigs compared to other assemblers. Especially, PECAT achieves nearly haplotype-resolved assembly on <italic>B. taurus</italic> (Bison×Simmental) using Nanopore R9 reads and phase block NG50 with 59.4/58.0 Mb for HG002 using Nanopore R10 reads.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Most existing assemblers failed to generate high-quality phased assemblies using long noisy reads. Here, the authors present PECAT, a Phased Error Correction and Assembly Tool, for reconstructing diploid genomes from long noisy reads.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Genome assembly algorithms</kwd>
      <kwd>Computational models</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100005825</institution-id>
            <institution>United States Department of Agriculture | National Institute of Food and Agriculture (NIFA)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2023-70029-41309</award-id>
        <principal-award-recipient>
          <name>
            <surname>Luo</surname>
            <given-names>Feng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000153</institution-id>
            <institution>NSF | BIO | Division of Biological Infrastructure (DBI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ABI-1759856</award-id>
        <principal-award-recipient>
          <name>
            <surname>Luo</surname>
            <given-names>Feng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">De novo genome assembly is a fundamental task in genomic research<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. Using long noisy reads from sequencing technologies, such as complete long reads (CLR) sequencing of Pacific Biosciences (PacBio) and Nanopore sequencing of Oxford Technologies (ONT), many assemblers<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR9">9</xref></sup> now can effectively reconstruct high-quality genome sequences for haploid or inbred species. However, a significant fraction of genetic information of a diploid genome is lost in those assemblies and most of them have lots of haplotype switch errors. Because long noisy reads, such as PacBio CLR reads and Nanopore reads, usually contain a 5–15% sequencing error<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, it is difficult to distinguish heterozygotes from sequencing errors in long noisy reads<sup><xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup>, which prevents the diploid assemblers from generating long haplotype-specific contigs. Recently, by combining long noisy reads with additional highly accurate sequencing data, such as parental short reads<sup><xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref></sup>, PacBio HiFi reads<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>, Hi-C reads<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, Strand-seq data<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, or gamete cell data<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, assemblers now can produce more contiguous haplotype-specific contigs. However, the requirements for additional sequencing data increase costs and limit their applications in practice<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR23">23</xref></sup>. Meanwhile, it is easier to identify haplotype differences using high accurate PacBio HiFi reads<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> (&lt; 1% error rate), which has been widely used for haplotype resolved assemblies<sup><xref ref-type="bibr" rid="CR25">25</xref>–<xref ref-type="bibr" rid="CR28">28</xref></sup>. However, the average lengths of HiFi reads (10–25 kb) are shorter than those of long noisy reads. For example, the ultra-long reads of Nanopore are up to 1 M in length and with read N50 &gt; 100 kb<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Longer reads usually help to assemble more contiguous contigs<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. Therefore, it will be useful to develop an assembler that can take advantage of long noisy reads to generate more contiguous haplotype-specific contigs for diploid genomes.</p>
    <p id="Par4">To achieve high-quality assemblies, error correction is usually a useful step for genome assembling using long noisy reads. One challenge for correct-then-assemble pipelines in assembling a diploid genome using long noisy reads is how to retain heterozygotes during error correction. If the sequencing error rate exceeds haplotype divergence, current correct-then-assemble pipelines<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup> eliminate heterozygotes as sequencing errors or mixed alleles of different haplotypes in a read. Therefore, corrected reads don’t contain heterozygote information for haplotype phasing. Assemblers, such as FALCON-Unzip<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, used raw reads instead of corrected reads in their “unzip” phasing step, then mapped the raw reads to the corrected reads for the later diploid assembly. This has led to assembly errors due to the heterozygote errors in the corrected reads and mapping errors between corrected reads and raw reads as the length of reads and their SNP position changed after correction<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. Furthermore, phasing raw reads is more difficult due to their high error rate.</p>
    <p id="Par5">Another challenge is partitioning reads according to their haplotypes in the phasing step. After error correction, there still are sequencing errors left in corrected reads. The error profile of corrected reads is also more complex than that of PacBio HiFi reads. Due to the sequencing errors, a significant fraction of reads is difficult to be phased to the correct haplotypes. This leads to inconsistent overlaps<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> among reads, whose reads come from different haplotypes or different copies of the segmental duplication. The inconsistent overlaps can cause haplotype switch errors or unresolved repeats. Accurately phasing the reads, and then identifying and removing inconsistent overlaps is important in overlap-graph-based diploid genome assembly. Even if we assemble the genome using PacBio HiFi reads, there is still need error correction step to improve the phasing accuracy<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. The higher error rate in corrected long noisy reads makes phasing and identifying inconsistent overlaps more difficult. It is necessary to design a more accurate and robust method to identify inconsistent overlaps for long noisy read-based assemblers.</p>
    <p id="Par6">Furthermore, to construct two haplotypes of diploid genomes, the assemblers often need higher coverage of sequencing data. However, with the increasing amount of sequencing data, the running time of assembly increases nonlinearly. Therefore, assembling large diploid genomes at an acceptable time is another challenge. Overlap-graph-based assemblers have their unique advantages to assemble diploid genomes since the overlaps can be reused in subsequent steps once they are found. This helps to design an efficient multi-round assembly strategy. The overlap-graph-based assemblers usually use seed (i.e., k-mers, minimizers<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>) based methods to find candidate overlaps, then perform local alignment to find the true overlaps. The local alignment is the major computational bottleneck of overlap-graph-based approaches. Although skipping local alignment can accelerate the overlap-finding step<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>, it leads to lots of false-positive overlaps and introduces errors in assembly graphs. String-graph-based<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> approaches, a type of overlap-graph-based approach, ignore the reads contained by other reads and mark most edges in the graph as transitive edges<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> that don’t contribute to the construction of contigs. Then, it is not necessary to perform local alignment on those read pairs. Therefore, it is possible to design a fast string-graph-based diploid genome assembler by minimizing the number of local alignments needed.</p>
    <p id="Par7">In this work, we present PECAT, a <bold>P</bold>hased <bold>E</bold>rror <bold>C</bold>orrection and <bold>A</bold>ssembly <bold>T</bold>ool, designed to reconstruct diploid genomes from long noisy reads, including PacBio CLR reads and Nanopore reads. PECAT follows the correct-then-assemble strategy, including a haplotype-aware error correction module, which can retain heterozygote alleles while correcting sequencing errors, and a two-round string graph-based assembly module. To accelerate the assembling, PECAT only performs local alignment when it is necessary instead of performing local alignments on all candidate overlaps. PECAT outputs two sets of contigs either in primary/alternate format (long contigs with the mosaic of homologous haplotypes and short haplotype-specific contigs) or in the dual assembly format<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> (two sets of long contigs with the mosaic of homologous haplotypes). PECAT can efficiently assemble diploid genomes using Nanopore R9, PacBio CLR or more accurate Nanopore R10 reads only and generate more contiguous haplotype-specific contigs compared to other assemblers.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Result</title>
    <sec id="Sec3">
      <title>Haplotype-aware error correction</title>
      <p id="Par8">Our error correction method (Fig. <xref rid="Fig1" ref-type="fig">1a</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>) is based on the partial-order alignment (POA) graph<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> method. For the template read to be corrected, a POA graph is built from the alignment of supporting reads. Then, the path with the highest weight is found in the POA graph to construct the consensus sequence for the template read. However, if the sequencing error rate exceeds haplotype divergence, current methods inevitably select supporting reads from different haplotypes. This causes either heterozygote alleles in the template reads to be eliminated as sequencing errors or heterozygous alleles from different haplotypes to be mixed in corrected reads.<fig id="Fig1"><label>Fig. 1</label><caption><title>Overview of PECAT.</title><p><bold>a</bold> Haplotype-aware error correction method. The reads in different colors (in green or in yellow) are from different haplotypes. The reads with a dark gray background color indicate that they are not selected. The supporting reads that are more likely from the same haplotype are selected to correct the template read. <bold>b</bold> The first round of assembly. PECAT finds overlaps between reads. The dashed lines indicate there are overlaps between reads. Our string-graph-based assembler is performed to construct haplotype-collapsed contigs. The reads in green or in yellow are from heterozygosity regions. The same color indicates that the reads come from the same haplotype. The reads in grey are from homozygosity regions. <bold>c</bold> The second round of assembly. PECAT identifies inconsistent overlaps by calling and analyzing SNP alleles in reads. After removing inconsistent overlaps from the overlaps found in the first round of assembly, PECAT performs our string-graph-based assembler again to construct the contigs in the primary/alternate format or the dual assembly format.</p></caption><graphic xlink:href="41467_2024_47349_Fig1_HTML" id="d33e464"/></fig></p>
      <p id="Par9">To maintain the heterozygote alleles in the template read, we need to select supporting reads from the same haplotype to correct it. After analyzing the POA graph, we have found that the difference between random sequencing errors and heterozygotes can be reflected in the POA graph. In the case of heterozygotes, there are two dominant parallel branches in the POA graph. In the case of random errors, there tends to be only one dominant branch (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1b</xref>). Based on this finding, we design a scoring algorithm to estimate the likelihood that the supporting read and the template read are from the same haplotype (<bold>Methods</bold>). For each position at which there are two dominant parallel branches, if the supporting read and the template read pass through the same dominant branch, the score is increased by 1 and if the supporting read and the template read pass through the different dominant branches, the score is decreased by 1 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1c</xref><bold>)</bold>. A higher score means that the template read and the supporting read are more likely from the same haplotype. If the supporting reads come from different haplotypes, the histogram of scores of all supporting reads should show two peaks (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1d</xref><bold>)</bold>. Then, we select the high-scoring supporting reads, which are very likely to be in the same haplotype as the template read, to correct the template read. To further increase the likelihood of selecting supporting reads in the same haplotype, we assign different weights to the reads according to their score. The higher the score of a read, the larger its weight is assigned (<bold>Methods</bold>). Then, we remove unselected reads in the POA graph by assigning their weights to 0. Finally, we use a dynamic programming approach to find the path with the highest weight in the POA graph and concatenated the nodes in the path, and generate the consensus sequence (<bold>Methods</bold>).</p>
      <p id="Par10">We evaluate the performance of the selection method on seven diploid datasets of <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison×Simmental) and HG002 (Nanopore R9), all with reads classified by the trio-binning algorithm<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> (<bold>Methods</bold>). As shown in Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>, without the selection method, 36.7%, 31.5%, 41.1%, 28.1%, 33.8%, 37.2% and 27.4% of supporting reads are inconsistent reads, respectively, which are from the haplotype different from the one of template read. Meanwhile, there are only 2.8%, 3.5% 4.9%, 3.6%, 4.3%, 2.9%, and 4.2% inconsistent reads in selected supporting reads, respectively. After further re-weighting the scores, the percentages of inconsistent reads are reduced to 2.1%, 3.1%, 4.0%, 3.1%, 3.5%, 2.3%, and 3.4%, respectively.</p>
      <p id="Par11">Since most of the selected supporting reads are from the same haplotype of the template read, most heterozygote alleles in the template read are correctly retained in our error correction method. We compare our method with other methods including Canu<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, MECAT2<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, and NECAT<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> on simulated PacBio CLR data and Nanopore data (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>, Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>, and Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>). The overall accuracies of corrected reads are similar, which exceeds 99%. However, the accuracies of SNP alleles in corrected reads are less than 80% for Canu and less than 60% for MECAT and NECAT, which are far worse than those of raw reads and reads corrected by PECAT. When the heterozygosity rate of simulated reads is greater than or equal to 0.0005, the accuracy of SNP alleles in reads corrected by PECAT is greater than 99%, which exceeds that of raw reads (96% or 98%). However, when the heterozygosity rate of simulated reads is equal to 0.0001, the accuracy of SNP alleles in reads corrected by PECAT is reduced to 92% ~ 94%, which is less than that of raw reads (96% ~ 98%). Therefore, for high heterozygosity genome regions (&gt;= 0.0005), our haplotype-aware error correction can preserve the SNPs well. However, for low heterozygosity genome regions (&lt; 0.0005), we need to combine with other methods to improve the accuracy of SNP calling (<bold>Methods</bold>).<fig id="Fig2"><label>Fig. 2</label><caption><title>Performance comparison of error correction.</title><p><bold>a</bold> Accuracy of raw and corrected reads and accuracy of SNP alleles in raw and corrected reads on the simulated datasets with different heterozygosity rates. <bold>b</bold> Accuracy of raw reads and corrected reads by NECAT and PECAT in difficult-to-map regions and low-complexity regions of HG002 reference genome. <bold>c, d</bold> Consistency, and completeness of raw reads and corrected reads by Canu, FALCON, MECAT2, NECAT, and PECAT on the seven diploid datasets. The metrics by Canu on <italic>B. taurus</italic> (PacBio CLR and ONT) and HG002 (ONT) and the metrics by FALCON on <italic>B. taurus</italic> (PacBio CLR) are excluded because they could not finish correcting in three weeks. Consistency is defined as <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum \max ({k}_{p},{k}_{m})/\sum ({k}_{p}+{k}_{m})$$\end{document}</tex-math><mml:math id="M2"><mml:mo>∑</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq1.gif"/></alternatives></inline-formula>, in which <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{p}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{m}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq3.gif"/></alternatives></inline-formula> are the number of paternal and maternal haplotype-specific k-mers in each read. Completeness is the percentage of parent-specific k-mers (occurrences <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 4$$\end{document}</tex-math><mml:math id="M8"><mml:mo>≥</mml:mo><mml:mn>4</mml:mn></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq4.gif"/></alternatives></inline-formula>) in the 40X longest reads. <bold>e</bold> Consistency of <italic>D. melanogaster</italic> (ISO1 × A4) raw reads and corrected reads by the different methods. Each point corresponds to a read. Its coordinate gives the proportion of the parental specific k-mers in the read, where k is 18. All 40X longest reads are shown in each sub-figure.</p></caption><graphic xlink:href="41467_2024_47349_Fig2_HTML" id="d33e655"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Fast string graph-based assembler</title>
      <p id="Par12">After error correction, PECAT implements two rounds of string graph-based assembly. In each round of assembly, we first construct the overlaps between the corrected reads using the seed-based alignment method (minimap2<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>), which allows us to build the overlaps quickly. However, seed-based alignment can bring low-quality overlaps with low identity or with long overhangs. Those low-quality overlaps could introduce errors during assembling. Performing local alignment on overlaps to identify low-quality ones becomes the major computational cost. To speed up the assembling, PECAT only performs local alignments when it is necessary during the construction of the string graph. (<bold>Methods</bold>). First, to reduce overhangs of overlaps, we use diff algorithm<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> to extend the candidate overlaps to the ends of the reads. Here, we only perform local alignment on overhangs instead of on the whole overlap. We remove the overlaps if their overhangs are still long (<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min ({{{{{\mathrm{100,0.01}}}}}}\cdot l)$$\end{document}</tex-math><mml:math id="M10"><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">100, 0.01</mml:mi><mml:mo>⋅</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq5.gif"/></alternatives></inline-formula> for PacBio reads and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min {({{{{\mathrm{300,0.03}}}}}}\cdot l)$$\end{document}</tex-math><mml:math id="M12"><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">300, 0.03</mml:mi><mml:mo>⋅</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq6.gif"/></alternatives></inline-formula> for Nanopore reads, where <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M14"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq7.gif"/></alternatives></inline-formula> is length of the read). On the diploid datasets of <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison × Simmental) and HG002, 5.3%, 10.3%, 82.2%, 12.8%, 20.0%, 59.4% and 56.3% of candidate overlaps with long overhangs have been considered as low quality and removed, respectively (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). Then, we further filter out the overlaps whose reads are contained in other reads or with low coverage. Only 0.15%, 0.18%, 0.86%, 0.86%, 0.03%, 1.23%, and 0.15% of overlaps remained on the above seven diploid datasets (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). We then construct a directed string graph from the remaining overlaps. We find the transitive edges using Myers’ algorithm<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> and mark them as inactive edges, which are not used for constructing contigs. On the above diploid datasets, only 25.1%, 16.7%, 16.3%, 18.5%, 20.7%, 15.4%, and 23.6% of edges are active (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>).</p>
      <p id="Par13">To remove low-quality edges in the string graph, we calculate the identity of the overlaps (the active edges) in the string graph using local alignments. Since most edges have been marked as inactive, we only need to perform local alignments for a small portion of overlaps. On the above diploid datasets, 2.1%, 12.2%, 9.5%, 2.2%, 13.2%, 1.8%, and 6.9% of active edges have been removed because their identities are less than the threshold (<bold>Methods</bold>) (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). After the above step, some paths in the graphs connected by low-quality edges are broken. Those broken paths need to be connected using the transitive edges that have been labeled as inactive edges. We then select transitive edges with the longest alignment and their identity greater than the threshold to connect the broken paths. On the above diploid datasets, about 0.67%, 0.12%, 0.15%, 0.09%, 0.13%, 0.05%, and 0.16% of transitive edges have been reactivated (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). Finally, we attempt to use the contained reads to connect the broken paths, and about 0.30%, 0.39%, 0.17%, 0.11%, 0.77%, 0.13%, and 0.45% of new edges are added to the graph on the above diploid datasets (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). In the first round of assembly (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>), PECAT finds linear paths from this string graph and constructs haplotype-collapsed contigs. In the second round of assembly (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>), PECAT identifies and removes inconsistent overlaps (next Section) in the string graph, and then generates two sets of contigs in primary/alternate format or dual assembly format. After generating contigs, we use corrected reads (CLR data) or raw reads (Nanopore data) to polish them to improve the quality (<bold>Methods</bold>).</p>
    </sec>
    <sec id="Sec5">
      <title>Identification of inconsistent overlaps</title>
      <p id="Par14">The inconsistent overlaps connect reads from different haplotypes or different copies of the segmental duplication in the overlap graph. They cause haplotype switch errors or unresolved repeats (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). After identifying and filtering out inconsistent overlaps, only the overlaps between reads from the same haplotype or the same copies of the segmental duplication are left, and then the assembler can naturally generate contigs of two haplotypes. Since our corrected reads contain allele information, we may use the SNP allele information to identify inconsistent overlaps. If the SNP alleles on a pair of reads are different, these two reads should come from different haplotypes and the overlaps between them should be inconsistent. At the error correction step, we have scored the possibility that two raw reads come from the same haplotype. However, the accuracy of the previous scoring that is based on the alignments between two raw reads cannot meet the requirements for identifying inconsistent overlaps. Therefore, we developed a read-level SNP caller and a read grouping method for identifying inconsistent overlaps.</p>
      <p id="Par15">First, we map all corrected reads onto the haplotype-collapsed contigs from the first round of assembly using minimap2<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. We call the heterozygous SNP sites based on the base frequency of the alignments (<bold>Methods</bold>). Then, we set each read as a template read and collect a set of reads that have the common SNP sites with it. We cluster the set of reads according to the SNP alleles in reads. The reads from the same haplotype are more likely to be clustered into the same subgroup. We then verify and correct the SNP alleles in the template read using other reads in the same subgroups. After identifying SNP alleles in each read, we remove the inconsistent overlaps using the SNP information from the candidate overlaps found in the first round of assembly. Then, we construct the string graph again. For high heterozygosity genome regions (&gt;= 0.0005), this inconsistent overlap identification approach works well due to the high accuracy of SNPs in corrected reads. However, for low heterozygosity genome regions (&lt; 0.0005), the SNP caller using corrected reads only can not achieve high performance in inconsistent overlap identification as the accuracy of SNPs is decreased dramatically in corrected reads for those genome regions. Therefore, we combine raw reads to identify and filter inconsistent overlaps. We first use corrected reads to identify inconsistent overlaps. Then, we call SNPs using raw reads and identify inconsistent overlaps again (<bold>Methods</bold>). For Nanopore reads, we have used Clair3<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> to call heterozygous SNP sites. For PacBio CLR reads, we do not have a tool to call SNPs from raw reads now.</p>
      <p id="Par16">We evaluate the performance of the inconsistent overlaps identification method using the haplotype reads classified by the trio-binning algorithm<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. As shown in Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>, compared with the first round of assemblies, the percentages of inconsistent overlaps in simplified graphs of the second round of assemblies of diploid datasets <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison × Simmental) and HG002 decrease sharply. The percentages of inconsistent overlaps have decreased from 36.98%, 16.00%, 15.94%, 36.55%, 16.62%, 18.08%, and 37.45% in the first round of assemblies to 0.32%, 0.57%, 0.90%, 0.63%, 0.79%, 0.03%, and 1.09% in the second round of assemblies, respectively. For the three Nanopore datasets, we compare the performance of the method using corrected reads, raw reads, and both (Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>). Using both raw and corrected reads, we get lower percentages of inconsistent overlaps in simplified graphs of the second round of assemblies of all three Nanopore datasets. The high performance of the inconsistent overlap identification method ensures that PECAT can generate the haplotype-specific contigs effectively. After filtering inconsistent overlaps, collapsed regions in the first round of assembly are separated in the second round of assembly. The sizes of alternate contigs are close to their corresponding reference genome in the second round of assembly (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>).</p>
      <p id="Par17">Moreover, our inconsistent overlap identification method can also help solve nearly identical repeats without knowing the number of their copies. The clustering step can automatically separate nearly identical repeats if there are SNPs that can divide the repeats. After filtering out the inconsistent overlaps at the repeats, PECAT can solve the repeat to generate contiguous contigs in the second round of assembly. As a result, PECAT achieves more contiguous assemblies in the second round of assembly on most of our diploid datasets (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>). As shown in Supplementary Figs. <xref rid="MOESM1" ref-type="media">3</xref> and <xref rid="MOESM1" ref-type="media">4</xref>, PECAT perfectly solves repeats in the NCTC9024 and NCTC9006 datasets and reconstructs two circle contigs, while other assemblers obtain fragment results<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR37">37</xref></sup>.</p>
    </sec>
    <sec id="Sec6">
      <title>Performance of PECAT error correction method</title>
      <p id="Par18">We evaluate the performance of the PECAT error correction method using four PacBio diploid datasets: <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), and three Nanopore diploid datasets: <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison × Simmental), and HG002. We compare PECAT with the error correction methods in the other four tools, including Canu<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, FALCON<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, MECAT2<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, and NECAT<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> (Fig. <xref rid="Fig2" ref-type="fig">2 b–e</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref><bold>)</bold>. All methods have reported high accuracy (&gt;98.6%). We also evaluate the performance of PECAT and NECAT on the difficult-to-map regions<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> and low-complexity regions of HG002 (<bold>Methods</bold>). On average, the accuracies of PECAT are 0.75% higher than those of NECAT, and the accuracy of corrected reads on these regions is similar to those on normal regions (Fig. <xref rid="Fig2" ref-type="fig">2b</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">7</xref><bold>)</bold>. We then assess the haplotype-specific k-mers completeness and consistency of corrected reads (<bold>Methods</bold>). These two metrics can evaluate the ability to retain consistent heterozygote alleles. The reads corrected by PECAT have higher completeness and consistency in all datasets (Fig. <xref rid="Fig2" ref-type="fig">2c, d</xref><bold>)</bold>. Especially, haplotype-specific k-mers consistencies of the reads corrected by PECAT are greater than or equal to 99.4% on all datasets, while haplotype-specific k-mers consistencies of the reads corrected by other methods are all less than or equal to 94.8%. The haplotype-specific k-mers completenesses of reads corrected by PECAT are also higher than those of reads corrected by other methods, especially for three Nanopore datasets. We plot the raw read and corrected reads using haplotype-specific k-mers for the seven datasets. As shown in Fig. <xref rid="Fig2" ref-type="fig">2e</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">5</xref>–<xref rid="MOESM1" ref-type="media">10</xref>, PECAT effectively avoids mixing heterozygous alleles from two haplotypes and its corrected reads tend to contain only one type of haplotype-specific k-mer. In summary, the reads corrected by PECAT contain more haplotype-specific k-mers than those corrected by other methods.</p>
    </sec>
    <sec id="Sec7">
      <title>Performance of PECAT assembler</title>
      <p id="Par19">We also assess the performance of the PECAT assembler using four PacBio diploid datasets: <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), and three Nanopore diploid datasets: <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison × Simmental) and HG002. We compare PECAT with four diploid genome assembly pipelines: Canu<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>+purge_dups<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, FALCON-Unzip<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, Flye<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>+HapDup<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR40">40</xref></sup>, and Shasta<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref><bold>)</bold>. We evaluate assembled genomes with respect to the assembly size, contiguity (contig NG50 and phase block NG50), and qualities (BUSCO<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, the base quality using pomosix (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/pomoxis">https://github.com/nanoporetech/pomoxis</ext-link>) and merqury<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>, ‘Intra-block switch error’ from merqury, and the hamming error rate). (<bold>Methods</bold>).</p>
      <p id="Par20">For four PacBio CLR datasets, all pipelines output the contigs in primary/alternate format. As shown in Table <xref rid="Tab1" ref-type="table">1</xref>, the sizes of both primary and alternate contigs of all four assemblies are close to those of their corresponding reference genome, except the alternate contigs of <italic>S. cerevisiae</italic> (SK1×Y12) genome assembled by Canu+Purge_dups. Compared to the other two pipelines, PECAT obtains the highest NG50 with 0.8/0.8, 14.3/7.8, 24.5/11.9, and 72.4/2.8 Mb and the highest ‘phase block NG50’ with 0.8/0.8, 12.1/7.4, 16.1/11.8, 4.5/2.4 Mb for all four assemblies. As shown in Supplementary Figs. <xref rid="MOESM1" ref-type="media">11</xref>–<xref rid="MOESM1" ref-type="media">14</xref>, the alternate contigs generated by all pipelines are haplotigs. Unlike the other two pipelines, most primary contigs by PECAT are also haplotigs except those of <italic>B. taurus</italic> (Angus×Brahman). These results are consistent with the results of the ‘Hamming error’, where the ‘Hamming error’ of primary contigs of <italic>B. taurus</italic> (Angus×Brahman) is exceptionally high. All pipelines have similar ‘Quality’ and BUSCO scores, except that Canu+Purge_dups has low BUSCO scores on alternate contigs of <italic>S. cerevisiae</italic>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance comparison of assembly on PacBio CLR datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Pipeline</th><th>Size (Mb)</th><th>NG50 (Mb)</th><th>Quality (reference-based)</th><th>Quality (k-mer- based)</th><th>BUSCO (%)</th><th>Hamming error (%)</th><th>Phase block NG50 (Mb)</th><th>Intra-block switch error (%)</th></tr></thead><tbody><tr><td rowspan="4"><p><italic>S. cerevisiae</italic></p><p>SK1×Y12</p><p>200X</p></td><td>Ref</td><td>12.1/12.0</td><td>0.9/0.9</td><td>–/–</td><td>47.3/49.4</td><td>99.6/99.6</td><td>0.13/0.03</td><td>0.9/0.9</td><td>0.13/0.03</td></tr><tr><td>Canu + Purge_dups</td><td>12.4/4.8</td><td>0.8/0.0</td><td>25.6/30.5</td><td>38.9/36.2</td><td>98.7/28.1</td><td>39.24/6.25</td><td>0.0/0.0</td><td>9.92/4.50</td></tr><tr><td>FALCON-Unzip</td><td>12.1/11.1</td><td>0.8/0.4</td><td>40.5/42.2</td><td>44.5/45.0</td><td>99.4/95.8</td><td>21.58/0.98</td><td>0.5/0.4</td><td>0.40/0.22</td></tr><tr><td>PECAT</td><td>12.3/11.8</td><td>0.8/0.8</td><td>35.9/36.0</td><td>39.1/39.7</td><td>96.0/93.8</td><td>1.65/0.49</td><td>0.8/0.8</td><td>0.16/0.09</td></tr><tr><td rowspan="4"><p><italic>A. thaliana</italic></p><p>Col-0×Cvi-0</p><p>164X</p></td><td>Ref</td><td>133.3/119.7</td><td>26.2/23.20</td><td>–/–</td><td>Inf/Inf</td><td>99.3/99.2</td><td>0.12/0.01</td><td>12.1/23.2</td><td>0.11/0.01</td></tr><tr><td>Canu + Purge_dups</td><td>129.1/122.6</td><td>6.7/0.1</td><td>28.0/30.4</td><td>24.8/30.7</td><td>98.7/81.7</td><td>37.52/2.65</td><td>0.1/0.1</td><td>2.81/2.45</td></tr><tr><td>FALCON-Unzip*</td><td>140.0/104.9</td><td>8.0/4.3</td><td>40.0/40.0</td><td>30.0/34.9</td><td>98.9/93.6</td><td>15.11/0.98</td><td>3.1/2.4</td><td>0.15/0.19</td></tr><tr><td>PECAT</td><td>130.6/120.4</td><td>14.3/7.8</td><td>34.6/34.7</td><td>25.3/33.2</td><td>98.3/98.2</td><td>2.64/0.21</td><td>12.6/7.8</td><td>0.13/0.13</td></tr><tr><td rowspan="4"><p><italic>D. melanogaster</italic></p><p>ISO1×A4</p><p>200X</p></td><td>Ref</td><td>143.7/140.7</td><td>25.3/25.0</td><td>–/–</td><td>46.5/46.3</td><td>98.7/98.7</td><td>0.06/0.02</td><td>25.3/24.6</td><td>0.06/0.02</td></tr><tr><td>Canu + Purge_dups*</td><td>143.2/129.7</td><td>16.1/0.3</td><td>33.6/34.7</td><td>35.4/35.3</td><td>98.5/87.3</td><td>43.50/3.97</td><td>0.4/0.3</td><td>3.92/3.01</td></tr><tr><td>FALCON-Unzip</td><td>189.7/105.9</td><td>4.0/0.4</td><td>40.5/40.5</td><td>37.1/37.4</td><td>98.8/84.0</td><td>29.31/5.38</td><td>1.0/0.3</td><td>0.34/0.41</td></tr><tr><td>PECAT</td><td>149.6/135.7</td><td>24.5/11.9</td><td>38.5/39.2</td><td>40.8/43.5</td><td>98.7/96.7</td><td>3.00/0.07</td><td>16.1/11.8</td><td>0.05/0.04</td></tr><tr><td rowspan="3"><p><italic>B. taurus</italic></p><p>Angus×Brahman</p><p>135X</p></td><td>Ref</td><td>2580.8/2681.0</td><td>91.1/104.5</td><td>–/–</td><td>43.3/43.8</td><td>93.6/95.6</td><td>0.10/0.04</td><td>21.8/30.5</td><td>0.08/0.03</td></tr><tr><td>FALCON-Unzip*</td><td>2713.4/2453.7</td><td>31.4/2.0</td><td>39.2/38.5</td><td>39.4/39.0</td><td>95.4/86.3</td><td>28.15/1.97</td><td>3.2/1.8</td><td>0.21/0.22</td></tr><tr><td>PECAT</td><td>2744.7/2447.6</td><td>72.4/2.8</td><td>34.6/34.6</td><td>39.9/40.1</td><td>94.8/87.0</td><td>29.46/0.47</td><td>4.5/2.4</td><td>0.10/0.09</td></tr></tbody></table><table-wrap-foot><p>‘Size’ is the total number of base pairs in all contigs generated by assemblers. ‘NG50’ is the length of the shortest contig for which longer and equal length contigs cover at least 50 of genome size. The genome sizes of <italic>S. cerevisiae, A. thaliana, D. melanogaster</italic>, and <italic>B. taurus</italic> that we used for evaluation are 12 M, 130 M, 140 M, and 2.7 G, respectively. ‘BUSCO’ is gene completeness evaluated by BUSCO. ‘Quality (reference-based)’ is the metric ‘q50’ evaluated by Pomoxis. ‘Hamming error’ is the fraction of nondominant parental-specific k-mers in a contig. ‘Quality (k-mer-based)’, ‘Phase block NG50’, and ‘Intra-block switch error’ are evaluated by mercury. All assemblies are in primary/alternate format. The primary and alternate contigs are separately reported in each cell. ‘Ref’ is the reference genome. The sources of the reference genomes are illustrated in Supplementary Table <xref rid="MOESM1" ref-type="media">17</xref>. For <italic>B. taurus</italic>, Canu didn’t finish the assembly in 3 weeks, so it is excluded. Asterisks mark previously published assemblies.</p></table-wrap-foot></table-wrap></p>
      <p id="Par21">For three Nanopore datasets, Canu+Purge_dups and Shasta output the contigs in primary/alternate format, Flye+HapDup outputs the contigs in dual assembly format and PECAT can output both formats. As shown in Table <xref rid="Tab2" ref-type="table">2</xref>, the sizes of both two sets of contigs of all three assemblies are close to their corresponding reference genome, except the <italic>A. thaliana</italic> (Col-0×C24) genomes assembled by Canu+Purge_dups. Compared to other pipelines, PECAT obtains higher NG50 for three genomes. The phase block NG50 reported by PECAT is at least 10 times higher than those reported by other pipelines for <italic>A. thaliana</italic> (Col-0×C24) and <italic>B.taurus</italic> (Bison×Simmental). Especially, PECAT reports the assembly with phase block NG50 of 79.6/86.1 Mb for <italic>B. taurus</italic> (Bison×Simmental), which exceeds the assembly with phase block N50 of 68.5/70.6 Mb reported by the trio-binning method using additional parental reads<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. Meanwhile, for HG002, PECAT reports higher phase block NG50 than that reported by Flye+HapDup, both are at least 25 times higher than that reported by Shasta. PECAT reports smaller Intra-block switch error and Hamming error on <italic>A. thaliana</italic> (Col-0×C24) and <italic>B. taurus</italic> (Bison×Simmental). Most of the contigs reported by PECAT on <italic>A. thaliana</italic> (Col-0×C24) and <italic>B. taurus</italic> (Bison × Simmental) are haplotigs (Fig. <xref rid="Fig3" ref-type="fig">3a</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">15</xref>). For HG002, PECAT and Flye+HapDup report similar Intra-block switch errors, and both are much less than those reported by Shasta. Although PECAT and Flye+HapDup reported smaller Hamming errors than that reported by Shasta, their reported Hamming error rates are high, which may be because some low heterozygosity regions of HG002 are not successfully phased. Moreover, most contigs reported by Flye+HapDup and PECAT on HG002 are not haplotigs (Supplementary Figs. <xref rid="MOESM1" ref-type="media">16</xref>,<xref rid="MOESM1" ref-type="media">17</xref>).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance comparison of assembly on Nanopore and PacBio HiFi datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Pipeline</th><th>Size (Mb)</th><th>NG50 (Mb)</th><th>Quality (reference-based)</th><th>Quality (k-mer-based)</th><th>BUSCO (%)</th><th>Hamming error (%)</th><th>Phase block NG50 (Mb)</th><th>Intra-block<break/>switch error (%)</th></tr></thead><tbody><tr><td rowspan="6"><p><italic>A. thaliana</italic></p><p>Col-0 × C24</p><p>ONT, 106X</p></td><td>Ref</td><td>133.3/119.2</td><td>26.2/23.8</td><td>–/–</td><td>44.7/44.0</td><td>99.3/99.1</td><td>0.14/0.01</td><td>12.7/23.8</td><td>0.15/0.02</td></tr><tr><td><p>Canu +</p><p>Purge_dups (pri/alt)</p></td><td>125.9/68.3</td><td>8.1/0.0</td><td>22.0/23.5</td><td>29.8/28.7</td><td>96.6/37.4</td><td>37.95/7.02</td><td>0.1/0.0</td><td>8.33/5.71</td></tr><tr><td>Flye + HapDup (dual)</td><td>136.4/136.5</td><td>2.1/2.1</td><td>25.6/25.0</td><td>28.5/28.3</td><td>97.8/97.8</td><td>11.85/13.62</td><td>0.5/0.5</td><td>0.66/0.67</td></tr><tr><td>Shasta (pri/alt)</td><td>126.3/105.0</td><td>0.8/0.5</td><td>22.4/23.8</td><td>28.9/30.6</td><td>94.9/92.2</td><td>11.75/7.96</td><td>0.3/0.3</td><td>7.11/5.39</td></tr><tr><td>PECAT (pri/alt)</td><td>131.2/123.9</td><td>14.3/7.7</td><td>30.2/30.6</td><td>31.4/32.1</td><td>98.5/98.2</td><td>3.18/0.32</td><td>9.1/7.1</td><td>0.35/0.36</td></tr><tr><td>PECAT (dual)</td><td>131.1/125.1</td><td>14.3/14.0</td><td>30.4/30.7</td><td>31.6/32.2</td><td>98.6/98.4</td><td>1.07/0.38</td><td>7.8/7.9</td><td>0.37/0.37</td></tr><tr><td rowspan="5"><p><italic>B. taurus</italic></p><p>Bison × Simmental</p><p>ONT, UL, 200X</p></td><td>Ref</td><td>2651.6/2861.7</td><td>87.8/104.4</td><td>–/–</td><td>38.7/36.1</td><td>93.1/95.7</td><td>0.67/0.48</td><td>87.8/104.4</td><td>0.74/0.61</td></tr><tr><td>Flye + HapDup (dual)</td><td>2713.0/2713.2</td><td>33.4/33.4</td><td>25.0/25.0</td><td>28.5/28.4</td><td>83.4/83.3</td><td>6.52/6.57</td><td>8.2/8.1</td><td>0.44/0.44</td></tr><tr><td>Shasta (pri/alt)</td><td>2815.7/2406.9</td><td>0.3/0.2</td><td>15.1/15.1</td><td>22.9/24.0</td><td>61.3/59.1</td><td>22.05/25.65</td><td>0.1/0.1</td><td>23.26/25.79</td></tr><tr><td>PECAT (pri/alt)</td><td>2968.2/2770.0</td><td>94.3/93.8</td><td>25.6/25.6</td><td>28.8/28.5</td><td>83.6/83.1</td><td>0.39/0.38</td><td>79.6/86.1</td><td>0.37/0.38</td></tr><tr><td>PECAT (dual)</td><td>2970.2/2856.3</td><td>94.3/93.8</td><td>25.5/25.6</td><td>28.8/28.8</td><td>83.3/83.4</td><td>0.39/0.38</td><td>79.5/86.1</td><td>0.37/0.39</td></tr><tr><td rowspan="5"><p>HG002</p><p>ONT, R9, UL 59X</p></td><td>Ref</td><td>2959.3/3061.7</td><td>146.7/154.4</td><td>–/–</td><td>58.6/59.4</td><td>92.8/95.8</td><td>0.15/0.08</td><td>90.4/106.7</td><td>0.02/0.03</td></tr><tr><td>Flye+ HapDup (dual)</td><td>2932.2/2932.4</td><td>49.9/49.9</td><td>33.2/33.2</td><td>40.9/40.8</td><td>94.2/94.1</td><td>7.91/8.24</td><td>20.5/19.6</td><td>0.08/0.09</td></tr><tr><td>Shasta (pri/alt)</td><td>3007.0/2443.9</td><td>24.2/2.9</td><td>28.8/30.1</td><td>34.7/38.5</td><td>92.4/79.6</td><td>18.93/11.42</td><td>0.8/0.5</td><td>8.66/5.36</td></tr><tr><td>PECAT (pri/alt)</td><td>3059.3/2857.7</td><td>92.9/15.0</td><td>30.8/30.8</td><td>41.8/41.6</td><td>94.7/91.0</td><td>15.72/1.48</td><td>22.2/13.0</td><td>0.08/0.11</td></tr><tr><td>PECAT (dual)</td><td>3057.2/2927.2</td><td>92.7/74.5</td><td>30.8/30.8</td><td>41.8/41.8</td><td>94.6/91.6</td><td>9.67/10.98</td><td>30.8/23.6</td><td>0.08/0.11</td></tr><tr><td rowspan="4"><p>HG002</p><p>ONT, R10,</p><p>UL, 116X</p></td><td>Flye+ HapDup (dual)</td><td>2954.7/2952.1</td><td>61.9/59.3</td><td>36.4/36.2</td><td>48.9/48.2</td><td>95.8/95.7</td><td>3.13/3.02</td><td>46.5/39.1</td><td>0.02/0.03</td></tr><tr><td>Shasta (pri/alt)</td><td>3095.4/2729.9</td><td>45.3/33.8</td><td>34.3/34.4</td><td>42.1/48.7</td><td>95.7/92.2</td><td>3.05/0.86</td><td>17.2/15.4</td><td>0.30/0.44</td></tr><tr><td>PECAT (pri/alt)</td><td>3159.7/2895.6</td><td>91.4/59.9</td><td>38.0/38.0</td><td>49.0/50.1</td><td>95.8/92.4</td><td>3.75/0.30</td><td>59.4/58.0</td><td>0.04/0.05</td></tr><tr><td>PECAT (dual)</td><td>3153.4/2917.8</td><td>91.4/80.2</td><td>38.0/38.0</td><td>49.2/50.0</td><td>95.8/92.7</td><td>2.99/1.49</td><td>63.8/59.2</td><td>0.04/0.06</td></tr><tr><td rowspan="3">HG002 HiFi, 36X</td><td>Hifiasm (pri/alt) *</td><td>3112.2/2910.3</td><td>89.9/0.4</td><td>50.0/50.0</td><td>55.3/56.5</td><td>95.6/77.0</td><td>24.38/1.67</td><td>1.1/0.3</td><td>0.11/0.01</td></tr><tr><td>Hifiasm (dual) *</td><td>3015.3/3077.5</td><td>44.8/64.5</td><td>50.0/50.0</td><td>54.9/57.8</td><td>95.5/94.9</td><td>34.80/24.10</td><td>1.0/1.0</td><td>0.16/0.11</td></tr><tr><td>Hifiasm (Hi-C) *</td><td>3075.0/2908.7</td><td>55.1/55.1</td><td>50.0/50.0</td><td>54.9/57.9</td><td>95.7/92.5</td><td>0.45/0.25</td><td>20.6/20.4</td><td>0.09/0.06</td></tr></tbody></table><table-wrap-foot><p>‘Size’ is the total number of base pairs in all contigs generated by assemblers. ‘NG50’ is the length of the shortest contig for which longer and equal length contigs cover at least 50 of genome size. The genome sizes of <italic>A. thaliana</italic>, <italic>B. taurus</italic>, and HG002 that we used for evaluation are 130 M, 2.7 G, and 3 G, respectively. ‘BUSCO’ is gene completeness evaluated by BUSCO. ‘Hamming error’ is the fraction of nondominant parental-specific k-mers in a contig. ‘Quality (reference-based)’ is the metric ‘q50’ evaluated by Pomoxis. ‘Quality (k-mer-based)’, ‘Phase block NG50’, and ‘Intra-block switch error’ are evaluated by mercury. ‘pri/alt’ represents primary/alternate assembly format. ‘dual’ represents dual assembly format. ‘ONT’ indicates the dataset is composed of Nanopore reads. ‘UL’ indicates the reads are ultra-long reads. ‘HiFi’ indicates the dataset is composed of PacBio HiFi reads. ‘Hi-C’ represents that the assembly uses the additional Hi-C reads. The two sets of contigs are separately reported in each cell. ‘Ref’ is the reference genome. The sources of the reference genomes are illustrated in Supplementary Table <xref rid="MOESM1" ref-type="media">17</xref>. For <italic>B. taurus</italic> and HG002, Canu didn’t finish the assembly in 3 weeks, so it is excluded. Asterisks mark previously published assemblies.</p></table-wrap-foot></table-wrap><fig id="Fig3"><label>Fig. 3</label><caption><title>Performance comparison of assembly.</title><p><bold>a</bold> Haplotype-specific k-mer blob plots of the <italic>B. taurus</italic> (Bison × Simmental) reference genome and assemblies by Flye+HapDup, Shasta, and PECAT. pri/alt or dual represents that the assembly is the primary/alternate format or the dual assembly format. Each blob corresponds to a contig. The coordinate of the blob gives the count of the parental specific k-mers in the contig, where k is 21. Blob size is proportional to contig length. <bold>b</bold> Precisions and recalls of small variants (SNP, INDEL) and structural variants (SV) in HG002 assemblies. <bold>c</bold> Genome fraction of the assemblies, which are evaluated by QUAST.</p></caption><graphic xlink:href="41467_2024_47349_Fig3_HTML" id="d33e1971"/></fig></p>
      <p id="Par22">For the metrics ‘Quality’ and BUSCO score, Shasta reports the lowest scores on all three Nanopore datasets, while Flye+HapDup and PECAT report similar scores on <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison×Simmental) and HG002, except that the BUSCO scores of the alternate contigs/the haplotype 2 contigs reported by PECAT are slightly lower than those reported by Flye+HapDup (91.0%/91.6% vs. 94.1%). The main reason for this difference is that PECAT places the contigs of X and Y chromosomes in the primary contigs or the haplotype 1 contigs while Flye+HapDup outputs two copies of contigs of X and Y chromosomes to two sets of assemblies at the same time. We remove the contigs of X and Y chromosomes in the assemblies of Flye+HapDup (dual) and PECAT (dual). The BUSCO scores of the assembly by Flye+HapDup (dual) are reduced from 94.2%/94.1% to 91.2%/91.1%, while the BUSCO scores of the assembly by PECAT (dual) are reduced from 94.6%/91.6% to 91.6%/91.5%, which are similar to those reported by Flye+HapDup (dual).</p>
      <p id="Par23">We also compare the HG002 genome assembled using Nanopore reads by PECAT with those using HiFi reads by Hifiasm<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>. The long Nanopore reads can help the assemblers to obtain longer phased blocks. PECAT reports much longer NG50 and phase block NG50 than those reported by Hifiasm using HiFi reads only, even longer than those reported by Hifiasm using both HiFi reads and Hi-C reads. The Intra-block switch errors reported by PECAT are similar to those reported by Hifiasm. On the other hand, the high-quality HiFi reads allow Hifiasm to report higher base qualities of assemblies with better ‘Quality’ scores. Moreover, Hifiasm reports higher Hamming errors when using HiFi reads only. However, with the help of Hi-C data, Hifiasm reported a much smaller Hamming error and almost all contigs are haplotigs (Supplementary Figs. <xref rid="MOESM1" ref-type="media">16</xref>,<xref rid="MOESM1" ref-type="media">17</xref><bold>)</bold>. We then evaluate the small variants (SNP, INDEL) and the structural variants (SV) in HG002 assemblies against the GIAB benchmark (<bold>Methods</bold>). As shown in Fig. <xref rid="Fig3" ref-type="fig">3b</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>, the precisions and recalls of SNP and SV of genomes assembled by Flye+HapDup and PECAT using Nanopore reads are similar to those of genomes assembled by Hifiasm using HiFi reads. However, the precisions and recalls of INDEL of genomes assembled by Flye+HapDup and PECAT using Nanopore read is much less than those of genomes assembled by Hifiasm using HiFi reads, which is consistent with the previous finding<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>.</p>
      <p id="Par24">In the second round of assembly of PECAT, it reassembles the filtered string graph, which will help correct errors or collapsed regions in the first round of assembly. As shown in Fig. <xref rid="Fig3" ref-type="fig">3c</xref> and Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>, PECAT reports higher ‘Genome fraction’ values than those reported by other pipelines. We then map the HG002 reference genome and HG002 assemblies to GRCh38. As an example (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), the region [130,005,418, 130,116,766] in chromosome 3 includes the gene EVA1CP6 and has a large INDEL with a length of about 43,365 bp between the parental reference genomes. Both PECAT and Hifiasm reconstruct the INDEL in their assemblies, but Flye+HapDup (dual) fails. This large INDEL cannot be preserved in the haplotype-collapsed contigs in the first round of assembly and reads from another haplotype may not be mapped onto the haplotype-collapsed contigs. Therefore, it is difficult for the polish-based assemblies, such as Flye+HapDup, to restore the INDEL in the second round of assembly, which may be the reason that Flye+Hapdup reports lower Genome fraction scores than those reported by PECAT (Fig. <xref rid="Fig3" ref-type="fig">3c</xref> and Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>) on three Nanopore datasets.<fig id="Fig4"><label>Fig. 4</label><caption><title>Screenshot of HG002 reference, assembly and read alignment to GRCh38.</title><p>It shows the range of [130,005,418, 130,116,766] in chromosome 3. Small INDELs in all alignments and mismatches in read alignments are not shown. Paternal reference and maternal reference are HG002 paternal references. The assemblies by Flye, Flye+HapDup, and PECAT are from Nanopore reads. The assembly by Hifiasm is from HiFi reads. The assembly by Flye is haplotype-collapsed contigs. The other assemblies are in the dual assembly format. The two sets of contigs are labeled as haplotype 1 and haplotype 2.</p></caption><graphic xlink:href="41467_2024_47349_Fig4_HTML" id="d33e2036"/></fig></p>
      <p id="Par25">We further compare the computational resources required by each pipeline (Supplementary Table <xref rid="MOESM1" ref-type="media">9</xref>, <xref rid="MOESM1" ref-type="media">10</xref><bold>)</bold>. Canu on <italic>B. taurus</italic> (Angus×Brahman), <italic>B. taurus</italic> (Bison×Simmental), and HG002, FALCON-Unzip on <italic>B. taurus</italic> (Angus×Brahman) are excluded for comparison since the assemblies are not constructed within three weeks. PECAT is at least 8.7 times faster than traditional correct-then-assemble pipelines, such as Canu+purge_dups and FALCON-Unzip. But it’s slower than assemble-then-correct pipelines, such as Shasta and Flye+HapDup. The peaks of memory usage and disk space usage of PECAT are also recorded in Supplementary Table <xref rid="MOESM1" ref-type="media">10</xref>.</p>
    </sec>
    <sec id="Sec8">
      <title>Performance on highly accurate long reads</title>
      <p id="Par26">With the development of sequencing technology, the accuracy of long reads has greatly improved recently<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR45">45</xref></sup>. We evaluate the performance of PECAT using Nanopore R10 sequencing (ultra-long), Nanopore R10 duplex sequencing and PacBio HiFi sequencing reads. The accuracy of 40X longest reads for those datasets is 98.25%, 99.67%, and 99.77% (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>), respectively, which are much higher than the accuracy of the Nanopore R9 (ultra-long) dataset (94.97%). However, there are still less accurate reads in those datasets and PECAT error correction can still improve the qualities of those reads, except for a 0.1–0.2% decrease in the metric “Completeness” (Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>). The Nanopore R10 (ultra-long) dataset with higher accuracy and longer read length improves the assemblies of all pipelines (Table <xref rid="Tab2" ref-type="table">2</xref>). Compared with the assemblies from the Nanopore R9 (ultra-long) dataset (Table <xref rid="Tab2" ref-type="table">2</xref>), the assemblies from the Nanopore R10 (ultra-long) dataset have higher QV when evaluated by pomoxis and merqury. Especially, the assembly of PECAT from the Nanopore R10 (ultra-long) dataset has the highest phase block NG50 with 59.4/58.0 Mb in primary/alternate format and with 63.8/59.2 Mb in dual format, which is twice as much as those of assembly of PECAT from Nanopore R9 (ultra-long) data. Furthermore, the assemblies from the Nanopore R10 (ultra-long) dataset report one magnitude smaller Hamming error and more contigs in this assembly are haplotigs (Supplementary Figs. <xref rid="MOESM1" ref-type="media">19</xref>, <xref rid="MOESM1" ref-type="media">20</xref>). Similar to the Nanopore R9 (ultra-long) dataset, the assembly of PECAT from the Nanopore R10 (ultra-long) dataset outperforms those of Flye+HapDup and Shasta in terms of NG50 and phase block NG50. Meanwhile, the assemblies for the Nanopore R10 duplex and PacBio HiFi datasets (Supplementary Table <xref rid="MOESM1" ref-type="media">12</xref>) have less NG50 and phase block NG50 than those of assembly from the Nanopore R9 (ultra-long) dataset (Table <xref rid="Tab2" ref-type="table">2</xref>), although have higher quality measures. Moreover, less amount of contigs of assemblies of Nanopore R10 duplex and PacBio HiFi reads are haplotigs (Supplementary Figs. <xref rid="MOESM1" ref-type="media">21</xref>–<xref rid="MOESM1" ref-type="media">24</xref>). This result indicated that the length of reads is more important for obtaining contiguous haplotype-specific contigs.</p>
      <p id="Par27">We then evaluate the small variants (SNP, INDEL) and the structural variants (SV) in those assemblies using Nanopore R10 sequencing (ultra-long), Nanopore R10 duplex sequencing and PacBio HiFi sequencing reads against the GIAB benchmark (Supplementary Table <xref rid="MOESM1" ref-type="media">13</xref>–<xref rid="MOESM1" ref-type="media">15</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">25</xref>–<xref rid="MOESM1" ref-type="media">27</xref>). The assemblers report similar metrics. The precisions and recalls of SNP and SV of the assemblies are similar to those of the assemblies using Nanopore R9 (ultra-long) reads (Fig. <xref rid="Fig3" ref-type="fig">3b</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>). However, the precisions and recalls of INDEL of genomes assembled from Nanopore R10 (ultra-long) reads and Nanopore R10 duplex reads are much greater than those of assemblies using R9 (ultra-long) reads, while still less than those of assemblies using HiFi reads.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par28">Although long noisy reads, especially Nanopore reads, have the advantage to generate high contiguity contigs, using them for diploid genome assembly remains a challenge. Due to the high sequencing error rate, directly phasing the raw reads and then assembling the diploid genome can not obtain high-quality assembly<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. Here, we first develop a haplotype-aware error-correct method to keep most of the heterozygote alleles while correcting sequencing errors. However, even after error corrections, it is not able to accurately call SNPs by just aligning corrected reads as the Hifiasm did for HiFi reads. PECAT then first generates a haplotype-collapsed genome and calls SNPs by aligning the corrected reads to the haplotype-collapsed genome. Nevertheless, the accuracy of this SNP call is still low for low heterozygosity rate regions. Therefore, we use Clair3 to call SNPs again for Nanopore reads. Our experiments show that the SNPs called from raw reads complemented the SNPs called by aligning corrected reads. Combing both SNPs helps achieve the best performance.</p>
    <p id="Par29">Another advantage of our haplotype-aware error-corrected reads is to allow reuse the overlaps built in the first round of assembly and just simplify the overlaps by removing inconsistent ones before reassembling the diploid genome. This strategy is like that used in Hifiasm. Compared to methods that directly separate the collapsed contigs into two haplotypes, such as Flye+HapDup, this strategy can correct errors or collapsed regions in the first round of assembly, and then achieve better assembly.</p>
    <p id="Par30">Furthermore, PECAT does not simply phase the reads into two copies, but uses the read grouping method to separate reads from nearly identical repeats into multiple copies, which can help solve the repeats with more than two copies. Meanwhile, in order to obtain high-quality phased assembly, PECAT needs higher coverage of data. As shown in Supplementary Table <xref rid="MOESM1" ref-type="media">16</xref>, the contiguity and qualities of the assembly of HG002 using 37X Nanopore reads are less than those of assembly using 59X Nanopore reads.</p>
    <p id="Par31">Although the new generation long reads from Nanopore and PacBio have much higher accuracy, PECAT error correction can still improve their quality. PECAT can also efficiently assemble those highly accurate reads. It can leverage the advantages of read length and accuracy to obtain better assemblies. Therefore, PECAT achieve the phase block NG50 with 59.4/58.0 Mb in primary/alternate format and with 63.8/59.2 Mb in dual format only using Nanopore R10 (ultra-long) reads. However, our current error correction method may not be effective enough to distinguish small errors from heterozygote alleles in very low heterozygosity rate regions, even in highly accurate reads (Nanopore duplex and PacBio HiFi reads). Compared with the read-length advantage, PECAT does not fully take advantage of the high accuracy of reads for being compatible with long noisy reads, therefore it achieves mediocre performance on Nanopore duplex and PacBio HiFi reads (Supplementary Table <xref rid="MOESM1" ref-type="media">12</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">21</xref>–<xref rid="MOESM1" ref-type="media">24</xref>). We will resolve this issue in subsequent PECAT releases. Overall, PECAT is an efficient assembly pipeline for diploid genomes.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Diploid datasets for benchmarking</title>
      <p id="Par32">We evaluate the performance of PECAT using seven diploid datasets (Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">17</xref>): <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison×Simmental) and HG002. The first four datasets are PacBio CLR datasets and the last three are Nanopore datasets (the last two are ultra-long raw reads and the HG002 dataset is generated by Nanopore R9). The heterozygosity rate of those species is 0.85%, 1.04%, 0.84%, 1.12%, 0.83%, 1.48%, and 0.34%, respectively (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>). The accuracies of reads in those datasets are 87.80%, 88.24%, 89.58%, 86.25%, 92.33%, 89.12%, and 94.97%, respectively. (Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref>). In addition, we evaluate the performance of PECA on more accurate datasets, i.e., other three HG002 datasets using Nanopore R10 sequencing (ultra-long), Nanopore R10 duplex sequencing and PacBio HiFi sequencing, separately. Their accuracies are 98.25%, 99.67%, and 99.77% (Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>). For each of the above data, PECAT and NECAT extract the longest 80X raw reads or all reads, if the dataset is less than 80X, for error correction and assembly. Canu corrects the longest 100X raw reads for assembly. Other tools use all raw reads for error correction or assembly (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>).</p>
    </sec>
    <sec id="Sec12">
      <title>Haplotype-aware error correction</title>
      <p id="Par33">The PECAT error correction method is based on the partial-order alignment (POA) graph method<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR47">47</xref></sup>. Instead of assigning the same weight to each read for error correction, we select reads more likely coming from the same haplotype or the same copy of the nearly identical repeat and assign different weights to prevent heterozygotes in reads from being eliminated as sequencing errors. First, we find candidate overlaps between raw reads using minimap2 with parameters “-x ava-pb” for PacBio CLR reads and parameters “-x ava-ont” for Nanopore reads. For each template read to be corrected, we collect a group of supporting reads that have candidate overlaps with the template read. Then, we perform pairwise alignment between the template read and each supporting read using diff<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> or edlib<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> algorithm and build a POA graph based on the alignments of the reads as shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>. Each node in the graph is labeled by a triple value <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(c,r,{b})$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq8.gif"/></alternatives></inline-formula>, corresponding a base pair in the alignment. <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M18"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq9.gif"/></alternatives></inline-formula> is the location at the template read, <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M20"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq10.gif"/></alternatives></inline-formula> means the number of consecutive insertions (if <italic>r</italic> = 0, there is a match, a mismatch, or a deletion), and <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b$$\end{document}</tex-math><mml:math id="M22"><mml:mi>b</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq11.gif"/></alternatives></inline-formula> is the base on the supporting read or a deletion, which is one of <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{\prime} {A}^{{\prime} }{,}^{{\prime} }{C}^{{\prime} }{,}^{{\prime} }{G}^{{\prime} }{,}^{{\prime} }{T}^{{\prime} }{,}^{{\prime} }{-}^{{\prime} }\}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>′</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq12.gif"/></alternatives></inline-formula>. Each edge in the graph means two base pairs of their nodes appearing continuously in the alignment. The support count of each edge is defined as the number of alignments which pass the edge. For the convenience of analysis, we add a trivial alignment between the template read and itself to the graph. According to our observations, for each location <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M26"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq13.gif"/></alternatives></inline-formula>, all paths in the graph must only pass one of the nodes <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{\left(c,0,{b}_{i}\right),{b}_{i}\in \left({\prime} {A}^{{\prime} }{,}^{{\prime} }{C}^{{\prime} }{,}^{{\prime} }{G}^{{\prime} }{,}^{{\prime} }{T}^{{\prime} }{,}^{{\prime} }{-}^{{\prime} }\right)\}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo>′</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq14.gif"/></alternatives></inline-formula>. If these nodes have more than one in-edge with large support counts, there may be heterozygotes rather than random sequencing errors (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1 b</xref><bold>)</bold>. Therefore, we compute the support count <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq15.gif"/></alternatives></inline-formula> for in-edges of the nodes. We mark an in-edge as the important one if <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}\ge \left\{\begin{array}{cc}{r}_{l}\cdot S &amp; S\le {S}_{l}\\ \frac{{r}_{h}\cdot {S}_{h}-{r}_{l}\cdot {S}_{l}}{{S}_{h}-{S}_{l}}\cdot \left(S-{S}_{l}\right)+{r}_{l}\cdot {S}_{l} &amp; {S}_{l} &lt; S\le {S}_{h}\\ {r}_{h}\cdot S &amp; {S}_{h} &lt; S\end{array}\right.$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>S</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>S</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>S</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>S</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>S</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>S</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq16.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S=\sum {s}_{i}$$\end{document}</tex-math><mml:math id="M34"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq17.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{l}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq18.gif"/></alternatives></inline-formula>, <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{h}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq19.gif"/></alternatives></inline-formula>, <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{l}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq20.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{h}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq21.gif"/></alternatives></inline-formula> are user-set parameters (the default values are 0.5, 0.2, 10, and 200). We mark a location <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M44"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq22.gif"/></alternatives></inline-formula> as the important one if (1) there is no homopolymer at location <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M46"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq23.gif"/></alternatives></inline-formula>, (2) there are two or more important in-edges and a bubble structure which can be detected along the reverse direction of the in-edges, (3) more than half of the reads through the important in-edge pass the corresponding path in the bubble, (4) there is not an INDEL variant between the sequences represented by the paths in the bubble. Then, we calculate a score for each supporting read based on whether the supporting read and the template read pass the same important in-edges at important locations. We increase the score by 1 if a supporting read passes the same important in-edge as template read and decrease it by 1 if the supporting read and the template read pass the different important in-edges (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1 c</xref>). For uniformity, the score is divided by the number of important locations in the supporting read. As shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">1 d</xref>, the histogram of scores shows two or more peaks if the supporting reads come from different haplotypes or different copies of the segmental duplication. We select the reads whose scores fall into the first peak for error correction. If there is only one peak, we select half of the supporting reads with larger scores. We linearly map the scores of selected reads to a range, which is <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[0.4,0.8]$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0.4</mml:mn><mml:mo>,</mml:mo><mml:mn>0.8</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq24.gif"/></alternatives></inline-formula> by default, as the final weights of supporting reads. The weight of each edge is the sum of the weights of selected supporting reads that pass the edge.</p>
      <p id="Par34">Finally, we find the path in the POA graph to generate a consensus for the template read. For each node <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v$$\end{document}</tex-math><mml:math id="M50"><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq25.gif"/></alternatives></inline-formula> labeled by the triple value <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(c,r,b)$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq26.gif"/></alternatives></inline-formula>, if it has <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M54"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq27.gif"/></alternatives></inline-formula> in-edges <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{({u}_{i},v){|i}\le N\}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq28.gif"/></alternatives></inline-formula>, it gets the score <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{v}=\mathop{\max }\limits_{i\le N}\{{S}_{{u}_{i}}+{W}_{\left({u}_{i},v\right)}-{P}_{c}\}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq29.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{\left({u}_{i},v\right)}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq30.gif"/></alternatives></inline-formula> is the weight of the edge <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({u}_{i},v\right)$$\end{document}</tex-math><mml:math id="M62"><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq31.gif"/></alternatives></inline-formula>. In the previous work<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{c}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq32.gif"/></alternatives></inline-formula> is the half of the coverage at the location <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M66"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq33.gif"/></alternatives></inline-formula> in the template read. In our work, <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{c}=\max \left({0.4}^{r},0.3\right)*{W}_{c}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mrow><mml:mn>0.4</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:mfenced><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq34.gif"/></alternatives></inline-formula> instead, where <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{c}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq35.gif"/></alternatives></inline-formula> is the sum of weight of the supporting reads which pass the location <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M72"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq36.gif"/></alternatives></inline-formula>. The score of the nodes without any in-edge is assigned to 0. We calculate the scores for all nodes by dynamic programming in topological order and record the related edges which get the maximum scores for the nodes. The node with the highest score is selected and backtracking is done to obtain the path for consensus. The consensus sequence for the template read is generated by concatenating the bases of the nodes in the path.</p>
    </sec>
    <sec id="Sec13">
      <title>Read-level SNP caller and read grouping method for identifying inconsistent overlaps</title>
      <sec id="Sec14">
        <title>Calling heterozygous SNPs in haplotype-collapsed contigs and SNP alleles in reads</title>
        <p id="Par35">We map corrected reads to the first round of assembly using minimap2 with parameters “-x map-pb -c -p 0.5 -r 1000” for PacBio CLR reads and parameters “-x map-ont -c -p 0.5 -r 1000” for Nanopore reads. It performs base-level alignment and generates CIGAR strings. We scan the CIGAR strings and call heterozygous SNPs for each contig. We call a base site a heterozygous SNP site if it meets the following two conditions. (1) Its coverage is in the range [10, 1000]. (2) The number of second-most common bases is greater or equal to <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{\begin{array}{cc}{r}_{l}\cdot c &amp; c\le {c}_{l}\\ \frac{{r}_{h}\cdot {c}_{h}-{r}_{l}\cdot {c}_{l}}{{c}_{h}-{c}_{l}}\cdot \left(c-{c}_{l}\right)+{r}_{l}\cdot {c}_{l} &amp; {c}_{l} &lt; c\le {c}_{h}\\ {r}_{h}\cdot c &amp; c\ge {c}_{h}\end{array}\right.$$\end{document}</tex-math><mml:math id="M74"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>c</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>c</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>c</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>c</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>c</mml:mi><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq37.gif"/></alternatives></inline-formula>, in which <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M76"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq38.gif"/></alternatives></inline-formula> is the site coverage and <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{l}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq39.gif"/></alternatives></inline-formula>, <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{h}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq40.gif"/></alternatives></inline-formula>, <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{l}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq41.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{h}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq42.gif"/></alternatives></inline-formula> are user-set parameters (default values are 0.4, 0.2, 10 and 100). After calling heterozygous SNPs, we call SNP alleles in reads. We define a function <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{r}(s)$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq43.gif"/></alternatives></inline-formula> for each read <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M88"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq44.gif"/></alternatives></inline-formula>. For any SNP site <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M90"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq45.gif"/></alternatives></inline-formula>, <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{r}(s)$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq46.gif"/></alternatives></inline-formula> is defined as 1 or 2 if the read <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M94"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq47.gif"/></alternatives></inline-formula> covers the site <inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M96"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq48.gif"/></alternatives></inline-formula> and the base of the read <inline-formula id="IEq49"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M98"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq49.gif"/></alternatives></inline-formula> is equal to the first-most or second-most common base at site <inline-formula id="IEq50"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M100"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq50.gif"/></alternatives></inline-formula>. Otherwise, <inline-formula id="IEq51"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{r}(s)$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq51.gif"/></alternatives></inline-formula> is defined as 0.</p>
      </sec>
      <sec id="Sec15">
        <title>Verifying and correcting SNP alleles</title>
        <p id="Par36">To verify and correct SNP alleles in a read, we need to find which reads are from the same haplotype within its local region. For each read labeled as the template read <inline-formula id="IEq52"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M104"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq52.gif"/></alternatives></inline-formula>, we assume that it covers a set of SNP sites <inline-formula id="IEq53"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S=\left\{{s}_{1},{s}_{2},\ldots,{s}_{N}\right\}$$\end{document}</tex-math><mml:math id="M106"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq53.gif"/></alternatives></inline-formula>. We collect the query reads that cover 3 common SNP sites with the template read <inline-formula id="IEq54"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M108"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq54.gif"/></alternatives></inline-formula>. The template read and the query reads are put into a group <inline-formula id="IEq55"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M110"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq55.gif"/></alternatives></inline-formula>. We cluster the reads in the group <inline-formula id="IEq56"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M112"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq56.gif"/></alternatives></inline-formula> according to the SNP alleles in them. The reads in the same cluster can be considered from the same haplotype. To facilitate the description of the method, here we make some definitions. We define a centroid <inline-formula id="IEq57"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C=\{\left({v}_{s},{n}_{s}\right){|s}\in S\}$$\end{document}</tex-math><mml:math id="M114"><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∣</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq57.gif"/></alternatives></inline-formula> for the group <inline-formula id="IEq58"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M116"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq58.gif"/></alternatives></inline-formula> at the SNP site set <inline-formula id="IEq59"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M118"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq59.gif"/></alternatives></inline-formula>. <inline-formula id="IEq60"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq60.gif"/></alternatives></inline-formula> is defined to <inline-formula id="IEq61"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}^{+}-{v}_{s}^{-}$$\end{document}</tex-math><mml:math id="M122"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq61.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq62"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}^{+}$$\end{document}</tex-math><mml:math id="M124"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq62.gif"/></alternatives></inline-formula> is the number of the read set <inline-formula id="IEq63"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{r|}{H}_{r}\left(s\right)=1,{r}\in G,s\in S\}$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq63.gif"/></alternatives></inline-formula> and <inline-formula id="IEq64"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}^{-}$$\end{document}</tex-math><mml:math id="M128"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq64.gif"/></alternatives></inline-formula> is the number of the read set <inline-formula id="IEq65"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{r|}{H}_{r}\left(s\right)=2,{r}\in G,s\in S\}$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq65.gif"/></alternatives></inline-formula>. <inline-formula id="IEq66"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{i}$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq66.gif"/></alternatives></inline-formula> is defined to <inline-formula id="IEq67"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}^{+}+{v}_{s}^{-}$$\end{document}</tex-math><mml:math id="M134"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq67.gif"/></alternatives></inline-formula>. One read can be regarded as a group only including it. We define the following three formulas to get verified SNP sites of the centroid <inline-formula id="IEq68"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><mml:math id="M136"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq68.gif"/></alternatives></inline-formula>.<disp-formula id="Equa"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}{V}_{ &gt; }\left(C,\,{p}_{0},\,{p}_{1}\right)=\left\{s | {v}_{s}\, &gt; \,0,\left|{v}_{s}\right|\, \ge \,{\max}(p_{0}\cdot {n}_{s},\,{p}_{1})\right\},\, ({v}_{s},\, {n}_{s})\in C\left\}\right.\\ {V}_{ &lt; }\left(C,\, {p}_{0},\, {p}_{1}\right)=\left\{s | {v}_{s}\, &lt; \, 0,\left|{v}_{s}\right|\, \ge \, {\max}(p_{0}\cdot {n}_{s},\, {p}_{1})\right\},({v}_{s},\, {n}_{s})\in C\left\}\right.\\ {V}_{\ne }\left(C,\, {p}_{0},\, {p}_{1}\right)={V}_{ &gt; }\left(C,\, {p}_{0},\, {p}_{1}\right)\bigcup {V}_{ &lt; }\left(C,\, {p}_{0},\, {p}_{1}\right)\end{array}$$\end{document}</tex-math><mml:math id="M138"><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>&gt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>≥</mml:mo><mml:mspace width="0.25em"/><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mfenced open="}"><mml:mrow/></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>&lt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>≥</mml:mo><mml:mspace width="0.25em"/><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mfenced open="}"><mml:mrow/></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>≠</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo mathsize="big"> ⋃</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2024_47349_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par37">The parameters <inline-formula id="IEq69"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{0}$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq69.gif"/></alternatives></inline-formula> and <inline-formula id="IEq70"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{1}$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq70.gif"/></alternatives></inline-formula> are used to control which sites are valid. Next, we define the operations between two centroids.<disp-formula id="Equb"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}A\left({C}_{1},\, {C}_{2},\, {p}_{0},\, {p}_{1}\right)={V}_{\ne }({C}_{1},\, {p}_{0},\, {p}_{1})\bigcap {V}_{\ne }({C}_{2},\, {p}_{0},\, {p}_{1})\\ S\left({C}_{1},\, {C}_{2},\, {p}_{0},\, {p}_{1}\right)={V}_{ &lt; }({C}_{1},\, {p}_{0},\, {p}_{1})\bigcap {V}_{ &lt; }({C}_{2},\, {p}_{0},\, {p}_{1})\cup {V}_{ &gt; }({C}_{1},\, {p}_{0},\, {p}_{1})\bigcap {V}_{ &gt; }({C}_{2},\,{p}_{0},\,{p}_{1})\\ D\left({C}_{1},\,{C}_{2},\,{p}_{0},\,{p}_{1}\right)={V}_{ &lt; }\left({C}_{1},\,{p}_{0},\,{p}_{1}\right)\bigcap {V}_{ &gt; }\left({C}_{2},\,{p}_{0},\,{p}_{1}\right)\cup {V}_{ &gt; }\left({C}_{1},\,{p}_{0},\,{p}_{1}\right)\bigcap {V}_{ &lt; }\left({C}_{2},\,{p}_{0},\,{p}_{1}\right)\end{array}$$\end{document}</tex-math><mml:math id="M144"><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>≠</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo mathsize="big">⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>≠</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo mathsize="big">⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo mathsize="big">⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo mathsize="big"> ⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo mathsize="big"> ⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2024_47349_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par38"><inline-formula id="IEq71"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A\left({C}_{1},{C}_{2},{p}_{0},{p}_{1}\right)$$\end{document}</tex-math><mml:math id="M146"><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq71.gif"/></alternatives></inline-formula> is the set of common verified SNP sites of the centroids <inline-formula id="IEq72"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{1}$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq72.gif"/></alternatives></inline-formula> and <inline-formula id="IEq73"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{2}$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq73.gif"/></alternatives></inline-formula>. <inline-formula id="IEq74"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S\left({C}_{1},{C}_{2},{p}_{0},{p}_{1}\right)$$\end{document}</tex-math><mml:math id="M152"><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left({C}_{1},{C}_{2},{p}_{0},{p}_{1}\right)$$\end{document}</tex-math><mml:math id="M154"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq75.gif"/></alternatives></inline-formula> are used to describe the similarity and the distance of the centroids <inline-formula id="IEq76"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{1}$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{2}$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq77.gif"/></alternatives></inline-formula>. A read <inline-formula id="IEq78"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M160"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq78.gif"/></alternatives></inline-formula> can also be used as the parameter, which means the centroid of <inline-formula id="IEq79"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{r\}$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq79.gif"/></alternatives></inline-formula>.</p>
        <p id="Par39">For each template read <inline-formula id="IEq80"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M164"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq80.gif"/></alternatives></inline-formula> and related group <inline-formula id="IEq81"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M166"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq81.gif"/></alternatives></inline-formula>, we use a divide-then-combine strategy to cluster reads (Supplementary Fig. <xref rid="MOESM1" ref-type="media">28</xref>). In the dividing step, we use a modified bisecting k-means algorithm<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> to divide the group <inline-formula id="IEq82"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M168"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq82.gif"/></alternatives></inline-formula> into small ones with following steps</p>
        <p id="Par40">1. The centroids<inline-formula id="IEq83"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\,{C}_{1}$$\end{document}</tex-math><mml:math id="M170"><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq83.gif"/></alternatives></inline-formula> and <inline-formula id="IEq84"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{2}$$\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq84.gif"/></alternatives></inline-formula> of the sets <inline-formula id="IEq85"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{r}_{1}\}$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq85.gif"/></alternatives></inline-formula> and <inline-formula id="IEq86"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{{r}_{2}\right\}$$\end{document}</tex-math><mml:math id="M176"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq86.gif"/></alternatives></inline-formula> are initially selected, where reads <inline-formula id="IEq87"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{1}$$\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq87.gif"/></alternatives></inline-formula> and <inline-formula id="IEq88"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{2}$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq88.gif"/></alternatives></inline-formula> are a read pair in the group <inline-formula id="IEq89"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M182"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq89.gif"/></alternatives></inline-formula> with the largest distance (<inline-formula id="IEq90"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{1},{r}_{2}={{{\arg }}}_{{r}_{1},{r}_{2}\in G}\max {|D}({r}_{1},{r}_{2},0,0)|$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>arg</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mi>max</mml:mi><mml:mo>∣</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq90.gif"/></alternatives></inline-formula>).</p>
        <p id="Par41">2. We divide the group <inline-formula id="IEq91"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M186"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq91.gif"/></alternatives></inline-formula> into three subgroups, two subgroups corresponding to the centroids and a separate subgroup containing the reads far away from the centroids. For each read <inline-formula id="IEq92"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M188"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq92.gif"/></alternatives></inline-formula>, if it is far away from the centroids, it meets the conditions: <inline-formula id="IEq93"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{\left|A\left(r,{C}_{i},0,0\right)\right|}{\left|{V}_{\ne }(r,0,0)\right|} &lt; {p}_{2}$$\end{document}</tex-math><mml:math id="M190"><mml:mfrac><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>≠</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq93.gif"/></alternatives></inline-formula>
<inline-formula id="IEq94"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${or}\frac{|D(r,{C}_{i},0,0)|}{|A(r,{C}_{i},0,0)|} &gt; {p}_{3},{i}\in \{{1,2}\}$$\end{document}</tex-math><mml:math id="M192"><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mfrac><mml:mrow><mml:mo>∣</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq94.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq95"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{2}$$\end{document}</tex-math><mml:math id="M194"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq95.gif"/></alternatives></inline-formula> and <inline-formula id="IEq96"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{3}$$\end{document}</tex-math><mml:math id="M196"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq96.gif"/></alternatives></inline-formula> are user-set parameters (default values are 0.3 and 0.5), it is assigned to a separate subgroup. Otherwise, it is assigned the nearest subgroup <inline-formula id="IEq97"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i={{{\arg }}}_{{{{{{\rm{i}}}}}}\in \{1,2\}}\min \frac{\left|D\left(r,{C}_{i},0,0\right)\right|}{\left|A\left(r,{C}_{i},0,0\right)\right|}$$\end{document}</tex-math><mml:math id="M198"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>arg</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mi>min</mml:mi><mml:mfrac><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq97.gif"/></alternatives></inline-formula>. The purpose of the separate subgroup is to prevent the centroids from changing dramatically in each iteration.</p>
        <p id="Par42">3. We calculate the centroids for the first two subgroups and repeat step 2 until the three subgroups don’t change.</p>
        <p id="Par43">After the group is divided into three subgroups, we repeat the above steps to continue dividing the subgroups. If the subgroup <inline-formula id="IEq98"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M200"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq98.gif"/></alternatives></inline-formula> and its centroid <inline-formula id="IEq99"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><mml:math id="M202"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq99.gif"/></alternatives></inline-formula> meet the following conditions: <inline-formula id="IEq100"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|G\right|\le 3$$\end{document}</tex-math><mml:math id="M204"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq100.gif"/></alternatives></inline-formula> or <inline-formula id="IEq101"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{\sum }_{r\in G}\left|D\left(r,C,0,0\right)\right|}{{\sum }_{r\in G}\left|A\left(r,C,0,0\right)\right|}\le {p}_{4}$$\end{document}</tex-math><mml:math id="M206"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq101.gif"/></alternatives></inline-formula> and <inline-formula id="IEq102"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sum }_{r\in G}\left|D\left(r,C,0,0\right)\right|\le {p}_{5}$$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq102.gif"/></alternatives></inline-formula>, it is no longer divided into small subgroups. <inline-formula id="IEq103"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{4}$$\end{document}</tex-math><mml:math id="M210"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq103.gif"/></alternatives></inline-formula> and <inline-formula id="IEq104"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{5}$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq104.gif"/></alternatives></inline-formula> are user-set parameters (the default values are 0.02 and 4).</p>
        <p id="Par44">After dividing the groups, we get a set of subgroups <inline-formula id="IEq105"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${SG}$$\end{document}</tex-math><mml:math id="M214"><mml:mi>S</mml:mi><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq105.gif"/></alternatives></inline-formula>. we combine a pair of subgroups into a big one if the centroids are close to each other. First, we create an empty list <inline-formula id="IEq106"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M216"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq106.gif"/></alternatives></inline-formula> and add the subgroup that contains the template read to the list as the first element <inline-formula id="IEq107"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq107.gif"/></alternatives></inline-formula>. Then, we combine other subgroup <inline-formula id="IEq108"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}</tex-math><mml:math id="M220"><mml:mi>g</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq108.gif"/></alternatives></inline-formula> to <inline-formula id="IEq109"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq109.gif"/></alternatives></inline-formula>, if it meets the conditions: <inline-formula id="IEq110"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left(g,{L}_{1},{p}_{6},{p}_{7}\right) &lt; \min ({p}_{8},{A}\left(g,{L}_{1},{p}_{6},{p}_{7}\right)\cdot {p}_{9})$$\end{document}</tex-math><mml:math id="M224"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq110.gif"/></alternatives></inline-formula> and <inline-formula id="IEq111"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left(g,{L}_{1},{p}_{6},{p}_{7}/2\right) &lt; A\left(g,{L}_{1},{p}_{6},{p}_{7}/2\right)\cdot {p}_{9}$$\end{document}</tex-math><mml:math id="M226"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq111.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq112"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{6}$$\end{document}</tex-math><mml:math id="M228"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq112.gif"/></alternatives></inline-formula>, <inline-formula id="IEq113"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{7}$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq113.gif"/></alternatives></inline-formula>, <inline-formula id="IEq114"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{8}$$\end{document}</tex-math><mml:math id="M232"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq114.gif"/></alternatives></inline-formula> and <inline-formula id="IEq115"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{9}$$\end{document}</tex-math><mml:math id="M234"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq115.gif"/></alternatives></inline-formula> are user-set parameters (the default values are 0.66, 6, 4 and 0.2). The remaining subgroups are put into another list <inline-formula id="IEq116"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}^{{\prime} }$$\end{document}</tex-math><mml:math id="M236"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq116.gif"/></alternatives></inline-formula> and sort the subgroups in ascending order of distance with <inline-formula id="IEq117"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M238"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq117.gif"/></alternatives></inline-formula> (<inline-formula id="IEq118"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|D({L}_{1},{L}_{i}^{{\prime} },{p}_{6},{p}_{7})\right|$$\end{document}</tex-math><mml:math id="M240"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq118.gif"/></alternatives></inline-formula>). For the subgroup <inline-formula id="IEq119"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M242"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq119.gif"/></alternatives></inline-formula> in the list <inline-formula id="IEq120"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}^{{\prime} }$$\end{document}</tex-math><mml:math id="M244"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq120.gif"/></alternatives></inline-formula>, we combine it to the subgroup <inline-formula id="IEq121"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M246"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq121.gif"/></alternatives></inline-formula> in list <inline-formula id="IEq122"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M248"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq122.gif"/></alternatives></inline-formula>, if it meets the following conditions: (1) <inline-formula id="IEq123"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j={{\arg }}\max \left|S\left(i,j,{p}_{6},0\right)\right|,{j}\in L$$\end{document}</tex-math><mml:math id="M250"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:mi>max</mml:mi><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq123.gif"/></alternatives></inline-formula>; (2) <inline-formula id="IEq124"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left(i,j,{p}_{6},{p}_{7}\right) &lt; \max ({p}_{8},{A}\left(i,j,{p}_{6},{p}_{7}\right)\cdot {p}_{9})$$\end{document}</tex-math><mml:math id="M252"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq124.gif"/></alternatives></inline-formula>; (3) <inline-formula id="IEq125"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left(i,j,{p}_{6},0\right) &lt; A\left(i,j,{p}_{6},0\right)\cdot {p}_{9}$$\end{document}</tex-math><mml:math id="M254"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq125.gif"/></alternatives></inline-formula>. Otherwise, the subgroup <inline-formula id="IEq126"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M256"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq126.gif"/></alternatives></inline-formula> is added to the end of the list <inline-formula id="IEq127"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M258"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq127.gif"/></alternatives></inline-formula>.</p>
        <p id="Par45">After combining the subgroups, we think the reads in the same subgroup in the list <inline-formula id="IEq128"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M260"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq128.gif"/></alternatives></inline-formula> are from the same haplotype or the same copy of the repeat. The SNP alleles in the read can be verified by the centroid of its subgroup, which helps to find inconsistent overlaps more accurately. In addition, since the group <inline-formula id="IEq129"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq129.gif"/></alternatives></inline-formula> contains the template read <inline-formula id="IEq130"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M264"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq130.gif"/></alternatives></inline-formula>, we use the centroid of the group <inline-formula id="IEq131"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M266"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq131.gif"/></alternatives></inline-formula> to correct SNP alleles in the template read <inline-formula id="IEq132"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M268"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq132.gif"/></alternatives></inline-formula>. Here, the read is corrected when it is treated as a template read. After all reads are corrected, we run the verifying and correcting SNP alleles step again to obtain more robust results. We run the step twice by default.</p>
      </sec>
      <sec id="Sec16">
        <title>Finding inconsistent overlaps</title>
        <p id="Par46">In the last round of verifying and correcting SNP alleles, we identify inconsistent overlaps. After combining steps, for each template read <inline-formula id="IEq133"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M270"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq133.gif"/></alternatives></inline-formula>, we obtain a subgroup list <inline-formula id="IEq134"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M272"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq134.gif"/></alternatives></inline-formula> and the first subgroup <inline-formula id="IEq135"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq135.gif"/></alternatives></inline-formula> of <inline-formula id="IEq136"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M276"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq136.gif"/></alternatives></inline-formula> contains the template read <inline-formula id="IEq137"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M278"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq137.gif"/></alternatives></inline-formula>. We consider a query read <inline-formula id="IEq138"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M280"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq138.gif"/></alternatives></inline-formula> and the template read <inline-formula id="IEq139"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M282"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq139.gif"/></alternatives></inline-formula> to be inconsistent if the query read <inline-formula id="IEq140"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M284"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq140.gif"/></alternatives></inline-formula> and its subgroup <inline-formula id="IEq141"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{r}$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq141.gif"/></alternatives></inline-formula> (<inline-formula id="IEq142"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r\in {L}_{r}$$\end{document}</tex-math><mml:math id="M288"><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq142.gif"/></alternatives></inline-formula>) meet the conditions:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\rm{|}}}}}}D\left({L}_{r},{L}_{1},{p}_{6},{p}_{7}\right){{{{{\rm{|}}}}}}\ge \max ({p}_{8},{{{{{\rm{|}}}}}}A\left({L}_{r},{L}_{1},{p}_{6},{p}_{7}\right){{{{{\rm{|}}}}}}\cdot {p}_{9});$$\end{document}</tex-math><mml:math id="M290"><mml:mi mathvariant="normal">∣</mml:mi><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">∣</mml:mi><mml:mo>≥</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∣</mml:mi><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">∣</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo></mml:math><graphic xlink:href="41467_2024_47349_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|D\left(r,{L}_{1},0,0\right)\bigcap A\left({L}_{r},{L}_{1},{p}_{6},{p}_{7}\right)\right| \ge \max ({p}_{8},{{{{{\rm{|}}}}}}A\left(r,{L}_{1},0,0\right)\\ \bigcap A\left({L}_{r},{L}_{1},{p}_{6},{p}_{7}\right){{{{{\rm{|}}}}}}\cdot {p}_{9}).$$\end{document}</tex-math><mml:math id="M292"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo mathsize="big">⋂</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>≥</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∣</mml:mi><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo mathsize="big">⋂</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">∣</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2024_47349_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par47">The parameters <inline-formula id="IEq143"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{6}$$\end{document}</tex-math><mml:math id="M294"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq143.gif"/></alternatives></inline-formula>, <inline-formula id="IEq144"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{7}$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq144.gif"/></alternatives></inline-formula>, <inline-formula id="IEq145"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{8}$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq145.gif"/></alternatives></inline-formula> and <inline-formula id="IEq146"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{9}$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq146.gif"/></alternatives></inline-formula> are mentioned above. We record the location and direction of the reads in the haplotype-collapsed contigs. The overlaps between the inconsistent read pairs are identified as inconsistent overlaps if the directions and distances of the reads in the overlaps do not conflict with those in the haplotype-collapsed contigs (The difference between two distances should be less than 1000 by default.). The distance of the reads is defined as the distance of the 3’ ends of the reads. We record the inconsistent overlap information and SNP alleles in reads for subsequent steps.</p>
      </sec>
      <sec id="Sec17">
        <title>Combining Nanopore raw reads to identify inconsistent overlaps</title>
        <p id="Par48">For Nanopore datasets, we combine the corrected reads and raw reads to identify inconsistent overlaps. We first identify inconsistent overlaps using corrected reads with the strict threshold that the pair of reads should contain 8 different SNP alleles. Then, we use raw reads to identify inconsistent overlaps with the loose threshold that the pair of reads should contain 6 different SNP alleles. Using raw reads to identify inconsistent overlaps is similar to that using corrected reads. For Nanopore reads, we use Clair3<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> to call heterozygous SNPs for each contig. Since PECAT doesn’t change the names of the reads during error correction, inconsistent overlaps between raw reads can be regarded as inconsistent overlaps between corrected reads. Similar to using corrected reads, we also check whether the directions and distances of the reads in the overlaps conflict with those in the haplotype-collapsed contigs. We record the location of corrected reads in raw reads during error correction. Therefore, we can calculate the distance of corrected reads in the haplotype-collapsed contigs by linear mapping. The distance threshold is set to <inline-formula id="IEq147"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\max (2500,0.05*{D}_{c})$$\end{document}</tex-math><mml:math id="M302"><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2500</mml:mn><mml:mo>,</mml:mo><mml:mn>0.05</mml:mn><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq147.gif"/></alternatives></inline-formula> by default, where <inline-formula id="IEq148"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{{{{{{\rm{c}}}}}}}$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq148.gif"/></alternatives></inline-formula> is distance of corrected reads in the haplotype-collapsed contigs.</p>
      </sec>
    </sec>
    <sec id="Sec18">
      <title>Fast string-graph-based assembler</title>
      <p id="Par49">According to the characteristics of k-mer-based alignment and string graphs, we propose a fast string-graph-based assembler to balance the quality and speed of assembling. First, we use minimap2 with parameters “-X -g3000 -w30 -k19 -m100 -r500” to find candidate overlaps between corrected reads. Minimap2<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> with those parameters invokes the k-mer-based alignment. To reduce overhangs of overlaps, we extend the alignment to the ends of the reads with the diff<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> algorithm and filter out overlaps still with long overhangs. Next, we remove the overlaps whose reads are contained in other reads or with low coverage. A directed string graph is constructed using the remaining overlaps. Myers’ algorithm<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> is used to mark transitive edges as inactive ones. We implement local alignment using the edlib<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> algorithm to calculate the identity of each active edge, which is defined as the identity of its related overlap. Only a few edges need to calculate identities for most of the edges are marked as inactive ones. The edges whose identities are less than the threshold are marked as low quality and removed. The threshold is determined by the formula <inline-formula id="IEq149"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(({m}_{1}-6*1.253*{{MAD}}_{1})+2*({m}_{2}-6*1.4826*{{MAD}}_{2}))/3$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>6</mml:mn><mml:mo>*</mml:mo><mml:mn>1.253</mml:mn><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>*</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>6</mml:mn><mml:mo>*</mml:mo><mml:mn>1.4826</mml:mn><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq149.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq150"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}_{1}$$\end{document}</tex-math><mml:math id="M308"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq150.gif"/></alternatives></inline-formula> and <inline-formula id="IEq151"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}_{2}$$\end{document}</tex-math><mml:math id="M310"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq151.gif"/></alternatives></inline-formula> are the mean and the median of identity of all active edges in the string graph and <inline-formula id="IEq152"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{MAD}}_{1}$$\end{document}</tex-math><mml:math id="M312"><mml:msub><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq152.gif"/></alternatives></inline-formula> and <inline-formula id="IEq153"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{MAD}}_{2}$$\end{document}</tex-math><mml:math id="M314"><mml:msub><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq153.gif"/></alternatives></inline-formula> are the mean absolute deviation and the median absolute deviation of them. This step also breaks some paths connected by low-quality edges in the graphs. To repair those paths, we check dead-end nodes whose outdegree or indegree are equal to 0. We calculate the identities of their transitive edges and reactivate the edge with the longest alignment and the identity greater than the threshold. Considering that some breaks in paths are caused by reads being contained by other reads from the different haplotype or the different copy of the repeat, we extend the dead-end nodes with contained reads to repair the breaks using the similar method. In this way, an appropriate string graph is constructed. After performing other simplifying processes, such as removing the ambiguous edges (tips, bubbles, and spurious links) in the graph, we identify linear paths from the graph and generate contigs.</p>
    </sec>
    <sec id="Sec19">
      <title>Improvement of best overlap graph algorithm</title>
      <p id="Par50">Best overlap graph algorithm<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> only retains the best out-edge and the best in-edge of each node according to the overlap length. After removing transitive edges using Myers’ algorithm<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, PECAT performs the best overlap graph algorithm to further simplify the string graph. However, the original algorithm is not suitable for diploid assembly. The SNP alleles in reads are more important than the overlap length to measure which edge is the best one. Although most inconsistent overlaps are removed, there remain some undetected inconsistent overlaps and the corresponding reads contain different SNP alleles. We improve the algorithm and use the following steps to determine the best edges. First, for the in-edges or out-edges of each node, we sort the edges in descending order of the edge score <inline-formula id="IEq154"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}=({{n}_{i}^{+}\cdot w-n}_{i}^{-},{l}_{i})$$\end{document}</tex-math><mml:math id="M316"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq154.gif"/></alternatives></inline-formula>. <inline-formula id="IEq155"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{i}^{+}$$\end{document}</tex-math><mml:math id="M318"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq155.gif"/></alternatives></inline-formula> and <inline-formula id="IEq156"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{i}^{-}$$\end{document}</tex-math><mml:math id="M320"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq156.gif"/></alternatives></inline-formula> are the numbers of two related reads containing the same or different SNP alleles, which are obtained in finding inconsistent overlaps step. <inline-formula id="IEq157"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w$$\end{document}</tex-math><mml:math id="M322"><mml:mi>w</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq157.gif"/></alternatives></inline-formula> is a user-defined parameter. Its default value is set to 0.5. <inline-formula id="IEq158"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${l}_{i}$$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq158.gif"/></alternatives></inline-formula> is the overlap length. The first edge <inline-formula id="IEq159"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{0}$$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq159.gif"/></alternatives></inline-formula> is marked as a candidate best edge. The other edges meeting the following conditions also are marked as the candidate best edges: (1) Its related read is inconsistent with the reads related to the candidate best edges. (2) Its score is not too much less than the first edge <inline-formula id="IEq160"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{0}$$\end{document}</tex-math><mml:math id="M328"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq160.gif"/></alternatives></inline-formula>, which means <inline-formula id="IEq161"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{0}\left[0\right]-{s}_{i}\left[0\right]\, &lt; \,\left\{\begin{array}{c}\max \left(C,\,{s}_{i}\left[0\right]\cdot {R}_{1}\right),\,{s}_{i}\left[0\right]\, \ge \,0\\ \max \left(C,-{s}_{i}\left[0\right]\cdot {R}_{2}\right),\,{s}_{i}\left[0\right] \, &lt; \, 0\end{array}\right.$$\end{document}</tex-math><mml:math id="M330"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>&lt;</mml:mo><mml:mspace width="0.25em"/><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>max</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>≥</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>max</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>&lt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq161.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq162"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><mml:math id="M332"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq162.gif"/></alternatives></inline-formula>, <inline-formula id="IEq163"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{1}$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq163.gif"/></alternatives></inline-formula> and <inline-formula id="IEq164"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{2}$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq164.gif"/></alternatives></inline-formula> are user-defined parameters (the default values are 4, 2, and 0.66). Next, if the edge is marked as a candidate best edge twice (in-edge and out-edge), it is selected as the best edge. Then, if the node has no best in-edge or best out-edge, its first in-edge or first out-edge is selected as the best one. Finally, the edges selected as the best edges are retained and the other edges are removed from the string graph.</p>
    </sec>
    <sec id="Sec20">
      <title>Generating two sets of contigs</title>
      <p id="Par51">After simplifying the string graph, PECAT identifies three structures from the string graph, as shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">29a</xref>. First, we use FALCON-Unzip’s heuristic algorithm<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> to identify bubble structures. Generally, the paths in the bubble structure are from different haplotypes. Then, we also identify alternate branches, which meet the following conditions: (1) There are only two branches. (2) The shorter branch is linear and does not contain other branches. (3) More than 30% of reads in the shorter branch are inconsistent with the reads in the other branch. We think the two branches that meet the conditions are from different haplotypes. We identify the paths in the string graph and do not break the paths if they encounter bubble structures or alternate branches. This trick can increase the continuity of primary contigs. The other paths in bubble structures or the alternate branches output as alternate contigs. We also check each pair of arbitrary independent contigs. If more than 30% of reads in the shorter contig are inconsistent with the reads in another contig, the shorter contig is labeled as an alternate contig. Another contig not labeled as an alternate contig is outputted as a primary contig.</p>
      <p id="Par52">To generate a dual assembly, PECAT connects the paths in two adjacent bubble structures. In the step of inconsistent overlap identification, we have called SNP alleles in each read. The information is used to determine the pair of paths in adjacent bubble structures that should be connected. As shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">29b</xref>, we build two read groups <inline-formula id="IEq165"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{1}$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq165.gif"/></alternatives></inline-formula> and <inline-formula id="IEq166"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{2}$$\end{document}</tex-math><mml:math id="M340"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq166.gif"/></alternatives></inline-formula> for in-edges <inline-formula id="IEq167"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{1}$$\end{document}</tex-math><mml:math id="M342"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq167.gif"/></alternatives></inline-formula> and <inline-formula id="IEq168"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{2}$$\end{document}</tex-math><mml:math id="M344"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq168.gif"/></alternatives></inline-formula> respectively. If the reads only overlap with the reads in in-edges <inline-formula id="IEq169"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{1}$$\end{document}</tex-math><mml:math id="M346"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq169.gif"/></alternatives></inline-formula> or <inline-formula id="IEq170"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{2}$$\end{document}</tex-math><mml:math id="M348"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq170.gif"/></alternatives></inline-formula>, they are assigned to <inline-formula id="IEq171"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{1}$$\end{document}</tex-math><mml:math id="M350"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq171.gif"/></alternatives></inline-formula> or <inline-formula id="IEq172"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{2}$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq172.gif"/></alternatives></inline-formula>, respectively. If the reads overlap with the reads in in-edges <inline-formula id="IEq173"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{1}$$\end{document}</tex-math><mml:math id="M354"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq173.gif"/></alternatives></inline-formula> and <inline-formula id="IEq174"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{2}$$\end{document}</tex-math><mml:math id="M356"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq174.gif"/></alternatives></inline-formula> at the same time, the reads are assigned to the group whose centroid the reads are closer to. The concepts of centroid and distance are defined in the previous section on verifying and correcting SNP alleles. In the same way, we get read groups <inline-formula id="IEq175"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${O}_{1}$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq175.gif"/></alternatives></inline-formula> or <inline-formula id="IEq176"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${O}_{2}$$\end{document}</tex-math><mml:math id="M360"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq176.gif"/></alternatives></inline-formula> for out-edges <inline-formula id="IEq177"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{out}}_{1}$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq177.gif"/></alternatives></inline-formula> or <inline-formula id="IEq178"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{out}}_{2}$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq178.gif"/></alternatives></inline-formula>. If the centroid of <inline-formula id="IEq179"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{1}$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq179.gif"/></alternatives></inline-formula> or <inline-formula id="IEq180"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{2}$$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq180.gif"/></alternatives></inline-formula> does not have a common heterozygous site with the centroid of <inline-formula id="IEq181"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${O}_{1}$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq181.gif"/></alternatives></inline-formula> or <inline-formula id="IEq182"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${O}_{2}$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq182.gif"/></alternatives></inline-formula>, we randomly connect the paths of bubble structures. Otherwise, we choose the paths to minimize the distance between their corresponding read group centroids.</p>
    </sec>
    <sec id="Sec21">
      <title>Polishing two sets of contigs</title>
      <p id="Par53">After generating contigs in primary/alternate format or dual assembly format, we use corrected reads or raw reads to polish them. We map the reads to the contigs using minimap2. In previous steps, we record which read pairs are inconsistent and which reads construct the contigs. If the read is inconsistent with the reads used for constructing the contig, the related alignments are removed. This trick helps to reduce haplotype switch errors. After removing other low-quality alignments, we run racon<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> with default parameters to polish the contigs.</p>
      <p id="Par54">For the assemblies from the Nanopore sequences, we use Medaka (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/medaka">https://github.com/nanoporetech/medaka</ext-link>) to further improve the assembly quality. Its steps are similar to those polishing with racon. The key step is to filter the inconsistent alignments between the reads and the contigs according to the information of inconsistent overlap.</p>
    </sec>
    <sec id="Sec22">
      <title>Evaluation</title>
      <p id="Par55">To evaluate the effectiveness of correction methods fairly, we extract the 40X longest reads from corrected reads and then evaluate them. We map the reads to the reference genome using minimap2 with parameters “-c --eqx”. It generates CIGAR strings. We scan the CIGAR strings to calculate the accuracy of each corrected data. To evaluate the accuracy of the sequences in the difficult-to-map regions and low-complexity regions in the HG002 reference genome, we map the HG002 reference genome to GRCh38. The regions are located in the HG002 reference genome according to GIAB v2.0 genome stratification BED files and the alignment between the HG002 reference genome and GRCh38. Then, we calculate the accuracy of the sequences in these regions separately. To evaluate the haplotype-specific k-mers completeness, we calculate the percentage of parent-specific k-mers in 40X longest reads. Considering that there are 40X datasets, we only count k-mers with equal to or more than 4 occurrences. To evaluate the haplotype-specific k-mers consistency, we calculate the metric as <inline-formula id="IEq183"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum \max ({k}_{p},{k}_{m})/\sum ({k}_{p}+{k}_{m})$$\end{document}</tex-math><mml:math id="M374"><mml:mo>∑</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq183.gif"/></alternatives></inline-formula>, in which <inline-formula id="IEq184"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{p}$$\end{document}</tex-math><mml:math id="M376"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq184.gif"/></alternatives></inline-formula> and <inline-formula id="IEq185"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{m}$$\end{document}</tex-math><mml:math id="M378"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq185.gif"/></alternatives></inline-formula> are the number of paternal and maternal haplotype-specific k-mers in each read.</p>
      <p id="Par56">To evaluate the performance of selecting supporting reads and the performance of finding inconsistent overlaps, we use Illumina reads of parents to classify long reads with a trio-binning algorithm<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. We adjust the threshold to reduce false positives. The read is classified as the paternal read if it meets the condition: <inline-formula id="IEq186"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{k}_{p}}{{K}_{p}} &gt; \frac{{k}_{m}+\max (10,{k}_{m}\cdot 0.1)}{{K}_{m}}$$\end{document}</tex-math><mml:math id="M380"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mn>0.1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq186.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq187"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{p}$$\end{document}</tex-math><mml:math id="M382"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq187.gif"/></alternatives></inline-formula> and <inline-formula id="IEq188"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{m}$$\end{document}</tex-math><mml:math id="M384"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq188.gif"/></alternatives></inline-formula> are the numbers of paternal and maternal haplotype-specific k-mers in the read, and <inline-formula id="IEq189"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{p}$$\end{document}</tex-math><mml:math id="M386"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq189.gif"/></alternatives></inline-formula> and <inline-formula id="IEq190"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{m}$$\end{document}</tex-math><mml:math id="M388"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq190.gif"/></alternatives></inline-formula> are the numbers of all paternal and maternal haplotype-specific k-mers. The read is classified as a maternal read if it meets the condition: <inline-formula id="IEq191"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{k}_{m}}{{K}_{m}} &gt; \frac{{k}_{p}+\max (10,{k}_{p}\cdot 0.1)}{{K}_{p}}$$\end{document}</tex-math><mml:math id="M390"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mn>0.1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq191.gif"/></alternatives></inline-formula>. Otherwise, it is classified to the untagged reads. When one read of the pair of reads is a maternal read and the other read is a paternal read or vice versa, we think the pair of reads is inconsistent.</p>
      <p id="Par57">We use the k-mer-based assembly evaluation tool merqury<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> to evaluate the diploid assemblies generated by each pipeline and use BUSCO<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> to evaluate the gene completeness of assemblies. The hamming error rate of the assemblies is calculated from the output of merqury. The details of the parameters used in this study are described in Supplementary Notes <xref rid="MOESM1" ref-type="media">4</xref>, <xref rid="MOESM1" ref-type="media">5</xref>. We use the reference-based evaluation tool Pomoxis (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/pomoxis">https://github.com/nanoporetech/pomoxis</ext-link>) to evaluate the base quality of diploid assemblies <bold>(</bold>Supplementary Note <xref rid="MOESM1" ref-type="media">6</xref>). The genome fraction is evaluated by QUAST<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> and its parameters are described in Supplementary Note <xref rid="MOESM1" ref-type="media">7</xref>.</p>
      <p id="Par58">We obtain the small variants (SNP and INDEL) sets from HG002 assemblies against GRCh38 using dipcall<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> and compare them against the HG002 GIAB benchmark to evaluate their precisions, recalls, and F1 scores using hap.py<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>. We called structural variant (SV) sets from HG002 assemblies against GRCh37 using hapdiff (<ext-link ext-link-type="uri" xlink:href="https://github.com/KolmogorovLab/hapdiff">https://github.com/KolmogorovLab/hapdiff</ext-link>) and compare them against the curated set of SVs in the HG002 genome<sup><xref ref-type="bibr" rid="CR55">55</xref></sup> to evaluate their precisions, recalls, and F1 scores using truvari<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> (Supplementary Note <xref rid="MOESM1" ref-type="media">8</xref>).</p>
    </sec>
    <sec id="Sec23">
      <title>Reporting summary</title>
      <p id="Par59">Further information on research design is available in the <xref rid="MOESM5" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec24">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2024_47349_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2024_47349_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2024_47349_MOESM3_ESM.docx">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2024_47349_MOESM4_ESM.xlsx">
            <caption>
              <p>Supplementary Data 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2024_47349_MOESM5_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Fan Nie, Peng Ni</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-024-47349-7.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported in part by the National Key Research and Development Program of China (No. 2021YFF1201200); the National Natural Science Foundation of China under Grants (Nos. 62350004, 62332020); the Project of Xiangjiang Laboratory (No. 23XJ01011) to Jianxin Wang. This work was also supported in part by the US National Institute of Food and Agriculture (NIFA; Grant Number 2017-70016-26051 and 2023-70029-41309) and the US National Science Foundation (NSF; Grant Number ABI-1759856, MRI-2018069, MTM2-2025541) to Feng Luo. This work was also supported in part by Guangdong Basic and Applied Basic Research Foundation (No. 2020B1515020057) to Chuanle Xiao. We are grateful for resources from the High-Performance Computing Center of Central South University.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.X.W., F.L., and C.L.X. conceived and designed this project. F.N. and J.X.W. conceived, designed, and implemented the consensus and assembly algorithm. F.N. and P.N. integrated all the programs into the PECAT pipeline and provided documentation. F.N., P.N., N.H., and J.Z. analyzed the performance of algorithms developed in this study. C.L.X. and Z.Y.W. provided the dataset <italic>A. thaliana</italic> (Col-0 × C24). J.X.W., F.L., and F.N. performed the theoretical analysis of the algorithms developed in this study. J.X.W., F.L., and F.N. wrote the manuscript. Z.Y.W. wrote about cultivating <italic>A. thaliana</italic> (Col-0 × C24) and extracting its DNA. All authors have read and approved the final version of this manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par60"><italic>Nature Communications</italic> thanks Kishwar Shafin for his contribution to the peer review of this work. A peer review file is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>All described datasets are obtained from public websites, except for <italic>A. thaliana</italic> (Col-0 × C24) which is generated using our in-house sequencing. It is available from NGDC at <ext-link ext-link-type="uri" xlink:href="https://ngdc.cncb.ac.cn/bioproject/browse/PRJCA011723">PRJCA011723</ext-link>. <italic>S. cerevisiae</italic> (SK × Y12), <italic>A. thaliana</italic> (Col-0 × Cvi-0), <italic>D. melanogaster</italic> (ISO1 × A4), <italic>B. taurus</italic> (Angus × Brahman), and <italic>B. taurus</italic> (Bison×Simmental) are available from NCBI at <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJEB7245">PRJEB7245</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA314706">PRJNA314706</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA558397">PRJNA558397</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA432857">PRJNA432857</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA677946">PRJNA677946</ext-link>. HG002 using Nanopore R9 sequencing is available at Human Pangenome Reference Consortium (HPRC) [<ext-link ext-link-type="uri" xlink:href="https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=T2T/scratch/HG002/sequencing/ont/">https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=T2T/scratch/HG002/sequencing/ont/</ext-link>]. HG002 using Nanopore R10 sequencing is available at HPRC [<ext-link ext-link-type="uri" xlink:href="https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=submissions/5b73fa0e-658a-4248-b2b8-cd16155bc157--UCSC_GIAB_R1041_nanopore/HG002_R1041_UL/Guppy6/">https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=submissions/5b73fa0e-658a-4248-b2b8-cd16155bc157--UCSC_GIAB_R1041_nanopore/HG002_R1041_UL/Guppy6/</ext-link>]. HG002 using Nanopore R10 duplex sequencing is available at HPRC [<ext-link ext-link-type="uri" xlink:href="https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=submissions/0CB931D5-AE0C-4187-8BD8-B3A9C9BFDADE--UCSC_HG002_R1041_Duplex_Dorado/Dorado_v0.1.1/stereo_duplex">https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=submissions/0CB931D5-AE0C-4187-8BD8-B3A9C9BFDADE--UCSC_HG002_R1041_Duplex_Dorado/Dorado_v0.1.1/stereo_duplex</ext-link>]. HG002 using PacBio HiFi sequencing is available from NCBI at <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA586863">PRJNA586863</ext-link>. GIAB v2.0 genome stratification BED files are available at <ext-link ext-link-type="uri" xlink:href="https://ftp-trace.ncbi.nlm.nih.gov/ReferenceSamples/giab/release/genome-stratifications/v2.0/GRCh38/">GIAB</ext-link>. HG002 GIAB benchmark is available at <ext-link ext-link-type="uri" xlink:href="https://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/release/AshkenazimTrio/HG002_NA24385_son/NISTv3.3.2/">GIAB</ext-link>. The curated set of SVs in the HG002 is available at <ext-link ext-link-type="uri" xlink:href="https://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/AshkenazimTrio/analysis/NIST_SVs_Integration_v0.6/">GIAB</ext-link>. NCTC9006 and NCTC9024 are available from ENA at <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ena/browser/view/PRJEB6403">PRJEB6403</ext-link>. The details of the datasets used in this study are reported in Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">17</xref>. All assemblies are available at Zenodo [10.5281/zenodo.10457427].</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>All source codes for PECAT are available at GitHub [<ext-link ext-link-type="uri" xlink:href="https://github.com/lemene/PECAT">https://github.com/lemene/PECAT</ext-link>] and Zenodo [10.5281/zenodo.10799833].</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par61">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagarajan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Sequence assembly demystified</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>157</fpage>
        <lpage>167</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3367</pub-id>
        <?supplied-pmid 23358380?>
        <pub-id pub-id-type="pmid">23358380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gagarinova</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Emili</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Genome-scale genetic manipulation methods for exploring bacterial molecular biology</article-title>
        <source>Mol. Biosyst.</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>1626</fpage>
        <pub-id pub-id-type="doi">10.1039/c2mb25040c</pub-id>
        <?supplied-pmid 22517266?>
        <pub-id pub-id-type="pmid">22517266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>International Human Genome Sequencing Consortium</surname>
          </name>
        </person-group>
        <article-title>Finishing the euchromatic sequence of the human genome</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>431</volume>
        <fpage>931</fpage>
        <lpage>945</lpage>
        <pub-id pub-id-type="doi">10.1038/nature03001</pub-id>
        <pub-id pub-id-type="pmid">15496913</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chin</surname>
            <given-names>CS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phased diploid genome assembly with single-molecule real-time sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>1050</fpage>
        <lpage>1054</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4035</pub-id>
        <?supplied-pmid 27749838?>
        <pub-id pub-id-type="pmid">27749838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Canu: scalable and accurate long-read assembly via adaptive <italic>k</italic> -mer weighting and repeat separation</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>722</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.215087.116</pub-id>
        <?supplied-pmid 28298431?>
        <pub-id pub-id-type="pmid">28298431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>C-L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MECAT: fast mapping, error correction, and de novo assembly for single-molecule sequencing reads</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>1072</fpage>
        <lpage>1074</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4432</pub-id>
        <?supplied-pmid 28945707?>
        <pub-id pub-id-type="pmid">28945707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolmogorov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Assembly of long, error-prone reads using repeat graphs</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>540</fpage>
        <lpage>546</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0072-8</pub-id>
        <?supplied-pmid 30936562?>
        <pub-id pub-id-type="pmid">30936562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate long-read assembly with wtdbg2</article-title>
        <source>Nat. Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>155</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0669-3</pub-id>
        <?supplied-pmid 31819265?>
        <pub-id pub-id-type="pmid">31819265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Efficient assembly of nanopore reads via highly accurate and intact error correction</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>60</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-20236-7</pub-id>
        <?supplied-pmid 33397900?>
        <pub-id pub-id-type="pmid">33397900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weirather</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive comparison of Pacific Biosciences and Oxford Nanopore Technologies and their applications to transcriptome analysis</article-title>
        <source>F1000Research</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>100</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.10571.2</pub-id>
        <?supplied-pmid 28868132?>
        <pub-id pub-id-type="pmid">28868132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A universal SNP and small-indel variant caller using deep neural networks</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>983</fpage>
        <lpage>987</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4235</pub-id>
        <?supplied-pmid 30247488?>
        <pub-id pub-id-type="pmid">30247488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>A multi-task convolutional deep neural network for variant calling in single molecule sequencing</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>998</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09025-z</pub-id>
        <?supplied-pmid 30824707?>
        <pub-id pub-id-type="pmid">30824707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahsan</surname>
            <given-names>MU</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>NanoCaller for accurate detection of SNPs and indels in difficult-to-map regions from long-read sequencing by haplotype-aware deep neural networks</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>261</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02472-2</pub-id>
        <?supplied-pmid 34488830?>
        <pub-id pub-id-type="pmid">34488830</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafin</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype-aware variant calling with PEPPER-Margin-DeepVariant enables high accuracy in nanopore long-reads</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>1322</fpage>
        <lpage>1332</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01299-w</pub-id>
        <?supplied-pmid 34725481?>
        <pub-id pub-id-type="pmid">34725481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Symphonizing pileup and full-alignment for deep learning-based long-read variant calling</article-title>
        <source>Nat. Comput. Sci.</source>
        <year>2022</year>
        <volume>2</volume>
        <fpage>797</fpage>
        <lpage>803</lpage>
        <pub-id pub-id-type="doi">10.1038/s43588-022-00387-x</pub-id>
        <?supplied-pmid 38177392?>
        <pub-id pub-id-type="pmid">38177392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly of haplotype-resolved genomes with trio binning</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>1174</fpage>
        <lpage>1182</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jarvis</surname>
            <given-names>ED</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Semi-automated assembly of high-quality diploid human reference genomes</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>611</volume>
        <fpage>519</fpage>
        <lpage>531</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-05325-5</pub-id>
        <?supplied-pmid 36261518?>
        <pub-id pub-id-type="pmid">36261518</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rautiainen</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Telomere-to-telomere assembly of diploid chromosomes with Verkko</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2023</year>
        <volume>41</volume>
        <fpage>1474</fpage>
        <lpage>1482</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-023-01662-6</pub-id>
        <?supplied-pmid 36797493?>
        <pub-id pub-id-type="pmid">36797493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kronenberg</surname>
            <given-names>ZN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Extended haplotype-phasing of long-read de novo genome assemblies using Hi-C</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>1935</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-20536-y</pub-id>
        <?supplied-pmid 33911078?>
        <pub-id pub-id-type="pmid">33911078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Human Genome Structural Variation Consortium</surname>
          </name>
          <etal/>
        </person-group>
        <article-title>Fully phased human genome assembly without parental data using single-cell strand sequencing and long reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>302</fpage>
        <lpage>308</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0719-5</pub-id>
        <pub-id pub-id-type="pmid">33288906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campoy</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gamete binning: chromosome-level and haplotype-resolved genome assembly enabled by high-throughput single-cell sequencing of gamete genomes</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>306</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02235-5</pub-id>
        <?supplied-pmid 33372615?>
        <pub-id pub-id-type="pmid">33372615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Digestion-ligation-only Hi-C is an efficient and cost-effective method for chromosome conformation capture</article-title>
        <source>Nat. Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>754</fpage>
        <lpage>763</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0111-2</pub-id>
        <?supplied-pmid 29700467?>
        <pub-id pub-id-type="pmid">29700467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>HS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromosome-scale assembly comparison of the Korean Reference Genome KOREF from PromethION and PacBio with Hi-C mapping information</article-title>
        <source>GigaScience</source>
        <year>2019</year>
        <volume>8</volume>
        <fpage>giz125</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giz125</pub-id>
        <?supplied-pmid 31794015?>
        <pub-id pub-id-type="pmid">31794015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wenger</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate circular consensus long-read sequencing improves variant detection and assembly of a human genome</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>1155</fpage>
        <lpage>1162</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0217-9</pub-id>
        <?supplied-pmid 31406327?>
        <pub-id pub-id-type="pmid">31406327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Concepcion</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Haplotype-resolved de novo assembly using phased assembly graphs with hifiasm</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>170</fpage>
        <lpage>175</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01056-5</pub-id>
        <?supplied-pmid 33526886?>
        <pub-id pub-id-type="pmid">33526886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HiCanu: accurate assembly of segmental duplications, satellites, and allelic variants from high-fidelity long reads</article-title>
        <source>Genome Res.</source>
        <year>2020</year>
        <volume>30</volume>
        <fpage>1291</fpage>
        <lpage>1305</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.263566.120</pub-id>
        <?supplied-pmid 32801147?>
        <pub-id pub-id-type="pmid">32801147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype-resolved assembly of diploid genomes without parental data</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>1332</fpage>
        <lpage>1335</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-022-01261-x</pub-id>
        <?supplied-pmid 35332338?>
        <pub-id pub-id-type="pmid">35332338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bankevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bzikadze</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Kolmogorov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Antipov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Multiplex de Bruijn graphs enable genome assembly from long, high-fidelity reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>1075</fpage>
        <lpage>1081</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-022-01220-6</pub-id>
        <?supplied-pmid 35228706?>
        <pub-id pub-id-type="pmid">35228706</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and assembly of a human genome with ultra-long reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>338</fpage>
        <lpage>345</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4060</pub-id>
        <?supplied-pmid 29431738?>
        <pub-id pub-id-type="pmid">29431738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frei</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultralong Oxford nanopore reads enable the development of a reference-grade perennial ryegrass genome assembly</article-title>
        <source>Genome Biol. Evol.</source>
        <year>2021</year>
        <volume>13</volume>
        <fpage>evab159</fpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evab159</pub-id>
        <?supplied-pmid 34247248?>
        <pub-id pub-id-type="pmid">34247248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Yorke</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Reducing storage requirements for biological sequence comparison</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>3363</fpage>
        <lpage>3369</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth408</pub-id>
        <?supplied-pmid 15256412?>
        <pub-id pub-id-type="pmid">15256412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap and miniasm: fast mapping and de novo assembly for noisy long sequences</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>2103</fpage>
        <lpage>2110</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw152</pub-id>
        <?supplied-pmid 27153593?>
        <pub-id pub-id-type="pmid">27153593</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>The fragment assembly string graph</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>ii79</fpage>
        <lpage>ii85</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti1114</pub-id>
        <?supplied-pmid 16204131?>
        <pub-id pub-id-type="pmid">16204131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Grasso</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sharlow</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>Multiple sequence alignment using partial order graphs</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>452</fpage>
        <lpage>464</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.452</pub-id>
        <?supplied-pmid 11934745?>
        <pub-id pub-id-type="pmid">11934745</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <?supplied-pmid 29750242?>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>AnO(ND) difference algorithm and its variations</article-title>
        <source>Algorithmica</source>
        <year>1986</year>
        <volume>1</volume>
        <fpage>251</fpage>
        <lpage>266</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01840446</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kamath</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Shomorony</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Courtade</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Tse</surname>
            <given-names>DN</given-names>
          </name>
        </person-group>
        <article-title>HINGE: long-read assembly achieves optimal repeat resolution</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>747</fpage>
        <lpage>756</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.216465.116</pub-id>
        <?supplied-pmid 28320918?>
        <pub-id pub-id-type="pmid">28320918</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Benchmarking challenging small variants with linked and long reads</article-title>
        <source>Cell Genom.</source>
        <year>2022</year>
        <volume>2</volume>
        <fpage>100128</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100128</pub-id>
        <?supplied-pmid 36452119?>
        <pub-id pub-id-type="pmid">36452119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guan</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying and removing haplotypic duplication in primary genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>2896</fpage>
        <lpage>2898</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa025</pub-id>
        <?supplied-pmid 31971576?>
        <pub-id pub-id-type="pmid">31971576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolmogorov</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>
          <italic>Scalable nanopore sequencing of human genomes provides a comprehensive view of haplotype-resolved variation and methylation</italic>
        </article-title>
        <source>Nat. Methods</source>
        <year>2023</year>
        <volume>20</volume>
        <fpage>1483</fpage>
        <lpage>1492</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-023-01993-x</pub-id>
        <?supplied-pmid 37710018?>
        <pub-id pub-id-type="pmid">37710018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafin</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and the Shasta toolkit enable efficient de novo assembly of eleven human genomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>1044</fpage>
        <lpage>1053</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0503-6</pub-id>
        <?supplied-pmid 32686750?>
        <pub-id pub-id-type="pmid">32686750</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Berkeley</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Seppey</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Simão</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>BUSCO update: novel and streamlined workflows along with broader and deeper phylogenetic coverage for scoring of eukaryotic, prokaryotic, and viral genomes</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2021</year>
        <volume>38</volume>
        <fpage>4647</fpage>
        <lpage>4654</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msab199</pub-id>
        <?supplied-pmid 34320186?>
        <pub-id pub-id-type="pmid">34320186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rhie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Merqury: reference-free quality, completeness, and phasing assessment for genome assemblies</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>245</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02134-9</pub-id>
        <?supplied-pmid 32928274?>
        <pub-id pub-id-type="pmid">32928274</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oppenheimer</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A reference genome assembly of American bison, Bison bison bison</article-title>
        <source>J. Hered.</source>
        <year>2021</year>
        <volume>112</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="doi">10.1093/jhered/esab003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bollas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Au</surname>
            <given-names>KF</given-names>
          </name>
        </person-group>
        <article-title>Nanopore sequencing technology, bioinformatics and applications</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>1348</fpage>
        <lpage>1365</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-01108-x</pub-id>
        <?supplied-pmid 34750572?>
        <pub-id pub-id-type="pmid">34750572</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garg</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromosome-scale, haplotype-resolved assembly of human genomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>309</fpage>
        <lpage>312</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0711-0</pub-id>
        <?supplied-pmid 33288905?>
        <pub-id pub-id-type="pmid">33288905</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chin</surname>
            <given-names>CS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nonhybrid, finished microbial genome assemblies from long-read SMRT sequencing data</article-title>
        <source>Nat. Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>563</fpage>
        <lpage>569</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2474</pub-id>
        <?supplied-pmid 23644548?>
        <pub-id pub-id-type="pmid">23644548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Šošić</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Šikić</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Edlib: a C/C ++ library for fast, exact sequence alignment using edit distance</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>1394</fpage>
        <lpage>1395</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw753</pub-id>
        <?supplied-pmid 28453688?>
        <pub-id pub-id-type="pmid">28453688</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Savaresi, S. M. &amp; Boley, D. L. On the performance of bisecting K-means and PDDP. in <italic>Proceedings of the 2001 SIAM International Conference on Data Mining.</italic> 1–14 (2001).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Aggressive assembly of pyrosequencing reads with mates</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>2818</fpage>
        <lpage>2824</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn548</pub-id>
        <?supplied-pmid 18952627?>
        <pub-id pub-id-type="pmid">18952627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaser</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sović</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Nagarajan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Šikić</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate de novo genome assembly from long uncorrected reads</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>737</fpage>
        <lpage>746</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.214270.116</pub-id>
        <?supplied-pmid 28100585?>
        <pub-id pub-id-type="pmid">28100585</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saveliev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vyahhi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>QUAST: quality assessment tool for genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1072</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt086</pub-id>
        <?supplied-pmid 23422339?>
        <pub-id pub-id-type="pmid">23422339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A synthetic-diploid benchmark for accurate variant-calling evaluation</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>595</fpage>
        <lpage>597</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0054-7</pub-id>
        <?supplied-pmid 30013044?>
        <pub-id pub-id-type="pmid">30013044</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">The Global Alliance for Genomics and Health Benchmarking Team et al. Best practices for benchmarking germline small-variant calls in human genomes. <italic>Nat. Biotechnol</italic>. <bold>37</bold>, 555–560 (2019).</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zook</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A robust benchmark for detection of germline large deletions and insertions</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>1347</fpage>
        <lpage>1355</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0538-8</pub-id>
        <?supplied-pmid 32541955?>
        <pub-id pub-id-type="pmid">32541955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>English</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Menon</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Metcalf</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Truvari: refined structural variant comparison preserves allelic diversity</article-title>
        <source>Genome Biol.</source>
        <year>2022</year>
        <volume>23</volume>
        <fpage>271</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02840-6</pub-id>
        <?supplied-pmid 36575487?>
        <pub-id pub-id-type="pmid">36575487</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10997618</article-id>
    <article-id pub-id-type="pmid">38580638</article-id>
    <article-id pub-id-type="publisher-id">47349</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-024-47349-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>De novo diploid genome assembly using long noisy reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Nie</surname>
          <given-names>Fan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0801-7574</contrib-id>
        <name>
          <surname>Ni</surname>
          <given-names>Peng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Neng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Jun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Zhenyu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4680-0682</contrib-id>
        <name>
          <surname>Xiao</surname>
          <given-names>Chuanle</given-names>
        </name>
        <address>
          <email>xiaochuanle@126.com</email>
        </address>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4813-2403</contrib-id>
        <name>
          <surname>Luo</surname>
          <given-names>Feng</given-names>
        </name>
        <address>
          <email>luofeng@clemson.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1516-0480</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Jianxin</given-names>
        </name>
        <address>
          <email>jxwang@mail.csu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f1zfq44</institution-id><institution-id institution-id-type="GRID">grid.216417.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0379 7164</institution-id><institution>School of Computer Science and Engineering, </institution><institution>Central South University, </institution></institution-wrap>Changsha, 410083 China </aff>
      <aff id="Aff2"><label>2</label>Xiangjiang Laboratory, Changsha, 410205 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00xsfaz62</institution-id><institution-id institution-id-type="GRID">grid.412982.4</institution-id><institution-id institution-id-type="ISNI">0000 0000 8633 7608</institution-id><institution>National Center for Applied Mathematics in Hunan and Key Laboratory of Intelligent Computing and Information Processing of Ministry of Education, </institution><institution>Xiangtan University, </institution></institution-wrap>Xiangtan, Hunan 411105 China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f1zfq44</institution-id><institution-id institution-id-type="GRID">grid.216417.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0379 7164</institution-id><institution>Hunan Provincial Key Lab on Bioinformatics, </institution><institution>Central South University, </institution></institution-wrap>Changsha, 410083 China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01g9hkj35</institution-id><institution-id institution-id-type="GRID">grid.464309.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 6431 5677</institution-id><institution>Institute of Nanfan &amp; Seed Industry, </institution><institution>Guangdong Academy of Sciences, </institution></institution-wrap>Guangdong, 510316 China </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/003mfbe21</institution-id><institution>State Key Laboratory of Ophthalmology, Zhongshan Ophthalmic Center, </institution><institution>Sun Yat-sen University #7 Jinsui Road, Tianhe District, </institution></institution-wrap>Guangzhou, China </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/037s24f05</institution-id><institution-id institution-id-type="GRID">grid.26090.3d</institution-id><institution-id institution-id-type="ISNI">0000 0001 0665 0280</institution-id><institution>School of Computing, </institution><institution>Clemson University, </institution></institution-wrap>Clemson, SC 29634-0974 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>2964</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The high sequencing error rate has impeded the application of long noisy reads for diploid genome assembly. Most existing assemblers failed to generate high-quality phased assemblies using long noisy reads. Here, we present PECAT, a <bold>P</bold>hased <bold>E</bold>rror <bold>C</bold>orrection and <bold>A</bold>ssembly <bold>T</bold>ool, for reconstructing diploid genomes from long noisy reads. We design a haplotype-aware error correction method that can retain heterozygote alleles while correcting sequencing errors. We combine a corrected read SNP caller and a raw read SNP caller to further improve the identification of inconsistent overlaps in the string graph. We use a grouping method to assign reads to different haplotype groups. PECAT efficiently assembles diploid genomes using Nanopore R9, PacBio CLR or Nanopore R10 reads only. PECAT generates more contiguous haplotype-specific contigs compared to other assemblers. Especially, PECAT achieves nearly haplotype-resolved assembly on <italic>B. taurus</italic> (Bison×Simmental) using Nanopore R9 reads and phase block NG50 with 59.4/58.0 Mb for HG002 using Nanopore R10 reads.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Most existing assemblers failed to generate high-quality phased assemblies using long noisy reads. Here, the authors present PECAT, a Phased Error Correction and Assembly Tool, for reconstructing diploid genomes from long noisy reads.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Genome assembly algorithms</kwd>
      <kwd>Computational models</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100005825</institution-id>
            <institution>United States Department of Agriculture | National Institute of Food and Agriculture (NIFA)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2023-70029-41309</award-id>
        <principal-award-recipient>
          <name>
            <surname>Luo</surname>
            <given-names>Feng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000153</institution-id>
            <institution>NSF | BIO | Division of Biological Infrastructure (DBI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ABI-1759856</award-id>
        <principal-award-recipient>
          <name>
            <surname>Luo</surname>
            <given-names>Feng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">De novo genome assembly is a fundamental task in genomic research<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. Using long noisy reads from sequencing technologies, such as complete long reads (CLR) sequencing of Pacific Biosciences (PacBio) and Nanopore sequencing of Oxford Technologies (ONT), many assemblers<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR9">9</xref></sup> now can effectively reconstruct high-quality genome sequences for haploid or inbred species. However, a significant fraction of genetic information of a diploid genome is lost in those assemblies and most of them have lots of haplotype switch errors. Because long noisy reads, such as PacBio CLR reads and Nanopore reads, usually contain a 5–15% sequencing error<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, it is difficult to distinguish heterozygotes from sequencing errors in long noisy reads<sup><xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup>, which prevents the diploid assemblers from generating long haplotype-specific contigs. Recently, by combining long noisy reads with additional highly accurate sequencing data, such as parental short reads<sup><xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref></sup>, PacBio HiFi reads<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>, Hi-C reads<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, Strand-seq data<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, or gamete cell data<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, assemblers now can produce more contiguous haplotype-specific contigs. However, the requirements for additional sequencing data increase costs and limit their applications in practice<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR23">23</xref></sup>. Meanwhile, it is easier to identify haplotype differences using high accurate PacBio HiFi reads<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> (&lt; 1% error rate), which has been widely used for haplotype resolved assemblies<sup><xref ref-type="bibr" rid="CR25">25</xref>–<xref ref-type="bibr" rid="CR28">28</xref></sup>. However, the average lengths of HiFi reads (10–25 kb) are shorter than those of long noisy reads. For example, the ultra-long reads of Nanopore are up to 1 M in length and with read N50 &gt; 100 kb<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Longer reads usually help to assemble more contiguous contigs<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. Therefore, it will be useful to develop an assembler that can take advantage of long noisy reads to generate more contiguous haplotype-specific contigs for diploid genomes.</p>
    <p id="Par4">To achieve high-quality assemblies, error correction is usually a useful step for genome assembling using long noisy reads. One challenge for correct-then-assemble pipelines in assembling a diploid genome using long noisy reads is how to retain heterozygotes during error correction. If the sequencing error rate exceeds haplotype divergence, current correct-then-assemble pipelines<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup> eliminate heterozygotes as sequencing errors or mixed alleles of different haplotypes in a read. Therefore, corrected reads don’t contain heterozygote information for haplotype phasing. Assemblers, such as FALCON-Unzip<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, used raw reads instead of corrected reads in their “unzip” phasing step, then mapped the raw reads to the corrected reads for the later diploid assembly. This has led to assembly errors due to the heterozygote errors in the corrected reads and mapping errors between corrected reads and raw reads as the length of reads and their SNP position changed after correction<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. Furthermore, phasing raw reads is more difficult due to their high error rate.</p>
    <p id="Par5">Another challenge is partitioning reads according to their haplotypes in the phasing step. After error correction, there still are sequencing errors left in corrected reads. The error profile of corrected reads is also more complex than that of PacBio HiFi reads. Due to the sequencing errors, a significant fraction of reads is difficult to be phased to the correct haplotypes. This leads to inconsistent overlaps<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> among reads, whose reads come from different haplotypes or different copies of the segmental duplication. The inconsistent overlaps can cause haplotype switch errors or unresolved repeats. Accurately phasing the reads, and then identifying and removing inconsistent overlaps is important in overlap-graph-based diploid genome assembly. Even if we assemble the genome using PacBio HiFi reads, there is still need error correction step to improve the phasing accuracy<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. The higher error rate in corrected long noisy reads makes phasing and identifying inconsistent overlaps more difficult. It is necessary to design a more accurate and robust method to identify inconsistent overlaps for long noisy read-based assemblers.</p>
    <p id="Par6">Furthermore, to construct two haplotypes of diploid genomes, the assemblers often need higher coverage of sequencing data. However, with the increasing amount of sequencing data, the running time of assembly increases nonlinearly. Therefore, assembling large diploid genomes at an acceptable time is another challenge. Overlap-graph-based assemblers have their unique advantages to assemble diploid genomes since the overlaps can be reused in subsequent steps once they are found. This helps to design an efficient multi-round assembly strategy. The overlap-graph-based assemblers usually use seed (i.e., k-mers, minimizers<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>) based methods to find candidate overlaps, then perform local alignment to find the true overlaps. The local alignment is the major computational bottleneck of overlap-graph-based approaches. Although skipping local alignment can accelerate the overlap-finding step<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>, it leads to lots of false-positive overlaps and introduces errors in assembly graphs. String-graph-based<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> approaches, a type of overlap-graph-based approach, ignore the reads contained by other reads and mark most edges in the graph as transitive edges<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> that don’t contribute to the construction of contigs. Then, it is not necessary to perform local alignment on those read pairs. Therefore, it is possible to design a fast string-graph-based diploid genome assembler by minimizing the number of local alignments needed.</p>
    <p id="Par7">In this work, we present PECAT, a <bold>P</bold>hased <bold>E</bold>rror <bold>C</bold>orrection and <bold>A</bold>ssembly <bold>T</bold>ool, designed to reconstruct diploid genomes from long noisy reads, including PacBio CLR reads and Nanopore reads. PECAT follows the correct-then-assemble strategy, including a haplotype-aware error correction module, which can retain heterozygote alleles while correcting sequencing errors, and a two-round string graph-based assembly module. To accelerate the assembling, PECAT only performs local alignment when it is necessary instead of performing local alignments on all candidate overlaps. PECAT outputs two sets of contigs either in primary/alternate format (long contigs with the mosaic of homologous haplotypes and short haplotype-specific contigs) or in the dual assembly format<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> (two sets of long contigs with the mosaic of homologous haplotypes). PECAT can efficiently assemble diploid genomes using Nanopore R9, PacBio CLR or more accurate Nanopore R10 reads only and generate more contiguous haplotype-specific contigs compared to other assemblers.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Result</title>
    <sec id="Sec3">
      <title>Haplotype-aware error correction</title>
      <p id="Par8">Our error correction method (Fig. <xref rid="Fig1" ref-type="fig">1a</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>) is based on the partial-order alignment (POA) graph<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> method. For the template read to be corrected, a POA graph is built from the alignment of supporting reads. Then, the path with the highest weight is found in the POA graph to construct the consensus sequence for the template read. However, if the sequencing error rate exceeds haplotype divergence, current methods inevitably select supporting reads from different haplotypes. This causes either heterozygote alleles in the template reads to be eliminated as sequencing errors or heterozygous alleles from different haplotypes to be mixed in corrected reads.<fig id="Fig1"><label>Fig. 1</label><caption><title>Overview of PECAT.</title><p><bold>a</bold> Haplotype-aware error correction method. The reads in different colors (in green or in yellow) are from different haplotypes. The reads with a dark gray background color indicate that they are not selected. The supporting reads that are more likely from the same haplotype are selected to correct the template read. <bold>b</bold> The first round of assembly. PECAT finds overlaps between reads. The dashed lines indicate there are overlaps between reads. Our string-graph-based assembler is performed to construct haplotype-collapsed contigs. The reads in green or in yellow are from heterozygosity regions. The same color indicates that the reads come from the same haplotype. The reads in grey are from homozygosity regions. <bold>c</bold> The second round of assembly. PECAT identifies inconsistent overlaps by calling and analyzing SNP alleles in reads. After removing inconsistent overlaps from the overlaps found in the first round of assembly, PECAT performs our string-graph-based assembler again to construct the contigs in the primary/alternate format or the dual assembly format.</p></caption><graphic xlink:href="41467_2024_47349_Fig1_HTML" id="d33e464"/></fig></p>
      <p id="Par9">To maintain the heterozygote alleles in the template read, we need to select supporting reads from the same haplotype to correct it. After analyzing the POA graph, we have found that the difference between random sequencing errors and heterozygotes can be reflected in the POA graph. In the case of heterozygotes, there are two dominant parallel branches in the POA graph. In the case of random errors, there tends to be only one dominant branch (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1b</xref>). Based on this finding, we design a scoring algorithm to estimate the likelihood that the supporting read and the template read are from the same haplotype (<bold>Methods</bold>). For each position at which there are two dominant parallel branches, if the supporting read and the template read pass through the same dominant branch, the score is increased by 1 and if the supporting read and the template read pass through the different dominant branches, the score is decreased by 1 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1c</xref><bold>)</bold>. A higher score means that the template read and the supporting read are more likely from the same haplotype. If the supporting reads come from different haplotypes, the histogram of scores of all supporting reads should show two peaks (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1d</xref><bold>)</bold>. Then, we select the high-scoring supporting reads, which are very likely to be in the same haplotype as the template read, to correct the template read. To further increase the likelihood of selecting supporting reads in the same haplotype, we assign different weights to the reads according to their score. The higher the score of a read, the larger its weight is assigned (<bold>Methods</bold>). Then, we remove unselected reads in the POA graph by assigning their weights to 0. Finally, we use a dynamic programming approach to find the path with the highest weight in the POA graph and concatenated the nodes in the path, and generate the consensus sequence (<bold>Methods</bold>).</p>
      <p id="Par10">We evaluate the performance of the selection method on seven diploid datasets of <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison×Simmental) and HG002 (Nanopore R9), all with reads classified by the trio-binning algorithm<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> (<bold>Methods</bold>). As shown in Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>, without the selection method, 36.7%, 31.5%, 41.1%, 28.1%, 33.8%, 37.2% and 27.4% of supporting reads are inconsistent reads, respectively, which are from the haplotype different from the one of template read. Meanwhile, there are only 2.8%, 3.5% 4.9%, 3.6%, 4.3%, 2.9%, and 4.2% inconsistent reads in selected supporting reads, respectively. After further re-weighting the scores, the percentages of inconsistent reads are reduced to 2.1%, 3.1%, 4.0%, 3.1%, 3.5%, 2.3%, and 3.4%, respectively.</p>
      <p id="Par11">Since most of the selected supporting reads are from the same haplotype of the template read, most heterozygote alleles in the template read are correctly retained in our error correction method. We compare our method with other methods including Canu<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, MECAT2<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, and NECAT<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> on simulated PacBio CLR data and Nanopore data (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>, Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>, and Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>). The overall accuracies of corrected reads are similar, which exceeds 99%. However, the accuracies of SNP alleles in corrected reads are less than 80% for Canu and less than 60% for MECAT and NECAT, which are far worse than those of raw reads and reads corrected by PECAT. When the heterozygosity rate of simulated reads is greater than or equal to 0.0005, the accuracy of SNP alleles in reads corrected by PECAT is greater than 99%, which exceeds that of raw reads (96% or 98%). However, when the heterozygosity rate of simulated reads is equal to 0.0001, the accuracy of SNP alleles in reads corrected by PECAT is reduced to 92% ~ 94%, which is less than that of raw reads (96% ~ 98%). Therefore, for high heterozygosity genome regions (&gt;= 0.0005), our haplotype-aware error correction can preserve the SNPs well. However, for low heterozygosity genome regions (&lt; 0.0005), we need to combine with other methods to improve the accuracy of SNP calling (<bold>Methods</bold>).<fig id="Fig2"><label>Fig. 2</label><caption><title>Performance comparison of error correction.</title><p><bold>a</bold> Accuracy of raw and corrected reads and accuracy of SNP alleles in raw and corrected reads on the simulated datasets with different heterozygosity rates. <bold>b</bold> Accuracy of raw reads and corrected reads by NECAT and PECAT in difficult-to-map regions and low-complexity regions of HG002 reference genome. <bold>c, d</bold> Consistency, and completeness of raw reads and corrected reads by Canu, FALCON, MECAT2, NECAT, and PECAT on the seven diploid datasets. The metrics by Canu on <italic>B. taurus</italic> (PacBio CLR and ONT) and HG002 (ONT) and the metrics by FALCON on <italic>B. taurus</italic> (PacBio CLR) are excluded because they could not finish correcting in three weeks. Consistency is defined as <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum \max ({k}_{p},{k}_{m})/\sum ({k}_{p}+{k}_{m})$$\end{document}</tex-math><mml:math id="M2"><mml:mo>∑</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq1.gif"/></alternatives></inline-formula>, in which <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{p}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{m}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq3.gif"/></alternatives></inline-formula> are the number of paternal and maternal haplotype-specific k-mers in each read. Completeness is the percentage of parent-specific k-mers (occurrences <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 4$$\end{document}</tex-math><mml:math id="M8"><mml:mo>≥</mml:mo><mml:mn>4</mml:mn></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq4.gif"/></alternatives></inline-formula>) in the 40X longest reads. <bold>e</bold> Consistency of <italic>D. melanogaster</italic> (ISO1 × A4) raw reads and corrected reads by the different methods. Each point corresponds to a read. Its coordinate gives the proportion of the parental specific k-mers in the read, where k is 18. All 40X longest reads are shown in each sub-figure.</p></caption><graphic xlink:href="41467_2024_47349_Fig2_HTML" id="d33e655"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Fast string graph-based assembler</title>
      <p id="Par12">After error correction, PECAT implements two rounds of string graph-based assembly. In each round of assembly, we first construct the overlaps between the corrected reads using the seed-based alignment method (minimap2<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>), which allows us to build the overlaps quickly. However, seed-based alignment can bring low-quality overlaps with low identity or with long overhangs. Those low-quality overlaps could introduce errors during assembling. Performing local alignment on overlaps to identify low-quality ones becomes the major computational cost. To speed up the assembling, PECAT only performs local alignments when it is necessary during the construction of the string graph. (<bold>Methods</bold>). First, to reduce overhangs of overlaps, we use diff algorithm<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> to extend the candidate overlaps to the ends of the reads. Here, we only perform local alignment on overhangs instead of on the whole overlap. We remove the overlaps if their overhangs are still long (<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min ({{{{{\mathrm{100,0.01}}}}}}\cdot l)$$\end{document}</tex-math><mml:math id="M10"><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">100, 0.01</mml:mi><mml:mo>⋅</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq5.gif"/></alternatives></inline-formula> for PacBio reads and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min {({{{{\mathrm{300,0.03}}}}}}\cdot l)$$\end{document}</tex-math><mml:math id="M12"><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">300, 0.03</mml:mi><mml:mo>⋅</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq6.gif"/></alternatives></inline-formula> for Nanopore reads, where <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M14"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq7.gif"/></alternatives></inline-formula> is length of the read). On the diploid datasets of <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison × Simmental) and HG002, 5.3%, 10.3%, 82.2%, 12.8%, 20.0%, 59.4% and 56.3% of candidate overlaps with long overhangs have been considered as low quality and removed, respectively (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). Then, we further filter out the overlaps whose reads are contained in other reads or with low coverage. Only 0.15%, 0.18%, 0.86%, 0.86%, 0.03%, 1.23%, and 0.15% of overlaps remained on the above seven diploid datasets (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). We then construct a directed string graph from the remaining overlaps. We find the transitive edges using Myers’ algorithm<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> and mark them as inactive edges, which are not used for constructing contigs. On the above diploid datasets, only 25.1%, 16.7%, 16.3%, 18.5%, 20.7%, 15.4%, and 23.6% of edges are active (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>).</p>
      <p id="Par13">To remove low-quality edges in the string graph, we calculate the identity of the overlaps (the active edges) in the string graph using local alignments. Since most edges have been marked as inactive, we only need to perform local alignments for a small portion of overlaps. On the above diploid datasets, 2.1%, 12.2%, 9.5%, 2.2%, 13.2%, 1.8%, and 6.9% of active edges have been removed because their identities are less than the threshold (<bold>Methods</bold>) (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). After the above step, some paths in the graphs connected by low-quality edges are broken. Those broken paths need to be connected using the transitive edges that have been labeled as inactive edges. We then select transitive edges with the longest alignment and their identity greater than the threshold to connect the broken paths. On the above diploid datasets, about 0.67%, 0.12%, 0.15%, 0.09%, 0.13%, 0.05%, and 0.16% of transitive edges have been reactivated (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). Finally, we attempt to use the contained reads to connect the broken paths, and about 0.30%, 0.39%, 0.17%, 0.11%, 0.77%, 0.13%, and 0.45% of new edges are added to the graph on the above diploid datasets (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). In the first round of assembly (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>), PECAT finds linear paths from this string graph and constructs haplotype-collapsed contigs. In the second round of assembly (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>), PECAT identifies and removes inconsistent overlaps (next Section) in the string graph, and then generates two sets of contigs in primary/alternate format or dual assembly format. After generating contigs, we use corrected reads (CLR data) or raw reads (Nanopore data) to polish them to improve the quality (<bold>Methods</bold>).</p>
    </sec>
    <sec id="Sec5">
      <title>Identification of inconsistent overlaps</title>
      <p id="Par14">The inconsistent overlaps connect reads from different haplotypes or different copies of the segmental duplication in the overlap graph. They cause haplotype switch errors or unresolved repeats (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). After identifying and filtering out inconsistent overlaps, only the overlaps between reads from the same haplotype or the same copies of the segmental duplication are left, and then the assembler can naturally generate contigs of two haplotypes. Since our corrected reads contain allele information, we may use the SNP allele information to identify inconsistent overlaps. If the SNP alleles on a pair of reads are different, these two reads should come from different haplotypes and the overlaps between them should be inconsistent. At the error correction step, we have scored the possibility that two raw reads come from the same haplotype. However, the accuracy of the previous scoring that is based on the alignments between two raw reads cannot meet the requirements for identifying inconsistent overlaps. Therefore, we developed a read-level SNP caller and a read grouping method for identifying inconsistent overlaps.</p>
      <p id="Par15">First, we map all corrected reads onto the haplotype-collapsed contigs from the first round of assembly using minimap2<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. We call the heterozygous SNP sites based on the base frequency of the alignments (<bold>Methods</bold>). Then, we set each read as a template read and collect a set of reads that have the common SNP sites with it. We cluster the set of reads according to the SNP alleles in reads. The reads from the same haplotype are more likely to be clustered into the same subgroup. We then verify and correct the SNP alleles in the template read using other reads in the same subgroups. After identifying SNP alleles in each read, we remove the inconsistent overlaps using the SNP information from the candidate overlaps found in the first round of assembly. Then, we construct the string graph again. For high heterozygosity genome regions (&gt;= 0.0005), this inconsistent overlap identification approach works well due to the high accuracy of SNPs in corrected reads. However, for low heterozygosity genome regions (&lt; 0.0005), the SNP caller using corrected reads only can not achieve high performance in inconsistent overlap identification as the accuracy of SNPs is decreased dramatically in corrected reads for those genome regions. Therefore, we combine raw reads to identify and filter inconsistent overlaps. We first use corrected reads to identify inconsistent overlaps. Then, we call SNPs using raw reads and identify inconsistent overlaps again (<bold>Methods</bold>). For Nanopore reads, we have used Clair3<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> to call heterozygous SNP sites. For PacBio CLR reads, we do not have a tool to call SNPs from raw reads now.</p>
      <p id="Par16">We evaluate the performance of the inconsistent overlaps identification method using the haplotype reads classified by the trio-binning algorithm<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. As shown in Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>, compared with the first round of assemblies, the percentages of inconsistent overlaps in simplified graphs of the second round of assemblies of diploid datasets <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison × Simmental) and HG002 decrease sharply. The percentages of inconsistent overlaps have decreased from 36.98%, 16.00%, 15.94%, 36.55%, 16.62%, 18.08%, and 37.45% in the first round of assemblies to 0.32%, 0.57%, 0.90%, 0.63%, 0.79%, 0.03%, and 1.09% in the second round of assemblies, respectively. For the three Nanopore datasets, we compare the performance of the method using corrected reads, raw reads, and both (Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>). Using both raw and corrected reads, we get lower percentages of inconsistent overlaps in simplified graphs of the second round of assemblies of all three Nanopore datasets. The high performance of the inconsistent overlap identification method ensures that PECAT can generate the haplotype-specific contigs effectively. After filtering inconsistent overlaps, collapsed regions in the first round of assembly are separated in the second round of assembly. The sizes of alternate contigs are close to their corresponding reference genome in the second round of assembly (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>).</p>
      <p id="Par17">Moreover, our inconsistent overlap identification method can also help solve nearly identical repeats without knowing the number of their copies. The clustering step can automatically separate nearly identical repeats if there are SNPs that can divide the repeats. After filtering out the inconsistent overlaps at the repeats, PECAT can solve the repeat to generate contiguous contigs in the second round of assembly. As a result, PECAT achieves more contiguous assemblies in the second round of assembly on most of our diploid datasets (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>). As shown in Supplementary Figs. <xref rid="MOESM1" ref-type="media">3</xref> and <xref rid="MOESM1" ref-type="media">4</xref>, PECAT perfectly solves repeats in the NCTC9024 and NCTC9006 datasets and reconstructs two circle contigs, while other assemblers obtain fragment results<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR37">37</xref></sup>.</p>
    </sec>
    <sec id="Sec6">
      <title>Performance of PECAT error correction method</title>
      <p id="Par18">We evaluate the performance of the PECAT error correction method using four PacBio diploid datasets: <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), and three Nanopore diploid datasets: <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison × Simmental), and HG002. We compare PECAT with the error correction methods in the other four tools, including Canu<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, FALCON<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, MECAT2<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, and NECAT<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> (Fig. <xref rid="Fig2" ref-type="fig">2 b–e</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref><bold>)</bold>. All methods have reported high accuracy (&gt;98.6%). We also evaluate the performance of PECAT and NECAT on the difficult-to-map regions<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> and low-complexity regions of HG002 (<bold>Methods</bold>). On average, the accuracies of PECAT are 0.75% higher than those of NECAT, and the accuracy of corrected reads on these regions is similar to those on normal regions (Fig. <xref rid="Fig2" ref-type="fig">2b</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">7</xref><bold>)</bold>. We then assess the haplotype-specific k-mers completeness and consistency of corrected reads (<bold>Methods</bold>). These two metrics can evaluate the ability to retain consistent heterozygote alleles. The reads corrected by PECAT have higher completeness and consistency in all datasets (Fig. <xref rid="Fig2" ref-type="fig">2c, d</xref><bold>)</bold>. Especially, haplotype-specific k-mers consistencies of the reads corrected by PECAT are greater than or equal to 99.4% on all datasets, while haplotype-specific k-mers consistencies of the reads corrected by other methods are all less than or equal to 94.8%. The haplotype-specific k-mers completenesses of reads corrected by PECAT are also higher than those of reads corrected by other methods, especially for three Nanopore datasets. We plot the raw read and corrected reads using haplotype-specific k-mers for the seven datasets. As shown in Fig. <xref rid="Fig2" ref-type="fig">2e</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">5</xref>–<xref rid="MOESM1" ref-type="media">10</xref>, PECAT effectively avoids mixing heterozygous alleles from two haplotypes and its corrected reads tend to contain only one type of haplotype-specific k-mer. In summary, the reads corrected by PECAT contain more haplotype-specific k-mers than those corrected by other methods.</p>
    </sec>
    <sec id="Sec7">
      <title>Performance of PECAT assembler</title>
      <p id="Par19">We also assess the performance of the PECAT assembler using four PacBio diploid datasets: <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), and three Nanopore diploid datasets: <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison × Simmental) and HG002. We compare PECAT with four diploid genome assembly pipelines: Canu<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>+purge_dups<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, FALCON-Unzip<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, Flye<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>+HapDup<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR40">40</xref></sup>, and Shasta<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref><bold>)</bold>. We evaluate assembled genomes with respect to the assembly size, contiguity (contig NG50 and phase block NG50), and qualities (BUSCO<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, the base quality using pomosix (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/pomoxis">https://github.com/nanoporetech/pomoxis</ext-link>) and merqury<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>, ‘Intra-block switch error’ from merqury, and the hamming error rate). (<bold>Methods</bold>).</p>
      <p id="Par20">For four PacBio CLR datasets, all pipelines output the contigs in primary/alternate format. As shown in Table <xref rid="Tab1" ref-type="table">1</xref>, the sizes of both primary and alternate contigs of all four assemblies are close to those of their corresponding reference genome, except the alternate contigs of <italic>S. cerevisiae</italic> (SK1×Y12) genome assembled by Canu+Purge_dups. Compared to the other two pipelines, PECAT obtains the highest NG50 with 0.8/0.8, 14.3/7.8, 24.5/11.9, and 72.4/2.8 Mb and the highest ‘phase block NG50’ with 0.8/0.8, 12.1/7.4, 16.1/11.8, 4.5/2.4 Mb for all four assemblies. As shown in Supplementary Figs. <xref rid="MOESM1" ref-type="media">11</xref>–<xref rid="MOESM1" ref-type="media">14</xref>, the alternate contigs generated by all pipelines are haplotigs. Unlike the other two pipelines, most primary contigs by PECAT are also haplotigs except those of <italic>B. taurus</italic> (Angus×Brahman). These results are consistent with the results of the ‘Hamming error’, where the ‘Hamming error’ of primary contigs of <italic>B. taurus</italic> (Angus×Brahman) is exceptionally high. All pipelines have similar ‘Quality’ and BUSCO scores, except that Canu+Purge_dups has low BUSCO scores on alternate contigs of <italic>S. cerevisiae</italic>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance comparison of assembly on PacBio CLR datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Pipeline</th><th>Size (Mb)</th><th>NG50 (Mb)</th><th>Quality (reference-based)</th><th>Quality (k-mer- based)</th><th>BUSCO (%)</th><th>Hamming error (%)</th><th>Phase block NG50 (Mb)</th><th>Intra-block switch error (%)</th></tr></thead><tbody><tr><td rowspan="4"><p><italic>S. cerevisiae</italic></p><p>SK1×Y12</p><p>200X</p></td><td>Ref</td><td>12.1/12.0</td><td>0.9/0.9</td><td>–/–</td><td>47.3/49.4</td><td>99.6/99.6</td><td>0.13/0.03</td><td>0.9/0.9</td><td>0.13/0.03</td></tr><tr><td>Canu + Purge_dups</td><td>12.4/4.8</td><td>0.8/0.0</td><td>25.6/30.5</td><td>38.9/36.2</td><td>98.7/28.1</td><td>39.24/6.25</td><td>0.0/0.0</td><td>9.92/4.50</td></tr><tr><td>FALCON-Unzip</td><td>12.1/11.1</td><td>0.8/0.4</td><td>40.5/42.2</td><td>44.5/45.0</td><td>99.4/95.8</td><td>21.58/0.98</td><td>0.5/0.4</td><td>0.40/0.22</td></tr><tr><td>PECAT</td><td>12.3/11.8</td><td>0.8/0.8</td><td>35.9/36.0</td><td>39.1/39.7</td><td>96.0/93.8</td><td>1.65/0.49</td><td>0.8/0.8</td><td>0.16/0.09</td></tr><tr><td rowspan="4"><p><italic>A. thaliana</italic></p><p>Col-0×Cvi-0</p><p>164X</p></td><td>Ref</td><td>133.3/119.7</td><td>26.2/23.20</td><td>–/–</td><td>Inf/Inf</td><td>99.3/99.2</td><td>0.12/0.01</td><td>12.1/23.2</td><td>0.11/0.01</td></tr><tr><td>Canu + Purge_dups</td><td>129.1/122.6</td><td>6.7/0.1</td><td>28.0/30.4</td><td>24.8/30.7</td><td>98.7/81.7</td><td>37.52/2.65</td><td>0.1/0.1</td><td>2.81/2.45</td></tr><tr><td>FALCON-Unzip*</td><td>140.0/104.9</td><td>8.0/4.3</td><td>40.0/40.0</td><td>30.0/34.9</td><td>98.9/93.6</td><td>15.11/0.98</td><td>3.1/2.4</td><td>0.15/0.19</td></tr><tr><td>PECAT</td><td>130.6/120.4</td><td>14.3/7.8</td><td>34.6/34.7</td><td>25.3/33.2</td><td>98.3/98.2</td><td>2.64/0.21</td><td>12.6/7.8</td><td>0.13/0.13</td></tr><tr><td rowspan="4"><p><italic>D. melanogaster</italic></p><p>ISO1×A4</p><p>200X</p></td><td>Ref</td><td>143.7/140.7</td><td>25.3/25.0</td><td>–/–</td><td>46.5/46.3</td><td>98.7/98.7</td><td>0.06/0.02</td><td>25.3/24.6</td><td>0.06/0.02</td></tr><tr><td>Canu + Purge_dups*</td><td>143.2/129.7</td><td>16.1/0.3</td><td>33.6/34.7</td><td>35.4/35.3</td><td>98.5/87.3</td><td>43.50/3.97</td><td>0.4/0.3</td><td>3.92/3.01</td></tr><tr><td>FALCON-Unzip</td><td>189.7/105.9</td><td>4.0/0.4</td><td>40.5/40.5</td><td>37.1/37.4</td><td>98.8/84.0</td><td>29.31/5.38</td><td>1.0/0.3</td><td>0.34/0.41</td></tr><tr><td>PECAT</td><td>149.6/135.7</td><td>24.5/11.9</td><td>38.5/39.2</td><td>40.8/43.5</td><td>98.7/96.7</td><td>3.00/0.07</td><td>16.1/11.8</td><td>0.05/0.04</td></tr><tr><td rowspan="3"><p><italic>B. taurus</italic></p><p>Angus×Brahman</p><p>135X</p></td><td>Ref</td><td>2580.8/2681.0</td><td>91.1/104.5</td><td>–/–</td><td>43.3/43.8</td><td>93.6/95.6</td><td>0.10/0.04</td><td>21.8/30.5</td><td>0.08/0.03</td></tr><tr><td>FALCON-Unzip*</td><td>2713.4/2453.7</td><td>31.4/2.0</td><td>39.2/38.5</td><td>39.4/39.0</td><td>95.4/86.3</td><td>28.15/1.97</td><td>3.2/1.8</td><td>0.21/0.22</td></tr><tr><td>PECAT</td><td>2744.7/2447.6</td><td>72.4/2.8</td><td>34.6/34.6</td><td>39.9/40.1</td><td>94.8/87.0</td><td>29.46/0.47</td><td>4.5/2.4</td><td>0.10/0.09</td></tr></tbody></table><table-wrap-foot><p>‘Size’ is the total number of base pairs in all contigs generated by assemblers. ‘NG50’ is the length of the shortest contig for which longer and equal length contigs cover at least 50 of genome size. The genome sizes of <italic>S. cerevisiae, A. thaliana, D. melanogaster</italic>, and <italic>B. taurus</italic> that we used for evaluation are 12 M, 130 M, 140 M, and 2.7 G, respectively. ‘BUSCO’ is gene completeness evaluated by BUSCO. ‘Quality (reference-based)’ is the metric ‘q50’ evaluated by Pomoxis. ‘Hamming error’ is the fraction of nondominant parental-specific k-mers in a contig. ‘Quality (k-mer-based)’, ‘Phase block NG50’, and ‘Intra-block switch error’ are evaluated by mercury. All assemblies are in primary/alternate format. The primary and alternate contigs are separately reported in each cell. ‘Ref’ is the reference genome. The sources of the reference genomes are illustrated in Supplementary Table <xref rid="MOESM1" ref-type="media">17</xref>. For <italic>B. taurus</italic>, Canu didn’t finish the assembly in 3 weeks, so it is excluded. Asterisks mark previously published assemblies.</p></table-wrap-foot></table-wrap></p>
      <p id="Par21">For three Nanopore datasets, Canu+Purge_dups and Shasta output the contigs in primary/alternate format, Flye+HapDup outputs the contigs in dual assembly format and PECAT can output both formats. As shown in Table <xref rid="Tab2" ref-type="table">2</xref>, the sizes of both two sets of contigs of all three assemblies are close to their corresponding reference genome, except the <italic>A. thaliana</italic> (Col-0×C24) genomes assembled by Canu+Purge_dups. Compared to other pipelines, PECAT obtains higher NG50 for three genomes. The phase block NG50 reported by PECAT is at least 10 times higher than those reported by other pipelines for <italic>A. thaliana</italic> (Col-0×C24) and <italic>B.taurus</italic> (Bison×Simmental). Especially, PECAT reports the assembly with phase block NG50 of 79.6/86.1 Mb for <italic>B. taurus</italic> (Bison×Simmental), which exceeds the assembly with phase block N50 of 68.5/70.6 Mb reported by the trio-binning method using additional parental reads<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. Meanwhile, for HG002, PECAT reports higher phase block NG50 than that reported by Flye+HapDup, both are at least 25 times higher than that reported by Shasta. PECAT reports smaller Intra-block switch error and Hamming error on <italic>A. thaliana</italic> (Col-0×C24) and <italic>B. taurus</italic> (Bison×Simmental). Most of the contigs reported by PECAT on <italic>A. thaliana</italic> (Col-0×C24) and <italic>B. taurus</italic> (Bison × Simmental) are haplotigs (Fig. <xref rid="Fig3" ref-type="fig">3a</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">15</xref>). For HG002, PECAT and Flye+HapDup report similar Intra-block switch errors, and both are much less than those reported by Shasta. Although PECAT and Flye+HapDup reported smaller Hamming errors than that reported by Shasta, their reported Hamming error rates are high, which may be because some low heterozygosity regions of HG002 are not successfully phased. Moreover, most contigs reported by Flye+HapDup and PECAT on HG002 are not haplotigs (Supplementary Figs. <xref rid="MOESM1" ref-type="media">16</xref>,<xref rid="MOESM1" ref-type="media">17</xref>).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance comparison of assembly on Nanopore and PacBio HiFi datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Pipeline</th><th>Size (Mb)</th><th>NG50 (Mb)</th><th>Quality (reference-based)</th><th>Quality (k-mer-based)</th><th>BUSCO (%)</th><th>Hamming error (%)</th><th>Phase block NG50 (Mb)</th><th>Intra-block<break/>switch error (%)</th></tr></thead><tbody><tr><td rowspan="6"><p><italic>A. thaliana</italic></p><p>Col-0 × C24</p><p>ONT, 106X</p></td><td>Ref</td><td>133.3/119.2</td><td>26.2/23.8</td><td>–/–</td><td>44.7/44.0</td><td>99.3/99.1</td><td>0.14/0.01</td><td>12.7/23.8</td><td>0.15/0.02</td></tr><tr><td><p>Canu +</p><p>Purge_dups (pri/alt)</p></td><td>125.9/68.3</td><td>8.1/0.0</td><td>22.0/23.5</td><td>29.8/28.7</td><td>96.6/37.4</td><td>37.95/7.02</td><td>0.1/0.0</td><td>8.33/5.71</td></tr><tr><td>Flye + HapDup (dual)</td><td>136.4/136.5</td><td>2.1/2.1</td><td>25.6/25.0</td><td>28.5/28.3</td><td>97.8/97.8</td><td>11.85/13.62</td><td>0.5/0.5</td><td>0.66/0.67</td></tr><tr><td>Shasta (pri/alt)</td><td>126.3/105.0</td><td>0.8/0.5</td><td>22.4/23.8</td><td>28.9/30.6</td><td>94.9/92.2</td><td>11.75/7.96</td><td>0.3/0.3</td><td>7.11/5.39</td></tr><tr><td>PECAT (pri/alt)</td><td>131.2/123.9</td><td>14.3/7.7</td><td>30.2/30.6</td><td>31.4/32.1</td><td>98.5/98.2</td><td>3.18/0.32</td><td>9.1/7.1</td><td>0.35/0.36</td></tr><tr><td>PECAT (dual)</td><td>131.1/125.1</td><td>14.3/14.0</td><td>30.4/30.7</td><td>31.6/32.2</td><td>98.6/98.4</td><td>1.07/0.38</td><td>7.8/7.9</td><td>0.37/0.37</td></tr><tr><td rowspan="5"><p><italic>B. taurus</italic></p><p>Bison × Simmental</p><p>ONT, UL, 200X</p></td><td>Ref</td><td>2651.6/2861.7</td><td>87.8/104.4</td><td>–/–</td><td>38.7/36.1</td><td>93.1/95.7</td><td>0.67/0.48</td><td>87.8/104.4</td><td>0.74/0.61</td></tr><tr><td>Flye + HapDup (dual)</td><td>2713.0/2713.2</td><td>33.4/33.4</td><td>25.0/25.0</td><td>28.5/28.4</td><td>83.4/83.3</td><td>6.52/6.57</td><td>8.2/8.1</td><td>0.44/0.44</td></tr><tr><td>Shasta (pri/alt)</td><td>2815.7/2406.9</td><td>0.3/0.2</td><td>15.1/15.1</td><td>22.9/24.0</td><td>61.3/59.1</td><td>22.05/25.65</td><td>0.1/0.1</td><td>23.26/25.79</td></tr><tr><td>PECAT (pri/alt)</td><td>2968.2/2770.0</td><td>94.3/93.8</td><td>25.6/25.6</td><td>28.8/28.5</td><td>83.6/83.1</td><td>0.39/0.38</td><td>79.6/86.1</td><td>0.37/0.38</td></tr><tr><td>PECAT (dual)</td><td>2970.2/2856.3</td><td>94.3/93.8</td><td>25.5/25.6</td><td>28.8/28.8</td><td>83.3/83.4</td><td>0.39/0.38</td><td>79.5/86.1</td><td>0.37/0.39</td></tr><tr><td rowspan="5"><p>HG002</p><p>ONT, R9, UL 59X</p></td><td>Ref</td><td>2959.3/3061.7</td><td>146.7/154.4</td><td>–/–</td><td>58.6/59.4</td><td>92.8/95.8</td><td>0.15/0.08</td><td>90.4/106.7</td><td>0.02/0.03</td></tr><tr><td>Flye+ HapDup (dual)</td><td>2932.2/2932.4</td><td>49.9/49.9</td><td>33.2/33.2</td><td>40.9/40.8</td><td>94.2/94.1</td><td>7.91/8.24</td><td>20.5/19.6</td><td>0.08/0.09</td></tr><tr><td>Shasta (pri/alt)</td><td>3007.0/2443.9</td><td>24.2/2.9</td><td>28.8/30.1</td><td>34.7/38.5</td><td>92.4/79.6</td><td>18.93/11.42</td><td>0.8/0.5</td><td>8.66/5.36</td></tr><tr><td>PECAT (pri/alt)</td><td>3059.3/2857.7</td><td>92.9/15.0</td><td>30.8/30.8</td><td>41.8/41.6</td><td>94.7/91.0</td><td>15.72/1.48</td><td>22.2/13.0</td><td>0.08/0.11</td></tr><tr><td>PECAT (dual)</td><td>3057.2/2927.2</td><td>92.7/74.5</td><td>30.8/30.8</td><td>41.8/41.8</td><td>94.6/91.6</td><td>9.67/10.98</td><td>30.8/23.6</td><td>0.08/0.11</td></tr><tr><td rowspan="4"><p>HG002</p><p>ONT, R10,</p><p>UL, 116X</p></td><td>Flye+ HapDup (dual)</td><td>2954.7/2952.1</td><td>61.9/59.3</td><td>36.4/36.2</td><td>48.9/48.2</td><td>95.8/95.7</td><td>3.13/3.02</td><td>46.5/39.1</td><td>0.02/0.03</td></tr><tr><td>Shasta (pri/alt)</td><td>3095.4/2729.9</td><td>45.3/33.8</td><td>34.3/34.4</td><td>42.1/48.7</td><td>95.7/92.2</td><td>3.05/0.86</td><td>17.2/15.4</td><td>0.30/0.44</td></tr><tr><td>PECAT (pri/alt)</td><td>3159.7/2895.6</td><td>91.4/59.9</td><td>38.0/38.0</td><td>49.0/50.1</td><td>95.8/92.4</td><td>3.75/0.30</td><td>59.4/58.0</td><td>0.04/0.05</td></tr><tr><td>PECAT (dual)</td><td>3153.4/2917.8</td><td>91.4/80.2</td><td>38.0/38.0</td><td>49.2/50.0</td><td>95.8/92.7</td><td>2.99/1.49</td><td>63.8/59.2</td><td>0.04/0.06</td></tr><tr><td rowspan="3">HG002 HiFi, 36X</td><td>Hifiasm (pri/alt) *</td><td>3112.2/2910.3</td><td>89.9/0.4</td><td>50.0/50.0</td><td>55.3/56.5</td><td>95.6/77.0</td><td>24.38/1.67</td><td>1.1/0.3</td><td>0.11/0.01</td></tr><tr><td>Hifiasm (dual) *</td><td>3015.3/3077.5</td><td>44.8/64.5</td><td>50.0/50.0</td><td>54.9/57.8</td><td>95.5/94.9</td><td>34.80/24.10</td><td>1.0/1.0</td><td>0.16/0.11</td></tr><tr><td>Hifiasm (Hi-C) *</td><td>3075.0/2908.7</td><td>55.1/55.1</td><td>50.0/50.0</td><td>54.9/57.9</td><td>95.7/92.5</td><td>0.45/0.25</td><td>20.6/20.4</td><td>0.09/0.06</td></tr></tbody></table><table-wrap-foot><p>‘Size’ is the total number of base pairs in all contigs generated by assemblers. ‘NG50’ is the length of the shortest contig for which longer and equal length contigs cover at least 50 of genome size. The genome sizes of <italic>A. thaliana</italic>, <italic>B. taurus</italic>, and HG002 that we used for evaluation are 130 M, 2.7 G, and 3 G, respectively. ‘BUSCO’ is gene completeness evaluated by BUSCO. ‘Hamming error’ is the fraction of nondominant parental-specific k-mers in a contig. ‘Quality (reference-based)’ is the metric ‘q50’ evaluated by Pomoxis. ‘Quality (k-mer-based)’, ‘Phase block NG50’, and ‘Intra-block switch error’ are evaluated by mercury. ‘pri/alt’ represents primary/alternate assembly format. ‘dual’ represents dual assembly format. ‘ONT’ indicates the dataset is composed of Nanopore reads. ‘UL’ indicates the reads are ultra-long reads. ‘HiFi’ indicates the dataset is composed of PacBio HiFi reads. ‘Hi-C’ represents that the assembly uses the additional Hi-C reads. The two sets of contigs are separately reported in each cell. ‘Ref’ is the reference genome. The sources of the reference genomes are illustrated in Supplementary Table <xref rid="MOESM1" ref-type="media">17</xref>. For <italic>B. taurus</italic> and HG002, Canu didn’t finish the assembly in 3 weeks, so it is excluded. Asterisks mark previously published assemblies.</p></table-wrap-foot></table-wrap><fig id="Fig3"><label>Fig. 3</label><caption><title>Performance comparison of assembly.</title><p><bold>a</bold> Haplotype-specific k-mer blob plots of the <italic>B. taurus</italic> (Bison × Simmental) reference genome and assemblies by Flye+HapDup, Shasta, and PECAT. pri/alt or dual represents that the assembly is the primary/alternate format or the dual assembly format. Each blob corresponds to a contig. The coordinate of the blob gives the count of the parental specific k-mers in the contig, where k is 21. Blob size is proportional to contig length. <bold>b</bold> Precisions and recalls of small variants (SNP, INDEL) and structural variants (SV) in HG002 assemblies. <bold>c</bold> Genome fraction of the assemblies, which are evaluated by QUAST.</p></caption><graphic xlink:href="41467_2024_47349_Fig3_HTML" id="d33e1971"/></fig></p>
      <p id="Par22">For the metrics ‘Quality’ and BUSCO score, Shasta reports the lowest scores on all three Nanopore datasets, while Flye+HapDup and PECAT report similar scores on <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison×Simmental) and HG002, except that the BUSCO scores of the alternate contigs/the haplotype 2 contigs reported by PECAT are slightly lower than those reported by Flye+HapDup (91.0%/91.6% vs. 94.1%). The main reason for this difference is that PECAT places the contigs of X and Y chromosomes in the primary contigs or the haplotype 1 contigs while Flye+HapDup outputs two copies of contigs of X and Y chromosomes to two sets of assemblies at the same time. We remove the contigs of X and Y chromosomes in the assemblies of Flye+HapDup (dual) and PECAT (dual). The BUSCO scores of the assembly by Flye+HapDup (dual) are reduced from 94.2%/94.1% to 91.2%/91.1%, while the BUSCO scores of the assembly by PECAT (dual) are reduced from 94.6%/91.6% to 91.6%/91.5%, which are similar to those reported by Flye+HapDup (dual).</p>
      <p id="Par23">We also compare the HG002 genome assembled using Nanopore reads by PECAT with those using HiFi reads by Hifiasm<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>. The long Nanopore reads can help the assemblers to obtain longer phased blocks. PECAT reports much longer NG50 and phase block NG50 than those reported by Hifiasm using HiFi reads only, even longer than those reported by Hifiasm using both HiFi reads and Hi-C reads. The Intra-block switch errors reported by PECAT are similar to those reported by Hifiasm. On the other hand, the high-quality HiFi reads allow Hifiasm to report higher base qualities of assemblies with better ‘Quality’ scores. Moreover, Hifiasm reports higher Hamming errors when using HiFi reads only. However, with the help of Hi-C data, Hifiasm reported a much smaller Hamming error and almost all contigs are haplotigs (Supplementary Figs. <xref rid="MOESM1" ref-type="media">16</xref>,<xref rid="MOESM1" ref-type="media">17</xref><bold>)</bold>. We then evaluate the small variants (SNP, INDEL) and the structural variants (SV) in HG002 assemblies against the GIAB benchmark (<bold>Methods</bold>). As shown in Fig. <xref rid="Fig3" ref-type="fig">3b</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>, the precisions and recalls of SNP and SV of genomes assembled by Flye+HapDup and PECAT using Nanopore reads are similar to those of genomes assembled by Hifiasm using HiFi reads. However, the precisions and recalls of INDEL of genomes assembled by Flye+HapDup and PECAT using Nanopore read is much less than those of genomes assembled by Hifiasm using HiFi reads, which is consistent with the previous finding<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>.</p>
      <p id="Par24">In the second round of assembly of PECAT, it reassembles the filtered string graph, which will help correct errors or collapsed regions in the first round of assembly. As shown in Fig. <xref rid="Fig3" ref-type="fig">3c</xref> and Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>, PECAT reports higher ‘Genome fraction’ values than those reported by other pipelines. We then map the HG002 reference genome and HG002 assemblies to GRCh38. As an example (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), the region [130,005,418, 130,116,766] in chromosome 3 includes the gene EVA1CP6 and has a large INDEL with a length of about 43,365 bp between the parental reference genomes. Both PECAT and Hifiasm reconstruct the INDEL in their assemblies, but Flye+HapDup (dual) fails. This large INDEL cannot be preserved in the haplotype-collapsed contigs in the first round of assembly and reads from another haplotype may not be mapped onto the haplotype-collapsed contigs. Therefore, it is difficult for the polish-based assemblies, such as Flye+HapDup, to restore the INDEL in the second round of assembly, which may be the reason that Flye+Hapdup reports lower Genome fraction scores than those reported by PECAT (Fig. <xref rid="Fig3" ref-type="fig">3c</xref> and Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>) on three Nanopore datasets.<fig id="Fig4"><label>Fig. 4</label><caption><title>Screenshot of HG002 reference, assembly and read alignment to GRCh38.</title><p>It shows the range of [130,005,418, 130,116,766] in chromosome 3. Small INDELs in all alignments and mismatches in read alignments are not shown. Paternal reference and maternal reference are HG002 paternal references. The assemblies by Flye, Flye+HapDup, and PECAT are from Nanopore reads. The assembly by Hifiasm is from HiFi reads. The assembly by Flye is haplotype-collapsed contigs. The other assemblies are in the dual assembly format. The two sets of contigs are labeled as haplotype 1 and haplotype 2.</p></caption><graphic xlink:href="41467_2024_47349_Fig4_HTML" id="d33e2036"/></fig></p>
      <p id="Par25">We further compare the computational resources required by each pipeline (Supplementary Table <xref rid="MOESM1" ref-type="media">9</xref>, <xref rid="MOESM1" ref-type="media">10</xref><bold>)</bold>. Canu on <italic>B. taurus</italic> (Angus×Brahman), <italic>B. taurus</italic> (Bison×Simmental), and HG002, FALCON-Unzip on <italic>B. taurus</italic> (Angus×Brahman) are excluded for comparison since the assemblies are not constructed within three weeks. PECAT is at least 8.7 times faster than traditional correct-then-assemble pipelines, such as Canu+purge_dups and FALCON-Unzip. But it’s slower than assemble-then-correct pipelines, such as Shasta and Flye+HapDup. The peaks of memory usage and disk space usage of PECAT are also recorded in Supplementary Table <xref rid="MOESM1" ref-type="media">10</xref>.</p>
    </sec>
    <sec id="Sec8">
      <title>Performance on highly accurate long reads</title>
      <p id="Par26">With the development of sequencing technology, the accuracy of long reads has greatly improved recently<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR45">45</xref></sup>. We evaluate the performance of PECAT using Nanopore R10 sequencing (ultra-long), Nanopore R10 duplex sequencing and PacBio HiFi sequencing reads. The accuracy of 40X longest reads for those datasets is 98.25%, 99.67%, and 99.77% (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>), respectively, which are much higher than the accuracy of the Nanopore R9 (ultra-long) dataset (94.97%). However, there are still less accurate reads in those datasets and PECAT error correction can still improve the qualities of those reads, except for a 0.1–0.2% decrease in the metric “Completeness” (Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>). The Nanopore R10 (ultra-long) dataset with higher accuracy and longer read length improves the assemblies of all pipelines (Table <xref rid="Tab2" ref-type="table">2</xref>). Compared with the assemblies from the Nanopore R9 (ultra-long) dataset (Table <xref rid="Tab2" ref-type="table">2</xref>), the assemblies from the Nanopore R10 (ultra-long) dataset have higher QV when evaluated by pomoxis and merqury. Especially, the assembly of PECAT from the Nanopore R10 (ultra-long) dataset has the highest phase block NG50 with 59.4/58.0 Mb in primary/alternate format and with 63.8/59.2 Mb in dual format, which is twice as much as those of assembly of PECAT from Nanopore R9 (ultra-long) data. Furthermore, the assemblies from the Nanopore R10 (ultra-long) dataset report one magnitude smaller Hamming error and more contigs in this assembly are haplotigs (Supplementary Figs. <xref rid="MOESM1" ref-type="media">19</xref>, <xref rid="MOESM1" ref-type="media">20</xref>). Similar to the Nanopore R9 (ultra-long) dataset, the assembly of PECAT from the Nanopore R10 (ultra-long) dataset outperforms those of Flye+HapDup and Shasta in terms of NG50 and phase block NG50. Meanwhile, the assemblies for the Nanopore R10 duplex and PacBio HiFi datasets (Supplementary Table <xref rid="MOESM1" ref-type="media">12</xref>) have less NG50 and phase block NG50 than those of assembly from the Nanopore R9 (ultra-long) dataset (Table <xref rid="Tab2" ref-type="table">2</xref>), although have higher quality measures. Moreover, less amount of contigs of assemblies of Nanopore R10 duplex and PacBio HiFi reads are haplotigs (Supplementary Figs. <xref rid="MOESM1" ref-type="media">21</xref>–<xref rid="MOESM1" ref-type="media">24</xref>). This result indicated that the length of reads is more important for obtaining contiguous haplotype-specific contigs.</p>
      <p id="Par27">We then evaluate the small variants (SNP, INDEL) and the structural variants (SV) in those assemblies using Nanopore R10 sequencing (ultra-long), Nanopore R10 duplex sequencing and PacBio HiFi sequencing reads against the GIAB benchmark (Supplementary Table <xref rid="MOESM1" ref-type="media">13</xref>–<xref rid="MOESM1" ref-type="media">15</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">25</xref>–<xref rid="MOESM1" ref-type="media">27</xref>). The assemblers report similar metrics. The precisions and recalls of SNP and SV of the assemblies are similar to those of the assemblies using Nanopore R9 (ultra-long) reads (Fig. <xref rid="Fig3" ref-type="fig">3b</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>). However, the precisions and recalls of INDEL of genomes assembled from Nanopore R10 (ultra-long) reads and Nanopore R10 duplex reads are much greater than those of assemblies using R9 (ultra-long) reads, while still less than those of assemblies using HiFi reads.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par28">Although long noisy reads, especially Nanopore reads, have the advantage to generate high contiguity contigs, using them for diploid genome assembly remains a challenge. Due to the high sequencing error rate, directly phasing the raw reads and then assembling the diploid genome can not obtain high-quality assembly<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. Here, we first develop a haplotype-aware error-correct method to keep most of the heterozygote alleles while correcting sequencing errors. However, even after error corrections, it is not able to accurately call SNPs by just aligning corrected reads as the Hifiasm did for HiFi reads. PECAT then first generates a haplotype-collapsed genome and calls SNPs by aligning the corrected reads to the haplotype-collapsed genome. Nevertheless, the accuracy of this SNP call is still low for low heterozygosity rate regions. Therefore, we use Clair3 to call SNPs again for Nanopore reads. Our experiments show that the SNPs called from raw reads complemented the SNPs called by aligning corrected reads. Combing both SNPs helps achieve the best performance.</p>
    <p id="Par29">Another advantage of our haplotype-aware error-corrected reads is to allow reuse the overlaps built in the first round of assembly and just simplify the overlaps by removing inconsistent ones before reassembling the diploid genome. This strategy is like that used in Hifiasm. Compared to methods that directly separate the collapsed contigs into two haplotypes, such as Flye+HapDup, this strategy can correct errors or collapsed regions in the first round of assembly, and then achieve better assembly.</p>
    <p id="Par30">Furthermore, PECAT does not simply phase the reads into two copies, but uses the read grouping method to separate reads from nearly identical repeats into multiple copies, which can help solve the repeats with more than two copies. Meanwhile, in order to obtain high-quality phased assembly, PECAT needs higher coverage of data. As shown in Supplementary Table <xref rid="MOESM1" ref-type="media">16</xref>, the contiguity and qualities of the assembly of HG002 using 37X Nanopore reads are less than those of assembly using 59X Nanopore reads.</p>
    <p id="Par31">Although the new generation long reads from Nanopore and PacBio have much higher accuracy, PECAT error correction can still improve their quality. PECAT can also efficiently assemble those highly accurate reads. It can leverage the advantages of read length and accuracy to obtain better assemblies. Therefore, PECAT achieve the phase block NG50 with 59.4/58.0 Mb in primary/alternate format and with 63.8/59.2 Mb in dual format only using Nanopore R10 (ultra-long) reads. However, our current error correction method may not be effective enough to distinguish small errors from heterozygote alleles in very low heterozygosity rate regions, even in highly accurate reads (Nanopore duplex and PacBio HiFi reads). Compared with the read-length advantage, PECAT does not fully take advantage of the high accuracy of reads for being compatible with long noisy reads, therefore it achieves mediocre performance on Nanopore duplex and PacBio HiFi reads (Supplementary Table <xref rid="MOESM1" ref-type="media">12</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">21</xref>–<xref rid="MOESM1" ref-type="media">24</xref>). We will resolve this issue in subsequent PECAT releases. Overall, PECAT is an efficient assembly pipeline for diploid genomes.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Diploid datasets for benchmarking</title>
      <p id="Par32">We evaluate the performance of PECAT using seven diploid datasets (Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">17</xref>): <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison×Simmental) and HG002. The first four datasets are PacBio CLR datasets and the last three are Nanopore datasets (the last two are ultra-long raw reads and the HG002 dataset is generated by Nanopore R9). The heterozygosity rate of those species is 0.85%, 1.04%, 0.84%, 1.12%, 0.83%, 1.48%, and 0.34%, respectively (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>). The accuracies of reads in those datasets are 87.80%, 88.24%, 89.58%, 86.25%, 92.33%, 89.12%, and 94.97%, respectively. (Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref>). In addition, we evaluate the performance of PECA on more accurate datasets, i.e., other three HG002 datasets using Nanopore R10 sequencing (ultra-long), Nanopore R10 duplex sequencing and PacBio HiFi sequencing, separately. Their accuracies are 98.25%, 99.67%, and 99.77% (Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>). For each of the above data, PECAT and NECAT extract the longest 80X raw reads or all reads, if the dataset is less than 80X, for error correction and assembly. Canu corrects the longest 100X raw reads for assembly. Other tools use all raw reads for error correction or assembly (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>).</p>
    </sec>
    <sec id="Sec12">
      <title>Haplotype-aware error correction</title>
      <p id="Par33">The PECAT error correction method is based on the partial-order alignment (POA) graph method<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR47">47</xref></sup>. Instead of assigning the same weight to each read for error correction, we select reads more likely coming from the same haplotype or the same copy of the nearly identical repeat and assign different weights to prevent heterozygotes in reads from being eliminated as sequencing errors. First, we find candidate overlaps between raw reads using minimap2 with parameters “-x ava-pb” for PacBio CLR reads and parameters “-x ava-ont” for Nanopore reads. For each template read to be corrected, we collect a group of supporting reads that have candidate overlaps with the template read. Then, we perform pairwise alignment between the template read and each supporting read using diff<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> or edlib<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> algorithm and build a POA graph based on the alignments of the reads as shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>. Each node in the graph is labeled by a triple value <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(c,r,{b})$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq8.gif"/></alternatives></inline-formula>, corresponding a base pair in the alignment. <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M18"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq9.gif"/></alternatives></inline-formula> is the location at the template read, <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M20"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq10.gif"/></alternatives></inline-formula> means the number of consecutive insertions (if <italic>r</italic> = 0, there is a match, a mismatch, or a deletion), and <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b$$\end{document}</tex-math><mml:math id="M22"><mml:mi>b</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq11.gif"/></alternatives></inline-formula> is the base on the supporting read or a deletion, which is one of <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{\prime} {A}^{{\prime} }{,}^{{\prime} }{C}^{{\prime} }{,}^{{\prime} }{G}^{{\prime} }{,}^{{\prime} }{T}^{{\prime} }{,}^{{\prime} }{-}^{{\prime} }\}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>′</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq12.gif"/></alternatives></inline-formula>. Each edge in the graph means two base pairs of their nodes appearing continuously in the alignment. The support count of each edge is defined as the number of alignments which pass the edge. For the convenience of analysis, we add a trivial alignment between the template read and itself to the graph. According to our observations, for each location <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M26"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq13.gif"/></alternatives></inline-formula>, all paths in the graph must only pass one of the nodes <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{\left(c,0,{b}_{i}\right),{b}_{i}\in \left({\prime} {A}^{{\prime} }{,}^{{\prime} }{C}^{{\prime} }{,}^{{\prime} }{G}^{{\prime} }{,}^{{\prime} }{T}^{{\prime} }{,}^{{\prime} }{-}^{{\prime} }\right)\}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo>′</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq14.gif"/></alternatives></inline-formula>. If these nodes have more than one in-edge with large support counts, there may be heterozygotes rather than random sequencing errors (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1 b</xref><bold>)</bold>. Therefore, we compute the support count <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq15.gif"/></alternatives></inline-formula> for in-edges of the nodes. We mark an in-edge as the important one if <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}\ge \left\{\begin{array}{cc}{r}_{l}\cdot S &amp; S\le {S}_{l}\\ \frac{{r}_{h}\cdot {S}_{h}-{r}_{l}\cdot {S}_{l}}{{S}_{h}-{S}_{l}}\cdot \left(S-{S}_{l}\right)+{r}_{l}\cdot {S}_{l} &amp; {S}_{l} &lt; S\le {S}_{h}\\ {r}_{h}\cdot S &amp; {S}_{h} &lt; S\end{array}\right.$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>S</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>S</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>S</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>S</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>S</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>S</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq16.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S=\sum {s}_{i}$$\end{document}</tex-math><mml:math id="M34"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq17.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{l}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq18.gif"/></alternatives></inline-formula>, <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{h}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq19.gif"/></alternatives></inline-formula>, <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{l}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq20.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{h}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq21.gif"/></alternatives></inline-formula> are user-set parameters (the default values are 0.5, 0.2, 10, and 200). We mark a location <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M44"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq22.gif"/></alternatives></inline-formula> as the important one if (1) there is no homopolymer at location <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M46"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq23.gif"/></alternatives></inline-formula>, (2) there are two or more important in-edges and a bubble structure which can be detected along the reverse direction of the in-edges, (3) more than half of the reads through the important in-edge pass the corresponding path in the bubble, (4) there is not an INDEL variant between the sequences represented by the paths in the bubble. Then, we calculate a score for each supporting read based on whether the supporting read and the template read pass the same important in-edges at important locations. We increase the score by 1 if a supporting read passes the same important in-edge as template read and decrease it by 1 if the supporting read and the template read pass the different important in-edges (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1 c</xref>). For uniformity, the score is divided by the number of important locations in the supporting read. As shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">1 d</xref>, the histogram of scores shows two or more peaks if the supporting reads come from different haplotypes or different copies of the segmental duplication. We select the reads whose scores fall into the first peak for error correction. If there is only one peak, we select half of the supporting reads with larger scores. We linearly map the scores of selected reads to a range, which is <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[0.4,0.8]$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0.4</mml:mn><mml:mo>,</mml:mo><mml:mn>0.8</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq24.gif"/></alternatives></inline-formula> by default, as the final weights of supporting reads. The weight of each edge is the sum of the weights of selected supporting reads that pass the edge.</p>
      <p id="Par34">Finally, we find the path in the POA graph to generate a consensus for the template read. For each node <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v$$\end{document}</tex-math><mml:math id="M50"><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq25.gif"/></alternatives></inline-formula> labeled by the triple value <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(c,r,b)$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq26.gif"/></alternatives></inline-formula>, if it has <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M54"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq27.gif"/></alternatives></inline-formula> in-edges <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{({u}_{i},v){|i}\le N\}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq28.gif"/></alternatives></inline-formula>, it gets the score <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{v}=\mathop{\max }\limits_{i\le N}\{{S}_{{u}_{i}}+{W}_{\left({u}_{i},v\right)}-{P}_{c}\}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq29.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{\left({u}_{i},v\right)}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq30.gif"/></alternatives></inline-formula> is the weight of the edge <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({u}_{i},v\right)$$\end{document}</tex-math><mml:math id="M62"><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq31.gif"/></alternatives></inline-formula>. In the previous work<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{c}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq32.gif"/></alternatives></inline-formula> is the half of the coverage at the location <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M66"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq33.gif"/></alternatives></inline-formula> in the template read. In our work, <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{c}=\max \left({0.4}^{r},0.3\right)*{W}_{c}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mrow><mml:mn>0.4</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:mfenced><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq34.gif"/></alternatives></inline-formula> instead, where <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{c}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq35.gif"/></alternatives></inline-formula> is the sum of weight of the supporting reads which pass the location <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M72"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq36.gif"/></alternatives></inline-formula>. The score of the nodes without any in-edge is assigned to 0. We calculate the scores for all nodes by dynamic programming in topological order and record the related edges which get the maximum scores for the nodes. The node with the highest score is selected and backtracking is done to obtain the path for consensus. The consensus sequence for the template read is generated by concatenating the bases of the nodes in the path.</p>
    </sec>
    <sec id="Sec13">
      <title>Read-level SNP caller and read grouping method for identifying inconsistent overlaps</title>
      <sec id="Sec14">
        <title>Calling heterozygous SNPs in haplotype-collapsed contigs and SNP alleles in reads</title>
        <p id="Par35">We map corrected reads to the first round of assembly using minimap2 with parameters “-x map-pb -c -p 0.5 -r 1000” for PacBio CLR reads and parameters “-x map-ont -c -p 0.5 -r 1000” for Nanopore reads. It performs base-level alignment and generates CIGAR strings. We scan the CIGAR strings and call heterozygous SNPs for each contig. We call a base site a heterozygous SNP site if it meets the following two conditions. (1) Its coverage is in the range [10, 1000]. (2) The number of second-most common bases is greater or equal to <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{\begin{array}{cc}{r}_{l}\cdot c &amp; c\le {c}_{l}\\ \frac{{r}_{h}\cdot {c}_{h}-{r}_{l}\cdot {c}_{l}}{{c}_{h}-{c}_{l}}\cdot \left(c-{c}_{l}\right)+{r}_{l}\cdot {c}_{l} &amp; {c}_{l} &lt; c\le {c}_{h}\\ {r}_{h}\cdot c &amp; c\ge {c}_{h}\end{array}\right.$$\end{document}</tex-math><mml:math id="M74"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>c</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>c</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>c</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>c</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>c</mml:mi><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq37.gif"/></alternatives></inline-formula>, in which <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M76"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq38.gif"/></alternatives></inline-formula> is the site coverage and <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{l}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq39.gif"/></alternatives></inline-formula>, <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{h}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq40.gif"/></alternatives></inline-formula>, <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{l}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq41.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{h}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq42.gif"/></alternatives></inline-formula> are user-set parameters (default values are 0.4, 0.2, 10 and 100). After calling heterozygous SNPs, we call SNP alleles in reads. We define a function <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{r}(s)$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq43.gif"/></alternatives></inline-formula> for each read <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M88"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq44.gif"/></alternatives></inline-formula>. For any SNP site <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M90"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq45.gif"/></alternatives></inline-formula>, <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{r}(s)$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq46.gif"/></alternatives></inline-formula> is defined as 1 or 2 if the read <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M94"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq47.gif"/></alternatives></inline-formula> covers the site <inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M96"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq48.gif"/></alternatives></inline-formula> and the base of the read <inline-formula id="IEq49"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M98"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq49.gif"/></alternatives></inline-formula> is equal to the first-most or second-most common base at site <inline-formula id="IEq50"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M100"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq50.gif"/></alternatives></inline-formula>. Otherwise, <inline-formula id="IEq51"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{r}(s)$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq51.gif"/></alternatives></inline-formula> is defined as 0.</p>
      </sec>
      <sec id="Sec15">
        <title>Verifying and correcting SNP alleles</title>
        <p id="Par36">To verify and correct SNP alleles in a read, we need to find which reads are from the same haplotype within its local region. For each read labeled as the template read <inline-formula id="IEq52"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M104"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq52.gif"/></alternatives></inline-formula>, we assume that it covers a set of SNP sites <inline-formula id="IEq53"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S=\left\{{s}_{1},{s}_{2},\ldots,{s}_{N}\right\}$$\end{document}</tex-math><mml:math id="M106"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq53.gif"/></alternatives></inline-formula>. We collect the query reads that cover 3 common SNP sites with the template read <inline-formula id="IEq54"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M108"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq54.gif"/></alternatives></inline-formula>. The template read and the query reads are put into a group <inline-formula id="IEq55"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M110"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq55.gif"/></alternatives></inline-formula>. We cluster the reads in the group <inline-formula id="IEq56"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M112"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq56.gif"/></alternatives></inline-formula> according to the SNP alleles in them. The reads in the same cluster can be considered from the same haplotype. To facilitate the description of the method, here we make some definitions. We define a centroid <inline-formula id="IEq57"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C=\{\left({v}_{s},{n}_{s}\right){|s}\in S\}$$\end{document}</tex-math><mml:math id="M114"><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∣</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq57.gif"/></alternatives></inline-formula> for the group <inline-formula id="IEq58"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M116"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq58.gif"/></alternatives></inline-formula> at the SNP site set <inline-formula id="IEq59"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M118"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq59.gif"/></alternatives></inline-formula>. <inline-formula id="IEq60"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq60.gif"/></alternatives></inline-formula> is defined to <inline-formula id="IEq61"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}^{+}-{v}_{s}^{-}$$\end{document}</tex-math><mml:math id="M122"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq61.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq62"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}^{+}$$\end{document}</tex-math><mml:math id="M124"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq62.gif"/></alternatives></inline-formula> is the number of the read set <inline-formula id="IEq63"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{r|}{H}_{r}\left(s\right)=1,{r}\in G,s\in S\}$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq63.gif"/></alternatives></inline-formula> and <inline-formula id="IEq64"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}^{-}$$\end{document}</tex-math><mml:math id="M128"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq64.gif"/></alternatives></inline-formula> is the number of the read set <inline-formula id="IEq65"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{r|}{H}_{r}\left(s\right)=2,{r}\in G,s\in S\}$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq65.gif"/></alternatives></inline-formula>. <inline-formula id="IEq66"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{i}$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq66.gif"/></alternatives></inline-formula> is defined to <inline-formula id="IEq67"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}^{+}+{v}_{s}^{-}$$\end{document}</tex-math><mml:math id="M134"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq67.gif"/></alternatives></inline-formula>. One read can be regarded as a group only including it. We define the following three formulas to get verified SNP sites of the centroid <inline-formula id="IEq68"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><mml:math id="M136"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq68.gif"/></alternatives></inline-formula>.<disp-formula id="Equa"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}{V}_{ &gt; }\left(C,\,{p}_{0},\,{p}_{1}\right)=\left\{s | {v}_{s}\, &gt; \,0,\left|{v}_{s}\right|\, \ge \,{\max}(p_{0}\cdot {n}_{s},\,{p}_{1})\right\},\, ({v}_{s},\, {n}_{s})\in C\left\}\right.\\ {V}_{ &lt; }\left(C,\, {p}_{0},\, {p}_{1}\right)=\left\{s | {v}_{s}\, &lt; \, 0,\left|{v}_{s}\right|\, \ge \, {\max}(p_{0}\cdot {n}_{s},\, {p}_{1})\right\},({v}_{s},\, {n}_{s})\in C\left\}\right.\\ {V}_{\ne }\left(C,\, {p}_{0},\, {p}_{1}\right)={V}_{ &gt; }\left(C,\, {p}_{0},\, {p}_{1}\right)\bigcup {V}_{ &lt; }\left(C,\, {p}_{0},\, {p}_{1}\right)\end{array}$$\end{document}</tex-math><mml:math id="M138"><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>&gt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>≥</mml:mo><mml:mspace width="0.25em"/><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mfenced open="}"><mml:mrow/></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>&lt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>≥</mml:mo><mml:mspace width="0.25em"/><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mfenced open="}"><mml:mrow/></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>≠</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo mathsize="big"> ⋃</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2024_47349_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par37">The parameters <inline-formula id="IEq69"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{0}$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq69.gif"/></alternatives></inline-formula> and <inline-formula id="IEq70"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{1}$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq70.gif"/></alternatives></inline-formula> are used to control which sites are valid. Next, we define the operations between two centroids.<disp-formula id="Equb"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}A\left({C}_{1},\, {C}_{2},\, {p}_{0},\, {p}_{1}\right)={V}_{\ne }({C}_{1},\, {p}_{0},\, {p}_{1})\bigcap {V}_{\ne }({C}_{2},\, {p}_{0},\, {p}_{1})\\ S\left({C}_{1},\, {C}_{2},\, {p}_{0},\, {p}_{1}\right)={V}_{ &lt; }({C}_{1},\, {p}_{0},\, {p}_{1})\bigcap {V}_{ &lt; }({C}_{2},\, {p}_{0},\, {p}_{1})\cup {V}_{ &gt; }({C}_{1},\, {p}_{0},\, {p}_{1})\bigcap {V}_{ &gt; }({C}_{2},\,{p}_{0},\,{p}_{1})\\ D\left({C}_{1},\,{C}_{2},\,{p}_{0},\,{p}_{1}\right)={V}_{ &lt; }\left({C}_{1},\,{p}_{0},\,{p}_{1}\right)\bigcap {V}_{ &gt; }\left({C}_{2},\,{p}_{0},\,{p}_{1}\right)\cup {V}_{ &gt; }\left({C}_{1},\,{p}_{0},\,{p}_{1}\right)\bigcap {V}_{ &lt; }\left({C}_{2},\,{p}_{0},\,{p}_{1}\right)\end{array}$$\end{document}</tex-math><mml:math id="M144"><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>≠</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo mathsize="big">⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>≠</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo mathsize="big">⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo mathsize="big">⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo mathsize="big"> ⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo mathsize="big"> ⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2024_47349_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par38"><inline-formula id="IEq71"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A\left({C}_{1},{C}_{2},{p}_{0},{p}_{1}\right)$$\end{document}</tex-math><mml:math id="M146"><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq71.gif"/></alternatives></inline-formula> is the set of common verified SNP sites of the centroids <inline-formula id="IEq72"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{1}$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq72.gif"/></alternatives></inline-formula> and <inline-formula id="IEq73"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{2}$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq73.gif"/></alternatives></inline-formula>. <inline-formula id="IEq74"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S\left({C}_{1},{C}_{2},{p}_{0},{p}_{1}\right)$$\end{document}</tex-math><mml:math id="M152"><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left({C}_{1},{C}_{2},{p}_{0},{p}_{1}\right)$$\end{document}</tex-math><mml:math id="M154"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq75.gif"/></alternatives></inline-formula> are used to describe the similarity and the distance of the centroids <inline-formula id="IEq76"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{1}$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{2}$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq77.gif"/></alternatives></inline-formula>. A read <inline-formula id="IEq78"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M160"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq78.gif"/></alternatives></inline-formula> can also be used as the parameter, which means the centroid of <inline-formula id="IEq79"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{r\}$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq79.gif"/></alternatives></inline-formula>.</p>
        <p id="Par39">For each template read <inline-formula id="IEq80"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M164"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq80.gif"/></alternatives></inline-formula> and related group <inline-formula id="IEq81"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M166"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq81.gif"/></alternatives></inline-formula>, we use a divide-then-combine strategy to cluster reads (Supplementary Fig. <xref rid="MOESM1" ref-type="media">28</xref>). In the dividing step, we use a modified bisecting k-means algorithm<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> to divide the group <inline-formula id="IEq82"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M168"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq82.gif"/></alternatives></inline-formula> into small ones with following steps</p>
        <p id="Par40">1. The centroids<inline-formula id="IEq83"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\,{C}_{1}$$\end{document}</tex-math><mml:math id="M170"><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq83.gif"/></alternatives></inline-formula> and <inline-formula id="IEq84"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{2}$$\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq84.gif"/></alternatives></inline-formula> of the sets <inline-formula id="IEq85"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{r}_{1}\}$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq85.gif"/></alternatives></inline-formula> and <inline-formula id="IEq86"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{{r}_{2}\right\}$$\end{document}</tex-math><mml:math id="M176"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq86.gif"/></alternatives></inline-formula> are initially selected, where reads <inline-formula id="IEq87"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{1}$$\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq87.gif"/></alternatives></inline-formula> and <inline-formula id="IEq88"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{2}$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq88.gif"/></alternatives></inline-formula> are a read pair in the group <inline-formula id="IEq89"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M182"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq89.gif"/></alternatives></inline-formula> with the largest distance (<inline-formula id="IEq90"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{1},{r}_{2}={{{\arg }}}_{{r}_{1},{r}_{2}\in G}\max {|D}({r}_{1},{r}_{2},0,0)|$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>arg</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mi>max</mml:mi><mml:mo>∣</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq90.gif"/></alternatives></inline-formula>).</p>
        <p id="Par41">2. We divide the group <inline-formula id="IEq91"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M186"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq91.gif"/></alternatives></inline-formula> into three subgroups, two subgroups corresponding to the centroids and a separate subgroup containing the reads far away from the centroids. For each read <inline-formula id="IEq92"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M188"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq92.gif"/></alternatives></inline-formula>, if it is far away from the centroids, it meets the conditions: <inline-formula id="IEq93"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{\left|A\left(r,{C}_{i},0,0\right)\right|}{\left|{V}_{\ne }(r,0,0)\right|} &lt; {p}_{2}$$\end{document}</tex-math><mml:math id="M190"><mml:mfrac><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>≠</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq93.gif"/></alternatives></inline-formula>
<inline-formula id="IEq94"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${or}\frac{|D(r,{C}_{i},0,0)|}{|A(r,{C}_{i},0,0)|} &gt; {p}_{3},{i}\in \{{1,2}\}$$\end{document}</tex-math><mml:math id="M192"><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mfrac><mml:mrow><mml:mo>∣</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq94.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq95"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{2}$$\end{document}</tex-math><mml:math id="M194"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq95.gif"/></alternatives></inline-formula> and <inline-formula id="IEq96"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{3}$$\end{document}</tex-math><mml:math id="M196"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq96.gif"/></alternatives></inline-formula> are user-set parameters (default values are 0.3 and 0.5), it is assigned to a separate subgroup. Otherwise, it is assigned the nearest subgroup <inline-formula id="IEq97"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i={{{\arg }}}_{{{{{{\rm{i}}}}}}\in \{1,2\}}\min \frac{\left|D\left(r,{C}_{i},0,0\right)\right|}{\left|A\left(r,{C}_{i},0,0\right)\right|}$$\end{document}</tex-math><mml:math id="M198"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>arg</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mi>min</mml:mi><mml:mfrac><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq97.gif"/></alternatives></inline-formula>. The purpose of the separate subgroup is to prevent the centroids from changing dramatically in each iteration.</p>
        <p id="Par42">3. We calculate the centroids for the first two subgroups and repeat step 2 until the three subgroups don’t change.</p>
        <p id="Par43">After the group is divided into three subgroups, we repeat the above steps to continue dividing the subgroups. If the subgroup <inline-formula id="IEq98"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M200"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq98.gif"/></alternatives></inline-formula> and its centroid <inline-formula id="IEq99"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><mml:math id="M202"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq99.gif"/></alternatives></inline-formula> meet the following conditions: <inline-formula id="IEq100"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|G\right|\le 3$$\end{document}</tex-math><mml:math id="M204"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq100.gif"/></alternatives></inline-formula> or <inline-formula id="IEq101"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{\sum }_{r\in G}\left|D\left(r,C,0,0\right)\right|}{{\sum }_{r\in G}\left|A\left(r,C,0,0\right)\right|}\le {p}_{4}$$\end{document}</tex-math><mml:math id="M206"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq101.gif"/></alternatives></inline-formula> and <inline-formula id="IEq102"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sum }_{r\in G}\left|D\left(r,C,0,0\right)\right|\le {p}_{5}$$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq102.gif"/></alternatives></inline-formula>, it is no longer divided into small subgroups. <inline-formula id="IEq103"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{4}$$\end{document}</tex-math><mml:math id="M210"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq103.gif"/></alternatives></inline-formula> and <inline-formula id="IEq104"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{5}$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq104.gif"/></alternatives></inline-formula> are user-set parameters (the default values are 0.02 and 4).</p>
        <p id="Par44">After dividing the groups, we get a set of subgroups <inline-formula id="IEq105"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${SG}$$\end{document}</tex-math><mml:math id="M214"><mml:mi>S</mml:mi><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq105.gif"/></alternatives></inline-formula>. we combine a pair of subgroups into a big one if the centroids are close to each other. First, we create an empty list <inline-formula id="IEq106"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M216"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq106.gif"/></alternatives></inline-formula> and add the subgroup that contains the template read to the list as the first element <inline-formula id="IEq107"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq107.gif"/></alternatives></inline-formula>. Then, we combine other subgroup <inline-formula id="IEq108"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}</tex-math><mml:math id="M220"><mml:mi>g</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq108.gif"/></alternatives></inline-formula> to <inline-formula id="IEq109"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq109.gif"/></alternatives></inline-formula>, if it meets the conditions: <inline-formula id="IEq110"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left(g,{L}_{1},{p}_{6},{p}_{7}\right) &lt; \min ({p}_{8},{A}\left(g,{L}_{1},{p}_{6},{p}_{7}\right)\cdot {p}_{9})$$\end{document}</tex-math><mml:math id="M224"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq110.gif"/></alternatives></inline-formula> and <inline-formula id="IEq111"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left(g,{L}_{1},{p}_{6},{p}_{7}/2\right) &lt; A\left(g,{L}_{1},{p}_{6},{p}_{7}/2\right)\cdot {p}_{9}$$\end{document}</tex-math><mml:math id="M226"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq111.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq112"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{6}$$\end{document}</tex-math><mml:math id="M228"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq112.gif"/></alternatives></inline-formula>, <inline-formula id="IEq113"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{7}$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq113.gif"/></alternatives></inline-formula>, <inline-formula id="IEq114"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{8}$$\end{document}</tex-math><mml:math id="M232"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq114.gif"/></alternatives></inline-formula> and <inline-formula id="IEq115"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{9}$$\end{document}</tex-math><mml:math id="M234"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq115.gif"/></alternatives></inline-formula> are user-set parameters (the default values are 0.66, 6, 4 and 0.2). The remaining subgroups are put into another list <inline-formula id="IEq116"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}^{{\prime} }$$\end{document}</tex-math><mml:math id="M236"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq116.gif"/></alternatives></inline-formula> and sort the subgroups in ascending order of distance with <inline-formula id="IEq117"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M238"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq117.gif"/></alternatives></inline-formula> (<inline-formula id="IEq118"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|D({L}_{1},{L}_{i}^{{\prime} },{p}_{6},{p}_{7})\right|$$\end{document}</tex-math><mml:math id="M240"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq118.gif"/></alternatives></inline-formula>). For the subgroup <inline-formula id="IEq119"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M242"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq119.gif"/></alternatives></inline-formula> in the list <inline-formula id="IEq120"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}^{{\prime} }$$\end{document}</tex-math><mml:math id="M244"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq120.gif"/></alternatives></inline-formula>, we combine it to the subgroup <inline-formula id="IEq121"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M246"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq121.gif"/></alternatives></inline-formula> in list <inline-formula id="IEq122"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M248"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq122.gif"/></alternatives></inline-formula>, if it meets the following conditions: (1) <inline-formula id="IEq123"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j={{\arg }}\max \left|S\left(i,j,{p}_{6},0\right)\right|,{j}\in L$$\end{document}</tex-math><mml:math id="M250"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:mi>max</mml:mi><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq123.gif"/></alternatives></inline-formula>; (2) <inline-formula id="IEq124"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left(i,j,{p}_{6},{p}_{7}\right) &lt; \max ({p}_{8},{A}\left(i,j,{p}_{6},{p}_{7}\right)\cdot {p}_{9})$$\end{document}</tex-math><mml:math id="M252"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq124.gif"/></alternatives></inline-formula>; (3) <inline-formula id="IEq125"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left(i,j,{p}_{6},0\right) &lt; A\left(i,j,{p}_{6},0\right)\cdot {p}_{9}$$\end{document}</tex-math><mml:math id="M254"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq125.gif"/></alternatives></inline-formula>. Otherwise, the subgroup <inline-formula id="IEq126"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M256"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq126.gif"/></alternatives></inline-formula> is added to the end of the list <inline-formula id="IEq127"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M258"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq127.gif"/></alternatives></inline-formula>.</p>
        <p id="Par45">After combining the subgroups, we think the reads in the same subgroup in the list <inline-formula id="IEq128"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M260"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq128.gif"/></alternatives></inline-formula> are from the same haplotype or the same copy of the repeat. The SNP alleles in the read can be verified by the centroid of its subgroup, which helps to find inconsistent overlaps more accurately. In addition, since the group <inline-formula id="IEq129"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq129.gif"/></alternatives></inline-formula> contains the template read <inline-formula id="IEq130"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M264"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq130.gif"/></alternatives></inline-formula>, we use the centroid of the group <inline-formula id="IEq131"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M266"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq131.gif"/></alternatives></inline-formula> to correct SNP alleles in the template read <inline-formula id="IEq132"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M268"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq132.gif"/></alternatives></inline-formula>. Here, the read is corrected when it is treated as a template read. After all reads are corrected, we run the verifying and correcting SNP alleles step again to obtain more robust results. We run the step twice by default.</p>
      </sec>
      <sec id="Sec16">
        <title>Finding inconsistent overlaps</title>
        <p id="Par46">In the last round of verifying and correcting SNP alleles, we identify inconsistent overlaps. After combining steps, for each template read <inline-formula id="IEq133"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M270"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq133.gif"/></alternatives></inline-formula>, we obtain a subgroup list <inline-formula id="IEq134"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M272"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq134.gif"/></alternatives></inline-formula> and the first subgroup <inline-formula id="IEq135"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq135.gif"/></alternatives></inline-formula> of <inline-formula id="IEq136"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M276"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq136.gif"/></alternatives></inline-formula> contains the template read <inline-formula id="IEq137"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M278"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq137.gif"/></alternatives></inline-formula>. We consider a query read <inline-formula id="IEq138"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M280"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq138.gif"/></alternatives></inline-formula> and the template read <inline-formula id="IEq139"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M282"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq139.gif"/></alternatives></inline-formula> to be inconsistent if the query read <inline-formula id="IEq140"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M284"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq140.gif"/></alternatives></inline-formula> and its subgroup <inline-formula id="IEq141"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{r}$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq141.gif"/></alternatives></inline-formula> (<inline-formula id="IEq142"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r\in {L}_{r}$$\end{document}</tex-math><mml:math id="M288"><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq142.gif"/></alternatives></inline-formula>) meet the conditions:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\rm{|}}}}}}D\left({L}_{r},{L}_{1},{p}_{6},{p}_{7}\right){{{{{\rm{|}}}}}}\ge \max ({p}_{8},{{{{{\rm{|}}}}}}A\left({L}_{r},{L}_{1},{p}_{6},{p}_{7}\right){{{{{\rm{|}}}}}}\cdot {p}_{9});$$\end{document}</tex-math><mml:math id="M290"><mml:mi mathvariant="normal">∣</mml:mi><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">∣</mml:mi><mml:mo>≥</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∣</mml:mi><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">∣</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo></mml:math><graphic xlink:href="41467_2024_47349_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|D\left(r,{L}_{1},0,0\right)\bigcap A\left({L}_{r},{L}_{1},{p}_{6},{p}_{7}\right)\right| \ge \max ({p}_{8},{{{{{\rm{|}}}}}}A\left(r,{L}_{1},0,0\right)\\ \bigcap A\left({L}_{r},{L}_{1},{p}_{6},{p}_{7}\right){{{{{\rm{|}}}}}}\cdot {p}_{9}).$$\end{document}</tex-math><mml:math id="M292"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo mathsize="big">⋂</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>≥</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∣</mml:mi><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo mathsize="big">⋂</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">∣</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2024_47349_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par47">The parameters <inline-formula id="IEq143"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{6}$$\end{document}</tex-math><mml:math id="M294"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq143.gif"/></alternatives></inline-formula>, <inline-formula id="IEq144"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{7}$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq144.gif"/></alternatives></inline-formula>, <inline-formula id="IEq145"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{8}$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq145.gif"/></alternatives></inline-formula> and <inline-formula id="IEq146"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{9}$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq146.gif"/></alternatives></inline-formula> are mentioned above. We record the location and direction of the reads in the haplotype-collapsed contigs. The overlaps between the inconsistent read pairs are identified as inconsistent overlaps if the directions and distances of the reads in the overlaps do not conflict with those in the haplotype-collapsed contigs (The difference between two distances should be less than 1000 by default.). The distance of the reads is defined as the distance of the 3’ ends of the reads. We record the inconsistent overlap information and SNP alleles in reads for subsequent steps.</p>
      </sec>
      <sec id="Sec17">
        <title>Combining Nanopore raw reads to identify inconsistent overlaps</title>
        <p id="Par48">For Nanopore datasets, we combine the corrected reads and raw reads to identify inconsistent overlaps. We first identify inconsistent overlaps using corrected reads with the strict threshold that the pair of reads should contain 8 different SNP alleles. Then, we use raw reads to identify inconsistent overlaps with the loose threshold that the pair of reads should contain 6 different SNP alleles. Using raw reads to identify inconsistent overlaps is similar to that using corrected reads. For Nanopore reads, we use Clair3<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> to call heterozygous SNPs for each contig. Since PECAT doesn’t change the names of the reads during error correction, inconsistent overlaps between raw reads can be regarded as inconsistent overlaps between corrected reads. Similar to using corrected reads, we also check whether the directions and distances of the reads in the overlaps conflict with those in the haplotype-collapsed contigs. We record the location of corrected reads in raw reads during error correction. Therefore, we can calculate the distance of corrected reads in the haplotype-collapsed contigs by linear mapping. The distance threshold is set to <inline-formula id="IEq147"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\max (2500,0.05*{D}_{c})$$\end{document}</tex-math><mml:math id="M302"><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2500</mml:mn><mml:mo>,</mml:mo><mml:mn>0.05</mml:mn><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq147.gif"/></alternatives></inline-formula> by default, where <inline-formula id="IEq148"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{{{{{{\rm{c}}}}}}}$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq148.gif"/></alternatives></inline-formula> is distance of corrected reads in the haplotype-collapsed contigs.</p>
      </sec>
    </sec>
    <sec id="Sec18">
      <title>Fast string-graph-based assembler</title>
      <p id="Par49">According to the characteristics of k-mer-based alignment and string graphs, we propose a fast string-graph-based assembler to balance the quality and speed of assembling. First, we use minimap2 with parameters “-X -g3000 -w30 -k19 -m100 -r500” to find candidate overlaps between corrected reads. Minimap2<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> with those parameters invokes the k-mer-based alignment. To reduce overhangs of overlaps, we extend the alignment to the ends of the reads with the diff<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> algorithm and filter out overlaps still with long overhangs. Next, we remove the overlaps whose reads are contained in other reads or with low coverage. A directed string graph is constructed using the remaining overlaps. Myers’ algorithm<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> is used to mark transitive edges as inactive ones. We implement local alignment using the edlib<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> algorithm to calculate the identity of each active edge, which is defined as the identity of its related overlap. Only a few edges need to calculate identities for most of the edges are marked as inactive ones. The edges whose identities are less than the threshold are marked as low quality and removed. The threshold is determined by the formula <inline-formula id="IEq149"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(({m}_{1}-6*1.253*{{MAD}}_{1})+2*({m}_{2}-6*1.4826*{{MAD}}_{2}))/3$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>6</mml:mn><mml:mo>*</mml:mo><mml:mn>1.253</mml:mn><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>*</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>6</mml:mn><mml:mo>*</mml:mo><mml:mn>1.4826</mml:mn><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq149.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq150"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}_{1}$$\end{document}</tex-math><mml:math id="M308"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq150.gif"/></alternatives></inline-formula> and <inline-formula id="IEq151"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}_{2}$$\end{document}</tex-math><mml:math id="M310"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq151.gif"/></alternatives></inline-formula> are the mean and the median of identity of all active edges in the string graph and <inline-formula id="IEq152"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{MAD}}_{1}$$\end{document}</tex-math><mml:math id="M312"><mml:msub><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq152.gif"/></alternatives></inline-formula> and <inline-formula id="IEq153"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{MAD}}_{2}$$\end{document}</tex-math><mml:math id="M314"><mml:msub><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq153.gif"/></alternatives></inline-formula> are the mean absolute deviation and the median absolute deviation of them. This step also breaks some paths connected by low-quality edges in the graphs. To repair those paths, we check dead-end nodes whose outdegree or indegree are equal to 0. We calculate the identities of their transitive edges and reactivate the edge with the longest alignment and the identity greater than the threshold. Considering that some breaks in paths are caused by reads being contained by other reads from the different haplotype or the different copy of the repeat, we extend the dead-end nodes with contained reads to repair the breaks using the similar method. In this way, an appropriate string graph is constructed. After performing other simplifying processes, such as removing the ambiguous edges (tips, bubbles, and spurious links) in the graph, we identify linear paths from the graph and generate contigs.</p>
    </sec>
    <sec id="Sec19">
      <title>Improvement of best overlap graph algorithm</title>
      <p id="Par50">Best overlap graph algorithm<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> only retains the best out-edge and the best in-edge of each node according to the overlap length. After removing transitive edges using Myers’ algorithm<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, PECAT performs the best overlap graph algorithm to further simplify the string graph. However, the original algorithm is not suitable for diploid assembly. The SNP alleles in reads are more important than the overlap length to measure which edge is the best one. Although most inconsistent overlaps are removed, there remain some undetected inconsistent overlaps and the corresponding reads contain different SNP alleles. We improve the algorithm and use the following steps to determine the best edges. First, for the in-edges or out-edges of each node, we sort the edges in descending order of the edge score <inline-formula id="IEq154"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}=({{n}_{i}^{+}\cdot w-n}_{i}^{-},{l}_{i})$$\end{document}</tex-math><mml:math id="M316"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq154.gif"/></alternatives></inline-formula>. <inline-formula id="IEq155"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{i}^{+}$$\end{document}</tex-math><mml:math id="M318"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq155.gif"/></alternatives></inline-formula> and <inline-formula id="IEq156"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{i}^{-}$$\end{document}</tex-math><mml:math id="M320"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq156.gif"/></alternatives></inline-formula> are the numbers of two related reads containing the same or different SNP alleles, which are obtained in finding inconsistent overlaps step. <inline-formula id="IEq157"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w$$\end{document}</tex-math><mml:math id="M322"><mml:mi>w</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq157.gif"/></alternatives></inline-formula> is a user-defined parameter. Its default value is set to 0.5. <inline-formula id="IEq158"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${l}_{i}$$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq158.gif"/></alternatives></inline-formula> is the overlap length. The first edge <inline-formula id="IEq159"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{0}$$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq159.gif"/></alternatives></inline-formula> is marked as a candidate best edge. The other edges meeting the following conditions also are marked as the candidate best edges: (1) Its related read is inconsistent with the reads related to the candidate best edges. (2) Its score is not too much less than the first edge <inline-formula id="IEq160"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{0}$$\end{document}</tex-math><mml:math id="M328"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq160.gif"/></alternatives></inline-formula>, which means <inline-formula id="IEq161"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{0}\left[0\right]-{s}_{i}\left[0\right]\, &lt; \,\left\{\begin{array}{c}\max \left(C,\,{s}_{i}\left[0\right]\cdot {R}_{1}\right),\,{s}_{i}\left[0\right]\, \ge \,0\\ \max \left(C,-{s}_{i}\left[0\right]\cdot {R}_{2}\right),\,{s}_{i}\left[0\right] \, &lt; \, 0\end{array}\right.$$\end{document}</tex-math><mml:math id="M330"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>&lt;</mml:mo><mml:mspace width="0.25em"/><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>max</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>≥</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>max</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>&lt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq161.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq162"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><mml:math id="M332"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq162.gif"/></alternatives></inline-formula>, <inline-formula id="IEq163"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{1}$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq163.gif"/></alternatives></inline-formula> and <inline-formula id="IEq164"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{2}$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq164.gif"/></alternatives></inline-formula> are user-defined parameters (the default values are 4, 2, and 0.66). Next, if the edge is marked as a candidate best edge twice (in-edge and out-edge), it is selected as the best edge. Then, if the node has no best in-edge or best out-edge, its first in-edge or first out-edge is selected as the best one. Finally, the edges selected as the best edges are retained and the other edges are removed from the string graph.</p>
    </sec>
    <sec id="Sec20">
      <title>Generating two sets of contigs</title>
      <p id="Par51">After simplifying the string graph, PECAT identifies three structures from the string graph, as shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">29a</xref>. First, we use FALCON-Unzip’s heuristic algorithm<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> to identify bubble structures. Generally, the paths in the bubble structure are from different haplotypes. Then, we also identify alternate branches, which meet the following conditions: (1) There are only two branches. (2) The shorter branch is linear and does not contain other branches. (3) More than 30% of reads in the shorter branch are inconsistent with the reads in the other branch. We think the two branches that meet the conditions are from different haplotypes. We identify the paths in the string graph and do not break the paths if they encounter bubble structures or alternate branches. This trick can increase the continuity of primary contigs. The other paths in bubble structures or the alternate branches output as alternate contigs. We also check each pair of arbitrary independent contigs. If more than 30% of reads in the shorter contig are inconsistent with the reads in another contig, the shorter contig is labeled as an alternate contig. Another contig not labeled as an alternate contig is outputted as a primary contig.</p>
      <p id="Par52">To generate a dual assembly, PECAT connects the paths in two adjacent bubble structures. In the step of inconsistent overlap identification, we have called SNP alleles in each read. The information is used to determine the pair of paths in adjacent bubble structures that should be connected. As shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">29b</xref>, we build two read groups <inline-formula id="IEq165"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{1}$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq165.gif"/></alternatives></inline-formula> and <inline-formula id="IEq166"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{2}$$\end{document}</tex-math><mml:math id="M340"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq166.gif"/></alternatives></inline-formula> for in-edges <inline-formula id="IEq167"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{1}$$\end{document}</tex-math><mml:math id="M342"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq167.gif"/></alternatives></inline-formula> and <inline-formula id="IEq168"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{2}$$\end{document}</tex-math><mml:math id="M344"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq168.gif"/></alternatives></inline-formula> respectively. If the reads only overlap with the reads in in-edges <inline-formula id="IEq169"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{1}$$\end{document}</tex-math><mml:math id="M346"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq169.gif"/></alternatives></inline-formula> or <inline-formula id="IEq170"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{2}$$\end{document}</tex-math><mml:math id="M348"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq170.gif"/></alternatives></inline-formula>, they are assigned to <inline-formula id="IEq171"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{1}$$\end{document}</tex-math><mml:math id="M350"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq171.gif"/></alternatives></inline-formula> or <inline-formula id="IEq172"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{2}$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq172.gif"/></alternatives></inline-formula>, respectively. If the reads overlap with the reads in in-edges <inline-formula id="IEq173"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{1}$$\end{document}</tex-math><mml:math id="M354"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq173.gif"/></alternatives></inline-formula> and <inline-formula id="IEq174"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{2}$$\end{document}</tex-math><mml:math id="M356"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq174.gif"/></alternatives></inline-formula> at the same time, the reads are assigned to the group whose centroid the reads are closer to. The concepts of centroid and distance are defined in the previous section on verifying and correcting SNP alleles. In the same way, we get read groups <inline-formula id="IEq175"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${O}_{1}$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq175.gif"/></alternatives></inline-formula> or <inline-formula id="IEq176"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${O}_{2}$$\end{document}</tex-math><mml:math id="M360"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq176.gif"/></alternatives></inline-formula> for out-edges <inline-formula id="IEq177"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{out}}_{1}$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq177.gif"/></alternatives></inline-formula> or <inline-formula id="IEq178"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{out}}_{2}$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq178.gif"/></alternatives></inline-formula>. If the centroid of <inline-formula id="IEq179"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{1}$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq179.gif"/></alternatives></inline-formula> or <inline-formula id="IEq180"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{2}$$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq180.gif"/></alternatives></inline-formula> does not have a common heterozygous site with the centroid of <inline-formula id="IEq181"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${O}_{1}$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq181.gif"/></alternatives></inline-formula> or <inline-formula id="IEq182"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${O}_{2}$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq182.gif"/></alternatives></inline-formula>, we randomly connect the paths of bubble structures. Otherwise, we choose the paths to minimize the distance between their corresponding read group centroids.</p>
    </sec>
    <sec id="Sec21">
      <title>Polishing two sets of contigs</title>
      <p id="Par53">After generating contigs in primary/alternate format or dual assembly format, we use corrected reads or raw reads to polish them. We map the reads to the contigs using minimap2. In previous steps, we record which read pairs are inconsistent and which reads construct the contigs. If the read is inconsistent with the reads used for constructing the contig, the related alignments are removed. This trick helps to reduce haplotype switch errors. After removing other low-quality alignments, we run racon<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> with default parameters to polish the contigs.</p>
      <p id="Par54">For the assemblies from the Nanopore sequences, we use Medaka (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/medaka">https://github.com/nanoporetech/medaka</ext-link>) to further improve the assembly quality. Its steps are similar to those polishing with racon. The key step is to filter the inconsistent alignments between the reads and the contigs according to the information of inconsistent overlap.</p>
    </sec>
    <sec id="Sec22">
      <title>Evaluation</title>
      <p id="Par55">To evaluate the effectiveness of correction methods fairly, we extract the 40X longest reads from corrected reads and then evaluate them. We map the reads to the reference genome using minimap2 with parameters “-c --eqx”. It generates CIGAR strings. We scan the CIGAR strings to calculate the accuracy of each corrected data. To evaluate the accuracy of the sequences in the difficult-to-map regions and low-complexity regions in the HG002 reference genome, we map the HG002 reference genome to GRCh38. The regions are located in the HG002 reference genome according to GIAB v2.0 genome stratification BED files and the alignment between the HG002 reference genome and GRCh38. Then, we calculate the accuracy of the sequences in these regions separately. To evaluate the haplotype-specific k-mers completeness, we calculate the percentage of parent-specific k-mers in 40X longest reads. Considering that there are 40X datasets, we only count k-mers with equal to or more than 4 occurrences. To evaluate the haplotype-specific k-mers consistency, we calculate the metric as <inline-formula id="IEq183"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum \max ({k}_{p},{k}_{m})/\sum ({k}_{p}+{k}_{m})$$\end{document}</tex-math><mml:math id="M374"><mml:mo>∑</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq183.gif"/></alternatives></inline-formula>, in which <inline-formula id="IEq184"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{p}$$\end{document}</tex-math><mml:math id="M376"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq184.gif"/></alternatives></inline-formula> and <inline-formula id="IEq185"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{m}$$\end{document}</tex-math><mml:math id="M378"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq185.gif"/></alternatives></inline-formula> are the number of paternal and maternal haplotype-specific k-mers in each read.</p>
      <p id="Par56">To evaluate the performance of selecting supporting reads and the performance of finding inconsistent overlaps, we use Illumina reads of parents to classify long reads with a trio-binning algorithm<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. We adjust the threshold to reduce false positives. The read is classified as the paternal read if it meets the condition: <inline-formula id="IEq186"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{k}_{p}}{{K}_{p}} &gt; \frac{{k}_{m}+\max (10,{k}_{m}\cdot 0.1)}{{K}_{m}}$$\end{document}</tex-math><mml:math id="M380"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mn>0.1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq186.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq187"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{p}$$\end{document}</tex-math><mml:math id="M382"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq187.gif"/></alternatives></inline-formula> and <inline-formula id="IEq188"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{m}$$\end{document}</tex-math><mml:math id="M384"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq188.gif"/></alternatives></inline-formula> are the numbers of paternal and maternal haplotype-specific k-mers in the read, and <inline-formula id="IEq189"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{p}$$\end{document}</tex-math><mml:math id="M386"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq189.gif"/></alternatives></inline-formula> and <inline-formula id="IEq190"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{m}$$\end{document}</tex-math><mml:math id="M388"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq190.gif"/></alternatives></inline-formula> are the numbers of all paternal and maternal haplotype-specific k-mers. The read is classified as a maternal read if it meets the condition: <inline-formula id="IEq191"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{k}_{m}}{{K}_{m}} &gt; \frac{{k}_{p}+\max (10,{k}_{p}\cdot 0.1)}{{K}_{p}}$$\end{document}</tex-math><mml:math id="M390"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mn>0.1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq191.gif"/></alternatives></inline-formula>. Otherwise, it is classified to the untagged reads. When one read of the pair of reads is a maternal read and the other read is a paternal read or vice versa, we think the pair of reads is inconsistent.</p>
      <p id="Par57">We use the k-mer-based assembly evaluation tool merqury<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> to evaluate the diploid assemblies generated by each pipeline and use BUSCO<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> to evaluate the gene completeness of assemblies. The hamming error rate of the assemblies is calculated from the output of merqury. The details of the parameters used in this study are described in Supplementary Notes <xref rid="MOESM1" ref-type="media">4</xref>, <xref rid="MOESM1" ref-type="media">5</xref>. We use the reference-based evaluation tool Pomoxis (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/pomoxis">https://github.com/nanoporetech/pomoxis</ext-link>) to evaluate the base quality of diploid assemblies <bold>(</bold>Supplementary Note <xref rid="MOESM1" ref-type="media">6</xref>). The genome fraction is evaluated by QUAST<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> and its parameters are described in Supplementary Note <xref rid="MOESM1" ref-type="media">7</xref>.</p>
      <p id="Par58">We obtain the small variants (SNP and INDEL) sets from HG002 assemblies against GRCh38 using dipcall<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> and compare them against the HG002 GIAB benchmark to evaluate their precisions, recalls, and F1 scores using hap.py<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>. We called structural variant (SV) sets from HG002 assemblies against GRCh37 using hapdiff (<ext-link ext-link-type="uri" xlink:href="https://github.com/KolmogorovLab/hapdiff">https://github.com/KolmogorovLab/hapdiff</ext-link>) and compare them against the curated set of SVs in the HG002 genome<sup><xref ref-type="bibr" rid="CR55">55</xref></sup> to evaluate their precisions, recalls, and F1 scores using truvari<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> (Supplementary Note <xref rid="MOESM1" ref-type="media">8</xref>).</p>
    </sec>
    <sec id="Sec23">
      <title>Reporting summary</title>
      <p id="Par59">Further information on research design is available in the <xref rid="MOESM5" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec24">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2024_47349_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2024_47349_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2024_47349_MOESM3_ESM.docx">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2024_47349_MOESM4_ESM.xlsx">
            <caption>
              <p>Supplementary Data 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2024_47349_MOESM5_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Fan Nie, Peng Ni</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-024-47349-7.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported in part by the National Key Research and Development Program of China (No. 2021YFF1201200); the National Natural Science Foundation of China under Grants (Nos. 62350004, 62332020); the Project of Xiangjiang Laboratory (No. 23XJ01011) to Jianxin Wang. This work was also supported in part by the US National Institute of Food and Agriculture (NIFA; Grant Number 2017-70016-26051 and 2023-70029-41309) and the US National Science Foundation (NSF; Grant Number ABI-1759856, MRI-2018069, MTM2-2025541) to Feng Luo. This work was also supported in part by Guangdong Basic and Applied Basic Research Foundation (No. 2020B1515020057) to Chuanle Xiao. We are grateful for resources from the High-Performance Computing Center of Central South University.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.X.W., F.L., and C.L.X. conceived and designed this project. F.N. and J.X.W. conceived, designed, and implemented the consensus and assembly algorithm. F.N. and P.N. integrated all the programs into the PECAT pipeline and provided documentation. F.N., P.N., N.H., and J.Z. analyzed the performance of algorithms developed in this study. C.L.X. and Z.Y.W. provided the dataset <italic>A. thaliana</italic> (Col-0 × C24). J.X.W., F.L., and F.N. performed the theoretical analysis of the algorithms developed in this study. J.X.W., F.L., and F.N. wrote the manuscript. Z.Y.W. wrote about cultivating <italic>A. thaliana</italic> (Col-0 × C24) and extracting its DNA. All authors have read and approved the final version of this manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par60"><italic>Nature Communications</italic> thanks Kishwar Shafin for his contribution to the peer review of this work. A peer review file is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>All described datasets are obtained from public websites, except for <italic>A. thaliana</italic> (Col-0 × C24) which is generated using our in-house sequencing. It is available from NGDC at <ext-link ext-link-type="uri" xlink:href="https://ngdc.cncb.ac.cn/bioproject/browse/PRJCA011723">PRJCA011723</ext-link>. <italic>S. cerevisiae</italic> (SK × Y12), <italic>A. thaliana</italic> (Col-0 × Cvi-0), <italic>D. melanogaster</italic> (ISO1 × A4), <italic>B. taurus</italic> (Angus × Brahman), and <italic>B. taurus</italic> (Bison×Simmental) are available from NCBI at <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJEB7245">PRJEB7245</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA314706">PRJNA314706</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA558397">PRJNA558397</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA432857">PRJNA432857</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA677946">PRJNA677946</ext-link>. HG002 using Nanopore R9 sequencing is available at Human Pangenome Reference Consortium (HPRC) [<ext-link ext-link-type="uri" xlink:href="https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=T2T/scratch/HG002/sequencing/ont/">https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=T2T/scratch/HG002/sequencing/ont/</ext-link>]. HG002 using Nanopore R10 sequencing is available at HPRC [<ext-link ext-link-type="uri" xlink:href="https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=submissions/5b73fa0e-658a-4248-b2b8-cd16155bc157--UCSC_GIAB_R1041_nanopore/HG002_R1041_UL/Guppy6/">https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=submissions/5b73fa0e-658a-4248-b2b8-cd16155bc157--UCSC_GIAB_R1041_nanopore/HG002_R1041_UL/Guppy6/</ext-link>]. HG002 using Nanopore R10 duplex sequencing is available at HPRC [<ext-link ext-link-type="uri" xlink:href="https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=submissions/0CB931D5-AE0C-4187-8BD8-B3A9C9BFDADE--UCSC_HG002_R1041_Duplex_Dorado/Dorado_v0.1.1/stereo_duplex">https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=submissions/0CB931D5-AE0C-4187-8BD8-B3A9C9BFDADE--UCSC_HG002_R1041_Duplex_Dorado/Dorado_v0.1.1/stereo_duplex</ext-link>]. HG002 using PacBio HiFi sequencing is available from NCBI at <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA586863">PRJNA586863</ext-link>. GIAB v2.0 genome stratification BED files are available at <ext-link ext-link-type="uri" xlink:href="https://ftp-trace.ncbi.nlm.nih.gov/ReferenceSamples/giab/release/genome-stratifications/v2.0/GRCh38/">GIAB</ext-link>. HG002 GIAB benchmark is available at <ext-link ext-link-type="uri" xlink:href="https://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/release/AshkenazimTrio/HG002_NA24385_son/NISTv3.3.2/">GIAB</ext-link>. The curated set of SVs in the HG002 is available at <ext-link ext-link-type="uri" xlink:href="https://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/AshkenazimTrio/analysis/NIST_SVs_Integration_v0.6/">GIAB</ext-link>. NCTC9006 and NCTC9024 are available from ENA at <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ena/browser/view/PRJEB6403">PRJEB6403</ext-link>. The details of the datasets used in this study are reported in Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">17</xref>. All assemblies are available at Zenodo [10.5281/zenodo.10457427].</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>All source codes for PECAT are available at GitHub [<ext-link ext-link-type="uri" xlink:href="https://github.com/lemene/PECAT">https://github.com/lemene/PECAT</ext-link>] and Zenodo [10.5281/zenodo.10799833].</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par61">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagarajan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Sequence assembly demystified</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>157</fpage>
        <lpage>167</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3367</pub-id>
        <?supplied-pmid 23358380?>
        <pub-id pub-id-type="pmid">23358380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gagarinova</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Emili</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Genome-scale genetic manipulation methods for exploring bacterial molecular biology</article-title>
        <source>Mol. Biosyst.</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>1626</fpage>
        <pub-id pub-id-type="doi">10.1039/c2mb25040c</pub-id>
        <?supplied-pmid 22517266?>
        <pub-id pub-id-type="pmid">22517266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>International Human Genome Sequencing Consortium</surname>
          </name>
        </person-group>
        <article-title>Finishing the euchromatic sequence of the human genome</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>431</volume>
        <fpage>931</fpage>
        <lpage>945</lpage>
        <pub-id pub-id-type="doi">10.1038/nature03001</pub-id>
        <pub-id pub-id-type="pmid">15496913</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chin</surname>
            <given-names>CS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phased diploid genome assembly with single-molecule real-time sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>1050</fpage>
        <lpage>1054</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4035</pub-id>
        <?supplied-pmid 27749838?>
        <pub-id pub-id-type="pmid">27749838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Canu: scalable and accurate long-read assembly via adaptive <italic>k</italic> -mer weighting and repeat separation</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>722</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.215087.116</pub-id>
        <?supplied-pmid 28298431?>
        <pub-id pub-id-type="pmid">28298431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>C-L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MECAT: fast mapping, error correction, and de novo assembly for single-molecule sequencing reads</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>1072</fpage>
        <lpage>1074</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4432</pub-id>
        <?supplied-pmid 28945707?>
        <pub-id pub-id-type="pmid">28945707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolmogorov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Assembly of long, error-prone reads using repeat graphs</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>540</fpage>
        <lpage>546</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0072-8</pub-id>
        <?supplied-pmid 30936562?>
        <pub-id pub-id-type="pmid">30936562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate long-read assembly with wtdbg2</article-title>
        <source>Nat. Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>155</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0669-3</pub-id>
        <?supplied-pmid 31819265?>
        <pub-id pub-id-type="pmid">31819265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Efficient assembly of nanopore reads via highly accurate and intact error correction</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>60</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-20236-7</pub-id>
        <?supplied-pmid 33397900?>
        <pub-id pub-id-type="pmid">33397900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weirather</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive comparison of Pacific Biosciences and Oxford Nanopore Technologies and their applications to transcriptome analysis</article-title>
        <source>F1000Research</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>100</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.10571.2</pub-id>
        <?supplied-pmid 28868132?>
        <pub-id pub-id-type="pmid">28868132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A universal SNP and small-indel variant caller using deep neural networks</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>983</fpage>
        <lpage>987</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4235</pub-id>
        <?supplied-pmid 30247488?>
        <pub-id pub-id-type="pmid">30247488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>A multi-task convolutional deep neural network for variant calling in single molecule sequencing</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>998</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09025-z</pub-id>
        <?supplied-pmid 30824707?>
        <pub-id pub-id-type="pmid">30824707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahsan</surname>
            <given-names>MU</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>NanoCaller for accurate detection of SNPs and indels in difficult-to-map regions from long-read sequencing by haplotype-aware deep neural networks</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>261</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02472-2</pub-id>
        <?supplied-pmid 34488830?>
        <pub-id pub-id-type="pmid">34488830</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafin</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype-aware variant calling with PEPPER-Margin-DeepVariant enables high accuracy in nanopore long-reads</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>1322</fpage>
        <lpage>1332</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01299-w</pub-id>
        <?supplied-pmid 34725481?>
        <pub-id pub-id-type="pmid">34725481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Symphonizing pileup and full-alignment for deep learning-based long-read variant calling</article-title>
        <source>Nat. Comput. Sci.</source>
        <year>2022</year>
        <volume>2</volume>
        <fpage>797</fpage>
        <lpage>803</lpage>
        <pub-id pub-id-type="doi">10.1038/s43588-022-00387-x</pub-id>
        <?supplied-pmid 38177392?>
        <pub-id pub-id-type="pmid">38177392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly of haplotype-resolved genomes with trio binning</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>1174</fpage>
        <lpage>1182</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jarvis</surname>
            <given-names>ED</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Semi-automated assembly of high-quality diploid human reference genomes</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>611</volume>
        <fpage>519</fpage>
        <lpage>531</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-05325-5</pub-id>
        <?supplied-pmid 36261518?>
        <pub-id pub-id-type="pmid">36261518</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rautiainen</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Telomere-to-telomere assembly of diploid chromosomes with Verkko</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2023</year>
        <volume>41</volume>
        <fpage>1474</fpage>
        <lpage>1482</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-023-01662-6</pub-id>
        <?supplied-pmid 36797493?>
        <pub-id pub-id-type="pmid">36797493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kronenberg</surname>
            <given-names>ZN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Extended haplotype-phasing of long-read de novo genome assemblies using Hi-C</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>1935</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-20536-y</pub-id>
        <?supplied-pmid 33911078?>
        <pub-id pub-id-type="pmid">33911078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Human Genome Structural Variation Consortium</surname>
          </name>
          <etal/>
        </person-group>
        <article-title>Fully phased human genome assembly without parental data using single-cell strand sequencing and long reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>302</fpage>
        <lpage>308</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0719-5</pub-id>
        <pub-id pub-id-type="pmid">33288906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campoy</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gamete binning: chromosome-level and haplotype-resolved genome assembly enabled by high-throughput single-cell sequencing of gamete genomes</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>306</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02235-5</pub-id>
        <?supplied-pmid 33372615?>
        <pub-id pub-id-type="pmid">33372615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Digestion-ligation-only Hi-C is an efficient and cost-effective method for chromosome conformation capture</article-title>
        <source>Nat. Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>754</fpage>
        <lpage>763</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0111-2</pub-id>
        <?supplied-pmid 29700467?>
        <pub-id pub-id-type="pmid">29700467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>HS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromosome-scale assembly comparison of the Korean Reference Genome KOREF from PromethION and PacBio with Hi-C mapping information</article-title>
        <source>GigaScience</source>
        <year>2019</year>
        <volume>8</volume>
        <fpage>giz125</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giz125</pub-id>
        <?supplied-pmid 31794015?>
        <pub-id pub-id-type="pmid">31794015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wenger</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate circular consensus long-read sequencing improves variant detection and assembly of a human genome</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>1155</fpage>
        <lpage>1162</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0217-9</pub-id>
        <?supplied-pmid 31406327?>
        <pub-id pub-id-type="pmid">31406327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Concepcion</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Haplotype-resolved de novo assembly using phased assembly graphs with hifiasm</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>170</fpage>
        <lpage>175</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01056-5</pub-id>
        <?supplied-pmid 33526886?>
        <pub-id pub-id-type="pmid">33526886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HiCanu: accurate assembly of segmental duplications, satellites, and allelic variants from high-fidelity long reads</article-title>
        <source>Genome Res.</source>
        <year>2020</year>
        <volume>30</volume>
        <fpage>1291</fpage>
        <lpage>1305</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.263566.120</pub-id>
        <?supplied-pmid 32801147?>
        <pub-id pub-id-type="pmid">32801147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype-resolved assembly of diploid genomes without parental data</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>1332</fpage>
        <lpage>1335</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-022-01261-x</pub-id>
        <?supplied-pmid 35332338?>
        <pub-id pub-id-type="pmid">35332338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bankevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bzikadze</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Kolmogorov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Antipov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Multiplex de Bruijn graphs enable genome assembly from long, high-fidelity reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>1075</fpage>
        <lpage>1081</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-022-01220-6</pub-id>
        <?supplied-pmid 35228706?>
        <pub-id pub-id-type="pmid">35228706</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and assembly of a human genome with ultra-long reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>338</fpage>
        <lpage>345</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4060</pub-id>
        <?supplied-pmid 29431738?>
        <pub-id pub-id-type="pmid">29431738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frei</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultralong Oxford nanopore reads enable the development of a reference-grade perennial ryegrass genome assembly</article-title>
        <source>Genome Biol. Evol.</source>
        <year>2021</year>
        <volume>13</volume>
        <fpage>evab159</fpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evab159</pub-id>
        <?supplied-pmid 34247248?>
        <pub-id pub-id-type="pmid">34247248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Yorke</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Reducing storage requirements for biological sequence comparison</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>3363</fpage>
        <lpage>3369</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth408</pub-id>
        <?supplied-pmid 15256412?>
        <pub-id pub-id-type="pmid">15256412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap and miniasm: fast mapping and de novo assembly for noisy long sequences</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>2103</fpage>
        <lpage>2110</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw152</pub-id>
        <?supplied-pmid 27153593?>
        <pub-id pub-id-type="pmid">27153593</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>The fragment assembly string graph</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>ii79</fpage>
        <lpage>ii85</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti1114</pub-id>
        <?supplied-pmid 16204131?>
        <pub-id pub-id-type="pmid">16204131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Grasso</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sharlow</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>Multiple sequence alignment using partial order graphs</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>452</fpage>
        <lpage>464</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.452</pub-id>
        <?supplied-pmid 11934745?>
        <pub-id pub-id-type="pmid">11934745</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <?supplied-pmid 29750242?>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>AnO(ND) difference algorithm and its variations</article-title>
        <source>Algorithmica</source>
        <year>1986</year>
        <volume>1</volume>
        <fpage>251</fpage>
        <lpage>266</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01840446</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kamath</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Shomorony</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Courtade</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Tse</surname>
            <given-names>DN</given-names>
          </name>
        </person-group>
        <article-title>HINGE: long-read assembly achieves optimal repeat resolution</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>747</fpage>
        <lpage>756</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.216465.116</pub-id>
        <?supplied-pmid 28320918?>
        <pub-id pub-id-type="pmid">28320918</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Benchmarking challenging small variants with linked and long reads</article-title>
        <source>Cell Genom.</source>
        <year>2022</year>
        <volume>2</volume>
        <fpage>100128</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100128</pub-id>
        <?supplied-pmid 36452119?>
        <pub-id pub-id-type="pmid">36452119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guan</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying and removing haplotypic duplication in primary genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>2896</fpage>
        <lpage>2898</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa025</pub-id>
        <?supplied-pmid 31971576?>
        <pub-id pub-id-type="pmid">31971576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolmogorov</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>
          <italic>Scalable nanopore sequencing of human genomes provides a comprehensive view of haplotype-resolved variation and methylation</italic>
        </article-title>
        <source>Nat. Methods</source>
        <year>2023</year>
        <volume>20</volume>
        <fpage>1483</fpage>
        <lpage>1492</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-023-01993-x</pub-id>
        <?supplied-pmid 37710018?>
        <pub-id pub-id-type="pmid">37710018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafin</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and the Shasta toolkit enable efficient de novo assembly of eleven human genomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>1044</fpage>
        <lpage>1053</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0503-6</pub-id>
        <?supplied-pmid 32686750?>
        <pub-id pub-id-type="pmid">32686750</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Berkeley</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Seppey</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Simão</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>BUSCO update: novel and streamlined workflows along with broader and deeper phylogenetic coverage for scoring of eukaryotic, prokaryotic, and viral genomes</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2021</year>
        <volume>38</volume>
        <fpage>4647</fpage>
        <lpage>4654</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msab199</pub-id>
        <?supplied-pmid 34320186?>
        <pub-id pub-id-type="pmid">34320186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rhie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Merqury: reference-free quality, completeness, and phasing assessment for genome assemblies</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>245</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02134-9</pub-id>
        <?supplied-pmid 32928274?>
        <pub-id pub-id-type="pmid">32928274</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oppenheimer</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A reference genome assembly of American bison, Bison bison bison</article-title>
        <source>J. Hered.</source>
        <year>2021</year>
        <volume>112</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="doi">10.1093/jhered/esab003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bollas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Au</surname>
            <given-names>KF</given-names>
          </name>
        </person-group>
        <article-title>Nanopore sequencing technology, bioinformatics and applications</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>1348</fpage>
        <lpage>1365</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-01108-x</pub-id>
        <?supplied-pmid 34750572?>
        <pub-id pub-id-type="pmid">34750572</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garg</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromosome-scale, haplotype-resolved assembly of human genomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>309</fpage>
        <lpage>312</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0711-0</pub-id>
        <?supplied-pmid 33288905?>
        <pub-id pub-id-type="pmid">33288905</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chin</surname>
            <given-names>CS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nonhybrid, finished microbial genome assemblies from long-read SMRT sequencing data</article-title>
        <source>Nat. Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>563</fpage>
        <lpage>569</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2474</pub-id>
        <?supplied-pmid 23644548?>
        <pub-id pub-id-type="pmid">23644548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Šošić</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Šikić</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Edlib: a C/C ++ library for fast, exact sequence alignment using edit distance</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>1394</fpage>
        <lpage>1395</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw753</pub-id>
        <?supplied-pmid 28453688?>
        <pub-id pub-id-type="pmid">28453688</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Savaresi, S. M. &amp; Boley, D. L. On the performance of bisecting K-means and PDDP. in <italic>Proceedings of the 2001 SIAM International Conference on Data Mining.</italic> 1–14 (2001).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Aggressive assembly of pyrosequencing reads with mates</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>2818</fpage>
        <lpage>2824</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn548</pub-id>
        <?supplied-pmid 18952627?>
        <pub-id pub-id-type="pmid">18952627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaser</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sović</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Nagarajan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Šikić</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate de novo genome assembly from long uncorrected reads</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>737</fpage>
        <lpage>746</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.214270.116</pub-id>
        <?supplied-pmid 28100585?>
        <pub-id pub-id-type="pmid">28100585</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saveliev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vyahhi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>QUAST: quality assessment tool for genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1072</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt086</pub-id>
        <?supplied-pmid 23422339?>
        <pub-id pub-id-type="pmid">23422339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A synthetic-diploid benchmark for accurate variant-calling evaluation</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>595</fpage>
        <lpage>597</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0054-7</pub-id>
        <?supplied-pmid 30013044?>
        <pub-id pub-id-type="pmid">30013044</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">The Global Alliance for Genomics and Health Benchmarking Team et al. Best practices for benchmarking germline small-variant calls in human genomes. <italic>Nat. Biotechnol</italic>. <bold>37</bold>, 555–560 (2019).</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zook</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A robust benchmark for detection of germline large deletions and insertions</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>1347</fpage>
        <lpage>1355</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0538-8</pub-id>
        <?supplied-pmid 32541955?>
        <pub-id pub-id-type="pmid">32541955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>English</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Menon</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Metcalf</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Truvari: refined structural variant comparison preserves allelic diversity</article-title>
        <source>Genome Biol.</source>
        <year>2022</year>
        <volume>23</volume>
        <fpage>271</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02840-6</pub-id>
        <?supplied-pmid 36575487?>
        <pub-id pub-id-type="pmid">36575487</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10997618</article-id>
    <article-id pub-id-type="pmid">38580638</article-id>
    <article-id pub-id-type="publisher-id">47349</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-024-47349-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>De novo diploid genome assembly using long noisy reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Nie</surname>
          <given-names>Fan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0801-7574</contrib-id>
        <name>
          <surname>Ni</surname>
          <given-names>Peng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Neng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Jun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Zhenyu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4680-0682</contrib-id>
        <name>
          <surname>Xiao</surname>
          <given-names>Chuanle</given-names>
        </name>
        <address>
          <email>xiaochuanle@126.com</email>
        </address>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4813-2403</contrib-id>
        <name>
          <surname>Luo</surname>
          <given-names>Feng</given-names>
        </name>
        <address>
          <email>luofeng@clemson.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1516-0480</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Jianxin</given-names>
        </name>
        <address>
          <email>jxwang@mail.csu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f1zfq44</institution-id><institution-id institution-id-type="GRID">grid.216417.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0379 7164</institution-id><institution>School of Computer Science and Engineering, </institution><institution>Central South University, </institution></institution-wrap>Changsha, 410083 China </aff>
      <aff id="Aff2"><label>2</label>Xiangjiang Laboratory, Changsha, 410205 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00xsfaz62</institution-id><institution-id institution-id-type="GRID">grid.412982.4</institution-id><institution-id institution-id-type="ISNI">0000 0000 8633 7608</institution-id><institution>National Center for Applied Mathematics in Hunan and Key Laboratory of Intelligent Computing and Information Processing of Ministry of Education, </institution><institution>Xiangtan University, </institution></institution-wrap>Xiangtan, Hunan 411105 China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f1zfq44</institution-id><institution-id institution-id-type="GRID">grid.216417.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0379 7164</institution-id><institution>Hunan Provincial Key Lab on Bioinformatics, </institution><institution>Central South University, </institution></institution-wrap>Changsha, 410083 China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01g9hkj35</institution-id><institution-id institution-id-type="GRID">grid.464309.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 6431 5677</institution-id><institution>Institute of Nanfan &amp; Seed Industry, </institution><institution>Guangdong Academy of Sciences, </institution></institution-wrap>Guangdong, 510316 China </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/003mfbe21</institution-id><institution>State Key Laboratory of Ophthalmology, Zhongshan Ophthalmic Center, </institution><institution>Sun Yat-sen University #7 Jinsui Road, Tianhe District, </institution></institution-wrap>Guangzhou, China </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/037s24f05</institution-id><institution-id institution-id-type="GRID">grid.26090.3d</institution-id><institution-id institution-id-type="ISNI">0000 0001 0665 0280</institution-id><institution>School of Computing, </institution><institution>Clemson University, </institution></institution-wrap>Clemson, SC 29634-0974 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>2964</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The high sequencing error rate has impeded the application of long noisy reads for diploid genome assembly. Most existing assemblers failed to generate high-quality phased assemblies using long noisy reads. Here, we present PECAT, a <bold>P</bold>hased <bold>E</bold>rror <bold>C</bold>orrection and <bold>A</bold>ssembly <bold>T</bold>ool, for reconstructing diploid genomes from long noisy reads. We design a haplotype-aware error correction method that can retain heterozygote alleles while correcting sequencing errors. We combine a corrected read SNP caller and a raw read SNP caller to further improve the identification of inconsistent overlaps in the string graph. We use a grouping method to assign reads to different haplotype groups. PECAT efficiently assembles diploid genomes using Nanopore R9, PacBio CLR or Nanopore R10 reads only. PECAT generates more contiguous haplotype-specific contigs compared to other assemblers. Especially, PECAT achieves nearly haplotype-resolved assembly on <italic>B. taurus</italic> (Bison×Simmental) using Nanopore R9 reads and phase block NG50 with 59.4/58.0 Mb for HG002 using Nanopore R10 reads.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Most existing assemblers failed to generate high-quality phased assemblies using long noisy reads. Here, the authors present PECAT, a Phased Error Correction and Assembly Tool, for reconstructing diploid genomes from long noisy reads.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Genome assembly algorithms</kwd>
      <kwd>Computational models</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100005825</institution-id>
            <institution>United States Department of Agriculture | National Institute of Food and Agriculture (NIFA)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2023-70029-41309</award-id>
        <principal-award-recipient>
          <name>
            <surname>Luo</surname>
            <given-names>Feng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000153</institution-id>
            <institution>NSF | BIO | Division of Biological Infrastructure (DBI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ABI-1759856</award-id>
        <principal-award-recipient>
          <name>
            <surname>Luo</surname>
            <given-names>Feng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">De novo genome assembly is a fundamental task in genomic research<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. Using long noisy reads from sequencing technologies, such as complete long reads (CLR) sequencing of Pacific Biosciences (PacBio) and Nanopore sequencing of Oxford Technologies (ONT), many assemblers<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR9">9</xref></sup> now can effectively reconstruct high-quality genome sequences for haploid or inbred species. However, a significant fraction of genetic information of a diploid genome is lost in those assemblies and most of them have lots of haplotype switch errors. Because long noisy reads, such as PacBio CLR reads and Nanopore reads, usually contain a 5–15% sequencing error<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, it is difficult to distinguish heterozygotes from sequencing errors in long noisy reads<sup><xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup>, which prevents the diploid assemblers from generating long haplotype-specific contigs. Recently, by combining long noisy reads with additional highly accurate sequencing data, such as parental short reads<sup><xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref></sup>, PacBio HiFi reads<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>, Hi-C reads<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, Strand-seq data<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, or gamete cell data<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, assemblers now can produce more contiguous haplotype-specific contigs. However, the requirements for additional sequencing data increase costs and limit their applications in practice<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR23">23</xref></sup>. Meanwhile, it is easier to identify haplotype differences using high accurate PacBio HiFi reads<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> (&lt; 1% error rate), which has been widely used for haplotype resolved assemblies<sup><xref ref-type="bibr" rid="CR25">25</xref>–<xref ref-type="bibr" rid="CR28">28</xref></sup>. However, the average lengths of HiFi reads (10–25 kb) are shorter than those of long noisy reads. For example, the ultra-long reads of Nanopore are up to 1 M in length and with read N50 &gt; 100 kb<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Longer reads usually help to assemble more contiguous contigs<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. Therefore, it will be useful to develop an assembler that can take advantage of long noisy reads to generate more contiguous haplotype-specific contigs for diploid genomes.</p>
    <p id="Par4">To achieve high-quality assemblies, error correction is usually a useful step for genome assembling using long noisy reads. One challenge for correct-then-assemble pipelines in assembling a diploid genome using long noisy reads is how to retain heterozygotes during error correction. If the sequencing error rate exceeds haplotype divergence, current correct-then-assemble pipelines<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup> eliminate heterozygotes as sequencing errors or mixed alleles of different haplotypes in a read. Therefore, corrected reads don’t contain heterozygote information for haplotype phasing. Assemblers, such as FALCON-Unzip<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, used raw reads instead of corrected reads in their “unzip” phasing step, then mapped the raw reads to the corrected reads for the later diploid assembly. This has led to assembly errors due to the heterozygote errors in the corrected reads and mapping errors between corrected reads and raw reads as the length of reads and their SNP position changed after correction<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. Furthermore, phasing raw reads is more difficult due to their high error rate.</p>
    <p id="Par5">Another challenge is partitioning reads according to their haplotypes in the phasing step. After error correction, there still are sequencing errors left in corrected reads. The error profile of corrected reads is also more complex than that of PacBio HiFi reads. Due to the sequencing errors, a significant fraction of reads is difficult to be phased to the correct haplotypes. This leads to inconsistent overlaps<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> among reads, whose reads come from different haplotypes or different copies of the segmental duplication. The inconsistent overlaps can cause haplotype switch errors or unresolved repeats. Accurately phasing the reads, and then identifying and removing inconsistent overlaps is important in overlap-graph-based diploid genome assembly. Even if we assemble the genome using PacBio HiFi reads, there is still need error correction step to improve the phasing accuracy<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. The higher error rate in corrected long noisy reads makes phasing and identifying inconsistent overlaps more difficult. It is necessary to design a more accurate and robust method to identify inconsistent overlaps for long noisy read-based assemblers.</p>
    <p id="Par6">Furthermore, to construct two haplotypes of diploid genomes, the assemblers often need higher coverage of sequencing data. However, with the increasing amount of sequencing data, the running time of assembly increases nonlinearly. Therefore, assembling large diploid genomes at an acceptable time is another challenge. Overlap-graph-based assemblers have their unique advantages to assemble diploid genomes since the overlaps can be reused in subsequent steps once they are found. This helps to design an efficient multi-round assembly strategy. The overlap-graph-based assemblers usually use seed (i.e., k-mers, minimizers<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>) based methods to find candidate overlaps, then perform local alignment to find the true overlaps. The local alignment is the major computational bottleneck of overlap-graph-based approaches. Although skipping local alignment can accelerate the overlap-finding step<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>, it leads to lots of false-positive overlaps and introduces errors in assembly graphs. String-graph-based<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> approaches, a type of overlap-graph-based approach, ignore the reads contained by other reads and mark most edges in the graph as transitive edges<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> that don’t contribute to the construction of contigs. Then, it is not necessary to perform local alignment on those read pairs. Therefore, it is possible to design a fast string-graph-based diploid genome assembler by minimizing the number of local alignments needed.</p>
    <p id="Par7">In this work, we present PECAT, a <bold>P</bold>hased <bold>E</bold>rror <bold>C</bold>orrection and <bold>A</bold>ssembly <bold>T</bold>ool, designed to reconstruct diploid genomes from long noisy reads, including PacBio CLR reads and Nanopore reads. PECAT follows the correct-then-assemble strategy, including a haplotype-aware error correction module, which can retain heterozygote alleles while correcting sequencing errors, and a two-round string graph-based assembly module. To accelerate the assembling, PECAT only performs local alignment when it is necessary instead of performing local alignments on all candidate overlaps. PECAT outputs two sets of contigs either in primary/alternate format (long contigs with the mosaic of homologous haplotypes and short haplotype-specific contigs) or in the dual assembly format<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> (two sets of long contigs with the mosaic of homologous haplotypes). PECAT can efficiently assemble diploid genomes using Nanopore R9, PacBio CLR or more accurate Nanopore R10 reads only and generate more contiguous haplotype-specific contigs compared to other assemblers.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Result</title>
    <sec id="Sec3">
      <title>Haplotype-aware error correction</title>
      <p id="Par8">Our error correction method (Fig. <xref rid="Fig1" ref-type="fig">1a</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>) is based on the partial-order alignment (POA) graph<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> method. For the template read to be corrected, a POA graph is built from the alignment of supporting reads. Then, the path with the highest weight is found in the POA graph to construct the consensus sequence for the template read. However, if the sequencing error rate exceeds haplotype divergence, current methods inevitably select supporting reads from different haplotypes. This causes either heterozygote alleles in the template reads to be eliminated as sequencing errors or heterozygous alleles from different haplotypes to be mixed in corrected reads.<fig id="Fig1"><label>Fig. 1</label><caption><title>Overview of PECAT.</title><p><bold>a</bold> Haplotype-aware error correction method. The reads in different colors (in green or in yellow) are from different haplotypes. The reads with a dark gray background color indicate that they are not selected. The supporting reads that are more likely from the same haplotype are selected to correct the template read. <bold>b</bold> The first round of assembly. PECAT finds overlaps between reads. The dashed lines indicate there are overlaps between reads. Our string-graph-based assembler is performed to construct haplotype-collapsed contigs. The reads in green or in yellow are from heterozygosity regions. The same color indicates that the reads come from the same haplotype. The reads in grey are from homozygosity regions. <bold>c</bold> The second round of assembly. PECAT identifies inconsistent overlaps by calling and analyzing SNP alleles in reads. After removing inconsistent overlaps from the overlaps found in the first round of assembly, PECAT performs our string-graph-based assembler again to construct the contigs in the primary/alternate format or the dual assembly format.</p></caption><graphic xlink:href="41467_2024_47349_Fig1_HTML" id="d33e464"/></fig></p>
      <p id="Par9">To maintain the heterozygote alleles in the template read, we need to select supporting reads from the same haplotype to correct it. After analyzing the POA graph, we have found that the difference between random sequencing errors and heterozygotes can be reflected in the POA graph. In the case of heterozygotes, there are two dominant parallel branches in the POA graph. In the case of random errors, there tends to be only one dominant branch (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1b</xref>). Based on this finding, we design a scoring algorithm to estimate the likelihood that the supporting read and the template read are from the same haplotype (<bold>Methods</bold>). For each position at which there are two dominant parallel branches, if the supporting read and the template read pass through the same dominant branch, the score is increased by 1 and if the supporting read and the template read pass through the different dominant branches, the score is decreased by 1 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1c</xref><bold>)</bold>. A higher score means that the template read and the supporting read are more likely from the same haplotype. If the supporting reads come from different haplotypes, the histogram of scores of all supporting reads should show two peaks (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1d</xref><bold>)</bold>. Then, we select the high-scoring supporting reads, which are very likely to be in the same haplotype as the template read, to correct the template read. To further increase the likelihood of selecting supporting reads in the same haplotype, we assign different weights to the reads according to their score. The higher the score of a read, the larger its weight is assigned (<bold>Methods</bold>). Then, we remove unselected reads in the POA graph by assigning their weights to 0. Finally, we use a dynamic programming approach to find the path with the highest weight in the POA graph and concatenated the nodes in the path, and generate the consensus sequence (<bold>Methods</bold>).</p>
      <p id="Par10">We evaluate the performance of the selection method on seven diploid datasets of <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison×Simmental) and HG002 (Nanopore R9), all with reads classified by the trio-binning algorithm<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> (<bold>Methods</bold>). As shown in Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>, without the selection method, 36.7%, 31.5%, 41.1%, 28.1%, 33.8%, 37.2% and 27.4% of supporting reads are inconsistent reads, respectively, which are from the haplotype different from the one of template read. Meanwhile, there are only 2.8%, 3.5% 4.9%, 3.6%, 4.3%, 2.9%, and 4.2% inconsistent reads in selected supporting reads, respectively. After further re-weighting the scores, the percentages of inconsistent reads are reduced to 2.1%, 3.1%, 4.0%, 3.1%, 3.5%, 2.3%, and 3.4%, respectively.</p>
      <p id="Par11">Since most of the selected supporting reads are from the same haplotype of the template read, most heterozygote alleles in the template read are correctly retained in our error correction method. We compare our method with other methods including Canu<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, MECAT2<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, and NECAT<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> on simulated PacBio CLR data and Nanopore data (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>, Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>, and Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>). The overall accuracies of corrected reads are similar, which exceeds 99%. However, the accuracies of SNP alleles in corrected reads are less than 80% for Canu and less than 60% for MECAT and NECAT, which are far worse than those of raw reads and reads corrected by PECAT. When the heterozygosity rate of simulated reads is greater than or equal to 0.0005, the accuracy of SNP alleles in reads corrected by PECAT is greater than 99%, which exceeds that of raw reads (96% or 98%). However, when the heterozygosity rate of simulated reads is equal to 0.0001, the accuracy of SNP alleles in reads corrected by PECAT is reduced to 92% ~ 94%, which is less than that of raw reads (96% ~ 98%). Therefore, for high heterozygosity genome regions (&gt;= 0.0005), our haplotype-aware error correction can preserve the SNPs well. However, for low heterozygosity genome regions (&lt; 0.0005), we need to combine with other methods to improve the accuracy of SNP calling (<bold>Methods</bold>).<fig id="Fig2"><label>Fig. 2</label><caption><title>Performance comparison of error correction.</title><p><bold>a</bold> Accuracy of raw and corrected reads and accuracy of SNP alleles in raw and corrected reads on the simulated datasets with different heterozygosity rates. <bold>b</bold> Accuracy of raw reads and corrected reads by NECAT and PECAT in difficult-to-map regions and low-complexity regions of HG002 reference genome. <bold>c, d</bold> Consistency, and completeness of raw reads and corrected reads by Canu, FALCON, MECAT2, NECAT, and PECAT on the seven diploid datasets. The metrics by Canu on <italic>B. taurus</italic> (PacBio CLR and ONT) and HG002 (ONT) and the metrics by FALCON on <italic>B. taurus</italic> (PacBio CLR) are excluded because they could not finish correcting in three weeks. Consistency is defined as <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum \max ({k}_{p},{k}_{m})/\sum ({k}_{p}+{k}_{m})$$\end{document}</tex-math><mml:math id="M2"><mml:mo>∑</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq1.gif"/></alternatives></inline-formula>, in which <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{p}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{m}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq3.gif"/></alternatives></inline-formula> are the number of paternal and maternal haplotype-specific k-mers in each read. Completeness is the percentage of parent-specific k-mers (occurrences <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 4$$\end{document}</tex-math><mml:math id="M8"><mml:mo>≥</mml:mo><mml:mn>4</mml:mn></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq4.gif"/></alternatives></inline-formula>) in the 40X longest reads. <bold>e</bold> Consistency of <italic>D. melanogaster</italic> (ISO1 × A4) raw reads and corrected reads by the different methods. Each point corresponds to a read. Its coordinate gives the proportion of the parental specific k-mers in the read, where k is 18. All 40X longest reads are shown in each sub-figure.</p></caption><graphic xlink:href="41467_2024_47349_Fig2_HTML" id="d33e655"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Fast string graph-based assembler</title>
      <p id="Par12">After error correction, PECAT implements two rounds of string graph-based assembly. In each round of assembly, we first construct the overlaps between the corrected reads using the seed-based alignment method (minimap2<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>), which allows us to build the overlaps quickly. However, seed-based alignment can bring low-quality overlaps with low identity or with long overhangs. Those low-quality overlaps could introduce errors during assembling. Performing local alignment on overlaps to identify low-quality ones becomes the major computational cost. To speed up the assembling, PECAT only performs local alignments when it is necessary during the construction of the string graph. (<bold>Methods</bold>). First, to reduce overhangs of overlaps, we use diff algorithm<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> to extend the candidate overlaps to the ends of the reads. Here, we only perform local alignment on overhangs instead of on the whole overlap. We remove the overlaps if their overhangs are still long (<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min ({{{{{\mathrm{100,0.01}}}}}}\cdot l)$$\end{document}</tex-math><mml:math id="M10"><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">100, 0.01</mml:mi><mml:mo>⋅</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq5.gif"/></alternatives></inline-formula> for PacBio reads and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min {({{{{\mathrm{300,0.03}}}}}}\cdot l)$$\end{document}</tex-math><mml:math id="M12"><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">300, 0.03</mml:mi><mml:mo>⋅</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq6.gif"/></alternatives></inline-formula> for Nanopore reads, where <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M14"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq7.gif"/></alternatives></inline-formula> is length of the read). On the diploid datasets of <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison × Simmental) and HG002, 5.3%, 10.3%, 82.2%, 12.8%, 20.0%, 59.4% and 56.3% of candidate overlaps with long overhangs have been considered as low quality and removed, respectively (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). Then, we further filter out the overlaps whose reads are contained in other reads or with low coverage. Only 0.15%, 0.18%, 0.86%, 0.86%, 0.03%, 1.23%, and 0.15% of overlaps remained on the above seven diploid datasets (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). We then construct a directed string graph from the remaining overlaps. We find the transitive edges using Myers’ algorithm<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> and mark them as inactive edges, which are not used for constructing contigs. On the above diploid datasets, only 25.1%, 16.7%, 16.3%, 18.5%, 20.7%, 15.4%, and 23.6% of edges are active (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>).</p>
      <p id="Par13">To remove low-quality edges in the string graph, we calculate the identity of the overlaps (the active edges) in the string graph using local alignments. Since most edges have been marked as inactive, we only need to perform local alignments for a small portion of overlaps. On the above diploid datasets, 2.1%, 12.2%, 9.5%, 2.2%, 13.2%, 1.8%, and 6.9% of active edges have been removed because their identities are less than the threshold (<bold>Methods</bold>) (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). After the above step, some paths in the graphs connected by low-quality edges are broken. Those broken paths need to be connected using the transitive edges that have been labeled as inactive edges. We then select transitive edges with the longest alignment and their identity greater than the threshold to connect the broken paths. On the above diploid datasets, about 0.67%, 0.12%, 0.15%, 0.09%, 0.13%, 0.05%, and 0.16% of transitive edges have been reactivated (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). Finally, we attempt to use the contained reads to connect the broken paths, and about 0.30%, 0.39%, 0.17%, 0.11%, 0.77%, 0.13%, and 0.45% of new edges are added to the graph on the above diploid datasets (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). In the first round of assembly (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>), PECAT finds linear paths from this string graph and constructs haplotype-collapsed contigs. In the second round of assembly (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>), PECAT identifies and removes inconsistent overlaps (next Section) in the string graph, and then generates two sets of contigs in primary/alternate format or dual assembly format. After generating contigs, we use corrected reads (CLR data) or raw reads (Nanopore data) to polish them to improve the quality (<bold>Methods</bold>).</p>
    </sec>
    <sec id="Sec5">
      <title>Identification of inconsistent overlaps</title>
      <p id="Par14">The inconsistent overlaps connect reads from different haplotypes or different copies of the segmental duplication in the overlap graph. They cause haplotype switch errors or unresolved repeats (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). After identifying and filtering out inconsistent overlaps, only the overlaps between reads from the same haplotype or the same copies of the segmental duplication are left, and then the assembler can naturally generate contigs of two haplotypes. Since our corrected reads contain allele information, we may use the SNP allele information to identify inconsistent overlaps. If the SNP alleles on a pair of reads are different, these two reads should come from different haplotypes and the overlaps between them should be inconsistent. At the error correction step, we have scored the possibility that two raw reads come from the same haplotype. However, the accuracy of the previous scoring that is based on the alignments between two raw reads cannot meet the requirements for identifying inconsistent overlaps. Therefore, we developed a read-level SNP caller and a read grouping method for identifying inconsistent overlaps.</p>
      <p id="Par15">First, we map all corrected reads onto the haplotype-collapsed contigs from the first round of assembly using minimap2<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. We call the heterozygous SNP sites based on the base frequency of the alignments (<bold>Methods</bold>). Then, we set each read as a template read and collect a set of reads that have the common SNP sites with it. We cluster the set of reads according to the SNP alleles in reads. The reads from the same haplotype are more likely to be clustered into the same subgroup. We then verify and correct the SNP alleles in the template read using other reads in the same subgroups. After identifying SNP alleles in each read, we remove the inconsistent overlaps using the SNP information from the candidate overlaps found in the first round of assembly. Then, we construct the string graph again. For high heterozygosity genome regions (&gt;= 0.0005), this inconsistent overlap identification approach works well due to the high accuracy of SNPs in corrected reads. However, for low heterozygosity genome regions (&lt; 0.0005), the SNP caller using corrected reads only can not achieve high performance in inconsistent overlap identification as the accuracy of SNPs is decreased dramatically in corrected reads for those genome regions. Therefore, we combine raw reads to identify and filter inconsistent overlaps. We first use corrected reads to identify inconsistent overlaps. Then, we call SNPs using raw reads and identify inconsistent overlaps again (<bold>Methods</bold>). For Nanopore reads, we have used Clair3<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> to call heterozygous SNP sites. For PacBio CLR reads, we do not have a tool to call SNPs from raw reads now.</p>
      <p id="Par16">We evaluate the performance of the inconsistent overlaps identification method using the haplotype reads classified by the trio-binning algorithm<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. As shown in Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>, compared with the first round of assemblies, the percentages of inconsistent overlaps in simplified graphs of the second round of assemblies of diploid datasets <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison × Simmental) and HG002 decrease sharply. The percentages of inconsistent overlaps have decreased from 36.98%, 16.00%, 15.94%, 36.55%, 16.62%, 18.08%, and 37.45% in the first round of assemblies to 0.32%, 0.57%, 0.90%, 0.63%, 0.79%, 0.03%, and 1.09% in the second round of assemblies, respectively. For the three Nanopore datasets, we compare the performance of the method using corrected reads, raw reads, and both (Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>). Using both raw and corrected reads, we get lower percentages of inconsistent overlaps in simplified graphs of the second round of assemblies of all three Nanopore datasets. The high performance of the inconsistent overlap identification method ensures that PECAT can generate the haplotype-specific contigs effectively. After filtering inconsistent overlaps, collapsed regions in the first round of assembly are separated in the second round of assembly. The sizes of alternate contigs are close to their corresponding reference genome in the second round of assembly (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>).</p>
      <p id="Par17">Moreover, our inconsistent overlap identification method can also help solve nearly identical repeats without knowing the number of their copies. The clustering step can automatically separate nearly identical repeats if there are SNPs that can divide the repeats. After filtering out the inconsistent overlaps at the repeats, PECAT can solve the repeat to generate contiguous contigs in the second round of assembly. As a result, PECAT achieves more contiguous assemblies in the second round of assembly on most of our diploid datasets (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>). As shown in Supplementary Figs. <xref rid="MOESM1" ref-type="media">3</xref> and <xref rid="MOESM1" ref-type="media">4</xref>, PECAT perfectly solves repeats in the NCTC9024 and NCTC9006 datasets and reconstructs two circle contigs, while other assemblers obtain fragment results<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR37">37</xref></sup>.</p>
    </sec>
    <sec id="Sec6">
      <title>Performance of PECAT error correction method</title>
      <p id="Par18">We evaluate the performance of the PECAT error correction method using four PacBio diploid datasets: <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), and three Nanopore diploid datasets: <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison × Simmental), and HG002. We compare PECAT with the error correction methods in the other four tools, including Canu<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, FALCON<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, MECAT2<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, and NECAT<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> (Fig. <xref rid="Fig2" ref-type="fig">2 b–e</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref><bold>)</bold>. All methods have reported high accuracy (&gt;98.6%). We also evaluate the performance of PECAT and NECAT on the difficult-to-map regions<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> and low-complexity regions of HG002 (<bold>Methods</bold>). On average, the accuracies of PECAT are 0.75% higher than those of NECAT, and the accuracy of corrected reads on these regions is similar to those on normal regions (Fig. <xref rid="Fig2" ref-type="fig">2b</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">7</xref><bold>)</bold>. We then assess the haplotype-specific k-mers completeness and consistency of corrected reads (<bold>Methods</bold>). These two metrics can evaluate the ability to retain consistent heterozygote alleles. The reads corrected by PECAT have higher completeness and consistency in all datasets (Fig. <xref rid="Fig2" ref-type="fig">2c, d</xref><bold>)</bold>. Especially, haplotype-specific k-mers consistencies of the reads corrected by PECAT are greater than or equal to 99.4% on all datasets, while haplotype-specific k-mers consistencies of the reads corrected by other methods are all less than or equal to 94.8%. The haplotype-specific k-mers completenesses of reads corrected by PECAT are also higher than those of reads corrected by other methods, especially for three Nanopore datasets. We plot the raw read and corrected reads using haplotype-specific k-mers for the seven datasets. As shown in Fig. <xref rid="Fig2" ref-type="fig">2e</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">5</xref>–<xref rid="MOESM1" ref-type="media">10</xref>, PECAT effectively avoids mixing heterozygous alleles from two haplotypes and its corrected reads tend to contain only one type of haplotype-specific k-mer. In summary, the reads corrected by PECAT contain more haplotype-specific k-mers than those corrected by other methods.</p>
    </sec>
    <sec id="Sec7">
      <title>Performance of PECAT assembler</title>
      <p id="Par19">We also assess the performance of the PECAT assembler using four PacBio diploid datasets: <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), and three Nanopore diploid datasets: <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison × Simmental) and HG002. We compare PECAT with four diploid genome assembly pipelines: Canu<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>+purge_dups<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, FALCON-Unzip<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, Flye<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>+HapDup<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR40">40</xref></sup>, and Shasta<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref><bold>)</bold>. We evaluate assembled genomes with respect to the assembly size, contiguity (contig NG50 and phase block NG50), and qualities (BUSCO<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, the base quality using pomosix (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/pomoxis">https://github.com/nanoporetech/pomoxis</ext-link>) and merqury<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>, ‘Intra-block switch error’ from merqury, and the hamming error rate). (<bold>Methods</bold>).</p>
      <p id="Par20">For four PacBio CLR datasets, all pipelines output the contigs in primary/alternate format. As shown in Table <xref rid="Tab1" ref-type="table">1</xref>, the sizes of both primary and alternate contigs of all four assemblies are close to those of their corresponding reference genome, except the alternate contigs of <italic>S. cerevisiae</italic> (SK1×Y12) genome assembled by Canu+Purge_dups. Compared to the other two pipelines, PECAT obtains the highest NG50 with 0.8/0.8, 14.3/7.8, 24.5/11.9, and 72.4/2.8 Mb and the highest ‘phase block NG50’ with 0.8/0.8, 12.1/7.4, 16.1/11.8, 4.5/2.4 Mb for all four assemblies. As shown in Supplementary Figs. <xref rid="MOESM1" ref-type="media">11</xref>–<xref rid="MOESM1" ref-type="media">14</xref>, the alternate contigs generated by all pipelines are haplotigs. Unlike the other two pipelines, most primary contigs by PECAT are also haplotigs except those of <italic>B. taurus</italic> (Angus×Brahman). These results are consistent with the results of the ‘Hamming error’, where the ‘Hamming error’ of primary contigs of <italic>B. taurus</italic> (Angus×Brahman) is exceptionally high. All pipelines have similar ‘Quality’ and BUSCO scores, except that Canu+Purge_dups has low BUSCO scores on alternate contigs of <italic>S. cerevisiae</italic>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance comparison of assembly on PacBio CLR datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Pipeline</th><th>Size (Mb)</th><th>NG50 (Mb)</th><th>Quality (reference-based)</th><th>Quality (k-mer- based)</th><th>BUSCO (%)</th><th>Hamming error (%)</th><th>Phase block NG50 (Mb)</th><th>Intra-block switch error (%)</th></tr></thead><tbody><tr><td rowspan="4"><p><italic>S. cerevisiae</italic></p><p>SK1×Y12</p><p>200X</p></td><td>Ref</td><td>12.1/12.0</td><td>0.9/0.9</td><td>–/–</td><td>47.3/49.4</td><td>99.6/99.6</td><td>0.13/0.03</td><td>0.9/0.9</td><td>0.13/0.03</td></tr><tr><td>Canu + Purge_dups</td><td>12.4/4.8</td><td>0.8/0.0</td><td>25.6/30.5</td><td>38.9/36.2</td><td>98.7/28.1</td><td>39.24/6.25</td><td>0.0/0.0</td><td>9.92/4.50</td></tr><tr><td>FALCON-Unzip</td><td>12.1/11.1</td><td>0.8/0.4</td><td>40.5/42.2</td><td>44.5/45.0</td><td>99.4/95.8</td><td>21.58/0.98</td><td>0.5/0.4</td><td>0.40/0.22</td></tr><tr><td>PECAT</td><td>12.3/11.8</td><td>0.8/0.8</td><td>35.9/36.0</td><td>39.1/39.7</td><td>96.0/93.8</td><td>1.65/0.49</td><td>0.8/0.8</td><td>0.16/0.09</td></tr><tr><td rowspan="4"><p><italic>A. thaliana</italic></p><p>Col-0×Cvi-0</p><p>164X</p></td><td>Ref</td><td>133.3/119.7</td><td>26.2/23.20</td><td>–/–</td><td>Inf/Inf</td><td>99.3/99.2</td><td>0.12/0.01</td><td>12.1/23.2</td><td>0.11/0.01</td></tr><tr><td>Canu + Purge_dups</td><td>129.1/122.6</td><td>6.7/0.1</td><td>28.0/30.4</td><td>24.8/30.7</td><td>98.7/81.7</td><td>37.52/2.65</td><td>0.1/0.1</td><td>2.81/2.45</td></tr><tr><td>FALCON-Unzip*</td><td>140.0/104.9</td><td>8.0/4.3</td><td>40.0/40.0</td><td>30.0/34.9</td><td>98.9/93.6</td><td>15.11/0.98</td><td>3.1/2.4</td><td>0.15/0.19</td></tr><tr><td>PECAT</td><td>130.6/120.4</td><td>14.3/7.8</td><td>34.6/34.7</td><td>25.3/33.2</td><td>98.3/98.2</td><td>2.64/0.21</td><td>12.6/7.8</td><td>0.13/0.13</td></tr><tr><td rowspan="4"><p><italic>D. melanogaster</italic></p><p>ISO1×A4</p><p>200X</p></td><td>Ref</td><td>143.7/140.7</td><td>25.3/25.0</td><td>–/–</td><td>46.5/46.3</td><td>98.7/98.7</td><td>0.06/0.02</td><td>25.3/24.6</td><td>0.06/0.02</td></tr><tr><td>Canu + Purge_dups*</td><td>143.2/129.7</td><td>16.1/0.3</td><td>33.6/34.7</td><td>35.4/35.3</td><td>98.5/87.3</td><td>43.50/3.97</td><td>0.4/0.3</td><td>3.92/3.01</td></tr><tr><td>FALCON-Unzip</td><td>189.7/105.9</td><td>4.0/0.4</td><td>40.5/40.5</td><td>37.1/37.4</td><td>98.8/84.0</td><td>29.31/5.38</td><td>1.0/0.3</td><td>0.34/0.41</td></tr><tr><td>PECAT</td><td>149.6/135.7</td><td>24.5/11.9</td><td>38.5/39.2</td><td>40.8/43.5</td><td>98.7/96.7</td><td>3.00/0.07</td><td>16.1/11.8</td><td>0.05/0.04</td></tr><tr><td rowspan="3"><p><italic>B. taurus</italic></p><p>Angus×Brahman</p><p>135X</p></td><td>Ref</td><td>2580.8/2681.0</td><td>91.1/104.5</td><td>–/–</td><td>43.3/43.8</td><td>93.6/95.6</td><td>0.10/0.04</td><td>21.8/30.5</td><td>0.08/0.03</td></tr><tr><td>FALCON-Unzip*</td><td>2713.4/2453.7</td><td>31.4/2.0</td><td>39.2/38.5</td><td>39.4/39.0</td><td>95.4/86.3</td><td>28.15/1.97</td><td>3.2/1.8</td><td>0.21/0.22</td></tr><tr><td>PECAT</td><td>2744.7/2447.6</td><td>72.4/2.8</td><td>34.6/34.6</td><td>39.9/40.1</td><td>94.8/87.0</td><td>29.46/0.47</td><td>4.5/2.4</td><td>0.10/0.09</td></tr></tbody></table><table-wrap-foot><p>‘Size’ is the total number of base pairs in all contigs generated by assemblers. ‘NG50’ is the length of the shortest contig for which longer and equal length contigs cover at least 50 of genome size. The genome sizes of <italic>S. cerevisiae, A. thaliana, D. melanogaster</italic>, and <italic>B. taurus</italic> that we used for evaluation are 12 M, 130 M, 140 M, and 2.7 G, respectively. ‘BUSCO’ is gene completeness evaluated by BUSCO. ‘Quality (reference-based)’ is the metric ‘q50’ evaluated by Pomoxis. ‘Hamming error’ is the fraction of nondominant parental-specific k-mers in a contig. ‘Quality (k-mer-based)’, ‘Phase block NG50’, and ‘Intra-block switch error’ are evaluated by mercury. All assemblies are in primary/alternate format. The primary and alternate contigs are separately reported in each cell. ‘Ref’ is the reference genome. The sources of the reference genomes are illustrated in Supplementary Table <xref rid="MOESM1" ref-type="media">17</xref>. For <italic>B. taurus</italic>, Canu didn’t finish the assembly in 3 weeks, so it is excluded. Asterisks mark previously published assemblies.</p></table-wrap-foot></table-wrap></p>
      <p id="Par21">For three Nanopore datasets, Canu+Purge_dups and Shasta output the contigs in primary/alternate format, Flye+HapDup outputs the contigs in dual assembly format and PECAT can output both formats. As shown in Table <xref rid="Tab2" ref-type="table">2</xref>, the sizes of both two sets of contigs of all three assemblies are close to their corresponding reference genome, except the <italic>A. thaliana</italic> (Col-0×C24) genomes assembled by Canu+Purge_dups. Compared to other pipelines, PECAT obtains higher NG50 for three genomes. The phase block NG50 reported by PECAT is at least 10 times higher than those reported by other pipelines for <italic>A. thaliana</italic> (Col-0×C24) and <italic>B.taurus</italic> (Bison×Simmental). Especially, PECAT reports the assembly with phase block NG50 of 79.6/86.1 Mb for <italic>B. taurus</italic> (Bison×Simmental), which exceeds the assembly with phase block N50 of 68.5/70.6 Mb reported by the trio-binning method using additional parental reads<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. Meanwhile, for HG002, PECAT reports higher phase block NG50 than that reported by Flye+HapDup, both are at least 25 times higher than that reported by Shasta. PECAT reports smaller Intra-block switch error and Hamming error on <italic>A. thaliana</italic> (Col-0×C24) and <italic>B. taurus</italic> (Bison×Simmental). Most of the contigs reported by PECAT on <italic>A. thaliana</italic> (Col-0×C24) and <italic>B. taurus</italic> (Bison × Simmental) are haplotigs (Fig. <xref rid="Fig3" ref-type="fig">3a</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">15</xref>). For HG002, PECAT and Flye+HapDup report similar Intra-block switch errors, and both are much less than those reported by Shasta. Although PECAT and Flye+HapDup reported smaller Hamming errors than that reported by Shasta, their reported Hamming error rates are high, which may be because some low heterozygosity regions of HG002 are not successfully phased. Moreover, most contigs reported by Flye+HapDup and PECAT on HG002 are not haplotigs (Supplementary Figs. <xref rid="MOESM1" ref-type="media">16</xref>,<xref rid="MOESM1" ref-type="media">17</xref>).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance comparison of assembly on Nanopore and PacBio HiFi datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>Pipeline</th><th>Size (Mb)</th><th>NG50 (Mb)</th><th>Quality (reference-based)</th><th>Quality (k-mer-based)</th><th>BUSCO (%)</th><th>Hamming error (%)</th><th>Phase block NG50 (Mb)</th><th>Intra-block<break/>switch error (%)</th></tr></thead><tbody><tr><td rowspan="6"><p><italic>A. thaliana</italic></p><p>Col-0 × C24</p><p>ONT, 106X</p></td><td>Ref</td><td>133.3/119.2</td><td>26.2/23.8</td><td>–/–</td><td>44.7/44.0</td><td>99.3/99.1</td><td>0.14/0.01</td><td>12.7/23.8</td><td>0.15/0.02</td></tr><tr><td><p>Canu +</p><p>Purge_dups (pri/alt)</p></td><td>125.9/68.3</td><td>8.1/0.0</td><td>22.0/23.5</td><td>29.8/28.7</td><td>96.6/37.4</td><td>37.95/7.02</td><td>0.1/0.0</td><td>8.33/5.71</td></tr><tr><td>Flye + HapDup (dual)</td><td>136.4/136.5</td><td>2.1/2.1</td><td>25.6/25.0</td><td>28.5/28.3</td><td>97.8/97.8</td><td>11.85/13.62</td><td>0.5/0.5</td><td>0.66/0.67</td></tr><tr><td>Shasta (pri/alt)</td><td>126.3/105.0</td><td>0.8/0.5</td><td>22.4/23.8</td><td>28.9/30.6</td><td>94.9/92.2</td><td>11.75/7.96</td><td>0.3/0.3</td><td>7.11/5.39</td></tr><tr><td>PECAT (pri/alt)</td><td>131.2/123.9</td><td>14.3/7.7</td><td>30.2/30.6</td><td>31.4/32.1</td><td>98.5/98.2</td><td>3.18/0.32</td><td>9.1/7.1</td><td>0.35/0.36</td></tr><tr><td>PECAT (dual)</td><td>131.1/125.1</td><td>14.3/14.0</td><td>30.4/30.7</td><td>31.6/32.2</td><td>98.6/98.4</td><td>1.07/0.38</td><td>7.8/7.9</td><td>0.37/0.37</td></tr><tr><td rowspan="5"><p><italic>B. taurus</italic></p><p>Bison × Simmental</p><p>ONT, UL, 200X</p></td><td>Ref</td><td>2651.6/2861.7</td><td>87.8/104.4</td><td>–/–</td><td>38.7/36.1</td><td>93.1/95.7</td><td>0.67/0.48</td><td>87.8/104.4</td><td>0.74/0.61</td></tr><tr><td>Flye + HapDup (dual)</td><td>2713.0/2713.2</td><td>33.4/33.4</td><td>25.0/25.0</td><td>28.5/28.4</td><td>83.4/83.3</td><td>6.52/6.57</td><td>8.2/8.1</td><td>0.44/0.44</td></tr><tr><td>Shasta (pri/alt)</td><td>2815.7/2406.9</td><td>0.3/0.2</td><td>15.1/15.1</td><td>22.9/24.0</td><td>61.3/59.1</td><td>22.05/25.65</td><td>0.1/0.1</td><td>23.26/25.79</td></tr><tr><td>PECAT (pri/alt)</td><td>2968.2/2770.0</td><td>94.3/93.8</td><td>25.6/25.6</td><td>28.8/28.5</td><td>83.6/83.1</td><td>0.39/0.38</td><td>79.6/86.1</td><td>0.37/0.38</td></tr><tr><td>PECAT (dual)</td><td>2970.2/2856.3</td><td>94.3/93.8</td><td>25.5/25.6</td><td>28.8/28.8</td><td>83.3/83.4</td><td>0.39/0.38</td><td>79.5/86.1</td><td>0.37/0.39</td></tr><tr><td rowspan="5"><p>HG002</p><p>ONT, R9, UL 59X</p></td><td>Ref</td><td>2959.3/3061.7</td><td>146.7/154.4</td><td>–/–</td><td>58.6/59.4</td><td>92.8/95.8</td><td>0.15/0.08</td><td>90.4/106.7</td><td>0.02/0.03</td></tr><tr><td>Flye+ HapDup (dual)</td><td>2932.2/2932.4</td><td>49.9/49.9</td><td>33.2/33.2</td><td>40.9/40.8</td><td>94.2/94.1</td><td>7.91/8.24</td><td>20.5/19.6</td><td>0.08/0.09</td></tr><tr><td>Shasta (pri/alt)</td><td>3007.0/2443.9</td><td>24.2/2.9</td><td>28.8/30.1</td><td>34.7/38.5</td><td>92.4/79.6</td><td>18.93/11.42</td><td>0.8/0.5</td><td>8.66/5.36</td></tr><tr><td>PECAT (pri/alt)</td><td>3059.3/2857.7</td><td>92.9/15.0</td><td>30.8/30.8</td><td>41.8/41.6</td><td>94.7/91.0</td><td>15.72/1.48</td><td>22.2/13.0</td><td>0.08/0.11</td></tr><tr><td>PECAT (dual)</td><td>3057.2/2927.2</td><td>92.7/74.5</td><td>30.8/30.8</td><td>41.8/41.8</td><td>94.6/91.6</td><td>9.67/10.98</td><td>30.8/23.6</td><td>0.08/0.11</td></tr><tr><td rowspan="4"><p>HG002</p><p>ONT, R10,</p><p>UL, 116X</p></td><td>Flye+ HapDup (dual)</td><td>2954.7/2952.1</td><td>61.9/59.3</td><td>36.4/36.2</td><td>48.9/48.2</td><td>95.8/95.7</td><td>3.13/3.02</td><td>46.5/39.1</td><td>0.02/0.03</td></tr><tr><td>Shasta (pri/alt)</td><td>3095.4/2729.9</td><td>45.3/33.8</td><td>34.3/34.4</td><td>42.1/48.7</td><td>95.7/92.2</td><td>3.05/0.86</td><td>17.2/15.4</td><td>0.30/0.44</td></tr><tr><td>PECAT (pri/alt)</td><td>3159.7/2895.6</td><td>91.4/59.9</td><td>38.0/38.0</td><td>49.0/50.1</td><td>95.8/92.4</td><td>3.75/0.30</td><td>59.4/58.0</td><td>0.04/0.05</td></tr><tr><td>PECAT (dual)</td><td>3153.4/2917.8</td><td>91.4/80.2</td><td>38.0/38.0</td><td>49.2/50.0</td><td>95.8/92.7</td><td>2.99/1.49</td><td>63.8/59.2</td><td>0.04/0.06</td></tr><tr><td rowspan="3">HG002 HiFi, 36X</td><td>Hifiasm (pri/alt) *</td><td>3112.2/2910.3</td><td>89.9/0.4</td><td>50.0/50.0</td><td>55.3/56.5</td><td>95.6/77.0</td><td>24.38/1.67</td><td>1.1/0.3</td><td>0.11/0.01</td></tr><tr><td>Hifiasm (dual) *</td><td>3015.3/3077.5</td><td>44.8/64.5</td><td>50.0/50.0</td><td>54.9/57.8</td><td>95.5/94.9</td><td>34.80/24.10</td><td>1.0/1.0</td><td>0.16/0.11</td></tr><tr><td>Hifiasm (Hi-C) *</td><td>3075.0/2908.7</td><td>55.1/55.1</td><td>50.0/50.0</td><td>54.9/57.9</td><td>95.7/92.5</td><td>0.45/0.25</td><td>20.6/20.4</td><td>0.09/0.06</td></tr></tbody></table><table-wrap-foot><p>‘Size’ is the total number of base pairs in all contigs generated by assemblers. ‘NG50’ is the length of the shortest contig for which longer and equal length contigs cover at least 50 of genome size. The genome sizes of <italic>A. thaliana</italic>, <italic>B. taurus</italic>, and HG002 that we used for evaluation are 130 M, 2.7 G, and 3 G, respectively. ‘BUSCO’ is gene completeness evaluated by BUSCO. ‘Hamming error’ is the fraction of nondominant parental-specific k-mers in a contig. ‘Quality (reference-based)’ is the metric ‘q50’ evaluated by Pomoxis. ‘Quality (k-mer-based)’, ‘Phase block NG50’, and ‘Intra-block switch error’ are evaluated by mercury. ‘pri/alt’ represents primary/alternate assembly format. ‘dual’ represents dual assembly format. ‘ONT’ indicates the dataset is composed of Nanopore reads. ‘UL’ indicates the reads are ultra-long reads. ‘HiFi’ indicates the dataset is composed of PacBio HiFi reads. ‘Hi-C’ represents that the assembly uses the additional Hi-C reads. The two sets of contigs are separately reported in each cell. ‘Ref’ is the reference genome. The sources of the reference genomes are illustrated in Supplementary Table <xref rid="MOESM1" ref-type="media">17</xref>. For <italic>B. taurus</italic> and HG002, Canu didn’t finish the assembly in 3 weeks, so it is excluded. Asterisks mark previously published assemblies.</p></table-wrap-foot></table-wrap><fig id="Fig3"><label>Fig. 3</label><caption><title>Performance comparison of assembly.</title><p><bold>a</bold> Haplotype-specific k-mer blob plots of the <italic>B. taurus</italic> (Bison × Simmental) reference genome and assemblies by Flye+HapDup, Shasta, and PECAT. pri/alt or dual represents that the assembly is the primary/alternate format or the dual assembly format. Each blob corresponds to a contig. The coordinate of the blob gives the count of the parental specific k-mers in the contig, where k is 21. Blob size is proportional to contig length. <bold>b</bold> Precisions and recalls of small variants (SNP, INDEL) and structural variants (SV) in HG002 assemblies. <bold>c</bold> Genome fraction of the assemblies, which are evaluated by QUAST.</p></caption><graphic xlink:href="41467_2024_47349_Fig3_HTML" id="d33e1971"/></fig></p>
      <p id="Par22">For the metrics ‘Quality’ and BUSCO score, Shasta reports the lowest scores on all three Nanopore datasets, while Flye+HapDup and PECAT report similar scores on <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison×Simmental) and HG002, except that the BUSCO scores of the alternate contigs/the haplotype 2 contigs reported by PECAT are slightly lower than those reported by Flye+HapDup (91.0%/91.6% vs. 94.1%). The main reason for this difference is that PECAT places the contigs of X and Y chromosomes in the primary contigs or the haplotype 1 contigs while Flye+HapDup outputs two copies of contigs of X and Y chromosomes to two sets of assemblies at the same time. We remove the contigs of X and Y chromosomes in the assemblies of Flye+HapDup (dual) and PECAT (dual). The BUSCO scores of the assembly by Flye+HapDup (dual) are reduced from 94.2%/94.1% to 91.2%/91.1%, while the BUSCO scores of the assembly by PECAT (dual) are reduced from 94.6%/91.6% to 91.6%/91.5%, which are similar to those reported by Flye+HapDup (dual).</p>
      <p id="Par23">We also compare the HG002 genome assembled using Nanopore reads by PECAT with those using HiFi reads by Hifiasm<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>. The long Nanopore reads can help the assemblers to obtain longer phased blocks. PECAT reports much longer NG50 and phase block NG50 than those reported by Hifiasm using HiFi reads only, even longer than those reported by Hifiasm using both HiFi reads and Hi-C reads. The Intra-block switch errors reported by PECAT are similar to those reported by Hifiasm. On the other hand, the high-quality HiFi reads allow Hifiasm to report higher base qualities of assemblies with better ‘Quality’ scores. Moreover, Hifiasm reports higher Hamming errors when using HiFi reads only. However, with the help of Hi-C data, Hifiasm reported a much smaller Hamming error and almost all contigs are haplotigs (Supplementary Figs. <xref rid="MOESM1" ref-type="media">16</xref>,<xref rid="MOESM1" ref-type="media">17</xref><bold>)</bold>. We then evaluate the small variants (SNP, INDEL) and the structural variants (SV) in HG002 assemblies against the GIAB benchmark (<bold>Methods</bold>). As shown in Fig. <xref rid="Fig3" ref-type="fig">3b</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>, the precisions and recalls of SNP and SV of genomes assembled by Flye+HapDup and PECAT using Nanopore reads are similar to those of genomes assembled by Hifiasm using HiFi reads. However, the precisions and recalls of INDEL of genomes assembled by Flye+HapDup and PECAT using Nanopore read is much less than those of genomes assembled by Hifiasm using HiFi reads, which is consistent with the previous finding<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>.</p>
      <p id="Par24">In the second round of assembly of PECAT, it reassembles the filtered string graph, which will help correct errors or collapsed regions in the first round of assembly. As shown in Fig. <xref rid="Fig3" ref-type="fig">3c</xref> and Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>, PECAT reports higher ‘Genome fraction’ values than those reported by other pipelines. We then map the HG002 reference genome and HG002 assemblies to GRCh38. As an example (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), the region [130,005,418, 130,116,766] in chromosome 3 includes the gene EVA1CP6 and has a large INDEL with a length of about 43,365 bp between the parental reference genomes. Both PECAT and Hifiasm reconstruct the INDEL in their assemblies, but Flye+HapDup (dual) fails. This large INDEL cannot be preserved in the haplotype-collapsed contigs in the first round of assembly and reads from another haplotype may not be mapped onto the haplotype-collapsed contigs. Therefore, it is difficult for the polish-based assemblies, such as Flye+HapDup, to restore the INDEL in the second round of assembly, which may be the reason that Flye+Hapdup reports lower Genome fraction scores than those reported by PECAT (Fig. <xref rid="Fig3" ref-type="fig">3c</xref> and Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>) on three Nanopore datasets.<fig id="Fig4"><label>Fig. 4</label><caption><title>Screenshot of HG002 reference, assembly and read alignment to GRCh38.</title><p>It shows the range of [130,005,418, 130,116,766] in chromosome 3. Small INDELs in all alignments and mismatches in read alignments are not shown. Paternal reference and maternal reference are HG002 paternal references. The assemblies by Flye, Flye+HapDup, and PECAT are from Nanopore reads. The assembly by Hifiasm is from HiFi reads. The assembly by Flye is haplotype-collapsed contigs. The other assemblies are in the dual assembly format. The two sets of contigs are labeled as haplotype 1 and haplotype 2.</p></caption><graphic xlink:href="41467_2024_47349_Fig4_HTML" id="d33e2036"/></fig></p>
      <p id="Par25">We further compare the computational resources required by each pipeline (Supplementary Table <xref rid="MOESM1" ref-type="media">9</xref>, <xref rid="MOESM1" ref-type="media">10</xref><bold>)</bold>. Canu on <italic>B. taurus</italic> (Angus×Brahman), <italic>B. taurus</italic> (Bison×Simmental), and HG002, FALCON-Unzip on <italic>B. taurus</italic> (Angus×Brahman) are excluded for comparison since the assemblies are not constructed within three weeks. PECAT is at least 8.7 times faster than traditional correct-then-assemble pipelines, such as Canu+purge_dups and FALCON-Unzip. But it’s slower than assemble-then-correct pipelines, such as Shasta and Flye+HapDup. The peaks of memory usage and disk space usage of PECAT are also recorded in Supplementary Table <xref rid="MOESM1" ref-type="media">10</xref>.</p>
    </sec>
    <sec id="Sec8">
      <title>Performance on highly accurate long reads</title>
      <p id="Par26">With the development of sequencing technology, the accuracy of long reads has greatly improved recently<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR45">45</xref></sup>. We evaluate the performance of PECAT using Nanopore R10 sequencing (ultra-long), Nanopore R10 duplex sequencing and PacBio HiFi sequencing reads. The accuracy of 40X longest reads for those datasets is 98.25%, 99.67%, and 99.77% (Supplementary Fig. <xref rid="MOESM1" ref-type="media">18</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>), respectively, which are much higher than the accuracy of the Nanopore R9 (ultra-long) dataset (94.97%). However, there are still less accurate reads in those datasets and PECAT error correction can still improve the qualities of those reads, except for a 0.1–0.2% decrease in the metric “Completeness” (Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>). The Nanopore R10 (ultra-long) dataset with higher accuracy and longer read length improves the assemblies of all pipelines (Table <xref rid="Tab2" ref-type="table">2</xref>). Compared with the assemblies from the Nanopore R9 (ultra-long) dataset (Table <xref rid="Tab2" ref-type="table">2</xref>), the assemblies from the Nanopore R10 (ultra-long) dataset have higher QV when evaluated by pomoxis and merqury. Especially, the assembly of PECAT from the Nanopore R10 (ultra-long) dataset has the highest phase block NG50 with 59.4/58.0 Mb in primary/alternate format and with 63.8/59.2 Mb in dual format, which is twice as much as those of assembly of PECAT from Nanopore R9 (ultra-long) data. Furthermore, the assemblies from the Nanopore R10 (ultra-long) dataset report one magnitude smaller Hamming error and more contigs in this assembly are haplotigs (Supplementary Figs. <xref rid="MOESM1" ref-type="media">19</xref>, <xref rid="MOESM1" ref-type="media">20</xref>). Similar to the Nanopore R9 (ultra-long) dataset, the assembly of PECAT from the Nanopore R10 (ultra-long) dataset outperforms those of Flye+HapDup and Shasta in terms of NG50 and phase block NG50. Meanwhile, the assemblies for the Nanopore R10 duplex and PacBio HiFi datasets (Supplementary Table <xref rid="MOESM1" ref-type="media">12</xref>) have less NG50 and phase block NG50 than those of assembly from the Nanopore R9 (ultra-long) dataset (Table <xref rid="Tab2" ref-type="table">2</xref>), although have higher quality measures. Moreover, less amount of contigs of assemblies of Nanopore R10 duplex and PacBio HiFi reads are haplotigs (Supplementary Figs. <xref rid="MOESM1" ref-type="media">21</xref>–<xref rid="MOESM1" ref-type="media">24</xref>). This result indicated that the length of reads is more important for obtaining contiguous haplotype-specific contigs.</p>
      <p id="Par27">We then evaluate the small variants (SNP, INDEL) and the structural variants (SV) in those assemblies using Nanopore R10 sequencing (ultra-long), Nanopore R10 duplex sequencing and PacBio HiFi sequencing reads against the GIAB benchmark (Supplementary Table <xref rid="MOESM1" ref-type="media">13</xref>–<xref rid="MOESM1" ref-type="media">15</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">25</xref>–<xref rid="MOESM1" ref-type="media">27</xref>). The assemblers report similar metrics. The precisions and recalls of SNP and SV of the assemblies are similar to those of the assemblies using Nanopore R9 (ultra-long) reads (Fig. <xref rid="Fig3" ref-type="fig">3b</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>). However, the precisions and recalls of INDEL of genomes assembled from Nanopore R10 (ultra-long) reads and Nanopore R10 duplex reads are much greater than those of assemblies using R9 (ultra-long) reads, while still less than those of assemblies using HiFi reads.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par28">Although long noisy reads, especially Nanopore reads, have the advantage to generate high contiguity contigs, using them for diploid genome assembly remains a challenge. Due to the high sequencing error rate, directly phasing the raw reads and then assembling the diploid genome can not obtain high-quality assembly<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>. Here, we first develop a haplotype-aware error-correct method to keep most of the heterozygote alleles while correcting sequencing errors. However, even after error corrections, it is not able to accurately call SNPs by just aligning corrected reads as the Hifiasm did for HiFi reads. PECAT then first generates a haplotype-collapsed genome and calls SNPs by aligning the corrected reads to the haplotype-collapsed genome. Nevertheless, the accuracy of this SNP call is still low for low heterozygosity rate regions. Therefore, we use Clair3 to call SNPs again for Nanopore reads. Our experiments show that the SNPs called from raw reads complemented the SNPs called by aligning corrected reads. Combing both SNPs helps achieve the best performance.</p>
    <p id="Par29">Another advantage of our haplotype-aware error-corrected reads is to allow reuse the overlaps built in the first round of assembly and just simplify the overlaps by removing inconsistent ones before reassembling the diploid genome. This strategy is like that used in Hifiasm. Compared to methods that directly separate the collapsed contigs into two haplotypes, such as Flye+HapDup, this strategy can correct errors or collapsed regions in the first round of assembly, and then achieve better assembly.</p>
    <p id="Par30">Furthermore, PECAT does not simply phase the reads into two copies, but uses the read grouping method to separate reads from nearly identical repeats into multiple copies, which can help solve the repeats with more than two copies. Meanwhile, in order to obtain high-quality phased assembly, PECAT needs higher coverage of data. As shown in Supplementary Table <xref rid="MOESM1" ref-type="media">16</xref>, the contiguity and qualities of the assembly of HG002 using 37X Nanopore reads are less than those of assembly using 59X Nanopore reads.</p>
    <p id="Par31">Although the new generation long reads from Nanopore and PacBio have much higher accuracy, PECAT error correction can still improve their quality. PECAT can also efficiently assemble those highly accurate reads. It can leverage the advantages of read length and accuracy to obtain better assemblies. Therefore, PECAT achieve the phase block NG50 with 59.4/58.0 Mb in primary/alternate format and with 63.8/59.2 Mb in dual format only using Nanopore R10 (ultra-long) reads. However, our current error correction method may not be effective enough to distinguish small errors from heterozygote alleles in very low heterozygosity rate regions, even in highly accurate reads (Nanopore duplex and PacBio HiFi reads). Compared with the read-length advantage, PECAT does not fully take advantage of the high accuracy of reads for being compatible with long noisy reads, therefore it achieves mediocre performance on Nanopore duplex and PacBio HiFi reads (Supplementary Table <xref rid="MOESM1" ref-type="media">12</xref> and Supplementary Figs. <xref rid="MOESM1" ref-type="media">21</xref>–<xref rid="MOESM1" ref-type="media">24</xref>). We will resolve this issue in subsequent PECAT releases. Overall, PECAT is an efficient assembly pipeline for diploid genomes.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Diploid datasets for benchmarking</title>
      <p id="Par32">We evaluate the performance of PECAT using seven diploid datasets (Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">17</xref>): <italic>S. cerevisiae</italic> (SK1×Y12), <italic>A. thaliana</italic> (Col-0×Cvi-0), <italic>D. melanogaster</italic> (ISO1×A4), <italic>B. taurus</italic> (Angus×Brahman), <italic>A. thaliana</italic> (Col-0×C24), <italic>B. taurus</italic> (Bison×Simmental) and HG002. The first four datasets are PacBio CLR datasets and the last three are Nanopore datasets (the last two are ultra-long raw reads and the HG002 dataset is generated by Nanopore R9). The heterozygosity rate of those species is 0.85%, 1.04%, 0.84%, 1.12%, 0.83%, 1.48%, and 0.34%, respectively (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>). The accuracies of reads in those datasets are 87.80%, 88.24%, 89.58%, 86.25%, 92.33%, 89.12%, and 94.97%, respectively. (Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref>). In addition, we evaluate the performance of PECA on more accurate datasets, i.e., other three HG002 datasets using Nanopore R10 sequencing (ultra-long), Nanopore R10 duplex sequencing and PacBio HiFi sequencing, separately. Their accuracies are 98.25%, 99.67%, and 99.77% (Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>). For each of the above data, PECAT and NECAT extract the longest 80X raw reads or all reads, if the dataset is less than 80X, for error correction and assembly. Canu corrects the longest 100X raw reads for assembly. Other tools use all raw reads for error correction or assembly (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>).</p>
    </sec>
    <sec id="Sec12">
      <title>Haplotype-aware error correction</title>
      <p id="Par33">The PECAT error correction method is based on the partial-order alignment (POA) graph method<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR47">47</xref></sup>. Instead of assigning the same weight to each read for error correction, we select reads more likely coming from the same haplotype or the same copy of the nearly identical repeat and assign different weights to prevent heterozygotes in reads from being eliminated as sequencing errors. First, we find candidate overlaps between raw reads using minimap2 with parameters “-x ava-pb” for PacBio CLR reads and parameters “-x ava-ont” for Nanopore reads. For each template read to be corrected, we collect a group of supporting reads that have candidate overlaps with the template read. Then, we perform pairwise alignment between the template read and each supporting read using diff<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> or edlib<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> algorithm and build a POA graph based on the alignments of the reads as shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>. Each node in the graph is labeled by a triple value <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(c,r,{b})$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq8.gif"/></alternatives></inline-formula>, corresponding a base pair in the alignment. <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M18"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq9.gif"/></alternatives></inline-formula> is the location at the template read, <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M20"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq10.gif"/></alternatives></inline-formula> means the number of consecutive insertions (if <italic>r</italic> = 0, there is a match, a mismatch, or a deletion), and <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b$$\end{document}</tex-math><mml:math id="M22"><mml:mi>b</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq11.gif"/></alternatives></inline-formula> is the base on the supporting read or a deletion, which is one of <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{\prime} {A}^{{\prime} }{,}^{{\prime} }{C}^{{\prime} }{,}^{{\prime} }{G}^{{\prime} }{,}^{{\prime} }{T}^{{\prime} }{,}^{{\prime} }{-}^{{\prime} }\}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>′</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq12.gif"/></alternatives></inline-formula>. Each edge in the graph means two base pairs of their nodes appearing continuously in the alignment. The support count of each edge is defined as the number of alignments which pass the edge. For the convenience of analysis, we add a trivial alignment between the template read and itself to the graph. According to our observations, for each location <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M26"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq13.gif"/></alternatives></inline-formula>, all paths in the graph must only pass one of the nodes <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{\left(c,0,{b}_{i}\right),{b}_{i}\in \left({\prime} {A}^{{\prime} }{,}^{{\prime} }{C}^{{\prime} }{,}^{{\prime} }{G}^{{\prime} }{,}^{{\prime} }{T}^{{\prime} }{,}^{{\prime} }{-}^{{\prime} }\right)\}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo>′</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>,</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq14.gif"/></alternatives></inline-formula>. If these nodes have more than one in-edge with large support counts, there may be heterozygotes rather than random sequencing errors (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1 b</xref><bold>)</bold>. Therefore, we compute the support count <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq15.gif"/></alternatives></inline-formula> for in-edges of the nodes. We mark an in-edge as the important one if <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}\ge \left\{\begin{array}{cc}{r}_{l}\cdot S &amp; S\le {S}_{l}\\ \frac{{r}_{h}\cdot {S}_{h}-{r}_{l}\cdot {S}_{l}}{{S}_{h}-{S}_{l}}\cdot \left(S-{S}_{l}\right)+{r}_{l}\cdot {S}_{l} &amp; {S}_{l} &lt; S\le {S}_{h}\\ {r}_{h}\cdot S &amp; {S}_{h} &lt; S\end{array}\right.$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>S</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>S</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>S</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>S</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>S</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>S</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq16.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S=\sum {s}_{i}$$\end{document}</tex-math><mml:math id="M34"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq17.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{l}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq18.gif"/></alternatives></inline-formula>, <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{h}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq19.gif"/></alternatives></inline-formula>, <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{l}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq20.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{h}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq21.gif"/></alternatives></inline-formula> are user-set parameters (the default values are 0.5, 0.2, 10, and 200). We mark a location <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M44"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq22.gif"/></alternatives></inline-formula> as the important one if (1) there is no homopolymer at location <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M46"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq23.gif"/></alternatives></inline-formula>, (2) there are two or more important in-edges and a bubble structure which can be detected along the reverse direction of the in-edges, (3) more than half of the reads through the important in-edge pass the corresponding path in the bubble, (4) there is not an INDEL variant between the sequences represented by the paths in the bubble. Then, we calculate a score for each supporting read based on whether the supporting read and the template read pass the same important in-edges at important locations. We increase the score by 1 if a supporting read passes the same important in-edge as template read and decrease it by 1 if the supporting read and the template read pass the different important in-edges (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1 c</xref>). For uniformity, the score is divided by the number of important locations in the supporting read. As shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">1 d</xref>, the histogram of scores shows two or more peaks if the supporting reads come from different haplotypes or different copies of the segmental duplication. We select the reads whose scores fall into the first peak for error correction. If there is only one peak, we select half of the supporting reads with larger scores. We linearly map the scores of selected reads to a range, which is <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[0.4,0.8]$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0.4</mml:mn><mml:mo>,</mml:mo><mml:mn>0.8</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq24.gif"/></alternatives></inline-formula> by default, as the final weights of supporting reads. The weight of each edge is the sum of the weights of selected supporting reads that pass the edge.</p>
      <p id="Par34">Finally, we find the path in the POA graph to generate a consensus for the template read. For each node <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v$$\end{document}</tex-math><mml:math id="M50"><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq25.gif"/></alternatives></inline-formula> labeled by the triple value <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(c,r,b)$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq26.gif"/></alternatives></inline-formula>, if it has <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M54"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq27.gif"/></alternatives></inline-formula> in-edges <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{({u}_{i},v){|i}\le N\}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq28.gif"/></alternatives></inline-formula>, it gets the score <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{v}=\mathop{\max }\limits_{i\le N}\{{S}_{{u}_{i}}+{W}_{\left({u}_{i},v\right)}-{P}_{c}\}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq29.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{\left({u}_{i},v\right)}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq30.gif"/></alternatives></inline-formula> is the weight of the edge <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({u}_{i},v\right)$$\end{document}</tex-math><mml:math id="M62"><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq31.gif"/></alternatives></inline-formula>. In the previous work<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{c}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq32.gif"/></alternatives></inline-formula> is the half of the coverage at the location <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M66"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq33.gif"/></alternatives></inline-formula> in the template read. In our work, <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{c}=\max \left({0.4}^{r},0.3\right)*{W}_{c}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mrow><mml:mn>0.4</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:mfenced><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq34.gif"/></alternatives></inline-formula> instead, where <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${W}_{c}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq35.gif"/></alternatives></inline-formula> is the sum of weight of the supporting reads which pass the location <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M72"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq36.gif"/></alternatives></inline-formula>. The score of the nodes without any in-edge is assigned to 0. We calculate the scores for all nodes by dynamic programming in topological order and record the related edges which get the maximum scores for the nodes. The node with the highest score is selected and backtracking is done to obtain the path for consensus. The consensus sequence for the template read is generated by concatenating the bases of the nodes in the path.</p>
    </sec>
    <sec id="Sec13">
      <title>Read-level SNP caller and read grouping method for identifying inconsistent overlaps</title>
      <sec id="Sec14">
        <title>Calling heterozygous SNPs in haplotype-collapsed contigs and SNP alleles in reads</title>
        <p id="Par35">We map corrected reads to the first round of assembly using minimap2 with parameters “-x map-pb -c -p 0.5 -r 1000” for PacBio CLR reads and parameters “-x map-ont -c -p 0.5 -r 1000” for Nanopore reads. It performs base-level alignment and generates CIGAR strings. We scan the CIGAR strings and call heterozygous SNPs for each contig. We call a base site a heterozygous SNP site if it meets the following two conditions. (1) Its coverage is in the range [10, 1000]. (2) The number of second-most common bases is greater or equal to <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{\begin{array}{cc}{r}_{l}\cdot c &amp; c\le {c}_{l}\\ \frac{{r}_{h}\cdot {c}_{h}-{r}_{l}\cdot {c}_{l}}{{c}_{h}-{c}_{l}}\cdot \left(c-{c}_{l}\right)+{r}_{l}\cdot {c}_{l} &amp; {c}_{l} &lt; c\le {c}_{h}\\ {r}_{h}\cdot c &amp; c\ge {c}_{h}\end{array}\right.$$\end{document}</tex-math><mml:math id="M74"><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>c</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>c</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>c</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>c</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>c</mml:mi><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq37.gif"/></alternatives></inline-formula>, in which <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M76"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq38.gif"/></alternatives></inline-formula> is the site coverage and <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{l}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq39.gif"/></alternatives></inline-formula>, <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{h}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq40.gif"/></alternatives></inline-formula>, <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{l}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq41.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{h}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq42.gif"/></alternatives></inline-formula> are user-set parameters (default values are 0.4, 0.2, 10 and 100). After calling heterozygous SNPs, we call SNP alleles in reads. We define a function <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{r}(s)$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq43.gif"/></alternatives></inline-formula> for each read <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M88"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq44.gif"/></alternatives></inline-formula>. For any SNP site <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M90"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq45.gif"/></alternatives></inline-formula>, <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{r}(s)$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq46.gif"/></alternatives></inline-formula> is defined as 1 or 2 if the read <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M94"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq47.gif"/></alternatives></inline-formula> covers the site <inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M96"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq48.gif"/></alternatives></inline-formula> and the base of the read <inline-formula id="IEq49"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M98"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq49.gif"/></alternatives></inline-formula> is equal to the first-most or second-most common base at site <inline-formula id="IEq50"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M100"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq50.gif"/></alternatives></inline-formula>. Otherwise, <inline-formula id="IEq51"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{r}(s)$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq51.gif"/></alternatives></inline-formula> is defined as 0.</p>
      </sec>
      <sec id="Sec15">
        <title>Verifying and correcting SNP alleles</title>
        <p id="Par36">To verify and correct SNP alleles in a read, we need to find which reads are from the same haplotype within its local region. For each read labeled as the template read <inline-formula id="IEq52"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M104"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq52.gif"/></alternatives></inline-formula>, we assume that it covers a set of SNP sites <inline-formula id="IEq53"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S=\left\{{s}_{1},{s}_{2},\ldots,{s}_{N}\right\}$$\end{document}</tex-math><mml:math id="M106"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq53.gif"/></alternatives></inline-formula>. We collect the query reads that cover 3 common SNP sites with the template read <inline-formula id="IEq54"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M108"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq54.gif"/></alternatives></inline-formula>. The template read and the query reads are put into a group <inline-formula id="IEq55"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M110"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq55.gif"/></alternatives></inline-formula>. We cluster the reads in the group <inline-formula id="IEq56"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M112"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq56.gif"/></alternatives></inline-formula> according to the SNP alleles in them. The reads in the same cluster can be considered from the same haplotype. To facilitate the description of the method, here we make some definitions. We define a centroid <inline-formula id="IEq57"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C=\{\left({v}_{s},{n}_{s}\right){|s}\in S\}$$\end{document}</tex-math><mml:math id="M114"><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∣</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq57.gif"/></alternatives></inline-formula> for the group <inline-formula id="IEq58"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M116"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq58.gif"/></alternatives></inline-formula> at the SNP site set <inline-formula id="IEq59"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M118"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq59.gif"/></alternatives></inline-formula>. <inline-formula id="IEq60"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq60.gif"/></alternatives></inline-formula> is defined to <inline-formula id="IEq61"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}^{+}-{v}_{s}^{-}$$\end{document}</tex-math><mml:math id="M122"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq61.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq62"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}^{+}$$\end{document}</tex-math><mml:math id="M124"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq62.gif"/></alternatives></inline-formula> is the number of the read set <inline-formula id="IEq63"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{r|}{H}_{r}\left(s\right)=1,{r}\in G,s\in S\}$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq63.gif"/></alternatives></inline-formula> and <inline-formula id="IEq64"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}^{-}$$\end{document}</tex-math><mml:math id="M128"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq64.gif"/></alternatives></inline-formula> is the number of the read set <inline-formula id="IEq65"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{r|}{H}_{r}\left(s\right)=2,{r}\in G,s\in S\}$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq65.gif"/></alternatives></inline-formula>. <inline-formula id="IEq66"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{i}$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq66.gif"/></alternatives></inline-formula> is defined to <inline-formula id="IEq67"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{s}^{+}+{v}_{s}^{-}$$\end{document}</tex-math><mml:math id="M134"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq67.gif"/></alternatives></inline-formula>. One read can be regarded as a group only including it. We define the following three formulas to get verified SNP sites of the centroid <inline-formula id="IEq68"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><mml:math id="M136"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq68.gif"/></alternatives></inline-formula>.<disp-formula id="Equa"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}{V}_{ &gt; }\left(C,\,{p}_{0},\,{p}_{1}\right)=\left\{s | {v}_{s}\, &gt; \,0,\left|{v}_{s}\right|\, \ge \,{\max}(p_{0}\cdot {n}_{s},\,{p}_{1})\right\},\, ({v}_{s},\, {n}_{s})\in C\left\}\right.\\ {V}_{ &lt; }\left(C,\, {p}_{0},\, {p}_{1}\right)=\left\{s | {v}_{s}\, &lt; \, 0,\left|{v}_{s}\right|\, \ge \, {\max}(p_{0}\cdot {n}_{s},\, {p}_{1})\right\},({v}_{s},\, {n}_{s})\in C\left\}\right.\\ {V}_{\ne }\left(C,\, {p}_{0},\, {p}_{1}\right)={V}_{ &gt; }\left(C,\, {p}_{0},\, {p}_{1}\right)\bigcup {V}_{ &lt; }\left(C,\, {p}_{0},\, {p}_{1}\right)\end{array}$$\end{document}</tex-math><mml:math id="M138"><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>&gt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>≥</mml:mo><mml:mspace width="0.25em"/><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mfenced open="}"><mml:mrow/></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>&lt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>≥</mml:mo><mml:mspace width="0.25em"/><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mfenced open="}"><mml:mrow/></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>≠</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo mathsize="big"> ⋃</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2024_47349_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par37">The parameters <inline-formula id="IEq69"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{0}$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq69.gif"/></alternatives></inline-formula> and <inline-formula id="IEq70"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{1}$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq70.gif"/></alternatives></inline-formula> are used to control which sites are valid. Next, we define the operations between two centroids.<disp-formula id="Equb"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}A\left({C}_{1},\, {C}_{2},\, {p}_{0},\, {p}_{1}\right)={V}_{\ne }({C}_{1},\, {p}_{0},\, {p}_{1})\bigcap {V}_{\ne }({C}_{2},\, {p}_{0},\, {p}_{1})\\ S\left({C}_{1},\, {C}_{2},\, {p}_{0},\, {p}_{1}\right)={V}_{ &lt; }({C}_{1},\, {p}_{0},\, {p}_{1})\bigcap {V}_{ &lt; }({C}_{2},\, {p}_{0},\, {p}_{1})\cup {V}_{ &gt; }({C}_{1},\, {p}_{0},\, {p}_{1})\bigcap {V}_{ &gt; }({C}_{2},\,{p}_{0},\,{p}_{1})\\ D\left({C}_{1},\,{C}_{2},\,{p}_{0},\,{p}_{1}\right)={V}_{ &lt; }\left({C}_{1},\,{p}_{0},\,{p}_{1}\right)\bigcap {V}_{ &gt; }\left({C}_{2},\,{p}_{0},\,{p}_{1}\right)\cup {V}_{ &gt; }\left({C}_{1},\,{p}_{0},\,{p}_{1}\right)\bigcap {V}_{ &lt; }\left({C}_{2},\,{p}_{0},\,{p}_{1}\right)\end{array}$$\end{document}</tex-math><mml:math id="M144"><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>≠</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo mathsize="big">⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>≠</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo mathsize="big">⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo mathsize="big">⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo mathsize="big"> ⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo mathsize="big"> ⋂</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2024_47349_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par38"><inline-formula id="IEq71"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A\left({C}_{1},{C}_{2},{p}_{0},{p}_{1}\right)$$\end{document}</tex-math><mml:math id="M146"><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq71.gif"/></alternatives></inline-formula> is the set of common verified SNP sites of the centroids <inline-formula id="IEq72"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{1}$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq72.gif"/></alternatives></inline-formula> and <inline-formula id="IEq73"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{2}$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq73.gif"/></alternatives></inline-formula>. <inline-formula id="IEq74"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S\left({C}_{1},{C}_{2},{p}_{0},{p}_{1}\right)$$\end{document}</tex-math><mml:math id="M152"><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left({C}_{1},{C}_{2},{p}_{0},{p}_{1}\right)$$\end{document}</tex-math><mml:math id="M154"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq75.gif"/></alternatives></inline-formula> are used to describe the similarity and the distance of the centroids <inline-formula id="IEq76"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{1}$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{2}$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq77.gif"/></alternatives></inline-formula>. A read <inline-formula id="IEq78"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M160"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq78.gif"/></alternatives></inline-formula> can also be used as the parameter, which means the centroid of <inline-formula id="IEq79"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{r\}$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq79.gif"/></alternatives></inline-formula>.</p>
        <p id="Par39">For each template read <inline-formula id="IEq80"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M164"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq80.gif"/></alternatives></inline-formula> and related group <inline-formula id="IEq81"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M166"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq81.gif"/></alternatives></inline-formula>, we use a divide-then-combine strategy to cluster reads (Supplementary Fig. <xref rid="MOESM1" ref-type="media">28</xref>). In the dividing step, we use a modified bisecting k-means algorithm<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> to divide the group <inline-formula id="IEq82"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M168"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq82.gif"/></alternatives></inline-formula> into small ones with following steps</p>
        <p id="Par40">1. The centroids<inline-formula id="IEq83"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\,{C}_{1}$$\end{document}</tex-math><mml:math id="M170"><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq83.gif"/></alternatives></inline-formula> and <inline-formula id="IEq84"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{2}$$\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq84.gif"/></alternatives></inline-formula> of the sets <inline-formula id="IEq85"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{r}_{1}\}$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq85.gif"/></alternatives></inline-formula> and <inline-formula id="IEq86"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{{r}_{2}\right\}$$\end{document}</tex-math><mml:math id="M176"><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq86.gif"/></alternatives></inline-formula> are initially selected, where reads <inline-formula id="IEq87"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{1}$$\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq87.gif"/></alternatives></inline-formula> and <inline-formula id="IEq88"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{2}$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq88.gif"/></alternatives></inline-formula> are a read pair in the group <inline-formula id="IEq89"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M182"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq89.gif"/></alternatives></inline-formula> with the largest distance (<inline-formula id="IEq90"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{1},{r}_{2}={{{\arg }}}_{{r}_{1},{r}_{2}\in G}\max {|D}({r}_{1},{r}_{2},0,0)|$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>arg</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mi>max</mml:mi><mml:mo>∣</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq90.gif"/></alternatives></inline-formula>).</p>
        <p id="Par41">2. We divide the group <inline-formula id="IEq91"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M186"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq91.gif"/></alternatives></inline-formula> into three subgroups, two subgroups corresponding to the centroids and a separate subgroup containing the reads far away from the centroids. For each read <inline-formula id="IEq92"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M188"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq92.gif"/></alternatives></inline-formula>, if it is far away from the centroids, it meets the conditions: <inline-formula id="IEq93"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{\left|A\left(r,{C}_{i},0,0\right)\right|}{\left|{V}_{\ne }(r,0,0)\right|} &lt; {p}_{2}$$\end{document}</tex-math><mml:math id="M190"><mml:mfrac><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>≠</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq93.gif"/></alternatives></inline-formula>
<inline-formula id="IEq94"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${or}\frac{|D(r,{C}_{i},0,0)|}{|A(r,{C}_{i},0,0)|} &gt; {p}_{3},{i}\in \{{1,2}\}$$\end{document}</tex-math><mml:math id="M192"><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mfrac><mml:mrow><mml:mo>∣</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq94.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq95"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{2}$$\end{document}</tex-math><mml:math id="M194"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq95.gif"/></alternatives></inline-formula> and <inline-formula id="IEq96"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{3}$$\end{document}</tex-math><mml:math id="M196"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq96.gif"/></alternatives></inline-formula> are user-set parameters (default values are 0.3 and 0.5), it is assigned to a separate subgroup. Otherwise, it is assigned the nearest subgroup <inline-formula id="IEq97"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i={{{\arg }}}_{{{{{{\rm{i}}}}}}\in \{1,2\}}\min \frac{\left|D\left(r,{C}_{i},0,0\right)\right|}{\left|A\left(r,{C}_{i},0,0\right)\right|}$$\end{document}</tex-math><mml:math id="M198"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>arg</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mi>min</mml:mi><mml:mfrac><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq97.gif"/></alternatives></inline-formula>. The purpose of the separate subgroup is to prevent the centroids from changing dramatically in each iteration.</p>
        <p id="Par42">3. We calculate the centroids for the first two subgroups and repeat step 2 until the three subgroups don’t change.</p>
        <p id="Par43">After the group is divided into three subgroups, we repeat the above steps to continue dividing the subgroups. If the subgroup <inline-formula id="IEq98"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G$$\end{document}</tex-math><mml:math id="M200"><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq98.gif"/></alternatives></inline-formula> and its centroid <inline-formula id="IEq99"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><mml:math id="M202"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq99.gif"/></alternatives></inline-formula> meet the following conditions: <inline-formula id="IEq100"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|G\right|\le 3$$\end{document}</tex-math><mml:math id="M204"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq100.gif"/></alternatives></inline-formula> or <inline-formula id="IEq101"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{\sum }_{r\in G}\left|D\left(r,C,0,0\right)\right|}{{\sum }_{r\in G}\left|A\left(r,C,0,0\right)\right|}\le {p}_{4}$$\end{document}</tex-math><mml:math id="M206"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq101.gif"/></alternatives></inline-formula> and <inline-formula id="IEq102"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sum }_{r\in G}\left|D\left(r,C,0,0\right)\right|\le {p}_{5}$$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq102.gif"/></alternatives></inline-formula>, it is no longer divided into small subgroups. <inline-formula id="IEq103"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{4}$$\end{document}</tex-math><mml:math id="M210"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq103.gif"/></alternatives></inline-formula> and <inline-formula id="IEq104"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{5}$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq104.gif"/></alternatives></inline-formula> are user-set parameters (the default values are 0.02 and 4).</p>
        <p id="Par44">After dividing the groups, we get a set of subgroups <inline-formula id="IEq105"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${SG}$$\end{document}</tex-math><mml:math id="M214"><mml:mi>S</mml:mi><mml:mi>G</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq105.gif"/></alternatives></inline-formula>. we combine a pair of subgroups into a big one if the centroids are close to each other. First, we create an empty list <inline-formula id="IEq106"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M216"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq106.gif"/></alternatives></inline-formula> and add the subgroup that contains the template read to the list as the first element <inline-formula id="IEq107"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq107.gif"/></alternatives></inline-formula>. Then, we combine other subgroup <inline-formula id="IEq108"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}</tex-math><mml:math id="M220"><mml:mi>g</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq108.gif"/></alternatives></inline-formula> to <inline-formula id="IEq109"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq109.gif"/></alternatives></inline-formula>, if it meets the conditions: <inline-formula id="IEq110"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left(g,{L}_{1},{p}_{6},{p}_{7}\right) &lt; \min ({p}_{8},{A}\left(g,{L}_{1},{p}_{6},{p}_{7}\right)\cdot {p}_{9})$$\end{document}</tex-math><mml:math id="M224"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq110.gif"/></alternatives></inline-formula> and <inline-formula id="IEq111"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left(g,{L}_{1},{p}_{6},{p}_{7}/2\right) &lt; A\left(g,{L}_{1},{p}_{6},{p}_{7}/2\right)\cdot {p}_{9}$$\end{document}</tex-math><mml:math id="M226"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq111.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq112"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{6}$$\end{document}</tex-math><mml:math id="M228"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq112.gif"/></alternatives></inline-formula>, <inline-formula id="IEq113"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{7}$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq113.gif"/></alternatives></inline-formula>, <inline-formula id="IEq114"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{8}$$\end{document}</tex-math><mml:math id="M232"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq114.gif"/></alternatives></inline-formula> and <inline-formula id="IEq115"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{9}$$\end{document}</tex-math><mml:math id="M234"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq115.gif"/></alternatives></inline-formula> are user-set parameters (the default values are 0.66, 6, 4 and 0.2). The remaining subgroups are put into another list <inline-formula id="IEq116"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}^{{\prime} }$$\end{document}</tex-math><mml:math id="M236"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq116.gif"/></alternatives></inline-formula> and sort the subgroups in ascending order of distance with <inline-formula id="IEq117"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M238"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq117.gif"/></alternatives></inline-formula> (<inline-formula id="IEq118"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|D({L}_{1},{L}_{i}^{{\prime} },{p}_{6},{p}_{7})\right|$$\end{document}</tex-math><mml:math id="M240"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq118.gif"/></alternatives></inline-formula>). For the subgroup <inline-formula id="IEq119"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M242"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq119.gif"/></alternatives></inline-formula> in the list <inline-formula id="IEq120"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}^{{\prime} }$$\end{document}</tex-math><mml:math id="M244"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq120.gif"/></alternatives></inline-formula>, we combine it to the subgroup <inline-formula id="IEq121"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M246"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq121.gif"/></alternatives></inline-formula> in list <inline-formula id="IEq122"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M248"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq122.gif"/></alternatives></inline-formula>, if it meets the following conditions: (1) <inline-formula id="IEq123"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j={{\arg }}\max \left|S\left(i,j,{p}_{6},0\right)\right|,{j}\in L$$\end{document}</tex-math><mml:math id="M250"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:mi>max</mml:mi><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq123.gif"/></alternatives></inline-formula>; (2) <inline-formula id="IEq124"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left(i,j,{p}_{6},{p}_{7}\right) &lt; \max ({p}_{8},{A}\left(i,j,{p}_{6},{p}_{7}\right)\cdot {p}_{9})$$\end{document}</tex-math><mml:math id="M252"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq124.gif"/></alternatives></inline-formula>; (3) <inline-formula id="IEq125"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left(i,j,{p}_{6},0\right) &lt; A\left(i,j,{p}_{6},0\right)\cdot {p}_{9}$$\end{document}</tex-math><mml:math id="M254"><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq125.gif"/></alternatives></inline-formula>. Otherwise, the subgroup <inline-formula id="IEq126"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M256"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq126.gif"/></alternatives></inline-formula> is added to the end of the list <inline-formula id="IEq127"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M258"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq127.gif"/></alternatives></inline-formula>.</p>
        <p id="Par45">After combining the subgroups, we think the reads in the same subgroup in the list <inline-formula id="IEq128"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M260"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq128.gif"/></alternatives></inline-formula> are from the same haplotype or the same copy of the repeat. The SNP alleles in the read can be verified by the centroid of its subgroup, which helps to find inconsistent overlaps more accurately. In addition, since the group <inline-formula id="IEq129"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq129.gif"/></alternatives></inline-formula> contains the template read <inline-formula id="IEq130"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M264"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq130.gif"/></alternatives></inline-formula>, we use the centroid of the group <inline-formula id="IEq131"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M266"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq131.gif"/></alternatives></inline-formula> to correct SNP alleles in the template read <inline-formula id="IEq132"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M268"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq132.gif"/></alternatives></inline-formula>. Here, the read is corrected when it is treated as a template read. After all reads are corrected, we run the verifying and correcting SNP alleles step again to obtain more robust results. We run the step twice by default.</p>
      </sec>
      <sec id="Sec16">
        <title>Finding inconsistent overlaps</title>
        <p id="Par46">In the last round of verifying and correcting SNP alleles, we identify inconsistent overlaps. After combining steps, for each template read <inline-formula id="IEq133"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M270"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq133.gif"/></alternatives></inline-formula>, we obtain a subgroup list <inline-formula id="IEq134"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M272"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq134.gif"/></alternatives></inline-formula> and the first subgroup <inline-formula id="IEq135"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq135.gif"/></alternatives></inline-formula> of <inline-formula id="IEq136"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L$$\end{document}</tex-math><mml:math id="M276"><mml:mi>L</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq136.gif"/></alternatives></inline-formula> contains the template read <inline-formula id="IEq137"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M278"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq137.gif"/></alternatives></inline-formula>. We consider a query read <inline-formula id="IEq138"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M280"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq138.gif"/></alternatives></inline-formula> and the template read <inline-formula id="IEq139"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M282"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq139.gif"/></alternatives></inline-formula> to be inconsistent if the query read <inline-formula id="IEq140"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M284"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq140.gif"/></alternatives></inline-formula> and its subgroup <inline-formula id="IEq141"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{r}$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq141.gif"/></alternatives></inline-formula> (<inline-formula id="IEq142"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r\in {L}_{r}$$\end{document}</tex-math><mml:math id="M288"><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq142.gif"/></alternatives></inline-formula>) meet the conditions:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\rm{|}}}}}}D\left({L}_{r},{L}_{1},{p}_{6},{p}_{7}\right){{{{{\rm{|}}}}}}\ge \max ({p}_{8},{{{{{\rm{|}}}}}}A\left({L}_{r},{L}_{1},{p}_{6},{p}_{7}\right){{{{{\rm{|}}}}}}\cdot {p}_{9});$$\end{document}</tex-math><mml:math id="M290"><mml:mi mathvariant="normal">∣</mml:mi><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">∣</mml:mi><mml:mo>≥</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∣</mml:mi><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">∣</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo></mml:math><graphic xlink:href="41467_2024_47349_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|D\left(r,{L}_{1},0,0\right)\bigcap A\left({L}_{r},{L}_{1},{p}_{6},{p}_{7}\right)\right| \ge \max ({p}_{8},{{{{{\rm{|}}}}}}A\left(r,{L}_{1},0,0\right)\\ \bigcap A\left({L}_{r},{L}_{1},{p}_{6},{p}_{7}\right){{{{{\rm{|}}}}}}\cdot {p}_{9}).$$\end{document}</tex-math><mml:math id="M292"><mml:mfenced close="∣" open="∣"><mml:mrow><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo mathsize="big">⋂</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>≥</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∣</mml:mi><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo mathsize="big">⋂</mml:mo><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">∣</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2024_47349_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par47">The parameters <inline-formula id="IEq143"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{6}$$\end{document}</tex-math><mml:math id="M294"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq143.gif"/></alternatives></inline-formula>, <inline-formula id="IEq144"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{7}$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq144.gif"/></alternatives></inline-formula>, <inline-formula id="IEq145"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{8}$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq145.gif"/></alternatives></inline-formula> and <inline-formula id="IEq146"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{9}$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq146.gif"/></alternatives></inline-formula> are mentioned above. We record the location and direction of the reads in the haplotype-collapsed contigs. The overlaps between the inconsistent read pairs are identified as inconsistent overlaps if the directions and distances of the reads in the overlaps do not conflict with those in the haplotype-collapsed contigs (The difference between two distances should be less than 1000 by default.). The distance of the reads is defined as the distance of the 3’ ends of the reads. We record the inconsistent overlap information and SNP alleles in reads for subsequent steps.</p>
      </sec>
      <sec id="Sec17">
        <title>Combining Nanopore raw reads to identify inconsistent overlaps</title>
        <p id="Par48">For Nanopore datasets, we combine the corrected reads and raw reads to identify inconsistent overlaps. We first identify inconsistent overlaps using corrected reads with the strict threshold that the pair of reads should contain 8 different SNP alleles. Then, we use raw reads to identify inconsistent overlaps with the loose threshold that the pair of reads should contain 6 different SNP alleles. Using raw reads to identify inconsistent overlaps is similar to that using corrected reads. For Nanopore reads, we use Clair3<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> to call heterozygous SNPs for each contig. Since PECAT doesn’t change the names of the reads during error correction, inconsistent overlaps between raw reads can be regarded as inconsistent overlaps between corrected reads. Similar to using corrected reads, we also check whether the directions and distances of the reads in the overlaps conflict with those in the haplotype-collapsed contigs. We record the location of corrected reads in raw reads during error correction. Therefore, we can calculate the distance of corrected reads in the haplotype-collapsed contigs by linear mapping. The distance threshold is set to <inline-formula id="IEq147"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\max (2500,0.05*{D}_{c})$$\end{document}</tex-math><mml:math id="M302"><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2500</mml:mn><mml:mo>,</mml:mo><mml:mn>0.05</mml:mn><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq147.gif"/></alternatives></inline-formula> by default, where <inline-formula id="IEq148"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${D}_{{{{{{\rm{c}}}}}}}$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq148.gif"/></alternatives></inline-formula> is distance of corrected reads in the haplotype-collapsed contigs.</p>
      </sec>
    </sec>
    <sec id="Sec18">
      <title>Fast string-graph-based assembler</title>
      <p id="Par49">According to the characteristics of k-mer-based alignment and string graphs, we propose a fast string-graph-based assembler to balance the quality and speed of assembling. First, we use minimap2 with parameters “-X -g3000 -w30 -k19 -m100 -r500” to find candidate overlaps between corrected reads. Minimap2<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> with those parameters invokes the k-mer-based alignment. To reduce overhangs of overlaps, we extend the alignment to the ends of the reads with the diff<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> algorithm and filter out overlaps still with long overhangs. Next, we remove the overlaps whose reads are contained in other reads or with low coverage. A directed string graph is constructed using the remaining overlaps. Myers’ algorithm<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> is used to mark transitive edges as inactive ones. We implement local alignment using the edlib<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> algorithm to calculate the identity of each active edge, which is defined as the identity of its related overlap. Only a few edges need to calculate identities for most of the edges are marked as inactive ones. The edges whose identities are less than the threshold are marked as low quality and removed. The threshold is determined by the formula <inline-formula id="IEq149"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(({m}_{1}-6*1.253*{{MAD}}_{1})+2*({m}_{2}-6*1.4826*{{MAD}}_{2}))/3$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>6</mml:mn><mml:mo>*</mml:mo><mml:mn>1.253</mml:mn><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>*</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>6</mml:mn><mml:mo>*</mml:mo><mml:mn>1.4826</mml:mn><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq149.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq150"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}_{1}$$\end{document}</tex-math><mml:math id="M308"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq150.gif"/></alternatives></inline-formula> and <inline-formula id="IEq151"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}_{2}$$\end{document}</tex-math><mml:math id="M310"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq151.gif"/></alternatives></inline-formula> are the mean and the median of identity of all active edges in the string graph and <inline-formula id="IEq152"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{MAD}}_{1}$$\end{document}</tex-math><mml:math id="M312"><mml:msub><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq152.gif"/></alternatives></inline-formula> and <inline-formula id="IEq153"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{MAD}}_{2}$$\end{document}</tex-math><mml:math id="M314"><mml:msub><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq153.gif"/></alternatives></inline-formula> are the mean absolute deviation and the median absolute deviation of them. This step also breaks some paths connected by low-quality edges in the graphs. To repair those paths, we check dead-end nodes whose outdegree or indegree are equal to 0. We calculate the identities of their transitive edges and reactivate the edge with the longest alignment and the identity greater than the threshold. Considering that some breaks in paths are caused by reads being contained by other reads from the different haplotype or the different copy of the repeat, we extend the dead-end nodes with contained reads to repair the breaks using the similar method. In this way, an appropriate string graph is constructed. After performing other simplifying processes, such as removing the ambiguous edges (tips, bubbles, and spurious links) in the graph, we identify linear paths from the graph and generate contigs.</p>
    </sec>
    <sec id="Sec19">
      <title>Improvement of best overlap graph algorithm</title>
      <p id="Par50">Best overlap graph algorithm<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> only retains the best out-edge and the best in-edge of each node according to the overlap length. After removing transitive edges using Myers’ algorithm<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, PECAT performs the best overlap graph algorithm to further simplify the string graph. However, the original algorithm is not suitable for diploid assembly. The SNP alleles in reads are more important than the overlap length to measure which edge is the best one. Although most inconsistent overlaps are removed, there remain some undetected inconsistent overlaps and the corresponding reads contain different SNP alleles. We improve the algorithm and use the following steps to determine the best edges. First, for the in-edges or out-edges of each node, we sort the edges in descending order of the edge score <inline-formula id="IEq154"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}=({{n}_{i}^{+}\cdot w-n}_{i}^{-},{l}_{i})$$\end{document}</tex-math><mml:math id="M316"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq154.gif"/></alternatives></inline-formula>. <inline-formula id="IEq155"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{i}^{+}$$\end{document}</tex-math><mml:math id="M318"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq155.gif"/></alternatives></inline-formula> and <inline-formula id="IEq156"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{i}^{-}$$\end{document}</tex-math><mml:math id="M320"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq156.gif"/></alternatives></inline-formula> are the numbers of two related reads containing the same or different SNP alleles, which are obtained in finding inconsistent overlaps step. <inline-formula id="IEq157"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w$$\end{document}</tex-math><mml:math id="M322"><mml:mi>w</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq157.gif"/></alternatives></inline-formula> is a user-defined parameter. Its default value is set to 0.5. <inline-formula id="IEq158"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${l}_{i}$$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq158.gif"/></alternatives></inline-formula> is the overlap length. The first edge <inline-formula id="IEq159"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{0}$$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq159.gif"/></alternatives></inline-formula> is marked as a candidate best edge. The other edges meeting the following conditions also are marked as the candidate best edges: (1) Its related read is inconsistent with the reads related to the candidate best edges. (2) Its score is not too much less than the first edge <inline-formula id="IEq160"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{0}$$\end{document}</tex-math><mml:math id="M328"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq160.gif"/></alternatives></inline-formula>, which means <inline-formula id="IEq161"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{0}\left[0\right]-{s}_{i}\left[0\right]\, &lt; \,\left\{\begin{array}{c}\max \left(C,\,{s}_{i}\left[0\right]\cdot {R}_{1}\right),\,{s}_{i}\left[0\right]\, \ge \,0\\ \max \left(C,-{s}_{i}\left[0\right]\cdot {R}_{2}\right),\,{s}_{i}\left[0\right] \, &lt; \, 0\end{array}\right.$$\end{document}</tex-math><mml:math id="M330"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>&lt;</mml:mo><mml:mspace width="0.25em"/><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>max</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>≥</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>max</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>&lt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq161.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq162"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><mml:math id="M332"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq162.gif"/></alternatives></inline-formula>, <inline-formula id="IEq163"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{1}$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq163.gif"/></alternatives></inline-formula> and <inline-formula id="IEq164"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{2}$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq164.gif"/></alternatives></inline-formula> are user-defined parameters (the default values are 4, 2, and 0.66). Next, if the edge is marked as a candidate best edge twice (in-edge and out-edge), it is selected as the best edge. Then, if the node has no best in-edge or best out-edge, its first in-edge or first out-edge is selected as the best one. Finally, the edges selected as the best edges are retained and the other edges are removed from the string graph.</p>
    </sec>
    <sec id="Sec20">
      <title>Generating two sets of contigs</title>
      <p id="Par51">After simplifying the string graph, PECAT identifies three structures from the string graph, as shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">29a</xref>. First, we use FALCON-Unzip’s heuristic algorithm<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> to identify bubble structures. Generally, the paths in the bubble structure are from different haplotypes. Then, we also identify alternate branches, which meet the following conditions: (1) There are only two branches. (2) The shorter branch is linear and does not contain other branches. (3) More than 30% of reads in the shorter branch are inconsistent with the reads in the other branch. We think the two branches that meet the conditions are from different haplotypes. We identify the paths in the string graph and do not break the paths if they encounter bubble structures or alternate branches. This trick can increase the continuity of primary contigs. The other paths in bubble structures or the alternate branches output as alternate contigs. We also check each pair of arbitrary independent contigs. If more than 30% of reads in the shorter contig are inconsistent with the reads in another contig, the shorter contig is labeled as an alternate contig. Another contig not labeled as an alternate contig is outputted as a primary contig.</p>
      <p id="Par52">To generate a dual assembly, PECAT connects the paths in two adjacent bubble structures. In the step of inconsistent overlap identification, we have called SNP alleles in each read. The information is used to determine the pair of paths in adjacent bubble structures that should be connected. As shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">29b</xref>, we build two read groups <inline-formula id="IEq165"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{1}$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq165.gif"/></alternatives></inline-formula> and <inline-formula id="IEq166"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{2}$$\end{document}</tex-math><mml:math id="M340"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq166.gif"/></alternatives></inline-formula> for in-edges <inline-formula id="IEq167"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{1}$$\end{document}</tex-math><mml:math id="M342"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq167.gif"/></alternatives></inline-formula> and <inline-formula id="IEq168"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{2}$$\end{document}</tex-math><mml:math id="M344"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq168.gif"/></alternatives></inline-formula> respectively. If the reads only overlap with the reads in in-edges <inline-formula id="IEq169"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{1}$$\end{document}</tex-math><mml:math id="M346"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq169.gif"/></alternatives></inline-formula> or <inline-formula id="IEq170"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{2}$$\end{document}</tex-math><mml:math id="M348"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq170.gif"/></alternatives></inline-formula>, they are assigned to <inline-formula id="IEq171"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{1}$$\end{document}</tex-math><mml:math id="M350"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq171.gif"/></alternatives></inline-formula> or <inline-formula id="IEq172"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{2}$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq172.gif"/></alternatives></inline-formula>, respectively. If the reads overlap with the reads in in-edges <inline-formula id="IEq173"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{1}$$\end{document}</tex-math><mml:math id="M354"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq173.gif"/></alternatives></inline-formula> and <inline-formula id="IEq174"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{n}_{2}$$\end{document}</tex-math><mml:math id="M356"><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq174.gif"/></alternatives></inline-formula> at the same time, the reads are assigned to the group whose centroid the reads are closer to. The concepts of centroid and distance are defined in the previous section on verifying and correcting SNP alleles. In the same way, we get read groups <inline-formula id="IEq175"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${O}_{1}$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq175.gif"/></alternatives></inline-formula> or <inline-formula id="IEq176"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${O}_{2}$$\end{document}</tex-math><mml:math id="M360"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq176.gif"/></alternatives></inline-formula> for out-edges <inline-formula id="IEq177"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{out}}_{1}$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq177.gif"/></alternatives></inline-formula> or <inline-formula id="IEq178"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{out}}_{2}$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq178.gif"/></alternatives></inline-formula>. If the centroid of <inline-formula id="IEq179"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{1}$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq179.gif"/></alternatives></inline-formula> or <inline-formula id="IEq180"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{2}$$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq180.gif"/></alternatives></inline-formula> does not have a common heterozygous site with the centroid of <inline-formula id="IEq181"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${O}_{1}$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq181.gif"/></alternatives></inline-formula> or <inline-formula id="IEq182"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${O}_{2}$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq182.gif"/></alternatives></inline-formula>, we randomly connect the paths of bubble structures. Otherwise, we choose the paths to minimize the distance between their corresponding read group centroids.</p>
    </sec>
    <sec id="Sec21">
      <title>Polishing two sets of contigs</title>
      <p id="Par53">After generating contigs in primary/alternate format or dual assembly format, we use corrected reads or raw reads to polish them. We map the reads to the contigs using minimap2. In previous steps, we record which read pairs are inconsistent and which reads construct the contigs. If the read is inconsistent with the reads used for constructing the contig, the related alignments are removed. This trick helps to reduce haplotype switch errors. After removing other low-quality alignments, we run racon<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> with default parameters to polish the contigs.</p>
      <p id="Par54">For the assemblies from the Nanopore sequences, we use Medaka (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/medaka">https://github.com/nanoporetech/medaka</ext-link>) to further improve the assembly quality. Its steps are similar to those polishing with racon. The key step is to filter the inconsistent alignments between the reads and the contigs according to the information of inconsistent overlap.</p>
    </sec>
    <sec id="Sec22">
      <title>Evaluation</title>
      <p id="Par55">To evaluate the effectiveness of correction methods fairly, we extract the 40X longest reads from corrected reads and then evaluate them. We map the reads to the reference genome using minimap2 with parameters “-c --eqx”. It generates CIGAR strings. We scan the CIGAR strings to calculate the accuracy of each corrected data. To evaluate the accuracy of the sequences in the difficult-to-map regions and low-complexity regions in the HG002 reference genome, we map the HG002 reference genome to GRCh38. The regions are located in the HG002 reference genome according to GIAB v2.0 genome stratification BED files and the alignment between the HG002 reference genome and GRCh38. Then, we calculate the accuracy of the sequences in these regions separately. To evaluate the haplotype-specific k-mers completeness, we calculate the percentage of parent-specific k-mers in 40X longest reads. Considering that there are 40X datasets, we only count k-mers with equal to or more than 4 occurrences. To evaluate the haplotype-specific k-mers consistency, we calculate the metric as <inline-formula id="IEq183"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum \max ({k}_{p},{k}_{m})/\sum ({k}_{p}+{k}_{m})$$\end{document}</tex-math><mml:math id="M374"><mml:mo>∑</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq183.gif"/></alternatives></inline-formula>, in which <inline-formula id="IEq184"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{p}$$\end{document}</tex-math><mml:math id="M376"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq184.gif"/></alternatives></inline-formula> and <inline-formula id="IEq185"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{m}$$\end{document}</tex-math><mml:math id="M378"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq185.gif"/></alternatives></inline-formula> are the number of paternal and maternal haplotype-specific k-mers in each read.</p>
      <p id="Par56">To evaluate the performance of selecting supporting reads and the performance of finding inconsistent overlaps, we use Illumina reads of parents to classify long reads with a trio-binning algorithm<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. We adjust the threshold to reduce false positives. The read is classified as the paternal read if it meets the condition: <inline-formula id="IEq186"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{k}_{p}}{{K}_{p}} &gt; \frac{{k}_{m}+\max (10,{k}_{m}\cdot 0.1)}{{K}_{m}}$$\end{document}</tex-math><mml:math id="M380"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mn>0.1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq186.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq187"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{p}$$\end{document}</tex-math><mml:math id="M382"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq187.gif"/></alternatives></inline-formula> and <inline-formula id="IEq188"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}_{m}$$\end{document}</tex-math><mml:math id="M384"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq188.gif"/></alternatives></inline-formula> are the numbers of paternal and maternal haplotype-specific k-mers in the read, and <inline-formula id="IEq189"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{p}$$\end{document}</tex-math><mml:math id="M386"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq189.gif"/></alternatives></inline-formula> and <inline-formula id="IEq190"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{m}$$\end{document}</tex-math><mml:math id="M388"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq190.gif"/></alternatives></inline-formula> are the numbers of all paternal and maternal haplotype-specific k-mers. The read is classified as a maternal read if it meets the condition: <inline-formula id="IEq191"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{k}_{m}}{{K}_{m}} &gt; \frac{{k}_{p}+\max (10,{k}_{p}\cdot 0.1)}{{K}_{p}}$$\end{document}</tex-math><mml:math id="M390"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mn>0.1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2024_47349_Article_IEq191.gif"/></alternatives></inline-formula>. Otherwise, it is classified to the untagged reads. When one read of the pair of reads is a maternal read and the other read is a paternal read or vice versa, we think the pair of reads is inconsistent.</p>
      <p id="Par57">We use the k-mer-based assembly evaluation tool merqury<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> to evaluate the diploid assemblies generated by each pipeline and use BUSCO<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> to evaluate the gene completeness of assemblies. The hamming error rate of the assemblies is calculated from the output of merqury. The details of the parameters used in this study are described in Supplementary Notes <xref rid="MOESM1" ref-type="media">4</xref>, <xref rid="MOESM1" ref-type="media">5</xref>. We use the reference-based evaluation tool Pomoxis (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/pomoxis">https://github.com/nanoporetech/pomoxis</ext-link>) to evaluate the base quality of diploid assemblies <bold>(</bold>Supplementary Note <xref rid="MOESM1" ref-type="media">6</xref>). The genome fraction is evaluated by QUAST<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> and its parameters are described in Supplementary Note <xref rid="MOESM1" ref-type="media">7</xref>.</p>
      <p id="Par58">We obtain the small variants (SNP and INDEL) sets from HG002 assemblies against GRCh38 using dipcall<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> and compare them against the HG002 GIAB benchmark to evaluate their precisions, recalls, and F1 scores using hap.py<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>. We called structural variant (SV) sets from HG002 assemblies against GRCh37 using hapdiff (<ext-link ext-link-type="uri" xlink:href="https://github.com/KolmogorovLab/hapdiff">https://github.com/KolmogorovLab/hapdiff</ext-link>) and compare them against the curated set of SVs in the HG002 genome<sup><xref ref-type="bibr" rid="CR55">55</xref></sup> to evaluate their precisions, recalls, and F1 scores using truvari<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> (Supplementary Note <xref rid="MOESM1" ref-type="media">8</xref>).</p>
    </sec>
    <sec id="Sec23">
      <title>Reporting summary</title>
      <p id="Par59">Further information on research design is available in the <xref rid="MOESM5" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec24">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2024_47349_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2024_47349_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2024_47349_MOESM3_ESM.docx">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2024_47349_MOESM4_ESM.xlsx">
            <caption>
              <p>Supplementary Data 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2024_47349_MOESM5_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Fan Nie, Peng Ni</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-024-47349-7.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported in part by the National Key Research and Development Program of China (No. 2021YFF1201200); the National Natural Science Foundation of China under Grants (Nos. 62350004, 62332020); the Project of Xiangjiang Laboratory (No. 23XJ01011) to Jianxin Wang. This work was also supported in part by the US National Institute of Food and Agriculture (NIFA; Grant Number 2017-70016-26051 and 2023-70029-41309) and the US National Science Foundation (NSF; Grant Number ABI-1759856, MRI-2018069, MTM2-2025541) to Feng Luo. This work was also supported in part by Guangdong Basic and Applied Basic Research Foundation (No. 2020B1515020057) to Chuanle Xiao. We are grateful for resources from the High-Performance Computing Center of Central South University.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.X.W., F.L., and C.L.X. conceived and designed this project. F.N. and J.X.W. conceived, designed, and implemented the consensus and assembly algorithm. F.N. and P.N. integrated all the programs into the PECAT pipeline and provided documentation. F.N., P.N., N.H., and J.Z. analyzed the performance of algorithms developed in this study. C.L.X. and Z.Y.W. provided the dataset <italic>A. thaliana</italic> (Col-0 × C24). J.X.W., F.L., and F.N. performed the theoretical analysis of the algorithms developed in this study. J.X.W., F.L., and F.N. wrote the manuscript. Z.Y.W. wrote about cultivating <italic>A. thaliana</italic> (Col-0 × C24) and extracting its DNA. All authors have read and approved the final version of this manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par60"><italic>Nature Communications</italic> thanks Kishwar Shafin for his contribution to the peer review of this work. A peer review file is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>All described datasets are obtained from public websites, except for <italic>A. thaliana</italic> (Col-0 × C24) which is generated using our in-house sequencing. It is available from NGDC at <ext-link ext-link-type="uri" xlink:href="https://ngdc.cncb.ac.cn/bioproject/browse/PRJCA011723">PRJCA011723</ext-link>. <italic>S. cerevisiae</italic> (SK × Y12), <italic>A. thaliana</italic> (Col-0 × Cvi-0), <italic>D. melanogaster</italic> (ISO1 × A4), <italic>B. taurus</italic> (Angus × Brahman), and <italic>B. taurus</italic> (Bison×Simmental) are available from NCBI at <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJEB7245">PRJEB7245</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA314706">PRJNA314706</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA558397">PRJNA558397</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA432857">PRJNA432857</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA677946">PRJNA677946</ext-link>. HG002 using Nanopore R9 sequencing is available at Human Pangenome Reference Consortium (HPRC) [<ext-link ext-link-type="uri" xlink:href="https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=T2T/scratch/HG002/sequencing/ont/">https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=T2T/scratch/HG002/sequencing/ont/</ext-link>]. HG002 using Nanopore R10 sequencing is available at HPRC [<ext-link ext-link-type="uri" xlink:href="https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=submissions/5b73fa0e-658a-4248-b2b8-cd16155bc157--UCSC_GIAB_R1041_nanopore/HG002_R1041_UL/Guppy6/">https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=submissions/5b73fa0e-658a-4248-b2b8-cd16155bc157--UCSC_GIAB_R1041_nanopore/HG002_R1041_UL/Guppy6/</ext-link>]. HG002 using Nanopore R10 duplex sequencing is available at HPRC [<ext-link ext-link-type="uri" xlink:href="https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=submissions/0CB931D5-AE0C-4187-8BD8-B3A9C9BFDADE--UCSC_HG002_R1041_Duplex_Dorado/Dorado_v0.1.1/stereo_duplex">https://s3-us-west-2.amazonaws.com/human-pangenomics/index.html?prefix=submissions/0CB931D5-AE0C-4187-8BD8-B3A9C9BFDADE--UCSC_HG002_R1041_Duplex_Dorado/Dorado_v0.1.1/stereo_duplex</ext-link>]. HG002 using PacBio HiFi sequencing is available from NCBI at <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA586863">PRJNA586863</ext-link>. GIAB v2.0 genome stratification BED files are available at <ext-link ext-link-type="uri" xlink:href="https://ftp-trace.ncbi.nlm.nih.gov/ReferenceSamples/giab/release/genome-stratifications/v2.0/GRCh38/">GIAB</ext-link>. HG002 GIAB benchmark is available at <ext-link ext-link-type="uri" xlink:href="https://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/release/AshkenazimTrio/HG002_NA24385_son/NISTv3.3.2/">GIAB</ext-link>. The curated set of SVs in the HG002 is available at <ext-link ext-link-type="uri" xlink:href="https://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/AshkenazimTrio/analysis/NIST_SVs_Integration_v0.6/">GIAB</ext-link>. NCTC9006 and NCTC9024 are available from ENA at <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ena/browser/view/PRJEB6403">PRJEB6403</ext-link>. The details of the datasets used in this study are reported in Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">17</xref>. All assemblies are available at Zenodo [10.5281/zenodo.10457427].</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>All source codes for PECAT are available at GitHub [<ext-link ext-link-type="uri" xlink:href="https://github.com/lemene/PECAT">https://github.com/lemene/PECAT</ext-link>] and Zenodo [10.5281/zenodo.10799833].</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par61">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagarajan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Sequence assembly demystified</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>157</fpage>
        <lpage>167</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3367</pub-id>
        <?supplied-pmid 23358380?>
        <pub-id pub-id-type="pmid">23358380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gagarinova</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Emili</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Genome-scale genetic manipulation methods for exploring bacterial molecular biology</article-title>
        <source>Mol. Biosyst.</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>1626</fpage>
        <pub-id pub-id-type="doi">10.1039/c2mb25040c</pub-id>
        <?supplied-pmid 22517266?>
        <pub-id pub-id-type="pmid">22517266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>International Human Genome Sequencing Consortium</surname>
          </name>
        </person-group>
        <article-title>Finishing the euchromatic sequence of the human genome</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>431</volume>
        <fpage>931</fpage>
        <lpage>945</lpage>
        <pub-id pub-id-type="doi">10.1038/nature03001</pub-id>
        <pub-id pub-id-type="pmid">15496913</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chin</surname>
            <given-names>CS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phased diploid genome assembly with single-molecule real-time sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>1050</fpage>
        <lpage>1054</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4035</pub-id>
        <?supplied-pmid 27749838?>
        <pub-id pub-id-type="pmid">27749838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Canu: scalable and accurate long-read assembly via adaptive <italic>k</italic> -mer weighting and repeat separation</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>722</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.215087.116</pub-id>
        <?supplied-pmid 28298431?>
        <pub-id pub-id-type="pmid">28298431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>C-L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MECAT: fast mapping, error correction, and de novo assembly for single-molecule sequencing reads</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>1072</fpage>
        <lpage>1074</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4432</pub-id>
        <?supplied-pmid 28945707?>
        <pub-id pub-id-type="pmid">28945707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolmogorov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Assembly of long, error-prone reads using repeat graphs</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>540</fpage>
        <lpage>546</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0072-8</pub-id>
        <?supplied-pmid 30936562?>
        <pub-id pub-id-type="pmid">30936562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate long-read assembly with wtdbg2</article-title>
        <source>Nat. Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>155</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0669-3</pub-id>
        <?supplied-pmid 31819265?>
        <pub-id pub-id-type="pmid">31819265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Efficient assembly of nanopore reads via highly accurate and intact error correction</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>60</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-20236-7</pub-id>
        <?supplied-pmid 33397900?>
        <pub-id pub-id-type="pmid">33397900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weirather</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive comparison of Pacific Biosciences and Oxford Nanopore Technologies and their applications to transcriptome analysis</article-title>
        <source>F1000Research</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>100</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.10571.2</pub-id>
        <?supplied-pmid 28868132?>
        <pub-id pub-id-type="pmid">28868132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A universal SNP and small-indel variant caller using deep neural networks</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>983</fpage>
        <lpage>987</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4235</pub-id>
        <?supplied-pmid 30247488?>
        <pub-id pub-id-type="pmid">30247488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>A multi-task convolutional deep neural network for variant calling in single molecule sequencing</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>998</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09025-z</pub-id>
        <?supplied-pmid 30824707?>
        <pub-id pub-id-type="pmid">30824707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahsan</surname>
            <given-names>MU</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>NanoCaller for accurate detection of SNPs and indels in difficult-to-map regions from long-read sequencing by haplotype-aware deep neural networks</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>261</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02472-2</pub-id>
        <?supplied-pmid 34488830?>
        <pub-id pub-id-type="pmid">34488830</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafin</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype-aware variant calling with PEPPER-Margin-DeepVariant enables high accuracy in nanopore long-reads</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>1322</fpage>
        <lpage>1332</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01299-w</pub-id>
        <?supplied-pmid 34725481?>
        <pub-id pub-id-type="pmid">34725481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Symphonizing pileup and full-alignment for deep learning-based long-read variant calling</article-title>
        <source>Nat. Comput. Sci.</source>
        <year>2022</year>
        <volume>2</volume>
        <fpage>797</fpage>
        <lpage>803</lpage>
        <pub-id pub-id-type="doi">10.1038/s43588-022-00387-x</pub-id>
        <?supplied-pmid 38177392?>
        <pub-id pub-id-type="pmid">38177392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly of haplotype-resolved genomes with trio binning</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>1174</fpage>
        <lpage>1182</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jarvis</surname>
            <given-names>ED</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Semi-automated assembly of high-quality diploid human reference genomes</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>611</volume>
        <fpage>519</fpage>
        <lpage>531</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-05325-5</pub-id>
        <?supplied-pmid 36261518?>
        <pub-id pub-id-type="pmid">36261518</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rautiainen</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Telomere-to-telomere assembly of diploid chromosomes with Verkko</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2023</year>
        <volume>41</volume>
        <fpage>1474</fpage>
        <lpage>1482</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-023-01662-6</pub-id>
        <?supplied-pmid 36797493?>
        <pub-id pub-id-type="pmid">36797493</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kronenberg</surname>
            <given-names>ZN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Extended haplotype-phasing of long-read de novo genome assemblies using Hi-C</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>1935</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-20536-y</pub-id>
        <?supplied-pmid 33911078?>
        <pub-id pub-id-type="pmid">33911078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Human Genome Structural Variation Consortium</surname>
          </name>
          <etal/>
        </person-group>
        <article-title>Fully phased human genome assembly without parental data using single-cell strand sequencing and long reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>302</fpage>
        <lpage>308</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0719-5</pub-id>
        <pub-id pub-id-type="pmid">33288906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campoy</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gamete binning: chromosome-level and haplotype-resolved genome assembly enabled by high-throughput single-cell sequencing of gamete genomes</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>306</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02235-5</pub-id>
        <?supplied-pmid 33372615?>
        <pub-id pub-id-type="pmid">33372615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Digestion-ligation-only Hi-C is an efficient and cost-effective method for chromosome conformation capture</article-title>
        <source>Nat. Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>754</fpage>
        <lpage>763</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0111-2</pub-id>
        <?supplied-pmid 29700467?>
        <pub-id pub-id-type="pmid">29700467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>HS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromosome-scale assembly comparison of the Korean Reference Genome KOREF from PromethION and PacBio with Hi-C mapping information</article-title>
        <source>GigaScience</source>
        <year>2019</year>
        <volume>8</volume>
        <fpage>giz125</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giz125</pub-id>
        <?supplied-pmid 31794015?>
        <pub-id pub-id-type="pmid">31794015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wenger</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate circular consensus long-read sequencing improves variant detection and assembly of a human genome</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>1155</fpage>
        <lpage>1162</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0217-9</pub-id>
        <?supplied-pmid 31406327?>
        <pub-id pub-id-type="pmid">31406327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Concepcion</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Haplotype-resolved de novo assembly using phased assembly graphs with hifiasm</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>170</fpage>
        <lpage>175</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01056-5</pub-id>
        <?supplied-pmid 33526886?>
        <pub-id pub-id-type="pmid">33526886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HiCanu: accurate assembly of segmental duplications, satellites, and allelic variants from high-fidelity long reads</article-title>
        <source>Genome Res.</source>
        <year>2020</year>
        <volume>30</volume>
        <fpage>1291</fpage>
        <lpage>1305</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.263566.120</pub-id>
        <?supplied-pmid 32801147?>
        <pub-id pub-id-type="pmid">32801147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype-resolved assembly of diploid genomes without parental data</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>1332</fpage>
        <lpage>1335</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-022-01261-x</pub-id>
        <?supplied-pmid 35332338?>
        <pub-id pub-id-type="pmid">35332338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bankevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bzikadze</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Kolmogorov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Antipov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Multiplex de Bruijn graphs enable genome assembly from long, high-fidelity reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>1075</fpage>
        <lpage>1081</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-022-01220-6</pub-id>
        <?supplied-pmid 35228706?>
        <pub-id pub-id-type="pmid">35228706</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and assembly of a human genome with ultra-long reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>338</fpage>
        <lpage>345</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4060</pub-id>
        <?supplied-pmid 29431738?>
        <pub-id pub-id-type="pmid">29431738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frei</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultralong Oxford nanopore reads enable the development of a reference-grade perennial ryegrass genome assembly</article-title>
        <source>Genome Biol. Evol.</source>
        <year>2021</year>
        <volume>13</volume>
        <fpage>evab159</fpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evab159</pub-id>
        <?supplied-pmid 34247248?>
        <pub-id pub-id-type="pmid">34247248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Yorke</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Reducing storage requirements for biological sequence comparison</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>3363</fpage>
        <lpage>3369</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth408</pub-id>
        <?supplied-pmid 15256412?>
        <pub-id pub-id-type="pmid">15256412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap and miniasm: fast mapping and de novo assembly for noisy long sequences</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>2103</fpage>
        <lpage>2110</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw152</pub-id>
        <?supplied-pmid 27153593?>
        <pub-id pub-id-type="pmid">27153593</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>The fragment assembly string graph</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>ii79</fpage>
        <lpage>ii85</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti1114</pub-id>
        <?supplied-pmid 16204131?>
        <pub-id pub-id-type="pmid">16204131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Grasso</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sharlow</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>Multiple sequence alignment using partial order graphs</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>452</fpage>
        <lpage>464</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.452</pub-id>
        <?supplied-pmid 11934745?>
        <pub-id pub-id-type="pmid">11934745</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <?supplied-pmid 29750242?>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>AnO(ND) difference algorithm and its variations</article-title>
        <source>Algorithmica</source>
        <year>1986</year>
        <volume>1</volume>
        <fpage>251</fpage>
        <lpage>266</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01840446</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kamath</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Shomorony</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Courtade</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Tse</surname>
            <given-names>DN</given-names>
          </name>
        </person-group>
        <article-title>HINGE: long-read assembly achieves optimal repeat resolution</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>747</fpage>
        <lpage>756</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.216465.116</pub-id>
        <?supplied-pmid 28320918?>
        <pub-id pub-id-type="pmid">28320918</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Benchmarking challenging small variants with linked and long reads</article-title>
        <source>Cell Genom.</source>
        <year>2022</year>
        <volume>2</volume>
        <fpage>100128</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100128</pub-id>
        <?supplied-pmid 36452119?>
        <pub-id pub-id-type="pmid">36452119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guan</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying and removing haplotypic duplication in primary genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>2896</fpage>
        <lpage>2898</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa025</pub-id>
        <?supplied-pmid 31971576?>
        <pub-id pub-id-type="pmid">31971576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolmogorov</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>
          <italic>Scalable nanopore sequencing of human genomes provides a comprehensive view of haplotype-resolved variation and methylation</italic>
        </article-title>
        <source>Nat. Methods</source>
        <year>2023</year>
        <volume>20</volume>
        <fpage>1483</fpage>
        <lpage>1492</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-023-01993-x</pub-id>
        <?supplied-pmid 37710018?>
        <pub-id pub-id-type="pmid">37710018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafin</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and the Shasta toolkit enable efficient de novo assembly of eleven human genomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>1044</fpage>
        <lpage>1053</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0503-6</pub-id>
        <?supplied-pmid 32686750?>
        <pub-id pub-id-type="pmid">32686750</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Berkeley</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Seppey</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Simão</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>BUSCO update: novel and streamlined workflows along with broader and deeper phylogenetic coverage for scoring of eukaryotic, prokaryotic, and viral genomes</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2021</year>
        <volume>38</volume>
        <fpage>4647</fpage>
        <lpage>4654</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msab199</pub-id>
        <?supplied-pmid 34320186?>
        <pub-id pub-id-type="pmid">34320186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rhie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Merqury: reference-free quality, completeness, and phasing assessment for genome assemblies</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>245</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02134-9</pub-id>
        <?supplied-pmid 32928274?>
        <pub-id pub-id-type="pmid">32928274</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oppenheimer</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A reference genome assembly of American bison, Bison bison bison</article-title>
        <source>J. Hered.</source>
        <year>2021</year>
        <volume>112</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="doi">10.1093/jhered/esab003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bollas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Au</surname>
            <given-names>KF</given-names>
          </name>
        </person-group>
        <article-title>Nanopore sequencing technology, bioinformatics and applications</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>1348</fpage>
        <lpage>1365</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-01108-x</pub-id>
        <?supplied-pmid 34750572?>
        <pub-id pub-id-type="pmid">34750572</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garg</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromosome-scale, haplotype-resolved assembly of human genomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>309</fpage>
        <lpage>312</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0711-0</pub-id>
        <?supplied-pmid 33288905?>
        <pub-id pub-id-type="pmid">33288905</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chin</surname>
            <given-names>CS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nonhybrid, finished microbial genome assemblies from long-read SMRT sequencing data</article-title>
        <source>Nat. Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>563</fpage>
        <lpage>569</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2474</pub-id>
        <?supplied-pmid 23644548?>
        <pub-id pub-id-type="pmid">23644548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Šošić</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Šikić</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Edlib: a C/C ++ library for fast, exact sequence alignment using edit distance</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>1394</fpage>
        <lpage>1395</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw753</pub-id>
        <?supplied-pmid 28453688?>
        <pub-id pub-id-type="pmid">28453688</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Savaresi, S. M. &amp; Boley, D. L. On the performance of bisecting K-means and PDDP. in <italic>Proceedings of the 2001 SIAM International Conference on Data Mining.</italic> 1–14 (2001).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Aggressive assembly of pyrosequencing reads with mates</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>2818</fpage>
        <lpage>2824</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn548</pub-id>
        <?supplied-pmid 18952627?>
        <pub-id pub-id-type="pmid">18952627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaser</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sović</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Nagarajan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Šikić</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate de novo genome assembly from long uncorrected reads</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>737</fpage>
        <lpage>746</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.214270.116</pub-id>
        <?supplied-pmid 28100585?>
        <pub-id pub-id-type="pmid">28100585</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saveliev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vyahhi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>QUAST: quality assessment tool for genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1072</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt086</pub-id>
        <?supplied-pmid 23422339?>
        <pub-id pub-id-type="pmid">23422339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A synthetic-diploid benchmark for accurate variant-calling evaluation</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>595</fpage>
        <lpage>597</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0054-7</pub-id>
        <?supplied-pmid 30013044?>
        <pub-id pub-id-type="pmid">30013044</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">The Global Alliance for Genomics and Health Benchmarking Team et al. Best practices for benchmarking germline small-variant calls in human genomes. <italic>Nat. Biotechnol</italic>. <bold>37</bold>, 555–560 (2019).</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zook</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A robust benchmark for detection of germline large deletions and insertions</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>1347</fpage>
        <lpage>1355</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0538-8</pub-id>
        <?supplied-pmid 32541955?>
        <pub-id pub-id-type="pmid">32541955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>English</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Menon</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Metcalf</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Truvari: refined structural variant comparison preserves allelic diversity</article-title>
        <source>Genome Biol.</source>
        <year>2022</year>
        <volume>23</volume>
        <fpage>271</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02840-6</pub-id>
        <?supplied-pmid 36575487?>
        <pub-id pub-id-type="pmid">36575487</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
