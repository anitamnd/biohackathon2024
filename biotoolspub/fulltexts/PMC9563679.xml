<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9563679</article-id>
    <article-id pub-id-type="pmid">36040148</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac590</article-id>
    <article-id pub-id-type="publisher-id">btac590</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scFeatures: multi-view representations of single-cell and spatial data for disease outcome prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2356-4031</contrib-id>
        <name>
          <surname>Cao</surname>
          <given-names>Yue</given-names>
        </name>
        <aff><institution>Charles Perkins Centre, The University of Sydney</institution>, Sydney, NSW 2006, <country country="AU">Australia</country></aff>
        <aff><institution>School of Mathematics and Statistics, The University of Sydney</institution>, Sydney, NSW 2006, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Yingxin</given-names>
        </name>
        <aff><institution>Charles Perkins Centre, The University of Sydney</institution>, Sydney, NSW 2006, <country country="AU">Australia</country></aff>
        <aff><institution>School of Mathematics and Statistics, The University of Sydney</institution>, Sydney, NSW 2006, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5253-4747</contrib-id>
        <name>
          <surname>Patrick</surname>
          <given-names>Ellis</given-names>
        </name>
        <aff><institution>Charles Perkins Centre, The University of Sydney</institution>, Sydney, NSW 2006, <country country="AU">Australia</country></aff>
        <aff><institution>School of Mathematics and Statistics, The University of Sydney</institution>, Sydney, NSW 2006, <country country="AU">Australia</country></aff>
        <aff><institution>Computational Systems Biology Group, Children’s Medical Research Institute</institution>, Westmead, NSW 2145, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1098-3138</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Pengyi</given-names>
        </name>
        <!--pengyi.yang@sydney.edu.au-->
        <aff><institution>Charles Perkins Centre, The University of Sydney</institution>, Sydney, NSW 2006, <country country="AU">Australia</country></aff>
        <aff><institution>School of Mathematics and Statistics, The University of Sydney</institution>, Sydney, NSW 2006, <country country="AU">Australia</country></aff>
        <aff><institution>Computational Systems Biology Group, Children’s Medical Research Institute</institution>, Westmead, NSW 2145, <country country="AU">Australia</country></aff>
        <xref rid="btac590-cor1" ref-type="corresp"/>
        <xref rid="btac590-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Yang</surname>
          <given-names>Jean Yee Hwa</given-names>
        </name>
        <!--jean.yang@sydney.edu.au-->
        <aff><institution>Charles Perkins Centre, The University of Sydney</institution>, Sydney, NSW 2006, <country country="AU">Australia</country></aff>
        <aff><institution>School of Mathematics and Statistics, The University of Sydney</institution>, Sydney, NSW 2006, <country country="AU">Australia</country></aff>
        <aff><institution>Laboratory of Data Discovery for Health Limited (D24H), Science Park</institution>, Hong Kong SAR, <country country="CN">China</country></aff>
        <xref rid="btac590-cor1" ref-type="corresp"/>
        <xref rid="btac590-FM1" ref-type="author-notes"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Vitek</surname>
          <given-names>Olga</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btac590-FM1">
        <label>†</label>
        <p>The authors wish it to be known that, in their opinion, Pengyi Yang and Jean Yee Hwa Yang should be regarded as Joint Last Authors.</p>
      </fn>
      <corresp id="btac590-cor1">To whom correspondence should be addressed. <email>jean.yang@sydney.edu.au</email> or <email>pengyi.yang@sydney.edu.au</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-08-30">
      <day>30</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>20</issue>
    <fpage>4745</fpage>
    <lpage>4753</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>21</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>16</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>21</day>
        <month>9</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac590.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>With the recent surge of large-cohort scale single cell research, it is of critical importance that analytical methods can fully utilize the comprehensive characterization of cellular systems that single cell technologies produce to provide insights into samples from individuals. Currently, there is little consensus on the best ways to compress information from the complex data structures of these technologies to summary statistics that represent each sample (e.g. individuals).</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present scFeatures, an approach that creates interpretable cellular and molecular representations of single-cell and spatial data at the sample level. We demonstrate that summarizing a broad collection of features at the sample level is both important for understanding underlying disease mechanisms in different experimental studies and for accurately classifying disease status of individuals.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>scFeatures is publicly available as an R package at <ext-link xlink:href="https://github.com/SydneyBioX/scFeatures" ext-link-type="uri">https://github.com/SydneyBioX/scFeatures</ext-link>. All data used in this study are publicly available with accession ID reported in the Section 2.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Australia National Health and Medical Research Council (NHMRC) Investigator Grant</institution>
          </institution-wrap>
        </funding-source>
        <award-id>APP1173469</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>AIR@innoHK programme of the Innovation and Technology Commission of Hong Kong</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Australia NHMRC Career Developmental Fellowship</institution>
          </institution-wrap>
        </funding-source>
        <award-id>APP1111338</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Australian Research Council Discovery Early Career Researcher Award</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DE200100944</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Australian Government</institution>
            <institution-id institution-id-type="DOI">10.13039/100015539</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Research Training Program Tuition Fee Offset and University of Sydney Postgraduate Award Stipend Scholarship</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Research Training Program Tuition Fee Offset and Stipend Scholarship and Chen Family Research Scholarship</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Recent single-cell or near single-cell resolution omics technologies such as spatial transcriptomics enable the discovery of cell- and cell type specific knowledge and have transformed our understanding of biological systems, including diseases (<xref rid="btac590-B19" ref-type="bibr">Longo <italic toggle="yes">et al.</italic>, 2021</xref>). Key to the exploration of such data are the ability to untangle and extract useful information from their high feature dimensions (<xref rid="btac590-B35" ref-type="bibr">Yang <italic toggle="yes">et al.</italic>, 2021</xref>) and uncover hidden insights. A plethora of computational methods has been developed on this front, with the main focus on individual cell analysis (<xref rid="btac590-B31" ref-type="bibr">Stegle <italic toggle="yes">et al.</italic>, 2015</xref>), such as cell type identity (<xref rid="btac590-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac590-B13" ref-type="bibr">Kim <italic toggle="yes">et al.</italic>, 2021</xref>) and pseudotime ordering within a lineage (<xref rid="btac590-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic>, 2019</xref>). While these tools enable characterization of individual cells, there is a lack of tools that allow for the representation of individual samples based on their cellular characteristics and the investigation of how these cellular properties are driving disease outcomes. With the recent surge of multi-condition and multi-sample single-cell studies on large sample cohort (<xref rid="btac590-B17" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2020</xref>), the next frontier of research is on representing and characterizing cellular properties at the sample (e.g. individual patient) level for linking such information with the disease outcome.</p>
    <p>Creating a representation of each sample from the collection of sequenced cells is a crucial step for subsequent analysis as successful modelling and interpretation of disease outcomes requires biologically relevant learning features from the data. While using the original expression matrix as the input to various models could inform the change in transcriptomics level across disease conditions, the ability to represent the data with other layers of information is critical for uncovering additional insights given the complex and non-linear relationships among the feature dimensions (e.g. interaction of genes, gene networks and pathways). The single-cell field has a wealth of tools for data exploration (<xref rid="btac590-B34" ref-type="bibr">Wu and Zhang, 2020</xref>) which enables the exploration of biology underlying the individuals. Most current tools are not specifically designed to derive a set of features that can be used to represent an individual. Yet, with careful adaptation, a number of approaches can be used to construct novel molecular representations of individual samples. Cell-cell interactions tools (<xref rid="btac590-B4" ref-type="bibr">Armingol <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac590-B9" ref-type="bibr">Jin and Ramos, 2022</xref>) for example, calculate cell type specific signalling scores between pairs of ligand and receptor molecules. The interaction scores can be used to represent the intercellular communications of cells and cell types in a sample. Another example is gene set enrichment analysis (<xref rid="btac590-B20" ref-type="bibr">Maleki <italic toggle="yes">et al.</italic>, 2020</xref>) which infers the pathway enrichment score of individual cells. By summarizing the scores across cell types, a cell type specific representation of the pathway enrichment of each sample can be constructed.</p>
    <p>To this end, we develop scFeatures, a tool that generates a large collection of interpretable molecular representations for individual samples in single-cell omics data, which can be readily used by any machine learning algorithms to perform disease outcome prediction and drive biological discovery. Together, scFeatures generates features across six categories representing different molecular views of cellular characteristics. These include (i) cell type proportions, (ii) cell type specific gene expressions, (iii) cell type specific pathway expressions, (iv) cell type specific cell-cell interaction (CCI) scores, (v) overall aggregated gene expressions and (vi) spatial metrics. The different types of features constructed thereby enable a more comprehensive multi-view representation of the expression data. Based on the generated features, scFeatures produces an HTML report containing visual summaries of features most associated with conditions. In a collection of 17 published single-cell RNA-seq, single-cell spatial proteomics and spatial transcriptomics datasets, scFeatures reveal different feature types are useful for predicting the disease outcomes in different datasets. Furthermore, through examining the selected features in two case studies, scFeatures uncovers cell types important to ulcerative colitis and stratified individuals with distinct survival outcomes in a triple negative breast cancer dataset. Together, these results demonstrate that scFeatures enables data-driven feature generation (or feature engineering) and facilitates unbiased identification of feature types most perturbed by the disease conditions.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1. Data collection and processing</title>
      <sec>
        <title>2.1.1 scRNA-seq</title>
        <p>To demonstrate scFeatures on scRNA-seq data, we collected data from four published studies and curated a total of 15 datasets from the studies. The data are described in detail below:</p>
        <p><italic toggle="yes">Six Ulcerative Colitis datasets</italic>: The UC data (<xref rid="btac590-B30" ref-type="bibr">Smillie <italic toggle="yes">et al.</italic>, 2019</xref>) sequenced healthy control, inflamed and non-inflamed colon biopsies from multiple individuals. The data was retrieved from Single Cell Portal with accession ID SCP259. We subset the data into epithelial, stromal cells and immune subsets according to the original publication, resulting in the following six datasets:
</p>
        <list list-type="bullet">
          <list-item>
            <p>UC healthy versus non-inflamed (Epi)</p>
          </list-item>
          <list-item>
            <p>UC healthy versus non-inflamed (Fib)</p>
          </list-item>
          <list-item>
            <p>UC healthy versus non-inflamed (Imm)</p>
          </list-item>
          <list-item>
            <p>UC inflamed versus non-inflamed (Epi)</p>
          </list-item>
          <list-item>
            <p>UC inflamed versus non-inflamed (Fib)</p>
          </list-item>
          <list-item>
            <p>UC inflamed versus non-inflamed (Imm)</p>
          </list-item>
        </list>
        <p>where Epi stands for epithelial, Fib stands for stromal and Imm stands for immune subsets. Inflamed, non-inflamed and healthy are conditions of interest.</p>
        <p><italic toggle="yes">Six lung datasets</italic>: The lung data (<xref rid="btac590-B2" ref-type="bibr">Adams <italic toggle="yes">et al.</italic>, 2020</xref>) sequenced healthy control, idiopathic pulmonary fibrosis (IPF) and chronic obstructive pulmonary disease (COPD) biopsies from multiple individuals. The data was retrieved from Gene Expression Omnibus (GEO) with accession ID GSE136831. We subset the data into epithelial, stromal cells and immune subsets according to the original publication, resulting in the following datasets:
</p>
        <list list-type="bullet">
          <list-item>
            <p>Lung healthy versus IPF (Epi)</p>
          </list-item>
          <list-item>
            <p>Lung healthy versus IPF (Fib)</p>
          </list-item>
          <list-item>
            <p>Lung healthy versus IPF (Imm)</p>
          </list-item>
          <list-item>
            <p>Lung healthy versus COPD (Epi)</p>
          </list-item>
          <list-item>
            <p>Lung healthy versus COPD (Fib)</p>
          </list-item>
          <list-item>
            <p>Lung healthy versus COPD (Imm)</p>
          </list-item>
        </list>
        <p>where healthy, IPF and COPD are conditions of interest.</p>
        <p><italic toggle="yes">Two melanoma data</italic> (<xref rid="btac590-B25" ref-type="bibr">Sade-Feldman <italic toggle="yes">et al.</italic>, 2019</xref>) sequenced immune cells from tumour biopsies of melanoma patients before and after treatment with immune checkpoint therapy. The data was retrieved from GEO with accession ID GSE120575. We subset the data into pre-treatment and post-treatment datasets. The conditions of interest in both datasets are non-responding and responding.</p>
        <p><italic toggle="yes">The COVID dataset</italic> (<xref rid="btac590-B29" ref-type="bibr">Schulte-Schrepping <italic toggle="yes">et al.</italic>, 2020</xref>) sequenced peripheral blood mononuclear cells (PBMC) from COVID-19 individuals. The data was retrieved from European Genome-phenome Archive (EGA) with accession ID EGAS00001004571. We subset the original data into mild and severe individuals and consider the mild and severe disease stage as the conditions of interest.</p>
      </sec>
      <sec>
        <title>2.1.2 Spatial proteomics</title>
        <p>The <italic toggle="yes">triple negative breast cancer dataset</italic> (<xref rid="btac590-B12" ref-type="bibr">Keren <italic toggle="yes">et al.</italic>, 2019</xref>) measured the patient’s protein expression using MIBI-TOF (multiplexed ion beam imaging by time of flight) technology. Data was obtained from <ext-link xlink:href="https://mibi-share.ionpath.com" ext-link-type="uri">https://mibi-share.ionpath.com</ext-link>.</p>
      </sec>
      <sec>
        <title>2.1.3 Spatial transcriptomics</title>
        <p><italic toggle="yes">The amyotrophic lateral sclerosis dataset</italic> (<xref rid="btac590-B21" ref-type="bibr">Maniatis <italic toggle="yes">et al.</italic>, 2019</xref>) sequenced lumbar spinal cord tissue of ALS and control mice at varying time points using the spatial transcriptomics technology. The data was retrieved from GEO with accession ID GSE120374. We used the subset of data sequenced at the disease onset time point.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Implementation of feature types</title>
      <p>We generated 17 feature types that can be broadly categorized into six categories: (i) cell type proportions, (ii) cell type specific gene expressions, (iii) cell type specific pathway expressions, (iv) cell type specific CCI scores, (v) overall aggregated gene expressions and (vi) spatial metrics. All feature types except for the overall aggregated gene expressions category have different implementations for scRNA-seq and spatial data to better leverage the characteristics of different data types and the implementation details are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>.</p>
      <p>For spot-based spatial transcriptomics, we performed the following additional processing to allow certain feature types to be applicable. First, since the cell type specific feature categories require cell type information while the spot in spot-based data contains a mixed population of multiple cells, we used Seurat’s TransferData function to predict the cell type probability of each spot. A published scRNA-seq data on mouse spinal cord with cell type labels was used as the reference (<xref rid="btac590-B28" ref-type="bibr">Sathyamurthy <italic toggle="yes">et al.</italic>, 2018</xref>). Then, given that each spot contains an unknown number of cells that varies between spots, we weighted the contribution of each spot to the generated features by the relative number of cells it contains. We used library size as an estimate of the relative number of cells, motivated by a study that found a high correlation between the number of cells and library size of spots (<xref rid="btac590-B27" ref-type="bibr">Saiselet <italic toggle="yes">et al.</italic>, 2020</xref>). To calculate the relative number of cells, we binned the log2 transformed total library size of cells into 100 bins and assigned each spot a relative number of cells ranging between 1 and 100 according to its bin. The cell type probability of each spot together with the relative number of cells were used in the implementation of feature types for spatial transcriptomics.</p>
    </sec>
    <sec>
      <title>2.3 Correlation between features and feature types</title>
      <p>Given scFeatures constructs a standard matrix of samples by features, we can readily compute the Pearson’s correlation between individual features as shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>. We subsampled 100 features from feature types that have more than 100 features to avoid the correlation plot being dominated by feature types with greater number of features.</p>
      <p>To summarize the correlation between pairs of feature types as shown in <xref rid="btac590-F2" ref-type="fig">Figure 2b</xref>, the following approach was taken. First, we calculated the Pearson’s correlation between all features from a pair of feature types, such as proportion raw and gene mean celltype. This is repeated for each pairwise combination of feature types for each dataset. Then we subsampled 1000 values from the correlation values to reduce the computational burden of plotting. For ease of visual interpretation, the absolute values of the correlation values were taken.</p>
      <p>These correlation values were further summarized in <xref rid="btac590-F2" ref-type="fig">Figure 2c</xref> by taking the average correlation values, followed by hierarchical clustering to cluster the feature types.</p>
    </sec>
    <sec>
      <title>2.4 Classification and survival analysis using generated features</title>
      <p>In scFeatures, we provide functionality to perform classification and survival analysis for the convenience of users. The classification function builds upon the functions in the classification package classifyR (<xref rid="btac590-B32" ref-type="bibr">Strbenac <italic toggle="yes">et al.</italic>, 2015</xref>) that was published by our group earlier. We used the random forest model, set the number of folds to three, performed 50 cross-validation and calculated F1 score. classifyR has an in-built feature selection function. We used the default setting that uses the feature selected from the random forest model built on the training set to evaluate on the test set. These were also the settings used to report the classification performance in this study and can be specified by the user. The only exception is that 100 repeats of cross-validation were performed instead of 50 to obtain a more stable feature importance score for the case study on the ‘UC healthy versus non-inflamed (Fib)’ dataset.</p>
      <p>For survival analysis, we used a Cox proportional-hazards model provided in the rms R package. By default, we set the number of folds to three, performed 50 cross-validation and calculated C-index. Note that as the Cox model is not designed to take in a large number of features at once, unlike a typical classification model, we input one feature from the generated feature type at a time for building the Cox model. The best C-index was reported as the performance for the feature type.</p>
    </sec>
    <sec>
      <title>2.5 Complementarity of the generated features</title>
      <p>To explore the complementarity of the generated features, we compared the classification accuracy of using features from individual feature types with using the combination of features from all feature types. In detail, we used the classification model described above, which is trained on all feature space to derive the feature importance. We then identified the top eight features from each feature type and combined them into the ‘combined feature set’. This set contains 96 features (8 features × 12 feature types) for the ALS dataset and 104 features (8 features × 13 feature types) for the other 15 datasets. The triple negative breast cancer dataset was excluded from this analysis as Cox proportional-hazards model is not designed to take in a large number of features at once. For fair comparison with the individual feature type, we used the top 100 features from each individual feature type. For feature types with less than 100 features, i.e. ‘proportion raw’ and ‘proportion logit’, we used all features. We used the random forest model, set the number of folds to three, performed 50 cross-validation and recorded the F1 score.</p>
    </sec>
    <sec>
      <title>2.6 Feature importance score</title>
      <p>The runTests function in ClassifyR outputs the features selected by the classification model. Since repeated cross-validation was performed, this generated one set of included features for each cross-validation process. Based on all the derived sets, the frequency of inclusion was considered as the ‘feature importance score’ of each feature.</p>
      <p>For the cell type specific feature category, given that each feature is associated with a cell type, it is also of interest to aggregate the feature importance score associated with each cell type. We approached this by summing the feature importance score of all features associated with a cell type, then dividing by the number of features constructed for that particular cell type to adjust for the difference in the number of features per cell type. The final score was considered the feature importance score of each cell type.</p>
    </sec>
    <sec>
      <title>2.7 Speed and memory usage</title>
      <p>To benchmark the scalability of the 17 feature types, we used the UC inflamed versus non-inflamed (Imm) dataset and took random samples to construct datasets with 1000, 2000, 3000, 5000, 10 000, 20 000, 30 000, 50 000, 70 000 and 100 000 cells. Each dataset contains the same 15 individuals and the same 15 cell types.</p>
      <p>For the purpose of evaluating the feature types designed for spot-based data which require each spot to be associated with a cell type probability vector, we treated each cell as a ‘spot’ and randomly created a cell type probability vector for each cell. Similarly, for the purpose of evaluating the feature types under the category of spatial metrics which require spatial coordinates of each cell, we randomly assigned a pair of <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic>-coordinates to each cell. In addition, the cell type probability and number of cells in each spot were randomly generated to represent such data.</p>
      <p>Runtime was measured using the built-in Sys.time function in R. Memory was measured by recording the peak resident set size, which measures the peak amount of memory that a process consumes across all cores. All code was run in parallel using 8 cores three times and the average measurements were taken. All processes were carried out using a research server with dual Intel(R) Xeon(R) Gold 6148 Processor with 40 cores and 768 GB of memory.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 scFeatures performs multi-view feature engineering for single-cell and spatial data</title>
      <p>We propose scFeatures, a new multi-view feature engineering framework that creates an interpretable representation of cellular level features for each individual sample from a given single-cell or spot-based expression dataset (<xref rid="btac590-F1" ref-type="fig">Fig. 1a</xref>). To capture the wide range of cellular information for sample classification (e.g. diseased versus healthy individuals) using single-cell data, we implemented an extensive collection of algorithms to extract over 50 000 interpretable features from a given dataset. These features, spanning a total of 17 types, are motivated by established analytical approaches in a broad range of single-cell literature and can be broadly grouped into six distinct categories including (i) cell type proportions, (ii) cell type specific gene expressions, (iii) cell type specific pathway expressions, (iv) cell type specific CCI scores, (v) overall aggregated gene expressions and (vi) spatial metrics (<xref rid="btac590-F1" ref-type="fig">Fig. 1b</xref>). These collections of constructed features can then be used for various downstream analyses such as disease outcome prediction, biomarker selection, survival analysis and enable the identification of interpretable features and feature types associated with disease conditions.</p>
      <fig position="float" id="btac590-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Overview of scFeatures. (<bold>a</bold>) The input for scFeatures is an omics dataset containing multiple samples such as individuals and cell type labels. scFeatures extracts different views of the data, thereby transforming the gene by cell matrix into a vector of features for each sample. (<bold>b</bold>) scFeatures constructs 17 feature types that can be broadly classified into six categories. Each feature type consists of multiple individual features. For example, for ‘gene mean celltype’, 100 features are generated by default per cell type (nct) per sample (ns) (see Section 2). Examples of feature names from each feature type are given to illustrate the data format</p>
        </caption>
        <graphic xlink:href="btac590f1" position="float"/>
      </fig>
      <p>The six feature categories represent different ‘views’ of the single-cell information. Specifically, category I captures cell type proportion information in which the proportion of cell types for each sample and the ratio of proportions between two cell types are measured. Category II represents cell type specific gene expression and examines the expression of sets of genes or proteins in each cell type. We implemented different approaches for representing this information, including average expression, proportion of expression and correlation of expressions. In category III, which calculates cell type specific pathway scores, by default the 50 hallmark pathways in the Molecular Signatures Database (MSigDB) (<xref rid="btac590-B16" ref-type="bibr">Liberzon <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btac590-B33" ref-type="bibr">Subramanian <italic toggle="yes">et al.</italic>, 2005</xref>) were used to generate various features such as the average expression of each pathway in each cell type. Category IV contains the CCI scores, which measure the probability of ligand-receptor interaction based on the expression values. Category V is designed to recreate the bulk expression by aggregating the expression across cells. Category VI is designed specifically for spatial data type and includes classical metrics for identifying spatial patterns. For all feature categories except category V, the values are summarized at per cell type level, for example, feature <italic toggle="yes">x</italic> cell type <italic toggle="yes">a</italic> and feature <italic toggle="yes">y</italic> cell type <italic toggle="yes">b</italic>, which then forms the vector of molecular representation containing over 50 000 features for each sample. The implementation details can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>.</p>
      <p>scFeatures extracts interpretable features from data generated by scRNA-seq, spatial proteomics and spatial transcriptomics (<xref rid="btac590-T1" ref-type="table">Table 1</xref>). In particular, spatial transcriptomics data, a spot-based technique in which the expression value of each spot is based on a small population of cells, often contains cells from multiple cell types in each spot. We developed several novel ways to adapt the 13 feature types to spot-based data whenever possible; this collection of spatial metrics considers the properties of spot-based technology and reveals cell type specific features in spot-based data. For example, spot-based data precludes direct application of cell type proportion computation since each spot includes an unknown number of cells, while cell type percentage estimation requires individual cell counts for each cell type. To overcome this issue, we estimated the number of cells in each spot using the library size of that location based on the association between the two values. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> provides more documentation on the implementation details on the adaptation of feature types from single-cell RNA-sequencing to spot-based technologies.</p>
      <table-wrap position="float" id="btac590-T1">
        <label>Table 1.</label>
        <caption>
          <p>List of features generated by scFeatures</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th colspan="17" rowspan="1">Feature category<hr/></th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th colspan="3" rowspan="1">Cell type specific proportions<hr/></th>
              <th colspan="3" rowspan="1">Cell type specific gene expressions<hr/></th>
              <th colspan="3" rowspan="1">Cell type specific pathway expressions<hr/></th>
              <th rowspan="1" colspan="1">Cell–cell interaction scores</th>
              <th colspan="3" rowspan="1">Overall aggregated gene expressions<hr/></th>
              <th colspan="4" rowspan="1">Spatial metrics<hr/></th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th colspan="17" rowspan="1">Feature type</th>
            </tr>
            <tr>
              <th colspan="18" rowspan="1">
                <hr/>
              </th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">Application</th>
              <th rowspan="1" colspan="1">Proportion raw</th>
              <th rowspan="1" colspan="1">Proportion logit</th>
              <th rowspan="1" colspan="1">Pairwise ratio of proportion</th>
              <th rowspan="1" colspan="1">Gene mean celltype</th>
              <th rowspan="1" colspan="1">Gene proportion celltype</th>
              <th rowspan="1" colspan="1">Gene correlation celltype</th>
              <th rowspan="1" colspan="1">Pathway mean</th>
              <th rowspan="1" colspan="1">Pathway gsva</th>
              <th rowspan="1" colspan="1">Pathway proportion</th>
              <th rowspan="1" colspan="1">CCI</th>
              <th rowspan="1" colspan="1">Gene mean aggregated</th>
              <th rowspan="1" colspan="1">Gene mean proportion</th>
              <th rowspan="1" colspan="1">Gene mean correlation</th>
              <th rowspan="1" colspan="1">L function</th>
              <th rowspan="1" colspan="1">Cell type interaction</th>
              <th rowspan="1" colspan="1">Moran’s I</th>
              <th rowspan="1" colspan="1">Nearest neighbour correlation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">scRNA-seq data</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Spatial proteomics data</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Single cell transcriptome data</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">Note</italic>: scRNA-seq data are single-cell based and representative technologies are 10× and Smart-seq. Spatial proteomics data are single-cell based and representative technologies are MIBI-TOF, IMC and CODEX. Single-cell transcriptome data are spot based and representative technologies are ST, Visium and MALDI.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.2 scFeatures generates a large collection of diverse features and is scalable to large datasets</title>
      <p>To demonstrate the characteristics of the feature representation, we applied scFeatures to 17 datasets measured using scRNA-seq, spatial proteomics and spatial transcriptomics data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). For typical scRNA-seq data, scFeatures generated over 50 000 features (<xref rid="btac590-F2" ref-type="fig">Fig. 2a</xref>). As expected, the number of features generated was mostly associated with the number of cell types in the dataset and not with other data characteristics, including the number of genes and number of cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
      <fig position="float" id="btac590-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Characteristics of the features generated by scFeatures. (<bold>a</bold>) Compositional barchart showing the number of features generated by scFeatures for each dataset. Datasets are first ordered by data types, and then by the number of cell types. (<bold>b</bold>) Correlation plot showing Pearson’s correlation of features on the ‘Lung healthy versus IPF (Epi)’ dataset as a representative example. The features are colour labelled by feature types for ease of interpretation. (<bold>c</bold>) Boxplots summarizing the correlation between pairs of features across all datasets (see Section 2). Texts highlight the 10 most and 10 least correlated feature types pairs, coloured according to their feature category. (<bold>d</bold>) Hierarchical clustering of the average correlation between feature types. Heatmap is colour labelled by feature category for ease of interpretation</p>
        </caption>
        <graphic xlink:href="btac590f2" position="float"/>
      </fig>
      <p>To explore the diversity of the features generated from scFeatures, we first examined the correlation between the features across 17 datasets (<xref rid="btac590-F2" ref-type="fig">Fig. 2a</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). By summarizing the correlation values between every pairwise combination of feature types (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>), we observed that overall the feature types were poorly correlated, with the median correlation ranging from 0.1 to 0.3 (<xref rid="btac590-F2" ref-type="fig">Fig. 2b</xref>). Hierarchical clustering of the correlations revealed that the higher correlation was observed between certain feature types from the same feature category (<xref rid="btac590-F2" ref-type="fig">Fig. 2c and d</xref>). For example, the ‘gene mean aggregated’ and ‘gene proportion aggregated’ from the aggregated gene expression category had high correlation within each of the feature types and between the feature types pair. This is consistent with our expectation of some degree of co-expression linked with disease conditions.</p>
      <p>To further examine the complementarity of the feature types, we compared the performance of individual feature types with the combination of features across feature types (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). The ability to accurately classify disease outcomes was used as the evaluation metric (see Section 2). We found the combination of features in general performed better than most of the individual feature types and achieved the best classification performance in 11 out of the 16 datasets, suggesting the complementarity of the feature types.</p>
      <p>We next benchmarked the runtime and memory requirements of the feature types on single-cell scRNA-seq (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5a</xref>), spatial proteomics (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5b</xref>), as well as spot-based spatial transcriptomics datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5c</xref>) for evaluating both the single-cell RNA-sequencing implementation and the spot-based implementation. All datasets contain 1000 to 100 000 cells. On the largest datasets with 100 000 cells, the majority of feature types took less than a minute to compute when executed on eight cores, demonstrating that scFeatures is highly scalable to large datasets. As expected, there was some trade-off between processing time and memory. As a result of parallel computation over eight cores, some feature types required more than 10GB of RAM in total; however, users can run on a single core to reduce the memory requirement.</p>
    </sec>
    <sec>
      <title>3.3 The most informative feature types differ between different datasets</title>
      <p>We hypothesized that distinct feature types would be informative for different datasets since each dataset comprises samples with varying characteristics and disease outcomes. Several datasets were used where each feature type was evaluated on its ability to predict disease outcome and the observations were in alignment with our hypothesis. First, we used a lung disease dataset collection (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>) where the cells were split into the epithelial, immune and fibroblast subsets and the outcome of interest was to classify the individuals into healthy or idiopathic pulmonary fibrosis (IPF). In <xref rid="btac590-F3" ref-type="fig">Figure 3a</xref>, we visualized the classification performance of the feature types on the three subsets and ordered the feature types according to their performance in the epithelial subsets. This reveals that feature types related to cell type proportions (i.e. ‘proportion ratio’, ‘proportion logit’ and ‘proportion raw’) achieved the highest accuracy in the epithelial subset (<xref rid="btac590-F3" ref-type="fig">Fig. 3a</xref>). In contrast, the performance of feature types on the immune and fibroblast subsets did not follow the same trend as on the epithelial subset, demonstrating that different feature types are useful for the three datasets.</p>
      <fig position="float" id="btac590-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Performance of feature types on patient outcomes. (<bold>a</bold>) The epithelial, fibroblast and immune subsets of healthy and IPF individuals, where the outcome of interest is classifying healthy and IPF status. The feature types are ordered by their F1 scores on the epithelial subset. (<bold>b</bold>) Pre-treatment and post-treatment melanoma patients, where the outcome of interest is classifying therapy responders and non-responders. The feature types are ordered by the difference of the F1 scores between the two datasets. (<bold>c</bold>) For each of the 17 datasets, the squares denote the top five feature types with the highest F1 scores</p>
        </caption>
        <graphic xlink:href="btac590f3" position="float"/>
      </fig>
      <p>Similar observations were also found in the melanoma pre-treatment dataset and melanoma post-treatment dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>) where the question of interest was classifying non-responders and responders. This revealed that proportion features (i.e. ‘proportion raw’ and ‘proportion logit’) more accurately classified individuals in the post-treatment dataset than in the pre-treatment dataset, while pathway features (i.e. ‘pathway gsva’ and ‘pathway proportion’) provided higher classification accuracy for pre-treated individuals (<xref rid="btac590-F3" ref-type="fig">Fig. 3</xref>).</p>
      <p>We then examined 17 datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>) and highlighted the five informative feature types for each dataset (<xref rid="btac590-F3" ref-type="fig">Fig. 3c</xref>) for a more comprehensive assessment of the performance of the feature types. Across the 17 datasets tested, ‘gene mean celltype’, which examines expression in cell type specific manner, occurred in 10 datasets as the top five informative feature types. This is perhaps not surprising, as it elucidates the power of single-cell technology to profile the cell type specific expression to uncover changes in response to diseases. Across the spatial datasets, we saw feature types in the spatial feature category appeared as the top five informative feature types, indicating the effectiveness of this category to capture spatial information and the potential of spatial data modality to offer complementary information. Altogether, these findings highlight that different feature types are useful for exploring disease mechanisms in different datasets and even in different subsets of the same dataset, as seen by the pre- and post-treatment melanoma datasets and the lung disease dataset subset by cell types, and argue for the need for a diverse compendium of feature types for such analyses.</p>
    </sec>
    <sec>
      <title>3.4 scFeatures provides interpretable insight into disease outcomes from scRNA-seq data</title>
      <p>To illustrate that scFeatures provides interpretable features for the understanding of diseases, we applied scFeatures to the ‘UC healthy versus non-inflamed (Fib)’ dataset (<xref rid="btac590-B30" ref-type="bibr">Smillie <italic toggle="yes">et al.</italic>, 2019</xref>). This scRNA-seq dataset compares fibroblast cells of non-inflamed biopsies from ulcerative colitis (UC) individuals with biopsies from healthy individuals. We focused on the two top performing feature types of ‘gene mean celltype’ and ‘proportion raw’ based on the classification model performance from the previous section (<xref rid="btac590-F3" ref-type="fig">Fig. 3c</xref>) and discovered different sets of cell types were important to the two feature types. In particular, for the feature type based on cell type specific gene expression (denoted by ‘gene mean celltype’), the fourth-ranked cell type according to feature importance score (see Section 2) was WNT5B+ 2 (<xref rid="btac590-F4" ref-type="fig">Fig. 4a</xref>). This cell type was ranked as the 11th cell type in terms of the differences in cell type proportion (denoted by ‘proportion raw’) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>), indicating that while the gene expression was different between disease outcomes, the proportion of cell types was similar. In contrast, glia was ranked first in terms of gene expression and second in terms of cell type proportion. These two feature types offer different perspectives from the same data and reveal distinct collections of cell types where one group is more concerned with changes in expression and the other collection is more concerned with changes in proportion. It would have been challenging or impossible to accurately disentangle the contributions of cell type percentage and cell specific gene expression in classical bulk gene expression data. These observations not only highlight the necessity of single-cell research, but also emphasize the importance of evaluating various feature types, as generated by scFeatures.</p>
      <fig position="float" id="btac590-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Selected features generated on the ‘UC healthy versus non-inflamed (Fib)’ dataset and the ‘triple negative breast cancer’ datasets. (<bold>a</bold>) Scatterplot of cell type rank for the feature type ‘cell type proportion’ and ‘gene mean celltype’. (<bold>b</bold>) Heatmap showing the clustering result using the nearest neighbour correlation. (<bold>c</bold>) Kaplan–Meier plot of individuals stratified by the clustering output (top) and stratified by patient groups defined in the original study (bottom)</p>
        </caption>
        <graphic xlink:href="btac590f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 scFeatures uncovers data features associated with survival outcomes from spatial proteomics</title>
      <p>To demonstrate the utility of scFeatures at extracting spatial information, we applied scFeatures to a spatial proteomics dataset of tumours from triple negative breast cancer individuals (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The question of interest is classifying tumours based on cellular organization into distinct types that are associated with patient survival. The original study defined three tumour groups based on mixing scores, where a ‘cold group’ is identified by low immune infiltrate, a ‘compartmentalised group’ is identified by compartments formed by almost entirely of either tumour or immune cells, and a ‘mixed group’ is when there is no clear boundary separating the tumour and immune cells.</p>
      <p>The nearest neighbour correlation is a feature type in scFeatures that was created primarily to capture spatial co-expression patterns. It computes the correlation of a cell's protein expression with that of its nearest neighbour. Therefore, spatial organization of cells, such as whether tumour cells are next to immune cells would affect the correlation of protein expression of cells with neighbouring cells. To construct this feature type, we used scFeatures on selected ‘triple negative breast cancer’ samples from the dataset and clustered the resulting features (<xref rid="btac590-F4" ref-type="fig">Fig. 4b</xref>). Survival analysis using the Kaplan–Meier Curve revealed differences between survival outcomes of individuals from the two clusters (<italic toggle="yes">P</italic>-value of 0.07, <xref rid="btac590-F4" ref-type="fig">Fig. 4c</xref>), compared to the patient group defined in the original study with <italic toggle="yes">P</italic>-value of 0.22. This suggests that the new patient subgroup found by scFeatures has greater association with the survival outcomes and demonstrates the ability of the spatial feature category to represent spatial organizations and uncover novel patterns in the data.</p>
    </sec>
    <sec>
      <title>3.6 scFeatures automatically generates an HTML file that reports features most associated with conditions to facilitate interpretable discoveries</title>
      <p>One of the most commonly investigated questions by researchers is what features are most associated with disease conditions. We implemented a function within scFeatures that takes generated features as input and automatically performs a series of association studies for each feature type, producing an HTML report as the output. An example of a comprehensive HTML report can be found on our Github (<ext-link xlink:href="https://github.com/SydneyBioX/scFeatures" ext-link-type="uri">https://github.com/SydneyBioX/scFeatures</ext-link>). The HTML report includes a variety of visual summaries to aid the downstream interpretation of features. Here, we used the ‘COVID’ dataset to identify features associated with disease severity and illustrate a selected panel of visual summaries (<xref rid="btac590-F5" ref-type="fig">Fig. 5</xref>). The composition plot visualized the features from ‘cell type proportion raw’ (<xref rid="btac590-F5" ref-type="fig">Fig. 5a</xref>) and revealed that many cell types underwent drastic change between mild and severe conditions. The pathway enrichment plots (<xref rid="btac590-F5" ref-type="fig">Fig. 5b</xref>) summarized that, in the rare cell type plasmablasts, genes associated with severe condition were enriched in immune pathways. Heatmap is used to visualize the difference between conditions that can be expressed numerically. The heatmap on feature type ‘CCI’ revealed that the cell-cell interactions in most pairs of cell types increased in severe patients compared to mild patients (<xref rid="btac590-F5" ref-type="fig">Fig. 5c</xref>). Overall, the association study and visual summaries provided by the HTML facilitate a more focused exploration of features for further analysis.</p>
      <fig position="float" id="btac590-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Selected visualization summaries from the HTML report. The ‘COVID’ dataset containing mild and severe COVID-19 patients was used to show a subset of visualization summaries from the association analysis report. (<bold>a</bold>) Composition plot of the ‘cell type proportion raw’ features in mild and severe patients. (<bold>b</bold>) Enriched pathways of the top 200 features associated with the plasmoblasts of severe patients. Pathway enrichment in the left plot was calculated based on features from ‘cell type specific mean expression’. Pathway enrichment in the right plot was calculated based on features from ‘cell type specific mean proportion’. Similar pathway terms were grouped by hierarchical clustering. (<bold>c</bold>) Heatmap shows the difference in the number of CCI features between mild and severe patients. Positive number indicates more interactions in the mild patients and negative number indicates more interactions in the severe patients</p>
        </caption>
        <graphic xlink:href="btac590f5" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion and conclusion</title>
    <p>In summary, scFeatures creates a multi-view molecular representation of individuals by generating tens of thousands of interpretable features based on single-cell and spot-based spatial data. The innovation and motivation of scFeatures lie in the generation of various literature motivated and biologically relevant feature vectors for phenotype disease modelling and disease prediction. We have designed 17 feature types across six categories based on a broad range of analytical approaches in literature from cell type specific gene expression to measures of cell-cell (ligand-receptor co-expression) interaction and demonstrated that the feature types are diverse with low correlation amongst them. We illustrated scFeatures on scRNA-seq data from ulcerative colitis and discovered a number of features linked with disease characteristics. scFeatures is also able to extract spatial features from a triple negative breast cancer proteomics data, resulting in the stratification of tumours that are more strongly related to survival outcomes than the original study’s subgroups. Through the automatic report generation that highlights features most associated with disease, scFeatures supports ease of feature exploration.</p>
    <p>The features vector generated by scFeatures can be used for a broader set of downstream applications and is not limited to the ones illustrated in the case studies. For example, given the feature vectors are generated at the sample level, this provides the opportunity for the exploration of differential patient responses to diseases due to heterogeneity between individuals. Even amongst those recorded as responders to treatment, the extent of response and the change at omics level vary between individuals. The feature vector can be subjected to latent class analysis, which has typically been applied on single-cell level to explore cellular diversity (<xref rid="btac590-B7" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac590-B6" ref-type="bibr">Buettner <italic toggle="yes">et al.</italic>, 2017</xref>) and to enable detection of sub-populations in the cohort, as well as the biology driving patient heterogeneity. Given that scFeatures creates a representation for each patient, this also enables the integrative analysis of patients across multiple datasets to increase the power of analysis and to expand the range of questions that can be asked. Batch correction methods, such as scMerge (<xref rid="btac590-B18" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2019</xref>) and Harmony (<xref rid="btac590-B14" ref-type="bibr">Korsunsky <italic toggle="yes">et al.</italic>, 2019</xref>), may be needed in this case to remove the unwanted technical variation due to datasets.</p>
    <p>The multiple feature types generated by scFeatures can be considered as multiple views of the data and as such, lead naturally to multi-view learning. This is one of the many collections of methods that perform integration across multiple feature classes to enhance model performance. There exist many approaches for data integration (<xref rid="btac590-B15" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2018</xref>), from the simple concatenation of features from all feature types into a single vector as the input, to incorporating and optimizing the procedure within the model training process. While current multi-view learning in bioinformatics typically refers to the use of multiple omics obtained from the same sample (<xref rid="btac590-B23" ref-type="bibr">Nguyen and Wang, 2020</xref>), we envisage the generation of multiple feature types by scFeatures opens new opportunities for multi-view learning for single omic type.scFeatures is currently designed to perform feature engineering for single-cell RNA-seq, spatial proteomics and spatial transcriptomics data, but the framework is not limited to these platforms. Taking chromatin accessibility as an example, a commonly used analysis strategy is assigning genes based on nearby peaks, thereby converting the peak matrix to a matrix of gene activity scores similar to gene expressions (<xref rid="btac590-B5" ref-type="bibr">Baek and Lee, 2020</xref>). Using this approach, all feature types designed for scRNA-seq are then applicable to chromatin accessibility data. In future, we plan to extend scFeatures to other single-cell omics such as single-cell DNA methylation, single-cell chromatin accessibility and single-cell genomics, leveraging the common analytical approach in these omics and constructing specific feature types. For chromatin accessibility, the co-accessibility between pairs of peaks, which is used to predict cis-regulatory interactions, can be constructed and stored as a vector for each sample. The correlation values between transcription factors (TF) motifs can be readily constructed as another class of feature representation vector, and can be used to identify the modules of TF motifs affected in disease state.</p>
    <p>With the recent surge of cohort based single-cell studies and the number of tools for characterizing individual cells, there is an increased demand for defining samples in a study based on their cellular characterization to guide better understanding of disease and health. Here, we present scFeatures, a tool that provides a multi-view extraction of molecular features from single-cell and spot-based spatial data to characterize cellular features of each individual. scFeatures efficiently extracts collections of interpretable features from large-scale data and derives biological insights in both scRNA-seq and spatial data. We envision that scFeatures, a public R package available at <ext-link xlink:href="https://github.com/SydneyBioX/scFeatures" ext-link-type="uri">https://github.com/SydneyBioX/scFeatures</ext-link>, will facilitate better understanding of single-cell data from a sample (i.e. patient) perspective and the signatures underlying disease conditions from different angles.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac590_Supplementary_Data</label>
      <media xlink:href="btac590_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>The authors would like to thank all their colleagues at The University of Sydney, School of Mathematics and Statistics, for their intellectual engagement and constructive feedback. In particular, we would like to acknowledge Shila Ghazanfar for her valuable feedback toward the manuscript.</p>
    <sec>
      <title>Author contributions</title>
      <p>J.Y.H.Y., P.Y. and Y.C conceived the study. Y.C. performed the experiments with input from Y.L. and E.P. and interpreted the results with input from all authors. All authors wrote, read and approved the final manuscript.</p>
    </sec>
    <sec>
      <title>Funding</title>
      <p>This study was made possible in part by Australia National Health and Medical Research Council (NHMRC) Investigator Grant [APP1173469 to P.Y.]; AIR@innoHK programme of the Innovation and Technology Commission of Hong Kong, Australia NHMRC Career Developmental Fellowship [APP1111338 to P.Y. and J.Y.H.Y.]; Australian Research Council Discovery Early Career Researcher Award [DE200100944] funded by the Australian Government. to E.P.; Research Training Program Tuition Fee Offset and University of Sydney Postgraduate Award Stipend Scholarship to Y.C.; Research Training Program Tuition Fee Offset and Stipend Scholarship and Chen Family Research Scholarship to Y.L.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
    <sec sec-type="data-availability">
      <title>Data availability</title>
      <p>All data used in this study are publicly available. The accession links are reported in the Section 2.</p>
    </sec>
    <sec>
      <title>Code availability</title>
      <p>scFeatures is publicly available as an R package at <ext-link xlink:href="https://github.com/SydneyBioX/scFeatures" ext-link-type="uri">https://github.com/SydneyBioX/scFeatures</ext-link>.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac590-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelaal</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>194</fpage>.<pub-id pub-id-type="pmid">31500660</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adams</surname><given-names>T.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Single-cell RNA-seq reveals ectopic and aberrant lung-resident cell populations in idiopathic pulmonary fibrosis</article-title>. <source>Sci. Adv</source>., <volume>6</volume>, <fpage>eaba1983</fpage>.<pub-id pub-id-type="pmid">32832599</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Armingol</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Deciphering cell–cell interactions and communication from gene expression</article-title>. <source>Nat. Rev. Genet</source>., <volume>22</volume>, <fpage>71</fpage>–<lpage>88</lpage>.<pub-id pub-id-type="pmid">33168968</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baek</surname><given-names>S.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>I.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Single-cell ATAC sequencing analysis: from data preprocessing to hypothesis generation</article-title>. <source>Comput. Struct. Biotechnol. J</source>., <volume>18</volume>, <fpage>1429</fpage>–<lpage>1439</lpage>.<pub-id pub-id-type="pmid">32637041</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buettner</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>f-scLVM: scalable and versatile factor analysis for single-cell RNA-seq</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>212</fpage>.<pub-id pub-id-type="pmid">29115968</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Latent cellular analysis robustly reveals subtle diversity in large-scale single-cell RNA-seq data</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>e143</fpage>.<pub-id pub-id-type="pmid">31566233</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jin</surname><given-names>S.</given-names></string-name>, <string-name><surname>Ramos</surname><given-names>R.</given-names></string-name></person-group> (<year>2022</year>) <article-title>Computational exploration of cellular communication in skin from emerging single-cell and spatial transcriptomic data</article-title>. <source>Biochem. Soc. Trans</source>., <volume>50</volume>, <fpage>297</fpage>–<lpage>308</lpage>.<pub-id pub-id-type="pmid">35191953</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keren</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>MIBI-TOF: a multiplexed imaging platform relates cellular phenotypes and tissue structure</article-title>. <source>Sci. Adv</source>., <volume>5</volume>, <fpage>eaax5851</fpage>.<pub-id pub-id-type="pmid">31633026</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>H.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Uncovering cell identity through differential stability with Cepo</article-title>. <source>Nat. Comput. Sci</source>., <volume>1</volume>, <fpage>784</fpage>–<lpage>790</lpage>.</mixed-citation>
    </ref>
    <ref id="btac590-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korsunsky</surname><given-names>I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Fast, sensitive and accurate integration of single-cell data with harmony</article-title>. <source>Nat. Methods</source>, <volume>16</volume>, <fpage>1289</fpage>–<lpage>1296</lpage>.<pub-id pub-id-type="pmid">31740819</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>A review on machine learning principles for multi-view biological data integration</article-title>. <source>Brief. Bioinform</source>., <volume>19</volume>, <fpage>325</fpage>–<lpage>340</lpage>.<pub-id pub-id-type="pmid">28011753</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liberzon</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>The Molecular Signatures Database (MSigDB) hallmark gene set collection</article-title>. <source>Cell Syst</source>., <volume>1</volume>, <fpage>417</fpage>–<lpage>425</lpage>.<pub-id pub-id-type="pmid">26771021</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>W.N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>The role of single-cell technology in the study and control of infectious diseases</article-title>. <source>Cells</source>, <volume>9</volume>, <fpage>1440</fpage>.</mixed-citation>
    </ref>
    <ref id="btac590-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>scMerge leverages factor analysis, stable expression, and pseudoreplication to merge multiple single-cell RNA-seq datasets</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>116</volume>, <fpage>9775</fpage>–<lpage>9784</lpage>.<pub-id pub-id-type="pmid">31028141</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Longo</surname><given-names>S.K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Integrating single-cell and spatial transcriptomics to elucidate intercellular tissue dynamics</article-title>. <source>Nat. Rev. Genet</source>., <volume>22</volume>, <fpage>627</fpage>–<lpage>644</lpage>.<pub-id pub-id-type="pmid">34145435</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maleki</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Gene set analysis: challenges, opportunities, and future research</article-title>. <source>Front. Genet</source>., <volume>11</volume>, <fpage>654</fpage>.<pub-id pub-id-type="pmid">32695141</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maniatis</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Spatiotemporal dynamics of molecular pathology in amyotrophic lateral sclerosis</article-title>. <source>Science</source>, <volume>364</volume>, <fpage>89</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">30948552</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nguyen</surname><given-names>N.D.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>D.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Multiview learning for understanding functional multiomics</article-title>. <source>PLoS Comput. Biol</source>., <volume>16</volume>, <fpage>e1007677</fpage>.<pub-id pub-id-type="pmid">32240163</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sade-Feldman</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Defining T cell states associated with response to checkpoint immunotherapy in melanoma</article-title>. <source>Cell</source>, <volume>176</volume>, <fpage>404</fpage>.<pub-id pub-id-type="pmid">30633907</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saelens</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>A comparison of single-cell trajectory inference methods</article-title>. <source>Nat. Biotechnol</source>., <volume>37</volume>, <fpage>547</fpage>–<lpage>554</lpage>.<pub-id pub-id-type="pmid">30936559</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saiselet</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Transcriptional output, cell-type densities, and normalization in spatial transcriptomics</article-title>. <source>J. Mol. Cell Biol</source>., <volume>12</volume>, <fpage>906</fpage>–<lpage>908</lpage>.<pub-id pub-id-type="pmid">32573704</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sathyamurthy</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Massively parallel single nucleus transcriptional profiling defines spinal cord neurons and their activity during behavior</article-title>. <source>Cell Rep</source>., <volume>22</volume>, <fpage>2216</fpage>–<lpage>2225</lpage>.<pub-id pub-id-type="pmid">29466745</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schulte-Schrepping</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal>; <collab>Deutsche COVID-19 OMICS Initiative (DeCOI)</collab>. (<year>2020</year>) <article-title>Severe COVID-19 is marked by a dysregulated myeloid cell compartment</article-title>. <source>Cell</source>, <volume>182</volume>, <fpage>1419</fpage>–<lpage>1440.e23</lpage>.<pub-id pub-id-type="pmid">32810438</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smillie</surname><given-names>C.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Intra- and inter-cellular rewiring of the human colon during ulcerative colitis</article-title>. <source>Cell</source>, <volume>178</volume>, <fpage>714</fpage>–<lpage>730.e22</lpage>.<pub-id pub-id-type="pmid">31348891</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stegle</surname><given-names>O.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Computational and analytical challenges in single-cell transcriptomics</article-title>. <source>Nat. Rev. Genet</source>., <volume>16</volume>, <fpage>133</fpage>–<lpage>145</lpage>.<pub-id pub-id-type="pmid">25628217</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strbenac</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>ClassifyR: an R package for performance assessment of classification with applications to transcriptomics</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>1851</fpage>–<lpage>1853</lpage>.<pub-id pub-id-type="pmid">25644269</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2005</year>) <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>102</volume>, <fpage>15545</fpage>–<lpage>15550</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>K.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Tools for the analysis of high-dimensional single-cell RNA sequencing data</article-title>. <source>Nat. Rev. Nephrol</source>., <volume>16</volume>, <fpage>408</fpage>–<lpage>421</lpage>.<pub-id pub-id-type="pmid">32221477</pub-id></mixed-citation>
    </ref>
    <ref id="btac590-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Feature selection revisited in the single-cell era</article-title>. <source>Genome Biol</source>., <volume>22</volume>, <fpage>321</fpage>.<pub-id pub-id-type="pmid">34847932</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
