<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.5.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art550.dtd?>
<?SourceDTD.Version 5.5.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_ISCI26 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEfx1 jpg ?>
<?FILEmmc1 pdf ?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">iScience</journal-id>
    <journal-id journal-id-type="iso-abbrev">iScience</journal-id>
    <journal-title-group>
      <journal-title>iScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2589-0042</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5993205</article-id>
    <article-id pub-id-type="publisher-id">S2589-0042(18)30026-9</article-id>
    <article-id pub-id-type="doi">10.1016/j.isci.2018.03.017</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>OpenHiCAMM: High-Content Screening Software for Complex Microscope Imaging Workflows</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Booth</surname>
          <given-names>Benjamin W.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McParland</surname>
          <given-names>Charles</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Beattie</surname>
          <given-names>Keith</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fisher</surname>
          <given-names>William W.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hammonds</surname>
          <given-names>Ann S.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Celniker</surname>
          <given-names>Susan E.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Frise</surname>
          <given-names>Erwin</given-names>
        </name>
        <email>erwin@fruitfly.org</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="fn1" ref-type="fn">3</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
    </contrib-group>
    <aff id="aff1"><label>1</label>Biological Systems and Engineering Division, Lawrence Berkeley National Laboratory, Berkeley, CA 94720, USA</aff>
    <aff id="aff2"><label>2</label>Computer Science Research Division, Lawrence Berkeley National Laboratory, Berkeley, CA 94720, USA</aff>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding author <email>erwin@fruitfly.org</email></corresp>
      <fn id="fn1">
        <label>3</label>
        <p id="ntpara0010">Lead Contact</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <day>27</day>
      <month>4</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <volume>2</volume>
    <fpage>136</fpage>
    <lpage>140</lpage>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>11</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>8</day>
        <month>2</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>3</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2018 The Authors</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="CC BY" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <title>Summary</title>
      <p>High-content image acquisition is generally limited to cells grown in culture, requiring complex hardware and preset imaging modalities. Here we report an open source software package, OpenHiCAMM (Open Hi Content Acquisition for μManager), that provides a flexible framework for integration of generic microscope-associated robotics and image processing with sequential workflows. As an example, we imaged <italic>Drosophila</italic> embryos, detecting the embryos at low resolution, followed by re-imaging the detected embryos at high resolution, suitable for computational analysis and screening. The OpenHiCAMM package is easy to use and adapt for automating complex microscope image tasks. It expands our abilities for high-throughput image-based screens to a new range of biological samples, such as organoids, and will provide a foundation for bioimaging systems biology.</p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0015">
      <title>Graphical Abstract</title>
      <fig id="undfig1" position="anchor">
        <graphic xlink:href="fx1"/>
      </fig>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">OpenHiCAMM is an open source software that integrates robotics and image acquisition</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">OpenHiCAMM is a module for the Fiji/ImageJ and μManager software packages</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">OpenHiCAMM tracks images on multiple slides and controls an optional slide loader</p>
          </list-item>
          <list-item id="u0025">
            <label>•</label>
            <p id="p0025">OpenHiCAMM is easily adapted for high-throughput screening and image analysis</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0025">
      <p>Optical Imaging; Technical Aspects of Cell Biology; Bioinformatics</p>
    </abstract>
    <kwd-group id="kwrds0010">
      <title>Subject Areas</title>
      <kwd>Optical Imaging</kwd>
      <kwd>Technical Aspects of Cell Biology</kwd>
      <kwd>Bioinformatics</kwd>
    </kwd-group>
  </article-meta>
  <notes>
    <p id="misc0010">Published: April 27, 2018</p>
  </notes>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p id="p0030">Large-scale genome sequencing has rapidly facilitated the investigation and analysis of gene and protein functions and interactions. Efforts to interpret sequence data and to understand how they are used to control cellular, tissue, or organ system development have quickly revealed the limitations in our molecular understanding of multicellular organisms. Spatial gene expression is important for understanding the events that are necessary for the development of metazoans, and large-scale studies are underway for a number of species (e.g., <xref rid="bib6" ref-type="bibr">Hammonds et al., 2013</xref>, <xref rid="bib8" ref-type="bibr">Lein et al., 2007</xref>, <xref rid="bib14" ref-type="bibr">Pollet et al., 2005</xref>, <xref rid="bib18" ref-type="bibr">Tabara et al., 1996</xref>). Indeed, even the existence of uniform cells or tissues has been questioned, and their variance has been masked by single measurements (<xref rid="bib9" ref-type="bibr">Levsky and Singer, 2003</xref>).</p>
    <p id="p0035">High-content screening (HCS) is routinely used in cell culture imaging, pharmaceutical drug discovery, genome-wide RNA interference (RNAi), and CRISPR (<xref rid="bib2" ref-type="bibr">Boutros et al., 2015</xref>). Commercial equipment is readily available (<xref rid="bib21" ref-type="bibr">Zanella et al., 2010</xref>) and able to scan multi-well plates and slides. Commercial automated microscopes are integrated packages of robotics, microscope, and software, limiting possible customizations, especially for well-suited existing microscope systems. Imaging is done in a single pass, requiring a compromise between resolution and field depth. For single cell samples, this means a tradeoff between resolution and cell density. Transient transfections may not have sufficient cell transfection density for high-resolution imaging. For larger samples, such as histological sections, organoids, or whole-mount samples of model organisms or tissues, specimens need to be tiled at low resolution or placed at a predefined position.</p>
    <p id="p0040">We describe new software for high-throughput imaging, specifically designed to automate image acquisition that requires multi-step workflows contingent on image analysis and multiple imaging modalities. The software, OpenHiCAMM (Open Hi Content Acquisition for μManager) controls optical microscopes and interfaces with an automated slide loader to perform fully automated HCS.</p>
  </sec>
  <sec id="sec2">
    <title>Results</title>
    <p id="p0045">We developed OpenHiCAMM as a module for the popular open source bioimage analysis package Fiji (<xref rid="bib16" ref-type="bibr">Schindelin et al., 2012</xref>) and microscope hardware control μManager (<xref rid="bib5" ref-type="bibr">Edelstein et al., 2010</xref>). OpenHiCAMM utilizes μManager for its broad support of microscopes, components, and cameras and its flexible slide acquisition. For advanced image analysis, our modules use Fiji's software components. Other existing μManager extensions are designed for thorough exploration of single samples (<xref rid="bib12" ref-type="bibr">Pinkard et al., 2016</xref>, <xref rid="bib13" ref-type="bibr">Pitrone et al., 2013</xref>), whereas our software is designed to process large sample sets.</p>
    <p id="p0050">The core of OpenHiCAMM is a sophisticated workflow manager that executes modules operating the robotic hardware, performing the imaging and processing the data (<xref rid="mmc1" ref-type="supplementary-material">Table S1</xref>, <xref rid="mmc1" ref-type="supplementary-material">Figure S3</xref> and <xref rid="mmc1" ref-type="supplementary-material">Tables S2–S4</xref>). In the spirit of Fiji and μManager, we designed a high-quality, open and extensible Java core. The workflow manager executes microscope-dependent modules sequentially and computational processing modules in parallel. OpenHiCAMM uses an integrated SQL database engine for persistent storage of workflow setups, for module configurations, and for recording completed tasks, thus allowing for recovery from operational hardware problems and stopping or resuming interrupted workflows. Both the database files and the image files, in standard μManager file and directory format, are stored in a user-selectable local or remote disk destination (<xref rid="fig1" ref-type="fig">Figure 1</xref>).<fig id="fig1"><label>Figure 1</label><caption><p>Microscope Setup and OpenHiCAMM Results</p><p>(A) Microscope with motorized stage (on the right) and the automated slide loader (on the left).</p><p>(B) Main dialog box for OpenHiCAMM, showing the workflow storage directory in use, tabs allowing user configuration options and access to reports and logs. See also <xref rid="mmc1" ref-type="supplementary-material">Figure S10–S14</xref>.</p><p>(C and D) Excerpts of the OpenHiCAMM report. (C) Image of a processed slide, stitched by stage position and the automated detection of regions of interest (ROI) shown boxed in red. (D) Screenshot from the report page showing the results for one detected ROI; (left) the image at 5× magnification, (middle) the image at 20× magnification superimposed by relative position, (right) the final image at 20× magnification stitched with the Fiji's algorithm (red arrows indicate the stitching position). See also <xref rid="mmc1" ref-type="supplementary-material">Figure S1</xref>.</p></caption><graphic xlink:href="gr1"/></fig></p>
    <p id="p0055">To automate slide handling for HCS, we developed a slide management module, SlideLoader, which tracks the slides and either interfaces with a hardware slide loader or, for semi-automatic imaging without the slide loader, prompts the user to place the slide on the stage. SlideLoader can be used multiple times in the same workflow, allowing for loading and imaging slides repeatedly. This design allows for changing image modalities and manual adjustments of the microscope between each imaging pass. Loading slides multiple times may result in possible offsets to the slide position on the stage. To correct for these offsets, we developed modules for calibrating the stage position using the location-invariant edge between the frosted end and the adjacent transparent glass in commercially available slides (<xref rid="mmc1" ref-type="supplementary-material">Figures S4</xref> and <xref rid="mmc1" ref-type="supplementary-material">S5</xref>).</p>
    <p id="p0060">Imaging of the slide is performed by the SlideImager module, which is a wrapper for μManager's Multi-D acquisition and thus able to use all capabilities of μManager, including selectable light filters and stacks along the z axis. If an area exceeds the size of a single camera snapshot, multiple tiled images are acquired and post-processed with Fiji image stitching to assemble a composite image (<xref rid="bib15" ref-type="bibr">Preibisch et al., 2009</xref>) (<xref rid="fig1" ref-type="fig">Figure 1</xref>D). To increase the acquisition rate, we developed a fast custom autofocus plugin (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>).</p>
    <p id="p0065">In our initial implementation, we developed a workflow and modules optimized for imaging slides containing whole-mount <italic>Drosophila</italic> embryos with gene expression patterns detected by <italic>in situ</italic> mRNA hybridization (<xref rid="bib20" ref-type="bibr">Weiszmann et al., 2009</xref>). We assembled an HCS microscope platform with a Prior PL-200 slide loader, a Zeiss Axioplan 2 motorized microscope, a Nikon DSLR D5100 camera, and a Prior motorized stage (<xref rid="fig1" ref-type="fig">Figure 1</xref>B). We selected differential interference contrast (DIC) microscopy for capturing both probe staining and sample morphology in a single image, thus making it particularly well suited to high-throughput analysis of tissue or organisms and for studying ontogeny, such as the developing <italic>Drosophila</italic> embryo (<xref rid="bib7" ref-type="bibr">Hartenstein and Campos-Ortega, 1997</xref>). We designed the workflow to image <italic>Drosophila</italic> embryos with two imaging modalities (<xref rid="mmc1" ref-type="supplementary-material">Figure S9</xref>). For the first pass (Phase 1), we calibrated the microscope for a 5× objective. We ran the workflow to first image manually selected areas of the slide occupied by the coverslip as tiled images, followed by an image analysis module to capture the coordinates of the detected embryos (<xref rid="mmc1" ref-type="supplementary-material">Figures S7</xref> and <xref rid="mmc1" ref-type="supplementary-material">S8</xref>). After completion of the first pass, we manually adjusted the microscope, moving to a 20× objective, and resumed the workflow at the second entry point (Phase 2). The workflow re-loads the slides and re-images the detected embryos at higher magnification.</p>
    <p id="p0070">To assess the performance, we measured the precision and speed of the imaging process. We manually created imaging objects on slides with a permanent marker, performed the imaging workflow, and manually superimposed the objects. The average displacement was 0.059 μm, about 1.5% of the image at 20× magnification (<xref rid="mmc1" ref-type="supplementary-material">Figure S5</xref>). On average, the tiling at 5× took 2.3 s/image and the detection of twenty-five 20× images, including a focus step, took 12 s/image. At 5× magnification, the slides can be covered with 200–300 tiles, resulting in a rate of about 12 min/ slide. The second-phase high-resolution imaging with 20× magnification takes about 20 min for each 100 detected objects. Imaging the slide with high resolution at 20× would take over 3,000–6,500 images. Thus with approximately 300 embryos per slide, our imaging strategy achieved a more than 10-fold speedup.</p>
    <p id="p0075">To demonstrate OpenHiCAMM's ability for autonomously completing an HCS experiment, we used the workflow to image 95 slides made from a 96-well plate experiment (<xref rid="mmc1" ref-type="supplementary-material">Figure S1</xref>). For the low-resolution pass, we selected a slide area with 180 tiles. Low-resolution imaging was completed in about 12 hr or at a rate of 8 min/ slide and yielded 26–751 objects (continuous areas containing one or multiple embryos) per slide. In the second pass, we obtained high-resolution images for embryos with imaging times ranging from 39 min (61 objects with 119 images) to 113 min (334 objects within 573 images) for 90% of the slides excluding those at the tails of the distribution (too few or too many embryos per slide).</p>
    <p id="p0080">For cases that rely only on high-resolution imaging, we developed an additional module, SlideSurveyor, which takes advantage of the camera video feed to rapidly image the slide from live view. We detect objects and re-image with SlideImager. All steps use the same imaging modality, thus limiting alignment problems and user intervention from repeated slide loading. Using SlideSurveyor for Phase 1 at 20× magnification resulted in 20 min/slide, while avoiding slide reloading and changing the objective.</p>
    <p id="p0085">We imaged six additional slides to compare the expression of <italic>Drosophila</italic> embryonic wild-type gene <italic>mirror (mirr)</italic> (<xref rid="bib10" ref-type="bibr">McNeill et al., 1997</xref>) with two intragenic and three intergenic cis-regulatory module (CRM) reporter constructs (<xref rid="bib11" ref-type="bibr">Pfeiffer et al., 2008</xref>) (<xref rid="fig2" ref-type="fig">Figures 2</xref> and <xref rid="mmc1" ref-type="supplementary-material">S2</xref>). For high-quality slides, our workflow acquired between 75% and 85% of the objects on the slide. One slide (GMR33E04) exhibited age-related degradation (low contrast) and detected only 55% of the total objects on the slide. For each slide, we obtained high-quality images representing six stage ranges and two standard orientations as previously described for manual imaging (<xref rid="bib6" ref-type="bibr">Hammonds et al., 2013</xref>). The images obtained from slides containing embryos with CRM constructs were compared with the images obtained from slides containing wild-type embryos. The collected images were of sufficiently high resolution to allow identification of distinct elements of the wild-type pattern driven by different CRMs (<xref rid="fig2" ref-type="fig">Figures 2</xref>B and <xref rid="mmc1" ref-type="supplementary-material">S2</xref>). These results were comparable with those from similar experiments performed using manual imaging (<xref rid="bib11" ref-type="bibr">Pfeiffer et al., 2008</xref>).<fig id="fig2"><label>Figure 2</label><caption><p><italic>Drosophila</italic> Embryonic Images Acquired with OpenHiCAMM</p><p>(A and B) (A) Genomic map of the <italic>mirror (mirr)</italic> locus. (B) Expression of the <italic>mirr</italic> gene in embryonic stages 4–6 (blastoderm), 9–10 (gastrulation), and 13–16 (terminal differentiation) visualized by whole-mount <italic>in situ</italic> hybridization with a probe to <italic>mirr</italic> mRNA shown adjacent to the expression produced by the fragments GMR34C02, GMR34C05, GMR33E04, GMR34C02, and GMR34C05. Transgene expression is visualized by whole-mount <italic>in situ</italic> hybridization with a probe to <italic>GAL4</italic> mRNA. Lateral views are shown, anterior to the left.</p><p>Expression in the foregut anlage in statu nascendi (AISN) is indicated by arrowheads, and expression in the proventriculus is indicated by arrows. Segmental expression apparent at stage 9–10 in the wild-type <italic>mirr</italic> embryos is detectable at stage 4–6 in GMR33C10. Eight images (marked with an asterisk) are composite stitched images from overlapping tiled ROIs. Scale bar, 50 μm.</p><p>See also <xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>.</p></caption><graphic xlink:href="gr2"/></fig></p>
  </sec>
  <sec id="sec3">
    <title>Discussion</title>
    <p id="p0090">Imaging multicellular samples has become increasingly essential for understanding the complexity of medically relevant biology. To our knowledge, no existing tool is capable of multiple-slide autonomous imaging or adapting studies focused on multicellular samples to HCS. OpenHiCAMM adds the abilities to (1) accommodate hardware beyond the microscope itself as demonstrated with the slide loader, (2) handle hardware and software workflows, and (3) track slide contents beyond a single plate/slide setup. To accomplish these goals, we developed a sophisticated task algorithm, capable of resolving hardware and software task dependencies and providing persistence across workflows or interrupted experiments with an SQL database back end. These advances provide the flexibility to adapt workflows currently used for HCS, and material science samples, as well as allow integration of experimental devices, such as flow cells activated by changes computationally recognized in an acquired image.</p>
    <p id="p0095">Imaging cells in 96-well plates is well supported, both commercially and by open source products (<xref rid="bib17" ref-type="bibr">Singh et al., 2014</xref>). OpenHiCAMM expands HCS to sample types for which there is no current solution while providing a robust, self-contained package and a transparent user interface, similar to the Fiji bioimaging package and commercial imaging and microscopy software (e.g., Opera/Operetta by Perkin Elmer). Previously existing tools are implemented as macro packages with only a subset of our software's capabilities (<xref rid="bib5" ref-type="bibr">Edelstein et al., 2010</xref>), or are dependent on external software such as LabView (<xref rid="bib3" ref-type="bibr">Conrad et al., 2011</xref>). As an important advance over a previous workflow design (<xref rid="bib4" ref-type="bibr">Eberle et al., 2017</xref>) implemented in KNIME (<xref rid="bib1" ref-type="bibr">Berthold et al., 2009</xref>), our software enables experiments for a high-content screen on multiple slides or multi-well plates. The commercial Metafer Slide Scanning platform is closest in capabilities but is dependent on a single hardware setup and is solely aimed toward histology content at lower resolutions. Magellan utilizes μManager and serves as a complementary utility for exploration of single-slide 3D samples or could conceivably be adapted as powerful plugin to our software.</p>
    <p id="p0100">Object recognition has been the primary focus of previous works (<xref rid="bib3" ref-type="bibr">Conrad et al., 2011</xref>, <xref rid="bib4" ref-type="bibr">Eberle et al., 2017</xref>, <xref rid="bib19" ref-type="bibr">Tischer et al., 2014</xref>) but is only a relatively insignificant part of our software. We tried to avoid the domain specificity of machine learning by creating an intentionally simple but more generalizable object recognition algorithm, while allowing users to add their own recognition pipeline developed in ImageJ/Fiji and pasted as a macro. More sophisticated machine learning algorithms are easily added with a simple programming interface. In fact, the well-supported KNIME software (<xref rid="bib1" ref-type="bibr">Berthold et al., 2009</xref>) would make a highly complementary plugin to our software for complex image processing workflows to detect specific features in biological samples.</p>
    <p id="p0105">Our workflow framework is robust, flexible, easily adapted, and extendable to other high-throughput robotics tasks that are increasingly common in modern biology, making the OpenHiCAMM package uniquely positioned to provide a foundation for sophisticated high-throughput screens.</p>
  </sec>
  <sec id="sec4">
    <title>Methods</title>
    <p id="p0110">All methods can be found in the accompanying <xref rid="mmc1" ref-type="supplementary-material">Transparent Methods supplemental file</xref>.</p>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Berthold</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Cebron</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Dill</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>T.R.</given-names>
          </name>
          <name>
            <surname>Kötter</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Meinl</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Ohl</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Thiel</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Wiswedel</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>KNIME - the Konstanz information miner: version 2.0 and beyond</article-title>
        <source>SIGKDD Explor. Newsl.</source>
        <volume>11</volume>
        <year>2009</year>
        <fpage>26</fpage>
        <lpage>31</lpage>
      </element-citation>
    </ref>
    <ref id="bib2">
      <element-citation publication-type="journal" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Boutros</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Heigwer</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Laufer</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Microscopy-based high-content screening</article-title>
        <source>Cell</source>
        <volume>163</volume>
        <year>2015</year>
        <fpage>1314</fpage>
        <lpage>1325</lpage>
        <pub-id pub-id-type="pmid">26638068</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <element-citation publication-type="journal" id="sref3">
        <person-group person-group-type="author">
          <name>
            <surname>Conrad</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Wunsche</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>T.H.</given-names>
          </name>
          <name>
            <surname>Bulkescher</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sieckmann</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Verissimo</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Edelstein</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Liebel</surname>
            <given-names>U.</given-names>
          </name>
          <name>
            <surname>Pepperkok</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Micropilot: automation of fluorescence microscopy-based imaging for systems biology</article-title>
        <source>Nat. Methods</source>
        <volume>8</volume>
        <year>2011</year>
        <fpage>246</fpage>
        <lpage>249</lpage>
        <pub-id pub-id-type="pmid">21258339</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Eberle</surname>
            <given-names>J.P.</given-names>
          </name>
          <name>
            <surname>Muranyi</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Erfle</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Gunkel</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Fully automated targeted confocal and single-molecule localization microscopy</article-title>
        <source>Methods Mol. Biol.</source>
        <volume>1663</volume>
        <year>2017</year>
        <fpage>139</fpage>
        <lpage>152</lpage>
        <pub-id pub-id-type="pmid">28924665</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <element-citation publication-type="journal" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Edelstein</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Amodaj</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Hoover</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Vale</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Stuurman</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>Computer control of microscopes using microManager</article-title>
        <source>Curr. Protoc. Mol. Biol.</source>
        <volume>Chapter 14</volume>
        <year>2010</year>
        <comment>Unit14 20</comment>
      </element-citation>
    </ref>
    <ref id="bib6">
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Hammonds</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Bristow</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>W.W.</given-names>
          </name>
          <name>
            <surname>Weiszmann</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Hartenstein</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Frise</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Celniker</surname>
            <given-names>S.E.</given-names>
          </name>
        </person-group>
        <article-title>Spatial expression of transcription factors in <italic>Drosophila</italic> embryonic organ development</article-title>
        <source>Genome Biol.</source>
        <volume>14</volume>
        <year>2013</year>
        <fpage>R140</fpage>
        <pub-id pub-id-type="pmid">24359758</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <element-citation publication-type="book" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Hartenstein</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Campos-Ortega</surname>
            <given-names>J.A.</given-names>
          </name>
        </person-group>
        <chapter-title>The Embryonic Development of <italic>Drosophila melanogaster</italic></chapter-title>
        <edition>Second Edition</edition>
        <year>1997</year>
        <publisher-name>Springer-Verlag Berlin</publisher-name>
      </element-citation>
    </ref>
    <ref id="bib8">
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Lein</surname>
            <given-names>E.S.</given-names>
          </name>
          <name>
            <surname>Hawrylycz</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Ao</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Ayres</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bensinger</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bernard</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Boe</surname>
            <given-names>A.F.</given-names>
          </name>
          <name>
            <surname>Boguski</surname>
            <given-names>M.S.</given-names>
          </name>
          <name>
            <surname>Brockway</surname>
            <given-names>K.S.</given-names>
          </name>
          <name>
            <surname>Byrnes</surname>
            <given-names>E.J.</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide atlas of gene expression in the adult mouse brain</article-title>
        <source>Nature</source>
        <volume>445</volume>
        <year>2007</year>
        <fpage>168</fpage>
        <lpage>176</lpage>
        <pub-id pub-id-type="pmid">17151600</pub-id>
      </element-citation>
    </ref>
    <ref id="bib9">
      <element-citation publication-type="journal" id="sref9">
        <person-group person-group-type="author">
          <name>
            <surname>Levsky</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>R.H.</given-names>
          </name>
        </person-group>
        <article-title>Gene expression and the myth of the average cell</article-title>
        <source>Trends Cell Biol.</source>
        <volume>13</volume>
        <year>2003</year>
        <fpage>4</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="pmid">12480334</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <element-citation publication-type="journal" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>McNeill</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>C.H.</given-names>
          </name>
          <name>
            <surname>Brodsky</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ungos</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>M.A.</given-names>
          </name>
        </person-group>
        <article-title>Mirror encodes a novel PBX-class homeoprotein that functions in the definition of the dorsal-ventral border in the <italic>Drosophila</italic> eye</article-title>
        <source>Genes Dev.</source>
        <volume>11</volume>
        <year>1997</year>
        <fpage>1073</fpage>
        <lpage>1082</lpage>
        <pub-id pub-id-type="pmid">9136934</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <element-citation publication-type="journal" id="sref11">
        <person-group person-group-type="author">
          <name>
            <surname>Pfeiffer</surname>
            <given-names>B.D.</given-names>
          </name>
          <name>
            <surname>Jenett</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hammonds</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Ngo</surname>
            <given-names>T.T.</given-names>
          </name>
          <name>
            <surname>Misra</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Scully</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>J.W.</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>K.H.</given-names>
          </name>
          <name>
            <surname>Laverty</surname>
            <given-names>T.R.</given-names>
          </name>
        </person-group>
        <article-title>Tools for neuroanatomy and neurogenetics in <italic>Drosophila</italic></article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <volume>105</volume>
        <year>2008</year>
        <fpage>9715</fpage>
        <lpage>9720</lpage>
        <pub-id pub-id-type="pmid">18621688</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <element-citation publication-type="journal" id="sref12">
        <person-group person-group-type="author">
          <name>
            <surname>Pinkard</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Stuurman</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Corbin</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Vale</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Krummel</surname>
            <given-names>M.F.</given-names>
          </name>
        </person-group>
        <article-title>Micro-Magellan: open-source, sample-adaptive, acquisition software for optical microscopy</article-title>
        <source>Nat. Methods</source>
        <volume>13</volume>
        <year>2016</year>
        <fpage>807</fpage>
        <lpage>809</lpage>
        <pub-id pub-id-type="pmid">27684577</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <element-citation publication-type="journal" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Pitrone</surname>
            <given-names>P.G.</given-names>
          </name>
          <name>
            <surname>Schindelin</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Stuyvenberg</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Preibisch</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Eliceiri</surname>
            <given-names>K.W.</given-names>
          </name>
          <name>
            <surname>Huisken</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Tomancak</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>OpenSPIM: an open-access light-sheet microscopy platform</article-title>
        <source>Nat. Methods</source>
        <volume>10</volume>
        <year>2013</year>
        <fpage>598</fpage>
        <lpage>599</lpage>
        <pub-id pub-id-type="pmid">23749304</pub-id>
      </element-citation>
    </ref>
    <ref id="bib14">
      <element-citation publication-type="journal" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Pollet</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Muncke</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Verbeek</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Fenger</surname>
            <given-names>U.</given-names>
          </name>
          <name>
            <surname>Delius</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Niehrs</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>An atlas of differential gene expression during early <italic>Xenopus</italic> embryogenesis</article-title>
        <source>Mech. Dev.</source>
        <volume>122</volume>
        <year>2005</year>
        <fpage>365</fpage>
        <lpage>439</lpage>
        <pub-id pub-id-type="pmid">15763213</pub-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <element-citation publication-type="journal" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Preibisch</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Saalfeld</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Tomancak</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Globally optimal stitching of tiled 3D microscopic image acquisitions</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <year>2009</year>
        <fpage>1463</fpage>
        <lpage>1465</lpage>
        <pub-id pub-id-type="pmid">19346324</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <element-citation publication-type="journal" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Schindelin</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Arganda-Carreras</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Frise</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Kaynig</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Longair</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Pietzsch</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Preibisch</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Rueden</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Saalfeld</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Fiji: an open-source platform for biological-image analysis</article-title>
        <source>Nat. Methods</source>
        <volume>9</volume>
        <year>2012</year>
        <fpage>676</fpage>
        <lpage>682</lpage>
        <pub-id pub-id-type="pmid">22743772</pub-id>
      </element-citation>
    </ref>
    <ref id="bib17">
      <element-citation publication-type="journal" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>Singh</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Carpenter</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>Genovesio</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Increasing the content of high-content screening: an overview</article-title>
        <source>J. Biomol. Screen.</source>
        <volume>19</volume>
        <year>2014</year>
        <fpage>640</fpage>
        <lpage>650</lpage>
        <pub-id pub-id-type="pmid">24710339</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <element-citation publication-type="journal" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Tabara</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Motohashi</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Kohara</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>A multi-well version of in situ hybridization on whole mount embryos of <italic>Caenorhabditis elegans</italic></article-title>
        <source>Nucleic Acids Res.</source>
        <volume>24</volume>
        <year>1996</year>
        <fpage>2119</fpage>
        <lpage>2124</lpage>
        <pub-id pub-id-type="pmid">8668544</pub-id>
      </element-citation>
    </ref>
    <ref id="bib19">
      <element-citation publication-type="journal" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>Tischer</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Hilsenstein</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Hanson</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Pepperkok</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Adaptive fluorescence microscopy by online feedback image analysis</article-title>
        <source>Methods Cell. Biol.</source>
        <volume>123</volume>
        <year>2014</year>
        <fpage>489</fpage>
        <lpage>503</lpage>
        <pub-id pub-id-type="pmid">24974044</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <element-citation publication-type="journal" id="sref20">
        <person-group person-group-type="author">
          <name>
            <surname>Weiszmann</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Hammonds</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Celniker</surname>
            <given-names>S.E.</given-names>
          </name>
        </person-group>
        <article-title>Determination of gene expression patterns using high-throughput RNA in situ hybridization to whole-mount <italic>Drosophila</italic> embryos</article-title>
        <source>Nat. Protoc.</source>
        <volume>4</volume>
        <year>2009</year>
        <fpage>605</fpage>
        <lpage>618</lpage>
        <pub-id pub-id-type="pmid">19360017</pub-id>
      </element-citation>
    </ref>
    <ref id="bib21">
      <element-citation publication-type="journal" id="sref21">
        <person-group person-group-type="author">
          <name>
            <surname>Zanella</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Lorens</surname>
            <given-names>J.B.</given-names>
          </name>
          <name>
            <surname>Link</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>High content screening: seeing is believing</article-title>
        <source>Trends Biotechnol.</source>
        <volume>28</volume>
        <year>2010</year>
        <fpage>237</fpage>
        <lpage>245</lpage>
        <pub-id pub-id-type="pmid">20346526</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="appsec2" sec-type="supplementary-material">
    <title>Supplemental Information</title>
    <p id="p0135">
      <supplementary-material content-type="local-data" id="mmc1">
        <caption>
          <title>Document S1. Transparent Methods, Figures S1–S14, and Tables S1–S4</title>
        </caption>
        <media xlink:href="mmc1.pdf"/>
      </supplementary-material>
    </p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p>We are indebted to the members of BDGP for their support and advice. We thank Richard Weiszmann for conducting the whole-mount <italic>in situ</italic> hybridization experiments. We thank Stephan Preibisch for providing implementation for the autofocus function and Abdelrahman Elbashandy for prototype testing. We thank Korneel Hens and Bart Deplancke at Laboratory of Systems Biology and Genetics (LSBG) of Ecole polytechnique fédérale de Lausanne for the full-length cDNA clone of <italic>mirror</italic>. The work was supported by <funding-source id="gs1">NIH</funding-source> grants R01 GM076655 to S.E.C. and R01 GM097231 to E.F. Work at LBNL was conducted under Department of Energy contract DEAC02- 05CH11231.</p>
    <sec id="sec5">
      <title>Author Contributions</title>
      <p id="p0120">B.W.B. developed the workflow manager, C.M. developed the hardware integration, K.B. developed the C++ adapter for the PL-200 slide loader, W.W.F. and A.S.H. conducted the biological experiments, and E.F. conceived the workflow manager and supervised the work. A.S.H., S.E.C., and E.F. wrote the manuscript.</p>
    </sec>
    <sec id="sec6">
      <title>Declaration of Interests</title>
      <p id="p0125">The authors declare no competing interests.</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="appsec1" fn-type="supplementary-material">
      <p id="p0130">Supplemental Information includes Transparent Methods, 14 figures, and 4 tables and can be found with this article online at <ext-link ext-link-type="doi" xlink:href="10.1016/j.isci.2018.03.017" id="intref0010">https://doi.org/10.1016/j.isci.2018.03.017</ext-link>.</p>
    </fn>
  </fn-group>
</back>
