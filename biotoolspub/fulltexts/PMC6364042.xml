<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.5.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art550.dtd?>
<?SourceDTD.Version 5.5.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_GPB322 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEfx1 jpg ?>
<?FILEfx2 jpg ?>
<?FILEfx3 jpg ?>
<?FILEmmc1 docx ?>
<?FILEmmc2 docx ?>
<?FILEmmc3 docx ?>
<?FILEmmc4 docx ?>
<?FILEmmc5 docx ?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genomics Proteomics Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genomics Proteomics Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Genomics, Proteomics &amp; Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1672-0229</issn>
    <issn pub-type="epub">2210-3244</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6364042</article-id>
    <article-id pub-id-type="publisher-id">S1672-0229(18)30437-6</article-id>
    <article-id pub-id-type="doi">10.1016/j.gpb.2018.03.006</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RGAAT: A Reference-based Genome Assembly and Annotation Tool for New Genomes and Upgrade of Known Genomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Wanfei</given-names>
        </name>
        <xref rid="af005" ref-type="aff">1</xref>
        <xref rid="af010" ref-type="aff">2</xref>
        <xref rid="af020" ref-type="aff">4</xref>
        <xref rid="fn1" ref-type="fn">#</xref>
        <xref rid="fn2" ref-type="fn">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Shuangyang</given-names>
        </name>
        <xref rid="af005" ref-type="aff">1</xref>
        <xref rid="af015" ref-type="aff">3</xref>
        <xref rid="fn1" ref-type="fn">#</xref>
        <xref rid="fn3" ref-type="fn">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Qiang</given-names>
        </name>
        <xref rid="af005" ref-type="aff">1</xref>
        <xref rid="af010" ref-type="aff">2</xref>
        <xref rid="fn1" ref-type="fn">#</xref>
        <xref rid="fn4" ref-type="fn">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gao</surname>
          <given-names>Shenghan</given-names>
        </name>
        <xref rid="af005" ref-type="aff">1</xref>
        <xref rid="fn5" ref-type="fn">d</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ding</surname>
          <given-names>Feng</given-names>
        </name>
        <xref rid="af025" ref-type="aff">5</xref>
        <xref rid="fn6" ref-type="fn">e</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Xiaowei</given-names>
        </name>
        <xref rid="af005" ref-type="aff">1</xref>
        <xref rid="fn7" ref-type="fn">f</xref>
        <xref rid="fn90" ref-type="fn">†</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aljohi</surname>
          <given-names>Hasan Awad</given-names>
        </name>
        <email>haljohi@kacst.edu.sa</email>
        <xref rid="af010" ref-type="aff">2</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
        <xref rid="fn8" ref-type="fn">g</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Jun</given-names>
        </name>
        <email>junyu@big.ac.cn</email>
        <xref rid="af005" ref-type="aff">1</xref>
        <xref rid="af010" ref-type="aff">2</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
        <xref rid="fn9" ref-type="fn">h</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Songnian</given-names>
        </name>
        <email>husn@big.ac.cn</email>
        <xref rid="af005" ref-type="aff">1</xref>
        <xref rid="af010" ref-type="aff">2</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
        <xref rid="fn10" ref-type="fn">i</xref>
      </contrib>
    </contrib-group>
    <aff id="af005"><label>1</label>CAS Key Laboratory of Genome Sciences and Information, Beijing Institute of Genomics, Chinese Academy of Sciences, Beijing 100101, China</aff>
    <aff id="af010"><label>2</label>Joint Center for Genomics Research (JCGR), King Abdulaziz City for Science and Technology and Chinese Academy of Sciences, Riyadh 11442, Saudi Arabia</aff>
    <aff id="af015"><label>3</label>University of Chinese Academy of Sciences, Beijing 100049, China</aff>
    <aff id="af020"><label>4</label>Grail Scientific Co. Ltd., Shenyang 110000, China</aff>
    <aff id="af025"><label>5</label>Shenzhen Institute of Geriatrics, Shenzhen 518020, China</aff>
    <author-notes>
      <corresp id="cor1"><label>⁎</label>Corresponding authors. <email>haljohi@kacst.edu.sa</email><email>junyu@big.ac.cn</email><email>husn@big.ac.cn</email></corresp>
      <fn id="fn1">
        <label>#</label>
        <p id="np010">Equal contribution.</p>
      </fn>
      <fn id="fn2">
        <label>a</label>
        <p id="np015">ORCID: 0000-0002-6637-6807.</p>
      </fn>
      <fn id="fn3">
        <label>b</label>
        <p id="np020">ORCID: 0000-0001-6305-3204.</p>
      </fn>
      <fn id="fn4">
        <label>c</label>
        <p id="np025">ORCID: 0000-0003-2882-7758.</p>
      </fn>
      <fn id="fn5">
        <label>d</label>
        <p id="np030">ORCID: 0000-0003-4280-4915.</p>
      </fn>
      <fn id="fn6">
        <label>e</label>
        <p id="np035">ORCID: 0000-0001-6397-5532.</p>
      </fn>
      <fn id="fn7">
        <label>f</label>
        <p id="np040">ORCID: 0000-0001-7608-9644.</p>
      </fn>
      <fn id="fn8">
        <label>g</label>
        <p id="np045">ORCID: 0000-0002-3937-7994.</p>
      </fn>
      <fn id="fn9">
        <label>h</label>
        <p id="np050">ORCID: 0000-0002-2702-055X.</p>
      </fn>
      <fn id="fn10">
        <label>i</label>
        <p id="np055">ORCID: 0000-0003-3966-3111.</p>
      </fn>
      <fn id="fn90">
        <label>†</label>
        <p id="ce.note-para_jpd_p4p_hgb">Deceased.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="ppub">
      <month>10</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <volume>16</volume>
    <issue>5</issue>
    <fpage>373</fpage>
    <lpage>381</lpage>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>12</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>12</day>
        <month>2</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>3</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2018 The Authors</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="CC BY" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="ab005">
      <p>The rapid development of high-throughput sequencing technologies has led to a dramatic decrease in the money and time required for <italic>de novo</italic> genome sequencing or genome resequencing projects, with new genome sequences constantly released every week. Among such projects, the plethora of updated genome assemblies induces the requirement of version-dependent annotation files and other compatible public dataset for downstream analysis. To handle these tasks in an efficient manner, we developed the reference-based <bold>genome assembly</bold> and annotation tool (RGAAT), a flexible toolkit for resequencing-based consensus building and annotation update. RGAAT can detect sequence variants with comparable precision, specificity, and sensitivity to GATK and with higher precision and specificity than Freebayes and SAMtools on four DNA-seq datasets tested in this study. RGAAT can also identify sequence variants based on cross-cultivar or cross-version genomic alignments. Unlike GATK and SAMtools/BCFtools, RGAAT builds the consensus sequence by taking into account the true allele frequency. Finally, RGAAT generates a coordinate conversion file between the reference and query genomes using sequence variants and supports annotation file transfer. Compared to the rapid annotation transfer tool (RATT), RGAAT displays better performance characteristics for annotation transfer between different genome assemblies, strains, and species. In addition, RGAAT can be used for genome modification, <bold>genome comparison</bold>, and coordinate conversion. RGAAT is available at <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/rgaat/" id="ir005">https://sourceforge.net/projects/rgaat/</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/wushyer/RGAAT_v2" id="ir010">https://github.com/wushyer/RGAAT_v2</ext-link> at no cost.</p>
    </abstract>
    <kwd-group id="kg005">
      <title>Keywords</title>
      <kwd>Variant identification</kwd>
      <kwd>Genome assembly</kwd>
      <kwd>Genome annotation</kwd>
      <kwd>Genome comparison</kwd>
    </kwd-group>
  </article-meta>
  <notes>
    <p id="ms005">Handled by Ge Gao</p>
  </notes>
</front>
<body>
  <sec id="s0005">
    <title>Introduction</title>
    <p id="p0005">With the development of sequencing technologies, it is getting easier to obtain the genome of various species. Up to, genome sequences of 4963 eukaryotes, 125,679 prokaryotes, 12,952 viruses, 10,916 plasmids, and 10,965 organelles have been available in the NCBI genome database (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/genome/browse#!/overview/" id="ir015">https://www.ncbi.nlm.nih.gov/genome/browse#!/overview/</ext-link>; accessed on December 5, 2017) <xref rid="b0005" ref-type="bibr">[1]</xref>. The sequence error rate is around 0.01% in the human genome <xref rid="b0010" ref-type="bibr">[2]</xref>. However, the quality of genome sequences varied considerably due to a variety of factors such as different sequencing platforms used, even if improved by subsequent efforts, especially using next-generation sequencing platforms. In addition, some assemblies have obvious sequencing errors caused by the sequencing platform used, such as homopolymers from Roche/454 and base substitutions from Solexa <xref rid="b0015" ref-type="bibr">[3]</xref>. Moreover, many more genome projects have released one reference assembly and several resequencing data for different cultivars or closely related species <xref rid="b0020" ref-type="bibr">[4]</xref>, <xref rid="b0025" ref-type="bibr">[5]</xref>. The reference sequences are also constantly updated with newly emerging methods or strategies, such as 10X genomics long reads (<ext-link ext-link-type="uri" xlink:href="https://www.10xgenomics.com/" id="ir020">https://www.10xgenomics.com/</ext-link>), single molecular sequencing (<ext-link ext-link-type="uri" xlink:href="https://www.pacb.com/" id="ir025">https://www.pacb.com/</ext-link>), and optical scan (<ext-link ext-link-type="uri" xlink:href="https://bionanogenomics.com/" id="ir030">https://bionanogenomics.com/</ext-link>). Thus, to maintain and utilize the different assemblies, genome upgrade, assembly, and annotation based on known assemblies are on common and great demands. Unfortunately, there are few easy-to-use integrated tools to achieve both genome assembly and annotation transfer based on known reference genomes. Despite some tools, such as SAMtools/BCFtools and GATK, containing the module to create consensus sequence, none of them considers the true allele frequency for each variant, which is important for reducing false positive rate <xref rid="b0030" ref-type="bibr">[6]</xref>, <xref rid="b0035" ref-type="bibr">[7]</xref>, <xref rid="b0040" ref-type="bibr">[8]</xref>, <xref rid="b0045" ref-type="bibr">[9]</xref>. Another tool, rapid annotation transfer tool (RATT), can be used for annotation transfer, but the accuracy is relatively low for repeat regions <xref rid="b0050" ref-type="bibr">[10]</xref>, whereas iCORN can be used for correcting sequence errors, but not for upgrading annotations <xref rid="b0055" ref-type="bibr">[11]</xref>. The web-based platforms—UCSC (<ext-link ext-link-type="uri" xlink:href="https://genome.ucsc.edu/cgi-bin/hgLiftOver" id="ir035">https://genome.ucsc.edu/cgi-bin/hgLiftOver</ext-link>) and Galaxy (<ext-link ext-link-type="uri" xlink:href="http://usegalaxy.org" id="ir040">http://usegalaxy.org</ext-link>)—can convert coordinates among different genome assembly versions using the liftOver utility, but only for 106 genomes present in their databases <xref rid="b0060" ref-type="bibr">[12]</xref>, <xref rid="b0065" ref-type="bibr">[13]</xref>, <xref rid="b0070" ref-type="bibr">[14]</xref>, <xref rid="b0075" ref-type="bibr">[15]</xref>. There is an increasing demand for genome comparison between sub-species and cultivars on the gene level. Therefore, it is imperative to achieve both reference-based genome assembly and annotation transfer for comparative genomic analysis. Unfortunately, there were few integral tools to perform both functions.</p>
    <p id="p0010">In this study, we reported the development of the reference-based genome assembly and annotation tool, RGAAT, to solve the problems encountered in the process of genome assembly and annotation. Although these problems are very common, we did not find comprehensive solutions despite searching two popular forums: Biostars (<ext-link ext-link-type="uri" xlink:href="https://www.biostars.org/" id="ir045">https://www.biostars.org/</ext-link>) and SEQanswers (<ext-link ext-link-type="uri" xlink:href="http://seqanswers.com/" id="ir050">http://seqanswers.com/</ext-link>). RGAAT is implemented in Perl and freely available to users at <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/rgaat/" id="ir055">https://sourceforge.net/projects/rgaat/</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/wushyer/RGAAT_v2" id="ir090">https://github.com/wushyer/RGAAT_v2</ext-link>. It accepts inputs of the genome sequence (FASTA format), annotation (GTF, GFF, GFF3, and BED format), mapping-based new assembly features, such as sequence alignment (SAM/BAM format), sequence variant (VCF format or tab-delimited five-column table containing chromosome, position, ID, reference allele, and alternative allele), and the new genome sequence (FASTA format). The search output displays sequence variants (for sequence alignment and genome comparison), updated genome sequence (for sequence alignment and sequence variant), corresponding coordinates between two genomes (known genome and upgrade/new genome), new genome annotation, and result of genome comparison. This tool can also be used to identify genome variants and to build genome consensus sequences.</p>
  </sec>
  <sec id="s0010">
    <title>Method</title>
    <p id="p0015">RGAAT includes three main modules: variant identification, coordinate conversion, and genome assembly/annotation. The workflow of RGAAT is shown in <xref rid="f0005" ref-type="fig">Figure 1</xref>.<fig id="f0005"><label>Figure 1</label><caption><p><bold>Workflow of RGAAT</bold></p><p>RGAAT includes three main modules: variant identification, coordinate conversion, and genome assembly/annotation. Variant identification is based on the sequence alignment or genome comparison result; annotation transfer is based on the processing coordinate conversion with variant calling result. The output of RGAAT includes new genome assembly and annotation.</p></caption><graphic xlink:href="gr1"/></fig></p>
    <sec id="s0015">
      <title>Variant identification based on read alignment</title>
      <p id="p0020">The principle of variant identification involves assessment of read quality, mapping quality, and sequence coverage. As several read mapping software have been developed to deal with read and mapping quality, we adopt the mapping results and handle the data at two stages: read processing and variant identification/filter (<xref rid="f0010" ref-type="fig">Figure 2</xref>).<fig id="f0010"><label>Figure 2</label><caption><p><bold>Workflow of variant identification based on sequence alignment (SAM/BAM) in RGAAT</bold></p><p>Variant identification based on sequence alignment includes 3 stages: read processing, variant discovery, and variant filtering. During the variant discovery stage, RGAAT applies a combination of criteria listed in the box with dashed borders in blue to increase the sensitivity of identification. During the variant filtering stage, RGAAT applies a combination of criteria listed in the box with dashed borders in orange to ensure the accuracy of identification. Finally, all candidate variant related attributes are recoded to reduce the false positive rate.</p></caption><graphic xlink:href="gr2"/></fig></p>
      <p id="p0025">The first part is read processing, <italic>i.e.</italic>, read filtering and locus parsing. Firstly, low-quality reads with average quality score &lt;Q20 were abandoned. Then, we filtered the reads, including those with lower mapping quality, those from PCR or optical duplicate, and those with multiple mapping loci. To distinguish sequence error and variant, we evaluated the adjacent variant distance in dbSNP and built a variant distance trinomial function (<italic>y</italic> =  −0.6944<italic>x</italic><sup>3</sup> + 11.31<italic>x</italic><sup>2</sup> − 26.71<italic>x</italic> + 17, <italic>x</italic> and <italic>y</italic> indicate the variant number and variant distance, respectively) (<xref rid="s0120" ref-type="sec">Figure S1</xref>). Using this function, we filtered reads based on read mismatch, insertion, and deletion. Due to the relatively low accuracy for short mapped blocks at both ends of the read, we clipped the read ends with short match regions (length of cigar “M” &lt;8 bp). After obtaining high-quality mapped reads, we parsed reads at each genome locus with quality check and masked reads in repeat regions that were handled by RepeatMasker (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org" id="ir060">http://www.repeatmasker.org</ext-link>) and Tandem Repeats Finder <xref rid="b0080" ref-type="bibr">[16]</xref>. Next, we recorded related attributes for each locus simultaneously, including (1) raw read coverage, (2) high-quality read coverage, (3) reference and alternative alleles, (4) base quality, (5) read start point number, (6) multi-mapped read number, and (7) mapped read number on each strand.</p>
      <p id="p0030">The second part is variant discovery and filtering. We firstly identified all candidate variants and recorded related attributes. To reduce the false positive rate, we removed the variants with low average base quality (&lt;20), low uniquely mapped allele frequency (&lt;15%), high reference allele frequency (≥80%), low read depth (&lt;2), and low variant read number (&lt;2) (<xref rid="s0120" ref-type="sec">Figure S2</xref>).</p>
    </sec>
    <sec id="s0020">
      <title>Evaluation of identified variants based on four test datasets</title>
      <p id="p0035">To evaluate the efficiency and accuracy of RGAAT, we performed variant calling for four NGS datasets. These include Illumina 100 bp paired-end 30× exome data from the Genome Comparison And Analytic Testing (GCAT) toolkit, Illumina 101 bp paired-end 200× human exome data, as well as Illumina 101 bp paired-end data for plant chloroplast (∼5167×) and mitochondria (∼1788×) (<xref rid="t0005" ref-type="table">Table 1</xref>), which were generated from other sequencing projects in our laboratory and deposited to GSA <xref rid="b0085" ref-type="bibr">[17]</xref> under the accession Nos. PRJCA001139 (human exome data) and PRJCA000261 (chloroplast and mitochondria), respectively. After removing adaptor sequences and low-quality reads by Trimmomatic (v0.33) <xref rid="b0090" ref-type="bibr">[18]</xref>, filtered reads were mapped using Bowtie2 (v2.2.4) <xref rid="b0095" ref-type="bibr">[19]</xref> with default setting. Variants were identified using GATK (duplicates marked by Picard Tools v1.119; INDEL intervals created by RealignerTargetCreator; reads realigned by IndelRealigner; and variants called by HaplotypeCaller of GATK v3.3-0-g37228af) <xref rid="b0045" ref-type="bibr">[9]</xref>, SAMtools (SAMtools v1.2 with configuration of -d 100000, -L 100000, and -m 3, and BCFtools v1.2 with default setting), and RGAAT. The variants of Freebayes_Q40 <xref rid="b0100" ref-type="bibr">[20]</xref> were obtained from GCAT as well.<table-wrap id="t0005" position="float"><label>Table 1</label><caption><p><bold>The four HiSeq datasets analyzed in this study</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th><bold>Feature</bold></th><th><bold>Human</bold></th><th><bold>Human</bold></th><th><bold>Chloroplast</bold></th><th><bold>Mitochondria</bold></th></tr></thead><tbody><tr><td>Data type</td><td>100-bp pair-end exome</td><td>101-bp pair-end exome</td><td>101-bp pair-end genome</td><td>101-bp pair-end genome</td></tr><tr><td>Data source</td><td>GCAT</td><td>PRJCA001139</td><td>PRJCA000261</td><td>PRJCA000261</td></tr><tr><td>Coverage</td><td>30×</td><td>77×</td><td>5167×</td><td>1788×</td></tr><tr><td>Mapping software</td><td>Bowtie2(2.2.4)</td><td>BWA(0.7.10-r789)</td><td>Bowtie2(2.2.4)</td><td>Bowtie2(2.2.4)</td></tr><tr><td>No. of mapped reads</td><td>17,884,489</td><td>60,821,606</td><td>9,402,591</td><td>9,363,153</td></tr><tr><td>No. (percentage) of mapped clean reads</td><td>17,167,791 (95.99%)</td><td>59,862,730 (98.42%)</td><td>9,338,188 (99.32%)</td><td>9,198,701 (98.24%)</td></tr><tr><td>No. of raw variants</td><td>789,170</td><td>1,182,110</td><td>157,076</td><td>488,918</td></tr><tr><td>No. of variants after the first filtering</td><td>189,106</td><td>273,382</td><td>223</td><td>742</td></tr><tr><td>No. of final filtered variants</td><td>123,660</td><td>201,100</td><td>221</td><td>742</td></tr></tbody></table><table-wrap-foot><fn><p><italic>Note</italic>: dbSNP for human samples and the manually-curated variants for chloroplast and mitochondria sequences were used for evaluating the performance of variant calling in RGAAT. During read filtering step, unmapped reads, multi-mapped reads, reads generated from PCR duplicate, reads with low quality, high mismatch, chromosome difference, or large distance for paired-end were removed. At the first filtering step, variants with low read average base quality, low uniquely-mapped allele frequency, high reference frequency, low read depth, or low variant read number were removed. Variants of low read depth, low allele frequency, or low average read quality were filtered to obtain the final variants. GCAT, Genome Comparison and Analytic Testing platform.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="s0025">
      <title>Variant identification based on genome comparison</title>
      <p id="p0040">RGAAT can be used to generate variants between two assemblies by sequence comparison (<xref rid="f0015" ref-type="fig">Figure 3</xref>). We used BLAT for genome comparison because of its ability to map sequences with long gap tolerance to eliminate the influence of repeat sequences, especially for different genome assemblies of the same species. First, we obtained the genome alignment using BLAT (v35) <xref rid="b0105" ref-type="bibr">[21]</xref> with default setting. For genome comparison between different species, we used parameter “-minIdentity = 50” for BLAT. There were some redundant alignments and alignment errors in BLAT results due to the presence of repetitive and low-complexity regions. Based on the base number for match, mismatch, insertion, and deletion in query and target genome, we filtered the BLAT results step-by-step as follows. We first identified and kept the best alignment result for each query sequence; we then sorted query alignments based on the coordinate order in target sequences; and finally we removed bad alignments for overlapping records, that is, only the alignment with highest identity was kept whereas other alignments were removed. After that, we identified variants (SNPs and INDELs) and created genome coordinate conversion files (“TargetChrom, TargetStart, TargetEnd, QueryStart, QueryEnd, QueryChrom, QueryStrand”) based on the non-redundant genome alignment. Variants were identified at three levels, <italic>i.e.</italic>, SNPs in aligned regions, INDELs in gaps, as well as SNPs and INDELs located in the gaps of adjacent BLAT alignment records. The variants and coordinate conversion files are used in the downstream analysis.<fig id="f0015"><label>Figure 3</label><caption><p><bold>Workflow of variant identification based on genome comparison in RGAAT</bold></p><p>First, the genome comparison is performed by BLAT and the redundant reads are filtered out by the combination of processes indicated in the box with dashed borders in black. Second, variants including SNPs and INDELs are identified as indicated in the box with dashed borders in blue. Finally, variants were ready for downstream analysis.</p></caption><graphic xlink:href="gr3"/></fig></p>
    </sec>
    <sec id="s0030">
      <title>Consensus sequence building based on variants</title>
      <p id="p0045">One of the most common needs for re-sequencing projects and genome sequencing of closely-related cultivars, strains, or species is to reconstruct the new assembly based on read alignment files, such as the population-specific consensus genome sequences in humans <xref rid="b0110" ref-type="bibr">[22]</xref> and other model species. Although GATK and SAMtools/BCFtools can build the consensus sequences based on variants, both tools have some disadvantages. First, GATK and SAMtools identify variants with suppressed read depth (500× coverage for GATK with the down-sampling setting for and maximally 250× coverage for SAMtools by default), which may affect allele frequency due to information loss with highly excessive coverage. Second, both tools create consensus sequences with non-reference alleles without considering the true allele frequency and read depth, which are very important parameters for genome upgrade. RGAAT improved the consensus sequence building in both aspects, that is, not setting read depth limit for variant identification and taking allele frequency into consideration. RGAAT can build consensus sequences easily by parsing the variant files in two steps, including (1) selecting the main allele among reference and alternative alleles and (2) adjusting genome location according to variants. For the first step, we selected the major allele based on the allele frequency. Software such as GATK and Freebayes can provide the allelic depths for the reference and alternative alleles by the allelic depth (AD) ID. RGAAT reports the exact allele read number and frequency of the reference and major alternative alleles during variant calling. Note that the “AF” ID in the VCF file is the max-likelihood estimate of the alternative allele frequency, which is not the true allele frequency. For the second step, we produced the genome coordinate conversion file for further annotation transfer.</p>
    </sec>
    <sec id="s0035">
      <title>Annotation transfer based on variants or genome comparisons</title>
      <p id="p0050">In addition to new genome creation, annotation transfer is an important step for assembly upgrade and further genome comparison at the gene level. Application of next-generation sequencing (NGS) technologies has greatly reduced the sequencing cost and promoted the productivity of genome sequencing projects dramatically. However, genome annotation is both arduous and computing-intensive. Several automatic annotation tools, such as Ensembl <xref rid="b0115" ref-type="bibr">[23]</xref>, NCBI <xref rid="b0005" ref-type="bibr">[1]</xref>, PASA <xref rid="b0120" ref-type="bibr">[24]</xref>, and MAKER <xref rid="b0125" ref-type="bibr">[25]</xref> have been developed. However, these complicated tools require expertise to use and are more suitable for <italic>ab initio</italic> genome annotation. RATT is a tool for annotation transfer between similar genomes and can be run easily and quickly <xref rid="b0050" ref-type="bibr">[10]</xref>. However, RATT uses MUMmer <xref rid="b0130" ref-type="bibr">[26]</xref> as aligner, resulting in the loss of global sequence consistency during alignment for closely-related genomes, especially for repeat regions. For rapid upgrade genome annotation between different genome assemblies, RGAAT can build genome coordinate conversion files based on variants or genome comparison. There are two options for genome annotation transfer: one is to replace the reference genome with variants (creating a new consensus sequence) and change the coordinate for corresponding annotation files; and the other is to transfer reference annotations to the target genome based on genome comparison (<xref rid="f0020" ref-type="fig">Figure 4</xref>). The former is suitable for genome upgrade, while the latter performs better for closely-related genomes without re-sequencing data.<fig id="f0020"><label>Figure 4</label><caption><p><bold>Workflow of annotation transfer</bold></p><p>The annotation transfer pipeline integrates two sets of information: the transfer progress based on variant identification (blue), and the transfer progress based on genome comparison (yellow). The integrated annotation file is classified into three categories (dashed borders in black): no locus transferred, two loci transferred, and one locus transferred. Annotation file in the first category is discarded, while file in the second one is transferred directly and file in the third one needs two extra steps (dashed borders in blue) to infer untransformed locus by extension to both upstream and downstream regions.</p></caption><graphic xlink:href="gr4"/></fig></p>
      <p id="p0055">It is important to define the exact syntenic regions between the two assemblies in annotation transfer. With the genome coordinate conversion file, the coordinates of annotation features in the reference genome are transformed. For each annotation feature, the outcome of annotation transfer can be classified into three groups according to the status of start/end locus: two loci successfully transferred, one locus successfully transferred, and no locus transferred. In the first case, two loci can be easily replaced with new genome coordinates. In the second case, the non-transformed locus can be inferred from the successfully-transferred locus, by considering the distance of two loci in the reference genome and the strand information in the query genome. To reduce the influence of syntenic loss in the low identity region, RGAAT tries to find possible start or stop codons by extending to upstream or downstream sequences in order to infer the non-transformed site. For the first exon, RGAAT tries to find the possible start codon by extending upstream, while for the last exon, RGAAT tries to find the possible stop codon by extending downstream. Due to sequence variations between the two genomes, annotation features may be interfered by SNPs and INDELs, especially for coding sequences (CDS). Meanwhile, to achieve the maximum annotation transfer in syntenic regions, we keep all candidate annotations in the output files and mark the location of problematic annotations (annotations partially transferred due to the interruption by the presence of stop codons) using an interrogation sign “?”. Users can check the annotation with “?” markers to recover partially transferred annotations interrupted by stop codons. In addition, we prefer using the feature table file (*.tbl) for annotation transfer to be compatible with the NCBI record system. However, it should be pointed out that the success in direct transfer of genes highly relies on the similarity between the two genomes. For the annotation of problematic features, we refer to the information from the successfully-transferred locus, including distance between the two loci of the feature in the reference genome and their strandness in the query genome to ensure the completeness of ORFs. If the similarity of genome is too low, the results of annotation transfer would become unpredictable. In this case, we highly recommend a fully <italic>ab initio gene</italic> prediction for very distinct genomes.</p>
    </sec>
    <sec id="s0040">
      <title>Evaluation of annotation transfer between genomes in five datasets</title>
      <p id="p0060">We evaluate the efficiency of annotation transfer using RGAAT based on five datasets. These include two chloroplast genome assemblies generated in our lab (GenBank accession: KX028884) using different sequencing platforms, 454 and Solexa, which includes corrected 212 regions in total consisting of 119 base errors, 6 deletions, and 87 insertions as reference to assess annotation transfer between different genome assemblies. To evaluate the annotation transfer between strains, the bacterium <italic>Mycobacterium tuberculosis</italic> (strain H37Rv; GenBank accession: AL123456 and strain F11; GenBank accession: CP000717) and chromosome IV of yeast <italic>Saccharomyces cerevisiae</italic> (strain S288C; GenBank accession: NC_001136 and strain ySR127 GenBank accession: CP011550) were used. In addition, the chromosome 14 of the parasites <italic>Plasmodium chabaudi</italic> and <italic>P. berghei</italic> (downloaded from <ext-link ext-link-type="uri" xlink:href="http://ratt.sourceforge.net" id="ir065">http://ratt.sourceforge.net</ext-link>) and the chromosome IV of yeast <italic>S. cerevisiae</italic> (strain S288C; GenBank accession: NC_001136) and <italic>S. arboricola</italic> (strain H-6; GenBank accession: CM001566) were used to assess annotation transfer between species.</p>
    </sec>
    <sec id="s0045">
      <title>SVG figure creation for genome comparison</title>
      <p id="p0065">To reveal the variations between two genomes, an SVG figure is created for each chromosome based on the genome coordinate conversion file and genome annotation file. The figure shows SNPs, INDELs, and identical regions with different colors for the compared genomes with gene blocks. SVG file can be displayed easily in browser, using functions such as drag, zoom in, and zoom out.</p>
    </sec>
  </sec>
  <sec id="s0050">
    <title>Results</title>
    <p id="p0070">Here, we demonstrate the performance of RGAAT, mainly in two parts: variant identification and annotation transfer.</p>
    <sec id="s0055">
      <title>Variant identification</title>
      <sec id="s0060">
        <title>For dataset with low sequence depth</title>
        <p id="p0075">The 30× 100 bp paired-end exome dataset was downloaded from GCAT website and aligned using Bowtie2 with default parameters (<xref rid="t0005" ref-type="table">Table 1</xref>). Before variant identification, we filtered 4.01% aligned reads including those with low sequence quality (3.16%), low mapping quality (0.06%), and high percentage of mismatches (0.79%). We also filtered the short aligned regions on both end of the reads. From the retained mapped reads, we identified 789,170 raw variants. After examining the base quality, variant frequency, reference frequency, multi-mapped reads, read start count, read depth, and the discrepancy between the numbers of reference and variant reads, only 189,106 (23.96%) variants passed the initial filter criteria. Then, we filtered the variants according to the percentage and quality of variant reads. In total, 123,660 final variants were identified. For comparison, GATK and SAMtools were also used to identify variants simultaneously. We uploaded the variants identified by RGAAT, GATK, and SAMtools to GCAT and compared them together with Freebayes. According to the comparison reports, the precision rate of variant identification using RGAAT is higher than those using Freebayes and SAMtools, and was similar to that using GATK. As for sensitivity, the performance of RGAAT is comparable with that of GATK, but higher than that of Freebayes and lower than that of SAMtools (<xref rid="t0010" ref-type="table">Table 2</xref>). Upon validation with dbSNPs, we observed that RGAAT identified higher number of common variants than GATK, and lower number of novel variants than SAMtools and Freebayes. These observations indicate that RGAAT achieves a good balance between true positives and false positives, which is consistent with the precision rate, specificity, and sensitivity exhibited by RGAAT. In addition, RGAAT shows a higher transition/transversion ratio (Ti/Tv; the number of transitions to the number of transversions for SNP variants; 2.156) than Freebayes (1.826) and SAMtools (1.483), which is comparable with GATK (2.356).<table-wrap id="t0010" position="float"><label>Table 2</label><caption><p><bold>Comparison of performance in variant identification using different tools</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th><bold>Dataset</bold></th><th><bold>Software</bold></th><th><bold>TP</bold></th><th><bold>FP</bold></th><th><bold>TN</bold></th><th><bold>FN</bold></th><th><bold>Precision</bold></th><th><bold>Sensitivity</bold></th><th><bold>Specificity</bold></th></tr></thead><tbody><tr><td rowspan="4">Human<break/>(GCAT)<sup>a</sup></td><td>RGAAT</td><td>20,032</td><td>1432</td><td>46,467,105</td><td>3471</td><td>93.33%</td><td>85.23%</td><td>100.00%</td></tr><tr><td>GATK</td><td>19,861</td><td>1121</td><td>46,467,416</td><td>3321</td><td>94.66%</td><td>85.67%</td><td>100.00%</td></tr><tr><td>SAMtools</td><td>20,537</td><td>3227</td><td>46,465,310</td><td>2248</td><td>86.42%</td><td>90.13%</td><td>99.99%</td></tr><tr><td>Freebayes_Q40</td><td>18,925</td><td>1854</td><td>46,466,683</td><td>4376</td><td>91.08%</td><td>81.22%</td><td>100.00%</td></tr><tr><td colspan="9">  </td></tr><tr><td rowspan="4">Human<break/>(GCAT)<sup>b</sup></td><td>RGAAT</td><td>14,487</td><td>468</td><td>59,286</td><td>2045</td><td>96.87%</td><td>87.63%</td><td>99.22%</td></tr><tr><td>GATK</td><td>14,180</td><td>732</td><td>59,311</td><td>2063</td><td>95.09%</td><td>87.30%</td><td>98.78%</td></tr><tr><td>SAMtools</td><td>14,862</td><td>802</td><td>59,230</td><td>1392</td><td>94.88%</td><td>91.44%</td><td>98.66%</td></tr><tr><td>Freebayes_Q40</td><td>13,688</td><td>555</td><td>59,321</td><td>2722</td><td>96.10%</td><td>83.41%</td><td>99.07%</td></tr><tr><td colspan="9">  </td></tr><tr><td rowspan="3">Human<break/>(GSA)<sup>c</sup></td><td>RGAAT</td><td>38,527</td><td>785</td><td>48,223,655</td><td>2,926,351</td><td>98.00%</td><td>1.30%</td><td>100.00%</td></tr><tr><td>GATK</td><td>42,773</td><td>1553</td><td>48,222,887</td><td>2,922,105</td><td>96.50%</td><td>1.44%</td><td>100.00%</td></tr><tr><td>SAMtools</td><td>41,963</td><td>1882</td><td>48,222,558</td><td>2,922,915</td><td>95.71%</td><td>1.42%</td><td>100.00%</td></tr><tr><td colspan="9">  </td></tr><tr><td rowspan="3">Chloroplast<sup>d</sup></td><td>RGAAT</td><td>198</td><td>23</td><td>154,300</td><td>14</td><td>89.59%</td><td>93.40%</td><td>99.99%</td></tr><tr><td>GATK</td><td>163</td><td>123</td><td>154,200</td><td>49</td><td>56.99%</td><td>76.89%</td><td>99.92%</td></tr><tr><td>SAMtools</td><td>181</td><td>83</td><td>154,240</td><td>31</td><td>68.56%</td><td>85.38%</td><td>99.95%</td></tr><tr><td colspan="9">  </td></tr><tr><td rowspan="3">Mitochondria<sup>e</sup></td><td>RGAAT</td><td>624</td><td>118</td><td>677,331</td><td>60</td><td>84.10%</td><td>91.23%</td><td>99.98%</td></tr><tr><td>GATK</td><td>560</td><td>238</td><td>677,211</td><td>124</td><td>70.18%</td><td>81.87%</td><td>99.96%</td></tr><tr><td>SAMtools</td><td>581</td><td>220</td><td>677,229</td><td>103</td><td>72.53%</td><td>84.94%</td><td>99.97%</td></tr></tbody></table><table-wrap-foot><fn><p><italic>Note</italic>: The variants of NIST Genome in a Bottle (GIAB, a) and the variants of Illumina OMNI SNP Array (b) were obtained from GCAT; the dbSNP variants for human exome (c) were deposited in GSA (accession No. PRJCA00113); the manually curated variants for chloroplast (d) and mitochondria (e) were deposited in GSA (accession No. PRJCA00261). TP, true positive; FP, false positive; TN, true negative; FN, false negative.</p></fn></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="s0065">
        <title>For dataset with high sequence depth</title>
        <p id="p0080">To assess the performance of identification at higher read depths, we applied RGAAT, GATK, and SAMtools to identify variants in one medium-depth data (200× human exome dataset) and two high-depth data (5167× of chloroplast and 1788× of mitochondria datasets) (<xref rid="t0010" ref-type="table">Table 2</xref>). With 200× human exome data, RGAAT showed the highest precision rate and specificity, but lowest sensitivity. The Ti/Tv ratios were 2.63, 2.31, and 2.28 for SAMtools, RGAAT, and GATK, respectively. For the two high-depth data, RGAAT displayed better performance, <italic>i.e.</italic>, higher precision rate, sensitivity, and specificity than SAMtools and GATK (<xref rid="t0010" ref-type="table">Table 2</xref>).</p>
      </sec>
      <sec id="s0070">
        <title>Variant identification by genome comparison</title>
        <p id="p0085">We performed sequence alignment to identify variants between two versions of chloroplast genome sequence generated in our lab using two different platforms by BLAT and compared them with the true variants. All 212 true variants (119 SNPs, 87 insertions, and 6 deletions) were identified by genome comparison, including 191 one-to-one, 8 two-to-one, and 1 five-to-one variant matches (<xref rid="s0120" ref-type="sec">Figure S3</xref>A). Note that the variants identified by BLAT is located at the end of aligned region, while the variant identified from read alignment is located in the start of aligned region (see <xref rid="s0120" ref-type="sec">Figure S3</xref>B for example).</p>
      </sec>
    </sec>
    <sec id="s0075">
      <title>Annotation transfer</title>
      <sec id="s0080">
        <title>Annotation transfer between different genome assemblies</title>
        <p id="p0090">We obtained two genome assembly versions for the chloroplast sample. Using two annotation transfer methods in RGAAT, <italic>i.e.</italic>, variant-based and genome comparison-based, all annotation features were successfully transformed, including 93 CDSs, 54 exons, 141 genes, 8 rRNAs, and 40 tRNAs. In comparison, RATT, another annotation transfer tool, lost 8 genes, 14 CDSs, 1 exon, and 8 tRNAs during transfer (<xref rid="t0015" ref-type="table">Table 3</xref>). In particular, the transferred annotation in RATT contained one partial CDS and two frameshift CDSs (<xref rid="s0120" ref-type="sec">Table S1</xref>).<table-wrap id="t0015" position="float"><label>Table 3</label><caption><p><bold>Comparison of performance in annotation transfer using RGAAT and RATT</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2" valign="middle"><bold>Scenario</bold></th><th rowspan="2" valign="middle"><bold>Samples</bold></th><th rowspan="2" valign="middle"><bold>No. of reference features</bold></th><th rowspan="2" valign="middle"><bold>No. of target features</bold></th><th rowspan="2" valign="middle"><bold>Tool</bold></th><th rowspan="2" valign="middle"><bold>No. of transferred features</bold></th><th rowspan="2" valign="middle"><bold>No. of problematic features</bold></th><th colspan="5" align="center" valign="middle"><bold>Comparison with known annotation</bold><hr/></th></tr><tr><th><bold>TP</bold></th><th><bold>FP</bold></th><th><bold>FN</bold></th><th><bold>Precision</bold></th><th><bold>Sensitivity</bold></th></tr></thead><tbody><tr><td rowspan="2">Between different genome assemblies</td><td rowspan="2">Chloroplast</td><td rowspan="2">336</td><td rowspan="2">336</td><td>RGAAT</td><td>336</td><td>0</td><td>336</td><td>0</td><td>0</td><td>100.00%</td><td>100.00%</td></tr><tr><td>RATT</td><td>305</td><td>3</td><td>303</td><td>2</td><td>33</td><td>99.34%</td><td>90.18%</td></tr><tr><td colspan="12">  </td></tr><tr><td rowspan="4">Between different strains</td><td rowspan="2"><italic>M. tuberculosis</italic></td><td rowspan="2">8540</td><td rowspan="2">7996</td><td>RGAAT</td><td>8417</td><td>29</td><td>7796</td><td>318</td><td>198</td><td>96.08%</td><td>97.50%</td></tr><tr><td>RATT<break/></td><td>8223<break/></td><td>41<break/></td><td>7648<break/></td><td>314<break/></td><td>348<break/></td><td>96.06%<break/></td><td>95.65%<break/></td></tr><tr><td rowspan="2"><italic>S. cerevisiae</italic></td><td rowspan="2">2430</td><td rowspan="2">-</td><td>RGAAT</td><td>2430</td><td>5</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td></tr><tr><td>RATT</td><td>2430</td><td>22</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td></tr><tr><td colspan="12">  </td></tr><tr><td rowspan="4">Between different species</td><td rowspan="2"><italic>P. chabaudi</italic>/<italic>P. berghei</italic></td><td rowspan="2">686</td><td rowspan="2">661</td><td>RGAAT</td><td>652</td><td>186</td><td>636</td><td>16</td><td>25</td><td>97.55%</td><td>96.22%</td></tr><tr><td>RATT<break/></td><td>647<break/></td><td>174<break/></td><td>633<break/></td><td>14<break/></td><td>28<break/></td><td>97.83%<break/></td><td>95.76%<break/></td></tr><tr><td rowspan="2"><italic>S. cerevisiae/S. arboricola</italic></td><td rowspan="2">2430</td><td rowspan="2">1106</td><td>RGAAT</td><td>1401</td><td>105</td><td>670</td><td>671</td><td>436</td><td>49.96%</td><td>60.58%</td></tr><tr><td>RATT</td><td>993</td><td>13</td><td>661</td><td>321</td><td>445</td><td>67.31%</td><td>59.76%</td></tr></tbody></table><table-wrap-foot><fn><p><italic>Note</italic>: The number of reference features is the number of annotations from the source genome; the number of target features is the number of reference annotations already available on the targeted genome; the number of transferred features is the number of annotations transferred by software based on the annotation of the source genome and the comparison of the two genome sequences; and the number of problematic features is the number of annotations partially transferred due to the interruption by the presence of stop codons. Parameters including TP, FP, FN, precision and sensitivity are calculated based” on the number of transferred features and the number of target features. “-” indicates that there is no this kind of feature in query genome and the number of FP is overestimated due to the inclusion of pseudo genes. TP, true positive; FP, false positive; FN, false negative.</p></fn></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="s0085">
        <title>Annotation transfer between different strains</title>
        <p id="p0095">First, we tested the annotation transfer from the bacterium <italic>Mycobacterium tuberculosis</italic> strain H37Rv to the strain F11 genome because these two closely related genomes are relative well assembled and annotated. Both RATT and RGAAT completed the transfer within several minutes. Of 8540 annotation features in strain H37Rv, 8417 (98.56%) and 8223 (96.29%) were transferred to F11 by RGAAT and RATT, respectively (<xref rid="t0015" ref-type="table">Table 3</xref> and <xref rid="s0120" ref-type="sec">Table S2</xref>). We inspected all CDSs of strain F11 and found that only 29 (0.73%) in RGAAT and 41 (1.05%) in RATT were not transferred correctly. Among them, in-frame stop codons were found in the translation of 17 and 15 CDSs in RGAAT and RATT, respectively, indicating that these CDSs could be pseudogenes. Comparing with known annotation of F11, RGAAT shows similar precision rate (96.08%) with RATT but higher sensitivity (97.50%). Moreover, 140 (4 problematic) and 137 (8 problematic) novel CDSs were identified by RGAAT and RATT, respectively. We then used the chromosome IV of yeast strain S288C to annotate the strain ySR127 that was submitted to NCBI without annotation. All 2430 annotation features in strain S288C were successfully transferred by both RGAAT and RATT (<xref rid="t0015" ref-type="table">Table 3</xref> and <xref rid="s0120" ref-type="sec">Table S3</xref>). Among them, the translation of 5 CDSs in RGAAT and 22 CDSs in RATT terminates earlier, most of which were transferred incorrectly. We thus compared the annotation results between RGAAT and RATT and found that 4 mobile elements and 20 CDSs were inconsistently annotated. After comparing with repetitive elements, we found that 4 mobile elements were mis-transferred in RATT. Among the 20 discrepant CDSs, 18 was incorrectly transferred in RATT, which led to frame shift, and the remaining 2 terminated earlier due to the stop codons present in RGAAT.</p>
      </sec>
      <sec id="s0090">
        <title>Annotation transfer between different species</title>
        <p id="p0100">We also evaluated the performance of RGAAT for annotation transfer between two closely related eukaryote species in two datasets since accuracy and sensitivity of annotation transfer directly affect downstream gene function analysis. In the previous report on RATT <xref rid="b0050" ref-type="bibr">[10]</xref>, the <italic>P. chabaudi</italic> was used to annotate <italic>P. berghei</italic> chromosome 14. Our test showed that, using this dataset, 652 and 647 out of 686 reference CDSs were transferred from chromosome 14 of <italic>P. chabaudi</italic> to that of <italic>P. berghei</italic> by RGAAT and RATT, respectively, of which 186 and 174 CDSs terminated earlier by stop codon in RGAAT and RATT, respectively (<xref rid="t0015" ref-type="table">Table 3</xref>). When we checked the translation of <italic>P. chabaudi</italic> CDSs <xref rid="b0050" ref-type="bibr">[10]</xref>, we found that 470 CDSs were interrupted by in-frame stop codons. The bad quality of reference annotation made it difficult to perform further comparisons.</p>
        <p id="p0105">Meanwhile, genome information of <italic>S. cerevisiae</italic> chromosome IV was used to annotate <italic>S. arboricola</italic> chromosome IV. 1401 and 993 of 2430 reference annotation features were transferred by RGAAT and RATT, respectively, with 105 and 13 CDSs containing multiple in-frame stop codons, respectively (<xref rid="t0015" ref-type="table">Table 3</xref> and <xref rid="s0120" ref-type="sec">Table S4</xref>). We analyzed the 105 CDSs in RGAAT and found 10 of them seemingly pseudogenes. Comparing with RATT, RGAAT has higher sensitivity and lower precision rate. The main reason for low precision rate in RGAAT is the higher number of transferred features in RGAAT compared to RATT (1401 <italic>vs</italic>. 993). Additionally, the original annotated features may include pseudogenes, which was removed in the RGAAT, leading to the underestimated precision rate. If the problematic features were removed, the precision rate would be higher. False negative annotation features could be further recovered from problematic features by manual inspection.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s0095">
    <title>Other applications</title>
    <p id="p0110">In addition to the functions described above, RGAAT can be used for other applications. For instance, RGAAT can read the tab delimited text file with five columns (chromosome, position, ID, reference allele, and alternative allele) and build new genome assembly based on alternative alleles, which means that user can edit genome sequences (insertion and deletion) easily by just providing the edit position and sequence. In addition, based on sequence comparison, RGAAT can identify variants between two genomes and evaluate the influence of these variants using other downstream analysis tools such as ANNOVAR <xref rid="b0135" ref-type="bibr">[27]</xref>. RGAAT can also provide the SVG graphical results for assembly comparison based on coordinate conversion file and genome annotation files.</p>
  </sec>
  <sec id="s0100">
    <title>Conclusions</title>
    <p id="p0115">RGAAT is an efficient tool for assembly upgrade and annotation transfer to new assembly based on known reference genomes. The variant identification for human exome sequencing can be achieved in less than one day using one CPU and approximately 16 Gb memory on a Linux system. RGAAT is compatible with many variant input types: (1) tab delimited text file provided by users with five columns (chromosome, position, ID, reference, and variant); (2) variant call format file created by other software, such as GATK, SAMtools, and Freebayes; (3) sequence alignment file provided in SAM or BAM format; and (4) new genome sequences provided in FASTA format. Compared with GATK, SAMtools, and Freebayes, RGAAT and GATK have similar precision rate (TP/(TP + FP)) and specificity (TN/(TN + FP)), but exhibit slightly lower sensitivity (TP/(TP + FP)) for the NIST Genome in a Bottle dataset (GCAT) (<ext-link ext-link-type="uri" xlink:href="https://www.nist.gov/programs-projects/genome-bottle" id="ir070">https://www.nist.gov/programs-projects/genome-bottle</ext-link>), whereas RGAAT shows the highest precision rate and specificity on Illumina OMNI SNP Array, indicating that RGAAT achieves a good balance between true and false positives. In addition, RGAAT has a higher Ti/Tv ratio than Freebayes and SAMtools, which is comparable with GATK. A higher Ti/Tv ratio generally suggests high accuracy in our variant calling test for human exome <xref rid="b0045" ref-type="bibr">[9]</xref>. To build consensus sequences, we parse all reads for variant identification and consider the true allele frequency for variant selection. RGAAT has better performance for different genome assemblies and strains (&gt;96% precision rate and sensitivity), although the annotation transfer is influenced by sequence similarity between two species. Compared to RATT, RGAAT has higher transfer percentage, higher sensitivity and lower problematic annotation percentage. RGAAT can also support some popular annotation formats such as GTF, GFF, GFF3, and BED (<xref rid="s0120" ref-type="sec">Table S5</xref>). Although we provide some frequently used modules for genome assembly and annotation, there remains much work to be further optimized. RGAAT is implemented in PERL and tested in Linux environments. The detailed description can be found in the README file of RGAAT software package.</p>
    <p id="p0120">In summary, RGAAT provides several functional modules for handling frequently-used genome analysis, such as genome variant identification, genome consensus sequence building, genome modification, genome comparison, and annotation transfer. RGAAT will benefit the comparative genomic analysis between closely-related species and sub-species at the gene level, such as pan-genome analysis and population genetics.</p>
  </sec>
  <sec id="s0105">
    <title>Authors’ contributions</title>
    <p id="p0125">HAA, JY, and SH conceived the study; WL, SW, and QL wrote the codes. WL and QL wrote the manuscript; SG, FD, and XZ revised the manuscript. All author read and approved the manuscript.</p>
  </sec>
  <sec id="s0110">
    <title>Competing interests</title>
    <p id="p0130">The authors have declared no competing interests.</p>
  </sec>
</body>
<back>
  <ref-list id="bi005">
    <title>References</title>
    <ref id="b0005">
      <label>1</label>
      <element-citation publication-type="journal" id="h0005">
        <person-group person-group-type="author">
          <name>
            <surname>NCBI Resource Coordinators</surname>
          </name>
        </person-group>
        <article-title>Database resources of the national center for biotechnology information</article-title>
        <source>Nucleic Acids Res</source>
        <volume>46</volume>
        <year>2018</year>
        <fpage>D8</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="pmid">29140470</pub-id>
      </element-citation>
    </ref>
    <ref id="b0010">
      <label>2</label>
      <element-citation publication-type="journal" id="h0010">
        <person-group person-group-type="author">
          <name>
            <surname>Lander</surname>
            <given-names>E.S.</given-names>
          </name>
          <name>
            <surname>Linton</surname>
            <given-names>L.M.</given-names>
          </name>
          <name>
            <surname>Birren</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Zody</surname>
            <given-names>M.C.</given-names>
          </name>
          <name>
            <surname>Baldwin</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Initial sequencing and analysis of the human genome</article-title>
        <source>Nature</source>
        <volume>409</volume>
        <year>2001</year>
        <fpage>860</fpage>
        <lpage>921</lpage>
        <pub-id pub-id-type="pmid">11237011</pub-id>
      </element-citation>
    </ref>
    <ref id="b0015">
      <label>3</label>
      <element-citation publication-type="journal" id="h0015">
        <person-group person-group-type="author">
          <name>
            <surname>Shendure</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Next-generation DNA sequencing</article-title>
        <source>Nat Biotechnol</source>
        <volume>26</volume>
        <year>2008</year>
        <fpage>1135</fpage>
        <lpage>1145</lpage>
        <pub-id pub-id-type="pmid">18846087</pub-id>
      </element-citation>
    </ref>
    <ref id="b0020">
      <label>4</label>
      <element-citation publication-type="journal" id="h0020">
        <person-group person-group-type="author">
          <name>
            <surname>Al-Mssallem</surname>
            <given-names>I.S.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Genome sequence of the date palm <italic>Phoenix dactylifera</italic> L</article-title>
        <source>Nat Commun</source>
        <volume>4</volume>
        <year>2013</year>
        <fpage>2274</fpage>
        <pub-id pub-id-type="pmid">23917264</pub-id>
      </element-citation>
    </ref>
    <ref id="b0025">
      <label>5</label>
      <element-citation publication-type="journal" id="h0025">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Kuang</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Genome sequence and genetic diversity of the common carp, <italic>Cyprinus carpio</italic></article-title>
        <source>Nat Genet</source>
        <volume>46</volume>
        <year>2014</year>
        <fpage>1212</fpage>
        <lpage>1219</lpage>
        <pub-id pub-id-type="pmid">25240282</pub-id>
      </element-citation>
    </ref>
    <ref id="b0030">
      <label>6</label>
      <element-citation publication-type="journal" id="h0030">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <year>2009</year>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="b0035">
      <label>7</label>
      <element-citation publication-type="journal" id="h0035">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>
        <source>Bioinformatics</source>
        <volume>27</volume>
        <year>2011</year>
        <fpage>2987</fpage>
        <lpage>2993</lpage>
        <pub-id pub-id-type="pmid">21903627</pub-id>
      </element-citation>
    </ref>
    <ref id="b0040">
      <label>8</label>
      <element-citation publication-type="journal" id="h0040">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Improving SNP discovery by base alignment quality</article-title>
        <source>Bioinformatics</source>
        <volume>27</volume>
        <year>2011</year>
        <fpage>1157</fpage>
        <lpage>1158</lpage>
        <pub-id pub-id-type="pmid">21320865</pub-id>
      </element-citation>
    </ref>
    <ref id="b0045">
      <label>9</label>
      <element-citation publication-type="journal" id="h0045">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hanna</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Kernytsky</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res</source>
        <volume>20</volume>
        <year>2010</year>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="b0050">
      <label>10</label>
      <element-citation publication-type="journal" id="h0050">
        <person-group person-group-type="author">
          <name>
            <surname>Otto</surname>
            <given-names>T.D.</given-names>
          </name>
          <name>
            <surname>Dillon</surname>
            <given-names>G.P.</given-names>
          </name>
          <name>
            <surname>Degrave</surname>
            <given-names>W.S.</given-names>
          </name>
          <name>
            <surname>Berriman</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>RATT: rapid annotation transfer tool</article-title>
        <source>Nucleic Acids Res</source>
        <volume>39</volume>
        <year>2011</year>
        <fpage>e57</fpage>
        <pub-id pub-id-type="pmid">21306991</pub-id>
      </element-citation>
    </ref>
    <ref id="b0055">
      <label>11</label>
      <element-citation publication-type="journal" id="h0055">
        <person-group person-group-type="author">
          <name>
            <surname>Otto</surname>
            <given-names>T.D.</given-names>
          </name>
          <name>
            <surname>Sanders</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Berriman</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Newbold</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Iterative Correction of Reference Nucleotides (iCORN) using second generation sequencing technology</article-title>
        <source>Bioinformatics</source>
        <volume>26</volume>
        <year>2010</year>
        <fpage>1704</fpage>
        <lpage>1707</lpage>
        <pub-id pub-id-type="pmid">20562415</pub-id>
      </element-citation>
    </ref>
    <ref id="b0060">
      <label>12</label>
      <element-citation publication-type="journal" id="h0060">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W.J.</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>C.W.</given-names>
          </name>
          <name>
            <surname>Furey</surname>
            <given-names>T.S.</given-names>
          </name>
          <name>
            <surname>Roskin</surname>
            <given-names>K.M.</given-names>
          </name>
          <name>
            <surname>Pringle</surname>
            <given-names>T.H.</given-names>
          </name>
          <name>
            <surname>Zahler</surname>
            <given-names>A.M.</given-names>
          </name>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res</source>
        <volume>12</volume>
        <year>2002</year>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="b0065">
      <label>13</label>
      <element-citation publication-type="journal" id="h0065">
        <person-group person-group-type="author">
          <name>
            <surname>Goecks</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Nekrutenko</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences</article-title>
        <source>Genome Biol</source>
        <volume>11</volume>
        <year>2010</year>
        <fpage>R86</fpage>
        <pub-id pub-id-type="pmid">20738864</pub-id>
      </element-citation>
    </ref>
    <ref id="b0070">
      <label>14</label>
      <element-citation publication-type="journal" id="h0070">
        <person-group person-group-type="author">
          <name>
            <surname>Blankenberg</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Kuster</surname>
            <given-names>G.V.</given-names>
          </name>
          <name>
            <surname>Coraor</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Ananda</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Lazarus</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Mangan</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Galaxy: a web-based genome analysis tool for experimentalists</article-title>
        <source>Curr Protoc Mol Biol</source>
        <volume>19</volume>
        <year>2010</year>
        <fpage>19.10.1</fpage>
        <lpage>21</lpage>
      </element-citation>
    </ref>
    <ref id="b0075">
      <label>15</label>
      <element-citation publication-type="journal" id="h0075">
        <person-group person-group-type="author">
          <name>
            <surname>Giardine</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Riemer</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>R.C.</given-names>
          </name>
          <name>
            <surname>Burhans</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Elnitski</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Galaxy: a platform for interactive large-scale genome analysis</article-title>
        <source>Genome Res</source>
        <volume>15</volume>
        <year>2005</year>
        <fpage>1451</fpage>
        <lpage>1455</lpage>
        <pub-id pub-id-type="pmid">16169926</pub-id>
      </element-citation>
    </ref>
    <ref id="b0080">
      <label>16</label>
      <element-citation publication-type="journal" id="h0080">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Tandem repeats finder: a program to analyze DNA sequences</article-title>
        <source>Nucleic Acids Res</source>
        <volume>27</volume>
        <year>1999</year>
        <fpage>573</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="pmid">9862982</pub-id>
      </element-citation>
    </ref>
    <ref id="b0085">
      <label>17</label>
      <element-citation publication-type="journal" id="h0085">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>GSA: genome sequence archive</article-title>
        <source>Genomics Proteomics Bioinformatics</source>
        <volume>15</volume>
        <year>2017</year>
        <fpage>14</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">28387199</pub-id>
      </element-citation>
    </ref>
    <ref id="b0090">
      <label>18</label>
      <element-citation publication-type="journal" id="h0090">
        <person-group person-group-type="author">
          <name>
            <surname>Bolger</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Lohse</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Usadel</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title>
        <source>Bioinformatics</source>
        <volume>30</volume>
        <year>2014</year>
        <fpage>2114</fpage>
        <lpage>2120</lpage>
        <pub-id pub-id-type="pmid">24695404</pub-id>
      </element-citation>
    </ref>
    <ref id="b0095">
      <label>19</label>
      <element-citation publication-type="journal" id="h0095">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S.L.</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat Methods</source>
        <volume>9</volume>
        <year>2012</year>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="b0100">
      <label>20</label>
      <element-citation publication-type="journal" id="h0100">
        <person-group person-group-type="author">
          <name>
            <surname>Garrison</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Haplotype-based variant detection from short-read sequencing</article-title>
        <source>arXiv</source>
        <year>2012</year>
        <comment>1207.3907</comment>
      </element-citation>
    </ref>
    <ref id="b0105">
      <label>21</label>
      <element-citation publication-type="journal" id="h0105">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W.J.</given-names>
          </name>
        </person-group>
        <article-title>BLAT—the BLAST-like alignment tool</article-title>
        <source>Genome Res</source>
        <volume>12</volume>
        <year>2002</year>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </element-citation>
    </ref>
    <ref id="b0110">
      <label>22</label>
      <element-citation publication-type="journal" id="h0110">
        <person-group person-group-type="author">
          <name>
            <surname>Ling</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>VCGDB: a dynamic genome database of the Chinese population</article-title>
        <source>BMC Genomics</source>
        <volume>15</volume>
        <year>2014</year>
        <fpage>1</fpage>
        <pub-id pub-id-type="pmid">24382143</pub-id>
      </element-citation>
    </ref>
    <ref id="b0115">
      <label>23</label>
      <element-citation publication-type="journal" id="h0115">
        <person-group person-group-type="author">
          <name>
            <surname>Ruffier</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kähäri</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Komorowska</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Keenan</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Longden</surname>
            <given-names>I.</given-names>
          </name>
        </person-group>
        <article-title>Ensembl core software resources: storage and programmatic access for DNA sequence and genome annotation</article-title>
        <source>Database (Oxford)</source>
        <volume>2017</volume>
        <year>2017</year>
        <fpage>bax020</fpage>
      </element-citation>
    </ref>
    <ref id="b0120">
      <label>24</label>
      <element-citation publication-type="journal" id="h0120">
        <person-group person-group-type="author">
          <name>
            <surname>Haas</surname>
            <given-names>B.J.</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Wortman</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>R.K.</given-names>
            <suffix>Jr</suffix>
          </name>
          <name>
            <surname>Hannick</surname>
            <given-names>L.I.</given-names>
          </name>
        </person-group>
        <article-title>Improving the <italic>Arabidopsis</italic> genome annotation using maximal transcript alignment assemblies</article-title>
        <source>Nucleic Acids Res</source>
        <volume>31</volume>
        <year>2003</year>
        <fpage>5654</fpage>
        <lpage>5666</lpage>
        <pub-id pub-id-type="pmid">14500829</pub-id>
      </element-citation>
    </ref>
    <ref id="b0125">
      <label>25</label>
      <element-citation publication-type="journal" id="h0125">
        <person-group person-group-type="author">
          <name>
            <surname>Holt</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Yandell</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>MAKER2: an annotation pipeline and genome-database management tool for second-generation genome projects</article-title>
        <source>Bioinformatics</source>
        <volume>12</volume>
        <year>2011</year>
        <fpage>1</fpage>
      </element-citation>
    </ref>
    <ref id="b0130">
      <label>26</label>
      <element-citation publication-type="journal" id="h0130">
        <person-group person-group-type="author">
          <name>
            <surname>Delcher</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S.L.</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>A.M.</given-names>
          </name>
        </person-group>
        <article-title>Using MUMmer to identify similar regions in large sequence sets</article-title>
        <source>Curr Protoc Bioinformatics</source>
        <volume>10</volume>
        <issue>10</issue>
        <year>2003</year>
        <fpage>3</fpage>
        <pub-id pub-id-type="pmid">18428693</pub-id>
      </element-citation>
    </ref>
    <ref id="b0135">
      <label>27</label>
      <element-citation publication-type="journal" id="h0135">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hakonarson</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>ANNOVAR: functional annotation of genetic variants from high-throughput sequencing data</article-title>
        <source>Nucleic Acids Res</source>
        <volume>38</volume>
        <year>2010</year>
        <fpage>e164</fpage>
        <pub-id pub-id-type="pmid">20601685</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="s0120" sec-type="supplementary-material">
    <title>Supplementary materials</title>
    <p id="p0145">The following are the Supplementary data to this article:<fig id="f0025" position="anchor"><label>Supplementary Figure S1</label><caption><p><bold>The evaluation of sequence error and variant A.</bold> Density plot of the distance between adjacent variants (bp) in dbSNP was used to set up the variant distance. Numbers before “SNPs” in the legend box indicate the numbers of consecutive SNP loci. <bold>B.</bold> Trinomial function (y = −0.6944x<sup>3</sup> + 11.31x<sup>2</sup> − 26.71x + 17; x and y indicate the variant number and variant distance, respectively) is used to filter reads based on read mismatch, insertion, and deletion to distinguish the true SNPs and sequencing errors.</p></caption><graphic xlink:href="fx1"/></fig></p>
    <p id="p0150">
      <fig id="f0030" position="anchor">
        <label>Supplementary Figure S2</label>
        <caption>
          <p><bold>The density of allele frequency</bold> The density of reference allele frequency and alternative allele frequency is shown in <bold>A</bold> and <bold>B</bold>, respectively. “All” means all candidate variants, “Common” means common variants in dbSNP. To reduce the false positive rate of variant identification, cutoff values were set to 0.8 for reference allele frequency and 0.15 for alternative allele frequency. Variants with frequency &gt;0.8 for reference allele and &lt;0.15 for alternative allele were removed.</p>
        </caption>
        <graphic xlink:href="fx2"/>
      </fig>
    </p>
    <p id="p0155">
      <fig id="f0035" position="anchor">
        <label>Supplementary Figure S3</label>
        <caption>
          <p><bold>Variant identification by genome comparison A.</bold> The pairwise synteny of query and reference genomes. Genes and repeats are colored in red and green, respectively, with gene linkages shown in purple. Variants were identified based on the comparison. <bold>B.</bold> The variant position difference between read alignment and genome comparison by BLAT. The variant loci were identified by BLAT (right) and the variant position were identified from read alignment (left).</p>
        </caption>
        <graphic xlink:href="fx3"/>
      </fig>
    </p>
    <p id="p0160">
      <supplementary-material content-type="local-data" id="m0025">
        <caption>
          <title>Supplementary Table S1</title>
        </caption>
        <media xlink:href="mmc1.docx"/>
      </supplementary-material>
    </p>
    <p id="p0165">
      <supplementary-material content-type="local-data" id="m0020">
        <caption>
          <title>Supplementary Table S2</title>
        </caption>
        <media xlink:href="mmc2.docx"/>
      </supplementary-material>
    </p>
    <p id="p0170">
      <supplementary-material content-type="local-data" id="m0015">
        <caption>
          <title>Supplementary Table S3</title>
        </caption>
        <media xlink:href="mmc3.docx"/>
      </supplementary-material>
    </p>
    <p id="p0175">
      <supplementary-material content-type="local-data" id="m0010">
        <caption>
          <title>Supplementary Table S4</title>
        </caption>
        <media xlink:href="mmc4.docx"/>
      </supplementary-material>
    </p>
    <p id="p0180">
      <supplementary-material content-type="local-data" id="m0005">
        <caption>
          <title>Supplementary Table S5</title>
        </caption>
        <media xlink:href="mmc5.docx"/>
      </supplementary-material>
    </p>
  </sec>
  <ack id="ak005">
    <title>Acknowledgments</title>
    <p>This study is supported by grants from the <funding-source id="gp005">Strategic Priority Research Program of the Chinese Academy of Sciences</funding-source> (Grant No. XDA08020102), <funding-source id="gp010">National Natural Science Foundation of China</funding-source> (Grant Nos. 81701071, 31501042, 31271385, and 31200957), <funding-source id="gp015">Shenzhen Science and Technology Program</funding-source> (Grant No. JCYJ20170306171013613), China and <funding-source id="gp020">King Abdulaziz City for Science and Technology</funding-source> (KACST; Grant No. 1035-35), Kingdom of Saudi Arabia. Technical supports were provided by the <funding-source id="gp025">CAS Key Laboratory of Genome Science and Information</funding-source>, Beijing Institute of Genomics, <funding-source id="gp030">Chinese Academy of Sciences</funding-source>, China.</p>
  </ack>
  <fn-group>
    <fn id="d31e878">
      <p id="np005">Peer review under responsibility of Beijing Institute of Genomics, Chinese Academy of Sciences and Genetics Society of China.</p>
    </fn>
    <fn id="s0115" fn-type="supplementary-material">
      <p id="p0140">Supplementary data to this article can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.gpb.2018.03.006" id="ir075">https://doi.org/10.1016/j.gpb.2018.03.006</ext-link>.</p>
    </fn>
  </fn-group>
</back>
