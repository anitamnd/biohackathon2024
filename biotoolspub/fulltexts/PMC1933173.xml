<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.2 20060430//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.2?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub June-6-2007?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1933173</article-id>
    <article-id pub-id-type="pmid">17553837</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkm359</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MultiPhyl: a high-throughput phylogenomics webserver using distributed computing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Keane</surname>
          <given-names>Thomas M.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Naughton</surname>
          <given-names>Thomas J.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McInerney</surname>
          <given-names>James O.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Pathogen Sequencing Unit, Wellcome Trust Sanger Institute, Wellcome Trust Genome Campus, Hinxton, CB10 1SA Hinxton, UK, <sup>2</sup>Department of Biology, National University of Ireland, Maynooth, Co. Kildare, Ireland and <sup>3</sup>Department of Computer Science, National University of Ireland, Maynooth, Co. Kildare, Ireland</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed. <phone>+44 (0) 1223 494954</phone><fax>+44 (0)1223 494919</fax><email>tkeane@cs.nuim.ie</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>6</month>
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>6</month>
      <year>2007</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
						epub date downloaded from Highwire. -->
    <volume>35</volume>
    <issue>Web Server issue</issue>
    <fpage>W33</fpage>
    <lpage>W37</lpage>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>1</month>
        <year>2007</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>4</month>
        <year>2007</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>4</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2007 The Author(s)</copyright-statement>
      <copyright-year>2007</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>With the number of fully sequenced genomes increasing steadily, there is greater interest in performing large-scale phylogenomic analyses from large numbers of individual gene families. Maximum likelihood (ML) has been shown repeatedly to be one of the most accurate methods for phylogenetic construction. Recently, there have been a number of algorithmic improvements in maximum-likelihood-based tree search methods. However, it can still take a long time to analyse the evolutionary history of many gene families using a single computer. Distributed computing refers to a method of combining the computing power of multiple computers in order to perform some larger overall calculation. In this article, we present the first high-throughput implementation of a distributed phylogenetics platform, MultiPhyl, capable of using the idle computational resources of many heterogeneous non-dedicated machines to form a phylogenetics supercomputer. MultiPhyl allows a user to upload hundreds or thousands of amino acid or nucleotide alignments simultaneously and perform computationally intensive tasks such as model selection, tree searching and bootstrapping of each of the alignments using many desktop machines. The program implements a set of 88 amino acid models and 56 nucleotide maximum likelihood models and a variety of statistical methods for choosing between alternative models. A MultiPhyl webserver is available for public use at: <ext-link ext-link-type="uri" xlink:href="http://www.cs.nuim.ie/distributed/multiphyl.php">http://www.cs.nuim.ie/distributed/multiphyl.php</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>One of the greatest goals of biology is the reconstruction of the tree of life. Recent advances in high-throughput sequencing technologies have seen an exponential increase in the amount of publicly available genomic data. The huge increase in genomic data requires us to develop efficient high-throughput methods for analysing this data. Nowadays it is usual for whole-genome phylogenetic studies to comprise of thousands of different genes and search through large numbers of possible phylogenies. For example, in supertree analysis, researchers first construct a large number of fully optimized phylogenies with partially overlapping taxa and combine these input trees to produce more comprehensive phylogenetic hypotheses (e.g. <xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>). One of the most accurate techniques for constructing phylogenetic trees is using maximum likelihood (ML) estimation (<xref ref-type="bibr" rid="B3">3</xref>).</p>
    <p>Recently, there have been significant advances in model-based tree search methods that can be mainly attributed to algorithmic improvements rather than hardware improvements. Programs such as Phyml (<xref ref-type="bibr" rid="B4">4</xref>), RaxML (<xref ref-type="bibr" rid="B5">5</xref>), MrBayes (<xref ref-type="bibr" rid="B6">6</xref>) and IQPNNI (<xref ref-type="bibr" rid="B7">7</xref>) have each introduced better and faster heuristics that have been shown to repeatedly outperform traditional ML programs such as fastDNAml (<xref ref-type="bibr" rid="B8">8</xref>) in terms of computing time and topological accuracy. The impressive results presented by Guindon and Gascuel (<xref ref-type="bibr" rid="B4">4</xref>) serve as an example of the extent to which these algorithmic improvements have made it possible to use ML programs to construct relatively large phylogenies quickly using standard hardware. Despite these improvements, it can still take a considerable amount of time to perform large-scale phylogenetic analyses involving thousands of alignments using only a single processor. One popular method of addressing this limitation is to take a number of closely coupled processors to form a dedicated processing cluster for performing high-throughput phylogenetic analysis (<xref ref-type="bibr" rid="B9 B10 B11">9–11</xref>). Although extremely effective, these clusters can be prohibitively expensive as they often require dedicated processors and specialized personnel to maintain these systems. On the other hand, it has been shown in a recent study by IBM that Windows and UNIX servers are idle for approximately 95 and 85% of the day respectively (<xref ref-type="bibr" rid="B12">12</xref>) while another study showed that on average, desktop machines are idle for between 60 and 80% of the day (<xref ref-type="bibr" rid="B13">13</xref>). The term distributed computing is often taken to mean computing using a non-dedicated pre-existing pool of heterogeneous processors that are not localized in a single room or building and can fail arbitrarily. By harnessing the spare clock cycles of multiple semi-idle desktop machines (a semi-idle machine is a machine primarily used by another individual that, because of the nature of the usage, is idle some of the time, e.g. a computer in a university teaching laboratory), it is possible to emulate the computing power offered by specialized dedicated hardware at a fraction of the cost (<xref ref-type="bibr" rid="B14">14</xref>). Recently, a number of authors have identified the suitability of distributed computing for phylogenetic analysis and shown how it is possible to harness the idle clock cycles of hundreds of standard desktop machines to perform phylogenetic analysis (<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B16">16</xref>).</p>
    <p>In this article, we introduce MultiPhyl, which is a fully cross-platform high-throughput ML-based phylogeny analysis program that allows researchers to create a virtual phylogenetic supercomputer from a group of semi-idle desktop machines. The MultiPhyl webserver is aimed at researchers who wish to perform phylogenetic analysis of large numbers of alignments in short amounts of time but do not have access to dedicated high-performance computational resources.</p>
  </sec>
  <sec>
    <title>MULTIPHYL</title>
    <p>MultiPhyl is one of a number of applications that runs on our general-purpose distributed computing system (<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>). The overall design of the system is based on the client-server model. This model describes a system consisting of a single server computer and a number of client computers. Our system is divided into three separate pieces of software: server, client and remote interface (<xref ref-type="bibr" rid="B18">18</xref>). Apart from the server, the system is completely dynamic meaning that new donor machines (a donor machine is owned by someone that offers their machines spare clock cycles to MultiPhyl) can be added at any time and existing donor machines can fail arbitrarily with no adverse effect to the computations. We have deployed the distributed system across our university campus using the idle computing resources of several hundred desktop computers (see <ext-link ext-link-type="uri" xlink:href="http://www.cs.nuim.ie/distributed/statistics.php">http://www.cs.nuim.ie/distributed/statistics.php</ext-link> for details).</p>
    <p>The overall flow of control in MultiPhyl can be broken up into three distinct stages: model selection, tree searching and bootstrapping. The user uploads a group of <italic>n</italic> nucleotide or amino acid alignments in either FASTA or PHYLIP file format. MultiPhyl makes extensive use of the Java-based Phylogenetic Analysis Library (PAL) v1.5 (<xref ref-type="bibr" rid="B19">19</xref>) to perform all likelihood calculations. Each of the analysis stages (model selection, tree searching and bootstrapping) operates completely asynchronously across different alignments, thus achieving maximum speedup and avoiding performance bottlenecks. One of the essential requirements for ML phylogenetic inference is a model of amino acid or nucleotide substitution. It has been shown that using incorrect or suboptimal substitution models can produce less accurate or incorrect phylogenies when the wrong model of evolution is assumed (<xref ref-type="bibr" rid="B20">20</xref>). Therefore, it may be useful to first compute the most suitable model before performing a treesearch. However, model selection is one area that has been overlooked as an essential part of the phylogeny construction process by many other parallel phylogenetic construction programs. We have recognized the importance of integrating model selection into all phylogenetic studies and therefore MultiPhyl allows the user to perform model selection on every alignment prior to all tree searches (<xref ref-type="bibr" rid="B20">20</xref>). The task of testing multiple substitution models against an alignment is very amenable to parallelization as each model can be optimized completely independently and the corresponding likelihoods can be collected and analysed at the server to determine the best model. In order to gain the maximum speedup for the model selection stage of the program, we implemented an adaptive parallel strategy where the server first recruits a single donor machine to construct the initial NJ tree to be used to optimize each model. The parallel granularity of a model selection stage is estimated dynamically by recording how many models are optimized by the first donor machine in <italic>m</italic> min (where the default value of <italic>m</italic> is 15 min). Although it may seem that the optimal parallel granularity would be to just issue a single model per donor machine, this could have a number of adverse effects on the distributed system such as overloading the non-dedicated network or overloading the server with many simultaneous connections. After the server receives the first set of <italic>o</italic> optimized models, it issues groups of <italic>o</italic> models to multiple donor machines to be optimized. As MultiPhyl is based on a network of heterogeneous processors with varying computational abilities, each donor machine has the option to return a partial set of <italic>p</italic> optimized models (where <italic>p</italic> is the number of models optimized by the particular machine within 15 min and <italic>p</italic> &lt; <italic>o</italic>) with the unoptimized models being redistributed to other machines, thereby avoiding a bottleneck that might be caused by a few slow donor machines in the system.</p>
    <p>In order to address the trade-off between running time and accuracy when performing large-scale analysis, we have implemented two different tree search algorithms in MultiPhyl and given the user the option to select which algorithm they wish to use to analyse their dataset. The first tree- building algorithm initially constructs an NJ tree and then iteratively improves the trees by repeatedly performing all possible simultaneous NNI and local branch length optimization swaps that improve the likelihood until convergence (<xref ref-type="bibr" rid="B4">4</xref>). The model parameters are also optimized after each round of NNI swaps. Finally, all of the branch lengths are globally optimized to improve the final likelihood of the tree. The second tree search algorithm implemented in MultiPhyl allows the user to define a maximal depth of subtree pruning and regrafting (SPR) rearrangements to perform from each node of the tree. The SPR tree search algorithm begins by creating a starting tree by performing the NNI search algorithm outlined above and then iteratively visits each node of the tree and performs SPR rearrangements spanning increasing levels of the tree (beginning at 2 levels and continuing up to a user-defined maximum). In order to accommodate both long tree searches and the varying computational abilities of the available donor machines, if an individual tree search has not converged after 60 min on a particular machine, then the current state of the tree search is saved and returned to the server. This tree search is then re-issued to another donor machine to continue optimizing the tree. This also ensures that if a donor machine fails (e.g. crashes or is switched off), it is only possible to lose a maximum of approximately 60 min computing time for any tree search.</p>
    <p>One significant challenge in a distributed computing environment is the huge disparity of available memory on the donor machines. This is a particular issue in phylogenetics as the amount of memory consumed by ML-based phylogeny programs increases linearly with sequence length and number of taxa. MultiPhyl implements a dynamic memory scheme where the minimum memory requirements of each task is first set to some initial value (default is 60 Mb). When a donor machine requests a work unit, the donor machine can only be issued a particular task (model optimization or tree search) that has a memory requirement less than the amount of memory available to the Java Virtual Machine (JVM) on the donor machine. If a donor machine reports that the JVM ran out of memory while attempting to perform a particular task, the server dynamically increases the minimum memory requirements of that individual task to a level that is suitable for the task. If no machine with sufficient memory can be detected after <italic>q</italic> attempts (default value for <italic>q</italic> is 5), then the problem is removed from the system with an appropriate entry in the log file returned to the user. This dynamic scheme ensures that each phylogenetic computation can gain access to the maximum amount of computational resources available to MultiPhyl as the user is not required to decide a priori what types of machines are capable of processing their dataset.</p>
  </sec>
  <sec>
    <title>WEBSERVER</title>
    <p>The MultiPhyl webserver (<ext-link ext-link-type="uri" xlink:href="http://www.cs.nuim.ie/distributed/multiphyl.php">http://www.cs.nuim.ie/distributed/multiphyl.php</ext-link>) allows any researcher to upload multiple amino acid or nucleotide alignments (in FASTA or PHYLIP format) to be analysed on our network of computers. A user can upload either a single alignment file or a zip file containing up to 1000 alignments. The user must provide a valid email address to which the results are sent when the analysis is finished. Each alignment is first checked for formatting errors and an email is sent to notify the user if any errors are found. The webserver is set to perform model selection by default and the user chooses which tree search algorithm to use and whether or not to perform bootstrapping. For each alignment, a comprehensive report file is produced with information on the alignment (number of sites, gap content, constant sites), search parameters, model selection ranking information, sequence-composition chi-squared test, final likelihood, human-readable tree, phylip format tree and a bipartition table constructed from the bootstrap replicates.</p>
    <p>A user is presented with a web submission form when they log onto the MultiPhyl homepage. To avail of the service, the user first selects their alignment file (or a zip file containing their alignments). The user then uses the check-boxes to specify which tree search algorithm (NNI or SPR) to use for their analysis. Next, the user can select whether to perform bootstrapping on their dataset and enter how many bootstrap replicates to carry out in the text box. All users must enter their name, institution and email address in the text-boxes provided. Finally, the user presses the execute button to start the analysis on the distributed system. Any errors found in the submission information are displayed on the screen immediately.</p>
  </sec>
  <sec>
    <title>VALIDATION</title>
    <p>In order to benchmark the tree search algorithms implemented in MultiPhyl, we ran MultiPhyl on a single processor and compared it to a number of other prominent tree search programs, using a number of previously published well-known real alignments. We obtained the three datasets used to benchmark parallel fastDNAml (<xref ref-type="bibr" rid="B11">11</xref>) corresponding to 50 (1858 bp), 101 (1858 bp) and 150 (1269 bp) taxa. We also used the 218RDPII (4128 bp) dataset used to benchmark Phyml (<xref ref-type="bibr" rid="B4">4</xref>) and the 150ARB (3188 bp), 193V (465 bp), 200ARB (3270 bp) and 250ARB (3638 bp) datasets used to benchmark RAxML (<xref ref-type="bibr" rid="B5">5</xref>). The performance of six different phylogeny construction programs across three different architectures was recorded. As MultiPhyl optimizes the base frequencies of the model, Phyml was executed using the ‘F’ option to also optimize the base frequencies. The final likelihood values and running times of each program using the GTR (<xref ref-type="bibr" rid="B21">21</xref>) nucleotide substitution model are given in <xref ref-type="table" rid="T1">Table 1</xref>. In all cases, the final likelihood values of the trees were calculated using Phyml using the branch and model optimisation option to allow for a fair comparison of likelihood values.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Comparison of final log likelihood values and runtimes (seconds in brackets) of MultiPhyl v1.0.4, RAxML-VI, Phyml v2.4.4, DPRml and IQPNNI v3.0 for a number of previously published datasets</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Dataset</th><th rowspan="1" colspan="1">MultiPhyl</th><th rowspan="1" colspan="1">Phyml</th><th rowspan="1" colspan="1">DPRml</th><th rowspan="1" colspan="1">MultiPhyl</th><th rowspan="1" colspan="1">IQPNNI</th><th rowspan="1" colspan="1">RAxML-VI</th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">(NNI)</th><th rowspan="1" colspan="1">v2.4.4</th><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">(SPR)</th><th rowspan="1" colspan="1">v3.0</th><th rowspan="1" colspan="1"/></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">50SC</td><td rowspan="1" colspan="1">−43664</td><td rowspan="1" colspan="1">−43691</td><td rowspan="1" colspan="1">−43735</td><td rowspan="1" colspan="1">−43651</td><td rowspan="1" colspan="1">−43630</td><td rowspan="1" colspan="1">−43630</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">(78)</td><td rowspan="1" colspan="1">(66)</td><td rowspan="1" colspan="1">(5994)</td><td rowspan="1" colspan="1">(6777)</td><td rowspan="1" colspan="1">(443)</td><td rowspan="1" colspan="1">(69)</td></tr><tr><td rowspan="1" colspan="1">101SC</td><td rowspan="1" colspan="1">−73807</td><td rowspan="1" colspan="1">−73818</td><td rowspan="1" colspan="1">−73754</td><td rowspan="1" colspan="1">−73790</td><td rowspan="1" colspan="1">−73648</td><td rowspan="1" colspan="1">−73610</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">(163)</td><td rowspan="1" colspan="1">(145)</td><td rowspan="1" colspan="1">(82935)</td><td rowspan="1" colspan="1">(13674)</td><td rowspan="1" colspan="1">(1703)</td><td rowspan="1" colspan="1">(602)</td></tr><tr><td rowspan="1" colspan="1">150SC</td><td rowspan="1" colspan="1">−44178</td><td rowspan="1" colspan="1">−44138</td><td rowspan="1" colspan="1">−44082</td><td rowspan="1" colspan="1">−44172</td><td rowspan="1" colspan="1">−44061</td><td rowspan="1" colspan="1">−44024</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">(162)</td><td rowspan="1" colspan="1">(113)</td><td rowspan="1" colspan="1">(141211)</td><td rowspan="1" colspan="1">(13931)</td><td rowspan="1" colspan="1">(2513)</td><td rowspan="1" colspan="1">(342)</td></tr><tr><td rowspan="1" colspan="1">150ARB</td><td rowspan="1" colspan="1">−76472</td><td rowspan="1" colspan="1">−76489</td><td rowspan="1" colspan="1">−76571</td><td rowspan="1" colspan="1">−76472</td><td rowspan="1" colspan="1">−76473</td><td rowspan="1" colspan="1">−76473</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">(482)</td><td rowspan="1" colspan="1">(323)</td><td rowspan="1" colspan="1">(309434)</td><td rowspan="1" colspan="1">(17441)</td><td rowspan="1" colspan="1">(4117)</td><td rowspan="1" colspan="1">(814)</td></tr><tr><td rowspan="1" colspan="1">193V</td><td rowspan="1" colspan="1">−64799</td><td rowspan="1" colspan="1">−64532</td><td rowspan="1" colspan="1">n/a</td><td rowspan="1" colspan="1">−64802</td><td rowspan="1" colspan="1">−64413</td><td rowspan="1" colspan="1">−64407</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">(235)</td><td rowspan="1" colspan="1">(263)</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">(13411)</td><td rowspan="1" colspan="1">(2511)</td><td rowspan="1" colspan="1">(905)</td></tr><tr><td rowspan="1" colspan="1">200ARB</td><td rowspan="1" colspan="1">−103741</td><td rowspan="1" colspan="1">−103789</td><td rowspan="1" colspan="1">n/a</td><td rowspan="1" colspan="1">−103740</td><td rowspan="1" colspan="1">−103784</td><td rowspan="1" colspan="1">−103696</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">(1003)</td><td rowspan="1" colspan="1">(395)</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">(17147)</td><td rowspan="1" colspan="1">(6470)</td><td rowspan="1" colspan="1">(1487)</td></tr><tr><td rowspan="1" colspan="1">218RDPII</td><td rowspan="1" colspan="1">−155967</td><td rowspan="1" colspan="1">−155876</td><td rowspan="1" colspan="1">n/a</td><td rowspan="1" colspan="1">−155934</td><td rowspan="1" colspan="1">−155607</td><td rowspan="1" colspan="1">−155603</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">(1049)</td><td rowspan="1" colspan="1">(535)</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">(17233)</td><td rowspan="1" colspan="1">(11508)</td><td rowspan="1" colspan="1">(2937)</td></tr><tr><td rowspan="1" colspan="1">250ARB</td><td rowspan="1" colspan="1">−130530</td><td rowspan="1" colspan="1">−130488</td><td rowspan="1" colspan="1">n/a</td><td rowspan="1" colspan="1">−130518</td><td rowspan="1" colspan="1">−130271</td><td rowspan="1" colspan="1">−130287</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">(1262)</td><td rowspan="1" colspan="1">(619)</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">(17570)</td><td rowspan="1" colspan="1">(15226)</td><td rowspan="1" colspan="1">(3575)</td></tr></tbody></table><table-wrap-foot><fn><p>SPR rearrangements were limited to a maximum of 5 branches of the tree in MulitPhyl (SPR). All tests were carried out on an AMD Opteron 2.4 GHz with 1 GB RAM. Phyml was used to calculate the final likelihood values produced by each program. DPRml was not tested on some of the larger datasets due to its excessive runtimes.</p></fn></table-wrap-foot></table-wrap></p>
    <p>In terms of final likelihood values, the performance of MultiPhyl (NNI) and Phyml is quite similar. Phyml achieves higher final likelihood values in four out of the eight datasets (150SC, 193V, 218RDPII and 250ARB) with MultiPhyl (NNI) achieving higher likelihoods in the other four datasets (50SC, 101SC, 150ARB and 200ARB). As both programs implement very similar tree search algorithms, the differences in performance can be attributed to slight implementation differences of the search algorithm in the two programs. For the smaller datasets (50SC, 101SC, 150SC, 150ARB and 193V), the runtimes of the two programs are quite comparable with MultiPhyl (NNI) producing runtimes up to 1.5 times slower than Phyml. However, the runtimes from the three largest datasets (200ARB, 218RDPII, 250ARB) show more significant differences between the two programs. The performance of the more extensive tree search programs [MultiPhyl (SPR), RAxML and IQPNNI] shows a number of patterns. RAxML clearly outperforms the two other programs in terms of final likelihood values. In five out of the eight datasets (101SC, 150SC, 193V, 200ARB and 218RDPII), RAxML produced the highest likelihoods of any of the programs tested. MultiPhyl (SPR) produced the highest likelihood in one dataset (150ARB) with IQPNNI also producing the highest likelihood for the 250ARB dataset. The scale of the algorithmic improvements in recent years is apparent by examining the performance of DPRml compared to all of the other programs. DPRml is based on a traditional tree search algorithm that has been in use for many years (<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B16">16</xref>). However, in three of the four datasets that DPRml was executed on, it produced the lowest (worst) likelihood values of all of the programs.</p>
  </sec>
  <sec sec-type="conclusions">
    <title>CONCLUSION</title>
    <p>As the number of fully completed genomes increases, we are becoming greatly interested in performing whole-genome phylogenetic analyses by examining the evolutionary history of large numbers of gene families. Despite the recent improvements in ML-based tree search programs, it can still take a long time to perform a full ML phylogenetic analysis of multiple genes on a single computer. In order to address these computational challenges, we have recently developed the first high-throughput implementation of a distributed phylogenetics platform, MultiPhyl, capable of using the idle computational resources of many heterogeneous non-dedicated machines to form a phylogenetics supercomputer. MultiPhyl allows users to upload multiple amino acid or nucleotide alignments and perform the tasks of ML model selection, tree searching, and bootstrapping. We have shown that the tree search algorithms implemented in MultiPhyl are quite comparable to the fastest serial phylogenetic programs. In future versions of MultiPhyl, we intend to integrate some of the other computationally intensive processes that are performed when carrying out a typical phylogenomic analysis such as multiple sequence alignment and simultaneous estimation of alignment and tree parameters. We also intend to incorporate more complex models of sequence evolution such as heterogeneous mixture models of nucleotide and amino acid evolution. MultiPhyl is currently installed on several hundred desktop computers in our university campus and we encourage other institutions to also install MultiPhyl. Perhaps the true significance of the MultiPhyl webserver is that it allows researchers who otherwise do not have access to high performance computational hardware (e.g. in developing countries) the opportunity to perform large phylogenomic studies.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>Financial support for this project was provided by the Irish research council for Science, Engineering and Technology. We would like to thank all of the computer technicians at the Department of Computer Science and the Computer Center at NUIM for their continued support and assistance in deploying the software across the university campus. Funding to pay the Open Access publication charges for this article was provided by the Department of Biology, National University of Ireland, Maynooth, Co. Kildare, Ireland.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Philip</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Creevey</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>McInerney</surname>
            <given-names>JO</given-names>
          </name>
        </person-group>
        <article-title>The opisthokonta and the ecdysozoa may not be clades: stronger support for the grouping of plant and animal than for animal and fungi and stronger support for the coelomata than ecdysozoa</article-title>
        <source>Mol. Biol. Evol</source>
        <year>2005</year>
        <volume>22</volume>
        <fpage>1175</fpage>
        <lpage>1184</lpage>
        <pub-id pub-id-type="pmid">15703245</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fitzpatrick</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Logue</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Stajich</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>A fungal phylogeny based on 42 complete genomes derived from supertree and combined gene analysis</article-title>
        <source>BMC Evol. Biol</source>
        <year>2006</year>
        <volume>6</volume>
        <fpage>99</fpage>
        <pub-id pub-id-type="pmid">17121679</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delsuc</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Brinkmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Philippe</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomics and the reconstruction of the tree of life</article-title>
        <source>Nat. Rev. Genet</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>361</fpage>
        <lpage>375</lpage>
        <pub-id pub-id-type="pmid">15861208</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guindon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gascuel</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>A simple, fast, and accurate algorithm to estimate large phylogenies by maximum likelihood</article-title>
        <source>Syst. Biol</source>
        <year>2003</year>
        <volume>52</volume>
        <fpage>696</fpage>
        <lpage>704</lpage>
        <pub-id pub-id-type="pmid">14530136</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Ludwig</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meier</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>RAxML-III: a fast program for maximum likelihood-based inference of large phylogenetic trees</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>456</fpage>
        <lpage>463</lpage>
        <pub-id pub-id-type="pmid">15608047</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>MrBayes 3: Bayesian phylogenetic inference under mixed models</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>1572</fpage>
        <lpage>1574</lpage>
        <pub-id pub-id-type="pmid">12912839</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vinh</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>IQPNNI: Moving fast through tree space and stopping in time</article-title>
        <source>Mol. Biol. Evol</source>
        <year>2004</year>
        <volume>21</volume>
        <fpage>1565</fpage>
        <lpage>1571</lpage>
        <pub-id pub-id-type="pmid">15163768</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olsen</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Matsuda</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hagstrom</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Overbeek</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>fastDNAmL: a tool for construction of phylogenetic tees of DNA sequences using maximum likelihood</article-title>
        <source>Comput. Appl. Biosci</source>
        <year>1994</year>
        <volume>10</volume>
        <fpage>41</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="pmid">8193955</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brauer</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Holder</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Dries</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Zwickl</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Hillis</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Genetic algorithms and parallel processing in maximum-likelihood phylogeny inference</article-title>
        <source>Mol. Biol. Evol</source>
        <year>2002</year>
        <volume>19</volume>
        <fpage>1717</fpage>
        <lpage>1726</lpage>
        <pub-id pub-id-type="pmid">12270898</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>TREE-PUZZLE: maximum likelihood phylogenetic analysis using quartets and parallel computing</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>502</fpage>
        <lpage>504</lpage>
        <pub-id pub-id-type="pmid">11934758</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Stewart</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Hart</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Wernert</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Parallel implementation and performance of fastDNAml - a program for maximum likelihood phylogenetic inference</article-title>
        <source>Proceedings of SC2001</source>
        <year>2001</year>
        <publisher-name>Denver, CO</publisher-name>
        <fpage>20</fpage>
        <lpage>31</lpage>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Heap</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Taurus - A Taxonomy of Actual Utilization of Real UNIX and Windows Servers. IBM eServer Library on ibm.com</article-title>
        <source>Technical White Paper GM12-0191</source>
        <year>2003</year>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Acharya</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Edjlali</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Saltz</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The utility of exploiting idle workstations for parallel computing</article-title>
        <source>Proceedings of the 1997 ACM SIGMETRICS International Conference on Measurement &amp; Modeling of Computer Systems</source>
        <year>1997</year>
        <fpage>225</fpage>
        <lpage>236</lpage>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bohannon</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Grassroots supercomputing</article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>308</volume>
        <fpage>810</fpage>
        <pub-id pub-id-type="pmid">15879205</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ott</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ludwig</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meier</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>DRAxML@home: A Distributed Program for Computation of Large Phylogenetic Trees</article-title>
        <source>Future Generation Computer Systems</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>725</fpage>
        <lpage>730</lpage>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keane</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Naughton</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Travers</surname>
            <given-names>SAA</given-names>
          </name>
          <name>
            <surname>McInerney</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>McCormack</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>DPRml: distributed phylogeny reconstruction by maximum likelihood</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>969</fpage>
        <lpage>974</lpage>
        <pub-id pub-id-type="pmid">15513992</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keane</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Naughton</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>DSEARCH: sensitive database searching using distributed computing</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>1705</fpage>
        <lpage>1706</lpage>
        <pub-id pub-id-type="pmid">15564297</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keane</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Page</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Naughton</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Travers</surname>
            <given-names>SAA</given-names>
          </name>
          <name>
            <surname>McInerney</surname>
            <given-names>JO</given-names>
          </name>
        </person-group>
        <article-title>Building large phylogenetic trees on coarse-grained parallel machines</article-title>
        <source>Algorithmica</source>
        <year>2006</year>
        <volume>45</volume>
        <fpage>285</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drummond</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>PAL: An object-oriented programming library for molecular evolution and phylogenetics</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>662</fpage>
        <lpage>663</lpage>
        <pub-id pub-id-type="pmid">11448888</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keane</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Creevey</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Pentony</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Naughton</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>McInerney</surname>
            <given-names>JO</given-names>
          </name>
        </person-group>
        <article-title>Assessment of methods for amino acid 60 matrix selection and their use on empirical data shows that ad hoc assumptions for choice of matrix are not justified</article-title>
        <source>BMC Evol. Biol</source>
        <year>2006</year>
        <volume>6</volume>
        <fpage>29</fpage>
        <pub-id pub-id-type="pmid">16563161</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodriguez</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Marin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Medina</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>The general stochastic model of nucleotide substitution</article-title>
        <source>J. Theor. Biol</source>
        <year>1990</year>
        <volume>142</volume>
        <fpage>485</fpage>
        <lpage>501</lpage>
        <pub-id pub-id-type="pmid">2338834</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
