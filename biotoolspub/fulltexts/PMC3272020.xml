<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3272020</article-id>
    <article-id pub-id-type="pmid">22319561</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-11-15801</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0030126</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis Tools</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Ecology</subject>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Medicine</subject>
        <subj-group>
          <subject>Clinical Research Design</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Dirichlet Multinomial Mixtures: Generative Models for Microbial Metagenomics</article-title>
      <alt-title alt-title-type="running-head">Generative Models for Microbiomics</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Holmes</surname>
          <given-names>Ian</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Harris</surname>
          <given-names>Keith</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quince</surname>
          <given-names>Christopher</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Department of Bioengineering, University of California, Berkeley, California, United States of America</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>School of Engineering, University of Glasgow, Glasgow, United Kingdom</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gilbert</surname>
          <given-names>Jack Anthony</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">Argonne National Laboratory, United States of America</aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>christopher.quince@glasgow.ac.uk</email></corresp>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: IH KH CQ. Performed the experiments: IH KH CQ. Analyzed the data: IH KH CQ. Contributed reagents/materials/analysis tools: IH KH CQ. Wrote the paper: IH KH CQ.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>2</month>
      <year>2012</year>
    </pub-date>
    <volume>7</volume>
    <issue>2</issue>
    <elocation-id>e30126</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>8</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>12</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Holmes et al.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>We introduce Dirichlet multinomial mixtures (DMM) for the probabilistic modelling of microbial metagenomics data. This data can be represented as a frequency matrix giving the number of times each taxa is observed in each sample. The samples have different size, and the matrix is sparse, as communities are diverse and skewed to rare taxa. Most methods used previously to classify or cluster samples have ignored these features. We describe each community by a vector of taxa probabilities. These vectors are generated from one of a finite number of Dirichlet mixture components each with different hyperparameters. Observed samples are generated through multinomial sampling. The mixture components cluster communities into distinct ‘metacommunities’, and, hence, determine envirotypes or enterotypes, groups of communities with a similar composition. The model can also deduce the impact of a treatment and be used for classification. We wrote software for the fitting of DMM models using the ‘evidence framework’ (<ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/microbedmm/">http://code.google.com/p/microbedmm/</ext-link>). This includes the Laplace approximation of the model evidence. We applied the DMM model to human gut microbe genera frequencies from Obese and Lean twins. From the model evidence four clusters fit this data best. Two clusters were dominated by Bacteroides and were homogenous; two had a more variable community composition. We could not find a significant impact of body mass on community structure. However, Obese twins were more likely to derive from the high variance clusters. We propose that obesity is not associated with a distinct microbiota but increases the chance that an individual derives from a disturbed enterotype. This is an example of the ‘Anna Karenina principle (AKP)’ applied to microbial communities: disturbed states having many more configurations than undisturbed. We verify this by showing that in a study of inflammatory bowel disease (IBD) phenotypes, ileal Crohn's disease (ICD) is associated with a more variable community.</p>
    </abstract>
    <counts>
      <page-count count="15"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Next generation sequencing, applied to microbial metagenomics, has transformed the study of microbial diversity. Microbial metagenomics, or sequencing of DNA extracted from microbial communities, provides a means to determine what organisms are present without the need for isolation and culturing, which can access less than 1% of the species in a typical environment <xref rid="pone.0030126-Streit1" ref-type="bibr">[1]</xref>. Prior to next generation sequencing individual DNA fragments from a sample were cloned and then Sanger sequenced <xref rid="pone.0030126-Dorigo1" ref-type="bibr">[2]</xref> – a procedure that is slow and expensive when done on a per read basis. Direct next generation sequencing, for example 454 pyrosequencing <xref rid="pone.0030126-Margulies1" ref-type="bibr">[3]</xref> or Illumina <xref rid="pone.0030126-Caporaso1" ref-type="bibr">[4]</xref>, is cheaper and faster, which has allowed much larger studies of microbial diversity, with more reads in total, and with more communities sampled. However, the development of statistics to extract ecologically meaningful information from these data sets has not developed as quickly as the experimental methodology. In particular, tools that can account for the discrete nature, sparsity, and variable size of these data sets are lacking. We propose the Dirichlet multinomial mixture as a generative modelling framework that addresses this need.</p>
    <p>Broadly, microbial metagenomics data can be of two types: either amplicons or shotgun metagenomics. Amplicons are generated by PCR amplification of a specific marker gene region – typically a variable region from the 16S rRNA gene – prior to sequencing, so that the data consists of reads from homologous genes in different organisms. In shotgun metagenomics DNA is fragmented in some way and those fragments sequenced, generating reads from throughout the genome of the different community members. For both amplicons and shotgun reads it is possible to classify sequence reads against known taxa, and determine a list of those organisms that are present and the read frequency associated with them <xref rid="pone.0030126-Wang1" ref-type="bibr">[5]</xref>. For the majority of environments, many organisms will not have been taxonomically classified and sequenced before, in which case the list of taxa may have to be generated at a low resolution phylogenetic level, e.g. phylum, to achieve a reasonable proportion of classified reads. Alternatively, an unsupervised strategy can be used to identify proxies to traditional taxonomic units by clustering sequences, so called Operational Taxonomic Units (OTUs) <xref rid="pone.0030126-Schloss1" ref-type="bibr">[6]</xref>. This is commonly performed in the case of homologous marker genes from amplicons but can also be applied to shotgun metagenomics data <xref rid="pone.0030126-Schloss2" ref-type="bibr">[7]</xref>. Whether supervised or unsupervised approaches are used the end result is the same: a community is represented by a list of types, either taxa or OTUs, and their frequency. For shotgun metagenomics data much more analysis is possible, utilising information about the function of genes that are sequenced, but here we will focus on the analysis of community structure generated by microbial metagenomics. Typically, this will be generated as amplicons, which typically will be 454 pyrosequenced, but we would emphasise that the approach can be applied to any list of taxa or OTUs with discrete abundances.</p>
    <p>Early studies of microbial communities focussed on cataloguing diversity in individual samples, asking: how many different taxa or OTUs were present <xref rid="pone.0030126-Sogin1" ref-type="bibr">[8]</xref>, <xref rid="pone.0030126-Huber1" ref-type="bibr">[9]</xref>? A striking result was that the observed diversity was very high, and that most species were observed with low abundance; this phenomenon has been termed the ‘rare biosphere’ <xref rid="pone.0030126-Sogin1" ref-type="bibr">[8]</xref>. These early studies ignored the impact of sequencing and PCR errors which can inflate OTU diversities <xref rid="pone.0030126-Quince1" ref-type="bibr">[10]</xref>, but even after the application of algorithms capable of removing those errors <xref rid="pone.0030126-Quince2" ref-type="bibr">[11]</xref>, observed diversities remain high in most environments and abundances are still skewed to low abundances in almost all <xref rid="pone.0030126-Quince1" ref-type="bibr">[10]</xref>, <xref rid="pone.0030126-Turnbaugh1" ref-type="bibr">[12]</xref>. The consequence of this is that even with very large read numbers we will have only sampled a fraction of the true diversity <xref rid="pone.0030126-Quince3" ref-type="bibr">[13]</xref>.</p>
    <p>The natural extension to examining the diversity in an individual sample is to look at patterns across samples from similar environments. Barcoding allows multiple samples to be sequenced in a single run but difficulties quantifying DNA concentration means that the number of reads from each sample will usually vary substantially <xref rid="pone.0030126-Hamady1" ref-type="bibr">[14]</xref>. Sub-sampling can be used to reduce all samples to the same size but that inevitably throws away large amounts of meaningful data. The majority of studies have used exploratory statistics to search for natural patterns in the data, unsupervised learning again. A common strategy is to use multivariate ordination techniques, where samples are positioned in a space of reduced dimensionality so as to preserve the distances between them in the original higher dimensional space; often two or three dimensional ordinations are used and then it is possible to look for patterns by eye. A classic example of an ordination method is principal components analysis (PCA), which generates new dimensions that are linear combinations of the original, chosen so as to preserve the Euclidean distance between samples <xref rid="pone.0030126-Ramette1" ref-type="bibr">[15]</xref>. Euclidean distances are not very appropriate for microbial community analysis, much better is to use measures that incorporate the phylogentic divergence between types, e.g. Unifrac <xref rid="pone.0030126-Lozupone1" ref-type="bibr">[16]</xref>. Ordination can be performed with arbitrary distance metrics using multidimensional scaling methods, these can be either metric in that they preserve distances or non-metric in that they preserve the ranking of the distances. An example of a metric multidimensional scaling is principal coordinates analysis which has proven a useful and popular tool when coupled with Unifrac for exploratory data analysis <xref rid="pone.0030126-Caporaso2" ref-type="bibr">[17]</xref>.</p>
    <p>Clustering is another means of exploratory data analysis which searches for natural groups or partitions in the samples. Hierarchical clustering, where a tree of relationships is generated without explicitly grouping samples unless an arbitrary cut-off is chosen, is quite commonly used in microbial community analyses, partitional clustering where the samples are divided into groups has traditionally been less popular. This may be because of the need to decide <italic>a priori</italic> how many clusters are present. Generally variants of the <inline-formula><inline-graphic xlink:href="pone.0030126.e001.jpg" mimetype="image"/></inline-formula>-means algorithm have been used together with heuristics to decide how good a clustering is. To date there has been no model based clustering of microbial community data. This question of the natural number of types of communities has received particular attention recently in the context of the human gut, for which it has been suggested that three microbial community types, known as envirotypes (or, in the context of the gut, enterotypes) are to be found <xref rid="pone.0030126-Arumugam1" ref-type="bibr">[18]</xref>. Classification, or supervised learning, is closely related to clustering, except here the problem is not to find natural groups in the data but to predict the group of a new sample, given a labelling of samples in a training data set. Two studies applying classification methods to microbial communities have appeared recently <xref rid="pone.0030126-Sun1" ref-type="bibr">[19]</xref>, <xref rid="pone.0030126-Knights1" ref-type="bibr">[20]</xref>. Most of the algorithms used were, as for the unsupervised approaches, developed for continuous data with the notable exception of the multinomial naive Bayes (MNB) model in Knights et al. (2001) <xref rid="pone.0030126-Knights1" ref-type="bibr">[20]</xref>.</p>
    <p>There are, however, problems inherent in using standard multivariate techniques for the analysis of microbial metagenomics data. The data, even if normalised into relative abundances, is fundamentally discrete and can only be approximately modelled by continuous variables. In addition, the high diversity (relative to sampling effort) results in very sparse data sets; most taxa appear in only a few samples at low abundance. Finally, the samples vary in read number: a small sample will inherently be more noisy than a larger one. All these issues can be addressed using an explicit sampling scheme. Instead of viewing the sample as representing the community, we view it as having being generated by sampling from the community. The most natural assumption to make is sampling with replacement, so that the likelihood of an observed sample is a multinomial distribution with a parameter vector where a given entry represents the probability that a read is from a given taxa. These probabilities in the limit of very large community sizes will become the relative frequencies of the taxa. This provides a discrete model, that accounts for different sample sizes, and can model sparse data.</p>
    <p>We will show how this multinomial sampling can be used as a starting point for a generative modelling framework, one that explicitly describes a model for generating the observed data <xref rid="pone.0030126-Bishop1" ref-type="bibr">[21]</xref>. This provides model-based alternatives for both clustering and classification of microbial communities. The natural prior for the parameters of the multinomial distribution is the Dirichlet. This is a probability distribution over probability vectors. In the context of microbial communities we can view it as describing a metacommunity from which communities can be sampled. Its parameters then describe both the mean expected community and the variance in the communities. As we will show, one of the major advantages of the Dirichlet prior is that the community parameter vectors which are unobserved can be integrated out or marginalised to give an analytic solution to the <italic>evidence</italic>: the probability that the data was generated by the model. By extending the Dirichlet prior to a mixture of Dirichlets <xref rid="pone.0030126-Sjolander1" ref-type="bibr">[22]</xref>–<xref rid="pone.0030126-Bouguila1" ref-type="bibr">[24]</xref>, so that the data set is generated not by a single metacommunity but a mixture of multiple metacommunities, we obtain both a more flexible model for our data and a means to cluster communities. To perform the clustering, we simply impute for each sample the component which is most likely to have generated it. This separates samples into groups according to the metacommunity it has the highest probability of deriving from. The advantage of this approach over simple <inline-formula><inline-graphic xlink:href="pone.0030126.e002.jpg" mimetype="image"/></inline-formula>-means type strategies is twofold: (1) the clusters can be of different sizes depending on the variability of the metacommunity, and more importantly (2) because we now have an explicit probabilistic model that is appropriate to the data, then we can use the evidence together with methods to penalise model complexity to provide a rigorous means of determining optimal cluster number.</p>
    <p>Multinomial sampling has been used previously in the study of microbial communities <xref rid="pone.0030126-Knights1" ref-type="bibr">[20]</xref>, and it has been coupled with a Dirichlet prior <xref rid="pone.0030126-D1" ref-type="bibr">[25]</xref>, but the extension of that prior to a mixture of Dirichlet components in this context is completely novel, as is the explicit association of each Dirichlet component with a different metacommunity. The major challenge for our framework is how to fit the Dirichlet mixture given the very large dimensionality of microbial metagenomics data sets. This will make Gibbs sampling to obtain posterior distributions for the Dirichlet parameters challenging, at least for OTU based data sets. Instead, we utilise the analytic form for the evidence and fit the Dirichlet parameters by maximising this, given a gamma hyperprior distribution for those parameters, this is an example of the ‘evidence framework’ <xref rid="pone.0030126-Mackay1" ref-type="bibr">[26]</xref>. In practice, this is achieved by coupling an Expectation-Maximisation (EM) algorithm for the Dirichlet mixture parameters with multi-dimensional optimisation of each component's parameters. To answer the crucial question of model fit, we use a Laplace approximation to integrate out the hyperparameters, and estimate the evidence of the complete model. In contrast, the extension to a classifier is relatively simple. We simply fit the model to the different classes, estimate priors as the frequencies of the classes in the training data, and then use Bayes' theorem to calculate the probability that a sample to be classified was generated from each of the classes. We now explain in more detail the model framework and illustrate its utility by application to two example data sets of human gut microbiota <xref rid="pone.0030126-Turnbaugh2" ref-type="bibr">[27]</xref>, <xref rid="pone.0030126-Willing1" ref-type="bibr">[28]</xref>.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <sec id="s2a">
      <title>Multinomial sampling</title>
      <p>Our starting point is a matrix of occupancies <inline-formula><inline-graphic xlink:href="pone.0030126.e003.jpg" mimetype="image"/></inline-formula> with elements <inline-formula><inline-graphic xlink:href="pone.0030126.e004.jpg" mimetype="image"/></inline-formula> that give the observed abundance of taxa <inline-formula><inline-graphic xlink:href="pone.0030126.e005.jpg" mimetype="image"/></inline-formula> in community sample <inline-formula><inline-graphic xlink:href="pone.0030126.e006.jpg" mimetype="image"/></inline-formula> where <inline-formula><inline-graphic xlink:href="pone.0030126.e007.jpg" mimetype="image"/></inline-formula> runs from 1 to the total number of taxa <inline-formula><inline-graphic xlink:href="pone.0030126.e008.jpg" mimetype="image"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0030126.e009.jpg" mimetype="image"/></inline-formula> from 1 to the total number of communities <inline-formula><inline-graphic xlink:href="pone.0030126.e010.jpg" mimetype="image"/></inline-formula>. We will denote the rows of this matrix that give the occupancies in each individual community sample by the <inline-formula><inline-graphic xlink:href="pone.0030126.e011.jpg" mimetype="image"/></inline-formula> vectors <inline-formula><inline-graphic xlink:href="pone.0030126.e012.jpg" mimetype="image"/></inline-formula>. We assume that each community sample is generated from a multinomial distribution with parameter vector <inline-formula><inline-graphic xlink:href="pone.0030126.e013.jpg" mimetype="image"/></inline-formula>. The elements of <inline-formula><inline-graphic xlink:href="pone.0030126.e014.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0030126.e015.jpg" mimetype="image"/></inline-formula>, are the probabilities that an individual read taken from community <inline-formula><inline-graphic xlink:href="pone.0030126.e016.jpg" mimetype="image"/></inline-formula> belongs to species <inline-formula><inline-graphic xlink:href="pone.0030126.e017.jpg" mimetype="image"/></inline-formula>. The multinomial distribution corresponds to sampling with replacement from the community. This gives a likelihood for observing each community sample:<disp-formula><graphic xlink:href="pone.0030126.e018.jpg" mimetype="image" position="float"/><label>(1)</label></disp-formula>where the <inline-formula><inline-graphic xlink:href="pone.0030126.e019.jpg" mimetype="image"/></inline-formula> are the total number of reads from each community <inline-formula><inline-graphic xlink:href="pone.0030126.e020.jpg" mimetype="image"/></inline-formula>. The total likelihood is the product of the community sample likelihoods:<disp-formula><graphic xlink:href="pone.0030126.e021.jpg" mimetype="image" position="float"/></disp-formula>
</p>
    </sec>
    <sec id="s2b">
      <title>Dirichlet mixture priors</title>
      <p>In a Bayesian approach we now need to define a prior distribution for the multinomial parameter probability vectors <inline-formula><inline-graphic xlink:href="pone.0030126.e022.jpg" mimetype="image"/></inline-formula>. We will refer to these as ‘communities’ since they reflect the underlying structure of the community <inline-formula><inline-graphic xlink:href="pone.0030126.e023.jpg" mimetype="image"/></inline-formula> that is sampled. A prior based on the Dirichlet distribution is natural, as it is conjugate to the multinomial and (as we will discuss) has a number of convenient properties. The Dirichlet is a probability distribution over distributions:<disp-formula><graphic xlink:href="pone.0030126.e024.jpg" mimetype="image" position="float"/><label>(2)</label></disp-formula>This distribution has <inline-formula><inline-graphic xlink:href="pone.0030126.e025.jpg" mimetype="image"/></inline-formula> parameters which we can represent as a vector <inline-formula><inline-graphic xlink:href="pone.0030126.e026.jpg" mimetype="image"/></inline-formula> that is a measure i.e. all elements are strictly positive, <inline-formula><inline-graphic xlink:href="pone.0030126.e027.jpg" mimetype="image"/></inline-formula>. We can express <inline-formula><inline-graphic xlink:href="pone.0030126.e028.jpg" mimetype="image"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0030126.e029.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0030126.e030.jpg" mimetype="image"/></inline-formula> is a normalised measure with <inline-formula><inline-graphic xlink:href="pone.0030126.e031.jpg" mimetype="image"/></inline-formula>. The elements <inline-formula><inline-graphic xlink:href="pone.0030126.e032.jpg" mimetype="image"/></inline-formula> then give the mean <inline-formula><inline-graphic xlink:href="pone.0030126.e033.jpg" mimetype="image"/></inline-formula> values and the value <inline-formula><inline-graphic xlink:href="pone.0030126.e034.jpg" mimetype="image"/></inline-formula> acts like a precision, determining how close the values lie to that mean: a large <inline-formula><inline-graphic xlink:href="pone.0030126.e035.jpg" mimetype="image"/></inline-formula> gives little variance about the mean values, while a small <inline-formula><inline-graphic xlink:href="pone.0030126.e036.jpg" mimetype="image"/></inline-formula> leads to widely distributed samples. Conceptually we view these parameters as describing a ‘metacommunity’, from which different communities can be sampled. The Dirac delta function ensures normalisation, i.e. <inline-formula><inline-graphic xlink:href="pone.0030126.e037.jpg" mimetype="image"/></inline-formula>.</p>
      <p>To provide a more flexible modelling framework and to allow clustering we extend this single Dirichlet prior to a mixture of <inline-formula><inline-graphic xlink:href="pone.0030126.e038.jpg" mimetype="image"/></inline-formula> Dirichlets, indexed <inline-formula><inline-graphic xlink:href="pone.0030126.e039.jpg" mimetype="image"/></inline-formula>, each with parameters <inline-formula><inline-graphic xlink:href="pone.0030126.e040.jpg" mimetype="image"/></inline-formula> and weight <inline-formula><inline-graphic xlink:href="pone.0030126.e041.jpg" mimetype="image"/></inline-formula>
<xref rid="pone.0030126-Sjolander1" ref-type="bibr">[22]</xref>, <xref rid="pone.0030126-X1" ref-type="bibr">[23]</xref>. Each community vector <inline-formula><inline-graphic xlink:href="pone.0030126.e042.jpg" mimetype="image"/></inline-formula> is assumed to derive from a single metacommunity. For each sample <inline-formula><inline-graphic xlink:href="pone.0030126.e043.jpg" mimetype="image"/></inline-formula>, we represent this using a <inline-formula><inline-graphic xlink:href="pone.0030126.e044.jpg" mimetype="image"/></inline-formula>-dimensional indicator vector <inline-formula><inline-graphic xlink:href="pone.0030126.e045.jpg" mimetype="image"/></inline-formula> that consists of zeros except for the entry corresponding to the metacommunity that sample <inline-formula><inline-graphic xlink:href="pone.0030126.e046.jpg" mimetype="image"/></inline-formula> derives from which is equal to one. The prior probabilities for the vectors <inline-formula><inline-graphic xlink:href="pone.0030126.e047.jpg" mimetype="image"/></inline-formula> are then just the mixture weights, so:<disp-formula><graphic xlink:href="pone.0030126.e048.jpg" mimetype="image" position="float"/><label>(3)</label></disp-formula>and the complete mixture prior is:<disp-formula><graphic xlink:href="pone.0030126.e049.jpg" mimetype="image" position="float"/><label>(4)</label></disp-formula>where the Dirichlet distribution is given by Equation 2 , and the mixture prior hyperparameters are <inline-formula><inline-graphic xlink:href="pone.0030126.e050.jpg" mimetype="image"/></inline-formula>.</p>
      <p>The numerical behaviour of the model can be improved by placing independent and identically distributed Gamma hyperpriors on the Dirichlet parameters <inline-formula><inline-graphic xlink:href="pone.0030126.e051.jpg" mimetype="image"/></inline-formula>, i.e., <inline-formula><inline-graphic xlink:href="pone.0030126.e052.jpg" mimetype="image"/></inline-formula>. Thus,<disp-formula><graphic xlink:href="pone.0030126.e053.jpg" mimetype="image" position="float"/><label>(5)</label></disp-formula>as we will later use the following reparameterisation: <inline-formula><inline-graphic xlink:href="pone.0030126.e054.jpg" mimetype="image"/></inline-formula>, the change of variables formula for probability density functions was used to convert the prior for <inline-formula><inline-graphic xlink:href="pone.0030126.e055.jpg" mimetype="image"/></inline-formula> into one for <inline-formula><inline-graphic xlink:href="pone.0030126.e056.jpg" mimetype="image"/></inline-formula>, which yields the result that:<disp-formula><graphic xlink:href="pone.0030126.e057.jpg" mimetype="image" position="float"/><label>(6)</label></disp-formula>
</p>
    </sec>
    <sec id="s2c">
      <title>Posterior distribution of the multinomial parameters</title>
      <p>The posterior distribution of the community parameters is obtained by multiplying the Dirichlet mixture prior by the multinomial likelihood ( Equation 1 ) and appropriately normalising to give for community <inline-formula><inline-graphic xlink:href="pone.0030126.e058.jpg" mimetype="image"/></inline-formula>:<disp-formula><graphic xlink:href="pone.0030126.e059.jpg" mimetype="image" position="float"/><label>(7)</label></disp-formula>The Dirichlet is a conjugate prior for the multinomial: for a single Dirichlet the posterior is itself a Dirichlet with parameters obtained by summing the observed counts and the Dirichlet parameters, <inline-formula><inline-graphic xlink:href="pone.0030126.e060.jpg" mimetype="image"/></inline-formula>. For the Dirichlet mixture this conjugacy is maintained and Equation 7 can also be written as a Dirichlet mixture:<disp-formula><graphic xlink:href="pone.0030126.e061.jpg" mimetype="image" position="float"/><label>(8)</label></disp-formula>We will discuss the calculation of the posterior probabilities, <inline-formula><inline-graphic xlink:href="pone.0030126.e062.jpg" mimetype="image"/></inline-formula>, for a sample deriving from a metacommunity below.</p>
    </sec>
    <sec id="s2d">
      <title>Marginalising the multinomial parameters</title>
      <p>The denominator of Equation 7 is equivalent to <inline-formula><inline-graphic xlink:href="pone.0030126.e063.jpg" mimetype="image"/></inline-formula>, the evidence for community sample <inline-formula><inline-graphic xlink:href="pone.0030126.e064.jpg" mimetype="image"/></inline-formula>. This is obtained by integrating the numerator, i.e. the mixture prior <inline-formula><inline-graphic xlink:href="pone.0030126.e065.jpg" mimetype="image"/></inline-formula> multiplied by the likelihood <inline-formula><inline-graphic xlink:href="pone.0030126.e066.jpg" mimetype="image"/></inline-formula>, over all possible community priors. It is the complete probability of observing this data marginalising out the unseen vector of probabilities <inline-formula><inline-graphic xlink:href="pone.0030126.e067.jpg" mimetype="image"/></inline-formula>. One of the useful properties of the Dirichlet prior is that this evidence has a closed form. So focussing on just a single mixture component <inline-formula><inline-graphic xlink:href="pone.0030126.e068.jpg" mimetype="image"/></inline-formula>:<disp-formula><graphic xlink:href="pone.0030126.e069.jpg" mimetype="image" position="float"/></disp-formula>
<disp-formula><graphic xlink:href="pone.0030126.e070.jpg" mimetype="image" position="float"/></disp-formula>where the function <inline-formula><inline-graphic xlink:href="pone.0030126.e071.jpg" mimetype="image"/></inline-formula> is the multinomial Beta function and can be expressed in terms of Gamma functions as:<disp-formula><graphic xlink:href="pone.0030126.e072.jpg" mimetype="image" position="float"/></disp-formula>So far we have considered the posterior and evidence for just a single community sample <inline-formula><inline-graphic xlink:href="pone.0030126.e073.jpg" mimetype="image"/></inline-formula>. The evidence over all samples is just the product of the evidences for each sample:<disp-formula><graphic xlink:href="pone.0030126.e074.jpg" mimetype="image" position="float"/><label>(9)</label></disp-formula>
</p>
    </sec>
    <sec id="s2e">
      <title>EM algorithm for fitting the mixture of Dirichlets prior</title>
      <p>Our strategy for fitting the mixture of Dirichlets is to maximise the evidence given the gamma hyperpriors. The strictly Bayesian approach would be to sample from the unobserved hyperparameters, <inline-formula><inline-graphic xlink:href="pone.0030126.e075.jpg" mimetype="image"/></inline-formula>, and latent variables <inline-formula><inline-graphic xlink:href="pone.0030126.e076.jpg" mimetype="image"/></inline-formula>, given the hyperpriors, using Markov chain Monte Carlo (MCMC), and then marginalise. This would be computationally challenging for the high dimensional <inline-formula><inline-graphic xlink:href="pone.0030126.e077.jpg" mimetype="image"/></inline-formula> vectors that are encountered in microbiomics data. Maximising the evidence allows us to obtain a single parameter vector that will correspond to the most likely set of parameters given the gamma hyperpriors. The technique is well established and is known as the ‘evidence framework’ <xref rid="pone.0030126-Bishop1" ref-type="bibr">[21]</xref>, <xref rid="pone.0030126-Mackay1" ref-type="bibr">[26]</xref>. The posterior distribution of the hyperparameters is given by the product of the evidence (Equation 9) and the hyperprior for the <inline-formula><inline-graphic xlink:href="pone.0030126.e078.jpg" mimetype="image"/></inline-formula> given by Equation 5. Strictly, to distinguish this from the posterior of the multinomial parameters we should refer to this as the marginal posterior distribution but our meaning should be clear from the context used. We are also implicitly assuming uniform hyperpriors for the other components of <inline-formula><inline-graphic xlink:href="pone.0030126.e079.jpg" mimetype="image"/></inline-formula>, the mixing coefficients <inline-formula><inline-graphic xlink:href="pone.0030126.e080.jpg" mimetype="image"/></inline-formula>. Maximising the posterior of the hyperparameters is equivalent to maximising the log posterior of the hyperparameters, <inline-formula><inline-graphic xlink:href="pone.0030126.e081.jpg" mimetype="image"/></inline-formula>. Thus:<disp-formula><graphic xlink:href="pone.0030126.e082.jpg" mimetype="image" position="float"/></disp-formula>where<disp-formula><graphic xlink:href="pone.0030126.e083.jpg" mimetype="image" position="float"/><label>(10)</label></disp-formula>
</p>
      <p>We now use a binary latent variable matrix <inline-formula><inline-graphic xlink:href="pone.0030126.e084.jpg" mimetype="image"/></inline-formula> with elements <inline-formula><inline-graphic xlink:href="pone.0030126.e085.jpg" mimetype="image"/></inline-formula> that are 1 if the <inline-formula><inline-graphic xlink:href="pone.0030126.e086.jpg" mimetype="image"/></inline-formula>th community sample belongs to the <inline-formula><inline-graphic xlink:href="pone.0030126.e087.jpg" mimetype="image"/></inline-formula>th metacommunity and 0 otherwise. The rows of this matrix are the <inline-formula><inline-graphic xlink:href="pone.0030126.e088.jpg" mimetype="image"/></inline-formula> vectors introduced above. This allows us to maximise the log posterior distribution using the popular expectation-maximisation (EM) algorithm <xref rid="pone.0030126-Bishop1" ref-type="bibr">[21]</xref>. Augmenting the data with these latent variables, the evidence and log posterior distribution, respectively, become:<disp-formula><graphic xlink:href="pone.0030126.e089.jpg" mimetype="image" position="float"/></disp-formula>
<disp-formula><graphic xlink:href="pone.0030126.e090.jpg" mimetype="image" position="float"/></disp-formula>Using Jensen's inequality we obtain a lower bound for the expected log posterior distribution:<disp-formula><graphic xlink:href="pone.0030126.e091.jpg" mimetype="image" position="float"/><label>(11)</label></disp-formula>We can calculate <inline-formula><inline-graphic xlink:href="pone.0030126.e092.jpg" mimetype="image"/></inline-formula> as follows:<disp-formula><graphic xlink:href="pone.0030126.e093.jpg" mimetype="image" position="float"/><label>(12)</label></disp-formula>where we have used Bayes' theorem and <inline-formula><inline-graphic xlink:href="pone.0030126.e094.jpg" mimetype="image"/></inline-formula>.</p>
      <p>Following Sjölander <italic>et al</italic> (1996) <xref rid="pone.0030126-Sjolander1" ref-type="bibr">[22]</xref>, we now reparameterise and optimise the expected log posterior distribution with respect to these new parameters: to keep the <inline-formula><inline-graphic xlink:href="pone.0030126.e095.jpg" mimetype="image"/></inline-formula>'s positive, we set <inline-formula><inline-graphic xlink:href="pone.0030126.e096.jpg" mimetype="image"/></inline-formula>, and to keep the <inline-formula><inline-graphic xlink:href="pone.0030126.e097.jpg" mimetype="image"/></inline-formula>'s normalised, we set <inline-formula><inline-graphic xlink:href="pone.0030126.e098.jpg" mimetype="image"/></inline-formula>. Optimising <inline-formula><inline-graphic xlink:href="pone.0030126.e099.jpg" mimetype="image"/></inline-formula> with respect to <inline-formula><inline-graphic xlink:href="pone.0030126.e100.jpg" mimetype="image"/></inline-formula> is equivalent to solving the following equation:<disp-formula><graphic xlink:href="pone.0030126.e101.jpg" mimetype="image" position="float"/></disp-formula>Rearranging this equation we obtain:<disp-formula><graphic xlink:href="pone.0030126.e102.jpg" mimetype="image" position="float"/></disp-formula>and thus:<disp-formula><graphic xlink:href="pone.0030126.e103.jpg" mimetype="image" position="float"/><label>(13)</label></disp-formula>
</p>
      <p>Our EM algorithm to find <inline-formula><inline-graphic xlink:href="pone.0030126.e104.jpg" mimetype="image"/></inline-formula> thus alternates between updating the responsibilities <inline-formula><inline-graphic xlink:href="pone.0030126.e105.jpg" mimetype="image"/></inline-formula>, the mixing coefficients <inline-formula><inline-graphic xlink:href="pone.0030126.e106.jpg" mimetype="image"/></inline-formula> and the Dirichlet parameters <inline-formula><inline-graphic xlink:href="pone.0030126.e107.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0030126.e108.jpg" mimetype="image"/></inline-formula>:</p>
      <list list-type="bullet">
        <list-item>
          <p>Calculate <inline-formula><inline-graphic xlink:href="pone.0030126.e109.jpg" mimetype="image"/></inline-formula> using Equation 12.</p>
        </list-item>
        <list-item>
          <p>Update <inline-formula><inline-graphic xlink:href="pone.0030126.e110.jpg" mimetype="image"/></inline-formula> by finding parameters that minimise the negative of Equation 11. In practice we used the Broyden-Fletcher-Goldfarb-Shanno (BFGS) algorithm as implemented in the Gnu Science Library <xref rid="pone.0030126-Galassi1" ref-type="bibr">[29]</xref>.</p>
        </list-item>
        <list-item>
          <p>Calculate <inline-formula><inline-graphic xlink:href="pone.0030126.e111.jpg" mimetype="image"/></inline-formula> using Equation 13.</p>
        </list-item>
        <list-item>
          <p>Repeat until convergence of <inline-formula><inline-graphic xlink:href="pone.0030126.e112.jpg" mimetype="image"/></inline-formula>, which can be calculated from Equation 11.</p>
        </list-item>
      </list>
      <p>We will refer to the hyperparameter values obtained by this method as the maximum posterior estimates (MPE).</p>
      <sec id="s2e1">
        <title>Model comparison through Laplace approximation</title>
        <p>We need to determine the number of components <inline-formula><inline-graphic xlink:href="pone.0030126.e113.jpg" mimetype="image"/></inline-formula> in the Dirichlet mixture. We cannot simply choose the one with the largest log posterior, <inline-formula><inline-graphic xlink:href="pone.0030126.e114.jpg" mimetype="image"/></inline-formula>, as this takes no account of model complexity: as the number of components is increased, <inline-formula><inline-graphic xlink:href="pone.0030126.e115.jpg" mimetype="image"/></inline-formula> must increase. We could use a heuristic like the Aikaike Information Criterion (AIC) or Bayesian Information Criterion (BIC) to penalise the model parameters but these can give misleading results <xref rid="pone.0030126-Bishop1" ref-type="bibr">[21]</xref>. Better is to take a fully Bayesian approach to model comparison where probabilities are used to represent uncertainty in the choice of model. Applying Bayes' theorem, the posterior probability of the <inline-formula><inline-graphic xlink:href="pone.0030126.e116.jpg" mimetype="image"/></inline-formula> component model <inline-formula><inline-graphic xlink:href="pone.0030126.e117.jpg" mimetype="image"/></inline-formula> given the data matrix <inline-formula><inline-graphic xlink:href="pone.0030126.e118.jpg" mimetype="image"/></inline-formula> is:<disp-formula><graphic xlink:href="pone.0030126.e119.jpg" mimetype="image" position="float"/></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0030126.e120.jpg" mimetype="image"/></inline-formula> is the prior probability for the <inline-formula><inline-graphic xlink:href="pone.0030126.e121.jpg" mimetype="image"/></inline-formula> component model, which allows us to express a preference for different models, and <inline-formula><inline-graphic xlink:href="pone.0030126.e122.jpg" mimetype="image"/></inline-formula> is the model evidence, which expresses the preference of the data for different models. In our case, the model evidence is given by:<disp-formula><graphic xlink:href="pone.0030126.e123.jpg" mimetype="image" position="float"/></disp-formula>This integral cannot be calculated analytically, but it can be estimated using the Laplace approximation:<disp-formula><graphic xlink:href="pone.0030126.e124.jpg" mimetype="image" position="float"/><label>(14)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0030126.e125.jpg" mimetype="image"/></inline-formula> is the number of parameters in <inline-formula><inline-graphic xlink:href="pone.0030126.e126.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0030126.e127.jpg" mimetype="image"/></inline-formula> are the parameters maximising the posterior distribution, and <inline-formula><inline-graphic xlink:href="pone.0030126.e128.jpg" mimetype="image"/></inline-formula> is the Hessian matrix of second derivatives of the negative log posterior evaluated at <inline-formula><inline-graphic xlink:href="pone.0030126.e129.jpg" mimetype="image"/></inline-formula>:<disp-formula><graphic xlink:href="pone.0030126.e130.jpg" mimetype="image" position="float"/><label>(15)</label></disp-formula>Thus,<disp-formula><graphic xlink:href="pone.0030126.e131.jpg" mimetype="image" position="float"/></disp-formula>
</p>
        <p>The nonzero elements of the Hessian matrix are given below:<disp-formula><graphic xlink:href="pone.0030126.e132.jpg" mimetype="image" position="float"/></disp-formula>
<disp-formula><graphic xlink:href="pone.0030126.e133.jpg" mimetype="image" position="float"/></disp-formula>
<disp-formula><graphic xlink:href="pone.0030126.e134.jpg" mimetype="image" position="float"/></disp-formula>and<disp-formula><graphic xlink:href="pone.0030126.e135.jpg" mimetype="image" position="float"/></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0030126.e136.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0030126.e137.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0030126.e138.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0030126.e139.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0030126.e140.jpg" mimetype="image"/></inline-formula>. In the results we will give the negative of Equation 14 so that a better fit corresponds to a smaller value. The Hessian also allows us to calculate uncertainties in the parameter estimates of <inline-formula><inline-graphic xlink:href="pone.0030126.e141.jpg" mimetype="image"/></inline-formula>, through computing the inverse, then the diagonal elements give the variance of the corresponding parameter.</p>
      </sec>
    </sec>
    <sec id="s2f">
      <title>Data Sets</title>
      <sec id="s2f1">
        <title>Twins</title>
        <p>To illustrate the application of these ideas to a real data set we reanalysed a study of the gut microbiomes of twins and their mothers <xref rid="pone.0030126-Turnbaugh2" ref-type="bibr">[27]</xref>. These comprised faecal samples from 154 different individuals characterised by family and body mass index – ‘Lean’, ‘Obese’ and ‘Overweight’. Each individual was sampled at two time points approximately two months apart. The V2 hypervariable region of the 16S rRNA gene was amplified by PCR and then sequenced using 454. We reanalysed this data set filtering the reads, denoising and removing chimeras using the AmpliconNoise pipeline <xref rid="pone.0030126-Quince1" ref-type="bibr">[10]</xref>, <xref rid="pone.0030126-Quince2" ref-type="bibr">[11]</xref>. Denoised reads were then classified to the genus level using the RDP stand-alone classifier <xref rid="pone.0030126-Wang1" ref-type="bibr">[5]</xref>. This gave a total of 570,851 reads split over 278 samples since of the 308 possible some failed to possess any reads following filtering. The size of individual samples varied from just 53 to 10,585 with a median of 1,599. A total of 129 different genera were observed with a genera diversity per sample that varied from just 12 to 50 with a median of 28. One extra category ‘Unknown’ was used for those reads that failed to be classified with greater than 50% bootstrap certainty. We will refer to this as the ‘Twins’ data set.</p>
      </sec>
      <sec id="s2f2">
        <title>IBD</title>
        <p>We also include a brief analysis of microbiome data from a study of inflammatory bowel diseases (IBDs) <xref rid="pone.0030126-Willing1" ref-type="bibr">[28]</xref>. This comprised faecal samples from 78 individuals where the V5-6 region of the 16S rRNA gene was pyrosequenced using 454. 35 samples were from healthy individuals, 12 from individuals with colonic Crohn's disease (CCD), 15 from individuals exhibiting ileal Crohn's disease (ICD), and 16 from individuals with ulcerative colitis (UC). We processed the data as above. This gave a total of 134,276 reads with individual samples varying in size from 394 to 3,258 with a median of 1,710 reads. 93 separate genera were observed in these samples with a genera diversity per sample that varied from 8 to 33 with a median of 22.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results</title>
    <sec id="s3a">
      <title>Clustering Twins data at the metacommunity level</title>
      <p>The mixture of Dirichlets prior can be used to cluster samples at the metacommunity level. Assuming each sample represents a unique community, we can try to infer which metacommunity that community is most likely to have originated from. This is the component for which the posterior probability of each membership is the highest, i.e. the value of <inline-formula><inline-graphic xlink:href="pone.0030126.e142.jpg" mimetype="image"/></inline-formula> that maximizes <inline-formula><inline-graphic xlink:href="pone.0030126.e143.jpg" mimetype="image"/></inline-formula> for a particular sample <inline-formula><inline-graphic xlink:href="pone.0030126.e144.jpg" mimetype="image"/></inline-formula>. We will denote this value as <inline-formula><inline-graphic xlink:href="pone.0030126.e145.jpg" mimetype="image"/></inline-formula>. These posterior probabilities will be the equilibrium values of the <inline-formula><inline-graphic xlink:href="pone.0030126.e146.jpg" mimetype="image"/></inline-formula> calculated by the EM fitting algorithm.</p>
      <p>To use the mixture of Dirichlets prior for clustering at the metacommunity level we first need to determine what the number of clusters or mixture components <inline-formula><inline-graphic xlink:href="pone.0030126.e147.jpg" mimetype="image"/></inline-formula> should be. To do this we fitted Dirichlet mixtures by minimising the negative log posterior as described above. To calculate model fit accounting for complexity we then used the Laplace approximation to the model evidence. We did this for increasing values of <inline-formula><inline-graphic xlink:href="pone.0030126.e148.jpg" mimetype="image"/></inline-formula> starting with just a single component <inline-formula><inline-graphic xlink:href="pone.0030126.e149.jpg" mimetype="image"/></inline-formula>. The results are shown in <xref ref-type="fig" rid="pone-0030126-g001">Figure 1</xref> where we see a minimum for <inline-formula><inline-graphic xlink:href="pone.0030126.e150.jpg" mimetype="image"/></inline-formula> suggesting, firstly, that a mixture of Dirichlets is more appropriate than a single Dirichlet prior for this data set and that, secondly, the mixture has four components.</p>
      <fig id="pone-0030126-g001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0030126.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Model fit for mixture of Dirichlets prior to Twins dataset.</title>
          <p>Evaluates model fit for increasing number of Dirichlet mixture components <inline-formula><inline-graphic xlink:href="pone.0030126.e151.jpg" mimetype="image"/></inline-formula> using the Laplace approximation to the negative log model evidence.</p>
        </caption>
        <graphic xlink:href="pone.0030126.g001"/>
      </fig>
      <p>The four components have weights <inline-formula><inline-graphic xlink:href="pone.0030126.e152.jpg" mimetype="image"/></inline-formula>. They differ also in how variable their communities are with <inline-formula><inline-graphic xlink:href="pone.0030126.e153.jpg" mimetype="image"/></inline-formula>. Therefore we have two less abundant highly variable clusters 1 and 4 and two more abundant homogeneous clusters 2 and 3. To graphically illustrate this optimal clustering in <xref ref-type="fig" rid="pone-0030126-g002">Figure 2</xref> we used non-metric multidimensional scaling (NMDS) to generate two-dimensional positions for each community sample, and the mean vectors associated with the four Dirichlet components <inline-formula><inline-graphic xlink:href="pone.0030126.e154.jpg" mimetype="image"/></inline-formula>, that reflect their Bray-Curtis distances using the isoMDS function of R <xref rid="pone.0030126-R1" ref-type="bibr">[30]</xref>. From this the higher variability in the first and fourth clusters is readily apparent. Another striking observation is that communities are not necessarily associated with the closest cluster mean. Partially this may reflect imperfect mapping to the two-dimensional space but it will also likely reflect properly accounting for sampling through the multinomial-Dirichlet structure.</p>
      <fig id="pone-0030126-g002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0030126.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>NMDS plot of Twins dataset with hierarchical cluster labellings.</title>
          <p>Samples arising from each of the four components are shown in red, green, blue and magenta, respectively. The black crosses indicate the Dirichlet means of each component.</p>
        </caption>
        <graphic xlink:href="pone.0030126.g002"/>
      </fig>
      <p>To explore the component composition we use the Dirichlet parameter vector obtained by fitting a single mixture to the data set as a reference, which we will denote <inline-formula><inline-graphic xlink:href="pone.0030126.e155.jpg" mimetype="image"/></inline-formula>. For interest <inline-formula><inline-graphic xlink:href="pone.0030126.e156.jpg" mimetype="image"/></inline-formula> a value that is intermediate to that of the four components. We can get a sense of how different the components are by calculating the sum of their posterior mean absolute differences to the reference <inline-formula><inline-graphic xlink:href="pone.0030126.e157.jpg" mimetype="image"/></inline-formula>. A quantity which will vary between 0 and 200% for metacommunities that are identical and completely dissimilar to the reference respectively. Calculating this gives 34%, 26%, 51% and 47% for the four components, and a total of 158%, indicating substantial differences in community structures for each component from the reference. How the different OTUs contribute to these differences is shown in <xref ref-type="table" rid="pone-0030126-t001">Table 1</xref>. Comparing the means of the posterior distributions for the four components we find that 30 out of 131 genera account for over 90% of this difference. The Bacteroides alone account for 29% of this difference. This genera is substantially over represented in the third cluster comprising nearly 39% of the community, close to the reference at 23% in the second cluster and observed at much lower proportions in the first and fourth clusters at around 7% and 8%, respectively. The next most significantly different category is actually ‘Unknown’ with nearly 15% more sequences failing to be classified with sufficient confidence in the fourth component, and 8% less in the third component than the reference. Faecilibacterium are substantially under-represented in the fourth component whereas Prevotella is mostly found in the first. The other genera exhibit various patterns but frequently we see over representation in one of or both the first and fourth clusters and little representation in the second and third e.g. Colinsella, Eubacterium, Streptococcus, et cetera.</p>
      <table-wrap id="pone-0030126-t001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0030126.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Genera frequencies in the Twins Clusters.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0030126-t001-1" xlink:href="pone.0030126.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Rank</td>
                <td align="left" rowspan="1" colspan="1">Genus</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0030126.e158.jpg" mimetype="image"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0030126.e159.jpg" mimetype="image"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0030126.e160.jpg" mimetype="image"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0030126.e161.jpg" mimetype="image"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0030126.e162.jpg" mimetype="image"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">Diff.</td>
                <td align="left" rowspan="1" colspan="1">C. Diff.</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">Bacteroides</td>
                <td align="left" rowspan="1" colspan="1">17.5</td>
                <td align="left" rowspan="1" colspan="1">5-6.8-8</td>
                <td align="left" rowspan="1" colspan="1">21-22.6-25</td>
                <td align="left" rowspan="1" colspan="1">35-38.8-43</td>
                <td align="left" rowspan="1" colspan="1">7-8.3-11</td>
                <td align="left" rowspan="1" colspan="1">46.3</td>
                <td align="left" rowspan="1" colspan="1">29.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">Unknown</td>
                <td align="left" rowspan="1" colspan="1">30.8</td>
                <td align="left" rowspan="1" colspan="1">26-29.1-33</td>
                <td align="left" rowspan="1" colspan="1">31-33.6-37</td>
                <td align="left" rowspan="1" colspan="1">20-22.4-25</td>
                <td align="left" rowspan="1" colspan="1">39-45.2-53</td>
                <td align="left" rowspan="1" colspan="1">27.2</td>
                <td align="left" rowspan="1" colspan="1">46.4</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">Faecalibacter.</td>
                <td align="left" rowspan="1" colspan="1">10.0</td>
                <td align="left" rowspan="1" colspan="1">12-13.8-16</td>
                <td align="left" rowspan="1" colspan="1">8-8.8-10</td>
                <td align="left" rowspan="1" colspan="1">12-13.8-16</td>
                <td align="left" rowspan="1" colspan="1">3-4.0-5</td>
                <td align="left" rowspan="1" colspan="1">14.9</td>
                <td align="left" rowspan="1" colspan="1">55.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">Prevotella</td>
                <td align="left" rowspan="1" colspan="1">0.60</td>
                <td align="left" rowspan="1" colspan="1">4.2-5.18-6.3</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.22-0.3</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.14-0.2</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.40-0.7</td>
                <td align="left" rowspan="1" colspan="1">5.6</td>
                <td align="left" rowspan="1" colspan="1">59.4</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">Alistipes</td>
                <td align="left" rowspan="1" colspan="1">2.33</td>
                <td align="left" rowspan="1" colspan="1">1.5-1.86-2.4</td>
                <td align="left" rowspan="1" colspan="1">3.5-4.02-4.7</td>
                <td align="left" rowspan="1" colspan="1">1.4-1.66-2.0</td>
                <td align="left" rowspan="1" colspan="1">0.7-0.99-1.4</td>
                <td align="left" rowspan="1" colspan="1">4.2</td>
                <td align="left" rowspan="1" colspan="1">62.0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">6</td>
                <td align="left" rowspan="1" colspan="1">Dorea</td>
                <td align="left" rowspan="1" colspan="1">2.71</td>
                <td align="left" rowspan="1" colspan="1">2.7-3.32-4.1</td>
                <td align="left" rowspan="1" colspan="1">1.2-1.49-1.8</td>
                <td align="left" rowspan="1" colspan="1">1.4-1.73-2.1</td>
                <td align="left" rowspan="1" colspan="1">3.1-4.05-5.3</td>
                <td align="left" rowspan="1" colspan="1">4.1</td>
                <td align="left" rowspan="1" colspan="1">64.6</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">Ruminococcus</td>
                <td align="left" rowspan="1" colspan="1">2.05</td>
                <td align="left" rowspan="1" colspan="1">1.9-2.36-3.0</td>
                <td align="left" rowspan="1" colspan="1">3.1-3.57-4.2</td>
                <td align="left" rowspan="1" colspan="1">0.8-0.95-1.2</td>
                <td align="left" rowspan="1" colspan="1">0.6-0.92-1.4</td>
                <td align="left" rowspan="1" colspan="1">4.1</td>
                <td align="left" rowspan="1" colspan="1">67.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">8</td>
                <td align="left" rowspan="1" colspan="1">Oscillibacter</td>
                <td align="left" rowspan="1" colspan="1">2.56</td>
                <td align="left" rowspan="1" colspan="1">2.3-2.84-3.5</td>
                <td align="left" rowspan="1" colspan="1">3.4-3.96-4.6</td>
                <td align="left" rowspan="1" colspan="1">1.3-1.59-1.9</td>
                <td align="left" rowspan="1" colspan="1">0.9-1.20-1.7</td>
                <td align="left" rowspan="1" colspan="1">4.0</td>
                <td align="left" rowspan="1" colspan="1">69.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">9</td>
                <td align="left" rowspan="1" colspan="1">Roseburia</td>
                <td align="left" rowspan="1" colspan="1">4.13</td>
                <td align="left" rowspan="1" colspan="1">3.0-3.63-4.5</td>
                <td align="left" rowspan="1" colspan="1">2.0-2.32-2.8</td>
                <td align="left" rowspan="1" colspan="1">3.9-4.47-5.2</td>
                <td align="left" rowspan="1" colspan="1">4.2-5.40-6.9</td>
                <td align="left" rowspan="1" colspan="1">3.9</td>
                <td align="left" rowspan="1" colspan="1">72.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">Subdoligran.</td>
                <td align="left" rowspan="1" colspan="1">2.84</td>
                <td align="left" rowspan="1" colspan="1">2.8-3.40-4.2</td>
                <td align="left" rowspan="1" colspan="1">2.6-3.04-3.6</td>
                <td align="left" rowspan="1" colspan="1">1.6-1.91-2.3</td>
                <td align="left" rowspan="1" colspan="1">1.2-1.62-2.3</td>
                <td align="left" rowspan="1" colspan="1">2.9</td>
                <td align="left" rowspan="1" colspan="1">74.0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">11</td>
                <td align="left" rowspan="1" colspan="1">Collinsella</td>
                <td align="left" rowspan="1" colspan="1">1.37</td>
                <td align="left" rowspan="1" colspan="1">1.8-2.32-2.9</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.66-0.8</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.67-0.9</td>
                <td align="left" rowspan="1" colspan="1">1.3-1.76-2.5</td>
                <td align="left" rowspan="1" colspan="1">2.7</td>
                <td align="left" rowspan="1" colspan="1">75.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">12</td>
                <td align="left" rowspan="1" colspan="1">Eubacterium</td>
                <td align="left" rowspan="1" colspan="1">1.03</td>
                <td align="left" rowspan="1" colspan="1">1.9-2.47-3.1</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.40-0.5</td>
                <td align="left" rowspan="1" colspan="1">0.4-0.52-0.7</td>
                <td align="left" rowspan="1" colspan="1">0.8-1.16-1.6</td>
                <td align="left" rowspan="1" colspan="1">2.7</td>
                <td align="left" rowspan="1" colspan="1">77.5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">13</td>
                <td align="left" rowspan="1" colspan="1">Hespellia</td>
                <td align="left" rowspan="1" colspan="1">1.04</td>
                <td align="left" rowspan="1" colspan="1">0.4-0.54-0.8</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.65-0.8</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.69-0.9</td>
                <td align="left" rowspan="1" colspan="1">1.4-1.95-2.6</td>
                <td align="left" rowspan="1" colspan="1">2.1</td>
                <td align="left" rowspan="1" colspan="1">78.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">14</td>
                <td align="left" rowspan="1" colspan="1">Coprococcus</td>
                <td align="left" rowspan="1" colspan="1">2.37</td>
                <td align="left" rowspan="1" colspan="1">2.3-2.84-3.5</td>
                <td align="left" rowspan="1" colspan="1">1.6-1.90-2.3</td>
                <td align="left" rowspan="1" colspan="1">1.1-1.32-1.6</td>
                <td align="left" rowspan="1" colspan="1">1.7-2.31-3.1</td>
                <td align="left" rowspan="1" colspan="1">2.1</td>
                <td align="left" rowspan="1" colspan="1">80.1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">15</td>
                <td align="left" rowspan="1" colspan="1">Streptococcus</td>
                <td align="left" rowspan="1" colspan="1">1.12</td>
                <td align="left" rowspan="1" colspan="1">0.9-1.21-1.6</td>
                <td align="left" rowspan="1" colspan="1">0.4-0.57-0.7</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.62-0.8</td>
                <td align="left" rowspan="1" colspan="1">1.2-1.65-2.2</td>
                <td align="left" rowspan="1" colspan="1">1.7</td>
                <td align="left" rowspan="1" colspan="1">81.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">16</td>
                <td align="left" rowspan="1" colspan="1">Coprobacillus</td>
                <td align="left" rowspan="1" colspan="1">1.13</td>
                <td align="left" rowspan="1" colspan="1">0.6-0.77-1.1</td>
                <td align="left" rowspan="1" colspan="1">0.8-0.95-1.2</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.59-0.8</td>
                <td align="left" rowspan="1" colspan="1">1.1-1.58-2.2</td>
                <td align="left" rowspan="1" colspan="1">1.5</td>
                <td align="left" rowspan="1" colspan="1">82.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">17</td>
                <td align="left" rowspan="1" colspan="1">Catenibacterium</td>
                <td align="left" rowspan="1" colspan="1">0.35</td>
                <td align="left" rowspan="1" colspan="1">0.8-1.09-1.5</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.09-0.2</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.15-0.2</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.30-0.6</td>
                <td align="left" rowspan="1" colspan="1">1.2</td>
                <td align="left" rowspan="1" colspan="1">82.9</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">18</td>
                <td align="left" rowspan="1" colspan="1">Eggerthella</td>
                <td align="left" rowspan="1" colspan="1">0.47</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.24-0.4</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.30-0.4</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.22-0.3</td>
                <td align="left" rowspan="1" colspan="1">0.7-1.00-1.4</td>
                <td align="left" rowspan="1" colspan="1">1.2</td>
                <td align="left" rowspan="1" colspan="1">83.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">19</td>
                <td align="left" rowspan="1" colspan="1">Clostridium</td>
                <td align="left" rowspan="1" colspan="1">0.74</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.68-0.9</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.42-0.6</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.39-0.5</td>
                <td align="left" rowspan="1" colspan="1">0.7-1.03-1.5</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">84.3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">20</td>
                <td align="left" rowspan="1" colspan="1">Anaerotruncus</td>
                <td align="left" rowspan="1" colspan="1">1.02</td>
                <td align="left" rowspan="1" colspan="1">0.8-1.07-1.4</td>
                <td align="left" rowspan="1" colspan="1">0.7-0.85-1.1</td>
                <td align="left" rowspan="1" colspan="1">0.4-0.52-0.7</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.76-1.1</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">84.9</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">21</td>
                <td align="left" rowspan="1" colspan="1">Odoribacter</td>
                <td align="left" rowspan="1" colspan="1">0.67</td>
                <td align="left" rowspan="1" colspan="1">0.6-0.77-1.0</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.62-0.8</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.32-0.4</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.21-0.4</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">85.6</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">22</td>
                <td align="left" rowspan="1" colspan="1">Barnesiella</td>
                <td align="left" rowspan="1" colspan="1">0.56</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.71-1.0</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.60-0.8</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.22-0.3</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.13-0.3</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">86.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">23</td>
                <td align="left" rowspan="1" colspan="1">Megasphaera</td>
                <td align="left" rowspan="1" colspan="1">0.38</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.68-1.0</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.11-0.2</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.20-0.3</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.54-0.9</td>
                <td align="left" rowspan="1" colspan="1">0.9</td>
                <td align="left" rowspan="1" colspan="1">86.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">24</td>
                <td align="left" rowspan="1" colspan="1">Paraprevotella</td>
                <td align="left" rowspan="1" colspan="1">0.29</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.71-1.0</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.11-0.2</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.10-0.2</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.18-0.4</td>
                <td align="left" rowspan="1" colspan="1">0.9</td>
                <td align="left" rowspan="1" colspan="1">87.3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">Lactobacillus</td>
                <td align="left" rowspan="1" colspan="1">0.29</td>
                <td align="left" rowspan="1" colspan="1">0.4-0.60-0.9</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.12-0.2</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.08-0.1</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.40-0.7</td>
                <td align="left" rowspan="1" colspan="1">0.8</td>
                <td align="left" rowspan="1" colspan="1">87.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">26</td>
                <td align="left" rowspan="1" colspan="1">Butyricimonas</td>
                <td align="left" rowspan="1" colspan="1">0.42</td>
                <td align="left" rowspan="1" colspan="1">0.4-0.58-0.8</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.30-0.4</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.20-0.3</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.13-0.3</td>
                <td align="left" rowspan="1" colspan="1">0.8</td>
                <td align="left" rowspan="1" colspan="1">88.3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">27</td>
                <td align="left" rowspan="1" colspan="1">Butyricicoccus</td>
                <td align="left" rowspan="1" colspan="1">0.87</td>
                <td align="left" rowspan="1" colspan="1">0.6-0.79-1.1</td>
                <td align="left" rowspan="1" colspan="1">0.4-0.47-0.6</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.60-0.8</td>
                <td align="left" rowspan="1" colspan="1">0.6-0.84-1.2</td>
                <td align="left" rowspan="1" colspan="1">0.8</td>
                <td align="left" rowspan="1" colspan="1">88.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">28</td>
                <td align="left" rowspan="1" colspan="1">Lactonifactor</td>
                <td align="left" rowspan="1" colspan="1">0.63</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.65-0.9</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.35-0.5</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.34-0.5</td>
                <td align="left" rowspan="1" colspan="1">0.6-0.81-1.2</td>
                <td align="left" rowspan="1" colspan="1">0.8</td>
                <td align="left" rowspan="1" colspan="1">89.3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">29</td>
                <td align="left" rowspan="1" colspan="1">Parabacteroides</td>
                <td align="left" rowspan="1" colspan="1">0.77</td>
                <td align="left" rowspan="1" colspan="1">0.4-0.59-0.8</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.64-0.8</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.40-0.5</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.68-1.0</td>
                <td align="left" rowspan="1" colspan="1">0.8</td>
                <td align="left" rowspan="1" colspan="1">89.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">30</td>
                <td align="left" rowspan="1" colspan="1">Dialister</td>
                <td align="left" rowspan="1" colspan="1">0.57</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.49-0.7</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.27-0.4</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.42-0.6</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.78-1.2</td>
                <td align="left" rowspan="1" colspan="1">0.7</td>
                <td align="left" rowspan="1" colspan="1">90.2</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt101">
            <label/>
            <p>Percentage relative abundance of the first 30 out of 131 genera in the estimate of the mean of the reference single Dirichlet component, <inline-formula><inline-graphic xlink:href="pone.0030126.e163.jpg" mimetype="image"/></inline-formula>, and the four Dirichlet mixture components, <inline-formula><inline-graphic xlink:href="pone.0030126.e164.jpg" mimetype="image"/></inline-formula> fitted to the Twins data. For the mixture components the upper and lower 95% credible intervals are also given in the format (lower-MPE-upper). These are calculated as the maximum posterior estimate minus/plus two standard deviations as calculated from the inverse Hessian. Genera are ranked in order of their contribution to the total mean difference of 158%, split 34%, 26%, 51% and 47% across components, and the cumulative fraction of this difference accounted for given in the last column in the table.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>These patterns are also illustrated graphically in the ‘heat map’ of relative frequencies shown in <xref ref-type="fig" rid="pone-0030126-g003">Figure 3</xref>. The relative frequencies of the 30 genera accounting for the most difference between clusters are shown for all the samples. The samples are grouped into the cluster that they had the highest probability of being generated from, as defined above. The cluster means are plotted to the right of the samples mapped to that cluster. Roughly we have that the two low variance clusters are dominated by Bacteroides and Faecilibacterium, albeit to a greater extent in the third cluster. The high variance, first and fourth clusters, contain a greater variety of genera but with substantially more Prevotella and Faecilibacterium in the first, rather than the fourth, where no genus really dominates.</p>
      <fig id="pone-0030126-g003" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0030126.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Heat map of the Twins data and hierarchical clustering.</title>
          <p>Heat map showing the Twins data with samples grouped according to the cluster most likely to have generated them. Only 30 out of 131 genera are shown, those with the greatest variability across clusters, see <xref ref-type="table" rid="pone-0030126-t001">Table 1</xref>. To the right of each cluster the mean of the Dirichlet component for that mixture is shown. The data is square root transformed and therefore to convert the scale to relative abundance, values must be squared.</p>
        </caption>
        <graphic xlink:href="pone.0030126.g003"/>
      </fig>
    </sec>
    <sec id="s3b">
      <title>Generative classifier for Twins data</title>
      <p>The Dirichlet-multinomial framework can also be used for classification. This is a supervised learning approach as opposed to the unsupervised approach used in the previous section. Here, we will consider the case of binary classes but any number of classes is a simple extension. Given a training data set of <inline-formula><inline-graphic xlink:href="pone.0030126.e165.jpg" mimetype="image"/></inline-formula> samples <inline-formula><inline-graphic xlink:href="pone.0030126.e166.jpg" mimetype="image"/></inline-formula> then we denote class membership with the <inline-formula><inline-graphic xlink:href="pone.0030126.e167.jpg" mimetype="image"/></inline-formula> dimensional vector <inline-formula><inline-graphic xlink:href="pone.0030126.e168.jpg" mimetype="image"/></inline-formula> with elements <inline-formula><inline-graphic xlink:href="pone.0030126.e169.jpg" mimetype="image"/></inline-formula> which are either 0 or 1. The classification problem is to deduce the class <inline-formula><inline-graphic xlink:href="pone.0030126.e170.jpg" mimetype="image"/></inline-formula> of a new sample <inline-formula><inline-graphic xlink:href="pone.0030126.e171.jpg" mimetype="image"/></inline-formula>. To do this we associate a separate Dirichlet multinomial mixture model with each class. We denote the hyperparameters of these mixtures by <inline-formula><inline-graphic xlink:href="pone.0030126.e172.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0030126.e173.jpg" mimetype="image"/></inline-formula>, respectively. Then we can marginalise over the multinomial parameters of the sample to be classified so that:<disp-formula><graphic xlink:href="pone.0030126.e174.jpg" mimetype="image" position="float"/><label>(16)</label></disp-formula>is the probability of the sample belonging to the second class and <inline-formula><inline-graphic xlink:href="pone.0030126.e175.jpg" mimetype="image"/></inline-formula>. The prior class probabilities are estimated as the observed class frequencies so that <inline-formula><inline-graphic xlink:href="pone.0030126.e176.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0030126.e177.jpg" mimetype="image"/></inline-formula>. The class mixture themselves are determined just as before but with data points restricted to those class members. We can also determine if the fit is significant by comparing the sum of model fits of the classes with the model fit ignoring the class variables. This is our generative classification scheme.</p>
      <p>We will apply this to the Twins data denoting individuals with ‘Lean’ BMI by <inline-formula><inline-graphic xlink:href="pone.0030126.e178.jpg" mimetype="image"/></inline-formula> and ‘Obese’ as <inline-formula><inline-graphic xlink:href="pone.0030126.e179.jpg" mimetype="image"/></inline-formula>. We will ignore the ‘Overweight’ category to avoid ambiguity. In <xref ref-type="fig" rid="pone-0030126-g004">Figure 4</xref> we replot the NMDS plot of <xref ref-type="fig" rid="pone-0030126-g002">Figure 2</xref> with these class labels. There is no dramatic separation of points according to class labels. We found that for the Lean <inline-formula><inline-graphic xlink:href="pone.0030126.e180.jpg" mimetype="image"/></inline-formula> class a single component Dirichlet mixture was optimal but that for the Obese <inline-formula><inline-graphic xlink:href="pone.0030126.e181.jpg" mimetype="image"/></inline-formula> class three components minimised the Laplace approximation to the model evidence. The means of each of the three Obese components were quite different but the posterior mean for the entire prior sampling from all three according to their weights (black circle in <xref ref-type="fig" rid="pone-0030126-g004">Figure 4</xref>) is close to the single component from the Lean class (black asterisk <xref ref-type="fig" rid="pone-0030126-g004">Figure 4</xref>). In fact, accounting for uncertainty in both the Dirichlet priors and the sampling from those, then only one low frequency genera, Megasphaera, was significantly differently expressed between classes, having a 97% probability of being more abundant in Obese people. In addition, fitting to the two classes separately did not give a significantly better fit than fitting to the whole data set, 35640 vs. 35385. It is also apparent from comparing <xref ref-type="fig" rid="pone-0030126-g002">Figure 2</xref> and <xref ref-type="fig" rid="pone-0030126-g004">Figure 4</xref> that each of the class components map onto one of the components from the clustering of the whole data set, this was confirmed by comparing the Bray-Curtis distances between the two sets of mean vectors, the component from the Lean class maps onto the second of the four from the whole data set, and the three components from the Obese class map onto the third, first and fourth, respectively. In summary, it appears that the difference between Lean and Obese classes lies not at the level of mean community composition but that the Obese individuals contain a greater variety of community structures including three out of the four components found in the complete data set.</p>
      <fig id="pone-0030126-g004" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0030126.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>NMDS plot of Twins dataset with class labels.</title>
          <p>Samples from Lean (<inline-formula><inline-graphic xlink:href="pone.0030126.e182.jpg" mimetype="image"/></inline-formula>) individuals are shown in magenta and Obese (<inline-formula><inline-graphic xlink:href="pone.0030126.e183.jpg" mimetype="image"/></inline-formula>) in Cyan. Overweight are grey. The black crosses indicate the Dirichlet means of each component of the three components for the Obese class, the black asterisk the single component for the Lean class. We also show the posterior mean of the entire Obese class as a black circle.</p>
        </caption>
        <graphic xlink:href="pone.0030126.g004"/>
      </fig>
      <p>In a recent evaluation of classification algorithms applied to microbial community data the random forests algorithm was found to perform best <xref rid="pone.0030126-Knights1" ref-type="bibr">[20]</xref>, substantially outperforming elastic nets, support vector machines, and multinomial naive Bayes (MNB). The random forests algorithm is an example of ensemble learning where many classifiers are generated and their predictions are aggregated. In particular, it is an extension of the machine learning technique known as bootstrap aggregating or bagging for short. The bagging approach constructs decision trees from bootstrap samples of the data and makes class predictions via majority vote. Random forests adds an extra layer of randomness to bagging by changing how the decision trees are constructed. Instead of splitting each node using the best split amongst all the variables, the best split amongst a subset of randomly chosen predictors is used. Moreover, the random forests algorithm also gives a measure of the importance of a variable by calculating how much prediction error increases when data for that variable is permuted. Random forests therefore seemed like an appropriate benchmark to compare the performance of our generative classifier to. Following Knights et al. (2011) <xref rid="pone.0030126-Knights1" ref-type="bibr">[20]</xref>, we implemented the random forests algorithm using the randomForest package in R, though we tuned the parameters of the algorithm (the number of variables in the random subset at each node and the number of trees in the forest) according to the heuristics suggested by Liaw and Wiener (2002) <xref rid="pone.0030126-Liaw1" ref-type="bibr">[31]</xref>.</p>
      <p>To compare the two classification methods we performed leave-one-out validation. We removed each sample in turn from the data set, trained the classifier, and classified the missing data point. Assigning the data point as Obese if the predicted probability was greater than or equal to 0.5. We obtained a slightly lower error rate, i.e. fraction of samples misclassified, for the random forests algorithm (18.5%) as opposed to the Dirichlet multinomial generative classifier (22.4%). Examining the ‘confusion matrix’ for each classifier, <xref ref-type="table" rid="pone-0030126-t002">Table 2</xref>, that is the number of individuals from each true class classified into the two classes, reveals that the generative classifier does have a better distribution of errors across classes. We then generated receiver-operating characteristic (ROC) curves for each classifier. These are shown in <xref ref-type="fig" rid="pone-0030126-g005">Figure 5</xref>. They are generated by ordering samples by decreasing likelihood of being Obese: for the generative classifier that is simply the probability of being Obese i.e. <inline-formula><inline-graphic xlink:href="pone.0030126.e184.jpg" mimetype="image"/></inline-formula>; for random forests this is the weighted vote. We then lower a threshold from 1.0 to 0.0 with intervals defined by the sample probabilities. All samples with probability greater than or equal to a given threshold are classified as Obese, all other samples as Lean. Based on these classifications, the false positive percentage (i.e. Lean classified as Obese) and true positive rate (Obese classified as Obese) are calculated and plotted against each other. This is repeated for all thresholds. It is a means of summarising the performance of a classifier over all decision thresholds. Both classifiers do substantially better than random but at lower thresholds random forests outperforms the generative classifier with fewer false positives. A summary statistic is the area under the ROC curve, for random forests this was 85%; for the Dirichlet-Multinomial 79% was obtained.</p>
      <fig id="pone-0030126-g005" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0030126.g005</object-id>
        <label>Figure 5</label>
        <caption>
          <title>Receiver operating characteristic (ROC) curves for the Twins Dirichlet multinomial and random forests classifiers.</title>
          <p>Gives true positive percentage on the y-axis i.e. Obese individuals correctly identified vs false positive percentage i.e Lean individuals flagged as Obese.</p>
        </caption>
        <graphic xlink:href="pone.0030126.g005"/>
      </fig>
      <table-wrap id="pone-0030126-t002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0030126.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Confusion matrices for classification of Twins data.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0030126-t002-2" xlink:href="pone.0030126.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Predicted</td>
                <td colspan="2" align="left" rowspan="1">Random forests</td>
                <td colspan="2" align="left" rowspan="1">Dirichlet multinomial</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Actual</td>
                <td align="left" rowspan="1" colspan="1">Lean</td>
                <td align="left" rowspan="1" colspan="1">Obese</td>
                <td align="left" rowspan="1" colspan="1">Lean</td>
                <td align="left" rowspan="1" colspan="1">Obese</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Lean</td>
                <td align="left" rowspan="1" colspan="1">19</td>
                <td align="left" rowspan="1" colspan="1">42</td>
                <td align="left" rowspan="1" colspan="1">33</td>
                <td align="left" rowspan="1" colspan="1">28</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Obese</td>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">188</td>
                <td align="left" rowspan="1" colspan="1">29</td>
                <td align="left" rowspan="1" colspan="1">164</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt102">
            <label/>
            <p>The two rows give the number of ‘Lean’ and ‘Obese’ individuals predicted to be ‘Lean’ and ‘Obese’ by the random forests and Dirichlet multinomial classifiers following leave-one-out validation. A classification threshold of 0.5 was used for both algorithms.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="s3c">
      <title>Analysis of IBD phenotypes</title>
      <p>We conclude with a brief analysis of the inflammatory bowel disease (IBD) phenotypes. In <xref ref-type="fig" rid="pone-0030126-g006">Figure 6</xref> we show an NMDS plot with samples coloured according to phenotype for this data set generated as described above. It is apparent from this that the Healthy (H) individuals, and those exhibiting colonic Crohn's disease (CCD) and ulcerative colitis (UC), have similar, fairly homogeneous community structures whereas the individuals with ileal Crohn's disease (ICD) have a much larger variation in community structure. We can use the DMM model to quantify this, we fitted single component models, to all the samples together, and then each phenotype separately. The <inline-formula><inline-graphic xlink:href="pone.0030126.e185.jpg" mimetype="image"/></inline-formula> values obtained were 15.7 for the whole data set and (H) 22.2, (CCD) 39.4, (ICD) 5.1, (UC) 38.5 for the phenotypes. Remembering, that <inline-formula><inline-graphic xlink:href="pone.0030126.e186.jpg" mimetype="image"/></inline-formula> is related to the inverse of the variance, then this confirms that the ICD phenotype is associated with an increase in metacommunity variability. We also show the metacommunity means in <xref ref-type="fig" rid="pone-0030126-g006">Figure 6</xref> as crosses: H, CCD and UC have a similar location whereas the ICD mean is displaced. Exactly how the different OTUs contribute to the differences in the ICD samples is shown in <xref ref-type="table" rid="pone-0030126-t003">Table 3</xref> and graphically in <xref ref-type="fig" rid="pone-0030126-g007">Figure 7</xref>. The proportion of the Unknown, Bacteroides, and Faecalibacterium genera are reduced whereas numerous other genera for example the Escherichia/Shigella, Sutterella, and Prevotella are increased.</p>
      <fig id="pone-0030126-g006" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0030126.g006</object-id>
        <label>Figure 6</label>
        <caption>
          <title>NMDS plot of IBD dataset with class labels.</title>
          <p>Samples from Healthy individuals (black), and three IBD phenotypes, (red) colonic Crohn's disease (CCD), (green) ileal Crohn's disease (ICD), and (blue) ulcerative colitis (UC) are shown. The Dirichlet means of single component fits to each type are shown by the corresponding coloured cross.</p>
        </caption>
        <graphic xlink:href="pone.0030126.g006"/>
      </fig>
      <fig id="pone-0030126-g007" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0030126.g007</object-id>
        <label>Figure 7</label>
        <caption>
          <title>Heat map of the IBD data divided by phenotype together with phenotype means.</title>
          <p>Heat map showing the IBD data with samples grouped according to the IBD pheonotype. The means of the four single component Dirichlet models, fitted to healthy (<inline-formula><inline-graphic xlink:href="pone.0030126.e187.jpg" mimetype="image"/></inline-formula>), colonic Crohn's disease (CCD - <inline-formula><inline-graphic xlink:href="pone.0030126.e188.jpg" mimetype="image"/></inline-formula>), ileal Crohn's disease (ICD - <inline-formula><inline-graphic xlink:href="pone.0030126.e189.jpg" mimetype="image"/></inline-formula>), and ulcerative colitis (UC - <inline-formula><inline-graphic xlink:href="pone.0030126.e190.jpg" mimetype="image"/></inline-formula>) phenotypes are also shown. Only 25 out of 95 genera are shown, those with the greatest variability across phenotypes, see <xref ref-type="table" rid="pone-0030126-t003">Table 3</xref>. The data is square root transformed and therefore to convert the scale to relative abundance, values must be squared.</p>
        </caption>
        <graphic xlink:href="pone.0030126.g007"/>
      </fig>
      <table-wrap id="pone-0030126-t003" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0030126.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Genera frequencies in the IBD phenotypes.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0030126-t003-3" xlink:href="pone.0030126.t003"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Rank</td>
                <td align="left" rowspan="1" colspan="1">Genus</td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0030126.e191.jpg" mimetype="image"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0030126.e192.jpg" mimetype="image"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0030126.e193.jpg" mimetype="image"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0030126.e194.jpg" mimetype="image"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula>
                    <inline-graphic xlink:href="pone.0030126.e195.jpg" mimetype="image"/>
                  </inline-formula>
                </td>
                <td align="left" rowspan="1" colspan="1">Diff.</td>
                <td align="left" rowspan="1" colspan="1">C. Diff.</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">Unknown</td>
                <td align="left" rowspan="1" colspan="1">27.8</td>
                <td align="left" rowspan="1" colspan="1">24-28.4-34</td>
                <td align="left" rowspan="1" colspan="1">26-33.4-44</td>
                <td align="left" rowspan="1" colspan="1">14-21.1-33</td>
                <td align="left" rowspan="1" colspan="1">27-34.7-44</td>
                <td align="left" rowspan="1" colspan="1">19.8</td>
                <td align="left" rowspan="1" colspan="1">18.9</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">Bacteroides</td>
                <td align="left" rowspan="1" colspan="1">27.2</td>
                <td align="left" rowspan="1" colspan="1">24-28.7-35</td>
                <td align="left" rowspan="1" colspan="1">22-28.7-38</td>
                <td align="left" rowspan="1" colspan="1">12-19.6-31</td>
                <td align="left" rowspan="1" colspan="1">26-32.5-41</td>
                <td align="left" rowspan="1" colspan="1">15.9</td>
                <td align="left" rowspan="1" colspan="1">34.1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">Faecalibacter.</td>
                <td align="left" rowspan="1" colspan="1">3.61</td>
                <td align="left" rowspan="1" colspan="1">3.3-4.36-5.8</td>
                <td align="left" rowspan="1" colspan="1">3.6-5.39-8.0</td>
                <td align="left" rowspan="1" colspan="1">0.7-1.52-3.4</td>
                <td align="left" rowspan="1" colspan="1">3.1-4.46-6.4</td>
                <td align="left" rowspan="1" colspan="1">5.5</td>
                <td align="left" rowspan="1" colspan="1">39.4</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">Escherichia/Shigella</td>
                <td align="left" rowspan="1" colspan="1">0.93</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.58-1.0</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.50-1.1</td>
                <td align="left" rowspan="1" colspan="1">2.1-3.85-7.0</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.41-0.8</td>
                <td align="left" rowspan="1" colspan="1">4.2</td>
                <td align="left" rowspan="1" colspan="1">43.4</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">Parabacteroides</td>
                <td align="left" rowspan="1" colspan="1">3.49</td>
                <td align="left" rowspan="1" colspan="1">2.3-3.19-4.3</td>
                <td align="left" rowspan="1" colspan="1">1.9-3.07-4.9</td>
                <td align="left" rowspan="1" colspan="1">2.6-4.77-8.6</td>
                <td align="left" rowspan="1" colspan="1">1.5-2.31-3.6</td>
                <td align="left" rowspan="1" colspan="1">3.2</td>
                <td align="left" rowspan="1" colspan="1">46.5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">6</td>
                <td align="left" rowspan="1" colspan="1">Sutterella</td>
                <td align="left" rowspan="1" colspan="1">1.00</td>
                <td align="left" rowspan="1" colspan="1">0.6-0.95-1.5</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.49-1.1</td>
                <td align="left" rowspan="1" colspan="1">1.3-2.63-5.3</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.30-0.7</td>
                <td align="left" rowspan="1" colspan="1">2.9</td>
                <td align="left" rowspan="1" colspan="1">49.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">Alistipes</td>
                <td align="left" rowspan="1" colspan="1">3.61</td>
                <td align="left" rowspan="1" colspan="1">3.3-4.41-5.9</td>
                <td align="left" rowspan="1" colspan="1">2.4-3.79-6.0</td>
                <td align="left" rowspan="1" colspan="1">1.3-2.56-5.1</td>
                <td align="left" rowspan="1" colspan="1">1.9-2.92-4.4</td>
                <td align="left" rowspan="1" colspan="1">2.7</td>
                <td align="left" rowspan="1" colspan="1">51.8</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">8</td>
                <td align="left" rowspan="1" colspan="1">Prevotella</td>
                <td align="left" rowspan="1" colspan="1">0.77</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.79-1.3</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.15-0.6</td>
                <td align="left" rowspan="1" colspan="1">0.9-1.98-4.4</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.36-0.8</td>
                <td align="left" rowspan="1" colspan="1">2.3</td>
                <td align="left" rowspan="1" colspan="1">54.0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">9</td>
                <td align="left" rowspan="1" colspan="1">Dorea</td>
                <td align="left" rowspan="1" colspan="1">1.98</td>
                <td align="left" rowspan="1" colspan="1">1.2-1.65-2.3</td>
                <td align="left" rowspan="1" colspan="1">0.9-1.48-2.5</td>
                <td align="left" rowspan="1" colspan="1">1.4-2.70-5.2</td>
                <td align="left" rowspan="1" colspan="1">0.8-1.29-2.1</td>
                <td align="left" rowspan="1" colspan="1">2.2</td>
                <td align="left" rowspan="1" colspan="1">56.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">Klebsiella</td>
                <td align="left" rowspan="1" colspan="1">0.47</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.34-0.6</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.21-0.7</td>
                <td align="left" rowspan="1" colspan="1">0.9-1.95-4.4</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.16-0.5</td>
                <td align="left" rowspan="1" colspan="1">2.2</td>
                <td align="left" rowspan="1" colspan="1">58.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">11</td>
                <td align="left" rowspan="1" colspan="1">Bifidobacterium</td>
                <td align="left" rowspan="1" colspan="1">1.91</td>
                <td align="left" rowspan="1" colspan="1">1.1-1.59-2.3</td>
                <td align="left" rowspan="1" colspan="1">1.5-2.48-4.1</td>
                <td align="left" rowspan="1" colspan="1">1.2-2.32-4.7</td>
                <td align="left" rowspan="1" colspan="1">0.7-1.14-1.9</td>
                <td align="left" rowspan="1" colspan="1">2.1</td>
                <td align="left" rowspan="1" colspan="1">60.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">12</td>
                <td align="left" rowspan="1" colspan="1">Barnesiella</td>
                <td align="left" rowspan="1" colspan="1">1.65</td>
                <td align="left" rowspan="1" colspan="1">1.3-1.88-2.7</td>
                <td align="left" rowspan="1" colspan="1">0.8-1.47-2.6</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.49-1.9</td>
                <td align="left" rowspan="1" colspan="1">0.8-1.30-2.2</td>
                <td align="left" rowspan="1" colspan="1">1.9</td>
                <td align="left" rowspan="1" colspan="1">62.1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">13</td>
                <td align="left" rowspan="1" colspan="1">Oscillibacter</td>
                <td align="left" rowspan="1" colspan="1">2.49</td>
                <td align="left" rowspan="1" colspan="1">2.0-2.75-3.8</td>
                <td align="left" rowspan="1" colspan="1">1.4-2.31-3.8</td>
                <td align="left" rowspan="1" colspan="1">0.7-1.60-3.6</td>
                <td align="left" rowspan="1" colspan="1">1.3-1.97-3.1</td>
                <td align="left" rowspan="1" colspan="1">1.9</td>
                <td align="left" rowspan="1" colspan="1">63.9</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">14</td>
                <td align="left" rowspan="1" colspan="1">Streptococcus</td>
                <td align="left" rowspan="1" colspan="1">0.67</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.44-0.8</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.44-1.0</td>
                <td align="left" rowspan="1" colspan="1">0.8-1.76-3.7</td>
                <td align="left" rowspan="1" colspan="1">0.2-0.37-0.8</td>
                <td align="left" rowspan="1" colspan="1">1.8</td>
                <td align="left" rowspan="1" colspan="1">65.6</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">15</td>
                <td align="left" rowspan="1" colspan="1">Coprococcus</td>
                <td align="left" rowspan="1" colspan="1">1.73</td>
                <td align="left" rowspan="1" colspan="1">0.9-1.37-2.0</td>
                <td align="left" rowspan="1" colspan="1">0.7-1.20-2.1</td>
                <td align="left" rowspan="1" colspan="1">1.2-2.41-4.7</td>
                <td align="left" rowspan="1" colspan="1">0.9-1.46-2.4</td>
                <td align="left" rowspan="1" colspan="1">1.8</td>
                <td align="left" rowspan="1" colspan="1">67.4</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">16</td>
                <td align="left" rowspan="1" colspan="1">Veillonella</td>
                <td align="left" rowspan="1" colspan="1">0.17</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.03-0.2</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.00-0.0</td>
                <td align="left" rowspan="1" colspan="1">0.7-1.59-3.6</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.09-0.4</td>
                <td align="left" rowspan="1" colspan="1">1.8</td>
                <td align="left" rowspan="1" colspan="1">69.1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">17</td>
                <td align="left" rowspan="1" colspan="1">Subdoligranulum</td>
                <td align="left" rowspan="1" colspan="1">2.33</td>
                <td align="left" rowspan="1" colspan="1">1.8-2.47-3.4</td>
                <td align="left" rowspan="1" colspan="1">1.2-1.93-3.2</td>
                <td align="left" rowspan="1" colspan="1">0.7-1.62-3.6</td>
                <td align="left" rowspan="1" colspan="1">1.2-1.86-3.0</td>
                <td align="left" rowspan="1" colspan="1">1.7</td>
                <td align="left" rowspan="1" colspan="1">70.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">18</td>
                <td align="left" rowspan="1" colspan="1">Paraprevotella</td>
                <td align="left" rowspan="1" colspan="1">0.55</td>
                <td align="left" rowspan="1" colspan="1">0.4-0.60-1.0</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.14-0.5</td>
                <td align="left" rowspan="1" colspan="1">0.6-1.36-3.3</td>
                <td align="left" rowspan="1" colspan="1">0.1-0.21-0.6</td>
                <td align="left" rowspan="1" colspan="1">1.6</td>
                <td align="left" rowspan="1" colspan="1">72.3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">19</td>
                <td align="left" rowspan="1" colspan="1">Acidaminococcus</td>
                <td align="left" rowspan="1" colspan="1">0.19</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.06-0.3</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.07-0.5</td>
                <td align="left" rowspan="1" colspan="1">0.6-1.35-3.3</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.09-0.4</td>
                <td align="left" rowspan="1" colspan="1">1.5</td>
                <td align="left" rowspan="1" colspan="1">73.7</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">20</td>
                <td align="left" rowspan="1" colspan="1">Lactobacillus</td>
                <td align="left" rowspan="1" colspan="1">0.20</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.13-0.3</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.13-0.5</td>
                <td align="left" rowspan="1" colspan="1">0.5-1.27-3.1</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.00-0.0</td>
                <td align="left" rowspan="1" colspan="1">1.4</td>
                <td align="left" rowspan="1" colspan="1">75.1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">21</td>
                <td align="left" rowspan="1" colspan="1">Ruminococcus</td>
                <td align="left" rowspan="1" colspan="1">1.47</td>
                <td align="left" rowspan="1" colspan="1">1.0-1.40-2.0</td>
                <td align="left" rowspan="1" colspan="1">0.7-1.29-2.3</td>
                <td align="left" rowspan="1" colspan="1">0.4-1.01-2.7</td>
                <td align="left" rowspan="1" colspan="1">0.5-0.94-1.6</td>
                <td align="left" rowspan="1" colspan="1">1.2</td>
                <td align="left" rowspan="1" colspan="1">76.3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">22</td>
                <td align="left" rowspan="1" colspan="1">Lactonifactor</td>
                <td align="left" rowspan="1" colspan="1">0.11</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.06-0.2</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.00-0.0</td>
                <td align="left" rowspan="1" colspan="1">0.4-1.01-2.7</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.00-0.0</td>
                <td align="left" rowspan="1" colspan="1">1.2</td>
                <td align="left" rowspan="1" colspan="1">77.4</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">23</td>
                <td align="left" rowspan="1" colspan="1">Odoribacter</td>
                <td align="left" rowspan="1" colspan="1">1.11</td>
                <td align="left" rowspan="1" colspan="1">0.7-1.04-1.5</td>
                <td align="left" rowspan="1" colspan="1">0.4-0.73-1.4</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.93-2.5</td>
                <td align="left" rowspan="1" colspan="1">0.4-0.69-1.2</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">78.4</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">24</td>
                <td align="left" rowspan="1" colspan="1">Butyricicoccus</td>
                <td align="left" rowspan="1" colspan="1">1.01</td>
                <td align="left" rowspan="1" colspan="1">0.6-0.92-1.4</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.53-1.1</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.93-2.5</td>
                <td align="left" rowspan="1" colspan="1">0.4-0.66-1.1</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">79.3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">Fusobacterium</td>
                <td align="left" rowspan="1" colspan="1">0.09</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.06-0.3</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.00-0.0</td>
                <td align="left" rowspan="1" colspan="1">0.3-0.80-2.5</td>
                <td align="left" rowspan="1" colspan="1">0.0-0.00-0.0</td>
                <td align="left" rowspan="1" colspan="1">0.9</td>
                <td align="left" rowspan="1" colspan="1">80.2</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt103">
            <label/>
            <p>Percentage relative abundance of the first 25 out of 95 genera in the estimate of the mean of the reference single Dirichlet component, <inline-formula><inline-graphic xlink:href="pone.0030126.e196.jpg" mimetype="image"/></inline-formula>, fitted to all IBD individuals, and the four single component Dirichlet models, fitted to healthy (<inline-formula><inline-graphic xlink:href="pone.0030126.e197.jpg" mimetype="image"/></inline-formula>), colonic Crohn's disease (CCD - <inline-formula><inline-graphic xlink:href="pone.0030126.e198.jpg" mimetype="image"/></inline-formula>), ileal Crohn's disease (ICD - <inline-formula><inline-graphic xlink:href="pone.0030126.e199.jpg" mimetype="image"/></inline-formula>), and ulcerative colitis (UC - <inline-formula><inline-graphic xlink:href="pone.0030126.e200.jpg" mimetype="image"/></inline-formula>) phenotypes. For the mixture components the upper and lower 95% credible intervals are also given in the format (lower-MPE-upper). These are calculated as the maximum log posterior estimate minus/plus two standard deviations as calculated from the inverse Hessian. Genera are ranked in order of their contribution to the total difference of 104% to the reference split 9%, 20%, 48%, 27% across phenotypes, and the cumulative fraction of this difference accounted for given in the last column in the table.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec id="s4">
    <title>Discussion</title>
    <p>We have demonstrated that the Dirichlet multinomial mixture is a powerful framework for the generative modelling of microbial community data. It operates at several levels, it allows read numbers and hence sampling noise to be naturally accounted for, and the Dirichlet parameters are easily interpretable in terms of the mean and variance of the communities generated from each component. Used for ‘unsupervised learning’ or clustering it provides a means to determine clusters of communities or envirotypes, a highly topical problem in the analysis of microbial community data. Since it is a probabilistic model, we can harness rigorous statistical theory for determining how well the data is explained by a given cluster number.</p>
    <p>We illustrated this approach with the Twins data set. Using our models, the most probable estimate for the number of envirotypes present in this sample (or ‘enterotypes’ as they are known in the context of gut microbiota samples) is four. Our measure of model fit, the negative logarithm of the approximate model evidence, was 41 less than the next best cluster number, three. Thus, in the context of our model the probability that there are four rather than three or five clusters is practically a 100%. However, a direct implication of the Bayesian approach is that any point estimate of the number of envirotypes represents a summary (in our case, the mode) of the posterior distribution over the number of clusters. For other data sets the predicted cluster number may be more uncertain. This uncertainty can be naturally incorporated by our approach.</p>
    <p>Our analysis, and its statistical implications, may be contrasted with a previous analysis of this same Twins dataset, which used a partitioning around medoid (PAM) clustering coupled with the heuristic Calinski-Harabasz (CH) index <xref rid="pone.0030126-Arumugam1" ref-type="bibr">[18]</xref>. The CH approach makes no acknowledgment of the fact that there is inherent uncertainty in the number of clusters, and thus may potentially be misread as offering an unambiguous and definitive assessment of the number of clusters. Furthermore, the PAM clustering algorithm does not allow clusters to be of variable spread. This may be the reason why they found three rather than four clusters. The extra flexibility of the DMM model could better represent the true patterns in the data. This, to us, supports the promise of a probabilistic model with the flexibility to model clusters of different size and a Bayesian approach to determining the cluster number.</p>
    <p>Used for ‘supervised learning’ the Dirichlet multinomial mixture provides an effective classifier. Absolute classification power as summarised by the area under the ROC curve is less than for the best performing of previously tested algorithms - random forests. However, using the standard classification threshold of 0.5 it had a better distribution of errors across classes, outperforming random forests on the smaller ‘Lean’ class. In general, we would expect discriminative classifiers, which only model the conditional probability of the class label given the data, to outperform generative models, which fit the actual class distributions. On the other hand, the generative approach allows much easier interpretation of the fitted models, which is often more important than accuracy <italic>per se</italic>. The fitted Dirichlet parameters describe both the composition of the communities, and critically variance in composition associated with the classes. The probabilistic framework that we present also allows the hypothesis of whether two classes do differ in community composition to be rigorously tested. Or equivalently whether a discrete experimental treatment significantly impacts community structure.</p>
    <p>Generative models provide a framework for both clustering and classification but their full power derives from their ability to combine the two. We will illustrate this for the Twins data. In <xref ref-type="table" rid="pone-0030126-t004">Table 4</xref> we give the proportion of samples from each BMI category, i.e. Lean, Obese and Overweight, that fell into our four enterotypes. For this data set we did not see a significant difference in mean community composition between Lean and Obese individuals. However, it is clear that the two classes do differ significantly in their probability of deriving from each of the clusters. Lean individuals are much less likely to derive from the first and fourth clusters than Obese individuals. They are much more likely to derive from the second and somewhat less likely from the third. This suggests a novel explanation for the differences in taxa frequency that have been previously reported between Lean and Obese individuals from this data. BMI itself is not correlated with changes in community structure rather it influences the likelihood of deriving from the four enterotypes.</p>
    <table-wrap id="pone-0030126-t004" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0030126.t004</object-id>
      <label>Table 4</label>
      <caption>
        <title>Comparison of BMI and cluster or ‘Enterotype’.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0030126-t004-4" xlink:href="pone.0030126.t004"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">BMI</td>
              <td align="left" rowspan="1" colspan="1">e = 1</td>
              <td align="left" rowspan="1" colspan="1">e = 2</td>
              <td align="left" rowspan="1" colspan="1">e = 3</td>
              <td align="left" rowspan="1" colspan="1">e = 4</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Lean</td>
              <td align="left" rowspan="1" colspan="1">6.6%</td>
              <td align="left" rowspan="1" colspan="1">60.7%</td>
              <td align="left" rowspan="1" colspan="1">24.6%</td>
              <td align="left" rowspan="1" colspan="1">8.2%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Obese</td>
              <td align="left" rowspan="1" colspan="1">25.9%</td>
              <td align="left" rowspan="1" colspan="1">21.2%</td>
              <td align="left" rowspan="1" colspan="1">33.2%</td>
              <td align="left" rowspan="1" colspan="1">19.7%</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Overweight</td>
              <td align="left" rowspan="1" colspan="1">29.2%</td>
              <td align="left" rowspan="1" colspan="1">33.3%</td>
              <td align="left" rowspan="1" colspan="1">25.0%</td>
              <td align="left" rowspan="1" colspan="1">12.5%</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt104">
          <label/>
          <p>Proportion of samples with a given BMI deriving from the four enterotypes <inline-formula><inline-graphic xlink:href="pone.0030126.e201.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0030126.e202.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0030126.e203.jpg" mimetype="image"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0030126.e204.jpg" mimetype="image"/></inline-formula>.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>This raises the intriguing possibility that the first and fourth enterotypes may be associated with a disturbed possibly unhealthy gut microbiota – ‘dysbiosis’. This implies that obesity does not guarantee a disturbed microflora but increases its likelihood. Finally, we return to the observation that the first and fourth enterotypes have a higher variance in community structure than the second and third. We suggest that this is an example of the ‘Anna Karenina principle’ as applied to microbial communities. This principle popularised by Jared Diamond <xref rid="pone.0030126-Diamond1" ref-type="bibr">[32]</xref> derives from the first line of Tolstoy's novel: “Happy families are all alike; every unhappy family is unhappy in its own way” <xref rid="pone.0030126-Tolstoy1" ref-type="bibr">[33]</xref>. We propose that the same thing may apply to microbial communities in human health, there are many more configurations associated with dysbiosis than are possible for a healthy community which is relatively predictable and homogeneous as it requires certain key components. This is not to suggest that the first and fourth enterotypes are associated with higher genera level diversity in individual samples, the median diversities are not significantly different between the enterotypes, it is the diversity in community compositions that increases. Our observations are also consistent, therefore, with the conclusion of the original study that the major impact of obesity was a reduction in OTU diversity <xref rid="pone.0030126-Turnbaugh2" ref-type="bibr">[27]</xref>.</p>
    <p>This interpretation of the Twins data is obviously speculative and will require further studies with more meta-data on host health to corroborate. The analysis of the IBD phenotype data represents a first step in this direction. There we did find a much more variable microbiota associated with one of the disease phenotypes, ileal Crohn's disease, but not colonic Crohn's or ulcerative colitis. This is, therefore partial support for the AKP. However, it is possible that the latter two diseases are not strongly associated with gut dysbiosis. Certainly, at the genera level we were unable to discriminate their community compositions from healthy individuals. The number of samples in each of the disease phenotypes was also quite small. We hope that future large-scale sequencing projects will allow us to investigate this question further. The ‘Human Microbiome Project’ is restricted to healthy individuals but that will allow us to verify the existence of the two enterotypes that we propose are associated with a healthy microbiota <xref rid="pone.0030126-Peterson1" ref-type="bibr">[34]</xref>.</p>
    <p>The software for fitting the Dirichlet multinomial mixture is available for download from the Google Code project MicrobeDMM (<ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/microbedmm/">http://code.google.com/p/microbedmm/</ext-link>).</p>
  </sec>
</body>
<back>
  <ack>
    <p>We wish to thank Jose Carlos Clemente, Alan Walker and three anonymous reviewers for comments on an earlier draft of this manuscript, Peter Turnbaugh for providing the Twins data, and Ben Willing, Johan Dicksved and Anders Andersson for providing the IBD data set.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement">
      <p><bold>Competing Interests: </bold>KH is directly funded through a Unilever research grant to develop bioinformatics tools. All tools developed under this grant are being released open source. This does not alter the authors' adherence to all the PLoS ONE policies on sharing data and materials.</p>
    </fn>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding: </bold>CQ is funded by an EPSRC Career Acceleration Fellowship EP/H003851/1. KH by a Unilever directly funded research grant to the University of Glasgow. IH was supported by NIH/NIGMS grant R01-GM076705. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="pone.0030126-Streit1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Streit</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Schmitz</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>Metagenomics - the key to the uncultured microbes.</article-title>
        <source>Curr Opin Microbiol</source>
        <volume>7</volume>
        <fpage>492</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="pmid">15451504</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Dorigo1">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dorigo</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Volatier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Humbert</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Molecular approaches to the assessment of biodiversity in aquatic microbial communities.</article-title>
        <source>Water Res</source>
        <volume>39</volume>
        <fpage>2207</fpage>
        <lpage>2218</lpage>
        <pub-id pub-id-type="pmid">15935436</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Margulies1">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Margulies</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Egholm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Altman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Attiya</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bader</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2005</year>
        <article-title>Genome sequencing in microfabricated high-density picolitre reactors.</article-title>
        <source>Nature</source>
        <volume>437</volume>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="pmid">16056220</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Caporaso1">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Lauber</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Berg-Lyons</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lozupone</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2011</year>
        <article-title>Global patterns of 16S rRNA diversity at a depth of millions of sequences per sample.</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <comment>e-pub ahead of print doi: 10.1073/pnas.1000080107</comment>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Wang1">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Garrity</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Tiedje</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Naive Bayesian classifier for rapid assignment of rRNA sequences into the new bacterial taxonomy.</article-title>
        <source>Appl Environ Microbiol</source>
        <volume>73</volume>
        <fpage>5261</fpage>
        <lpage>5267</lpage>
        <pub-id pub-id-type="pmid">17586664</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Schloss1">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Handelsman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Introducing DOTUR, a computer program for defining operational taxonomic units and estimating species richness.</article-title>
        <source>Appl Environ Microbiol</source>
        <volume>71</volume>
        <fpage>1501</fpage>
        <lpage>1506</lpage>
        <pub-id pub-id-type="pmid">15746353</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Schloss2">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Handelsman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>A statistical toolbox for metagenomics: assessing functional diversity in microbial communities.</article-title>
        <source>BMC Bioinf</source>
        <volume>9</volume>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Sogin1">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sogin</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Mark Welch</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Huse</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2006</year>
        <article-title>Microbial diversity in the deep sea and the underexplored “rare biosphere”.</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <volume>103</volume>
        <fpage>12115</fpage>
        <lpage>12120</lpage>
        <pub-id pub-id-type="pmid">16880384</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Huber1">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Mark Welch</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Huse</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Neal</surname>
            <given-names>PR</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>Microbial population structures in the deep marine biosphere.</article-title>
        <source>Science</source>
        <volume>318</volume>
        <fpage>97</fpage>
        <lpage>100</lpage>
        <pub-id pub-id-type="pmid">17916733</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Quince1">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lanzen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Curtis</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Davenport</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>Accurate determination of microbial diversity from 454 pyrosequencing data.</article-title>
        <source>Nat Methods</source>
        <volume>6</volume>
        <fpage>639</fpage>
        <lpage>641</lpage>
        <pub-id pub-id-type="pmid">19668203</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Quince2">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lanzen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davenport</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>Removing noise from pyrosequenced amplicons.</article-title>
        <source>BMC Bioinf</source>
        <volume>12</volume>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Turnbaugh1">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Faith</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Yatsunenko</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Organismal, genetic, and transcriptional variation in the deeply sequenced gut microbiomes of identical twins.</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <volume>107</volume>
        <fpage>7503</fpage>
        <lpage>7508</lpage>
        <pub-id pub-id-type="pmid">20363958</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Quince3">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Curtis</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Sloan</surname>
            <given-names>WT</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>The rational exploration of microbial diversity.</article-title>
        <source>ISME J</source>
        <volume>2</volume>
        <fpage>997</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">18650928</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Hamady1">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hamady</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Gold</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Error-correcting barcoded primersfor pyrosequencing hundreds of samples in multiplex.</article-title>
        <source>Nat Methods</source>
        <volume>5</volume>
        <fpage>235</fpage>
        <lpage>237</lpage>
        <pub-id pub-id-type="pmid">18264105</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Ramette1">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramette</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Multivariate analyses in microbial ecology.</article-title>
        <source>FEMS Microbiol Ecol</source>
        <volume>62</volume>
        <fpage>142</fpage>
        <lpage>160</lpage>
        <pub-id pub-id-type="pmid">17892477</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Lozupone1">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lozupone</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>UniFrac: a new phylogenetic method for comparing microbial communities.</article-title>
        <source>Appl Environ Microbiol</source>
        <volume>71</volume>
        <fpage>8228</fpage>
        <lpage>8235</lpage>
        <pub-id pub-id-type="pmid">16332807</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Caporaso2">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stombaugh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>QIIME allows analysis of high-throughput community sequencing data.</article-title>
        <source>Nat Methods</source>
        <volume>7</volume>
        <fpage>335</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="pmid">20383131</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Arumugam1">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arumugam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pelletier</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Le Paslier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yamada</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2011</year>
        <article-title>Enterotypes of the human gut microbiome.</article-title>
        <source>Nature</source>
        <volume>473</volume>
        <fpage>174</fpage>
        <lpage>180</lpage>
        <pub-id pub-id-type="pmid">21508958</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Sun1">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Mai</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Farmerie</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Advanced computational algorithms for microbial community analysis using massive 16S rRNA sequence data.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>38</volume>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Knights1">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knights</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>Supervised classification of human microbiota.</article-title>
        <source>FEMS Microbiol Rev</source>
        <volume>35</volume>
        <fpage>343</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="pmid">21039646</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Bishop1">
      <label>21</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bishop</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <source>Pattern Recognition and Machine Learning</source>
        <publisher-name>Springer: Yale University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Sjolander1">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sjolander</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Karplus</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hughey</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <year>1996</year>
        <article-title>Dirichlet mixtures: A method for improved detection of weak but significant protein sequence homology.</article-title>
        <source>Comput Appl Biosci</source>
        <volume>12</volume>
        <fpage>327</fpage>
        <lpage>345</lpage>
        <pub-id pub-id-type="pmid">8902360</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-X1">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>X</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>YK</given-names>
          </name>
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Compositional adjustment of Dirichlet mixture priors.</article-title>
        <source>J Comput Biol</source>
        <volume>17</volume>
        <fpage>1607</fpage>
        <lpage>1620</lpage>
        <pub-id pub-id-type="pmid">21128852</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Bouguila1">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bouguila</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>Count data modeling and classification using finite mixtures of distributions.</article-title>
        <source>IEEE Trans Neural Netw</source>
        <volume>22</volume>
        <fpage>186</fpage>
        <lpage>198</lpage>
        <pub-id pub-id-type="pmid">21095862</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-D1">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>D</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Charlson</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Zaneveld</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mozer</surname>
            <given-names>MC</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2011</year>
        <article-title>Bayesian community-wide culture-independent microbial source tracking.</article-title>
        <source>Nat Methods</source>
        <volume>8</volume>
        <fpage>761</fpage>
        <lpage>763</lpage>
        <pub-id pub-id-type="pmid">21765408</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Mackay1">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mackay</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <year>1992</year>
        <article-title>Bayesian interpolation.</article-title>
        <source>Neural Comput</source>
        <volume>4</volume>
        <fpage>415</fpage>
        <lpage>417</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Turnbaugh2">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Hamady</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yatsunenko</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cantarel</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Duncan</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>A core gut microbiome in obese and lean twins.</article-title>
        <source>Nature</source>
        <volume>457</volume>
        <fpage>480</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="pmid">19043404</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Willing1">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willing</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Dicksved</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Halfvarson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Lucio</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>A Pyrosequencing Study in Twins Shows That Gastrointestinal Microbial Profiles Vary With Inflammatory Bowel Disease Phenotypes.</article-title>
        <source>Gastroenterology</source>
        <volume>139</volume>
        <fpage>1844</fpage>
        <lpage>U105</lpage>
        <pub-id pub-id-type="pmid">20816835</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Galassi1">
      <label>29</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Galassi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>GNU Scientific Library Reference Manual.</article-title>
        <comment>URL <ext-link ext-link-type="uri" xlink:href="http://www.gnu.org/software/gsl/">http://www.gnu.org/software/gsl/</ext-link>. ISBN 0-954612-07-8</comment>
      </element-citation>
    </ref>
    <ref id="pone.0030126-R1">
      <label>30</label>
      <element-citation publication-type="other">
        <collab>R Development Core Team</collab>
        <year>2010</year>
        <article-title>R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria.</article-title>
        <comment>URL <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org">http://www.R-project.org</ext-link>. ISBN 3-900051-07-0</comment>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Liaw1">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liaw</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wiener</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Classification and regression by randomforest.</article-title>
        <source>R news</source>
        <volume>2</volume>
        <fpage>18</fpage>
        <lpage>22</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Diamond1">
      <label>32</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Diamond</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>1997</year>
        <source>Guns, Germs, and Steel</source>
        <publisher-loc>New York, New York</publisher-loc>
        <publisher-name>W. W. Norton</publisher-name>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Tolstoy1">
      <label>33</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Tolstoy</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <year>1877</year>
        <source>Anna Karenina</source>
        <publisher-loc>Moscow, Russia</publisher-loc>
        <publisher-name>The Russian Messenger</publisher-name>
      </element-citation>
    </ref>
    <ref id="pone.0030126-Peterson1">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peterson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Garges</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Giovanni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McInnes</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>The NIH Human Microbiome Project.</article-title>
        <source>Genome Res</source>
        <volume>19</volume>
        <fpage>2317</fpage>
        <lpage>2323</lpage>
        <pub-id pub-id-type="pmid">19819907</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
