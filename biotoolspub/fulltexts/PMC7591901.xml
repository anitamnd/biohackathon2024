<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Commun Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Commun Biol</journal-id>
    <journal-title-group>
      <journal-title>Communications Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2399-3642</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7591901</article-id>
    <article-id pub-id-type="publisher-id">1350</article-id>
    <article-id pub-id-type="doi">10.1038/s42003-020-01350-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Spatiotemporal identification of druggable binding sites using deep learning</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6552-0881</contrib-id>
        <name>
          <surname>Kozlovskii</surname>
          <given-names>Igor</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Popov</surname>
          <given-names>Petr</given-names>
        </name>
        <address>
          <email>p.popov@skoltech.ru</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.454320.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 0555 3608</institution-id><institution>iMolecule, Center for Computational and Data-Intensive Science and Engineering, </institution><institution>Skolkovo Institute of Science and Technology, </institution></institution-wrap>Bolshoy Boulevard 30, bld. 1, Moscow, 121205 Russia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>3</volume>
    <elocation-id>618</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>10</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Identification of novel protein binding sites expands druggable genome and opens new opportunities for drug discovery. Generally, presence or absence of a binding site depends on the three-dimensional conformation of a protein, making binding site identification resemble the object detection problem in computer vision. Here we introduce a computational approach for the large-scale detection of protein binding sites, that considers protein conformations as 3D-images, binding sites as objects on these images to detect, and conformational ensembles of proteins as 3D-videos to analyze. BiteNet is suitable for spatiotemporal detection of hard-to-spot allosteric binding sites, as we showed for conformation-specific binding site of the epidermal growth factor receptor, oligomer-specific binding site of the ion channel, and binding site in G protein-coupled receptor. BiteNet outperforms state-of-the-art methods both in terms of accuracy and speed, taking about 1.5 minutes to analyze 1000 conformations of a protein with ~2000 atoms.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Kozlovskii and Popov present BiteNet, a new computational method utilizing deep learning principles for rapid detection of binding sites. BiteNet considers proteins as 3D images, enabling rapid detection of allosteric sites from either static protein structures or its dynamic ensembles.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Machine learning</kwd>
      <kwd>Target identification</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Proteins serve biological functionality of a cell via local intermolecular interactions that take place in spatial regions, called binding sites. Binding sites are one of the key elements in drug discovery, being hot spots in the pharmacological targets, where the designed drug-like molecule should bind. Identification of novel binding sites expands druggable genome and opens new strategies for therapy and drug discovery<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Typically drug-like molecules target either orthosteric binding site, where protein interacts with endogenous molecules, or topologically distinct allosteric binding sites<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. The latter is of a special interest, because allosteric binding sites exhibit higher degree of sequence diversity between protein subtypes, thus, allowing to design more selective ligands, in contrast to the orthosteric ligands<sup><xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>.</p>
    <p id="Par4">Proteins are flexible molecules, that adopt various conformations during their life cycle; and a binding site is a dynamic property of a protein mediated by its conformational changes<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. Single protein structure represents only a minor part of the entire conformational space, hence, binding sites might be easy to overlook from the experimentally determined three-dimensional protein structures<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup>. Moreover, many proteins perform their function assembling to oligomeric structure and can form binding sites by means of oligomer’s subunits<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>.</p>
    <p id="Par5">Experimental identification of binding sites, such as fragment screening and site-directed tethering<sup><xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup>, using antibodies<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, small molecule microarrays<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, hydrogen-deuterium exchange<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, or site-directed mutagenesis<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> are resource-consuming and may result in negative outcome. On the other hand, computational methods allow to perform large scale binding site identification, investigate protein flexibility via molecular dynamics simulation, and probe to fit chemical compounds using virtual ligand or fragment-based screening. The classical approaches typically employ empirical scoring functions based on the structural information about known binding sites, or use this information as features for the machine learning algorithms<sup><xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR28">28</xref></sup>. The success rate of these approaches critically depends on the designed features, and may result in false positive predictions, that is identification of undruggable regions<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Most recently, deep learning approaches, that do not require hand-crafted feature engineering, demonstrated feasibility to predict protein binding sites<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. In spite of present progress, large-scale binding site detection remains to be a challenge, let alone that there is still a big room for improvement in terms of the method’s accuracy<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>.</p>
    <p id="Par6">In this study, we present rapid and accurate deep learning approach, dubbed BiteNet (<bold>Bi</bold>nding si<bold>te</bold> neural <bold>Net</bold>work), suitable for the large-scale and spatiotemporal identification of protein binding sites. Inspired by the computer vision problems, such as object detection in images and videos, we consider protein conformations as the 3D images, binding sites as the objects on these images to detect, and conformational ensembles, that is a set of protein conformations, as the 3D videos to analyze. We showed that BiteNet is capable to solve challenging binding site detection problems by applying it to three-dimensional structures of pharmacological targets, including ATP-gated cation channel, epidermal growth factor receptor, and G protein-coupled receptor. Particularly, BiteNet correctly identified oligomer-specific allosteric binding site formed by the subunits of the trimeric P2X3 receptor complex; and conformation-specific allosteric binding site of the epidermal growth factor receptor kinase domain. BiteNet can be used for spatiotemporal investigation of novel binding sites, as we showed by the example of molecular dynamics simulation trajectory for the adenosine A2A receptor. BiteNet outperforms the state-of-the-art methods both in terms of accuracy and speed as demonstrated on several benchmarks. It takes approximately 0.1 seconds to analyze single conformation and 1.5 minutes for BiteNet to analyze molecular dynamics trajectory with 1000 frames for protein with  ~2000 atoms, making it suitable for large-scale spatiotemporal analysis of protein structures.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>BiteNet architecture</title>
      <p id="Par7">To develop BiteNet we trained 3D convolutional neural network using manually curated protein structures from the Protein Data Bank as the training set (see “Methods” section). Figure <xref rid="Fig1" ref-type="fig">1</xref> presents the BiteNet workflow. Similarly to 2D images, that have two dimensions (width and height) and three channels for each pixel (red, green, and blue), we represent proteins as 3D images with three dimensions (width, height, and length) and 11 channels for each voxel, where channels correspond to the atomic densities of a certain type (see “Methods” section) (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). As neural networks typically take fixed size tensors for the input, we used voxel grid of 64 × 64 × 64 voxels and voxels of 1 Å × 1 Å × 1 Å size. If protein exceeds 64 Å in any of the dimensions, we used several voxel grids to represent it (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). The obtained voxel grids are processed with the 3D convolutional neural network (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>) to output 8 × 8 × 8 × 4 tensor, where the first three dimensions correspond to the cell coordinates relatively to the voxel grid (region of 8 × 8 × 8 voxels), and the four scalars of the last dimension correspond to the probability score of the binding site being in the cell and its Cartesian coordinates. This is followed by the processing of the obtained tensors to output the most relevant predictions of the binding sites (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). Thus, the input to the BiteNet is the spatial structure of a protein and the output is the centers of the predicted binding sites along with the probability scores. Finally, BiteNet identifies the amino acid residues of a binding site within 6 Å neighborhood with respect to the predicted center. Additionally, when applied to the conformational ensemble of a protein, the obtained predictions and identified amino acid residues are grouped using clustering algorithms (see “Methods” section).<fig id="Fig1"><label>Fig. 1</label><caption><title>Schematic representation of the BiteNet workflow.</title><p><bold>a</bold> The input three-dimensional structure of a protein is represented with voxel grid, where channels correspond to the atomic densities. <bold>b</bold> The voxel grid is split into fixed-size cubic grids to be fed a neural network. <bold>c</bold> Each cubic grid is processed with the 3D convolutional neural network to predict binding sites in fixed-size cells. Cells in cubic grids are colored according to the probability score confidence, from blue to red. <bold>d</bold> Predictions obtained for each cubic grid are then processed to output center of the binding site (red sphere), its probability score, and amino acid residues within 6 Å of the predicted center (blue sticks). Co-crystallized ligand is shown with gray sticks.</p></caption><graphic xlink:href="42003_2020_1350_Fig1_HTML" id="d30e359"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Spatiotemporal prediction of binding sites in pharmacological targets</title>
      <p id="Par8">To demonstrate applicability of BiteNet we considered challenging binding site detection problems comprising three pharmacological targets: the P2X3 receptor of the ATP-gated cation channel family, the epidermal growth factor receptor of the kinase family, and the adenosine A2A receptor of the G-protein coupled receptor family.</p>
      <sec id="Sec5">
        <title>ATP-gated cation channel</title>
        <p id="Par9">The ATP-gated cation channel, formed by the P2X3 receptor, mediates various physiological processes and represents pharmacological target for hypertension, inflammation, pain perception, and others<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. The channel consists of three identical monomers traversing the membrane, and the orthosteric ATP-binding site comprises amino acid residues of two monomers (see Fig. <xref rid="Fig2" ref-type="fig">2c</xref>)<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. Drug design targeting the orthosteric binding site is difficult due to highly polarized ATP-specific interface, on the other hand, allosteric ligands targeting protein–protein interactions form promising avenue for drug discovery<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. Recently allosteric binding site formed by two monomers of a channel was discovered for the P2X3 and P2X7 receptors<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR33">33</xref></sup>. We applied BiteNet to the ATP-bound and (AF-219)-bound structures of the trimer complex formed by the P2X3 monomers (PDB IDs: 5SVK, 5YVE), as well as to the single monomer structures. BiteNet correctly identified the orthosteric binding site in the ATP-bound structure and the allosteric binding site in the (AF-219)-bound structure of the trimer, and not in the monomer structures (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Interestingly, BiteNet also predicted center for the ATP-binding site located on the opposite end of the ATP molecule with lower probability score (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>). To ensure, that this is not an artifact of the rotational variance of the model, we generated 50 replicas by rotating the monomer about ten axes by <italic>π</italic>/3, 2<italic>π</italic>/3, <italic>π</italic>, 4<italic>π</italic>/3, and 5<italic>π</italic>/3 angles and averaged the obtained predictions. As one can see from Fig. <xref rid="Fig2" ref-type="fig">2e, f</xref> although the absolute values of the probability scores vary with respect to the monomers, in all the cases BiteNet correctly identifies the allosteric binding site for the trimer complex and not for the monomer. Note, that ATP is endogenous agonist, while AF-219 is antagonist for the P2X trimer. The agonist-bound and the antagonist-bound conformations are different, particularly, in the regions of the orthosteric and allosteric binding sites (Fig. <xref rid="Fig2" ref-type="fig">2c, d</xref>). Therefore, BiteNet is sensitive to the conformational changes, as it does not predict the ATP-binding site in the (AF-219)-bound structure and vice versa. Interestingly, despite absence of binding site in the monomer structure, BiteNet predicted different binding sites with relatively high score in the monomer structures. Closer look into available three-dimensional structures of the P2X3 receptors revealed cation ions (Mg, Na, Ca), and ethylene glycol molecules corresponding to these predictions (PDB IDs: 5YVE, 5SVS, 5SVT, 5SVJ, 5SVR, 5SVQ, 5SVP, 5SVM, 5SVL, 6AH4, and 6AH5). We would like to emphasize that the training set does not contain structures similar to the P2X3 receptor. Indeed, the maximal sequence identity is 0.32 for human heparanase (PDB ID: 5L9Z) and the maximal structure similarity is 0.6 for tyrosine carboxypeptidase (PDB ID: 6J4P). Thus, this case demonstrates predictive power of BiteNet, rather than detection of memorized binding sites.<fig id="Fig2"><label>Fig. 2</label><caption><title>BiteNet predictions for the monomer and oligomer structure of the P2X3 receptor.</title><p><bold>a</bold> Monomer structure with the orthosteric ligand and cation ion alongside the BiteNet prediction for this structure. <bold>b</bold> Monomer structure with the allosteric ligand, cation ion and ethylene glycole alongside the BiteNet prediction for this structure. <bold>c</bold>, <bold>d</bold> Agonist-bound and antagonist-bound structures of the P2X3 trimer, respectively. <bold>e</bold>, <bold>f</bold> BiteNet predictions for the agonist-bound and antagonist-bound structures of the P2X3 trimer, respectively. Orthosteric and allosteric ligands are shown with red and magenta sticks, respectively. cation ions are shown as dark green spheres and ethylene glycol molecules are shown with violet sticks. BiteNet predictions for these molecules are shown as spheres with the corresponding color.</p></caption><graphic xlink:href="42003_2020_1350_Fig2_HTML" id="d30e448"/></fig></p>
      </sec>
      <sec id="Sec6">
        <title>Epidermal growth factor receptor (EGFR)</title>
        <p id="Par10">EGFR is a transmembrane protein from the tyrosine kinase family. Over-expression of EGFR is associated with various types of tumors. Although there are EGFR inhibitors targeting the orthosteric binding site of the kinase domain, proteins found in cancer cells often have amino acid substitutions making it insensitive to such inhibitors. There are also mutant-selective irreversible inhibitors that covalently bind to the Cys797 amino acid residue, however, some mutant type receptors possess different amino acid residue at 797 position as well<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. Recently, three-dimensional structure of L858R/T790M EGFR kinase domain variant bound to the mutant-selective allosteric inhibitor EAI001 was discovered (PDB ID: 5D41)<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. It was shown, that EAI001 binds to only one monomer, leading to incomplete inhibition, but decreasing cell autophosphorylation. Accordingly, the three-dimensional structure is asymmetric dimer with one monomer bound to both orthosteric and allosteric ligands (the ATP-analog adenylyl-imidodiphosphate (AMP-PNP) and EAI001, respectively), while the other monomer bound to AMP-PNP only. BiteNet successfully identified both orthosteric and allosteric binding sites in one monomer (chain A) and only former in the other monomer (chain B). In contrast to the P2X3 case study, the training set does contain two EGFR kinase domain structures (PDB IDs: 5UG9, 5GNK) as well as three other proteins with high sequence identity and structure similarity: DDX25 RNA helicase (PDB ID: 2RB4), kinase domain of human HER2 (PDB ID: 3PP0) and HER3 pseudokinase domain (PDB ID: 4OTW) with sequence similarity of 0.722, 0.762, and 0.596 and structure similarity 0.833, 0.876, and 0.944, respectively. Nonetheless, all these structures have ligands bound to the binding sites corresponding to the EGFR orthosteric binding site, but not to the allosteric binding site. Therefore, this example shows the predictive power of BiteNet to detect conformation-specific binding sites.</p>
        <p id="Par11">Although this and previous examples clearly demonstrate BiteNet’s capability to detect binding sites in <italic>holo</italic> conformations, on practice, such conformations can be unknown, especially, when one wants to discover novel binding sites. To evaluate BiteNet’s ability to detect binding sites starting from the unbound conformation, we emulated unbound-to-bound conformational transition as it follows. First, we modeled missing residues in chain B and placed EAI001, as it is observed in chain A. Then, we prepared molecular dynamics system containing chain B, AMP-PNP and EAI001, embedded into the water box with ions using the CHARMM-GUI web server<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. Next, we run full atom energy minimization of the prepared system until convergence using Gromacs<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>, resulting in minimization trajectory consisting of  ~900 conformations. Finally, we removed ligands, ions, and water and applied BiteNet to each frame of the minimization trajectory along with its 50 replicas. Figure <xref rid="Fig3" ref-type="fig">3c</xref> shows, that the probability score for the allosteric binding site steadily increases, while the energy of the system is decreasing and the root mean square deviation (RMSD) with respect to the allosteric binding site in the starting (unbound) conformation is increasing. Supplementary Movie <xref rid="MOESM4" ref-type="media">1</xref> (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>) demonstrates BiteNet predictions along with the minimization trajectory. Note, that the probability score for the orthosteric binding site remains high during the minimization. Also note, that we used 4Å for the non-max suppression distance threshold in order to avoid merging of the predictions for orthosteric and allosteric binding sites during post-processing stage of BiteNet. Therefore, BiteNet can be applied for the large-scale spatiotemporal trajectories in order to detect protein conformations that possess binding sites unseen in the original structure.<fig id="Fig3"><label>Fig. 3</label><caption><title>BiteNet predictions for the energy minimization trajectory of the assymetric dimer structure of the EGFR kinase domain.</title><p><bold>a</bold> Assymetric dimer structure of the EGFR kinase domain. Orthosteric and allosteric ligands are shown with yellow and magenta sticks, respectively, Mg ion is shown as green sphere. <bold>b</bold> BiteNet predictions for the assymetric dimer, the predicted centers for the ligands are shown as spheres with the corresponding color. <bold>c</bold> BiteNet predictions obtained for the energy minimization trajectory. The normalized energy is shown with blue dash-dotted line, the RMSD with respect to the unbound conformation of the alloteric binding site is shown with violet dotted line, BiteNet probability score for the orthosteric and allosteric binding sites are shown with dashed orange and magenta solid lines, respectively. The normalized energy of 1 and 0 corresponds to  −7.76969 × 10<sup>5</sup> kJ/mol and  −8.80655 × 10<sup>5</sup> kJ/mol, respectively. <bold>d</bold> The starting and the final conformations of the minimization trajectory along with BiteNet predictions.</p></caption><graphic xlink:href="42003_2020_1350_Fig3_HTML" id="d30e512"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><title>Video frames of energy minimization and molecular dynamic trajectories analyzed with BiteNet.</title><p><bold>a</bold> BiteNet applied to the minimization trajectory of the EGFR kinase domain starting from the unbound state (Supplementary Movie <xref rid="MOESM4" ref-type="media">1</xref>). Predictions corresponding to the orthosteric and allosteric sites are shown as yellow and magenta spheres, respectively. Frames 1 and 894 are shown. <bold>b</bold>, <bold>c</bold> BiteNet applied to the ligand-free (<bold>b</bold>) and ligand-bound (<bold>c</bold>) A2A molecular dynamics trajectory (Supplementary Movies <xref rid="MOESM5" ref-type="media">2</xref> and <xref rid="MOESM6" ref-type="media">3</xref>, respectively). BiteNet predictions for the orthosteric and hypothethical binding sites are colored with yellow and magenta, respectively. Lipid molecule, that occupies the identified binding site, is shown with green sticks. Frames 1489 and 2055 are shown for the ligand-free simulation, and frames 835 and 1806 are shown for the ligand-bound simulation.</p></caption><graphic xlink:href="42003_2020_1350_Fig4_HTML" id="d30e547"/></fig></p>
      </sec>
      <sec id="Sec7">
        <title>G protein-coupled receptor (GPCRs)</title>
        <p id="Par12">GPCRs mediate numerous physiological processes in the body, making them important targets for modern drug discovery. Most of FDA-approved drugs bind to orthosteric binding sites of GPCRs. However, such drugs may be nonselective with respect to the highly homologous receptor subtypes. In such cases, there is need in drug design targeting allosteric binding sites, that are less conserved than orthosteric one<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. Three-dimensional structures of GPCRs reveal allosteric binding sites spanning extracellular, transmembrane, and intracellular regions; identification of novel allosteric sites in GPCRs can provide alternative options for drug discovery<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. To demonstrate the use of BiteNet in spatiotemporal identification of GPCR binding sites we analyzed molecular dynamics trajectories of the human adenosine A2A receptor (A2A) retrieved from the GPCRmd repository<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>.</p>
        <p id="Par13">Namely, we considered trajectories of A2A embedded into the POPC lipid bilayer surrounded by water, sodium and chloride ion molecules starting from the active-like conformation (PDB ID: 5G53) in complex with agonist NECA and with no ligand (GPCRmd IDs: 48:10498 and 47:10488, respectively). In total each simulation lasted for 500 ns with the time step of 4.0 fs and interval between frames of 2.0 ns, resulting in 2500 conformations of A2A. We consequently applied BiteNet for each frame of the trajectory. As expected, in both simulation trajectories we observed a cluster of predictions corresponding to the canonical orthosteric binding site in GPCRs. The cluster is more dense and with higher averaged score in the ligand-bound simulation trajectory, which could be explained by lower flexibility of the protein due to the protein–ligand interactions. Surprisingly, in both simulation trajectories we also observed cluster of predictions in the neighborhood of the end of TM1, TM7 and helix 8 starting from ~300 ns in the ligand-free simulation and from  ~150 to  ~200 ns and from  ~320 to 370 ns in the ligand-bound simulation. Closer look to the conformations with the highest probability scores corresponding to this cluster revealed lipid tail buried to the cavity formed by hydrophobic amino acid residues. It is important to note, that although GPCRs are tightly surrounded by lipids, BiteNet did not produced predictions all over the region exposed to a membrane, as it was explicitly trained on druggable binding sites. To investigate if the lipid tail binds to the cavity, for each frame <italic>f</italic> we calculated its mobility in terms of RMSD between the conformation of the lipid tail in this frame and the conformation of the lipid tail averaged over [<italic>f</italic>  − 100, <italic>f</italic>  + 100] frames. As one can see from Fig. <xref rid="Fig5" ref-type="fig">5c, d</xref>, the calculated RMSD is lower for the frames with high probability scores corresponding to the predicted binding site. Supplementary Movies <xref rid="MOESM5" ref-type="media">2</xref> and <xref rid="MOESM6" ref-type="media">3</xref> (Fig. <xref rid="Fig4" ref-type="fig">4b, c</xref>) demonstrates BiteNet predictions and binding of the POPC molecule during these simulations. To the best of our knowledge there is no available structures for any GPCR with ligand bound to this region. When applied BiteNet to molecular dynamics trajectories obtained for other receptors from GPCRmd, we also observed similar cluster in the muscarinic M2 receptor, again, starting from active-like conformation. Thus, the predicted region may be worth paying attention to, as it may correspond to the novel allosteric binding site in GPCRs.<fig id="Fig5"><label>Fig. 5</label><caption><title>BiteNet predictions for molecular dynamics trajectories of the adenosine A2A receptor.</title><p><bold>a</bold>, <bold>b</bold> Starting ligand-free and agonist-bound conformations of A2A, respectively. Orange point clouds corresponds to the BiteNet predictions of the canonical orthosteric binding site in A2A, while magenta point cloud corresponds to the BiteNet predictions of the hypothetical binding site, observed during the simulation. <bold>c</bold>, <bold>d</bold> BiteNet probability scores for the orthosteric binding site (dashed orange line), allosteric binding site (magenta solid line), and RMSD with respect to the window-based mean lipid tail conformation (dotted violet line), computed for the molecular dynamics trajectories. <bold>e</bold>, <bold>f</bold> A2A conformations corresponding to the highest BiteNet probability scores for the hypothetical binding site. Lipid molecule, that occupies the hypothetical binding site, is shown with green sticks.</p></caption><graphic xlink:href="42003_2020_1350_Fig5_HTML" id="d30e616"/></fig></p>
        <p id="Par14">To summarize, we showed applicability of BiteNet for binding site detection for three different pharmacological targets and challenging binding sites observed in soluble as well as in transmembrane protein domains. BiteNet was capable to detect conformation-specific and oligomer-specific allosteric binding sites and can be applied for large-scale spatiotemporal analysis of protein structures. Using the example of A2A we demonstrated how BiteNet can be used on practice to investigate novel binding sites. We also would like to note, that used three-dimensional structures were not exposed to BiteNet during the training process. In the next section, we demonstrate computational efficiency of BiteNet in terms of accuracy and speed by comparing it against the existing computational methods on binding site prediction benchmarks.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Computational efficiency of BiteNet</title>
      <p id="Par15">To compare BiteNet with the other approaches we evaluated its performance on the HOLO4K and COACH420 benchmarks (see “Methods” section). As the performance metric we used the average precision (AP), as we consider this metric the most suitable for the binding site prediction problem (see “Discussion” section). We calculated AP for <italic>A</italic><italic>l</italic><italic>l</italic> and <italic>T</italic><italic>o</italic><italic>p</italic><italic>N</italic> predictions, where <italic>N</italic> is the number of the true binding sites present in a protein structure. As one can see from Fig. <xref rid="Fig6" ref-type="fig">6a</xref> BiteNet significantly outperforms (<italic>p</italic>-value ≤ 1.2<italic>e</italic><sup>−6</sup>) classical binding site prediction methods, such as fpocket<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>, SiteHound<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, MetaPocket<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, as well as the state-of-the-art machine learning methods, such as DeepSite<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> and P2Rank<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> (Supplementary Tables <xref rid="MOESM1" ref-type="media">3</xref>–<xref rid="MOESM1" ref-type="media">12</xref> lists more detailed comparison including the performance on the entire benchmarks, as well as the precision, recall, true positive, false positive, and false negative metrics).<fig id="Fig6"><label>Fig. 6</label><caption><title>Predictive power and computational efficiency of BiteNet.</title><p><bold>a</bold> Performance of the binding site prediction methods on the COACH420 and HOLO4K benchmarks. Violet and orange bars with diagonal hatching correspond to the average precision calculated for top <italic>N</italic> predictions for the COACH420 and HOLO4K benchmarks, respectively, where <italic>N</italic> is the number of true binding sites in a protein. Similarly, cyan and blue back hatched bars correspond to the average precision calculated for all predictions for the COACH420 and HOLO4K benchmarks, respectively. Pale bars correspond to the BiteNet performance, when the true positive binding site is defined as in the training. Black lines correspond to the BiteNet performance on the whole benchmarks. <bold>b</bold> Elapsed time for fpocket (dotted violet line), P2Rank (dashed orange, magenta, and green lines), and BiteNet (solid blue line) to analyze 1, 10, 1000, and 10,000 conformations of a protein with  ~2000 atoms. The computed elapsed time is the average of ten independent runs, individual data points are shown with gray circles.</p></caption><graphic xlink:href="42003_2020_1350_Fig6_HTML" id="d30e703"/></fig></p>
      <p id="Par16">BiteNet is also computationally efficient, Fig. <xref rid="Fig6" ref-type="fig">6b</xref> shows elapsed time spent by BiteNet along with fpocket and P2Rank, which are one of the fastest methods, with respect to the number of the processed protein conformations. BiteNet, that runs on a single GPU (GeForce GTX 1080 Ti), outperforms P2Rank that runs on several CPUs (Intel(R) Core(TM) i7-8700K CPU @ 3.70 GHz). On average, BiteNet takes approximately 0.1 seconds to process single protein conformation. Further optimization of CPU–GPU interconnection and multiple GPUs implementation of BiteNet will result in even faster performance.</p>
      <p id="Par17">We observed that BiteNet’s performance is 5% higher, when the true positive prediction of a binding site is defined as in the training, as compared to the P2Rank’s criterion. The main reason for this is more strict ligand filtering implemented in the training aiming to discard not relevant small molecules. For example, in the HOLO4K benchmark there are 29 structures corresponding to the Aspartic peptidase A1 protein family, that have the only active site with a peptide-like molecule bound to it. However, there are also small sugars (mannoses or arabinoses) that surround protein structures yielding additional binding sites according to the P2Rank’s criterion (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). Therefore the total number of binding sites is 29 for the BiteNet’s criterion and 38 for the P2Rank’s criterion. As a result, BiteNet yields zero false negative predictions in the former case, and nine in the latter case, hence, the drop in the AP metric from 0.99 to 0.75.</p>
      <p id="Par18">To investigate BiteNet’s predictive power in more detail we considered its performance on the most represented protein families comprising the HOLO4K benchmark retrieved from the InterPro database<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. More precisely, we assigned the InterPro family identifier to each protein in the HOLO4K benchmark and considered protein families counting at least 20 protein structures and containing at least one relevant binding site according to the BiteNet’s criterion. Figure <xref rid="Fig7" ref-type="fig">7</xref> shows the AP metric calculated for each protein family for BiteNet, as well as the ratio of structures from this family presented in the training set. BiteNet outperforms the other methods on 17 out of 27 protein families, for two protein families BiteNet is on par with P2Rank showing the perfect performance, and for the rest eight protein families there is a method with better performance than BiteNet (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>). Note also that none of the protein families are over-represented in the training set (the median ratio is 0.15%). Figure <xref rid="Fig8" ref-type="fig">8</xref> demonstrates common types of false positive and false negative predictions on example of Glycosyl transferase protein family (IPR000811). The most common false positive predictions correspond to the ligand-free region with low probability score (≤0.15) (see Fig. <xref rid="Fig8" ref-type="fig">8a</xref>). Interestingly, another type of false positive predictions correspond to the region with absent ligand in one structures, but present in the others (see Fig. <xref rid="Fig8" ref-type="fig">8c</xref>). Given higher probability scores (≥0.20) and capability to bind a ligand to the predicted binding site in some protein structures, it is not clear whether these predictions should be considered as false positive. At the same time, there are structures with the bound ligand, but with no binding site predictions, corresponding to the most common type of the false negative predictions (see Fig. <xref rid="Fig8" ref-type="fig">8b</xref>). Finally, we observed that some false negative predictions correspond to ligands in the proximity of the catalytic binding site predicted with high probability score (≥0.75) for the PLP molecule (pyridoxal-5′-phosphate) (see Fig. <xref rid="Fig8" ref-type="fig">8</xref>d). Thus, such false negative predictions might be an artifact of the nonmax-suppression procedure, when only single prediction with the highest probability score is kept within the 8 Å.<fig id="Fig7"><label>Fig. 7</label><caption><title>BiteNet performance on the most representative protein families in the HOLO4K benchmark.</title><p>Average precision calculated for protein families with at least 20 protein structures in the HOLO4K benchmark is shown with diagonal hatched blue bars. Ratio of structures from each protein family presented in the training set is shown with back diagonal hatched orange bars.</p></caption><graphic xlink:href="42003_2020_1350_Fig7_HTML" id="d30e752"/></fig><fig id="Fig8"><label>Fig. 8</label><caption><title>Examples of BiteNet prediction errors on the Glycosil transferase protein family (IPR000811).</title><p><bold>a</bold> Low scored false positive predictions, for which there are no bound ligands. <bold>b</bold> False negative predictions, that is absence of predictions in the proximity of the bound ligand. <bold>c</bold> Similar predictions may correspond to both the true positive and false positive predictions depending on the presence (PDB ID: 3GPB) or absence (PDB ID: 1FU7) of the bound ligand. <bold>d</bold> Catalytic site with two ligands is predicted either as two (PDB ID: 1LWN) or single (PDB ID: 5GPB) binding sites, resulting in false negative predictions. BiteNet predictions are depicted with spheres colored from white to red with respect to the probability score, and ligands are depicted with magenta, yellow and purple sticks.</p></caption><graphic xlink:href="42003_2020_1350_Fig8_HTML" id="d30e774"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par19">In this study we introduced BiteNet, a deep learning approach for spatiotemporal identification of binding sites. BiteNet takes advantages of the computer vision methods for object detection, by representing three-dimensional structure of a protein as a 3D image with channels corresponding to the atomic densities. BiteNet goes beyond classical problem of binding site prediction in <italic>holo</italic> protein structures, exploring protein dynamics and flexibility by means of large-scale analysis of conformational ensembles. The detected conformations with observed binding site of interest, then can be used for structure-based drug design approaches, such as molecular docking and virtual ligand screening, as well as structure-based de novo drug design.</p>
    <p id="Par20">We believe superior performance of BiteNet with respect to the other machine learning methods for binding site prediction was achieved due to careful preparation of the training set and training process; below we address several important issues related to these procedures.</p>
    <p id="Par21">Curated and well-balanced training set is of crucial importance for derivation of machine learning models and its applicability domain. Experimentally determined protein structures often contain detergent and buffer molecules, that reveal electron density. This should be considered carefully and not mixed up with the true binding sites. To avoid potential bias related to this problem we filtered out typical detergent and buffer molecules (see Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). Note, however, this procedure likely resulted in removing both false and true positives binding sites. For example, we discarded lipid molecules surrounding membrane proteins, including functional lipid molecules, such as cholesterol. Additionally, training set inevitably contains false negative binding sites, because protein structures may also contain empty binding sites. Another source for false positive binding sites come from symmetrical oligomer structures, as for example the P2X3 trimer. Indeed, the asymmetric unit does contain the ligand, however the binding site is formed not only by the asymmetric unit, but also by symmetry mates, which are usually omitted in the analysis. We also observed structures with missing atoms and residues in the binding sites; we believe such structures should be either properly refined or discarded from the training set. In addition, the definition of the true positive prediction and binding site itself may vary. Binding site is typically defined with respect to the cutoff distance between the protein and ligand atoms (4.0 Å in this study), center of the binding site can be defined as the center of mass of the ligand or the binding site residues (in this study), and the true positive prediction can be defined with respect to the cutoff distance between the ligand or center of the binding site (4.0 Å in this study). We choose the latter definition of the true positive prediction because it is invariant with respect to the type of the ligand and its binding pose.</p>
    <p id="Par22">Training-validation split is another important issue, that affects performance of the derived model. First of all structural similarity should be taken into account, as it is known that proteins with low sequence similarity may still share highly similar protein fold. We observed that the largest cluster contains 4044 protein chains of similar structures. Splitting this cluster into the train and validation sets would likely result in the bias and overfit with respect to the corresponding protein fold. To circumvent this issue we carefully distributed protein structures, such that there is no highly similar structures in the training and validation sets in terms of the TM-score structural similarity<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>.</p>
    <p id="Par23">Data augmentation techniques can be also helpful to derive more robust predictive models. For protein binding site prediction problem, computational methods to generate conformational ensembles can be used in order to represent binding site with multiple orientations or even small perturbations. In this study, due to computational limitations, we used implicit data augmentation and provided random orientation of proteins to the neural network each epoch.</p>
    <p id="Par24">Hyperparameters, such as neural network architecture, type of the activation functions, the learning rate, and many others, influences the model performance. Thus, fine-tuning is needed in order to find optimal set of the hyperparameters. We trained several models and found the following hyperparameters to be optimal: 64 voxels for the cubic grid size, 1.0Å for the voxel size, 4.0 Å for the density cutoff, 48 for the stride parameter, 16 for the minibatch size, 1e−5 and 10.0 for the <italic>γ</italic> and <italic>λ</italic> parameters, respectively (see Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref> for evaluation of models corresponding to different parameters). Among these parameters, the voxel size has dramatic influence on the computational speed, it takes  ~2 times more to train and apply the model with the voxel size of 0.8 Å, as compared to the voxel size of 1.0 Å. On the other hand, we observed model corresponding to the voxel size of 2.0 Å to be faster, though less accurate. Although we achieved satisfied performance of the resulting model (the average precision was improved from 0.4 to 0.53), our parameter screen is not meticulous. The auto-ml approaches would be useful to find optimal model through extensive search of neural network architecture and parameters<sup><xref ref-type="bibr" rid="CR43">43</xref>,<xref ref-type="bibr" rid="CR44">44</xref></sup>.</p>
    <p id="Par25">Note, that the obtained model is not rotation-translation invariant by construction; it could be easily seen from the different binding site scores assigned to identical subunits of oligomer (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>). To make sure this does not noticeably affect BiteNet’s performance, we re-evaluate the average precision on the augmented validation set and test benchmarks, that contains additional 50 replicas of each protein obtained with rotation by <italic>π</italic>/3, 2<italic>π</italic>/3, <italic>π</italic>, 4<italic>π</italic>/3, and 5<italic>π</italic>/3 angles about ten different axes corresponding to the centroids of the icosahedron facets<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>. Indeed, we observed that the average precision either did not change or slightly increased (see Supplementary Tables <xref rid="MOESM1" ref-type="media">3</xref>–<xref rid="MOESM1" ref-type="media">12</xref>). This is because for some replicas BiteNet produced additional binding site predictions with very low scores. Next, we analyzed if using of additional rotations affect internal ranking of true binding sites with respect to the probability score for each single structure in the HOLO4K benchmark. We observed that for most of the protein structures (2676 out of 3203) the ranking of the true positive predictions did not change, for 333 protein structures the ranking was improved, and for 194 protein structures the ranking was worsened. Thus, it might be useful to apply BiteNet for different orientations of the structure and average the obtained results.</p>
    <p id="Par26">As the performance metric we used the average precision (AP), that is the area below precision-recall curve:<disp-formula id="Equ1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{AP}}= \int_{0}^{1}p(r){\mathrm{d}}r,$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="normal">AP</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>r</mml:mi><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_1350_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>p</italic> is precision (Eq. <xref rid="Equ4" ref-type="">4</xref>), and <italic>r</italic> is recall (Eq. <xref rid="Equ5" ref-type="">5</xref>). The AP metric is one of the most indicative metric for the object detection problems in computer vision used by different methods and benchmarks<sup><xref ref-type="bibr" rid="CR46">46</xref>–<xref ref-type="bibr" rid="CR50">50</xref></sup>. Note that <italic>p</italic> or <italic>r</italic> metrics itself are not indicative, because precision and recall tends to be higher with smaller and larger number of predicted binding sites, respectively. The AP metric, in turn, is independent from the number of predicted binding sites and strongly depends on the ranking of the predictions, thus, it is suitable for comparison of methods with different average number of predicted binding sites and score ranges. We would also like to note that other conventional metrics, like specificity or Matthews correlation coefficient (MCC), are not suitable for comparison due to the lack of strict definition of a true negative (TN) prediction. Indeed, there are literally infinite number of points around the protein structure that can be considered as negative predictions of the binding site centers. Furthermore, as various methods operates with binding sites differently, e.g., voxel centers (BiteNet), surface points (Fpocket and P2Rank), low energy point clusters (SiteHound), it is difficult to rigorously define true negative prediction, that would be suitable for general comparison.</p>
    <p id="Par27">In this study we introduced BiteNet, a deep learning approach for spatiotemporal identification of binding sites. BiteNet takes advantages of the computer vision methods for object detection, by representing three-dimensional structure of a protein as a 3D image with channels corresponding to the atomic densities. BiteNet goes beyond classical problem of binding site prediction in <italic>holo</italic> protein structures, exploring protein dynamics and flexibility by means of large-scale analysis of conformational ensembles. It is able to detect allosteric binding sites for both soluble and transmembrane protein domains and outperforms state-of-the-art methods both in terms of accuracy and speed. BiteNet takes approximately 0.1 seconds to analyze single conformation and 1.5 minutes to analyze molecular dynamics trajectory with 1000 frames for protein with ~2000 atoms.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Training dataset</title>
      <p id="Par28">To compose the training set we retrieved atomic structures of protein-ligand complexes with resolution better than 3.0 Å, that contain less than four protein chains, and the sequence identity threshold of 90% from protein data bank (PDB)<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>. Then we refined each protein structure by replacing nonstandard amino acid residues with the standard ones, modeling missing residues and short loops (less than ten amino acid residues) using the ICM-Pro software (molsoft.com). Note, that we did not model N-terminus and C-terminus, as well as long missing loops of more than ten amino acid residues. Then we discarded proteins, if refinement affects three or more atoms of its binding sites, because such conformational changes could be incompatible with the ligand binding pose. We also discarded water molecules, ions, protein chains with length less than 50 amino acid residues, and considered only nondetergent molecules (see Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>) with more than 14 heavy atoms as the ligands. We further disregarded protein complexes with less than 20 protein heavy atoms in the binding site, that is protein atoms within 4 Å distance from the ligand. Finally, we manually filtered out “long” proteins, which length across at least one of the principal axis was more than 250 Å (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>). This procedure yielded the final set of 5946 atomic structures of protein–ligand complexes comprising 11,301 polypeptide chains and 11,949 binding sites.</p>
      <p id="Par29">We considered each protein of a protein complex as a voxel grid, with voxel size of 1.0 Å with no spacing between the voxels. We represented each voxel by 11 channels corresponding to the atomic density function of a certain atom type, similarly to<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>:<disp-formula id="Equ2"><label>1</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho (r)=\left\{\begin{array}{l}{e}^{-{r}^{2}/2},\ \,{\text{if}}\,\,r \, \le \, {r}_{{\mathrm{cutoff}}}\\ 0,\ \qquad\text{otherwise}\,\end{array}\right.,$$\end{document}</tex-math><mml:math id="M4"><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mo>≤</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">cutoff</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mspace width="2.0em"/><mml:mi mathvariant="normal">otherwise</mml:mi><mml:mspace width="0.25em"/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_1350_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <italic>r</italic><sub>cutoff</sub> is the distance threshold of 4 Å.</p>
      <p id="Par30">For rigorous validation of the prediction model it is important to carefully split the training and the validation datasets. Given that proteins with low sequence similarity may still have high structural similarity, the standard random split would likely lead to the biased training and validation sets. To reduce possible bias, we calculated structural similarity for each pair of protein chains in the dataset using the TMalign software<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, resulting in 11,301 × 11,301 structural similarity matrix (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>). Then we grouped protein chains using the hierarchical clustering algorithm implemented in <italic>s</italic><italic>k</italic><italic>l</italic><italic>e</italic><italic>a</italic><italic>r</italic><italic>n</italic><sup><xref ref-type="bibr" rid="CR53">53</xref>,<xref ref-type="bibr" rid="CR54">54</xref></sup>, such that structural similarity of any two protein chains from different clusters is less than 0.5. Finally, we split the dataset in a way that the training and the validation sets do not share protein chains from the same clusters, comprising 9844 and 1457 protein chains, respectively.</p>
    </sec>
    <sec id="Sec12">
      <title>Benchmarks</title>
      <p id="Par31">The HOLO4K benchmark is a large dataset of holo protein structures used for evaluation of binding site prediction methods<sup><xref ref-type="bibr" rid="CR55">55</xref></sup>; it counts 4542 proteins, most of which are multichain complexes. The original COACH benchmark consists of 501 single chain proteins<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>; in this study, we used the subset of 420 proteins on which several state-of-the-art binding site prediction methods were compared recently<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>.</p>
      <p id="Par32">We compared BiteNet with the following approaches for the binding site detection: fpocket, a geometry-based method<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>; SiteHound, that uses probe molecules to find low energy clusters corresponding to the binding sites<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>; MetaPocket, a consensus approach that combines predictions of other methods<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>; DeepSite, a deep learning approach based on the voxelized representation of protein structures<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>; and P2Rank, a classical machine learning approach based on the feature vectors calculated from the protein surface<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>.</p>
      <p id="Par33">For fair comparison we considered only proteins not presented in the method’s train sets, and for which all methods successfully predict true binding sites according to the P2Rank criterion<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, resulting in the 239 and 1682 protein subsets from COACH420 and HOLO4K, respectively. Also to compute performances of the methods we used both our and P2Rank’s definition of the binding site. More precisely, the P2Rank’s definition filters small molecules with less than 4 atoms, as well as HOH, DOD, WAT, NAG, MAN, UNK, GLC, ADA, MPD, GOL, SO4, and PO4 molecules. The ligand must be within 4Å of a protein, and the distance from the ligand center to protein must be at least 5.5 Å. The average number of ligand binding sites per protein structure for both criteria for the COACH420 and HOLO4K benchmarks, as well as the average number of predictions of each method are listed in Supplementary Table <xref rid="MOESM1" ref-type="media">13</xref>. In addition performances on the entire datasets are provided in Supplementary Tables <xref rid="MOESM1" ref-type="media">5</xref>, <xref rid="MOESM1" ref-type="media">6</xref>.</p>
    </sec>
    <sec id="Sec13">
      <title>Neural network architecture</title>
      <p id="Par34">Given <italic>N</italic><sub>x</sub> × <italic>N</italic><sub>y</sub> × <italic>N</italic><sub>z</sub> × <italic>N</italic><sub>c</sub> voxel grid representation of a protein, we first divided it into the cubic grids of the fixed shape of 64 × 64 × 64 voxels with stride of 48 voxels, in order to get constant size input for the neural network. We considered cubic grids with the average atom density less than 1e−4 as empty cubic grids, and discarded it from the training and validation sets. Following the Yolo approach for the object detection problem in images<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>, we constructed neural network that converts 64 × 64 × 64 cubic grid into 8 × 8 × 8 cubic cells of size 8 × 8 × 8 voxels each, and aims to identify target cells, that contain centers of the binding sites, along with the center’s coordinates. Thus, the output of the prediction model is 8 × 8 × 8 × 4 tensor, where the first three dimensions are the cell coordinates with respect to the cubic grid (<italic>i</italic><sub>cell</sub>, <italic>j</italic><sub>cell</sub>, <italic>k</italic><sub>cell</sub>), and the four scalars of the fourth dimension are the probability score <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{s}$$\end{document}</tex-math><mml:math id="M6"><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="42003_2020_1350_Article_IEq1.gif"/></alternatives></inline-formula>, that the corresponding cell contains center of a binding site, and the coordinates of this center with respect to the cell <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{x}$$\end{document}</tex-math><mml:math id="M8"><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="42003_2020_1350_Article_IEq2.gif"/></alternatives></inline-formula>, <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{y}$$\end{document}</tex-math><mml:math id="M10"><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="42003_2020_1350_Article_IEq3.gif"/></alternatives></inline-formula>, <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{z}$$\end{document}</tex-math><mml:math id="M12"><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="42003_2020_1350_Article_IEq4.gif"/></alternatives></inline-formula>. The core of the neural network comprises ten 3D convolutional layers: <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Conv3D}}_{32}\Rightarrow {\text{Conv3D}}_{32}^{\text{pool}}\Rightarrow {\text{Conv3D}}_{32}\Rightarrow {\text{Conv3D}}_{32}\Rightarrow {\text{Conv3D}}_{32}^{\text{pool}}\Rightarrow {\text{Conv3D}}_{64}\Rightarrow {\text{Conv3D}}_{64}\Rightarrow {\text{Conv3D}}_{64}^{\text{pool}}\Rightarrow {\text{Conv3D}}_{128}\Rightarrow {\text{Conv3D}}_{4}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Conv3D</mml:mi></mml:mrow><mml:mrow><mml:mn>32</mml:mn></mml:mrow></mml:msub><mml:mo>⇒</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Conv3D</mml:mi></mml:mrow><mml:mrow><mml:mn>32</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">pool</mml:mi></mml:mrow></mml:msubsup><mml:mo>⇒</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Conv3D</mml:mi></mml:mrow><mml:mrow><mml:mn>32</mml:mn></mml:mrow></mml:msub><mml:mo>⇒</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Conv3D</mml:mi></mml:mrow><mml:mrow><mml:mn>32</mml:mn></mml:mrow></mml:msub><mml:mo>⇒</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Conv3D</mml:mi></mml:mrow><mml:mrow><mml:mn>32</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">pool</mml:mi></mml:mrow></mml:msubsup><mml:mo>⇒</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Conv3D</mml:mi></mml:mrow><mml:mrow><mml:mn>64</mml:mn></mml:mrow></mml:msub><mml:mo>⇒</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Conv3D</mml:mi></mml:mrow><mml:mrow><mml:mn>64</mml:mn></mml:mrow></mml:msub><mml:mo>⇒</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Conv3D</mml:mi></mml:mrow><mml:mrow><mml:mn>64</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">pool</mml:mi></mml:mrow></mml:msubsup><mml:mo>⇒</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Conv3D</mml:mi></mml:mrow><mml:mrow><mml:mn>128</mml:mn></mml:mrow></mml:msub><mml:mo>⇒</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Conv3D</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2020_1350_Article_IEq5.gif"/></alternatives></inline-formula>, where the subscript number denotes the number of filters. We used kernels of size (3, 3, 3) for each layer, stride of 2 for the pooling layers, and the batch normalization and the rectified linear unit (ReLu) activation function for all layers, except for the last one. Finally, we use the sigmoid activation function to obtain probability score <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{s}$$\end{document}</tex-math><mml:math id="M16"><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="42003_2020_1350_Article_IEq6.gif"/></alternatives></inline-formula> in the range of (0, 1) and relative coordinates <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{x}$$\end{document}</tex-math><mml:math id="M18"><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="42003_2020_1350_Article_IEq7.gif"/></alternatives></inline-formula>, <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{y}$$\end{document}</tex-math><mml:math id="M20"><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="42003_2020_1350_Article_IEq8.gif"/></alternatives></inline-formula>, <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{z}$$\end{document}</tex-math><mml:math id="M22"><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="42003_2020_1350_Article_IEq9.gif"/></alternatives></inline-formula> of the predicted center of the binding site with respect to the cell. The Cartesian coordinates are then calculated according to (Eq. <xref rid="Equ2" ref-type="">2</xref>):<disp-formula id="Equ3"><label>2</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}\hat{X}={c}_{\,\text{size}}^{{\mathrm{x}}}\cdot {v}_{\text{size}\,}^{{\mathrm{x}}}\cdot ({i}_{{\mathrm{cell}}}+\hat{x})+{O}_{{\mathrm{x}}}\\ \hat{Y}={c}_{\,\text{size}}^{{\mathrm{y}}}\cdot {v}_{\text{size}\,}^{{\mathrm{y}}}\cdot ({j}_{{\mathrm{cell}}}+\hat{y})+{O}_{{\mathrm{y}}}\\ \hat{Z}={c}_{\,\text{size}}^{{\mathrm{z}}}\cdot {v}_{\text{size}\,}^{{\mathrm{z}}}\cdot ({k}_{{\mathrm{cell}}}+\hat{z})+{O}_{{\mathrm{z}}}\end{array},$$\end{document}</tex-math><mml:math id="M24"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">size</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">size</mml:mi><mml:mspace width="0.25em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">cell</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">size</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">size</mml:mi><mml:mspace width="0.25em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">cell</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">size</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">z</mml:mi></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">size</mml:mi><mml:mspace width="0.25em"/></mml:mrow><mml:mrow><mml:mi mathvariant="normal">z</mml:mi></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">cell</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_1350_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <italic>c</italic><sub>size</sub> and <italic>v</italic><sub>size</sub> corresponds to the size of a cell and voxel, respectively, and <italic>O</italic><sub>x</sub>,<italic>O</italic><sub>y</sub>,<italic>O</italic><sub>z</sub> are the Cartesian coordinates of the origin of the cubic grid.</p>
      <p id="Par35">We used custom loss function for training, that contains three terms:<disp-formula id="Equ4"><label>3</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{\mathrm{Loss}}\,=\,\mathop{\sum }\limits_{i = 1}^{{N}_{{\mathrm{cells}}}}{({s}_{{{i}}}-{\hat{s}}_{{{i}}})}^{2}+\lambda \mathop{\sum }\limits_{i = 1}^{{N}_{{\mathrm{cells}}}}{s}_{{{i}}}\cdot \left({({x}_{{{i}}}-{\hat{x}}_{{{i}}})}^{2}+{({y}_{{{i}}}-{\hat{y}}_{{{i}}})}^{2}+{({z}_{{{i}}}-{\hat{z}}_{{{i}}})}^{2}\right)+\gamma {L}_{2}\end{array},$$\end{document}</tex-math><mml:math id="M26"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Loss</mml:mi><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">cells</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">cells</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_1350_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <italic>N</italic><sub>cells</sub> is the number of cells in the single cubic grid, <italic>s</italic><sub><italic>i</italic></sub> and <inline-formula id="IEq10"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{{s}_{i}}$$\end{document}</tex-math><mml:math id="M28"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="42003_2020_1350_Article_IEq10.gif"/></alternatives></inline-formula> are the true (0 or 1) and predicted probability scores of the cell, <italic>x</italic><sub><italic>i</italic></sub>, <italic>y</italic><sub><italic>i</italic></sub>, <italic>z</italic><sub><italic>i</italic></sub> and <inline-formula id="IEq11"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{x}}_{{{i}}},{\hat{y}}_{{{i}}},{\hat{z}}_{{{i}}}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2020_1350_Article_IEq11.gif"/></alternatives></inline-formula> are the true and predicted coordinates for <italic>i</italic>th cell, respectively, and <italic>L</italic><sub>2</sub> correspond to the regularization term. Therefore, the first and the second terms aim to penalize incorrect prediction of the probability score and the center of the binding site, respectively. Note, that we multiply the second term by the true probability score (0 or 1) to take into account only relevant predictions. The third term is the <italic>L</italic><sub>2</sub> regularization term for the neural network parameters. The coefficients <italic>λ</italic> = 5 and <italic>γ</italic> = 1e−5 are the weights of the penalty terms.</p>
      <p id="Par36">We trained the network in Tensorflow v1.14<sup><xref ref-type="bibr" rid="CR57">57</xref></sup> for 400 epochs using the Adam optimizer with the default parameters, minibatch size of 16 cubic grids, and the learning rate of 1e−3 gradually decreasing to 1e−5 during the training. We would like to note, that presented architecture is not invariant to rotations of a protein. Data augmentation, i.e., considering different orientations of a protein within a single epoch, may circumvent this problem to some extent. Because of GPU memory limitations, in this study, we used implicit data augmentation by considering random orientation of a protein each epoch.</p>
      <p id="Par37">To obtain the final predictions we applied the post-processing procedure, as it follows. First, we discarded all the predictions with the probability score <inline-formula id="IEq12"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{s}\,&lt;\, {s}_{\text{threshold}}$$\end{document}</tex-math><mml:math id="M32"><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mspace width="0.25em"/><mml:mo>&lt;</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">threshold</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2020_1350_Article_IEq12.gif"/></alternatives></inline-formula>. The remaining predictions are then processed by means of the non-maximum suppression. More precisely, we select the best prediction in terms of the probability score, as the seed of a cluster, and put all the predictions with the centers of the binding site closer than <italic>d</italic><sub>threshold</sub> = 8 Å to the center of the best prediction. Then we select the second best prediction, as the seed of the next cluster, and repeat the above procedure until all the predictions are clustered. Finally, we keep only <italic>N</italic><sub>top</sub> seeds in terms of the probability scores, as the final predictions. For the training we used <italic>s</italic><sub>threshold</sub> = 0.1 and <italic>N</italic><sub>top</sub> = 5, for benchmarking <italic>s</italic><sub>threshold</sub> = 0.01 (in order to calculate AP for all predictions), and for the case study <italic>s</italic><sub>threshold</sub> = 0.1 and all predictions. To evaluate the performance of the prediction model we define the true positive (TP) prediction of the binding site, as the top-scored correct prediction, that is prediction with the probability score <inline-formula id="IEq13"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{s}\ge {s}_{\text{threshold}}$$\end{document}</tex-math><mml:math id="M34"><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">threshold</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="42003_2020_1350_Article_IEq13.gif"/></alternatives></inline-formula> and the predicted center of the binding site within <italic>d</italic><sub>threshold</sub> from the true center of the binding site. The rest of the predictions are considered as false positives (FP). Given this, we calculate precision and recall metrics according to:<disp-formula id="Equ5"><label>4</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{Precision}}\,=\,\frac{{N}_{{\mathrm{TP}}}}{{N}_{{\mathrm{TP}}}\,+\,{N}_{{\mathrm{FP}}}},$$\end{document}</tex-math><mml:math id="M36"><mml:mi mathvariant="normal">Precision</mml:mi><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">FP</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_1350_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>5</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{Recall}}\,=\,\frac{{N}_{{\mathrm{TP}}}}{{N}_{{\mathrm{TP}}}\,+\,{N}_{{\mathrm{FN}}}},$$\end{document}</tex-math><mml:math id="M38"><mml:mi mathvariant="normal">Recall</mml:mi><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TP</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">FN</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="42003_2020_1350_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <italic>N</italic><sub>FN</sub> is the number of false negative predictions, that is the number of binding sites with no correct prediction. As the main metric we calculate the average precision metric AP, which is the area under precision recall curve.</p>
      <p id="Par38">Note, that we define correct prediction with respect to the center of the binding site, rather than binding pose of a ligand. We believe this is more rigorous metric, because it does not depend neither on the binding pose of a ligand, nor on the ligand itself. However, for fair comparison with the existing methods, we also computed the metrics, where the prediction is considered to be true positive prediction, if the minimal distance to the ligand is less than <italic>d</italic><sub>threshold</sub> = 4Å.</p>
    </sec>
    <sec id="Sec14">
      <title>Clusterization</title>
      <p id="Par39">Given conformational ensemble of a protein, as for example, molecular dynamics trajectory, we firstly applied BiteNet to each conformation. Then we grouped the obtained predictions using clustering algorithms. In this study, we used three different clustering approaches implemented in the sklearn python library<sup><xref ref-type="bibr" rid="CR54">54</xref></sup> : the mean shift clustering algorithm (MSCA)<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>, the density-based clustering algorithm (DBSCAN)<sup><xref ref-type="bibr" rid="CR59">59</xref>,<xref ref-type="bibr" rid="CR60">60</xref></sup>, and the agglomerative hierachical clustering algorithm<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>. While the first two approaches are mainly applied for the set of points in Euclidean space, the latter approach can be applied also for set of amino acid residues forming the predicted binding site. Finally, we assigned two scores for each cluster. The first score is the sum of maximal probability score of a cluster in each frame averaged over the total number of frames. For the second score, the mean sum of probabilities scores (larger than <italic>s</italic><sub>cluster_score_threshold_step</sub> = 0.1) of a cluster is computed for each frame; these sums are then averaged over the total number of the corresponding frames. We implement several clustering approaches, because it is known that clustering results may strongly vary depending on clustering algorithm and different parameters for them, also affecting the cluster scores.</p>
    </sec>
    <sec id="Sec15">
      <title>Statistics and reproducibility</title>
      <p id="Par40">To support significant outperforming of BiteNet over the other methods, we performed statistical Student’s test, as it follows. We considered protein structures from the COACH420 and HOLO4K benchmarks that are not in the BiteNet’s training set and have at least one binding site according to the P2Rank filtering criterion. Then we split these protein structures into 31 independent subsets, and evaluated the performance of each method for each subset. Finally, we considered the null hypothesis that there is no significant difference in performance metrics between BiteNet and other methods. The highest calculated <italic>p</italic>-value for the AP metric is 1.2<italic>e</italic><sup>−6</sup>, that allows us to reject the null hypothesis (see Supplementary Table <xref rid="MOESM1" ref-type="media">14</xref> for more details). The BiteNet model required to reproduce the results of this study are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/i-Molecule/bitenet">https://github.com/i-Molecule/bitenet</ext-link> and 10.5281/zenodo.4043664<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>. In addition a web-server implementation of BiteNet is available at <ext-link ext-link-type="uri" xlink:href="https://sites.skoltech.ru/imolecule/tools/bitenet">https://sites.skoltech.ru/imolecule/tools/bitenet</ext-link>.</p>
    </sec>
    <sec id="Sec16">
      <title>Reporting summary</title>
      <p id="Par41">Further information on research design is available in the <xref rid="MOESM8" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec17">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="42003_2020_1350_MOESM1_ESM.pdf">
          <caption>
            <p>Supplementary Information</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="42003_2020_1350_MOESM2_ESM.pdf">
          <caption>
            <p>Peer Review File</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM3">
        <media xlink:href="42003_2020_1350_MOESM3_ESM.pdf">
          <caption>
            <p>Description of Additional Supplementary Files</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM4">
        <media xlink:href="42003_2020_1350_MOESM4_ESM.mp4">
          <caption>
            <p>Supplementary Movie 1</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM5">
        <media xlink:href="42003_2020_1350_MOESM5_ESM.mp4">
          <caption>
            <p>Supplementary Movie 2</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM6">
        <media xlink:href="42003_2020_1350_MOESM6_ESM.mp4">
          <caption>
            <p>Supplementary Movie 3</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM7">
        <media xlink:href="42003_2020_1350_MOESM7_ESM.tar">
          <caption>
            <p>Supplementary Data 1</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM8">
        <media xlink:href="42003_2020_1350_MOESM8_ESM.pdf">
          <caption>
            <p>Reporting Summary</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> is available for this paper at 10.1038/s42003-020-01350-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We acknowledge the HPC team at CDISE (Skoltech) for support usage of the “Zhores” supercomputer in order to train BiteNet.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>I.K. and P.P. constructed the training, validation, and test sets, processed protein structures, formulated the machine learning problem, developed BiteNet, conducted numerical experiments, performed data analysis and wrote the manuscript. P.P. organized and managed the project implementation, and supervised the research.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The dataset used for training of BiteNet is available at 10.5281/zenodo.4043664<sup><xref ref-type="bibr" rid="CR61">61</xref></sup> BiteNet is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/i-Molecule/bitenet">https://github.com/i-Molecule/bitenet</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>BiteNet source code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/i-Molecule/bitenet">https://github.com/i-Molecule/bitenet</ext-link> and 10.5281/zenodo.4043664<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par42">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hopkins</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Groom</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <article-title>The druggable genome</article-title>
        <source>Nat. Rev. Drug Discov.</source>
        <year>2002</year>
        <volume>1</volume>
        <fpage>727</fpage>
        <pub-id pub-id-type="doi">10.1038/nrd892</pub-id>
        <?supplied-pmid 12209152?>
        <pub-id pub-id-type="pmid">12209152</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christopoulos</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>International union of basic and clinical pharmacology. xc. multisite pharmacology: recommendations for the nomenclature of receptor allosterism and allosteric ligands</article-title>
        <source>Pharmacol. Rev.</source>
        <year>2014</year>
        <volume>66</volume>
        <fpage>918</fpage>
        <pub-id pub-id-type="doi">10.1124/pr.114.008862</pub-id>
        <?supplied-pmid 25026896?>
        <pub-id pub-id-type="pmid">25026896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Changeux</surname>
            <given-names>J-P</given-names>
          </name>
        </person-group>
        <article-title>The concept of allosteric modulation: an overview</article-title>
        <source>Drug Discov. Today</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>e223</fpage>
        <pub-id pub-id-type="doi">10.1016/j.ddtec.2012.07.007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Emerging computational methods for the rational discovery of allosteric drugs</article-title>
        <source>Chem. Rev.</source>
        <year>2016</year>
        <volume>116</volume>
        <fpage>6370</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.chemrev.5b00631</pub-id>
        <?supplied-pmid 27074285?>
        <pub-id pub-id-type="pmid">27074285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Discovery of hidden allosteric sites as novel targets for allosteric drug design</article-title>
        <source>Drug Discov. Today</source>
        <year>2018</year>
        <volume>23</volume>
        <fpage>359</fpage>
        <pub-id pub-id-type="doi">10.1016/j.drudis.2017.10.001</pub-id>
        <?supplied-pmid 29030241?>
        <pub-id pub-id-type="pmid">29030241</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laskowski</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Gerick</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>The structural basis of allosteric regulation in proteins</article-title>
        <source>FEBS Lett.</source>
        <year>2009</year>
        <volume>583</volume>
        <fpage>1692</fpage>
        <pub-id pub-id-type="doi">10.1016/j.febslet.2009.03.019</pub-id>
        <?supplied-pmid 19303011?>
        <pub-id pub-id-type="pmid">19303011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Changeux</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Christopoulos</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Allosteric modulation as a unifying mechanism for receptor function and regulation</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>166</volume>
        <fpage>1084</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.08.015</pub-id>
        <?supplied-pmid 27565340?>
        <pub-id pub-id-type="pmid">27565340</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Pietro</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Juarez-Jimenez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Munoz-Torrero</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Laughton</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Luque</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Unveiling a novel transient druggable pocket in bace-1 through molecular simulations: conformational analysis and binding mode of multisite inhibitors</article-title>
        <source>PLoS ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>e0177683</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0177683</pub-id>
        <?supplied-pmid 28505196?>
        <pub-id pub-id-type="pmid">28505196</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wakefield</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Kolossvary</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Beglov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vajda</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Structure-based analysis of cryptic-site opening</article-title>
        <source>Structure</source>
        <year>2020</year>
        <volume>28</volume>
        <fpage>223</fpage>
        <?supplied-pmid 31810712?>
        <pub-id pub-id-type="pmid">31810712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferré</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>G protein-coupled receptor oligomerization revisited: functional and pharmacological perspectives</article-title>
        <source>Pharmacol. Rev.</source>
        <year>2014</year>
        <volume>66</volume>
        <fpage>413</fpage>
        <pub-id pub-id-type="doi">10.1124/pr.113.008052</pub-id>
        <?supplied-pmid 24515647?>
        <pub-id pub-id-type="pmid">24515647</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Druggable negative allosteric site of p2x3 receptors</article-title>
        <source>Proc. Natl Acad. Sci.</source>
        <year>2018</year>
        <volume>115</volume>
        <fpage>4939</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1800907115</pub-id>
        <?supplied-pmid 29674445?>
        <pub-id pub-id-type="pmid">29674445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hardy</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Wells</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Searching for new allosteric sites in enzymes</article-title>
        <source>Curr. Opin. Struct. Biol.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>706</fpage>
        <pub-id pub-id-type="doi">10.1016/j.sbi.2004.10.009</pub-id>
        <?supplied-pmid 15582395?>
        <pub-id pub-id-type="pmid">15582395</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ludlow</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Verdonk</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Saini</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Tickle</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Jhoti</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Detection of secondary binding sites in proteins using fragment screening</article-title>
        <source>Proc. Natl Acad. Sci.</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>15910</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1518946112</pub-id>
        <?supplied-pmid 26655740?>
        <pub-id pub-id-type="pmid">26655740</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawson</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>Antibody-enabled small-molecule drug discovery</article-title>
        <source>Nat. Rev. Drug Discov.</source>
        <year>2012</year>
        <volume>11</volume>
        <fpage>519</fpage>
        <pub-id pub-id-type="doi">10.1038/nrd3756</pub-id>
        <?supplied-pmid 22743979?>
        <pub-id pub-id-type="pmid">22743979</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doyle</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Koehler</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Advances in discovering small molecules to probe protein function in a systems context</article-title>
        <source>Curr. Opin. Chem. Biol.</source>
        <year>2016</year>
        <volume>30</volume>
        <fpage>28</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cbpa.2015.10.032</pub-id>
        <?supplied-pmid 26615565?>
        <pub-id pub-id-type="pmid">26615565</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chalmers</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probing protein ligand interactions by automated hydrogen/deuterium exchange mass spectrometry</article-title>
        <source>Anal. Chem.</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>1005</fpage>
        <pub-id pub-id-type="doi">10.1021/ac051294f</pub-id>
        <?supplied-pmid 16478090?>
        <pub-id pub-id-type="pmid">16478090</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gelis</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hatt</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Neuhaus</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Gerwert</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Prediction of a ligand-binding niche within a human olfactory receptor by combining site-directed mutagenesis with dynamic homology modeling</article-title>
        <source>Angew. Chem. Int. Ed.</source>
        <year>2012</year>
        <volume>51</volume>
        <fpage>1274</fpage>
        <pub-id pub-id-type="doi">10.1002/anie.201103980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hendlich</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rippmann</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Barnickel</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Ligsite: automatic and efficient detection of potential small molecule-binding sites in proteins</article-title>
        <source>J. Mol. Graph. Model.</source>
        <year>1997</year>
        <volume>15</volume>
        <fpage>359</fpage>
        <pub-id pub-id-type="doi">10.1016/S1093-3263(98)00002-3</pub-id>
        <?supplied-pmid 9704298?>
        <pub-id pub-id-type="pmid">9704298</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>AntonFeenstra</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Heringa</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>IJzerman</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Marchiori</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Multi-relief: a method to recognize specificity determining residues from multiple sequence alignments using a machine-learning approach for feature weighting</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>24</volume>
        <fpage>18</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm537</pub-id>
        <?supplied-pmid 18024975?>
        <pub-id pub-id-type="pmid">18024975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weisel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Proschak</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Pocketpicker: analysis of ligand binding-sites with shape descriptors</article-title>
        <source>Chem. Cent. J.</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/1752-153X-1-7</pub-id>
        <?supplied-pmid 17880740?>
        <pub-id pub-id-type="pmid">17880740</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hernandez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ghersi</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sanchez</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Sitehound-web: a server for ligand binding site identification in protein structures</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>W413</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp281</pub-id>
        <?supplied-pmid 19398430?>
        <pub-id pub-id-type="pmid">19398430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Capra</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Laskowski</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Funkhouser</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>Predicting protein ligand binding sites by combining evolutionary sequence conservation and 3d structure</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000585</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000585</pub-id>
        <?supplied-pmid 19997483?>
        <pub-id pub-id-type="pmid">19997483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeGuilloux</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Schmidtke</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tuffery</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Fpocket: an open source platform for ligand pocket detection</article-title>
        <source>BMC Bioinform.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>168</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Schroeder</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Identification of cavities on protein surface using multiple computational approaches for drug binding site prediction</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2083</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr331</pub-id>
        <?supplied-pmid 21636590?>
        <pub-id pub-id-type="pmid">21636590</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>Z-R</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C-K</given-names>
          </name>
          <name>
            <surname>Hsiao</surname>
            <given-names>F-C</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>M-J</given-names>
          </name>
        </person-group>
        <article-title>Lise: a server using ligand-interacting and site-enriched protein triangles for prediction of ligand-binding sites</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>W292</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt300</pub-id>
        <?supplied-pmid 23609546?>
        <pub-id pub-id-type="pmid">23609546</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>D-J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Designing template-free predictor for targeting protein-ligand binding sites with classifier ensemble and spatial clustering</article-title>
        <source>IEEE/ACM Trans. Comput. Biol. Bioinform.</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>994</fpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2013.104</pub-id>
        <?supplied-pmid 24334392?>
        <pub-id pub-id-type="pmid">24334392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Chen, P., Huang, J. Z. &amp; Gao, X. Ligandrfs: random forest ensemble to identify ligand-binding residues from sequence information alone, <italic>BMC Bioinform.</italic><bold>15</bold>, S4.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krivák</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hoksza</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>P2rank: machine learning based tool for rapid and accurate prediction of ligand binding sites from protein structure</article-title>
        <source>J. Cheminform.</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>39</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-018-0285-8</pub-id>
        <?supplied-pmid 30109435?>
        <pub-id pub-id-type="pmid">30109435</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Broomhead</surname>
            <given-names>NK</given-names>
          </name>
          <name>
            <surname>Soliman</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Can we rely on computational predictions to correctly identify ligand binding sites on novel protein drug targets? assessment of binding site prediction methods and a protocol for validation of predicted binding sites</article-title>
        <source>Cell Biochem. Biophys.</source>
        <year>2017</year>
        <volume>75</volume>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1007/s12013-016-0769-y</pub-id>
        <?supplied-pmid 27796788?>
        <pub-id pub-id-type="pmid">27796788</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiménez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Doerr</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Martínez-Rosell</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rose</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Fabritiis</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <article-title>Deepsite: protein-binding site predictor using 3d-convolutional neural networks</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>3036</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx350</pub-id>
        <?supplied-pmid 28575181?>
        <pub-id pub-id-type="pmid">28575181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coddou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Obsil</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huidobro-Toro</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Stojilkovic</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>Activation and regulation of purinergic p2x receptor channels</article-title>
        <source>Pharmacol. Rev.</source>
        <year>2011</year>
        <volume>63</volume>
        <fpage>641</fpage>
        <pub-id pub-id-type="doi">10.1124/pr.110.003129</pub-id>
        <?supplied-pmid 21737531?>
        <pub-id pub-id-type="pmid">21737531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hattori</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gouaux</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Molecular mechanism of atp binding and ion channel activation in p2x receptors</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <fpage>207</fpage>
        <pub-id pub-id-type="doi">10.1038/nature11010</pub-id>
        <?supplied-pmid 22535247?>
        <pub-id pub-id-type="pmid">22535247</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karasawa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kawate</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Structural basis for subtype-specific inhibition of the p2x7 receptor</article-title>
        <source>elife</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>e22153</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.22153</pub-id>
        <?supplied-pmid 27935479?>
        <pub-id pub-id-type="pmid">27935479</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thress</surname>
            <given-names>KS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Acquired egfr c797s mutation mediates resistance to azd9291 in non-small cell lung cancer harboring egfr t790m</article-title>
        <source>Nat. Med.</source>
        <year>2015</year>
        <volume>21</volume>
        <fpage>560</fpage>
        <pub-id pub-id-type="doi">10.1038/nm.3854</pub-id>
        <?supplied-pmid 25939061?>
        <pub-id pub-id-type="pmid">25939061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Overcoming egfr (t790m) and egfr (c797s) resistance with mutant-selective allosteric inhibitors</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>534</volume>
        <fpage>129</fpage>
        <pub-id pub-id-type="doi">10.1038/nature17960</pub-id>
        <?supplied-pmid 27251290?>
        <pub-id pub-id-type="pmid">27251290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Charmm-gui input generator for namd, gromacs, amber, openmm, and charmm/openmm simulations using the charmm36 additive force field</article-title>
        <source>J. Chem. Theory Comput.</source>
        <year>2016</year>
        <volume>12</volume>
        <fpage>405</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.5b00935</pub-id>
        <?supplied-pmid 26631602?>
        <pub-id pub-id-type="pmid">26631602</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Der Spoel</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gromacs: fast, flexible, and free</article-title>
        <source>J. Comput. Chem.</source>
        <year>2005</year>
        <volume>26</volume>
        <fpage>1701</fpage>
        <pub-id pub-id-type="doi">10.1002/jcc.20291</pub-id>
        <pub-id pub-id-type="pmid">16211538</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wootten</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Christopoulos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sexton</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>Emerging paradigms in gpcr allostery: implications for drug discovery</article-title>
        <source>Nat. Rev. Drug Discov.</source>
        <year>2013</year>
        <volume>12</volume>
        <fpage>630</fpage>
        <pub-id pub-id-type="doi">10.1038/nrd4052</pub-id>
        <?supplied-pmid 23903222?>
        <pub-id pub-id-type="pmid">23903222</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Chan, H. S., Li, Y., Dahoun, T., Vogel, H. &amp; Yuan, S. New binding sites, new opportunities for gpcr drug discovery. <italic>Trends Biochem. Sci.</italic><bold>44</bold>, 312–330 (2019).</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodríguez-Espigares</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GPCRmd uncovers the dynamics of the 3D-GPCRome</article-title>
        <source>Nature Methods.</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>777</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-0884-y</pub-id>
        <?supplied-pmid 32661425?>
        <pub-id pub-id-type="pmid">32661425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mitchell</surname>
            <given-names>AL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Interpro in 2019: improving coverage, classification and access to protein sequence annotations</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D351</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1100</pub-id>
        <?supplied-pmid 30398656?>
        <pub-id pub-id-type="pmid">30398656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Skolnick</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Tm-align: a protein structure alignment algorithm based on the tm-score</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>2302</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gki524</pub-id>
        <?supplied-pmid 15849316?>
        <pub-id pub-id-type="pmid">15849316</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Zoph, B. &amp; Le, Q. V. Neural architecture search with reinforcement learning. <italic>arXiv preprint arXiv:1611.01578</italic> (2016).</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Liu, H., Simonyan, K. &amp; Yang, Y. Darts: differentiable architecture search. <italic>arXiv preprint arXiv:1806.09055</italic> (2018).</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Popov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Grudinin</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Eurecon: equidistant uniform rigid-body ensemble constructor</article-title>
        <source>J. Mol. Graph. Model.</source>
        <year>2018</year>
        <volume>80</volume>
        <fpage>313</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jmgm.2018.01.015</pub-id>
        <?supplied-pmid 29427936?>
        <pub-id pub-id-type="pmid">29427936</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Everingham</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Van Gool</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Winn</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zisserman</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The pascal visual object classes (voc) challenge</article-title>
        <source>Int. J. Comput. Vis.</source>
        <year>2010</year>
        <volume>88</volume>
        <fpage>303</fpage>
        <pub-id pub-id-type="doi">10.1007/s11263-009-0275-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Girshick, R., Donahue, J., Darrell, T. &amp; Malik, J. Rich feature hierarchies for accurate object detection and semantic segmentation. in <italic>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</italic> 580–587 (2014).</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Lin, T.-Y. et al. Microsoft coco: common objects in context. in <italic>European Conference on Computer Vision</italic> 740–755 (Springer, New York, 2014).</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Liu, W. et al. Ssd: single shot multibox detector, in <italic>European Conference on Computer Vision</italic> 21–37 (Springer, New York, 2016).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Redmon, J., Divvala, S., Girshick, R. &amp; Farhadi, A. You only look once: unified, real-time object detection, in <italic>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</italic> 779–788 (2016).</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Berman, H. M., Bourne, P. E., Westbrook, J. &amp; Zardecki, C. <italic>Protein Structure</italic> 394–410 (CRC Press, Boca Raton, 2003).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Derevyanko</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grudinin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lamoureux</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Deep convolutional networks for quality assessment of protein folds</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>4046</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty494</pub-id>
        <?supplied-pmid 29931128?>
        <pub-id pub-id-type="pmid">29931128</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical clustering schemes</article-title>
        <source>Psychometrika</source>
        <year>1967</year>
        <volume>32</volume>
        <fpage>241</fpage>
        <pub-id pub-id-type="doi">10.1007/BF02289588</pub-id>
        <?supplied-pmid 5234703?>
        <pub-id pub-id-type="pmid">5234703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: machine learning in python</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>2825</fpage>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidtke</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Souaille</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Estienne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Baurin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kroemer</surname>
            <given-names>RT</given-names>
          </name>
        </person-group>
        <article-title>Large-scale comparison of four binding site detection algorithms</article-title>
        <source>J. Chem. Inf. Model.</source>
        <year>2010</year>
        <volume>50</volume>
        <fpage>2191</fpage>
        <pub-id pub-id-type="doi">10.1021/ci1000289</pub-id>
        <?supplied-pmid 20828173?>
        <pub-id pub-id-type="pmid">20828173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Cofactor: an accurate comparative algorithm for structure-based protein function annotation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>W471</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks372</pub-id>
        <?supplied-pmid 22570420?>
        <pub-id pub-id-type="pmid">22570420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Abadi, M. et al.   TensorFlow: large-scale machine learning on heterogeneous systems. Software available on <ext-link ext-link-type="uri" xlink:href="https://www.tensorflow.org/">https://www.tensorflow.org/</ext-link> (2015).</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">Comaniciu, D. &amp; Meer P. Mean shift: a robust approach toward feature space analysis, <italic>IEEE Transactions on Pattern Analysis &amp; Machine Intelligence</italic>, 603 (2002).</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Ester, M. et al. A density-based algorithm for discovering clusters in large spatial databases with noise. <italic>Kdd</italic><bold>96</bold>, 226–231 (1996).</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schubert</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ester</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kriegel</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Dbscan revisited, revisited: why and how you should (still) use dbscan</article-title>
        <source>ACM Trans. Database Syst.</source>
        <year>2017</year>
        <volume>42</volume>
        <fpage>19</fpage>
        <pub-id pub-id-type="doi">10.1145/3068335</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <mixed-citation publication-type="other">Popov, P. &amp; Kozlovskii, I. Spatiotemporal identification of druggable bindingsites using deep learning (training dataset and software). 10.5281/zenodo.4043664 (Zenodo, 2020).</mixed-citation>
    </ref>
  </ref-list>
</back>
