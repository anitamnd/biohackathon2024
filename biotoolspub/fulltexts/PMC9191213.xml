<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9191213</article-id>
    <article-id pub-id-type="pmid">35575313</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac328</article-id>
    <article-id pub-id-type="publisher-id">btac328</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>An R package VIGoR for joint estimation of multiple linear learners with variational Bayesian inference</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1707-9539</contrib-id>
        <name>
          <surname>Onogi</surname>
          <given-names>Akio</given-names>
        </name>
        <xref rid="btac328-cor1" ref-type="corresp"/>
        <aff><institution>Department of Plant Life Science, Faculty of Agriculture, Ryukoku University</institution>, Otsu, Shiga 520-2194, <country country="JP">Japan</country></aff>
        <!--onogiakio@gmail.com-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arakawa</surname>
          <given-names>Aisaku</given-names>
        </name>
        <aff><institution>Division of Animal Breeding and Reproduction Research, Institute of Livestock and Grassland Science, National Agriculture and Food Research Organization</institution>, Tsukuba, Ibaraki 305-0901, <country country="JP">Japan</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac328-cor1">To whom correspondence should be addressed. <email>onogiakio@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-05-16">
      <day>16</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>12</issue>
    <fpage>3306</fpage>
    <lpage>3309</lpage>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>06</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>23</day>
        <month>5</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac328.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>An R package that can implement multiple linear learners, including penalized regression and regression with spike and slab priors, in a single model has been developed. Solutions are obtained with fast minorize-maximization algorithms in the framework of variational Bayesian inference. This package helps to incorporate multimodal and high-dimensional explanatory variables in a single regression model.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The R package VIGoR (Variational Bayesian Inference for Genome-wide Regression) is available at the Comprehensive R Archive Network (CRAN) (<ext-link xlink:href="https://cran.r-project.org/" ext-link-type="uri">https://cran.r-project.org/</ext-link>) and at GitHub (<ext-link xlink:href="https://github.com/Onogi/VIGoR" ext-link-type="uri">https://github.com/Onogi/VIGoR</ext-link>).</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ryukoku University</institution>
            <institution-id institution-id-type="DOI">10.13039/501100010626</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In current biology, data of multiple omics can be available from many samples (<xref rid="btac328-B4" ref-type="bibr">Hasin <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btac328-B5" ref-type="bibr">Kim and Tagkopoulos, 2018</xref>), and data are also available from environments in fine scales (<xref rid="btac328-B2" ref-type="bibr">Gupta and Quan, 2018</xref>; <xref rid="btac328-B8" ref-type="bibr">Munandar <italic toggle="yes">et al.</italic>, 2017</xref>). Thus, it is often of interest to discover important variables from such high-dimensional and multimodal data (<xref rid="btac328-B18" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2017</xref>) or to use them to predict phenotypes (<xref rid="btac328-B15" ref-type="bibr">Riedelsheimer <italic toggle="yes">et al.</italic>, 2012</xref>). To model such multimodal and high-dimensional variables in realistic time, flexible and fast regression tools are required. High-dimensional variables can be included in regression models using penalties. Although various penalized regressions have been proposed (e.g. <xref rid="btac328-B17" ref-type="bibr">Tibshirani, 1996</xref>; <xref rid="btac328-B19" ref-type="bibr">Zou and Hastie, 2005</xref>), implementation of these methods usually assumes unimodal explanatory variables (e.g. glmnet; <xref rid="btac328-B1" ref-type="bibr">Friedman <italic toggle="yes">et al.</italic>, 2010</xref>). An extension to multiple learners is feasible in a Bayesian framework because each learner can be a module. Indeed, a popular R package BGLR (<xref rid="btac328-B14" ref-type="bibr">Pérez and de los Campos, 2014</xref>) allows modeling multimodal explanatory variables using different Bayesian regression methods. However, calculation time will be an issue because the package depends on Markov chain Monte Carlo (MCMC) algorithms.</p>
    <p>Here, we provide an R package VIGoR (Variational Bayesian Inference for Genome-wide Regression) which can incorporate multimodal explanatory variables using different regression methods. Solutions are obtained with variational inference which is more time-efficient than MCMC. The package was initially developed to provide variational Bayesian inference for linear regressions (<xref rid="btac328-B10" ref-type="bibr">Onogi and Iwata, 2016</xref>) and has been updated to incorporate multiple learners. The updates are summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. VIGoR implements multiple regression methods including Bayesian lasso (BL) (<xref rid="btac328-B13" ref-type="bibr">Park and Casella, 2008</xref>), extended Bayesian lasso (EBL) (<xref rid="btac328-B9" ref-type="bibr">Mutshinda and Sillanpää, 2010</xref>), Bayesian Alphabets (BayesA, BayesB and BayesC), Bayesian ridge regression (BRR) and best linear unbiased prediction (BLUP). Bayesian Alphabets will be jargons in quantitative genetics; BayesB and BayesC are regressions with spike and slab priors (<xref rid="btac328-B3" ref-type="bibr">Habier <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="btac328-B7" ref-type="bibr">Meuwissen <italic toggle="yes">et al.</italic>, 2001</xref>) and BayesA uses <italic toggle="yes">t</italic>-distributions as prior distributions of regression coefficients (<xref rid="btac328-B7" ref-type="bibr">Meuwissen <italic toggle="yes">et al.</italic>, 2001</xref>). These regression methods were selected because they show different properties. BayesB, BayesC and EBL are suitable for variable selection, and BRR and BLUP are suitable for issues where many variables are involved in the response variable. BL and BayesA tend to show the intermediate properties. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref> for the details of these methods. Users can add these learners simultaneously to a single model as
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>ε</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic toggle="yes">y<sub>i</sub></italic> is the response variables for sample <italic toggle="yes">i</italic>, <italic toggle="yes">M</italic> is the number of learners in the model, <italic toggle="yes">f<sub>m</sub></italic> indicates the <italic toggle="yes">m</italic>th learner, <bold>x</bold><sub><italic toggle="yes">m</italic></sub><sub>,</sub><sub><italic toggle="yes">i</italic></sub> is the explanatory variables for learner <italic toggle="yes">m</italic> and sample <italic toggle="yes">i</italic>, <bold>θ</bold><sub><italic toggle="yes">m</italic></sub> is the parameters of learner <italic toggle="yes">m</italic> and <italic toggle="yes">ε<sub>i</sub></italic> is the residual. The theoretical backgrounds and variational Bayesian algorithms are illustrated in the pdf manual of the package available at <ext-link xlink:href="https://github.com/Onogi/VIGoR" ext-link-type="uri">https://github.com/Onogi/VIGoR</ext-link>. It is notable that the multiple learners in a model can share the explanatory variables (i.e. <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:math></inline-formula> and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>m</mml:mi><mml:mo>≠</mml:mo><mml:mi>n</mml:mi></mml:math></inline-formula>). Such modeling would behave like ensemble learning which is expected to be robust against hyperparameter specification and data architecture (<xref rid="btac328-B6" ref-type="bibr">Knürr <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btac328-B11" ref-type="bibr">Onogi <italic toggle="yes">et al.</italic>, 2015</xref>).</p>
  </sec>
  <sec>
    <title>2 Experiments</title>
    <p>Two simulation experiments (Exp. 1 and 2) were performed here. The simulated data in Exp. 1 and 2 were bimodal and tetra-modal, respectively. The total number of explanatory variables was 2000, 6000, 10 000, 20 000, 60 000 or 100 000. Each type (mode) of variables was included in equal numbers and explained the same amount of the variance of the response variable. Both the numbers of training and testing samples were 1000. In Exp. 1, both types of the explanatory variables were generated from the standard normal distribution, and 1% and 0.1% of each variable were assumed to have non-zero effects drawn from the standard normal distribution. BayesC with different shrinkage magnitudes was applied to both types of variables. In Exp. 2, one type of explanatory variable was assumed as SNPs, and genotypes were generated assuming allele frequencies being 0.5. The other three types of variables were generated from the standard normal distribution. All the SNPs were assumed to have non-zero effects, and 0.1% had non-zero effects for the other types of variables. Bayesian ridge regression was applied to SNPs, and BayesB were applied to the other types of variables. BayesB and BayesC implemented in VIGoR and BGLR differ in the inclusion probability of explanatory variables. The probability is fixed to a predefined value in VIGoR whereas it is inferred with a prior beta distribution, <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi mathvariant="normal">Beta</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>, in BGLR. Here, <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is the expectation and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> defines the variance as <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>. For fair comparison, <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> was set to 1e + 6 to prevent fluctuation of the probability during sampling. The predefined value of VIGoR and <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> of BGLR were set to the true values of the simulation. VIGoR and BGLR were compared in terms of calculation time, area under the curve (AUC) and prediction accuracy for testing samples. For SNPs in Exp. 2, Pearson correlation between the true and estimated effects was used instead of AUC. These experiments are complementally explained in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
    <p>Calculation time depends on the criterion of convergence. For VIGoR, three convergence criteria were compared. The iterative update of VIGoR was stopped when <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mfenced open="‖" close="‖" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mfenced open="‖" close="‖" separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula> where <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mtext> </mml:mtext><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> is the Euclidean norm, <bold>θ</bold> is the vector containing all parameter values at the previous iteration, <bold>θ*</bold> is the vector consisting of newly updated parameter values at the iteration and <italic toggle="yes">t</italic> is the convergence criterion which was set to 1e − 4 (loose), 1e − 5 (moderate) or 1e − 6 (strict). Because convergence of MCMC is difficult to verify in particular when many parameters are involved, three chain lengths were compared: (i) nIte = 1500, burnIn = 500 and thin = 5 (default setting of BGLR), (ii) nIte = 15 000, burnIn = 5000 and thin = 10 and (iii) nIte = 30 000, burnIn = 20 000 and thin = 10. Here, nIte, burnIn and thin denote the total number of iterations, length of burnin and sampling interval, respectively.</p>
    <p>In Exp. 1, AUC and prediction accuracy of VIGoR were almost same among the convergence criteria (<xref rid="btac328-F1" ref-type="fig">Fig. 1A</xref>). AUC and prediction accuracy of BGLR were improved by prolonging the chain length, but still inferior to those of VIGoR despite more calculation time spent. In Exp. 2, VIGoR generally showed the best performance when <italic toggle="yes">t</italic> = 1e − 6 (<xref rid="btac328-F1" ref-type="fig">Fig. 1B</xref>). Calculation time under this strict criterion was still less than the shortest chain length of BGLR (1500). Complete results with standard deviations are presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures</xref>  <xref rid="sup1" ref-type="supplementary-material">S1</xref> and <xref rid="sup1" ref-type="supplementary-material">S2</xref>.</p>
    <fig position="float" id="btac328-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Experimental results. (<bold>A</bold>) Exp. 1 where BayesC with different shrinkage magnitudes was applied to bimodal explanatory variables. The upper two panels are the AUC for the first and second type variables (AUC1 and AUC2), respectively. The lower two panels are the prediction accuracy and calculation time. For VIGoR and BGLR, three convergence criteria (1e − 4, 1e − 5 and 1e − 6) and chain lengths (1500, 20 000 and 30 000) were attempted, respectively. The <italic toggle="yes">x</italic> axis is the total number of explanatory variables where the bimodal explanatory variables are included half-and-half. Note that AUC1, AUC2 and prediction accuracy of VIGoR were similar among the criteria and thus the curves of 1e − 4 and 1e − 5 are masked by 1e − 6. All plots were averages of 20 replications and the standard deviations are omitted for visual ease (presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Calculation time was measured with a Windows 10 machine with Intel Core i7-5930K CPU, 3.50 GHz. AUC was calculated using ROCR package (<xref rid="btac328-B16" ref-type="bibr">Sing <italic toggle="yes">et al</italic>., 2005</xref>). (<bold>B</bold>) Exp. 2 where Bayesian ridge regression and BayesB were applied to tetra-modal explanatory variables. Estimation accuracy is the Pearson correlation for the first type variable between the true effects and effects estimated by Bayesian ridge regression. AUC2 is the AUC for the second type variable obtained from BayesB. AUC3 and AUC4 (AUC for the third and fourth type variables also obtained from BayesB) are omitted and presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>. All plots were averages of 20 replications and the standard deviations are presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>. (<bold>C</bold>) Exp. 3 where BayesC with different shrinkage magnitudes was applied to additive and interaction effects of real soybean data. Prediction accuracy was evaluated using Pearson correlation between the observed and predicted values. The unit of calculation time is second. Runs were repeated 10 times from different initial values</p>
      </caption>
      <graphic xlink:href="btac328f1" position="float"/>
    </fig>
    <p>In Exp. 3, we compared VIGoR with BGLR using a real data of soybean (<xref rid="btac328-B12" ref-type="bibr">Onogi <italic toggle="yes">et al.</italic>, 2021</xref>). Days to flowering of a major variety (ID V083) evaluated from 2005 to 2015 (<italic toggle="yes">N</italic> = 213) was predicted from records of the variety from 1967 to 2004 (<italic toggle="yes">N</italic> = 838). As explanatory variables, daily mean temperature, photoperiod and precipitation from sowing dates (1st day) to 246th day were used. First-order interactions among these variables were also considered resulting in 246 × 3 + 246 × 246 × 3 = 182 286 explanatory variables. These additive and interaction effects were modeled using BayesC with different shrinkage magnitudes. Specifically, 20% and 0.1% of the additive and interaction variables were assumed to have non-zero effects. <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> of BGLR was set to 1e + 6. The convergence criterion of VIGoR and the chain lengths of BGLR followed those used in Exp. 1 and 2. Prediction accuracy of VIGoR was similar among the convergence criteria (<xref rid="btac328-F1" ref-type="fig">Fig. 1C</xref>), and superior to BGLR of any chain length. Calculation time of VIGoR increased as the criterion became stricter, but still less than the longest chain of BGLR that was not able to achieve accuracy equivalent with VIGoR.</p>
  </sec>
  <sec>
    <title>3 Conclusions</title>
    <p>VIGoR offers fast and accurate solutions for linear models that incorporate multiple learners. The package enables users to model multimodal and high-dimensional explanatory variables, and will help discovering important variables or predicting phenotypes. Although the current version is only applicable to quantitative response variables, future updates will allow application to categorical or censored data.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Ryukoku University.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>R scripts to reproduce the experiment results and pdf manual of the package are provided at <ext-link xlink:href="https://github.com/Onogi/VIGoR" ext-link-type="uri">https://github.com/Onogi/VIGoR</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac328_Supplementary_Data</label>
      <media xlink:href="btac328_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac328-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Friedman</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Regularization paths for generalized linear models via coordinate descent</article-title>. <source>J. Stat. Softw</source>., <volume>33</volume>, <fpage>1</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">20808728</pub-id></mixed-citation>
    </ref>
    <ref id="btac328-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gupta</surname><given-names>G.S.</given-names></string-name>, <string-name><surname>Quan</surname><given-names>V.M.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Multi-sensor integrated system for wireless monitoring of greenhouse environment</article-title>. In: <source>2018 IEEE Sensors Applications Symposium (SAS), Seoul</source>, pp. <fpage>1</fpage>–<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="btac328-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Habier</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Extension of the Bayesian alphabet for genomic selection</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume>, <fpage>186</fpage>.<pub-id pub-id-type="pmid">21605355</pub-id></mixed-citation>
    </ref>
    <ref id="btac328-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hasin</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Multi-omics approaches to disease</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>83</fpage>.<pub-id pub-id-type="pmid">28476144</pub-id></mixed-citation>
    </ref>
    <ref id="btac328-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>M.</given-names></string-name>, <string-name><surname>Tagkopoulos</surname><given-names>I.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Data integration and predictive modeling methods for multi-omics datasets</article-title>. <source>Mol. Omics</source>, <volume>14</volume>, <fpage>8</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">29725673</pub-id></mixed-citation>
    </ref>
    <ref id="btac328-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Knürr</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Impact of prior specifications in a shrinkage-inducing Bayesian model for quantitative trait mapping and genomic prediction</article-title>. <source>Genet. Sel. Evol</source>., <volume>45</volume>, <fpage>1</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">23281913</pub-id></mixed-citation>
    </ref>
    <ref id="btac328-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meuwissen</surname><given-names>T.H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2001</year>) <article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>. <source>Genetics</source>, <volume>157</volume>, <fpage>1819</fpage>–<lpage>1829</lpage>.<pub-id pub-id-type="pmid">11290733</pub-id></mixed-citation>
    </ref>
    <ref id="btac328-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Munandar</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Design of real-time weather monitoring system based on mobile application using automatic weather station</article-title>. In: <source>2017 2nd International Conference on Automation, Cognitive Science, Optics, Micro Electro-Mechanical System, and Information Technology (ICACOMIT), Jakarta</source>, pp. <fpage>44</fpage>–<lpage>47</lpage>.</mixed-citation>
    </ref>
    <ref id="btac328-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mutshinda</surname><given-names>C.M.</given-names></string-name>, <string-name><surname>Sillanpää</surname><given-names>M.J.</given-names></string-name></person-group> (<year>2010</year>) <article-title>Extended Bayesian LASSO for multiple quantitative trait loci mapping and unobserved phenotype prediction</article-title>. <source>Genetics</source>, <volume>186</volume>, <fpage>1067</fpage>–<lpage>1075</lpage>.<pub-id pub-id-type="pmid">20805559</pub-id></mixed-citation>
    </ref>
    <ref id="btac328-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Onogi</surname><given-names>A.</given-names></string-name>, <string-name><surname>Iwata</surname><given-names>H.</given-names></string-name></person-group> (<year>2016</year>) <article-title>VIGoR: variational Bayesian inference for genome-wide regression</article-title>. <source>J. Open Res. Softw</source>., <volume>4</volume>, <fpage>e11</fpage>.</mixed-citation>
    </ref>
    <ref id="btac328-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Onogi</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Exploring the areas of applicability of whole-genome prediction methods for Asian rice (<italic toggle="yes">Oryza sativa</italic> L.)</article-title>. <source>Theor. Appl. Genet</source>., <volume>128</volume>, <fpage>41</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">25341369</pub-id></mixed-citation>
    </ref>
    <ref id="btac328-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Onogi</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>A method for identifying environmental stimuli and genes responsible for genotype-by-environment interactions from a large-scale multi-environment data set</article-title>. <source>Front. Genet</source>., <volume>12</volume>, <fpage>803636</fpage>.<pub-id pub-id-type="pmid">35027920</pub-id></mixed-citation>
    </ref>
    <ref id="btac328-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Park</surname><given-names>T.</given-names></string-name>, <string-name><surname>Casella</surname><given-names>G.</given-names></string-name></person-group> (<year>2008</year>) <article-title>The Bayesian lasso</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>103</volume>, <fpage>681</fpage>–<lpage>686</lpage>.</mixed-citation>
    </ref>
    <ref id="btac328-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pérez</surname><given-names>P.</given-names></string-name>, <string-name><surname>de los Campos</surname><given-names>G.</given-names></string-name></person-group> (<year>2014</year>) <article-title>Genome-wide regression and prediction with the BGLR Statistical package</article-title>. <source>Genetics</source>, <volume>198</volume>, <fpage>483</fpage>–<lpage>495</lpage>.<pub-id pub-id-type="pmid">25009151</pub-id></mixed-citation>
    </ref>
    <ref id="btac328-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Riedelsheimer</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Genomic and metabolic prediction of complex heterotic traits in hybrid maize</article-title>. <source>Nat. Genet</source>., <volume>44</volume>, <fpage>217</fpage>–<lpage>220</lpage>.<pub-id pub-id-type="pmid">22246502</pub-id></mixed-citation>
    </ref>
    <ref id="btac328-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sing</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2005</year>) <article-title>ROCR: visualizing classifier performance in R</article-title>. <source>Bioinformatics</source>, <volume>21</volume>, <fpage>3940</fpage>–<lpage>3941</lpage>.<pub-id pub-id-type="pmid">16096348</pub-id></mixed-citation>
    </ref>
    <ref id="btac328-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tibshirani</surname><given-names>R.</given-names></string-name></person-group> (<year>1996</year>) <article-title>Regression shrinkage and selection via the lasso</article-title>. <source>J. R. Stat. Soc. B</source>, <volume>58</volume>, <fpage>267</fpage>–<lpage>288</lpage>.</mixed-citation>
    </ref>
    <ref id="btac328-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Metabolome-wide association study identified the association between a circulating polyunsaturated fatty acid variant rs174548 and lung cancer</article-title>. <source>Carcinogenesis</source>, <volume>38</volume>, <fpage>1147</fpage>–<lpage>1154</lpage>.<pub-id pub-id-type="pmid">28968813</pub-id></mixed-citation>
    </ref>
    <ref id="btac328-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zou</surname><given-names>H.</given-names></string-name>, <string-name><surname>Hastie</surname><given-names>T.</given-names></string-name></person-group> (<year>2005</year>) <article-title>Regularization and variable selection via the elastic net</article-title>. <source>J. R. Stat. Soc. B</source>, <volume>67</volume>, <fpage>301</fpage>–<lpage>320</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
