<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4765869</article-id>
    <article-id pub-id-type="pmid">26072479</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv228</article-id>
    <article-id pub-id-type="publisher-id">btv228</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2015 Proceedings Papers Committee July 10 to July 14, 2015, Dublin, Ireland</subject>
        <subj-group subj-group-type="heading">
          <subject>Genes</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A hierarchical Bayesian model for flexible module discovery in three-way time-series data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Amar</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="btv228-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btv228-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yekutieli</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="btv228-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maron-Katz</surname>
          <given-names>Adi</given-names>
        </name>
        <xref ref-type="aff" rid="btv228-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv228-AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="btv228-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hendler</surname>
          <given-names>Talma</given-names>
        </name>
        <xref ref-type="aff" rid="btv228-AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="btv228-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shamir</surname>
          <given-names>Ron</given-names>
        </name>
        <xref ref-type="aff" rid="btv228-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btv228-COR1">*</xref>
      </contrib>
      <aff id="btv228-AFF1"><sup>1</sup>The Blavatnik School of Computer Science, Tel Aviv University, Tel Aviv 69978, Israel, <sup>2</sup>Department of Statistics and OR, School of Mathematical Sciences, Tel Aviv University, Tel Aviv 69978, Israel, <sup>3</sup>Functional Brain Center, Wohl Institute for Advanced Imaging, Tel Aviv Sourasky Medical Center, Tel Aviv 64239, Israel and <sup>4</sup>Sackler Faculty of Medicine, Tel Aviv University, Tel Aviv 69978, Israel</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv228-COR1">*To whom correspondence should be addressed.</corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>12</issue>
    <fpage>i17</fpage>
    <lpage>i26</lpage>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Detecting modules of co-ordinated activity is fundamental in the analysis of large biological studies. For two-dimensional data (e.g. genes × patients), this is often done via clustering or biclustering. More recently, studies monitoring patients over time have added another dimension. Analysis is much more challenging in this case, especially when time measurements are not synchronized. New methods that can analyze three-way data are thus needed.</p>
      <p><bold>Results:</bold> We present a new algorithm for finding coherent and flexible modules in three-way data. Our method can identify both core modules that appear in multiple patients and patient-specific augmentations of these core modules that contain additional genes. Our algorithm is based on a hierarchical Bayesian data model and Gibbs sampling. The algorithm outperforms extant methods on simulated and on real data. The method successfully dissected key components of septic shock response from time series measurements of gene expression. Detected patient-specific module augmentations were informative for disease outcome. In analyzing brain functional magnetic resonance imaging time series of subjects at rest, it detected the pertinent brain regions involved.</p>
      <p><bold>Availability and implementation:</bold> R code and data are available at <ext-link ext-link-type="uri" xlink:href="http://acgt.cs.tau.ac.il/twigs/">http://acgt.cs.tau.ac.il/twigs/</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>rshamir@tau.ac.il</email>
      </p>
      <p><bold>Supplementary information</bold><bold>:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv228/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Identifying modules of elements acting in concert is a fundamental paradigm in interpreting, visualizing and dissecting complex biomedical data. For two-dimensional data (e.g. genes versus conditions), clustering is the simplest way to group the elements of one dimension (<xref rid="btv228-B12" ref-type="bibr">Hartigan, 1972</xref>). Biclustering seeks row and column subsets that manifest similarity (<xref rid="btv228-B6" ref-type="bibr">Cheng and Church, 2000</xref>; <xref rid="btv228-B12" ref-type="bibr">Hartigan, 1972</xref>; <xref rid="btv228-B15" ref-type="bibr">Madeira and Oliveira, 2004</xref>). Such analysis has become standard in computational biology (<xref rid="btv228-B19" ref-type="bibr">Mitra <italic>et al.</italic>, 2013</xref>; <xref rid="btv228-B20" ref-type="bibr">Oghabian <italic>et al.</italic>, 2014</xref>). Algorithms for finding biclusters differ in how they define (and identify) biclusters (<xref rid="btv228-B15" ref-type="bibr">Madeira and Oliveira, 2004</xref>). For example, biclusters were defined as sub-matrices with constant values (<xref rid="btv228-B12" ref-type="bibr">Hartigan, 1972</xref>), row or column additive or multiplicative values (<xref rid="btv228-B13" ref-type="bibr">Lazzeroni and Owen, 2002</xref>) and submatrices with order preserving values (<xref rid="btv228-B3" ref-type="bibr">Ben-Dor <italic>et al.</italic>, 2003</xref>).</p>
    <p>Recent studies have extended the idea of biclustering to more complex input structures beyond the standard row–column data (<xref rid="btv228-B19" ref-type="bibr">Mitra <italic>et al.</italic>, 2013</xref>). <xref rid="btv228-B18" ref-type="bibr">Meng <italic>et al.</italic> (2009)</xref> extended the classic Iterative Signature Algorithm (ISA) (<xref rid="btv228-B4" ref-type="bibr">Bergmann <italic>et al.</italic>, 2003</xref>) to analyze a single matrix of time series data together with prior knowledge on gene function to detect temporal transcription modules that are biologically meaningful. <xref rid="btv228-B14" ref-type="bibr">Li and Tuck (2009)</xref> introduced an algorithm for joint analysis of ChIP-chip and gene expression data to find biclusters that are likely to be regulated by similar transcription factors. <xref rid="btv228-B34" ref-type="bibr">Waltman <italic>et al.</italic> (2010)</xref> and <xref rid="btv228-B8" ref-type="bibr">Dede and Ogul (2013)</xref> proposed three-way clustering of gene-condition-organism data. The algorithm of <xref rid="btv228-B34" ref-type="bibr">Waltman <italic>et al.</italic> (2010)</xref> uses sequence information to integrate data across species, and a post-processing step allows detection of species-specific information. <xref rid="btv228-B11" ref-type="bibr">Gerber <italic>et al.</italic> (2007)</xref> cluster tissues hierarchically and then find the representative gene set of each tissue cluster in the hierarchy.</p>
    <p>A common data source that calls for three-way analysis is a collection of gene expression profiles measured for a set of subjects over a series of time points. Hence, the data are represented by a gene × subject × time 3D matrix (i.e. a tensor of order 3) (<xref rid="btv228-B17" ref-type="bibr">Mankad and Michailidis, 2014</xref>; <xref rid="btv228-B36" ref-type="bibr">Zhao and Zaki, 2005</xref>). For such matrices, <xref rid="btv228-B30" ref-type="bibr">Supper <italic>et al.</italic> (2007)</xref> presented EDISA, an extension of ISA that handles a time-course vector for each gene–subject pair instead of a single scalar. Extant models are limited in their ability to detect a signal that is specific to a particular subject. For example, the set of genes active under one subject in a module may only partially overlap with the gene set of other subjects. Another limitation is the assumption of synchronicity of time points across subjects. Although this assumption is valid for technical repeats or well-tailored experiments, it is less plausible in other situations, e.g. samples taken from patients over time, due to possible heterogeneity in the response of different patients.</p>
    <p>Here, we introduce a new, flexible definition of a module suitable for three-way data where subjects have entities (e.g. genes) measured over time, but time courses are unsynchronized among the subjects. A <italic>core module</italic> is defined by a subset of the subjects and a subset of the entities, along with subject-specific subset of the time points. In addition, subjects may have <italic>private modules</italic> that only partially coincide with the core set of entities. The assumption is that the resulting submatrices will show values markedly different from the whole matrix. A toy example is shown in <xref ref-type="fig" rid="btv228-F1">Figure 1</xref>A.
<fig id="btv228-F1" position="float"><label>Fig. 1.</label><caption><p>Overview of the model. (<bold>A</bold>) A toy example of a core module (A) and its private modules (<bold>B</bold>, <bold>C</bold>). (B) An overview of the dependencies in the hierarchical model. P is the vector of subject-specific probabilities <italic>P</italic><sub>s</sub></p></caption><graphic xlink:href="btv228f1p"/></fig>
</p>
    <p>We developed a statistical framework and algorithm for analyzing such data. Our framework can detect core modules and for each subject in a core module, a private module with relevant time points. We developed a hierarchical Bayesian generative model for the data and a procedure that aims to fit model parameters for a given dataset. Our algorithm uses a regular biclustering solution as a starting point and then performs iterative improvement using a Gibbs sampling procedure. The algorithm is called TWIGS (three-way module inference via Gibbs sampling). In simulations, we show that TWIGS outperforms standard algorithms even when the core modules have no additional subject-specific signal. When subject-specific signals exist, the ability of extant algorithms to detect the core modules declines markedly, whereas the performance of TWIGS remains high.</p>
    <p>We demonstrate the advantage of our framework on experimental data from two different domains: gene expression and brain functional magnetic resonance imaging (fMRI) signals. We first analyzed whole blood expression profiles, taken daily for 5 days from 14 patients after septic shock (<xref rid="btv228-B21" ref-type="bibr">Parnell <italic>et al.</italic>, 2013</xref>). TWIGS detected two core modules of up-regulated genes, showing enrichment for different immune system processes. The first was related to response to bacteria, whereas the second was related to regulation of T-cells. Analysis of the subject-specific private modules revealed multiple enrichments that illustrate patient-specific-activated biological processes. Hence, our analysis produced both shared and subject-specific insights, highlighting biological pathways that repeatedly emerge as up-regulated after septic shock, together with additional biological functions particular to each patient. We also analyzed fMRI readings for 20 subjects at rest (<xref rid="btv228-B33" ref-type="bibr">Vaisvaser <italic>et al.</italic>, 2013</xref>). The data for each subject are a matrix of 464 brain regions (parcels) measured over 94 time points at 3 s intervals. Each value in the matrix is the parcel’s average blood-oxygen-level-dependent (BOLD) contrast. These levels are indicators of the activity at that region. TWIGS revealed several core modules of highly activated bi-lateral brain regions. Reassuringly, the detected modules were enriched with regions that are known to be active during rest. This analysis shows that our framework is able to detect large functional networks that reappear as activated across subjects and also highlight subject-specific activation patterns.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec id="SEC2.1">
      <title>2.1 The probabilistic model</title>
      <p>The input for our problem is summarized as a 3D matrix <bold>Z</bold> where <inline-formula><mml:math id="MM1"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the activity level of the measured object <inline-formula><mml:math id="MM2"><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula>, at time <inline-formula><mml:math id="MM3"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, for subject <inline-formula><mml:math id="MM4"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula>. We will say that <italic>v</italic> and <italic>t</italic> represent the rows and columns of the matrix and <italic>s</italic> represents layers. In gene expression data, <italic>v</italic> represents genes, whereas in fMRI, data <italic>v</italic> represents brain regions (parcels or voxels). For uniformity, from now on we use for <italic>v</italic> the term row or voxel. Here, we describe a hierarchical probability model for generating a single module from the distribution of <inline-formula><mml:math id="MM5"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle></mml:math></inline-formula>.</p>
      <p>We assume that there is a set of voxels <inline-formula><mml:math id="MM6"><mml:mrow><mml:mi mathvariant="script">V</mml:mi><mml:mo>⊂</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> that tend to have high values jointly in a subset of the subjects. <inline-formula><mml:math id="MM7"><mml:mi mathvariant="script">V</mml:mi></mml:math></inline-formula> is specified by the indicator vector <inline-formula><mml:math id="MM8"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, through the relation <inline-formula><mml:math id="MM9"><mml:mrow><mml:mi mathvariant="script">V</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>v</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. We assume that <inline-formula><mml:math id="MM10"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Bernoulli</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Although <italic>H</italic> marks the rows of the core module, the signal in each specific subject might change. The subject-specific voxel sets are specified by the matrix <inline-formula><mml:math id="MM11"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi><mml:mi>S</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="MM12"><mml:mrow><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> specifies that voxel <italic>v</italic> participates in the module of subject <italic>s</italic>. The relation between <inline-formula><mml:math id="MM13"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="MM14"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi><mml:mi>S</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula> is as follows: if <italic>H<sub>v</sub></italic> = 1 then <inline-formula><mml:math id="MM15"><mml:mrow><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Bernoulli</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, otherwise <inline-formula><mml:math id="MM16"><mml:mrow><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Bernoulli</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>We next model the time-series relations. <inline-formula><mml:math id="MM17"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> indicates whether the voxel set of subject <italic>s</italic> is active at time <italic>t</italic>. We assume <inline-formula><mml:math id="MM18"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The activity at time <inline-formula><mml:math id="MM19"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, depends on the time window of size <inline-formula><mml:math id="MM20"><mml:mrow><mml:mi>w</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> before <italic>t</italic>. In times <inline-formula><mml:math id="MM21"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math></inline-formula>, the time window is <inline-formula><mml:math id="MM22"><mml:mrow><mml:mn>1</mml:mn><mml:mo>⋯</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Let <inline-formula><mml:math id="MM23"><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, if the time window of subject <italic>s</italic> right before time point <italic>t</italic> contains at least one active time point and set <inline-formula><mml:math id="MM24"><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> otherwise. We assume that <inline-formula><mml:math id="MM25"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM26"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
      <p>Finally, we assume that for <italic>v</italic>, <italic>t</italic>, <italic>s</italic> for which <inline-formula><mml:math id="MM27"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM28"><mml:mrow><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, otherwise <inline-formula><mml:math id="MM29"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. An overview of the model hierarchy is shown in <xref ref-type="fig" rid="btv228-F1">Figure 1</xref>B. We assume that all hyper-parameters above have Beta prior distributions: <inline-formula><mml:math id="MM30"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="MM31"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 The Gibbs sampling algorithm</title>
      <p>Our algorithm starts from a solution produced using a standard biclustering algorithm and then applies iterative improvement steps. In each step, all parameters are fixed except a single one that is sampled according to its conditional probability. The order of parameters matches the subsections below. This order is repeated cyclically <italic>k</italic> times. The output of the process is the set of sampled values for each parameter in all iterations. We then extract the core modules and the subject-specific modules from this output.
<list list-type="simple"><list-item><p>(1) As <italic>H<sub>v</sub></italic> are Bernoulli realizations with success probability π<italic><sup>V</sup></italic><italic><sup>C</sup></italic>:
<disp-formula><mml:math id="MM32"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>v</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>v</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p></list-item></list>
</p>
      <p>Similarly: 
<disp-formula><mml:math id="MM233"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>v</mml:mi><mml:mo>:</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>v</mml:mi><mml:mo>:</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>:</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>:</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>s</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>s</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
<disp-formula><mml:math id="MM33"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>:</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>:</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>:</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>:</mml:mo><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
<list list-type="simple"><list-item><p>(2) H<italic><sub>v</sub></italic> is affected by π<italic><sup>V</sup></italic><italic><sup>C</sup></italic>, and it affects the values of <inline-formula><mml:math id="MM34"><mml:mrow><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for each s: 
<disp-formula><mml:math id="MM35"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p></list-item></list>
</p>
      <p>Thus,
<disp-formula><mml:math id="MM36"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mi>H</mml:mi></mml:mstyle><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext> </mml:mtext><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mi>H</mml:mi></mml:mstyle><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext> </mml:mtext><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p>
      <p>Therefore, the conditional posterior of <italic>H<sub>v</sub></italic> is:
<disp-formula><mml:math id="MM37"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
<list list-type="simple"><list-item><p>(3) Given <inline-formula><mml:math id="MM38"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, only the value of <inline-formula><mml:math id="MM39"><mml:mrow><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> affects the distribution of <inline-formula><mml:math id="MM40"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Assume for now, that we condition on <italic>H<sub>v</sub></italic> = 1, then: 
<disp-formula><mml:math id="MM41"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p></list-item></list>
</p>
      <p>From the above, it is clear that when <inline-formula><mml:math id="MM42"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>:
<disp-formula><mml:math id="MM43"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p>
      <p>Therefore, a time point <italic>t</italic> in which <inline-formula><mml:math id="MM44"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> will not affect the marginal distribution of <inline-formula><mml:math id="MM45"><mml:mrow><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Let <inline-formula><mml:math id="MM46"><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>t</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, then:
<disp-formula><mml:math id="MM47"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p>
      <p>On the basis of the equations above, we can calculate the conditional posterior of <inline-formula><mml:math id="MM48"><mml:mrow><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, given that <italic>H<sub>v</sub></italic> = 1, through:
<disp-formula><mml:math id="MM49"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>∨</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
Similarly, the conditional posterior of <inline-formula><mml:math id="MM50"><mml:mrow><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> given that <italic>H<sub>v</sub></italic> = 0 can be calculated by replacing every <italic>p<sub>s</sub></italic> with <italic>p</italic><sub>0</sub> in the formulas above.
<list list-type="simple"><list-item><p>(4) As the value of <inline-formula><mml:math id="MM51"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> affects the value of the time window <inline-formula><mml:math id="MM52"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the values of <inline-formula><mml:math id="MM53"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="MM54"><mml:mrow><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>:
<disp-formula><mml:math id="MM55"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow/><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>:</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p></list-item></list>
</p>
      <p>Unlike the equation above, calculating the probability of <inline-formula><mml:math id="MM56"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> requires breaking the window into two parts. Assume that the time window contains at least one active cell. Let <italic>l</italic> be the first time point of <inline-formula><mml:math id="MM57"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> that changes from 0 to 1. Thus:
<disp-formula><mml:math id="MM58"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow/><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:msup><mml:mo>·</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>:</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
If there are no active cells in <inline-formula><mml:math id="MM59"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, then the calculation reduces to:
<disp-formula><mml:math id="MM60"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>:</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p>
      <p>Finally, the conditional of <inline-formula><mml:math id="MM61"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> can be calculated by:
<disp-formula><mml:math id="MM62"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
The conditional probability of the event <inline-formula><mml:math id="MM63"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is computed in the same way.
<list list-type="simple"><list-item><p>(5) For <inline-formula><mml:math id="MM64"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the value of <inline-formula><mml:math id="MM65"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is affected by the value of <inline-formula><mml:math id="MM66"><mml:mrow><mml:mi>C</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and it affects the value of <inline-formula><mml:math id="MM67"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mtext>min</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and the values of <inline-formula><mml:math id="MM68"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="MM69"><mml:mrow><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Thus: 
<disp-formula><mml:math id="MM270"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow/><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext>  </mml:mtext><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>:</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
<disp-formula><mml:math id="MM70"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:mstyle><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext>  </mml:mtext><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext>  </mml:mtext><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mtext>  </mml:mtext><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>:</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p></list-item></list>
</p>
      <p>Thus, <inline-formula><mml:math id="MM71"><mml:mrow><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can be calculated similarly to the calculations in the previous section.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Setting <italic>f</italic><sub>0</sub> and <italic>f</italic><sub>1</sub></title>
      <p>Here, we discuss two options for setting <italic>f</italic><sub>0</sub> and <italic>f</italic><sub>1</sub> and their hyper-parameters: (i) a <italic>Bernulli-Beta</italic> model for binary data and (ii) a <italic>Normal-Gamma</italic> model for normal distributions. Let <italic>A</italic> be the cells within the module (including the core and private parts): <inline-formula><mml:math id="MM72"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∧</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Let <italic>B</italic> be the cells outside the module: <inline-formula><mml:math id="MM73"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>∨</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula></p>
      <p>For binary data, we assume that <inline-formula><mml:math id="MM74"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mtext>Bernoulli</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM75"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mtext>Bernoulli</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Thus, our model learns the background probability <inline-formula><mml:math id="MM76"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> of observing a value of 1 and the probability <inline-formula><mml:math id="MM77"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> of observing 1 within the module. In this model, <inline-formula><mml:math id="MM78"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM79"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> follow Beta posterior distributions:
<disp-formula><mml:math id="MM80"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p>
      <p>In the continuous case, we assume that <italic>f</italic><sub>0</sub> is <inline-formula><mml:math id="MM81"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <italic>f</italic><sub>1</sub> is <inline-formula><mml:math id="MM82"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Under the <italic>Normal-Gamma</italic> model, the prior distribution for the mean <italic>μ</italic> and the standard deviation <italic>σ</italic> of a normal distribution <inline-formula><mml:math id="MM83"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is:
<disp-formula><mml:math id="MM84"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>σ</mml:mi><mml:malignmark/><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>μ</mml:mi><mml:malignmark/><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
The conditional posteriors for <inline-formula><mml:math id="MM85"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where for each <italic>i</italic>, <inline-formula><mml:math id="MM86"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are:
<disp-formula><mml:math id="MM87"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>σ</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mi>μ</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mi>σ</mml:mi><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
Thus, we apply the model above for <italic>A</italic> and <italic>B</italic>, thereby modeling <italic>f</italic><sub>0</sub> and <italic>f</italic><sub>1</sub> as normal distributions.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Finding multiple modules</title>
      <p>To find a single module, we use a standard biclustering algorithm to produce an initial solution and then use the Gibbs sampler to improve it. The biclustering algorithm is applied on a 2D matrix <italic>M</italic> obtained by concatenating the layers in <italic>Z</italic>, i.e. <inline-formula><mml:math id="MM88"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="MM89"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>. In this study, we tested Bimax (<xref rid="btv228-B22" ref-type="bibr">Prelic <italic>et al.</italic>, 2006</xref>) and ISA (<xref rid="btv228-B4" ref-type="bibr">Bergmann <italic>et al.</italic>, 2003</xref>) as the base algorithms. To binarize real-valued data <italic>Z</italic> to run Bimax, we use a threshold <italic>τ</italic>: we set every value <inline-formula><mml:math id="MM90"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="MM91"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:math></inline-formula>) to 1 (0). By default, we set <italic>τ</italic> to be the 0.9 quantile of the values in <italic>Z</italic>. After running the Gibbs sampler, we take the mode of <italic>H</italic>, <italic>HS</italic> and <italic>C</italic> as the solution. By default, all hyperparameters of the Gibbs sampler are set to non-informative priors. This means that the algorithm infers these parameters and thus no tunning is required.</p>
      <p>To find multiple modules, we tested two previously used heuristics (<xref rid="btv228-B26" ref-type="bibr">Serin and Vingron, 2011</xref>; <xref rid="btv228-B27" ref-type="bibr">Shabalin <italic>et al.</italic>, 2009</xref>). In the first (<xref rid="btv228-B6" ref-type="bibr">Cheng and Church, 2000</xref>), which we call <italic>masker</italic>, we run the algorithm iteratively on the residual matrix of <italic>Z</italic>. The residual matrix is calculated by going over all cells in the module and updating their values in <italic>Z</italic>. In the binary model, the update rule is to change all module cells to zero. In the normal model, we subtract the mean of <italic>f</italic><sub>1</sub> from the value of each cell.</p>
      <p>The second heuristic, called <italic>filter</italic>, takes a set of biclusters <italic>U</italic> as input and produces a reduced set. It first uses the <italic>overlap reduction</italic> method of <xref rid="btv228-B26" ref-type="bibr">Serin and Vingron (2011):</xref> initially <inline-formula><mml:math id="MM92"><mml:mrow><mml:mi>U</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mo>∅</mml:mo></mml:mrow></mml:math></inline-formula>, then the largest module in <italic>U</italic> is added to <inline-formula><mml:math id="MM93"><mml:mrow><mml:mi>U</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and all remaining modules with a large overlap with it (we used Jaccard index <inline-formula><mml:math id="MM94"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>) are removed from <italic>U</italic>. The process is repeated until <italic>U</italic> is empty. Next, we run the Gibbs sampler on the original matrix <italic>Z</italic> starting with each module in <inline-formula><mml:math id="MM95"><mml:mrow><mml:mi>U</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>. The result is a set of new modules <inline-formula><mml:math id="MM96"><mml:mrow><mml:mi>U</mml:mi><mml:mo>″</mml:mo></mml:mrow></mml:math></inline-formula>. Finally, as different modules in <inline-formula><mml:math id="MM97"><mml:mrow><mml:mi>U</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> might converge into similar modules in <inline-formula><mml:math id="MM98"><mml:mrow><mml:mi>U</mml:mi><mml:mo>″</mml:mo></mml:mrow></mml:math></inline-formula>, the overlap removal process is used again, taking <inline-formula><mml:math id="MM99"><mml:mrow><mml:mi>U</mml:mi><mml:mo>″</mml:mo></mml:mrow></mml:math></inline-formula> as input.</p>
      <p>For both heuristics, we define when to add a module to the final output. When using <italic>masker</italic>, we add modules until the first time a module is rejected. A module is accepted if it is large enough and the difference <inline-formula><mml:math id="MM100"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> for it is large enough. In the binary case, we set <inline-formula><mml:math id="MM101"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> and in the normal case we set <inline-formula><mml:math id="MM102"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>. Setting the minimal module size depends on the application and on the size of the input data. By default, we set the minimal size of a core module to 5 rows and 5 time points (combining all subjects).</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Performance measures</title>
      <p>In the results below, we compare algorithms on simulated data. In each case, we compare the known <italic>H</italic>, <italic>HS</italic>, <italic>C</italic> to the algorithm output <inline-formula><mml:math id="MM103"><mml:mrow><mml:mi>H</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mi>S</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> using the Jaccard coefficient. For example, the Jaccard score of <italic>H</italic> and <inline-formula><mml:math id="MM104"><mml:mrow><mml:mi>H</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> is:
<disp-formula><mml:math id="MM105"><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∧</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∨</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
When the data contain more than one module we use the running max average of all pairwise Jaccard scores. Given the known solution <inline-formula><mml:math id="MM106"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the algorithm output <inline-formula><mml:math id="MM107"><mml:mrow><mml:mi>H</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the running max average score is:
<disp-formula><mml:math id="MM108"><mml:mrow><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:munder><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munder><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
The same method is used for <italic>HS</italic> and <italic>C</italic>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec id="SEC3.1">
      <title>3.1 Simulations</title>
      <p>Our simulations setup was as follows. We set <italic>V</italic> = 500, <italic>T</italic> = 50, <italic>S</italic> = 10 and create an initial matrix <italic>Z</italic> in which all values are zero. We then add modules to <italic>Z</italic> in which all values are 1 and later add noise according to the tested model (binary or normal). To define a new module, we first need to randomly select the rows and columns of each subject <italic>s</italic>. Time points are selected randomly with <italic>w</italic> = 1, <inline-formula><mml:math id="MM109"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM110"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>. Rows are selected randomly as follows. We first select randomly 20 rows <inline-formula><mml:math id="MM111"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for the core module. Then, we add row <italic>r</italic> to the private module of subject <italic>s</italic> with probability <inline-formula><mml:math id="MM112"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="MM113"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, otherwise <italic>r</italic> is added with probability <inline-formula><mml:math id="MM114"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
      <p>Adding random noise to the data depends on the tested model. In the binary case, we randomly replace <inline-formula><mml:math id="MM115"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="MM116"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, with probability <italic>p<sub>w</sub></italic> if (<italic>v</italic>, <italic>t</italic>, <italic>s</italic>) belongs to the private module of <italic>s</italic> and with probability <italic>p</italic><sub>o</sub> otherwise. In the normal model for each (<italic>v</italic>, <italic>t</italic>, <italic>s</italic>) within the private module of <italic>s</italic> we select <inline-formula><mml:math id="MM117"><mml:mrow><mml:msub><mml:mi mathvariant="normal">ϵ</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, otherwise we select <inline-formula><mml:math id="MM118"><mml:mrow><mml:msub><mml:mi mathvariant="normal">ϵ</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We then add the noise by updating <inline-formula><mml:math id="MM119"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">ϵ</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. We tested scenarios of a single module with and without subject-specific signals and of multiple modules.</p>
    </sec>
    <sec sec-type="cases">
      <title>3.2 Case 1: a single core module</title>
      <p>In this test, we set <inline-formula><mml:math id="MM120"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM121"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. This case represents the standard biclustering task because there is no subject-specific signal. Thus, biclustering algorithms are expected to achieve high performance.</p>
      <p>The results are shown in <xref ref-type="fig" rid="btv228-F2">Figure 2</xref>A and B. Each algorithm was tested on 10 instances and the average Jaccard score, which quantifies the agreement between the known solution and the algorithm output, is shown. We set high noise levels both in the binary data (<xref ref-type="fig" rid="btv228-F2">Fig. 2</xref>A)—<inline-formula><mml:math id="MM122"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>o</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula> and in the normal data (<xref ref-type="fig" rid="btv228-F2">Fig. 2</xref>B)—<inline-formula><mml:math id="MM123"><mml:mrow><mml:mi>σ</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>o</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The Bimax algorithm had a low Jaccard score in most cases, since its output covered only a small part of the true bicluster. Although the false-positive rate was very low (&lt;0.01 both for the bicluster rows and columns), the true-positive rate was low as well (&lt;0.25). ISA performed much better, especially in terms of identifying <italic>H</italic> and <italic>HS</italic>. Using TWIGS to improve the solution was beneficial: it was able to keep the high performance of ISA for <italic>H</italic> and <italic>HS</italic> and to considerably improve the score of <italic>C</italic>. It greatly improved the Bimax solution in all criteria. For example, in the normal data, the score of <italic>C</italic> went up from 0.053 to 0.93. The ISA solution improved from 0.63 to 0.95 using TWIGS. Notably, this improvement was achieved with only 50 sampling iterations, which took less than 7 s on average (over simulation repeats). Thus, this boost in performance was achieved at a low cost of running time. We kept this number of iterations also in subsequent analyses. Note, however, that when the data are much larger (e.g. <inline-formula><mml:math id="MM124"><mml:mrow><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula>), the running time could increase to several minutes.
<fig id="btv228-F2" position="float"><label>Fig. 2.</label><caption><p>Simulation results for data with a single module. Each bar represents the average over 10 repeats. (<bold>A</bold>) Case 1: no subject-specific signal. (<bold>B</bold>) Case 2: with subject-specific signals. The Bimax-Gibbs variant was later chosen as the default TWIGS algorithm</p></caption><graphic xlink:href="btv228f2p"/></fig>
</p>
      <p>We also tested a binary case in which the noise levels were not symmetric: we set <inline-formula><mml:math id="MM125"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM126"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>o</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>. The results are shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv228/-/DC1">Supplementary Figure 1</ext-link>. In this case, the Bimax–Gibbs combination reached the top performance in all measurements, with very high scores: 0.92 (<italic>H</italic>), 0.86 (<italic>HS</italic>) and 0.93 (<italic>C</italic>). The performance of both ISA and Bimax was low (all scores were &lt;0.7), indicating that standard algorithms have difficulty in such noise levels.</p>
    </sec>
    <sec sec-type="cases">
      <title>3.3 Case 2: a core module with subject-specific signal</title>
      <p>In this test, we set <inline-formula><mml:math id="MM127"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM128"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>. Thus, this scenario is different from standard biclustering and triclustering tasks in two ways: (i) not all shared rows are necessarily part of each private module and (ii) each private module is likely to contain additional rows that are not shared among all subjects.</p>
      <p>The results (averaged over 10 instances) are shown in <xref ref-type="fig" rid="btv228-F2">Figure 2</xref>C and D. The noise levels were <inline-formula><mml:math id="MM129"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>o</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula> in the binary data <xref ref-type="fig" rid="btv228-F2">Fig. 2</xref>C) and <inline-formula><mml:math id="MM130"><mml:mrow><mml:mi>σ</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>o</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> in the normal data (<xref ref-type="fig" rid="btv228-F2">Fig. 2</xref>D). Similar to Case 1, Bimax had low scores because it typically covered only a small perfect fraction of the module, whereas ISA reached higher performance. However, the performance of ISA was much lower than in Case 1. For example, in the normal data the score of <italic>H</italic>, which represents the core module rows, dropped from 0.87 in Case 1 to 0.57. This result demonstrates a weakness of standard biclustering algorithms when the data contain subject-specific signal: the algorithms might fail to discover even the shared information. In contrast to ISA and Bimax, TWIGS improved the solution considerably in all measures. For example, the score of <italic>H</italic> and <italic>C</italic> was &gt;0.89 when starting with the Bimax solution.</p>
    </sec>
    <sec sec-type="cases">
      <title>3.4 Case 3: multiple modules</title>
      <p>Here, we tested the performance of TWIGS with <italic>filter</italic> and <italic>masker</italic> on data with five core modules, each with it own subject-specific signals, using as before <inline-formula><mml:math id="MM131"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM132"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>. The results are shown in <xref ref-type="fig" rid="btv228-F3">Figure 3</xref>. As expected, the results were lower than in the single core module tests. Nonetheless, the results were still high in spite of the high noise levels.
<fig id="btv228-F3" position="float"><label>Fig. 3.</label><caption><p>Simulation results for data with five core modules. Each bar represents the average over 10 repeats. (<bold>A</bold>) Binary data. (<bold>B</bold>) Normal data. The Bimax-Gibbs-masker variant was later chosen as the default TWIGS algorithm</p></caption><graphic xlink:href="btv228f3p"/></fig>
</p>
      <p>Unlike the previous cases, using <italic>masker</italic> with Bimax as the base algorithm was much better than all other algorithms. For example, in the binary case (<xref ref-type="fig" rid="btv228-F3">Fig. 3</xref>A), it reached scores of 0.86 and 0.8 for <italic>H</italic> and <italic>C</italic> respectively, where all other algorithms had scores below 0.6. In the normal data, we observed a sharp decrease in performance when setting the noise levels to <inline-formula><mml:math id="MM133"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> as in the previous sections, see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv228/-/DC1">Supplementary Figure 2</ext-link>. With a bit lower noise levels of 0.75, the results were similar to the binary case (<xref ref-type="fig" rid="btv228-F3">Fig. 3</xref>B). Interestingly, forcing high mean value in <italic>f</italic><sub>1</sub> (i.e. by setting <inline-formula><mml:math id="MM134"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and high <italic>p</italic><sub>0</sub> constant in the Normal-Gamma model, see Section 2) achieved higher performance scores. For example, setting the mean value to 1.5 improved the score of <italic>H</italic> from 0.8 to 0.9 and the score of <italic>C</italic> from 0.71 to 0.77. We discovered that the non-informative variant had some detrimental instances in which some core modules were grouped together (average number of detected modules was 4.2), whereas enforcing high mean for <italic>f</italic><sub>1</sub> detected the correct number of core modules.</p>
      <p>On the basis of the above results, from this point on, we used the Bimax-Gibbs-masker as the default variant of the TWIGS algorithm.</p>
    </sec>
    <sec id="SEC3.5">
      <title>3.5 Gene expression data</title>
      <p>We tested the performance of TWIGS by analyzing transcriptional response of patients to sepsis. <xref rid="btv228-B21" ref-type="bibr">Parnell <italic>et al.</italic> (2013)</xref> monitored patients after septic shock. For up to 5 days after sepsis, blood samples were taken daily, and whole blood gene expression was measured using Illumina microarrays. The dataset contained 14 patients for which five profiles, one for each day after sepsis, were available. Our goal was to detect up-regulated biological functions after septic shock. Therefore, for each subject we calculated the log fold change between time points <inline-formula><mml:math id="MM135"><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> and the first time point. We binarized the data by setting a threshold of 2 for the fold change (i.e. 1 for the log fold change) and ran <italic>masker</italic> with Bimax as the base algorithm. See the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv228/-/DC1">Supplementary Text</ext-link> for additional analyses using the non-binarized data and for sensitivity analysis of the binarization threshold. We set the minimal size of the detected core module to 10 rows and 10 columns (number of time points from all patients) and <italic>f</italic><sub>1</sub> to have <inline-formula><mml:math id="MM136"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>. Using these stop criteria in <italic>masker</italic>, a single small module of 5 genes was detected over 20 repeats in which we independently and randomly shuffled the values of each row in the input matrix.</p>
      <p>Two core modules were detected on the real expression matrix. The first covered 11 patients and 53 genes. The second covered seven patients and 62 genes. Four patients were represented in both. Distinct private modules were assigned to each subject in each module. Thus, a total of 20 modules (core or private) were detected in the analysis. GO enrichment analysis [using EXPANDER (<xref rid="btv228-B32" ref-type="bibr">Ulitsky <italic>et al.</italic>, 2010</xref>)] detected significant enrichment (0.05 FDR) in 19 of the modules. The two detected core modules differed in their enriched biological functions. The first was highly enriched with genes related to killing of cells of other organisms (<inline-formula><mml:math id="MM137"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>2.7</mml:mn><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:math></inline-formula>) and response to bacterium (<inline-formula><mml:math id="MM138"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>2.2</mml:mn><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mn>9</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.The second core module was enriched with functions that were more specific to T-cell activity (e.g. regulation of T cell activation <inline-formula><mml:math id="MM139"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>4.5</mml:mn><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>). Thus, TWIGS identified a fuzzy partition of the subjects into two main branches of the immune system and also pointed out the relevant up-regulated genes.</p>
      <p>The private modules in the solution were often much larger than the core modules. For example, in the first core module, the private modules of subjects 19 and 24 contained more than 450 genes each. The first core module and the enrichment analysis results of its private modules are shown in <xref ref-type="fig" rid="btv228-F4">Figure 4</xref>. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv228/-/DC1">Supplementary Figure 3</ext-link> for the results of the second core module. Only biological functions that were not significant in the core modules are shown. The figure illustrates how our analysis provides a complementary view to the core modules. That is, although the core modules indicate which biological functions tend to reappear across subjects, the private modules reveal additional enrichments that are sometimes much more specific biologically. For example, the private module of subject 24 was highly enriched with genes related to viral infectious cycle (<inline-formula><mml:math id="MM140"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>1.7</mml:mn><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula>). The network also highlights patients without subject-specific unique enrichments (subjects 30, 46, 49 and 50) and two hubs: subjects 24 and 19. Strikingly, out of the 11 patients covered by this core module, these two patients had much larger private modules and they were the only patients that did not survive the septic shock.
<fig id="btv228-F4" position="float"><label>Fig. 4.</label><caption><p>A module summarizing patient response to sepsis. Top: the first core module heatmap. Bottom: the subject-specific enrichments. The red stripes in each patient’s node represent the time points that were covered by its private module. An edge between a subject and a category (blue node) indicates that the subject-specific module was enriched for that category</p></caption><graphic xlink:href="btv228f4p"/></fig>
</p>
    </sec>
    <sec id="SEC3.6">
      <title>3.6 fMRI data</title>
      <p><xref rid="btv228-B33" ref-type="bibr">Vaisvaser <italic>et al.</italic> (2013)</xref> collected brain fMRI data from 20 male subjects at rest over 94 time points. In this technique blood flow (BOLD) intensity is measured at every voxel of the brain along time, providing levels of some 100 000 voxels every 2–3 s. The level reflects the activation intensity of the brain voxel. Standard fMRI preprocessing was applied on the raw data as reported in (<xref rid="btv228-B33" ref-type="bibr">Vaisvaser <italic>et al.</italic>, 2013</xref>). We used a whole brain functional parcellation to transform the data into 517 brain parcels (<xref rid="btv228-B7" ref-type="bibr">Craddock <italic>et al.</italic>, 2012</xref>). Parcels were masked to include gray matter voxels only using the WFU Pick Atlas Tool (<xref rid="btv228-B16" ref-type="bibr">Maldjian <italic>et al.</italic>, 2003</xref>; <xref rid="btv228-B29" ref-type="bibr">Stamatakis <italic>et al.</italic>, 2010</xref>) and 54 parcels that had <inline-formula><mml:math id="MM141"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> gray matter voxels were excluded. For each subject, average BOLD value across all gray matter voxels was calculated within each parcel at each time point. As is standard practice in fMRI analysis (<xref rid="btv228-B5" ref-type="bibr">Birn, 2012</xref>), to reduce the effect of physiological artifacts and nuisance variables, the whole-brain mean signal, six motion parameters, cerebrospinal fluid and white matter signals were regressed out of the parcel signals. The result is a matrix <italic>M<sub>s</sub></italic> for each subject <italic>s</italic>, in which rows are parcels and columns are time points. We standardized the signal of each row in <italic>M<sub>s</sub></italic> by subtracting the mean and dividing by the standard deviation. This normalization allows us to find relative changes in the activity of brain regions to highlight temporally activated regions (<xref rid="btv228-B23" ref-type="bibr">Rana <italic>et al.</italic>, 2013</xref>).</p>
      <p>We ran TWIGS with the normal model, Bimax as the initial solution finder and <italic>masker</italic>. With non-informative priors, the algorithm converged to large modules with relatively low mean value (&lt;0.5). As we were interested in highly activated brain regions, we reset the mean of <italic>f</italic><sub>1</sub> to a high value: we tested <inline-formula><mml:math id="MM142"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM143"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. As in the simulations, using such prior improved the results considerably since the non-informative variant tended to merge core modules with high mean value. No module was detected when running the algorithm after randomly and independently shuffling each row of the data matrix (20 repeats).</p>
      <p>Unlike in the gene expression analysis, each subject participated in each core module. For <inline-formula><mml:math id="MM144"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="btv228-F5">Fig. 5</xref>A), four core modules were detected (labeled 1A–4A), with an average of 48.5 parcels. For <inline-formula><mml:math id="MM145"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="btv228-F5">Fig. 5</xref>B), five core modules were detected (labeled 1B–5B), with an average of 66.4 parcels. Out of the five core modules detected using <inline-formula><mml:math id="MM146"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula>, four had a parallel core module detected using <inline-formula><mml:math id="MM147"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. In addition, modules 1A and 1B maintained similar spatial structure and size and so did 3A and 3B. Modules 2A and 4A were larger than their counterparts.
<fig id="btv228-F5" position="float"><label>Fig. 5.</label><caption><p>Results of the fMRI analysis. (<bold>A</bold>) The core module rows of the solution with <inline-formula><mml:math id="MM148"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) The core module rows of the solution with <inline-formula><mml:math id="MM149"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>C</bold>, <bold>D</bold>) Examples of subject-specific statistics. This example shows the results for core module 4B. (C) The percent of core module parcels covered by the private modules. Asterisks indicate subjects whose private module had a significant overlap (hyper-geometric <inline-formula><mml:math id="MM150"><mml:mrow><mml:mi>P</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>) with the core module. (D) The number of time points in each private module</p></caption><graphic xlink:href="btv228f5p"/></fig>
</p>
      <p>We evaluated the parcel sets of the identified core modules by comparing them to known functional annotations of the brain (<xref rid="btv228-B35" ref-type="bibr">Yeo <italic>et al.</italic>, 2011</xref>). The results show that our analysis detected well-known functional modules that are expected to share common activation patterns both during task and at rest. In both solutions, core module 1 was enriched with regions that are involved in visual processing in the occipital lobe of both hemispheres (<inline-formula><mml:math id="MM151"><mml:mrow><mml:mi>q</mml:mi><mml:mo>≤</mml:mo><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:math></inline-formula>) (<xref rid="btv228-B2" ref-type="bibr">Belliveau <italic>et al.</italic>, 1991</xref>). Core module 2B was enriched with parcels located within the ventral attention network, which is involved in bottom-up orienting of attention (<inline-formula><mml:math id="MM152"><mml:mrow><mml:mi>q</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math></inline-formula>) (<xref rid="btv228-B10" ref-type="bibr">Fox <italic>et al.</italic>, 2006</xref>). In both solutions, core module 3 was enriched with parcels located in regions that are involved in sensori-motor processing (<inline-formula><mml:math id="MM153"><mml:mrow><mml:mi>q</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:math></inline-formula>) and in parcels located within regions of the dorsal attention network, which is involved in top-down orienting of attention (<inline-formula><mml:math id="MM154"><mml:mrow><mml:mi>q</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math></inline-formula>) (<xref rid="btv228-B10" ref-type="bibr">Fox <italic>et al.</italic>, 2006</xref>). Modules 4A and 4B were enriched with parcels located in the default mode network (<inline-formula><mml:math id="MM155"><mml:mrow><mml:mi>q</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>), which is composed mainly of midline structures and is involved in self referential functions that include remembering the past as well as planning the future, and the frontoparietal control network, which is responsible for adaptive behavior (<inline-formula><mml:math id="MM156"><mml:mrow><mml:mi>q</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula>) (<xref rid="btv228-B9" ref-type="bibr">Dosenbach <italic>et al.</italic>, 2007</xref>). Finally, core module 5B contained 29 parcels and was enriched with regions that are involved in visual processing (<inline-formula><mml:math id="MM157"><mml:mrow><mml:mi>q</mml:mi><mml:mo>≤</mml:mo><mml:mn>5</mml:mn><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula>) and with parcels that are located within the dorsal attention network (<inline-formula><mml:math id="MM158"><mml:mrow><mml:mi>q</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>).</p>
      <p>Inspecting the private modules, we observed large heterogeneity in their tendency to overlap with their core module parcels and in the number of time points. <xref ref-type="fig" rid="btv228-F5">Figure 5</xref>C and D shows the results for core module 4B. This module is of particular interest as it was enriched with both the default mode network and the frontoparietal control networks. Patterns of co-activation between these two networks have been reported before and suggested to support goal-directed thought processes (<xref rid="btv228-B28" ref-type="bibr">Spreng <italic>et al.</italic>, 2010</xref>). On average, each private module covered 44.4% of the core module parcels (<xref ref-type="fig" rid="btv228-F5">Fig. 5</xref>C) and contained 15.5 time points. In addition, in 18 out of 20 subjects, the overlap between the subject-specific parcels and the core module parcels was significant (hyper-geometric <italic>P</italic> &lt; 0.001). Other modules had much higher coverage. For example, core module 1B had mean coverage of 64.4% and a larger number of time points (mean 23), see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv228/-/DC1">Supplementary Figure 4</ext-link>.</p>
      <p>When including the private modules in the enrichment analysis, 15 out of 20 private modules of core module 4B were also enriched with the default mode network. The frontoparietal control network was identified in 12 of the 20 subjects. Although to a much lower extent than in the gene expression analysis, we also detected subject-specific signal. For example, ventral attention enrichment was identified in 4 out of 20 subjects but not in the core module. This suggests a tendency of these four subjects to engage in bottom-up processing (e.g. be more attentive to sensory stimuli) during goal-directed thought processes. These results demonstrate the advantage of our multi-subject analysis: it was able to detect large functional networks that reappear as activated across subjects and even highlight subject-specific activation patterns.</p>
    </sec>
    <sec id="SEC3.7">
      <title>3.7 Comparison to related algorithms</title>
      <p>Extant algorithms for three-way data analysis were mainly developed for gene expression data. Triclustering (<xref rid="btv228-B36" ref-type="bibr">Zhao and Zaki, 2005</xref>) assumes that a module is a subcube created by one subset in each of the three dimensions. This setting is too rigid for simultaneous analysis of responses in many patients. <xref ref-type="fig" rid="btv228-F4">Figures 4</xref> and <xref ref-type="fig" rid="btv228-F5">5</xref> show that our modules are not triclusters since the time points and gene set of each private module differ under the same core module. Another type of three-way analysis seeks biclusters <inline-formula><mml:math id="MM159"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>G</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>′</mml:mo><mml:mo>&gt;</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="MM160"><mml:mrow><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> is a set of genes and <inline-formula><mml:math id="MM161"><mml:mrow><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> is a set of subjects, such that all genes in <inline-formula><mml:math id="MM162"><mml:mrow><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> manifest a similar time response across all subjects in <inline-formula><mml:math id="MM163"><mml:mrow><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>. Two such algorithms are EDISA (<xref rid="btv228-B30" ref-type="bibr">Supper <italic>et al.</italic>, 2007</xref>), which seeks high correlation between subjects across time points, and the plaid model of <xref rid="btv228-B17" ref-type="bibr">Mankad and Michailidis (2014)</xref>, which extends (<xref rid="btv228-B13" ref-type="bibr">Lazzeroni and Owen, 2002</xref>) and seeks up- or down-regulated time responses. Finally, <xref rid="btv228-B11" ref-type="bibr">Gerber <italic>et al.</italic> (2007)</xref> simultaneously cluster tissues and genes to produce biclusters, while accounting for three possible time responses for each tissue when introduced to a drug. However, this analysis answers very different questions than TWIGS as it assumes a hierarchical structure of tissue clusters without overlap, whereas we analyze a single tissue over many time points at rest and allow overlapping core modules.</p>
      <p>We compared TWIGS to seven methods: ISA (<xref rid="btv228-B4" ref-type="bibr">Bergmann <italic>et al.</italic>, 2003</xref>), Bimax (<xref rid="btv228-B22" ref-type="bibr">Prelic <italic>et al.</italic>, 2006</xref>), SAMBA (<xref rid="btv228-B31" ref-type="bibr">Tanay <italic>et al.</italic>, 2004</xref>), EDISA (<xref rid="btv228-B30" ref-type="bibr">Supper <italic>et al.</italic>, 2007</xref>), the plaid model (<xref rid="btv228-B17" ref-type="bibr">Mankad and Michailidis, 2014</xref>), sliding window analysis of fMRI data (<xref rid="btv228-B1" ref-type="bibr">Allen <italic>et al.</italic>, 2014</xref>) and modularity analysis of fMRI data (<xref rid="btv228-B24" ref-type="bibr">Rubinov and Sporns, 2010</xref>, <xref rid="btv228-B25" ref-type="bibr">2011</xref>). For each method, we tested a wide range of its internal parameters to fine tune it for the tested dataset. The <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv228/-/DC1">Supplementary Text</ext-link> provides all details; here we give a brief overview.</p>
      <p>Our comparison shows that except for modularity analysis (which enforces using all subjects by the method’s definition), extant methods have difficulties in finding modules that cover many subjects. TWIGS provides an almost 2-fold improvement in the ability to find modules that cover many patients. For example, on average, modules identified by EDISA on the sepsis data covered less than five patients compared with nine by TWIGS. The sliding window analysis, which estimates the covariance matrix of each time window and then clusters all windows from all subjects, had an average coverage of less than 10 on the fMRI data, whereas TWIGS covered all 20 subjects. TWIGS was comparable to other methods in enrichment analysis for known biological functions in terms of: (i) the total number of covered functions, (ii) the strength of the detected enrichments and (iii) the fraction of modules with enriched terms. When consolidating scores 1–3 using non-parametric ranking, TWIGS ranked first.</p>
      <p>When applying the plaid model to the sepsis data, it tended to find much larger gene sets. However, these modules manifested a very mild up-regulation response compared with the TWIGS modules. The fMRI modularity analysis method of Rubinov and Sporns (<xref rid="btv228-B24" ref-type="bibr">2010</xref>, <xref rid="btv228-B25" ref-type="bibr">2011</xref>) partitioned the brain into clusters, each containing one of our core modules. TWIGS’s subject-specific module augmentations provided additional biological results.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We presented a novel problem formulation and algorithm for flexible three-way clustering of multi-matrix time course data. We defined a core module as (i) a set of rows that are likely to be active together across a set of subjects and (ii) a set of active time points in each covered subject. In addition, each core module has subject-specific private modules that can contain additional genes and have high overlap with the core module. The set of active time points of a module can vary in size and times among subjects.</p>
    <p>Our model is much more flexible than existing models. First, it allows different active time points for each subject, thereby accommodating heterogeneity and asynchrony in the response of different subjects. Second, different subjects can differ in their underlying features (rows) and time points (columns). The row set of a particular subject in a module does not necessarily cover all core module rows. This property was crucial in the analysis of fMRI data, where it allowed discovering core modules that better covered active brain regions. In addition, the row set of a private module can contain additional rows that represent subject-specific signal. This property was crucial in the gene expression case as it allowed discovering patient-specific up-regulated immune processes.</p>
    <p>We compared TWIGS to seven other methods and showed that extant methods have difficulties in finding modules that cover many subjects, whereas TWIGS easily finds modules that represent a biological function shared by many subjects. In addition, our method outperformed other methods in terms of enrichment analysis. We employed additional metrics for evaluation in each domain. Other comparison criteria can be used in the future, e.g. test-likelihood or perplexity.</p>
    <p>Our current analysis has some limitations that can be addressed by future studies. First, we assume that the data originated from two distributions <italic>f</italic><sub>0</sub> and <italic>f</italic><sub>1</sub>. Other approaches could be considered, such as row-based or column-based additive models (<xref rid="btv228-B13" ref-type="bibr">Lazzeroni and Owen, 2002</xref>). Second, our basic model deals with only a single module at a time. More complex models and algorithms could be proposed to directly model multiple modules. Finally, additional tests are needed to fully exploit the abilities of the model. For example, we focused only on testing a time window of size 1 to find homogenous highly activated private modules.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This study was supported in part by the <funding-source>Israel Science Foundation</funding-source> (grant <award-id>317/13</award-id>, to R.S.), the Azrieli Foundation Fellowship and the Edmond J. Safra Center for Bioinformatics at Tel Aviv University (to D.A.). Additional support was provided by the <funding-source>Israeli Centers of Research Excellence (I-COREs) Gene Regulation in Complex Human Disease, Center</funding-source> No. 41/11 (R.S.) and <funding-source>Program in the Cognitive Sciences</funding-source> (to T.H.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_12_i17__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btv228_Shamir34_Supplementary_Figures_and_Text.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btv228-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname><given-names>E.A.</given-names></name><etal/></person-group> (<year>2014</year>) 
<article-title>Tracking whole-brain connectivity dynamics in the resting state</article-title>. <source>Cereb. Cortex</source><italic>,</italic>
<volume>24</volume>, <fpage>663</fpage>–<lpage>676</lpage>.<pub-id pub-id-type="pmid">23146964</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Belliveau</surname><given-names>J.W.</given-names></name><etal/></person-group> (<year>1991</year>) 
<article-title>Functional mapping of the human visual cortex by magnetic resonance imaging</article-title>. <source>Science</source><italic>,</italic>
<volume>254</volume>, <fpage>716</fpage>–<lpage>719</lpage>.<pub-id pub-id-type="pmid">1948051</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ben-Dor</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2003</year>) 
<article-title>Discovering local structure in gene expression data: The order-preserving submatrix problem</article-title>. <source>J. Comput. Biol.</source><italic>,</italic>
<volume>10</volume>, <fpage>373</fpage>–<lpage>384</lpage>.<pub-id pub-id-type="pmid">12935334</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bergmann</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2003</year>) 
<article-title>Iterative signature algorithm for the analysis of large-scale gene expression data</article-title>. <source>Phys. Rev. E Stat. Nonlin. Soft Matter Phys.</source><italic>,</italic>
<volume>67</volume>, <fpage>031902</fpage>.<pub-id pub-id-type="pmid">12689096</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Birn</surname><given-names>R.M.</given-names></name></person-group> (<year>2012</year>) 
<article-title>The role of physiological noise in resting-state functional connectivity</article-title>. <source>Neuroimage</source><italic>,</italic>
<volume>62</volume>, <fpage>864</fpage>–<lpage>870</lpage>.<pub-id pub-id-type="pmid">22245341</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>Y.</given-names></name><name><surname>Church</surname><given-names>G.M.</given-names></name></person-group> (<year>2000</year>) 
<article-title>Biclustering of expression data</article-title>. <source>Proc. Int. Conf. Intell. Syst. Mol. Biol.</source><italic>,</italic>
<volume>8</volume>, <fpage>93</fpage>–<lpage>103</lpage>.<pub-id pub-id-type="pmid">10977070</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Craddock</surname><given-names>R.C.</given-names></name><etal/></person-group> (<year>2012</year>) 
<article-title>A whole brain fMRI atlas generated via spatially constrained spectral clustering</article-title>. <source>Hum. Brain Mapp.</source><italic>,</italic>
<volume>33</volume>, <fpage>1914</fpage>–<lpage>1928</lpage>.<pub-id pub-id-type="pmid">21769991</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B8">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dede</surname><given-names>D.</given-names></name><name><surname>Ogul</surname><given-names>H.</given-names></name></person-group> (<year>2013</year>) 
<article-title>A three-way clustering approach to cross-species gene regulation analysis</article-title>. In: <source>2013 IEEE International Symposium on Innovations in Intelligent Systems and Applications (INISTA)</source>, <comment>IEEE</comment>, pp. <fpage>1</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="btv228-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dosenbach</surname><given-names>N.U.F.</given-names></name><etal/></person-group> (<year>2007</year>) 
<article-title>Distinct brain networks for adaptive and stable task control in humans</article-title>. <source>Proc. Natl Acad. Sci. USA</source><italic>,</italic>
<volume>104</volume>, <fpage>11073</fpage>–<lpage>11078</lpage>.<pub-id pub-id-type="pmid">17576922</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fox</surname><given-names>M.D.</given-names></name><etal/></person-group> (<year>2006</year>) 
<article-title>Spontaneous neuronal activity distinguishes human dorsal and ventral attention systems</article-title>. <source>Proc. Natl Acad. Sci. USA</source><italic>,</italic>
<volume>103</volume>, <fpage>10046</fpage>–<lpage>10051</lpage>.<pub-id pub-id-type="pmid">16788060</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerber</surname><given-names>G.K.</given-names></name><etal/></person-group> (<year>2007</year>) 
<article-title>Automated discovery of functional generality of human gene expression programs</article-title>. <source>PLoS Comput. Biol.</source><italic>,</italic>
<volume>3</volume>, <fpage>1426</fpage>–<lpage>1440</lpage>.</mixed-citation>
    </ref>
    <ref id="btv228-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartigan</surname><given-names>J.A.</given-names></name></person-group> (<year>1972</year>) 
<article-title>Direct clustering of a data matrix</article-title>. <source>J. Am. Stat. Assoc.</source><italic>,</italic>
<volume>67</volume>, <fpage>123</fpage>–<lpage>129</lpage>.</mixed-citation>
    </ref>
    <ref id="btv228-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lazzeroni</surname><given-names>L.</given-names></name><name><surname>Owen</surname><given-names>A.</given-names></name></person-group> (<year>2002</year>) 
<article-title>Plaid models for gene expression data</article-title>. <source>Stat. Sin.</source><italic>,</italic>
<volume>12</volume>, <fpage>61</fpage>–<lpage>86</lpage>.</mixed-citation>
    </ref>
    <ref id="btv228-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>A.</given-names></name><name><surname>Tuck</surname><given-names>D.</given-names></name></person-group> (<year>2009</year>) 
<article-title>An effective tri-clustering algorithm combining expression data with gene regulation information</article-title>. <source>Gene Regul. Syst. Biol.</source><italic>,</italic>
<volume>3</volume>, <fpage>49</fpage>–<lpage>64</lpage>.</mixed-citation>
    </ref>
    <ref id="btv228-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Madeira</surname><given-names>S.C.</given-names></name><name><surname>Oliveira</surname><given-names>A.L.</given-names></name></person-group> (<year>2004</year>) 
<article-title>Biclustering algorithms for biological data analysis: a survey</article-title>. <source>IEEE-ACM Trans. Comput. Biol. Bioinform.</source><italic>,</italic>
<volume>1</volume>, <fpage>24</fpage>–<lpage>45</lpage>.</mixed-citation>
    </ref>
    <ref id="btv228-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maldjian</surname><given-names>J.A.</given-names></name><etal/></person-group> (<year>2003</year>) 
<article-title>An automated method for neuroanatomic and cytoarchitectonic atlas-based interrogation of fMRI data sets</article-title>. <source>Neuroimage</source>, <volume>19</volume>, <fpage>1233</fpage>–<lpage>1239</lpage>.<pub-id pub-id-type="pmid">12880848</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mankad</surname><given-names>S.</given-names></name><name><surname>Michailidis</surname><given-names>G.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Biclustering three-dimensional data arrays with plaid models</article-title>. <source>J. Comput. Graph. Stat.</source><italic>,</italic>
<volume>23</volume>, <fpage>943</fpage>–<lpage>965</lpage>.</mixed-citation>
    </ref>
    <ref id="btv228-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meng</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2009</year>) 
<article-title>Enrichment constrained time-dependent clustering analysis for finding meaningful temporal transcription modules</article-title>. <source>Bioinformatics</source><italic>,</italic>
<volume>25</volume>, <fpage>1521</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">19351618</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitra</surname><given-names>K.</given-names></name><etal/></person-group> (<year>2013</year>) 
<article-title>Integrative approaches for finding modular structure in biological networks</article-title>. <source>Nat. Rev. Genet.</source><italic>,</italic>
<volume>14</volume>, <fpage>719</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">24045689</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oghabian</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2014</year>) 
<article-title>Biclustering methods: biological relevance and application in gene expression analysis</article-title>. <source>PLoS One</source><italic>,</italic>
<volume>9</volume>, <fpage>e90801</fpage>.<pub-id pub-id-type="pmid">24651574</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parnell</surname><given-names>G.P.</given-names></name><etal/></person-group> (<year>2013</year>) 
<article-title>Identifying key regulatory genes in the whole blood of septic patients to monitor underlying immune dysfunctions</article-title>. <source>Shock</source><italic>,</italic>
<volume>40</volume>, <fpage>166</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">23807251</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prelic</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2006</year>) 
<article-title>A systematic comparison and evaluation of biclustering methods for gene expression data</article-title>. <source>Bioinformatics</source><italic>,</italic>
<volume>22</volume>, <fpage>1122</fpage>–<lpage>1129</lpage>.<pub-id pub-id-type="pmid">16500941</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rana</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2013</year>) 
<article-title>A toolbox for real-time subject-independent and subject-dependent classification of brain states from fMRI signals</article-title>. <source>Front. Neurosci.</source><italic>,</italic>
<volume>7</volume>, <fpage>170</fpage>.<pub-id pub-id-type="pmid">24151454</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubinov</surname><given-names>M.</given-names></name><name><surname>Sporns</surname><given-names>O.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Complex network measures of brain connectivity: uses and interpretations</article-title>. <source>NeuroImage</source><italic>,</italic>
<volume>52</volume>, <fpage>1059</fpage>–<lpage>1069</lpage>.<pub-id pub-id-type="pmid">19819337</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubinov</surname><given-names>M.</given-names></name><name><surname>Sporns</surname><given-names>O.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Weight-conserving characterization of complex functional brain networks</article-title>. <source>NeuroImage</source><italic>,</italic>
<volume>56</volume>, <fpage>2068</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">21459148</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Serin</surname><given-names>A.</given-names></name><name><surname>Vingron</surname><given-names>M.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Debi: discovering differentially expressed biclusters using a frequent itemset approach</article-title>. <source>Algorithms Mol. Biol.</source><italic>,</italic>
<volume>6</volume>, <fpage>18</fpage>.<pub-id pub-id-type="pmid">21699691</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shabalin</surname><given-names>A.A.</given-names></name><etal/></person-group> (<year>2009</year>) 
<article-title>Finding large average submatrices in high dimensional data</article-title>. <source>Ann. Appl. Stat.</source><italic>,</italic>
<volume>3</volume>, <fpage>985</fpage>–<lpage>1012</lpage>.</mixed-citation>
    </ref>
    <ref id="btv228-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spreng</surname><given-names>R.N.</given-names></name><etal/></person-group> (<year>2010</year>) 
<article-title>Default network activity, coupled with the frontoparietal control network, supports goal-directed cognition</article-title>. <source>NeuroImage</source><italic>,</italic>
<volume>53</volume>, <fpage>303</fpage>–<lpage>317</lpage>.<pub-id pub-id-type="pmid">20600998</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stamatakis</surname><given-names>E.A.</given-names></name><etal/></person-group> (<year>2010</year>) 
<article-title>Changes in resting neural connectivity during propofol sedation</article-title>. <source>PLoS One</source><italic>,</italic>
<volume>5</volume>, <fpage>e14224</fpage>.<pub-id pub-id-type="pmid">21151992</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Supper</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2007</year>) 
<article-title>EDISA: extracting biclusters from multiple time-series of gene expression profiles</article-title>. <source>BMC Bioinformatics</source><italic>,</italic>
<volume>8</volume>, <fpage>334</fpage>.<pub-id pub-id-type="pmid">17850657</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanay</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2004</year>) 
<article-title>Revealing modularity and organization in the yeast molecular network by integrated analysis of highly heterogeneous genomewide data</article-title>. <source>Proc. Natl Acad. Sci. USA</source><italic>,</italic>
<volume>101</volume>, <fpage>2981</fpage>–<lpage>2986</lpage>.<pub-id pub-id-type="pmid">14973197</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ulitsky</surname><given-names>I.</given-names></name><etal/></person-group> (<year>2010</year>) 
<article-title>Expander: from expression microarrays to networks and functions</article-title>. <source>Nat. Protoc.</source><italic>,</italic>
<volume>5</volume>, <fpage>303</fpage>–<lpage>322</lpage>.<pub-id pub-id-type="pmid">20134430</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vaisvaser</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2013</year>) 
<article-title>Neural traces of stress: cortisol related sustained enhancement of amygdala-hippocampal functional connectivity</article-title>. <source>Front. Hum. Neurosci.</source><italic>,</italic>
<volume>7</volume>, <fpage>313</fpage>.<pub-id pub-id-type="pmid">23847492</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waltman</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2010</year>) 
<article-title>Multi-species integrative biclustering</article-title>. <source>Genome Biol.</source><italic>,</italic>
<volume>11</volume>, <fpage>R96</fpage>.<pub-id pub-id-type="pmid">20920250</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeo</surname><given-names>B.T.T.</given-names></name><etal/></person-group> (<year>2011</year>) 
<article-title>The organization of the human cerebral cortex estimated by intrinsic functional connectivity</article-title>. <source>J. Neurophysiol.</source><italic>,</italic>
<volume>106</volume>, <fpage>1125</fpage>–<lpage>1165</lpage>.<pub-id pub-id-type="pmid">21653723</pub-id></mixed-citation>
    </ref>
    <ref id="btv228-B36">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>L.</given-names></name><name><surname>Zaki</surname><given-names>M.J.</given-names></name></person-group> (<year>2005</year>) 
<article-title>TriCluster: an effective algorithm for mining coherent clusters in 3d microarray data</article-title>. In: <person-group person-group-type="editor"><name><surname>Ozcan</surname><given-names>F.</given-names></name></person-group> (ed.), <source>Proceedings of the 2005 ACM SIGMOD International Conference on Management of Data</source>. 
<publisher-name>ACM Press</publisher-name>, 
<publisher-loc>Baltimore, MD, USA</publisher-loc>, pp. <fpage>694</fpage>–<lpage>705</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
