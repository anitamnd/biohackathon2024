<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3356847</article-id>
    <article-id pub-id-type="pmid">22539670</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bts196</article-id>
    <article-id pub-id-type="publisher-id">bts196</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RNA-SeQC: RNA-seq metrics for quality control and process optimization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>DeLuca</surname>
          <given-names>David S.</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Levin</surname>
          <given-names>Joshua Z.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sivachenko</surname>
          <given-names>Andrey</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fennell</surname>
          <given-names>Timothy</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nazaire</surname>
          <given-names>Marc-Danie</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Williams</surname>
          <given-names>Chris</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reich</surname>
          <given-names>Michael</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Winckler</surname>
          <given-names>Wendy</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Getz</surname>
          <given-names>Gad</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1">The Broad Institute of MIT and Harvard, Cambridge, MA, USA</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Ivo Hofacker</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>6</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>4</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>4</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>28</volume>
    <issue>11</issue>
    <fpage>1530</fpage>
    <lpage>1532</lpage>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>11</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>8</day>
        <month>3</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>4</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2012. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> RNA-seq, the application of next-generation sequencing to RNA, provides transcriptome-wide characterization of cellular activity. Assessment of sequencing performance and library quality is critical to the interpretation of RNA-seq data, yet few tools exist to address this issue. We introduce RNA-SeQC, a program which provides key measures of data quality. These metrics include yield, alignment and duplication rates; GC bias, rRNA content, regions of alignment (exon, intron and intragenic), continuity of coverage, 3′/5′ bias and count of detectable transcripts, among others. The software provides multi-sample evaluation of library construction protocols, input materials and other experimental parameters. The modularity of the software enables pipeline integration and the routine monitoring of key measures of data quality such as the number of alignable reads, duplication rates and rRNA contamination. RNA-SeQC allows investigators to make informed decisions about sample inclusion in downstream analysis. In summary, RNA-SeQC provides quality control measures critical to experiment design, process optimization and downstream computational analysis.</p>
      <p><bold>Availability and implementation:</bold> See <ext-link ext-link-type="uri" xlink:href="www.genepattern.org">www.genepattern.org</ext-link> to run online, or <ext-link ext-link-type="uri" xlink:href="www.broadinstitute.org/rna-seqc/">www.broadinstitute.org/rna-seqc/</ext-link> for a command line tool.</p>
      <p>
        <bold>Contact:</bold>
        <email>ddeluca@broadinstitute.org</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts196/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>RNA-seq is a highly parallelized sequencing technology that allows for comprehensive transcriptome characterization and quantification (<xref ref-type="bibr" rid="B9">Wang <italic>et al.</italic>, 2009</xref>). As with all forms of parallelized sequencing, significant computational processing is required to unlock transcript abundance levels and other measures for biological interpretation (<xref ref-type="bibr" rid="B1">Garber <italic>et al.</italic>, 2011</xref>). However, prior to the calculation of biologically relevant data such as transcript abundance, presence of novel isoforms and genotype identity, it is necessary to evaluate the performance of the RNA-seq experiment itself. Summary statistics and quality control scores provide insight into inherently complex data prior to downstream analysis.</p>
    <p>Here we present RNA-SeQC, a metrics tool with application to two domains: experiment design and process optimization; and quality control prior to computational analysis. Metrics such as duplication rate, rRNA abundance, alignment rates, coverage continuity and correlation to reference expression profiles are highly informative during selection of experiment conditions and library construction methods (<xref ref-type="bibr" rid="B3">Levin <italic>et al.</italic>, 2010</xref>). RNA-SeQC's multi-sample input feature allows for direct comparison across samples (<xref ref-type="fig" rid="F1">Fig. 1</xref>). Additionally, a single-sample mode can be used to monitor samples on an ongoing basis to rapidly assess the quality of a particular sequencing run, and to monitor and optimize these measures in production over time and prior to downstream analysis. RNA-SeQC provides a suite of experiment quality measures, many of which are currently not provided by other available tools (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts196/DC1">Supplementary Material</ext-link>).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Overview of the RNA-SeQC process. (<bold>a</bold>) RNA-SeQC will work with one or more input samples to produce both a comparative summary across samples as well as a more detailed report for each sample. (<bold>b</bold>) The comparative summary report includes an extensive range of metrics (in addition to those shown) as well as coverage plots. (<bold>c</bold>) For each sample, additional reports quantify the coverage profile (variation, gaps, etc.) for individual transcripts</p></caption><graphic xlink:href="bts196f1"/></fig></p>
  </sec>
  <sec id="SEC2">
    <title>2 METRICS</title>
    <p>RNA-SeQC provides three types of quality control metrics: <italic>Read Counts</italic>, <italic>Coverage</italic> and <italic>Correlation</italic>. A list and description of these metrics is shown below. RNA-SeQC is compatible with any alignment method that produces a specification-conforming BAM file (<xref ref-type="bibr" rid="B4">Li <italic>et al.</italic>, 2009</xref>), with flags properly set. For additional information, usage and software requirements, see the GenePattern help document provided as <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts196/DC1">Supplementary Material 1</ext-link>. Metrics reports are provided in HTML for human consumption, as well as tab-delimited text files for pipeline integration.</p>
    <sec id="SEC2.1">
      <title>2.1 Read counts</title>
      <p>The following metrics are generated by counting reads with particular characteristics. <italic>Rates</italic> are also provided, and are calculated as either <italic>per total reads</italic> or <italic>per aligned reads</italic>. Since the BAM format does support multiple alignments per read, this implementation ignores any read flagged as not being a primary alignment.
<list list-type="bullet"><list-item><p>Total, unique and duplicate reads</p></list-item><list-item><p>Mapped reads and mapped unique reads</p></list-item><list-item><p>rRNA reads: counted in one of two modes: (i) interval mode where an interval file defines the location in the given alignment to which rRNA reads map; and (ii) BWA mode, where an independent Burrows–Wheeler Aligner (<xref ref-type="bibr" rid="B4">Li and Durbin, 2009</xref>) alignment to reference rRNA sequences is performed.</p></list-item><list-item><p>Transcript-annotated reads: intragenic (regions between genes), intergenic (within genes), exonic and intronic. These regions are defined in a user-specified GTF file (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts196/DC1">Supplementary Material</ext-link>). GENCODE annotations (<xref ref-type="bibr" rid="B2">Harrow <italic>et al.</italic>, 2006</xref>) are used by default.</p></list-item><list-item><p>Expression profile efficiency: the ratio of exon-mapped reads to the total reads sequenced.</p></list-item><list-item><p>Expressed transcripts: count of transcripts with reads ≥1.</p></list-item><list-item><p>Strand specificity: to assess the performance of strand-specific library construction methods, the percentage of sense-derived reads is given for each end of the read pair. Whereas a non-strand-specific protocol would give values of 50%/50%, strand-specific protocols typically yield 99%/1% or 1%/99% for this metric.</p></list-item></list>
</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Coverage</title>
      <p>The following metrics are based on <italic>coverage</italic>: the number of reads that cover a given genomic position (in units of reads per base). RNA-SeQC quantifies the uniformity of coverage with several different metrics. To reflect the effect of expression level on these metrics, we select genes from three categories: low, middle and high expression genes (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts196/DC1">Supplementary Material</ext-link>) and also report the average of these metrics for each gene set.
<list list-type="bullet"><list-item><p>Mean coverage: the mean number of reads per base.</p></list-item><list-item><p>Mean coefficient of variation: the mean coefficient of variation across all transcripts.</p></list-item><list-item><p>5′/3′ Coverage: the mean per-base coverage for end regions of RNA transcripts. The length of the end region has a default value of 100 base pairs.</p></list-item><list-item><p>Gaps in coverage: a stretch of sequence of at least 5 base pairs having zero coverage. Both the number of gaps as well as the summed gap length across all transcripts in the set is reported.</p></list-item><list-item><p>Cumulative gap length: sum of gap lengths of all transcripts.</p></list-item><list-item><p>Downsampling: to normalize data to a specific total read count we enable an on-the-fly random reduction of reads to reach a user-defined number. This is useful for comparing certain statistics across datasets, e.g. gap metrics, which are not otherwise adjusted for depth.</p></list-item><list-item><p>GC bias: to assess effects of GC content on sequencing performance, all coverage metrics are additionally reported for three levels of transcript GC content: high, low and moderate (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/bts196/DC1">Supplementary Material</ext-link> for default threshold settings).</p></list-item><list-item><p>Coverage plots: plots of coverage level versus base index, either for a single transcript or a set of transcripts.</p></list-item></list>
</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Expression correlation</title>
      <p>One of the most valuable ways to interpret the performance of an RNA-seq run is to compare the measured expression levels to a reference (<xref ref-type="bibr" rid="B3">Levin <italic>et al.</italic>, 2010</xref>). RNA-SeQC provides RPKM-based estimation of expression levels (<xref ref-type="bibr" rid="B7">Mortazavi <italic>et al.</italic> 2008</xref>). When run with multiple samples, RNA-SeQC creates a matrix of correlations among all combinations, reporting the Spearman (rank based) and Pearson (quantity based) correlation coefficients. Optionally, an array based or RNA-seq reference expression profile can be provided for the correlation analysis. Correlation metrics are also provided for the different GC content stratifications to measure GC bias.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 IMPLEMENTATION</title>
    <p>Implemented in Java, RNA-SeQC is platform independent and requires no installation. For investigators who prefer a web interface to a command-line tool, this software can be run using the GenePattern web interface found at <ext-link ext-link-type="uri" xlink:href="http://www.GenePattern.org">http://www.GenePattern.org</ext-link> (<xref ref-type="bibr" rid="B8">Reich <italic>et al.</italic>, 2006</xref>).</p>
    <p>Within the RNA-SeQC software package, Read Count metrics were implemented by inheriting from the <italic>ReadWalker</italic> class of the GATK software package (<xref ref-type="bibr" rid="B6">McKenna <italic>et al.</italic>, 2010</xref>). Transcript annotations are bound to the walker in the RefGen format. This format is created on-the-fly from a user-provided GTF file. The program is designed to support the minimal GTF specification, but the GTF format used by GENCODE (<xref ref-type="bibr" rid="B2">Harrow <italic>et al.</italic>, 2006</xref>) is recommended. For continuity of coverage calculations, the GATK's Depth of Coverage walker was used to calculate the number of bases at a given position in the genomic alignment. Finally, ribosomal RNA quantification is performed by realigning all reads to rRNA reference sequences using the Burrows–Wheeler Aligner (<xref ref-type="bibr" rid="B4">Li and Durbin, 2009</xref>).</p>
    <p><italic>Funding</italic>: Funded in part with Federal funds from the <funding-source>National Human Genome Research Institute</funding-source>, <funding-source>National Institutes of Health</funding-source>, <funding-source>Department of Health and Human</funding-source> under Contract No. <award-id>HHSN268201000029C</award-id>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_28_11_1530__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_bts196_Supplement-Tool_Comparison.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_bts196_Supplement-RNA-SeQC_GenePatternHelpFile_v1_1_2.doc"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garber</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational methods for transcriptome annotation and quantification using RNA-seq</article-title>
        <source>Nat. Meth.</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>469</fpage>
        <lpage>477</lpage>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrow</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GENCODE: producing a reference annotation for ENCODE</article-title>
        <source>Genome Biol.</source>
        <year>2006</year>
        <volume>7</volume>
        <issue>Suppl. 1</issue>
        <fpage>S4.1</fpage>
        <lpage>S4.9</lpage>
        <pub-id pub-id-type="pmid">16925838</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levin</surname>
            <given-names>J.Z.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive comparative analysis of strand-specific RNA sequencing methods</article-title>
        <source>Nat. Meth.</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>709</fpage>
        <lpage>715</lpage>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map (SAM) format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res.</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>
        <source>Nat. Meth.</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reich</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GenePattern 2.0</article-title>
        <source>Nat. Genet.</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>500</fpage>
        <lpage>501</lpage>
        <pub-id pub-id-type="pmid">16642009</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
