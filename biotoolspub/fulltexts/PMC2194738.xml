<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2194738</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-8-419</article-id>
    <article-id pub-id-type="pmid">17963529</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-8-419</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A dynamic programming approach for the alignment of signal peaks in multiple gas chromatography-mass spectrometry experiments</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Robinson</surname>
          <given-names>Mark D</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>mrobinson@wehi.edu.au</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>De Souza</surname>
          <given-names>David P</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>d.desouza@pgrad.unimelb.edu.au</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Keen</surname>
          <given-names>Woon Wai</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>wwoon@csse.unimelb.edu.au</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Saunders</surname>
          <given-names>Eleanor C</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>e.saunders@pgrad.unimelb.edu.au</email>
      </contrib>
      <contrib id="A5" contrib-type="author">
        <name>
          <surname>McConville</surname>
          <given-names>Malcolm J</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>malcolmm@unimelb.edu.au</email>
      </contrib>
      <contrib id="A6" contrib-type="author">
        <name>
          <surname>Speed</surname>
          <given-names>Terence P</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I5">5</xref>
        <email>terry@wehi.edu.au</email>
      </contrib>
      <contrib id="A7" corresp="yes" contrib-type="author">
        <name>
          <surname>Likić</surname>
          <given-names>Vladimir A</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>vlikic@unimelb.edu.au</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>The Walter and Eliza Hall Institute of Medical Research, 1G Royal Parade, Parkville, VIC 3050, Australia</aff>
    <aff id="I2"><label>2</label>Department of Medical Biology, University of Melbourne, Parkville, VIC 3010, Australia</aff>
    <aff id="I3"><label>3</label>Department of Biochemistry and Molecular Biology, Bio21 Molecular Science and Biotechnology Institute, University of Melbourne, Royal Parade, Parkville, VIC, 3010, Australia</aff>
    <aff id="I4"><label>4</label>Bio21 Molecular Science and Biotechnology Institute, University of Melbourne, Royal Parade, Parkville, 3010, Australia</aff>
    <aff id="I5"><label>5</label>Department of Statistics, University of California, Berkeley, CA 94720-3860, USA</aff>
    <pub-date pub-type="collection">
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>10</month>
      <year>2007</year>
    </pub-date>
    <volume>8</volume>
    <fpage>419</fpage>
    <lpage>419</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/8/419"/>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>5</month>
        <year>2007</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>10</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2007 Robinson et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2007</copyright-year>
      <copyright-holder>Robinson et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Robinson
               D
               Mark
               
               
               mrobinson@wehi.edu.au
            </dc:author><dc:title>
            A dynamic programming approach for the alignment of signal peaks in multiple gas chromatography-mass spectrometry experiments
         </dc:title><dc:date>2007</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 8(1): 419-. (2007)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2007)8:1&#x0003c;419&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Gas chromatography-mass spectrometry (GC-MS) is a robust platform for the profiling of certain classes of small molecules in biological samples. When multiple samples are profiled, including replicates of the same sample and/or different sample states, one needs to account for retention time drifts between experiments. This can be achieved either by the alignment of chromatographic profiles prior to peak detection, or by matching signal peaks after they have been extracted from chromatogram data matrices. Automated retention time correction is particularly important in non-targeted profiling studies.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>A new approach for matching signal peaks based on dynamic programming is presented. The proposed approach relies on both peak retention times and mass spectra. The alignment of more than two peak lists involves three steps: (1) all possible pairs of peak lists are aligned, and similarity of each pair of peak lists is estimated; (2) the guide tree is built based on the similarity between the peak lists; (3) peak lists are progressively aligned starting with the two most similar peak lists, following the guide tree until all peak lists are exhausted. When two or more experiments are performed on different sample states and each consisting of multiple replicates, peak lists within each set of replicate experiments are aligned first (within-state alignment), and subsequently the resulting alignments are aligned themselves (between-state alignment). When more than two sets of replicate experiments are present, the between-state alignment also employs the guide tree. We demonstrate the usefulness of this approach on GC-MS metabolic profiling experiments acquired on wild-type and mutant <italic>Leishmania mexicana </italic>parasites.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>We propose a progressive method to match signal peaks across multiple GC-MS experiments based on dynamic programming. A sensitive peak similarity function is proposed to balance peak retention time and peak mass spectra similarities. This approach can produce the optimal alignment between an arbitrary number of peak lists, and models explicitly within-state and between-state peak alignment. The accuracy of the proposed method was close to the accuracy of manually-curated peak matching, which required tens of man-hours for the analyzed data sets. The proposed approach may offer significant advantages for processing of high-throughput metabolomics data, especially when large numbers of experimental replicates and multiple sample states are analyzed.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Metabolomics refers to an all-inclusive profiling of low-molecular weight metabolites with an implicit aim to interpret results in the context of the organism's genome and its global metabolic network [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B4">4</xref>]. The term metabolic profiling is used to denote either targeted or non-targeted profiling of small molecules in biological samples. A targeted analysis focuses on specific, <italic>a priori </italic>known compounds, and therefore only parts of the chromatogram data matrix generated by the instrument may be considered relevant. In a non-targeted approach all detectable signals are analyzed, and the aim of such analysis is to achieve as wide coverage of metabolites as permitted by a particular experimental technique. A non-targeted metabolic profiling is an essential component of metabolomics, together with bioinformatics approaches for data analysis, interpretation, and integration [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B4">4</xref>]. In recent years metabolic profiling is increasingly being used in studies of microbial metabolism [<xref ref-type="bibr" rid="B5">5</xref>], biomarker discovery [<xref ref-type="bibr" rid="B6">6</xref>], toxicology [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>], nutrition [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B10">10</xref>], and integrated systems biology [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. Hyphenated mass spectrometry approaches, in particular gas chromatography-mass spectrometry (GC-MS) [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>] and liquid chromatography-mass spectrometry (LC-MS) [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B14">14</xref>], are often used for metabolic profiling because of their inherent robustness, sensitivity, and large dynamic range.</p>
    <p>GC-MS is particularly well suited for studies of low polarity metabolites with high sensitivity and specificity [<xref ref-type="bibr" rid="B15">15</xref>]. The processing of GC-MS data is based on the detection of chromatogram signal peaks, a step performed either with proprietary software or with freely available software such as AMDIS [<xref ref-type="bibr" rid="B16">16</xref>]. The net result of peak detection is a set of signal peaks that represent components present in the sample. Metabolic profiling experiments are relatively rapid, and typically multiple replicates per sample state are recorded to facilitate robust statistical analyses [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B13">13</xref>].</p>
    <p>In order to compare multiple samples, one needs to account for retention time drifts inherent in chromatographic separations [<xref ref-type="bibr" rid="B17">17</xref>-<xref ref-type="bibr" rid="B23">23</xref>]. The retention time drifts arise because of instrument imperfections (variations in temperature and mobile phase flow rates), column variations (stationary phase saturation and degradation, and stationary phase variations in column-to-column runs), and sample matrix effects (due to variations in sample composition, such as solvent and salts) [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B18">18</xref>]. A review of the literature shows that there is a pressing need for better algorithms for retention time correction in GC-MS small molecule profiling experiments. A summary of approaches used in the past for correcting retention time drifts in hyphenated mass spectrometry experiments is given in Figure <xref ref-type="fig" rid="F1">1</xref>. An approach often used to correct retention time drifts in practice is a linear correction calculated based on deviations from internal standards [<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B25">25</xref>]. This approach has several limitations [<xref ref-type="bibr" rid="B21">21</xref>]. For example, addition of internal standards adds new chemicals to the sample, and chromatographic retention time drifts are not linear (Figure <xref ref-type="fig" rid="F2">2</xref> and [<xref ref-type="bibr" rid="B21">21</xref>]).</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>An overview of methods for retention time correction in hyphenated mass spectrometry profiling experiments</bold>. A technique often used in retention time correction involves spiking internal standards prior to data acquisition, and then linear time correction is applied manually, based on user selected markers [24, 25]. This approach has significant limitations, as discussed in [21]. The automated approaches for retention time correction in hyphenated mass spectrometry are based on two schools of thought: one is to align the entire chromatographic profiles prior to peak detection (profile alignment), and the other is to perform peak detection first, and then match extracted signal peaks across samples to correct for retention time drifts (peak matching). In either approach one can rely on the time domain data only, or include the information from the m/z data domain (mass spectra). Examples of peak matching algorithms that use retention time only (branch 1) include [18, 19, 22]; examples of peak matching algorithms that use both time domain and m/z data (branch 2) include [20, 21, 23]; algorithms for profile alignment that rely on time domain data only (branch 3) were first proposed in 1979 [39], and include [17, 26, 28, 29]; finally, examples of algorithms for profile alignment that use the entire chromatogram data matrices include [27, 30, 37]. The algorithm proposed here is a peak matching approach, and relies on both time domain data and peak mass spectra (branch 2).</p>
      </caption>
      <graphic xlink:href="1471-2105-8-419-1"/>
    </fig>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p><bold>GC-MS total ion chromatograms showing non-linear time shifts</bold>. A portion of two GC-MS total ion chromatograms (TICs) of polar extracts of <italic>L. mexicana </italic>promastigotes harvested in the mid-log growth phase (solid line) and stationary growth phase (dotted lines). The overlay of raw TICs for the segment between 360 s and 540 s shows non-linear shifts in chromatographic separation often observed in practice.</p>
      </caption>
      <graphic xlink:href="1471-2105-8-419-2"/>
    </fig>
    <p>The problem of retention time correction is similar in GC-MS and LC-MS small molecule profiling experiments. There are two schools of thought on how to address this: one is to align entire chromatogram profiles prior to peak detection (profile alignment) [<xref ref-type="bibr" rid="B26">26</xref>-<xref ref-type="bibr" rid="B30">30</xref>], and the other is to perform peak detection first, and then align extracted signal peaks to correct for retention time drifts (peak alignment or peak matching) [<xref ref-type="bibr" rid="B18">18</xref>-<xref ref-type="bibr" rid="B23">23</xref>]. In either approach one can rely on the time domain data only, or include highly selective information from the m/z data domain (mass spectra).</p>
    <p>Both peak matching and profile alignment methods have been used in the context of GC-MS data. Jonsson and co-authors have developed a strategy for rapid comparison of GC-MS metabolic profiles, based on the division of a chromatogram into time windows [<xref ref-type="bibr" rid="B28">28</xref>]. To correct the retention time drifts they relied on finding the maximum covariance between the chromatograms [<xref ref-type="bibr" rid="B17">17</xref>]. This is a profile alignment method that uses the time domain data only (Figure <xref ref-type="fig" rid="F1">1</xref>, branch 3). To be effective this method requires that chromatographic profiles to be aligned are similar to one another, as was the case in the analysis of leaf plant extracts where the main purpose of the alignment was to facilitate setting of time domain windows [<xref ref-type="bibr" rid="B28">28</xref>]. A different alignment approach was used in the analysis of GC-MS data obtained from the profiling of tomato volatiles, but the algorithm was not described in detail [<xref ref-type="bibr" rid="B31">31</xref>].</p>
    <p>The peak matching approach is an alternative to the profile alignment that has received a considerable attention in GC-MS [<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B22">22</xref>]. Johnson et al. matched GC-MS peaks by retention time within a pre-defined time window [<xref ref-type="bibr" rid="B18">18</xref>]. Although this approach was shown to be reasonably effective in the GC-MS analysis of diesel fuels, much remains to be desired for applications in biomedical research. For example, it is unclear how to choose the target-chromatogram to which other chromatograms will be aligned; the choice of the cut-off window is arbitrary; and the proposed method of grouping the peaks depends on the order in which the grouping is performed. Duran and co-workers proposed a clustering procedure which groups peaks starting from the minimum retention time [<xref ref-type="bibr" rid="B19">19</xref>]. This approach is symmetrical with respect to all experiments and therefore alleviates the need for an arbitrary choice of a target chromatogram. However, the proposed clustering depends on the peak minimum retention time and the arbitrary retention time window [<xref ref-type="bibr" rid="B19">19</xref>]. We have attempted to improve on the peak clustering idea by using hierarchical clustering [<xref ref-type="bibr" rid="B22">22</xref>]. However, applications of this method have shown that results are rather sensitive to the quality of input data, especially for large retention time drifts. In summary, the body of work on peak matching suggests that accurate peak alignment is unlikely to be achieved by relying on retention time data only.</p>
    <p>The most accurate retention time correction is likely to be achieved when complete chromatogram data matrices are utilized. Such methods have been applied to LC-MS [<xref ref-type="bibr" rid="B27">27</xref>] and CE-MS [<xref ref-type="bibr" rid="B30">30</xref>] metabolic profiling data. The main drawback of any approach that works with entire chromatogram data matrices is the large amount of (uninformative) noise data that must be handled, which dramatically increases computational costs. Our preliminary calculations showed that progressive alignment of chromatogram matrices aimed to avoid the choice of a "target" data set is computationally prohibitive. Furthermore, it is an open question whether the computational costs can be justified by the potential increase in accuracy compared to peak matching methods, when peak matching is based on both retention times and mass spectra.</p>
    <p>The most advanced approaches for correction of retention time drifts have been developed on LC-MS and CE-MS data [<xref ref-type="bibr" rid="B20">20</xref>,<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B27">27</xref>,<xref ref-type="bibr" rid="B30">30</xref>]. To our knowledge the peak matching involving mass spectra has not been applied to GC-MS data, except in an approach proposed for a systematic identification of conserved metabolites [<xref ref-type="bibr" rid="B23">23</xref>]. This approach aims specifically at identification of conserved metabolites across experiments, and its peak matching is implicitly serving as input for a motif discovery algorithm [<xref ref-type="bibr" rid="B23">23</xref>].</p>
    <p>Here we present an approach for peak matching that relies on both peak retention times and mass spectra, capable of accurate alignment of peak lists from a large number of replicate GC-MS experiments. We use dynamic programming to arrive at the optimal solution to the global alignment problem. Dynamic programming was previously used for the alignment of chromatogram data matrices [<xref ref-type="bibr" rid="B27">27</xref>,<xref ref-type="bibr" rid="B30">30</xref>], but not in peak matching. The proposed approach uses a similarity function which balances effectively similarity in peak retention times with the similarity in mass spectra, mimicking the way an experienced human operator performs peak matching. The proposed algorithm is modelled after the heuristic solution for multiple sequence alignment [<xref ref-type="bibr" rid="B32">32</xref>,<xref ref-type="bibr" rid="B33">33</xref>], and relies on progressive alignment to match an arbitrary number of data sets. We apply this approach to GC-MS metabolic profiling data acquired on wild-type and mutant <italic>Leishmania mexicana </italic>parasites. In the absence of a suitable metric and an accepted benchmark for the peak alignment algorithms, we quantify absolute errors relative to manually derived "true" answer. We show that (<italic>a</italic>) the proposed method performed close to the accuracy of the manually curated alignments by an expert operator; (<italic>b</italic>) the results are not sensitive to the input parameters, suggesting that the proposed method is robust.</p>
  </sec>
  <sec>
    <title>Results</title>
    <p>The input for the peak alignment procedure consists of two or more peak lists obtained from hyphenated mass spectrometry experiments (GC-MS data used in this work). These peak lists may be derived from replicate analyses of the same sample (for example, polar extracts from wild-type parasites), or replicate analyses of different samples (for example, polar metabolite extracts of wild-type and mutant parasite lines).</p>
    <p>Each experiment is represented by a single and unique peak list. In the most general case, a peak list could be understood as a list of peak objects, where each peak object is characterized with one or more attributes. In the work described here, a peak was characterized with a unique peak ID, the retention time at the peak apex, and the mass spectrum at the peak apex. Henceforth, we assume that a peak list consists of peaks ordered by their retention time. Consider a peak list L<sub>A </sub>that contains peaks <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-8-419-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aqatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGWbaCdaWgaaWcbaGaeGymaedabeaakiabcYcaSiabdchaWnaaBaaaleaacqaIYaGmaeqaaOGaeiilaWIaeiOla4IaeiOla4IaeiOla4IaeiilaWIaemiCaa3aaSbaaSqaaiabd6gaUnaaBaaameaacqWGbbqqaeqaaaWcbeaaaaa@3B56@</mml:annotation></mml:semantics></mml:math></inline-formula>. In this case the retention time of the peak p<sub>2 </sub>is greater than that of p<sub>1</sub>, the retention time of the peak p<sub>3 </sub>is greater than that of p<sub>2</sub>, and so on.</p>
    <sec>
      <title>Alignment of two peak lists</title>
      <p>Consider two peak lists <italic>L</italic><sub><italic>A </italic></sub>= [<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-8-419-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aqatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGWbaCdaWgaaWcbaGaeGymaedabeaakiabcYcaSiabdchaWnaaBaaaleaacqaIYaGmaeqaaOGaeiilaWIaeiOla4IaeiOla4IaeiOla4IaeiilaWIaemiCaa3aaSbaaSqaaiabd6gaUnaaBaaameaacqWGbbqqaeqaaaWcbeaaaaa@3B56@</mml:annotation></mml:semantics></mml:math></inline-formula>] and <italic>L</italic><sub><italic>B </italic></sub>= [<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-8-419-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aqatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGXbqCdaWgaaWcbaGaeGymaedabeaakiabcYcaSiabdghaXnaaBaaaleaacqaIYaGmaeqaaOGaeiilaWIaeiOla4IaeiOla4IaeiOla4IaeiilaWIaemyCae3aaSbaaSqaaiabd6gaUnaaBaaameaacqWGcbGqaeqaaaWcbeaaaaa@3B5E@</mml:annotation></mml:semantics></mml:math></inline-formula>] which contain a total number of n<sub>A </sub>and n<sub>B </sub>peaks, respectively. The alignment of the peak lists L<sub>A </sub>and L<sub>B </sub>refers to the establishment of a one-to-one correspondence between the peaks from the two lists, with the possibility that any peak from one list has no matching peak in the other list. The alignment between the peak lists L<sub>A </sub>and L<sub>B </sub>could be represented as a list of peak pairs, where pairing implies peak-to-peak matching. For example,</p>
      <p>
        <disp-formula id="bmcM1">[(p<sub>1</sub>, q<sub>1</sub>), (p<sub>2</sub>, q<sub>2</sub>), (p<sub>3</sub>, -), (p<sub>4</sub>, q<sub>3</sub>), ...]</disp-formula>
      </p>
      <p>where p<sub>1 </sub>is matched with q<sub>1</sub>, p<sub>2 </sub>is matched with q<sub>2</sub>, and so on. The peak p<sub>3 </sub>from the list L<sub>A </sub>does not have a matching peak in the L<sub>B </sub>list. The number of elements in the above list will depend on the optimal alignment, but cannot be less than the larger of A and B, and cannot exceed A+B. For brevity, we refer to the alignment between peak lists L<sub>A </sub>and L<sub>B </sub>as L<sub>A</sub>:L<sub>B</sub>.</p>
      <p>It is apparent from the above that the alignment of two peak lists closely resembles the problem of pairwise sequence alignment. The situation for p<sub>3 </sub>in Equation [<xref ref-type="bibr" rid="B1">1</xref>] corresponds to matching a sequence letter to a gap. Furthermore, the analogy can be extended even further if one considers that the peak list is an ordered sequence of peaks. The variations in peak retention times arise from various non-linear effects during the separation stage, such as uneven flow of the carrier phase in the GC or LC column. Such perturbations may affect absolute peak retention times and may shift portions of the chromatogram in a non-linear manner [<xref ref-type="bibr" rid="B21">21</xref>], but normally do not change the order of peaks in terms of their retention times. The analogy with pairwise sequence alignment implies that dynamic programming could be applied to find the optimal alignment of two peak lists, provided that a suitable scoring scheme can be devised.</p>
    </sec>
    <sec>
      <title>The scoring scheme for peak alignment</title>
      <p>In sequence alignment, the cost function for matching two residue letters is obtained from a pre-computed substitution matrix. In the case of peak lists the cost function should reflect similarity between two peaks (henceforth referred to as the peak similarity function). Since the peak mass-spectrum is a key identifier of a particular peak, the peak similarity function should depend heavily on the similarity in the mass spectra. We propose the following peak similarity function P(i,j), which gives the similarity between the peaks i and j:</p>
      <p>
        <disp-formula id="bmcM2">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-8-419-i3" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mi>S</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>⋅</mml:mo>
                <mml:mi>exp</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:msup>
                          <mml:mi>D</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGqbaucqGGOaakcqWGPbqAcqGGSaalcqWGQbGAcqGGPaqkcqGH9aqpcqWGtbWucqGGOaakcqWGPbqAcqGGSaalcqWGQbGAcqGGPaqkcqGHflY1cyGGLbqzcqGG4baEcqGGWbaCdaqadaqaaiabgkHiTmaalaaabaGaeiikaGIaemiDaq3aaSbaaSqaaiabdMgaPbqabaGccqGHsislcqWG0baDdaWgaaWcbaGaemOAaOgabeaakiabcMcaPmaaCaaaleqabaGaeGOmaidaaaGcbaGaeGOmaiJaemiraq0aaWbaaSqabeaacqaIYaGmaaaaaaGccaGLOaGaayzkaaaaaa@509C@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>In the above equation S(i,j) is the similarity between the mass spectra of the peaks i and j, t<sub>i </sub>and t<sub>j </sub>are retention times of peaks i and j, and D is the retention time tolerance parameter which determines the importance of retention times to the overall peak similarity score. The function S(i,j) can be any function that returns a measure of the similarity in m/z ions detected in mass spectra of the peaks i and j. In our test implementation, S(i,j) was calculated as the cosine of the angle between the two mass spectra vectors (i.e. the normalized dot product). This resulted in values between 0 and 1: when the two mass spectra are identical S(i,j) = 1, and when they are completely dissimilar S(i,j) = 0.</p>
      <p>The second term in the equation [<xref ref-type="bibr" rid="B2">2</xref>] modulates the similarity in mass spectra. When two peaks have identical retention times (t<sub>i </sub>= t<sub>j</sub>) this term equals one, and the peak similarity reduces to the mass spectra similarity (P(i,j) = S(i,j)). When the retention times of the two peaks differ, then exp[-(t<sub>i </sub>- t<sub>j</sub>)<sup>2</sup>/2D<sup>2</sup>] &lt; 1, and P(i,j) &lt; S(i,j). The greater the retention time difference the peak similarity P(i,j) is more reduced relative to the mass spectra similarity S(i,j). The extent of this reduction depends on the relationship between the difference (t<sub>i </sub>- t<sub>j</sub>) and the parameter D. When (t<sub>i </sub>- t<sub>j</sub>) &gt;&gt; D then exp[-(t<sub>i </sub>- t<sub>j</sub>)<sup>2</sup>/2D<sup>2</sup>] will be close to zero and peak similarity will be close to zero (P(i,j) = 0), even if mass spectra are identical (S(i,j) = 1).</p>
      <p>The peak similarity function gives the "cost" of matching any two peaks. In addition to this, the dynamic programming algorithm requires a gap penalty to be defined. In sequence alignment gaps are treated with the affine gap function, designed to penalize gaps and to favor the extension of existing gaps over the creation of new gaps. In peak alignment favoring gap extensions is not physically justified, therefore, we set the gap penalty to a fixed number (G). With the above definition of P(i,j) (equation [<xref ref-type="bibr" rid="B2">2</xref>]) the meaningful range of G is between 0 and 1. A low value of G would favor the insertion of gaps even when peaks are originating from the same chemical compound; a high value of G would favour the alignment of peaks that are actually different.</p>
      <p>With the above definitions for the peak similarity function and the choice of gap penalty it is possible to deploy dynamic programming to find the global solution to the problem of optimal alignment of two peak lists. A standard dynamic programming procedure involves the following steps: (1) initialization of a two dimensional score matrix whose rows are indexed with the peaks of one peak list and columns are indexed with the peaks of the other peak list; (2) filling the cells of the score matrix based on the peak similarity function and possibly the gap penalty; (3) the best alignment between two peak lists is deduced from the traceback on the score matrix. We note that the pairwise alignment of two peak lists is analogous to the problem of global sequence alignment [<xref ref-type="bibr" rid="B34">34</xref>].</p>
      <p>An example pairwise alignment is shown in Figure <xref ref-type="fig" rid="F3">3</xref>. Figure <xref ref-type="fig" rid="F3">3(a)</xref> shows TIC segments between 467 s and 534 s for two GC-MS profiling experiments of <italic>L. mexicana </italic>promastigotes harvested in logarithmic and stationary growth phases, respectively. Peak finding has resulted in fourteen peaks in each segment as shown in Figure <xref ref-type="fig" rid="F3">3(b)</xref>, which also shows the peak matching after the alignment. Figure <xref ref-type="fig" rid="F4">4</xref> shows different score matrices and the traceback used to deduce the optimal alignment.</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>An example total ion chromatogram alignment</bold>. Panel a. Detail of the segment between 467 s and 534 s of the TICs showed in Figure 1. Fourteen signal peaks were detected in each segment. Panel b. The peak matching after dynamic programming peak alignment (see also Figure 4).</p>
        </caption>
        <graphic xlink:href="1471-2105-8-419-3"/>
      </fig>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>The score matrix for dynamic programming peak alignment</bold>. The score matrices for the alignment of two peak lists obtained from the GC-MS segments shown in Figure 3. Three matrices are shown with peak similarity (color coding is according to the scale between 0 and 1). For each score matrix the two axis refer to two peak lists to be aligned, with 14 signal peaks in each list (stationary phase peaks plotted along the x-axis and mid-log phase peaks plotted on the y-axis). The top panel shows the score matrix based on the retention time similarities only (as given the second term in the Equation [2]). The middle panel shows the score matrix based on the similarities in mass spectra taken at the peak apex (as given by the first term in the Equation [2]). The bottom panel is the total peak similarity function, as given by the Equation [2] (this is element-by-element product of the retention time and mass spectra score matrices). The traceback resulting from the application of dynamic programming is also shown in bottom panel. From the traceback the best alignment of peaks was deduced, as shown in Figure 3(b).</p>
        </caption>
        <graphic xlink:href="1471-2105-8-419-4"/>
      </fig>
    </sec>
    <sec>
      <title>Alignment of two alignments</title>
      <p>Consider an alignment between two internally fixed alignments: one consisting of N peak lists (henceforth referred to as N-alignment) and the other consisting of M peak lists (M-alignment). In order to find the best alignment between two such alignments with two-dimensional dynamic programming the scoring scheme must be extended.</p>
      <p>Let the N-alignment contain K peak positions and the M-alignment contain L peak positions. In this case the score matrix may have rows indexed by the peak positions of the N-alignment, and columns indexed by the peak positions of the M-alignment, resulting in a two dimensional table with K rows and L columns. During the dynamic programming procedure the cell (i,j) of this table is filled with the score W(i,j) calculated for the i-th position of the N-alignment and the j-th position of the M-alignment, possibly modified by the gap penalty G. Alternative definitions of W(i,j) are possible. In our test implementation W(i,j) was calculated as the average similarity between the peaks in the i-th position of the M-alignment and j-th position of the N-alignment. For example, if the position i of the N-alignment contained peaks p<sub>i1</sub>, p<sub>i2</sub>,... p<sub>iN </sub>and the position j or the M-alignment contained peaks q<sub>j1</sub>, q<sub>j2</sub>,... q<sub>jM </sub>then:</p>
      <p>
        <disp-formula id="bmcM3">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-8-419-i4" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mi>W</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>b</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mi>M</mml:mi>
                          </mml:munderover>
                          <mml:mrow>
                            <mml:mi>P</mml:mi>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mi>p</mml:mi>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>a</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>,</mml:mo>
                            <mml:msub>
                              <mml:mi>q</mml:mi>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                                <mml:mi>b</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>b</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mi>M</mml:mi>
                          </mml:munderover>
                          <mml:mrow>
                            <mml:mi>I</mml:mi>
                            <mml:mo stretchy="false">[</mml:mo>
                            <mml:mi>P</mml:mi>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mi>p</mml:mi>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>a</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>,</mml:mo>
                            <mml:msub>
                              <mml:mi>q</mml:mi>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                                <mml:mi>b</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mo>&gt;</mml:mo>
                            <mml:mn>0</mml:mn>
                            <mml:mo stretchy="false">]</mml:mo>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGxbWvcqGGOaakcqWGPbqAcqGGSaalcqWGQbGAcqGGPaqkcqGH9aqpdaWcaaqaamaaqahabaWaaabCaeaacqWGqbaucqGGOaakcqWGWbaCdaWgaaWcbaGaemyAaKMaemyyaegabeaakiabcYcaSiabdghaXnaaBaaaleaacqWGQbGAcqWGIbGyaeqaaOGaeiykaKcaleaacqWGIbGycqGH9aqpcqaIXaqmaeaacqWGnbqta0GaeyyeIuoaaSqaaiabdggaHjabg2da9iabigdaXaqaaiabd6eaobqdcqGHris5aaGcbaWaaabCaeaadaaeWbqaaiabdMeajjabcUfaBjabdcfaqjabcIcaOiabdchaWnaaBaaaleaacqWGPbqAcqWGHbqyaeqaaOGaeiilaWIaemyCae3aaSbaaSqaaiabdQgaQjabdkgaIbqabaGccqGGPaqkcqGH+aGpcqaIWaamcqGGDbqxaSqaaiabdkgaIjabg2da9iabigdaXaqaaiabd2eanbqdcqGHris5aaWcbaGaemyyaeMaeyypa0JaeGymaedabaGaemOta4eaniabggHiLdaaaaaa@6D14@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where I is the indicator function and P is given by Equation [<xref ref-type="bibr" rid="B2">2</xref>]. Here we extend the definition of the peak similarity function to include scoring of a peak with a gap, which is always zero (i.e. P(i,-) = P(-,j) = 0). Therefore, it is possible that the denominator is less than NM, since some of the terms in Equation [<xref ref-type="bibr" rid="B3">3</xref>] may be zero due to involvement of gaps.</p>
      <p>Consider the simple case, an alignment between the alignment L<sub>A</sub>:L<sub>B </sub>given by the Equation [<xref ref-type="bibr" rid="B1">1</xref>] and a single peak list <italic>L</italic><sub><italic>C </italic></sub>= [<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-8-419-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aqatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGYbGCdaWgaaWcbaGaeGymaedabeaakiabcYcaSiabdkhaYnaaBaaaleaacqaIYaGmaeqaaOGaeiilaWIaeiOla4IaeiOla4IaeiOla4IaeiilaWIaemOCai3aaSbaaSqaaiabd6gaUnaaBaaameaacqWGdbWqaeqaaaWcbeaaaaa@3B66@</mml:annotation></mml:semantics></mml:math></inline-formula>]. We note that the alignment L<sub>A</sub>:L<sub>B </sub>is a 2-alignment, and the peak list L<sub>C </sub>could be viewed as 1-alignment. According to Equation [<xref ref-type="bibr" rid="B3">3</xref>], the similarity function between the first position in the alignment given by Equation [<xref ref-type="bibr" rid="B1">1</xref>] (position (p<sub>1</sub>, q<sub>1</sub>)) and the first peak from the list L<sub>C </sub>(peak r<sub>1</sub>) will be calculated as:</p>
      <p>
        <disp-formula id="bmcM4">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-8-419-i6" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mi>W</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>p</mml:mi>
                  <mml:mn>1</mml:mn>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mi>q</mml:mi>
                  <mml:mn>1</mml:mn>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mi>r</mml:mi>
                  <mml:mn>1</mml:mn>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mn>1</mml:mn>
                  <mml:mn>2</mml:mn>
                </mml:mfrac>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>p</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>r</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>+</mml:mo>
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>q</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>r</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGxbWvcqGGOaakcqGGOaakcqWGWbaCdaWgaaWcbaGaeGymaedabeaakiabcYcaSiabdghaXnaaBaaaleaacqaIXaqmaeqaaOGaeiykaKIaeiilaWIaemOCai3aaSbaaSqaaiabigdaXaqabaGccqGGPaqkcqGH9aqpdaWcaaqaaiabigdaXaqaaiabikdaYaaadaqadaqaaiabdcfaqjabcIcaOiabdchaWnaaBaaaleaacqaIXaqmaeqaaOGaeiilaWIaemOCai3aaSbaaSqaaiabigdaXaqabaGccqGGPaqkcqGHRaWkcqWGqbaucqGGOaakcqWGXbqCdaWgaaWcbaGaeGymaedabeaakiabcYcaSiabdkhaYnaaBaaaleaacqaIXaqmaeqaaOGaeiykaKcacaGLOaGaayzkaaaaaa@51D9@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>The similarity function between the third position of the alignment L<sub>A</sub>:L<sub>B </sub>and the first peak from the list L<sub>C </sub>is W(r<sub>1</sub>, (p<sub>1</sub>, -)) = P(r<sub>1</sub>,p<sub>1</sub>) since P(r<sub>1</sub>,-) = 0. In the case of N = 1 and M = 1, the alignment reduces to a simple pairwise alignment discussed above.</p>
      <p>It is useful to devise a measure of how good one alignment is relative to another comparable alignment. Given an alignment between an N-alignment and M-alignment we calculate a total alignment score T as follows:</p>
      <p>
        <disp-formula id="bmcM5">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-8-419-i7" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mi>T</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mi>k</mml:mi>
                  </mml:munder>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>Z</mml:mi>
                      <mml:mi>k</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGubavcqGH9aqpdaaeqbqaaiabdQfaAnaaBaaaleaacqWGRbWAaeqaaaqaaiabdUgaRbqab0GaeyyeIuoaaaa@3522@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where Z<sub>k </sub>is the alignment score for the position k in the alignment, and the summation is over all positions in the alignment. The value of Z<sub>k </sub>depends on whether the gap was inserted in the k-th position of the alignment or not. If the gap was inserted either in the N- or M-alignment then Z<sub>k </sub>= -G. If the gap was not inserted then Z<sub>k </sub>equals W(i,j) given by the Equation [<xref ref-type="bibr" rid="B3">3</xref>], where i is the position from the N-alignment and j is the position from the M-alignment that are aligned to one another to result in the k position of the final (N+M)-alignment.</p>
    </sec>
    <sec>
      <title>Alignment of an arbitrary number of peak lists</title>
      <p>Consider the alignment of U peak lists L<sub>A</sub>, L<sub>B</sub>, L<sub>C</sub>,... where the peak list L<sub>A </sub>contains a total of n<sub>A </sub>peaks, the list L<sub>B </sub>contains a total of n<sub>B </sub>peaks, the list L<sub>C </sub>contains a total of n<sub>C </sub>peaks, and so on. The overall goal of the alignment process is to align the peak lists L<sub>A</sub>, L<sub>B</sub>, L<sub>C</sub>,... to obtain the alignment L<sub>A</sub>:L<sub>B</sub>:L<sub>C</sub>:... This alignment can be represented as a table or a matrix with U rows, each corresponding to one peak list. The exact number of columns in the alignment table will depend on the optimal alignment, but must be equal or greater than the maximum of n<sub>A</sub>, n<sub>B</sub>, n<sub>C</sub>,...</p>
      <p>Although it is possible to devise an exact dynamic programming solution for a multi-dimensional alignment, this quickly leads to a computationally intractable problem [<xref ref-type="bibr" rid="B33">33</xref>,<xref ref-type="bibr" rid="B35">35</xref>]. Therefore we modelled our solution after the progressive multiple sequence alignment [<xref ref-type="bibr" rid="B32">32</xref>,<xref ref-type="bibr" rid="B33">33</xref>], with changes to accommodate the unique requirements of peak alignment. To find the best alignment of peak lists L<sub>A</sub>, L<sub>B</sub>, L<sub>C</sub>,... we first calculate all possible pairwise alignments between the peak lists. From all pairwise alignments the alignment score for each pair of peak lists is calculated (T<sub>AB</sub>, T<sub>AC</sub>, T<sub>BC</sub>,...). In the next step, a dendrogram (guide) tree is built which provides the similarity relationship between the peak lists. A progressive pairwise alignment is performed following the branching order given by the guide tree. In the first step the two most similar peak lists are selected and aligned, resulting in a 2-alignment. The other peak lists are added gradually following the guide tree until all peak lists are exhausted.</p>
    </sec>
    <sec>
      <title>Within-state and between-state alignment</title>
      <p>In the case of experiments performed on different cell states with more than one replicate experiment per cell state it is reasonable to align first replicate experiments performed on each cell state ("within-state alignment"), and then to align the resulting alignments ("between-state alignment") [<xref ref-type="bibr" rid="B22">22</xref>]. This is because within each cell state one deals with true experimental replicates, and in the hypothetical case of perfect reproducibility all peaks will be observed in all experiments. In experiments performed on different cell states, such as wild-type and mutant cells, some metabolites may be missing in one state relative to another, and the expectation that all peaks observed in one state will be present in the other state is no longer valid.</p>
      <p>Consider an alignment of three cell states (wild-type (<italic>WT</italic>), mutant-1 (<italic>M1</italic>), and mutant-2 (<italic>M2</italic>)), each having eight replicate experiments. In the first step, within-state alignments are performed resulting in three 8-alignments (WT, M1, and M2). To solve the order of between-state alignment all possible pairwise alignments between WT, M1, and M2 alignments are created, the total alignment scores are calculated, and another guide tree is built. The between-state alignment is built progressively from WT, M1, and M2 alignments following the guide tree to result in the final 24-alignment WT:M1:M2.</p>
      <p>In practice, the reproducibility in peak retention times of experiments performed on the same cell state is often better compared to experiments performed on different cell states. Therefore, for optimal alignment involving different cell states it may be useful to use different parameters for retention time tolerance (D) and gap penalty (G). We denote these parameters D<sub>w</sub>, G<sub>w </sub>for within-state alignment and D<sub>b</sub>, G<sub>b </sub>for between-state alignment.</p>
    </sec>
    <sec>
      <title>Testing</title>
      <p>Metabolite profiling studies were performed on different cultivated stages of the human parasite, <italic>Leishmania mexicana</italic>. Comparisons were also made between wild type parasites and a mutant cell line lacking three major glucose transporters [<xref ref-type="bibr" rid="B36">36</xref>]. Polar metabolites were analyzed by GC-MS and peak lists generated manually or by using the proposed alignment method to assess the accuracy of the alignment and the sensitivity of the latter approach to input parameters such as the gap penalty and the retention time tolerance.</p>
    </sec>
    <sec>
      <title>Within-state alignment of the wild-type cells profiling experiments</title>
      <p>Eight replicate extracts of <italic>L.mexicana </italic>wild-type cells were analyzed by GC-MS and peaks were manually pre-processed and aligned. In this way a correct peak alignment table was constructed from 1,337 signal peaks from all eight replicate experiments. The manual analysis showed 173 unique metabolites, and the final alignment table contained 1,384 fields arranged in 8 columns (replicate experiments) and 173 rows (metabolites).</p>
      <p>To assess the accuracy of the proposed approach a series of alignments was constructed by applying dynamic programming alignment with different input parameters. The resulting alignment tables were compared to the correct alignment table and analyzed for errors. Two types of errors were observed (Figure <xref ref-type="fig" rid="F5">5</xref>): peak mixing (type A error) and metabolite splitting (type B error). In peak mixing errors one or more peaks are shifted to a different metabolite row to take a position of a missing peak. Figure <xref ref-type="fig" rid="F5">5(a)</xref> shows the simplest case of one metabolite being shifted from metabolite-1 to a metabolite-2 row. In practice mixing can involve more than two metabolite rows. In metabolite splitting, one or more peaks are moved to create an extra metabolite row (i.e. metabolite 3 in Figure <xref ref-type="fig" rid="F5">5(b)</xref>). As a consequence of the removal of spurious metabolites (see Methods) most artificially created metabolite rows due to metabolite splitting will be discarded. The only exception would be metabolites with all eight peaks present, subject to the splitting that has resulted in two metabolite rows with exactly four peaks per row.</p>
      <fig position="float" id="F5">
        <label>Figure 5</label>
        <caption>
          <p><bold>Errors in peak alignment</bold>. A portion of the hypothetical alignment table with two types of errors that occur in within-state peak alignment highlighted. The rows of the table represent metabolites and column represent individual experiments. The numbers shown are peak retention times in minutes. Panel (a) shows the type A error (peak mixing) where one or more peaks are shifted to an incorrect metabolite row. Panel (b) shows the type B error (metabolite splitting) where the metabolite row is split to create an artificial metabolite in the alignment table. The condition of minimum peaks is often imposed in practice (see Methods), in which case this type of error results in the deletion of the artificial metabolite (nevertheless the original metabolite is affected as it contains one or more missing peaks). If in the example shown on panel (b) it is assumed that the minimum peak cut-off is three peaks, and therefore both metabolite1 and metabolite2 will be deleted from the alignment table as the net result of the splitting error and the removal of spurious metabolite rows.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-419-5"/>
      </fig>
      <p>Comparison of the obtained peak alignment tables with the ideal alignment table allowed counting of errors. In the case of a simple peak mixing error (such as shown in Figure <xref ref-type="fig" rid="F5">5(a)</xref>) two metabolites are affected, resulting in an error count of two. If three metabolites were affected by peak mixing three errors were counted. In the case of a metabolite splitting error one or more metabolites may be affected.</p>
      <p>Figure <xref ref-type="fig" rid="F6">6</xref> shows the number of errors in a peak alignment table as a function of gap penalty in the range G = 0.10 to 0.55, for the fixed retention time tolerance of D = 2.5 s. For small values of G, metabolite splitting errors (type B) predominated, while for large G values peak mixing errors (type A) predominated. The decrease in the total number of metabolites for low values of G (Figure <xref ref-type="fig" rid="F6">6</xref>, bottom panel) is counterintuitive, since low values of G would favor the insertion of gaps, which in turn would create more metabolite rows in the alignment table. This effect was however more than countered by the removal of spurious metabolites rows in post-processing (see Methods). In addition, some cases of metabolite splitting resulted in a complete removal of the metabolite from the alignment table, due to the effect shown in Figure <xref ref-type="fig" rid="F5">5(b)</xref>.</p>
      <fig position="float" id="F6">
        <label>Figure 6</label>
        <caption>
          <p><bold>The accuracy of peak alignment as a function of gap penalty</bold>. The accuracy of dynamic programming peak alignment as a function of gap penalty G, shown on the x-axis. Eight replicate experiments of <italic>L mexicana </italic>polar extracts were processed, generating eight peak lists. The peak lists were aligned with the dynamic programming for a range of the gap penalty parameter between 0.10 and 0.55 (the retention time tolerance was fixed D = 2.5 s), and the resulting alignment tables were compared to the correct alignment table built manually. The top panel shows the total number of errors in the alignment. The middle panel shows the number of errors of type A (solid line) and type B (dashed line). The bottom panel shows the total number of metabolites in the resulting alignment. The correct number of metabolites is 173, shown in the dashed line.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-419-6"/>
      </fig>
      <p>A similar picture was observed for a number of errors as a function of the retention time tolerance (Figure <xref ref-type="fig" rid="F7">7</xref>). Small values of D favor metabolite splitting. This is because for small D any subset of peaks with small but systematically different retention times (due to experimental drift for example) would appear as a different metabolite and would be moved into a different metabolite row. However this effect was countered by the removal of spurious metabolites, and therefore a decrease in the total number of metabolites was observed for low D. Large values of D diminished peak discrimination by retention times resulting in an increase in mixing errors (type A), especially for the parts of the chromatogram which contained compounds with similar mass spectra.</p>
      <fig position="float" id="F7">
        <label>Figure 7</label>
        <caption>
          <p><bold>The accuracy of peak alignment as a function of retention time tolerance</bold>. The accuracy of dynamic programming peak alignment as a function of retention time tolerance D, shown on the x-axis. Eight replicate analyses of <italic>L. mexicana </italic>polar extracts were processed, resulting in eight peak lists. The peak lists were aligned with the dynamic programming for a range of retention time tolerances between 1.0 s and 5.5 s (the gap penalty was fixed G = 0.30), and the resulting alignment tables were compared to the correct alignment table built manually. The top panel shows the total number of errors in the alignment. The middle panel shows the number of errors of type A (solid line) and type B (dashed line) as explained in the text. The bottom panel shows the total number of metabolites in the resulting alignment. The correct number of metabolites is 173, shown in the dashed line.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-419-7"/>
      </fig>
    </sec>
    <sec>
      <title>Alignment of replicate analyses of wild type and mutant metabolite extracts</title>
      <p>These analyses were extended to replicate GC-MS chromatograms collected on wild-type and mutant cell states. The input for the alignment consisted of peak lists from 16 experiments (8 independent wild-type and 8 independent mutant extracts; Table <xref ref-type="table" rid="T1">1</xref>) with a total of 2,665 signal peaks. Within-state alignment was performed with D<sub>w </sub>= 2.5 s and G<sub>w </sub>= 0.30, and resulted in 173 unique metabolites for the wild-type cells and 171 unique metabolites for the mutant cells. For the between-states alignment we used the same gap penalty as for within-state alignment (G<sub>b </sub>= 0.30), while the retention time penalty was set to D<sub>b </sub>= 10.0 s, roughly the value that would allow matching of peaks in the case of large retention time shifts shown in Figure <xref ref-type="fig" rid="F2">2</xref>. In practice the retention time tolerance can be estimated from the largest retention time shifts between experiments (for data shown in Figure <xref ref-type="fig" rid="F2">2</xref> this is 5–7 s). For peaks 10 s apart the peak similarity will equal 0.6 times the similarity in their mass spectra, if D = 10.0 s (Equation [<xref ref-type="bibr" rid="B2">2</xref>]).</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Experiments used in peak alignment</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">
                <bold>Cell state</bold>
              </td>
              <td align="left">
                <bold>Replicates</bold>
              </td>
              <td align="left">
                <bold>Aver. No peaks</bold>
              </td>
              <td align="left">
                <bold>Metabolites</bold>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">wild-type, stationary phase</td>
              <td align="left">8</td>
              <td align="left">167.1 ± 2.3</td>
              <td align="left">173</td>
            </tr>
            <tr>
              <td align="left">Δgt, stationary phase</td>
              <td align="left">8</td>
              <td align="left">166.0 ± 4.9</td>
              <td align="left">171</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>A summary of parameters obtained for replicate analyses (8 each) of polar extracts from wild type and mutant (Δgt) parasites, processed using the peak alignment method. Shown is the number of experimental replicates for each cell state, the average number of peak per replicate experiment, and the number of unique metabolites after the within-state peak alignment with D<sub>w </sub>= 2.5 s and G<sub>w </sub>= 0.30.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>The complete alignment of wild-type and glucose transporter mutant experiments resulted in a total of 188 unique metabolites. The correct alignment table involving all 16 experiments was also compiled manually. A total of three errors were found in the within-state alignment of the wild-type experiments, and two errors were found in the within-state alignment of the mutant experiments. A comparison with the correct alignment table showed that incorrect between-state alignment affected a total of ten metabolites. This involved a segment of five misaligned metabolite rows between 10.2 and 10.5 minutes that had a prominent but anomalous feature at m/z = 155 that had created an effect of artificially similar mass spectra. It would be possible to remedy errors of this type with a more stringent retention time tolerance.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion and Conclusion</title>
    <p>GC-MS is a robust and sensitive platform for the profiling of certain metabolite classes [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B15">15</xref>]. Due to experimental limitations inherent in all chromatographic separations, slight drifts are observed in GC-MS elution times between experiments [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B18">18</xref>]. These drifts are particularly problematic for non-targeted metabolic profiling studies, which aim to analyze all detectable analytes within multiple experiments [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B23">23</xref>]. There are two schools of thought regarding how to address the retention time correction in hyphenated mass spectrometry (Figure <xref ref-type="fig" rid="F1">1</xref>). Algorithms that rely on time domain data only (Figure <xref ref-type="fig" rid="F1">1</xref>, branches 1 and 3) ignore highly pertinent information contained in the m/z dimension. Accumulated evidence suggests that effective retention time correction cannot be achieved based on retention time only, regardless of whether the approach involves peak matching or profile alignment [<xref ref-type="bibr" rid="B17">17</xref>-<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B26">26</xref>,<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B29">29</xref>].</p>
    <p>Profile alignment approaches that use the full chromatogram data matrices are expected to be the most accurate (Figure <xref ref-type="fig" rid="F1">1</xref>, branch 4). These approaches, however, come at a high cost, both in terms of complexity and computational costs. For example, Bylund and co-authors used correlation optimised warping [<xref ref-type="bibr" rid="B26">26</xref>], while Baran and co-authors used dynamic time warping with explicitly specified time shifts [<xref ref-type="bibr" rid="B30">30</xref>]. In both cases, an arbitrarily chosen "target" chromatogram was used to align all other chromatograms in a pairwise fashion, with the chromatogram data matrices segmented to facilitate the alignment [<xref ref-type="bibr" rid="B27">27</xref>,<xref ref-type="bibr" rid="B30">30</xref>]. This raises several difficulties. For example, it is unclear how the choice of the target chromatogram may affect the final alignment. In principle, a more objective alignment of chromatogram data matrices could be achieved by calculating a similarity tree [<xref ref-type="bibr" rid="B32">32</xref>,<xref ref-type="bibr" rid="B33">33</xref>]. This, however, must involve all possible pairwise alignments, which is likely to be computationally expensive. Furthermore, in the reported examples the chromatogram segmenting was based on strategic or node positions influenced by user chosen parameters [<xref ref-type="bibr" rid="B27">27</xref>], or a "representative" set of peaks [<xref ref-type="bibr" rid="B30">30</xref>]. This in turn raises the question of how the segmenting method might affect the final alignment. Finally, these approaches handle a large amount of uninformative noise data, since only a small portion of the full chromatogram data matrix is informative signal.</p>
    <p>Peak matching algorithms that use both time domain data and mass spectra are particularly promising, and have been applied to both LC-MS [<xref ref-type="bibr" rid="B20">20</xref>,<xref ref-type="bibr" rid="B21">21</xref>] and more recently to GC-MS data [<xref ref-type="bibr" rid="B23">23</xref>]. The input for these algorithms are signal peaks extracted from full chromatogram data matrices. Since the majority of uninformative data is discarded in the peak detection step, these methods operate on a vastly reduced data set while retaining highly selective information contained in the mass spectra. Here we propose an approach that falls into this category, and uses signal peak "objects" which are signals extracted from the chromatogram data matrix. A peak object may be characterized with several attributes including peak retention time (the time taken at the peak apex), peak mass spectrum (the m/z vector taken at the peak apex), experiment/cell state information, a unique peak ID, and so on. The result of an experiment is a list of peak objects, henceforth referred to as a peak list. From this viewpoint the peak matching problem is reduced to the alignment of peaks between multiple peak lists. If we assume that the elution order of peaks is conserved (a reasonable assumption for GC-MS; also an assumption widely used in proteomics based LC-MS [<xref ref-type="bibr" rid="B37">37</xref>]), this problem shows resemblance to extensively studied problem of multiple sequence alignment [<xref ref-type="bibr" rid="B32">32</xref>,<xref ref-type="bibr" rid="B33">33</xref>]. In order to cope with rapidly escalating computational costs of an exact, multidimensional dynamic programming solution, efficient algorithms were developed for multiple sequence alignment [<xref ref-type="bibr" rid="B33">33</xref>,<xref ref-type="bibr" rid="B35">35</xref>]. We have adapted this approach to the problem of peak alignment in multiple GC-MS experiments.</p>
    <p>The method proposed here uses both peak retention times and mass spectra, and relies on dynamic programming to find the optimal solution to the global alignment problem. Any peak matching method that uses both similarity in retention times and mass spectra similarity depends on a balance between the two, and devising an approach that balances this correctly poses a considerable challenge. For example, it is possible to incorporate mass spectra similarity into the total peak similarity score used in progressive hierarchical clustering [<xref ref-type="bibr" rid="B22">22</xref>], but it is unclear how to weight the relative contributions of retention time and mass spectra. The problem here is that progressive clustering relies on a single cutoff of the dendrogram tree to delineate peak clusters (essentially, the cutoff is a constant across the entire data set), while the retention times drifts are highly non-linear (Figure <xref ref-type="fig" rid="F2">2</xref> and [<xref ref-type="bibr" rid="B21">21</xref>]). In the work of Styczynski et al, the peak matching approach used to find conserved metabolites in GC-MS metabolic profiling experiments incorporated both the similarities in mass spectra and peak retention times [<xref ref-type="bibr" rid="B23">23</xref>]. However, in the demonstration of this approach the retention time similarity was taken into account only coarsely, with an elution similarity threshold of 1 min [<xref ref-type="bibr" rid="B23">23</xref>]. When two metabolites have distinct mass spectra, the retention time information can be neglected altogether and correct peak matching can still be achieved. However, for metabolites that elute in close proximity to one another, and give similar fragmentation patterns, the information provided by retention times is critical for a correct matching. Therefore, we would expect the method of Styczynski and co-authors to have difficulty when metabolites with similar fragmentation patterns elute in close proximity, as demonstrated by their inability to resolve isoleucine and leucine in the test data set [<xref ref-type="bibr" rid="B23">23</xref>].</p>
    <p>We propose the peak similarity function that incorporates the similarity between peak mass spectra modulated by the similarity in peak retention times (Equation [<xref ref-type="bibr" rid="B2">2</xref>]). This function is governed by two parameters: the gap penalty function (G) and the retention time tolerance (D). The first parameter (G) determines how similar mass spectra must be for peaks to be considered to represent the same metabolite; the second parameter (D) is related to expected drifts in retention times between experiments. For example, if retention times in a particular set of experiments are highly reproducible, decreasing the retention time tolerance will enable this information to be leveraged for increased accuracy in the peak alignment.</p>
    <p>To achieve the alignment of multiple peak lists, we rely on progressive alignment based on a similarity tree. The similarity tree is calculated from pairwise alignments, and the global alignment is built progressively, starting from the two most similar peak lists, and joining other peak lists in a process guided by the similarity tree [<xref ref-type="bibr" rid="B32">32</xref>,<xref ref-type="bibr" rid="B33">33</xref>]. When several cell states with multiple replicate experiments per state are analyzed, within each cell state one deals with true experimental replicates, while in experiments performed on different cell states some metabolites may be missing altogether in one state relative to another. To accommodate for this complexity, we first perform a within-state alignment, followed by the between-state alignment built by aligning the within-state alignments. In the case of more than two sets of replicate experiments, a similarity tree is built based on pairwise similarities between fixed within-state alignments, and then the alignments themselves are aligned progressively following the similarity tree. Therefore multiple guide trees are built, one for each set of replicate experiments to facilitate within-state alignment. An additional guide tree may be built to facilitate between-state alignment if more than two states are present.</p>
    <p>Several methods for peak matching based on both retention times and mass spectra (Figure <xref ref-type="fig" rid="F1">1</xref>, branch 2) have been described recently [<xref ref-type="bibr" rid="B20">20</xref>,<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B23">23</xref>]. Of these only the approach of Styczynski and co-authors was developed on GC-MS data [<xref ref-type="bibr" rid="B23">23</xref>], while the software packages MZmine [<xref ref-type="bibr" rid="B20">20</xref>] and XCMS [<xref ref-type="bibr" rid="B21">21</xref>] were developed on LC-MS data. In our experience the latter software packages tend to overinterpret GC-MS data, assigning a greater number of peaks than expected (probably related to differences in fragmentation patterns between GC-MS and LC-MS). Nevertheless, the alignment algorithms implemented in MZmine and XCMS are relevant and we briefly review them here.</p>
    <p>MZmine uses a simple alignment method to build the peak alignment table: one peak at a time is taken and an attempt is made to match it to an existing row of the peak alignment table. If no rows match a new row is created [<xref ref-type="bibr" rid="B20">20</xref>]. A secondary peak detection method is used to fill the gaps in the resulting alignment table [<xref ref-type="bibr" rid="B20">20</xref>]. We expect this approach to exhibit limitations similar to those observed in hierarchical clustering [<xref ref-type="bibr" rid="B22">22</xref>], and discussed above.</p>
    <p>XCMS incorporates one of the most advanced peak matching algorithms for metabolite profiling data described to date [<xref ref-type="bibr" rid="B21">21</xref>]. In this approach the distribution of peaks along the time domain by using the kernel density estimator is calculated, and regions where many peaks have similar retention times are identified [<xref ref-type="bibr" rid="B21">21</xref>]. From this, a fixed time interval that determines each group of peaks is deduced [<xref ref-type="bibr" rid="B21">21</xref>]. In practice, the retention time drifts are distributed in a highly irregular fashion, and a fixed time interval is unlikely to be able to capture peak groups correctly. This is suggested by observed peak collisions, where more than one peak from the same experiment is joined into a single group [<xref ref-type="bibr" rid="B19">19</xref>]. The same problem was encountered in other peak matching methods [<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B22">22</xref>], and requires additional, empirical intervention, such as "collision resolution" [<xref ref-type="bibr" rid="B19">19</xref>] or "tie-breaking" in XCMS [<xref ref-type="bibr" rid="B21">21</xref>]. The approach we propose inherently prevents peak collisions. Furthermore, it does not rely on any fixed intervals to group peaks, nor does it rely on any assumptions about the distribution of peaks across the samples.</p>
    <p>It is of interest to compare the method proposed here to the approach for constructing signal maps, described recently in LC-MS proteomics experiments [<xref ref-type="bibr" rid="B37">37</xref>]. Underlying the calculation of signal maps is the method for optimal alignment of chromatogram data matrices, that can be classified as belonging to branch 4 in Figure <xref ref-type="fig" rid="F1">1</xref>. These authors used the Needleman-Wunsch algorithm to align full chromatogram data matrices obtained from LC-MS proteomics experiments [<xref ref-type="bibr" rid="B37">37</xref>]. They also used minimum spanning tree, or progressive merging of pairwise alignments into a consensus run, to produce a global signal map [<xref ref-type="bibr" rid="B37">37</xref>]. Apart from the overt difference in that we focus on extracted signals rather than using the full chromatogram data matrices, there are several important yet more subtle differences between the two methods. First, in contrast to the method of [<xref ref-type="bibr" rid="B37">37</xref>] the score function proposed here incorporates both similarities in retention times and mass spectra. Second, in constructing signal maps from peptide mass spectra Prakash and co-workers allow for multiple mass spectra in one experiment to correspond to a single mass spectrum in the other experiment [<xref ref-type="bibr" rid="B37">37</xref>]. Since we are aligning peak objects rather than the raw signal, our approach inherently allows only one-to-one peak matching, and we consider explicitly the question of gaps (a match-to-nothing). Both of these features are critical for the ability to achieve the alignment of signal peaks in GC-MS. Similarly as in the approach of [<xref ref-type="bibr" rid="B37">37</xref>], we rely on the two-dimensional formulation of the global sequence alignment problem. However, during progressive alignment of individual experiments we do not merge individual runs into a "consensus" run, because this has a potential to degrade signal if two unrelated signal peaks are merged. Rather, our approach is based on the generalized solution for the alignment of two alignments, i.e. an N- and M-alignment. This has an additional benefit to be directly extensible to the alignment of pre-computed alignments representing replicates of different cell states (where signal-to-nothing matches may be significant), and allows one to tackle the problem of an arbitrary number of cell states with the same conceptual framework and finite computational resources. We note that the modification proposed for the calculation of mass spectra similarity [<xref ref-type="bibr" rid="B37">37</xref>], and results from other proteomics studies [<xref ref-type="bibr" rid="B38">38</xref>], could be used in the method proposed here.</p>
    <p>It would be useful to compare more directly the performance and accuracy of the approach proposed here to the approaches for peak matching described previously. Unfortunately, this is currently not feasible for two reasons. Firstly, a standard data set which could be used as a benchmark does not exist. Furthermore, it is difficult to create such a data set <italic>ad hoc</italic>. Most other alignment methods of interest, such as methods implemented in software packages MZmine [<xref ref-type="bibr" rid="B20">20</xref>] or XCMS [<xref ref-type="bibr" rid="B21">21</xref>], are embedded in the multi-step processing pipelines, and the input to peak matching is generated directly from the output of package-specific peak detection. Secondly, a suitable metric to quantify differences between two methods does not exist. This is particularly problematic, because in even the simplest case the resulting alignment table may involve hundreds of peak entries, and it is not clear how to represent and quantify the differences between two such tables.</p>
    <p>The development of a suitable metric to compare two peak matching methods is likely to require a separate research effort. To circumvent this we have performed a detailed analysis of absolute error and compiled error statistics relative to the "correct" alignment table created manually (Figures <xref ref-type="fig" rid="F6">6</xref> and <xref ref-type="fig" rid="F7">7</xref>). The error analysis performed on experimental data consisting of eight replicate GC-MS experiments collected on <italic>Leishmania </italic>parasites with ~170 peaks per experiment showed that, for near optimal parameters, &lt;5 metabolites were affected by misalignment errors. This approaches the accuracy achieved in a manual alignment, which required tens of man-hours for the tested data set.</p>
    <p>The alignment accuracy was not overly sensitive to empirical parameters for a wide range of values (gap penalty and retention time tolerance), suggesting that the method is robust. To address the problem of a benchmark data set, we provide our test data set in the supplementary material (see Additional files <xref ref-type="supplementary-material" rid="S1">1</xref>, <xref ref-type="supplementary-material" rid="S2">2</xref>, <xref ref-type="supplementary-material" rid="S3">3</xref>). This includes input peak lists, raw chromatogram data matrices, and alignment tables, including those produced for optimal parameters, as well as the "correct" alignment table prepared manually.</p>
    <p>The main drawback of the proposed approach is that it operates on a set of signal peaks obtained from peak detection pre-processing. Automated peak detection remains a challenge [<xref ref-type="bibr" rid="B30">30</xref>], and any errors introduced during peak detection (such as missing peaks or false peaks) will propagate through to the alignment tables. This is inherent in all peak matching methods, and could be viewed as an advantage as well. Focusing on signal peaks results in a greatly reduced data set which contains the vast majority of interesting signal, and allows one to leverage this information for downstream processing [<xref ref-type="bibr" rid="B21">21</xref>], in addition to significantly reducing computational costs required for downstream processing.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Metabolic profiling of <italic>L.mexicana</italic></title>
      <p><italic>L. mexicana </italic>wild-type and <italic>L. mexicana </italic>Δgt promastigotes (lacking three glucose transporters [<xref ref-type="bibr" rid="B36">36</xref>] were cultivated in RPMI media, pH 7.4 containing 10 % fetal calf serum (FCS). Parasites were harvested in mid-log phase or stationary phase (24 hr and 96 hr after inoculation, respectively). Prior to harvesting, the culture medium was rapidly chilled to 0°C by immersing the culture flasks in a dry-ice/ethanol bath. The temperature of the medium was monitored with an electronic thermometer and subsequent steps performed at 0°C. Replicate aliquots of the quenched culture medium (containing 4 × 10<sup>7 </sup>cells) were harvested by centrifugation (15,000 g, 30 sec, 0°C) and washed twice with ice-cold phosphate-buffered saline, pH 7.5. The washed cell pellets were suspended in chloroform:methanol:water (containing 1 nmole <italic>scyllo</italic>-inositol and 1 nmole norleucine internal standards) (1:3:1 v/v/v) and extracted at 60°C for 15 min. Water was added to give a final chloroform:methanol:water ratio of 1:3:3 (v/v) and the aqueous and organic phases separated by centrifugation. The upper aqueous phases were dried <italic>in vacuo</italic>, suspended in 20 mg/ml methoxyamine in pyridine (20 μl, 16 hr, 25°C) with continuous shaking and then derivatized with MSTFA + 1% TMCS (Pierce; 20 μl, 1 hr, 25°C). Samples (1 μL) were injected onto an Agilent 6890N gas chromatograph interfaced with a 5973 mass selective detector using a 7683 automatic liquid sampler. Gas chromatography was performed on a 30 m DB5-MS column with 0.25 mm inner diameter and 0.25 μm film thickness (J&amp;W Scientific). Injection temperature was 270°C, the interface set at 250°C, and the ion source adjusted to 230°C. The carrier gas was helium (flow rate 1 ml/min). The temperature program was 1 min isothermal heating at 70°C, followed by a 12.5°C/min oven temperature ramp to 295°C, then 25°C/min to 320°C and held for 1 min. Mass spectra were recorded at 3.2 scans/s (m/z 50–500).</p>
    </sec>
    <sec>
      <title>Post-processing and data preparation</title>
      <p>The total ion-chromatogram was integrated in ChemStation (MSD Chemstation D.01.02.16, Agilent Technologies) by using the default integrator. Resulting peak tables were exported to external files for further processing, together with raw data in ANDI-MS format. Initially the TICs were examined visually for each experiment, and peak lists were edited manually to mark the reference peak and uninformative peaks originating from the derivatizing reagent (TMS). Subsequently the reference peak and uninformative peaks were removed from the peak lists, and peaks in the region 6.5 to 21.0 min of each chromatogram were selected for further processing. Prior to peak alignment the mass spectra at peak apexes were extracted from the ANDI-MS files, and signals at m/z 73 and 147 (largely due to the derivatizing reagent) were suppressed for all peaks. To remove spurious metabolites such as those that arise as artefacts of empirical peak integration, all metabolite rows with less than four peaks were discarded after the alignment (i.e. one half of the original sample size of eight replicate experiments) [<xref ref-type="bibr" rid="B22">22</xref>].</p>
    </sec>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>MDR was involved in the development of the method and development of the test implementation. DPDS was involved in the development of GC-MS experiments and error analysis. WWK was involved in the development of the test implementation, ECS was involved in GC-MS experiments, MJM was involved in the development of the method and GC-MS experiments, TPS was involved in the development of the method. VAL originally conceived the project and was leading development of the method, development of the test implementation, and error analysis. VAL drafted the manuscript; all authors contributed to the final version. All authors have read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p>Raw data files, peak lists, and alignment tables for eight replicate experiments obtained by GC-MS metabolic profiling of wild type <italic>L.mexicana</italic>. This folder contains peak lists for eight GC-MS replicate experiments, raw GC-MS data files in the NetCDF format, manually prepared peak alignment table, and the alignment table obtained by automated peak alignment.</p>
      </caption>
      <media xlink:href="1471-2105-8-419-S1.gz" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p>Additional raw data files for replicate experiments obtained by GC-MS metabolic profiling of wild type <italic>L.mexicana</italic>. This folder contains three additional raw GC-MS data files in the NetCDF format, that correspond to peak lists provided in SupplMaterial1/ChemStation.</p>
      </caption>
      <media xlink:href="1471-2105-8-419-S2.gz" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p>Additional raw data files for replicate experiments obtained by GC-MS metabolic profiling of wild type <italic>L.mexicana</italic>. This folder contains three additional raw GC-MS data files in the NetCDF format, that correspond to peak lists provided in SupplMaterial1/ChemStation.</p>
      </caption>
      <media xlink:href="1471-2105-8-419-S3.gz" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>This work was supported by the Bio21 Molecular Science and Biotechnology Institute, University of Melbourne. MJM was supported by the Australian National Health and Medical Research Council (NHMRC) Programme grant and Principal Research Fellowship. DDS was supported by NHMRC "Dora Lush" Biomedical scholarship (Id. No. 359427).</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Kopka</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dormann</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Altmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Trethewey</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Willmitzer</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Metabolite profiling for plant functional genomics</article-title>
        <source>Nat Biotechnol</source>
        <year>2000</year>
        <volume>18</volume>
        <fpage>1157</fpage>
        <lpage>1161</lpage>
        <pub-id pub-id-type="pmid">11062433</pub-id>
        <pub-id pub-id-type="doi">10.1038/81137</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davey</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Broadhurst</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Heald</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Rowland</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Kell</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>High-throughput classification of yeast mutants for functional genomics using metabolic footprinting</article-title>
        <source>Nat Biotechnol</source>
        <year>2003</year>
        <volume>21</volume>
        <fpage>692</fpage>
        <lpage>696</lpage>
        <pub-id pub-id-type="pmid">12740584</pub-id>
        <pub-id pub-id-type="doi">10.1038/nbt823</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sweetlove</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Last</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Fernie</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Predictive Metabolic Engineering: A Goal for Systems Biology</article-title>
        <source>Plant Physiology</source>
        <year>2003</year>
        <volume>132</volume>
        <fpage>420</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="pmid">12805573</pub-id>
        <pub-id pub-id-type="doi">10.1104/pp.103.022004</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fernie</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Trethewey</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Krotzky</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Willmitzer</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Metabolite profiling: from diagnostics to systems biology</article-title>
        <source>Nat Rev Mol Cell Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>763</fpage>
        <lpage>769</lpage>
        <pub-id pub-id-type="pmid">15340383</pub-id>
        <pub-id pub-id-type="doi">10.1038/nrm1451</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koek</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Muilwijk</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>van der Werf</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Hankemeier</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Microbial metabolomics with gas chromatography/mass spectrometry</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>1272</fpage>
        <lpage>1281</lpage>
        <pub-id pub-id-type="pmid">16478122</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac051683+</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sabatine</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Morrow</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Heller</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McCarroll</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wiegand</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Berriz</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>FP</given-names>
          </name>
          <name>
            <surname>Gerszten</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>Metabolomic identification of novel biomarkers of myocardial ischemia</article-title>
        <source>Circulation</source>
        <year>2005</year>
        <volume>112</volume>
        <fpage>3868</fpage>
        <lpage>3875</lpage>
        <pub-id pub-id-type="pmid">16344383</pub-id>
        <pub-id pub-id-type="doi">10.1161/CIRCULATIONAHA.105.569137</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robertson</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Metabonomics in toxicology: a review</article-title>
        <source>Toxicol Sci</source>
        <year>2005</year>
        <volume>85</volume>
        <fpage>809</fpage>
        <lpage>822</lpage>
        <pub-id pub-id-type="pmid">15689416</pub-id>
        <pub-id pub-id-type="doi">10.1093/toxsci/kfi102</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keun</surname>
            <given-names>HC</given-names>
          </name>
        </person-group>
        <article-title>Metabonomic modeling of drug toxicity</article-title>
        <source>Pharmacol Ther</source>
        <year>2006</year>
        <volume>109</volume>
        <fpage>92</fpage>
        <lpage>106</lpage>
        <pub-id pub-id-type="pmid">16051371</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.pharmthera.2005.06.008</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibney</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Walsh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Brennan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Roche</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>German</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>van Ommen</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics in human nutrition: opportunities and challenges</article-title>
        <source>Am J Clin Nutr</source>
        <year>2005</year>
        <volume>82</volume>
        <fpage>497</fpage>
        <lpage>503</lpage>
        <pub-id pub-id-type="pmid">16155259</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>German</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Watkins</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Fay</surname>
            <given-names>LB</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics in practice: emerging knowledge to guide future dietetic advice toward individualized health</article-title>
        <source>J Am Diet Assoc</source>
        <year>2005</year>
        <volume>105</volume>
        <fpage>1425</fpage>
        <lpage>1432</lpage>
        <pub-id pub-id-type="pmid">16129085</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.jada.2005.06.006</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nikiforova</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Gakiere</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kempa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Adamik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Willmitzer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hesse</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hoefgen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Towards dissecting nutrient metabolism in plants: a systems biology case study on sulphur metabolism</article-title>
        <source>J Exp Bot</source>
        <year>2004</year>
        <volume>55</volume>
        <fpage>1861</fpage>
        <lpage>1870</lpage>
        <pub-id pub-id-type="pmid">15208339</pub-id>
        <pub-id pub-id-type="doi">10.1093/jxb/erh177</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roessner</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Luedemann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brust</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Linke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Willmitzer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fernie</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Metabolic profiling allows comprehensive phenotyping of genetically or environmentally modified plant systems</article-title>
        <source>Plant Cell</source>
        <year>2001</year>
        <volume>13</volume>
        <fpage>11</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="pmid">11158526</pub-id>
        <pub-id pub-id-type="doi">10.1105/tpc.13.1.11</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Urbanczyk-Wochniak</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Luedemann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kopka</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Selbig</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roessner-Tunali</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Willmitzer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fernie</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Parallel analysis of transcript and metabolic profiles: a new approach in systems biology</article-title>
        <source>EMBO Rep</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>989</fpage>
        <lpage>993</lpage>
        <pub-id pub-id-type="pmid">12973302</pub-id>
        <pub-id pub-id-type="doi">10.1038/sj.embor.embor944</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tolstikov</surname>
            <given-names>VV</given-names>
          </name>
          <name>
            <surname>Lommen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nakanishi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Monolithic silica-based capillary reversed-phase liquid chromatography/electrospray mass spectrometry for plant metabolomics</article-title>
        <source>Anal Chem</source>
        <year>2003</year>
        <volume>75</volume>
        <fpage>6737</fpage>
        <lpage>6740</lpage>
        <pub-id pub-id-type="pmid">14640754</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac034716z</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Halket</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Przyborowska</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Bramley</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>Chemical derivatization and mass spectral libraries in metabolic profiling by GC/MS and LC/MS/MS</article-title>
        <source>J Exp Bot</source>
        <year>2005</year>
        <volume>56</volume>
        <fpage>219</fpage>
        <lpage>243</lpage>
        <pub-id pub-id-type="pmid">15618298</pub-id>
        <pub-id pub-id-type="doi">10.1093/jxb/eri069</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stein</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <article-title>An Integrated Method for Spectrum Extraction and Compound Identification from Gas Chromatography/Mass Spectrometry Data</article-title>
        <source>J Am Soc Mass Spectrom</source>
        <year>1999</year>
        <volume>10</volume>
        <fpage>770</fpage>
        <lpage>781</lpage>
        <pub-id pub-id-type="doi">10.1016/S1044-0305(99)00047-1</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malmquist</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Danielsson</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Alignment of chromatographic profiles for principal component analysis: a prerequisite for fingerprinting methods</article-title>
        <source>Journal of Chromatography A</source>
        <year>1994</year>
        <volume>687</volume>
        <fpage>71</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1016/0021-9673(94)00726-8</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Jarman</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Synovec</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>High-speed peak matching algorithm for retention time alignment of gas chromatographic data for chemometric analysis</article-title>
        <source>J Chromatogr A</source>
        <year>2003</year>
        <volume>996</volume>
        <fpage>141</fpage>
        <lpage>155</lpage>
        <pub-id pub-id-type="pmid">12830915</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0021-9673(03)00616-2</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duran</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sumner</surname>
            <given-names>LW</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics spectral formatting, alignment and conversion tools (MSFACTs)</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>2283</fpage>
        <lpage>2293</lpage>
        <pub-id pub-id-type="pmid">14630657</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg315</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katajamaa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Processing methods for differential analysis of LC/MS profile data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>179</fpage>
        <pub-id pub-id-type="pmid">16026613</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-179</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Want</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>O'Maille</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>779</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="pmid">16448051</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac051437y</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Souza</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Saunders</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>McConville</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Likic</surname>
            <given-names>VA</given-names>
          </name>
        </person-group>
        <article-title>Progressive peak clustering in GC-MS Metabolomic experiments applied to Leishmania parasites</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1391</fpage>
        <lpage>1396</lpage>
        <pub-id pub-id-type="pmid">16527833</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl085</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Styczynski</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Moxley</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Tong</surname>
            <given-names>LV</given-names>
          </name>
          <name>
            <surname>Walther</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Stephanopoulos</surname>
            <given-names>GN</given-names>
          </name>
        </person-group>
        <article-title>Systematic identification of conserved metabolites in GC/MS data for metabolomics and biomarker discovery</article-title>
        <source>Anal Chem</source>
        <year>2007</year>
        <volume>79</volume>
        <fpage>966</fpage>
        <lpage>973</lpage>
        <pub-id pub-id-type="pmid">17263323</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac0614846</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frenzel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Engel</surname>
            <given-names>KH</given-names>
          </name>
        </person-group>
        <article-title>A methodology for automated comparative analysis of metabolite profiling data</article-title>
        <source>European Food Research and Technology</source>
        <year>2004</year>
        <volume>216</volume>
        <fpage>1438</fpage>
        <lpage>2377</lpage>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Broeckling</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>IR</given-names>
          </name>
          <name>
            <surname>Duran</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Sumner</surname>
            <given-names>LW</given-names>
          </name>
        </person-group>
        <article-title>MET-IDEA: data extraction tool for mass spectrometry-based metabolomics</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>4334</fpage>
        <lpage>4341</lpage>
        <pub-id pub-id-type="pmid">16808440</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac0521596</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>NPV</given-names>
          </name>
          <name>
            <surname>Carstensen</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Smedsgaard</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Aligning of single and multiple wavelength chromatographic profiles for chemometric data analysis using correlation optimised warping</article-title>
        <source>Journal of Chromatography A</source>
        <year>1998</year>
        <volume>805</volume>
        <fpage>17</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1016/S0021-9673(98)00021-1</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bylund</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Danielsson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Malmquist</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Markides</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>Chromatographic alignment by warping and dynamic programming as a pre-processing tool for PARAFAC modelling of liquid chromatography-mass spectrometry data</article-title>
        <source>J Chromatogr A</source>
        <year>2002</year>
        <volume>961</volume>
        <fpage>237</fpage>
        <lpage>244</lpage>
        <pub-id pub-id-type="pmid">12184621</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0021-9673(02)00588-5</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jonsson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gullberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nordstrom</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kusano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kowalczyk</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sjostrom</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moritz</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A strategy for identifying differences in large series of metabolomic samples analyzed by GC/MS</article-title>
        <source>Anal Chem</source>
        <year>2004</year>
        <volume>76</volume>
        <fpage>1738</fpage>
        <lpage>1745</lpage>
        <pub-id pub-id-type="pmid">15018577</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac0352427</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eilers</surname>
            <given-names>PH</given-names>
          </name>
        </person-group>
        <article-title>Parametric time warping</article-title>
        <source>Anal Chem</source>
        <year>2004</year>
        <volume>76</volume>
        <fpage>404</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="pmid">14719890</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac034800e</pub-id>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baran</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kochi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saito</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Suematsu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Soga</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nishioka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tomita</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MathDAMP: a package for differential analysis of metabolite profiles</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>530</fpage>
        <pub-id pub-id-type="pmid">17166258</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-530</pub-id>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tikunov</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lommen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>de Vos</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Verhoeven</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Bino</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Bovy</surname>
            <given-names>AG</given-names>
          </name>
        </person-group>
        <article-title>A novel approach for nontargeted data analysis for metabolomics. Large-scale profiling of tomato fruit volatiles</article-title>
        <source>Plant Physiol</source>
        <year>2005</year>
        <volume>139</volume>
        <fpage>1125</fpage>
        <lpage>1137</lpage>
        <pub-id pub-id-type="pmid">16286451</pub-id>
        <pub-id pub-id-type="doi">10.1104/pp.105.068130</pub-id>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Doolittle</surname>
            <given-names>RF</given-names>
          </name>
        </person-group>
        <article-title>Progressive sequence alignment as a prerequisite to correct phylogenetic trees</article-title>
        <source>J Mol Evol</source>
        <year>1987</year>
        <volume>25</volume>
        <fpage>351</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="pmid">3118049</pub-id>
        <pub-id pub-id-type="doi">10.1007/BF02603120</pub-id>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>
        <source>Nucleic Acids Res</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>4673</fpage>
        <lpage>4680</lpage>
        <pub-id pub-id-type="pmid">7984417</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/22.22.4673</pub-id>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Needleman</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wunsch</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>
        <source>J Mol Biol</source>
        <year>1970</year>
        <volume>48</volume>
        <fpage>443</fpage>
        <lpage>453</lpage>
        <pub-id pub-id-type="pmid">5420325</pub-id>
        <pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Kececioglu</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>A tool for multiple sequence alignment</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>1989</year>
        <volume>86</volume>
        <fpage>4412</fpage>
        <lpage>4415</lpage>
        <pub-id pub-id-type="pmid">2734293</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.86.12.4412</pub-id>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burchmore</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Rodriguez-Contreras</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McBride</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Merkel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Modi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sacks</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Landfear</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Genetic characterization of glucose transporter function in Leishmania mexicana</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>3901</fpage>
        <lpage>3906</lpage>
        <pub-id pub-id-type="pmid">12651954</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.0630165100</pub-id>
      </citation>
    </ref>
    <ref id="B37">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prakash</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mallick</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Whiteaker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Paulovich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Flory</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schwikowski</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Signal maps for mass spectrometry-based comparative proteomics</article-title>
        <source>Mol Cell Proteomics</source>
        <year>2006</year>
        <volume>5</volume>
        <fpage>423</fpage>
        <lpage>432</lpage>
        <pub-id pub-id-type="pmid">16269421</pub-id>
        <pub-id pub-id-type="doi">10.1074/mcp.M500133-MCP200</pub-id>
      </citation>
    </ref>
    <ref id="B38">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolski</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Lalowski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martus</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Herwig</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Giavalisco</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gobom</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sickmann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lehrach</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Transformation and other factors of the peptide mass spectrometry pairwise peak-list comparison process</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>285</fpage>
        <pub-id pub-id-type="pmid">16318636</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-285</pub-id>
      </citation>
    </ref>
    <ref id="B39">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reiner</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Abbey</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Moran</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Papamichalis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schafer</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>Characterization of normal human cells by pyrolysis gas chromatography mass spectrometry</article-title>
        <source>Biomed Mass Spectrom</source>
        <year>1979</year>
        <volume>6</volume>
        <fpage>491</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="pmid">394768</pub-id>
        <pub-id pub-id-type="doi">10.1002/bms.1200061107</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
