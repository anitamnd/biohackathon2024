<?properties open_access?>
<?subarticle report52997?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000 Research Limited</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6743255</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.18705.2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Analysis of correlation-based biomolecular networks from different omics data by fitting stochastic block models</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 2; peer review: 1 approved</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Baum</surname>
          <given-names>Katharina</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Formal Analysis</role>
        <role content-type="http://credit.casrai.org/">Funding Acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-7256-0566</contrib-id>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rajapakse</surname>
          <given-names>Jagath C.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding Acquisition</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Azuaje</surname>
          <given-names>Francisco</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding Acquisition</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9207-9072</contrib-id>
        <xref ref-type="corresp" rid="c2">b</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <aff id="a1"><label>1</label>Bioinformatics and Modelling, Luxembourg Institute of Health, Strassen, Luxembourg</aff>
      <aff id="a2"><label>2</label>Mathematical Modelling of Cellular Processes, Max Delbrück Center for Molecular Medicine in the Helmholtz Association, Berlin, Germany</aff>
      <aff id="a3"><label>3</label>School of Computer Science and Engineering, Nanyang Technological University, Singapore, Singapore</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:asjagath@ntu.edu.sg">asjagath@ntu.edu.sg</email>
      </corresp>
      <corresp id="c2">
        <label>b</label>
        <email xlink:href="mailto:francisco.azuaje@lih.lu">francisco.azuaje@lih.lu</email>
      </corresp>
      <fn fn-type="COI-statement">
        <p>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>8</volume>
    <elocation-id>465</elocation-id>
    <history>
      <date date-type="accepted">
        <day>14</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2019 Baum K et al.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="f1000research-8-22342.pdf"/>
    <abstract>
      <p><bold>Background:</bold> Biological entities such as genes, promoters, mRNA, metabolites or proteins do not act alone, but in concert in their network context. Modules, i.e., groups of nodes with similar topological properties in these networks characterize important biological functions of the underlying biomolecular system. Edges in such molecular networks represent regulatory and physical interactions, and comparing them between conditions provides valuable information on differential molecular mechanisms. However, biological data is inherently noisy and network reduction techniques can propagate errors particularly to the level of edges. We aim to improve the analysis of networks of biological molecules by deriving modules together with edge relevance estimations that are based on global network characteristics.</p>
      <p><bold>Methods: </bold>The key challenge we address here is investigating the capability of stochastic block models (SBMs) for representing and analyzing different types of biomolecular networks. Fitting them to SBMs both delivers modules of the networks and enables the derivation of edge confidence scores, and it has not yet been investigated for analyzing biomolecular networks. We apply SBM-based analysis independently to three correlation-based networks of breast cancer data originating from high-throughput measurements of different molecular layers: either transcriptomics, proteomics, or metabolomics. The networks were reduced by thresholding for correlation significance or by requirements on scale-freeness. </p>
      <p><bold>Results and discussion:</bold> We find that the networks are best represented by the hierarchical version of the SBM, and many of the predicted blocks have a biologically and phenotypically relevant functional annotation. The edge confidence scores are overall in concordance with the biological evidence given by the measurements. We conclude that biomolecular networks can be appropriately represented and analyzed by fitting SBMs. As the SBM-derived edge confidence scores are based on global network connectivity characteristics and potential hierarchies within the biomolecular networks are considered, they could be used as additional, integrated features in network-based data comparisons.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>biomolecular networks</kwd>
      <kwd>co-expression networks</kwd>
      <kwd>edge relevance</kwd>
      <kwd>hierarchical stochastic block model</kwd>
      <kwd>missing and spurious edges</kwd>
      <kwd>module detection</kwd>
      <kwd>network-based omics analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1" xlink:href="http://dx.doi.org/10.13039/501100001866">
        <funding-source>Fonds National de la Recherche Luxembourg</funding-source>
        <award-id>SINGALUNproject</award-id>
      </award-group>
      <award-group id="fund-2" xlink:href="http://dx.doi.org/10.13039/100008662">
        <funding-source>Joachim Herz Stiftung</funding-source>
        <award-id>Add-onFellowshipforInterdisciplinaryLifeSciences</award-id>
      </award-group>
      <funding-statement>This research was funded by Luxembourg National Research Fund, FNR, SINGALUN project. KB acknowledges funding by an Add-on Fellowship for Interdisciplinary Life Sciences of the Joachim Herz Stiftung.</funding-statement>
      <funding-statement>
        <italic>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</italic>
      </funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec sec-type="version-changes">
      <label>Revised</label>
      <title>Amendments from Version 1</title>
      <p>In the revised version of our manuscript, we reformulated parts of the Abstract and Introduction in order to clarify the goal of our analysis: Assessing whether stochastic block models (SBMs) can be used to represent and analyze single-layer biomolecular networks derived from different, clinically relevant datatypes that provide complementary perspectives of cellular or tumour tissue properties.   We included a more detailed description of the network reduction procedures and the applied reasoning in the Methods and Results sections, along with new Figure 1D, as well as the relationship between the two employed reduction methods in new Figure S1. We incorporated a description of the SBM types and their associated formalisms that connect them to the properties of the modelled network into the Methods section.   We clarified the contents of Figure 3 by adapting its description and shifting contents to new Figure S3, and we included pathway distances of the higher-level blocks (new Figure 3D).   The most comprehensive extensions consist of new analyses with a focus on biological predictions. First, we compare biological insights derived from SBM-based clustering to known characteristics of breast cancer, that is the phenotype we employ for our case study, as derived from MSigDB (new Figure 4). Second, we summarize predictions of the SBM-based clustering (new Figure 5, new Table 2) and relate them to (breast) cancer literature. Together with the strikingly tight relationship between SBM-based edge scores and data-derived edge interaction strength (correlation), these analyses support our conclusion that SBMs are suitable to represent and analyze biomolecular networks and to derive relevant predictions.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>High-throughput measurement techniques are advancing and become ever less expensive, enabling the screening of multiple biological data layers in single patients as almost standard clinical diagnostic tools. The wealth of the biological data can only be understood if treating the measured entities – gene promotors, mRNA, metabolites, proteins and their activity – not separately, but in their network context
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup>. Thereby, one method to capture the interdependencies of the intracellular machinery relies on the hypothesis that strongly connected molecular entities are either co-activated or co-repressed, i.e. their measured abundances should be correlated
<sup><xref rid="ref-2" ref-type="bibr">2</xref>–
<xref rid="ref-4" ref-type="bibr">4</xref></sup>. Fully connected, weighted biomolecular networks can be established, in which each node corresponds to a molecular entity and is connected to each other node by an edge. The weight of the edge is the correlation between the measurements and is considered to represent how strongly the nodes are connected, interact or regulate each other.</p>
    <p>Approaching a network-level analysis of a biological system by correlation-based interactions has the advantage that it does not require
<italic>a priori</italic> knowledge, and thus it is focused on the interaction profile for which evidence can be found in the measurements of the considered condition. However, this is a blessing and a curse: correlation-based networks suffer from the fact that the biological measurements are inherently noisy, even more so for small sample sizes as in rare diseases or in personalized medicine. This affects the values of the edge weights and the results of network reduction, and can be deleterious for subsequent analyses of the networks. In these cases, considering in addition alternative sources of edge relevance that are based on more global characteristics of the system might be beneficial and could make the network representations of the system and their analysis more robust.</p>
    <p>One of the commonly performed analyses of correlation-based networks relies on the observation that biological networks exhibit a modular structure, in which tightly regulated modules are loosely connected to other modules. An important readout from correlation-based networks therefore is the biological and functional characterization of condition-specific modules, i.e. communities of co-regulated entities. A plethora of methods for module detection in networks has been proposed
<sup><xref rid="ref-5" ref-type="bibr">5</xref>–
<xref rid="ref-14" ref-type="bibr">14</xref></sup>. Also for the inference of edge relevance, or edge prediction, as being tightly linked to the problem of the detection of missing or spurious edges, numerous methods have been suggested
<sup><xref rid="ref-15" ref-type="bibr">15</xref>–
<xref rid="ref-23" ref-type="bibr">23</xref></sup>. In this work, we showcase a method that is able to derive, within a single framework, modules as well as scores of edge relevance: representing the biomolecular correlation-based networks as stochastic block models (SBMs)
<sup><xref rid="ref-24" ref-type="bibr">24</xref></sup>.</p>
    <p>SBMs are the simplest form of generative network models for community structures and can also accommodate hierarchies
<sup><xref rid="ref-25" ref-type="bibr">25</xref></sup>, which are key to convey robustness to biological function. Other generative model approaches relying on scale-freeness of the network architecture have been used for edge prediction in protein-protein interaction networks
<sup><xref rid="ref-15" ref-type="bibr">15</xref></sup>, and the SBM has been used for representing other types of networks
<sup><xref rid="ref-17" ref-type="bibr">17</xref>,
<xref rid="ref-18" ref-type="bibr">18</xref>,
<xref rid="ref-26" ref-type="bibr">26</xref>,
<xref rid="ref-27" ref-type="bibr">27</xref></sup>, but not yet for biomolecular networks. In generative network model approaches, the network is described by a stringent mathematical framework based on statistical assumptions on network characteristics. For the case of the stochastic block model, this step delivers already the modular structure of the network as the nodes are assigned to blocks according to their connectivity properties to all other nodes. In contrast to other module detection methods, blocks in the SBM are not necessarily formed by tightly intra-connected entities but by entities which interact similarly with the nodes from all other blocks. Therefore, comparing SBM-derived modules between networks representing different (e.g. biomedical) conditions could be especially informative to shed light on regulatory changes. In a second step, the mathematical representation of the networks by SBMs is exploited to estimate edge probabilities. Specifically, it is assessed whether the existence of an edge in the network improves or reduces the fit of the network to the SBM. The resulting edge confidence scores are based on global network structure and can be used as alternative measure of edge relevance.</p>
    <p>The key challenge we address here was to investigate the capability of SBMs for representing and analyzing different types of biomolecular networks. We aimed to assess to which extent the SBM is applicable to derive useful information in terms of (i) relevant clustering as well as (ii) network-based, alternative edge scores. Therefore, we showcased the SBM-based analysis (overview in
<xref ref-type="fig" rid="f1">Figure 1A</xref>) for three biomolecular networks of different molecular types, derived from either transcriptomic, proteomic or metabolomics data of breast cancer tumours. We assessed which of the different versions of SBM fits each data layer best. Then, we investigated whether the SBM representation is able to capture functionally relevant structures in our biomolecular networks. In detail, we determined the agreement between the predicted blocks and independent biomolecular functional annotations from databases, compared the SBM-predicted function to breast cancer signatures and showed how to derive additional predictions from SBM-based clusters. Finally, we took advantage of the description of the networks as SBMs for the computation of an edge confidence score for each edge as measure of edge relevance. The edge confidence scores can be exploited to re-establish erroneously removed edges or to remove spurious edges, or they could serve by themselves for deriving disease-relevant differences when comparing groups of patients.</p>
    <fig fig-type="figure" id="f1" orientation="portrait" position="anchor">
      <label>Figure 1. </label>
      <caption>
        <title>Analysis of correlation-based networks from different omics data: Pipeline and network preparation.</title>
        <p>(
<bold>A</bold>) Pipeline for the approach. Given the matrix of measurements of mRNA expression, protein expression or metabolite abundance for a group of samples (I), we compute a fully-connected weighted network (II) of the molecular species for each data layer separately using a correlation-based approach. We reduce the networks by setting a threshold to the edge weights and binarize the networks (III). Each network is fitted to different types of stochastic block models in which the network nodes are partitioned into blocks (IV), the best fitting model is employed for deriving SBM-based edge confidence scores (V). (
<bold>B</bold>) We established correlation-based networks using Spearman’s correlation within mRNA expression, protein expression and metabolite biomolecular data from a subgroup of cancer patients. Shown are histograms of the correlations obtained for all edges of the networks. (
<bold>C</bold>) We only kept edges in the network that had a correlation which differed significantly from zero (sign. corr.). For different multiple testing correction methods (BH: Benjamini-Hochberg, BF: Bonferroni) and significance levels (0.05, 0.01), different degrees of reduction can be achieved. We chose for each data layer the most stringent threshold (highlighted in blue) that reduced the edge count to less than 10
<sup>7</sup> edges (left) while keeping the percentage of nodes in the largest connected component high (right). (
<bold>D</bold>) Scale-free fit indices
<italic>R</italic>
<sup>2</sup> according to
<xref rid="ref-3" ref-type="bibr">3</xref> for the mRNA (green), protein (blue), and metabolite (red) network reduced by different correlation thresholds between 0.3 and 0.95. The employed threshold of 0.85 for the scale-free fit index is indicated by a black line. (
<bold>E</bold>) Histogram of the node degrees of the networks reduced by criterion on significance of correlation (red) or on scale-freeness (blue) on double log-scale together with the scale-free fit indices
<italic>R</italic>
<sup>2</sup>. Networks are the more scale-free the more linear the relationship between log-frequency and log-node-degree is.</p>
      </caption>
      <graphic xlink:href="f1000research-8-22342-g0000"/>
    </fig>
    <p>Here we showcase the SBM-based analysis (overview in
<xref ref-type="fig" rid="f1">Figure 1A</xref>) for networks of three different molecular types, derived from transcriptomic, proteomic and metabolomics data of breast cancer tumours. We assessed which of the different versions of SBM fits each data layer best. Then, we investigated whether the SBM representation is able to capture functionally relevant structures in our biomolecular networks. In detail, we determined the agreement between the predicted blocks and independent biomolecular functional annotations from databases. Finally, we took advantage of the description of the networks as SBMs for the computation of an edge confidence score for each edge as measure of edge relevance. The edge confidence scores can be exploited to re-establish erroneously removed edges or to remove spurious edges, or they could serve by themselves for deriving disease-relevant differences when comparing groups of patients.</p>
    <p>All code is freely available on
<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/biomodlih/sbm-for-correlation-based-networks">https://gitlab.com/biomodlih/sbm-for-correlation-based-networks</ext-link>.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>mRNA, protein, metabolite data for ER- breast cancer tumors</title>
      <p id="ME1">Breast cancer mRNA expression from RNAseq was obtained from the TCGA BRCA cohort via RTCGA
<sup><xref rid="ref-28" ref-type="bibr">28</xref></sup> downloading TCGA level 3 preprocessed BRCA files (search term:
<italic>mRNAseq_Preprocess</italic>) on Nov 2, 2017. We used the normalized RSEM values. Protein data was obtained via the CPTAC homepage from the data generated in
<xref rid="ref-29" ref-type="bibr">29</xref>. We used the first replicate of samples measured in duplicates. We employed the unshared log ratio value for each sample to maximize reliability of protein identification. Clinical data for both TCGA and CPTAC data was retrieved and evaluated using the RTCGA package. Specifically, we used the following files for mRNA, protein and clinical data, respectively:</p>
      <list list-type="bullet">
        <list-item>
          <p>
            <italic>gdac.broadinstitute.org_BRCA.mRNAseq_Preprocess.Level_3.2016012800.0.0/ BRCA.uncv2.mRNAseq_RSEM_normalized_log2.txt</italic>
          </p>
        </list-item>
        <list-item>
          <p>
            <italic>TCGA_Breast_BI_Proteome_CDAP_Protein_Report.r3/Protein_data/CDAP/TCGA_Breast_BI_Proteome.itraq.tsv</italic>
          </p>
        </list-item>
        <list-item>
          <p><italic>gdac.broadinstitute.org_BRCA.Merge_Clinical.Level_1.2016012800.0.0/BRCA.clin.merged.txt</italic>.</p>
        </list-item>
      </list>
      <p>For both mRNA and protein data, we only used samples from patients whose entry "patient.breast_carcinoma_estrogen_receptor_status" in their clinical data was "negative". In addition, we restricted our analysis to solid tumour samples, i.e. TCGA sample identifiers ending with 01. This gave rise to 237 samples with 18321 measured genes for the mRNA data and 36 samples with 10625 measured proteins for the protein data.</p>
      <p>Metabolite data was used from the Excel file provided in
<xref rid="ref-30" ref-type="bibr">30</xref> using the measurements of 162 metabolites in the 67 samples containing ERn in their label.</p>
    </sec>
    <sec>
      <title>Missing values</title>
      <p>We removed missing values in the mRNA data by replacing them by -10 to account for the fact that they arose from logarithmizing read counts of zero. In the protein data, we removed the 2195 proteins which had more than 20% of missing values over the considered samples (i.e. more than 7 NAs among the 36 samples), resulting in 8430 measured proteins that we analyzed further. The metabolite data did not contain missing values as imputation had been performed in the original
publication
<sup><xref rid="ref-30" ref-type="bibr">30</xref></sup>.</p>
    </sec>
    <sec>
      <title>Network generation</title>
      <p>We used the correlation computation from the Hmisc package
<sup><xref rid="ref-31" ref-type="bibr">31</xref></sup> (function
<italic>rcorr</italic>) to determine Spearman’s correlation of the measurements of each pair of entities (mRNA, protein or metabolite) over all samples. Only pairwise complete observations were employed. Unless stated otherwise, we neglected self-edges.</p>
    </sec>
    <sec>
      <title>Network reduction</title>
      <p>The Hmisc package
<sup><xref rid="ref-31" ref-type="bibr">31</xref></sup> was used to determine the p-value associated to the correlation (significance of the correlation being different from zero). For each data layer, we assessed four different combinations of multiple testing correction and significance thresholds: Bonferroni or Benjamini-Hochberg
<sup><xref rid="ref-32" ref-type="bibr">32</xref></sup> multiple testing correction combined with significance thresholds of 0.01 or 0.05. The resulting reduced networks were characterized in terms of edge count and largest connected component. For each data layer, the network was chosen that yielded a sufficient degree of reduction (&lt; 10
<sup>7</sup> edges) to enable a sufficiently short computation time and memory consumption for the fit to SBM while maintaining at the same time a high percentage of nodes being connected to each other as would be expected in biological networks. Finally, Bonferroni correction was chosen for the mRNA network, Benjamini-Hochberg correction for the smaller protein and metabolite networks. Correlations were considered significantly different from zero for corrected p-values lower than 0.05 (mRNA, metabolite) or 0.01 (protein).</p>
      <p>For the reduction by imposing a scale-free architecture of the reduced network, we employed the
<italic>pickHardThreshold</italic> function of the WGCNA package
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup> with the default requirement (0.85) on goodness of fit to a power-law degree distribution of the nodes. Given the symmetric absolute correlation matrix of the network edges, this function reduces the network by one of a given set of edge thresholds at a time and determines the scale-free fit index
<italic>R</italic>
<sup>2</sup> which lies between 0 (bad fit) and 1 (perfect fit) by comparing the resulting degree distribution of the reduced network to a power-law degree distribution. The lowest of the tested edge thresholds that gives a scale-free fit index &gt; 0.85 is reported as estimated threshold. For the edge thresholds, we started with a grid with stepsize 0.05 between 0.3 and 0.95, refining according to the resulting estimates to vectors with stepsize 0.001 between 0.5 and 0.625 for the mRNA network, between 0.7 and 0.82 for the protein network, and between 0.3 and 0.4 for the metabolite network. Finally estimated edge correlation thresholds were 0.603 (mRNA), 0.788 (protein), and 0.375 (metabolite).</p>
    </sec>
    <sec>
      <title>Fit to SBM</title>
      <p>We employed four versions of the stochastic block model (SBM) derived from three SBM types (classical, degree-corrected, hierarchical SBM) and their Bayesian description
<sup><xref rid="ref-33" ref-type="bibr">33</xref>,
<xref rid="ref-34" ref-type="bibr">34</xref></sup>. In the classical SBM
<sup><xref rid="ref-24" ref-type="bibr">24</xref></sup>, the model is fully defined by a partition
<italic>b</italic> of the nodes into blocks and the matrix
<italic>e</italic> = {
<italic>e
<sub>rs</sub></italic>} of the numbers of edges between blocks (with
<italic>e
<sub>rr</sub></italic> being double the edge count within a block for convenience). We employ microcanonical formulations which imposes hard constraints on the values of the model parameters according to the observed graph
<italic>G</italic>
<sup><xref rid="ref-34" ref-type="bibr">34</xref></sup>. Given a graph
<italic>G</italic> and a partition
<italic>b</italic>, the probability that the graph was generated with the observed edge count matrix
<italic>e</italic>,
<italic>P</italic>(
<italic>G|b</italic>), can be described as</p>
      <p>
        <disp-formula id="e1">
          <mml:math id="math1">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mtext>(</mml:mtext>
              <mml:mi>G</mml:mi>
              <mml:mtext>|</mml:mtext>
              <mml:mi>b</mml:mi>
              <mml:mtext>)</mml:mtext>
              <mml:mo>=</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mtext>(</mml:mtext>
              <mml:mi>G</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mi>e</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>b</mml:mi>
              <mml:mtext>)</mml:mtext>
              <mml:mo>⋅</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>e</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mtext>.</mml:mtext>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Thereby,
<italic>P</italic>(
<italic>A|C</italic>,
<italic>D</italic>) denotes the probability of
<italic>A</italic> given
<italic>C</italic> and
<italic>D</italic>. With
<italic>A</italic> = {
<italic>A
<sub>ij</sub></italic>} being the adjacency matrix of the (multi)graph
<italic>G</italic>, with
<inline-formula><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> the number of edges adjacent to block
<italic>r</italic>, and
<italic>n
<sub>r</sub></italic> the number of nodes in block
<italic>r</italic> according to the partition
<italic>b</italic>, we employ</p>
      <p>
        <disp-formula id="e2">
          <mml:math id="math2">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mi>e</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>b</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mstyle displaystyle="true">
                    <mml:msub>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                        <mml:mo>&lt;</mml:mo>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mstyle displaystyle="true">
                        <mml:msub>
                          <mml:mo>∏</mml:mo>
                          <mml:mi>r</mml:mi>
                        </mml:msub>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>e</mml:mi>
                            <mml:mrow>
                              <mml:mi>r</mml:mi>
                              <mml:mi>r</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mspace width="0.2em"/>
                          <mml:mo>!</mml:mo>
                          <mml:mo>!</mml:mo>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle displaystyle="true">
                    <mml:msub>
                      <mml:mo>∏</mml:mo>
                      <mml:mi>r</mml:mi>
                    </mml:msub>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>n</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>e</mml:mi>
                            <mml:mi>r</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mstyle displaystyle="true">
                        <mml:msub>
                          <mml:mo>∏</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>&lt;</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>A</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mspace width="0.2em"/>
                          <mml:mo>!</mml:mo>
                          <mml:mspace width="0.2em"/>
                          <mml:mstyle displaystyle="true">
                            <mml:msub>
                              <mml:mo>∏</mml:mo>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>A</mml:mi>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mspace width="0.2em"/>
                              <mml:mo>!</mml:mo>
                              <mml:mo>!</mml:mo>
                            </mml:mrow>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>using the definition (2
<italic>m</italic>)!! = 2
<italic><sup>m</sup> · m</italic>!. In addition, for
<italic>n
<sub>e</sub></italic> = 2
<italic>E/</italic>(
<italic>B</italic>(
<italic>B</italic>+1)) the expected total number of edges with
<italic>E</italic> the number of edges in graph
<italic>G</italic>, and
<italic>B</italic> the number of non-empty blocks in partition
<italic>b</italic> the prior distribution on the edges is given by:</p>
      <p>
        <disp-formula id="e3">
          <mml:math id="math3">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>e</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>n</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>E</mml:mi>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mi>e</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>E</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>B</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>B</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>/</mml:mo>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>·</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Please refer to Peixoto, 2017
<sup><xref rid="ref-34" ref-type="bibr">34</xref></sup> for a detailed derivation and explanation. Note that for our networks, as we only use simple graphs and do not consider self-edges, i.e.
<italic>A
<sub>ij</sub></italic> ∈ {0, 1} and
<italic>A
<sub>ii</sub></italic> = 0, the product
<inline-formula><mml:math id="M2"><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mo>!</mml:mo><mml:mspace width="0.2em"/></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mo>!</mml:mo><mml:mo>!</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> simplifies to 1. The prior for the partition
<italic>b</italic> is derived from sampling the number of non-empty blocks
<italic>B</italic> as
<italic>P</italic>(
<italic>B</italic>) = 1
<italic>/N</italic> with
<italic>N</italic> the number of nodes in graph
<italic>G</italic>, then sample the distribution of block sizes
<italic>n
<sub>r</sub></italic> conditioned on
<italic>B</italic> and finally the partition
<italic>b</italic> conditioned on the former two which yields in total
<sup><xref rid="ref-34" ref-type="bibr">34</xref></sup>:</p>
      <p>
        <disp-formula id="e4">
          <mml:math id="math4">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>b</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mstyle displaystyle="true">
                    <mml:msub>
                      <mml:mo>∏</mml:mo>
                      <mml:mi>r</mml:mi>
                    </mml:msub>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mi>r</mml:mi>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mo>!</mml:mo>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>N</mml:mi>
                  <mml:mspace width="0.2em"/>
                  <mml:mo>!</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:msup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:mrow>
                              <mml:mi>B</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msup>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mi>N</mml:mi>
              </mml:mfrac>
              <mml:mo>·</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>A drawback of the classical SBM is that all nodes within a block are forced to have similar degrees which is not appropriate for most encountered real networks. Karrer and Newman proposed the degree-corrected SBM
<sup><xref rid="ref-35" ref-type="bibr">35</xref></sup> that is, in addition to the partition
<italic>b</italic> and the edge count matrix
<italic>e</italic>, defined by a degree sequence
<italic>k</italic> = {
<italic>k
<sub>i</sub></italic>} setting a degree for each node. Using the microcanonical formulation
<sup><xref rid="ref-34" ref-type="bibr">34</xref></sup>, we have</p>
      <p>
        <disp-formula id="e5">
          <mml:math id="math5">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mi>b</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mi>k</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>e</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>b</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mspace width="0.2em"/>
              <mml:mo>·</mml:mo>
              <mml:mspace width="0.2em"/>
              <mml:mi>P</mml:mi>
              <mml:mtext>(</mml:mtext>
              <mml:mi>k</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mi>e</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>b</mml:mi>
              <mml:mtext>)</mml:mtext>
              <mml:mspace width="0.2em"/>
              <mml:mo>·</mml:mo>
              <mml:mspace width="0.2em"/>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>e</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mtext>.</mml:mtext>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>with
<italic>P</italic>(
<italic>e</italic>) as above.
<italic>P</italic>(
<italic>G|k</italic>,
<italic>e</italic>,
<italic>b</italic>) is the probability of generating a graph
<italic>G</italic> where the edge counts as well as the degree sequence is fixed to a specific value given a certain partition
<italic>b</italic> and is given by</p>
      <p>
        <disp-formula id="e6">
          <mml:math id="math6">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mi>k</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>e</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>b</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mstyle displaystyle="true">
                    <mml:msub>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                        <mml:mo>&lt;</mml:mo>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mo>!</mml:mo>
                      <mml:mspace width="0.2em"/>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mstyle displaystyle="true">
                    <mml:msub>
                      <mml:mo>∏</mml:mo>
                      <mml:mi>r</mml:mi>
                    </mml:msub>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mi>r</mml:mi>
                      </mml:msub>
                      <mml:mi>r</mml:mi>
                      <mml:mspace width="0.2em"/>
                      <mml:mo>!</mml:mo>
                      <mml:mo>!</mml:mo>
                      <mml:mspace width="0.2em"/>
                      <mml:mstyle displaystyle="true">
                        <mml:msub>
                          <mml:mo>∏</mml:mo>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>k</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mspace width="0.2em"/>
                          <mml:mo>!</mml:mo>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle displaystyle="true">
                    <mml:msub>
                      <mml:mo>∏</mml:mo>
                      <mml:mi>r</mml:mi>
                    </mml:msub>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mi>r</mml:mi>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mo>!</mml:mo>
                      <mml:mo>!</mml:mo>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>·</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The prior we employ for the degree sequence is conditioned on the degree frequencies which are in turn sampled from a uniform hyperprior
<sup><xref rid="ref-34" ref-type="bibr">34</xref></sup>:</p>
      <p>
        <disp-formula id="e7">
          <mml:math id="math7">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>k</mml:mi>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mi>e</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>b</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mstyle displaystyle="true">
                <mml:munder>
                  <mml:mo>∏</mml:mo>
                  <mml:mi>r</mml:mi>
                </mml:munder>
                <mml:mrow>
                  <mml:mspace width="0.2em"/>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:msub>
                          <mml:mo>∏</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:msub>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>η</mml:mi>
                            <mml:mi>k</mml:mi>
                            <mml:mi>r</mml:mi>
                          </mml:msubsup>
                          <mml:mspace width="0.2em"/>
                          <mml:mo>!</mml:mo>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mi>r</mml:mi>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mo>!</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mstyle>
              <mml:mspace width="0.2em"/>
              <mml:mstyle displaystyle="true">
                <mml:munder>
                  <mml:mo>∏</mml:mo>
                  <mml:mi>r</mml:mi>
                </mml:munder>
                <mml:mrow>
                  <mml:mi>q</mml:mi>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mi>r</mml:mi>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.2em"/>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mi>r</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
              </mml:mstyle>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>with
<inline-formula><mml:math id="M3"><mml:mrow><mml:msubsup><mml:mi>η</mml:mi><mml:mi>k</mml:mi><mml:mi>r</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> the number of nodes of degree
<italic>k</italic> in block
<italic>r</italic> and
<italic>q</italic>(
<italic>n</italic>,
<italic>m</italic>) the number of partitions of
<italic>n</italic> elements into at most
<italic>m</italic> groups.</p>
      <p>The Bayesian approach as detailed by Peixoto
<sup><xref rid="ref-33" ref-type="bibr">33</xref>,
<xref rid="ref-34" ref-type="bibr">34</xref></sup> prevents overfitting but is prone to underfitting, meaning that statistically relevant structures may not be detected. In particular, the number of groups which can be resolved is limited such that small groups in very large networks can hardly be detected
<sup><xref rid="ref-34" ref-type="bibr">34</xref></sup>. A solution has been proposed via the hierarchical (or nested) SBM
<sup><xref rid="ref-25" ref-type="bibr">25</xref></sup>. Therein, the edge count matrix
<italic>e</italic> = {
<italic>e
<sub>rs</sub></italic>} is described with another SBM, i.e. the blocks of the first SBM are considered as nodes a second-level SBM which are partitioned into a second level of blocks, with the according second-level edge count matrix. The second-level SBM can again be described as another third-level SBM and so on,
<italic>L</italic> number of times, forming a nested hierarchy of SBMs.</p>
      <p>The joint distribution for the hierarchical microcanonical degree-corrected SBM is given by
<sup><xref rid="ref-34" ref-type="bibr">34</xref></sup>
</p>
      <p>
        <disp-formula id="e8">
          <mml:math id="math8">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>A</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>k</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mo>{</mml:mo>
              <mml:msub>
                <mml:mi>e</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:msub>
              <mml:mo>}</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mo>{</mml:mo>
              <mml:msub>
                <mml:mi>b</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:msub>
              <mml:mo>}</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>A</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mi>k</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mi>e</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mi>b</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>⋅</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>k</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:msub>
                <mml:mi>e</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mi>b</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>⋅</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mo>{</mml:mo>
              <mml:msub>
                <mml:mi>e</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:msub>
              <mml:mo>}</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>⋅</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mo>{</mml:mo>
              <mml:msub>
                <mml:mi>b</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:msub>
              <mml:mo>}</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>for
<italic>l</italic> ∈ {0, . . . ,
<italic>L</italic>}, with
<italic>e
<sub>l</sub></italic> the edge count matrix at level
<italic>l</italic>,
<italic>b
<sub>l</sub></italic> the partition at level
<italic>l</italic>. The according prior distributions are given as described above and in addition for the edge count by
<sup><xref rid="ref-34" ref-type="bibr">34</xref></sup>
</p>
      <p>
        <disp-formula id="e9">
          <mml:math id="math9">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mo stretchy="false">{</mml:mo>
              <mml:msub>
                <mml:mi>e</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:msub>
              <mml:mo stretchy="false">}</mml:mo>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mo stretchy="false">{</mml:mo>
              <mml:msub>
                <mml:mi>b</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:msub>
              <mml:mo stretchy="false">}</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mstyle displaystyle="true">
                <mml:munderover>
                  <mml:mo>∏</mml:mo>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mi>L</mml:mi>
                </mml:munderover>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>e</mml:mi>
                    <mml:mi>l</mml:mi>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mi>e</mml:mi>
                    <mml:mrow>
                      <mml:mi>l</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="0.2em"/>
                  <mml:msub>
                    <mml:mi>b</mml:mi>
                    <mml:mi>l</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mstyle>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>and imposing the boundary conditions
<italic>B
<sub>L</sub></italic> = 1 for the number of nonempty blocks at the highest level
<italic>L</italic>, and
<italic>P</italic>(
<italic>b
<sub>L</sub></italic> ) = 1. Thereby,</p>
      <p>
        <disp-formula id="e10">
          <mml:math id="math10">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mi>e</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:msub>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:msub>
                <mml:mi>e</mml:mi>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mi>b</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mstyle displaystyle="true">
                <mml:munder>
                  <mml:mo>∏</mml:mo>
                  <mml:mrow>
                    <mml:mi>r</mml:mi>
                    <mml:mo>&lt;</mml:mo>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:munder>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mtable>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mi>n</mml:mi>
                                    <mml:mi>r</mml:mi>
                                    <mml:mi>l</mml:mi>
                                  </mml:msubsup>
                                  <mml:msubsup>
                                    <mml:mi>n</mml:mi>
                                    <mml:mi>s</mml:mi>
                                    <mml:mi>l</mml:mi>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mi>e</mml:mi>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                      <mml:mi>s</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>l</mml:mi>
                                      <mml:mo>+</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mo>∏</mml:mo>
                      <mml:mi>r</mml:mi>
                    </mml:munder>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mtable>
                                <mml:mtr>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:msubsup>
                                        <mml:mi>n</mml:mi>
                                        <mml:mi>r</mml:mi>
                                        <mml:mi>l</mml:mi>
                                      </mml:msubsup>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:msubsup>
                                        <mml:mi>n</mml:mi>
                                        <mml:mi>r</mml:mi>
                                        <mml:mi>l</mml:mi>
                                      </mml:msubsup>
                                      <mml:mo>+</mml:mo>
                                      <mml:mn>1</mml:mn>
                                      <mml:mo stretchy="false">)</mml:mo>
                                      <mml:mo>/</mml:mo>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                                <mml:mtr>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:msubsup>
                                        <mml:mi>e</mml:mi>
                                        <mml:mrow>
                                          <mml:mi>r</mml:mi>
                                          <mml:mi>r</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>l</mml:mi>
                                          <mml:mo>+</mml:mo>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                      </mml:msubsup>
                                      <mml:mo>/</mml:mo>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                              </mml:mtable>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
              </mml:mstyle>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>with
<inline-formula><mml:math id="M4"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>m</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the number of combinations of
<italic>m</italic> elements with repetitions from a set of
<italic>n</italic> elements. For the prior distribution of the hierarchical partitions, we employ</p>
      <p>
        <disp-formula id="e11">
          <mml:math id="math11">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mo stretchy="false">{</mml:mo>
              <mml:msub>
                <mml:mi>b</mml:mi>
                <mml:mi>l</mml:mi>
              </mml:msub>
              <mml:mo stretchy="false">}</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mstyle displaystyle="true">
                <mml:munderover>
                  <mml:mo>∏</mml:mo>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mi>L</mml:mi>
                </mml:munderover>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>b</mml:mi>
                    <mml:mi>l</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mstyle>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>using the equation for
<italic>P</italic>(
<italic>b</italic>) from above with the block and node counts for the respective level
<italic>l</italic> and the boundary condition
<italic>B</italic>
<sub>0</sub> =
<italic>N</italic>. The hierarchical model without degree correction is obtained by replacing
<italic>P</italic>(
<italic>A|k</italic>,
<italic>e</italic>
<sub>1</sub>,
<italic>b</italic>
<sub>1</sub>)
<italic>· P</italic>(
<italic>k|e</italic>
<sub>1</sub>,
<italic>b</italic>
<sub>1</sub>) by
<italic>P</italic>(
<italic>A|e</italic>
<sub>1</sub>,
<italic>b</italic>
<sub>1</sub>).</p>
      <p>Here, we examine four SBM versions: the classical SBM, the degree-corrected SBM, the hierarchical SBM and the degree-corrected &amp; hierarchical SBM. For fitting the SBM to one of these four SBMs (i.e. in order to determine the most probable (hierarchical) partition given the data), we converted the adjacency matrices of the reduced networks to edge lists in
<italic>csv</italic> format, added the disconnected nodes and fed the resulting networks as graphs into the Python graph-tool
<sup><xref rid="ref-36" ref-type="bibr">36</xref></sup> framework. Initializing a partition according to the prior distribution of the partitions from above and using an agglomerative multi-level Markov Chain Monte Carlo algorithm
<sup><xref rid="ref-37" ref-type="bibr">37</xref></sup>, that module allows for determining a (potentially hierarchical) partition,
<italic>b</italic>, of the network,
<italic>G</italic>, which minimizes the description length,
<italic>DL</italic>, of the SBM
<sup><xref rid="ref-33" ref-type="bibr">33</xref></sup>:</p>
      <p>
        <disp-formula id="e12">
          <mml:math id="math12">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>D</mml:mi>
                  <mml:mi>L</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>log</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>G</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>λ</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>log</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>λ</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mspace width="1.1em"/>
                  <mml:mo>=</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>log</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>G</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>λ</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>⋅</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>λ</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mspace width="1.1em"/>
                  <mml:mo>=</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>log</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>G</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>⋅</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>log</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>G</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>⋅</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>G</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mtext>.</mml:mtext>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>Thereby,
<italic>λ</italic> captures all parameters of the model apart from the partition, such as the number of edges between blocks and degree distribution parameters for the degree-corrected SBM, in their planar or hierarchical version. Note that the above relationship holds only under a microcanonical formulation of the priors, i.e. hard constraints imposed on the values of the model parameters
<italic>λ</italic> by the structure of the network
<italic>G</italic> the SBM is fitted to (see
<xref rid="ref-33" ref-type="bibr">33</xref>,
<xref rid="ref-34" ref-type="bibr">34</xref>), which enables considering only one value for the parameter
<italic>λ</italic> for a given partition
<italic>b</italic> and thus</p>
      <p>
        <disp-formula>
          <mml:math id="math13">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mi>b</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mi>λ</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mspace width="0.2em"/>
              <mml:mi>b</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>⋅</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>λ</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>.</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Because the probability of the network itself,
<italic>P</italic>(
<italic>G</italic>), is constant for a fixed observed network, the description length is monotonously inversely related to the probability that partition
<italic>b</italic> is responsible for the observed network
<italic>G</italic>,
<italic>P</italic>(
<italic>b|G</italic>). Therefore, finding the partition which minimizes the description length is equivalent to finding the partition with maximal posterior probability,
<italic>P</italic>(
<italic>b|G</italic>). Furthermore, as can be seen in its second term in the first line, the description length
<italic>DL</italic> contains a "penalty" term for the complexity of the SBM description. Thus, it can be used to distinguish which of the four examined SBM types (classical, hierarchical, degree-corrected, hierarchical+degree-corrected) is most suitable to describe the network
<italic>G</italic>. Due to the large sizes of the networks, sampling over the posterior distribution is costly. Therefore, we decided to compare different SBM versions using only the estimated maximum of the posterior, i.e. at the partition
<italic>b</italic> with the lowest minimal description length, in the expression of the posterior odds ratio
<sup><xref rid="ref-33" ref-type="bibr">33</xref></sup>. Assuming that both SBM types that are compared,
<italic>SBM</italic>
<sub>1</sub> and
<italic>SBM</italic>
<sub>2</sub>, are equally probable
<italic>a priori</italic>,
<italic>P</italic>(
<italic>SBM</italic>
<sub>1</sub>) =
<italic>P</italic>(
<italic>SBM</italic>
<sub>2</sub>), we obtain for the posterior odds ratio Λ
<sup><xref rid="ref-33" ref-type="bibr">33</xref></sup>:</p>
      <p>
        <disp-formula>
          <mml:math id="math14">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>∧</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.2em"/>
                      <mml:mi>S</mml:mi>
                      <mml:mi>B</mml:mi>
                      <mml:msub>
                        <mml:mi>M</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:mi>G</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.2em"/>
                      <mml:mi>S</mml:mi>
                      <mml:mi>B</mml:mi>
                      <mml:msub>
                        <mml:mi>M</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:mi>G</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>G</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.2em"/>
                      <mml:mi>S</mml:mi>
                      <mml:mi>B</mml:mi>
                      <mml:msub>
                        <mml:mi>M</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>S</mml:mi>
                      <mml:mi>B</mml:mi>
                      <mml:msub>
                        <mml:mi>M</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>G</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.2em"/>
                      <mml:mi>S</mml:mi>
                      <mml:mi>B</mml:mi>
                      <mml:msub>
                        <mml:mi>M</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>S</mml:mi>
                      <mml:mi>B</mml:mi>
                      <mml:msub>
                        <mml:mi>M</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mspace width="1em"/>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>G</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.2em"/>
                      <mml:mi>S</mml:mi>
                      <mml:mi>B</mml:mi>
                      <mml:msub>
                        <mml:mi>M</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>G</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.2em"/>
                      <mml:mi>S</mml:mi>
                      <mml:mi>B</mml:mi>
                      <mml:msub>
                        <mml:mi>M</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mn>2</mml:mn>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>D</mml:mi>
                      <mml:msub>
                        <mml:mi>L</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mi>−</mml:mi>
                      <mml:mi>D</mml:mi>
                      <mml:msub>
                        <mml:mi>L</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>We can consider the SBM type with the lowest minimal description length most likely; the distance of the posterior odds ratio to 1 determines how much more likely it is than the other SBM type.</p>
      <p>We performed 500 runs with random initial partitions for each of the four SBM types and each of the six networks. The SBM type with lowest minimal description length was used for further analyses.</p>
    </sec>
    <sec>
      <title>Overrepresentation analysis</title>
      <p>Within the mRNA and protein networks, biological annotation of the blocks and overrepresentation was performed using Reactome pathways and the package ReactomePA
<sup><xref rid="ref-38" ref-type="bibr">38</xref></sup>. We restricted our analysis to Reactome pathways containing at least 10 and at most 500 annotated genes, all entities of the network were used as background. We employed Benjamini-Hochberg multiple-testing correction. Pathways were considered overrepresented for default settings (p-value &lt; 0.05, q-value &lt; 0.2), and only human pathways occurring in the file from the Reactome database,
<ext-link ext-link-type="uri" xlink:href="https://reactome.org/download/current/ReactomePathwaysRelation.txt">https://reactome.org/download/current/ReactomePathwaysRelation.txt</ext-link> (downloaded June 6, 2018,
<xref rid="ref-39" ref-type="bibr">39</xref>), were used. This file was also employed as representation of the Reactome hierarchy to determine distances between Reactome pathways.</p>
      <p>For the metabolite dataset, we mapped the pubchem IDs and metabolite names to KEGG compound IDs using the MBRole webserver version 2
<sup><xref rid="ref-40" ref-type="bibr">40</xref></sup> and merged them semi-manually, thereby preferring metabolite names (in case of mismatch with pubchem record) and KEGG IDs with pathway annotation. We downloaded the human KEGG pathway annotation for the mapped metabolites from MBRole and used it as user-defined annotation for overrepresentation analysis with the
<italic>enricher</italic> function from the package clusterProfiler
<sup><xref rid="ref-41" ref-type="bibr">41</xref></sup>. We only considered pathways with a minimal size of 2 and otherwise the same settings as for mRNA and protein overrepresentation analysis.</p>
    </sec>
    <sec>
      <title>Comparison to breast cancer signatures and summarizing biological function</title>
      <p>For comparison to known biological functions relevant to breast cancer, we downloaded those gene sets from the MSigDB database v6.2
<sup><xref rid="ref-42" ref-type="bibr">42</xref></sup>, gene set collection C6, oncogenic signatures, that arose for the search terms "breast AND (cancer OR carcinoma)" on the MSigDB web interface (17 gene sets in total, search and download on July 31, 2019). We computed the Reactome pathways that are overrepresented in any of these gene sets (as described in section "Overrepresentation analysis"). The resulting 43 Reactome pathways were assorted according to their Reactome parent pathways (top level Reactome pathways) and, for each single pathway, its occurrence among pathways overrepresented in SBM-predicted blocks was counted.</p>
      <p>For summarizing biological function, we mapped each overrepresented Reactome pathway to its parent Reactome pathway (top-level pathway). For each network and each hierarchy level, we counted the number of occurrence of each Reactome parent pathway among the Reactome pathways overrepresented in any of the SBM-derived blocks. We normalized these counts to the total number of overrepresented pathways in the blocks of the network and hierarchy level in order to obtain the percentage of each Reactome parent pathway. Note that we counted the same pathway multiple times if it was overrepresented in multiple SBM-derived blocks. In order to account for the different sizes of the Reactome parent pathways, we further divided the percentage of a Reactome parent pathway for a network and hierarchy level as described above by the percentage of all Reactome pathways that are associated to the Reactome parent pathway. This latter percentage is for example high for "metabolism" and "signal transduction" and low for "chromatin organization" and "circadian clock".</p>
    </sec>
    <sec>
      <title>Distance measures of Reactome terms and within hierarchical SBMs</title>
      <p>We employed two distance measures of Reactome pathways considering the graph given by the Reactome familial hierarchy tree: (i) the distance in terms of number of steps necessary in the Reactome hierarchy graph to reach from one pathway to the other (distance 1), and (ii) the hierarchy level of the lowest common ancestor, or least common subsumer, for ontology graphs (distance 2). We incorporated an artificial top-Reactome pathway into the hierarchy to connect all pathways
with each other and to have our distance measures well-defined. It lies at the 10th hierarchy level, so the largest distance between two pathways is 10 for distance 1 and 18 for distance 2 (nine steps to the highest level and nine back). For all comparisons, only blocks with at least one overrepresented pathway were considered. For comparing the distances of Reactome pathway annotations between blocks, i.e. to associate a distance to a pair of blocks, we median-averaged the distances over all combinations of Reactome pathways associated to the two blocks. For distances of pathway annotations within blocks, we median-averaged the distances between all possible combination of different Reactome pathways associated to the block. The trivial distances of zero for the distance of a Reactome pathway to itself were omitted, as well as blocks with only one overrepresented Reactome pathway for intra-block distances. Distances between blocks in the SBM hierarchy, as employed in
<xref ref-type="fig" rid="f3">Figure 3D</xref>, were defined analogously to the distance measure (i) based on the graph of the SBM hierarchy.</p>
    </sec>
    <sec>
      <title>WGCNA clustering</title>
      <p>Alternative clustering using the WGCNA package
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup> was performed following the WGCNA tutorial on clustering. We employed the full correlation matrices including self-edges. First, the correlation values were scaled to values between zero and 1 (by (1+corr)/2), and the soft threshold delivering scale free network topology was determined using the
<italic>pickSoftThreshold.fromSimilarity</italic> function with default settings. Power estimates were 8, 16 and 12 for the mRNA, protein and metabolite network, respectively. We calculated the dissimilarity using
<italic>TomSimilarity</italic> on the soft thresholded correlation matrix, used
<italic>hclust</italic> with method "average" and
<italic>cutreeDynamic</italic> with "deepSplit" parameter of 4 (mRNA) or 2 (else), "pamRespectsDendro" set to FALSE and "minClusterSize" of 3 (for mRNA, metabolite) or 4 (for proteins) to make the clustering most similar to the one obtained from the SBM.</p>
    </sec>
    <sec>
      <title>Edge prediction</title>
      <p>We aim to derive edge confidence scores for each single edge in the network exploiting the representation of the network as SBM. Let us consider a fixed network given as graph
<italic>G</italic>. If
<italic>δG</italic> is a set of edges which do or do not occur in the network
<italic>G</italic>, the probability that these edges belong to the observed network (for edges missing in
<italic>G</italic>) or do not belong to the observed network (for edges from
<italic>G</italic>),
<italic>P</italic>(
<italic>δG</italic>,
<italic>G</italic>), can be written as
<sup><xref rid="ref-27" ref-type="bibr">27</xref></sup>:</p>
      <p>
        <disp-formula>
          <mml:math id="math15">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>δ</mml:mi>
              <mml:mi>G</mml:mi>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>∝</mml:mo>
              <mml:mstyle displaystyle="true">
                <mml:munder>
                  <mml:mo>∑</mml:mo>
                  <mml:mi>b</mml:mi>
                </mml:munder>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>G</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>δ</mml:mi>
                      <mml:mi>G</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mi>b</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>G</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mi>b</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mstyle>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>b</mml:mi>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>for
<italic>b</italic> being partitions of the network
<italic>G</italic> (please refer to
<italic>Fit to SBM</italic> for further information on notation). The derivation assumes that the original network,
<italic>G</italic> and the altered network with edges in
<italic>δG</italic> added or removed,
<italic>G</italic> +
<italic>δG</italic>, has been generated by some SBM type (and all probabilities are conditional on that SBM type), and that the set
<italic>δG</italic> has been chosen by some uniform distribution among all possible edges. The proportionality factor between the expressions depends on the network G and the number of edges in
<italic>δG</italic>, and thus can be in particular neglected if only comparing edge confidences between single edges of a network. Because we aim to score all edges, and due to the sizes of the networks making computations slow, we refrained from sampling over the posterior distribution of the partitions and instead employed the single-point approximation for edge
prediction proposed in
<xref rid="ref-27" ref-type="bibr">27</xref>:</p>
      <p>
        <disp-formula>
          <mml:math id="math16">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>δ</mml:mi>
              <mml:mi>G</mml:mi>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>∝</mml:mo>
              <mml:mstyle displaystyle="true">
                <mml:munder>
                  <mml:mo>∑</mml:mo>
                  <mml:mi>b</mml:mi>
                </mml:munder>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>G</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>δ</mml:mi>
                      <mml:mi>G</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mi>b</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>G</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mi>b</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mstyle>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>b</mml:mi>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>≈</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>G</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mi>δ</mml:mi>
                  <mml:mi>G</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:msup>
                    <mml:mi>b</mml:mi>
                    <mml:mo>*</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>G</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:msup>
                    <mml:mi>b</mml:mi>
                    <mml:mo>*</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msup>
                <mml:mi>b</mml:mi>
                <mml:mo>*</mml:mo>
              </mml:msup>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>.</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>It resorts to neglecting the summands for all partitions except for the one,
<italic>b*</italic>, which contributes most to the posterior distribution,
<italic>b*</italic> =
<italic>max
<sub>b</sub>P</italic>(
<italic>b</italic>|
<italic>G</italic>). In addition, the approximation relies on the assumption that the estimated optimal partition for the representation of
<italic>G</italic> by the SBM is the same for
<italic>G</italic> and its altered version with added or removed edge,
<italic>G</italic> +
<italic>δG</italic>, which is reasonable for our application case of single edge predictions, i.e. for
<italic>δG</italic> being composed of a single putatively missing or spurious edge. The term
<italic>P</italic>(
<italic>b*|G</italic>) can be considered constant for a fixed
<italic>G</italic> and SBM type, so we can shift it to the proportionality factor. Considering the microcanonical formulation of the SBM (see
<italic>Fit to SBM</italic>), it becomes clear that the edge predictions for
<italic>δG</italic> directly depend on the difference between the description length of the original network
<italic>G</italic> with partition
<italic>b*</italic>,
<italic>DL</italic>
<sub><italic>G,b*</italic></sub>, and the description length of the altered network
<italic>G</italic> +
<italic>δG</italic> with partition
<italic>b*</italic>,
<italic>DL</italic>
<sub><italic>G</italic>+
<italic>δG</italic>,
<italic>b*</italic></sub>
<sup><xref rid="ref-27" ref-type="bibr">27</xref></sup>:</p>
      <p>
        <disp-formula>
          <mml:math id="math17">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>δ</mml:mi>
              <mml:mi>G</mml:mi>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>∝</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>G</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mi>δ</mml:mi>
                  <mml:mi>G</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:msup>
                    <mml:mi>b</mml:mi>
                    <mml:mo>*</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>G</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:msup>
                    <mml:mi>b</mml:mi>
                    <mml:mo>*</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>G</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mi>δ</mml:mi>
                  <mml:mi>G</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:msup>
                    <mml:mi>b</mml:mi>
                    <mml:mo>*</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msup>
                    <mml:mi>b</mml:mi>
                    <mml:mo>*</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>G</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:msup>
                    <mml:mi>b</mml:mi>
                    <mml:mo>*</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msup>
                    <mml:mi>b</mml:mi>
                    <mml:mo>*</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msup>
                    <mml:mn>2</mml:mn>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mi>D</mml:mi>
                      <mml:msub>
                        <mml:mi>L</mml:mi>
                        <mml:mrow>
                          <mml:mi>G</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>δ</mml:mi>
                          <mml:mi>G</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>b</mml:mi>
                          <mml:mo>*</mml:mo>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
                <mml:mrow>
                  <mml:msup>
                    <mml:mn>2</mml:mn>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mi>D</mml:mi>
                      <mml:msub>
                        <mml:mi>L</mml:mi>
                        <mml:mrow>
                          <mml:mi>G</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>b</mml:mi>
                          <mml:mo>*</mml:mo>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>=</mml:mo>
              <mml:msup>
                <mml:mn>2</mml:mn>
                <mml:mrow>
                  <mml:mi>D</mml:mi>
                  <mml:msub>
                    <mml:mi>L</mml:mi>
                    <mml:mrow>
                      <mml:mi>G</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>b</mml:mi>
                      <mml:mo>*</mml:mo>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>−</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:msub>
                    <mml:mi>L</mml:mi>
                    <mml:mrow>
                      <mml:mi>G</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>δ</mml:mi>
                      <mml:mi>G</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>b</mml:mi>
                      <mml:mo>*</mml:mo>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:msup>
              <mml:mo>.</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The difference between the description lengths,
<italic>DL</italic>
<sub><italic>G</italic>,
<italic>b*</italic></sub> −
<italic>DL</italic>
<sub><italic>G</italic>+
<italic>δG</italic>,
<italic>b*</italic></sub>, was computed via the function
<italic>get_edges_prob</italic> from graph-tool
<sup><xref rid="ref-36" ref-type="bibr">36</xref></sup>. Note that as of time of writing,
<italic>get_edges_prob</italic> does not work for weighted SBMs with real-normal edge covariate (see filed issue #452 at
<italic>graph-tool.skewed.de</italic>). In addition, this function employs the natural (instead of the dual) logarithm and consequently, the obtained value has to be scaled by log
<sub>2</sub>(
<italic>e</italic>) to obtain the plain difference of description lengths.</p>
      <p>In order to make clear that neither these edge predictions nor their dual (or natural) logarithm correspond to actual probabilities, we used the term edge confidence scores or simply edge scores throughout the manuscript.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Data preparation, network generation, and reduction</title>
      <p>We showcase the SBM-based analysis for data from a subgroup of breast cancer patients: those with estrogen receptor negative (ER-) tumours. ER status is predictive of patient outcome, with ER- leading to unfavourable prognoses, and its assessment is part of standard breast cancer patient screening
<sup><xref rid="ref-43" ref-type="bibr">43</xref>–
<xref rid="ref-45" ref-type="bibr">45</xref></sup>. We used three types of molecules reflecting different characteristics
of tumorous tissue or cells: mRNAs, proteins or metabolites. These are key cellular molecules that are widely applied, in isolation or in combinations, in different biomedical research domains. Their abundance and interconnectedness in networks are therefore of high interest if aiming to characterize cells or tumorous tissue.</p>
      <p>Other potential data types could be e.g. mutations, copy number variation, DNA methylation or miRNAs, which are interesting avenues to further explore. While they could be useful, there are some caveats associated with them, e.g.: the derived interactions within layers are even less directly interpretable than for mRNA, protein or metabolite; networks generated from mutations and copy number variation are extremely sparse; the functional interpretation of DNA methylation data relies
on mRNA expression and the resulting networks are extremely big; the roles of miRNAs are less well known. Therefore, we decided to restrict our analyses to the three biomolecular entities mRNA, proteins and metabolites.</p>
      <p>The Cancer Genome Atlas (TCGA) initiative has provided data on the mRNA level (from RNAseq) for 237 ER- breast cancer patient tissue samples; mass-spectrometry-based proteomic data (4plex iTRAQ) are available for a subgroup of 36 patients
<sup><xref rid="ref-29" ref-type="bibr">29</xref></sup>. Metabolomics data have been measured by GC-TOF-MS in a different breast cancer cohort study for 67 samples
<sup><xref rid="ref-30" ref-type="bibr">30</xref></sup>. We treated each measured entity as node and established a correlation-based, weighted, biomolecular network for each single measurement layer. Therein, each pair of nodes is connected by an edge for which the weight is determined by Spearman’s correlation of the measurements of the nodes (over the samples), delivering values between -1 and 1. Thus, an edge that connects nodes with a correlation close to 1 or close to -1 represents strong positive regulation and strong negative regulation, respectively; edges connecting nodes with a correlation close to zero represent weak or absent regulation. We employed Spearman’s correlation because it captures also non-linear relationships between measurements, and it is robust to outliers and any monotonous transformation (e.g. logarithmization). We dealt with missing values in the data by replacing them by small values (only for NAs due to log transformation of zero counts in the mRNA data) or removing entities with &gt;20% missing values for all samples (for the protein data). Subsequently, we computed the correlation only considering pairwise complete observations. The distributions of the computed correlation values for the three data types are shown in
<xref ref-type="fig" rid="f1">Figure 1B</xref>.</p>
      <p>The resulting biomolecular networks capture the relationships of the intracellular machinery, and their analyses deliver important insights on altered regulations in disease states
<sup><xref rid="ref-2" ref-type="bibr">2</xref>,
<xref rid="ref-3" ref-type="bibr">3</xref></sup>. However, because these networks are fully connected, i.e., every entity is connected to each other entity within a layer, the networks become very large and their analyses difficult. A common approach is to reduce the networks, either by selecting a subset of entities as nodes prior to network establishment, mainly by using criteria on abundance, or by using the assumption that weak regulations are less important for the biological network and can be omitted without impairing the represented function of the network. We decided on the latter approach in order not to bias our choice of considered molecular entities and because we wanted to focus on the connections between species, i.e. the covariation of expression. Thereby, also lowly abundant species can exhibit strong connections, and indeed they are found to play a role, as indicated by a non-zero degree, in our reduced networks (see Figure S1D
<sup><xref rid="ref-46" ref-type="bibr">46</xref></sup>).</p>
      <p>We used two different techniques of network reduction by thresholding: In the first, we only kept edges for which the correlation was significantly different from zero ("sign. corr."), i.e., the regulation being sufficiently strong. Therefore, we computed the p-value associated to each correlation value in the networks. Then, for each of the three networks, we applied both Bonferroni and Benjamini-Hochberg multiple testing correction methods along with the classical significance thresholds 0.01 and 0.05 (see
<xref ref-type="fig" rid="f1">Figure 1C</xref>). We finally chose the correction method and significance threshold for each data layer considering a trade-off between minimal network size (i.e. minimal computation time for the subsequent fit to SBM) and maximal connectedness of the reduced network: We used the combination of multiple testing correction and significance threshold that provided a high degree of reduction while maintaining a high percentage of nodes within the largest connected component of the network. While the stringent Bonferroni correction was necessary to achieve a sufficient degree of reduction for the mRNA network, it severely disrupted the connectedness for the protein and metabolite data layer leading to less than 30% or 65% of the nodes being in the largest connected component for protein or metabolite, respectively (see
<xref ref-type="fig" rid="f1">Figure 1C</xref>, employed thresholds marked in blue).</p>
      <p>In the second reduction method, we systematically removed links weaker than increasingly stringent correlation thresholds until the reduced network met a criterion of scale-freeness (using a function from the WGCNA R package
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup>), see
<xref ref-type="fig" rid="f1">Figure 1D</xref>. Scale-freeness is considered a key property of self-organized networks and thus also of biological molecular networks
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup>. In scale-free network formation, highly connected nodes tend to attract more connections than lowly connected nodes leading to a degree distribution following a power-law with a negative exponent. The least stringent correlation threshold for which a sufficiently good fit (scale-free fit index
<italic>R</italic>
<sup>2</sup> &gt; 0.85,
<xref rid="ref-3" ref-type="bibr">3</xref>) between the degree distribution of the reduced network and a power-law degree distribution with negative exponent was obtained was used for network reduction (networks named "scale-free"). The degree distributions of all six reduced networks are shown in
<xref ref-type="fig" rid="f1">Figure 1E</xref>. The relationship between the two reduction by thresholding approaches are further illustrated in Figure S1A-C
<sup><xref rid="ref-46" ref-type="bibr">46</xref></sup>. Both reduction techniques are hard-thresholding techniques meaning that edges are removed from the networks. The resulting six reduced networks, two for each data layer, were used in a binary form, i.e., weight information was discarded after reduction. Some characteristics of the original and reduced networks are shown in
<xref rid="T1" ref-type="table">Table 1</xref>. In the following sections, we describe how to analyze these different homogeneous cancer networks by fitting them to SBMs.</p>
      <table-wrap id="T1" orientation="portrait" position="anchor">
        <label>Table 1. </label>
        <caption>
          <title>Characteristics of the networks derived from the three data layers.</title>
          <p>Note that genes/proteins/metabolites were removed if having &gt;20% NA values (which was the case only for proteins), all other entities were kept as nodes in the reduced network even if their degree was zero (i.e. having no edge) after network reduction.</p>
        </caption>
        <table frame="hsides" rules="groups" content-type="article-table">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1">Characteristic</th>
              <th align="center" valign="top" rowspan="1" colspan="1">mRNA</th>
              <th align="center" valign="top" rowspan="1" colspan="1">protein</th>
              <th align="center" valign="top" rowspan="1" colspan="1">metabolite</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">samples</td>
              <td align="center" valign="top" rowspan="1" colspan="1">237</td>
              <td align="center" valign="top" rowspan="1" colspan="1">36</td>
              <td align="center" valign="top" rowspan="1" colspan="1">67</td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">entities (nodes, before NA removal)</td>
              <td align="center" valign="top" rowspan="1" colspan="1">18321</td>
              <td align="center" valign="top" rowspan="1" colspan="1">10625</td>
              <td align="center" valign="top" rowspan="1" colspan="1">162</td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">edges (before reduction)</td>
              <td align="center" valign="top" rowspan="1" colspan="1">167820360</td>
              <td align="center" valign="top" rowspan="1" colspan="1">56440000</td>
              <td align="center" valign="top" rowspan="1" colspan="1">13041</td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <bold>reduced network: scale-free</bold>
              </td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">minimal correlation</td>
              <td align="center" valign="top" rowspan="1" colspan="1">0.603</td>
              <td align="center" valign="top" rowspan="1" colspan="1">0.788</td>
              <td align="center" valign="top" rowspan="1" colspan="1">0.375</td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">entities (nodes)</td>
              <td align="center" valign="top" rowspan="1" colspan="1">18321</td>
              <td align="center" valign="top" rowspan="1" colspan="1">8430</td>
              <td align="center" valign="top" rowspan="1" colspan="1">162</td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">edges</td>
              <td align="center" valign="top" rowspan="1" colspan="1">287790</td>
              <td align="center" valign="top" rowspan="1" colspan="1">85980</td>
              <td align="center" valign="top" rowspan="1" colspan="1">1825</td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">entities of degree zero</td>
              <td align="center" valign="top" rowspan="1" colspan="1">8183</td>
              <td align="center" valign="top" rowspan="1" colspan="1">4967</td>
              <td align="center" valign="top" rowspan="1" colspan="1">4</td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">entities in largest connected component</td>
              <td align="center" valign="top" rowspan="1" colspan="1">9111</td>
              <td align="center" valign="top" rowspan="1" colspan="1">3187</td>
              <td align="center" valign="top" rowspan="1" colspan="1">158</td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <bold>reduced network: sign. corr.</bold>
              </td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">minimal correlation</td>
              <td align="center" valign="top" rowspan="1" colspan="1">0.395</td>
              <td align="center" valign="top" rowspan="1" colspan="1">0.534</td>
              <td align="center" valign="top" rowspan="1" colspan="1">0.310</td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">entities (nodes)</td>
              <td align="center" valign="top" rowspan="1" colspan="1">18321</td>
              <td align="center" valign="top" rowspan="1" colspan="1">8430</td>
              <td align="center" valign="top" rowspan="1" colspan="1">162</td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">edges</td>
              <td align="center" valign="top" rowspan="1" colspan="1">4260267</td>
              <td align="center" valign="top" rowspan="1" colspan="1">2434159</td>
              <td align="center" valign="top" rowspan="1" colspan="1">2811</td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">entities of degree zero</td>
              <td align="center" valign="top" rowspan="1" colspan="1">1061</td>
              <td align="center" valign="top" rowspan="1" colspan="1">3</td>
              <td align="center" valign="top" rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">entities in largest connected component</td>
              <td align="center" valign="top" rowspan="1" colspan="1">17190</td>
              <td align="center" valign="top" rowspan="1" colspan="1">8427</td>
              <td align="center" valign="top" rowspan="1" colspan="1">161</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>Fitting the reduced networks to stochastic block models</title>
      <p>Biological networks are known to be modular and hierarchical. Different molecular entities, such as genes, mRNAs, and proteins, are interconnected and form different modules to fulfill a specific function. Modularity can convey more robustness to the overall system, e.g. by preventing perturbations in single modules to spread fast and to cause erroneous behavior in other modules and thus functions. Hierarchies capture two characteristics of biological systems: (i) the ordered combination of functions, i.e., multiple simple functions resulting in more complex behavior or responses; and (ii) the inherent levels of complex organization of life, from single molecules to cell organelles, cells, tissue, organs and whole organisms.</p>
      <p>The stochastic block model (SBM) is the simplest form of a generative network model based on communities, i.e., group structures of the nodes. Thereby, nodes are assigned to blocks according to their connectivity properties (
<xref ref-type="fig" rid="f2">Figure 2A</xref> left); the block associations of two nodes fully determine the probability of an edge between them. A shortcoming of the classical SBM for representations of real networks is that nodes within one block need to have similar degrees. The degree-corrected version of the SBM
<sup><xref rid="ref-35" ref-type="bibr">35</xref></sup> accounts for that and enables different degrees for nodes within a block. Another extension of the SBM is its hierarchical version, in which the blocks are further partitioned into blocks of higher levels
<sup><xref rid="ref-25" ref-type="bibr">25</xref></sup> (
<xref ref-type="fig" rid="f2">Figure 2A</xref> right). This model is especially suitable to represent large networks with many nodes as it counteracts underfitting. Fitting biological networks to hierarchical (also called nested) SBMs is therefore most appropriate.</p>
      <fig fig-type="figure" id="f2" orientation="portrait" position="anchor">
        <label>Figure 2. </label>
        <caption>
          <title>Stochastic block models for representing correlation-based biomolecular networks.</title>
          <p>(
<bold>A</bold>) In a stochastic block model (SBM) representation, the nodes of a network are partitioned into blocks according to their similarity in connectivity. The hierarchical version of the SBM (right) imposes in addition hierarchical partitions onto the blocks. (
<bold>B</bold>) Six biomolecular networks derived from transcriptomic, proteomic or metabolomics data of breast tumours were fitted to four different types of SBM: the classical SBM (SBM, light blue), the degree-corrected SBM (dcSBM, light green), the hierarchical SBM (hSBM, dark blue) and the degree-corrected hierarchical SBM (dchSBM, dark green). We performed fits for 500 initial partitions for each network. A fit consists of altering the partitions underlying the SBM such as to minimize the description length. The smaller the description length the better the fit. Hierarchical SBMs outperform non-hierarchical SBMs, degree correction is required for the mRNA and protein networks. (
<bold>C</bold>) Graphical representations of the best fitting hierarchical stochastic block models with degree correction (dchSBM) or without (hSBM) for the networks reduced by significance of correlation (mRNAs, metabolites) or by scale-freeness (protein). The lowest layer (genes, proteins) is truncated in the mRNA and protein networks, colored lines denote edges between blocks of the first level (for mRNA, protein network) or between metabolites (level 0, metabolite network). Edges of blocks or metabolites which belong to the same block in the level above have the same colour. The higher-order hierarchical structure is shown in black.</p>
        </caption>
        <graphic xlink:href="f1000research-8-22342-g0001"/>
      </fig>
      <p>We assessed which of the four following types of stochastic block models could best represent the biological networks: the classical SBM, the degree-corrected SBM, the hierarchical SBM or the degree-corrected and hierarchical SBM (
<xref ref-type="fig" rid="f2">Figure 2B</xref>). We used the Python module graph-tool
<sup><xref rid="ref-36" ref-type="bibr">36</xref></sup> to fit SBMs to the networks, i.e., to find which partition (basal and/or hierarchically ordered) describes the network best as SBM.</p>
      <p>Note that we also examined the performance of weighted stochastic block models for our purpose of edge prediction as they have been successfully employed before for non-biomolecular networks
<sup><xref rid="ref-18" ref-type="bibr">18</xref>,
<xref rid="ref-27" ref-type="bibr">27</xref>,
<xref rid="ref-47" ref-type="bibr">47</xref></sup>. However, the characteristics of the optimal weighted SBM (number of blocks) were severely impacted by prior assumptions on the edge weight distributions, and the derived edge confidence scores did not coincide well with evidence on edge relevance given by the correlations of the edges for fully-connected weighted networks (see Figure S2
<sup><xref rid="ref-46" ref-type="bibr">46</xref></sup>). Taking in addition the increased computational effort for fitting the weighted SBM compared to the binary version into account, we restricted our further analyses to non-weighted SBMs.</p>
      <p>The model fit is performed following the rationale of Occam’s razor: The simplest model describing the data is the best. Thus, we searched for the partition that minimized the description length, i.e., the amount of information necessary to describe the network as an SBM. Additional information required to capture degree-correction and/or hierarchies compared to the classical SBM is thereby taken into account. Consequently, it can be directly concluded which of the four SBM model types is most appropriate for a certain network: The one with the lowest minimal description length. The optimization of the description length runs via an agglomerative Markov Chain Monte Carlo algorithm
<sup><xref rid="ref-37" ref-type="bibr">37</xref></sup>. It is non-deterministic and multiple initiations of the underlying partition of the SBM are required to obtain globally instead of locally optimal partitions. We performed optimizations for 500 initial partitions for each network and SBM type.</p>
      <p>For all four mRNA and protein networks, the classical SBM delivered the worst fit and the degree-corrected, hierarchical SBM fitted best (
<xref ref-type="fig" rid="f2">Figure 2B</xref> left and middle). Degree correction did not prove necessary to describe the metabolite networks, for which the hierarchical SBMs fitted slightly better than the classical SBM (
<xref ref-type="fig" rid="f2">Figure 2B</xref> right). A graphical representation of the best fitting SBMs in circular layout, showing the blocks from the lowest layer (for mRNA, protein) or the metabolites (metabolite network) and their connections in color, and the hierarchical structure on top in black, is given in
<xref ref-type="fig" rid="f2">Figure 2C</xref>.</p>
    </sec>
    <sec>
      <title>SBM-derived communities of the biomolecular networks capture and predict biological function</title>
      <p>We wanted to assess how well the biological content of the biomolecular networks is captured in the stochastic block models, i.e., if the clustering of the nodes into the blocks is biologically meaningful. To that purpose, we estimated whether the blocks show common biological function based on Reactome or KEGG pathways. Reactome provides a hierarchical annotation which enables a definition of a distance between terms and a comparison to the hierarchical structure given by the SBM, KEGG is one of the annotation databases used most for metabolites. In particular, we performed overrepresentation analyses of Reactome pathways for the blocks at each level of the SBMs of the four protein and mRNA networks, and overrepresentation of KEGG pathways for the blocks predicted for the two metabolite networks.</p>
      <p>We find that a high percentage of blocks in each level has at least one associated Reactome or KEGG pathway, i.e., the genes of the pathway are overrepresented within the block, they occur more frequently than expected by chance (
<xref ref-type="fig" rid="f3">Figure 3A</xref> bars). Except for the highest hierarchy levels that consist only of a few blocks, this percentage is decisively higher than for a random clustering of exactly the same structure (results for 3 random clusterings shown as black crosses in
<xref ref-type="fig" rid="f3">Figure 3A</xref>).</p>
      <fig fig-type="figure" id="f3" orientation="portrait" position="anchor">
        <label>Figure 3. </label>
        <caption>
          <title>Modules derived from hierarchical SBM represent biological function.</title>
          <p>(
<bold>A</bold>) Percentage of blocks with at least one overrepresented Reactome (KEGG) pathway for the best fitting SBM (see
<xref ref-type="fig" rid="f2">Figure 2B</xref>) for the mRNA and protein (metabolite) networks, reduced by condition on scale-freeness (scale-free) or on significance of correlation (sign. corr.), for each hierarchical level (bars). Black crosses denote the percentages of blocks with at least one overrepresented Reactome (KEGG) pathway for three SBMs each with exactly the same structures but randomly shuffled mRNAs or proteins (metabolites). (
<bold>B</bold>) For the lowest hierarchy level clustering (level 1) of each of the four mRNA and protein SBMs, we calculated the average distances between every pair of Reactome pathways between blocks and those within blocks, for a distance measures (i) based on the Reactome hierarchy (see Figure S3
<sup><xref rid="ref-46" ref-type="bibr">46</xref></sup> for the results using the alternative distance measure (ii)). The lower the distances the more similar are the pathways. The pathways associated to one single block (within) are significantly more similar than those associated to different blocks (Welch’s t-test p-value &lt; 0.01) suggesting that biological functions are consistent within blocks and distinct between blocks. (
<bold>C</bold>) Distance of Reactome pathways (as in
<bold>B</bold>) between blocks (or within blocks, for distance of blocks in SBM being zero) versus the distance of the blocks in the SBM hierarchy for blocks on level 1. We do not find evidence that the Reactome hierarchy is reflected in the SBM hierarchy. (
<bold>D</bold>) Between-module vs. within-module distances of Reactome terms as in (
<bold>B</bold>) for blocks of SBM hierarchy levels 2-6. (
<bold>E</bold>) Percentage of modules detected by the WGCNA approach with at least one overrepresented Reactome or KEGG pathway. Black crosses denote the results for three similar clusterings with randomly shuffled mRNAs, proteins, or metabolites. (
<bold>F</bold>) Between-module vs. within module distances of Reactome terms as in (
<bold>B</bold>) for the clusterings predicted from WGCNA-based module detection.</p>
        </caption>
        <graphic xlink:href="f1000research-8-22342-g0002"/>
      </fig>
      <p>Many blocks, however, have not only one but multiple Reactome pathways assigned. If blocks are biologically meaningful, we would expect to observe similar Reactome pathways within blocks but less similar pathways when comparing the pathways of different blocks.</p>
      <p>The dissimilarity of Reactome pathways is naturally represented by their distance in the Reactome familial hierarchy structure; the more distant pathways are, the less connected are their biological functions. We used two closely related measures to assess it: (i) the distance of two pathways is the length of the shortest path in the hierarchy tree from one pathway to the other, and (ii) the higher the hierarchy level of the lowest common ancestor (least common subsumer) of two pathways, the more distant they are. Please note that we restricted this analysis to the mRNA and protein networks because the KEGG pathways employed for metabolite data are only assorted into a very shallow hierarchy.</p>
      <p>We compared the distances of Reactome pathways using the average of the distance measure over pairs of Reactome pathways associated with one block (within blocks) and over pairs of Reactome pathways associated with two different blocks (between blocks) for the lowest hierarchy level blocks
(level 1, see
<xref ref-type="fig" rid="f3">Figure 3B</xref> for distance measure (i), Figure S3
<sup><xref rid="ref-46" ref-type="bibr">46</xref></sup> for distance measure (ii)). Thereby, for all four networks and both measures, we observe significantly smaller distances of Reactome pathways within blocks than between blocks (Welch’s test p &lt; 0.01). This suggests that biological function is coherent within and distinct between blocks, thus further enhancing the notion that SBMs represent well the biological function of the networks.</p>
      <p>In addition, we compared Reactome pathway distances between blocks and within blocks for the blocks of the higher levels (levels 2-6,
<xref ref-type="fig" rid="f3">Figure 3D</xref>). Please note that this analysis could only be performed for the subset of SBM hierarchy levels with at least three blocks with more than one overrepresented Reactome pathway (otherwise, a Welch’s test cannot be performed due to low sample count). For higher levels, within-block distances are only in some cases significantly lower than between-block distances, no general effect can be observed.</p>
      <p>Furthermore, we examined the relationship between the hierarchies within the SBMs and the hierarchy of the Reactome pathways. First, we defined the distance of blocks within a hierarchical SBM by counting the number of steps necessary to reach a block from the other (via their lowest common higher-level block). Second, we compared the distance within the SBM hierarchy of each pair of blocks (on level 1) to the distance of their associated Reactome pathways within the Reactome hierarchy (
<xref ref-type="fig" rid="f3">Figure 3C</xref>, Figure S3B). Thereby, we found only a weak positive correlation for Reactome pathway distance measure (i), that is even further reduced if neglecting intra-block coherence, i.e., neglecting blocks with distance zero in the SBM hierarchy. From both analyses (
<xref ref-type="fig" rid="f3">Figure 3C–D</xref>), we concluded that the hierarchy within the SBM does not strongly coincide with the hierarchy within the Reactome pathways.</p>
      <p>In order to assess how the clustering by SBM relates to established clustering techniques in correlation-based networks, we also performed module detection by using the WGCNA package
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup>. Note that for this approach, no model reduction is necessary, which means that we obtain only one result for each data layer. After soft thresholding to enforce scale-free network architecture, we employed WGCNA module detection to obtain comparable numbers of modules as for the SBM-based approach: 333 (mRNA), 109 (protein) and 12 (metabolite) for WGCNA; these numbers are similar to the 438, 113 and 15 blocks detected by SBM for the corresponding scale free networks. Overall, the WGCNA clusterings show a larger diversity of module sizes than those obtained for the SBM approach (Figure S3D
<sup><xref rid="ref-46" ref-type="bibr">46</xref></sup>). For all three data layers, a higher percentage of WGCNA-derived modules have a biological annotation compared to the blocks from the SBM (compare
<xref ref-type="fig" rid="f3">Figure 3E</xref> to
<xref ref-type="fig" rid="f3">3A</xref>). However, for the mRNA layer, many of the blocks also have an overrepresented pathway annotation for randomly shuffled gene names which hints on reduced significance of the WGCNA results and better performance for the modules detected by fitting to SBM. For protein and metabolites, in terms of detection of biologically annotated modules, the WGCNA approach seems to provide slightly better results than the SBM approach. Comparison of within-module distances and between-module distances of the annotated Reactome terms for the mRNA and protein networks delivers significantly lower within-module distances as for the SBM clusterings (
<xref ref-type="fig" rid="f3">Figure 3F</xref>).</p>
      <p>The observed differences derived from WGCNA vs. SBM could stem from conceptual differences in the approaches: Instead of detecting clusters of entities with highly positively correlated abundances only as in WGCNA, nodes from the same block are characterized by common connectivity characteristics in the SBM. Clearly, as proteins interact and bind directly for complex formation or regulation, and metabolites are interconverted into one another, entities which act together tend to have similar abundances and thus the modularization by WGCNA shows good results. For the detection of modules for mRNAs whose interaction can be considered less direct, assorting entities with similar connectivity patterns as in the SBM-derived modules is beneficial. In addition, the WGCNA framework, as most other module detection methods, cannot aid in assessing edge relevance - which is enabled by the fit of the networks to SBMs.</p>
      <p>We furthermore compared the results from the overrepresentation analysis of the SBM-derived blocks to known biological insights from breast cancer. To that purpose, for the mRNA and protein networks, we compared the SBM-derived biological Reactome terms to those found for oncogenic signatures obtained from the database MSigDB
<sup><xref rid="ref-42" ref-type="bibr">42</xref></sup>. The 43 Reactome pathways known to be related to breast cancer according to MSigDB (see
<italic>Methods</italic>) stem mainly from the categories extracellular matrix (ECM) organization, signal transduction, cell cycle, hemostasis, DNA repair, and few others. All but one of these pathways were found as overrepresented, partially with high frequency, in SBM-derived blocks of one of the mRNA or protein networks (
<xref ref-type="fig" rid="f4">Figure 4</xref>). The exception is "Defensins" that are relevant for antimicrobial immune response and therefore the immune system. Its occurrence in oncogenic signatures might originate from immune cells measured together with tumour tissue. Overall, the two protein networks exhibit less overrepresented pathways, but especially the categories ECM organization and DNA repair are well represented in both networks, and cell cycle in the network reduced by significance of correlation (lower 2 panels in
<xref ref-type="fig" rid="f4">Figure 4</xref>). Thus, biological functions related to breast cancer are well captured in the SBM-derived clustering.</p>
      <fig fig-type="figure" id="f4" orientation="portrait" position="anchor">
        <label>Figure 4. </label>
        <caption>
          <title>SBM-derived blocks of mRNA and protein networks exhibit biological functions related to breast cancer signature.</title>
          <p>Oncogenic signature gene sets related to breast cancer were retrieved from MSigDB
<sup><xref rid="ref-42" ref-type="bibr">42</xref></sup> and mapped to Reactome pathways. The color code shows for how many SBM-derived blocks each of these pathways was overrepresented, for the four mRNA and protein networks and each hierarchy level. Hierarchy levels without any blocks with overrepresented pathways are omitted.</p>
        </caption>
        <graphic xlink:href="f1000research-8-22342-g0003"/>
      </fig>
      <p>For the metabolite networks, we investigated the KEGG pathways found as overrepresented in the SBM-derived blocks (
<xref rid="T2" ref-type="table">Table 2</xref>). Therein, especially "Biosynthesis of unsaturated fatty acids" is very prominent, it is indeed overrepresented in two blocks for each network (not shown) and occurs in different variations in the scale-free network (e.g. further overrepresented terms "Fatty acid biosynthesis", "Linoleic acid metabolism",
<xref rid="T2" ref-type="table">Table 2</xref>). Indeed, fatty acids synthesis has been related to metastasis, therapeutic resistance and relapse in cancer
<sup><xref rid="ref-48" ref-type="bibr">48</xref></sup>. The SBM-derived predicted importance of valine, leucine and isoleucine metabolism for breast cancer (
<xref rid="T2" ref-type="table">Table 2</xref>) has been suggested before, in particular with respect to leucine
<sup><xref rid="ref-49" ref-type="bibr">49</xref></sup>. In addition, ABC transporters occur as overrepresented in both SBM-derived clusterings of the metabolite networks: They have been suggested to play a role in chemoresistance
<sup><xref rid="ref-50" ref-type="bibr">50</xref></sup> and therefore point to one possible underlying reason of the bad prognosis of ER- breast cancer patients.</p>
      <table-wrap id="T2" orientation="portrait" position="anchor">
        <label>Table 2. </label>
        <caption>
          <title>Overrepresented KEGG pathways for the SBM-derived blocks of the metabolite networks (reduced by significance of correlation, sign. corr., or by a criterion on scale-freeness, scale-free).</title>
        </caption>
        <table frame="hsides" rules="groups" content-type="article-table">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">metabolite network: sign. corr.</th>
              <th align="left" rowspan="1" colspan="1">metabolite network: scale-free</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">Biosynthesis of unsaturated fatty acids</td>
              <td align="left" rowspan="1" colspan="1">Biosynthesis of unsaturated fatty acids</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Aminoacyl-tRNA biosynthesis</td>
              <td align="left" rowspan="1" colspan="1">Aminoacyl-tRNA biosynthesis</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">ABC transporters</td>
              <td align="left" rowspan="1" colspan="1">ABC transporters</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Valine, leucine and isoleucine biosynthesis</td>
              <td align="left" rowspan="1" colspan="1">Valine, leucine and isoleucine biosynthesis</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Valine, leucine and isoleucine degradation</td>
              <td align="left" rowspan="1" colspan="1">Valine, leucine and isoleucine degradation</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Amino sugar and nucleotide sugar metabolism</td>
              <td align="left" rowspan="1" colspan="1">Starch and sucrose metabolism</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Fatty acid biosynthesis</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Linoleic acid metabolism</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Ubiquinone and other terpenoid-quinone biosynthesis</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Biosynthesis of secondary metabolites</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">Glycine, serine and threonine metabolism</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>In order to identify further biological functions that could play a role according to SBM-derived network structures in mRNA and protein networks, we summarized the overrepresented Reactome pathways on the level of the parent Reactome pathways (on the top level of the Reactome hierarchy,
<xref ref-type="fig" rid="f5">Figure 5</xref>). Thereby, we could retrieve the categories known to be of relevance to breast cancer, in particular ECM organization and cell cycle, for all four networks. We found additional categories that were observed more frequently than they are represented in the Reactome hierarchy: "Metabolism of RNA", "Metabolism of proteins", and "Chromatin organization" (columns with darker color in
<xref ref-type="fig" rid="f5">Figure 5A</xref>). Please note that tRNA synthesis has occurred as overrepresented KEGG pathway of the SBM-derived structures of the metabolite networks (
<xref rid="T2" ref-type="table">Table 2</xref>) - since tRNA is subject to RNA metabolism and is required for the translation of proteins, it lies at the interface those two relevant metabolism categories predicted from mRNA and protein networks and thus complements their predictions. Metabolism of proteins relies on amino acids and could be also related to the leucine addiction reported for breast cancer
<sup><xref rid="ref-49" ref-type="bibr">49</xref></sup>, and it is supported by the SBM-derived predictions in the metabolite network on the relevance of the metabolism of further amino acids (
<xref rid="T2" ref-type="table">Table 2</xref>). Of note, metabolism in general did not occur with a high frequency (relative to the size of the category “Metabolism”, see
<xref ref-type="fig" rid="f5">Figure 5B</xref>) revealing a certain specificity of the predictions obtained by fitting to SBM. The highlight on chromatin organization is an interesting SBM-derived prediction complementary to the metabolism motif and invites further exploration, e.g. by examining related blocks and their connectivity structure in relation to other blocks in the SBM.</p>
      <fig fig-type="figure" id="f5" orientation="portrait" position="anchor">
        <label>Figure 5. </label>
        <caption>
          <title>SBM-derived blocks of mRNA and protein networks predict further pathways relevant for breast cancer.</title>
          <p>(
<bold>A</bold>) We mapped the Reactome pathways to their Reactome parent pathways and counted their occurrence as overrepresented pathway in SBM-derived blocks of the four mRNA and protein networks and each hierarchy level. Reactome parent pathways are sorted by the number of pathways they summarize (see (
<bold>B</bold>)). The color code gives the percentage of occurrence as overrepresented of each parent pathway (counted occurrence divided by total number of overrepresented pathways obtained for the SBM-clustering of the hierarchy level and network) relative to the percentage of each parent pathway in the Reactome annotation (number of pathways associated to the parent pathway relative to the number of total Reactome pathways). These values indicate whether certain parent pathways occur more frequently than suggested by the size of the parent pathways cluster in Reactome. The higher the value (i.e. the darker the color), the more relevant the parent pathway is predicted by the SBM-derived network structure. (
<bold>B</bold>) Reactome pathway organization (downloaded from the Reactome website Pathway Viewer,
<xref rid="ref-39" ref-type="bibr">39</xref>). The parent pathways that are predicted as especially relevant for breast cancer according to (
<bold>A</bold>) are highlighted.</p>
        </caption>
        <graphic xlink:href="f1000research-8-22342-g0004"/>
      </fig>
      <p>To summarize, biological functions related to breast cancer are well captured in the SBM-derived clustering. Networks derived from different datalayers enable different perspectives of the phenotype that can support each other or provide complementary predictions. After the assessment of the biological content in the SBM-derived clustering, we moved to the second deliverable of the fit of the networks to SBMs: finding alternative edge relevance based on global network properties.</p>
    </sec>
    <sec>
      <title>Assessing edge relevance by SBM-based edge confidence scores</title>
      <p>The descriptions of the biomolecular networks as SBMs were exploited to determine a confidence score for each existing or non-existing edge of the network. This score would capture how well the existence (or non-existence) of the edge fits to the network’s description by the SBM: Erroneously kept or removed edges lead to a worse fit of the SBM to the network, and removing or reinstalling these edges lead to fit improvement. Indeed, under certain assumptions (see
<xref ref-type="other" rid="ME1"><italic>Methods</italic></xref>), the derived edge confidence score is proportional to the actual absolute probability that the edge belongs to the network, and thus signifies relative edge relevance. Therefore, the confidence score could be used to predict whether an edge is spurious (or missing)
<sup><xref rid="ref-17" ref-type="bibr">17</xref>,
<xref rid="ref-18" ref-type="bibr">18</xref>,
<xref rid="ref-27" ref-type="bibr">27</xref></sup>. A high missing edge confidence score suggests that the edge in question is missing and should be restored, it has a high relevance; a high spurious edge confidence score suggests that the edge in question is spurious and should be removed from the network, it has a low relevance. The SBM-based edge confidence scores rely on global network connectivity characteristics and complement the correlation-based weights of the edges which stem from the local, measured characteristics of their nodes.</p>
      <p>For the six reduced networks, all edges that existed in the network were considered as "putatively spurious". Similarly, all edges that were not in the network because they had been removed from the (fully connected) correlation-based network during the reduction procedure were considered as "putatively missing". For each putatively missing and spurious edge, we used the Python module graph-tool
<sup><xref rid="ref-36" ref-type="bibr">36</xref></sup> to compute its edge confidence score (
<xref ref-type="fig" rid="f6">Figure 6</xref>). Thereby, we took advantage of the following fact: Entities of degree zero, i.e., nodes that have no connection to any other node in the network after reduction, are indistinguishable to the SBM. Consequently, also all putatively missing edges connecting any of these nodes to a specific second node are only distinguishable by this second node, and thus carry the same missing edge confidence score. This reduces the number of scores we need to compute considerably, depending on the degree of reduction (see counts of entities of degree zero in
<xref rid="T1" ref-type="table">Table 1</xref>). We display the scores for the different types of missing edges in different histograms (
<xref ref-type="fig" rid="f6">Figure 6A, B</xref> middle and bottom). For very big networks with a low degree of reduction (the mRNA and protein networks reduced by significance of correlation), it is still computationally not feasible to compute the scores for all putatively missing edges. We therefore resorted to computing it for as many putatively missing edges as we have existing edges in the network (i.e. approx. 2.4×10
<sup>6</sup> for the protein network, 4.6×10
<sup>6</sup> for the mRNA network, see
<xref rid="T1" ref-type="table">Table 1</xref>), and chose those with highest absolute edge weights (
<xref ref-type="fig" rid="f6">Figure 6B</xref> left and middle).</p>
      <fig fig-type="figure" id="f6" orientation="portrait" position="anchor">
        <label>Figure 6. </label>
        <caption>
          <title>SBM-derived edge prediction: Missing and spurious edge confidence scores.</title>
          <p>(
<bold>A</bold>) Histograms of edge confidence scores for the best fitting SBM of the three networks reduced by criterion on scale-freeness for all existing, i.e., putatively spurious edges (spurious edge score, top), for the putatively missing edges between nodes with degree &gt; 0 (missing edge score, middle), for the putatively missing edges connecting a node of degree 0 to a node with a larger degree (missing edge (disc) score, bottom - only one edge for each node with degree &gt; 0 is shown). (
<bold>B</bold>) Edge confidence scores as described in (
<bold>A</bold>) for the networks reduced by criterion on significance of correlation. For the mRNA and protein network, missing edge scores (middle) were only computed for the edges with largest absolute correlations of the node measurements.</p>
        </caption>
        <graphic xlink:href="f1000research-8-22342-g0005"/>
      </fig>
      <p>Recall that the edge confidence scores are relative, i.e., they serve for comparing relevance between edges only. In addition, computation of the scores relies on the assumption that the partition of the originally fitted SBM is correct for the network. Different edge confidence scores might be obtained for SBMs with different partitions but with similarly good fit to the network. We neglect this complication for the sake of computational efficiency. Still, we have to keep both facts in mind for the interpretation and usage of the edge confidence scores. For example, an evident threshold for declaring an edge as relevant ("missing") or not relevant ("spurious") would be to have the respective edge confidence score larger than zero, as this indicates an improvement in fit quality if adding or removing the edge, respectively. However, we observe an imbalance of our computed scores which is inherent to the approach: Because having less edges reduces the complexity of the underlying network, removing edges preferentially reduces also the amount of information required to describe the SBM, i.e., its description length turns smaller, its goodness of fit improves. Therefore, the edge confidence score distributions of missing edges are shifted to the left - the great majority of edges would be predicted as not missing for the threshold of zero, they are not relevant and should be left out (
<xref ref-type="fig" rid="f6">Figure 6A, B</xref>, 2nd line). Conversely, the spurious edge confidence score distributions are shifted to the right - the great majority of existing edges would be predicted as spurious, they are not relevant and should be removed for an edge score threshold of zero (
<xref ref-type="fig" rid="f6">Figure 6A, B</xref>, top). Both measures point to making the networks smaller.</p>
    </sec>
    <sec>
      <title>Evaluation of edge confidence scores based on correlation</title>
      <p>In order to determine whether the edge confidence scores are overall a reasonable assessment of edge relevance, we compared the predicted scores to the edge weights of the edges as derived directly from Spearman’s correlation of the measurements of the nodes. It is important to note that these edge weights (correlations) were used exclusively for the reduction of the correlation-based networks. The edge correlations were at no point provided to the SBM, neither during the fitting to the SBM (except for the weighted version and only for Figures S2, S4
<sup><xref rid="ref-46" ref-type="bibr">46</xref></sup>) nor during the computation of the edge scores. Thus, they are close to an independent validation of the edge relevance, edges with large correlation being more relevant to the system encoded by the network than edges with a correlation close to zero.</p>
      <p>Indeed, for all six networks and SBMs, we find an overall positive correlation between the (absolute) edge correlations and the missing edge confidence scores: Edges with high correlation are preferentially predicted as missing, i.e., relevant to the network, also in terms of edge confidence score (
<xref ref-type="fig" rid="f7">Figure 7</xref>). Similarly, we find an overall negative correlation between (absolute) edge correlations and spurious edge confidence scores: Edges with high correlation are preferentially
<italic>not</italic> predicted as spurious, i.e., they are predicted as relevant to the network, also in terms of edge confidence score. Consequently, the comparison to the edge correlation suggests that SBM-derived edge confidence scores could be used as additional information for assessing the relevance of edges for multiple omics correlation-based networks.</p>
      <fig fig-type="figure" id="f7" orientation="portrait" position="anchor">
        <label>Figure 7. </label>
        <caption>
          <title>SBM-derived edge prediction: Validation by correlation.</title>
          <p>Relationship between edge confidence scores and edge correlations (Spearman’s correlation of the measurements at their nodes) for putatively spurious (top) or putatively missing edges between nodes of degree &gt; 0 (bottom) for the networks reduced by criterion on scale-freeness (
<bold>A</bold>) or significance of correlation (
<bold>B</bold>). Edge confidence scores correlate well to edge correlations, with edges with high SBM-predicted confidence in spuriousness - edges predicted as irrelevant - having lower correlations, edges with high SBM-predicted confidence in missingness - edges predicted as relevant - having higher correlations. Please note that for the protein network reduced by significance of correlation, due to missing values in the dataset, a fixed significance threshold leads to different correlation thresholds and thus the correlation value boundary is blurred (
<bold>B</bold>, middle).</p>
        </caption>
        <graphic xlink:href="f1000research-8-22342-g0006"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>Using example cases of correlation-based transcriptomic, proteomic and metabolomics networks from breast cancer tumour samples, here we show that and how stochastic block models can be employed for the analysis of biomolecular networks. The networks can be best represented by the hierarchical version of the stochastic block models. This gives rise to biologically meaningful separation of the biomolecules into many functionally relevant blocks. Biological functions related
to breast cancer are well captured in the SBM-derived clusters and the networks derived from the different data layers shed light on different perspectives of the phenotype that can support each other and result in complementary predictions. In addition, the SBM framework enables the computation of edge confidence scores that can be used to predict missing or spurious links.</p>
    <p>The representation of the networks by SBMs poses a challenge: The model fit and the derivation of edge confidence scores can be computationally very demanding, especially for networks with many edges. This was the case here for the mRNA networks and the protein network reduced by significance of correlation. Therefore, the approach of network analysis by SBM seems most suitable for smaller and/or sparser networks. On the other hand, it delivers two opportunities.</p>
    <p>First, modules derived from blocks in SBMs are not only defined as clusters of tight relationships, i.e. co-expression clusters, as obtained with other clustering approaches
<sup><xref rid="ref-3" ref-type="bibr">3</xref>,
<xref rid="ref-9" ref-type="bibr">9</xref>,
<xref rid="ref-14" ref-type="bibr">14</xref></sup>. In an SBM, nodes from the same block are characterized by common connectivity characteristics, i.e., common interaction profiles with nodes from the same and from other blocks. Consequently, comparing SBM-derived modules between conditions naturally points towards detecting altered regulations. Indeed, we found our SBM-derived blocks to be biologically relevant to our examined phenotype, and comparing SBM-derived structures between different phenotypes is an intriguing next step.</p>
    <p>Second, the derived edge predictions can reproduce the interaction strengths as estimated from measurements. SBM-based edge confidences tend to score missing edges higher that have high correlation, i.e., that would be considered a strong regulation, an important edge. Analogously, existing edges in the network with low correlation tend to be predicted as spurious with high confidence, i.e., as dispensable. Keep in mind that the correlations corresponding to the edges were not provided at any point to the SBM construction. Thus, the SBM approach proves very strong in delivering relevant edge predictions. A further biological validation of the predicted edge confidence scores, for example by comparison to interaction databases, would be an interesting next step.</p>
    <p>Still, a question remains: How should the edge confidence scores be translated into edge predictions to alter the network, i.e. to actually remove or re-install edges? There is a natural threshold for declaring an edge as missing or spurious, namely if the respective confidence score would be larger than zero. However, due to the minimal description length approach for SBM-based edge relevance assessment, the confidence scores are shifted towards reducing the networks as much as possible (
<xref ref-type="fig" rid="f6">Figure 6</xref>), such that this natural threshold for deriving the prediction of actual missingness or spuriousness from the confidence scores is not valid. Further examinations on other possible thresholds are required. However, for relative comparisons of relevance between edges in a network the SBM-based scores are suitable.</p>
    <p>Additional directions of SBM-based analysis of biomolecular networks remain to be explored.</p>
    <p>(i) For edge relevance assessment in other network types, it has been proposed that edge predictions with SBMs are more reliable if resorting to an ensemble of good fits instead of using the best fit only
<sup><xref rid="ref-27" ref-type="bibr">27</xref></sup>. Due to the sizes of the employed correlation-based biomolecular networks, this approach is computationally not of practical relevance here, but it would be an interesting point to assess in the future.</p>
    <p>(ii) We considered the weighted version of the SBM that could be an interesting option for the analysis of biomolecular networks because it enables representing fully-connected weighted networks as SBM without prior reduction. It could prove exciting especially for smaller networks, e.g. primary metabolites, or in more targeted data analysis approaches. However, in our case, we found hints that the weighted version of the SBM might not be appropriate for the task of edge prediction from SBM-based confidence scores for fully-connected networks (see Figure S2
<sup><xref rid="ref-46" ref-type="bibr">46</xref></sup>). For reduced networks, the results for weighted SBMs seem more promising (see Figure S4
<sup><xref rid="ref-46" ref-type="bibr">46</xref></sup>). A final assessment on the usefulness of the weighted version of the SBMs is still pending, as long as nothing is known about interaction strength distributions between and within modules: The fitted SBM strongly depends on the prior assumptions chosen for these distributions. An extensive analysis of different choices would be required, which is beyond the scope of this study.</p>
    <p>We propose to employ SBM-based modules and edge confidence scores as additional pieces of information to make the results of follow-up analyses more robust that rely on relationships between nodes, i.e., on edges and their strength. Edges and their strength play a key role in interpreting biomolecular effects, e.g. of mutations or drugs. If a drug “activates a protein”, this typically means alteration of the protein’s interaction strengths with other proteins or the DNA. The “mutation of a gene” may severely alter the binding properties of the corresponding translated protein to interaction partners. In sum, interactions and their strengths are at the heart of biologically relevant alterations in biomolecular networks, and characterizing the former is required in order to understand the effects of the latter. The SBM framework enables assessing the edge relevance or interaction strength on the basis of consistent, global network characteristics, instead of on the basis of correlation of measurements. Especially for personalized analyses which generally rely on a characterization by only few error-prone measurements of each molecule, this will be crucial to derive more reliable predictions.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <sec>
      <title>Underlying data</title>
      <p>In this study, data from TCGA and CPTAC were used. Proteomics data stem from
<xref rid="ref-29" ref-type="bibr">29</xref>, metabolomics data stem from
<xref rid="ref-30" ref-type="bibr">30</xref>. The metabolomics raw data can only be obtained upon accessing the cited article
<sup><xref rid="ref-30" ref-type="bibr">30</xref></sup>; processed data (Spearman’s correlations and associated p-values) can be found in the gitlab repository below.</p>
      <p>Code used to perform the analyses together with a detailed work-flow documentation:
<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/biomodlih/sbm-for-correlation-based-networks">https://gitlab.com/biomodlih/sbm-for-correlation-based-networks</ext-link>
</p>
      <p>Archived code as at time of publication:
<ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.5281/zenodo.3363060">https://doi.org/10.5281/zenodo.3363060</ext-link>
<sup><xref rid="ref-46" ref-type="bibr">46</xref></sup>
</p>
      <p>License: GNU GPLv3 license.</p>
    </sec>
    <sec>
      <title>Extended data</title>
      <p>Zenodo: Analysis of correlation-based biomolecular networks from different omics data by fitting stochastic block models.
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.3363060">https://doi.org/10.5281/zenodo.3363060</ext-link>
<sup><xref rid="ref-46" ref-type="bibr">46</xref></sup>. This project contains the following extended data files:</p>
      <list list-type="bullet">
        <list-item>
          <p>Figure S1: The relationship between network reduction by significance of correlation or by scale-freeness</p>
        </list-item>
        <list-item>
          <p>Figure S2: The weighted SBM seems not appropriate for edge prediction from edge confidence scores for fully connected networks</p>
        </list-item>
        <list-item>
          <p>Figure S3: Pathway characteristics for alternative distance measure, and block size distributions</p>
        </list-item>
        <list-item>
          <p>Figure S4: Edge predictions for a reduced weighted network with planar or hierarchical weighted SBMs</p>
        </list-item>
      </list>
      <p>Data are available under the terms of the
<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/legalcode">Creative Commons Attribution 4.0 International license</ext-link> (CC-BY 4.0).</p>
    </sec>
  </sec>
</body>
<back>
  <ref-list>
    <ref id="ref-1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barabási</surname><given-names>AL</given-names></name><name><surname>Gulbahce</surname><given-names>N</given-names></name><name><surname>Loscalzo</surname><given-names>J</given-names></name></person-group>:
<article-title>Network medicine: a network-based approach to human disease.</article-title><source><italic toggle="yes">Nat Rev Genet.</italic></source><year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>56</fpage>–<lpage>68</lpage>.
<pub-id pub-id-type="doi">10.1038/nrg2918</pub-id><!--<pub-id pub-id-type="pmcid">3140052</pub-id>--><?supplied-pmid 21164525?><pub-id pub-id-type="pmid">21164525</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Dam</surname><given-names>S</given-names></name><name><surname>Võsa</surname><given-names>U</given-names></name><name><surname>van der Graaf</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>Gene co-expression analysis for functional classification and gene-disease predictions.</article-title><source><italic toggle="yes">Brief Bioinform.</italic></source><year>2018</year>;<volume>19</volume>(<issue>4</issue>):<fpage>575</fpage>–<lpage>592</lpage>.
<pub-id pub-id-type="doi">10.1093/bib/bbw139</pub-id><!--<pub-id pub-id-type="pmcid">6054162</pub-id>--><?supplied-pmid 28077403?><pub-id pub-id-type="pmid">28077403</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langfelder</surname><given-names>P</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name></person-group>:
<article-title>WGCNA: an R package for weighted correlation network analysis.</article-title><source><italic toggle="yes">BMC Bioinformatics.</italic></source><year>2008</year>;<volume>9</volume>:<fpage>559</fpage>.
<pub-id pub-id-type="doi">10.1186/1471-2105-9-559</pub-id><!--<pub-id pub-id-type="pmcid">2631488</pub-id>--><?supplied-pmid 19114008?><pub-id pub-id-type="pmid">19114008</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Toubiana</surname><given-names>D</given-names></name><name><surname>Xue</surname><given-names>W</given-names></name><name><surname>Zhang</surname><given-names>N</given-names></name><etal/></person-group>:
<article-title>Correlation-Based Network Analysis of Metabolite and Enzyme Profiles Reveals a Role of Citrate Biosynthesis in Modulating N and C Metabolism in
<italic>Zea mays</italic>.</article-title><source><italic toggle="yes">Front Plant Sci.</italic></source><year>2016</year>;<volume>7</volume>:<fpage>1022</fpage>.
<pub-id pub-id-type="doi">10.3389/fpls.2016.01022</pub-id><!--<pub-id pub-id-type="pmcid">4940414</pub-id>--><?supplied-pmid 27462343?><pub-id pub-id-type="pmid">27462343</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pellegrini</surname><given-names>M</given-names></name></person-group>:
<article-title>Community Detection in Biological Networks.</article-title><source><italic toggle="yes">Encyclopedia of Bioinformatics and Computational Biology.</italic></source>Elsevier,<year>2019</year>;<volume>1</volume>:<fpage>978</fpage>–<lpage>987</lpage>.
<pub-id pub-id-type="doi">10.1016/B978-0-12-809633-8.20428-7</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langfelder</surname><given-names>P</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name></person-group>:
<article-title>Fast R Functions for Robust Correlations and Hierarchical Clustering.</article-title><source><italic toggle="yes">J Stat Softw.</italic></source><year>2012</year>;<volume>46</volume>(<issue>11</issue>): pii: i11.
<pub-id pub-id-type="doi">10.18637/jss.v046.i11</pub-id><!--<pub-id pub-id-type="pmcid">3465711</pub-id>--><?supplied-pmid 23050260?><pub-id pub-id-type="pmid">23050260</pub-id></mixed-citation>
    </ref>
    <ref id="ref-7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeub</surname><given-names>LGS</given-names></name><name><surname>Sporns</surname><given-names>O</given-names></name><name><surname>Fortunato</surname><given-names>S</given-names></name></person-group>:
<article-title>Multiresolution Consensus Clustering in Networks.</article-title><source><italic toggle="yes">Sci Rep.</italic></source><year>2018</year>;<volume>8</volume>(<issue>1</issue>): 3259.
<pub-id pub-id-type="doi">10.1038/s41598-018-21352-7</pub-id><!--<pub-id pub-id-type="pmcid">5818657</pub-id>--><?supplied-pmid 29459635?><pub-id pub-id-type="pmid">29459635</pub-id></mixed-citation>
    </ref>
    <ref id="ref-8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lancichinetti</surname><given-names>A</given-names></name><name><surname>Fortunato</surname><given-names>S</given-names></name></person-group>:
<article-title>Consensus clustering in complex networks.</article-title><source><italic toggle="yes">Sci Rep.</italic></source><year>2012</year>;<volume>2</volume>: 336.
<pub-id pub-id-type="doi">10.1038/srep00336</pub-id><!--<pub-id pub-id-type="pmcid">3313482</pub-id>--><?supplied-pmid 22468223?><pub-id pub-id-type="pmid">22468223</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Su</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name></person-group>:
<article-title>A seed-expanding method based on random walks for community detection in networks with ambiguous community structures.</article-title><source><italic toggle="yes">Sci Rep.</italic></source><year>2017</year>;<volume>7</volume>: 41830.
<pub-id pub-id-type="doi">10.1038/srep41830</pub-id><!--<pub-id pub-id-type="pmcid">5291113</pub-id>--><?supplied-pmid 28157183?><pub-id pub-id-type="pmid">28157183</pub-id></mixed-citation>
    </ref>
    <ref id="ref-10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosvall</surname><given-names>M</given-names></name><name><surname>Bergstrom</surname><given-names>CT</given-names></name></person-group>:
<article-title>An information-theoretic framework for resolving community structure in complex networks.</article-title><source><italic toggle="yes">Proc Natl Acad Sci U S A.</italic></source><year>2007</year>;<volume>104</volume>(<issue>18</issue>):<fpage>7327</fpage>–<lpage>31</lpage>.
<pub-id pub-id-type="doi">10.1073/pnas.0611034104</pub-id><!--<pub-id pub-id-type="pmcid">1855072</pub-id>--><?supplied-pmid 17452639?><pub-id pub-id-type="pmid">17452639</pub-id></mixed-citation>
    </ref>
    <ref id="ref-11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reichardt</surname><given-names>J</given-names></name><name><surname>Bornholdt</surname><given-names>S</given-names></name></person-group>:
<article-title>Statistical mechanics of community detection.</article-title><source><italic toggle="yes">Phys Rev E Stat Nonlin Soft Matter Phys.</italic></source><year>2006</year>;<volume>74</volume>(<issue>1 Pt 2</issue>):<fpage>016110</fpage>.
<pub-id pub-id-type="doi">10.1103/PhysRevE.74.016110</pub-id><?supplied-pmid 16907154?><pub-id pub-id-type="pmid">16907154</pub-id></mixed-citation>
    </ref>
    <ref id="ref-12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newman</surname><given-names>ME</given-names></name><name><surname>Girvan</surname><given-names>M</given-names></name></person-group>:
<article-title>Finding and evaluating community structure in networks.</article-title><source><italic toggle="yes">Phys Rev E Stat Nonlin Soft Matter Phys.</italic></source><year>2004</year>;<volume>69</volume>(<issue>2 Pt 2</issue>):<fpage>026113</fpage>.
<pub-id pub-id-type="doi">10.1103/PhysRevE.69.026113</pub-id><?supplied-pmid 14995526?><pub-id pub-id-type="pmid">14995526</pub-id></mixed-citation>
    </ref>
    <ref id="ref-13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enright</surname><given-names>AJ</given-names></name><name><surname>Van Dongen</surname><given-names>S</given-names></name><name><surname>Ouzounis</surname><given-names>CA</given-names></name></person-group>:
<article-title>An efficient algorithm for large-scale detection of protein families.</article-title><source><italic toggle="yes">Nucleic Acids Res.</italic></source><year>2002</year>;<volume>30</volume>(<issue>7</issue>):<fpage>1575</fpage>–<lpage>84</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/30.7.1575</pub-id><!--<pub-id pub-id-type="pmcid">101833</pub-id>--><?supplied-pmid 11917018?><pub-id pub-id-type="pmid">11917018</pub-id></mixed-citation>
    </ref>
    <ref id="ref-14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blondel</surname><given-names>VD</given-names></name><name><surname>Guillaume</surname><given-names>J</given-names></name><name><surname>Lambiotte</surname><given-names>R</given-names></name><etal/></person-group>:
<article-title>Fast unfolding of communities in large networks.</article-title><source><italic toggle="yes">J Stat Mech Theory Exp.</italic></source><year>2008</year>;<volume>2008</volume>(<issue>10</issue>):<fpage>P10008</fpage><pub-id pub-id-type="doi">10.1088/1742-5468/2008/10/P10008</pub-id></mixed-citation>
    </ref>
    <ref id="ref-15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>XF</given-names></name><name><surname>Dai</surname><given-names>DQ</given-names></name><etal/></person-group>:
<article-title>Identifying spurious interactions and predicting missing interactions in the protein-protein interaction networks via a generative network model.</article-title><source><italic toggle="yes">IEEE/ACM Trans Comput Biol Bioinform.</italic></source><year>2013</year>;<volume>10</volume>(<issue>1</issue>):<fpage>219</fpage>–<lpage>25</lpage>.
<pub-id pub-id-type="doi">10.1109/TCBB.2012.164</pub-id><?supplied-pmid 23702559?><pub-id pub-id-type="pmid">23702559</pub-id></mixed-citation>
    </ref>
    <ref id="ref-16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>F</given-names></name><name><surname>Min</surname><given-names>H</given-names></name><etal/></person-group>:
<article-title>SHINE: Signed heterogeneous information network embedding for sentiment link prediction.</article-title><source><italic toggle="yes">Proceedings of the Eleventh ACM International Conference on Web Search and Data Mining.</italic></source><year>2018</year>;<fpage>592</fpage>–<lpage>600</lpage>.
<pub-id pub-id-type="doi">10.1145/3159652.3159666</pub-id></mixed-citation>
    </ref>
    <ref id="ref-17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guimera</surname><given-names>R</given-names></name><name><surname>Sales-Pardo</surname><given-names>M</given-names></name></person-group>:
<article-title>Missing and spurious interactions and the reconstruction of complex networks.</article-title><source><italic toggle="yes">Proc Natl Acad Sci U S A.</italic></source><year>2009</year>;<volume>106</volume>(<issue>52</issue>):<fpage>22073</fpage>–<lpage>8</lpage>.
<pub-id pub-id-type="doi">10.1073/pnas.0908366106</pub-id><!--<pub-id pub-id-type="pmcid">2799723</pub-id>--><?supplied-pmid 20018705?><pub-id pub-id-type="pmid">20018705</pub-id></mixed-citation>
    </ref>
    <ref id="ref-18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aicher</surname><given-names>C</given-names></name><name><surname>Jacobs</surname><given-names>AZ</given-names></name><name><surname>Clauset</surname><given-names>A</given-names></name></person-group>:
<article-title>Learning latent block structure in weighted networks.</article-title><source><italic toggle="yes">J Complex Netw.</italic></source><year>2015</year>;<volume>3</volume>(<issue>2</issue>):<fpage>221</fpage>–<lpage>248</lpage>.
<pub-id pub-id-type="doi">10.1093/comnet/cnu026</pub-id></mixed-citation>
    </ref>
    <ref id="ref-19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williamson</surname><given-names>SA</given-names></name></person-group>:
<article-title>Nonparametric network models for link prediction.</article-title><source><italic toggle="yes">J Mach Learn Res.</italic></source><year>2016</year>;<volume>17</volume><ext-link ext-link-type="uri" xlink:href="https://pdfs.semanticscholar.org/2217/d47f414951c1f8aaa693b690aa50f85d5043.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>B</given-names></name><name><surname>Xia</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>XJ</given-names></name></person-group>:
<article-title>Weight prediction in complex networks based on neighbor set.</article-title><source><italic toggle="yes">Sci Rep.</italic></source><year>2016</year>;<volume>6</volume>: 38080.
<pub-id pub-id-type="doi">10.1038/srep38080</pub-id><?supplied-pmid 27905497?><pub-id pub-id-type="pmid">27905497</pub-id></mixed-citation>
    </ref>
    <ref id="ref-21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Navlakha</surname><given-names>S</given-names></name><name><surname>Gitter</surname><given-names>A</given-names></name><name><surname>Bar-Joseph</surname><given-names>Z</given-names></name></person-group>:
<article-title>A network-based approach for predicting missing pathway interactions.</article-title><source><italic toggle="yes">PLoS Comput Biol.</italic></source><year>2012</year>;<volume>8</volume>(<issue>8</issue>):<fpage>e1002640</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1002640</pub-id><!--<pub-id pub-id-type="pmcid">3420932</pub-id>--><?supplied-pmid 22916002?><pub-id pub-id-type="pmid">22916002</pub-id></mixed-citation>
    </ref>
    <ref id="ref-22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shakibian</surname><given-names>H</given-names></name><name><surname>Moghadam Charkari</surname><given-names>N</given-names></name></person-group>:
<article-title>Mutual information model for link prediction in heterogeneous complex networks.</article-title><source><italic toggle="yes">Sci Rep.</italic></source><year>2017</year>;<volume>7</volume>: 44981.
<pub-id pub-id-type="doi">10.1038/srep44981</pub-id><!--<pub-id pub-id-type="pmcid">5366872</pub-id>--><?supplied-pmid 28344326?><pub-id pub-id-type="pmid">28344326</pub-id></mixed-citation>
    </ref>
    <ref id="ref-23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>L</given-names></name><name><surname>Zhou</surname><given-names>T</given-names></name><name><surname>Lü</surname><given-names>L</given-names></name><etal/></person-group>:
<article-title>Predicting missing links and identifying spurious links via likelihood analysis.</article-title><source><italic toggle="yes">Sci Rep.</italic></source><year>2016</year>;<volume>6</volume>: 22955.
<pub-id pub-id-type="doi">10.1038/srep22955</pub-id><!--<pub-id pub-id-type="pmcid">4785364</pub-id>--><?supplied-pmid 26961965?><pub-id pub-id-type="pmid">26961965</pub-id></mixed-citation>
    </ref>
    <ref id="ref-24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holland</surname><given-names>PW</given-names></name><name><surname>Laskey</surname><given-names>KB</given-names></name><name><surname>Leinhardt</surname><given-names>S</given-names></name></person-group>:
<article-title>Stochastic blockmodels: First steps.</article-title><source><italic toggle="yes">Soc Networks.</italic></source><year>1983</year>;<volume>5</volume>(<issue>2</issue>):<fpage>109</fpage>–<lpage>137</lpage>.
<pub-id pub-id-type="doi">10.1016/0378-8733(83)90021-7</pub-id></mixed-citation>
    </ref>
    <ref id="ref-25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peixoto</surname><given-names>TP</given-names></name></person-group>:
<article-title>Hierarchical block structures and high-resolution model selection in large networks.</article-title><source><italic toggle="yes">Phys Rev X.</italic></source><year>2014</year>;<volume>4</volume>(<issue>1</issue>): 011047.
<pub-id pub-id-type="doi">10.1103/PhysRevX.4.011047</pub-id></mixed-citation>
    </ref>
    <ref id="ref-26">
      <label>26</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>XJ</given-names></name><name><surname>Zhao</surname><given-names>CL</given-names></name><etal/></person-group>:
<article-title>Degree-corrected stochastic block models and reliability in networks.</article-title><source><italic toggle="yes">Physica A-Statistical Mechanics and Its Applications.</italic></source><year>2014</year>;<volume>393</volume>:<fpage>553</fpage>–<lpage>559</lpage>.
<pub-id pub-id-type="doi">10.1016/j.physa.2013.08.061</pub-id></mixed-citation>
    </ref>
    <ref id="ref-27">
      <label>27</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallès-Català</surname><given-names>T</given-names></name><name><surname>Peixoto</surname><given-names>TP</given-names></name><name><surname>Sales-Pardo</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>Consistencies and inconsistencies between model selection and link prediction in networks.</article-title><source><italic toggle="yes">Phys Rev E.</italic></source><year>2018</year>;<volume>97</volume>(<issue>6–1</issue>):<fpage>062316</fpage>.
<pub-id pub-id-type="doi">10.1103/PhysRevE.97.062316</pub-id><?supplied-pmid 30011606?><pub-id pub-id-type="pmid">30011606</pub-id></mixed-citation>
    </ref>
    <ref id="ref-28">
      <label>28</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kosinski</surname><given-names>M</given-names></name><name><surname>Biecek</surname><given-names>P</given-names></name></person-group>:
<article-title>RTCGA: The cancer genome atlas data integration</article-title>.<year>2016</year><ext-link ext-link-type="uri" xlink:href="https://rtcga.github.io/RTCGA">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-29">
      <label>29</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mertins</surname><given-names>P</given-names></name><name><surname>Mani</surname><given-names>DR</given-names></name><name><surname>Ruggles</surname><given-names>KV</given-names></name><etal/></person-group>:
<article-title>Proteogenomics connects somatic mutations to signalling in breast cancer.</article-title><source><italic toggle="yes">Nature.</italic></source><year>2016</year>;<volume>534</volume>(<issue>7605</issue>):<fpage>55</fpage>–<lpage>62</lpage>.
<pub-id pub-id-type="doi">10.1038/nature18003</pub-id><!--<pub-id pub-id-type="pmcid">5102256</pub-id>--><?supplied-pmid 27251275?><pub-id pub-id-type="pmid">27251275</pub-id></mixed-citation>
    </ref>
    <ref id="ref-30">
      <label>30</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Budczies</surname><given-names>J</given-names></name><name><surname>Brockmöller</surname><given-names>SF</given-names></name><name><surname>Müller</surname><given-names>BM</given-names></name><etal/></person-group>:
<article-title>Comparative metabolomics of estrogen receptor positive and estrogen receptor negative breast cancer: alterations in glutamine and beta-alanine metabolism.</article-title><source><italic toggle="yes">J Proteomics.</italic></source><year>2013</year>;<volume>94</volume>:<fpage>279</fpage>–<lpage>88</lpage>.
<pub-id pub-id-type="doi">10.1016/j.jprot.2013.10.002</pub-id><?supplied-pmid 24125731?><pub-id pub-id-type="pmid">24125731</pub-id></mixed-citation>
    </ref>
    <ref id="ref-31">
      <label>31</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrell</surname><given-names>FE</given-names><suffix>Jr and with contributions from Charles Dupont and many others</suffix></name></person-group>:
<article-title>Hmisc: Harrell miscellaneous</article-title>.<year>2018</year><ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=Hmisc">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-32">
      <label>32</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y</given-names></name><name><surname>Hochberg</surname><given-names>Y</given-names></name></person-group>:
<article-title>Controlling the false discovery rate - a practical and powerful approach to multiple testing.</article-title><source><italic toggle="yes">J R Statist Soc B.</italic></source><year>1995</year>;<volume>57</volume>(<issue>1</issue>):<fpage>289</fpage>–<lpage>300</lpage>.
<pub-id pub-id-type="doi">10.1111/j.2517-6161.1995.tb02031.x</pub-id></mixed-citation>
    </ref>
    <ref id="ref-33">
      <label>33</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peixoto</surname><given-names>TP</given-names></name></person-group>:
<article-title>Bayesian stochastic blockmodeling.</article-title><source><italic toggle="yes">eprint arXiv:1705.10225.</italic></source><year>2017</year>;<fpage>arXiv:1705.10225</fpage><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1705.10225">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-34">
      <label>34</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peixoto</surname><given-names>TP</given-names></name></person-group>:
<article-title>Nonparametric Bayesian inference of the microcanonical stochastic block model.</article-title><source><italic toggle="yes">Phys Rev E.</italic></source><year>2017</year>;<volume>95</volume>(<issue>1–1</issue>):<fpage>012317</fpage>.
<pub-id pub-id-type="doi">10.1103/PhysRevE.95.012317</pub-id><?supplied-pmid 28208453?><pub-id pub-id-type="pmid">28208453</pub-id></mixed-citation>
    </ref>
    <ref id="ref-35">
      <label>35</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karrer</surname><given-names>B</given-names></name><name><surname>Newman</surname><given-names>MEJ</given-names></name></person-group>:
<article-title>Stochastic blockmodels and community structure in networks.</article-title><source><italic toggle="yes">Phys Rev E.</italic></source><year>2011</year>;<volume>83</volume>(<issue>1)</issue>: 016107.
<pub-id pub-id-type="doi">10.1103/PhysRevE.83.016107</pub-id></mixed-citation>
    </ref>
    <ref id="ref-36">
      <label>36</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peixoto</surname><given-names>TP</given-names></name></person-group>:
<article-title>The graph-tool python library.</article-title><source><italic toggle="yes">figshare.</italic></source><year>2014</year><pub-id pub-id-type="doi">10.6084/m9.figshare.1164194</pub-id></mixed-citation>
    </ref>
    <ref id="ref-37">
      <label>37</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peixoto</surname><given-names>TP</given-names></name></person-group>:
<article-title>Efficient Monte Carlo and greedy heuristic for the inference of stochastic block models.</article-title><source><italic toggle="yes">Phys Rev E Stat Nonlin Soft Matter Phys.</italic></source><year>2014</year>;<volume>89</volume>(<issue>1</issue>):<fpage>012804</fpage>.
<pub-id pub-id-type="doi">10.1103/PhysRevE.89.012804</pub-id><?supplied-pmid 24580278?><pub-id pub-id-type="pmid">24580278</pub-id></mixed-citation>
    </ref>
    <ref id="ref-38">
      <label>38</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>G</given-names></name><name><surname>He</surname><given-names>QY</given-names></name></person-group>:
<article-title>ReactomePA: an R/Bioconductor package for reactome pathway analysis and visualization.</article-title><source><italic toggle="yes">Mol Biosyst.</italic></source><year>2016</year>;<volume>12</volume>(<issue>2</issue>):<fpage>477</fpage>–<lpage>9</lpage>.
<pub-id pub-id-type="doi">10.1039/c5mb00663e</pub-id><?supplied-pmid 26661513?><pub-id pub-id-type="pmid">26661513</pub-id></mixed-citation>
    </ref>
    <ref id="ref-39">
      <label>39</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fabregat</surname><given-names>A</given-names></name><name><surname>Jupe</surname><given-names>S</given-names></name><name><surname>Matthews</surname><given-names>L</given-names></name><etal/></person-group>:
<article-title>The Reactome Pathway Knowledgebase.</article-title><source><italic toggle="yes">Nucleic Acids Res.</italic></source><year>2018</year>;<volume>46</volume>(<issue>D1</issue>):<fpage>D649</fpage>–<lpage>D655</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gkx1132</pub-id><!--<pub-id pub-id-type="pmcid">5753187</pub-id>--><?supplied-pmid 29145629?><pub-id pub-id-type="pmid">29145629</pub-id></mixed-citation>
    </ref>
    <ref id="ref-40">
      <label>40</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>López-Ibáñez</surname><given-names>J</given-names></name><name><surname>Pazos</surname><given-names>F</given-names></name><name><surname>Chagoyen</surname><given-names>M</given-names></name></person-group>:
<article-title>MBROLE 2.0-functional enrichment of chemical compounds.</article-title><source><italic toggle="yes">Nucleic Acids Res.</italic></source><year>2016</year>;<volume>44</volume>(<issue>W1</issue>):<fpage>W201</fpage>–<lpage>W204</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gkw253</pub-id><!--<pub-id pub-id-type="pmcid">4987872</pub-id>--><?supplied-pmid 27084944?><pub-id pub-id-type="pmid">27084944</pub-id></mixed-citation>
    </ref>
    <ref id="ref-41">
      <label>41</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>GC</given-names></name><name><surname>Wang</surname><given-names>LG</given-names></name><name><surname>Han</surname><given-names>YY</given-names></name><etal/></person-group>:
<article-title>clusterProfiler: an R package for comparing biological themes among gene clusters.</article-title><source><italic toggle="yes">OMICS.</italic></source><year>2012</year>;<volume>16</volume>(<issue>5</issue>):<fpage>284</fpage>–<lpage>287</lpage>.
<pub-id pub-id-type="doi">10.1089/omi.2011.0118</pub-id><!--<pub-id pub-id-type="pmcid">3339379</pub-id>--><?supplied-pmid 22455463?><pub-id pub-id-type="pmid">22455463</pub-id></mixed-citation>
    </ref>
    <ref id="ref-42">
      <label>42</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liberzon</surname><given-names>A</given-names></name><name><surname>Birger</surname><given-names>C</given-names></name><name><surname>Thorvaldsdóttir</surname><given-names>H</given-names></name><etal/></person-group>:
<article-title>The Molecular Signatures Database (MSigDB) hallmark gene set collection.</article-title><source><italic toggle="yes">Cell Syst.</italic></source><year>2015</year>;<volume>1</volume>(<issue>6</issue>):<fpage>417</fpage>–<lpage>425</lpage>.
<pub-id pub-id-type="doi">10.1016/j.cels.2015.12.004</pub-id><!--<pub-id pub-id-type="pmcid">4707969</pub-id>--><?supplied-pmid 26771021?><pub-id pub-id-type="pmid">26771021</pub-id></mixed-citation>
    </ref>
    <ref id="ref-43">
      <label>43</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harvey</surname><given-names>JM</given-names></name><name><surname>Clark</surname><given-names>GM</given-names></name><name><surname>Osborne</surname><given-names>CK</given-names></name><etal/></person-group>:
<article-title>Estrogen receptor status by immunohistochemistry is superior to the ligand-binding assay for predicting response to adjuvant endocrine therapy in breast cancer.</article-title><source><italic toggle="yes">J Clin Oncol.</italic></source><year>1999</year>;<volume>17</volume>(<issue>5</issue>):<fpage>1474</fpage>–<lpage>81</lpage>.
<pub-id pub-id-type="doi">10.1200/JCO.1999.17.5.1474</pub-id><?supplied-pmid 10334533?><pub-id pub-id-type="pmid">10334533</pub-id></mixed-citation>
    </ref>
    <ref id="ref-44">
      <label>44</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Samaan</surname><given-names>NA</given-names></name><name><surname>Buzdar</surname><given-names>AU</given-names></name><name><surname>Aldinger</surname><given-names>KA</given-names></name><etal/></person-group>:
<article-title>Estrogen receptor: a prognostic factor in breast cancer.</article-title><source><italic toggle="yes">Cancer.</italic></source><year>1981</year>;<volume>47</volume>(<issue>3</issue>):<fpage>554</fpage>–<lpage>60</lpage>.
<?supplied-pmid 7226005?><pub-id pub-id-type="pmid">7226005</pub-id></mixed-citation>
    </ref>
    <ref id="ref-45">
      <label>45</label>
      <mixed-citation publication-type="journal"><article-title>Clinical practice guidelines for the use of tumor markers in breast and colorectal cancer. Adopted on May 17, 1996 by the American Society of Clinical Oncology.</article-title><source><italic toggle="yes">J Clin Oncol.</italic></source><year>1996</year>;<volume>14</volume>(<issue>10</issue>):<fpage>2843</fpage>–<lpage>2877</lpage>.
<pub-id pub-id-type="doi">10.1200/JCO.1996.14.10.2843</pub-id><?supplied-pmid 8874347?><pub-id pub-id-type="pmid">8874347</pub-id></mixed-citation>
    </ref>
    <ref id="ref-46">
      <label>46</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baum</surname><given-names>K</given-names></name><name><surname>Rajapakse</surname><given-names>JC</given-names></name><name><surname>Azuaje</surname><given-names>F</given-names></name></person-group>:
<article-title>Analysis of correlation-based biomolecular networks from different omics data by fitting stochastic block models (version v3) [Data set].</article-title><source><italic toggle="yes">Zenodo.</italic></source><year>2019</year><pub-id pub-id-type="doi">10.5281/zenodo.3363060</pub-id></mixed-citation>
    </ref>
    <ref id="ref-47">
      <label>47</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peixoto</surname><given-names>TP</given-names></name></person-group>:
<article-title>Nonparametric weighted stochastic block models.</article-title><source><italic toggle="yes">Phys Rev E.</italic></source><year>2018</year>;<volume>97</volume>(<issue>1–1</issue>):<fpage>012306</fpage>.
<pub-id pub-id-type="doi">10.1103/PhysRevE.97.012306</pub-id><?supplied-pmid 29448436?><pub-id pub-id-type="pmid">29448436</pub-id></mixed-citation>
    </ref>
    <ref id="ref-48">
      <label>48</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuo</surname><given-names>CY</given-names></name><name><surname>Ann</surname><given-names>DK</given-names></name></person-group>:
<article-title>When fats commit crimes: fatty acid metabolism, cancer stemness and therapeutic resistance.</article-title><source><italic toggle="yes">Cancer Commun (Lond).</italic></source><year>2018</year>;<volume>38</volume>(<issue>1</issue>):<fpage>47</fpage>.
<pub-id pub-id-type="doi">10.1186/s40880-018-0317-9</pub-id><!--<pub-id pub-id-type="pmcid">6042406</pub-id>--><?supplied-pmid 29996946?><pub-id pub-id-type="pmid">29996946</pub-id></mixed-citation>
    </ref>
    <ref id="ref-49">
      <label>49</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xiao</surname><given-names>F</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Yin</surname><given-names>H</given-names></name><etal/></person-group>:
<article-title>Leucine deprivation inhibits proliferation and induces apoptosis of human breast cancer cells via fatty acid synthase.</article-title><source><italic toggle="yes">Oncotarget.</italic></source><year>2016</year>;<volume>7</volume>(<issue>39</issue>):<fpage>63679</fpage>–<lpage>63689</lpage>.
<pub-id pub-id-type="doi">10.18632/oncotarget.11626</pub-id><!--<pub-id pub-id-type="pmcid">5325395</pub-id>--><?supplied-pmid 27579768?><pub-id pub-id-type="pmid">27579768</pub-id></mixed-citation>
    </ref>
    <ref id="ref-50">
      <label>50</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Begicevic</surname><given-names>RR</given-names></name><name><surname>Falasca</surname><given-names>M</given-names></name></person-group>:
<article-title>ABC Transporters in Cancer Stem Cells: Beyond Chemoresistance.</article-title><source><italic toggle="yes">Int J Mol Sci.</italic></source><year>2017</year>;<volume>18</volume>(<issue>11</issue>): pii: E2362.
<pub-id pub-id-type="doi">10.3390/ijms18112362</pub-id><!--<pub-id pub-id-type="pmcid">5713331</pub-id>--><?supplied-pmid 29117122?><pub-id pub-id-type="pmid">29117122</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report52997" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.22342.r52997</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Conesa</surname>
          <given-names>Ana</given-names>
        </name>
        <xref ref-type="aff" rid="r52997a1">1</xref>
        <role>Referee</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ugidos</surname>
          <given-names>Manuel</given-names>
        </name>
        <xref ref-type="aff" rid="r52997a2">2</xref>
        <role>Co-referee</role>
      </contrib>
      <aff id="r52997a1"><label>1</label>Department of Microbiology and Cell Science, Institute of Food and Agricultural Sciences (IFAS), University of Florida, Gainesville, FL, USA</aff>
      <aff id="r52997a2"><label>2</label>Institute of Biomedicine of Valencia (IBV), CSIC, Valencia, Spain</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Conesa A and Ugidos M</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e6479" ext-link-type="doi" xlink:href="10.12688/f1000research.18705.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>Revised manuscript satisfied most of the previous comments.
<list list-type="order"><list-item><p><bold>Data preprocessing: </bold></p><p> Datasets are well characterize by the number of samples and features, the missing data imputation of the three datasets is clarified.</p></list-item><list-item><p><bold>Network generation and reduction: </bold></p><p> An explanation is included about the use of 10
<sup>7 </sup>as a threshold for the number of edges and its relation with the test-multiple correction rates performed. Furthermore, the scale-free reduction is better explained.</p></list-item><list-item><p><bold>Stochastic block models:</bold></p><p> On the one hand, the SBM model definition is more extensive and the underfitting problem is addressed. On the other hand, although the comment about the number of partitions is correctly answered, this explanation is not included in the body text.</p></list-item><list-item><p><bold>Functional enrichment:</bold></p><p> The use of Reactome and KEGG is now justified. The description of Figure 3 has improved and a new panel was added. Moreover, two new Figures were included dealing with the biological insights derived from the SBM blocks. Finally, the edge confident scores section is explained in more detail.</p></list-item></list>  </p>
    <p>
      <bold>New comments about revised manuscript:</bold>
    </p>
    <p> Figure 3C and 3D both suggest that SBM block hierarchy does not relates with Reactome’s hierarchy. As mentioned in text, SBM blocks are characterized by common connectivity characteristics which may not be completely related with traditional classification based on functions. This is the key point of SBM derived blocks and it is not fully evaluated in terms of biological meaning, i.e, which pathways are more related to the SBM blocks? Also, a figure with the SBM networks (network topology) as in Figure 2C but including tags with enriched pathways should be included in order to evaluate the biological information that could be extracted from the SBM network. In this sense, Figures 4 and 5 are more suitable than Figure 3 as a “validation” of the capability of SBM-derived communities to capture biological function related to breast cancer.</p>
    <p> The validation step previously proposed: “A good approach could be to select a gene X and see if the rest of the genes of the pathways, where gene X is annotated, are in the same block of gene X (or in near blocks in the hierarchy). And repeat this for a high number of genes.” has not been neither performed or considered in the response. If not suitable or possible, please explain why.</p>
    <p>We confirm that we have read this submission and believe that we have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however we have significant reservations, as outlined above.</p>
  </body>
</sub-article>
<sub-article id="report52998" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.22342.r52998</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Lei</given-names>
        </name>
        <xref ref-type="aff" rid="r52998a2">2</xref>
        <role>Referee</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Qiu</surname>
          <given-names>Yue</given-names>
        </name>
        <xref ref-type="aff" rid="r52998a1">1</xref>
        <role>Co-referee</role>
      </contrib>
      <aff id="r52998a1"><label>1</label>City University of New York, New York, NY, USA</aff>
      <aff id="r52998a2"><label>2</label>Department of Computer Science, Hunter College, The City University of New York, New York, NY, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Qiu Y and Xie L</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e6597" ext-link-type="doi" xlink:href="10.12688/f1000research.18705.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>Authors have addressed the issues raised. No further comments to make</p>
    <p>We confirm that we have read this submission and believe that we have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article id="report47834" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.20484.r47834</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Conesa</surname>
          <given-names>Ana</given-names>
        </name>
        <xref ref-type="aff" rid="r47834a1">1</xref>
        <role>Referee</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ugidos</surname>
          <given-names>Manuel</given-names>
        </name>
        <xref ref-type="aff" rid="r47834a2">2</xref>
        <role>Co-referee</role>
      </contrib>
      <aff id="r47834a1"><label>1</label>Department of Microbiology and Cell Science, Institute of Food and Agricultural Sciences (IFAS), University of Florida, Gainesville, FL, USA</aff>
      <aff id="r47834a2"><label>2</label>Institute of Biomedicine of Valencia (IBV), CSIC, Valencia, Spain</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>6</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Conesa A and Ugidos M</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e6669" ext-link-type="doi" xlink:href="10.12688/f1000research.18705.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>reject</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>This manuscript describes the application of stochastic block models (SBMs) as a method to construct biological networks from different omics data. Starting from correlation-based networks of breast cancer data, SBM delivers different modules (or blocks) of the network. In order to assess the usefulness of this approach, the authors evaluate the biological meaning of the modules obtained performing a functional enrichment analysis for each module of the network. Finally, the authors include the edge confidence score computation for each edge in the resulting network.</p>
    <p> This novel application of SBMs with omics data is interesting but its utility is not clearly explained in the manuscript. First, the title is confusing, since I understood a single network is obtained from different omics data, i.e. a multiomic integration analysis, however it is not performed. Furthermore, why are these three datasets used? It seems the authors want to evaluate the SBM-based networks starting from datasets with different complexity (different number of features/samples), but the reason is not properly explained.</p>
    <p> As for the SBM model definition, because of the microcanonical formulation because of its hard constraints, network underfitting could be an important issue. Although underfitting is solved using nested (hierarchical) or degree-corrected SBMs, an explanation of this phenomena and how to deal with it would be suitable in “Fit to SBM” methodological section.</p>
    <p> Regarding the functional enrichment, the choice of the pathway database is not clear. Why is Reactome chosen for genes annotation and KEGG for metabolites? Taking into account that breast cancer related biological findings is not the scope of this manuscript, a deeper analysis of biological information revealed by network blocks is necessary: which pathways are block-specific? Which pathway or pathways are present in the bigger block?  Do the pathway distances between blocks have any relation with previous knowledge about breast cancer? Furthermore, the pathway distances within and between blocks are computed just for the lower level of blocks. Since the network is hierarchical, pathway distances can be obtained for each level. This would indicate if the hierarchy is biological meaningful too. Moreover, the same genes are known to be annotated to related pathways. Therefore, this expected result does not represent a validation to determine the biological meaning of the blocks in the network. A good approach could be to select a gene X and see if the rest of the genes of the pathways, where gene X is annotated, are in the same block of gene X (or in near blocks in the hierarchy). And repeat this for a high number of genes.</p>
    <p> Finally, the edge confidence score looks like important to improve the network characterization, however they do not use this score to optimize the final network. I was expecting the comparison between the original SBM-based network and the corrected SBM-based network via edge confidence score optimization. In order to use the edge confidence scores, a way to compute thresholds for missing and spurious edges should be proposed.</p>
    <p> Resuming, SBM-based biological networks are a new way to represent omics data and it represents a novel approach for SBMs. However, a novel application should be coupled with a suitable interpretation of its results. Moreover, the main conclusion or this manuscript is not clear and the main question for a new methodological development is unanswered, why should I use this method?</p>
    <p>
      <bold>
        <underline>Specific points:</underline>
      </bold>
    </p>
    <p>
      <bold>1) Data preprocessing:</bold>
      <list list-type="bullet">
        <list-item>
          <p>Why are the three datasets used? Is it just a matter of different complexity? Datasets are not completely characterized as the number of features is not indicated.</p>
        </list-item>
        <list-item>
          <p>Authors say missing values of metabolite data were imputed previously. It is not clear whether they performed the imputation or not. In case they did, the algorithm used is not indicated. If missing values of metabolite data were imputed, why weren't the missing values of protein data?</p>
        </list-item>
      </list>
    </p>
    <p><bold>2) Network generation and reduction:</bold><list list-type="bullet"><list-item><p>They use different test-multiple correction rates for mRNA, protein and metabolites in order to obtain a similar degree of reduction. The authors should demonstrate this does not lead to any biases. The reduction objective is set at 10
<sup>7</sup> edges, is there any reason?</p></list-item><list-item><p>In Figure 1.D, a linear relationship is expected for the blue dots but it not perfectly linear, why? Could the scale-free reduction be modified to improve it?</p></list-item></list>  </p>
    <p><bold>3) Stochastic block models:</bold><list list-type="bullet"><list-item><p>How are the number of initial partitions (500) defined? Is there any relation between the suitable number of initial partitions and the network complexity (size)?</p></list-item></list>  </p>
    <p>
      <bold>4) Functional enrichment:</bold>
      <list list-type="bullet">
        <list-item>
          <p>They use Reactome database for genes annotation and KEGG for metabolites, but there is no an explanation of why that choice.</p>
        </list-item>
        <list-item>
          <p>Figure 3.C is confusing. I do not understand the objective of this analysis. In order to demonstrate the biological meaning of the hierarchical SBM, the pathway distances comparison within and between blocks at every hierarchical level (as in Figure 3.B) would be better than the provided analysis.</p>
        </list-item>
        <list-item>
          <p>As mentioned before, a deeper biological interpretation of the network is necessary.</p>
        </list-item>
        <list-item>
          <p>I am not sure what the clustering analysis is contributing to. Modules obtained by WGCNA shows good results looking at the number significant of pathways, but are they biologically relevant? Are they related to breast cancer?</p>
        </list-item>
      </list>
    </p>
    <p>We confirm that we have read this submission and believe that we have an appropriate level of expertise to state that we do not consider it to be of an acceptable scientific standard, for reasons outlined above.</p>
  </body>
  <sub-article id="comment4833" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Baum</surname>
            <given-names>Katharina</given-names>
          </name>
          <aff>Max Delbrück Center for Molecular Medicine in the Helmholtz Association, Germany</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>12</day>
        <month>8</month>
        <year>2019</year>
      </pub-date>
    </front-stub>
    <body>
      <p>We thank Dr. Ana Conesa and Manuel Ugidos for their time and effort they invested into commenting our work. They raised important points that we carefully addressed in our revised version 2 of the manuscript. Please find our specific replies and the description of introduced changes below. </p>
      <p> &gt;This manuscript describes the application of stochastic block models (SBMs) as a method to construct biological networks from different omics data. Starting from correlation-based networks of breast cancer data, SBM delivers different modules (or blocks) of the network. In order to assess the usefulness of this approach, the authors evaluate the biological meaning of the modules obtained performing a functional enrichment analysis for each module of the network. Finally, the authors include the edge confidence score computation for each edge in the resulting network.</p>
      <p> &gt;This novel application of SBMs with omics data is interesting but its utility is not clearly explained in the manuscript. First, the title is confusing, since I understood a single network is obtained from different omics data, i.e. a multiomic integration analysis, however it is not performed.</p>
      <p> &gt;Furthermore, why are these three datasets used? It seems the authors want to evaluate the SBM-based networks starting from datasets with different complexity (different number of features/samples), but the reason is not properly explained.</p>
      <p> &gt;As for the SBM model definition, because of the microcanonical formulation because of its hard constraints, network underfitting could be an important issue. Although underfitting is solved using nested (hierarchical) or degree-corrected SBMs, an explanation of this phenomena and how to deal with it would be suitable in ‘Fit to SBM’ methodological section.</p>
      <p> &gt;Regarding the functional enrichment, the choice of the pathway database is not clear. Why is Reactome chosen for genes annotation and KEGG for metabolites?</p>
      <p>  &gt;Taking into account that breast cancer related biological findings is not the scope of this manuscript, a deeper analysis of biological information revealed by network blocks is necessary: which pathways are block-specific? Which pathway or pathways are present in the bigger block?  Do the pathway distances between blocks have any relation with previous knowledge about breast cancer?</p>
      <p> &gt; Furthermore, the pathway distances within and between blocks are computed just for the lower level of blocks. Since the network is hierarchical, pathway distances can be obtained for each level. This would indicate if the hierarchy is biological meaningful too. Moreover, the same genes are known to be annotated to related pathways. Therefore, this expected result does not represent a validation to determine the biological meaning of the blocks in the network. A good approach could be to select a gene X and see if the rest of the genes of the pathways, where gene X is annotated, are in the same block of gene X (or in near blocks in the hierarchy). And repeat this for a high number of genes.</p>
      <p> &gt;Finally, the edge confidence score looks like important to improve the network characterization, however they do not use this score to optimize the final network. I was expecting the comparison between the original SBM-based network and the corrected SBM-based network via edge confidence score optimization. In order to use the edge confidence scores, a way to compute thresholds for missing and spurious edges should be proposed.</p>
      <p> &gt; Resuming, SBM-based biological networks are a new way to represent omics data and it represents a novel approach for SBMs. However, a novel application should be coupled with a suitable interpretation of its results. Moreover, the main conclusion or this manuscript is not clear and the main question for a new methodological development is unanswered, why should I use this method?</p>
      <p>
        <underline>
          <italic toggle="yes">Response:</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We thank the reviewers for the nice summary of our work. In order to sharpen the focus, we clarified in the abstract and at the end of the introduction that our goal is to pave the ground for the usage of the SBM model for different types of biomolecular networks. </italic>
          <italic toggle="yes">Investigating the capability of SBMs for representing and analysing different types of biological networks was the key challenge addressed in our article. We did not intend to compare the networks between layers, but rather assess to which extent the SBM is applicable to derive useful information in terms of (i) relevant clustering as well as (ii) network-based, alternative edge scores. </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We have shown that a lot more SBM-predicted blocks have biological counterparts (i.e. more genes or metabolites associated with certain Reactome or KEGG terms are clustered together) than expected by chance, and we show in our revised version that biological processes known to be relevant to the examined phenotype can be derived (new Figs. 4, 5, Table 2). </italic>
          <italic toggle="yes">In addition, we showed that the SBM-based edge relevance scores coincide with the correlation values (which have not been given to fit the network to the SBM). These results support our hypothesis that the SBM is suitable to represent and analyze biomolecular networks in which interactions are derived from correlations. </italic>
          <italic toggle="yes">This opens the avenue to new types of analyses using the SBM and its output for which this work lays the foundation. </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We hope that the reviewers will also find that the revised version supports this reasoning and the derived conclusion. </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">In response to other points that were raised only here but not in the specific points include below:</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">To</italic>
          <italic toggle="yes"> improve the clarity of the description of the data usage from the beginning, we reformulated the according sentences in the abstract and introduction which now read: </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">‘</italic>
          <italic toggle="yes">We apply SBM-based analysis independently to three correlation-based networks of breast cancer data originating from high-throughput measurements of different molecular layers: transcriptomics, proteomics, or metabolomics.</italic>
          <italic toggle="yes">’</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">‘Here we showcase the SBM-based analysis (overview in Fig. 1A) for three networks of different molecular types, derived from either transcriptomic, proteomic or metabolomics data of breast cancer tumours.’</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">In order to facilitate the understanding of the different SBM versions, we added an explanation on the hierarchical and degree-corrected version of the SBM into the methods part and comment on the relationship between underfitting and the hierarchical SBM in the revised methods section.</italic>
        </underline>
      </p>
      <p>
        <bold>&gt;Specific points:</bold>
      </p>
      <p>
        <bold>&gt;1) Data preprocessing:</bold>
      </p>
      <p> Why are the three datasets used? Is it just a matter of different complexity? Datasets are not completely characterized as the number of features is not indicated.</p>
      <p>
        <underline>
          <italic toggle="yes">Response:</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">Protein, mRNA and metabolites are key molecules in cells, which are widely applied, in isolation or in combinations, in different biomedical research domains. Their abundance and interconnectedness in networks are therefore of high interest if aiming to characterize cells or tumorous tissue. We used them to illustrate three examples for cellular interaction networks, whose interactions have different biological meanings. Moreover, in the revised article now we explain that we use these networks to reflect different characteristics of tumorous tissue/cells.</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">The number of features (i.e. number of mRNAs, proteins and metabolites) are given in the network characteristics in Table 1 (‘entities’ before NA removal and afterwards). In order to improve accessibility to the reader, we also state these numbers in the methods part of the revised manuscript and clearly identify them as feature count (‘mRNA, protein, metabolite data for ER-breast cancer tumors’).</italic>
        </underline>
      </p>
      <p> &gt;Authors say missing values of metabolite data were imputed previously. It is not clear whether they performed the imputation or not. In case they did, the algorithm used is not indicated. If missing values of metabolite data were imputed, why weren't the missing values of protein data?</p>
      <p>
        <italic>
          <underline>Response:</underline>
        </italic>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We used the metabolite data as provided in Budczies et al. 2009 in which imputation had been performed. </italic>
          <italic toggle="yes">In order to clarify this, we </italic>
          <italic toggle="yes">reformulated the sentence in the methods part to ‘</italic>
          <italic toggle="yes">The metabolite data did not contain missing values as imputation had been performed in the original publication
<sup>[Budczies et al. 2009]</sup>.’</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We used the processed protein data as provided in the original publication (Mertins et al, 2014). In general, in contrast to missing values in metabolite data which are usually considered to occur due to abundance below detection limit, missing values in protein data can have multiple different reasons making imputation less straightforward. Because we do not focus on data pre-processing here, we kept the data as close as possible to those originally published and rather took the opportunity to provide an idea of how to incorporate datasets with missing data into our proposed analysis framework.</italic>
        </underline>
      </p>
      <p>
        <bold>&gt;2) Network generation and reduction:</bold>
      </p>
      <p> They use different test-multiple correction rates for mRNA, protein and metabolites in order to obtain a similar degree of reduction. The authors should demonstrate this does not lead to any biases. The reduction objective is set at 10
<sup>7</sup>edges, is there any reason?</p>
      <p>
        <italic>
          <underline>Response:</underline>
        </italic>
      </p>
      <p>
        <italic>
          <underline> We reformulated and describe this part in more detail in the revised manuscript. In fact, we intended to provide examples for different corrections methods and thresholds which are frequently used, and to achieve a high degree of reduction (to reduce runtime for SBM fit) while still ensuring that the resulting biomolecular network is as connected as possible (see Fig. 1C). Similarity of the degree of reduction between the three data layers was not a goal to achieve. The border of 10
<sup>7</sup> edges arose out of computation time considerations (runtime scales with edge count for SBM fit in graph-tool, they correspond to several hours and Gbs of memory consumption for a single initialization), and thus could be adapted to each user’s case.</underline>
        </italic>
      </p>
      <p> &gt;In Figure 1.D, a linear relationship is expected for the blue dots but it not perfectly linear, why? Could the scale-free reduction be modified to improve it?</p>
      <p>
        <italic>
          <underline>Response:</underline>
        </italic>
      </p>
      <p>
        <underline>
          <italic toggle="yes">Usually, a perfect fit to scale-freeness cannot be achieved because altering the cut-off threshold leads to removal of multiple edges at the same time; the achievable combinations of which edges belong to the network are fully determined by the correlation values associated to the edges. We show possible scale-free fit indices (that index is a measure of how closely the node degree distribution resembles a power-law, i.e. how close the network is to scale-freeness) of the networks reduced by edge thresholding in new Fig. 1D. Therein, it also becomes clear that other thresholds could be used and can lead to ‘better’ scale-freeness in the resulting networks – while at the same time making the resulting network less connected. Other specific requirements on the degree of scale-freeness can be adapted on a case-by-case basis.</italic>
        </underline>
      </p>
      <p>
        <bold>&gt;3) Stochastic block models:</bold>
      </p>
      <p> How are the number of initial partitions (500) defined? Is there any relation between the suitable number of initial partitions and the network complexity (size)?</p>
      <p>
        <italic>
          <underline>Response: </underline>
        </italic>
      </p>
      <p>
        <underline>
          <italic toggle="yes">The number of initializations was chosen as first assessment whether this is sufficient to be able to distinguish between the different SBM types – which was the case. As is clear, for some networks different SBM types are more closely related whereas for others, they are well more separated. This will depend on the actual network/data that is fitted and serves as orientation. Of course, more initializations are always better, but it is subject to a trade-off between computation time and finding a good partition.</italic>
        </underline>
      </p>
      <p>
        <bold>&gt;4) Functional enrichment:</bold>
      </p>
      <p> They use Reactome database for genes annotation and KEGG for metabolites, but there is no an explanation of why that choice.</p>
      <p>
        <italic>
          <underline>Response:</underline>
        </italic>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We added the explanation to the revised version. Reactome provides a hierarchical annotation which qualifies it for comparison to the hierarchical structure given by the SBM, KEGG is one of the annotation databases used most for metabolites.</italic>
        </underline>
      </p>
      <p> &gt;Figure 3.C is confusing. I do not understand the objective of this analysis. In order to demonstrate the biological meaning of the hierarchical SBM, the pathway distances comparison within and between blocks at every hierarchical level (as in Figure 3.B) would be better than the provided analysis.</p>
      <p>
        <italic>
          <underline>Response:</underline>
        </italic>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We altered the accompanying description of Fig. 3C. What we intended is to relate the distance of two SBM blocks in the SBM hierarchy (x-axis) to the distances between the Reactome terms associated to the blocks (y-axis). For a matching hierarchy structure of Reactome and SBM, we would expect a positive correlation, i.e. more distant SBM blocks in the SBM hierarchy having more distantly related Reactome terms. We do not find convincing evidence for this. </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">To clarify the approach, we restructured Fig. 3 (by moving the results for the second distance measure into the supplement, new Fig. S3).</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes"> In addition, we now also include the analysis of within-block distance vs. between-block distances for the other hierarchy levels as suggested by the reviewer (new Fig. 3D). As in our previous analysis in Fig. 3C, we cannot find strong evidence for the hierarchy of the SBM coinciding with the Reactome hierarchy. Please note that the numbers of blocks with annotation get low in higher hierarchy levels, thereby reducing the number of hierarchy levels that can be considered for this analysis.</italic>
        </underline>
      </p>
      <p> &gt;As mentioned before, a deeper biological interpretation of the network is necessary.</p>
      <p> I am not sure what the clustering analysis is contributing to. Modules obtained by WGCNA shows good results looking at the number significant of pathways, but are they biologically relevant? Are they related to breast cancer?</p>
      <p>
        <italic>
          <underline>Response: </underline>
        </italic>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We provide additional biological interpretations of the clustering results in the revised version of the manuscript (see new Figs. 4, 5, Table 2). They show that the SBM-derived clustering can detect biological pathways known to be implicated in breast cancer according to oncogenic signatures from MSigDB, such as extracellular matrix organization or the cell cycle (see new Fig. 4), or fatty acid biosynthesis (Table 2). In addition, the relevance of further processes can be predicted, e.g. chromatin organization (new Fig. 5).</italic>
        </underline>
      </p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report47223" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.20484.r47223</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pineda San Juan</surname>
          <given-names>Silvia</given-names>
        </name>
        <xref ref-type="aff" rid="r47223a1">1</xref>
        <xref ref-type="aff" rid="r47223a2">2</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4017-1480</contrib-id>
      </contrib>
      <aff id="r47223a1"><label>1</label>Division of Transplant Surgery, Department of Surgery, University of California, San Francisco (UCSF), San Francisco, CA, USA</aff>
      <aff id="r47223a2"><label>2</label>Centro Nacional de Investigaciones Oncológicas (CNIO), Madrid, Spain</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Pineda San Juan S</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e7138" ext-link-type="doi" xlink:href="10.12688/f1000research.18705.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The manuscript provides an innovative way of using stochastic block models to perform networks for different omics data.</p>
    <p> The idea is interesting but the application should be better characterized. I was expecting a network integrating the different datasets, but the network is performed separately per each dataset. This fact should be addressed at the very beginning to avoid confusion to the readers. </p>
    <p> Also, the use of the three datasets is not justified, why these three and no others? </p>
    <p> It looks like the authors want to compare the three networks applied to the three datasets (mRNA, proteins, and metabolites) but the different sample size among other factors makes them not comparable.</p>
    <p> Finally, one of my main concern is that there is not a clear conclusion of the study, are they proposing a network that is better than the ones that already exist? (this is not assessed). Are they finding new biological insights for breast cancer? (this is not shown). The final conclusion is not clear since the authors did not give a biological example of the method application. It is not clear if the method outperforms others or if the method is able to find new biological interpretations, etc. Why people should use this method? What type of information will they obtain?</p>
    <p>
      <underline>More specific points: </underline>
    </p>
    <p> Data preparation and network generation:
<list list-type="bullet"><list-item><p>It is not clear to me why the authors used mRNA, protein and metabolites for this network study. Is it just because they were available, or is there a hypothesis under this selection? Why don't they use other omics data available in the TCGA? The sample size is pretty reduced for the proteomics data with only 36 samples. The other thing I do not understand is why they used metabolomics data measured in other individuals. And for the mRNA they do not give an exact sample size. </p></list-item><list-item><p>Why do they use Bonferroni for mRNA expression and Benjamini-Hochberg for protein, metabolite and just 0.01 for protein? This should be better justified.</p></list-item><list-item><p>They replace 0 values by NA, why? There is a big difference between a lack of expression and a missing value.</p></list-item><list-item><p>Do they filter for those genes that have a very low expression among samples? They only specify this for protein data, but what about mRNA expression? Are they considered only 0 for low expression or a very small cut-off normally used in mRNA analysis?  </p></list-item><list-item><p>Regarding the scale-free reduction. They explain that the technique removes weak links until met a criterion based on WGCNA package, but it does not well explain the process for this and how they applied this to the data. Please explain. </p></list-item></list>
</p>
    <p> Fitting SBM:
<list list-type="bullet"><list-item><p>They built the network based on a stochastic block model (SBM) representation, the nodes of a network are partitioned into blocks according to their similarity in connectivity. It is not clear how the SBM is applied to the data and how the similarities are obtained. </p></list-item></list>
</p>
    <p> For the SBM representing biological function:
<list list-type="bullet"><list-item><p>The whole module is unclear to me since they do not provide any biological or functional interpretation. I don't understand the goal of this. Figure 3 is also quite confusing.</p></list-item></list>
</p>
    <p>I confirm that I have read this submission and believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
  <sub-article id="comment4832" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Baum</surname>
            <given-names>Katharina</given-names>
          </name>
          <aff>Max Delbrück Center for Molecular Medicine in the Helmholtz Association, Germany</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>12</day>
        <month>8</month>
        <year>2019</year>
      </pub-date>
    </front-stub>
    <body>
      <p>We thank Dr. Silvia Pineda San Juan for the careful revision of our manuscript. Her comments helped us enhancing the clarity and stringency of our presentation and the reader's accessibility to our work. We respond to her specific comments and describe the introduced changes to version 2 of our manuscript below.</p>
      <p> &gt;The manuscript provides an innovative way of using stochastic block models to perform networks for different omics data.</p>
      <p> The idea is interesting but the application should be better characterized. I was expecting a network integrating the different datasets, but the network is performed separately per each dataset. This fact should be addressed at the very beginning to avoid confusion to the readers. </p>
      <p>
        <underline>
          <italic toggle="yes">Response:</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We thank the reviewer for her appreciation of our idea. In order to improve the clarity of the description of the data usage from the beginning, we reformulated the corresponding sentences in the abstract and introduction which now read: </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">‘We apply SBM-based analysis independently to three correlation-based networks of breast cancer data originating from high-throughput measurements of different molecular layers: either transcriptomics, proteomics, or metabolomics.’</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">‘Here we showcase the SBM-based analysis (overview in Fig. 1A) for three networks of different molecular types, derived from either transcriptomic, proteomic or metabolomics data of breast cancer tumours.’ </italic>
        </underline>
      </p>
      <p> &gt;Also, the use of the three datasets is not justified, why these three and no others? </p>
      <p> It looks like the authors want to compare the three networks applied to the three datasets (mRNA, proteins, and metabolites) but the different sample size among other factors makes them not comparable.</p>
      <p> Finally, one of my main concern is that there is not a clear conclusion of the study, are they proposing a network that is better than the ones that already exist? (this is not assessed). Are they finding new biological insights for breast cancer? (this is not shown). The final conclusion is not clear since the authors did not give a biological example of the method application. It is not clear if the method outperforms others or if the method is able to find new biological interpretations, etc. Why people should use this method? What type of information will they obtain?</p>
      <p>
        <underline>
          <italic toggle="yes">Response: </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">In order to sharpen the focus, we clarified in the abstract and at the end of the introduction that our goal is to pave the ground for the usage of the SBM model for different types of biomolecular networks. Investigating the capability of SBMs for representing and analysing different types of biological networks was the key challenge addressed in our article. We did not intend to compare the networks between layers, but rather assess to which extent the SBM is applicable to derive useful information in terms of (i) relevant clustering as well as (ii) network-based, alternative edge scores. </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We have shown that a lot more SBM-predicted blocks have biological counterparts (i.e. more genes or metabolites associated with certain Reactome or KEGG terms are clustered together) than expected by chance, and biological processes known to be relevant to the examined phenotype are can be derived (new Fig. 4, 5, Table 2). In addition, we showed that the SBM-based edge relevance scores coincide with the correlation values (which have not been given to fit the network to the SBM). These results support our hypothesis that the SBM is suitable to represent and analyze biomolecular networks in which interactions are derived from correlations. </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">This opens the avenue to new types of analyses using the SBM for which this work lays the foundation. </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">To strengthen our findings, as suggested by the reviewer, we now also include more biological interpretations of the clustering results (see Figs. 4, 5, Table 2). They show that the SBM-derived clustering can detect biological pathways known to be implicated in breast cancer according to oncogenic signatures from MSigDB, such as extracellular matrix organization and the cell cycle (see new Fig. 4), or fatty acid biosynthesis (Table 2). In addition, the relevance of further processes can be predicted, e.g. the chromatin organization (new Fig. 5).</italic>
        </underline>
      </p>
      <p>
        <underline>&gt;More specific points: </underline>
      </p>
      <p> &gt;Data preparation and network generation:  </p>
      <p> It is not clear to me why the authors used mRNA, protein and metabolites for this network study. Is it just because they were available, or is there a hypothesis under this selection? Why don't they use other omics data available in the TCGA? The sample size is pretty reduced for the proteomics data with only 36 samples. The other thing I do not understand is why they used metabolomics data measured in other individuals. And for the mRNA they do not give an exact sample size. </p>
      <p>
        <italic>
          <underline>Response:</underline>
        </italic>
      </p>
      <p>
        <underline>
          <italic toggle="yes">Protein, mRNA and metabolites are key molecules in cells, which are widely applied, in isolation or in combinations, in different biomedical research domains. Their abundance and interconnectedness in networks are therefore of high interest if aiming to characterize cells or tumorous tissue. We used them to illustrate three examples for cellular interaction networks, whose interactions have different biological meanings. Moreover, in the revised article now we explain that we use these networks to reflect different characteristics of tumorous tissue/cells.</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">Other potential data types could be e.g. mutations, copy number variation, DNA methylation or miRNAs, which are interesting avenues to further explore. While they could be useful, there are some caveats associated with them, e.g.: the derived interactions within layers are even less directly interpretable than for mRNA, protein or metabolite; networks generated from mutations and copy number variation are extremely sparse; the functional interpretation of DNA methylation data relies on transcription and the resulting networks are extremely big; the roles of miRNAs are less well known. Therefore, we decided to restrict our analyses to the three biomolecular entities mRNA, proteins and metabolites. We included these considerations when introducing the employed data layers in the results part of the revised manuscript. </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">Concerning the metabolite data: We are convinced that metabolites characterize a highly interesting layer of intra-tumor processes which is complementary to the gene expression associated layers mRNA and proteins. Unfortunately, metabolomics have not been measured for TCGA samples which is why we resorted to an alternative cohort for this data layer.</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">Please note that the number of tumour samples for each data layer were stated in the methods section (mRNA: 237, protein: 36, metabolite: 68). We now included that value for the mRNA data layer also into the main text. </italic>
        </underline>
      </p>
      <p> &gt;Why do they use Bonferroni for mRNA expression and Benjamini-Hochberg for protein, metabolite and just 0.01 for protein? This should be better justified.</p>
      <p>
        <italic>
          <underline>Response:</underline>
        </italic>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We explain our approach for network reduction more in detail in the methods and results part of the revised version of the manuscript. In fact, at first, we applied both Bonferroni and Benjamini-Hochberg correction methods, both of which are widely used and accepted, along with the classical significance thresholds 0.01 and 0.05 to the networks of all three data layers (see Fig. 1C). We finally chose the correction method and threshold for each data layer considering a trade-off between minimal network size (i.e. minimal computation time for the subsequent fit to SBM) and maximal connectedness of the reduced network: We used the combination which provided a high degree of reduction (less than 10 million edges in the network) while maximizing the size of the largest connected component in the network. While the stringent Bonferroni correction is necessary to achieve a sufficient degree of reduction for the mRNA network, it severely disrupted the connectedness for the protein and metabolite data layer leading to less than 30% or 65% of the nodes being in the largest connected component for protein or metabolite, respectively (see Fig 1C). </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">Using different correction methods and significance thresholds serve as examples of typical scenarios which could be envisioned during network reduction. Finally, every user could use their own thresholds reasonable for network reduction.</italic>
        </underline>
      </p>
      <p> &gt;They replace 0 values by NA, why? There is a big difference between a lack of expression and a missing value.</p>
      <p>
        <underline>
          <italic toggle="yes">Response:</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We replaced NAs by -10 in the log-counts of the RNAseq data. As stated in the methods part, the reason for this is the following: The RNAseq data are logarithmized (relative) counts. In this case the NAs are therefore artefacts from logarithmizing a zero count. Our replacement served to reverse this artefact.</italic>
        </underline>
      </p>
      <p> &gt;Do they filter for those genes that have a very low expression among samples? They only specify this for protein data, but what about mRNA expression? Are they considered only 0 for low expression or a very small cut-off normally used in mRNA analysis?  </p>
      <p>
        <underline>
          <italic toggle="yes">Response:</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">Apart from the replacement of NAs by very small values (-10 in log-counts) in the mRNA data, we use the data as provided by TCGA. The rationale for this is to reduce bias with respect to which nodes we consider. Since we do not focus on expression strength, but on the connection between molecular species, i.e. co-variation of expression, also lowly abundant species could, and indeed do, play a role, i.e. they have non-zero degree in the reduced networks. We dedicate new Figure S1D to an illustration of this fact.</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">One can imagine multiple other criteria of entity removal prior to analysis (e.g. tissue-specific GTEx, using pathways of interest) but this is not the focus of our work.</italic>
        </underline>
      </p>
      <p> &gt;Regarding the scale-free reduction. They explain that the technique removes weak links until met a criterion based on WGCNA package, but it does not well explain the process for this and how they applied this to the data. Please explain. </p>
      <p>
        <underline>
          <italic toggle="yes">Response:</italic>
        </underline>
      </p>
      <p>
        <underline><italic toggle="yes">We incorporated a more detailed explanation of this reduction technique in the methods part and added an additional panel to Fig. 1 (Fig. 1D) which illustrates intermediate results of the process. This is the revised methods part: ‘For the reduction by imposing a scale-free architecture of the reduced network, we employed the </italic>pickHardThreshold
<italic toggle="yes"> function of the WGCNA package (Langfelder et al, 2008) with the default requirement (0.85) on goodness of fit to a power-law degree distribution of the nodes. Given the symmetric absolute correlation matrix of the network edges, this function reduces the network by one of a given set of edge thresholds at a time and determines the scale-free fit index R
<sup>2</sup> which lies between 0 (bad fit) and 1 (perfect fit) by comparing the resulting degree distribution of the reduced network to a power-law degree distribution. The lowest of the tested edge thresholds that gives a scale-free fit index &gt; 0.85 is reported as estimated threshold. For the edge thresholds, we started with a grid with stepsize 0.05 between 0.3 and 0.95, refining according to the resulting estimates to vectors with stepsize 0.001 between 0.5 and 0.625 for the mRNA network, between 0.7 and 0.82 for the protein network and between 0.3 and 0.4 for the metabolite network. Finally estimated edge correlation thresholds were 0.603 (mRNA), 0.788 (protein), and 0.375 (metabolite).’</italic></underline>
      </p>
      <p> &gt;Fitting SBM:  </p>
      <p> They built the network based on a stochastic block model (SBM) representation, the nodes of a network are partitioned into blocks according to their similarity in connectivity. It is not clear how the SBM is applied to the data and how the similarities are obtained. </p>
      <p>
        <underline>
          <italic toggle="yes">Response:</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We extended the corresponding section describing the SBM in the Methods, in which we now also summarize the equations underlying the building of the SBM and the relationship between model likelihood and properties of the network graph derived from the data.</italic>
        </underline>
      </p>
      <p> &gt;For the SBM representing biological function:  </p>
      <p> The whole module is unclear to me since they do not provide any biological or functional interpretation. I don't understand the goal of this. Figure 3 is also quite confusing.</p>
      <p>
        <underline>
          <italic toggle="yes">Response:</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">The assumption behind the analysis is that a predicted block structure is meaningful if many of the predicted blocks have a biological counterpart, e.g., biological pathway. Such an analysis was performed as a starting point for assessing potential biological relevance. Nevertheless, because we agree that additional biological interpretations would benefit the reader, we included other examples of biological interpretations (new Figs. 4, 5, Table 2 and accompanying description in the results section). In addition, in order to improve accessibility, we reduced the contents of Fig. 3 (by only showing results for one distance measure) and clearly indicated which SBM hierarchy level the examined blocks stem from. </italic>
        </underline>
      </p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report47226" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.20484.r47226</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Lei</given-names>
        </name>
        <xref ref-type="aff" rid="r47226a1">1</xref>
        <role>Referee</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Qiu</surname>
          <given-names>Yue</given-names>
        </name>
        <xref ref-type="aff" rid="r47226a2">2</xref>
        <role>Co-referee</role>
      </contrib>
      <aff id="r47226a1"><label>1</label>Department of Computer Science, Hunter College, The City University of New York, New York, NY, USA</aff>
      <aff id="r47226a2"><label>2</label>City University of New York, New York, NY, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <permissions>
      <copyright-statement>Copyright: © 2019 Xie L and Qiu Y</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access peer review report distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <related-article related-article-type="peer-reviewed-article" id="d35e7537" ext-link-type="doi" xlink:href="10.12688/f1000research.18705.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The paper by Baum et al describes a method to construct biological networks from omics data using stochastic block models (SBMs). The application of SBM on mRNA, protein and metabolic data gives a new way of deriving information from correlation based biological networks. The proposed method could be a useful addition to network biology. To strengthen the manuscript, I would suggest the following points to be addressed:
<list list-type="order"><list-item><p>In the over representation analysis, while the statistics on distance of Reactome/KEGG terms shows the block generated here is significantly better than random. Is it possible to provide a such comparison between the clustering result by SBM and WGCNA?</p></list-item><list-item><p>In the network reduction step, a linear relationship is expected between log-frequency and log-node-degree. While the scale-free fit index (R
<sup>2</sup>) will be &gt; 0.85 with WGCNA default requirement, how different threshold affect that linearity is not clear from Fig 1D. Also, how well can the network be reduced by significance of correlation fit to a scale free network?</p></list-item><list-item><p>To demonstrate that SBM can provide biological insight, more detailed analysis on the benchmark data sets could be useful. For example, what are unique and common pathways for different breast cancer subtypes, how well are these findings consistent with existing knowledge?</p></list-item><list-item><p>Figure 4 shows SBM based confidence score can be used to predict the existence of an edge. However, it is not clearly stated how the edges are determined as putatively missing or spurious. Also, the description for figure 4A is hard to understand. </p></list-item></list>
</p>
    <p>We confirm that we have read this submission and believe that we have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however we have significant reservations, as outlined above.</p>
  </body>
  <sub-article id="comment4831" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Baum</surname>
            <given-names>Katharina</given-names>
          </name>
          <aff>Max Delbrück Center for Molecular Medicine in the Helmholtz Association, Germany</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>12</day>
        <month>8</month>
        <year>2019</year>
      </pub-date>
    </front-stub>
    <body>
      <p>We thank Prof. Lei Xie and Yue Qiu for their comments that helped improving the accessibility of the presented contents and strengthened the manuscript. In the following, we answer to the specific points they raised and how we addressed them in version 2.</p>
      <p> &gt;The paper by Baum et al describes a method to construct biological networks from omics data using stochastic block models (SBMs). The application of SBM on mRNA, protein and metabolic data gives a new way of deriving information from correlation based biological networks. The proposed method could be a useful addition to network biology. To strengthen the manuscript, I would suggest the following points to be addressed:  </p>
      <p> &gt;In the over representation analysis, while the statistics on distance of Reactome/KEGG terms shows the block generated here is significantly better than random. Is it possible to provide a such comparison between the clustering result by SBM and WGCNA?</p>
      <p>
        <underline>
          <italic toggle="yes">Response: </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We thank the reviewers for their appreciation of our work.</italic>
          <italic toggle="yes">We now also provide the computation of the SBM distances for the mRNA and protein WGCNA clustering results (see new Fig. 3F and new Fig. S3C). They show also a bigger distance between clusters than within clusters. We added the resulting p-values to the comparison of the distances for both SBM (Fig. 3B, D) and WGCNA (Fig. 3F, S3C) approach.</italic>
        </underline>
      </p>
      <p> &gt;In the network reduction step, a linear relationship is expected between log-frequency and log-node-degree. While the scale-free fit index (R2) will be &gt; 0.85 with WGCNA default requirement, how different threshold affect that linearity is not clear from Fig 1D. Also, how well can the network be reduced by significance of correlation fit to a scale free network?</p>
      <p>
        <underline>
          <italic toggle="yes">Response: </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">Fig. 1D (now 1E) has been included for illustrative purposes only to show some further characteristics (in this case: degree distribution) apart from those in Table 1 of the six networks employed for the SBM-based analysis. It can be used to appreciate the fact that the networks reduced by requirement on significance of correlation are not optimized for it but still may exhibit a close to linear relationship between log-frequency and log-node-degree. For clarification, we added the scale-free fit indices obtained for each network into old Fig. 1D - now Fig. 1E. </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We also extended the description of the scale-freeness fitting procedure and approach by using the WGCNA package (see revised Methods section). Please note that less strict correlation thresholds than the employed here lead to networks being further away from a network with scale-free characteristic (this is inherent to the WCGNA fitting approach as the least stringent threshold is determined leading to a scale-free fit index of at least 0.85) and more stringent correlation thresholds can lead to networks being closer to a scale-free network (i.e. to higher values of R
<sup>2</sup>). We give now these dependencies for the three networks in new Fig. 1D. </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">Please note that reducing by a threshold on significance of correlation is a different reduction method and it is neither expected nor intended that the resulting networks are scale-free. In order to illustrate the relationship between the two reduction methods, we introduced new illustrations in supplemental figure S1. Therein, </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">- we show in new panel S1A that for the metabolite and mRNA layer, due to the datasets not having NA values and thus the sample size being the same for each and every pair of metabolite or mRNA species, the p-values of the correlation being different from zero depend monotonously on the absolute correlation values. This is not the case for the protein dataset for which different sample sizes may occur. Therefore, the correlation value for some interactions will be backed by fewer data points only which leads to increased p-value despite the same correlation value.</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">- we show in new S1B that, for the mRNA and metabolite data layer, the scale-free fit index for networks reduced by different significance thresholds can be directly compared to those from Fig. 1D.</italic>
        </underline>
      </p>
      <p>
        <italic>
          <underline>- we show in new S1C how the significance threshold of correlation being different from zero relates to the scale-free score for the protein dataset and where the four networks reduced by the four considered significance thresholds locate therein.</underline>
        </italic>
      </p>
      <p> &gt;To demonstrate that SBM can provide biological insight, more detailed analysis on the benchmark data sets could be useful. For example, what are unique and common pathways for different breast cancer subtypes, how well are these findings consistent with existing knowledge?</p>
      <p>
        <underline>
          <italic toggle="yes">Response:</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We agree that a comparison of results between breast cancer subgroups to provide biological insights into the utility of the clustering would be useful. However, our work focusses on determining whether SBMs are suitable to represent biomolecular networks as they have not been explored for molecular network analysis.</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We indeed expect additional and complementary biological findings to what is already known with the SBM approach. To strengthen our work, we also added some showcase examples of biological interpretation (new Figs. 4, 5, Table 2 and Description in the text). They show that the SBM-derived clustering can detect biological pathways known to be implicated in breast cancer according to oncogenic signatures from MSigDB, such as extracellular matrix organization or the cell cycle (see new Fig. 4), or fatty acid biosynthesis (Table 2). In addition, the relevance of further processes can be predicted, e.g. the chromatin organization (new Fig. 5).</italic>
        </underline>
      </p>
      <p> &gt;Figure 4 shows SBM based confidence score can be used to predict the existence of an edge. However, it is not clearly stated how the edges are determined as putatively missing or spurious. Also, the description for figure 4A is hard to understand. </p>
      <p>
        <underline>
          <italic toggle="yes">Response:</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We extended the description of the edge detection by adding the following sentences in the section ‘Assessing edge relevance by SBM-based edge confidence scores’:</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">‘For the six reduced networks, all edges that exist in the network were considered as ‘putatively spurious’. Similarly, all edges that were not in the network because they had been removed from the (fully connected) correlation-based network during the reduction procedure were considered as ‘putatively missing’.’ </italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">We clarified the legend to new Fig. 6A (old Fig. 4A) that now reads:</italic>
        </underline>
      </p>
      <p>
        <underline>
          <italic toggle="yes">‘(A) Histograms of edge confidence scores for the best fitting SBM of the three networks reduced by criterion on scale-freeness. Top: spurious edge confidence scores, computed for all edges existing in the network; middle and bottom: missing edge confidence scores, computed for all edges that were removed during the reduction procedure (middle: missing edges between nodes with degree&gt;0 in the reduced network, bottom: missing edges adjacent to a node of degree zero in the reduced network).’</italic>
        </underline>
      </p>
    </body>
  </sub-article>
</sub-article>
