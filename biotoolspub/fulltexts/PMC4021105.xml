<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4021105</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-15-100</article-id>
    <article-id pub-id-type="pmid">24717095</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-15-100</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Adaptable probabilistic mapping of short reads using position specific scoring matrices</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes" id="A1">
        <name>
          <surname>Kerpedjiev</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>psk@binf.ku.dk</email>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes" id="A2">
        <name>
          <surname>Frellsen</surname>
          <given-names>Jes</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>frellsen@binf.ku.dk</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Lindgreen</surname>
          <given-names>Stinus</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>stinus@binf.ku.dk</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A4">
        <name>
          <surname>Krogh</surname>
          <given-names>Anders</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I5">5</xref>
        <email>krogh@binf.ku.dk</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Section for Computational and RNA Biology, Department of Biology, University of Copenhagen, Ole Maaloes Vej 5, 2200 Copenhagen, Denmark</aff>
    <aff id="I2"><label>2</label>Institute for Theoretical Chemistry, University of Vienna, Währinger Straße 17, A-1090 Vienna, Austria</aff>
    <aff id="I3"><label>3</label>Department of Engineering, University of Cambridge, Trumpington Street, Cambridge CB2 1PZ, UK</aff>
    <aff id="I4"><label>4</label>Biomolecular Interaction Centre, School of Biological Sciences, University of Canterbury, Private Bag 4800, Christchurch 8020, New Zealand</aff>
    <aff id="I5"><label>5</label>Centre for GeoGenetics, Natural History Museum of Denmark, University of Copenhagen, Øster Voldgade 5-7, 1350 Copenhagen K, Denmark</aff>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>4</month>
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <fpage>100</fpage>
    <lpage>100</lpage>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>3</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>3</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2014 Kerpedjiev et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Kerpedjiev et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License(
<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (
<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/15/100"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Modern DNA sequencing methods produce vast amounts of data that often requires mapping to a reference genome. Most existing programs use the number of mismatches between the read and the genome as a measure of quality. This approach is without a statistical foundation and can for some data types result in many wrongly mapped reads. Here we present a probabilistic mapping method based on position-specific scoring matrices, which can take into account not only the quality scores of the reads but also user-specified models of evolution and data-specific biases.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We show how evolution, data-specific biases, and sequencing errors are naturally dealt with probabilistically. Our method achieves better results than Bowtie and BWA on simulated and real ancient and PAR-CLIP reads, as well as on simulated reads from the AT rich organism <italic>P. falciparum</italic>, when modeling the biases of these data. For simulated Illumina reads, the method has consistently higher sensitivity for both single-end and paired-end data. We also show that our probabilistic approach can limit the problem of random matches from short reads of contamination and that it improves the mapping of real reads from one organism (<italic>D. melanogaster</italic>) to a related genome (<italic>D. simulans</italic>).</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The presented work is an implementation of a novel approach to short read mapping where quality scores, prior mismatch probabilities and mapping qualities are handled in a statistically sound manner. The resulting implementation provides not only a tool for biologists working with low quality and/or biased sequencing data but also a demonstration of the feasibility of using a probability based alignment method on real and simulated data sets.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Short-read mapping</kwd>
      <kwd>Sequence alignment</kwd>
      <kwd>Next-generation sequencing</kwd>
      <kwd>Ancient DNA</kwd>
      <kwd>PAR-CLIP</kwd>
      <kwd>Xeno mapping</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Next-generation DNA sequencing is a powerful tool in biological research
[<xref ref-type="bibr" rid="B1">1</xref>] and is steadily gaining momentum as costs keep decreasing. Applications vary from genome re-sequencing
[<xref ref-type="bibr" rid="B2">2</xref>-<xref ref-type="bibr" rid="B4">4</xref>] to transcriptome analysis
[<xref ref-type="bibr" rid="B5">5</xref>-<xref ref-type="bibr" rid="B7">7</xref>], metagenomics projects
[<xref ref-type="bibr" rid="B8">8</xref>-<xref ref-type="bibr" rid="B10">10</xref>], and sequencing of ancient genomes
[<xref ref-type="bibr" rid="B11">11</xref>-<xref ref-type="bibr" rid="B16">16</xref>]. All these applications rely on mapping reads to existing reference genomes. Many mapping programs have been developed using a variety of algorithms with different strengths, weaknesses and limitations
[<xref ref-type="bibr" rid="B17">17</xref>].</p>
    <p>Hash-based algorithms such as MAQ
[<xref ref-type="bibr" rid="B18">18</xref>] and SOAP
[<xref ref-type="bibr" rid="B19">19</xref>] dominated initially but were hampered by large memory demands. Subsequently, the Burrows-Wheeler transform
[<xref ref-type="bibr" rid="B20">20</xref>] was applied to compress the genome index in programs such as Bowtie
[<xref ref-type="bibr" rid="B21">21</xref>], Bowtie2
[<xref ref-type="bibr" rid="B22">22</xref>], SOAP2
[<xref ref-type="bibr" rid="B23">23</xref>], and BWA
[<xref ref-type="bibr" rid="B24">24</xref>]. This decreased the memory usage while increasing speed and sensitivity, leading to mappers based on the Burrows-Wheeler transform to now dominate the field. Other approaches, however, show promising results for some types of data. Segemehl
[<xref ref-type="bibr" rid="B25">25</xref>] uses an enhanced-suffix array to provide fast alignment of insertion/deletion (indel) prone reads, and a similar approach was implemented in the mapping tool used in the sequencing of the first ancient human genome
[<xref ref-type="bibr" rid="B13">13</xref>]. Programs such as CUSHAW
[<xref ref-type="bibr" rid="B26">26</xref>] and SOAP3
[<xref ref-type="bibr" rid="B27">27</xref>] have begun to use graphics processing units (GPUs) to provide even faster mapping.</p>
    <p>Most programs allow a specified number of mismatches in an alignment (with a limit of 1-3 mismatches in the beginning of the read), and report uniquely mapped reads as those where all other locations have more mismatches. However, evaluating a mapping location by the number of nucleotide mismatches alone is not optimal and implicitly assumes that the genome has a homogeneous base composition and that errors occur uniformly in the reads. The mapping with the lowest number of mismatches may have a high probability of being incorrect if i) there are many sub-optimal mappings, ii) the genome has a very biased base composition, iii) certain nucleotide mismatches are expected due to sample conditions, or iv) the mismatching bases have low error-probabilities compared to other bases.</p>
    <p>Most sequencing platforms provide a quality score for each base derived from the probability that the nucleotide is wrongly assigned in the base-calling. With the Illumina platform, the error probabilities typically range from around 0.01% in the 5’ end of the read to several percent in the 3’ end, but the actual DNA sequence can affect the read quality
[<xref ref-type="bibr" rid="B28">28</xref>]. These qualities can affect not only the ability of a mapper to find the correct hit, but also the quality of the reported hit. While the latest generation of mappers such as MASAI
[<xref ref-type="bibr" rid="B29">29</xref>] and GEM
[<xref ref-type="bibr" rid="B30">30</xref>] either do not take quality scores into account or only consider them in a rudimentary manner, they also report all possible alignments and do not provide a mapping quality to distinguish between a high confidence alignment and a low confidence one. We demonstrate that taking quality scores and other information about the biases in the experimental data into account can improve the sensitivity while providing an accurate mapping quality estimation. Recently, the use of position-specific scoring matrices (PSSMs) has been applied to the short read mapping problem and shown to provide accurate SNP and indel calling
[<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B31">31</xref>].</p>
    <p>Here we show how quality scores, contamination, biases in base composition, mutations, and data-specific base-changes (as in PAR-CLIP or ancient DNA) can all be dealt with probabilistically and encoded in a PSSM. We also present an algorithm which applies the Burrows-Wheeler transform to the scoring of PSSMs, and BWA-PSSM, a fast and sensitive mapping tool which implements the methods.</p>
    <p>We show that the use of probabilistic scoring allows for both higher sensitivity and positive predictive value when mapping simulated reads. More importantly, we offer the ability to use a specified error model to map reads based on the expected types and locations of mismatches. This improves the mapping of ancient DNA data with errors due to damage, and the improvement is even more pronounced when mapping PAR-CLIP data, where there is a strong bias towards T-to-C substitutions
[<xref ref-type="bibr" rid="B32">32</xref>], as well as data from <italic>P. falciparum</italic> which has an extreme nucleotide bias with more than 80% AT content
[<xref ref-type="bibr" rid="B33">33</xref>]. We also show that the probabilistic scoring can help in cases of contamination by dramatically reducing the mapping of short reads from <italic>E. coli</italic> to the human genome.</p>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <p>When mapping reads, one is interested in the probability that the read originated from a specific location in the genome. The read and the genome might not be completely identical due to e.g. sequencing errors or SNPs.</p>
    <sec>
      <title>A position-specific scoring matrix from quality scores</title>
      <p>Most sequencing machines provide a quality score for each base which is related to the probability of a sequencing error occurring at this position in the read. These qualities are normally in the Phred format
[<xref ref-type="bibr" rid="B34">34</xref>] and relate the error probability <italic>p</italic><sub>e</sub> and the quality score <italic>Q</italic> by <italic>p</italic><sub>e</sub> = 10<sup>-<italic>Q</italic>/10</sup>. From these qualities, we can calculate the probability <italic>P</italic>(<italic>a</italic>|<italic>x</italic>) for the base <italic>a</italic> ∈ {A,C,G,T} being present at a given position in the DNA fragment given that the base <italic>x</italic> ∈ {A,C,G,T} was called by the sequencing machine (see Methods).</p>
      <p>If the DNA being sequenced differs from the reference genome, e.g. due to evolution, there is a probability <italic>P</italic>(<italic>g</italic>|<italic>a</italic>) that base <italic>g</italic> occurs in the genome if the base is <italic>a</italic> in the sample. We use a simple model with a probability <italic>p</italic><sub>0</sub> for a mutation (see Methods).</p>
      <p>Combining this with the probability of errors, the probability of a base <italic>g</italic> in the genome given the called base <italic>x</italic> is</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math id="M1" name="1471-2105-15-100-i1" overflow="scroll">
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>g</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:munder>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
            </mml:munder>
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>g</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>a</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>a</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>In some types of data, known base modifications are known to occur. For instance, in ancient DNA some bases are damaged due to hydrolysis, resulting in cytosine to thymine (C-to-T) conversions in the 5’ ends of reads, which can look like apparent guanine to adenine (G-to-A) substitutions in the 3’ end, and in PAR-CLIP experiments there is a large fraction of thymine to cytosine (T-to-C) conversions where the protein crosslinks to the RNA. These phenomena are easily modeled and included in the PSSM, essentially by introducing a probability <italic>P</italic>(<italic>b</italic>|<italic>a</italic>) that the observed base is <italic>b</italic>, given that the base is <italic>a</italic> in the sample (see Methods section).</p>
      <p>Using this approach, one can turn a short read into a PSSM and use it for mapping the read to the genome. The PSSM is constructed such that at position <italic>i</italic> in the read, the score for base <italic>g</italic> is <italic>s</italic>(<italic>g</italic>|<italic>x</italic><sub><italic>i</italic></sub>) = log<sub>2</sub>(<italic>P</italic>(<italic>g</italic>|<italic>x</italic><sub><italic>i</italic></sub>)/<italic>q</italic>(<italic>g</italic>)), where <italic>P</italic>(<italic>g</italic>|<italic>x</italic><sub><italic>i</italic></sub>) is the probability of a genomic base <italic>g</italic> given the <italic>i</italic>’th base <italic>x</italic><sub><italic>i</italic></sub> in the read calculated as described above in equation 1, and <italic>q</italic>(<italic>g</italic>) is a background probability, which is usually just the frequency of the base in the genome. The score for matching a read <bold>x</bold> to a certain position <italic>ℓ</italic> in the genome is <italic>S</italic><sub><bold>x</bold></sub>(<italic>ℓ</italic>), and is obtained by summing the scores from the PSSM corresponding to the genome sequence starting at position <italic>l</italic>.</p>
      <p>BWA-PSSM is very flexible when it comes to how you feed the PSSM to the program. In the present implementation, the PSSM can be constructed from the quality scores supplied with the sequence, using a background distribution calculated from the frequencies of bases in the reference genome and a mutation rate (<italic>p</italic><sub>0</sub> above). Alternatively, the user can supply a table with a direct translation of base and quality score pairs to PSSM scores. Such a table can be computed ahead of time to include for instance a more sophisticated evolutionary model or a PAR-CLIP model. Finally the user can input a fully constructed PSSM and use it for mapping.</p>
    </sec>
    <sec>
      <title>Mapping probability</title>
      <p>The advantage of the PSSM is that the probability of a match can be calculated directly
[<xref ref-type="bibr" rid="B17">17</xref>]. There is a probability that a read <bold>x</bold> originates from – or is homologous to – a position <italic>ℓ</italic> in a genome <bold>g</bold>, <italic>P</italic>(<italic>ℓ</italic>,M|<bold>x</bold>,<bold>g</bold>), where M means the "match model". Alternatively, the background model N is used if the read does not originate from the genome due to e.g. contamination or adapter sequences. <italic>A priori</italic>, we may be able to estimate the probability <italic>P</italic>(N|<bold>x</bold>) of a read being contamination, and obviously <italic>P</italic>(M|<bold>x</bold>) = 1 - <italic>P</italic>(N|<bold>x</bold>).</p>
      <p>Using the sum and product rule we can express the match probability at position <italic>ℓ</italic> as</p>
      <p>
        <disp-formula>
          <mml:math id="M2" name="1471-2105-15-100-i2" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>ℓ</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi mathvariant="normal">M</mml:mi>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mi mathvariant="bold">x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi mathvariant="bold">g</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold">g</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi>ℓ</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="normal">M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>ℓ</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="normal">M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="normal">M</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold">g</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="normal">M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="normal">M</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold">g</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="normal">N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="normal">N</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Assuming that any mapping position is equally likely <italic>a priori</italic> we have <italic>P</italic>(<italic>ℓ</italic>|M,<bold>x</bold>) = 1/<italic>L</italic>, where <italic>L</italic> is the length of the genome.</p>
      <p>In the background model N we assume independently identically distributed (i.i.d.) bases.</p>
      <p>In the match model M, the probability of the aligned bases in <bold>g</bold> is calculated from the PSSM and the remaining bases are assumed to be distributed as in the background model; this means that</p>
      <p><inline-formula><mml:math id="M3" name="1471-2105-15-100-i3" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">g</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">g</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, where <italic>S</italic><sub><bold>x</bold></sub>(<italic>ℓ</italic>) is the PSSM score. It is possible, of course, to have more sophisticated background models of those sequences that do not originate from the genome, such as a Markov model, but this will not be considered here.</p>
      <p>Using the identity
<inline-formula><mml:math id="M4" name="1471-2105-15-100-i4" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">g</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">g</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, where <italic>ℓ</italic><sup>′</sup> runs over all positions in the genome, we can finally write the posterior probability of the read <bold>x</bold> mapping to position <italic>ℓ</italic> in the genome as</p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <mml:math id="M5" name="1471-2105-15-100-i5" overflow="scroll">
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>ℓ</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mi mathvariant="normal">M</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi mathvariant="bold">x</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mi mathvariant="bold">g</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>S</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="bold">x</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>ℓ</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo>∑</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>ℓ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:msub>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>S</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="bold">x</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>ℓ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>+</mml:mo>
                <mml:mi>L</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>-</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi mathvariant="normal">M</mml:mi>
                <mml:mo stretchy="false">|</mml:mo>
                <mml:mi mathvariant="bold">x</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo stretchy="false">/</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi mathvariant="normal">M</mml:mi>
                <mml:mo stretchy="false">|</mml:mo>
                <mml:mi mathvariant="bold">x</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:mfrac>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>The first term in the denominator is the sum over all possible genomic positions. This is impractical to calculate, but since only positions with some similarity to the query yield a significant contribution, it is well approximated by a sum over high-scoring mappings. The second term in the denominator is proportional to the genome size and reflects the fact that the larger the genome, the more likely it is to have a random hit.</p>
      <p>In the BWA-PSSM implementation we assume the same prior match probability for all reads, <italic>P</italic>(M) = <italic>P</italic>(M|<bold>x</bold>), which can be specified as a parameter with a default value of 0.8 which is used for all experiments in this paper. To simplify the presentation we assumed no indels in the alignment of the read and the genome, see Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref> for the derivation of equation (2) and Methods for details on handling indels.</p>
    </sec>
    <sec>
      <title>Algorithm and implementation</title>
      <p>PSSM search is implemented in the BWA program
[<xref ref-type="bibr" rid="B24">24</xref>] as a separate version called BWA-PSSM, which can be used instead of the regular BWA alignment step (<monospace>aln</monospace>). Here we describe the main algorithmic changes as compared to standard BWA.</p>
      <p>Using a PSSM, a score can be calculated for each position in the reference genome, where high scores indicate hits. Using a Burrows-Wheeler transformed index, this operation can be sped up by evaluating scores on the prefix tree of the index. At any given point in the search, the position within the scoring matrix corresponds to the current depth of the prefix tree. Scores are calculated by summing the position-specific score at each node along a path.</p>
      <p>To bound the number of positions in the genome that must be evaluated, a threshold score is used which replaces the maximum number of mismatches used in standard BWA. To calculate an overall score threshold for a read, we rely on converting a limit on the number of mismatches <italic>n</italic> into the minimum possible score with <italic>n</italic> mismatches. That is, we allow <italic>n</italic> mismatches of bases with high quality and more than <italic>n</italic> mismatches of low-quality bases.</p>
      <p>To further prune the search space, lookahead scoring can be used, in which the threshold is calculated for each position in the PSSM as the difference between the threshold and the best possible score of the remaining PSSM
[<xref ref-type="bibr" rid="B35">35</xref>]. This is implemented in BWA-PSSM (Algorithm 1), but using an improved bound. This is done by adapting the method (named <sc>CALCULATED</sc>) employed by BWA to consider what the minimum number of mismatches must be for that subsequence to align to some region of the genome. Our algorithm, called <sc>CALCULATET</sc> (Algorithm 2), instead calculates the difference between the best possible PSSM score with no mismatches and the best possible score with the minimum number of necessary mismatches. This difference is calculated at each position and added to the lookahead-derived intermediate thresholds. This has the effect of requiring a higher match score at each position and thus further bounding the search tree. This allows for faster and more accurate mapping of sequences with many low quality bases as more likely paths (and thus matches) will tend to be visited first.</p>
      <p><bold>Algorithm 1 The recursive BWA-PSSM search algorithm.</bold> The PSSM is denoted <italic>A</italic> and the PSSM thresholds at each position<italic>i</italic> are stored in <italic>T</italic>[<italic>i</italic>]. A score, <italic>s</italic>, is maintained for every partial match and the indices into the Burrows-Wheeler transformed sequence are stored in <italic>k</italic> and <italic>l</italic>. In the algorithm <italic>O</italic>(<italic>b</italic>,<italic>l</italic>) denotes the number of occurrences of the base <italic>b</italic> in the <italic>l</italic>’th prefix of the Burrows-Wheeler transformed reference sequence, and <italic>C</italic>(<italic>b</italic>) is the number of occurrences of bases that are lexicographically smaller than <italic>b</italic> in the reference sequence. Insertions and deletions are assigned penalties <italic>ρ</italic><sub><bold>i</bold></sub> and <italic>ρ</italic><sub><bold>d</bold></sub>, respectively. The algorithm is initiated with the values PSSMSEARCH(<italic>A</italic>,<italic>T</italic>,|<bold>x</bold>|-1,0,|<bold>g</bold>|-1), where<italic>T</italic> is calculated from the sequence <bold>x</bold> using the algorithm <sc>CALCULATET</sc> and |<bold>g</bold>| denotes the size of the reference sequence.<disp-formula><graphic xlink:href="1471-2105-15-100-i6.gif"/></disp-formula></p>
      <p><bold>Algorithm 2 Calculation of intermediate thresholds.</bold> The algorithm calculates intermediate thresholds for PSSM <italic>A</italic>, read sequence <bold>x</bold>, genomic reference sequence <bold>g</bold> given the global threshold <italic>t</italic>. <bold>x</bold><sub><bold><italic>j</italic></bold><bold>:</bold><bold><italic>i</italic></bold></sub> is the subsequence from <italic>j</italic> to <italic>i</italic> of the read, and <italic>t</italic> stores the difference between the best and second best PSSM score that can be obtained for the subsequence. The MINDROP(<italic>A</italic>,<italic>i</italic>,<italic>j</italic>) function simply calculates the minimum of the differences between the highest and lowest scores for columns <italic>i</italic> to <italic>j</italic> in the PSSM, while the function SUMMAX(<italic>A</italic>,0,<italic>i</italic> - 1) calculates the sum of the maximal values in column 0 to column <italic>i</italic> - 1 in the PSSM.<disp-formula><graphic xlink:href="1471-2105-15-100-i7.gif"/></disp-formula></p>
      <p>While BWA uses the MAQ mapping quality score (MapQ), BWA-PSSM reports the posterior probability given in equation (2), but estimating the sum in the denominator from the matches above the threshold. In keeping with the MAQ tradition, this probability is also log scaled, rounded to an integer and reported as the MapQ score in the output, that is
<inline-formula><mml:math id="M6" name="1471-2105-15-100-i8" overflow="scroll"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>⌊</mml:mo><mml:mo>-</mml:mo><mml:mn>10</mml:mn><mml:msub><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>⌋</mml:mo></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>Comparing methods on simulated reads</title>
      <p>The performance of BWA-PSSM was compared to BWA
[<xref ref-type="bibr" rid="B24">24</xref>], BWA-MEM
[<xref ref-type="bibr" rid="B36">36</xref>], Bowtie
[<xref ref-type="bibr" rid="B21">21</xref>], Bowtie2
[<xref ref-type="bibr" rid="B22">22</xref>] and GEM
[<xref ref-type="bibr" rid="B30">30</xref>] on a number of simulated datasets modelling different types of short reads. The results are summarized in Tables
<xref ref-type="table" rid="T1">1</xref>,
<xref ref-type="table" rid="T2">2</xref> and
<xref ref-type="table" rid="T3">3</xref> and Figures
<xref ref-type="fig" rid="F1">1</xref> and
<xref ref-type="fig" rid="F2">2</xref>, and details are given below. Each program, except Bowtie, reports a mapping quality (MapQ), and the mapping performance clearly depends on which threshold is used for this. We report the unfiltered results, for which we use no MapQ threshold, and the filtered results, for which all matches with a MapQ of less than 25 are discarded. The sensitivity reported is the number of correctly mapped reads divided by the total number of reads. The PPV (Positive Predictive Value) is the number of correctly mapped reads divided by the number of reported matches. The elapsed user time is reported when running each program on an Intel(R) Xeon(R) E7450 2.40GHz CPU.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Analysis of single-end data simulated with ART</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left" valign="bottom"> <hr/></th>
              <th align="left" valign="bottom"> <hr/></th>
              <th colspan="2" align="center" valign="bottom">
                <bold>Unfiltered</bold>
                <hr/>
              </th>
              <th colspan="2" align="center" valign="bottom">
                <bold>MapQ filtered</bold>
                <hr/>
              </th>
              <th align="left" valign="bottom"> <hr/></th>
            </tr>
            <tr>
              <th align="left"> </th>
              <th align="left">
                <bold>Mapper</bold>
              </th>
              <th align="center">
                <bold>Sensitivity</bold>
              </th>
              <th align="center">
                <bold>PPV</bold>
              </th>
              <th align="center">
                <bold>Sensitivity</bold>
              </th>
              <th align="center">
                <bold>PPV</bold>
              </th>
              <th align="center">
                <bold>Time (s)</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>a) ART single-end length 36</bold><hr/></td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.811<hr/></td>
              <td align="center" valign="bottom">0.899<hr/></td>
              <td align="center" valign="bottom">0.776<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">44.19<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.804<hr/></td>
              <td align="center" valign="bottom">0.896<hr/></td>
              <td align="center" valign="bottom">0.735<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">47.41<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.772<hr/></td>
              <td align="center" valign="bottom">0.900<hr/></td>
              <td align="center" valign="bottom">0.663<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">146.99<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie<hr/></td>
              <td align="center" valign="bottom">0.812<hr/></td>
              <td align="center" valign="bottom">0.900<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">9.75<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.802<hr/></td>
              <td align="center" valign="bottom">0.898<hr/></td>
              <td align="center" valign="bottom">0.757<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">28.67<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">GEM<hr/></td>
              <td align="center" valign="bottom">0.755<hr/></td>
              <td align="center" valign="bottom">0.995<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">34.57<hr/></td>
            </tr>
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>b) ART single-end length 50</bold><hr/></td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.839<hr/></td>
              <td align="center" valign="bottom">0.934<hr/></td>
              <td align="center" valign="bottom">0.797<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">96.07<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.805<hr/></td>
              <td align="center" valign="bottom">0.929<hr/></td>
              <td align="center" valign="bottom">0.753<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">84.65<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.816<hr/></td>
              <td align="center" valign="bottom">0.921<hr/></td>
              <td align="center" valign="bottom">0.719<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">56.64<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie<hr/></td>
              <td align="center" valign="bottom">0.840<hr/></td>
              <td align="center" valign="bottom">0.931<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">15.74<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.802<hr/></td>
              <td align="center" valign="bottom">0.918<hr/></td>
              <td align="center" valign="bottom">0.717<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">48.58<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">GEM<hr/></td>
              <td align="center" valign="bottom">0.705<hr/></td>
              <td align="center" valign="bottom">0.995<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">35.45<hr/></td>
            </tr>
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>c) ART single-end length 76</bold><hr/></td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.807<hr/></td>
              <td align="center" valign="bottom">0.967<hr/></td>
              <td align="center" valign="bottom">0.795<hr/></td>
              <td align="center" valign="bottom">0.998<hr/></td>
              <td align="center" valign="bottom">94.35<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.573<hr/></td>
              <td align="center" valign="bottom">0.961<hr/></td>
              <td align="center" valign="bottom">0.554<hr/></td>
              <td align="center" valign="bottom">0.998<hr/></td>
              <td align="center" valign="bottom">168.42<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.821<hr/></td>
              <td align="center" valign="bottom">0.937<hr/></td>
              <td align="center" valign="bottom">0.751<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">65.21<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie<hr/></td>
              <td align="center" valign="bottom">0.822<hr/></td>
              <td align="center" valign="bottom">0.962<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">25.01<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.778<hr/></td>
              <td align="center" valign="bottom">0.928<hr/></td>
              <td align="center" valign="bottom">0.675<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">81.86<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">GEM<hr/></td>
              <td align="center" valign="bottom">0.695<hr/></td>
              <td align="center" valign="bottom">0.995<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">32.20<hr/></td>
            </tr>
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>d) ART single-end length 100</bold><hr/></td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.837<hr/></td>
              <td align="center" valign="bottom">0.979<hr/></td>
              <td align="center" valign="bottom">0.828<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">128.25<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.308<hr/></td>
              <td align="center" valign="bottom">0.973<hr/></td>
              <td align="center" valign="bottom">0.302<hr/></td>
              <td align="center" valign="bottom">0.998<hr/></td>
              <td align="center" valign="bottom">262.54<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.863<hr/></td>
              <td align="center" valign="bottom">0.951<hr/></td>
              <td align="center" valign="bottom">0.807<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">91.12<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie<hr/></td>
              <td align="center" valign="bottom">0.855<hr/></td>
              <td align="center" valign="bottom">0.976<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">28.33<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.811<hr/></td>
              <td align="center" valign="bottom">0.944<hr/></td>
              <td align="center" valign="bottom">0.668<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">100.49<hr/></td>
            </tr>
            <tr>
              <td align="left"> </td>
              <td align="left">GEM</td>
              <td align="center">0.716</td>
              <td align="center">0.996</td>
              <td align="center">*</td>
              <td align="center">*</td>
              <td align="center">35.77</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Comparison of sensitivity, positive predictive value (PPV) and run time using BWA-PSSM, BWA, BWA-MEM, Bowtie, Bowtie2 and GEM on simulated data sets covering a random 1% of the human genome. The reads were simulated using the ART_illumina
[<xref ref-type="bibr" rid="B37">37</xref>] program with the default error profile for the given read length. The symbol ’*’ indicates that the mapper does not provide MapQ scores.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Analysis of paired-end data simulated with ART</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left" valign="bottom"> <hr/></th>
              <th align="left" valign="bottom"> <hr/></th>
              <th colspan="2" align="center" valign="bottom">
                <bold>Unfiltered</bold>
                <hr/>
              </th>
              <th colspan="2" align="center" valign="bottom">
                <bold>MapQ filtered</bold>
                <hr/>
              </th>
              <th align="left" valign="bottom"> <hr/></th>
            </tr>
            <tr>
              <th align="left"> </th>
              <th align="left">
                <bold>Mapper</bold>
              </th>
              <th align="center">
                <bold>Sensitivity</bold>
              </th>
              <th align="center">
                <bold>PPV</bold>
              </th>
              <th align="center">
                <bold>Sensitivity</bold>
              </th>
              <th align="center">
                <bold>PPV</bold>
              </th>
              <th align="center">
                <bold>Time (s)</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>a) ART paired-end length 36</bold><hr/></td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.974<hr/></td>
              <td align="center" valign="bottom">0.974<hr/></td>
              <td align="center" valign="bottom">0.935<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">211.18<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.973<hr/></td>
              <td align="center" valign="bottom">0.973<hr/></td>
              <td align="center" valign="bottom">0.911<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">238.95<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.899<hr/></td>
              <td align="center" valign="bottom">0.899<hr/></td>
              <td align="center" valign="bottom">0.753<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">404.35<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie<hr/></td>
              <td align="center" valign="bottom">0.483<hr/></td>
              <td align="center" valign="bottom">0.927<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">1578.74<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.971<hr/></td>
              <td align="center" valign="bottom">0.971<hr/></td>
              <td align="center" valign="bottom">0.929<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">137.88<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">GEM<hr/></td>
              <td align="center" valign="bottom">0.976<hr/></td>
              <td align="center" valign="bottom">0.071<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">91.46<hr/></td>
            </tr>
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>b) ART paired-end length 50</bold><hr/></td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.965<hr/></td>
              <td align="center" valign="bottom">0.967<hr/></td>
              <td align="center" valign="bottom">0.928<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">242.98<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.911<hr/></td>
              <td align="center" valign="bottom">0.943<hr/></td>
              <td align="center" valign="bottom">0.785<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">261.53<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.902<hr/></td>
              <td align="center" valign="bottom">0.908<hr/></td>
              <td align="center" valign="bottom">0.655<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">118.35<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie<hr/></td>
              <td align="center" valign="bottom">0.433<hr/></td>
              <td align="center" valign="bottom">0.951<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">656.37<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.939<hr/></td>
              <td align="center" valign="bottom">0.952<hr/></td>
              <td align="center" valign="bottom">0.736<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">109.78<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">GEM<hr/></td>
              <td align="center" valign="bottom">0.927<hr/></td>
              <td align="center" valign="bottom">0.399<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">48.79<hr/></td>
            </tr>
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>c) ART paired-end length 76</bold><hr/></td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.958<hr/></td>
              <td align="center" valign="bottom">0.978<hr/></td>
              <td align="center" valign="bottom">0.943<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">155.57<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.697<hr/></td>
              <td align="center" valign="bottom">0.963<hr/></td>
              <td align="center" valign="bottom">0.498<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">210.34<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.939<hr/></td>
              <td align="center" valign="bottom">0.943<hr/></td>
              <td align="center" valign="bottom">0.815<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">102.00<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie<hr/></td>
              <td align="center" valign="bottom">0.366<hr/></td>
              <td align="center" valign="bottom">0.969<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">213.10<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.920<hr/></td>
              <td align="center" valign="bottom">0.948<hr/></td>
              <td align="center" valign="bottom">0.726<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">81.17<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">GEM<hr/></td>
              <td align="center" valign="bottom">0.906<hr/></td>
              <td align="center" valign="bottom">0.692<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">29.47<hr/></td>
            </tr>
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>d) ART paired-end length 100</bold><hr/></td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.962<hr/></td>
              <td align="center" valign="bottom">0.983<hr/></td>
              <td align="center" valign="bottom">0.949<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">147.38<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.352<hr/></td>
              <td align="center" valign="bottom">0.971<hr/></td>
              <td align="center" valign="bottom">0.201<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">194.03<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.955<hr/></td>
              <td align="center" valign="bottom">0.956<hr/></td>
              <td align="center" valign="bottom">0.854<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">102.86<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie<hr/></td>
              <td align="center" valign="bottom">0.365<hr/></td>
              <td align="center" valign="bottom">0.981<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">168.39<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.930<hr/></td>
              <td align="center" valign="bottom">0.957<hr/></td>
              <td align="center" valign="bottom">0.517<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">74.23<hr/></td>
            </tr>
            <tr>
              <td align="left"> </td>
              <td align="left">GEM</td>
              <td align="center">0.900</td>
              <td align="center">0.779</td>
              <td align="center">*</td>
              <td align="center">*</td>
              <td align="center">23.25</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Comparison of sensitivity, positive predictive value (PPV) and run time using BWA-PSSM, BWA, BWA-MEM, Bowtie, Bowtie2 and GEM on simulated data sets covering a random 1% of the human genome. The reads were simulated using the ART_illumina
[<xref ref-type="bibr" rid="B37">37</xref>] program with the default error profile for the given read length. The insert sizes in the paired-end data were simulated using a mean length of 250 and a standard deviation of 50. The symbol ’*’ indicates that the mapper does not provide MapQ scores.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Analysis of simulated biased single-end data</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left" valign="bottom"> <hr/></th>
              <th align="left" valign="bottom"> <hr/></th>
              <th colspan="2" align="center" valign="bottom">
                <bold>Unfiltered</bold>
                <hr/>
              </th>
              <th colspan="2" align="center" valign="bottom">
                <bold>MapQ filtered</bold>
                <hr/>
              </th>
              <th align="left" valign="bottom"> <hr/></th>
            </tr>
            <tr>
              <th align="left"> </th>
              <th align="left">
                <bold>Mapper</bold>
              </th>
              <th align="center">
                <bold>Sensitivity</bold>
              </th>
              <th align="center">
                <bold>PPV</bold>
              </th>
              <th align="center">
                <bold>Sensitivity</bold>
              </th>
              <th align="center">
                <bold>PPV</bold>
              </th>
              <th align="center">
                <bold>Time (s)</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>a) ART single-end length 36 / PAR-CLIP</bold><hr/></td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<sup>PC</sup><hr/></td>
              <td align="center" valign="bottom">0.699<hr/></td>
              <td align="center" valign="bottom">0.881<hr/></td>
              <td align="center" valign="bottom">0.662<hr/></td>
              <td align="center" valign="bottom">0.996<hr/></td>
              <td align="center" valign="bottom">68.84<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.642<hr/></td>
              <td align="center" valign="bottom">0.865<hr/></td>
              <td align="center" valign="bottom">0.594<hr/></td>
              <td align="center" valign="bottom">0.990<hr/></td>
              <td align="center" valign="bottom">81.89<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.628<hr/></td>
              <td align="center" valign="bottom">0.866<hr/></td>
              <td align="center" valign="bottom">0.582<hr/></td>
              <td align="center" valign="bottom">0.996<hr/></td>
              <td align="center" valign="bottom">56.05<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.451<hr/></td>
              <td align="center" valign="bottom">0.844<hr/></td>
              <td align="center" valign="bottom">0.388<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">74.78<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie<hr/></td>
              <td align="center" valign="bottom">0.689<hr/></td>
              <td align="center" valign="bottom">0.870<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">32.21<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.594<hr/></td>
              <td align="center" valign="bottom">0.845<hr/></td>
              <td align="center" valign="bottom">0.419<hr/></td>
              <td align="center" valign="bottom">0.992<hr/></td>
              <td align="center" valign="bottom">25.91<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">GEM<hr/></td>
              <td align="center" valign="bottom">0.475<hr/></td>
              <td align="center" valign="bottom">0.980<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">39.48<hr/></td>
            </tr>
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>b) ART single-end length 55 / Ancient DNA</bold><hr/></td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<sup>A</sup><hr/></td>
              <td align="center" valign="bottom">0.807<hr/></td>
              <td align="center" valign="bottom">0.941<hr/></td>
              <td align="center" valign="bottom">0.774<hr/></td>
              <td align="center" valign="bottom">0.997<hr/></td>
              <td align="center" valign="bottom">122.16<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.797<hr/></td>
              <td align="center" valign="bottom">0.937<hr/></td>
              <td align="center" valign="bottom">0.766<hr/></td>
              <td align="center" valign="bottom">0.996<hr/></td>
              <td align="center" valign="bottom">115.17<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.743<hr/></td>
              <td align="center" valign="bottom">0.935<hr/></td>
              <td align="center" valign="bottom">0.703<hr/></td>
              <td align="center" valign="bottom">0.998<hr/></td>
              <td align="center" valign="bottom">90.33<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.817<hr/></td>
              <td align="center" valign="bottom">0.924<hr/></td>
              <td align="center" valign="bottom">0.725<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">50.89<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie<hr/></td>
              <td align="center" valign="bottom">0.807<hr/></td>
              <td align="center" valign="bottom">0.934<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">28.55<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.788<hr/></td>
              <td align="center" valign="bottom">0.916<hr/></td>
              <td align="center" valign="bottom">0.665<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">57.76<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">GEM<hr/></td>
              <td align="center" valign="bottom">0.691<hr/></td>
              <td align="center" valign="bottom">0.993<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">30.62<hr/></td>
            </tr>
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>c) ART single-end length 100 /</bold><bold><italic>P. falciparum</italic></bold><hr/></td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.899<hr/></td>
              <td align="center" valign="bottom">0.975<hr/></td>
              <td align="center" valign="bottom">0.886<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">86.60<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.332<hr/></td>
              <td align="center" valign="bottom">0.974<hr/></td>
              <td align="center" valign="bottom">0.325<hr/></td>
              <td align="center" valign="bottom">0.999<hr/></td>
              <td align="center" valign="bottom">59.20<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.824<hr/></td>
              <td align="center" valign="bottom">0.840<hr/></td>
              <td align="center" valign="bottom">0.786<hr/></td>
              <td align="center" valign="bottom">0.868<hr/></td>
              <td align="center" valign="bottom">34.56<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie<hr/></td>
              <td align="center" valign="bottom">0.925<hr/></td>
              <td align="center" valign="bottom">0.976<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">12.91<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.832<hr/></td>
              <td align="center" valign="bottom">0.972<hr/></td>
              <td align="center" valign="bottom">0.712<hr/></td>
              <td align="center" valign="bottom">1.000<hr/></td>
              <td align="center" valign="bottom">34.33<hr/></td>
            </tr>
            <tr>
              <td align="left"> </td>
              <td align="left">GEM</td>
              <td align="center">0.726</td>
              <td align="center">1.000</td>
              <td align="center">*</td>
              <td align="center">*</td>
              <td align="center">13.84</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Comparison of sensitivity, positive predictive value (PPV) and run time using BWA-PSSM, BWA, BWA-MEM, Bowtie, Bowtie2 and GEM on data sets simulated using the ART_illumina
[<xref ref-type="bibr" rid="B37">37</xref>] program with the default error profile for the given read length. The PAR-CLIP and Ancient DNA data sets cover a random 1% of the human genome, while the <italic>P. falciparum</italic> data set covers 42.9% of the <italic>P. falciparum</italic> genome corresponding to 100,000 reads. The data simulated for the PAR-CLIP and Ancient DNA data was further mutated to simulate the bias introduced by the experiment and natural degradation (see the respective Results and discussion sections). The symbol ’*’ indicates that the mapper does not provide MapQ scores.</p>
        </table-wrap-foot>
      </table-wrap>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Comparison of the sensitivity of BWA-PSSM, BWA, BWA-MEM and Bowtie2 after applying MapQ filtering on the single-end and paired-end data sets simulated with ART.</bold> After filtering the results on mapping quality all the mappers shown above have a PPV above 0.99. The sensitivities and PPVs are listed in Tables
<xref ref-type="table" rid="T1">1</xref> and
<xref ref-type="table" rid="T2">2</xref>. Bowtie and GEM are excluded as they do not provide MapQ scores.</p>
        </caption>
        <graphic xlink:href="1471-2105-15-100-1"/>
      </fig>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Comparison of the sensitivity of BWA-PSSM, BWA, BWA-MEM and Bowtie2 for the three simulated biased data sets after applying MapQ filtering.</bold> After filtering the results on mapping quality all the mappers shown above have a PPV above 0.97, except for BWA-MEM which has a PPV of 0.868 on the <italic>P. falciparum</italic> data set. For the PAR-CLIP data we show the sensitivity of BWA-PSSM<sup>PC</sup> using the T-to-C transition model, and for the ancient DNA data the sensitivity of BWA-PSSM<sup>A</sup> using the ancient DNA damage model is shown. The sensitivities and PPVs are listed in Table
<xref ref-type="table" rid="T3">3</xref>. Bowtie and GEM are excluded as they do not provide MapQ scores.</p>
        </caption>
        <graphic xlink:href="1471-2105-15-100-2"/>
      </fig>
      <sec>
        <title>Unbiased reads</title>
        <p>To test the baseline performance of BWA-PSSM, we simulated reads using three different simulation programs. The first, ART
[<xref ref-type="bibr" rid="B37">37</xref>] simulates reads using an error profile particular to the sequencing technology being simulated (Illumina Genome Analyzer II, in our case). The second, WG-SIM
[<xref ref-type="bibr" rid="B38">38</xref>], simulates reads with a uniform error probability. The third, MASON
[<xref ref-type="bibr" rid="B39">39</xref>], uses variable, position dependent qualities drawn from normal distributions with a specified mean and standard deviation for the start and end position. ART generated the lowest quality reads, followed by MASON, followed by the high quality WG-SIM simulated reads.</p>
        <p>As expected, BWA-PSSM performs best on the low-quality data set (Table
<xref ref-type="table" rid="T1">1</xref>) and slightly worse on the high quality reads (Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref>: Table S2 and S4). It performs comparatively better on the shorter reads than on the longer. This is likely explained by the fact that we limit the size of the heap (and consequently the branching) and thus miss more hits simply because we discard a proportionally larger portion of the search space for the longer reads. Filtering according to mapping quality improves the PPV and reduces the sensitivity.</p>
        <p>The performance of BWA-PSSM really stands out when considering high quality alignments (as reported by the MapQ score) of ART-simulated reads (Figure
<xref ref-type="fig" rid="F1">1</xref>). BWA-PSSM achieves the greatest sensitivity of the tested aligners which all have a PPV greater than 99%. For reads of length 36 and 50, BWA-PSSM performs better across all quality values, whereas for the longer reads BWA-MEM reports more lower quality mappings (Figure
<xref ref-type="fig" rid="F3">3</xref>). When ignoring the quality of the resulting mappings, Bowtie returns more results with the caveat that they are more likely to be incorrect. The running time among the aligners varies within an order of magnitude with Bowtie consistently being the fastest while the slowest depended on the length and quality of the reads.</p>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p><bold>Sensitivity as a function of PPV for BWA-PSSM, BWA, BWA-MEM and Bowtie2 using single-end ART-simulated data.</bold> For short reads of length 36 <bold>(a)</bold> and 50 <bold>(b)</bold> BWA-PSSM shows greater sensitivity than the other mappers at similar PPV. For reads of length 76 <bold>(c)</bold> the performance of BWA-PSSM and BWA-MEM is similar, while for reads of length 100 <bold>(d)</bold> BWA-MEM has slightly higher sensitivity than BWA-PSSM at similar PPV. The curves for each mapping program were obtained by filtering for varying mapping qualities. The results are based on the simulations shown in Table
<xref ref-type="table" rid="T1">1</xref>. Bowtie and GEM are excluded as they do not provide MapQ scores.</p>
          </caption>
          <graphic xlink:href="1471-2105-15-100-3"/>
        </fig>
        <p>For the longer higher quality reads, the performance of BWA-PSSM lags slightly behind the other aligners for all PPV values (Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S2 and S3). These results are not unexpected as using quality values which are largely irrelevant should not improve the performance. Furthermore, some of the trade-offs employed to improve the performance for low-quality and biased reads impede the performance for high quality data. While disadvantageous, this is not the targeted type of data for which this approach was designed and the other aligners already serve this niche adequately.</p>
        <p>GEM reports all the potential hits found and classifies them according to the edit distance from the genome. While this approach leads to a greater overall sensitivity, it also makes it difficult to assign a confidence value to a particular alignment. The strength of this mapper lies in aligning long insertion/deletion prone reads, two qualities which are conspicuously absent from the presented benchmark data sets. As such, the performance of GEM is presented in the data tables simply as a point of a comparison for this different class of read mappers.</p>
        <p>For paired-end data (Table
<xref ref-type="table" rid="T2">2</xref> and Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref>: Table S3), the situation is similar but more pronounced. Low quality reads are readily aligned with high accuracy by BWA-PSSM whereas high quality reads present a greater challenge. Due to the use of (nearly) default parameters for each aligner, BWA performs extremely poorly on the longer low quality reads. The situation is somewhat reversed for the high quality reads where BWA-PSSM finds slightly less hits in a longer amount of time than Bowtie2 and BWA. The results presented, of course, depend greatly upon the parameters chosen for each mapper (the default). Exploring the potential parameter space for each program is an overwhelming task which is often guided by the data to be aligned. The results presented here are merely meant to be a cross section of the potential capabilities of each aligner, corresponding to a roughly comparable (within an order of magnitude) running time.</p>
      </sec>
    </sec>
    <sec>
      <title>Ancient DNA</title>
      <p>By specifying a probability for each base at each position, it is possible to include additional information in the alignment. Ancient DNA is fragmented and degraded in various ways, leading to specific biases and errors in the data. The dominant error is the deamination of cytosines into uracils (C-to-U), which will be interpreted as thymines in the sequencing step
[<xref ref-type="bibr" rid="B40">40</xref>]. This leads to an excess of C-to-T or G-to-A mismatches, depending on the strand being sequenced. This is most significant in the ends of the reads and decreases rapidly towards the center
[<xref ref-type="bibr" rid="B15">15</xref>].</p>
      <p>PSSMs were simulated using the damage model specified by Orlando <italic>et al.</italic>[<xref ref-type="bibr" rid="B15">15</xref>], see Methods. The results (Table
<xref ref-type="table" rid="T3">3</xref>b) show that BWA-PSSM with a PSSM modelling the simulated damage gives slightly higher sensitivity and PPV than without a damage model. The sensitivity is slightly higher than BWA while the run time is roughly the same. BWA-PSSM was able to find more hits than BWA, Bowtie and Bowtie2 even without a specialized PSSM.</p>
      <p>When mapping real ancient DNA and filtering on MapQ, the results mostly reflect the simulated data (Table
<xref ref-type="table" rid="T4">4</xref>a). The use of a PSSM led to the recovery of more matches than without one. While the difference is not large, the number of reads one might expect to be damaged is rather low in comparison to the total number of reads present. Hence, a modest increase in actual numbers can reflect a greater increase in relative terms. Furthermore, if the results reflect the simulated data, then the expected PPV of the filtered results should be higher than for the other mapping tools. Again, BWA-PSSM without a specialized PSSM provides an increase in filtered matches compared to BWA and Bowtie2.</p>
      <table-wrap position="float" id="T4">
        <label>Table 4</label>
        <caption>
          <p>Analysis of real single-end data</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left" valign="bottom"> <hr/></th>
              <th align="left" valign="bottom"> <hr/></th>
              <th align="center" valign="bottom">
                <bold>Unfiltered</bold>
                <hr/>
              </th>
              <th align="center" valign="bottom">
                <bold>Filtered</bold>
                <hr/>
              </th>
              <th align="left" valign="bottom"> <hr/></th>
            </tr>
            <tr>
              <th align="left" valign="bottom"> <hr/></th>
              <th align="left" valign="bottom">
                <bold>Mapper</bold>
                <hr/>
              </th>
              <th align="center" valign="bottom">
                <bold>Aligned</bold>
                <hr/>
              </th>
              <th align="center" valign="bottom">
                <bold>Aligned</bold>
                <hr/>
              </th>
              <th align="center" valign="bottom">
                <bold>Time (s)</bold>
                <hr/>
              </th>
            </tr>
            <tr>
              <th align="left"> </th>
              <th align="left"> </th>
              <th align="center">
                <bold>(fraction)</bold>
              </th>
              <th align="center">
                <bold>(fraction)</bold>
              </th>
              <th align="left"> </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td colspan="5" align="left" valign="bottom">
                <bold>a) Ancient DNA</bold>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<sup>A</sup><hr/></td>
              <td align="center" valign="bottom">0.01000<hr/></td>
              <td align="center" valign="bottom">0.00763<hr/></td>
              <td align="center" valign="bottom">60.75<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.01000<hr/></td>
              <td align="center" valign="bottom">0.00759<hr/></td>
              <td align="center" valign="bottom">51.61<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.00906<hr/></td>
              <td align="center" valign="bottom">0.00708<hr/></td>
              <td align="center" valign="bottom">18.63<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.01629<hr/></td>
              <td align="center" valign="bottom">0.01177<hr/></td>
              <td align="center" valign="bottom">21.24<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie<hr/></td>
              <td align="center" valign="bottom">0.00892<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">63.78<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.01087<hr/></td>
              <td align="center" valign="bottom">0.00691<hr/></td>
              <td align="center" valign="bottom">16.48<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">GEM<hr/></td>
              <td align="center" valign="bottom">0.06106<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">18.69<hr/></td>
            </tr>
            <tr>
              <td colspan="5" align="left" valign="bottom">
                <bold>b) Real PAR-CLIP</bold>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<sup>PC</sup><hr/></td>
              <td align="center" valign="bottom">0.600<hr/></td>
              <td align="center" valign="bottom">0.148<hr/></td>
              <td align="center" valign="bottom">146.08<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.476<hr/></td>
              <td align="center" valign="bottom">0.114<hr/></td>
              <td align="center" valign="bottom">141.08<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.483<hr/></td>
              <td align="center" valign="bottom">0.140<hr/></td>
              <td align="center" valign="bottom">166.99<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.198<hr/></td>
              <td align="center" valign="bottom">0.022<hr/></td>
              <td align="center" valign="bottom">236.51<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie<hr/></td>
              <td align="center" valign="bottom">0.463<hr/></td>
              <td align="center" valign="bottom">*<hr/></td>
              <td align="center" valign="bottom">84.81<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.453<hr/></td>
              <td align="center" valign="bottom">0.076<hr/></td>
              <td align="center" valign="bottom">43.11<hr/></td>
            </tr>
            <tr>
              <td align="left"> </td>
              <td align="left">GEM</td>
              <td align="center">0.227</td>
              <td align="center">0.227</td>
              <td align="center">280.57</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Comparison of run times and fraction of reads mapped for the four mappers on two real data sets, each containing 100,000 Illumina reads. <bold>a)</bold> Reads of ancient DNA mapped to the horse genome. The run times do not include the time required to build the PSSMs. <bold>b)</bold> Reads of PAR-CLIP data mapped to the human genome. BWA-PSSM only makes use of the error model given by equation (1), while BWA-PSSM<sup>A</sup> also uses the ancient DNA damage model and BWA-PSSM<sup>PC</sup> also uses the T-to-C transition model characterizing PAR-CLIP data. The symbol ’*’ indicates that the mapper does not provide MapQ scores.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>PAR-CLIP data</title>
      <p>Sequencing data from PAR-CLIP experiments is very prone to T-to-C transitions due to the incorporation of 4SU-containing nucleobases and their crosslinking to the bound protein. The locations of such transitions indicate where an RNA molecule is bound by a protein
[<xref ref-type="bibr" rid="B41">41</xref>]. The increased probability of a T-to-C mismatch is readily encoded in a PSSM and incorporated into the mapping by BWA-PSSM.</p>
      <p>To examine the efficacy of providing this extra information, reads were simulated with a 11% T-to-C rate. The results (Table
<xref ref-type="table" rid="T3">3</xref>a) show that the use of a T-to-C transition model improves both the unfiltered and filtered sensitivity. Without such a model, BWA-PSSM performs only slightly better than BWA. Introducing the error model increases the filtered sensitivity by nearly 14% over the previous best aligner (BWA) for quality-filtered mappings. This advantage, however, is not limited to high quality mappings and can be seen across all reported mapping qualities (Figure
<xref ref-type="fig" rid="F4">4</xref>). Even for the high quality data sets, where the use of PSSM was more of a hindrance for aligning unbiased reads, introducing an error model leads to greatly improved sensitivity in aligning simulated PAR-CLIP data (Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref>: Table S2 and S4).</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Sensitivity as a function of PPV for BWA-PSSM, BWA, BWA-MEM and Bowtie2 using single-end PAR-CLIP data simulated using ART.</bold> The curves for each mapping program were obtained by filtering for varying mapping qualities. The top line for BWA-PSSM (PC) includes the PAR-CLIP model. The results are based on the PAR-CLIP simulation shown in Table
<xref ref-type="table" rid="T3">3</xref>a. Bowtie and GEM are excluded as they do not provide MapQ scores.</p>
        </caption>
        <graphic xlink:href="1471-2105-15-100-4"/>
      </fig>
      <p>To support the simulated data, real data was obtained from a PAR-CLIP study investigating the binding of RNA to the HuR protein
[<xref ref-type="bibr" rid="B42">42</xref>]. The statistics for the mapping of the real data (Table
<xref ref-type="table" rid="T4">4</xref>b) roughly reflects those for the simulated data. Notice the greatly reduced number of matches after filtering for all the mappers, which is the result of shorter reads leading to more ambiguous matches, and a base distribution unlike that of the actual genome (due to the AT-rich regions that were being sequenced). Nevertheless, BWA-PSSM finds more matches than any of the other programs at a PPV value greater than 0.95 for all types of simulated data.</p>
    </sec>
    <sec>
      <title>AT rich data</title>
      <p>To test the effect of the background model in BWA-PSSM, we simulated Illumina reads of length 100nt using ART
[<xref ref-type="bibr" rid="B43">43</xref>] from the <italic>P. falciparum</italic> genome
[<xref ref-type="bibr" rid="B33">33</xref>], which has an AT content of more than 80%. In BWA-PSSM, the PSSMs were constructed using a background model, <italic>q</italic>(<italic>g</italic>), that matches the base composition of the reference genome, while the other mappers do not consider this base composition. We see that all mappers except BWA-MEM have similar PPVs for both unfiltered and filtered reads (Table
<xref ref-type="table" rid="T3">3</xref>c). Among the mappers that provide a quality score, BWA-PSSM obtains the highest sensitivity. For filtered reads BWA-MEM has the next highest sensitivity, however the PPV for BWA-MEM is significantly lower than for the other mappers. Bowtie2 has a marginally lower unfiltered sensitivity than BWA-PSSM, however, for the filtered reads the sensitivity of Bowtie2 is notably lower. While BWA has a considerably lower sensitivity than the other mappers, Bowtie has the highest sensitivity, which is obtained at the cost of slightly reduced PPV compared to the filtered PPV of BWA-PSSM.</p>
    </sec>
    <sec>
      <title>Random matches from contaminating reads</title>
      <p>We examined how well the mappers can filter out random short matches. To obtain random matches, we simulated short reads of different lengths from the <italic>E. coli</italic> genome
[<xref ref-type="bibr" rid="B44">44</xref>] using ART
[<xref ref-type="bibr" rid="B43">43</xref>] and mapped them to the human genome. From Figure
<xref ref-type="fig" rid="F5">5</xref> we observe that BWA-PSSM, BWA and Bowtie map similar fractions of reads when not applying a quality filter, while this fraction in general is smaller for Bowtie2. However, for quality filtered reads BWA-PSSM maps at worst less than 2% of the reads, which is less than any of the other mappers except BWA-MEM, though from read length 20nt the curves for Bowtie2 and BWA-PSSM are coincident. In comparison, BWA maps more than 25% of the reads at worst after quality filtering. GEM maps approximately the same fraction of reads as Bowtie2 does after quality filtering and BWA-MEM cannot map any reads at the given lengths. In conclusion, we see that BWA-PSSM has similar efficiency as BWA and Bowtie in mapping short reads, however the quality score (posterior probability) reported by BWA-PSSM allows for filtering out random matches at least as efficiently as Bowtie2.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Mapping simulated </bold><bold><italic>E. coli </italic></bold><bold> reads to the human genome.</bold> The fraction of all <italic>E. coli</italic> reads that are mapped is shown as a function of the read length. For each length, 100,000 Illumina reads were simulated using ART
[<xref ref-type="bibr" rid="B43">43</xref>]. The dotted lines represent the fraction of unfiltered reads, while the full lines are the fraction of quality filtered reads. For Bowtie and GEM curves are only shown for unfiltered reads. The curves for BWA-MEM are hardly visible as BWA-MEM does not map any reads.</p>
        </caption>
        <graphic xlink:href="1471-2105-15-100-5"/>
      </fig>
    </sec>
    <sec>
      <title>Xeno mapping</title>
      <p>If no reference genome is available for a set of reads, one can try to map the reads to a closely related species. This task is called cross species mapping or xeno mapping
[<xref ref-type="bibr" rid="B31">31</xref>]. Inspired by the work of Frith <italic>et al.</italic>[<xref ref-type="bibr" rid="B31">31</xref>], we examine how well the programs can map real reads from <italic>D. melanogaster</italic> using the closely related <italic>D. simulans</italic> genome as reference. We consider three sets of <italic>D. melanogaster</italic> reads obtained from the NCBI SRA database: a set of short reads (length 36nt, ID SRR001981), a set of long reads with low quality (length 76, ID SRR023647) and a set of long reads with high quality (length 95, ID SRR516029). All data sets are based on the Illumina platform and low quality bases in the end of the reads are trimmed using the AdapterRemoval tool
[<xref ref-type="bibr" rid="B45">45</xref>].</p>
      <p>To gauge the performance of the mappers, reads are mapped to both the <italic>D. simulans</italic> and <italic>D. melanogaster</italic> genome using each mapper. For each tool, we consider all reads that map to the genomes with a mapping quality above a given threshold, and we compare the mapping positions in the two genomes based on the UCSC whole genome alignment of <italic>D. simulans</italic> and <italic>D. melanogaster</italic>. If the mapping regions overlap in the whole genome alignment we say the read is <italic>consistently</italic> mapped. If the read maps to a region in <italic>D. melanogaster</italic> that is aligned to <italic>D. simulans</italic>, but the mapping regions do not overlap, we say the read is <italic>inconsistently</italic> mapped. For the xeno mapping experiments we calculate the sensitivity as the number of consistently mapped reads divided by the total number of reads, and the PPV is calculated as the number of consistently mapped reads divided by the number of consistently and inconsistently mapped reads.</p>
      <p>The flexibility of BWA-PSSM allows us to include an evolutionary model that reflects the substitution level between the two Drosophila genomes when we map the reads to <italic>D. simulans</italic> (see Methods). For comparison we also map the reads to <italic>D. simulans</italic> with BWA-PSSM using only the standard error model. In both cases, we map the reads to <italic>D. melanogaster</italic> using only the standard error model.</p>
      <p>Due to the setup of this experiment, we only consider mappers that provide MapQ scores. The results are shown in Table
<xref ref-type="table" rid="T5">5</xref> and Figure
<xref ref-type="fig" rid="F6">6</xref>. In Table
<xref ref-type="table" rid="T5">5</xref> we used a MapQ threshold of 25 and in Figure
<xref ref-type="fig" rid="F6">6</xref> the threshold was varied between 0 and 200.</p>
      <table-wrap position="float" id="T5">
        <label>Table 5</label>
        <caption>
          <p>Analysis of the xeno mapping experiment</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left" valign="bottom"> <hr/></th>
              <th align="left" valign="bottom"> <hr/></th>
              <th colspan="2" align="center" valign="bottom">
                <bold>MapQ filtered</bold>
                <hr/>
              </th>
              <th align="left" valign="bottom"> <hr/></th>
            </tr>
            <tr>
              <th align="left"> </th>
              <th align="left">
                <bold>Mapper</bold>
              </th>
              <th align="center">
                <bold>Sensitivity</bold>
              </th>
              <th align="center">
                <bold>PPV</bold>
              </th>
              <th align="center">
                <bold>Time (s)</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>a) Xeno short reads (SRR001981)</bold><hr/></td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<sup>EVO</sup><hr/></td>
              <td align="center" valign="bottom">0.305<hr/></td>
              <td align="center" valign="bottom">0.982<hr/></td>
              <td align="center" valign="bottom">3721.53<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.269<hr/></td>
              <td align="center" valign="bottom">0.976<hr/></td>
              <td align="center" valign="bottom">3228.94<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.268<hr/></td>
              <td align="center" valign="bottom">0.982<hr/></td>
              <td align="center" valign="bottom">1444.48<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.186<hr/></td>
              <td align="center" valign="bottom">0.989<hr/></td>
              <td align="center" valign="bottom">727.22<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.195<hr/></td>
              <td align="center" valign="bottom">0.981<hr/></td>
              <td align="center" valign="bottom">635.21<hr/></td>
            </tr>
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>b) Xeno long low quality reads (SRR023647)</bold><hr/></td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<sup>EVO</sup><hr/></td>
              <td align="center" valign="bottom">0.609<hr/></td>
              <td align="center" valign="bottom">0.994<hr/></td>
              <td align="center" valign="bottom">9355.64<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.591<hr/></td>
              <td align="center" valign="bottom">0.989<hr/></td>
              <td align="center" valign="bottom">7371.12<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.550<hr/></td>
              <td align="center" valign="bottom">0.992<hr/></td>
              <td align="center" valign="bottom">3420.15<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.500<hr/></td>
              <td align="center" valign="bottom">0.984<hr/></td>
              <td align="center" valign="bottom">1260.17<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">Bowtie2<hr/></td>
              <td align="center" valign="bottom">0.429<hr/></td>
              <td align="center" valign="bottom">0.991<hr/></td>
              <td align="center" valign="bottom">1262.93<hr/></td>
            </tr>
            <tr>
              <td colspan="4" align="left" valign="bottom"> <bold>c) Xeno long high quality reads (SRR516029)</bold><hr/></td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<sup>EVO</sup><hr/></td>
              <td align="center" valign="bottom">0.364<hr/></td>
              <td align="center" valign="bottom">0.979<hr/></td>
              <td align="center" valign="bottom">13271.88<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-PSSM<hr/></td>
              <td align="center" valign="bottom">0.300<hr/></td>
              <td align="center" valign="bottom">0.972<hr/></td>
              <td align="center" valign="bottom">11457.96<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA<hr/></td>
              <td align="center" valign="bottom">0.302<hr/></td>
              <td align="center" valign="bottom">0.984<hr/></td>
              <td align="center" valign="bottom">5735.58<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">BWA-MEM<hr/></td>
              <td align="center" valign="bottom">0.429<hr/></td>
              <td align="center" valign="bottom">0.988<hr/></td>
              <td align="center" valign="bottom">4147.98<hr/></td>
            </tr>
            <tr>
              <td align="left"> </td>
              <td align="left">Bowtie2</td>
              <td align="center">0.218</td>
              <td align="center">0.987</td>
              <td align="center">3468.82</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Comparison of sensitivity, positive predictive value (PPV) and run time using BWA-PSSM, BWA, BWA-MEM and Bowtie2 on real single-end reads from <italic>D. melanogaster</italic> mapped to <italic>D. simulans</italic>. In BWA-PSSM<sup>EVO</sup> we include an evolutionary model reflecting the substitution rate between the two Drosophila genomes when mapping the reads to <italic>D. simulans</italic>, while in the BWA-PSSM results we only include the standard error model. The reported running time is only for the xeno mapping.</p>
        </table-wrap-foot>
      </table-wrap>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Sensitivity as a function of PPV for BWA-PSSM, BWA, BWA-MEM and Bowtie2 for the xeno mapping experiment.</bold> Single-end Illumina reads from <italic>D. melanogaster</italic> are mapped to the <italic>D. simulans</italic> genome using the five mappers. Plots are shown for short reads <bold>(a)</bold>, long low quality reads <bold>(b)</bold> and long high quality reads <bold>(c)</bold>. The curves for each mapping program were obtained by filtering for varying mapping qualities. The results are based on the data in Table
<xref ref-type="table" rid="T5">5</xref>. Bowtie and GEM are excluded as they do not provide MapQ scores.</p>
        </caption>
        <graphic xlink:href="1471-2105-15-100-6"/>
      </fig>
      <p>We see that BWA-PSSM with the evolutionary model generally performs better than all the other programs for the short reads and the long low quality reads (Figure
<xref ref-type="fig" rid="F6">6</xref>a and
<xref ref-type="fig" rid="F6">6</xref>b). BWA-PSSM has higher sensitivity for any PPV value except in the high PPV end of the curves. For the short reads, BWA-MEM has slightly better sensitivity at PPV between 0.991 and 0.992, and for the long low quality reads BWA and Bowtie2 can obtain slightly higher PPV than BWA-PSSM in the low sensitive end of the curves. For the long high quality reads (Figure
<xref ref-type="fig" rid="F6">6</xref>c) we see that BWA-MEM performs best overall, while Bowtie2 can obtain marginally higher PPV than BWA-MEM. BWA-PSSM can obtain the next highest sensitivity with the evolutionary model, however all the other mappers, including BWA-PSSM without the evolutionary model, can obtain higher PPVs.</p>
      <p>We see a similar picture when we consider the filtered results in Table
<xref ref-type="table" rid="T5">5</xref>. While the mappers have similar PPVs on all the data sets for a fixed MapQ threshold, BWA-PSSM has the highest sensitivity on the short and long low quality reads. On the long high quality reads BWA-MEM has the highest sensitivity and BWA-PSSM the next highest. We also see that the increased sensitivity of BWA-PSSM come at the cost of increased running time. In the worst case (Table
<xref ref-type="table" rid="T5">5</xref>b) BWA-PSSM is nearly 7.5 times slower than the fastest method (Bowtie2), however in this case BWA-PSSM maps over 40% more reads and have a marginal higher PPV than Bowtie2.</p>
      <p>Finally we also see that the performance of BWA-PSSM generally improves when including an evolutionary model. On the short reads the sensitivity of BWA-PSSM is improved at all PPVs and on the two long read data sets BWA-PSSM can generally obtain higher sensitivity with the evolutionary model. However, BWA-PSSM can obtain slightly higher PPVs using only the standard error model on the long reads.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>We have presented BWA-PSSM, a novel method for using position-specific scoring matrices to provide quality aware short read mapping. The algorithm for PSSM scoring is based on BWA’s mapping algorithm. This method can be applied to other PSSM applications, lowering the number of genomic locations that need to be evaluated and increasing the efficiency of PSSM searches.</p>
    <p>There are many advantages in the probabilistic approach taken here, in which the probability of a match being correct is estimated using prior probabilities that may be specific for the experiment. We have shown how it is possible to model the evolutionary differences between the sample and reference genome, sequencing errors based on e.g. quality scores, experiment-specific base substitutions, and contamination in the sample.</p>
    <p>It is worth emphasizing the importance of the prior probability of a match. In all experiments there is a possibility that the read sequence is due to contamination or that it does not appear in the reference genome for other reasons (e.g. sequences private to the sampled individual). In some experiments the majority of reads may be contamination, as is often the case with ancient samples. Especially when it comes to short reads, there is a great risk that contaminating sequences will be mapped to the reference genome, as was illustrated with the mapping of <italic>E. coli</italic> sequences to the human genome. This may be taken into account by changing the value for the prior probability of a match.</p>
    <p>Some of the important extensions implemented in BWA-PSSM include the ability to use longer genomes and to handle the forward and reverse search in a single concatenated index, the control of the direction of the search tree traversal based on the underlying PSSM, and the use of an interval heap for focusing on the most likely region of the search tree while discarding lower scoring branches. Furthermore, BWA-PSSM can capture platform and sample specific biases in the nucleotide composition, making the tool highly sensitive and adaptable to specialized applications such as ancient DNA, PAR-CLIP, or biased genomes.</p>
    <p>Because matches can be prioritized by a continuous match score, the number of candidate matches stored in the heap can be significantly reduced compared to other methods that use the number of mismatches to prioritize. For this reason the PSSM implementation runs with a speed comparable to the other mappers.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>A probabilistic model for next-generation DNA reads</title>
      <p>In this section we present a detailed description of the probabilistic model of DNA reads. In the simple model we have two distinct processes that can affect the base called by the sequencer compared to the base actually present in the genome of interest: Actual mutation with respect to the reference genome from base <italic>g</italic> to base <italic>a</italic>, and a miscalled base <italic>x</italic> by the sequencing machine given base <italic>a</italic> in the sample.</p>
      <p>We will assume that the observed base <italic>x</italic> is independent of the base <italic>g</italic> in the genome given the base <italic>a</italic> in the sample. This conditional independence assumption can be expressed by the Bayesian network in Figure
<xref ref-type="fig" rid="F7">7</xref>A. Using this assumption we can calculate the probability of observing the base <italic>x</italic> in the read given the base <italic>g</italic> in the genome
<inline-formula><mml:math id="M7" name="1471-2105-15-100-i9" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, where <italic>P</italic>(<italic>a</italic>|<italic>g</italic>) is the mutation model and <italic>P</italic>(<italic>x</italic>|<italic>a</italic>) is the model of sequencing errors. To calculate the entries in the position-specific scoring matrix (PSSM) we need <italic>P</italic>(<italic>g</italic>|<italic>x</italic>), and the conditional independence assumptions also give that</p>
      <p>
        <disp-formula id="bmcM3">
          <label>(3)</label>
          <mml:math id="M8" name="1471-2105-15-100-i10" overflow="scroll">
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>g</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:munder>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>a</mml:mi>
              </mml:mrow>
            </mml:munder>
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>g</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>a</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>a</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <fig id="F7" position="float">
        <label>Figure 7</label>
        <caption>
          <p><bold>Bayesian networks describing the independence assumptions between nucleotides.</bold> The nodes represent random variables, while the arrows describe the conditional independencies between the variables. The left figure <bold>(A)</bold> shows the base in the reference genome <italic>g</italic>, the base in the sample <italic>a</italic>, and the observed base <italic>x</italic>, while the right figure <bold>(B)</bold> also includes the alternated (biased) base <italic>b</italic>.</p>
        </caption>
        <graphic xlink:href="1471-2105-15-100-7"/>
      </fig>
      <p><italic>P</italic>(<italic>g</italic>|<italic>a</italic>) can be calculated from an evolutionary model. Here we use a simple one, where there is a fixed probability <italic>p</italic><sub>0</sub> for a mutation which is independent of the base, that is</p>
      <p>
        <disp-formula id="bmcM4">
          <label>(4)</label>
          <mml:math id="M9" name="1471-2105-15-100-i11" overflow="scroll">
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>g</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>a</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mfenced open="{">
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mn>1</mml:mn>
                      <mml:mo>-</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mtext>if</mml:mtext>
                      <mml:mspace width="0.3em"/>
                      <mml:mi>a</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo stretchy="false">/</mml:mo>
                      <mml:mn>3</mml:mn>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mtext>if</mml:mtext>
                      <mml:mspace width="0.3em"/>
                      <mml:mi>a</mml:mi>
                      <mml:mo>≠</mml:mo>
                      <mml:mi>g</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mfenced>
            <mml:mspace width="1em"/>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>For this to make sense, we implicitly assume a uniform base distribution in the genome.</p>
      <p>For sequencing error we also assume a simple model, where the probability of an error <italic>p</italic><sub>e</sub> = 10<sup>-<italic>Q</italic>/10</sup> is given by the quality score <italic>Q</italic>. From this we can calculate the probability of the sample containing base <italic>a</italic> given that the sequencer is calling base <italic>x</italic></p>
      <p>
        <disp-formula id="bmcM5">
          <label>(5)</label>
          <mml:math id="M10" name="1471-2105-15-100-i12" overflow="scroll">
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>a</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mfenced open="{">
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mn>1</mml:mn>
                      <mml:mo>-</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">e</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mtext>if</mml:mtext>
                      <mml:mspace width="0.3em"/>
                      <mml:mi>a</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mi>x</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">e</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo stretchy="false">/</mml:mo>
                      <mml:mn>3</mml:mn>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mtext>if</mml:mtext>
                      <mml:mspace width="0.3em"/>
                      <mml:mi>a</mml:mi>
                      <mml:mo>≠</mml:mo>
                      <mml:mi>x</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mfenced>
            <mml:mspace width="1em"/>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>Note that it is in principle straight-forward to use more sophisticated models both for evolution and for sequencing errors and include these in the PSSM. An example of such a model is presented in the next section.</p>
      <sec>
        <title>Evolutionary model for xeno mapping</title>
        <p>For xeno mapping we adopt the evolutionary model by Frith <italic>et al.</italic>[<xref ref-type="bibr" rid="B31">31</xref>]. According to this model we write</p>
        <p>
          <disp-formula>
            <mml:math id="M11" name="1471-2105-15-100-i13" overflow="scroll">
              <mml:mrow>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>g</mml:mi>
                <mml:mo stretchy="false">|</mml:mo>
                <mml:mi>a</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfenced open="{">
                  <mml:mrow>
                    <mml:mtable columnalign="left">
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mn>1</mml:mn>
                          <mml:mo>-</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">s</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mtext>if</mml:mtext>
                          <mml:mspace width="0.3em"/>
                          <mml:mi>a</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>g</mml:mi>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">s</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">t</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mtext>if</mml:mtext>
                          <mml:mspace width="0.3em"/>
                          <mml:mi>a</mml:mi>
                          <mml:mo>→</mml:mo>
                          <mml:mi>g</mml:mi>
                          <mml:mspace width="0.3em"/>
                          <mml:mtext>is a transition</mml:mtext>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:mfrac>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">s</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>-</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">t</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mtext>if</mml:mtext>
                          <mml:mspace width="0.3em"/>
                          <mml:mi>a</mml:mi>
                          <mml:mo>→</mml:mo>
                          <mml:mi>g</mml:mi>
                          <mml:mspace width="0.3em"/>
                          <mml:mtext>is a transversion</mml:mtext>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mspace width="1em"/>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>p</italic><sub>s</sub> is the probability of a substitution and <italic>p</italic><sub>t</sub> is the probability of a transition given that a substitution has happened. For mapping <italic>D. melanogaster</italic> reads to the <italic>D. simulans</italic> genome, we used the substitution and transition frequencies observed in the UCSC alignment of the two genomes as given by Frith <italic>et al.</italic>[<xref ref-type="bibr" rid="B31">31</xref>], that is
<inline-formula><mml:math id="M12" name="1471-2105-15-100-i14" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:math></inline-formula> and
<inline-formula><mml:math id="M13" name="1471-2105-15-100-i15" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.45</mml:mn></mml:math></inline-formula>.</p>
      </sec>
    </sec>
    <sec>
      <title>A probabilistic model for biased DNA reads</title>
      <p>In a given data set, we might expect specific biases to affect the frequency with which particular modifications of the DNA sequence occur. This is a well-known phenomenon in many different types of data. If we include a specific model of these biases, we now have three processes that can affect the base called by the sequencer, where the additional process is changing the original base <italic>a</italic> into base <italic>b</italic> due to the type of DNA sample. The independence assumptions for these three processes is expressed by the Bayesian network in Figure
<xref ref-type="fig" rid="F7">7</xref>B.</p>
      <p>Using these assumptions the probability of genomic base <italic>g</italic> given that base <italic>x</italic> is reported by the sequencing machine is (as before)</p>
      <p>
        <disp-formula id="bmcM6">
          <label>(6)</label>
          <mml:math id="M14" name="1471-2105-15-100-i16" overflow="scroll">
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>g</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:munder>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>a</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>b</mml:mi>
              </mml:mrow>
            </mml:munder>
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>g</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>a</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>a</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>b</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>b</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where the term <italic>P</italic>(<italic>a</italic>|<italic>b</italic>) describes the bias. However, in the examples we will describe here, it is more natural to estimate <italic>P</italic>(<italic>b</italic>|<italic>a</italic>). By performing the <italic>a</italic>-sum in equation (6) and using the conditional independence assumptions, we obtain the expression</p>
      <p>
        <disp-formula id="bmcM7">
          <label>(7)</label>
          <mml:math id="M15" name="1471-2105-15-100-i17" overflow="scroll">
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>g</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mo>∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>b</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>g</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>b</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mi>P</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>b</mml:mi>
            <mml:mo stretchy="false">|</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>Using Bayes’ rule and the sum rule we can write the first term in the equation above as</p>
      <p>
        <disp-formula id="bmcM8">
          <label>(8)</label>
          <mml:math id="M16" name="1471-2105-15-100-i18" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mspace width="5.5pt"/>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>g</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>b</mml:mi>
                      <mml:mo stretchy="false">|</mml:mo>
                      <mml:mi>g</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>g</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>′</mml:mo>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>b</mml:mi>
                      <mml:mo stretchy="false">|</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>g</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>′</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>g</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>′</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mspace width="1em"/>
                  <mml:mtext>where</mml:mtext>
                  <mml:mspace width="1em"/>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi>g</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd/>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi mathsize="big">∑</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi>a</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>a</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi>g</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>.</mml:mi>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>Assuming the simple models for evolution <italic>P</italic>(<italic>a</italic>|<italic>g</italic>) and sequencing error <italic>P</italic>(<italic>b</italic>|<italic>x</italic>) from the previous section, all we need in order to calculate <italic>P</italic>(<italic>g</italic>|<italic>x</italic>) is an expression for the bias model <italic>P</italic>(<italic>b</italic>|<italic>a</italic>) and trivially a prior for the genomic base distribution <italic>P</italic>(<italic>g</italic>). In the following sections we will consider two such bias models.</p>
      <sec>
        <title>Ancient DNA model</title>
        <p>In ancient DNA we often observe damage (miscoding lesions), especially C-to-U changes due to deamination, which translate into C-to-T in the sequenced reads (or G-to-A depending on the strand being sequenced). The damage model <italic>P</italic>(<italic>b</italic>|<italic>a</italic>) describing these alterations is as follows. We allow C-to-T and G-to-A changes and the probabilities of these changes depend on the position in the read, with 3’ and 5’ positions having the highest rate of damage. Let <italic>i</italic> denote the position in the read, then we specify the probabilities <italic>p</italic><sub><italic>i</italic></sub>(<italic>b</italic>|<italic>a</italic>) = 0 except for the following cases:</p>
        <p>
          <disp-formula>
            <mml:math id="M17" name="1471-2105-15-100-i19" overflow="scroll">
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>A</mml:mi>
                    <mml:mo stretchy="false">|</mml:mo>
                    <mml:mi>A</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mo stretchy="false">|</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mo stretchy="false">|</mml:mo>
                    <mml:mi>C</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>γ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>C</mml:mi>
                    <mml:mo stretchy="false">|</mml:mo>
                    <mml:mi>C</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>-</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>γ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>A</mml:mi>
                    <mml:mo stretchy="false">|</mml:mo>
                    <mml:mi>G</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>δ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>G</mml:mi>
                    <mml:mo stretchy="false">|</mml:mo>
                    <mml:mi>G</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>-</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>δ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mi>.</mml:mi>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>The actual damage rates, <italic>γ</italic><sub><italic>i</italic></sub> and <italic>δ</italic><sub><italic>i</italic></sub>, are obtained from Orlando <italic>et al.</italic>[<xref ref-type="bibr" rid="B15">15</xref>].</p>
        <p>For ancient DNA, the evolutionary model <italic>P</italic>(<italic>a</italic>|<italic>g</italic>) is obtained by assuming a probability <italic>m</italic><sub>1</sub> for transitions (substitutions between C and T, or between A and G) and a smaller probability <italic>m</italic><sub>2</sub> for transversions (all other substitutions).</p>
      </sec>
      <sec>
        <title>PAR CLIP model</title>
        <p>While ancient DNA has a pattern of alterations where it is mainly bases in the 5’ and 3’ ends of a read that are modified, other types of data exhibit different modifications. PAR-CLIP data, for example, has consistent T-to-C changes. These changes can be handled in the same manner as for ancient DNA damage described above by modifying the conditional probabilities <italic>P</italic>(<italic>b</italic>|<italic>a</italic>) to construct a model <italic>P</italic>(<italic>x</italic>|<italic>g</italic>) incorporating the particular modification pattern.</p>
      </sec>
      <sec>
        <title>Practical calculation of the PSSM</title>
        <p>Once the evolutionary model, the bias model, and the error model have been formulated, <italic>P</italic>(<italic>g</italic>|<italic>x</italic>), and thus the corresponding PSSM scores, can be calculated for all possible combinations of base and quality score (and read position for the damage model). Therefore the conversion of a read with quality scores to a PSSM can be done very fast with a table look-up.</p>
      </sec>
    </sec>
    <sec>
      <title>Including indels in the alignment</title>
      <p>In equation (2) we only considered alignments without indels. If we assume that the indel pattern <bold>a</bold> is independent of the starting position <italic>ℓ</italic> we can write the posterior probability for a match as</p>
      <p>
        <disp-formula>
          <mml:math id="M18" name="1471-2105-15-100-i20" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>ℓ</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi mathvariant="bold">a</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi mathvariant="normal">M</mml:mi>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mi mathvariant="bold">x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi mathvariant="bold">g</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold">g</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi>ℓ</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold">a</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="normal">M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold">a</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="normal">M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>ℓ</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="normal">M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="normal">M</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold">g</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="normal">M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="normal">M</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold">g</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="normal">N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="normal">N</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Again we will assume that all unaligned positions in the genome are i.i.d. with the same distribution in both the match and mismatch model, which means that
<inline-formula><mml:math id="M19" name="1471-2105-15-100-i21" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">g</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>ℓ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">M</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">g</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>. Consequently we can write the posterior probability as</p>
      <p>
        <disp-formula>
          <mml:math id="M20" name="1471-2105-15-100-i22" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>ℓ</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi mathvariant="bold">a</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi mathvariant="normal">M</mml:mi>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mi mathvariant="bold">x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi mathvariant="bold">g</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>S</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="bold">x</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>ℓ</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>log</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi mathvariant="bold">a</mml:mi>
                      <mml:mo stretchy="false">|</mml:mo>
                      <mml:mi>M</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi mathvariant="bold">x</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>ℓ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>′</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>,</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi mathvariant="bold">a</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>′</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="0.3em"/>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>S</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="bold">x</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>ℓ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>′</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>log</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mspace width="0.3em"/>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi mathvariant="bold">a</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>′</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo stretchy="false">|</mml:mo>
                      <mml:mi>M</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi mathvariant="bold">x</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mspace width="0.3em"/>
                  <mml:mo>+</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mi>L</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mspace width="0.3em"/>
                  <mml:mo>-</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="normal">M</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mo stretchy="false">/</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="normal">M</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi mathvariant="bold">x</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>where the sum in the denominator runs over all positions <italic>ℓ</italic><sup>′</sup> in the genome and all possible alignments <bold>a</bold><sup>′</sup> starting at position <italic>ℓ</italic><sup>′</sup>.</p>
      <p>For the indel pattern we will use a linear gap penalty model, which means that the gap lengths follow a geometric distribution
[<xref ref-type="bibr" rid="B46">46</xref>]. If we assume that insertions and deletions happen independently at each position in <bold>x</bold>, we can write the probability of a given alignment in terms of the total number of insertions <italic>a</italic><sub>i</sub> and deletions <italic>a</italic><sub>d</sub> in the sequence</p>
      <p>
        <disp-formula>
          <mml:math id="M21" name="1471-2105-15-100-i23" overflow="scroll">
            <mml:mrow>
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mspace width="5.5pt"/>
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi mathvariant="bold">a</mml:mi>
                    <mml:mo stretchy="false">|</mml:mo>
                    <mml:mi mathvariant="normal">M</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi mathvariant="bold">x</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">d</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">|</mml:mo>
                    <mml:mi mathvariant="normal">M</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi mathvariant="bold">x</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd/>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">|</mml:mo>
                    <mml:mi mathvariant="normal">M</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi mathvariant="bold">x</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">d</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">|</mml:mo>
                    <mml:mi mathvariant="normal">M</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi mathvariant="bold">x</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>∝</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>-</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>a</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ρ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>-</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>a</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">d</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ρ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">d</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>,</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>where
<inline-formula><mml:math id="M22" name="1471-2105-15-100-i24" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></inline-formula> is the probability of an insertion and
<inline-formula><mml:math id="M23" name="1471-2105-15-100-i25" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></inline-formula> is the probability of a deletion. Here <italic>ρ</italic><sub>i</sub> and <italic>ρ</italic><sub>d</sub> are the insertion and deletion penalty log scores, respectively. In practice this is implemented as illustrated in Algorithm 1 and the default value for <italic>ρ</italic><sub>i</sub> and <italic>ρ</italic><sub>d</sub> is 17.</p>
    </sec>
    <sec>
      <title>Other BWA modifications</title>
      <p>In addition to allowing the use of position-specific scoring matrices for alignment, we introduced two other modifications to speed up the alignment method and to allow for the indexing of larger genomes.</p>
      <sec>
        <title>64-Bit indexing</title>
        <p>The existing version of BWA has been modified to use 64-bit indexing by changing the underlying data structures. This modification allows for the sequencing of genomes greater than 4 billion base pairs in length. Due to the limitations of the SAM/BAM format
[<xref ref-type="bibr" rid="B47">47</xref>], however, these genomes must be composed of sub-sequences (i.e. chromosomes) smaller than 4 gigabases each. Using 64-bit indexing leads to an index approximately 32% larger than its 32-bit counterpart.</p>
      </sec>
      <sec>
        <title>Single index</title>
        <p>Traditionally, BWA uses two indexes: One of the forward and one of the reverse of the reference genome. Searches are performed by using the original read and a complemented read and searching the forward index and reverse index with the corresponding read. Combining the forward and reverse indexes into a single structure and searching using only the original read improves the running time by consolidating prefixes common to both the forward and reverse indexes (see Figure
<xref ref-type="fig" rid="F8">8</xref>). Inspired by our work, a single 64-bit index has also been included in the 0.6 release of BWA.</p>
        <fig id="F8" position="float">
          <label>Figure 8</label>
          <caption>
            <p><bold>Comparison of the original BWA alignment method (top) and the modified version using a single index (bottom).</bold> The sequence of the short read, ‘TAC’, on the ‘-’ strand can easily be found by subtracting the length of the original sequence from its position in the concatenated sequence.</p>
          </caption>
          <graphic xlink:href="1471-2105-15-100-8"/>
        </fig>
      </sec>
      <sec>
        <title>Heap sorting for partial hits</title>
        <p>In BWA, the best partial candidate hits are kept sorted by a score computed as a function of the mismatches, insertions and deletions in a heap-like structure. BWA-PSSM, in contrast, uses the offset from the best possible score at a particular position as the sorting criterion (Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S1). If the score of an alignment candidate (partial-hit) drops due to mismatches or insertions/deletions, it moves down the list. While BWA abandons the search when the size of the heap is exceeded, BWA-PSSM continues searching while discarding the partial hits with the lowest PSSM score offset. This is made possible by the use of an interval-heap data structure, allowing for the rapid removal, <italic>Θ</italic>(log n), of either the largest or smallest element
[<xref ref-type="bibr" rid="B48">48</xref>].</p>
        <p>The traditional breadth-first search of the prefix tree employed by BWA is further modified such that each branch is weighted according to the decrease from the optimal PSSM score for that character. That is, the branch corresponding to a perfectly matched base would have a weight corresponding to 0 since it will contain the best possible score (see Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S1). A mismatch branch, however, would have a lower score due to the use of a sub-optimal PSSM score. The use of score offsets corresponds to a breadth-first traversal of the suffix tree whereas using the total PSSM score itself corresponds to a depth-first traversal.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Availability</title>
    <p>BWA-PSSM and its source code are freely available through the website
<ext-link ext-link-type="uri" xlink:href="http://bwa-pssm.binf.ku.dk">http://bwa-pssm.binf.ku.dk</ext-link>.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>PK and AK developed the method and algorithms. JF and SL contributed to discussions on the method and algorithms. PK developed the software. PK, JF, SL, and AK designed the experiments and analysis. PK and JF performed the experiments and analysis. PK, JF, SL and AK wrote the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p>Supplementary material.</p>
      </caption>
      <media xlink:href="1471-2105-15-100-S1.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>The authors would like thank Simon Rasmussen and Mireya Plass for providing the error model used for the PAR-CLIP data as well as valuable feedback and bug reports. This work was supported by the Novo Nordisk Foundation, the Danish National Research Foundation, and the Danish Council for Strategic Research. PK would like to thank Novo Nordisk and Novozymes for funding via the Novo Scholarship Program. JF is supported by an individual postdoc grant from the Danish Council for Independent Research | Natural Sciences. SL is supported by a Marie Curie International Outgoing Fellowship within the 7th European Community Framework Programme.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Metzker</surname>
          <given-names>ML</given-names>
        </name>
        <article-title>Sequencing technologies - the next generation</article-title>
        <source>Nat Rev Genet</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>31</fpage>
        <lpage>46</lpage>
        <comment>doi:10.1038/nrg2626</comment>
        <pub-id pub-id-type="doi">10.1038/nrg2626</pub-id>
        <?supplied-pmid 19997069?>
        <pub-id pub-id-type="pmid">19997069</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Tian</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Goodman</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Fan</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Guo</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Feng</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Lu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Fang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Liang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Du</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Hu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Zheng</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Hellmann</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Inouye</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Pool</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Yi</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Duan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zhou</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Qin</surname>
          <given-names>J</given-names>
        </name>
        <etal/>
        <article-title>The diploid genome sequence of an Asian individual</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>60</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07484</pub-id>
        <?supplied-pmid 18987735?>
        <pub-id pub-id-type="pmid">18987735</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wheeler</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Srinivasan</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Egholm</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Shen</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>McGuire</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>He</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>YJ</given-names>
        </name>
        <name>
          <surname>Makhijani</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Roth</surname>
          <given-names>GT</given-names>
        </name>
        <name>
          <surname>Gomes</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Tartaro</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Niazi</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Turcotte</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Irzyk</surname>
          <given-names>GP</given-names>
        </name>
        <name>
          <surname>Lupski</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Chinault</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Song</surname>
          <given-names>XZ</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Yuan</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Nazareth</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Qin</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Muzny</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Margulies</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Weinstock</surname>
          <given-names>GM</given-names>
        </name>
        <name>
          <surname>Gibbs</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Rothberg</surname>
          <given-names>JM</given-names>
        </name>
        <article-title>The complete genome of an individual by massively parallel DNA sequencing</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>452</volume>
        <issue>7189</issue>
        <fpage>872</fpage>
        <lpage>876</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06884</pub-id>
        <?supplied-pmid 18421352?>
        <pub-id pub-id-type="pmid">18421352</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kitzman</surname>
          <given-names>JO</given-names>
        </name>
        <name>
          <surname>Mackenzie</surname>
          <given-names>AP</given-names>
        </name>
        <name>
          <surname>Adey</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Hiatt</surname>
          <given-names>JB</given-names>
        </name>
        <name>
          <surname>Patwardhan</surname>
          <given-names>RP</given-names>
        </name>
        <name>
          <surname>Sudmant</surname>
          <given-names>PH</given-names>
        </name>
        <name>
          <surname>Ng</surname>
          <given-names>SB</given-names>
        </name>
        <name>
          <surname>Alkan</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Qiu</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Eichler</surname>
          <given-names>EE</given-names>
        </name>
        <name>
          <surname>Shendure</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Haplotype-resolved genome sequencing of a Gujarati Indian individual</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>59</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1740</pub-id>
        <?supplied-pmid 21170042?>
        <pub-id pub-id-type="pmid">21170042</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pan</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Shai</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>LJ</given-names>
        </name>
        <name>
          <surname>Frey</surname>
          <given-names>BJ</given-names>
        </name>
        <name>
          <surname>Blencowe</surname>
          <given-names>BJ</given-names>
        </name>
        <article-title>Deep surveying of alternative splicing complexity in the human transcriptome by high-throughput sequencing</article-title>
        <source>Nat Genet</source>
        <year>2008</year>
        <volume>40</volume>
        <issue>12</issue>
        <fpage>1413</fpage>
        <lpage>1415</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.259</pub-id>
        <?supplied-pmid 18978789?>
        <pub-id pub-id-type="pmid">18978789</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cloonan</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Grimmond</surname>
          <given-names>SM</given-names>
        </name>
        <article-title>Transcriptome content and dynamics at single-nucleotide resolution</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>9</issue>
        <fpage>234</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-9-234</pub-id>
        <?supplied-pmid 18828881?>
        <pub-id pub-id-type="pmid">18828881</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Levin</surname>
          <given-names>JZ</given-names>
        </name>
        <name>
          <surname>Berger</surname>
          <given-names>MF</given-names>
        </name>
        <name>
          <surname>Adiconis</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Rogov</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Melnikov</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fennell</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Nusbaum</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Garraway</surname>
          <given-names>LA</given-names>
        </name>
        <name>
          <surname>Gnirke</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Targeted next-generation sequencing of a cancer transcriptome enhances detection of sequence variants and novel fusion transcripts</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>10</issue>
        <fpage>115</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-10-r115</pub-id>
        <?supplied-pmid 20109167?>
        <pub-id pub-id-type="pmid">20109167</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Adams</surname>
          <given-names>IP</given-names>
        </name>
        <name>
          <surname>Glover</surname>
          <given-names>RH</given-names>
        </name>
        <name>
          <surname>Monger</surname>
          <given-names>WA</given-names>
        </name>
        <name>
          <surname>Mumford</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Jackeviciene</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Navalinskiene</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Samuitiene</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Boonham</surname>
          <given-names>N</given-names>
        </name>
        <article-title>Next-generation sequencing and metagenomic analysis: a universal diagnostic tool in plant virology</article-title>
        <source>Mol Plant Pathol</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>4</issue>
        <fpage>537</fpage>
        <lpage>545</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1364-3703.2009.00545.x</pub-id>
        <?supplied-pmid 19523106?>
        <pub-id pub-id-type="pmid">19523106</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Petrosino</surname>
          <given-names>JF</given-names>
        </name>
        <name>
          <surname>Highlander</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Luna</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Gibbs</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Versalovic</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Metagenomic pyrosequencing and microbial identification</article-title>
        <source>Clin Chem</source>
        <year>2009</year>
        <volume>55</volume>
        <issue>5</issue>
        <fpage>856</fpage>
        <lpage>866</lpage>
        <pub-id pub-id-type="doi">10.1373/clinchem.2008.107565</pub-id>
        <?supplied-pmid 19264858?>
        <pub-id pub-id-type="pmid">19264858</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="other">
        <name>
          <surname>Simon</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Wiezer</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Strittmatter</surname>
          <given-names>AW</given-names>
        </name>
        <name>
          <surname>Daniel</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Phylogenetic diversity and metabolic potential revealed in a glacier ice metagenome</article-title>
        <source>Appl Environ Microbiol</source>
        <volume>75</volume>
        <issue>23</issue>
        <fpage>7519</fpage>
        <lpage>7526</lpage>
        <pub-id pub-id-type="pmid">19801459</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Green</surname>
          <given-names>RE</given-names>
        </name>
        <name>
          <surname>Krause</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Ptak</surname>
          <given-names>SE</given-names>
        </name>
        <name>
          <surname>Briggs</surname>
          <given-names>AW</given-names>
        </name>
        <name>
          <surname>Ronan</surname>
          <given-names>MT</given-names>
        </name>
        <name>
          <surname>Simons</surname>
          <given-names>JF</given-names>
        </name>
        <name>
          <surname>Du</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Egholm</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Rothberg</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Paunovic</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Paabo</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Analysis of one million base pairs of Neanderthal DNA</article-title>
        <source>Nature</source>
        <year>2006</year>
        <volume>444</volume>
        <fpage>330</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="doi">10.1038/nature05336</pub-id>
        <?supplied-pmid 17108958?>
        <pub-id pub-id-type="pmid">17108958</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Miller</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Drautz</surname>
          <given-names>DI</given-names>
        </name>
        <name>
          <surname>Ratan</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Pusey</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Qi</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Lesk</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Tomsho</surname>
          <given-names>LP</given-names>
        </name>
        <name>
          <surname>Packard</surname>
          <given-names>MD</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Sher</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Tikhonov</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Raney</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Patterson</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Lindblad-Toh</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Lander</surname>
          <given-names>ES</given-names>
        </name>
        <name>
          <surname>Knight</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Irzyk</surname>
          <given-names>GP</given-names>
        </name>
        <name>
          <surname>Fredrikson</surname>
          <given-names>KM</given-names>
        </name>
        <name>
          <surname>Harkins</surname>
          <given-names>TT</given-names>
        </name>
        <name>
          <surname>Sheridan</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Pringle</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Schuster</surname>
          <given-names>SC</given-names>
        </name>
        <article-title>Sequencing the nuclear genome of the extinct woolly mammoth</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>387</fpage>
        <lpage>390</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07446</pub-id>
        <?supplied-pmid 19020620?>
        <pub-id pub-id-type="pmid">19020620</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rasmussen</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Lindgreen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Pedersen</surname>
          <given-names>JS</given-names>
        </name>
        <name>
          <surname>Albrechtsen</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Moltke</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Metspalu</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Metspalu</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Kivisild</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Gupta</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Bertalan</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Nielsen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Gilbert</surname>
          <given-names>MT</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Raghavan</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Campos</surname>
          <given-names>PF</given-names>
        </name>
        <name>
          <surname>Kamp</surname>
          <given-names>HM</given-names>
        </name>
        <name>
          <surname>Wilson</surname>
          <given-names>AS</given-names>
        </name>
        <name>
          <surname>Gledhill</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Tridico</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Bunce</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lorenzen</surname>
          <given-names>ED</given-names>
        </name>
        <name>
          <surname>Binladen</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Guo</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Orlando</surname>
          <given-names>L</given-names>
        </name>
        <etal/>
        <article-title>Ancient human genome sequence of an extinct Palaeo-Eskimo</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>463</volume>
        <fpage>757</fpage>
        <lpage>762</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08835</pub-id>
        <?supplied-pmid 20148029?>
        <pub-id pub-id-type="pmid">20148029</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rasmussen</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Guo</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Lohmueller</surname>
          <given-names>KE</given-names>
        </name>
        <name>
          <surname>Rasmussen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Albrechtsen</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Skotte</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Lindgreen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Metspalu</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Jombart</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Kivisild</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Zhai</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Eriksson</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Manica</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Orlando</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>De La Vega</surname>
          <given-names>FM</given-names>
        </name>
        <name>
          <surname>Tridico</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Metspalu</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Nielsen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Avila-Arcos</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Moreno-Mayar</surname>
          <given-names>JV</given-names>
        </name>
        <name>
          <surname>Muller</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Dortch</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Gilbert</surname>
          <given-names>MT</given-names>
        </name>
        <name>
          <surname>Lund</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Wesolowska</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Karmin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Weinert</surname>
          <given-names>LA</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>J</given-names>
        </name>
        <etal/>
        <article-title>An Aboriginal Australian genome reveals separate human dispersals into Asia</article-title>
        <source>Science</source>
        <year>2011</year>
        <volume>334</volume>
        <fpage>94</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1211177</pub-id>
        <?supplied-pmid 21940856?>
        <pub-id pub-id-type="pmid">21940856</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Orlando</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Ginolhac</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Raghavan</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Vilstrup</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Rasmussen</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Magnussen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Steinmann</surname>
          <given-names>KE</given-names>
        </name>
        <name>
          <surname>Kapranov</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Thompson</surname>
          <given-names>JF</given-names>
        </name>
        <name>
          <surname>Zazula</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Froese</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Moltke</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Shapiro</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Hofreiter</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Al-Rasheid</surname>
          <given-names>KAS</given-names>
        </name>
        <name>
          <surname>Gilbert</surname>
          <given-names>MTP</given-names>
        </name>
        <name>
          <surname>Willerslev</surname>
          <given-names>E</given-names>
        </name>
        <article-title>True single-molecule DNA sequencing of a pleistocene horse bone</article-title>
        <source>Genome Res</source>
        <year>2011</year>
        <volume>21</volume>
        <issue>10</issue>
        <fpage>1705</fpage>
        <lpage>1719</lpage>
        <comment>doi:10.1101/gr.122747.111</comment>
        <pub-id pub-id-type="doi">10.1101/gr.122747.111</pub-id>
        <?supplied-pmid 21803858?>
        <pub-id pub-id-type="pmid">21803858</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schubert</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Ginolhac</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Lindgreen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Thompson</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>AL-Rasheid</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Willerslev</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Krogh</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Orlando</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Improving ancient dna read mapping against modern reference genomes</article-title>
        <source>BMC Genomics</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>178</fpage>
        <comment>doi:10.1186/1471-2164-13-178</comment>
        <pub-id pub-id-type="doi">10.1186/1471-2164-13-178</pub-id>
        <?supplied-pmid 22574660?>
        <pub-id pub-id-type="pmid">22574660</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="other">
        <name>
          <surname>Hamada</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Wijaya</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Frith</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Asai</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Probabilistic alignments with quality scores: an application to short-read mapping toward accurate SNP/indel detection</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <comment>doi:10.1093/bioinformatics/btr537</comment>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Ruan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <issue>11</issue>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <comment>doi:10.1101/gr.078212.108</comment>
        <pub-id pub-id-type="doi">10.1101/gr.078212.108</pub-id>
        <?supplied-pmid 18714091?>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Kristiansen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <article-title>SOAP: short oligonucleotide alignment program</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>5</issue>
        <fpage>713</fpage>
        <lpage>714</lpage>
        <comment>doi:10.1093/bioinformatics/btn025</comment>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn025</pub-id>
        <?supplied-pmid 18227114?>
        <pub-id pub-id-type="pmid">18227114</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="other">
        <name>
          <surname>Burrows</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Wheeler</surname>
          <given-names>D</given-names>
        </name>
        <article-title>A block sorting lossless data compression algorithm</article-title>
        <comment>Technical Report 124, Digital Equipment Corporation. 1994</comment>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Langmead</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Trapnell</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Pop</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>25</fpage>
        <comment>doi:10.1186/gb-2009-10-3-r25</comment>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Langmead</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>SL</given-names>
        </name>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>4</issue>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <comment>doi:10.1038/nmeth.1923</comment>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <?supplied-pmid 22388286?>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Lam</surname>
          <given-names>T-WW</given-names>
        </name>
        <name>
          <surname>Yiu</surname>
          <given-names>S-MM</given-names>
        </name>
        <name>
          <surname>Kristiansen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <article-title>SOAP2: an improved ultrafast tool for short read alignment</article-title>
        <source>Bioinformatics (Oxford England)</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>15</issue>
        <fpage>1966</fpage>
        <lpage>1967</lpage>
        <comment>doi:10.1093/bioinformatics/btp336</comment>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp336</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>14</issue>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <comment>doi:10.1093/bioinformatics/btp324</comment>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="other">
        <name>
          <surname>Hoffmann</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Otto</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Kurtz</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Sharma</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Khaitovich</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Vogel</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Stadler</surname>
          <given-names>PF</given-names>
        </name>
        <name>
          <surname>Hackermüller</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Fast mapping of short sequences with mismatches, insertions and deletions using index structures</article-title>
        <source>PLoS Comput Biol</source>
        <volume>5</volume>
        <issue>9</issue>
        <fpage>1000502</fpage>
        <comment>doi:10.1371/journal.pcbi.1000502</comment>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Liu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Schmidt</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Maskell</surname>
          <given-names>DL</given-names>
        </name>
        <article-title>CUSHAW: a CUDA compatible short read aligner to large genomes based on the burrows–wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>14</issue>
        <fpage>1830</fpage>
        <lpage>1837</lpage>
        <comment>doi:10.1093/bioinformatics/bts276</comment>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts276</pub-id>
        <?supplied-pmid 22576173?>
        <pub-id pub-id-type="pmid">22576173</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="other">
        <name>
          <surname>Liu</surname>
          <given-names>C-M</given-names>
        </name>
        <name>
          <surname>Wong</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Luo</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Yiu</surname>
          <given-names>S-M</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Chu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Lam</surname>
          <given-names>T-W</given-names>
        </name>
        <article-title>SOAP3: Ultra-fast GPU-based parallel alignment tool for short reads</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <comment>doi:10.1093/bioinformatics/bts061</comment>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nakamura</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Oshima</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Morimoto</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ikeda</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Yoshikawa</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Shiwa</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Ishikawa</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Linak</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Hirai</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Takahashi</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Altaf-Ul-Amin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Ogasawara</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Kanaya</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Sequence-specific error profile of Illumina sequencers</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <issue>13</issue>
        <fpage>90</fpage>
        <comment>doi:10.1093/nar/gkr344</comment>
        <pub-id pub-id-type="doi">10.1093/nar/gkr344</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Siragusa</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Weese</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Reinert</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Fast and accurate read mapping with approximate seeds and multiple backtracking</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>7</issue>
        <fpage>78</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt005</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Marco-Sola</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Sammeth</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Guigo</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Ribeca</surname>
          <given-names>P</given-names>
        </name>
        <article-title>The GEM mapper: fast, accurate and versatile alignment by filtration</article-title>
        <source>Nat Meth</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>12</issue>
        <fpage>1185</fpage>
        <lpage>1188</lpage>
        <comment>doi:10.1038/nmeth.2221</comment>
        <pub-id pub-id-type="doi">10.1038/nmeth.2221</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Frith</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Wan</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Horton</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Incorporating sequence quality data into alignment improves DNA read mapping</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>7</issue>
        <fpage>100</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq010</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kishore</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Jaskiewicz</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Burger</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Hausser</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Khorshid</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Zavolan</surname>
          <given-names>M</given-names>
        </name>
        <article-title>A quantitative analysis of CLIP methods for identifying binding sites of RNA-binding proteins</article-title>
        <source>Nat Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <issue>7</issue>
        <fpage>559</fpage>
        <lpage>564</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1608</pub-id>
        <?supplied-pmid 21572407?>
        <pub-id pub-id-type="pmid">21572407</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gardner</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Hall</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Fung</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>White</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Berriman</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hyman</surname>
          <given-names>RW</given-names>
        </name>
        <name>
          <surname>Carlton</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Pain</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Nelson</surname>
          <given-names>KE</given-names>
        </name>
        <name>
          <surname>Bowman</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Paulsen</surname>
          <given-names>IT</given-names>
        </name>
        <name>
          <surname>James</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Eisen</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Rutherford</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>SL</given-names>
        </name>
        <name>
          <surname>Craig</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Kyes</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Chan</surname>
          <given-names>MS</given-names>
        </name>
        <name>
          <surname>Nene</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Shallom</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Suh</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Peterson</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Angiuoli</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Pertea</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Allen</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Selengut</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Haft</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Mather</surname>
          <given-names>MW</given-names>
        </name>
        <name>
          <surname>Vaidya</surname>
          <given-names>AB</given-names>
        </name>
        <name>
          <surname>Martin</surname>
          <given-names>DM</given-names>
        </name>
        <etal/>
        <article-title>Genome sequence of the human malaria parasite Plasmodium falciparum</article-title>
        <source>Nature</source>
        <year>2002</year>
        <volume>419</volume>
        <issue>6906</issue>
        <fpage>498</fpage>
        <lpage>511</lpage>
        <pub-id pub-id-type="doi">10.1038/nature01097</pub-id>
        <?supplied-pmid 12368864?>
        <pub-id pub-id-type="pmid">12368864</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ewing</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Green</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Base-calling of automated sequencer traces using phred. II Error probabilities</article-title>
        <source>Genome Res</source>
        <year>1998</year>
        <volume>8</volume>
        <fpage>186</fpage>
        <lpage>194</lpage>
        <?supplied-pmid 9521922?>
        <pub-id pub-id-type="pmid">9521922</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Beckstette</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Homann</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Giegerich</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Kurtz</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Fast index based algorithms and software for matching position specific scoring matrices</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>389</fpage>
        <comment>doi:10.1186/1471-2105-7-389</comment>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-389</pub-id>
        <?supplied-pmid 16930469?>
        <pub-id pub-id-type="pmid">16930469</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="other">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title>
        <comment>ArXiv e-prints. 2013, 1303.3997</comment>
      </mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Huang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>GT</given-names>
        </name>
        <article-title>ART: a next-generation sequencing read simulator</article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>594</lpage>
        <comment>doi:10.1093/bioinformatics/btr708</comment>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="other">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <article-title>wgsim - Read simulator for next generation sequencing</article-title>
        <year>2011</year>
        <comment>[
<ext-link ext-link-type="uri" xlink:href="http://github.com/lh3/wgsim">http://github.com/lh3/wgsim</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="other">
        <name>
          <surname>Holtgrewe</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Mason–a read simulator for second generation sequencing data</article-title>
        <comment>Technical Report FU Berlin. 2010</comment>
      </mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Willerslev</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Cooper</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Review paper. ancient dna</article-title>
        <source>Proc R Soc B: Biol Sci</source>
        <year>2005</year>
        <volume>272</volume>
        <issue>1558</issue>
        <fpage>3</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1098/rspb.2004.2813</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hafner</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Landthaler</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Burger</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Khorshid</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hausser</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Berninger</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Rothballer</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Ascano Jr</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Jungkamp</surname>
          <given-names>AC</given-names>
        </name>
        <name>
          <surname>Munschauer</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Ulrich</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wardle</surname>
          <given-names>GS</given-names>
        </name>
        <name>
          <surname>Dewell</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Zavolan</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Tuschl</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Transcriptome-wide identification of rna-binding protein and microrna target sites by par-clip</article-title>
        <source>Cell</source>
        <year>2010</year>
        <volume>141</volume>
        <issue>1</issue>
        <fpage>129</fpage>
        <lpage>141</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2010.03.009</pub-id>
        <?supplied-pmid 20371350?>
        <pub-id pub-id-type="pmid">20371350</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kishore</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Jaskiewicz</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Burger</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Hausser</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Khorshid</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Zavolan</surname>
          <given-names>M</given-names>
        </name>
        <article-title>A quantitative analysis of clip methods for identifying binding sites of rna-binding proteins</article-title>
        <source>Nat Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <issue>7</issue>
        <fpage>559</fpage>
        <lpage>564</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1608</pub-id>
        <?supplied-pmid 21572407?>
        <pub-id pub-id-type="pmid">21572407</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Huang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>G</given-names>
        </name>
        <article-title>ART: a next-generation sequencing read simulator</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>593</fpage>
        <lpage>4</lpage>
        <comment>doi:10.1093/bioinformatics/btr708</comment>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id>
        <?supplied-pmid 22199392?>
        <pub-id pub-id-type="pmid">22199392</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Blattner</surname>
          <given-names>FR</given-names>
        </name>
        <name>
          <surname>Plunkett</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Bloch</surname>
          <given-names>CA</given-names>
        </name>
        <name>
          <surname>Perna</surname>
          <given-names>NT</given-names>
        </name>
        <name>
          <surname>Burland</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Riley</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Collado-Vides</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Glasner</surname>
          <given-names>JD</given-names>
        </name>
        <name>
          <surname>Rode</surname>
          <given-names>CK</given-names>
        </name>
        <name>
          <surname>Mayhew</surname>
          <given-names>GF</given-names>
        </name>
        <name>
          <surname>Gregor</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Davis</surname>
          <given-names>NW</given-names>
        </name>
        <name>
          <surname>Kirkpatrick</surname>
          <given-names>HA</given-names>
        </name>
        <name>
          <surname>Goeden</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Rose</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Mau</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Shao</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>The complete genome sequence of escherichia coli k-12</article-title>
        <source>Science</source>
        <year>1997</year>
        <volume>277</volume>
        <issue>5331</issue>
        <fpage>1453</fpage>
        <lpage>1462</lpage>
        <pub-id pub-id-type="doi">10.1126/science.277.5331.1453</pub-id>
        <?supplied-pmid 9278503?>
        <pub-id pub-id-type="pmid">9278503</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lindgreen</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Adapterremoval: Easy cleaning of next generation sequencing reads</article-title>
        <source>BMC Res Notes</source>
        <year>2012</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>337</fpage>
        <pub-id pub-id-type="doi">10.1186/1756-0500-5-337</pub-id>
        <?supplied-pmid 22748135?>
        <pub-id pub-id-type="pmid">22748135</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B46">
      <mixed-citation publication-type="book">
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Eddy</surname>
          <given-names>SR</given-names>
        </name>
        <name>
          <surname>Krogh</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Mitchison</surname>
          <given-names>G</given-names>
        </name>
        <source>Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids</source>
        <year>1998</year>
        <publisher-name>Cambridge: Cambridge University Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B47">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Handsaker</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Wysoker</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fennell</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ruan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Homer</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Abecasis</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B48">
      <mixed-citation publication-type="journal">
        <name>
          <surname>van Leeuwen</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wood</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Interval heaps</article-title>
        <source>Comput J</source>
        <year>1993</year>
        <volume>36</volume>
        <issue>3</issue>
        <fpage>209</fpage>
        <lpage>216</lpage>
        <comment>doi:10.1093/comjnl/36.3.209</comment>
        <pub-id pub-id-type="doi">10.1093/comjnl/36.3.209</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
