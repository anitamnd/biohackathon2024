<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5619791</article-id>
    <article-id pub-id-type="pmid">28957408</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-17-20268</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0185528</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Infectious Diseases</subject>
          <subj-group>
            <subject>Viral Diseases</subject>
            <subj-group>
              <subject>Measles</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Infectious Diseases</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Epidemiology</subject>
          <subj-group>
            <subject>Disease Dynamics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Mathematical and statistical techniques</subject>
          <subj-group>
            <subject>Statistical methods</subject>
            <subj-group>
              <subject>Monte Carlo method</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics (mathematics)</subject>
            <subj-group>
              <subject>Statistical methods</subject>
              <subj-group>
                <subject>Monte Carlo method</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Pathology and Laboratory Medicine</subject>
          <subj-group>
            <subject>Pathogens</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Pediatrics</subject>
          <subj-group>
            <subject>Pediatric Infections</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>tsiR: An R package for time-series Susceptible-Infected-Recovered models of epidemics</article-title>
      <alt-title alt-title-type="running-head">tsiR: An R package for time-series Susceptible-Infected-Recovered models of epidemics</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6524-0513</contrib-id>
        <name>
          <surname>Becker</surname>
          <given-names>Alexander D.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grenfell</surname>
          <given-names>Bryan T.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Ecology and Evolutionary Biology, Princeton University, Princeton, NJ, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Woodrow Wilson School of Public and International Affairs, Princeton University, Princeton, NJ, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Fogarty International Center, National Institutes of Health, Bethesda, MD, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Nishiura</surname>
          <given-names>Hiroshi</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Hokkaido University Graduate School of Medicine, JAPAN</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>adbecker@princeton.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <volume>12</volume>
    <issue>9</issue>
    <elocation-id>e0185528</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>5</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>9</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2017 Becker, Grenfell</copyright-statement>
      <copyright-year>2017</copyright-year>
      <copyright-holder>Becker, Grenfell</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0185528.pdf"/>
    <abstract>
      <p><bold>tsiR</bold> is an open source software package implemented in the R programming language designed to analyze infectious disease time-series data. The software extends a well-studied and widely-applied algorithm, the time-series Susceptible-Infected-Recovered (TSIR) model, to infer parameters from incidence data, such as contact seasonality, and to forward simulate the underlying mechanistic model. The <bold>tsiR</bold> package aggregates a number of different fitting features previously described in the literature in a user-friendly way, providing support for their broader adoption in infectious disease research. Also included in <bold>tsiR</bold> are a number of diagnostic tools to assess the fit of the TSIR model. This package should be useful for researchers analyzing incidence data for fully-immunizing infectious diseases.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>Bill and Melinda Gates Foundation (US)</institution>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Grenfell</surname>
            <given-names>Bryan T.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>National Institutes of Health (US)</institution>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Grenfell</surname>
            <given-names>Bryan T.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>U.S. Department of Defense (US)</institution>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Grenfell</surname>
            <given-names>Bryan T.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6524-0513</contrib-id>
          <name>
            <surname>Becker</surname>
            <given-names>Alexander D.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>A.D.B. was supported by a National Science Foundation Graduate Research Fellowship and the Center for Health and Wellbeing at Princeton University. B.T.G. was supported by the Research and Policy for Infectious Disease Dynamics program of the Science and Technology Directorate, Department of Homeland Security, the Fogarty International Center, National Institutes of Health, the Bill and Melinda Gates Foundation, and the U.S. Centers for Disease Control and Prevention.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="1"/>
      <page-count count="10"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the paper and its Supporting Information files.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Mathematical models coupled with statistical inference techniques allow us to compare infectious disease theory and data, shedding light on transmission estimates, vaccine control strategies, and predicting future trends [<xref rid="pone.0185528.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0185528.ref002" ref-type="bibr">2</xref>]. These models (and inference methods) cover a spectrum from very simple (based on well-mixed, population-level assumptions) to highly complex representations (in which individual variation is modeled explicitly) [<xref rid="pone.0185528.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0185528.ref003" ref-type="bibr">3</xref>]. Even the simplest of such non-linear models can display very rich, elaborate, and potentially chaotic, dynamics [<xref rid="pone.0185528.ref004" ref-type="bibr">4</xref>–<xref rid="pone.0185528.ref006" ref-type="bibr">6</xref>].</p>
    <p>One of the simplest and most powerful of epidemic models is the family of mass-action formulations based on the Susceptible-Infected-Recovered (SIR) equations [<xref rid="pone.0185528.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0185528.ref007" ref-type="bibr">7</xref>]. The SIR model assumes a well-mixed population, and in the most basic form balances demographic processes (e.g., births, <italic>B</italic>, and deaths, <italic>μ</italic>) with infectious disease specific properties such as contact rate, <italic>β</italic>, and infectious period, inverse <italic>γ</italic>, for a single pathogen. In general, and especially for the prototypical example, measles, the transmission coefficient, <italic>β</italic>, varies seasonally. The deterministic skeleton of the SIR model is shown in <xref ref-type="disp-formula" rid="pone.0185528.e002">Eq 1</xref>; λ is the force of infection, typically defined as <inline-formula id="pone.0185528.e001"><alternatives><graphic xlink:href="pone.0185528.e001.jpg" id="pone.0185528.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mi>I</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula>. In addition, this model requires that immunity post-infection is life-long, although this assumption can be relaxed via a Susceptible-Infected-Recovered-Susceptible (SIRS) model.
<disp-formula id="pone.0185528.e002"><alternatives><graphic xlink:href="pone.0185528.e002.jpg" id="pone.0185528.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>λ</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>λ</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula></p>
    <p>Despite its simplicity, calibrating the seasonally-forced SIR model against time-series data is a difficult mathematical and statistical problem, as evidenced by the extensive literature on this subject [<xref rid="pone.0185528.ref008" ref-type="bibr">8</xref>–<xref rid="pone.0185528.ref013" ref-type="bibr">13</xref>]. The desired outcome of SIR model inference is to extract parameter estimates from a given epidemic time-series for key values such seasonal variation. In terms of the data, fitting SIR-type models is a non-trivial inferential challenge for a number of reasons. First, only one state variable—the number of cases over time—is observed. Second, there is generally substantial under-reporting of disease incidence. Adding additional complexity is the fact that the model is a continuous-time process, whereas the data are generally collected on a weekly or monthly basis. While statistically robust and powerful methods (e.g., filtering based algorithms) are readily available in packages such as <bold>pomp</bold> [<xref rid="pone.0185528.ref014" ref-type="bibr">14</xref>], they may be slow to converge and may not be suitable for analyzing many (100+) time-series.
<disp-formula id="pone.0185528.e003"><alternatives><graphic xlink:href="pone.0185528.e003.jpg" id="pone.0185528.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msubsup><mml:mi>I</mml:mi><mml:mi>t</mml:mi><mml:mi>α</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula></p>
    <p>An alternative, computationally inexpensive, and highly tractable approach to these problems is provided by the time-series SIR model (TSIR model), shown in <xref ref-type="disp-formula" rid="pone.0185528.e003">Eq 2</xref> [<xref rid="pone.0185528.ref008" ref-type="bibr">8</xref>]. The TSIR model relies on two main assumptions: first, that the infectious period is fixed at the sampling interval of the data (e.g., bi-weekly for measles) and that over a long enough time (e.g., 10-20 years), the sum of births and cases should be approximately equal due to the high infectivity of pathogens such as measles and other childhood infections, in the pre-vaccine era. A full description of the TSIR model and algorithm can be found in [<xref rid="pone.0185528.ref008" ref-type="bibr">8</xref>]. A brief qualitative description of the algorithm follows in order to provide context for the subsequent development of the <bold>tsiR</bold> package.</p>
    <p>In the TSIR framework, a regression model is first fitted between cumulative cases and cumulative births. Assuming they are equal, the slope will be the reporting rate <italic>ρ</italic><sub><italic>t</italic></sub> and the residuals of the regression model, <italic>Z</italic><sub><italic>t</italic></sub> provide the shape of the susceptible dynamics, <italic>S</italic><sub><italic>t</italic></sub>. Next, using <xref ref-type="disp-formula" rid="pone.0185528.e003">Eq 2</xref> and setting the expectation to the mean, the log-linear equation shown in <xref ref-type="disp-formula" rid="pone.0185528.e005">Eq 3</xref> can be acquired. The mean number of susceptible individuals across the time-series, <inline-formula id="pone.0185528.e004"><alternatives><graphic xlink:href="pone.0185528.e004.jpg" id="pone.0185528.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, can be inferred using profile likelihood and a seasonally repeating contact rate (52 divided by the infectious period time points, e.g., 26 for measles); <italic>β</italic><sub><italic>t</italic></sub>, can then be estimated along with a homogeneity parameter <italic>α</italic> using a generalized linear model (GLM). The parameter <italic>α</italic> describes the epidemic saturation as well as a correction factor for switching from continuous to discrete time [<xref rid="pone.0185528.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0185528.ref016" ref-type="bibr">16</xref>]
<disp-formula id="pone.0185528.e005"><alternatives><graphic xlink:href="pone.0185528.e005.jpg" id="pone.0185528.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo form="prefix">log</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo form="prefix">log</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo form="prefix">log</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo form="prefix">log</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
    <p>The TSIR method has been used very successfully to analyze a number of childhood infections such as measles, whooping cough, diphtheria, mumps, varicella, and scarlet fever, as well as multi-strain pathogens such as dengue. [<xref rid="pone.0185528.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0185528.ref008" ref-type="bibr">8</xref>, <xref rid="pone.0185528.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0185528.ref017" ref-type="bibr">17</xref>–<xref rid="pone.0185528.ref020" ref-type="bibr">20</xref>]. Analysis of this model has shown both birth rate and school-term forcing to be central drivers of the pattern of epidemics and periodicity, as well as improving our ability to predict infectious disease dynamics further into the future in both small and large populations ranging from London to Iceland [<xref rid="pone.0185528.ref008" ref-type="bibr">8</xref>, <xref rid="pone.0185528.ref012" ref-type="bibr">12</xref>].</p>
    <p>Although the underlying model is simple, the TSIR approach provides a number of different fitting options. When reconstructing the susceptible dynamics, options range from a simple linear regression fit between cumulative cases and cumulative births, to more sophisticated approaches such as Gaussian regressions. These choices, and which variable is the dependent variable in each case, also impact both whether the reporting rate <italic>ρ</italic><sub><italic>t</italic></sub> is time-invariant as well as how the residuals of the regression are calculated. Once the susceptible dynamics are reconstructed, the modeler is again faced with many more choices about the log-linear model, the GLM family and link, and which parameters to estimate and which to fix (commonly, for the study of measles dynamics, <italic>α</italic> is fixed to be 0.97, and <inline-formula id="pone.0185528.e006"><alternatives><graphic xlink:href="pone.0185528.e006.jpg" id="pone.0185528.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is occasionally fixed as well to be 0.035 based on analysis of pre-vaccination data from the United Kingdom [<xref rid="pone.0185528.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0185528.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0185528.ref018" ref-type="bibr">18</xref>]). This decision process can also be implemented in a Bayesian framework, although is a computationally more extensive task. Further choices must be made when describing the distribution of the expected value in <xref ref-type="disp-formula" rid="pone.0185528.e003">Eq 2</xref>, as well as a deciding between a completely forward prediction versus a step-ahead prediction. These options, while relatively straightforward, are cumbersome to implement especially while working with a number of time-series. Thus, while the TSIR model has been used extensively, there is a need for an open source software package which implements these options in a user-friendly way. We have developed the <bold>tsiR</bold> package to address this methodological challenge and facilitate a more straight-forward and widely-accessible model-fitting process.</p>
  </sec>
  <sec id="sec002">
    <title>1 Methods</title>
    <p>The <bold>tsiR</bold> package, available on CRAN, is written completely in the <bold>R</bold> programming language. Package functions and a short description of their use is included at the end of this section. Package dependencies are <bold>kernlab</bold> [<xref rid="pone.0185528.ref021" ref-type="bibr">21</xref>], <bold>ggplot2</bold> [<xref rid="pone.0185528.ref022" ref-type="bibr">22</xref>], and <bold>reshape2</bold> [<xref rid="pone.0185528.ref023" ref-type="bibr">23</xref>]. All code is publicly available on GitHub (<ext-link ext-link-type="uri" xlink:href="http://www.github.com/adbecker/tsiR">www.github.com/adbecker/tsiR</ext-link>). In the following section, typewriter font refers to function arguments and quotes refer to argument inputs.</p>
    <sec id="sec003">
      <title>1.1 Data</title>
      <p><bold>tsiR</bold> requires data to be a named data frame with a ‘time’ column (that can be understood by <bold>ggplot2</bold>—see [<xref rid="pone.0185528.ref022" ref-type="bibr">22</xref>] for details), and columns for ‘cases’, ‘births’ and ‘pop’ (population size). If the number of births and population size are on a different time scale than the reported cases, these data (as well as case data) must be interpolated to the generation time. When incidence data are reported weekly and demographic data (i.e., births and population size) are reported yearly, as is often the case, these individual vectors can be interpolated to the proper infectious period timescale via the <bold>tsiRdata</bold> function. Note that at each time point, the births must be the number of births that occur within the <monospace>IP</monospace> weeks, where <monospace>IP</monospace> is the infectious period (in weeks). For measles, this is typically taken as two weeks, however <bold>tsiR</bold> does not require <monospace>IP</monospace> to be an integer. A dataset, <bold>twentymeas</bold>, is included in the <bold>tsiR</bold> package as a list. This dataset is a list which contains biweekly data (<monospace>IP</monospace>=2) for twenty locations in England from 1944-1964 and was analyzed in [<xref rid="pone.0185528.ref011" ref-type="bibr">11</xref>].</p>
    </sec>
    <sec id="sec004">
      <title>1.2 Model inference and forward simulation</title>
      <p>The main function in the <bold>tsiR</bold> package is <bold>runtsir</bold>. This function reconstructs the susceptible dynamics, fits the log-linear relationship in <xref ref-type="disp-formula" rid="pone.0185528.e005">Eq 3</xref>, and then resimulates the TSIR model in <xref ref-type="disp-formula" rid="pone.0185528.e003">Eq 2</xref> forward under the fitted parameters.</p>
      <p>An essential argument (and assumption of the TSIR model) in the <bold>tsiR</bold> package is that the time step is equal to the infectious period (<monospace>IP</monospace>), i.e. that <monospace>IP</monospace> is a consistent argument throughout the data. Written based on measles, in <bold>tsiR</bold> all functions default to IP = 2. Thus, if a different disease is being analyzed, it is key to change the <monospace>IP</monospace> argument throughout the function inputs. As with all <bold>R</bold> functions, a full description of the function can be acquired via <monospace>?runtsir</monospace>. Here we describe the main arguments. The <monospace>xreg</monospace> argument indicates whether cumulative cases or cumulative births are on the x-axis of the regression. Thus, the options are simply ‘cumcases’ or ‘cumbirths’ with a default of ‘cumcases’. A more extensive discussion of this choice can be found in [<xref rid="pone.0185528.ref006" ref-type="bibr">6</xref>]. After describing the formula for the susceptible reconstruction, the regression type must be specified via the <monospace>regtype</monospace> argument. Here, the options are ‘gaussian’, where the kernel size is profiled to maintain a reporting rate between zero and one, and ‘lm’, ‘lowess’, ‘loess’ or ‘spline’ regression, for a linear, a lowess, a loess, and a spline regression with 2.5 degrees freedom, respectively. If the Gaussian process fails to produce a reporting rate between zero and one, <bold>runtsir</bold> defaults to a loess regression. A Gaussian regression, as implemented in [<xref rid="pone.0185528.ref012" ref-type="bibr">12</xref>], appears to produce the most robust results in both small and large populations. However, using a Gaussian regression may produce exaggerated reporting rates when there is a single outbreak that is substantially larger in size than across the rest of the time series. The aforementioned arguments will specify the shape, <italic>Z</italic><sub><italic>t</italic></sub>, of the susceptible dynamics, <italic>S</italic><sub><italic>t</italic></sub>. At this stage, model parameters left to estimate are <italic>β</italic><sub><italic>t</italic></sub>, <italic>α</italic>, and <inline-formula id="pone.0185528.e007"><alternatives><graphic xlink:href="pone.0185528.e007.jpg" id="pone.0185528.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, although the last two can be fixed as previously mentioned. Note that the number of parameters in <italic>β</italic><sub><italic>t</italic></sub> is dependent on <monospace>IP</monospace> such that the length of <italic>β</italic><sub><italic>t</italic></sub> is 52 divided by <monospace>IP</monospace>. The only exception is where <monospace>IP</monospace> is equal to one. In this scenario <italic>β</italic><sub><italic>t</italic></sub> is truncated to 26 points, each repeated twice to preserve statistical integrity. Parameters <italic>α</italic> and <inline-formula id="pone.0185528.e008"><alternatives><graphic xlink:href="pone.0185528.e008.jpg" id="pone.0185528.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> can be fixed via <monospace>alpha</monospace> and <monospace>sbar</monospace> if desired. For the log-linear regression in <xref ref-type="disp-formula" rid="pone.0185528.e005">Eq 3</xref> virtually any GLM family and link can be used, although the options are essentially ‘quasipoisson’, ‘poisson’, and ‘gaussian’ where ‘poisson’/‘quassipoisson’ take a ‘log’ link and a ‘gaussian’ family takes either a ‘log’ or ‘identity’ link.</p>
      <p>At this stage, all parameters are estimated, confidence intervals have been constructed (when appropriate and the computation can be completed), and the model can be forward simulated. The <bold>runtsir</bold> function defaults to a full time-series ahead forward prediction, although step-ahead can be inputted as well under the <monospace>pred</monospace> argument. For large populations, the forward prediction can generally be simulated without fear of fade-outs (i.e., the simulation declining to zero). However, for smaller populations with frequent local ‘fade-outs’ of infection between epidemics, the forward prediction may only be able to be run a simple epidemic-ahead [<xref rid="pone.0185528.ref012" ref-type="bibr">12</xref>]. This constraint on the prediction model can be specified via <monospace>epidemics = break</monospace> as well as designating a <monospace>threshold</monospace> parameter that indicates when a new epidemic is started and thus where to reset the forward simulation. By default, the initial conditions (<italic>S</italic><sub>0</sub>, <italic>I</italic><sub>0</sub>) are (<inline-formula id="pone.0185528.e009"><alternatives><graphic xlink:href="pone.0185528.e009.jpg" id="pone.0185528.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, <italic>C</italic><sub>0</sub>/<italic>ρ</italic><sub>0</sub>) where <italic>C</italic><sub><italic>t</italic></sub> is cases. Thus, if <italic>C</italic><sub>0</sub> is zero, the forward prediction will fail. In this scenario, the data must be truncated to the first non-trivial case, or initial conditions can be fit using simple least squares per [<xref rid="pone.0185528.ref006" ref-type="bibr">6</xref>], although this feature could be made more robust in the future (see the <xref ref-type="sec" rid="sec005">Conclusions</xref> section). This can be specified using the <monospace>inits.fit = T</monospace> argument. Finally, the simulation distribution can be specified via <monospace>method</monospace> where the options are ‘deterministic’, ‘negbin’, and ‘pois’ for deterministic, Negative Binomial, and Poisson distributions. The number of simulations to perform is specified via <monospace>nsim</monospace>. The output of <bold>runtsir</bold> is a named list and can be fully plotted via the <bold>plotres</bold> function. The output of this model, as generated by the following code, can be seen below and is plotted in <xref ref-type="fig" rid="pone.0185528.g001">Fig 1</xref>.</p>
      <fig id="pone.0185528.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0185528.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Output results from the runtsir function for London.</title>
          <p>Subplots A) and B) are the cumulative births against cumulative cases regression and estimated reporting rate, the C) and D) are the profiled <inline-formula id="pone.0185528.e010"><alternatives><graphic id="pone.0185528.e010g" xlink:href="pone.0185528.e010"/><mml:math id="M10"><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> from <italic>Z</italic><sub><italic>t</italic></sub> and then reconstructed <italic>S</italic>, E) is 26-point <italic>β</italic><sub><italic>t</italic></sub> with the <italic>α</italic> and mean <italic>β</italic> (indicated as <inline-formula id="pone.0185528.e011"><alternatives><graphic id="pone.0185528.e011g" xlink:href="pone.0185528.e011"/><mml:math id="M11"><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) estimate, and F) and G) are the data (blue) against 10 randomly chosen stochastic simulations (red) and the (inverse) data against mean of the simulations with confidence intervals.</p>
        </caption>
        <graphic xlink:href="pone.0185528.g001"/>
      </fig>
      <p specific-use="line">LondonMeas &lt;- twentymeas[[“London”]]</p>
      <p specific-use="line">LondonRes &lt;- runtsir(data=LondonMeas, IP = 2,</p>
      <p specific-use="line">         xreg = ’cumcases’, regtype=’gaussian’,</p>
      <p specific-use="line">         alpha = NULL, sbar = NULL,</p>
      <p specific-use="line">         family = ’gaussian’, link = ’identity’</p>
      <p specific-use="line">         method = ’negbin’, nsim = 100)</p>
      <p specific-use="line">plotres(LondonRes)</p>
      <p>The <bold>runtsir</bold> function is also decomposed via the <bold>estpars</bold> and <bold>simulatetsir</bold> functions. This may be more desirable if exploring a large number of simulations or analyzing sparse incidence data. In the following short example, we will examine such a data set from Northwich (Cheshire, England, population size in 1944 = 18,070). Here, we must define epidemic start and end times per [<xref rid="pone.0185528.ref012" ref-type="bibr">12</xref>]. Using a threshold of three, we can see where each epidemic is defined via the dashed line in <xref ref-type="fig" rid="pone.0185528.g002">Fig 2</xref>. Here, we are estimating parameters using different regression options available in <bold>tsiR</bold>, as well as simulating the model via a Poisson distribution and fixing <italic>α</italic>. Only the forward simulations are shown in <xref ref-type="fig" rid="pone.0185528.g003">Fig 3</xref>, where again the data is shown in blue and the simulation results are shown in red. Overall, the forward simulation captures the epidemic final size well for such a noisy time-series [<xref rid="pone.0185528.ref012" ref-type="bibr">12</xref>]. The code used to generate these fits and plots is shown below.</p>
      <fig id="pone.0185528.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0185528.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Northwich time-series data.</title>
          <p>Dashed lines are the time points in which the forward simulation resets in the <monospace>epidemics = ‘break’</monospace> argument for a threshold for three.</p>
        </caption>
        <graphic xlink:href="pone.0185528.g002"/>
      </fig>
      <fig id="pone.0185528.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0185528.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>The forward simulations for the Northwich time-series data under an epidemic-ahead fit using a threshold of three.</title>
          <p>The color coding in the panels shown here are the same as in <xref ref-type="fig" rid="pone.0185528.g001">Fig 1</xref>.</p>
        </caption>
        <graphic xlink:href="pone.0185528.g003"/>
      </fig>
      <p specific-use="line">NorthwichMeas &lt;- twentymeas[[“Northwich”]]</p>
      <p specific-use="line">NorthwichParms &lt;- estpars(data = NorthwichMeas, IP = 2,</p>
      <p specific-use="line">            alpha = 0.97, sbar = NULL,</p>
      <p specific-use="line">            regtype = ’loess’,</p>
      <p specific-use="line">            family = ’poisson’, link = ’log’)</p>
      <p specific-use="line">plotbreaks (data = NorthwichMeas, threshold = 3)</p>
      <p specific-use="line">NorthwichRes &lt;- simulatetsir(data = NorthwichMeas, IP = 2,</p>
      <p specific-use="line">            parms = NorthwichParms,</p>
      <p specific-use="line">            epidemics = ’break’, threshold = 3,</p>
      <p specific-use="line">            method = ’pois’,nsim = 100)</p>
      <p specific-use="line">plotcomp (NorthwichRes)</p>
      <p>A brief summary of the main functions and their usage in the <bold>tsiR</bold> package follow below in <xref rid="pone.0185528.t001" ref-type="table">Table 1</xref>. Please note for MCMC functionality, one must install <bold>rjags</bold> [<xref rid="pone.0185528.ref024" ref-type="bibr">24</xref>] independently. The MCMC functions, <bold>mcmcestpars</bold> and <bold>mcmctsir</bold>, follow generally the same arguments as their frequentist counterparts. Notable exceptions however are that a family and link no longer can be specified, and MCMC specific arguments (<monospace>n.chains</monospace> for the number of chains, <monospace>update.iter</monospace> for the number of MCMC iterations to use in the <bold>rjags</bold> update section, <monospace>n.iter</monospace> for number of MCMC iterations to perform, <monospace>n.adapt</monospace> for the adaptive number, and <monospace>burn.in</monospace> for the burn in number) can be specified. For more information on these arguments, we direct the reader to <bold>rjags</bold> documentation [<xref rid="pone.0185528.ref024" ref-type="bibr">24</xref>]. Additionally, annotated code for the London and Northwich estimations and forward simulations is included as a .R files in the Supporting Information.</p>
      <table-wrap id="pone.0185528.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0185528.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Summary and description of the main functions in the tsiR package.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0185528.t001g" xlink:href="pone.0185528.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Function</th>
                <th align="left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">tsiRdata</td>
                <td align="left" rowspan="1" colspan="1">Interpolates (weekly) cases and (yearly) births and population vectors to the generation time of the disease</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">twentymeas</td>
                <td align="left" rowspan="1" colspan="1">Named list of twenty biweekly (IP = 2) time-series from 1944-1964 England</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">plotdata</td>
                <td align="left" rowspan="1" colspan="1">Plots the cases, births, and population time series</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">runtsir</td>
                <td align="left" rowspan="1" colspan="1">Reconstructs susceptible dynamics, estimates parameters, and runs the forward simulation</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">plotres</td>
                <td align="left" rowspan="1" colspan="1">Plots the fitted regressions, reporting, susceptible reconstruction, estimated parameters, and the fit diagnostics</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">plotcomp</td>
                <td align="left" rowspan="1" colspan="1">Plots the data versus the simulations only</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">estpars</td>
                <td align="left" rowspan="1" colspan="1">Reconstructs the susceptible dynamics and estimates parameters</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">maxthreshold</td>
                <td align="left" rowspan="1" colspan="1">Optimizes the threshold parameter for sparse data using <italic>R</italic><sup>2</sup></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mcmcestpars</td>
                <td align="left" rowspan="1" colspan="1">Using MCMC, reconstructs susceptible dynamics and estimates parameters</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mcmctsir</td>
                <td align="left" rowspan="1" colspan="1">Using MCMC, reconstructs susceptible dynamics, estimates parameters, and runs the simulation</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">simulatetsir</td>
                <td align="left" rowspan="1" colspan="1">Runs the forward simulation taking in the output from estpars or mcmcestpars</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">plotregression</td>
                <td align="left" rowspan="1" colspan="1">Plots the cumulative cases and cumulative births regression</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">plotrho</td>
                <td align="left" rowspan="1" colspan="1">Plots the inferred reporting rate <italic>ρ</italic></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">plotsbar</td>
                <td align="left" rowspan="1" colspan="1">Plots the inferred <inline-formula id="pone.0185528.e012"><alternatives><graphic id="pone.0185528.e012g" xlink:href="pone.0185528.e012"/><mml:math id="M12"><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and the profile log likelihood</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">plotbeta</td>
                <td align="left" rowspan="1" colspan="1">Plots the inferred <italic>β</italic></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">plotforward</td>
                <td align="left" rowspan="1" colspan="1">Plots the data against the mean simulation with confidence intervals</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
  </sec>
  <sec id="sec005">
    <title>2 Conclusions, limitations, and future work</title>
    <p>The <bold>tsiR</bold> package allows researchers to fit the time-series Susceptible-Infected-Recovered model using a number of different fitting options that are easy to change and compare. Per the model formulation, the frequentist fitting techniques are computationally tractable and, to a first approximation, work very well for childhood diseases in a number of settings.</p>
    <p>However, the model does make a number of assumptions that are undesirable for certain data and pathogens. For example, fixing the infectious period may not be realistic for more chronic infections, and ignoring deaths may lead to biased conclusions when examined over a long enough time scale. Additionally, under certain settings and time scales, the assumption that cumulative cases approximates cumulative births may be flawed. Furthermore, the TSIR model only includes the observation process as a single reporting rate and not as a probability distribution, and stochasticity cannot be explicitly estimated. To include these complexities, methods such as Sequential Monte Carlo and Iterated Filtering can be used to perturb parameters in order to maximize the likelihood [<xref rid="pone.0185528.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0185528.ref025" ref-type="bibr">25</xref>]. These algorithms are included in the <bold>R</bold> package <bold>pomp</bold> [<xref rid="pone.0185528.ref014" ref-type="bibr">14</xref>]. Such flexibility does comes at a cost, however, as Maximum Likelihood methods can be computationally expensive and optimization algorithms are often complex [<xref rid="pone.0185528.ref011" ref-type="bibr">11</xref>, <xref rid="pone.0185528.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0185528.ref026" ref-type="bibr">26</xref>].</p>
    <p>Regardless, for fully-immunizing childhood infections such as measles, the TSIR model is able to accurately capture the parameters of interest across a range of different scenarios and remains the most tractable approach (in particular for large numbers of time-series). Improvements and areas of future work to the <bold>tsiR</bold> package include incorporating spatial disease spread (e.g., the gravity model per [<xref rid="pone.0185528.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0185528.ref027" ref-type="bibr">27</xref>]), the addition of an immigration parameter to the force of infection, a more statistically robust method to estimate initial conditions, and a more streamlined Bayesian approach to the TSIR model. In the spirit of open science, other researchers are welcome to send suggestions, bug reports, as well as contributions to the software.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec006">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0185528.s001">
      <label>S1 File</label>
      <caption>
        <title>R script.</title>
        <p>Annotated code to run the analysis in this paper (with additional plots).</p>
        <p>(R)</p>
      </caption>
      <media xlink:href="pone.0185528.s001.R">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Ottar Bjørnstad, Quentin Caudron, Benjamin Dalziel, Ayesha S. Mahmud, C. Jessica Metcalf, Sinead E. Morris, Saki Takahashi, Amy Wesolowski, and Colin Worby for their valuable suggestions, comments, and work using the TSIR model.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0185528.ref001">
      <label>1</label>
      <mixed-citation publication-type="book"><name><surname>Anderson</surname><given-names>RM</given-names></name>, <name><surname>May</surname><given-names>R M</given-names></name>. <source>Infectious diseases of humans: Dynamics and control</source>. <volume>vol. 15</volume><publisher-loc>Oxford</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>; <year>1992</year> Available from: <ext-link ext-link-type="uri" xlink:href="http://onlinelibrary.wiley.com/doi/10.1002/hep.1840150131/abstract">http://onlinelibrary.wiley.com/doi/10.1002/hep.1840150131/abstract</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0185528.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Freckleton</surname><given-names>RP</given-names></name>. <article-title>The Ecological Detective: Confronting Models with Data</article-title>. <name><surname>Hilborn</surname><given-names>R.</given-names></name> &amp; <name><surname>Mangel</surname><given-names>M.</given-names></name> (<year>1997</year>). <source>Journal of Applied Ecology</source>. 1999;<volume>36</volume>(<issue>5</issue>):<fpage>842</fpage>–<lpage>846</lpage>. <pub-id pub-id-type="doi">10.1046/j.1365-2664.1999.04462.x</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Holland</surname><given-names>PW</given-names></name>, <name><surname>Leinhardt</surname><given-names>S</given-names></name>. <article-title>An Exponential Family of Probability Distributions for Directed Graphs</article-title>. <source>Journal of the American Statistical Association</source>. <year>1981</year>;<volume>76</volume>(<issue>373</issue>):<fpage>33</fpage>–<lpage>50</lpage>. <pub-id pub-id-type="doi">10.2307/2287042</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>May</surname><given-names>RM</given-names></name>. <article-title>Simple mathematical models with very complicated dynamics</article-title>. <source>Nature</source>. <year>1976</year>;<volume>261</volume>(<issue>5560</issue>):<fpage>459</fpage>–<lpage>467</lpage>. <pub-id pub-id-type="doi">10.1038/261459a0</pub-id><?supplied-pmid 934280?><pub-id pub-id-type="pmid">934280</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Ferrari</surname><given-names>MJ</given-names></name>, <name><surname>Grais</surname><given-names>RF</given-names></name>, <name><surname>Bharti</surname><given-names>N</given-names></name>, <name><surname>Conlan</surname><given-names>AJK</given-names></name>, <name><surname>Bjørnstad</surname><given-names>ON</given-names></name>, <name><surname>Wolfson</surname><given-names>LJ</given-names></name>, <etal>et al</etal><article-title>The dynamics of measles in sub-Saharan Africa</article-title>. <source>Nature</source>. <year>2008</year>;<volume>451</volume>(<issue>7179</issue>):<fpage>679</fpage>–<lpage>684</lpage>. <pub-id pub-id-type="doi">10.1038/nature06509</pub-id><?supplied-pmid 18256664?><pub-id pub-id-type="pmid">18256664</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Dalziel</surname><given-names>BD</given-names></name>, <name><surname>Bjørnstad</surname><given-names>ON</given-names></name>, <name><surname>van Panhuis</surname><given-names>WG</given-names></name>, <name><surname>Burke</surname><given-names>DS</given-names></name>, <name><surname>Metcalf</surname><given-names>CJE</given-names></name>, <name><surname>Grenfell</surname><given-names>BT</given-names></name>. <article-title>Persistent Chaos of Measles Epidemics in the Prevaccination United States Caused by a Small Change in Seasonal Transmission Patterns</article-title>. <source>PLOS Computational Biology</source>. <year>2016</year>;<volume>12</volume>(<issue>2</issue>):<fpage>e1004655</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004655</pub-id><?supplied-pmid 26845437?><pub-id pub-id-type="pmid">26845437</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Kermack</surname><given-names>WO</given-names></name>, <name><surname>McKendrick</surname><given-names>AG</given-names></name>. <article-title>A Contribution to the Mathematical Theory of Epidemics</article-title>. <source>Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences</source>. <year>1927</year>;<volume>115</volume>(<issue>772</issue>):<fpage>700</fpage>–<lpage>721</lpage>. <pub-id pub-id-type="doi">10.1098/rspa.1927.0118</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Finkenstädt</surname><given-names>BF</given-names></name>, <name><surname>Grenfell</surname><given-names>BT</given-names></name>. <article-title>Time series modelling of childhood diseases: a dynamical systems approach</article-title>. <source>Journal of the Royal Statistical Society: Series C (Applied Statistics)</source>. <year>2000</year>;<volume>49</volume>(<issue>2</issue>):<fpage>187</fpage>–<lpage>205</lpage>. <pub-id pub-id-type="doi">10.1111/1467-9876.00187</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Wallinga</surname><given-names>J</given-names></name>, <name><surname>Lévy-Bruhl</surname><given-names>D</given-names></name>, <name><surname>Gay</surname><given-names>NJ</given-names></name>, <name><surname>Wachmann</surname><given-names>CH</given-names></name>. <article-title>Estimation of measles reproduction ratios and prospects for elimination of measles by vaccination in some Western European countries</article-title>. <source>Epidemiology and Infection</source>. <year>2001</year>;<volume>127</volume>(<issue>2</issue>):<fpage>281</fpage>–<lpage>295</lpage>. <pub-id pub-id-type="doi">10.1017/S095026880100601X</pub-id><?supplied-pmid 11693506?><pub-id pub-id-type="pmid">11693506</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Ionides</surname><given-names>EL</given-names></name>, <name><surname>Bretó</surname><given-names>C</given-names></name>, <name><surname>King</surname><given-names>AA</given-names></name>. <article-title>Inference for nonlinear dynamical systems</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2006</year>;<volume>103</volume>(<issue>49</issue>):<fpage>18438</fpage>–<lpage>18443</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0603181103</pub-id><?supplied-pmid 17121996?><pub-id pub-id-type="pmid">17121996</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>D</given-names></name>, <name><surname>Ionides</surname><given-names>EL</given-names></name>, <name><surname>King</surname><given-names>AA</given-names></name>. <article-title>Plug-and-play inference for disease dynamics: measles in large and small populations as a case study</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2010</year>;<volume>7</volume>(<issue>43</issue>):<fpage>271</fpage>–<lpage>283</lpage>. <pub-id pub-id-type="doi">10.1098/rsif.2009.0151</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Caudron</surname><given-names>Q</given-names></name>, <name><surname>Mahmud</surname><given-names>AS</given-names></name>, <name><surname>Metcalf</surname><given-names>CJE</given-names></name>, <name><surname>Gottfresson</surname><given-names>M</given-names></name>, <name><surname>Viboud</surname><given-names>C</given-names></name>, <name><surname>Cliff</surname><given-names>AD</given-names></name>, <etal>et al</etal><article-title>Predictability in a highly stochastic system: final size of measles epidemics in small populations</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2015</year>;<volume>12</volume>(<issue>102</issue>):<fpage>20141125</fpage><pub-id pub-id-type="doi">10.1098/rsif.2014.1125</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Takahashi</surname><given-names>S</given-names></name>, <name><surname>Liao</surname><given-names>Q</given-names></name>, <name><surname>Van Boeckel</surname><given-names>TP</given-names></name>, <name><surname>Xing</surname><given-names>W</given-names></name>, <name><surname>Sun</surname><given-names>J</given-names></name>, <name><surname>Hsiao</surname><given-names>VY</given-names></name>, <etal>et al</etal><article-title>Hand, Foot, and Mouth Disease in China: Modeling Epidemic Dynamics of Enterovirus Serotypes and Implications for Vaccination</article-title>. <source>PLOS Medicine</source>. <year>2016</year>;<volume>13</volume>(<issue>2</issue>):<fpage>e1001958</fpage><pub-id pub-id-type="doi">10.1371/journal.pmed.1001958</pub-id><?supplied-pmid 26882540?><pub-id pub-id-type="pmid">26882540</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>King</surname><given-names>AA</given-names></name>, <name><surname>Ionides</surname><given-names>EL</given-names></name>, <name><surname>Breto</surname><given-names>C</given-names></name>, <name><surname>Ellner</surname><given-names>SP</given-names></name>, <name><surname>Ferrari</surname><given-names>MJ</given-names></name>, <name><surname>Kendall</surname><given-names>BE</given-names></name>, <etal>et al</etal><source>pomp: Statistical Inference for Partially Observed Markov Processes</source>; <year>2015</year> Available from: <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/pomp/index.html">https://cran.r-project.org/web/packages/pomp/index.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0185528.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Glass</surname><given-names>K</given-names></name>, <name><surname>Xia</surname><given-names>Y</given-names></name>, <name><surname>Grenfell</surname><given-names>BT</given-names></name>. <article-title>Interpreting time-series analyses for continuous-time biological models—measles as a case study</article-title>. <source>Journal of Theoretical Biology</source>. <year>2003</year>;<volume>223</volume>(<issue>1</issue>):<fpage>19</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.1016/S0022-5193(03)00031-6</pub-id><?supplied-pmid 12782113?><pub-id pub-id-type="pmid">12782113</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>D</given-names></name>, <name><surname>Dushoff</surname><given-names>J</given-names></name>, <name><surname>Day</surname><given-names>T</given-names></name>, <name><surname>Ma</surname><given-names>J</given-names></name>, <name><surname>Earn</surname><given-names>DJD</given-names></name>. <article-title>Mechanistic modelling of the three waves of the 1918 influenza pandemic</article-title>. <source>Theoretical Ecology</source>. <year>2011</year>;<volume>4</volume>(<issue>2</issue>):<fpage>283</fpage>–<lpage>288</lpage>. <pub-id pub-id-type="doi">10.1007/s12080-011-0123-3</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Grenfell</surname><given-names>BT</given-names></name>, <name><surname>Bjørnstad</surname><given-names>ON</given-names></name>, <name><surname>Finkenstädt</surname><given-names>BF</given-names></name>. <article-title>Dynamics of measles epidemics: scaling noise, determinism, and predictability with the tsir model</article-title>. <source>Ecological Monographs</source>. <year>2002</year>;<volume>72</volume>(<issue>2</issue>):<fpage>185</fpage>–<lpage>202</lpage>. <pub-id pub-id-type="doi">10.1890/0012-9615(2002)072[0185:DOMESN]2.0.CO;2</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Bjørnstad</surname><given-names>ON</given-names></name>, <name><surname>Finkenstädt</surname><given-names>BF</given-names></name>. <article-title>Dynamics of measles epidemics: Estimating scaling of transmission rates using a Time series SIR model</article-title>. <source>Ecological Monographs</source>. <year>2002</year>;<volume>72</volume>(<issue>2</issue>):<fpage>169</fpage>–<lpage>184</lpage>. <pub-id pub-id-type="doi">10.1890/0012-9615(2002)072[0169:DOMEES]2.0.CO;2</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Metcalf</surname><given-names>CJE</given-names></name>, <name><surname>Bjørnstad</surname><given-names>ON</given-names></name>, <name><surname>Grenfell</surname><given-names>BT</given-names></name>, <name><surname>Andreasen</surname><given-names>V</given-names></name>. <article-title>Seasonality and comparative dynamics of six childhood infections in pre-vaccination Copenhagen</article-title>. <source>Proceedings of the Royal Society of London B: Biological Sciences</source>. <year>2009</year>;<volume>276</volume> (<issue>1676</issue>). <pub-id pub-id-type="doi">10.1098/rspb.2009.1058</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Reich</surname><given-names>NG</given-names></name>, <name><surname>Shrestha</surname><given-names>S</given-names></name>, <name><surname>King</surname><given-names>AA</given-names></name>, <name><surname>Rohani</surname><given-names>P</given-names></name>, <name><surname>Lessler</surname><given-names>J</given-names></name>, <name><surname>Kalayanarooj</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Interactions between serotypes of dengue highlight epidemiological impact of cross-immunity</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2013</year>;<volume>10</volume>(<issue>86</issue>). <pub-id pub-id-type="doi">10.1098/rsif.2013.0414</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Karatzoglou</surname><given-names>A</given-names></name>, <name><surname>Smola</surname><given-names>A</given-names></name>, <name><surname>Hornik</surname><given-names>K</given-names></name>, <name><surname>Zeileis</surname><given-names>A</given-names></name>. <article-title>Kernel-Based Machine Learning Lab [R package kernlab version 0.9-25]</article-title>. <source>Journal of Statistical Software</source>. <year>2004</year>;<volume>11</volume>(<issue>9</issue>):<fpage>1</fpage>–<lpage>20</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0185528.ref022">
      <label>22</label>
      <mixed-citation publication-type="book"><name><surname>Wickham</surname><given-names>Hadley</given-names></name>. <source>ggplot2: Elegant Graphics for Data Analysis</source>; <year>2009</year>.</mixed-citation>
    </ref>
    <ref id="pone.0185528.ref023">
      <label>23</label>
      <mixed-citation publication-type="other">Wickham H. Reshaping Data with the reshape Package; 2007. Available from: <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/reshape2/">https://cran.r-project.org/web/packages/reshape2/</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref024">
      <label>24</label>
      <mixed-citation publication-type="other">Plummer M. Bayesian Graphical Models using MCMC [R package rjags version 4-6]. 2016;.</mixed-citation>
    </ref>
    <ref id="pone.0185528.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Bretó</surname><given-names>C</given-names></name>, <name><surname>He</surname><given-names>D</given-names></name>, <name><surname>Ionides</surname><given-names>EL</given-names></name>, <name><surname>King</surname><given-names>AA</given-names></name>. <article-title>Time series analysis via mechanistic models</article-title>. <source>The Annals of Applied Statistics</source>. <year>2009</year>;<volume>3</volume>(<issue>1</issue>):<fpage>319</fpage>–<lpage>348</lpage>. <pub-id pub-id-type="doi">10.1214/08-AOAS201</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Groendyke</surname><given-names>C</given-names></name>, <name><surname>Welch</surname><given-names>D</given-names></name>, <name><surname>Hunter</surname><given-names>DR</given-names></name>. <article-title>A network-based analysis of the 1861 Hagelloch measles data</article-title>. <source>Biometrics</source>. <year>2012</year>;<volume>68</volume>(<issue>3</issue>):<fpage>755</fpage>–<lpage>765</lpage>. <pub-id pub-id-type="doi">10.1111/j.1541-0420.2012.01748.x</pub-id><?supplied-pmid 22364540?><pub-id pub-id-type="pmid">22364540</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0185528.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Xia</surname><given-names>Y</given-names></name>, <name><surname>Bjørnstad</surname><given-names>O</given-names></name>, <name><surname>Grenfell</surname><given-names>B</given-names></name>. <article-title>Measles Metapopulation Dynamics: A Gravity Model for Epidemiological Coupling and Dynamics</article-title>. <source>The American Naturalist</source>. <year>2004</year>;<volume>164</volume>(<issue>2</issue>):<fpage>267</fpage>–<lpage>281</lpage>. <pub-id pub-id-type="doi">10.1086/422341</pub-id><?supplied-pmid 15278849?><pub-id pub-id-type="pmid">15278849</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
