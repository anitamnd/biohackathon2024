<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6493727</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0215337</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-01617</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FluoroCellTrack: An algorithm for automated analysis of high-throughput droplet microfluidic data</article-title>
      <alt-title alt-title-type="running-head">FluoroCellTrack</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Vaithiyanathan</surname>
          <given-names>Manibarathi</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Safa</surname>
          <given-names>Nora</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0484-5871</contrib-id>
        <name>
          <surname>Melvin</surname>
          <given-names>Adam T.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="corresp" rid="cor001">*</xref>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Cain Department of Chemical Engineering, Louisiana State University, Baton Rouge, Louisiana, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Han</surname>
          <given-names>Arum</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Texas A&amp;M University College Station, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>melvin@lsu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>14</volume>
    <issue>5</issue>
    <elocation-id>e0215337</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>1</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>3</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Vaithiyanathan et al</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Vaithiyanathan et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0215337.pdf"/>
    <abstract>
      <p>High-throughput droplet microfluidic devices with fluorescence detection systems provide several advantages over conventional end-point cytometric techniques due to their ability to isolate single cells and investigate complex intracellular dynamics. While there have been significant advances in the field of experimental droplet microfluidics, the development of complementary software tools has lagged. Existing quantification tools have limitations including interdependent hardware platforms or challenges analyzing a wide range of high-throughput droplet microfluidic data using a single algorithm. To address these issues, an all-in-one Python algorithm called FluoroCellTrack was developed and its wide-range utility was tested on three different applications including quantification of cellular response to drugs, droplet tracking, and intracellular fluorescence. The algorithm imports all images collected using bright field and fluorescence microscopy and analyzes them to extract useful information. Two parallel steps are performed where droplets are detected using a mathematical Circular Hough Transform (CHT) while single cells (or other contours) are detected by a series of steps defining respective color boundaries involving edge detection, dilation, and erosion. These feature detection steps are strengthened by segmentation and radius/area thresholding for precise detection and removal of false positives. Individually detected droplet and contour center maps are overlaid to obtain encapsulation information for further analyses. FluoroCellTrack demonstrates an average of a ~92–99% similarity with manual analysis and exhibits a significant reduction in analysis time of 30 min to analyze an entire cohort compared to 20 h required for manual quantification.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000070</institution-id>
            <institution>National Institute of Biomedical Imaging and Bioengineering</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R03EB02935</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0484-5871</contrib-id>
          <name>
            <surname>Melvin</surname>
            <given-names>Adam T.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000146</institution-id>
            <institution>Division of Chemical, Bioengineering, Environmental, and Transport Systems</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1509713</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0484-5871</contrib-id>
          <name>
            <surname>Melvin</surname>
            <given-names>Adam T.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported by grants from the National Institute of Biomedical Imaging and Bioengineering (<ext-link ext-link-type="uri" xlink:href="https://www.nibib.nih.gov/">https://www.nibib.nih.gov/</ext-link>), R03EB02935 (ATM), and the National Science Foundation, Division of Chemical, Bioengineering, Environmental, and Transport Systems (<ext-link ext-link-type="uri" xlink:href="https://www.nsf.gov/div/index.jsp?div=CBET">https://www.nsf.gov/div/index.jsp?div=CBET</ext-link>), 1509713 (ATM). The funders had no role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="9"/>
      <table-count count="0"/>
      <page-count count="22"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The data underlying this study has been made publicly available via the authors’ repository on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/Manibarathi/FluoroCellTrack">https://github.com/Manibarathi/FluoroCellTrack</ext-link>) as well as Zenodo (<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/badge/latestdoi/168103212">https://zenodo.org/badge/latestdoi/168103212</ext-link>, DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.2586194">10.5281/zenodo.2586194</ext-link>). All other relevant data are within the paper and its Supporting Information files. Data for the development of the nanoparticles is include in a published manuscript by Vaithiyanathan et al [Anal. Bioanal. Chem. (2019) 411:156]. Data for the use of a droplet microfluidic device to examine CPP uptake across a population is published in a manuscript by Safa et al [Anal. Bioanal. Chem (2019) in press -<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00216-019-01713-5">10.1007/s00216-019-01713-5</ext-link>]. Both manuscripts will be made available through the NIH Manuscript Submission (NIHMS) submission.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The data underlying this study has been made publicly available via the authors’ repository on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/Manibarathi/FluoroCellTrack">https://github.com/Manibarathi/FluoroCellTrack</ext-link>) as well as Zenodo (<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/badge/latestdoi/168103212">https://zenodo.org/badge/latestdoi/168103212</ext-link>, DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.2586194">10.5281/zenodo.2586194</ext-link>). All other relevant data are within the paper and its Supporting Information files. Data for the development of the nanoparticles is include in a published manuscript by Vaithiyanathan et al [Anal. Bioanal. Chem. (2019) 411:156]. Data for the use of a droplet microfluidic device to examine CPP uptake across a population is published in a manuscript by Safa et al [Anal. Bioanal. Chem (2019) in press -<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00216-019-01713-5">10.1007/s00216-019-01713-5</ext-link>]. Both manuscripts will be made available through the NIH Manuscript Submission (NIHMS) submission.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Development of fluorescence and image-based single cell technologies has enabled systematic investigation of cellular heterogeneity in a wide range of diseased tissues and cellular populations [<xref rid="pone.0215337.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0215337.ref002" ref-type="bibr">2</xref>]. While conventional single cell analytical tools like flow cytometry (and Fluorescence Activated Cell Sorting, Image Flow Cytometry) can detect, sort and collect cells with desired properties, these techniques do not permit dynamic monitoring of cell responses as the data is collected at a single time point [<xref rid="pone.0215337.ref003" ref-type="bibr">3</xref>]. Considering these limitations, microscale technologies such as droplet microfluidic devices and microfluidic cell trap arrays allow for facile collection and segregation of single cells to enable real-time investigation of cellular processes [<xref rid="pone.0215337.ref004" ref-type="bibr">4</xref>, <xref rid="pone.0215337.ref005" ref-type="bibr">5</xref>]. Droplet microfluidic devices in particular, have an advantage of working with picoliter to nanoliter volumes of solution that increases sensitivity, specificity, and precise quantification of real-time intra and extracellular processes [<xref rid="pone.0215337.ref003" ref-type="bibr">3</xref>]. The development of a wide variety of sophisticated cellular fluorescent probes in recent times has enabled easy tracking and detection of cellular activities by incorporating static microdroplet trapping arrays with fluorescence microscopy platforms to eliminate the need for high-speed cameras and expensive fiber optics used in large-scale cytometric tools [<xref rid="pone.0215337.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0215337.ref007" ref-type="bibr">7</xref>]. This technology has found a diverse set of applications in disease detection and diagnostics ranging from single cell analyses to droplet-based quantitative PCR and electrokinetic assays [<xref rid="pone.0215337.ref008" ref-type="bibr">8</xref>–<xref rid="pone.0215337.ref011" ref-type="bibr">11</xref>]. One such example in cellomics is the use of fluorescent stains and organic dyes in droplet microfluidic devices to sort cells based on their dynamic fluorescent responses to external stimuli [<xref rid="pone.0215337.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0215337.ref013" ref-type="bibr">13</xref>]. Similarly, fluorescent proteins, quantum dots, and luminescent nanoparticles have been used to track protein-protein interactions, intracellular enzyme activities, and identify biomolecules or biomarkers within single cells encapsulated in droplets [<xref rid="pone.0215337.ref014" ref-type="bibr">14</xref>–<xref rid="pone.0215337.ref017" ref-type="bibr">17</xref>]. In addition to cellomics, massively parallelized high-throughput droplet generators are used in combination with fluorescent barcodes to perform single cell DNA- and RNA- sequencing [<xref rid="pone.0215337.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0215337.ref019" ref-type="bibr">19</xref>]. Digital droplet microfluidics are also extensively used in the quantitative immunoassays and development of biosensors [<xref rid="pone.0215337.ref020" ref-type="bibr">20</xref>]. Beyond disease detection and diagnostics, fluorescence-based droplet microfluidics also finds applications in renewable energy, pharmaceutical industry and managing environmental issues [<xref rid="pone.0215337.ref021" ref-type="bibr">21</xref>–<xref rid="pone.0215337.ref024" ref-type="bibr">24</xref>].</p>
    <p>The growing advancement of these single-cell analytical devices in various fields has created a need for specific computational tools capable of processing and quantifying the large amount of intricate data collected from these screening systems. Additionally, there is a need for automated quantification due to the inconsistencies and challenges associated with manual cell counting and analysis, which is highly laborious and prone to subjective results that may vary from person to person. While many of the end-point commercial single cell analysis platforms are equipped with expensive inter-complementary hardware and software options to perform simultaneous imaging and analysis, there are limited stand-alone software tools to analyze high-throughput microarray or microfluidics data. Existing open-source software like ImageJ (NIH) and CellProfiler (Broad Institute) can count and characterize the total number of cells in a defined region; however, this is not suitable for high-throughput intracellular quantification of a large number of cells such as the datasets generated using a droplet microfluidic trapping array [<xref rid="pone.0215337.ref025" ref-type="bibr">25</xref>, <xref rid="pone.0215337.ref026" ref-type="bibr">26</xref>]. ImageJ utilizes macros to provide grid analysis similar to a hemocytometer but is limited to grid annotation or the detection cell colonies [<xref rid="pone.0215337.ref027" ref-type="bibr">27</xref>]. Commercial platforms accompanied by software tools like WOLF Cell Sorter (NanoCellect Biomedical, Inc., San Diego, CA, USA), Scepter 2.0 Cell Counter (Millipore Sigma, Burlington, MA, USA) and Cellomics (ThermoScientific, Pittsburg, PA, USA) can analyze high-throughput microfluidic data, but are limited in their ability to automatically detect microarrays and quantify intracellular properties [<xref rid="pone.0215337.ref028" ref-type="bibr">28</xref>]. Proprietary microarray software such as Quantarray (Packard BioChip Technologies, Billerica, MA, USA) and Genepix (Molecular Devices, Sunnyvale, CA, USA) allow users to define arrays individually in one image but are limited in their ability to automatically recognize the bounds of the array [<xref rid="pone.0215337.ref029" ref-type="bibr">29</xref>, <xref rid="pone.0215337.ref030" ref-type="bibr">30</xref>]. Recently, several algorithms have been developed to individually analyze droplet microfluidic data including screening target cells within droplets, tracking droplet morphology and velocity, or tracking single-cell movement trajectories within droplets [<xref rid="pone.0215337.ref031" ref-type="bibr">31</xref>–<xref rid="pone.0215337.ref033" ref-type="bibr">33</xref>]. While these algorithms can be integrated into experimental platforms to extract superficial droplet or cellular information, they are often restrained to a single analysis metric and are limited in their ability to quantify cell encapsulation information and intracellular properties.</p>
    <p>The goal of this work was to develop an algorithm called FluoroCellTrack that could rapidly analyze a wide range of fluorescent microscopy images from different droplet microfluidic applications. The algorithm was developed using Python 3.6.0 (Python Imaging Library, Python Software Foundation), considering the advantages of it over other programming languages such as MATLAB, C++ and Java [<xref rid="pone.0215337.ref034" ref-type="bibr">34</xref>]. The algorithm was designed to handle overlay images obtained using fluorescent microscopy which consisted of both brightfield and fluorescence overlays. To demonstrate the wide-range utility of FluoroCellTrack, it was utilized for three different applications: (1) to characterize and quantify a heterogeneous population of single OPM2 cancer cells based on their dynamic response to different concentrations of a drug; (2) to distinguish cells from clusters of spectrally independent luminescent nanoparticles (NPs) co-encapsulated in droplets which were successfully used as droplet trackers in prior work by Vaithiyanathan et al. [<xref rid="pone.0215337.ref035" ref-type="bibr">35</xref>] and (3) to quantify heterogeneous uptake of fluorescent cell penetrating peptides (CPPs) in single cancer cells through intracellular fluorescence as described in previous work by Safa et al. [<xref rid="pone.0215337.ref036" ref-type="bibr">36</xref>]. The algorithm was able to automatically (i) distinguish droplets from cells, (ii) distinguish and count live, dead and overlapping cells in each droplet, (iii) retrieve cell and NP co-encapsulation information to track single cells in each droplet, and (iv) quantify the intracellular fluorescence of intact cells. A significant limitation of single cell analysis was the time-consuming nature of manual quantification; however, FluoroCellTrack takes &lt;1 min to count cells and &lt;30 min to quantify intracellular fluorescence, compared to ~60 min and ~20 h using manual analysis. The accuracy of FluoroCellTrack was compared with manual counting of cells and found an average of ~92–99% similarity out of a total population of an average of 320 cells (per experiment) coupled with a 19-fold increase in analysis speed over manual counting. While in this work, FluoroCellTrack was tested on a low-throughput data for the ease of comparison with manual analysis, it can quantify several fluorescence-based, high-throughput and multiplexed data sets obtained from droplet microfluidic platforms in addition to microfluidic cell trap arrays or microdroplet arrays [<xref rid="pone.0215337.ref037" ref-type="bibr">37</xref>, <xref rid="pone.0215337.ref038" ref-type="bibr">38</xref>]. Beyond microfluidics, this algorithm can also be easily employed to quantify fluorescent cells in platforms such as microarrays, microchannels, 3D micro-environment, microtiter plates, and petri dishes [<xref rid="pone.0215337.ref039" ref-type="bibr">39</xref>, <xref rid="pone.0215337.ref040" ref-type="bibr">40</xref>].</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>Cell culture and reagents</title>
      <p>The details about cell culture, reagents and equipment used in all the three applications [<xref rid="pone.0215337.ref035" ref-type="bibr">35</xref>, <xref rid="pone.0215337.ref036" ref-type="bibr">36</xref>, <xref rid="pone.0215337.ref041" ref-type="bibr">41</xref>] are described in <xref ref-type="supplementary-material" rid="pone.0215337.s001">S1 Method</xref>.</p>
    </sec>
    <sec id="sec004">
      <title>Design and fabrication of the microfluidic device</title>
      <p>The microfluidic device used here is a two-layered droplet generator which was designed and fabricated as described by Vaithiyanathan et al. [<xref rid="pone.0215337.ref035" ref-type="bibr">35</xref>] and Safa et al. [<xref rid="pone.0215337.ref036" ref-type="bibr">36</xref>]. A brief description on this is presented in <xref ref-type="supplementary-material" rid="pone.0215337.s002">S2 Method</xref>.</p>
    </sec>
    <sec id="sec005">
      <title>Fluorescent microscopy: Camera and filter sets</title>
      <p>For experimentation, the microfluidic device was mounted on the stage of a fluorescent DMi8 inverted microscope (Leica Microsystems, Wetzlar, Germany) to visualize droplet generation, trapping and to acquire microscopy data. This DMi8 inverted microscope, equipped with a range of different magnifications (5x to 20x), was connected to an ORCA-Flash 4.0 V2 Digital CMOS Camera C11440-22CU (Hamamatsu Photonics K. K., Shizuoka, Japan) through a USB 3.0 interface for image collection. The CMOS camera had a 4.0-megapixel resolution (2048 pixels x 2048 pixels) with a high-speed readout (100 frames/s), while achieving a 1.0 electron (median) readout noise performance. The digital camera provided a very high sensitivity through its micro lens (37,000:1 dynamic range) with the CMOS image sensor providing 6.5 μm x 6.5 μm pixel sizes, thus making this camera the most suitable for dynamic brightfield and fluorescent imaging across a wide range of spectra. The microscope was equipped with external trigger functions and time output functions to control the essential timing control during imaging. The following excitation/emission filters (Chroma Tech. Corp., Bellow Falls, VT, USA) were used: fluorescein isothiocyanate FITC (λ<sub>ex</sub>: 440–520 nm and λ<sub>em</sub>: 497–557 nm); rhodamine (λ<sub>ex</sub>: 536–556 nm and λ<sub>em</sub>: 545–625 nm); filter set 1 (λ<sub>ex</sub>: 370–420 nm and λ<sub>em</sub>: 605–645 nm); and filter set 2 (λ<sub>ex</sub>: 325–355 nm and λ<sub>em</sub>: 505–565 nm).</p>
    </sec>
    <sec id="sec006">
      <title>Experimental set up</title>
      <p>The experimental steps describing sample preparation and execution of the three test systems (dose response analysis of OPM2 cells to Bortezomib using a droplet trapping array, tracking single cells using luminescent nanoparticles in a droplet trapping array [<xref rid="pone.0215337.ref035" ref-type="bibr">35</xref>], and understanding CPP uptake in intact cancer cells by measuring intracellular fluorescence) [<xref rid="pone.0215337.ref036" ref-type="bibr">36</xref>] are explained in <xref ref-type="supplementary-material" rid="pone.0215337.s003">S3 Method</xref>.</p>
    </sec>
    <sec id="sec007">
      <title>Quantification of data: Automated image analysis and manual analysis</title>
      <p>The FluoroCellTrack algorithm was developed in Python 3.6.0 software language (Python Software Foundation, Wilmington, DE, USA) using OpenCV (Open Source Computer Vision, Intel Corp.). Despite being slower than C/C++, Python was preferred in this work due to its ease and simplicity: the syntax in Python involves fewer steps as compared to C++ or Java. Another advantage of Python exploited here was its use alongside OpenCV, an open source machine learning software library that consists of a wide range of programming functions for real-time computer vision applications in pattern recognition, event detection, and artificial intelligence. OpenCV has its application programming interface (API) with several other programming languages and the interface in Python is called the OpenCV-Python which combines the best features of OpenCV-C++ API and Python. This feature allowed for writing computationally intensive codes in C/C++ and using a Python wrapper to use these codes as Python modules. This served as a two-in-one advantage. First, it allowed the code to run as fast as the C/C++ script and second, it gave the programmable ease of Python. OpenCV was used instead of the conservative Pillow (Python Imaging Library) due to the strong focus and better computational efficiency in wide range of applications.</p>
      <p>In FluoroCellTrack, highly optimized libraries of OpenCV-Python (e.g., NumPy, SciPy, scikit and matplotlib) were used to execute several numerical operations, thus making this an appropriate tool for fast prototyping of computer vision problems. FluoroCellTrack was tested for its performance on various experimental test systems using a 64-bit Operating System with a processor of base and turbo speeds of 2.50 GHz and 2.70 GHz. All collected microscopy data consisted of images with overlaid brightfield and fluorescent channels, which were processed and analyzed, resulting in the extraction of the required information using a series of 16-bit processing and operational steps. For multiple types of input, the algorithm was designed to handle folders of microscopy images of all formats (e.g., .<italic>tiff</italic>, .<italic>png</italic>, .<italic>gif</italic>, .<italic>jpeg</italic>, <italic>and</italic> .<italic>bmp</italic>). The acquired results were exported in suitable formats (.<italic>csv or</italic> .<italic>txt</italic>) for further data analysis. The efficiency of this algorithm was calculated by comparing the results obtained from automated quantification to manual quantification. The detailed description of the theory and validation of the automated quantification is given in the following sections. The manual analysis of the first two test systems consisted of counting live and dead single/multiple cells and luminescent NPs within droplets to register for encapsulation data, cell viability data and droplet tracking data [<xref rid="pone.0215337.ref035" ref-type="bibr">35</xref>]. For the third test system, the mean intracellular fluorescence intensities of cells were manually quantified through gray values by drawing a polygon scan region of interest (ROI) across each cell using LAS X software 3.3.0. This fluorescence intensity signal was normalized against the background noise obtained from each experiment thus giving a range of normalized intensity values which were further used for statistical and data analyses as described by Safa et al. [<xref rid="pone.0215337.ref036" ref-type="bibr">36</xref>].</p>
    </sec>
  </sec>
  <sec id="sec008">
    <title>Theory</title>
    <p>The FluoroCellTrack algorithm consists of several steps as depicted in <xref ref-type="fig" rid="pone.0215337.g001">Fig 1</xref>. This schematic outlines the pipeline that can quantify a wide range of data generated using the microfluidic droplet trapping array. The algorithm begins with a basic feature to read fluorescent microscopic images that were collected and stored in folders. Approximately 30–40 unprocessed, overlaid brightfield and fluorescent images were batch fed into the algorithm. The major steps of the algorithm included: (1) pre-processing to remove noise from the images; (2) feature detection including droplet and contour detection; (3) post-processing to extract essential information from the images; and (4) exporting the results for additional analyses. All the processing steps involved 16-bit processing techniques.</p>
    <fig id="pone.0215337.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0215337.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Outline of the FluoroCellTrack algorithm.</title>
        <p>The starting and ending points are depicted by ovals, the input and output commands are depicted by parallelograms, the processing steps are rectangles, and the decision steps are diamonds. The green arrows denote the steps in droplet detection, the blue arrows show contour detection, and the purple arrows represent information extracted from combining droplet and contour outputs. The dotted lines represent extended applications of the algorithm.</p>
      </caption>
      <graphic xlink:href="pone.0215337.g001"/>
    </fig>
    <sec id="sec009">
      <title>Droplet detection</title>
      <p>The steps used to identify droplets trapped in the microfluidic device were accomplished using Hough Transform, which is a basic technique for digital image processing to detect different shapes.[<xref rid="pone.0215337.ref042" ref-type="bibr">42</xref>] Here, a specific Circular Hough Transform (CHT) was used to extract information about circles from the input images [<xref rid="pone.0215337.ref043" ref-type="bibr">43</xref>, <xref rid="pone.0215337.ref044" ref-type="bibr">44</xref>]. Prior to detecting the circles (droplets), the input microscopy overlay image (<italic>img</italic>) was smoothened to remove noise over signal as shown in Eq (<xref ref-type="disp-formula" rid="pone.0215337.e001">1</xref>), where <italic>S</italic> is the smoothening function and the extent of smoothening is decided with a median filter, <italic>M</italic>.
<disp-formula id="pone.0215337.e001"><alternatives><graphic xlink:href="pone.0215337.e001.jpg" id="pone.0215337.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msub><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mo>*</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives><label>(1)</label></disp-formula>
The smoothened grayscale image (<italic>img</italic><sub><italic>(D</italic>, <italic>gray)</italic></sub><italic>)</italic> was further used as an input for the CHT function to detect circles. The parameterization of a circle was described with three features: the center <italic>(a</italic>,<italic>b)</italic> and radius <italic>R</italic>. The equations of a circle in <italic>xy</italic> space is written as:
<disp-formula id="pone.0215337.e002"><alternatives><graphic xlink:href="pone.0215337.e002.jpg" id="pone.0215337.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>θ</mml:mi></mml:math></alternatives><label>(2)</label></disp-formula>
<disp-formula id="pone.0215337.e003"><alternatives><graphic xlink:href="pone.0215337.e003.jpg" id="pone.0215337.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">Ѳ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>360</mml:mn></mml:math></alternatives><label>(3)</label></disp-formula>
Using CHT, triplets <italic>(x</italic>,<italic>y</italic>,<italic>R)</italic> were identified that were highly likely to be the parameters of the circle. Next, it was assumed that R was a known quantity and <italic>(a</italic>,<italic>b)</italic> were unknown due to the fact that droplets with known radii must be detected from the input image. Eqs (<xref ref-type="disp-formula" rid="pone.0215337.e002">2</xref>) and (<xref ref-type="disp-formula" rid="pone.0215337.e003">3</xref>) were rearranged into <italic>ab</italic> space as follows:
<disp-formula id="pone.0215337.e004"><alternatives><graphic xlink:href="pone.0215337.e004.jpg" id="pone.0215337.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>θ</mml:mi></mml:math></alternatives><label>(4)</label></disp-formula>
<disp-formula id="pone.0215337.e005"><alternatives><graphic xlink:href="pone.0215337.e005.jpg" id="pone.0215337.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">Ѳ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>360</mml:mn></mml:math></alternatives><label>(5)</label></disp-formula>
As θ sweeps between 0° - 360°, every point <italic>(x</italic><sub><italic>n</italic></sub>,<italic>y</italic><sub><italic>n</italic></sub><italic>)</italic> in the <italic>xy</italic> space is equivalent to a circle in the <italic>ab</italic> space. The steps used to detect circles with respective parameterization are as follows:</p>
      <list list-type="order">
        <list-item>
          <p>Load the smoothened image. The smoothened grayscale image <italic>img</italic><sub><italic>(D</italic>,<italic>gray)</italic></sub> was considered as the <italic>input array</italic>.</p>
        </list-item>
        <list-item>
          <p>The known R values of the droplets were given minimum and maximum range of 25 and 50 microns (due to occasional experimental inconsistency leading in generation of droplets of varied sizes). For these known <italic>R</italic> values, detect edges in the <italic>xy</italic> space and create a binary image.</p>
        </list-item>
        <list-item>
          <p>For every detected ‘edge pixel’ in the <italic>xy</italic> space, an equivalent circle is drawn in the ab space. This edge detection step involves efficient thresholding.</p>
          <p><disp-formula id="pone.0215337.e006"><alternatives><graphic xlink:href="pone.0215337.e006.jpg" id="pone.0215337.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>H</mml:mi><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives><label>(6)</label></disp-formula>
where, <inline-formula id="pone.0215337.e007"><alternatives><graphic xlink:href="pone.0215337.e007.jpg" id="pone.0215337.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:msubsup><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>∇</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
<disp-formula id="pone.0215337.e008"><alternatives><graphic xlink:href="pone.0215337.e008.jpg" id="pone.0215337.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></alternatives><label>(7)</label></disp-formula>
<disp-formula id="pone.0215337.e009"><alternatives><graphic xlink:href="pone.0215337.e009.jpg" id="pone.0215337.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>L</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mi>G</mml:mi><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></alternatives><label>(8)</label></disp-formula>
<disp-formula id="pone.0215337.e010"><alternatives><graphic xlink:href="pone.0215337.e010.jpg" id="pone.0215337.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>⃘</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:math></alternatives><label>(9)</label></disp-formula>
<disp-formula id="pone.0215337.e011"><alternatives><graphic xlink:href="pone.0215337.e011.jpg" id="pone.0215337.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives><label>(10)</label></disp-formula>
where, <inline-formula id="pone.0215337.e012"><alternatives><graphic xlink:href="pone.0215337.e012.jpg" id="pone.0215337.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mo>*</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mi>∇</mml:mi><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="0.25em"/><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>M</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></inline-formula>
<disp-formula id="pone.0215337.e013"><alternatives><graphic xlink:href="pone.0215337.e013.jpg" id="pone.0215337.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>⊕</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives><label>(11)</label></disp-formula>
<disp-formula id="pone.0215337.e014"><alternatives><graphic xlink:href="pone.0215337.e014.jpg" id="pone.0215337.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>⊖</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives><label>(12)</label></disp-formula>
<disp-formula id="pone.0215337.e015"><alternatives><graphic xlink:href="pone.0215337.e015.jpg" id="pone.0215337.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∊</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:math></alternatives><label>(13)</label></disp-formula>
where, <italic>I</italic> is the predefined label</p>
        </list-item>
        <list-item>
          <p>Cast ‘votes’ in the accumulator for every point in the ab space. The accumulator is a 2D array which holds the values of two parameters <italic>a</italic>,<italic>b</italic>.</p>
        </list-item>
        <list-item>
          <p>Points with the highest votes in the <italic>ab</italic> space were detected as droplet centers, which are stored in the <italic>output array</italic>, <italic>D</italic><sub><italic>centers</italic></sub>.</p>
        </list-item>
      </list>
      <p>The above steps describing the droplet detection are performed mathematically as shown in Eq (<xref ref-type="disp-formula" rid="pone.0215337.e006">6</xref>), where CHT is the mathematical function performed on the smoothened input image (<italic>img</italic><sub><italic>(D</italic>,<italic>gray)</italic></sub><italic>)</italic> with parameterization <italic>(param)</italic>, to yield the output array, <italic>D</italic><sub><italic>centers</italic></sub>. The CHT function as described earlier involves the detection of droplet centers <italic>[a</italic><sub><italic>max</italic></sub>, <italic>b</italic><sub><italic>max</italic></sub><italic>]</italic> by casting votes in the accumulator <italic>A</italic> when the hough gradient, <italic>∇g</italic> scans across all the pixels (<italic>x</italic><sub><italic>i</italic></sub>,<italic>y</italic><sub><italic>i</italic></sub> to <italic>x</italic><sub><italic>n</italic></sub>,<italic>y</italic><sub><italic>n</italic></sub>) of the <italic>img</italic><sub><italic>(D</italic>,<italic>gray)</italic></sub>. Once the CHT is implemented to the smoothened input image, the algorithm checks for the detected circles with the parameters as described. If the detected circles satisfy the parameters, the boundaries and centers of these circles are traced and printed. Thus, the number of droplets <italic>N</italic><sub><italic>droplets</italic></sub> is obtained by the length of the output array, <italic>D</italic><sub><italic>centers</italic></sub> as shown in (7).</p>
    </sec>
    <sec id="sec010">
      <title>Contour detection: Fluorescent regions of interest</title>
      <p>The fluorescent cells (NPs or any fluorescent regions) encapsulated within droplets in the microfluidic device were considered as contours. This detection step included several defining and processing steps outlined below:</p>
      <list list-type="order">
        <list-item>
          <p>Define arrays of color boundaries. Specific color boundaries for cells and luminescent NPs were assigned in this step.</p>
        </list-item>
        <list-item>
          <p>Create a mask by detecting colors with specified boundaries.</p>
        </list-item>
        <list-item>
          <p>Load input image, apply the mask, convert it to grayscale, and smoothen it.</p>
        </list-item>
        <list-item>
          <p>Perform edge detection, dilation, and erosion. This is followed by segmentation to detect attached contours.</p>
        </list-item>
        <list-item>
          <p>Find contours.</p>
        </list-item>
      </list>
      <p>Arrays of specific color boundaries were created to detect contours of specific interest. The contours of interest for cells were the colors green, red, and yellow. Yellow was used to denote the overlap between the live (green) cells and dead (red) cells in the small population that showed both fluorescent signals. The fine elements of image processing and the availability of the broad color palette was exploited here where color codes of magenta and blue were used for Europium (Eu<sup>3+</sup>)-doped NPs and Terbium (Tb<sup>3+</sup>)-doped NPs to avoid color overlap with live (also GFP) and dead cells (also RFP). The arrays for each color had a lower and an upper boundary limit to detect color in terms of blue, green, and red for BGR vector values. Once the values of lower and upper boundaries were defined, the colors with specified boundaries were detected from the input image (<italic>img</italic>) using respective <italic>BGR</italic>
<sub><italic>[upper</italic>, <italic>lower]</italic></sub>. After this step, a mask, <italic>C</italic><sub><italic>mask</italic></sub> was created by detecting respective colors when the function <italic>f</italic><sub><italic>CLR</italic></sub> was allowed to scan over each pixel <italic>x</italic><sub><italic>i</italic></sub>,<italic>y</italic><sub><italic>i</italic></sub> of the input image <italic>img</italic>. This mask was then overlaid on the input image which was then converted to grayscale and was smoothened (S) to filter signal from noise, thus yielding <italic>C</italic><sub><italic>gray</italic></sub> as shown in Eqs (<xref ref-type="disp-formula" rid="pone.0215337.e009">8</xref>) and (<xref ref-type="disp-formula" rid="pone.0215337.e010">9</xref>). This masking step was done to ensure the exact mapping of fluorescent layer with that of the brightfield, where even the weakest signal from the contour will be finely detected.</p>
      <p>The masked, image (<italic>C</italic><sub><italic>gray</italic></sub>) was subjected to several processing steps before detecting contours. The first processing step was to detect edges using Canny Edge Detector [<xref rid="pone.0215337.ref045" ref-type="bibr">45</xref>]. As described in Eq (<xref ref-type="disp-formula" rid="pone.0215337.e011">10</xref>), the Canny Edge Detector involved smoothening of <italic>C</italic><sub><italic>gray</italic></sub> with median filter <italic>M</italic>, followed by computing the gradient, <italic>∇f</italic> of this smoothened image to finally threshold it through non-maxima suppression (<italic>M</italic><sub><italic>T</italic></sub>) to detect edges. The detected edges between the minimum and maximum threshold values (<italic>T</italic>) were finally used to plot the resultant edge map (<italic>C</italic><sub><italic>edge</italic></sub>). This binary edge map was then subjected to the morphological operations erosion and dilation as shown in Eqs (<xref ref-type="disp-formula" rid="pone.0215337.e013">11</xref>) and (<xref ref-type="disp-formula" rid="pone.0215337.e014">12</xref>). These two functions were used to process images based on their shapes by convolving structural kernels (D, E) with the edge map (<italic>C</italic><sub><italic>edge</italic></sub>). The dilation function was used to join broken parts of the object edges and accentuate the features. This dilation step was followed by the erosion step, to remove white noise and to detach two connecting objects.</p>
      <p>The resultant processed image (<italic>C</italic><sub><italic>erode</italic></sub>) was then put through the random walker segmentation algorithm [<xref rid="pone.0215337.ref046" ref-type="bibr">46</xref>] to distinguish attached contours. As denoted in Eq (<xref ref-type="disp-formula" rid="pone.0215337.e015">13</xref>), this segmentation function was executed by comparing each pixel of the image, <italic>C</italic><sub><italic>erode</italic></sub> to a predefined label (<italic>I</italic>) and thus determining the probability of this comparison to finally enhance local maxima of each of the attached individual contour. The final step was to highlight contours through contour retrieval and approximation method. Each detected, segmented contour was stored as a vector of points in the output array <italic>C</italic><sub><italic>out</italic></sub>. The detected contour values in this array were checked for convexity defects using convex hull adjustment function which was similar to the contour approximation method but, checked for bulged-out or flat curves within a contour and approximated them by drawing a defined boundary. In order to effectively detect live/dead/overlapping (dying) cells and NPs, the outlined cell contours were checked for their area. This step was included to exclude cellular or experimental debris from quantification. In case of measuring intracellular fluorescence corresponding to CPP uptake in intact cells, the mean and variance values of each of the positively detected cell contour boundaries were calculated. Next, information about single versus multiple cell encapsulation efficiencies and droplet tracking data was extracted by convolving the detected droplet center map (<italic>D</italic><sub><italic>centers</italic></sub>) over the detected contours center map (<italic>C</italic><sub><italic>centers</italic></sub>). The droplet centers were used as an axis center and the minimum and maximum R values of 25 and 50 microns were used to scan the overlapped contour positions. The positively overlapped cell counters within droplets gave information about single cell encapsulation versus multiple cell encapsulation in the droplets. This analysis further provided insight on the spatial location of single cells and NPs co-encapsulated in a single droplet to provide information on cellular tracking within droplets. All of these output data were exported to suitable formats (.<italic>csv</italic> or .<italic>txt</italic>) for further population analysis. Additionally, it is to be noted that the trap centers in the droplet microfluidic device follow a hexagonal pattern with an exact radius of 35 μm and are placed equidistantly at 360 μm from each other. This was used as an advantage to eliminate multiple droplets within a trap during image pixel scan, where droplet centers once overlapped with contour centers are tested for equidistance (350-370-pixel length) thus aiding in elimination of multiple droplets.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec011">
    <title>Results and discussion</title>
    <sec id="sec012">
      <title>Droplet and contour detection: Validation of theory</title>
      <p>The droplet and contour detection steps of FluoroCellTrack resulted in the successful detection of features, quantification of single versus multiple cells encapsulated in aqueous droplets trapped in the array as well as identifying the individual fluorescent cellular response to different input conditions. FluoroCellTrack was able to read the input folders, each consisting of ~30–40 microscopy images (.<italic>tiff</italic> format was used here). The CHT mathematical function enabled facile and efficient detection of circular features from the images. Droplets with R values ranging from 25 to 50 microns were detected which demonstrated that results from experimental inconsistency could also be included in quantification. This CHT step proved to be a powerful feature detection tool over the edge detection feature, which has been conventionally used [<xref rid="pone.0215337.ref047" ref-type="bibr">47</xref>, <xref rid="pone.0215337.ref048" ref-type="bibr">48</xref>]. In order to compare CHT and conventional thresholding, both of the algorithms were run side-by-side (<xref ref-type="fig" rid="pone.0215337.g002">Fig 2</xref>). Here, manual thresholding with the edge detector function lacked the sensitivity and specificity needed for accurate detection. Specifically, the lower threshold values led to noise retainment resulting in false positives and higher values resulting in data removal (<xref ref-type="fig" rid="pone.0215337.g002">Fig 2</xref>, dashed white boxes). Data smoothening with a median kernel followed by CHT led to precise detection of circular features with their centers and boundaries of exactly 25&lt;R&lt;50 microns. Through CHT, the local maxima of each of the droplet was precisely mapped where the detected droplets boundaries and centers were highlighted in green and orange. These marked centers were finally counted to detect the total number of droplets. Since the majority of the droplet microfluidic data consists of circular features of known R values, CHT plays the ideal function in detecting such features. It is to be noted that, the CHT function lags behind in analyzing systems with circular features of unknown R values and thus, it can be replaced by the modified canny edge detector function as recently discussed [<xref rid="pone.0215337.ref049" ref-type="bibr">49</xref>]. Additionally, for systems which generate non-circular droplets (i.e. oval or ellipse), the Fast Ellipse Hough Transform (FEHT), as previously discussed by Xie et al. and Wong et al. [<xref rid="pone.0215337.ref050" ref-type="bibr">50</xref>, <xref rid="pone.0215337.ref051" ref-type="bibr">51</xref>] can be implemented over CHT. The FEHT works in similar way to that of the CHT with a distinguished parameterization of major and minor axes (circles are nothing but special case of an ellipse, where the major and minor axes are equal). In summary, this droplet detection can be used as a stand-alone step for different applications: in characterizing droplet parameters [<xref rid="pone.0215337.ref032" ref-type="bibr">32</xref>], to quantify lipid droplets shrinkage [<xref rid="pone.0215337.ref052" ref-type="bibr">52</xref>], to detect optimal concentration of fluorescent dye within droplet etc. [<xref rid="pone.0215337.ref053" ref-type="bibr">53</xref>, <xref rid="pone.0215337.ref054" ref-type="bibr">54</xref>].</p>
      <fig id="pone.0215337.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0215337.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Comparison of edge detector and CHT in detecting droplets.</title>
          <p>Left: The edge detector function involved manual thresholding resulted in incorrect detection: low T led to false positive values while high T led to data destruction, as highlighted in dashed white boxes. Right: CHT resulted in precise detection of droplets with exact requirement of 25&lt;R&lt;50 microns, as highlighted in white boxes. CHT outlined the droplets with green boundaries and orange centers which were finally counted for further analysis. Scale bar represents 70 μm.</p>
        </caption>
        <graphic xlink:href="pone.0215337.g002"/>
      </fig>
      <p>Next, contour detection was implemented to detect cellular features as shown in <xref ref-type="fig" rid="pone.0215337.g003">Fig 3</xref>. First, a mask was generated by detecting differently colored cells from the input image, <xref ref-type="fig" rid="pone.0215337.g003">Fig 3A</xref>. This mask (<xref ref-type="fig" rid="pone.0215337.g003">Fig 3B</xref>) was overlapped with the input image and was subjected to edge detection, dilation and erosion to yield <xref ref-type="fig" rid="pone.0215337.g003">Fig 3C</xref>, which was then segmented through random walker algorithm to detect and distinguish attached cells. Random walker segmentation algorithm was used over traditional watershed algorithm due to its highly precise probabilistic interpretation of local maxima [<xref rid="pone.0215337.ref055" ref-type="bibr">55</xref>, <xref rid="pone.0215337.ref056" ref-type="bibr">56</xref>] (<xref ref-type="fig" rid="pone.0215337.g003">Fig 3D</xref>). The distinguished contours from this image were then filtered for area, where cellular area equal to or greater than 130 pixels were outlined and labeled as shown in <xref ref-type="fig" rid="pone.0215337.g003">Fig 3E</xref>. 130 was selected as the thresholding value due to the mean cellular area being ~140 pixels. This step was essential to exclude debris to eliminate false positives. However, in case of co-culture platforms, where primary cells are of the same size as that of the secondary cells [<xref rid="pone.0215337.ref057" ref-type="bibr">57</xref>, <xref rid="pone.0215337.ref058" ref-type="bibr">58</xref>], or in systems where the debris is of the same size as that of the cells, specific cellular or organelle staining can be used to distinguish these features and the extensive palette used in computer vision aids in easy detection of such features. This contour detection step used here was found to be technically stronger than the template matching feature during the initial stages of the development of FluoroCellTrack, which is a commonly used technique in digital image analysis to find small parts of an image that match the template image [<xref rid="pone.0215337.ref027" ref-type="bibr">27</xref>]. For instance, similar features with slight deviations in shape, size and orientation were easily detected by the droplet/contour detection steps of FluoroCellTrack but would need a repository of many templates while using the template matching feature, showing that the latter can be highly uneconomical. The broad palette of colors in computer vision can be exploited here to detect any fluorescent cell and as an example here, the contour detection step was implemented to quantify actual cellular viability data as shown in <xref ref-type="fig" rid="pone.0215337.g004">Fig 4</xref>. Lower [B, G, R]: [0, 51, 0] and upper [B, G, R]: [153, 255, 153] boundaries were given for live cells and, dead cells were identified with the lower and upper color boundaries at [0, 0, 51]; [153, 153, 255] while overlapping cells were identified with lower and upper color boundaries of [0, 51, 51]; [153, 255, 255]. Cells with overlapping signals in both the green and red filter sets represent cells with compromised plasma membranes (indicative of a dead cell), but with remaining esterase activity to react with the Calcein AM. These cells were noted as ‘dying’ cells to distinguish them from the clean live and dead signals using the other contour boundaries. The contours with specific colors were detected from the input images, where the positively detected live, dead and overlapping cells with an area equal to or greater than 130 pixels were outlined with distinct colors: live cells in red, dead cells in blue and overlapping cells in purple (<xref ref-type="fig" rid="pone.0215337.g004">Fig 4</xref>). The outlined cell-center map was overlaid with the droplet center map and scanned to fit within 25&lt;R&lt;50-micron values (denoted by white arrows), to account for single/multiple cell encapsulation information as shown in the output data of <xref ref-type="fig" rid="pone.0215337.g004">Fig 4</xref>. This step was essential to calculate the single-cell encapsulation efficiency and to eliminate cells that were freely floating in the device, thus including cells that were only inside the droplets. Additionally, the user can easily eliminate the droplet detection step to use this contour detection as a stand-alone platform (similar to ImageJ and Cell Profiler) to detect and quantify properties of fluorescent cells from other microfluidic or non-microfluidic applications [<xref rid="pone.0215337.ref059" ref-type="bibr">59</xref>–<xref rid="pone.0215337.ref061" ref-type="bibr">61</xref>]. The advantage of FluoroCellTrack over current software tools like ImageJ and Cell Profiler lies in the fact that the former can be employed in non-droplet microfluidic platforms in addition to droplet microfluidics, but the latter cannot be used to quantify high-throughput droplet microfluidic data.</p>
      <fig id="pone.0215337.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0215337.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Steps involved in contour detection.</title>
          <p>A mask was generated from the input image (A) through definition of color boundaries. This mask was convolved with the input image, smoothened and converted to grayscale as shown in (B). Edge detection, dilation and erosion was performed on (B) to yield (C) which was then subjected to random walker segmentation to map the contour centers as shown in (D). The detected contours were finally checked for area where cellular area equal to or greater than 130 pixels were outlined and labeled (E). Scale bar represents 70 μm.</p>
        </caption>
        <graphic xlink:href="pone.0215337.g003"/>
      </fig>
      <fig id="pone.0215337.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0215337.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Quantification of encapsulation information.</title>
          <p>(A) The process of cell detection involved setting of color boundaries, edge detection, segmentation to finally generate ROIs around cells including live cells (green), dead cells (red) and overlapping cells (yellow) outlined in red, blue and purple. Differently colored ROIs are counted for respective type of cells (as shown in output). (B) Detection of droplets through CHT mark them with green outlines and orange centers. The overlapping droplet center map with cell center map and defining droplet axis centers and radius boundaries resulted in generation of encapsulation information in output data. Scale bar represents 70 μm.</p>
        </caption>
        <graphic xlink:href="pone.0215337.g004"/>
      </fig>
    </sec>
    <sec id="sec013">
      <title>Quantification of the single cell response to different doses of a drug</title>
      <p>An important application of any automated platform is to count cells and sort them based on their fluorescent response. As an example, the dose-dependent single cell response of OPM-2 cells to a clinical inhibitor, Bortezomib was observed. FluoroCellTrack quantified the heterogeneous responses of single OPM-2 cells treated with three doses of Bortezomib (1 nM, 10 nM and 100 nM) for three incubation periods (24 h, 48 h, and 72 h). A minimum of 275 cells (average 320 cells) and 787 droplets were analyzed for each condition at each time point and as a result, the cells were found to exhibit a decrease in viability at increasing concentrations and incubation times (<xref ref-type="supplementary-material" rid="pone.0215337.s004">S1 Table</xref>). To determine the accuracy of the algorithm, the results from the automated analysis were compared to a manual inspection of the images (<xref ref-type="fig" rid="pone.0215337.g005">Fig 5</xref>). The results obtained by FluoroCellTrack demonstrated an average of ~99% similarity for a triplicate analysis of the three described conditions, while requiring only &lt;1 min to quantify the entire population of cells compared to the ~60 min of for manual analysis. Beyond sorting cells based on cellular viability, this algorithm can easily be applied to several different platforms where fluorescent proteins, quantum dots, biosensors induced dynamic responses of cells are used as a metric to detect intracellular signaling, protein-protein interaction etc. [<xref rid="pone.0215337.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0215337.ref062" ref-type="bibr">62</xref>–<xref rid="pone.0215337.ref064" ref-type="bibr">64</xref>].</p>
      <fig id="pone.0215337.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0215337.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Comparison of FluoroCellTrack to manual inspection to quantify single OPM-2 cell viability.</title>
          <p>Cells were treated with different dozes of BTZ for 24 h (A), 48 h (B), and 72 h (C). An average of ~99% similarity was observed between the outputs of FluoroCellTrack and manual inspection in terms of single cell and multiple cell encapsulation (SCE and MCE) and assessment of cell viability. A minimum of 275 cells and n = 787 droplets were analyzed in each case.</p>
        </caption>
        <graphic xlink:href="pone.0215337.g005"/>
      </fig>
    </sec>
    <sec id="sec014">
      <title>Tracking of co-encapsulated single cells and luminescent nanoparticles</title>
      <p>The advantage of fluorescence microscopy coupled with automated analysis by FluoroCellTrack was exploited to quantify cellular tracking data in droplets that co-encapsulated single cells with luminescent nanoparticles as shown in <xref ref-type="fig" rid="pone.0215337.g006">Fig 6</xref>. The image acquisition system was designed with four different filter sets to capture GFP/live cells, RFP/dead cells, Eu<sup>3+</sup>-doped NPs, and Tb<sup>3+</sup> doped- NPs without any overlap between the images (<xref ref-type="fig" rid="pone.0215337.g006">Fig 6A</xref>). A similar approach for droplet identification and contour detection was applied here as described above. Luminescent nanoparticles were distinguished from cells based on the definition of color boundaries which was followed by area thresholding. An example of these steps is shown in <xref ref-type="fig" rid="pone.0215337.g006">Fig 6B</xref> for RFP-expressing MDA-MB-231 cells co-encapsulated with Eu<sup>3+</sup>-doped NPs. The process of contour detection involved two parallel loops to test for cellular color boundaries and for NP color boundaries. Since Eu<sup>3+</sup>-doped NPs and Tb<sup>3+</sup>-doped NPs had visual outputs in red and green (not to be overlapped with the output colors of dead and live cells), the Eu<sup>3+</sup>-doped NPs and Tb<sup>3+</sup>-doped NPs were assigned the color boundaries of magenta and blue to prevent misidentification with RFP/dead cells and GFP/live cells (<xref ref-type="fig" rid="pone.0215337.g006">Fig 6B</xref>). The color boundaries for cells were the same here as described above while the Eu<sup>3+</sup>-doped NPs were detected at lower and upper boundaries of [51, 0, 51]; [255, 102, 255] and Tb<sup>3+</sup>-doped NPs were detected between [51, 0, 0]; [255, 51, 51]. Following cell segmentation, the positive color-based selected contours were looped through area thresholding. Cell contours and NP contours equal to or greater than 130 and 150 pixels were filtered and any respective contour area below these values were ignored. 150 was selected as the area threshold value for NPs due to the mean area for NP clusters being 170. The detected contours in the specific boundaries of cells and NPs were outlined with distinct colors: Eu<sup>3+</sup>-doped NPs were outlined in yellow and RFP-MDA-MB-231 cells were outlined in blue (<xref ref-type="fig" rid="pone.0215337.g006">Fig 6B</xref>) while Tb<sup>3+</sup>-doped NP were outlined in orange and GFP-HeLa cells were outlined in red. The detected individual cell center and NP center maps were overlapped with droplet center maps and scanned for droplet boundaries to obtain information on co-encapsulation and droplet tracking. Following this, the droplet centers were finally checked for equidistance to eliminate multiple droplets as shown in output image of <xref ref-type="fig" rid="pone.0215337.g006">Fig 6B</xref>.</p>
      <fig id="pone.0215337.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0215337.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Identification of co-encapsulated single cells and NPs.</title>
          <p>A) Representative images of (i) GFP-HeLa cells and (ii) RFP-MDA MB 231 cells tracked by Eu<sup>3+</sup>-doped NPs and (iii) GFP-HeLa cells and (iv) RFP-MDA-MB-231 cells tracked by Tb<sup>3+</sup>-doped NPs. White boxes denote droplets co-encapsulated with cells and NPs. Eu<sup>3+</sup>-doped NPs and Tb<sup>3+</sup>-doped NPs are colored magenta and blue in (ii) and (iii) to distinguish them from RFP- and GFP-expressing cells. B) Approach to quantify droplet tracking data using an image from RFP-MDA-MB-231 cells co-encapsulated with Eu<sup>3+</sup>-doped NPs. Eu<sup>3+</sup>-doped NPs are outlined in yellow while RFP-MDA-MB-231 cells are outlined in blue. The single droplet represents the RFP-MDA-MB-231 cell being tracked by Eu<sup>3+</sup>-doped NPs. Scale bar represents 70 μm.</p>
        </caption>
        <graphic xlink:href="pone.0215337.g006"/>
      </fig>
      <p>FluoroCellTrack was able to identify and sort different subpopulations of droplets with respect to single versus multiple cell encapsulation coupled with droplet tracking by co-encapsulation with rare earth (RE)-doped NPs (<xref ref-type="supplementary-material" rid="pone.0215337.s005">S2 Table</xref>). The output from FluoroCellTrack was compared to manual assessment of the data (<xref ref-type="fig" rid="pone.0215337.g007">Fig 7</xref>), where a maximum of 787 droplets were analyzed per experiment and was found to exhibit an average of ~97–99% similarity to manual counting for a duplicate analysis of each case, while taking &lt;5 min to complete the analysis compared to ~60 min required for manual inspection. This algorithm was further used to quantify other tracking experiments involving live, dead, and overlapping MDA-MB-231 cells with both RE-doped nanoparticles with similar similarities (as discussed by Vaithiyanathan et al. in [<xref rid="pone.0215337.ref035" ref-type="bibr">35</xref>]). The ability to assign different color boundaries to distinguish cells from NPs highlights the utility of FluoroCellTrack in both cellomic and genomic applications. This algorithm can be used as an effective tool to analyze high-throughput multiplexed droplet microfluidic data [<xref rid="pone.0215337.ref037" ref-type="bibr">37</xref>, <xref rid="pone.0215337.ref065" ref-type="bibr">65</xref>], where more such luminescent NPs or other fluorescent trackers like droplet barcodes could be used to simultaneously track single cells from different input conditions on the same platform or in case of single cell sequencing (DNA or RNA) [<xref rid="pone.0215337.ref037" ref-type="bibr">37</xref>, <xref rid="pone.0215337.ref066" ref-type="bibr">66</xref>, <xref rid="pone.0215337.ref067" ref-type="bibr">67</xref>]. While this algorithm successfully quantified tracking information through cellular co-encapsulation, tracking can also be done in this system by simply labelling the droplets. The hexagonal geometry of trap centers in such droplet microfluidic array with each of the traps being equidistant at 360 μm from each other can be overlapped with the detected droplet centers in the process of labelling. Similar parameters can be used in different droplet microfluidic platforms in order to track droplets or other features.</p>
      <fig id="pone.0215337.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0215337.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Comparison of FluoroCellTrack to manual inspection of co-encapsulation droplet tracking data.</title>
          <p>Droplet subpopulation identification was performed for RFP-expressing MDA-MB-231 cells tracked by (A) Eu<sup>3+</sup>-doped NPs and (B) Tb<sup>3+</sup>-doped NPs. SC-single cells, MC-multiple cells. n = 787 droplets were analyzed for each experiment.</p>
        </caption>
        <graphic xlink:href="pone.0215337.g007"/>
      </fig>
    </sec>
    <sec id="sec015">
      <title>Quantification of intracellular fluorescence intensity corresponding to cell penetrating peptide uptake in intact single cells</title>
      <p>Prior work by Safa et al. [<xref rid="pone.0215337.ref036" ref-type="bibr">36</xref>] quantified CPP uptake in intact cells using a droplet trapping array; however, the manual quantification of each experiment took ~20 h. FluoroCellTrack was tested to quantify the permeability of two novel CPPs reported by Safa et al. (RWRWR and OWRWR) in addition to two commercially available CPPs (ARG and TAT) [<xref rid="pone.0215337.ref036" ref-type="bibr">36</xref>, <xref rid="pone.0215337.ref041" ref-type="bibr">41</xref>]. The analysis of intracellular heterogeneity required enhancing the FluoroCellTrack algorithm to be able to distinguish subtle differences in fluorescent intensity of the cells. The algorithm was tuned using data from an experiment quantifying the uptake of 50 μM ARG in single, intact HeLa cells (<xref ref-type="fig" rid="pone.0215337.g008">Fig 8</xref>). Peptide uptake in intact cells was visualized using FAM-tagged peptides (<xref ref-type="fig" rid="pone.0215337.g008">Fig 8A</xref>). Droplets were detected using the methods described above (<xref ref-type="fig" rid="pone.0215337.g008">Fig 8B</xref>). Intact cells were detected between the color boundaries [0, 51, 0] and [153, 255, 153] followed by segmentation to discern between cells and debris. This was accomplished using an area thresholding step to remove anything below 130 pixels (<xref ref-type="fig" rid="pone.0215337.g008">Fig 8C</xref>). The contour center map was overlaid with the droplet center map to provide information on the droplet count and cell encapsulation efficiency as shown in the output data from <xref ref-type="fig" rid="pone.0215337.g008">Fig 8D</xref>. The mean pixel values within each of the contours were extracted and tabulated to quantify intracellular fluorescence. These values were in the range of [0–65536] pixels and corresponded to the fluorescence uptake of the CPPs within each cell (an example output intracellular fluorescence data was obtained and is shown in <xref ref-type="fig" rid="pone.0215337.g008">Fig 8D</xref>). Each of these mean cellular fluorescence intensity values were exported to .<italic>csv</italic> format for further population analysis. Representative data of HeLa cells incubated with 50 μM concentrations of the four CPPs are shown in <xref ref-type="supplementary-material" rid="pone.0215337.s006">S3 Table</xref>, which list the mean fluorescence values from each experiment. The values calculated by FluoroCellTrack were ~92–98% similar on an average, to those obtained by manual analysis of the population of cells [<xref rid="pone.0215337.ref036" ref-type="bibr">36</xref>]. The small variation between the values calculated by FluoroCellTrack and manual inspection could be attributed to the bias in manual quantification which involved manual boundary identification over automated identification using FluoroCellTrack. A similar trend was observed with lower concentrations of these peptides (10 μM), which was also captured by FluoroCellTrack. The time required to analyze each data set was dramatically reduced using FluoroCellTrack which took &lt;30 minutes/experiment compared to &gt;20 hours/experiment needed for manual inspection.</p>
      <fig id="pone.0215337.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0215337.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Quantification of intracellular fluorescence using FluoroCellTrack for the uptake of 50 μM ARG.</title>
          <p>The input image (A) of single HeLa cells containing the ARG peptide was processed to detect droplets (B). (C) Cell detection required area thresholding to filter out debris (dashed white box) from cells (white box) trapped in droplets. (D) Overlapping of droplet center and contour maps produced output data consisting of encapsulation and intracellular fluorescence information.</p>
        </caption>
        <graphic xlink:href="pone.0215337.g008"/>
      </fig>
      <p>In addition to quantifying mean fluorescence values, FluoroCellTrack was able to record minimum, maximum and variance in pixel values within each cell to further characterize intracellular peptide distribution. <xref ref-type="fig" rid="pone.0215337.g009">Fig 9</xref> contains example values obtained for a single cell incubated with 50 μM OWRWR, for which the maximum, minimum and variance values of grayscale intensity values were obtained from automated quantification (2546, 742, 24056). This was similar in trend to the values obtained by manual quantification (2387, 801, 24013), highlighting the utility of this algorithm for a broad application in understanding population heterogeneity. Beyond this broad application in understanding population heterogeneity through intracellular fluorescence, this algorithm can be combined with Spatial Intensity Distribution Analysis (SpIDA) to understand the cellular distribution of fluorescent stains or markers [<xref rid="pone.0215337.ref068" ref-type="bibr">68</xref>, <xref rid="pone.0215337.ref069" ref-type="bibr">69</xref>].</p>
      <fig id="pone.0215337.g009" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0215337.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <title>Quantification of intracellular parameters to understand heterogeneous peptide uptake.</title>
          <p>(A) The outlined fluorescent cell from the fluorescent channel of the input image was traced for its center map and the center was detected in red shown in (B). The 8-bit histogram plot was generated to observe the frequency of grayscale intensity values in (C) leading to the generation of maximum, minimum peak values of intensity along with variance in intensity values which is finally mapped into a 16-bit scale as shown in the output data (D). Scale bar represents 10 μm.</p>
        </caption>
        <graphic xlink:href="pone.0215337.g009"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec016">
    <title>Conclusions</title>
    <p>The multistep Python algorithm, FluoroCellTrack was developed to process and analyze folders of microscopy images obtained from global droplet microfluidic experimentation. The algorithm has several distinct features including the automatic detection of droplet subpopulations (e.g., empty droplets, droplets with single cells, droplets with multiple cells), the quantification of single cell responses to drugs, and the quantification of intracellular fluorescence in intact cells. FluoroCellTrack was successfully implemented in three different systems: (i) live/dead subpopulation studies to understand cellular responses to different doses of drugs, (ii) quantification of cell and nanoparticle co-encapsulation for droplet tracking information, and (iii) quantification of CPP uptake in single intact cells based on fluorescent intensity. This algorithm was found to be superior to the commonly used feature detection techniques like Edge Detector thresholding, template matching and had well-defined and precise steps to eliminate false positives such as debris (e.g., cell or peptide) across the trapping array. Manual control analyses conformed with the Python algorithm with an average similarity of ~92–99% from a mean population of 320 cells. Moreover, automated image analysis took about &lt;1 min to count all the cells trapped in the device and &lt;30 min to quantify the fluorescence intensity across the entire population of cells, proving it to be a powerful tool for microscopy data analysis. This was far superior to the ~60 min required for manual cell counting and ~20 h needed for manual analysis of intracellular fluorescence. While the work here demonstrated the utility of FluoroCellTrack with a low-throughput droplet data (~787 droplets), the algorithm has a potential to quantify high-throughput droplet data (~10,000 droplets) in a couple of hours in comparison to days of manual analysis. Finally, FluoroCellTrack was found to overcome the limitations of existing non-droplet microfluidic algorithms and has the potential to be integrated with several different types of microfluidic devices, trapping arrays and non-microfluidic platforms with easy user-defined modifications. Beyond tracking and quantifying intracellular fluorescence, this algorithm has multiple applications in tracking cellular movements, through time-lapse imaging and position detection and can also be potentially extended to understand subcellular molecular processes by analyzing intracellular localization of biochemical stains through intracellular pixel quantification.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec017">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0215337.s001">
      <label>S1 Method</label>
      <caption>
        <title>Cell culture and reagents.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0215337.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0215337.s002">
      <label>S2 Method</label>
      <caption>
        <title>Design and fabrication of the microfluidic device.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0215337.s002.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0215337.s003">
      <label>S3 Method</label>
      <caption>
        <title>Experimental set up.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0215337.s003.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0215337.s004">
      <label>S1 Table</label>
      <caption>
        <title>Automated quantification of single OPM-2 cell response to different doses of Bortezomib.</title>
        <p>A minimum of 275 cells and n = 787 droplets were analyzed for each case.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0215337.s004.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0215337.s005">
      <label>S2 Table</label>
      <caption>
        <title>Quantification of droplet tracking data by FluoroCellTrack.</title>
        <p>Information on droplet subpopulations and cell encapsulation obtained from two individual experiments where RFP-expressing MDA-MB-231 cells were co-encapsulated with Eu<sup>3+</sup>-doped NPs and Tb<sup>3+</sup>-doped NPs. n = 787 droplets were analyzed in each case.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0215337.s005.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0215337.s006">
      <label>S3 Table</label>
      <caption>
        <title>Comparison of mean intracellular fluorescence representative of CPP uptake in HeLa cells using FluoroCellTrack.</title>
        <p>A minimum of 142 cells (maximum 367 cells) were analyzed in these experiments.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0215337.s006.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors would like to thank Dr. Nancy Allbritton (UNC) for supplying the GFP-expressing HeLa cells and OPM2 cells and Dr. Elizabeth Martin (LSU) for supplying the RFP-expressing MDA-MB-231 cells. The authors would also like to thank Dr. Michael Benton (Chemical Engineering, LSU) for insightful discussions during the development of the manuscript.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0215337.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Takehara</surname><given-names>H</given-names></name>, <name><surname>Kazutaka</surname><given-names>O</given-names></name>, <name><surname>Haruta</surname><given-names>M</given-names></name>, <name><surname>Noda</surname><given-names>T</given-names></name>, <name><surname>Sasagawa</surname><given-names>K</given-names></name>, <name><surname>Tokuda</surname><given-names>T</given-names></name>, <etal>et al</etal><article-title>On-chip cell analysis platform: Implementation of contact fluorescence microscopy in microfluidic chips</article-title>. <source>AIP Advances</source>. <year>2017</year>;<volume>7</volume>(<issue>9</issue>):<fpage>095213</fpage><pub-id pub-id-type="doi">10.1063/1.4986872</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Lin</surname><given-names>S-W</given-names></name>, <name><surname>Chang</surname><given-names>C-H</given-names></name>, <name><surname>Lin</surname><given-names>C-H</given-names></name>. <article-title>High-throughput fluorescence detections in microfluidic systems</article-title>. <source>Genomic Medicine, Biomarkers, and Health Sciences</source>. <year>2011</year>;<volume>3</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>38</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Yin</surname><given-names>H</given-names></name>, <name><surname>Marshall</surname><given-names>D</given-names></name>. <article-title>Microfluidics for single cell analysis</article-title>. <source>Curr Opin Biotechnol</source>. <year>2012</year>;<volume>23</volume>(<issue>1</issue>):<fpage>110</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1016/j.copbio.2011.11.002</pub-id><?supplied-pmid 22133547?><pub-id pub-id-type="pmid">22133547</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Jin</surname><given-names>SH</given-names></name>, <name><surname>Jeong</surname><given-names>H-H</given-names></name>, <name><surname>Lee</surname><given-names>B</given-names></name>, <name><surname>Lee</surname><given-names>SS</given-names></name>, <name><surname>Lee</surname><given-names>C-S</given-names></name>. <article-title>A programmable microfluidic static droplet array for droplet generation, transportation, fusion, storage, and retrieval</article-title>. <source>Lab Chip</source>. <year>2015</year>;<volume>15</volume>(<issue>18</issue>):<fpage>3677</fpage>–<lpage>86</lpage>. <pub-id pub-id-type="doi">10.1039/c5lc00651a</pub-id><?supplied-pmid 26247820?><pub-id pub-id-type="pmid">26247820</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Brouzes</surname><given-names>E</given-names></name>, <name><surname>Medkova</surname><given-names>M</given-names></name>, <name><surname>Savenelli</surname><given-names>N</given-names></name>, <name><surname>Marran</surname><given-names>D</given-names></name>, <name><surname>Twardowski</surname><given-names>M</given-names></name>, <name><surname>Hutchison</surname><given-names>JB</given-names></name>, <etal>et al</etal><article-title>Droplet microfluidic technology for single-cell high-throughput screening</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2009</year>;<volume>106</volume>(<issue>34</issue>):<fpage>14195</fpage>–<lpage>200</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0903542106</pub-id><?supplied-pmid 19617544?><pub-id pub-id-type="pmid">19617544</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Zhu</surname><given-names>Y</given-names></name>, <name><surname>Fang</surname><given-names>Q</given-names></name>. <article-title>Analytical detection techniques for droplet microfluidics—A review</article-title>. <source>Anal Chim Acta</source>. <year>2013</year>;<volume>787</volume>:<fpage>24</fpage>–<lpage>35</lpage>. <pub-id pub-id-type="doi">10.1016/j.aca.2013.04.064</pub-id><?supplied-pmid 23830418?><pub-id pub-id-type="pmid">23830418</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Etcheverry</surname><given-names>S</given-names></name>, <name><surname>Faridi</surname><given-names>A</given-names></name>, <name><surname>Ramachandraiah</surname><given-names>H</given-names></name>, <name><surname>Kumar</surname><given-names>T</given-names></name>, <name><surname>Margulis</surname><given-names>W</given-names></name>, <name><surname>Laurell</surname><given-names>F</given-names></name>, <etal>et al</etal><article-title>High performance micro-flow cytometer based on optical fibres</article-title>. <source>Scientific Reports</source>. <year>2017</year>;<volume>7</volume>(<issue>1</issue>):<fpage>5628</fpage><pub-id pub-id-type="doi">10.1038/s41598-017-05843-7</pub-id><?supplied-pmid 28717236?><pub-id pub-id-type="pmid">28717236</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Z</given-names></name>, <name><surname>Nagrath</surname><given-names>S</given-names></name>. <article-title>Microfluidics and cancer: are we there yet?</article-title><source>Biomedical microdevices</source>. <year>2013</year>;<volume>15</volume>(<issue>4</issue>):<fpage>595</fpage>–<lpage>609</lpage>. <pub-id pub-id-type="doi">10.1007/s10544-012-9734-8</pub-id><?supplied-pmid 23358873?><pub-id pub-id-type="pmid">23358873</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>SC</given-names></name>, <name><surname>Clark</surname><given-names>IC</given-names></name>, <name><surname>Shahi</surname><given-names>P</given-names></name>, <name><surname>Abate</surname><given-names>AR</given-names></name>. <article-title>Single-cell RT-PCR in microfluidic droplets with integrated chemical lysis</article-title>. <source>Anal Chem</source>. <year>2018</year>;<volume>90</volume>(<issue>2</issue>):<fpage>1273</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.7b04050</pub-id><?supplied-pmid 29256243?><pub-id pub-id-type="pmid">29256243</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Huebner</surname><given-names>A</given-names></name>, <name><surname>Bratton</surname><given-names>D</given-names></name>, <name><surname>Whyte</surname><given-names>G</given-names></name>, <name><surname>Yang</surname><given-names>M</given-names></name>, <name><surname>Abell</surname><given-names>C</given-names></name>, <name><surname>Hollfelder</surname><given-names>F</given-names></name>. <article-title>Static microdroplet arrays: a microfluidic device for droplet trapping, incubation and release for enzymatic and cell-based assays</article-title>. <source>Lab Chip</source>. <year>2009</year>;<volume>9</volume>(<issue>5</issue>):<fpage>692</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1039/b813709a</pub-id><?supplied-pmid 19224019?><pub-id pub-id-type="pmid">19224019</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Dittrich</surname><given-names>PS</given-names></name>, <name><surname>Manz</surname><given-names>A</given-names></name>. <article-title>Lab-on-a-chip: microfluidics in drug discovery</article-title>. <source>Nature Reviews Drug Discovery</source>. <year>2006</year>;<volume>5</volume>:<fpage>210</fpage><pub-id pub-id-type="doi">10.1038/nrd1985</pub-id><?supplied-pmid 16518374?><pub-id pub-id-type="pmid">16518374</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Mazutis</surname><given-names>L</given-names></name>, <name><surname>Gilbert</surname><given-names>J</given-names></name>, <name><surname>Ung</surname><given-names>WL</given-names></name>, <name><surname>Weitz</surname><given-names>DA</given-names></name>, <name><surname>Griffiths</surname><given-names>AD</given-names></name>, <name><surname>Heyman</surname><given-names>JA</given-names></name>. <article-title>Single-cell analysis and sorting using droplet-based microfluidics</article-title>. <source>Nat Protoc</source>. <year>2013</year>;<volume>8</volume>:<fpage>870</fpage><pub-id pub-id-type="doi">10.1038/nprot.2013.046</pub-id><ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/nprot.2013.046#supplementary-information">https://www.nature.com/articles/nprot.2013.046#supplementary-information</ext-link>. <?supplied-pmid 23558786?><pub-id pub-id-type="pmid">23558786</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Utharala</surname><given-names>R</given-names></name>, <name><surname>Tseng</surname><given-names>Q</given-names></name>, <name><surname>Furlong</surname><given-names>EE</given-names></name>, <name><surname>Merten</surname><given-names>CA</given-names></name>. <article-title>A Versatile, Low-Cost, Multiway Microfluidic Sorter for Droplets, Cells, and Embryos</article-title>. <source>Anal Chem</source>. <year>2018</year>;<volume>90</volume>(<issue>10</issue>):<fpage>5982</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.7b04689</pub-id><?supplied-pmid 29688703?><pub-id pub-id-type="pmid">29688703</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Huebner</surname><given-names>A</given-names></name>, <name><surname>Srisa-Art</surname><given-names>M</given-names></name>, <name><surname>Holt</surname><given-names>D</given-names></name>, <name><surname>Abell</surname><given-names>C</given-names></name>, <name><surname>Hollfelder</surname><given-names>F</given-names></name>, <name><surname>Edel</surname><given-names>J</given-names></name>. <article-title>Quantitative detection of protein expression in single cells using droplet microfluidics</article-title>. <source>Chemical communications</source>. <year>2007</year>;(<issue>12</issue>):<fpage>1218</fpage>–<lpage>20</lpage>. <pub-id pub-id-type="doi">10.1039/b618570c</pub-id><?supplied-pmid 17356761?><pub-id pub-id-type="pmid">17356761</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Chinen</surname><given-names>AB</given-names></name>, <name><surname>Guan</surname><given-names>CM</given-names></name>, <name><surname>Ferrer</surname><given-names>JR</given-names></name>, <name><surname>Barnaby</surname><given-names>SN</given-names></name>, <name><surname>Merkel</surname><given-names>TJ</given-names></name>, <name><surname>Mirkin</surname><given-names>CA</given-names></name>. <article-title>Nanoparticle probes for the detection of cancer biomarkers, cells, and tissues by fluorescence</article-title>. <source>Chem Rev</source>. <year>2015</year>;<volume>115</volume>(<issue>19</issue>):<fpage>10530</fpage>–<lpage>74</lpage>. <pub-id pub-id-type="doi">10.1021/acs.chemrev.5b00321</pub-id><?supplied-pmid 26313138?><pub-id pub-id-type="pmid">26313138</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Luka</surname><given-names>G</given-names></name>, <name><surname>Ahmadi</surname><given-names>A</given-names></name>, <name><surname>Najjaran</surname><given-names>H</given-names></name>, <name><surname>Alocilja</surname><given-names>E</given-names></name>, <name><surname>DeRosa</surname><given-names>M</given-names></name>, <name><surname>Wolthers</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>Microfluidics integrated biosensors: a leading technology towards lab-on-a-chip and sensing applications</article-title>. <source>Sensors</source>. <year>2015</year>;<volume>15</volume>(<issue>12</issue>):<fpage>30011</fpage>–<lpage>31</lpage>. <pub-id pub-id-type="doi">10.3390/s151229783</pub-id><?supplied-pmid 26633409?><pub-id pub-id-type="pmid">26633409</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Ghrera</surname><given-names>AS</given-names></name>, <name><surname>Pandey</surname><given-names>CM</given-names></name>, <name><surname>Ali</surname><given-names>MA</given-names></name>, <name><surname>Malhotra</surname><given-names>BD</given-names></name>. <article-title>Quantum dot-based microfluidic biosensor for cancer detection</article-title>. <source>Appl Phys Lett</source>. <year>2015</year>;<volume>106</volume>(<issue>19</issue>):<fpage>193703</fpage><pub-id pub-id-type="doi">10.1063/1.4921203</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Zilionis</surname><given-names>R</given-names></name>, <name><surname>Nainys</surname><given-names>J</given-names></name>, <name><surname>Veres</surname><given-names>A</given-names></name>, <name><surname>Savova</surname><given-names>V</given-names></name>, <name><surname>Zemmour</surname><given-names>D</given-names></name>, <name><surname>Klein</surname><given-names>AM</given-names></name>, <etal>et al</etal><article-title>Single-cell barcoding and sequencing using droplet microfluidics</article-title>. <source>Nat Protoc</source>. <year>2017</year>;<volume>12</volume>(<issue>1</issue>):<fpage>44</fpage>–<lpage>73</lpage>. Epub 2016/12/09. <pub-id pub-id-type="doi">10.1038/nprot.2016.154</pub-id> .<?supplied-pmid 27929523?><pub-id pub-id-type="pmid">27929523</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Klein</surname><given-names>AM</given-names></name>, <name><surname>Mazutis</surname><given-names>L</given-names></name>, <name><surname>Akartuna</surname><given-names>I</given-names></name>, <name><surname>Tallapragada</surname><given-names>N</given-names></name>, <name><surname>Veres</surname><given-names>A</given-names></name>, <name><surname>Li</surname><given-names>V</given-names></name>, <etal>et al</etal><article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source>. <year>2015</year>;<volume>161</volume>(<issue>5</issue>):<fpage>1187</fpage>–<lpage>201</lpage>. Epub 2015/05/23. <pub-id pub-id-type="doi">10.1016/j.cell.2015.04.044</pub-id><?supplied-pmid 26000487?><pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Schuler</surname><given-names>F</given-names></name>, <name><surname>Trotter</surname><given-names>M</given-names></name>, <name><surname>Geltman</surname><given-names>M</given-names></name>, <name><surname>Schwemmer</surname><given-names>F</given-names></name>, <name><surname>Wadle</surname><given-names>S</given-names></name>, <name><surname>Domínguez-Garrido</surname><given-names>E</given-names></name>, <etal>et al</etal><article-title>Digital droplet PCR on disk</article-title>. <source>Lab Chip</source>. <year>2016</year>;<volume>16</volume>(<issue>1</issue>):<fpage>208</fpage>–<lpage>16</lpage>. <pub-id pub-id-type="doi">10.1039/c5lc01068c</pub-id><?supplied-pmid 26610263?><pub-id pub-id-type="pmid">26610263</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Jeong</surname><given-names>H-H</given-names></name>, <name><surname>Jin</surname><given-names>SH</given-names></name>, <name><surname>Lee</surname><given-names>BJ</given-names></name>, <name><surname>Kim</surname><given-names>T</given-names></name>, <name><surname>Lee</surname><given-names>C-S</given-names></name>. <article-title>Microfluidic static droplet array for analyzing microbial communication on a population gradient</article-title>. <source>Lab Chip</source>. <year>2015</year>;<volume>15</volume>(<issue>3</issue>):<fpage>889</fpage>–<lpage>99</lpage>. <pub-id pub-id-type="doi">10.1039/c4lc01097c</pub-id><?supplied-pmid 25494004?><pub-id pub-id-type="pmid">25494004</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Shembekar</surname><given-names>N</given-names></name>, <name><surname>Chaipan</surname><given-names>C</given-names></name>, <name><surname>Utharala</surname><given-names>R</given-names></name>, <name><surname>Merten</surname><given-names>CA</given-names></name>. <article-title>Droplet-based microfluidics in drug discovery, transcriptomics and high-throughput molecular genetics</article-title>. <source>Lab Chip</source>. <year>2016</year>;<volume>16</volume>(<issue>8</issue>):<fpage>1314</fpage>–<lpage>31</lpage>. <pub-id pub-id-type="doi">10.1039/c6lc00249h</pub-id><?supplied-pmid 27025767?><pub-id pub-id-type="pmid">27025767</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Abalde-Cela</surname><given-names>S</given-names></name>, <name><surname>Gould</surname><given-names>A</given-names></name>, <name><surname>Liu</surname><given-names>X</given-names></name>, <name><surname>Kazamia</surname><given-names>E</given-names></name>, <name><surname>Smith</surname><given-names>AG</given-names></name>, <name><surname>Abell</surname><given-names>C</given-names></name>. <article-title>High-throughput detection of ethanol-producing cyanobacteria in a microdroplet platform</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2015</year>;<volume>12</volume>(<issue>106</issue>):<fpage>20150216</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Bell</surname><given-names>J</given-names></name>. <source>Microfluidic platform and fluorescent sensor particles for the detection of the herbicide 2, 4-D in worldwide samples</source>. <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Schneider</surname><given-names>CA</given-names></name>, <name><surname>Rasband</surname><given-names>WS</given-names></name>, <name><surname>Eliceiri</surname><given-names>KW</given-names></name>. <article-title>NIH Image to ImageJ: 25 years of image analysis</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>(<issue>7</issue>):<fpage>671</fpage><?supplied-pmid 22930834?><pub-id pub-id-type="pmid">22930834</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Kamentsky</surname><given-names>L</given-names></name>, <name><surname>Jones</surname><given-names>TR</given-names></name>, <name><surname>Fraser</surname><given-names>A</given-names></name>, <name><surname>Bray</surname><given-names>M-A</given-names></name>, <name><surname>Logan</surname><given-names>DJ</given-names></name>, <name><surname>Madden</surname><given-names>KL</given-names></name>, <etal>et al</etal><article-title>Improved structure, function and compatibility for CellProfiler: modular high-throughput image analysis software</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>8</issue>):<fpage>1179</fpage>–<lpage>80</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr095</pub-id><?supplied-pmid 21349861?><pub-id pub-id-type="pmid">21349861</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Kachouie</surname><given-names>N</given-names></name>, <name><surname>Kang</surname><given-names>L</given-names></name>, <name><surname>Khademhosseini</surname><given-names>A</given-names></name>. <article-title>Arraycount, an algorithm for automatic cell counting in microwell arrays</article-title>. <source>BioTechniques</source>. <year>2009</year>;<volume>47</volume>(<issue>3</issue>):<fpage>x</fpage>–<lpage>xvi</lpage>. Epub 2009/10/27. <pub-id pub-id-type="doi">10.2144/000113202</pub-id><?supplied-pmid 19852758?><pub-id pub-id-type="pmid">19852758</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Shields</surname><given-names>CW</given-names></name>, <name><surname>Ohiri</surname><given-names>KA</given-names></name>, <name><surname>Szott</surname><given-names>LM</given-names></name>, <name><surname>López</surname><given-names>GP</given-names></name>. <article-title>Translating microfluidics: Cell separation technologies and their barriers to commercialization</article-title>. <source>Cytometry Part B: Clinical Cytometry</source>. <year>2017</year>;<volume>92</volume>(<issue>2</issue>):<fpage>115</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.1002/cyto.b.21388</pub-id><?supplied-pmid 27282966?><pub-id pub-id-type="pmid">27282966</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Breitkreutz</surname><given-names>B-J</given-names></name>, <name><surname>Jorgensen</surname><given-names>P</given-names></name>, <name><surname>Breitkreutz</surname><given-names>A</given-names></name>, <name><surname>Tyers</surname><given-names>M</given-names></name>. <article-title>AFM 4.0: a toolbox for DNA microarray analysis</article-title>. <source>Genome biology</source>. <year>2001</year>;<volume>2</volume>(<issue>8</issue>):<fpage>software0001</fpage><lpage>1</lpage>. <?supplied-pmid 11532221?><pub-id pub-id-type="pmid">11532221</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Fielden</surname><given-names>M</given-names></name>, <name><surname>Halgren</surname><given-names>R</given-names></name>, <name><surname>Dere</surname><given-names>E</given-names></name>, <name><surname>Zacharewski</surname><given-names>T</given-names></name>. <article-title>GP3: GenePix post-processing program for automated analysis of raw microarray data</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>5</issue>):<fpage>771</fpage>–<lpage>3</lpage>. <?supplied-pmid 12050078?><pub-id pub-id-type="pmid">12050078</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Jeong</surname><given-names>J</given-names></name>, <name><surname>Frohberg</surname><given-names>NJ</given-names></name>, <name><surname>Zhou</surname><given-names>E</given-names></name>, <name><surname>Sulchek</surname><given-names>T</given-names></name>, <name><surname>Qiu</surname><given-names>P</given-names></name>. <article-title>Accurately tracking single-cell movement trajectories in microfluidic cell sorting devices</article-title>. <source>PloS one</source>. <year>2018</year>;<volume>13</volume>(<issue>2</issue>):<fpage>e0192463</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0192463</pub-id><?supplied-pmid 29414993?><pub-id pub-id-type="pmid">29414993</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Basu</surname><given-names>AS</given-names></name>. <article-title>Droplet morphometry and velocimetry (DMV): a video processing software for time-resolved, label-free tracking of droplet parameters</article-title>. <source>Lab Chip</source>. <year>2013</year>;<volume>13</volume>(<issue>10</issue>):<fpage>1892</fpage>–<lpage>901</lpage>. <pub-id pub-id-type="doi">10.1039/c3lc50074h</pub-id><?supplied-pmid 23567746?><pub-id pub-id-type="pmid">23567746</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Girault</surname><given-names>M</given-names></name>, <name><surname>Kim</surname><given-names>H</given-names></name>, <name><surname>Arakawa</surname><given-names>H</given-names></name>, <name><surname>Matsuura</surname><given-names>K</given-names></name>, <name><surname>Odaka</surname><given-names>M</given-names></name>, <name><surname>Hattori</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>An on-chip imaging droplet-sorting system: a real-time shape recognition method to screen target cells in droplets with single cell resolution</article-title>. <source>Scientific reports</source>. <year>2017</year>;<volume>7</volume>:<fpage>40072</fpage><pub-id pub-id-type="doi">10.1038/srep40072</pub-id><?supplied-pmid 28059147?><pub-id pub-id-type="pmid">28059147</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Feldman</surname><given-names>PM</given-names></name>. <source>Eight Advantages of Python Over Matlab</source>. <month>9</month>; <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Vaithiyanathan</surname><given-names>M</given-names></name>, <name><surname>Bajgiran</surname><given-names>KR</given-names></name>, <name><surname>Darapaneni</surname><given-names>P</given-names></name>, <name><surname>Safa</surname><given-names>N</given-names></name>, <name><surname>Dorman</surname><given-names>JA</given-names></name>, <name><surname>Melvin</surname><given-names>AT</given-names></name>. <article-title>Luminescent nanomaterials for droplet tracking in a microfluidic trapping array</article-title>. <source>Analytical and bioanalytical chemistry</source>. <year>2019</year>;<volume>411</volume>(<issue>1</issue>):<fpage>157</fpage>–<lpage>70</lpage>. <pub-id pub-id-type="doi">10.1007/s00216-018-1448-1</pub-id><?supplied-pmid 30483856?><pub-id pub-id-type="pmid">30483856</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Safa</surname><given-names>N</given-names></name>, <name><surname>Vaithiyanathan</surname><given-names>M.</given-names></name>, <name><surname>Sombolestani</surname><given-names>S.</given-names></name>, <name><surname>Charles</surname><given-names>S.</given-names></name>, &amp; <name><surname>Melvin</surname><given-names>A. T.</given-names></name>
<article-title>Population-based analysis of cell penetrating peptide uptake using a microfluidic droplet trapping array</article-title>. <source>Analytical and Bioanalytical Chemistry</source>. <italic>Accepted</italic>
<year>2019</year>.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Muluneh</surname><given-names>M</given-names></name>, <name><surname>Kim</surname><given-names>B</given-names></name>, <name><surname>Buchsbaum</surname><given-names>G</given-names></name>, <name><surname>Issadore</surname><given-names>D</given-names></name>. <article-title>Miniaturized, multiplexed readout of droplet-based microfluidic assays using time-domain modulation</article-title>. <source>Lab Chip</source>. <year>2014</year>;<volume>14</volume>(<issue>24</issue>):<fpage>4638</fpage>–<lpage>46</lpage>. <pub-id pub-id-type="doi">10.1039/c4lc00819g</pub-id><?supplied-pmid 25311204?><pub-id pub-id-type="pmid">25311204</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Kang</surname><given-names>HM</given-names></name>, <name><surname>Subramaniam</surname><given-names>M</given-names></name>, <name><surname>Targ</surname><given-names>S</given-names></name>, <name><surname>Nguyen</surname><given-names>M</given-names></name>, <name><surname>Maliskova</surname><given-names>L</given-names></name>, <name><surname>McCarthy</surname><given-names>E</given-names></name>, <etal>et al</etal><article-title>Multiplexed droplet single-cell RNA-sequencing using natural genetic variation</article-title>. <source>Nat Biotechnol</source>. <year>2017</year>;<volume>36</volume>:<fpage>89</fpage><pub-id pub-id-type="doi">10.1038/nbt.4042</pub-id><ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/nbt.4042#supplementary-information">https://www.nature.com/articles/nbt.4042#supplementary-information</ext-link>. <?supplied-pmid 29227470?><pub-id pub-id-type="pmid">29227470</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Thievessen</surname><given-names>I</given-names></name>, <name><surname>Fakhri</surname><given-names>N</given-names></name>, <name><surname>Steinwachs</surname><given-names>J</given-names></name>, <name><surname>Kraus</surname><given-names>V</given-names></name>, <name><surname>McIsaac</surname><given-names>RS</given-names></name>, <name><surname>Gao</surname><given-names>L</given-names></name>, <etal>et al</etal><article-title>Vinculin is required for cell polarization, migration, and extracellular matrix remodeling in 3D collagen</article-title>. <source>The FASEB Journal</source>. <year>2015</year>;<volume>29</volume>(<issue>11</issue>):<fpage>4555</fpage>–<lpage>67</lpage>. <pub-id pub-id-type="doi">10.1096/fj.14-268235</pub-id><?supplied-pmid 26195589?><pub-id pub-id-type="pmid">26195589</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Campbell</surname><given-names>J</given-names></name>, <name><surname>Balhoff</surname><given-names>J</given-names></name>, <name><surname>Landwehr</surname><given-names>G</given-names></name>, <name><surname>Rahman</surname><given-names>S</given-names></name>, <name><surname>Vaithiyanathan</surname><given-names>M</given-names></name>, <name><surname>Melvin</surname><given-names>A</given-names></name>. <article-title>Microfluidic and Paper-Based Devices for Disease Detection and Diagnostic Research</article-title>. <source>Int J Mol Sci</source>. <year>2018</year>;<volume>19</volume>(<issue>9</issue>):<fpage>2731</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Safa</surname><given-names>N</given-names></name>, <name><surname>Anderson</surname><given-names>JC</given-names></name>, <name><surname>Vaithiyanathan</surname><given-names>M</given-names></name>, <name><surname>Pettigrew</surname><given-names>JH</given-names></name>, <name><surname>Pappas</surname><given-names>GA</given-names></name>, <name><surname>Liu</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>CPProtectides: Rapid uptake of well‐folded β‐hairpin peptides with enhanced resistance to intracellular degradation</article-title>. <source>Peptide Science</source>. <year>2018</year>:<fpage>e24092</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref042">
      <label>42</label>
      <mixed-citation publication-type="other">Maji S, Malik J, editors. Object detection using a max-margin hough transform. Computer Vision and Pattern Recognition, 2009 CVPR 2009 IEEE Conference on; 2009: IEEE.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Pedersen</surname><given-names>SJK</given-names></name>. <article-title>Circular hough transform</article-title>. <source>Aalborg University, Vision, Graphics, and Interactive Systems</source>. <year>2007</year>;<volume>123</volume>:<fpage>123</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref044">
      <label>44</label>
      <mixed-citation publication-type="other">Yadav VK, Batham S, Acharya AK, Paul R, editors. Approach to accurate circle detection: circular hough transform and local maxima concept. Electronics and Communication Systems (ICECS), 2014 International Conference on; 2014: IEEE.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref045">
      <label>45</label>
      <mixed-citation publication-type="other">Rong W, Li Z, Zhang W, Sun L, editors. An improved CANNY edge detection algorithm. Mechatronics and Automation (ICMA), 2014 IEEE International Conference on; 2014: IEEE.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Grady</surname><given-names>L</given-names></name>. <article-title>Random walks for image segmentation</article-title>. <source>IEEE transactions on pattern analysis and machine intelligence</source>. <year>2006</year>;<volume>28</volume>(<issue>11</issue>):<fpage>1768</fpage>–<lpage>83</lpage>. <pub-id pub-id-type="doi">10.1109/TPAMI.2006.233</pub-id><?supplied-pmid 17063682?><pub-id pub-id-type="pmid">17063682</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Khorshidi</surname><given-names>MA</given-names></name>, <name><surname>Rajeswari</surname><given-names>PK</given-names></name>, <name><surname>Wahlby</surname><given-names>C</given-names></name>, <name><surname>Joensson</surname><given-names>HN</given-names></name>, <name><surname>Andersson Svahn</surname><given-names>H</given-names></name>. <article-title>Automated analysis of dynamic behavior of single cells in picoliter droplets</article-title>. <source>Lab Chip</source>. <year>2014</year>;<volume>14</volume>(<issue>5</issue>):<fpage>931</fpage>–<lpage>7</lpage>. Epub 2014/01/05. <pub-id pub-id-type="doi">10.1039/c3lc51136g</pub-id> .<?supplied-pmid 24385254?><pub-id pub-id-type="pmid">24385254</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Ensink</surname><given-names>E</given-names></name>, <name><surname>Sinha</surname><given-names>J</given-names></name>, <name><surname>Sinha</surname><given-names>A</given-names></name>, <name><surname>Tang</surname><given-names>H</given-names></name>, <name><surname>Calderone</surname><given-names>HM</given-names></name>, <name><surname>Hostetter</surname><given-names>G</given-names></name>, <etal>et al</etal><article-title>Segment and fit thresholding: a new method for image analysis applied to microarray and immunofluorescence data</article-title>. <source>Anal Chem</source>. <year>2015</year>;<volume>87</volume>(<issue>19</issue>):<fpage>9715</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1021/acs.analchem.5b03159</pub-id><?supplied-pmid 26339978?><pub-id pub-id-type="pmid">26339978</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Hassanein</surname><given-names>AS</given-names></name>, <name><surname>Mohammad</surname><given-names>S</given-names></name>, <name><surname>Sameer</surname><given-names>M</given-names></name>, <name><surname>Ragab</surname><given-names>ME</given-names></name>. <article-title>A survey on Hough transform, theory, techniques and applications</article-title>. <source>arXiv preprint arXiv:150202160</source>. <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref050">
      <label>50</label>
      <mixed-citation publication-type="other">Wong CY, Lin SC-F, Ren T, Kwok NM, editors. A survey on ellipse detection methods. 2012 IEEE International Symposium on Industrial Electronics; 2012: IEEE.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Xie</surname><given-names>Y</given-names></name>, <name><surname>Ji</surname><given-names>Q</given-names></name>, editors. <article-title>A new efficient ellipse detection method</article-title>. <source>Object recognition supported by user interaction for service robots</source>; <year>2002</year>: IEEE.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Thiam</surname><given-names>AR</given-names></name>, <name><surname>Farese</surname><given-names>Jr RV</given-names></name>, <name><surname>Walther</surname><given-names>TC</given-names></name>. <article-title>The biophysics and cell biology of lipid droplets</article-title>. <source>Nature reviews Molecular cell biology</source>. <year>2013</year>;<volume>14</volume>(<issue>12</issue>):<fpage>775</fpage><pub-id pub-id-type="doi">10.1038/nrm3699</pub-id><?supplied-pmid 24220094?><pub-id pub-id-type="pmid">24220094</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Greenspan</surname><given-names>P</given-names></name>, <name><surname>Mayer</surname><given-names>EP</given-names></name>, <name><surname>Fowler</surname><given-names>SD</given-names></name>. <article-title>Nile red: a selective fluorescent stain for intracellular lipid droplets</article-title>. <source>The Journal of cell biology</source>. <year>1985</year>;<volume>100</volume>(<issue>3</issue>):<fpage>965</fpage>–<lpage>73</lpage>. <?supplied-pmid 3972906?><pub-id pub-id-type="pmid">3972906</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Bagwe</surname><given-names>RP</given-names></name>, <name><surname>Yang</surname><given-names>C</given-names></name>, <name><surname>Hilliard</surname><given-names>LR</given-names></name>, <name><surname>Tan</surname><given-names>W</given-names></name>. <article-title>Optimization of dye-doped silica nanoparticles prepared using a reverse microemulsion method</article-title>. <source>Langmuir</source>. <year>2004</year>;<volume>20</volume>(<issue>19</issue>):<fpage>8336</fpage>–<lpage>42</lpage>. <pub-id pub-id-type="doi">10.1021/la049137j</pub-id><?supplied-pmid 15350111?><pub-id pub-id-type="pmid">15350111</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Parvati</surname><given-names>K</given-names></name>, <name><surname>Rao</surname><given-names>P</given-names></name>, <name><surname>Mariya Das</surname><given-names>M</given-names></name>. <article-title>Image segmentation using gray-scale morphology and marker-controlled watershed transformation</article-title>. <source>Discrete Dynamics in Nature and Society</source>. <year>2008</year>;<fpage>2008</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref056">
      <label>56</label>
      <mixed-citation publication-type="other">Grady L, editor Multilabel random walker image segmentation using prior models. Computer Vision and Pattern Recognition, 2005 CVPR 2005 IEEE Computer Society Conference on; 2005: IEEE.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Long</surname><given-names>L</given-names></name>, <name><surname>Yin</surname><given-names>M</given-names></name>, <name><surname>Min</surname><given-names>W</given-names></name>. <article-title>3D Co-culture System of Tumor-associated Macrophages and Ovarian Cancer Cells</article-title>. <source>Bio-protocol</source>. <year>2018</year>;<volume>8</volume>(<issue>8</issue>).</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Saini</surname><given-names>H</given-names></name>, <name><surname>Navaei</surname><given-names>A</given-names></name>, <name><surname>Van Putten</surname><given-names>A</given-names></name>, <name><surname>Nikkhah</surname><given-names>M</given-names></name>. <article-title>3D cardiac microtissues encapsulated with the co‐culture of cardiomyocytes and cardiac fibroblasts</article-title>. <source>Advanced healthcare materials</source>. <year>2015</year>;<volume>4</volume>(<issue>13</issue>):<fpage>1961</fpage>–<lpage>71</lpage>. <pub-id pub-id-type="doi">10.1002/adhm.201500331</pub-id><?supplied-pmid 26129820?><pub-id pub-id-type="pmid">26129820</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Jones</surname><given-names>LJ</given-names></name>, <name><surname>Gray</surname><given-names>M</given-names></name>, <name><surname>Yue</surname><given-names>ST</given-names></name>, <name><surname>Haugland</surname><given-names>RP</given-names></name>, <name><surname>Singer</surname><given-names>VL</given-names></name>. <article-title>Sensitive determination of cell number using the CyQUANT cell proliferation assay</article-title>. <source>Journal of immunological methods</source>. <year>2001</year>;<volume>254</volume>(<issue>1–2</issue>):<fpage>85</fpage>–<lpage>98</lpage>. <?supplied-pmid 11406155?><pub-id pub-id-type="pmid">11406155</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Ong</surname><given-names>S-M</given-names></name>, <name><surname>Zhang</surname><given-names>C</given-names></name>, <name><surname>Toh</surname><given-names>Y-C</given-names></name>, <name><surname>Kim</surname><given-names>SH</given-names></name>, <name><surname>Foo</surname><given-names>HL</given-names></name>, <name><surname>Tan</surname><given-names>CH</given-names></name>, <etal>et al</etal><article-title>A gel-free 3D microfluidic cell culture system</article-title>. <source>Biomaterials</source>. <year>2008</year>;<volume>29</volume>(<issue>22</issue>):<fpage>3237</fpage>–<lpage>44</lpage>. <pub-id pub-id-type="doi">10.1016/j.biomaterials.2008.04.022</pub-id><?supplied-pmid 18455231?><pub-id pub-id-type="pmid">18455231</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Ingham</surname><given-names>CJ</given-names></name>, <name><surname>Sprenkels</surname><given-names>A</given-names></name>, <name><surname>Bomer</surname><given-names>J</given-names></name>, <name><surname>Molenaar</surname><given-names>D</given-names></name>, <name><surname>van den Berg</surname><given-names>A</given-names></name>, <name><surname>van Hylckama Vlieg</surname><given-names>JE</given-names></name>, <etal>et al</etal><article-title>The micro-Petri dish, a million-well growth chip for the culture and high-throughput screening of microorganisms</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2007</year>;<volume>104</volume>(<issue>46</issue>):<fpage>18217</fpage>–<lpage>22</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0215337.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Albayrak</surname><given-names>C</given-names></name>, <name><surname>Jordi</surname><given-names>CA</given-names></name>, <name><surname>Zechner</surname><given-names>C</given-names></name>, <name><surname>Lin</surname><given-names>J</given-names></name>, <name><surname>Bichsel</surname><given-names>CA</given-names></name>, <name><surname>Khammash</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Digital quantification of proteins and mRNA in single mammalian cells</article-title>. <source>Molecular cell</source>. <year>2016</year>;<volume>61</volume>(<issue>6</issue>):<fpage>914</fpage>–<lpage>24</lpage>. <pub-id pub-id-type="doi">10.1016/j.molcel.2016.02.030</pub-id><?supplied-pmid 26990994?><pub-id pub-id-type="pmid">26990994</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>J</given-names></name>, <name><surname>Zhan</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>RS</given-names></name>, <name><surname>Gao</surname><given-names>PF</given-names></name>, <name><surname>Huang</surname><given-names>CZ</given-names></name>. <article-title>Color-Encoded Assays for the Simultaneous Quantification of Dual Cancer Biomarkers</article-title>. <source>Anal Chem</source>. <year>2017</year>;<volume>89</volume>(<issue>16</issue>):<fpage>8484</fpage>–<lpage>9</lpage>. Epub 2017/07/22. <pub-id pub-id-type="doi">10.1021/acs.analchem.7b02033</pub-id> .<?supplied-pmid 28732160?><pub-id pub-id-type="pmid">28732160</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Chan</surname><given-names>WCW</given-names></name>, <name><surname>Maxwell</surname><given-names>DJ</given-names></name>, <name><surname>Gao</surname><given-names>X</given-names></name>, <name><surname>Bailey</surname><given-names>RE</given-names></name>, <name><surname>Han</surname><given-names>M</given-names></name>, <name><surname>Nie</surname><given-names>S</given-names></name>. <article-title>Luminescent quantum dots for multiplexed biological detection and imaging</article-title>. <source>Curr Opin Biotechnol</source>. <year>2002</year>;<volume>13</volume>(<issue>1</issue>):<fpage>40</fpage>–<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1016/S0958-1669(02)00282-3</pub-id>. <?supplied-pmid 11849956?><pub-id pub-id-type="pmid">11849956</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Bui</surname><given-names>M-PN</given-names></name>, <name><surname>Li</surname><given-names>CA</given-names></name>, <name><surname>Han</surname><given-names>KN</given-names></name>, <name><surname>Choo</surname><given-names>J</given-names></name>, <name><surname>Lee</surname><given-names>EK</given-names></name>, <name><surname>Seong</surname><given-names>GH</given-names></name>. <article-title>Enzyme kinetic measurements using a droplet-based microfluidic system with a concentration gradient</article-title>. <source>Anal Chem</source>. <year>2011</year>;<volume>83</volume>(<issue>5</issue>):<fpage>1603</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1021/ac102472a</pub-id><?supplied-pmid 21280615?><pub-id pub-id-type="pmid">21280615</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Chan</surname><given-names>WC</given-names></name>, <name><surname>Maxwell</surname><given-names>DJ</given-names></name>, <name><surname>Gao</surname><given-names>X</given-names></name>, <name><surname>Bailey</surname><given-names>RE</given-names></name>, <name><surname>Han</surname><given-names>M</given-names></name>, <name><surname>Nie</surname><given-names>S</given-names></name>. <article-title>Luminescent quantum dots for multiplexed biological detection and imaging</article-title>. <source>Curr Opin Biotechnol</source>. <year>2002</year>;<volume>13</volume>(<issue>1</issue>):<fpage>40</fpage>–<lpage>6</lpage>. <?supplied-pmid 11849956?><pub-id pub-id-type="pmid">11849956</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref067">
      <label>67</label>
      <mixed-citation publication-type="journal"><name><surname>Manjunatha</surname><given-names>SD</given-names></name>, <name><surname>Erik</surname><given-names>KL</given-names></name>, <name><surname>Bethany</surname><given-names>HK</given-names></name>, <name><surname>Pratim</surname><given-names>CP</given-names></name>, <name><surname>Britton</surname><given-names>OP</given-names></name>, <name><surname>Anushree</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>High-Throughput Block Optical DNA Sequence Identification</article-title>. <source>Small</source>. <year>2018</year>;<volume>14</volume>(<issue>4</issue>):<fpage>1703165</fpage><pub-id pub-id-type="doi">10.1002/smll.201703165</pub-id><?supplied-pmid 29205813?><pub-id pub-id-type="pmid">29205813</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Godin</surname><given-names>AG</given-names></name>, <name><surname>Rappaz</surname><given-names>B</given-names></name>, <name><surname>Potvin-Trottier</surname><given-names>L</given-names></name>, <name><surname>Kennedy</surname><given-names>TE</given-names></name>, <name><surname>De Koninck</surname><given-names>Y</given-names></name>, <name><surname>Wiseman</surname><given-names>PW</given-names></name>. <article-title>Spatial intensity distribution analysis reveals abnormal oligomerization of proteins in single cells</article-title>. <source>Biophysical journal</source>. <year>2015</year>;<volume>109</volume>(<issue>4</issue>):<fpage>710</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2015.06.068</pub-id><?supplied-pmid 26287623?><pub-id pub-id-type="pmid">26287623</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0215337.ref069">
      <label>69</label>
      <mixed-citation publication-type="journal"><name><surname>Costes</surname><given-names>SV</given-names></name>, <name><surname>Daelemans</surname><given-names>D</given-names></name>, <name><surname>Cho</surname><given-names>EH</given-names></name>, <name><surname>Dobbin</surname><given-names>Z</given-names></name>, <name><surname>Pavlakis</surname><given-names>G</given-names></name>, <name><surname>Lockett</surname><given-names>S</given-names></name>. <article-title>Automatic and quantitative measurement of protein-protein colocalization in live cells</article-title>. <source>Biophysical journal</source>. <year>2004</year>;<volume>86</volume>(<issue>6</issue>):<fpage>3993</fpage>–<lpage>4003</lpage>. <pub-id pub-id-type="doi">10.1529/biophysj.103.038422</pub-id><?supplied-pmid 15189895?><pub-id pub-id-type="pmid">15189895</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
