<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1011163.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10310047</article-id>
    <article-id pub-id-type="pmid">37327214</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011163</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-22-01483</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Sequence Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Database Searching</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Metagenomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical Microbiology</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Microbiome</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Genomics</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Database and informatics methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence analysis</subject>
              <subj-group>
                <subject>BLAST algorithm</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Proteomes</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
            <subj-group>
              <subject>Open Source Software</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
            <subj-group>
              <subject>Open Source Software</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Science Policy</subject>
        <subj-group>
          <subject>Open Science</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">MetaNovo</italic>: An open-source pipeline for probabilistic peptide discovery in complex metaproteomic datasets</article-title>
      <alt-title alt-title-type="running-head"><italic toggle="yes">MetaNovo</italic>—Probabilistic peptide discovery in metaproteomics</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9919-9210</contrib-id>
        <name>
          <surname>Potgieter</surname>
          <given-names>Matthys G.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nel</surname>
          <given-names>Andrew J. M.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8148-7807</contrib-id>
        <name>
          <surname>Fortuin</surname>
          <given-names>Suereta</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Garnett</surname>
          <given-names>Shaun</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wendoh</surname>
          <given-names>Jerome M.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7223-578X</contrib-id>
        <name>
          <surname>Tabb</surname>
          <given-names>David L.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Mulder</surname>
          <given-names>Nicola J.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8988-9595</contrib-id>
        <name>
          <surname>Blackburn</surname>
          <given-names>Jonathan M.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Computational Biology Division, Department of Integrative Biomedical Sciences, University of Cape Town, Cape Town, South Africa</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Division of Chemical and Systems Biology, Department of Integrative Biomedical Sciences, University of Cape Town, Cape Town, South Africa</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Division of Immunology, Department of Pathology, University of Cape Town, Cape Town, South Africa</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Division of Molecular Biology and Human Genetics, Department of Biomedical Sciences; African Microbiome Institute; South African Tuberculosis Bioinformatics Initiative; Stellenbosch University, Cape Town, South Africa</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Institute of Infectious Disease &amp; Molecular Medicine, Faculty of Health Sciences, University of Cape Town, Cape Town, South Africa</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>CANADA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors declare that they have no competing interests.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>nicola.mulder@uct.ac.za</email> (NJM); <email>jonathan.blackburn@uct.ac.za</email> (JMB)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>19</volume>
    <issue>6</issue>
    <elocation-id>e1011163</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 Potgieter et al</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Potgieter et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011163.pdf"/>
    <abstract>
      <sec id="sec001">
        <title>Background</title>
        <p>Microbiome research is providing important new insights into the metabolic interactions of complex microbial ecosystems involved in fields as diverse as the pathogenesis of human diseases, agriculture and climate change. Poor correlations typically observed between RNA and protein expression datasets make it hard to accurately infer microbial protein synthesis from metagenomic data. Additionally, mass spectrometry-based metaproteomic analyses typically rely on focused search sequence databases based on prior knowledge for protein identification that may not represent all the proteins present in a set of samples. Metagenomic 16S rRNA sequencing only targets the bacterial component, while whole genome sequencing is at best an indirect measure of expressed proteomes. Here we describe a novel approach, <bold>MetaNovo</bold>, that combines existing open-source software tools to perform scalable <italic toggle="yes">de novo</italic> sequence tag matching with a novel algorithm for probabilistic optimization of the entire <bold>UniProt</bold> knowledgebase to create tailored sequence databases for target-decoy searches directly at the proteome level, enabling metaproteomic analyses without prior expectation of sample composition or metagenomic data generation and compatible with standard downstream analysis pipelines.</p>
      </sec>
      <sec id="sec002">
        <title>Results</title>
        <p>We compared <bold>MetaNovo</bold> to published results from the <bold>MetaPro-IQ</bold> pipeline on 8 human mucosal-luminal interface samples, with comparable numbers of peptide and protein identifications, many shared peptide sequences and a similar bacterial taxonomic distribution compared to that found using a matched metagenome sequence database—but simultaneously identified many more non-bacterial peptides than the previous approaches<bold>. MetaNovo</bold> was also benchmarked on samples of known microbial composition against matched metagenomic and whole genomic sequence database workflows, yielding many more MS/MS identifications for the expected taxa, with improved taxonomic representation, while also highlighting previously described genome sequencing quality concerns for one of the organisms, and identifying an experimental sample contaminant without prior expectation.</p>
      </sec>
      <sec id="sec003">
        <title>Conclusions</title>
        <p>By estimating taxonomic and peptide level information directly on microbiome samples from tandem mass spectrometry data, <bold>MetaNovo</bold> enables the simultaneous identification of peptides from all domains of life in metaproteome samples, bypassing the need for curated sequence databases to search. We show that the <bold>MetaNovo</bold> approach to mass spectrometry metaproteomics is more accurate than current gold standard approaches of tailored or matched genomic sequence database searches, can identify sample contaminants without prior expectation and yields insights into previously unidentified metaproteomic signals, building on the potential for complex mass spectrometry metaproteomic data to speak for itself.</p>
      </sec>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p><bold>MetaNovo</bold> is an open-source software pipeline that integrates existing tools with a custom algorithm to produce targeted protein sequence databases for mass spectrometry metaproteomic analysis as an intermediate filtering step prior to standard sequence database search approaches. <bold>MetaNovo</bold> uses open-source tools to match peptide mass spectrometry spectra to sequence database entries in a parallelised and scalable manner and can be installed in a cluster or run standalone on a Linux machine. The software is scalable to the number of input files and search sequence database size. As inputs the software requires raw mass spectrometry data in MGF format, and a <bold>UniProt</bold> FASTA sequence database to search. The pipeline is relevant to users analysing protein data from multiple organisms, where the exact species composition is unknown, such as microbiome or environmental samples, and provides an avenue for analysis when matched metagenomics data or accurate taxonomic characterisation is not available as it infers the organisms and proteins present directly from the raw data and the parent sequence database. The targeted sequence database produced can be used with standard downstream peptide identification software that relies on a targeted input sequence database to search the raw data against and allows greater sensitivity in peptide spectral matching in metaproteomic datasets.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>National Research Foundation (ZA)</institution>
        </funding-source>
        <award-id>NRF BFG 93665</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9919-9210</contrib-id>
          <name>
            <surname>Potgieter</surname>
            <given-names>Matthys G.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>South African Tuberculosis Bioinformatics Initiative</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7223-578X</contrib-id>
          <name>
            <surname>Tabb</surname>
            <given-names>David L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001322</institution-id>
            <institution>South African Medical Research Council</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7223-578X</contrib-id>
          <name>
            <surname>Tabb</surname>
            <given-names>David L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>Department of Science and Technology, South Africa</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7223-578X</contrib-id>
          <name>
            <surname>Tabb</surname>
            <given-names>David L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution>National Research Foundation (ZA)</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8988-9595</contrib-id>
          <name>
            <surname>Blackburn</surname>
            <given-names>Jonathan M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>MGP would like to thank the National Research Foundation (NRF) of South Africa for an MSc grant (NRF BFG 93665). DLT was supported by the South African Tuberculosis Bioinformatics Initiative (SATBBI), a Strategic Health Innovation Partnership grant from the South African Medical Research Council and South African Department of Science and Technology. JMB thanks the NRF for a South African Research Chair grant. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="1"/>
      <page-count count="22"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2023-06-29</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The Human mucosal-luminal interface mass spectrometry proteomics data are available from the ProteomeXchange Consortium via the PRIDE partner repository with the dataset identifier PXD003528, and all results have been uploaded to the ProteomeXchange Consortium via the PRIDE partner repository with the dataset identifier PXD030708 (<ext-link xlink:href="https://www.ebi.ac.uk/pride/archive/projects/PXD030708" ext-link-type="uri">https://www.ebi.ac.uk/pride/archive/projects/PXD030708</ext-link>). The MetaNovo software is available from GitHub (<ext-link xlink:href="https://github.com/uct-cbio/proteomics-pipelines/releases/tag/v1.7.0" ext-link-type="uri">https://github.com/uct-cbio/proteomics-pipelines/releases/tag/v1.7.0</ext-link>) and can be run as a standalone Singularity or Docker container available from the Docker Hub (<ext-link xlink:href="https://hub.docker.com/r/thyscbio/metanovo" ext-link-type="uri">https://hub.docker.com/r/thyscbio/metanovo</ext-link>). The companion code used to generate the analysis for this manuscript are available in a dedicated repository on GitHub as jupyter notebooks (<ext-link xlink:href="https://github.com/Thys3Potgieter/Metanovo-Manuscript" ext-link-type="uri">https://github.com/Thys3Potgieter/Metanovo-Manuscript</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The Human mucosal-luminal interface mass spectrometry proteomics data are available from the ProteomeXchange Consortium via the PRIDE partner repository with the dataset identifier PXD003528, and all results have been uploaded to the ProteomeXchange Consortium via the PRIDE partner repository with the dataset identifier PXD030708 (<ext-link xlink:href="https://www.ebi.ac.uk/pride/archive/projects/PXD030708" ext-link-type="uri">https://www.ebi.ac.uk/pride/archive/projects/PXD030708</ext-link>). The MetaNovo software is available from GitHub (<ext-link xlink:href="https://github.com/uct-cbio/proteomics-pipelines/releases/tag/v1.7.0" ext-link-type="uri">https://github.com/uct-cbio/proteomics-pipelines/releases/tag/v1.7.0</ext-link>) and can be run as a standalone Singularity or Docker container available from the Docker Hub (<ext-link xlink:href="https://hub.docker.com/r/thyscbio/metanovo" ext-link-type="uri">https://hub.docker.com/r/thyscbio/metanovo</ext-link>). The companion code used to generate the analysis for this manuscript are available in a dedicated repository on GitHub as jupyter notebooks (<ext-link xlink:href="https://github.com/Thys3Potgieter/Metanovo-Manuscript" ext-link-type="uri">https://github.com/Thys3Potgieter/Metanovo-Manuscript</ext-link>).</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Software paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec004">
    <title>Introduction</title>
    <p>Characterising microbial ecosystems from clinical or environmental samples promises insights into the complex metabolic pathways involved in processes as diverse as carbon sequestration and climate change to the susceptibility and progression of human diseases [<xref rid="pcbi.1011163.ref001" ref-type="bibr">1</xref>]. Microbial communities play a wide-ranging role in the complex determinants of human well-being, with potential disease implications should the balance be disrupted [<xref rid="pcbi.1011163.ref002" ref-type="bibr">2</xref>].</p>
    <p>Genome and transcriptome sequencing approaches to microbiome analysis allow for functional and taxonomic characterization of the genes and organisms involved in complex microbial communities, but it has been shown that measures of gene transcription do not generally correlate well with measured protein abundance [<xref rid="pcbi.1011163.ref003" ref-type="bibr">3</xref>]. On the other hand, metaproteomic and clinical proteomic approaches in principle allow researchers to obtain a snapshot of all the proteins present in a complex microbiome sample at a given time, providing a quantitative window into key functional components of complex pathways and organism interactions, including the direct measurement of dynamic changes in microbial protein composition, localisation and modification that may mediate host/pathogen interactions in the context of human health and disease.</p>
    <p>Classically, the identification of peptides (and by inference, the parent proteins) from complex mass spectrometry datasets has been largely dependent on the availability of focussed, representative and relatively small sequence databases or spectral libraries against which to search tandem mass spectra—perhaps due in part to the historical emphasis in the field on the analysis of model organism proteomes to answer simple biological questions. However, the analysis of complex, multi-species samples–such as human microbiome samples where the total number of microbial genes may vastly exceed the number of human genes—is far less straightforward for a variety of reasons, including: the vast majority of specific organisms in any given microbiome are likely to not have been cultured, identified, or characterised in the laboratory, so appropriate reference genomes may not exist to underpin proteomic data analyses; and the fact that massive expansion of proteomic sequence databases used in target-decoy-based peptide-spectrum matching has been shown to lead to dramatically reduced identification rates due to higher rates of false negatives and false discovery misestimation problems [<xref rid="pcbi.1011163.ref004" ref-type="bibr">4</xref>].</p>
    <p>Various methods have been developed to address the challenges of metaproteomic MS/MS identification. Previous methods for metaproteomic analysis have addressed these issues essentially by relying on prior expectation of the microbial composition of a given microbiome sample, for example using 16S sequencing data to produce a focussed metaproteome sequence database to search [<xref rid="pcbi.1011163.ref005" ref-type="bibr">5</xref>]. However, some limitations of this approach are that: (i) it assumes that the 16S data itself provides a complete description of all bacteria present in the sample, which is probably not true; (ii) it assumes that appropriate reference bacterial proteomes exist and are close enough in sequence to the clinical isolate proteomes for proteomic data analysis to be valid, which may also not be true; (iii) it automatically ignores all non-bacterial components of the microbiome; &amp; (iv) the expressed proteome even within a single species is dynamic and not constant under all conditions, leading to the likely inclusion of spurious protein sequences even for correctly included organisms, thus inflating the search space and leading to decreased sensitivity. These approaches also imply additional analyses that depend on resources and samples that may not be available in all cases. Whole metagenome sequencing itself also suffers from the complexity of short reads leading to fragmented contigs and scaffolds which may interrupt protein-coding regions and hamper CDS predictions. Tang et al. [<xref rid="pcbi.1011163.ref006" ref-type="bibr">6</xref>] used <italic toggle="yes">de Bruijn</italic> graphs generated by metagenome assembly to produce protein sequence databases for metaproteomics, where identified peptides may span separate contigs in the graph, yielding many more peptide identifications than linear approaches to metagenome data.</p>
    <p>Iterative “two-step” search strategies—where matches from a primary search against an initially very large sequence database at relaxed false discovery rates (FDR) are used to create a focused sequence database for subsequent more stringent target-decoy search—have been used, for example by the <bold>MetaPro-IQ</bold> pipeline, to yield a higher number of identifications [<xref rid="pcbi.1011163.ref007" ref-type="bibr">7</xref>,<xref rid="pcbi.1011163.ref008" ref-type="bibr">8</xref>], but there are some concerns about the statistical implication of re-searching data repeatedly using identical or closely related algorithms.</p>
    <p>Further pitfalls of the use of targeted sequence databases for metaproteomics include the danger of mis- assignments when proteins truly present in the data are not included in the search sequence database. A case in point are spectra assigned to viral proteins identified and published in a study but later identified as <italic toggle="yes">Apis mellifera</italic> honey bee proteins by another group—that may have been differently assigned if the original authors included those proteins in the original search sequence database [<xref rid="pcbi.1011163.ref009" ref-type="bibr">9</xref>], underlining a significant potential problem if metaproteomics studies ignore the presence of viruses, archaea, fungi and dietary components that are likely to be present in a sample.</p>
    <p>Reanalysis of the same <italic toggle="yes">Apis mellifera</italic> samples by another group [<xref rid="pcbi.1011163.ref010" ref-type="bibr">10</xref>], found that only a small percentage of the viral peptides could be explained by homologous peptides, and argued that limiting the search space to only peptides of interest, reduces multiple hypothesis testing, and thus increases peptide identification sensitivity. However, they pointed out that leaving out sequences from the search sequence database could lead to false assignments of spectra of true proteins to biologically related sequences in the sequence database. In the case of metaproteomic analysis representing multiple species with potentially many orthologous proteins, artificially limiting the search space may therefore lead to false positive peptide identifications despite decreased false negative identifications. However, reducing the search space to peptides of interest would be an interesting avenue for analysing complex samples, but requires a representative sequence database that is available for filtering, and prior knowledge of sample composition, and does not work for very small sequence database sizes, due to false discovery estimation problems.</p>
    <p>The ideal sequence database for mass spectrometry-based peptide identification in metaproteomic datasets would therefore be comprehensive, whilst excluding proteins that are genuinely absent, and would not be reliant on prior expectation of sample composition, nor would it require prior generation of DNA/RNA sequencing data to inform the construction of a search sequence database.</p>
    <p>Taxonomic profiling of proteins identified during metaproteomic analysis is also complicated by high levels of shared tryptic peptides between homologous proteins of closely related organisms. To help solve this, the <bold>UniPept</bold>
<italic toggle="yes">pept2lca</italic> algorithm [<xref rid="pcbi.1011163.ref011" ref-type="bibr">11</xref>] assigns the lowest common ancestor (LCA) for a given peptide assignment, whilst the recently published <bold>ProteoClade</bold> algorithm [<xref rid="pcbi.1011163.ref012" ref-type="bibr">12</xref>] allows users to apply species level annotation to identified peptides using customised search sequence databases.</p>
    <p><italic toggle="yes">De novo</italic> sequencing of peptides from mass spectrometry data has long been used for sequence database filtration, allowing for rapid searches of very large search spaces with sequence tags prior to peptide-spectral matching [<xref rid="pcbi.1011163.ref013" ref-type="bibr">13</xref>]. Tanner <italic toggle="yes">et al</italic>. published the <bold>InsPecT</bold> tool in 2005 [<xref rid="pcbi.1011163.ref014" ref-type="bibr">14</xref>]. These approaches work by reducing the sequence database size by orders of magnitude, while retaining the correct sequences with high probability. The sequence tag filtering approach is interesting, as in isolation full peptide sequencing of higher-energy collisional dissociation (HCD) data has been found to be only around 35% accurate [<xref rid="pcbi.1011163.ref015" ref-type="bibr">15</xref>]. Moreover, incomplete fragmentation of experimental spectra hampers accurate full-length sequencing using <italic toggle="yes">de novo</italic> algorithms [<xref rid="pcbi.1011163.ref016" ref-type="bibr">16</xref>]. Notwithstanding these challenges, partial sequencing with sequence tag approaches with tools such as <bold>DirecTag</bold> [<xref rid="pcbi.1011163.ref017" ref-type="bibr">17</xref>] represents a plausible, robust and scalable approach for sequence database filtering, whilst recent advances in deep-learning-based approaches have significantly improved the accuracy of full sequence <italic toggle="yes">de novo</italic> sequencing approaches, with tools such as <bold>pNovo3</bold> yielding up to 89% improvement in precision compared to other state-of-the-art tools, illustrating the current rapid progress in this field [<xref rid="pcbi.1011163.ref018" ref-type="bibr">18</xref>].</p>
    <p>Here, we present a novel metaproteomic analysis pipeline—<bold>MetaNovo</bold>–improving on the conventional methodology for iterative sequence database search by mapping <italic toggle="yes">de novo</italic> sequence tags to very large protein sequence databases using a high-performance and parallelized computing pipeline as the first search, thereby generating compact sequence databases for subsequent, orthogonal peptide-spectrum matching (PSM)-based target-decoy analysis and FDR-controlled protein identifications. We compare the results of <bold>MetaNovo</bold> against those published for the two-step <bold>MetaPro-IQ</bold> pipeline using a publicly available mass spectrometry dataset. We further validate the pipeline on samples of known microbial composition as ground truth. To our knowledge, this is the first published metaproteomic workflow for iterative two-step searching that uses <italic toggle="yes">de novo</italic> sequencing and probabilistic protein inference as a first step, followed by orthogonal conventional target-decoy search with FDR control in the second step. We show that replacing conventional PSM-based sequence database searching with <italic toggle="yes">de novo</italic> sequencing in the first step extends the applicability of iterative searches to extremely large sequence databases, which have previously only been applied to large, curated lists of proteins, thus decreasing the bias inherent in the analysis of complex metaproteomic data using these approaches.</p>
    <p>The <bold>MetaNovo</bold> software has already been used to obtain new insights into vaginal [<xref rid="pcbi.1011163.ref019" ref-type="bibr">19</xref>,<xref rid="pcbi.1011163.ref020" ref-type="bibr">20</xref>] and foreskin [<xref rid="pcbi.1011163.ref021" ref-type="bibr">21</xref>] microbiome dynamics and has been made publicly available on <bold>Galaxy</bold> [<xref rid="pcbi.1011163.ref022" ref-type="bibr">22</xref>] (<ext-link xlink:href="https://toolshed.g2.bx.psu.edu/repository?repository_id=f90d438ce91f95f1" ext-link-type="uri">https://toolshed.g2.bx.psu.edu/repository?repository_id=f90d438ce91f95f1</ext-link>, <ext-link xlink:href="https://usegalaxy.eu/root?tool_id=metanovo" ext-link-type="uri">https://usegalaxy.eu/root?tool_id=metanovo</ext-link>,). The tool is also available as a standalone package in <bold>Anaconda (</bold><ext-link xlink:href="https://anaconda.org/bioconda/metanovo" ext-link-type="uri">https://anaconda.org/bioconda/metanovo</ext-link>).</p>
  </sec>
  <sec sec-type="materials|methods" id="sec005">
    <title>Design and implementation</title>
    <sec id="sec006">
      <title><italic toggle="yes">MetaNovo</italic> sequence database generation workflow and benchmarking</title>
      <sec id="sec007">
        <title>UniProt sequence database statistics</title>
        <p>The 2019_11 release [<xref rid="pcbi.1011163.ref023" ref-type="bibr">23</xref>] of <bold>UniProt</bold> was downloaded, and a combined FASTA sequence database created from <bold>UniProt SwissProt</bold>, <bold>TREMBL</bold>, and <bold>SwissProt</bold> alternative splice variant sequences (ca. 180 million sequences). See <italic toggle="yes"><xref rid="pcbi.1011163.s001" ref-type="supplementary-material">S1 Table</xref>.</italic></p>
      </sec>
    </sec>
    <sec id="sec008">
      <title>General software overview</title>
      <p>The <bold>MetaNovo</bold> software is a configurable command-line Linux <bold>Bash</bold> pipeline that combines open-source software tools with custom <bold>Python</bold> libraries and scripts to provide targeted protein identification search libraries in <bold>FASTA</bold> format. The pipeline has three main components based on custom and existing open-source tools—generating <italic toggle="yes">de novo</italic> sequence tags using <bold>DirecTag</bold>, mapping the tags to a protein sequence database using <bold>PeptideMapper</bold>, and a novel algorithm for probabilistic protein ranking and filtering based on estimated species and protein abundance. The <bold>MetaNovo</bold> software is available from <bold>GitHub</bold> [<xref rid="pcbi.1011163.ref024" ref-type="bibr">24</xref>] and can be run as a standalone <bold>Singularity</bold> or <bold>Docker</bold> container available from the <bold>Docker Hub</bold> [<xref rid="pcbi.1011163.ref025" ref-type="bibr">25</xref>]. The Human mucosal-luminal interface mass spectrometry proteomics data are available from the <bold>ProteomeXchange Consortium</bold> via the <bold>PRIDE</bold> [<xref rid="pcbi.1011163.ref026" ref-type="bibr">26</xref>] partner repository with the dataset identifier <bold>PXD003528</bold>, and all results have been uploaded to the <bold>ProteomeXchange</bold> Consortium via the <bold>PRIDE</bold> partner repository with the dataset identifier <bold>PXD030708</bold>. <italic toggle="yes">See <xref rid="pcbi.1011163.g001" ref-type="fig">Fig 1</xref>. The Typical</italic>
<bold><italic toggle="yes">MetaNovo</italic></bold>
<italic toggle="yes">workflow</italic>.</p>
      <fig position="float" id="pcbi.1011163.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011163.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Visualisation of the MetaNovo workflow used to analyse the mass spectrometry data of 8 human mucosal-luminal interface samples.</title>
          <p>Raw mass-spectrometry data were analysed using the <bold>MetaNovo</bold> pipeline in MGF format, using <italic toggle="yes">de novo</italic> sequence tags to create a targeted FASTA file for target-decoy search.</p>
        </caption>
        <graphic xlink:href="pcbi.1011163.g001" position="float"/>
      </fig>
    </sec>
    <sec id="sec009">
      <title>Generation of <italic toggle="yes">de novo</italic> sequence tags</title>
      <p>Raw MS/MS files need to be converted to <italic toggle="yes">Mascot Generic Feature</italic> (MGF) format prior to analysis. <italic toggle="yes">De novo</italic> sequence tags are generated using <bold>DeNovoGUI</bold> version 1.15.11 [<xref rid="pcbi.1011163.ref027" ref-type="bibr">27</xref>], with <bold>DirecTag</bold> [<xref rid="pcbi.1011163.ref017" ref-type="bibr">17</xref>] selected as the sequencing engine. General <bold>MetaNovo</bold> parameters selected for the analyses include fragment and precursor ion mass tolerance of 0.02 Da, with fixed modification ‘<italic toggle="yes">Carbamidomethylation of C’</italic> and variable modifications ‘<italic toggle="yes">Oxidation of M’</italic> and <italic toggle="yes">‘Acetylation of protein N-term’</italic>. For <bold>DirecTag</bold>, a tag sequence length of 4 amino acids was required, and the top 5 sequence tags per spectrum were selected (taking into account alternative possible charge states). These settings were chosen as preliminary runs with a sequence tag length of 3 proved impractical with very large sequence databases, requiring more than 5 days with 24 threads on a high-performance cluster to search 8 MGF files against <bold>UniProt</bold>. Similarly, increasing sequence tag options per spectrum from 5 to 30 considerably increased processing time without a corresponding gain in sensitivity, possibly due to the inclusion of low-scoring matches. The output of <bold>DirecTag</bold> is parsed with a custom <bold>Python</bold> script and all sequence tags for each MS/MS across replicates are stored in an <bold>SQLite</bold> database [<xref rid="pcbi.1011163.ref028" ref-type="bibr">28</xref>]. The distinct set of sequence tags (N-terminus mass gap, amino acid sequence, and C-terminus mass gap) are obtained using an <bold>SQL</bold> query, combining identical tags across multiple MS/MS into a single non-redundant list.</p>
    </sec>
    <sec id="sec010">
      <title>Mapping sequence tags to a FASTA sequence database</title>
      <p><bold>PeptideMapper</bold> [<xref rid="pcbi.1011163.ref029" ref-type="bibr">29</xref>] included in <bold>compomics-utilities</bold> version 4.11.19 [<xref rid="pcbi.1011163.ref030" ref-type="bibr">30</xref>] is used to search the sequence tag set against the protein sequence database. The same mass error tolerance and post-translational modification settings are used as for <bold>DeNovoGUI</bold> and specified in the config file. The open-source <bold>GNU parallel</bold> tool [<xref rid="pcbi.1011163.ref031" ref-type="bibr">31</xref>] is used to search the set of sequence tags against the FASTA sequence database in configurable chunk sizes, using a configurable number of threads per node in parallel.</p>
    </sec>
    <sec id="sec011">
      <title>Enzymatic cleavage rule evaluation</title>
      <p>A custom <bold>Python</bold> script is used to evaluate the cleavage rule of the peptide sequences of identified sequence tags. Only peptides passing the selected cleavage rule are selected for downstream analysis (‘Trypsin, no P rule’ was selected for the benchmarking analysis—cleavage after all <italic toggle="yes">Lys</italic> or <italic toggle="yes">Arg</italic>) with up to 2 missed cleavages allowed. The corresponding sequence tags for the validated peptide sequences are queried against the <bold>SQLite</bold> database to obtain a mapping of MS/MS ids to protein ids, allowing for the estimation of protein abundance based on mapped MS/MS in a similar manner to spectral counting in a target-decoy search.</p>
    </sec>
    <sec id="sec012">
      <title>Normalised spectral abundance factor calculation</title>
      <p>Protein abundance is estimated using the <italic toggle="yes">Normalised Spectral Abundance Factor</italic> (NSAF) approach developed for shotgun proteomics [<xref rid="pcbi.1011163.ref032" ref-type="bibr">32</xref>]. The set of MS/MS IDs in each sample per protein is obtained, and the number of mapped MS/MS ids is divided by protein length to obtain a <italic toggle="yes">Spectral Abundance Factor</italic> (SAF). The SAF values for each sample are divided by the sum of the SAF values in that sample, to obtain an NSAF for each protein in each sample/replicate.</p>
    </sec>
    <sec id="sec013">
      <title>Probabilistic ranking of sequence database proteins</title>
      <p>The <bold>MetaNovo</bold> algorithm uses the concept of unconditional or marginal probability, which is a probabilistic value generated for each protein in the <bold>UniProt</bold> sequence database corresponding to the probability that a given peptide fragment sampled at random from the raw data will belong to that protein given the available data. To calculate the marginal probabilities, protein NSAF values are summed across replicates, and divided by the sum of all NSAF values across all replicates, with a maximum value of 1 for each protein. This value is equivalent to the proportion that a given protein makes up of all replicates by summed NSAF value. SQLite database proteins are ranked by this marginal probability and filtered such that a minimal set of ranked proteins is obtained where each protein in the list contains at least one unique MS/MS scan ID relative to the set of proteins above its position in the list—and excluding all proteins that do not contain any uniquely identified spectra relative to the set of proteins above their position in the ranked list. Using this methodology, sets of protein isoforms that share an exact set of mapped MS/MS ids will be represented by the shortest sequence in the set due to having a higher NSAF value, based on the principle of Occam’s razor where longer sequences are more likely to have sequence tag matches by pure chance. The organism names are obtained from the <bold>UniProt</bold> FASTA headers, and summed NSAF values in the filtered set are aggregated by organism and divided by the total to obtain an organism-level marginal probability. Following this, the proteins in the unfiltered set are annotated with their respective calculated organism marginal probability. The unfiltered set of proteins is re-ranked based on the joint probability of the organism and protein probability values, based on the simplistic assumption of conditional independence (Naive Bayes Assumption) which allows low abundance proteins with a high estimated relative abundance at the organism level to be favoured compared to proteins where both the protein and organism abundance are estimated to be low. Benefits of the Naive Bayes assumption of conditional independence between predictors are ease of mathematical implementation and being highly scalable to the number of predictors and data points, without sacrificing model accuracy, and allowing model training and classification with a single pass over the data. The protein joint probability calculation used to rank protein ids in the SQLite database is as per the equation below:
<disp-formula id="pcbi.1011163.e001"><alternatives><graphic xlink:href="pcbi.1011163.e001.jpg" id="pcbi.1011163.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>O</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>O</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>*</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula></p>
      <p>Following the second ranking step, the database is re-filtered to obtain a minimal subset of proteins that can explain all mapped <italic toggle="yes">de novo</italic> sequence tags, based on estimated relative protein and organism abundance. <italic toggle="yes">See <xref rid="pcbi.1011163.g002" ref-type="fig">Fig 2</xref>.</italic></p>
      <fig position="float" id="pcbi.1011163.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011163.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>A Graphical representation of the MetaNovo algorithm applied for sequence database filtration.</title>
          <p><italic toggle="yes">Normalized spectral abundance factor</italic> calculations include non-unique spectra. The magnitude of probabilities are represented by +’s. Proteins are ranked by the joint probability of organism and protein probabilities, represented by the arrow, in order of increasing probability. The number of unique spectra for each protein is determined based on its position in the ranked list, and only include spectra that do not appear in the set of proteins in the list above (but may include spectra that appear below), such as the spectra for <bold>Peptide B</bold> that are counted towards the first protein in the list, but not the second. Tie breaks for adjacent and nearly identical isoforms that share the same set of spectra, will be based on the shortest (most probable) sequence having a higher NSAF (and thus a higher protein probability) or a higher organism probability. Proteins in green will be selected for inclusion in the filtered sequence database, and proteins in red will be excluded (having no unique spectra). The colors shared by proteins, peptides and spectra above, illustrate the assignment of unique spectra and peptides, to the most probable protein in the ranked list.</p>
        </caption>
        <graphic xlink:href="pcbi.1011163.g002" position="float"/>
      </fig>
    </sec>
    <sec id="sec014">
      <title>Mucosal-luminal interface samples</title>
      <sec id="sec015">
        <title>Mucosal-luminal interface (MLI) sample metagenomic and proteomics data</title>
        <p>Metagenome and proteomics data of 8 MLI samples from adolescent volunteers obtained during colonoscopy were downloaded from <bold>PRIDE</bold> with identifier <bold>PXD003528</bold> and through author correspondence. The sample processing, mass spectrometry and metagenomics sequence database creation methods have already been described [<xref rid="pcbi.1011163.ref008" ref-type="bibr">8</xref>].</p>
      </sec>
      <sec id="sec016">
        <title><italic toggle="yes">MetaNovo</italic> sequence database generation</title>
        <p>The December 2019 release [<xref rid="pcbi.1011163.ref023" ref-type="bibr">23</xref>] of <bold>UniProt</bold> (containing ca. 180 million protein entries) was used to create a sequence database containing 74136 entries. The <bold>MetaNovo</bold> settings described above were used. The experiment was run on a high performance computing cluster, with 120 GB available RAM, and 8 allocated Intel Xeon Processor (Skylake, IBRS) cpus, and total running time was 3d03h38m to process the 8 MGF files.</p>
      </sec>
    </sec>
    <sec id="sec017">
      <title>Sequence database search using MaxQuant</title>
      <p><bold>MaxQuant</bold> version 1.5.2.8 was used to search the <bold>MetaNovo sequence</bold> database, with the same settings as for the <bold>MetaPro-IQ</bold> publication. <italic toggle="yes">Acetyl (Protein N-term)</italic> and <italic toggle="yes">Oxidation (M)</italic> were selected as variable modifications, and <italic toggle="yes">Carbamidomethyl (C)</italic> was selected as a fixed modification. Specific enzyme mode with <italic toggle="yes">Trypsin/P</italic> was selected with up to 2 missed cleavages allowed, and a PSM and protein FDR of 0.01 was required.</p>
      <p>Nine-organism microbial mixture samples.</p>
    </sec>
    <sec id="sec018">
      <title>9MM sample and validation sequence databases</title>
      <p>Raw proteomic data from two samples of a known nine-organism microbial mixture (9MM) from a single biological replicate were downloaded from <bold>PeptideAtlas</bold> (identifier <bold>PASS00194)</bold> [<xref rid="pcbi.1011163.ref033" ref-type="bibr">33</xref>]. <italic toggle="yes">See <xref rid="pcbi.1011163.s002" ref-type="supplementary-material">S2 Table</xref></italic>. Detailed proteomic methods were described in the original publication [<xref rid="pcbi.1011163.ref033" ref-type="bibr">33</xref>]. In brief, each of 9 organisms was cultured separately on the appropriate growing media and divided into aliquots of approximately 10<sup>9</sup> CFU each. The 9MM sample was created by combining an aliquot of each organism pellet and processed separately by filter-aided sample preparation (FASP) and protein precipitation followed by in-solution digestion (PPID). Two sequence databases were selected from the original publication for comparison. One, the top-performing sequence database from the previous publication was created by single genome assembly followed by gene prediction and protein annotation using <bold>TrEMBL</bold>, with 27164 non-redundant entries <bold>(SGA-PA</bold>). Secondly, to illustrate a typical metaproteomics workflow, the sequence database created by NGS of the two 9MM extracts (metagenome sequencing) followed by gene prediction and protein annotation using <bold>TrEMBL</bold> was selected, with 13270 non-redundant entries (<bold>Meta-PA</bold>).</p>
    </sec>
    <sec id="sec019">
      <title><italic toggle="yes">MetaNovo</italic> sequence database generation</title>
      <p>The December 2019 release [<xref rid="pcbi.1011163.ref023" ref-type="bibr">23</xref>] of <bold>UniProt</bold> (containing ca. 180 million protein entries) was used to create a sequence database containing 13195 entries. The <bold>MetaNovo</bold> settings described above were used. The experiment was run on a single node of a high-performance computing cluster (<ext-link xlink:href="https://www.ilifu.ac.za/" ext-link-type="uri">https://www.ilifu.ac.za/</ext-link>), with 120 GB available RAM, and 8 allocated Intel Xeon Processor (Skylake, IBRS) processors. The total running time was 0d09h11m to process the 2 MGF files.</p>
    </sec>
    <sec id="sec020">
      <title>Sequence database search using MaxQuant</title>
      <p><bold>MaxQuant</bold> version 1.5.2.8 was used to search the <bold>MetaNovo, SGA-PA</bold> and <bold>Meta-PA</bold> databases using the same search parameters. <italic toggle="yes">Acetyl (Protein N-term)</italic> and <italic toggle="yes">Oxidation (M)</italic> were selected as variable modifications, and <italic toggle="yes">Carbamidomethyl (C)</italic> was selected as a fixed modification. Specific enzyme mode with <italic toggle="yes">Trypsin/P</italic> was selected with up to 2 missed cleavages allowed, and a PSM and protein FDR of 0.01 was required. The FASP and PPID samples were treated as separate experiments.</p>
    </sec>
    <sec id="sec021">
      <title>Bioinformatic analysis</title>
      <sec id="sec022">
        <title>Posterior error probability (PEP) score analysis</title>
        <p>PEP scores are a standard metric to identify and rank the quality of PSMs and are used during the FDR calculation of target decoy searches, as false-positive PSMs tend to rank similarly to reverse or decoy hits, allowing a convenient method to estimate the FDR at a given position in the PEP score ranking [<xref rid="pcbi.1011163.ref034" ref-type="bibr">34</xref>]. PEP scores have been applied in the field of proteogenomics to evaluate the accuracy of novel peptide identifications, by comparing their distribution to that of reverse hits, allowing for the assessment of the level of completeness of protein annotation in a given strain, as novel peptide identifications in completely annotated genomes are likely false positive identifications [<xref rid="pcbi.1011163.ref035" ref-type="bibr">35</xref>]. The PEP scores of PSMs obtained using <bold>MaxQuant</bold> were obtained from the <italic toggle="yes">peptides</italic>.<italic toggle="yes">txt</italic> output files of the different sequence database runs of the MLI samples—using <bold>MetaNovo</bold>, <bold>MetaPro-IQ</bold> using the integrated gene catalog (IGC) of human gut microbial genes [<xref rid="pcbi.1011163.ref036" ref-type="bibr">36</xref>], hereafter referred to as <bold>MetaPro-IQ/IGC</bold>, and a matched metagenome sequence database hereafter referred to as <bold>MetaPro-IQ/Metagenome</bold> (the published <bold>MaxQuant</bold> results using the <bold>MetaPro-IQ/IGC</bold> and <bold>MetaPro-IQ/Metagenome</bold> sequence databases were obtained from PRIDE). PSMs for each run were grouped into “exclusive” peptide sequences only identified in that run, and PSMs of “shared” peptides that were also identified in the other two runs, as well as the reverse hits for each group. Significant differences between the groups were tested for using the <italic toggle="yes">Kruskal-Wallis</italic> non-parametric analysis of variance test followed by <italic toggle="yes">Dunn’s</italic> post hoc test using a custom python script. PEP score distributions were visualised using the python <italic toggle="yes">matplotlib</italic> library.</p>
      </sec>
    </sec>
    <sec id="sec023">
      <title>Taxonomic analysis</title>
      <p>Peptide sequences were assigned to the lowest common ancestor (taxonomic level) using the <bold>UniPept <italic toggle="yes">pept2lca</italic></bold> tool, to allow for a comparison between the results of the different approaches and to the ground truth samples of known taxonomic composition (9MM) [<xref rid="pcbi.1011163.ref033" ref-type="bibr">33</xref>]. Peptide and spectral counts were aggregated at selected phylum levels reported in the <bold><italic toggle="yes">pept2lca</italic></bold> output, with custom visualisations done using the Python <italic toggle="yes">matplotlib</italic> module. We followed a previously described approach to filtering spurious taxa based on <bold>UniPept</bold> results by only including taxa that represent more than 0.5% of taxonomically characterised peptides [<xref rid="pcbi.1011163.ref033" ref-type="bibr">33</xref>], applied separately at each taxonomic level.</p>
    </sec>
    <sec id="sec024">
      <title>BLAST analysis of selected peptides and proteins from 9MM samples</title>
      <p>Peptides identified in the 9MM analysis that were assigned using the <bold>UniPept</bold>
<italic toggle="yes">pept2lca</italic> tool to organisms not expected from the known mixture were selectively subjected to <bold>NCBI BLAST</bold> analysis. Leading proteins for the same peptides were extracted from the <italic toggle="yes">proteinGroups</italic>.<italic toggle="yes">txt</italic> file and the protein sequences submitted for <bold>NCBI BLAST</bold> [<xref rid="pcbi.1011163.ref037" ref-type="bibr">37</xref>]. Proteotypic peptides were defined as only matching to a single species with 100% identity in the <bold>NCBI</bold> nr sequence database. Species-specific protein sequences were defined as those sequences that only matched to a single species above a threshold of 90% identity in the <bold>NCBI</bold> nr sequence database.</p>
    </sec>
    <sec id="sec025">
      <title>9MM Taxonomic representation error scores calculation</title>
      <p>Spectral counts obtained from the <bold>MaxQuant</bold> output files were aggregated to <italic toggle="yes">family</italic>, <italic toggle="yes">genus</italic> and <italic toggle="yes">species</italic> levels for the expected taxa. For each expected taxon, the percentage relative to the total characterised MS/MS (including mis assignments) was calculated for the <bold>MetaNovo</bold>, <bold>SGA-PA</bold>, and <bold>Meta-PA</bold> workflows respectively. As approximately equal proportions of the 9 organisms were analysed based on CFU counts, ground truth percentages were assigned to the 3 taxonomic levels accordingly. Mean Squared Error (MSE) scores were calculated for relative taxon abundance for each of the three runs relative to the ground truth percentages and compared. MSE values closer to 0 indicate lower error rates, and therefore a more accurate representation of relative taxon abundance in the samples.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec026">
    <title>Results</title>
    <sec id="sec027">
      <title>MetaNovo identifies non-bacterial taxa, whilst providing comparable bacterial composition data to a matched metagenome approach in human Mucosal-luminal interface samples</title>
      <sec id="sec028">
        <title>Protein and peptide identifications</title>
        <p>The <bold>MetaNovo</bold> pipeline was run using the entire, unfiltered <bold>UniProt</bold> sequence database (December 2019 release; ca. 180 million entries), resulting in the identification of 69878 target peptides and 15731 protein groups, with 36.37% of total MS/MS identified. These results are comparable but slightly better with &gt;2% more spectra assigned than those of previous approaches, with 34 and 33% MS/MS identification rates reported by the <bold>MetaPro-IQ</bold> authors using a matched metagenome or an integrated gene catalog (IGC), respectively. 48705 peptides were identified in common by all three runs, while 4873, 6525 and 14049 were identified exclusively by the <bold>MetaPro-IQ/IGC</bold>, <bold>MetaPro-IQ/Metagenome</bold>, and <bold>MetaNovo</bold> sequence databases, respectively. <italic toggle="yes">See <xref rid="pcbi.1011163.g003" ref-type="fig">Fig 3B</xref>.</italic></p>
        <fig position="float" id="pcbi.1011163.g003">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011163.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>MLI dataset results.</title>
            <p><bold>A.</bold> Bar chart of peptide identifications. The identification rates of <bold>MetaNovo</bold> are comparable to the previously published results of <bold>MetaPro-IQ</bold> using matched metagenome and <italic toggle="yes">integrated gene catalog sequence</italic> databases. <bold>B.</bold> Venn diagram showing large overlap in identified sequences using different approaches, with the highest number of sequences identified using <bold>MetaNovo. C.</bold> Peptide counts by <italic toggle="yes">UniPept lowest common ancestor</italic> showed similar taxonomic distributions obtained from different approaches. <bold>D.</bold> Peptides uniquely identified by <bold>MaxQuant</bold> using the <bold>MetaNovo sequence</bold> database had a significantly different distribution compared to reverse hits (p-value 6.33e-26). The boxes extend from the lower to the upper quartile, and the whiskers represent 1.5 times the interquartile range (IQR) below and above the first and third quartiles, respectively.</p>
          </caption>
          <graphic xlink:href="pcbi.1011163.g003" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec id="sec029">
      <title>PEP score analysis</title>
      <p>Kruskal-Wallis analysis of variance howed a statistiucally significant difference between exlusive, shared and reverse hit PEP scores across the three runs (statistic = 10883.94, pvalue = 0.0). Visual inspection of PEP score density plots shows a similar distribution of peptide PEP scores for peptides only identified in a specific run, and peptides that were identified in all runs, with the exception of peptides only identified using the <bold>MetaPro-IQ/Metagenome sequence</bold> database, that showed a very broad distribution overlapping with the reverse hits (<italic toggle="yes">See <xref rid="pcbi.1011163.s015" ref-type="supplementary-material">S1 Fig</xref></italic>). Analysis of shared and exclusive peptide identifications in each group revealed significantly different distributions between 14049 peptides only identified using <bold>MetaNovo</bold> and reverse hits for the same run (p-value 6.33e-26), indicating true positive identifications in this set not found using the other approaches. The difference between peptides exclusively identified with the <bold>MetaPro-IQ/IGC</bold> sequence database and reverse hits was also significant (p-value 3.15e-20). The 6525 peptides only identified using the matched metagenome had a higher median PEP score (0.038306) compared to reverse hits (0.009337) although the difference between the two groups was not statistically significant(p-value 4.60e-01), suggesting a higher rate of false-positive hits in this group than the other two approaches. <italic toggle="yes">See <xref rid="pcbi.1011163.g003" ref-type="fig">Fig 3D</xref> and <xref rid="pcbi.1011163.s003" ref-type="supplementary-material">S3</xref> and <xref rid="pcbi.1011163.s004" ref-type="supplementary-material">S4</xref> Tables.</italic></p>
    </sec>
    <sec id="sec030">
      <title>Taxonomic comparisons</title>
      <p>Peptide counts by lowest common ancestor were compared between different analysis runs using the output of UniPept <italic toggle="yes">pept2lca (See <xref rid="pcbi.1011163.s005" ref-type="supplementary-material">S5 Table</xref>)</italic>. After applying stringency criteria based on requiring at least 0.5% of total classified peptides per included taxon, the highest number of characterised peptides by UniPept pept2lca <italic toggle="yes">taxon_name (the most specific possible taxonomic characterization for a given peptide across all taxonomic levels)</italic> was obtained using <bold>MetaNovo/UniProt</bold> (35169), followed by <bold>MetaPro-IQ/Metagenome</bold> (34768) and <bold>MetaPro-IQ/IGC</bold> (32325). A similar taxonomic distribution was obtained between runs (<italic toggle="yes">See <xref rid="pcbi.1011163.g003" ref-type="fig">Fig 3C</xref>).</italic> Of the characterised peptides passing the stringency criteria, 4700 peptides belonged to <italic toggle="yes">taxon_name</italic> taxa that were identified exclusively by <bold>MetaNovo</bold>. These taxa are consistent with expected host peptides that were not identified by the other runs (no <italic toggle="yes">Homo sapiens</italic> peptides were identified by the other approaches). <italic toggle="yes">See <xref rid="pcbi.1011163.s006" ref-type="supplementary-material">S6 Table</xref>.</italic> Conversely, all taxa identified by the other analysis methods were also identified by <bold>MetaNovo.</bold>
<italic toggle="yes">See <xref rid="pcbi.1011163.s007" ref-type="supplementary-material">S7 Table</xref>.</italic> When selecting only Bacteria “<italic toggle="yes">superkingdom_name”</italic> peptides, lower numbers of peptides were identified by <bold>MetaNovo</bold> than for the other runs, with 27289, 30311 and 31591 annotated peptides for <bold>MetaNovo</bold>, <bold>MetaPro-IQ/IGC</bold>, and <bold>MetaPro-IQ/Metagenome</bold>, respectively. A similar taxonomic distribution was visualised for all three runs in this group. <italic toggle="yes">See <xref rid="pcbi.1011163.s016" ref-type="supplementary-material">S2 Fig</xref>.</italic> When aggregating peptide counts at the “<italic toggle="yes">kingdom_name”</italic> level, peptides from <italic toggle="yes">Metazoa</italic>, <italic toggle="yes">Viridiplantae</italic> and <italic toggle="yes">Fungi</italic> kingdoms were represented by all runs, but with much higher numbers represented by <bold>MetaNovo.</bold> These taxa are all known to play key roles in the human gut microbiome, as living or dietary components. <italic toggle="yes">See <xref rid="pcbi.1011163.s008" ref-type="supplementary-material">S8 Table</xref>.</italic> Similarly, aggregated to <italic toggle="yes">Phylum</italic> level, <bold>MetaNovo</bold> identified the same phyla as identified in either of the other runs, but with much higher numbers of <italic toggle="yes">Chordata</italic> peptides. Interestingly, both the <bold>MetaNovo/UniProt</bold> and <bold>MetaPro-IQ/IGC sequence</bold> databases identified <italic toggle="yes">Actinobacteria</italic>—but these were not identified by the <bold>MetaPro-IQ/Metagenome sequence</bold> database. <italic toggle="yes">See <xref rid="pcbi.1011163.s009" ref-type="supplementary-material">S9 Table</xref>.</italic></p>
    </sec>
    <sec id="sec031">
      <title>Analysis of a known microbial mixture using the MetaNovo software yields increased sensitivity compared to matched genomics sequence databases</title>
      <sec id="sec032">
        <title>Protein and peptide identifications</title>
        <p>The <bold>MetaNovo</bold> pipeline was run using the entire, unfiltered <bold>UniProt sequence</bold> database (December 2019 release; ca. 180 million entries), resulting in the identification of 12529 target peptides and 2534 target protein groups, with 44.17% of total MS/MS identified. These results are significantly better with 9.14% more spectra assigned than the best performing genomic sequence database reported by the original authors when run with the same <bold>MaxQuant</bold> settings (single predicted and annotated genomes assembly DB (SGA-PA)) that yielded 35.03% identified MSMS, 10109 target peptides and 2099 target protein groups. The results were almost double those of the metagenome (Meta-PA) sequence database that yielded 23.03% identified MSMS, 6044 target peptides and 1087 target proteins (<italic toggle="yes">See <xref rid="pcbi.1011163.g004" ref-type="fig">Fig 4A</xref></italic>), despite a similar size of the Meta-PA sequence database to the MetaNovo sequence database. Kruskal-Wallis analysis of variance indicated a significant difference in the PEP score distribution of the exclusive, shared and reverse peptide matches of the three runs (statistic = 1525.73, pvalue = 0.0). The median PEP scores of the 3258 and 470 peptides exclusively identified using the MetaNovo and SGA-PA sequence databases were lower and the distributions significantly different to that of reverse hits for the same runs (p-value 1.05e-05 and 3.07e-02, respectively). The median PEP score of the 133 peptides exclusively identified by the Meta-PA sequence database (0.046675) was worse than that of the 11 reverse hit peptides of the same run (0.010709), but the difference was not statistically significant (p-value 8.11e-01). <italic toggle="yes">See <xref rid="pcbi.1011163.s010" ref-type="supplementary-material">S10</xref> and <xref rid="pcbi.1011163.s011" ref-type="supplementary-material">S11</xref> Tables.</italic></p>
        <fig position="float" id="pcbi.1011163.g004">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011163.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>9MM dataset identification results.</title>
            <p><bold>A.</bold> Number of peptides identified in each run. <bold>B.</bold> Number of protein groups identified in each run. <bold>C.</bold> Peptide identification overlap between the different approaches. <bold>D.</bold> Peptide PEP score distribution box plot for shared, exclusive and reverse hit peptides for each run.</p>
          </caption>
          <graphic xlink:href="pcbi.1011163.g004" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec id="sec033">
      <title>Taxon identification rates</title>
      <p>Percentages of misassigned peptides were calculated for all three runs. <bold>MetaNovo</bold> originally yielded a very high percentage of misassigned spectra at species level based on <bold>UniPept</bold>
<italic toggle="yes">pept2lca</italic> analysis. Further analysis of the characterised peptides indicated that most belonged to other <italic toggle="yes">Rhodotorula</italic> species, which corresponds to the authors’ original report of many non-canonical peptides identified in their samples using a 6-frame translated sequence database, which could lead to <bold>UniPept</bold> assignment to closely related organisms. The identification of 38 <italic toggle="yes">Gallus gallus</italic> peptides was narrowed down to components of egg-yolk using <bold>BLASTP</bold> analysis (See <bold><italic toggle="yes">Unexpected taxa BLAST analysis)</italic></bold>. Notably, subsequent personal correspondence with those authors confirmed that egg yolk was present in one of the growth media employed in the experiment. The <italic toggle="yes">Pasteurella multocida</italic> strain analysed in this study was a field isolate (author correspondence), and being a member of Gammaproteobacteria, natural sequence diversity in this strain might be compatible with a classification of <italic toggle="yes">Gammaproteobacteria bacterium</italic>. After allowing for other <italic toggle="yes">Rhodotorula spp</italic>., <italic toggle="yes">Gallus gallus</italic> and <italic toggle="yes">Gammaproteobacteria bacterium</italic> peptides, a species-level misassignment rate of only 1.04% was attained, with 0% error for all sequence databases at genus and family level using the 0.5% taxon-specific peptide stringency cutoff. The 9 <italic toggle="yes">Acidobacteria bacterium</italic> peptides making up the final misassignment percentage of <bold>MetaNovo</bold> could be explained by the higher total number of identified peptides leading to more false hits at the same FDR, actual contaminants, or <bold>UniPept</bold> misassignments of natural variants in the data. <italic toggle="yes">See <xref rid="pcbi.1011163.g005" ref-type="fig">Fig 5</xref> and <xref rid="pcbi.1011163.s012" ref-type="supplementary-material">S12 Table</xref>.</italic></p>
      <fig position="float" id="pcbi.1011163.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011163.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Percentages of misassigned peptides for all three 9MM runs.</title>
          <p><bold>A. MetaNovo</bold> originally yielded a very high percentage of misassigned peptides at species level <bold>UniPept</bold>
<italic toggle="yes">pept2lca</italic> analysis. <bold>B.</bold> Taxonomic breakdown of misassigned peptides <bold>C.</bold> Re-analysis after inclusion of plausible taxa yielded a species-level misassignment rate of only 1.04%, with 0% error for all approaches at genus and family level using the 0.5% taxon-specific peptide stringency cutoff. <bold>D.</bold> 9 <italic toggle="yes">Acidobacteria bacterium</italic> peptides making up the final misassignment percentage of <bold>MetaNovo</bold>.</p>
        </caption>
        <graphic xlink:href="pcbi.1011163.g005" position="float"/>
      </fig>
    </sec>
    <sec id="sec034">
      <title>Taxon assignment accuracy benchmarks based on mean-squared error show the highest accuracy for species-level assignments using MetaNovo</title>
      <p>Mean Squared Error (MSE) scores were calculated for the relative proportion of MS/MS of each taxon to the total of each run compared to the expected proportion by CFU counting as a percentage. Scores closer to 0 indicate higher accuracy. <bold>MetaNovo</bold> had a poorer score than <bold>SGA-PA</bold> for genus level assignments, but the highest accuracy of the three runs for both family and species level assignments. <bold>MetaNovo</bold> outperformed the matched metagenomic sequence database (<bold>Meta-PA)</bold> at all three taxonomic levels. After relabelling all <italic toggle="yes">Rhodotorula</italic> peptides as <italic toggle="yes">Rhodotorula spp</italic>. for the comparison, a further improvement in MSE scores was obtained, corresponding to the author’s report of identifying many non-canonical peptides using the translated 6 frame sequence database for the same organism; some of these assignments may be homologous and identical to canonical peptides in other species in the same genus, and therefore were assigned to those organisms by <bold>UniPept</bold>. <bold><italic toggle="yes">See <xref rid="pcbi.1011163.t001" ref-type="table">Table 1</xref>.</italic></bold></p>
      <table-wrap position="float" id="pcbi.1011163.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011163.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>MetaNovo yields the highest accuracy for species-level annotations compared to matched genomic databases.</title>
          <p>Mean Squared Error (MSE) scores for the relative proportion of MSMS of each taxon to the total of each run compared to the expected proportion by CFU counting as a percentage. Scores closer to 0 indicate higher accuracy.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011163.t001" id="pcbi.1011163.t001g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1"/>
                <th align="right" rowspan="1" colspan="1">Meta-PA</th>
                <th align="right" rowspan="1" colspan="1">SGA-PA</th>
                <th align="right" rowspan="1" colspan="1">MetaNovo—UniProt</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="1" colspan="1">
                  <bold>Family</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">398.89</td>
                <td align="left" rowspan="1" colspan="1">143.58</td>
                <td align="left" rowspan="1" colspan="1">106.08</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">
                  <bold>Genus</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">261.64</td>
                <td align="left" rowspan="1" colspan="1">78.44</td>
                <td align="left" rowspan="1" colspan="1">87.32</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">
                  <bold>Species</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">333.17</td>
                <td align="left" rowspan="1" colspan="1">207.77</td>
                <td align="left" rowspan="1" colspan="1">151.05</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">
                  <bold>Species (relabelled)</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">333.17</td>
                <td align="left" rowspan="1" colspan="1">198.79</td>
                <td align="left" rowspan="1" colspan="1">138.03</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec035">
      <title>Unexpected taxa BLAST analysis</title>
      <p>Of the taxonomically assigned peptides across the three runs, 38 <italic toggle="yes">Gallus gallus</italic> proteins were the largest group of false assignments by the <bold>MetaNovo</bold> pipeline compared to the list of expected taxa. This group was chosen for protein <bold>BLAST</bold> analysis. For each peptide, BLAST results were filtered to only include exact matches (100% identity). For each of these records, the organism names were identified, and 20 peptides that only matched to <italic toggle="yes">Gallus gallus</italic> were obtained as proteotypic peptides for this species, providing strong evidence at sequence level for this species in the data. See <italic toggle="yes"><xref rid="pcbi.1011163.s001" ref-type="supplementary-material">S1 Data</xref> and <xref rid="pcbi.1011163.s013" ref-type="supplementary-material">S13 Table</xref></italic>. A FASTA file of eight protein sequences corresponding to the FASTA headers of the protein groups of the <italic toggle="yes">Gallus gallus</italic> peptides was submitted for protein <bold>BLAST</bold>. For each query in the FASTA file, the set of organisms for all matches with more than 90% sequence identity was investigated—and 5 sequences matched only to <italic toggle="yes">Gallus gallus</italic>. These proteins include <italic toggle="yes">Apovitellenin-1</italic> (P02659), <italic toggle="yes">Vitellogenin-1</italic> (P87498, A0A1D5NUW2), <italic toggle="yes">Vitellogenin-2</italic> (P02845) and <italic toggle="yes">Vitellogenin-3</italic> (A0A3Q2U347). These are all known components of egg yolk. See <italic toggle="yes"><xref rid="pcbi.1011163.s002" ref-type="supplementary-material">S2 Data</xref> and <xref rid="pcbi.1011163.s014" ref-type="supplementary-material">S14 Table</xref></italic>.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec036">
    <title>Discussion</title>
    <p>On re-analysis of a set of Human Mucosal-luminal interface samples, comparative identification rates were achieved, with a &gt;2% increase in the number of MS/MS at the same FDR—but now simultaneously identifying multiple human origin peptides not assessed by the previous approaches—while not leaving out taxa identified by the other runs. The large number of exclusive peptides only identified by <italic toggle="yes">MetaNovo</italic>, can be explained by the previous approaches not including host sequences in the search sequence database, with potential misassignments of host peptides to microbial search sequence database entries for those runs—a known risk for search sequence databases that are not comprehensive (<italic toggle="yes">c</italic>.<italic toggle="yes">f</italic>. the <italic toggle="yes">Apis mellifera</italic> reanalysis example discussed previously) [<xref rid="pcbi.1011163.ref009" ref-type="bibr">9</xref>]. Any such spurious PSMs are likely to have a higher PEP score distribution, overlapping with those from the reverse hit sequence database (which are all by definition spurious sequences)—thus leading to a decreased rate of target peptide identifications at the given FDR cutoff. This explains the lower MS/MS % identification rate of the previous approaches. The improved error distribution of exclusive peptides identified using <bold>MetaNovo</bold> supports this view and contrasts with the error distribution of peptides exclusively identified by <bold>MetaPro-IQ</bold> with the metagenomics sequence database, the latter having a higher median PEP score than and with a distribution not significantly different from the distribution of reverse hits in the same experiment. A similar situation was found for the 9MM samples, where the median PEP score obtained from the Meta-PA only group (0.046675) was higher than the median peptide PEP score for reverse hits (0.010709), but the p-value for the difference in the distributions was not statistically significant. It is reassuring that in no comparison where the median PEP score was higher than for reverse hits, was the difference in the distribution statistically significant. It is interesting, in each case, that it was the sequence database that yielded the poorest MS/MS identification rate, that yielded the poorest PEP scores for peptides exclusively identified using that sequence database (not statistically significantly different from reverse hits) for both the MetaPro-IQ/Metagenome, as well as the Meta-PA 9MM sequence database runs. We suggest that due to poor sequence database representativity, PSMs to incorrect sequences in the sequence database occur due to the non-inclusion of the correct sequences, with peptides exclusively identified by the incomplete sequence databases having much poorer peptide PEP scores than the same groups obtained from the other, more complete sequence databases, and peptides only identified by the most representative sequence databases (by MS/MS percentage assignment) having the best median PEP scores in this category. As <bold>MetaNovo</bold> did not identify any exclusive taxa other than host compared to the other MLI runs, but with higher numbers of viridiplantae and fungi taxa, it points to improved characterization of non-bacterial components while maintaining an accurate characterization of the bacterial component without over-estimating taxonomic diversity. These other components of the gut microbiome may yield key insights into complex inter-specific interactions that may not be evident with approaches that target only limited taxonomies. Lower numbers of Bacterial peptide identifications by <bold>MetaNovo</bold> compared to the other two approaches may be due to the fact that both previous sequence databases are more comprehensive at the Bacterial level, while the <bold>MetaNovo</bold> algorithm aims to be globally representative, and increase the percentage of assigned spectra overall. However, it may also reflect the absence of host proteins from the search space, potentially leading to mis-assignments. Future updates to the <bold>MetaNovo</bold> algorithm will aim to increase the comprehensiveness of the generated sequence database, including known, clinically relevant host polymorphisms and mutations, so that the output can compete with taxonomically focused sequence databases and further increase the global sensitivity of assignments.</p>
    <p>Taxonomic assignment of peptides from the 9MM data to <italic toggle="yes">Rhodotorula</italic> species other than the expected strain by <bold>UniPept</bold>, for both <bold>MetaNovo</bold> (143 peptides) and <bold>SGA-PA</bold> (33 peptides), indicate the limitations of the <bold>UniPept</bold> approach that is based on the transfer of reference annotations to the natural sequence diversity of field isolates. The higher number of <italic toggle="yes">Rhodotorula</italic> peptides identified by <bold>MetaNovo</bold> are consistent with the lower sequence coverage reported for the <italic toggle="yes">R</italic>. <italic toggle="yes">glutinis</italic> strain (x12) used for the <bold>SGA-PA sequence</bold> database. It is notable that the <bold>MetaNovo</bold> approach was able to yield improved performance over full genome sequencing by leveraging sequence information of related strains without prior expectation.</p>
    <p>The almost double MS/MS assignment rate of MetaNovo compared to the Meta-PA sequence database (based on NGS of the two 9MM extracts), despite both sequence databases being almost identical in size, is most likely due to the lack of yeast proteins in the Meta-PA sequence database, excluding two of the 9 species present in the samples from the sequence database search space. This is an example of the utility of an approach that doesnt rely on matched metagenomics data to construct the search sequence database, as these may not be available or of high enough quality.</p>
    <p>The unexpected but confident identification here of proteotypic peptides for <italic toggle="yes">Gallus gallus</italic>, as well as the identification of 5 proteotypic protein groups all related to egg yolk, in the 9MM samples prompted us to conjecture that egg yolk might have been a specific component of the media used for <italic toggle="yes">in vitro</italic> culture of one or more of the 9 microbial species; this was subsequently confirmed by the authors of the original 9MM study. Thus, the identification of putative contaminants that may have otherwise been missed during sequence database creation confirms the power of our approach, including in cases where rare and unknown components of a biological sample would otherwise be missed.</p>
    <p>Despite higher overall detection sensitivity, slightly lower numbers of Bacteria “superkingdom_name” peptides dentified by <bold>MetaNovo</bold> than for the other MLI runs, appears to support the hypothesis of Noble [<xref rid="pcbi.1011163.ref010" ref-type="bibr">10</xref>] that reducing multiple hypotheis testing can increase the sensitivity for peptides of interest, by the greater performance of the Bacteria focused sequence databases in bacterial identifications. The greater overall sensitivity of the <bold>MetaNovo</bold> sequence database, could similarly be due to the inclusion of only the most probable proteins within the included species, thus reducing multiple hypothesis testing globally. It could be an interesting avenue for future work, to provide the ability to limit the search sequence database export by the <bold>MetaNovo</bold> algorithm to only taxa of interest, to further reduce multiple hypothesis testing, both during sequence database filtering from <bold>UniProt</bold>, and peptide identification using the filtered sequence database.</p>
    <p>Higher rates of MS/MS assignments yielded by the <bold>MetaNovo</bold> approach compared to the matched genomic approaches (both <bold>MetaPro-IQ/Metagenome</bold> and <bold>SGA-PA</bold>) indicate the utility of the <bold>MetaNovo</bold> algorithm in leveraging publicly available taxonomic and sequence data without sacrificing search sensitivity. Notably, the original, entire unfiltered <bold>UniProt</bold> sequence database seems likely to be more representative of expressed proteomes and natural sequence diversity in clinical samples than sequence databases compiled from reference bacterial proteomes based on 16S rRNA data and which may not directly reflect the actual sequences present at the proteome level. Further, as gene transcription does not correlate well with protein translation, sequence database generation approaches that rely only on matched metagenomic data may lead to an unnecessarily large search space and therefore decreased sequence database search sensitivity. Indeed, <bold>MetaNovo</bold> does not rely on any prior genomic data on specific samples as a pre-requisite for generation of sequence databases to search the mass spectrometry data against. Instead, <bold>MetaNovo</bold> relies on the sum total of all known, curated protein sequences to provide the search space, which provides additional advantages in circumstances where genomic data is not available or where simultaneous analysis of host, viral, fungal, dietary and bacterial proteomes is needed. Importantly, the production by <bold>MetaNovo</bold> of a more representative but still focused sequence database reduces the potential for mis-assignment of MS/MS due to sequence database incompleteness, leading to an increase in sequence database search sensitivity and accuracy.</p>
    <p>It can be argued that the use here of the <bold>UniProt</bold> (<bold>SwissProt</bold> plus <bold>trEMBL</bold>) sequence database still provides a degree of bias in the search space compared to larger sequence databases such as the <bold>NCBI</bold> nr protein sequence database that contain many more proteins and species from clinical and environmental sources. Moreover, the current reliance of <bold>MetaNovo</bold> on annotated sequences may miss novel sequence polymorphisms present in clinical isolates. Further work to tailor the <bold>MetaNovo</bold> algorithm to work with non-<bold>UniProt</bold> FASTA sequence databases as well as with file formats such as the PSI extended FASTA format (PEFF) that include known clinically relevant polymorphisms, is now underway.</p>
  </sec>
  <sec sec-type="conclusions" id="sec037">
    <title>Conclusion</title>
    <p>In metaproteomic analyses where search spaces can be vast, the accuracy of protein and taxonomic assignment is critical. It is important to note therefore that not only does <bold>MetaNovo</bold> identify a greater total number of proteins per microbiome sample than previous two step approaches, but the clear separation of distributions of observed PEP scores between identified hits in the <bold>MetaNovo</bold>- and decoy sequence databases, coupled with a search space that does not artificially exclude host proteins, provides increased confidence in the spectral assignments made.</p>
    <p>Benchmarking of <bold>MetaNovo</bold> against other two step search tools, including on samples of defined microbial composition, yielded favourable results, with <bold>MetaNovo</bold> providing increased sensitivity without overestimating taxa present in the samples whilst simultaneously identifying unexpected components that may be missed using limited or hand-selected sequence databases.</p>
    <p>By estimating taxonomic and peptide level information on microbiome samples directly from tandem mass spectrometry data, in combination with the entire <bold>UniProt</bold> sequence database, <bold>MetaNovo</bold> allows simultaneous identification of human, bacterial, fungal, viral and other eukaryotic proteins in a given sample, unrestricted by prior expectation or availability of prior genomic data. The freely available MetaNovo algorithm should therefore enable clinically important correlations between changes in microbial protein abundance and change in the host proteome to be investigated in a single analysis, whilst minimising reliance on prior knowledge, or external information such as whole-genome sequencing.</p>
  </sec>
  <sec id="sec038" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011163.s001" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Taxonomic distribution by Kingdom of the UniProtKB 2019_11 release.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s001.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s002" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>Organisms included in the 9MM samples.</title>
        <p>Please refer to original publication, Table 1 [<xref rid="pcbi.1011163.ref033" ref-type="bibr">33</xref>].</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s002.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s003" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>MLI peptide PEP scores comparison.</title>
        <p>Shared—Peptides identified in all runs. Only—Peptides only identified in a particular run. Reverse hits—Reverse peptide hits for a particular run.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s003.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s004" position="float" content-type="local-data">
      <label>S4 Table</label>
      <caption>
        <title>MLI peptide PEP scores Dunn’s test post hoc comparison.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s004.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s005" position="float" content-type="local-data">
      <label>S5 Table</label>
      <caption>
        <title>UniPept pept2lca analysis of MLI samples.</title>
        <p>(CSV)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s005.csv">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s006" position="float" content-type="local-data">
      <label>S6 Table</label>
      <caption>
        <title>Peptide counts of taxa only identified with MetaNovo in the MLI samples.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s006.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s007" position="float" content-type="local-data">
      <label>S7 Table</label>
      <caption>
        <title>Peptide counts of taxa identified in all runs by UniPept <italic toggle="yes">pept2lca</italic> “taxon_name” in the MLI samples.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s007.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s008" position="float" content-type="local-data">
      <label>S8 Table</label>
      <caption>
        <title>“kingdom_name” peptides in the MLI samples.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s008.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s009" position="float" content-type="local-data">
      <label>S9 Table</label>
      <caption>
        <title>“phylum_name” peptides in the MLI samples.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s009.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s010" position="float" content-type="local-data">
      <label>S10 Table</label>
      <caption>
        <title>9MM peptide PEP scores comparison.</title>
        <p>Shared—Peptides identified in all runs. Only—Peptides only identified in a particular run. Reverse hits—Reverse peptide hits for a particular run.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s010.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s011" position="float" content-type="local-data">
      <label>S11 Table</label>
      <caption>
        <title>9MM peptide PEP scores Dunn’s test post hoc comparison.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s011.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s012" position="float" content-type="local-data">
      <label>S12 Table</label>
      <caption>
        <title>UniPept <italic toggle="yes">pept2lca</italic> analysis of 9MM samples.</title>
        <p>(CSV)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s012.csv">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s013" position="float" content-type="local-data">
      <label>S13 Table</label>
      <caption>
        <title>9MM <italic toggle="yes">Gallus gallus</italic> peptide BLAST (tabular).</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s013.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s014" position="float" content-type="local-data">
      <label>S14 Table</label>
      <caption>
        <title>9MM <italic toggle="yes">Gallus gallus</italic> protein BLAST (tabular).</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s014.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s015" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Density plot of MLI peptide PEP scores by group.</title>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s015.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s016" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>Bacteria “superkingdom_name” peptides in the MLI samples.</title>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s016.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s017" position="float" content-type="local-data">
      <label>S1 Data</label>
      <caption>
        <title>9MM <italic toggle="yes">Gallus gallus</italic> peptide BLAST.</title>
        <p>(JSON)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s017.json">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s018" position="float" content-type="local-data">
      <label>S2 Data</label>
      <caption>
        <title>9MM <italic toggle="yes">Gallus gallus</italic> protein BLAST.</title>
        <p>(JSON)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s018.json">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We acknowledge the use of the ilifu cloud computing facility - <ext-link xlink:href="http://www.ilifu.ac.za/" ext-link-type="uri">www.ilifu.ac.za</ext-link>, a partnership between the University of Cape Town, the University of the Western Cape, the University of Stellenbosch, Sol Plaatje University, the Cape Peninsula University of Technology and the South African Radio Astronomy Observatory. The ilifu facility is supported by contributions from the Inter-University Institute for Data Intensive Astronomy (IDIA—a partnership be-tween the University of Cape Town, the University of Pretoria and the University of the Western Cape), the Computational Biology division at UCT and the Data Intensive Research Initiative of South Africa (DIRISA).</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011163.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Ochoa-Hueso</surname><given-names>R.</given-names></name><article-title>Global Change and the Soil Microbiome: A Human-Health Perspective</article-title>. <source>Front Ecol Evol [Internet].</source><year>2017</year><month>Jul</month><day>6</day> [cited 2019 Apr 10];<volume>5</volume>:<fpage>71</fpage>. Available from: <ext-link xlink:href="http://journal.frontiersin.org/article/10.3389/fevo.2017.00071/full" ext-link-type="uri">http://journal.frontiersin.org/article/10.3389/fevo.2017.00071/full</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Blaser</surname><given-names>MJ</given-names></name>, <name><surname>Cardon</surname><given-names>ZG</given-names></name>, <name><surname>Cho</surname><given-names>MK</given-names></name>, <name><surname>Dangl</surname><given-names>JL</given-names></name>, <name><surname>Donohue</surname><given-names>TJ</given-names></name>, <name><surname>Green</surname><given-names>JL</given-names></name>, <etal>et al</etal>. <article-title>Toward a Predictive Understanding of Earth’s Microbiomes to Address 21st Century Challenges</article-title>. <source>mBio</source> [<source>Internet]</source>. <year>2016</year>
<month>Jul</month>
<day>13</day> [cited 2019 Apr 10];<volume>7</volume>(<issue>3</issue>):<fpage>e00714</fpage>–<lpage>16</lpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/27178263" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/27178263</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mBio.00714-16</pub-id>
<?supplied-pmid 27178263?><pub-id pub-id-type="pmid">27178263</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Beyer</surname><given-names>A</given-names></name>, <name><surname>Aebersold</surname><given-names>R</given-names></name>. <article-title>Leading Edge Review On the Dependency of Cellular Protein Levels on mRNA Abundance</article-title>. <year>2016</year> [cited 2021 Apr 16]; Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2016.03.014</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Muth</surname><given-names>T</given-names></name>, <name><surname>Kolmeder</surname><given-names>CA</given-names></name>, <name><surname>Salojärvi</surname><given-names>J</given-names></name>, <name><surname>Keskitalo</surname><given-names>S</given-names></name>, <name><surname>Varjosalo</surname><given-names>M</given-names></name>, <name><surname>Verdam</surname><given-names>FJ</given-names></name>, <etal>et al</etal>. <article-title>Navigating through metaproteomics data: A logbook of database searching</article-title>. <source>Proteomics</source>. <year>2015</year><month>Oct</month><day>1</day>;<volume>15</volume>(<issue>20</issue>):<fpage>3439</fpage>–<lpage>53</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/pmic.201400560</pub-id><?supplied-pmid 25778831?><pub-id pub-id-type="pmid">25778831</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Tanca</surname><given-names>A</given-names></name>, <name><surname>Palomba</surname><given-names>A</given-names></name>, <name><surname>Fraumene</surname><given-names>C</given-names></name>, <name><surname>Pagnozzi</surname><given-names>D</given-names></name>, <name><surname>Manghina</surname><given-names>V</given-names></name>, <name><surname>Deligios</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>The impact of sequence database choice on metaproteomic results in gut microbiota studies</article-title>. <source>Microbiome</source> [Internet]. <year>2016</year>
<month>Sep</month>
<day>27</day> [cited 2021 May 25];<volume>4</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>13</lpage>. Available from: <ext-link xlink:href="https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-016-0196-8" ext-link-type="uri">https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-016-0196-8</ext-link>
<?supplied-pmid 27671352?><pub-id pub-id-type="pmid">26739322</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>H</given-names></name>, <name><surname>Li</surname><given-names>S</given-names></name>, <name><surname>Ye</surname><given-names>Y</given-names></name>. <article-title>A Graph-Centric Approach for Metagenome-Guided Peptide and Protein Identification in Metaproteomics.</article-title><name><surname>Serang</surname><given-names>O</given-names></name>, editor. <source>PLoS Comput Biol</source> [<source>Internet]</source>. <year>2016</year>
<month>Dec</month>
<day>5</day> [cited 2019 Mar 21];<volume>12</volume>(<issue>12</issue>):<fpage>e1005224</fpage>. Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005224</pub-id>
<?supplied-pmid 27918579?><pub-id pub-id-type="pmid">27918579</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Jagtap</surname><given-names>P</given-names></name>, <name><surname>Goslinga</surname><given-names>J</given-names></name>, <name><surname>Kooren</surname><given-names>JA</given-names></name>, <name><surname>Mcgowan</surname><given-names>T</given-names></name>, <name><surname>Wroblewski</surname><given-names>MS</given-names></name>, <name><surname>Seymour</surname><given-names>SL</given-names></name>, <etal>et al</etal>. <article-title>A two-step database search method improves sensitivity in peptide sequence matches for metaproteomics and proteogenomics studies</article-title>. <source>Proteomics</source> [Internet]. <year>2013</year>
<month>Apr</month> [cited 2021 Nov 25];<volume>13</volume>(<issue>8</issue>):<fpage>1352</fpage>–<lpage>7</lpage>. Available from: <ext-link xlink:href="https://pubmed.ncbi.nlm.nih.gov/23412978/" ext-link-type="uri">https://pubmed.ncbi.nlm.nih.gov/23412978/</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1002/pmic.201200352</pub-id>
<?supplied-pmid 23412978?><pub-id pub-id-type="pmid">23412978</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Ning</surname><given-names>Z</given-names></name>, <name><surname>Mayne</surname><given-names>J</given-names></name>, <name><surname>Moore</surname><given-names>JI</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Butcher</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>MetaPro-IQ: a universal metaproteomic approach to studying human and mouse gut microbiota</article-title>. <source>Microbiome</source> [Internet]. <year>2016</year>
<month>Jun</month>
<day>24</day> [cited 2017 Nov 6];<volume>4</volume>(<issue>1</issue>):<fpage>31</fpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/27343061" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/27343061</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-016-0176-z</pub-id>
<?supplied-pmid 27343061?><pub-id pub-id-type="pmid">27343061</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Knudsen</surname><given-names>GM</given-names></name>, <name><surname>Chalkley</surname><given-names>RJ</given-names></name>. <article-title>The effect of using an inappropriate protein database for proteomic data analysis</article-title>. <source>PLoS One [Internet].</source><year>2011</year> [cited 2021 Nov 25];<volume>6</volume>(<issue>6</issue>). Available from: <ext-link xlink:href="https://pubmed.ncbi.nlm.nih.gov/21695130/" ext-link-type="uri">https://pubmed.ncbi.nlm.nih.gov/21695130/</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0020873</pub-id>
<?supplied-pmid 21695130?><pub-id pub-id-type="pmid">21695130</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Noble</surname><given-names>WS</given-names></name>. <article-title>Mass spectrometrists should search only for peptides they care about</article-title>. <source>Nature Methods</source><year>2015</year><volume>12</volume>:<fpage>7</fpage> [Internet]. 2015 Jun 30 [cited 2023 Apr 8];12(<issue>7</issue>):605–8. Available from: <ext-link xlink:href="https://www.nature.com/articles/nmeth.3450" ext-link-type="uri">https://www.nature.com/articles/nmeth.3450</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Mesuere</surname><given-names>B</given-names></name>, <name><surname>Devreese</surname><given-names>B</given-names></name>, <name><surname>Debyser</surname><given-names>G</given-names></name>, <name><surname>Aerts</surname><given-names>M</given-names></name>, <name><surname>Vandamme</surname><given-names>P</given-names></name>, <name><surname>Dawyndt</surname><given-names>P</given-names></name>. <article-title>Unipept: Tryptic Peptide-Based Biodiversity Analysis of Metaproteome Samples</article-title>. <source>J Proteome Res</source> [Internet]. <year>2012</year>
<month>Dec</month>
<day>7</day> [cited 2017 Oct 5];<volume>11</volume>(<issue>12</issue>):<fpage>5773</fpage>–<lpage>80</lpage>. Available from: <ext-link xlink:href="http://pubs.acs.org/doi/abs/" ext-link-type="uri">http://pubs.acs.org/doi/abs/</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1021/pr300576s</pub-id>
<?supplied-pmid 23153116?><pub-id pub-id-type="pmid">23153116</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Mooradian</surname><given-names>AD</given-names></name>, <name><surname>Van Der Postid</surname><given-names>S</given-names></name>, <name><surname>Naegleid</surname><given-names>KM</given-names></name>, <name><surname>Heldid</surname><given-names>JM</given-names></name>. <source>ProteoClade: A taxonomic toolkit for multi-species and metaproteomic analysis</source>. 2020 [cited 2020 Apr 3]; Available from: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1007741</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Frank</surname><given-names>A</given-names></name>, <name><surname>Tanner</surname><given-names>S</given-names></name>, <name><surname>Pevzner</surname><given-names>P</given-names></name>. <article-title>Peptide Sequence Tags for Fast Database Search in Mass-Spectrometry</article-title>. <source>Lecture Notes in Bioinformatics (Subseries of Lecture Notes in Computer Science) [Internet].</source><year>2005</year> [cited 2021 Dec 28];<volume>3500</volume>:<fpage>326</fpage>–<lpage>41</lpage>. Available from: <ext-link xlink:href="https://link.springer.com/chapter/10.1021/pr050011x" ext-link-type="uri">https://link.springer.com/chapter/10.1021/pr050011x</ext-link>
<?supplied-pmid 16083278?><pub-id pub-id-type="pmid">16083278</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Tanner</surname><given-names>S</given-names></name>, <name><surname>Shu</surname><given-names>H</given-names></name>, <name><surname>Frank</surname><given-names>A</given-names></name>, <name><surname>Wang</surname><given-names>LC</given-names></name>, <name><surname>Zandi</surname><given-names>E</given-names></name>, <name><surname>Mumby</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>InsPecT: Identification of Posttranslationally Modified Peptides from Tandem Mass Spectra</article-title>. <source>Anal Chem</source> [Internet]. <year>2005</year>
<month>Jul</month>
<day>15</day> [cited 2021 Dec 28];<volume>77</volume>(<issue>14</issue>):<fpage>4626</fpage>–<lpage>39</lpage>. Available from: <ext-link xlink:href="https://pubs.acs.org/doi/abs/" ext-link-type="uri">https://pubs.acs.org/doi/abs/</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1021/ac050102d</pub-id>
<?supplied-pmid 16013882?><pub-id pub-id-type="pmid">16013882</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Muth</surname><given-names>T</given-names></name>, <name><surname>Renard</surname><given-names>BY</given-names></name>. <article-title>Evaluating de novo sequencing in proteomics: already an accurate alternative to database-driven peptide identification?</article-title><source>Brief Bioinform</source> [Internet]. <year>2018</year>
<month>Sep</month>
<day>28</day> [cited 2021 Dec 28];<volume>19</volume>(<issue>5</issue>):<fpage>954</fpage>–<lpage>70</lpage>. Available from: <ext-link xlink:href="https://academic.oup.com/bib/article/19/5/954/3076504" ext-link-type="uri">https://academic.oup.com/bib/article/19/5/954/3076504</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbx033</pub-id>
<?supplied-pmid 28369237?><pub-id pub-id-type="pmid">28369237</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Chi</surname><given-names>H</given-names></name>, <name><surname>Chen</surname><given-names>H</given-names></name>, <name><surname>He</surname><given-names>K</given-names></name>, <name><surname>Wu</surname><given-names>L</given-names></name>, <name><surname>Yang</surname><given-names>B</given-names></name>, <name><surname>Sun</surname><given-names>RX</given-names></name>, <etal>et al</etal>. <article-title>pNovo+: de novo peptide sequencing using complementary HCD and ETD tandem mass spectra</article-title>. <source>J Proteome Res</source> [Internet]. <year>2013</year>
<month>Feb</month>
<day>1</day> [cited 2021 Dec 28];<volume>12</volume>(<issue>2</issue>):<fpage>615</fpage>–<lpage>25</lpage>. Available from: <ext-link xlink:href="https://pubmed.ncbi.nlm.nih.gov/23272783/" ext-link-type="uri">https://pubmed.ncbi.nlm.nih.gov/23272783/</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1021/pr3006843</pub-id>
<?supplied-pmid 23272783?><pub-id pub-id-type="pmid">23272783</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Tabb</surname><given-names>DL</given-names></name>, <name><surname>Ma</surname><given-names>ZQ</given-names></name>, <name><surname>Martin</surname><given-names>DB</given-names></name>, <name><surname>Ham</surname><given-names>AJL</given-names></name>, <name><surname>Chambers</surname><given-names>MC</given-names></name>. <article-title>DirecTag: Accurate Sequence Tags from Peptide MS/MS through Statistical Scoring</article-title>. <source>J Proteome Res</source> [Internet]. <year>2008</year>
<month>Sep</month>
<day>5</day> [cited 2017 Oct 5];<volume>7</volume>(<issue>9</issue>):<fpage>3838</fpage>–<lpage>46</lpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/18630943" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/18630943</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1021/pr800154p</pub-id>
<?supplied-pmid 18630943?><pub-id pub-id-type="pmid">18630943</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>H</given-names></name>, <name><surname>Chi</surname><given-names>H</given-names></name>, <name><surname>Zeng</surname><given-names>WF</given-names></name>, <name><surname>Zhou</surname><given-names>WJ</given-names></name>, <name><surname>He</surname><given-names>SM</given-names></name>. <article-title>pNovo 3: precise de novo peptide sequencing using a learning-to-rank framework</article-title>. <source>Bioinformatics</source> [Internet]. <year>2019</year>
<month>Jul</month>
<day>15</day> [cited 2021 Dec 28];<volume>35</volume>(<issue>14</issue>):<fpage>i183</fpage>–<lpage>90</lpage>. Available from: <ext-link xlink:href="https://pubmed.ncbi.nlm.nih.gov/31510687/" ext-link-type="uri">https://pubmed.ncbi.nlm.nih.gov/31510687/</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btz366</pub-id>
<?supplied-pmid 31510687?><pub-id pub-id-type="pmid">31510687</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Alisoltani</surname><given-names>A</given-names></name>, <name><surname>Manhanzva</surname><given-names>MT</given-names></name>, <name><surname>Potgieter</surname><given-names>M</given-names></name>, <name><surname>Balle</surname><given-names>C</given-names></name>, <name><surname>Bell</surname><given-names>L</given-names></name>, <name><surname>Ross</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Microbial function and genital inflammation in young South African women at high risk of HIV infection</article-title>. <source>Microbiome</source>. <year>2020</year><month>Dec</month><day>1</day>;<volume>8</volume>(<issue>1</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-020-00932-8</pub-id><?supplied-pmid 33220709?><pub-id pub-id-type="pmid">33220709</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Delgado-Diaz</surname><given-names>DJ</given-names></name>, <name><surname>Jesaveluk</surname><given-names>B</given-names></name>, <name><surname>Hayward</surname><given-names>JA</given-names></name>, <name><surname>Tyssen</surname><given-names>D</given-names></name>, <name><surname>Alisoltani</surname><given-names>A</given-names></name>, <name><surname>Potgieter</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Lactic acid from vaginal microbiota enhances cervicovaginal epithelial barrier integrity by promoting tight junction protein expression.</article-title><source>Microbiome.</source><year>2022</year><month>Aug</month><day>31</day>;<volume>10</volume>(<issue>1</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-022-01337-5</pub-id><?supplied-pmid 36045402?><pub-id pub-id-type="pmid">36045402</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Chigorimbo-Murefu</surname><given-names>NTL</given-names></name>, <name><surname>Potgieter</surname><given-names>MG</given-names></name>, <name><surname>Dzanibe</surname><given-names>S</given-names></name>, <name><surname>Gabazana</surname><given-names>Z</given-names></name>, <name><surname>Buri</surname><given-names>G</given-names></name>, <name><surname>Chawla</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A Pilot Study to show that asymptomatic sexually transmitted infections alter the foreskin epithelial proteome.</article-title><source>Front Microbiol.</source><year>2022</year>;<volume>0</volume>:<fpage>3536</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fmicb.2022.928317</pub-id><?supplied-pmid 36325020?><pub-id pub-id-type="pmid">36325020</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Wagner</surname><given-names>R</given-names></name>, <name><surname>Thuy-Boun</surname><given-names>P</given-names></name>, <name><surname>McArdle</surname><given-names>A</given-names></name>, <name><surname>Mehta</surname><given-names>S</given-names></name>, <name><surname>Johnson</surname><given-names>J</given-names></name>, <name><surname>Grüning</surname><given-names>B</given-names></name>, <etal>et al</etal>. <article-title>ComPIL 2.0 and MetaNovo Tools for Metaproteomics Searches Within Galaxy: Searching for Needles in a Haystack.</article-title><source>In: 2021 Galaxy Community Conference (GCC2021) [Internet].</source><year>2021</year> [cited 2022 Oct 6]. Available from: <ext-link xlink:href="https://static.sched.com/hosted_files/gcc2021/69/abstract91.pdf" ext-link-type="uri">https://static.sched.com/hosted_files/gcc2021/69/abstract91.pdf</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref023">
      <label>23</label>
      <mixed-citation publication-type="other">Index of /pub/databases/uniprot/previous_releases/release-2019_11/ [Internet]. [cited 2020 Apr 22]. Available from: <ext-link xlink:href="ftp://ftp.uniprot.org/pub/databases/uniprot/previous_releases/release-2019_11/" ext-link-type="ftp">ftp://ftp.uniprot.org/pub/databases/uniprot/previous_releases/release-2019_11/</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref024">
      <label>24</label>
      <mixed-citation publication-type="other">uct-cbio/proteomics-pipelines: A repo with a proteogenomics and metaproteomics pipeline developed by Matthys Potgieter. [Internet]. [cited 2020 Apr 22]. Available from: <ext-link xlink:href="https://github.com/uct-cbio/proteomics-pipelines" ext-link-type="uri">https://github.com/uct-cbio/proteomics-pipelines</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">thyscbio/metanovo—Docker Hub [Internet]. [cited 2020 Apr 22]. Available from: <ext-link xlink:href="https://hub.docker.com/r/thyscbio/metanovo" ext-link-type="uri">https://hub.docker.com/r/thyscbio/metanovo</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Perez-Riverol</surname><given-names>Y</given-names></name>, <name><surname>Csordas</surname><given-names>A</given-names></name>, <name><surname>Bai</surname><given-names>J</given-names></name>, <name><surname>Bernal-Llinares</surname><given-names>M</given-names></name>, <name><surname>Hewapathirana</surname><given-names>S</given-names></name>, <name><surname>Kundu</surname><given-names>DJ</given-names></name>, <etal>et al</etal>. <article-title>The PRIDE database and related tools and resources in 2019: improving support for quantification data.</article-title><source>Nucleic Acids Res</source> [Internet]. 2019 Jan 8 [cited 2019 Jun 12];<volume>47</volume>(<issue>D1</issue>):<fpage>D442</fpage>–<lpage>50</lpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/30395289" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/30395289</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gky1106</pub-id>
<?supplied-pmid 30395289?><pub-id pub-id-type="pmid">30395289</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Muth</surname><given-names>T</given-names></name>, <name><surname>Weilnböck</surname><given-names>L</given-names></name>, <name><surname>Rapp</surname><given-names>E</given-names></name>, <name><surname>Huber</surname><given-names>CG</given-names></name>, <name><surname>Martens</surname><given-names>L</given-names></name>, <name><surname>Vaudel</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>DeNovoGUI: an open source graphical user interface for de novo sequencing of tandem mass spectra</article-title>. <source>J Proteome Res</source> [Internet]. <year>2014</year>
<month>Feb</month>
<day>7</day> [cited 2016 May 11];<volume>13</volume>(<issue>2</issue>):<fpage>1143</fpage>–<lpage>6</lpage>. Available from: <ext-link xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3923451&amp;tool=pmcentrez&amp;rendertype=abstract" ext-link-type="uri">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3923451&amp;tool=pmcentrez&amp;rendertype=abstract</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1021/pr4008078</pub-id>
<?supplied-pmid 24295440?><pub-id pub-id-type="pmid">24295440</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref028">
      <label>28</label>
      <mixed-citation publication-type="other">SQLite Home Page [Internet]. [cited 2020 Apr 22]. Available from: <ext-link xlink:href="https://www.sqlite.org/index.html" ext-link-type="uri">https://www.sqlite.org/index.html</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Kopczynski</surname><given-names>D</given-names></name>, <name><surname>Barsnes</surname><given-names>H</given-names></name>, <name><surname>Njølstad</surname><given-names>PR</given-names></name>, <name><surname>Sickmann</surname><given-names>A</given-names></name>, <name><surname>Vaudel</surname><given-names>M</given-names></name>, <name><surname>Ahrends</surname><given-names>R</given-names></name>. <article-title>PeptideMapper: efficient and versatile amino acid sequence and tag mapping</article-title>. <source>Bioinformatics</source> [Internet]. <year>2017</year>
<month>Jul</month>
<day>1</day> [cited 2017 Nov 6];<volume>33</volume>(<issue>13</issue>):<fpage>2042</fpage>–<lpage>4</lpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/28334306" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/28334306</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btx122</pub-id>
<?supplied-pmid 28334306?><pub-id pub-id-type="pmid">28334306</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Barsnes</surname><given-names>H</given-names></name>, <name><surname>Vaudel</surname><given-names>M</given-names></name>, <name><surname>Colaert</surname><given-names>N</given-names></name>, <name><surname>Helsens</surname><given-names>K</given-names></name>, <name><surname>Sickmann</surname><given-names>A</given-names></name>, <name><surname>Berven</surname><given-names>FS</given-names></name>, <etal>et al</etal>. <article-title>compomics-utilities: an open-source Java library for computational proteomics</article-title>. <source>BMC Bioinformatics</source> [Internet]. <year>2011</year>
<month>Mar</month>
<day>8</day> [cited 2017 Nov 6];<volume>12</volume>(<issue>1</issue>):<fpage>70</fpage>. Available from: <ext-link xlink:href="http://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-12-70" ext-link-type="uri">http://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-12-70</ext-link>
<?supplied-pmid 21385435?><pub-id pub-id-type="pmid">21385435</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Tange</surname><given-names>O.</given-names></name><article-title>GNU Parallel: The Command-Line Power Tool | USENIX</article-title> [Internet]. <source>The USENIX Magazine</source>. <year>2011</year> [cited 2017 Nov 6]. p. <fpage>42</fpage>–<lpage>7</lpage>. Available from: <ext-link xlink:href="https://www.usenix.org/publications/login/february-2011-volume-36-number-1/gnu-parallel-command-line-power-tool" ext-link-type="uri">https://www.usenix.org/publications/login/february-2011-volume-36-number-1/gnu-parallel-command-line-power-tool</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Zybailov</surname><given-names>BL</given-names></name>, <name><surname>Florens</surname><given-names>L</given-names></name>, <name><surname>Washburn</surname><given-names>MP</given-names></name>. <article-title>Quantitative shotgun proteomics using a protease with broad specificity and normalized spectral abundance factors</article-title>. <source>Mol Biosyst</source> [Internet]. <year>2007</year>
<month>May</month> [cited 2017 Nov 7];<volume>3</volume>(<issue>5</issue>):<fpage>354</fpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/17460794" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/17460794</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1039/b701483j</pub-id>
<?supplied-pmid 17460794?><pub-id pub-id-type="pmid">17460794</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Tanca</surname><given-names>A</given-names></name>, <name><surname>Palomba</surname><given-names>A</given-names></name>, <name><surname>Deligios</surname><given-names>M</given-names></name>, <name><surname>Cubeddu</surname><given-names>T</given-names></name>, <name><surname>Fraumene</surname><given-names>C</given-names></name>. <article-title>Evaluating the Impact of Different Sequence Databases on Metaproteome Analysis: Insights from a Lab-Assembled Microbial Mixture</article-title>. <source>PLoS One [Internet].</source><year>2013</year> [cited 2020 Sep 25];<volume>8</volume>(<issue>12</issue>):<fpage>82981</fpage>. Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0082981</pub-id>
<?supplied-pmid 24349410?><pub-id pub-id-type="pmid">24349410</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Käll</surname><given-names>L</given-names></name>, <name><surname>Storey</surname><given-names>JD</given-names></name>, <name><surname>MacCoss</surname><given-names>MJ</given-names></name>, <name><surname>Noble</surname><given-names>WS</given-names></name>. <article-title>Posterior error probabilities and false discovery rates: two sides of the same coin</article-title>. <source>J Proteome Res</source> [Internet]. <year>2008</year>
<month>Jan</month>;<volume>7</volume>(<issue>1</issue>):<fpage>40</fpage>–<lpage>4</lpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/18052118" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/18052118</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1021/pr700739d</pub-id>
<?supplied-pmid 18052118?><pub-id pub-id-type="pmid">18052118</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Krug</surname><given-names>K</given-names></name>, <name><surname>Carpy</surname><given-names>A</given-names></name>, <name><surname>Behrends</surname><given-names>G</given-names></name>, <name><surname>Matic</surname><given-names>K</given-names></name>, <name><surname>Soares</surname><given-names>NC</given-names></name>, <name><surname>Macek</surname><given-names>B</given-names></name>. <article-title>Deep Coverage of the Escherichia coli Proteome Enables the Assessment of False Discovery Rates in Simple Proteogenomic Experiments</article-title>. <source>Mol Cell Proteomics</source> [Internet]. <year>2013</year>
<month>Nov</month> [cited 2022 Jan 10];<volume>12</volume>(<issue>11</issue>):<fpage>3420</fpage>. Available from: /pmc/articles/PMC3820952/ <comment>doi: </comment><pub-id pub-id-type="doi">10.1074/mcp.M113.029165</pub-id>
<?supplied-pmid 23908556?><pub-id pub-id-type="pmid">23908556</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Jia</surname><given-names>H</given-names></name>, <name><surname>Cai</surname><given-names>X</given-names></name>, <name><surname>Zhong</surname><given-names>H</given-names></name>, <name><surname>Feng</surname><given-names>Q</given-names></name>, <name><surname>Sunagawa</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>An integrated catalog of reference genes in the human gut microbiome</article-title>. <source>Nature Biotechnology</source><year>2014</year><volume>32</volume>:<fpage>8</fpage> [Internet]. 2014 Jul 6 [cited 2022 Jan 13];32(<issue>8</issue>):834–41. Available from: <ext-link xlink:href="https://www.nature.com/articles/nbt.2942" ext-link-type="uri">https://www.nature.com/articles/nbt.2942</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.2942</pub-id>
<?supplied-pmid 24997786?><pub-id pub-id-type="pmid">24997786</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref037">
      <label>37</label>
      <mixed-citation publication-type="other">Protein BLAST: search protein databases using a protein query [Internet]. [cited 2022 Jan 4]. Available from: <ext-link xlink:href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?PROGRAM=blastp&amp;PAGE_TYPE=BlastSearch&amp;LINK_LOC=blasthome" ext-link-type="uri">https://blast.ncbi.nlm.nih.gov/Blast.cgi?PROGRAM=blastp&amp;PAGE_TYPE=BlastSearch&amp;LINK_LOC=blasthome</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1011163.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011163.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ioshikhes, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ioshikhes, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011163" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">7 Feb 2023</named-content>
    </p>
    <p>Dear Potgieter,</p>
    <p>Thank you very much for submitting your manuscript "MetaNovo : an open-source pipeline for probabilistic peptide discovery in complex metaproteomic datasets" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.</p>
    <p>The reviewers all agree on the high quality of the manuscript and raise only matters related to presentation. Thus, we expect that these matters can be addressed quickly.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Luis Pedro Coelho</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Lucy Houghton</p>
    <p>Staff</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>The reviewers all agree on the high quality of the manuscript and raise only matters related to presentation. Thus, we expect that these matters can be addressed quickly.</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: In this manuscript, Potgieter et al developed a metaproteomic data analysis tool, MetaNovo, which involves de novo sequencing in the first step for the refined database generation. MetaNovo enables peptide identification from a comprehensive Uniprot database directly. This method is widely applicable to a variety of multi-species samples. The peptides from the host and other contaminants can also be identified simultaneously, which can improve the identification rate and reduce the random matches. This work can help researchers in various fields aiming to study the proteome from multi-species samples. There are some minor concerns that need to be addressed before publication.</p>
    <p>1. The users care about how fast the software runs. Could the authors provide the running time for the generation of the refined database from the Uniprot database by the de novo strategy?</p>
    <p>2. Could the authors double-check the data used in Figure 3D and Figure 4D? It looks a little bit strange that there are parts of PSMs with higher PEP scores than the reverse parts. We know that the reverse parts represent the random matches, and if the “metaproiq-metagenome: only” in Figure 3D and the “Meta-PA: only” in Figure 4D are also random matches, the PEP distributions will be similar. However, these two parts showed significantly higher PEP scores than random matches. Besides, this trend was observed from two different datasets and was surprisingly consistent. If it’s correct, can you explore the reasons for this result?</p>
    <p>3. Page 7, line 160. “for example using 16S sequencing data to produce a focused metaproteome library to search”. Here the word “library ” may cause a misunderstanding that it means a “spectra library”. I think it’s better to replace it with “database”.</p>
    <p>4. Page 24, line 526-527. “The results were almost double those of the metagenome DB (Meta-PA) database that yielded 23.03 % identified MSMS, 6044 target peptides and 1087 target proteins”. What’s the size of the Meta-PA database? Is the size of Meta-PA too big which leads to lower identification rate? How many peptides can be identified if you use the MetaNovo workflow based on the Meta-PA database?</p>
    <p>5. Page 26, line 551. “or UniPept misassignments of natural variants in the data.” The database used here is a Uniprot database, which incorporates taxonomic information. Are the identified protein names the same as the UniPept results? Actually, considering the Uniprot database contains the information of the organism for each protein, why use UniPept in the workflow instead of using the taxonomic information directly?</p>
    <p>6. Page 33, line 714-716. The ethics statement mentioned that adult stool samples were used, but no related content was found in the article. Only two public datasets were downloaded and analyzed in the manuscript.</p>
    <p>Reviewer #2: I think this paper contributes an important methodology to the proteomics and metaproteomics fields of study. It proposes that instead of making assumptions about the composition of organisms in a metaproteomics sample, we can use the vast amount of sequenced proteins that are publicly available and let the mass spectrometry data speak for itself. They do this by using de novo sequencing of peptides, followed by tag matching to the massive database of UniProt, and then they use their scoring and ranking metric to determine the which proteins should be put in the targeted database. Next, they take advantage of the standard database search of the mass spectrometry data, followed by using UniPept to determine what organism were present in the sample.</p>
    <p>While a 2% increase in the number of identified MS/MS spectra is not astonishing, the fact that this pipeline allows the user to not make any assumptions on the composition of their sample is immensely useful. This research is of high importance to many different areas of research where metagenomics and metaproteomics are used as tools to study complex biological systems. MetaNovo is particularly applicable if a lab does not have to budget or expertise to do metagenomics sequencing in addition to metaproteomics. The authors showed that they were able to detect chicken egg yoke proteins from the media that their sample was cultured on. This indicates that the MetaNovo method will also provide a better list of contaminate proteins.</p>
    <p>I was able to access their GitHub code and their PRIDE data. While their code base is not thoroughly documented, it is well organized and readable, and their GitHub page has instructions for how to install and run the MetaNovo software. Between their supplemental material, raw data on PRIDE, and their public GitHub code I believe that this study is repeatable by the scientific community.</p>
    <p>The authors come to reasonable conclusions that are backed up by their data, both in their figures and supplemental material. Just from my own curiosity, I’d be interested in seeing approximately how much time the MetaNovo pipeline takes to run on three replicate MGF files on a personal workstation or on a cluster. Finally, line 760 says ‘S8_table.csv’ but the file downloaded is S8_figure.png.</p>
    <p>Reviewer #3: This paper describes the algorithms, implementation, and results of a bioinformatics tool that uses de novo peptide identification to analyze LC-MS/MS metaproteomics data, specifically to create a database of protein sequences to use with traditional proteomics database search. The results show that the new tool has some advantages over more traditional methods of creating databases for metaproteomics/microbial community samples. The methods are sound and original, the results are interesting and the paper should be published. However, there are a few revisions that the authors could make to make their paper easier to understand. The authors should consider the following points:</p>
    <p>1. Figures. Graphics resolution is low and type is very small in figures 3, 4, and 5. The small type is extremely hard to read and presents a real obstacle to understanding the paper. Authors should consider reformatting the figures, or breaking up multipart figures into multiple figures, to allow a larger font size. Possibly this is partly due to the automatic formatting in to a PDF file for reviewers, but as provided to the reviewer, the font size is too small. In addition, many plots are missing y-axis labels. I also found Figure 2 to be difficult to understand. What does the arrow represent? Do the colors encode important information? Authors should consider revising the graphic, significantly expanding the caption, or possibly both. Also consider making the y-axis of Figure 3D and 4D logarithmic to should differences at lot PEP values better. Captions should include the dataset used.</p>
    <p>2. Dangers of omitting present organisms from the search database (page 8, lines 184-191). The authors cite Knudsen and Chalkley (reference 9 in the manuscript) as an example of what can happen when a true component of the sample is omitted from the search database. In this paper, Knudsen and Chalkley reexamine the data of Bromenshenk et al., who looked for protein markers of honeybee pathogens without including the honeybee protein database in their database. Knudsen and Chalkley do reach the conclusion that this omission was the cause of incorrect peptide identifications. However, Noble (<ext-link xlink:href="https://www.nature.com/articles/nmeth.3450" ext-link-type="uri">https://www.nature.com/articles/nmeth.3450</ext-link>) also reexamined the Bromenshenk data and reached a different conclusion: that only a small number of spectral assigned to pathogens should have been assigned to honeybee peptides, and “the choice of database does not explain the incorrect results obtained by Bromenshenk et al.” (Noble). Since the authors invoke Knudsen and Chalkley’s conclusion as a reason for the increased success of MetaNovo (page 28 line 603), I would be very interested to hear how they account for Noble’s arguments in this context.</p>
    <p>3. What do you mean by database? When describing each data set analyzed, the authors indicate the size of the search database produced by MetaNovo (e.g. page 17 lines 374-376 for the mucosal-luminal interface dataset). If I am following correctly, this “database” is the product of the whole MetaNovo pipeline, the “parsimonious protein subset identified” indicated near the bottom center of Figure 1. There is some possibility for the reader to confuse this database with the SQLite database that holds all the the DirecTag results, described on page 13 lines 287-291. The authors should consider how to distinguish these two uses of the word “database” to ensure that the results section is clear. I’m not just trying to nitpick here, it actually confused me the first time through.</p>
    <p>4. Page 23 line 501. Clarify what is meant by “taxon_name taxa.”</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>Figure Files:</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link xlink:href="https://pacev2.apexcovantage.com" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>Data Requirements:</p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>Reproducibility:</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>References:</p>
    <p>Review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript.</p>
    <p>
      <italic toggle="yes">If you need to cite a retracted article, indicate the article’s retracted status in the References list and also include a citation and full reference for the retraction notice.</italic>
    </p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1011163.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011163.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011163" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">12 Apr 2023</named-content>
    </p>
    <supplementary-material id="pcbi.1011163.s019" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Letter of Responses to Reviewers Comments .docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1011163.s019.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1011163.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011163.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ioshikhes, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ioshikhes, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011163" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">8 May 2023</named-content>
    </p>
    <p>Dear Prof Blackburn,</p>
    <p>We are pleased to inform you that your manuscript 'MetaNovo : an open-source pipeline for probabilistic peptide discovery in complex metaproteomic datasets' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Luis Pedro Coelho</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Ilya Ioshikhes</p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Lucy Houghton</p>
    <p>Staff</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1011163.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011163.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ioshikhes, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ioshikhes, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011163" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">13 Jun 2023</named-content>
    </p>
    <p>PCOMPBIOL-D-22-01483R1 </p>
    <p>MetaNovo: an open-source pipeline for probabilistic peptide discovery in complex metaproteomic datasets</p>
    <p>Dear Dr Blackburn,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Anita Estes</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1011163.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10310047</article-id>
    <article-id pub-id-type="pmid">37327214</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011163</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-22-01483</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Sequence Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Database Searching</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Metagenomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical Microbiology</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Microbiome</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Microbial Genomics</subject>
            <subj-group>
              <subject>Microbiome</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Database and informatics methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence analysis</subject>
              <subj-group>
                <subject>BLAST algorithm</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Proteomes</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
            <subj-group>
              <subject>Open Source Software</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Computer Software</subject>
            <subj-group>
              <subject>Open Source Software</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Science Policy</subject>
        <subj-group>
          <subject>Open Science</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">MetaNovo</italic>: An open-source pipeline for probabilistic peptide discovery in complex metaproteomic datasets</article-title>
      <alt-title alt-title-type="running-head"><italic toggle="yes">MetaNovo</italic>—Probabilistic peptide discovery in metaproteomics</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9919-9210</contrib-id>
        <name>
          <surname>Potgieter</surname>
          <given-names>Matthys G.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nel</surname>
          <given-names>Andrew J. M.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8148-7807</contrib-id>
        <name>
          <surname>Fortuin</surname>
          <given-names>Suereta</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Garnett</surname>
          <given-names>Shaun</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wendoh</surname>
          <given-names>Jerome M.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7223-578X</contrib-id>
        <name>
          <surname>Tabb</surname>
          <given-names>David L.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Mulder</surname>
          <given-names>Nicola J.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8988-9595</contrib-id>
        <name>
          <surname>Blackburn</surname>
          <given-names>Jonathan M.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Computational Biology Division, Department of Integrative Biomedical Sciences, University of Cape Town, Cape Town, South Africa</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Division of Chemical and Systems Biology, Department of Integrative Biomedical Sciences, University of Cape Town, Cape Town, South Africa</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Division of Immunology, Department of Pathology, University of Cape Town, Cape Town, South Africa</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Division of Molecular Biology and Human Genetics, Department of Biomedical Sciences; African Microbiome Institute; South African Tuberculosis Bioinformatics Initiative; Stellenbosch University, Cape Town, South Africa</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Institute of Infectious Disease &amp; Molecular Medicine, Faculty of Health Sciences, University of Cape Town, Cape Town, South Africa</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>CANADA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors declare that they have no competing interests.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>nicola.mulder@uct.ac.za</email> (NJM); <email>jonathan.blackburn@uct.ac.za</email> (JMB)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>19</volume>
    <issue>6</issue>
    <elocation-id>e1011163</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 Potgieter et al</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Potgieter et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011163.pdf"/>
    <abstract>
      <sec id="sec001">
        <title>Background</title>
        <p>Microbiome research is providing important new insights into the metabolic interactions of complex microbial ecosystems involved in fields as diverse as the pathogenesis of human diseases, agriculture and climate change. Poor correlations typically observed between RNA and protein expression datasets make it hard to accurately infer microbial protein synthesis from metagenomic data. Additionally, mass spectrometry-based metaproteomic analyses typically rely on focused search sequence databases based on prior knowledge for protein identification that may not represent all the proteins present in a set of samples. Metagenomic 16S rRNA sequencing only targets the bacterial component, while whole genome sequencing is at best an indirect measure of expressed proteomes. Here we describe a novel approach, <bold>MetaNovo</bold>, that combines existing open-source software tools to perform scalable <italic toggle="yes">de novo</italic> sequence tag matching with a novel algorithm for probabilistic optimization of the entire <bold>UniProt</bold> knowledgebase to create tailored sequence databases for target-decoy searches directly at the proteome level, enabling metaproteomic analyses without prior expectation of sample composition or metagenomic data generation and compatible with standard downstream analysis pipelines.</p>
      </sec>
      <sec id="sec002">
        <title>Results</title>
        <p>We compared <bold>MetaNovo</bold> to published results from the <bold>MetaPro-IQ</bold> pipeline on 8 human mucosal-luminal interface samples, with comparable numbers of peptide and protein identifications, many shared peptide sequences and a similar bacterial taxonomic distribution compared to that found using a matched metagenome sequence database—but simultaneously identified many more non-bacterial peptides than the previous approaches<bold>. MetaNovo</bold> was also benchmarked on samples of known microbial composition against matched metagenomic and whole genomic sequence database workflows, yielding many more MS/MS identifications for the expected taxa, with improved taxonomic representation, while also highlighting previously described genome sequencing quality concerns for one of the organisms, and identifying an experimental sample contaminant without prior expectation.</p>
      </sec>
      <sec id="sec003">
        <title>Conclusions</title>
        <p>By estimating taxonomic and peptide level information directly on microbiome samples from tandem mass spectrometry data, <bold>MetaNovo</bold> enables the simultaneous identification of peptides from all domains of life in metaproteome samples, bypassing the need for curated sequence databases to search. We show that the <bold>MetaNovo</bold> approach to mass spectrometry metaproteomics is more accurate than current gold standard approaches of tailored or matched genomic sequence database searches, can identify sample contaminants without prior expectation and yields insights into previously unidentified metaproteomic signals, building on the potential for complex mass spectrometry metaproteomic data to speak for itself.</p>
      </sec>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p><bold>MetaNovo</bold> is an open-source software pipeline that integrates existing tools with a custom algorithm to produce targeted protein sequence databases for mass spectrometry metaproteomic analysis as an intermediate filtering step prior to standard sequence database search approaches. <bold>MetaNovo</bold> uses open-source tools to match peptide mass spectrometry spectra to sequence database entries in a parallelised and scalable manner and can be installed in a cluster or run standalone on a Linux machine. The software is scalable to the number of input files and search sequence database size. As inputs the software requires raw mass spectrometry data in MGF format, and a <bold>UniProt</bold> FASTA sequence database to search. The pipeline is relevant to users analysing protein data from multiple organisms, where the exact species composition is unknown, such as microbiome or environmental samples, and provides an avenue for analysis when matched metagenomics data or accurate taxonomic characterisation is not available as it infers the organisms and proteins present directly from the raw data and the parent sequence database. The targeted sequence database produced can be used with standard downstream peptide identification software that relies on a targeted input sequence database to search the raw data against and allows greater sensitivity in peptide spectral matching in metaproteomic datasets.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>National Research Foundation (ZA)</institution>
        </funding-source>
        <award-id>NRF BFG 93665</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9919-9210</contrib-id>
          <name>
            <surname>Potgieter</surname>
            <given-names>Matthys G.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>South African Tuberculosis Bioinformatics Initiative</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7223-578X</contrib-id>
          <name>
            <surname>Tabb</surname>
            <given-names>David L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001322</institution-id>
            <institution>South African Medical Research Council</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7223-578X</contrib-id>
          <name>
            <surname>Tabb</surname>
            <given-names>David L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>Department of Science and Technology, South Africa</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7223-578X</contrib-id>
          <name>
            <surname>Tabb</surname>
            <given-names>David L.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution>National Research Foundation (ZA)</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8988-9595</contrib-id>
          <name>
            <surname>Blackburn</surname>
            <given-names>Jonathan M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>MGP would like to thank the National Research Foundation (NRF) of South Africa for an MSc grant (NRF BFG 93665). DLT was supported by the South African Tuberculosis Bioinformatics Initiative (SATBBI), a Strategic Health Innovation Partnership grant from the South African Medical Research Council and South African Department of Science and Technology. JMB thanks the NRF for a South African Research Chair grant. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="1"/>
      <page-count count="22"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2023-06-29</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The Human mucosal-luminal interface mass spectrometry proteomics data are available from the ProteomeXchange Consortium via the PRIDE partner repository with the dataset identifier PXD003528, and all results have been uploaded to the ProteomeXchange Consortium via the PRIDE partner repository with the dataset identifier PXD030708 (<ext-link xlink:href="https://www.ebi.ac.uk/pride/archive/projects/PXD030708" ext-link-type="uri">https://www.ebi.ac.uk/pride/archive/projects/PXD030708</ext-link>). The MetaNovo software is available from GitHub (<ext-link xlink:href="https://github.com/uct-cbio/proteomics-pipelines/releases/tag/v1.7.0" ext-link-type="uri">https://github.com/uct-cbio/proteomics-pipelines/releases/tag/v1.7.0</ext-link>) and can be run as a standalone Singularity or Docker container available from the Docker Hub (<ext-link xlink:href="https://hub.docker.com/r/thyscbio/metanovo" ext-link-type="uri">https://hub.docker.com/r/thyscbio/metanovo</ext-link>). The companion code used to generate the analysis for this manuscript are available in a dedicated repository on GitHub as jupyter notebooks (<ext-link xlink:href="https://github.com/Thys3Potgieter/Metanovo-Manuscript" ext-link-type="uri">https://github.com/Thys3Potgieter/Metanovo-Manuscript</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The Human mucosal-luminal interface mass spectrometry proteomics data are available from the ProteomeXchange Consortium via the PRIDE partner repository with the dataset identifier PXD003528, and all results have been uploaded to the ProteomeXchange Consortium via the PRIDE partner repository with the dataset identifier PXD030708 (<ext-link xlink:href="https://www.ebi.ac.uk/pride/archive/projects/PXD030708" ext-link-type="uri">https://www.ebi.ac.uk/pride/archive/projects/PXD030708</ext-link>). The MetaNovo software is available from GitHub (<ext-link xlink:href="https://github.com/uct-cbio/proteomics-pipelines/releases/tag/v1.7.0" ext-link-type="uri">https://github.com/uct-cbio/proteomics-pipelines/releases/tag/v1.7.0</ext-link>) and can be run as a standalone Singularity or Docker container available from the Docker Hub (<ext-link xlink:href="https://hub.docker.com/r/thyscbio/metanovo" ext-link-type="uri">https://hub.docker.com/r/thyscbio/metanovo</ext-link>). The companion code used to generate the analysis for this manuscript are available in a dedicated repository on GitHub as jupyter notebooks (<ext-link xlink:href="https://github.com/Thys3Potgieter/Metanovo-Manuscript" ext-link-type="uri">https://github.com/Thys3Potgieter/Metanovo-Manuscript</ext-link>).</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Software paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec004">
    <title>Introduction</title>
    <p>Characterising microbial ecosystems from clinical or environmental samples promises insights into the complex metabolic pathways involved in processes as diverse as carbon sequestration and climate change to the susceptibility and progression of human diseases [<xref rid="pcbi.1011163.ref001" ref-type="bibr">1</xref>]. Microbial communities play a wide-ranging role in the complex determinants of human well-being, with potential disease implications should the balance be disrupted [<xref rid="pcbi.1011163.ref002" ref-type="bibr">2</xref>].</p>
    <p>Genome and transcriptome sequencing approaches to microbiome analysis allow for functional and taxonomic characterization of the genes and organisms involved in complex microbial communities, but it has been shown that measures of gene transcription do not generally correlate well with measured protein abundance [<xref rid="pcbi.1011163.ref003" ref-type="bibr">3</xref>]. On the other hand, metaproteomic and clinical proteomic approaches in principle allow researchers to obtain a snapshot of all the proteins present in a complex microbiome sample at a given time, providing a quantitative window into key functional components of complex pathways and organism interactions, including the direct measurement of dynamic changes in microbial protein composition, localisation and modification that may mediate host/pathogen interactions in the context of human health and disease.</p>
    <p>Classically, the identification of peptides (and by inference, the parent proteins) from complex mass spectrometry datasets has been largely dependent on the availability of focussed, representative and relatively small sequence databases or spectral libraries against which to search tandem mass spectra—perhaps due in part to the historical emphasis in the field on the analysis of model organism proteomes to answer simple biological questions. However, the analysis of complex, multi-species samples–such as human microbiome samples where the total number of microbial genes may vastly exceed the number of human genes—is far less straightforward for a variety of reasons, including: the vast majority of specific organisms in any given microbiome are likely to not have been cultured, identified, or characterised in the laboratory, so appropriate reference genomes may not exist to underpin proteomic data analyses; and the fact that massive expansion of proteomic sequence databases used in target-decoy-based peptide-spectrum matching has been shown to lead to dramatically reduced identification rates due to higher rates of false negatives and false discovery misestimation problems [<xref rid="pcbi.1011163.ref004" ref-type="bibr">4</xref>].</p>
    <p>Various methods have been developed to address the challenges of metaproteomic MS/MS identification. Previous methods for metaproteomic analysis have addressed these issues essentially by relying on prior expectation of the microbial composition of a given microbiome sample, for example using 16S sequencing data to produce a focussed metaproteome sequence database to search [<xref rid="pcbi.1011163.ref005" ref-type="bibr">5</xref>]. However, some limitations of this approach are that: (i) it assumes that the 16S data itself provides a complete description of all bacteria present in the sample, which is probably not true; (ii) it assumes that appropriate reference bacterial proteomes exist and are close enough in sequence to the clinical isolate proteomes for proteomic data analysis to be valid, which may also not be true; (iii) it automatically ignores all non-bacterial components of the microbiome; &amp; (iv) the expressed proteome even within a single species is dynamic and not constant under all conditions, leading to the likely inclusion of spurious protein sequences even for correctly included organisms, thus inflating the search space and leading to decreased sensitivity. These approaches also imply additional analyses that depend on resources and samples that may not be available in all cases. Whole metagenome sequencing itself also suffers from the complexity of short reads leading to fragmented contigs and scaffolds which may interrupt protein-coding regions and hamper CDS predictions. Tang et al. [<xref rid="pcbi.1011163.ref006" ref-type="bibr">6</xref>] used <italic toggle="yes">de Bruijn</italic> graphs generated by metagenome assembly to produce protein sequence databases for metaproteomics, where identified peptides may span separate contigs in the graph, yielding many more peptide identifications than linear approaches to metagenome data.</p>
    <p>Iterative “two-step” search strategies—where matches from a primary search against an initially very large sequence database at relaxed false discovery rates (FDR) are used to create a focused sequence database for subsequent more stringent target-decoy search—have been used, for example by the <bold>MetaPro-IQ</bold> pipeline, to yield a higher number of identifications [<xref rid="pcbi.1011163.ref007" ref-type="bibr">7</xref>,<xref rid="pcbi.1011163.ref008" ref-type="bibr">8</xref>], but there are some concerns about the statistical implication of re-searching data repeatedly using identical or closely related algorithms.</p>
    <p>Further pitfalls of the use of targeted sequence databases for metaproteomics include the danger of mis- assignments when proteins truly present in the data are not included in the search sequence database. A case in point are spectra assigned to viral proteins identified and published in a study but later identified as <italic toggle="yes">Apis mellifera</italic> honey bee proteins by another group—that may have been differently assigned if the original authors included those proteins in the original search sequence database [<xref rid="pcbi.1011163.ref009" ref-type="bibr">9</xref>], underlining a significant potential problem if metaproteomics studies ignore the presence of viruses, archaea, fungi and dietary components that are likely to be present in a sample.</p>
    <p>Reanalysis of the same <italic toggle="yes">Apis mellifera</italic> samples by another group [<xref rid="pcbi.1011163.ref010" ref-type="bibr">10</xref>], found that only a small percentage of the viral peptides could be explained by homologous peptides, and argued that limiting the search space to only peptides of interest, reduces multiple hypothesis testing, and thus increases peptide identification sensitivity. However, they pointed out that leaving out sequences from the search sequence database could lead to false assignments of spectra of true proteins to biologically related sequences in the sequence database. In the case of metaproteomic analysis representing multiple species with potentially many orthologous proteins, artificially limiting the search space may therefore lead to false positive peptide identifications despite decreased false negative identifications. However, reducing the search space to peptides of interest would be an interesting avenue for analysing complex samples, but requires a representative sequence database that is available for filtering, and prior knowledge of sample composition, and does not work for very small sequence database sizes, due to false discovery estimation problems.</p>
    <p>The ideal sequence database for mass spectrometry-based peptide identification in metaproteomic datasets would therefore be comprehensive, whilst excluding proteins that are genuinely absent, and would not be reliant on prior expectation of sample composition, nor would it require prior generation of DNA/RNA sequencing data to inform the construction of a search sequence database.</p>
    <p>Taxonomic profiling of proteins identified during metaproteomic analysis is also complicated by high levels of shared tryptic peptides between homologous proteins of closely related organisms. To help solve this, the <bold>UniPept</bold>
<italic toggle="yes">pept2lca</italic> algorithm [<xref rid="pcbi.1011163.ref011" ref-type="bibr">11</xref>] assigns the lowest common ancestor (LCA) for a given peptide assignment, whilst the recently published <bold>ProteoClade</bold> algorithm [<xref rid="pcbi.1011163.ref012" ref-type="bibr">12</xref>] allows users to apply species level annotation to identified peptides using customised search sequence databases.</p>
    <p><italic toggle="yes">De novo</italic> sequencing of peptides from mass spectrometry data has long been used for sequence database filtration, allowing for rapid searches of very large search spaces with sequence tags prior to peptide-spectral matching [<xref rid="pcbi.1011163.ref013" ref-type="bibr">13</xref>]. Tanner <italic toggle="yes">et al</italic>. published the <bold>InsPecT</bold> tool in 2005 [<xref rid="pcbi.1011163.ref014" ref-type="bibr">14</xref>]. These approaches work by reducing the sequence database size by orders of magnitude, while retaining the correct sequences with high probability. The sequence tag filtering approach is interesting, as in isolation full peptide sequencing of higher-energy collisional dissociation (HCD) data has been found to be only around 35% accurate [<xref rid="pcbi.1011163.ref015" ref-type="bibr">15</xref>]. Moreover, incomplete fragmentation of experimental spectra hampers accurate full-length sequencing using <italic toggle="yes">de novo</italic> algorithms [<xref rid="pcbi.1011163.ref016" ref-type="bibr">16</xref>]. Notwithstanding these challenges, partial sequencing with sequence tag approaches with tools such as <bold>DirecTag</bold> [<xref rid="pcbi.1011163.ref017" ref-type="bibr">17</xref>] represents a plausible, robust and scalable approach for sequence database filtering, whilst recent advances in deep-learning-based approaches have significantly improved the accuracy of full sequence <italic toggle="yes">de novo</italic> sequencing approaches, with tools such as <bold>pNovo3</bold> yielding up to 89% improvement in precision compared to other state-of-the-art tools, illustrating the current rapid progress in this field [<xref rid="pcbi.1011163.ref018" ref-type="bibr">18</xref>].</p>
    <p>Here, we present a novel metaproteomic analysis pipeline—<bold>MetaNovo</bold>–improving on the conventional methodology for iterative sequence database search by mapping <italic toggle="yes">de novo</italic> sequence tags to very large protein sequence databases using a high-performance and parallelized computing pipeline as the first search, thereby generating compact sequence databases for subsequent, orthogonal peptide-spectrum matching (PSM)-based target-decoy analysis and FDR-controlled protein identifications. We compare the results of <bold>MetaNovo</bold> against those published for the two-step <bold>MetaPro-IQ</bold> pipeline using a publicly available mass spectrometry dataset. We further validate the pipeline on samples of known microbial composition as ground truth. To our knowledge, this is the first published metaproteomic workflow for iterative two-step searching that uses <italic toggle="yes">de novo</italic> sequencing and probabilistic protein inference as a first step, followed by orthogonal conventional target-decoy search with FDR control in the second step. We show that replacing conventional PSM-based sequence database searching with <italic toggle="yes">de novo</italic> sequencing in the first step extends the applicability of iterative searches to extremely large sequence databases, which have previously only been applied to large, curated lists of proteins, thus decreasing the bias inherent in the analysis of complex metaproteomic data using these approaches.</p>
    <p>The <bold>MetaNovo</bold> software has already been used to obtain new insights into vaginal [<xref rid="pcbi.1011163.ref019" ref-type="bibr">19</xref>,<xref rid="pcbi.1011163.ref020" ref-type="bibr">20</xref>] and foreskin [<xref rid="pcbi.1011163.ref021" ref-type="bibr">21</xref>] microbiome dynamics and has been made publicly available on <bold>Galaxy</bold> [<xref rid="pcbi.1011163.ref022" ref-type="bibr">22</xref>] (<ext-link xlink:href="https://toolshed.g2.bx.psu.edu/repository?repository_id=f90d438ce91f95f1" ext-link-type="uri">https://toolshed.g2.bx.psu.edu/repository?repository_id=f90d438ce91f95f1</ext-link>, <ext-link xlink:href="https://usegalaxy.eu/root?tool_id=metanovo" ext-link-type="uri">https://usegalaxy.eu/root?tool_id=metanovo</ext-link>,). The tool is also available as a standalone package in <bold>Anaconda (</bold><ext-link xlink:href="https://anaconda.org/bioconda/metanovo" ext-link-type="uri">https://anaconda.org/bioconda/metanovo</ext-link>).</p>
  </sec>
  <sec sec-type="materials|methods" id="sec005">
    <title>Design and implementation</title>
    <sec id="sec006">
      <title><italic toggle="yes">MetaNovo</italic> sequence database generation workflow and benchmarking</title>
      <sec id="sec007">
        <title>UniProt sequence database statistics</title>
        <p>The 2019_11 release [<xref rid="pcbi.1011163.ref023" ref-type="bibr">23</xref>] of <bold>UniProt</bold> was downloaded, and a combined FASTA sequence database created from <bold>UniProt SwissProt</bold>, <bold>TREMBL</bold>, and <bold>SwissProt</bold> alternative splice variant sequences (ca. 180 million sequences). See <italic toggle="yes"><xref rid="pcbi.1011163.s001" ref-type="supplementary-material">S1 Table</xref>.</italic></p>
      </sec>
    </sec>
    <sec id="sec008">
      <title>General software overview</title>
      <p>The <bold>MetaNovo</bold> software is a configurable command-line Linux <bold>Bash</bold> pipeline that combines open-source software tools with custom <bold>Python</bold> libraries and scripts to provide targeted protein identification search libraries in <bold>FASTA</bold> format. The pipeline has three main components based on custom and existing open-source tools—generating <italic toggle="yes">de novo</italic> sequence tags using <bold>DirecTag</bold>, mapping the tags to a protein sequence database using <bold>PeptideMapper</bold>, and a novel algorithm for probabilistic protein ranking and filtering based on estimated species and protein abundance. The <bold>MetaNovo</bold> software is available from <bold>GitHub</bold> [<xref rid="pcbi.1011163.ref024" ref-type="bibr">24</xref>] and can be run as a standalone <bold>Singularity</bold> or <bold>Docker</bold> container available from the <bold>Docker Hub</bold> [<xref rid="pcbi.1011163.ref025" ref-type="bibr">25</xref>]. The Human mucosal-luminal interface mass spectrometry proteomics data are available from the <bold>ProteomeXchange Consortium</bold> via the <bold>PRIDE</bold> [<xref rid="pcbi.1011163.ref026" ref-type="bibr">26</xref>] partner repository with the dataset identifier <bold>PXD003528</bold>, and all results have been uploaded to the <bold>ProteomeXchange</bold> Consortium via the <bold>PRIDE</bold> partner repository with the dataset identifier <bold>PXD030708</bold>. <italic toggle="yes">See <xref rid="pcbi.1011163.g001" ref-type="fig">Fig 1</xref>. The Typical</italic>
<bold><italic toggle="yes">MetaNovo</italic></bold>
<italic toggle="yes">workflow</italic>.</p>
      <fig position="float" id="pcbi.1011163.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011163.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Visualisation of the MetaNovo workflow used to analyse the mass spectrometry data of 8 human mucosal-luminal interface samples.</title>
          <p>Raw mass-spectrometry data were analysed using the <bold>MetaNovo</bold> pipeline in MGF format, using <italic toggle="yes">de novo</italic> sequence tags to create a targeted FASTA file for target-decoy search.</p>
        </caption>
        <graphic xlink:href="pcbi.1011163.g001" position="float"/>
      </fig>
    </sec>
    <sec id="sec009">
      <title>Generation of <italic toggle="yes">de novo</italic> sequence tags</title>
      <p>Raw MS/MS files need to be converted to <italic toggle="yes">Mascot Generic Feature</italic> (MGF) format prior to analysis. <italic toggle="yes">De novo</italic> sequence tags are generated using <bold>DeNovoGUI</bold> version 1.15.11 [<xref rid="pcbi.1011163.ref027" ref-type="bibr">27</xref>], with <bold>DirecTag</bold> [<xref rid="pcbi.1011163.ref017" ref-type="bibr">17</xref>] selected as the sequencing engine. General <bold>MetaNovo</bold> parameters selected for the analyses include fragment and precursor ion mass tolerance of 0.02 Da, with fixed modification ‘<italic toggle="yes">Carbamidomethylation of C’</italic> and variable modifications ‘<italic toggle="yes">Oxidation of M’</italic> and <italic toggle="yes">‘Acetylation of protein N-term’</italic>. For <bold>DirecTag</bold>, a tag sequence length of 4 amino acids was required, and the top 5 sequence tags per spectrum were selected (taking into account alternative possible charge states). These settings were chosen as preliminary runs with a sequence tag length of 3 proved impractical with very large sequence databases, requiring more than 5 days with 24 threads on a high-performance cluster to search 8 MGF files against <bold>UniProt</bold>. Similarly, increasing sequence tag options per spectrum from 5 to 30 considerably increased processing time without a corresponding gain in sensitivity, possibly due to the inclusion of low-scoring matches. The output of <bold>DirecTag</bold> is parsed with a custom <bold>Python</bold> script and all sequence tags for each MS/MS across replicates are stored in an <bold>SQLite</bold> database [<xref rid="pcbi.1011163.ref028" ref-type="bibr">28</xref>]. The distinct set of sequence tags (N-terminus mass gap, amino acid sequence, and C-terminus mass gap) are obtained using an <bold>SQL</bold> query, combining identical tags across multiple MS/MS into a single non-redundant list.</p>
    </sec>
    <sec id="sec010">
      <title>Mapping sequence tags to a FASTA sequence database</title>
      <p><bold>PeptideMapper</bold> [<xref rid="pcbi.1011163.ref029" ref-type="bibr">29</xref>] included in <bold>compomics-utilities</bold> version 4.11.19 [<xref rid="pcbi.1011163.ref030" ref-type="bibr">30</xref>] is used to search the sequence tag set against the protein sequence database. The same mass error tolerance and post-translational modification settings are used as for <bold>DeNovoGUI</bold> and specified in the config file. The open-source <bold>GNU parallel</bold> tool [<xref rid="pcbi.1011163.ref031" ref-type="bibr">31</xref>] is used to search the set of sequence tags against the FASTA sequence database in configurable chunk sizes, using a configurable number of threads per node in parallel.</p>
    </sec>
    <sec id="sec011">
      <title>Enzymatic cleavage rule evaluation</title>
      <p>A custom <bold>Python</bold> script is used to evaluate the cleavage rule of the peptide sequences of identified sequence tags. Only peptides passing the selected cleavage rule are selected for downstream analysis (‘Trypsin, no P rule’ was selected for the benchmarking analysis—cleavage after all <italic toggle="yes">Lys</italic> or <italic toggle="yes">Arg</italic>) with up to 2 missed cleavages allowed. The corresponding sequence tags for the validated peptide sequences are queried against the <bold>SQLite</bold> database to obtain a mapping of MS/MS ids to protein ids, allowing for the estimation of protein abundance based on mapped MS/MS in a similar manner to spectral counting in a target-decoy search.</p>
    </sec>
    <sec id="sec012">
      <title>Normalised spectral abundance factor calculation</title>
      <p>Protein abundance is estimated using the <italic toggle="yes">Normalised Spectral Abundance Factor</italic> (NSAF) approach developed for shotgun proteomics [<xref rid="pcbi.1011163.ref032" ref-type="bibr">32</xref>]. The set of MS/MS IDs in each sample per protein is obtained, and the number of mapped MS/MS ids is divided by protein length to obtain a <italic toggle="yes">Spectral Abundance Factor</italic> (SAF). The SAF values for each sample are divided by the sum of the SAF values in that sample, to obtain an NSAF for each protein in each sample/replicate.</p>
    </sec>
    <sec id="sec013">
      <title>Probabilistic ranking of sequence database proteins</title>
      <p>The <bold>MetaNovo</bold> algorithm uses the concept of unconditional or marginal probability, which is a probabilistic value generated for each protein in the <bold>UniProt</bold> sequence database corresponding to the probability that a given peptide fragment sampled at random from the raw data will belong to that protein given the available data. To calculate the marginal probabilities, protein NSAF values are summed across replicates, and divided by the sum of all NSAF values across all replicates, with a maximum value of 1 for each protein. This value is equivalent to the proportion that a given protein makes up of all replicates by summed NSAF value. SQLite database proteins are ranked by this marginal probability and filtered such that a minimal set of ranked proteins is obtained where each protein in the list contains at least one unique MS/MS scan ID relative to the set of proteins above its position in the list—and excluding all proteins that do not contain any uniquely identified spectra relative to the set of proteins above their position in the ranked list. Using this methodology, sets of protein isoforms that share an exact set of mapped MS/MS ids will be represented by the shortest sequence in the set due to having a higher NSAF value, based on the principle of Occam’s razor where longer sequences are more likely to have sequence tag matches by pure chance. The organism names are obtained from the <bold>UniProt</bold> FASTA headers, and summed NSAF values in the filtered set are aggregated by organism and divided by the total to obtain an organism-level marginal probability. Following this, the proteins in the unfiltered set are annotated with their respective calculated organism marginal probability. The unfiltered set of proteins is re-ranked based on the joint probability of the organism and protein probability values, based on the simplistic assumption of conditional independence (Naive Bayes Assumption) which allows low abundance proteins with a high estimated relative abundance at the organism level to be favoured compared to proteins where both the protein and organism abundance are estimated to be low. Benefits of the Naive Bayes assumption of conditional independence between predictors are ease of mathematical implementation and being highly scalable to the number of predictors and data points, without sacrificing model accuracy, and allowing model training and classification with a single pass over the data. The protein joint probability calculation used to rank protein ids in the SQLite database is as per the equation below:
<disp-formula id="pcbi.1011163.e001"><alternatives><graphic xlink:href="pcbi.1011163.e001.jpg" id="pcbi.1011163.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>O</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>O</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>*</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula></p>
      <p>Following the second ranking step, the database is re-filtered to obtain a minimal subset of proteins that can explain all mapped <italic toggle="yes">de novo</italic> sequence tags, based on estimated relative protein and organism abundance. <italic toggle="yes">See <xref rid="pcbi.1011163.g002" ref-type="fig">Fig 2</xref>.</italic></p>
      <fig position="float" id="pcbi.1011163.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011163.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>A Graphical representation of the MetaNovo algorithm applied for sequence database filtration.</title>
          <p><italic toggle="yes">Normalized spectral abundance factor</italic> calculations include non-unique spectra. The magnitude of probabilities are represented by +’s. Proteins are ranked by the joint probability of organism and protein probabilities, represented by the arrow, in order of increasing probability. The number of unique spectra for each protein is determined based on its position in the ranked list, and only include spectra that do not appear in the set of proteins in the list above (but may include spectra that appear below), such as the spectra for <bold>Peptide B</bold> that are counted towards the first protein in the list, but not the second. Tie breaks for adjacent and nearly identical isoforms that share the same set of spectra, will be based on the shortest (most probable) sequence having a higher NSAF (and thus a higher protein probability) or a higher organism probability. Proteins in green will be selected for inclusion in the filtered sequence database, and proteins in red will be excluded (having no unique spectra). The colors shared by proteins, peptides and spectra above, illustrate the assignment of unique spectra and peptides, to the most probable protein in the ranked list.</p>
        </caption>
        <graphic xlink:href="pcbi.1011163.g002" position="float"/>
      </fig>
    </sec>
    <sec id="sec014">
      <title>Mucosal-luminal interface samples</title>
      <sec id="sec015">
        <title>Mucosal-luminal interface (MLI) sample metagenomic and proteomics data</title>
        <p>Metagenome and proteomics data of 8 MLI samples from adolescent volunteers obtained during colonoscopy were downloaded from <bold>PRIDE</bold> with identifier <bold>PXD003528</bold> and through author correspondence. The sample processing, mass spectrometry and metagenomics sequence database creation methods have already been described [<xref rid="pcbi.1011163.ref008" ref-type="bibr">8</xref>].</p>
      </sec>
      <sec id="sec016">
        <title><italic toggle="yes">MetaNovo</italic> sequence database generation</title>
        <p>The December 2019 release [<xref rid="pcbi.1011163.ref023" ref-type="bibr">23</xref>] of <bold>UniProt</bold> (containing ca. 180 million protein entries) was used to create a sequence database containing 74136 entries. The <bold>MetaNovo</bold> settings described above were used. The experiment was run on a high performance computing cluster, with 120 GB available RAM, and 8 allocated Intel Xeon Processor (Skylake, IBRS) cpus, and total running time was 3d03h38m to process the 8 MGF files.</p>
      </sec>
    </sec>
    <sec id="sec017">
      <title>Sequence database search using MaxQuant</title>
      <p><bold>MaxQuant</bold> version 1.5.2.8 was used to search the <bold>MetaNovo sequence</bold> database, with the same settings as for the <bold>MetaPro-IQ</bold> publication. <italic toggle="yes">Acetyl (Protein N-term)</italic> and <italic toggle="yes">Oxidation (M)</italic> were selected as variable modifications, and <italic toggle="yes">Carbamidomethyl (C)</italic> was selected as a fixed modification. Specific enzyme mode with <italic toggle="yes">Trypsin/P</italic> was selected with up to 2 missed cleavages allowed, and a PSM and protein FDR of 0.01 was required.</p>
      <p>Nine-organism microbial mixture samples.</p>
    </sec>
    <sec id="sec018">
      <title>9MM sample and validation sequence databases</title>
      <p>Raw proteomic data from two samples of a known nine-organism microbial mixture (9MM) from a single biological replicate were downloaded from <bold>PeptideAtlas</bold> (identifier <bold>PASS00194)</bold> [<xref rid="pcbi.1011163.ref033" ref-type="bibr">33</xref>]. <italic toggle="yes">See <xref rid="pcbi.1011163.s002" ref-type="supplementary-material">S2 Table</xref></italic>. Detailed proteomic methods were described in the original publication [<xref rid="pcbi.1011163.ref033" ref-type="bibr">33</xref>]. In brief, each of 9 organisms was cultured separately on the appropriate growing media and divided into aliquots of approximately 10<sup>9</sup> CFU each. The 9MM sample was created by combining an aliquot of each organism pellet and processed separately by filter-aided sample preparation (FASP) and protein precipitation followed by in-solution digestion (PPID). Two sequence databases were selected from the original publication for comparison. One, the top-performing sequence database from the previous publication was created by single genome assembly followed by gene prediction and protein annotation using <bold>TrEMBL</bold>, with 27164 non-redundant entries <bold>(SGA-PA</bold>). Secondly, to illustrate a typical metaproteomics workflow, the sequence database created by NGS of the two 9MM extracts (metagenome sequencing) followed by gene prediction and protein annotation using <bold>TrEMBL</bold> was selected, with 13270 non-redundant entries (<bold>Meta-PA</bold>).</p>
    </sec>
    <sec id="sec019">
      <title><italic toggle="yes">MetaNovo</italic> sequence database generation</title>
      <p>The December 2019 release [<xref rid="pcbi.1011163.ref023" ref-type="bibr">23</xref>] of <bold>UniProt</bold> (containing ca. 180 million protein entries) was used to create a sequence database containing 13195 entries. The <bold>MetaNovo</bold> settings described above were used. The experiment was run on a single node of a high-performance computing cluster (<ext-link xlink:href="https://www.ilifu.ac.za/" ext-link-type="uri">https://www.ilifu.ac.za/</ext-link>), with 120 GB available RAM, and 8 allocated Intel Xeon Processor (Skylake, IBRS) processors. The total running time was 0d09h11m to process the 2 MGF files.</p>
    </sec>
    <sec id="sec020">
      <title>Sequence database search using MaxQuant</title>
      <p><bold>MaxQuant</bold> version 1.5.2.8 was used to search the <bold>MetaNovo, SGA-PA</bold> and <bold>Meta-PA</bold> databases using the same search parameters. <italic toggle="yes">Acetyl (Protein N-term)</italic> and <italic toggle="yes">Oxidation (M)</italic> were selected as variable modifications, and <italic toggle="yes">Carbamidomethyl (C)</italic> was selected as a fixed modification. Specific enzyme mode with <italic toggle="yes">Trypsin/P</italic> was selected with up to 2 missed cleavages allowed, and a PSM and protein FDR of 0.01 was required. The FASP and PPID samples were treated as separate experiments.</p>
    </sec>
    <sec id="sec021">
      <title>Bioinformatic analysis</title>
      <sec id="sec022">
        <title>Posterior error probability (PEP) score analysis</title>
        <p>PEP scores are a standard metric to identify and rank the quality of PSMs and are used during the FDR calculation of target decoy searches, as false-positive PSMs tend to rank similarly to reverse or decoy hits, allowing a convenient method to estimate the FDR at a given position in the PEP score ranking [<xref rid="pcbi.1011163.ref034" ref-type="bibr">34</xref>]. PEP scores have been applied in the field of proteogenomics to evaluate the accuracy of novel peptide identifications, by comparing their distribution to that of reverse hits, allowing for the assessment of the level of completeness of protein annotation in a given strain, as novel peptide identifications in completely annotated genomes are likely false positive identifications [<xref rid="pcbi.1011163.ref035" ref-type="bibr">35</xref>]. The PEP scores of PSMs obtained using <bold>MaxQuant</bold> were obtained from the <italic toggle="yes">peptides</italic>.<italic toggle="yes">txt</italic> output files of the different sequence database runs of the MLI samples—using <bold>MetaNovo</bold>, <bold>MetaPro-IQ</bold> using the integrated gene catalog (IGC) of human gut microbial genes [<xref rid="pcbi.1011163.ref036" ref-type="bibr">36</xref>], hereafter referred to as <bold>MetaPro-IQ/IGC</bold>, and a matched metagenome sequence database hereafter referred to as <bold>MetaPro-IQ/Metagenome</bold> (the published <bold>MaxQuant</bold> results using the <bold>MetaPro-IQ/IGC</bold> and <bold>MetaPro-IQ/Metagenome</bold> sequence databases were obtained from PRIDE). PSMs for each run were grouped into “exclusive” peptide sequences only identified in that run, and PSMs of “shared” peptides that were also identified in the other two runs, as well as the reverse hits for each group. Significant differences between the groups were tested for using the <italic toggle="yes">Kruskal-Wallis</italic> non-parametric analysis of variance test followed by <italic toggle="yes">Dunn’s</italic> post hoc test using a custom python script. PEP score distributions were visualised using the python <italic toggle="yes">matplotlib</italic> library.</p>
      </sec>
    </sec>
    <sec id="sec023">
      <title>Taxonomic analysis</title>
      <p>Peptide sequences were assigned to the lowest common ancestor (taxonomic level) using the <bold>UniPept <italic toggle="yes">pept2lca</italic></bold> tool, to allow for a comparison between the results of the different approaches and to the ground truth samples of known taxonomic composition (9MM) [<xref rid="pcbi.1011163.ref033" ref-type="bibr">33</xref>]. Peptide and spectral counts were aggregated at selected phylum levels reported in the <bold><italic toggle="yes">pept2lca</italic></bold> output, with custom visualisations done using the Python <italic toggle="yes">matplotlib</italic> module. We followed a previously described approach to filtering spurious taxa based on <bold>UniPept</bold> results by only including taxa that represent more than 0.5% of taxonomically characterised peptides [<xref rid="pcbi.1011163.ref033" ref-type="bibr">33</xref>], applied separately at each taxonomic level.</p>
    </sec>
    <sec id="sec024">
      <title>BLAST analysis of selected peptides and proteins from 9MM samples</title>
      <p>Peptides identified in the 9MM analysis that were assigned using the <bold>UniPept</bold>
<italic toggle="yes">pept2lca</italic> tool to organisms not expected from the known mixture were selectively subjected to <bold>NCBI BLAST</bold> analysis. Leading proteins for the same peptides were extracted from the <italic toggle="yes">proteinGroups</italic>.<italic toggle="yes">txt</italic> file and the protein sequences submitted for <bold>NCBI BLAST</bold> [<xref rid="pcbi.1011163.ref037" ref-type="bibr">37</xref>]. Proteotypic peptides were defined as only matching to a single species with 100% identity in the <bold>NCBI</bold> nr sequence database. Species-specific protein sequences were defined as those sequences that only matched to a single species above a threshold of 90% identity in the <bold>NCBI</bold> nr sequence database.</p>
    </sec>
    <sec id="sec025">
      <title>9MM Taxonomic representation error scores calculation</title>
      <p>Spectral counts obtained from the <bold>MaxQuant</bold> output files were aggregated to <italic toggle="yes">family</italic>, <italic toggle="yes">genus</italic> and <italic toggle="yes">species</italic> levels for the expected taxa. For each expected taxon, the percentage relative to the total characterised MS/MS (including mis assignments) was calculated for the <bold>MetaNovo</bold>, <bold>SGA-PA</bold>, and <bold>Meta-PA</bold> workflows respectively. As approximately equal proportions of the 9 organisms were analysed based on CFU counts, ground truth percentages were assigned to the 3 taxonomic levels accordingly. Mean Squared Error (MSE) scores were calculated for relative taxon abundance for each of the three runs relative to the ground truth percentages and compared. MSE values closer to 0 indicate lower error rates, and therefore a more accurate representation of relative taxon abundance in the samples.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec026">
    <title>Results</title>
    <sec id="sec027">
      <title>MetaNovo identifies non-bacterial taxa, whilst providing comparable bacterial composition data to a matched metagenome approach in human Mucosal-luminal interface samples</title>
      <sec id="sec028">
        <title>Protein and peptide identifications</title>
        <p>The <bold>MetaNovo</bold> pipeline was run using the entire, unfiltered <bold>UniProt</bold> sequence database (December 2019 release; ca. 180 million entries), resulting in the identification of 69878 target peptides and 15731 protein groups, with 36.37% of total MS/MS identified. These results are comparable but slightly better with &gt;2% more spectra assigned than those of previous approaches, with 34 and 33% MS/MS identification rates reported by the <bold>MetaPro-IQ</bold> authors using a matched metagenome or an integrated gene catalog (IGC), respectively. 48705 peptides were identified in common by all three runs, while 4873, 6525 and 14049 were identified exclusively by the <bold>MetaPro-IQ/IGC</bold>, <bold>MetaPro-IQ/Metagenome</bold>, and <bold>MetaNovo</bold> sequence databases, respectively. <italic toggle="yes">See <xref rid="pcbi.1011163.g003" ref-type="fig">Fig 3B</xref>.</italic></p>
        <fig position="float" id="pcbi.1011163.g003">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011163.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>MLI dataset results.</title>
            <p><bold>A.</bold> Bar chart of peptide identifications. The identification rates of <bold>MetaNovo</bold> are comparable to the previously published results of <bold>MetaPro-IQ</bold> using matched metagenome and <italic toggle="yes">integrated gene catalog sequence</italic> databases. <bold>B.</bold> Venn diagram showing large overlap in identified sequences using different approaches, with the highest number of sequences identified using <bold>MetaNovo. C.</bold> Peptide counts by <italic toggle="yes">UniPept lowest common ancestor</italic> showed similar taxonomic distributions obtained from different approaches. <bold>D.</bold> Peptides uniquely identified by <bold>MaxQuant</bold> using the <bold>MetaNovo sequence</bold> database had a significantly different distribution compared to reverse hits (p-value 6.33e-26). The boxes extend from the lower to the upper quartile, and the whiskers represent 1.5 times the interquartile range (IQR) below and above the first and third quartiles, respectively.</p>
          </caption>
          <graphic xlink:href="pcbi.1011163.g003" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec id="sec029">
      <title>PEP score analysis</title>
      <p>Kruskal-Wallis analysis of variance howed a statistiucally significant difference between exlusive, shared and reverse hit PEP scores across the three runs (statistic = 10883.94, pvalue = 0.0). Visual inspection of PEP score density plots shows a similar distribution of peptide PEP scores for peptides only identified in a specific run, and peptides that were identified in all runs, with the exception of peptides only identified using the <bold>MetaPro-IQ/Metagenome sequence</bold> database, that showed a very broad distribution overlapping with the reverse hits (<italic toggle="yes">See <xref rid="pcbi.1011163.s015" ref-type="supplementary-material">S1 Fig</xref></italic>). Analysis of shared and exclusive peptide identifications in each group revealed significantly different distributions between 14049 peptides only identified using <bold>MetaNovo</bold> and reverse hits for the same run (p-value 6.33e-26), indicating true positive identifications in this set not found using the other approaches. The difference between peptides exclusively identified with the <bold>MetaPro-IQ/IGC</bold> sequence database and reverse hits was also significant (p-value 3.15e-20). The 6525 peptides only identified using the matched metagenome had a higher median PEP score (0.038306) compared to reverse hits (0.009337) although the difference between the two groups was not statistically significant(p-value 4.60e-01), suggesting a higher rate of false-positive hits in this group than the other two approaches. <italic toggle="yes">See <xref rid="pcbi.1011163.g003" ref-type="fig">Fig 3D</xref> and <xref rid="pcbi.1011163.s003" ref-type="supplementary-material">S3</xref> and <xref rid="pcbi.1011163.s004" ref-type="supplementary-material">S4</xref> Tables.</italic></p>
    </sec>
    <sec id="sec030">
      <title>Taxonomic comparisons</title>
      <p>Peptide counts by lowest common ancestor were compared between different analysis runs using the output of UniPept <italic toggle="yes">pept2lca (See <xref rid="pcbi.1011163.s005" ref-type="supplementary-material">S5 Table</xref>)</italic>. After applying stringency criteria based on requiring at least 0.5% of total classified peptides per included taxon, the highest number of characterised peptides by UniPept pept2lca <italic toggle="yes">taxon_name (the most specific possible taxonomic characterization for a given peptide across all taxonomic levels)</italic> was obtained using <bold>MetaNovo/UniProt</bold> (35169), followed by <bold>MetaPro-IQ/Metagenome</bold> (34768) and <bold>MetaPro-IQ/IGC</bold> (32325). A similar taxonomic distribution was obtained between runs (<italic toggle="yes">See <xref rid="pcbi.1011163.g003" ref-type="fig">Fig 3C</xref>).</italic> Of the characterised peptides passing the stringency criteria, 4700 peptides belonged to <italic toggle="yes">taxon_name</italic> taxa that were identified exclusively by <bold>MetaNovo</bold>. These taxa are consistent with expected host peptides that were not identified by the other runs (no <italic toggle="yes">Homo sapiens</italic> peptides were identified by the other approaches). <italic toggle="yes">See <xref rid="pcbi.1011163.s006" ref-type="supplementary-material">S6 Table</xref>.</italic> Conversely, all taxa identified by the other analysis methods were also identified by <bold>MetaNovo.</bold>
<italic toggle="yes">See <xref rid="pcbi.1011163.s007" ref-type="supplementary-material">S7 Table</xref>.</italic> When selecting only Bacteria “<italic toggle="yes">superkingdom_name”</italic> peptides, lower numbers of peptides were identified by <bold>MetaNovo</bold> than for the other runs, with 27289, 30311 and 31591 annotated peptides for <bold>MetaNovo</bold>, <bold>MetaPro-IQ/IGC</bold>, and <bold>MetaPro-IQ/Metagenome</bold>, respectively. A similar taxonomic distribution was visualised for all three runs in this group. <italic toggle="yes">See <xref rid="pcbi.1011163.s016" ref-type="supplementary-material">S2 Fig</xref>.</italic> When aggregating peptide counts at the “<italic toggle="yes">kingdom_name”</italic> level, peptides from <italic toggle="yes">Metazoa</italic>, <italic toggle="yes">Viridiplantae</italic> and <italic toggle="yes">Fungi</italic> kingdoms were represented by all runs, but with much higher numbers represented by <bold>MetaNovo.</bold> These taxa are all known to play key roles in the human gut microbiome, as living or dietary components. <italic toggle="yes">See <xref rid="pcbi.1011163.s008" ref-type="supplementary-material">S8 Table</xref>.</italic> Similarly, aggregated to <italic toggle="yes">Phylum</italic> level, <bold>MetaNovo</bold> identified the same phyla as identified in either of the other runs, but with much higher numbers of <italic toggle="yes">Chordata</italic> peptides. Interestingly, both the <bold>MetaNovo/UniProt</bold> and <bold>MetaPro-IQ/IGC sequence</bold> databases identified <italic toggle="yes">Actinobacteria</italic>—but these were not identified by the <bold>MetaPro-IQ/Metagenome sequence</bold> database. <italic toggle="yes">See <xref rid="pcbi.1011163.s009" ref-type="supplementary-material">S9 Table</xref>.</italic></p>
    </sec>
    <sec id="sec031">
      <title>Analysis of a known microbial mixture using the MetaNovo software yields increased sensitivity compared to matched genomics sequence databases</title>
      <sec id="sec032">
        <title>Protein and peptide identifications</title>
        <p>The <bold>MetaNovo</bold> pipeline was run using the entire, unfiltered <bold>UniProt sequence</bold> database (December 2019 release; ca. 180 million entries), resulting in the identification of 12529 target peptides and 2534 target protein groups, with 44.17% of total MS/MS identified. These results are significantly better with 9.14% more spectra assigned than the best performing genomic sequence database reported by the original authors when run with the same <bold>MaxQuant</bold> settings (single predicted and annotated genomes assembly DB (SGA-PA)) that yielded 35.03% identified MSMS, 10109 target peptides and 2099 target protein groups. The results were almost double those of the metagenome (Meta-PA) sequence database that yielded 23.03% identified MSMS, 6044 target peptides and 1087 target proteins (<italic toggle="yes">See <xref rid="pcbi.1011163.g004" ref-type="fig">Fig 4A</xref></italic>), despite a similar size of the Meta-PA sequence database to the MetaNovo sequence database. Kruskal-Wallis analysis of variance indicated a significant difference in the PEP score distribution of the exclusive, shared and reverse peptide matches of the three runs (statistic = 1525.73, pvalue = 0.0). The median PEP scores of the 3258 and 470 peptides exclusively identified using the MetaNovo and SGA-PA sequence databases were lower and the distributions significantly different to that of reverse hits for the same runs (p-value 1.05e-05 and 3.07e-02, respectively). The median PEP score of the 133 peptides exclusively identified by the Meta-PA sequence database (0.046675) was worse than that of the 11 reverse hit peptides of the same run (0.010709), but the difference was not statistically significant (p-value 8.11e-01). <italic toggle="yes">See <xref rid="pcbi.1011163.s010" ref-type="supplementary-material">S10</xref> and <xref rid="pcbi.1011163.s011" ref-type="supplementary-material">S11</xref> Tables.</italic></p>
        <fig position="float" id="pcbi.1011163.g004">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1011163.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>9MM dataset identification results.</title>
            <p><bold>A.</bold> Number of peptides identified in each run. <bold>B.</bold> Number of protein groups identified in each run. <bold>C.</bold> Peptide identification overlap between the different approaches. <bold>D.</bold> Peptide PEP score distribution box plot for shared, exclusive and reverse hit peptides for each run.</p>
          </caption>
          <graphic xlink:href="pcbi.1011163.g004" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec id="sec033">
      <title>Taxon identification rates</title>
      <p>Percentages of misassigned peptides were calculated for all three runs. <bold>MetaNovo</bold> originally yielded a very high percentage of misassigned spectra at species level based on <bold>UniPept</bold>
<italic toggle="yes">pept2lca</italic> analysis. Further analysis of the characterised peptides indicated that most belonged to other <italic toggle="yes">Rhodotorula</italic> species, which corresponds to the authors’ original report of many non-canonical peptides identified in their samples using a 6-frame translated sequence database, which could lead to <bold>UniPept</bold> assignment to closely related organisms. The identification of 38 <italic toggle="yes">Gallus gallus</italic> peptides was narrowed down to components of egg-yolk using <bold>BLASTP</bold> analysis (See <bold><italic toggle="yes">Unexpected taxa BLAST analysis)</italic></bold>. Notably, subsequent personal correspondence with those authors confirmed that egg yolk was present in one of the growth media employed in the experiment. The <italic toggle="yes">Pasteurella multocida</italic> strain analysed in this study was a field isolate (author correspondence), and being a member of Gammaproteobacteria, natural sequence diversity in this strain might be compatible with a classification of <italic toggle="yes">Gammaproteobacteria bacterium</italic>. After allowing for other <italic toggle="yes">Rhodotorula spp</italic>., <italic toggle="yes">Gallus gallus</italic> and <italic toggle="yes">Gammaproteobacteria bacterium</italic> peptides, a species-level misassignment rate of only 1.04% was attained, with 0% error for all sequence databases at genus and family level using the 0.5% taxon-specific peptide stringency cutoff. The 9 <italic toggle="yes">Acidobacteria bacterium</italic> peptides making up the final misassignment percentage of <bold>MetaNovo</bold> could be explained by the higher total number of identified peptides leading to more false hits at the same FDR, actual contaminants, or <bold>UniPept</bold> misassignments of natural variants in the data. <italic toggle="yes">See <xref rid="pcbi.1011163.g005" ref-type="fig">Fig 5</xref> and <xref rid="pcbi.1011163.s012" ref-type="supplementary-material">S12 Table</xref>.</italic></p>
      <fig position="float" id="pcbi.1011163.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011163.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Percentages of misassigned peptides for all three 9MM runs.</title>
          <p><bold>A. MetaNovo</bold> originally yielded a very high percentage of misassigned peptides at species level <bold>UniPept</bold>
<italic toggle="yes">pept2lca</italic> analysis. <bold>B.</bold> Taxonomic breakdown of misassigned peptides <bold>C.</bold> Re-analysis after inclusion of plausible taxa yielded a species-level misassignment rate of only 1.04%, with 0% error for all approaches at genus and family level using the 0.5% taxon-specific peptide stringency cutoff. <bold>D.</bold> 9 <italic toggle="yes">Acidobacteria bacterium</italic> peptides making up the final misassignment percentage of <bold>MetaNovo</bold>.</p>
        </caption>
        <graphic xlink:href="pcbi.1011163.g005" position="float"/>
      </fig>
    </sec>
    <sec id="sec034">
      <title>Taxon assignment accuracy benchmarks based on mean-squared error show the highest accuracy for species-level assignments using MetaNovo</title>
      <p>Mean Squared Error (MSE) scores were calculated for the relative proportion of MS/MS of each taxon to the total of each run compared to the expected proportion by CFU counting as a percentage. Scores closer to 0 indicate higher accuracy. <bold>MetaNovo</bold> had a poorer score than <bold>SGA-PA</bold> for genus level assignments, but the highest accuracy of the three runs for both family and species level assignments. <bold>MetaNovo</bold> outperformed the matched metagenomic sequence database (<bold>Meta-PA)</bold> at all three taxonomic levels. After relabelling all <italic toggle="yes">Rhodotorula</italic> peptides as <italic toggle="yes">Rhodotorula spp</italic>. for the comparison, a further improvement in MSE scores was obtained, corresponding to the author’s report of identifying many non-canonical peptides using the translated 6 frame sequence database for the same organism; some of these assignments may be homologous and identical to canonical peptides in other species in the same genus, and therefore were assigned to those organisms by <bold>UniPept</bold>. <bold><italic toggle="yes">See <xref rid="pcbi.1011163.t001" ref-type="table">Table 1</xref>.</italic></bold></p>
      <table-wrap position="float" id="pcbi.1011163.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011163.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>MetaNovo yields the highest accuracy for species-level annotations compared to matched genomic databases.</title>
          <p>Mean Squared Error (MSE) scores for the relative proportion of MSMS of each taxon to the total of each run compared to the expected proportion by CFU counting as a percentage. Scores closer to 0 indicate higher accuracy.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011163.t001" id="pcbi.1011163.t001g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1"/>
                <th align="right" rowspan="1" colspan="1">Meta-PA</th>
                <th align="right" rowspan="1" colspan="1">SGA-PA</th>
                <th align="right" rowspan="1" colspan="1">MetaNovo—UniProt</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="1" colspan="1">
                  <bold>Family</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">398.89</td>
                <td align="left" rowspan="1" colspan="1">143.58</td>
                <td align="left" rowspan="1" colspan="1">106.08</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">
                  <bold>Genus</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">261.64</td>
                <td align="left" rowspan="1" colspan="1">78.44</td>
                <td align="left" rowspan="1" colspan="1">87.32</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">
                  <bold>Species</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">333.17</td>
                <td align="left" rowspan="1" colspan="1">207.77</td>
                <td align="left" rowspan="1" colspan="1">151.05</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">
                  <bold>Species (relabelled)</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">333.17</td>
                <td align="left" rowspan="1" colspan="1">198.79</td>
                <td align="left" rowspan="1" colspan="1">138.03</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec035">
      <title>Unexpected taxa BLAST analysis</title>
      <p>Of the taxonomically assigned peptides across the three runs, 38 <italic toggle="yes">Gallus gallus</italic> proteins were the largest group of false assignments by the <bold>MetaNovo</bold> pipeline compared to the list of expected taxa. This group was chosen for protein <bold>BLAST</bold> analysis. For each peptide, BLAST results were filtered to only include exact matches (100% identity). For each of these records, the organism names were identified, and 20 peptides that only matched to <italic toggle="yes">Gallus gallus</italic> were obtained as proteotypic peptides for this species, providing strong evidence at sequence level for this species in the data. See <italic toggle="yes"><xref rid="pcbi.1011163.s001" ref-type="supplementary-material">S1 Data</xref> and <xref rid="pcbi.1011163.s013" ref-type="supplementary-material">S13 Table</xref></italic>. A FASTA file of eight protein sequences corresponding to the FASTA headers of the protein groups of the <italic toggle="yes">Gallus gallus</italic> peptides was submitted for protein <bold>BLAST</bold>. For each query in the FASTA file, the set of organisms for all matches with more than 90% sequence identity was investigated—and 5 sequences matched only to <italic toggle="yes">Gallus gallus</italic>. These proteins include <italic toggle="yes">Apovitellenin-1</italic> (P02659), <italic toggle="yes">Vitellogenin-1</italic> (P87498, A0A1D5NUW2), <italic toggle="yes">Vitellogenin-2</italic> (P02845) and <italic toggle="yes">Vitellogenin-3</italic> (A0A3Q2U347). These are all known components of egg yolk. See <italic toggle="yes"><xref rid="pcbi.1011163.s002" ref-type="supplementary-material">S2 Data</xref> and <xref rid="pcbi.1011163.s014" ref-type="supplementary-material">S14 Table</xref></italic>.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec036">
    <title>Discussion</title>
    <p>On re-analysis of a set of Human Mucosal-luminal interface samples, comparative identification rates were achieved, with a &gt;2% increase in the number of MS/MS at the same FDR—but now simultaneously identifying multiple human origin peptides not assessed by the previous approaches—while not leaving out taxa identified by the other runs. The large number of exclusive peptides only identified by <italic toggle="yes">MetaNovo</italic>, can be explained by the previous approaches not including host sequences in the search sequence database, with potential misassignments of host peptides to microbial search sequence database entries for those runs—a known risk for search sequence databases that are not comprehensive (<italic toggle="yes">c</italic>.<italic toggle="yes">f</italic>. the <italic toggle="yes">Apis mellifera</italic> reanalysis example discussed previously) [<xref rid="pcbi.1011163.ref009" ref-type="bibr">9</xref>]. Any such spurious PSMs are likely to have a higher PEP score distribution, overlapping with those from the reverse hit sequence database (which are all by definition spurious sequences)—thus leading to a decreased rate of target peptide identifications at the given FDR cutoff. This explains the lower MS/MS % identification rate of the previous approaches. The improved error distribution of exclusive peptides identified using <bold>MetaNovo</bold> supports this view and contrasts with the error distribution of peptides exclusively identified by <bold>MetaPro-IQ</bold> with the metagenomics sequence database, the latter having a higher median PEP score than and with a distribution not significantly different from the distribution of reverse hits in the same experiment. A similar situation was found for the 9MM samples, where the median PEP score obtained from the Meta-PA only group (0.046675) was higher than the median peptide PEP score for reverse hits (0.010709), but the p-value for the difference in the distributions was not statistically significant. It is reassuring that in no comparison where the median PEP score was higher than for reverse hits, was the difference in the distribution statistically significant. It is interesting, in each case, that it was the sequence database that yielded the poorest MS/MS identification rate, that yielded the poorest PEP scores for peptides exclusively identified using that sequence database (not statistically significantly different from reverse hits) for both the MetaPro-IQ/Metagenome, as well as the Meta-PA 9MM sequence database runs. We suggest that due to poor sequence database representativity, PSMs to incorrect sequences in the sequence database occur due to the non-inclusion of the correct sequences, with peptides exclusively identified by the incomplete sequence databases having much poorer peptide PEP scores than the same groups obtained from the other, more complete sequence databases, and peptides only identified by the most representative sequence databases (by MS/MS percentage assignment) having the best median PEP scores in this category. As <bold>MetaNovo</bold> did not identify any exclusive taxa other than host compared to the other MLI runs, but with higher numbers of viridiplantae and fungi taxa, it points to improved characterization of non-bacterial components while maintaining an accurate characterization of the bacterial component without over-estimating taxonomic diversity. These other components of the gut microbiome may yield key insights into complex inter-specific interactions that may not be evident with approaches that target only limited taxonomies. Lower numbers of Bacterial peptide identifications by <bold>MetaNovo</bold> compared to the other two approaches may be due to the fact that both previous sequence databases are more comprehensive at the Bacterial level, while the <bold>MetaNovo</bold> algorithm aims to be globally representative, and increase the percentage of assigned spectra overall. However, it may also reflect the absence of host proteins from the search space, potentially leading to mis-assignments. Future updates to the <bold>MetaNovo</bold> algorithm will aim to increase the comprehensiveness of the generated sequence database, including known, clinically relevant host polymorphisms and mutations, so that the output can compete with taxonomically focused sequence databases and further increase the global sensitivity of assignments.</p>
    <p>Taxonomic assignment of peptides from the 9MM data to <italic toggle="yes">Rhodotorula</italic> species other than the expected strain by <bold>UniPept</bold>, for both <bold>MetaNovo</bold> (143 peptides) and <bold>SGA-PA</bold> (33 peptides), indicate the limitations of the <bold>UniPept</bold> approach that is based on the transfer of reference annotations to the natural sequence diversity of field isolates. The higher number of <italic toggle="yes">Rhodotorula</italic> peptides identified by <bold>MetaNovo</bold> are consistent with the lower sequence coverage reported for the <italic toggle="yes">R</italic>. <italic toggle="yes">glutinis</italic> strain (x12) used for the <bold>SGA-PA sequence</bold> database. It is notable that the <bold>MetaNovo</bold> approach was able to yield improved performance over full genome sequencing by leveraging sequence information of related strains without prior expectation.</p>
    <p>The almost double MS/MS assignment rate of MetaNovo compared to the Meta-PA sequence database (based on NGS of the two 9MM extracts), despite both sequence databases being almost identical in size, is most likely due to the lack of yeast proteins in the Meta-PA sequence database, excluding two of the 9 species present in the samples from the sequence database search space. This is an example of the utility of an approach that doesnt rely on matched metagenomics data to construct the search sequence database, as these may not be available or of high enough quality.</p>
    <p>The unexpected but confident identification here of proteotypic peptides for <italic toggle="yes">Gallus gallus</italic>, as well as the identification of 5 proteotypic protein groups all related to egg yolk, in the 9MM samples prompted us to conjecture that egg yolk might have been a specific component of the media used for <italic toggle="yes">in vitro</italic> culture of one or more of the 9 microbial species; this was subsequently confirmed by the authors of the original 9MM study. Thus, the identification of putative contaminants that may have otherwise been missed during sequence database creation confirms the power of our approach, including in cases where rare and unknown components of a biological sample would otherwise be missed.</p>
    <p>Despite higher overall detection sensitivity, slightly lower numbers of Bacteria “superkingdom_name” peptides dentified by <bold>MetaNovo</bold> than for the other MLI runs, appears to support the hypothesis of Noble [<xref rid="pcbi.1011163.ref010" ref-type="bibr">10</xref>] that reducing multiple hypotheis testing can increase the sensitivity for peptides of interest, by the greater performance of the Bacteria focused sequence databases in bacterial identifications. The greater overall sensitivity of the <bold>MetaNovo</bold> sequence database, could similarly be due to the inclusion of only the most probable proteins within the included species, thus reducing multiple hypothesis testing globally. It could be an interesting avenue for future work, to provide the ability to limit the search sequence database export by the <bold>MetaNovo</bold> algorithm to only taxa of interest, to further reduce multiple hypothesis testing, both during sequence database filtering from <bold>UniProt</bold>, and peptide identification using the filtered sequence database.</p>
    <p>Higher rates of MS/MS assignments yielded by the <bold>MetaNovo</bold> approach compared to the matched genomic approaches (both <bold>MetaPro-IQ/Metagenome</bold> and <bold>SGA-PA</bold>) indicate the utility of the <bold>MetaNovo</bold> algorithm in leveraging publicly available taxonomic and sequence data without sacrificing search sensitivity. Notably, the original, entire unfiltered <bold>UniProt</bold> sequence database seems likely to be more representative of expressed proteomes and natural sequence diversity in clinical samples than sequence databases compiled from reference bacterial proteomes based on 16S rRNA data and which may not directly reflect the actual sequences present at the proteome level. Further, as gene transcription does not correlate well with protein translation, sequence database generation approaches that rely only on matched metagenomic data may lead to an unnecessarily large search space and therefore decreased sequence database search sensitivity. Indeed, <bold>MetaNovo</bold> does not rely on any prior genomic data on specific samples as a pre-requisite for generation of sequence databases to search the mass spectrometry data against. Instead, <bold>MetaNovo</bold> relies on the sum total of all known, curated protein sequences to provide the search space, which provides additional advantages in circumstances where genomic data is not available or where simultaneous analysis of host, viral, fungal, dietary and bacterial proteomes is needed. Importantly, the production by <bold>MetaNovo</bold> of a more representative but still focused sequence database reduces the potential for mis-assignment of MS/MS due to sequence database incompleteness, leading to an increase in sequence database search sensitivity and accuracy.</p>
    <p>It can be argued that the use here of the <bold>UniProt</bold> (<bold>SwissProt</bold> plus <bold>trEMBL</bold>) sequence database still provides a degree of bias in the search space compared to larger sequence databases such as the <bold>NCBI</bold> nr protein sequence database that contain many more proteins and species from clinical and environmental sources. Moreover, the current reliance of <bold>MetaNovo</bold> on annotated sequences may miss novel sequence polymorphisms present in clinical isolates. Further work to tailor the <bold>MetaNovo</bold> algorithm to work with non-<bold>UniProt</bold> FASTA sequence databases as well as with file formats such as the PSI extended FASTA format (PEFF) that include known clinically relevant polymorphisms, is now underway.</p>
  </sec>
  <sec sec-type="conclusions" id="sec037">
    <title>Conclusion</title>
    <p>In metaproteomic analyses where search spaces can be vast, the accuracy of protein and taxonomic assignment is critical. It is important to note therefore that not only does <bold>MetaNovo</bold> identify a greater total number of proteins per microbiome sample than previous two step approaches, but the clear separation of distributions of observed PEP scores between identified hits in the <bold>MetaNovo</bold>- and decoy sequence databases, coupled with a search space that does not artificially exclude host proteins, provides increased confidence in the spectral assignments made.</p>
    <p>Benchmarking of <bold>MetaNovo</bold> against other two step search tools, including on samples of defined microbial composition, yielded favourable results, with <bold>MetaNovo</bold> providing increased sensitivity without overestimating taxa present in the samples whilst simultaneously identifying unexpected components that may be missed using limited or hand-selected sequence databases.</p>
    <p>By estimating taxonomic and peptide level information on microbiome samples directly from tandem mass spectrometry data, in combination with the entire <bold>UniProt</bold> sequence database, <bold>MetaNovo</bold> allows simultaneous identification of human, bacterial, fungal, viral and other eukaryotic proteins in a given sample, unrestricted by prior expectation or availability of prior genomic data. The freely available MetaNovo algorithm should therefore enable clinically important correlations between changes in microbial protein abundance and change in the host proteome to be investigated in a single analysis, whilst minimising reliance on prior knowledge, or external information such as whole-genome sequencing.</p>
  </sec>
  <sec id="sec038" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011163.s001" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Taxonomic distribution by Kingdom of the UniProtKB 2019_11 release.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s001.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s002" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>Organisms included in the 9MM samples.</title>
        <p>Please refer to original publication, Table 1 [<xref rid="pcbi.1011163.ref033" ref-type="bibr">33</xref>].</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s002.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s003" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>MLI peptide PEP scores comparison.</title>
        <p>Shared—Peptides identified in all runs. Only—Peptides only identified in a particular run. Reverse hits—Reverse peptide hits for a particular run.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s003.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s004" position="float" content-type="local-data">
      <label>S4 Table</label>
      <caption>
        <title>MLI peptide PEP scores Dunn’s test post hoc comparison.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s004.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s005" position="float" content-type="local-data">
      <label>S5 Table</label>
      <caption>
        <title>UniPept pept2lca analysis of MLI samples.</title>
        <p>(CSV)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s005.csv">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s006" position="float" content-type="local-data">
      <label>S6 Table</label>
      <caption>
        <title>Peptide counts of taxa only identified with MetaNovo in the MLI samples.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s006.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s007" position="float" content-type="local-data">
      <label>S7 Table</label>
      <caption>
        <title>Peptide counts of taxa identified in all runs by UniPept <italic toggle="yes">pept2lca</italic> “taxon_name” in the MLI samples.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s007.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s008" position="float" content-type="local-data">
      <label>S8 Table</label>
      <caption>
        <title>“kingdom_name” peptides in the MLI samples.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s008.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s009" position="float" content-type="local-data">
      <label>S9 Table</label>
      <caption>
        <title>“phylum_name” peptides in the MLI samples.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s009.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s010" position="float" content-type="local-data">
      <label>S10 Table</label>
      <caption>
        <title>9MM peptide PEP scores comparison.</title>
        <p>Shared—Peptides identified in all runs. Only—Peptides only identified in a particular run. Reverse hits—Reverse peptide hits for a particular run.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s010.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s011" position="float" content-type="local-data">
      <label>S11 Table</label>
      <caption>
        <title>9MM peptide PEP scores Dunn’s test post hoc comparison.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s011.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s012" position="float" content-type="local-data">
      <label>S12 Table</label>
      <caption>
        <title>UniPept <italic toggle="yes">pept2lca</italic> analysis of 9MM samples.</title>
        <p>(CSV)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s012.csv">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s013" position="float" content-type="local-data">
      <label>S13 Table</label>
      <caption>
        <title>9MM <italic toggle="yes">Gallus gallus</italic> peptide BLAST (tabular).</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s013.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s014" position="float" content-type="local-data">
      <label>S14 Table</label>
      <caption>
        <title>9MM <italic toggle="yes">Gallus gallus</italic> protein BLAST (tabular).</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s014.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s015" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Density plot of MLI peptide PEP scores by group.</title>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s015.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s016" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>Bacteria “superkingdom_name” peptides in the MLI samples.</title>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s016.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s017" position="float" content-type="local-data">
      <label>S1 Data</label>
      <caption>
        <title>9MM <italic toggle="yes">Gallus gallus</italic> peptide BLAST.</title>
        <p>(JSON)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s017.json">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1011163.s018" position="float" content-type="local-data">
      <label>S2 Data</label>
      <caption>
        <title>9MM <italic toggle="yes">Gallus gallus</italic> protein BLAST.</title>
        <p>(JSON)</p>
      </caption>
      <media xlink:href="pcbi.1011163.s018.json">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We acknowledge the use of the ilifu cloud computing facility - <ext-link xlink:href="http://www.ilifu.ac.za/" ext-link-type="uri">www.ilifu.ac.za</ext-link>, a partnership between the University of Cape Town, the University of the Western Cape, the University of Stellenbosch, Sol Plaatje University, the Cape Peninsula University of Technology and the South African Radio Astronomy Observatory. The ilifu facility is supported by contributions from the Inter-University Institute for Data Intensive Astronomy (IDIA—a partnership be-tween the University of Cape Town, the University of Pretoria and the University of the Western Cape), the Computational Biology division at UCT and the Data Intensive Research Initiative of South Africa (DIRISA).</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011163.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Ochoa-Hueso</surname><given-names>R.</given-names></name><article-title>Global Change and the Soil Microbiome: A Human-Health Perspective</article-title>. <source>Front Ecol Evol [Internet].</source><year>2017</year><month>Jul</month><day>6</day> [cited 2019 Apr 10];<volume>5</volume>:<fpage>71</fpage>. Available from: <ext-link xlink:href="http://journal.frontiersin.org/article/10.3389/fevo.2017.00071/full" ext-link-type="uri">http://journal.frontiersin.org/article/10.3389/fevo.2017.00071/full</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Blaser</surname><given-names>MJ</given-names></name>, <name><surname>Cardon</surname><given-names>ZG</given-names></name>, <name><surname>Cho</surname><given-names>MK</given-names></name>, <name><surname>Dangl</surname><given-names>JL</given-names></name>, <name><surname>Donohue</surname><given-names>TJ</given-names></name>, <name><surname>Green</surname><given-names>JL</given-names></name>, <etal>et al</etal>. <article-title>Toward a Predictive Understanding of Earth’s Microbiomes to Address 21st Century Challenges</article-title>. <source>mBio</source> [<source>Internet]</source>. <year>2016</year>
<month>Jul</month>
<day>13</day> [cited 2019 Apr 10];<volume>7</volume>(<issue>3</issue>):<fpage>e00714</fpage>–<lpage>16</lpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/27178263" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/27178263</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mBio.00714-16</pub-id>
<?supplied-pmid 27178263?><pub-id pub-id-type="pmid">27178263</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Beyer</surname><given-names>A</given-names></name>, <name><surname>Aebersold</surname><given-names>R</given-names></name>. <article-title>Leading Edge Review On the Dependency of Cellular Protein Levels on mRNA Abundance</article-title>. <year>2016</year> [cited 2021 Apr 16]; Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2016.03.014</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Muth</surname><given-names>T</given-names></name>, <name><surname>Kolmeder</surname><given-names>CA</given-names></name>, <name><surname>Salojärvi</surname><given-names>J</given-names></name>, <name><surname>Keskitalo</surname><given-names>S</given-names></name>, <name><surname>Varjosalo</surname><given-names>M</given-names></name>, <name><surname>Verdam</surname><given-names>FJ</given-names></name>, <etal>et al</etal>. <article-title>Navigating through metaproteomics data: A logbook of database searching</article-title>. <source>Proteomics</source>. <year>2015</year><month>Oct</month><day>1</day>;<volume>15</volume>(<issue>20</issue>):<fpage>3439</fpage>–<lpage>53</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/pmic.201400560</pub-id><?supplied-pmid 25778831?><pub-id pub-id-type="pmid">25778831</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Tanca</surname><given-names>A</given-names></name>, <name><surname>Palomba</surname><given-names>A</given-names></name>, <name><surname>Fraumene</surname><given-names>C</given-names></name>, <name><surname>Pagnozzi</surname><given-names>D</given-names></name>, <name><surname>Manghina</surname><given-names>V</given-names></name>, <name><surname>Deligios</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>The impact of sequence database choice on metaproteomic results in gut microbiota studies</article-title>. <source>Microbiome</source> [Internet]. <year>2016</year>
<month>Sep</month>
<day>27</day> [cited 2021 May 25];<volume>4</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>13</lpage>. Available from: <ext-link xlink:href="https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-016-0196-8" ext-link-type="uri">https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-016-0196-8</ext-link>
<?supplied-pmid 27671352?><pub-id pub-id-type="pmid">26739322</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>H</given-names></name>, <name><surname>Li</surname><given-names>S</given-names></name>, <name><surname>Ye</surname><given-names>Y</given-names></name>. <article-title>A Graph-Centric Approach for Metagenome-Guided Peptide and Protein Identification in Metaproteomics.</article-title><name><surname>Serang</surname><given-names>O</given-names></name>, editor. <source>PLoS Comput Biol</source> [<source>Internet]</source>. <year>2016</year>
<month>Dec</month>
<day>5</day> [cited 2019 Mar 21];<volume>12</volume>(<issue>12</issue>):<fpage>e1005224</fpage>. Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005224</pub-id>
<?supplied-pmid 27918579?><pub-id pub-id-type="pmid">27918579</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Jagtap</surname><given-names>P</given-names></name>, <name><surname>Goslinga</surname><given-names>J</given-names></name>, <name><surname>Kooren</surname><given-names>JA</given-names></name>, <name><surname>Mcgowan</surname><given-names>T</given-names></name>, <name><surname>Wroblewski</surname><given-names>MS</given-names></name>, <name><surname>Seymour</surname><given-names>SL</given-names></name>, <etal>et al</etal>. <article-title>A two-step database search method improves sensitivity in peptide sequence matches for metaproteomics and proteogenomics studies</article-title>. <source>Proteomics</source> [Internet]. <year>2013</year>
<month>Apr</month> [cited 2021 Nov 25];<volume>13</volume>(<issue>8</issue>):<fpage>1352</fpage>–<lpage>7</lpage>. Available from: <ext-link xlink:href="https://pubmed.ncbi.nlm.nih.gov/23412978/" ext-link-type="uri">https://pubmed.ncbi.nlm.nih.gov/23412978/</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1002/pmic.201200352</pub-id>
<?supplied-pmid 23412978?><pub-id pub-id-type="pmid">23412978</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Ning</surname><given-names>Z</given-names></name>, <name><surname>Mayne</surname><given-names>J</given-names></name>, <name><surname>Moore</surname><given-names>JI</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Butcher</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>MetaPro-IQ: a universal metaproteomic approach to studying human and mouse gut microbiota</article-title>. <source>Microbiome</source> [Internet]. <year>2016</year>
<month>Jun</month>
<day>24</day> [cited 2017 Nov 6];<volume>4</volume>(<issue>1</issue>):<fpage>31</fpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/27343061" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/27343061</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-016-0176-z</pub-id>
<?supplied-pmid 27343061?><pub-id pub-id-type="pmid">27343061</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Knudsen</surname><given-names>GM</given-names></name>, <name><surname>Chalkley</surname><given-names>RJ</given-names></name>. <article-title>The effect of using an inappropriate protein database for proteomic data analysis</article-title>. <source>PLoS One [Internet].</source><year>2011</year> [cited 2021 Nov 25];<volume>6</volume>(<issue>6</issue>). Available from: <ext-link xlink:href="https://pubmed.ncbi.nlm.nih.gov/21695130/" ext-link-type="uri">https://pubmed.ncbi.nlm.nih.gov/21695130/</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0020873</pub-id>
<?supplied-pmid 21695130?><pub-id pub-id-type="pmid">21695130</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Noble</surname><given-names>WS</given-names></name>. <article-title>Mass spectrometrists should search only for peptides they care about</article-title>. <source>Nature Methods</source><year>2015</year><volume>12</volume>:<fpage>7</fpage> [Internet]. 2015 Jun 30 [cited 2023 Apr 8];12(<issue>7</issue>):605–8. Available from: <ext-link xlink:href="https://www.nature.com/articles/nmeth.3450" ext-link-type="uri">https://www.nature.com/articles/nmeth.3450</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Mesuere</surname><given-names>B</given-names></name>, <name><surname>Devreese</surname><given-names>B</given-names></name>, <name><surname>Debyser</surname><given-names>G</given-names></name>, <name><surname>Aerts</surname><given-names>M</given-names></name>, <name><surname>Vandamme</surname><given-names>P</given-names></name>, <name><surname>Dawyndt</surname><given-names>P</given-names></name>. <article-title>Unipept: Tryptic Peptide-Based Biodiversity Analysis of Metaproteome Samples</article-title>. <source>J Proteome Res</source> [Internet]. <year>2012</year>
<month>Dec</month>
<day>7</day> [cited 2017 Oct 5];<volume>11</volume>(<issue>12</issue>):<fpage>5773</fpage>–<lpage>80</lpage>. Available from: <ext-link xlink:href="http://pubs.acs.org/doi/abs/" ext-link-type="uri">http://pubs.acs.org/doi/abs/</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1021/pr300576s</pub-id>
<?supplied-pmid 23153116?><pub-id pub-id-type="pmid">23153116</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Mooradian</surname><given-names>AD</given-names></name>, <name><surname>Van Der Postid</surname><given-names>S</given-names></name>, <name><surname>Naegleid</surname><given-names>KM</given-names></name>, <name><surname>Heldid</surname><given-names>JM</given-names></name>. <source>ProteoClade: A taxonomic toolkit for multi-species and metaproteomic analysis</source>. 2020 [cited 2020 Apr 3]; Available from: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1007741</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Frank</surname><given-names>A</given-names></name>, <name><surname>Tanner</surname><given-names>S</given-names></name>, <name><surname>Pevzner</surname><given-names>P</given-names></name>. <article-title>Peptide Sequence Tags for Fast Database Search in Mass-Spectrometry</article-title>. <source>Lecture Notes in Bioinformatics (Subseries of Lecture Notes in Computer Science) [Internet].</source><year>2005</year> [cited 2021 Dec 28];<volume>3500</volume>:<fpage>326</fpage>–<lpage>41</lpage>. Available from: <ext-link xlink:href="https://link.springer.com/chapter/10.1021/pr050011x" ext-link-type="uri">https://link.springer.com/chapter/10.1021/pr050011x</ext-link>
<?supplied-pmid 16083278?><pub-id pub-id-type="pmid">16083278</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Tanner</surname><given-names>S</given-names></name>, <name><surname>Shu</surname><given-names>H</given-names></name>, <name><surname>Frank</surname><given-names>A</given-names></name>, <name><surname>Wang</surname><given-names>LC</given-names></name>, <name><surname>Zandi</surname><given-names>E</given-names></name>, <name><surname>Mumby</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>InsPecT: Identification of Posttranslationally Modified Peptides from Tandem Mass Spectra</article-title>. <source>Anal Chem</source> [Internet]. <year>2005</year>
<month>Jul</month>
<day>15</day> [cited 2021 Dec 28];<volume>77</volume>(<issue>14</issue>):<fpage>4626</fpage>–<lpage>39</lpage>. Available from: <ext-link xlink:href="https://pubs.acs.org/doi/abs/" ext-link-type="uri">https://pubs.acs.org/doi/abs/</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1021/ac050102d</pub-id>
<?supplied-pmid 16013882?><pub-id pub-id-type="pmid">16013882</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Muth</surname><given-names>T</given-names></name>, <name><surname>Renard</surname><given-names>BY</given-names></name>. <article-title>Evaluating de novo sequencing in proteomics: already an accurate alternative to database-driven peptide identification?</article-title><source>Brief Bioinform</source> [Internet]. <year>2018</year>
<month>Sep</month>
<day>28</day> [cited 2021 Dec 28];<volume>19</volume>(<issue>5</issue>):<fpage>954</fpage>–<lpage>70</lpage>. Available from: <ext-link xlink:href="https://academic.oup.com/bib/article/19/5/954/3076504" ext-link-type="uri">https://academic.oup.com/bib/article/19/5/954/3076504</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbx033</pub-id>
<?supplied-pmid 28369237?><pub-id pub-id-type="pmid">28369237</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Chi</surname><given-names>H</given-names></name>, <name><surname>Chen</surname><given-names>H</given-names></name>, <name><surname>He</surname><given-names>K</given-names></name>, <name><surname>Wu</surname><given-names>L</given-names></name>, <name><surname>Yang</surname><given-names>B</given-names></name>, <name><surname>Sun</surname><given-names>RX</given-names></name>, <etal>et al</etal>. <article-title>pNovo+: de novo peptide sequencing using complementary HCD and ETD tandem mass spectra</article-title>. <source>J Proteome Res</source> [Internet]. <year>2013</year>
<month>Feb</month>
<day>1</day> [cited 2021 Dec 28];<volume>12</volume>(<issue>2</issue>):<fpage>615</fpage>–<lpage>25</lpage>. Available from: <ext-link xlink:href="https://pubmed.ncbi.nlm.nih.gov/23272783/" ext-link-type="uri">https://pubmed.ncbi.nlm.nih.gov/23272783/</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1021/pr3006843</pub-id>
<?supplied-pmid 23272783?><pub-id pub-id-type="pmid">23272783</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Tabb</surname><given-names>DL</given-names></name>, <name><surname>Ma</surname><given-names>ZQ</given-names></name>, <name><surname>Martin</surname><given-names>DB</given-names></name>, <name><surname>Ham</surname><given-names>AJL</given-names></name>, <name><surname>Chambers</surname><given-names>MC</given-names></name>. <article-title>DirecTag: Accurate Sequence Tags from Peptide MS/MS through Statistical Scoring</article-title>. <source>J Proteome Res</source> [Internet]. <year>2008</year>
<month>Sep</month>
<day>5</day> [cited 2017 Oct 5];<volume>7</volume>(<issue>9</issue>):<fpage>3838</fpage>–<lpage>46</lpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/18630943" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/18630943</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1021/pr800154p</pub-id>
<?supplied-pmid 18630943?><pub-id pub-id-type="pmid">18630943</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>H</given-names></name>, <name><surname>Chi</surname><given-names>H</given-names></name>, <name><surname>Zeng</surname><given-names>WF</given-names></name>, <name><surname>Zhou</surname><given-names>WJ</given-names></name>, <name><surname>He</surname><given-names>SM</given-names></name>. <article-title>pNovo 3: precise de novo peptide sequencing using a learning-to-rank framework</article-title>. <source>Bioinformatics</source> [Internet]. <year>2019</year>
<month>Jul</month>
<day>15</day> [cited 2021 Dec 28];<volume>35</volume>(<issue>14</issue>):<fpage>i183</fpage>–<lpage>90</lpage>. Available from: <ext-link xlink:href="https://pubmed.ncbi.nlm.nih.gov/31510687/" ext-link-type="uri">https://pubmed.ncbi.nlm.nih.gov/31510687/</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btz366</pub-id>
<?supplied-pmid 31510687?><pub-id pub-id-type="pmid">31510687</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Alisoltani</surname><given-names>A</given-names></name>, <name><surname>Manhanzva</surname><given-names>MT</given-names></name>, <name><surname>Potgieter</surname><given-names>M</given-names></name>, <name><surname>Balle</surname><given-names>C</given-names></name>, <name><surname>Bell</surname><given-names>L</given-names></name>, <name><surname>Ross</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Microbial function and genital inflammation in young South African women at high risk of HIV infection</article-title>. <source>Microbiome</source>. <year>2020</year><month>Dec</month><day>1</day>;<volume>8</volume>(<issue>1</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-020-00932-8</pub-id><?supplied-pmid 33220709?><pub-id pub-id-type="pmid">33220709</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Delgado-Diaz</surname><given-names>DJ</given-names></name>, <name><surname>Jesaveluk</surname><given-names>B</given-names></name>, <name><surname>Hayward</surname><given-names>JA</given-names></name>, <name><surname>Tyssen</surname><given-names>D</given-names></name>, <name><surname>Alisoltani</surname><given-names>A</given-names></name>, <name><surname>Potgieter</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Lactic acid from vaginal microbiota enhances cervicovaginal epithelial barrier integrity by promoting tight junction protein expression.</article-title><source>Microbiome.</source><year>2022</year><month>Aug</month><day>31</day>;<volume>10</volume>(<issue>1</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s40168-022-01337-5</pub-id><?supplied-pmid 36045402?><pub-id pub-id-type="pmid">36045402</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Chigorimbo-Murefu</surname><given-names>NTL</given-names></name>, <name><surname>Potgieter</surname><given-names>MG</given-names></name>, <name><surname>Dzanibe</surname><given-names>S</given-names></name>, <name><surname>Gabazana</surname><given-names>Z</given-names></name>, <name><surname>Buri</surname><given-names>G</given-names></name>, <name><surname>Chawla</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>A Pilot Study to show that asymptomatic sexually transmitted infections alter the foreskin epithelial proteome.</article-title><source>Front Microbiol.</source><year>2022</year>;<volume>0</volume>:<fpage>3536</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fmicb.2022.928317</pub-id><?supplied-pmid 36325020?><pub-id pub-id-type="pmid">36325020</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Wagner</surname><given-names>R</given-names></name>, <name><surname>Thuy-Boun</surname><given-names>P</given-names></name>, <name><surname>McArdle</surname><given-names>A</given-names></name>, <name><surname>Mehta</surname><given-names>S</given-names></name>, <name><surname>Johnson</surname><given-names>J</given-names></name>, <name><surname>Grüning</surname><given-names>B</given-names></name>, <etal>et al</etal>. <article-title>ComPIL 2.0 and MetaNovo Tools for Metaproteomics Searches Within Galaxy: Searching for Needles in a Haystack.</article-title><source>In: 2021 Galaxy Community Conference (GCC2021) [Internet].</source><year>2021</year> [cited 2022 Oct 6]. Available from: <ext-link xlink:href="https://static.sched.com/hosted_files/gcc2021/69/abstract91.pdf" ext-link-type="uri">https://static.sched.com/hosted_files/gcc2021/69/abstract91.pdf</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref023">
      <label>23</label>
      <mixed-citation publication-type="other">Index of /pub/databases/uniprot/previous_releases/release-2019_11/ [Internet]. [cited 2020 Apr 22]. Available from: <ext-link xlink:href="ftp://ftp.uniprot.org/pub/databases/uniprot/previous_releases/release-2019_11/" ext-link-type="ftp">ftp://ftp.uniprot.org/pub/databases/uniprot/previous_releases/release-2019_11/</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref024">
      <label>24</label>
      <mixed-citation publication-type="other">uct-cbio/proteomics-pipelines: A repo with a proteogenomics and metaproteomics pipeline developed by Matthys Potgieter. [Internet]. [cited 2020 Apr 22]. Available from: <ext-link xlink:href="https://github.com/uct-cbio/proteomics-pipelines" ext-link-type="uri">https://github.com/uct-cbio/proteomics-pipelines</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">thyscbio/metanovo—Docker Hub [Internet]. [cited 2020 Apr 22]. Available from: <ext-link xlink:href="https://hub.docker.com/r/thyscbio/metanovo" ext-link-type="uri">https://hub.docker.com/r/thyscbio/metanovo</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Perez-Riverol</surname><given-names>Y</given-names></name>, <name><surname>Csordas</surname><given-names>A</given-names></name>, <name><surname>Bai</surname><given-names>J</given-names></name>, <name><surname>Bernal-Llinares</surname><given-names>M</given-names></name>, <name><surname>Hewapathirana</surname><given-names>S</given-names></name>, <name><surname>Kundu</surname><given-names>DJ</given-names></name>, <etal>et al</etal>. <article-title>The PRIDE database and related tools and resources in 2019: improving support for quantification data.</article-title><source>Nucleic Acids Res</source> [Internet]. 2019 Jan 8 [cited 2019 Jun 12];<volume>47</volume>(<issue>D1</issue>):<fpage>D442</fpage>–<lpage>50</lpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/30395289" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/30395289</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gky1106</pub-id>
<?supplied-pmid 30395289?><pub-id pub-id-type="pmid">30395289</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Muth</surname><given-names>T</given-names></name>, <name><surname>Weilnböck</surname><given-names>L</given-names></name>, <name><surname>Rapp</surname><given-names>E</given-names></name>, <name><surname>Huber</surname><given-names>CG</given-names></name>, <name><surname>Martens</surname><given-names>L</given-names></name>, <name><surname>Vaudel</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>DeNovoGUI: an open source graphical user interface for de novo sequencing of tandem mass spectra</article-title>. <source>J Proteome Res</source> [Internet]. <year>2014</year>
<month>Feb</month>
<day>7</day> [cited 2016 May 11];<volume>13</volume>(<issue>2</issue>):<fpage>1143</fpage>–<lpage>6</lpage>. Available from: <ext-link xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3923451&amp;tool=pmcentrez&amp;rendertype=abstract" ext-link-type="uri">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3923451&amp;tool=pmcentrez&amp;rendertype=abstract</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1021/pr4008078</pub-id>
<?supplied-pmid 24295440?><pub-id pub-id-type="pmid">24295440</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref028">
      <label>28</label>
      <mixed-citation publication-type="other">SQLite Home Page [Internet]. [cited 2020 Apr 22]. Available from: <ext-link xlink:href="https://www.sqlite.org/index.html" ext-link-type="uri">https://www.sqlite.org/index.html</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Kopczynski</surname><given-names>D</given-names></name>, <name><surname>Barsnes</surname><given-names>H</given-names></name>, <name><surname>Njølstad</surname><given-names>PR</given-names></name>, <name><surname>Sickmann</surname><given-names>A</given-names></name>, <name><surname>Vaudel</surname><given-names>M</given-names></name>, <name><surname>Ahrends</surname><given-names>R</given-names></name>. <article-title>PeptideMapper: efficient and versatile amino acid sequence and tag mapping</article-title>. <source>Bioinformatics</source> [Internet]. <year>2017</year>
<month>Jul</month>
<day>1</day> [cited 2017 Nov 6];<volume>33</volume>(<issue>13</issue>):<fpage>2042</fpage>–<lpage>4</lpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/28334306" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/28334306</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btx122</pub-id>
<?supplied-pmid 28334306?><pub-id pub-id-type="pmid">28334306</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Barsnes</surname><given-names>H</given-names></name>, <name><surname>Vaudel</surname><given-names>M</given-names></name>, <name><surname>Colaert</surname><given-names>N</given-names></name>, <name><surname>Helsens</surname><given-names>K</given-names></name>, <name><surname>Sickmann</surname><given-names>A</given-names></name>, <name><surname>Berven</surname><given-names>FS</given-names></name>, <etal>et al</etal>. <article-title>compomics-utilities: an open-source Java library for computational proteomics</article-title>. <source>BMC Bioinformatics</source> [Internet]. <year>2011</year>
<month>Mar</month>
<day>8</day> [cited 2017 Nov 6];<volume>12</volume>(<issue>1</issue>):<fpage>70</fpage>. Available from: <ext-link xlink:href="http://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-12-70" ext-link-type="uri">http://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-12-70</ext-link>
<?supplied-pmid 21385435?><pub-id pub-id-type="pmid">21385435</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Tange</surname><given-names>O.</given-names></name><article-title>GNU Parallel: The Command-Line Power Tool | USENIX</article-title> [Internet]. <source>The USENIX Magazine</source>. <year>2011</year> [cited 2017 Nov 6]. p. <fpage>42</fpage>–<lpage>7</lpage>. Available from: <ext-link xlink:href="https://www.usenix.org/publications/login/february-2011-volume-36-number-1/gnu-parallel-command-line-power-tool" ext-link-type="uri">https://www.usenix.org/publications/login/february-2011-volume-36-number-1/gnu-parallel-command-line-power-tool</ext-link></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Zybailov</surname><given-names>BL</given-names></name>, <name><surname>Florens</surname><given-names>L</given-names></name>, <name><surname>Washburn</surname><given-names>MP</given-names></name>. <article-title>Quantitative shotgun proteomics using a protease with broad specificity and normalized spectral abundance factors</article-title>. <source>Mol Biosyst</source> [Internet]. <year>2007</year>
<month>May</month> [cited 2017 Nov 7];<volume>3</volume>(<issue>5</issue>):<fpage>354</fpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/17460794" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/17460794</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1039/b701483j</pub-id>
<?supplied-pmid 17460794?><pub-id pub-id-type="pmid">17460794</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Tanca</surname><given-names>A</given-names></name>, <name><surname>Palomba</surname><given-names>A</given-names></name>, <name><surname>Deligios</surname><given-names>M</given-names></name>, <name><surname>Cubeddu</surname><given-names>T</given-names></name>, <name><surname>Fraumene</surname><given-names>C</given-names></name>. <article-title>Evaluating the Impact of Different Sequence Databases on Metaproteome Analysis: Insights from a Lab-Assembled Microbial Mixture</article-title>. <source>PLoS One [Internet].</source><year>2013</year> [cited 2020 Sep 25];<volume>8</volume>(<issue>12</issue>):<fpage>82981</fpage>. Available from: <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0082981</pub-id>
<?supplied-pmid 24349410?><pub-id pub-id-type="pmid">24349410</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Käll</surname><given-names>L</given-names></name>, <name><surname>Storey</surname><given-names>JD</given-names></name>, <name><surname>MacCoss</surname><given-names>MJ</given-names></name>, <name><surname>Noble</surname><given-names>WS</given-names></name>. <article-title>Posterior error probabilities and false discovery rates: two sides of the same coin</article-title>. <source>J Proteome Res</source> [Internet]. <year>2008</year>
<month>Jan</month>;<volume>7</volume>(<issue>1</issue>):<fpage>40</fpage>–<lpage>4</lpage>. Available from: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/18052118" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/pubmed/18052118</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1021/pr700739d</pub-id>
<?supplied-pmid 18052118?><pub-id pub-id-type="pmid">18052118</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Krug</surname><given-names>K</given-names></name>, <name><surname>Carpy</surname><given-names>A</given-names></name>, <name><surname>Behrends</surname><given-names>G</given-names></name>, <name><surname>Matic</surname><given-names>K</given-names></name>, <name><surname>Soares</surname><given-names>NC</given-names></name>, <name><surname>Macek</surname><given-names>B</given-names></name>. <article-title>Deep Coverage of the Escherichia coli Proteome Enables the Assessment of False Discovery Rates in Simple Proteogenomic Experiments</article-title>. <source>Mol Cell Proteomics</source> [Internet]. <year>2013</year>
<month>Nov</month> [cited 2022 Jan 10];<volume>12</volume>(<issue>11</issue>):<fpage>3420</fpage>. Available from: /pmc/articles/PMC3820952/ <comment>doi: </comment><pub-id pub-id-type="doi">10.1074/mcp.M113.029165</pub-id>
<?supplied-pmid 23908556?><pub-id pub-id-type="pmid">23908556</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Jia</surname><given-names>H</given-names></name>, <name><surname>Cai</surname><given-names>X</given-names></name>, <name><surname>Zhong</surname><given-names>H</given-names></name>, <name><surname>Feng</surname><given-names>Q</given-names></name>, <name><surname>Sunagawa</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>An integrated catalog of reference genes in the human gut microbiome</article-title>. <source>Nature Biotechnology</source><year>2014</year><volume>32</volume>:<fpage>8</fpage> [Internet]. 2014 Jul 6 [cited 2022 Jan 13];32(<issue>8</issue>):834–41. Available from: <ext-link xlink:href="https://www.nature.com/articles/nbt.2942" ext-link-type="uri">https://www.nature.com/articles/nbt.2942</ext-link>
<comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.2942</pub-id>
<?supplied-pmid 24997786?><pub-id pub-id-type="pmid">24997786</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011163.ref037">
      <label>37</label>
      <mixed-citation publication-type="other">Protein BLAST: search protein databases using a protein query [Internet]. [cited 2022 Jan 4]. Available from: <ext-link xlink:href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?PROGRAM=blastp&amp;PAGE_TYPE=BlastSearch&amp;LINK_LOC=blasthome" ext-link-type="uri">https://blast.ncbi.nlm.nih.gov/Blast.cgi?PROGRAM=blastp&amp;PAGE_TYPE=BlastSearch&amp;LINK_LOC=blasthome</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1011163.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011163.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ioshikhes, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ioshikhes, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011163" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">7 Feb 2023</named-content>
    </p>
    <p>Dear Potgieter,</p>
    <p>Thank you very much for submitting your manuscript "MetaNovo : an open-source pipeline for probabilistic peptide discovery in complex metaproteomic datasets" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.</p>
    <p>The reviewers all agree on the high quality of the manuscript and raise only matters related to presentation. Thus, we expect that these matters can be addressed quickly.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Luis Pedro Coelho</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Lucy Houghton</p>
    <p>Staff</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>The reviewers all agree on the high quality of the manuscript and raise only matters related to presentation. Thus, we expect that these matters can be addressed quickly.</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: In this manuscript, Potgieter et al developed a metaproteomic data analysis tool, MetaNovo, which involves de novo sequencing in the first step for the refined database generation. MetaNovo enables peptide identification from a comprehensive Uniprot database directly. This method is widely applicable to a variety of multi-species samples. The peptides from the host and other contaminants can also be identified simultaneously, which can improve the identification rate and reduce the random matches. This work can help researchers in various fields aiming to study the proteome from multi-species samples. There are some minor concerns that need to be addressed before publication.</p>
    <p>1. The users care about how fast the software runs. Could the authors provide the running time for the generation of the refined database from the Uniprot database by the de novo strategy?</p>
    <p>2. Could the authors double-check the data used in Figure 3D and Figure 4D? It looks a little bit strange that there are parts of PSMs with higher PEP scores than the reverse parts. We know that the reverse parts represent the random matches, and if the “metaproiq-metagenome: only” in Figure 3D and the “Meta-PA: only” in Figure 4D are also random matches, the PEP distributions will be similar. However, these two parts showed significantly higher PEP scores than random matches. Besides, this trend was observed from two different datasets and was surprisingly consistent. If it’s correct, can you explore the reasons for this result?</p>
    <p>3. Page 7, line 160. “for example using 16S sequencing data to produce a focused metaproteome library to search”. Here the word “library ” may cause a misunderstanding that it means a “spectra library”. I think it’s better to replace it with “database”.</p>
    <p>4. Page 24, line 526-527. “The results were almost double those of the metagenome DB (Meta-PA) database that yielded 23.03 % identified MSMS, 6044 target peptides and 1087 target proteins”. What’s the size of the Meta-PA database? Is the size of Meta-PA too big which leads to lower identification rate? How many peptides can be identified if you use the MetaNovo workflow based on the Meta-PA database?</p>
    <p>5. Page 26, line 551. “or UniPept misassignments of natural variants in the data.” The database used here is a Uniprot database, which incorporates taxonomic information. Are the identified protein names the same as the UniPept results? Actually, considering the Uniprot database contains the information of the organism for each protein, why use UniPept in the workflow instead of using the taxonomic information directly?</p>
    <p>6. Page 33, line 714-716. The ethics statement mentioned that adult stool samples were used, but no related content was found in the article. Only two public datasets were downloaded and analyzed in the manuscript.</p>
    <p>Reviewer #2: I think this paper contributes an important methodology to the proteomics and metaproteomics fields of study. It proposes that instead of making assumptions about the composition of organisms in a metaproteomics sample, we can use the vast amount of sequenced proteins that are publicly available and let the mass spectrometry data speak for itself. They do this by using de novo sequencing of peptides, followed by tag matching to the massive database of UniProt, and then they use their scoring and ranking metric to determine the which proteins should be put in the targeted database. Next, they take advantage of the standard database search of the mass spectrometry data, followed by using UniPept to determine what organism were present in the sample.</p>
    <p>While a 2% increase in the number of identified MS/MS spectra is not astonishing, the fact that this pipeline allows the user to not make any assumptions on the composition of their sample is immensely useful. This research is of high importance to many different areas of research where metagenomics and metaproteomics are used as tools to study complex biological systems. MetaNovo is particularly applicable if a lab does not have to budget or expertise to do metagenomics sequencing in addition to metaproteomics. The authors showed that they were able to detect chicken egg yoke proteins from the media that their sample was cultured on. This indicates that the MetaNovo method will also provide a better list of contaminate proteins.</p>
    <p>I was able to access their GitHub code and their PRIDE data. While their code base is not thoroughly documented, it is well organized and readable, and their GitHub page has instructions for how to install and run the MetaNovo software. Between their supplemental material, raw data on PRIDE, and their public GitHub code I believe that this study is repeatable by the scientific community.</p>
    <p>The authors come to reasonable conclusions that are backed up by their data, both in their figures and supplemental material. Just from my own curiosity, I’d be interested in seeing approximately how much time the MetaNovo pipeline takes to run on three replicate MGF files on a personal workstation or on a cluster. Finally, line 760 says ‘S8_table.csv’ but the file downloaded is S8_figure.png.</p>
    <p>Reviewer #3: This paper describes the algorithms, implementation, and results of a bioinformatics tool that uses de novo peptide identification to analyze LC-MS/MS metaproteomics data, specifically to create a database of protein sequences to use with traditional proteomics database search. The results show that the new tool has some advantages over more traditional methods of creating databases for metaproteomics/microbial community samples. The methods are sound and original, the results are interesting and the paper should be published. However, there are a few revisions that the authors could make to make their paper easier to understand. The authors should consider the following points:</p>
    <p>1. Figures. Graphics resolution is low and type is very small in figures 3, 4, and 5. The small type is extremely hard to read and presents a real obstacle to understanding the paper. Authors should consider reformatting the figures, or breaking up multipart figures into multiple figures, to allow a larger font size. Possibly this is partly due to the automatic formatting in to a PDF file for reviewers, but as provided to the reviewer, the font size is too small. In addition, many plots are missing y-axis labels. I also found Figure 2 to be difficult to understand. What does the arrow represent? Do the colors encode important information? Authors should consider revising the graphic, significantly expanding the caption, or possibly both. Also consider making the y-axis of Figure 3D and 4D logarithmic to should differences at lot PEP values better. Captions should include the dataset used.</p>
    <p>2. Dangers of omitting present organisms from the search database (page 8, lines 184-191). The authors cite Knudsen and Chalkley (reference 9 in the manuscript) as an example of what can happen when a true component of the sample is omitted from the search database. In this paper, Knudsen and Chalkley reexamine the data of Bromenshenk et al., who looked for protein markers of honeybee pathogens without including the honeybee protein database in their database. Knudsen and Chalkley do reach the conclusion that this omission was the cause of incorrect peptide identifications. However, Noble (<ext-link xlink:href="https://www.nature.com/articles/nmeth.3450" ext-link-type="uri">https://www.nature.com/articles/nmeth.3450</ext-link>) also reexamined the Bromenshenk data and reached a different conclusion: that only a small number of spectral assigned to pathogens should have been assigned to honeybee peptides, and “the choice of database does not explain the incorrect results obtained by Bromenshenk et al.” (Noble). Since the authors invoke Knudsen and Chalkley’s conclusion as a reason for the increased success of MetaNovo (page 28 line 603), I would be very interested to hear how they account for Noble’s arguments in this context.</p>
    <p>3. What do you mean by database? When describing each data set analyzed, the authors indicate the size of the search database produced by MetaNovo (e.g. page 17 lines 374-376 for the mucosal-luminal interface dataset). If I am following correctly, this “database” is the product of the whole MetaNovo pipeline, the “parsimonious protein subset identified” indicated near the bottom center of Figure 1. There is some possibility for the reader to confuse this database with the SQLite database that holds all the the DirecTag results, described on page 13 lines 287-291. The authors should consider how to distinguish these two uses of the word “database” to ensure that the results section is clear. I’m not just trying to nitpick here, it actually confused me the first time through.</p>
    <p>4. Page 23 line 501. Clarify what is meant by “taxon_name taxa.”</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>Figure Files:</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link xlink:href="https://pacev2.apexcovantage.com" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>Data Requirements:</p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>Reproducibility:</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>References:</p>
    <p>Review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript.</p>
    <p>
      <italic toggle="yes">If you need to cite a retracted article, indicate the article’s retracted status in the References list and also include a citation and full reference for the retraction notice.</italic>
    </p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1011163.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011163.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011163" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">12 Apr 2023</named-content>
    </p>
    <supplementary-material id="pcbi.1011163.s019" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Letter of Responses to Reviewers Comments .docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1011163.s019.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1011163.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011163.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ioshikhes, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ioshikhes, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011163" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">8 May 2023</named-content>
    </p>
    <p>Dear Prof Blackburn,</p>
    <p>We are pleased to inform you that your manuscript 'MetaNovo : an open-source pipeline for probabilistic peptide discovery in complex metaproteomic datasets' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Luis Pedro Coelho</p>
    <p>Academic Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Ilya Ioshikhes</p>
    <p>Section Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Lucy Houghton</p>
    <p>Staff</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1011163.r004" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011163.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>Ilya</given-names>
        </name>
        <role>Section Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Coelho</surname>
          <given-names>Luis Pedro</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Ioshikhes, Coelho</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Ioshikhes, Coelho</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1011163" id="rel-obj004" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">13 Jun 2023</named-content>
    </p>
    <p>PCOMPBIOL-D-22-01483R1 </p>
    <p>MetaNovo: an open-source pipeline for probabilistic peptide discovery in complex metaproteomic datasets</p>
    <p>Dear Dr Blackburn,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Anita Estes</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
