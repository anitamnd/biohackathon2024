<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9188040</article-id>
    <article-id pub-id-type="publisher-id">8542</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-022-08542-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>UMGAP: the Unipept MetaGenomics Analysis Pipeline</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3168-927X</contrib-id>
        <name>
          <surname>Van der Jeugt</surname>
          <given-names>Felix</given-names>
        </name>
        <address>
          <email>unipept@ugent.be</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maertens</surname>
          <given-names>Rien</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Steyaert</surname>
          <given-names>Aranka</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Verschaffelt</surname>
          <given-names>Pieter</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>De Tender</surname>
          <given-names>Caroline</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dawyndt</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mesuere</surname>
          <given-names>Bart</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5342.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 2069 7798</institution-id><institution>Department of Applied Mathematics, Computer Science and Statistics, </institution><institution>Ghent University, </institution></institution-wrap>Ghent, Belgium </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.15762.37</institution-id><institution-id institution-id-type="ISNI">0000 0001 2215 0390</institution-id><institution>Department of Information Technology, IDLab, </institution><institution>imec, </institution></institution-wrap>Ghent, Belgium </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.511525.7</institution-id><institution>VIB-UGent Center for Medical Biotechnology, </institution></institution-wrap>Ghent, Belgium </aff>
      <aff id="Aff4"><label>4</label>Plant Sciences Unit, Flanders Research Institute for Agriculture, Fisheries and Food, Ghent, Belgium </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>433</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>4</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Shotgun metagenomics yields ever richer and larger data volumes on the complex communities living in diverse environments. Extracting deep insights from the raw reads heavily depends on the availability of fast, accurate and user-friendly biodiversity analysis tools.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Because environmental samples may contain strains and species that are not covered in reference databases and because protein sequences are more conserved than the genes encoding them, we explore the alternative route of taxonomic profiling based on protein coding regions translated from the shotgun metagenomics reads, instead of directly processing the DNA reads. We therefore developed the Unipept MetaGenomics Analysis Pipeline (UMGAP), a highly versatile suite of open source tools that are implemented in Rust and support parallelization to achieve optimal performance. Six preconfigured pipelines with different performance trade-offs were carefully selected, and benchmarked against a selection of state-of-the-art shotgun metagenomics taxonomic profiling tools.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">UMGAP’s protein space detour for taxonomic profiling makes it competitive with state-of-the-art shotgun metagenomics tools. Despite our design choices of an extra protein translation step, a broad spectrum index that can identify both archaea, bacteria, eukaryotes and viruses, and a highly configurable non-monolithic design, UMGAP achieves low runtime, manageable memory footprint and high accuracy. Its interactive visualizations allow for easy exploration and comparison of complex communities.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at (10.1186/s12864-022-08542-4).</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Shotgun metagenomics</kwd>
      <kwd>Biodiversity analysis</kwd>
      <kwd>Taxonomic profiling</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003132</institution-id>
            <institution>Agentschap voor Innovatie door Wetenschap en Technologie</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1164420N</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003132</institution-id>
            <institution>Agentschap voor Innovatie door Wetenschap en Technologie</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1174621N</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003132</institution-id>
            <institution>Agentschap voor Innovatie door Wetenschap en Technologie</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1512619N</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003132</institution-id>
            <institution>Agentschap voor Innovatie door Wetenschap en Technologie</institution>
          </institution-wrap>
        </funding-source>
        <award-id>12I5220N</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Biodiversity, in many environments, is formed by complex communities of archaea, bacteria, eukaryotes, and viruses. Most of these organisms are hard to isolate and culture in lab conditions, so getting insight into which species are present in these environments and estimating their abundances nowadays routinely relies on metagenomics [<xref ref-type="bibr" rid="CR1">1</xref>]: a combination of high-throughput DNA sequencing and computational methods that bypass the cultivation step to enable genomic analysis. In particular, shotgun metagenomics, the non-targeted sequencing of all genomes in an environmental sample, is applied more often [<xref ref-type="bibr" rid="CR2">2</xref>], as it allows the profiling of both taxonomic composition and functional potential of the sample.</p>
    <p>In general, computational approaches for taxonomic profiling of metagenomics data from high-complexity environments directly process the reads by either assembling them into larger contigs before profiling [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR8">8</xref>] or by individually mapping them to DNA sequence databases [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref>], e.g., compiled from publicly available reference genomes. As the latter approach is carried out without assembly, it can mitigate assembly problems, speed up computations, and enable profiling of low-abundance organisms that cannot be assembled de novo [<xref ref-type="bibr" rid="CR2">2</xref>]. Mapping a read onto a reference database usually either applies inexact string matching algorithms on the entire read or breaks it into shorter fragments before applying exact string matching algorithms.</p>
    <sec id="Sec2">
      <title>Aims</title>
      <p>In this paper we explore the alternative route of first translating the protein coding regions in the reads of a shotgun metagenomics data set. We then map the resulting protein fragments onto a reference protein sequence database. Because protein sequences are more conserved than the genes encoding them [<xref ref-type="bibr" rid="CR12">12</xref>], this might alleviate the limitation that environmental samples contain strains that are not covered in reference databases or even belong to yet uncharacterized species. In addition, it allows us to adapt the high-performance mapping algorithms based on periodic builds of a UniProtKB-based index [<xref ref-type="bibr" rid="CR13">13</xref>] for mapping tryptic peptides that we developed for shotgun metaproteomics analysis in Unipept [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR17">17</xref>]. Mapping against the complete UniProt Knowledgebase has the advantage that it covers all domains of life in a single general-purpose analysis, compared to using one or more reference databases of selected genomes.</p>
    </sec>
    <sec id="Sec3">
      <title>Methods</title>
      <p>The general steps involved in our approach for taxonomic profiling of a DNA read are outlined in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. After identifying and translating the (partial) protein coding genes in the read, the protein fragments are split into short peptides. Each individual peptide is then mapped onto a precomputed consensus taxon derived from all proteins containing the peptide in the reference database. As a final step we derive a consensus taxon for the read from the consensus taxa of its individual peptides. For paired-end sequencing, the information content in the final step increases after merging the individual peptides from a read pair, as it is guaranteed that both reads originate from the same organism.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Outline of the Unipept Metagenomics Analysis Pipeline (UMGAP). Green blocks represent data types, purple blocks represent tools. Horizontally aligned purple blocks grouped in yellow boxes are alternative approaches for the same general step of the pipeline</p></caption><graphic xlink:href="12864_2022_8542_Fig1_HTML" id="MO1"/></fig></p>
      <p>Each individual step in the above process can be tackled using a multitude of strategies. To explore which strategy performs best and how the combination of alternative strategies leads to different trade-offs with respect to runtime, memory footprint and predictive accuracy, we have implemented the Unipept Metagenomics Analysis Pipeline (UMGAP) according to the Unix philosophy [<xref ref-type="bibr" rid="CR18">18</xref>]. The result is a modular suite of 20 versatile filters (commands that read from standard input and write to standard output) that each implement a single operation and that can be seamlessly combined into a single data processing pipeline. All filters are implemented in Rust (<ext-link ext-link-type="uri" xlink:href="https://www.rust-lang.org">https://www.rust-lang.org</ext-link>) and support parallelisation to achieve optimal performance. As some filters implement alternative strategies of the same operation, we have performed a parameter sweep to collect performance metrics of all relevant combinations of alternative strategies. Based on our observations from this parameter sweep, we have selected six preconfigured pipelines with different performance trade-offs whose results have been compared in an established benchmark [<xref ref-type="bibr" rid="CR19">19</xref>] to a selection of state-of-the-art shotgun metagenomics taxonomic profiling tools.</p>
      <p>UMGAP has been open sourced on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/unipept/umgap">https://github.com/unipept/umgap</ext-link>) under the MIT License. Documentation (<ext-link ext-link-type="uri" xlink:href="https://unipept.ugent.be/umgap">https://unipept.ugent.be/umgap</ext-link>) and case studies (<ext-link ext-link-type="uri" xlink:href="https://unipept.ugent.be/umgap/casestudies">https://unipept.ugent.be/umgap/casestudies</ext-link>) are available on the Unipept website.</p>
    </sec>
  </sec>
  <sec id="Sec4">
    <title>Implementation</title>
    <p>UMGAP performs taxonomic profiling of individual reads or read pairs in a shotgun metagenomics data set. Results can be summarized for the entire data set, either as a hierarchical frequency table containing each identified taxon or as an interactive taxonomic visualization. The pipeline executes a multi-step process and provides fast implementations of alternative strategies for every step of the analysis. In this section, we chronologically discuss the successive steps of the generic pipeline, together with their alternative strategies.</p>
    <sec id="Sec5">
      <title>Protein translation</title>
      <p>UMGAP does not profile a read directly at the DNA level. Instead, protein fragments translated from the coding regions in the read are matched. Non-coding regions are ignored a priori (which might impact the sensitivity compared to identification strategies that use the entire read, especially for organisms with a lower coding density) and extra steps are required to find coding regions and protein translations (which might negatively impact both performance and accuracy). However, the more conserved nature of proteins compared to DNA might lead to better generalizations when it comes to profiling environmental strains that have no perfect match in the reference database [<xref ref-type="bibr" rid="CR12">12</xref>]. Two approaches are supported: one based on gene prediction in short reads and one based on a full six-frame translation (Fig. <xref rid="Fig2" ref-type="fig">2</xref>).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Sample DNA fragment extracted from the <italic>Acinetobacter baumannii</italic> 118362 genome (NCBI Assembly ASM58051v1, positions 37.700-39.530) containing three RefSeq annotated coding regions of a major Facilitator Superfamily protein (EXA88265), a tetR family protein (EXA88191) and a translocator family protein (EXA88255), marked with yellow lines (top). Blue lines indicate coding regions predicted by FGS. Green dots indicate starting positions of 9-mers with an LCA* on the <italic>A. baumannii</italic> lineage (true positive identifications). Red dots indicate starting positions of 9-mers with an LCA* outside the <italic>A. baumannii</italic> lineage (false positive identifications). Opacity of colored dots indicates depth in the taxonomic tree: opaque colors indicate highly specific LCA* (species level) and translucent colors indicate nonspecific LCA*. This example illustrates the following general observations: (1) the frameshift-correcting topology of the FGS hidden Markov model often incorrectly interprets coding regions of genes that are very close or overlapping as frameshifts and glues them together; (2) missing dots at the end of coding regions is merely an artefact of the visualization: the last 8 codons (24 bases) are never starting positions of <italic>k</italic>-mers; (3) FGS may identify false coding regions or (4) frame shifts, but the extracted peptides from those and (5) translations from non-coding regions in a six-frame translation are mostly filtered automatically as they have no exact match with any UniProt protein or can be filtered with additional heuristics</p></caption><graphic xlink:href="12864_2022_8542_Fig2_HTML" id="MO2"/></fig></p>
      <p><bold>Gene prediction</bold> In theory, UMGAP may use any gene predictor capable of identifying coding regions and their translations in short reads. Not all gene predictors can do this task accurately, as reads might contain only partial coding regions with start and/or stop sections missing. The translation table to be used is also a priori unknown.</p>
      <p>We used both FragGeneScan (FGS) [<xref ref-type="bibr" rid="CR20">20</xref>] and our own faster and more robust implementation of FGS in Rust called FragGeneScanRs (FGSrs) [<xref ref-type="bibr" rid="CR21">21</xref>] for testing and benchmarking purposes. FGS has a custom Hidden Markov Model whose topology especially addresses the problem of finding genes in short and error-prone reads, correcting frameshifts resulting from read errors. FragGeneScan-Plus (FGS+) [<xref ref-type="bibr" rid="CR22">22</xref>] is a faster implementation of FGS. As FGS+ is no longer actively supported, our own implementation with improved multithreading support and several critical bug fixes has been released as FGSrs.</p>
      <p>FGS and its derivatives are functionally equivalent and can thus be plugged into UMGAP interchangeably. They perform gene prediction relatively fast and accurate. However, due to their predictive nature, false negatives and, to a lesser extent, false positives might have a negative impact on downstream steps of the pipeline. Especially missed coding regions may lead to information loss and reduced precision of the pipeline.</p>
      <p>Other gene prediction tools such as Prodigal [<xref ref-type="bibr" rid="CR23">23</xref>], MetaGeneMark [<xref ref-type="bibr" rid="CR24">24</xref>] and MetaGeneAnnotator [<xref ref-type="bibr" rid="CR25">25</xref>] can also be plugged into UMGAP. However, this would also require an additional gene translator, as some of these tools merely predict the loci of genes but do not translate them into protein sequences.</p>
      <p><bold>Six-frame translation</bold> Translation of all coding regions is guaranteed when applied on all six reading frames of an error-free read, but at least 83.33% false positives (5 out of 6 reading frames) need to be filtered away downstream. UMGAP implements this strategy without attempting to correct for read errors at this stage, as they only result in local information loss in downstream steps. The translation table is user-specified, without an attempt to derive it from the data or using multiple tables. While this approach might lead to increased sensitivity compared to gene prediction, it yields at least a sixfold increase in the data volume that needs to be processed in downstream analysis.</p>
    </sec>
    <sec id="Sec6">
      <title>Protein fragmentation</title>
      <p>All (partial) proteins that are putatively translated from the read are matched against the complete UniProt knowledgebase [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. Direct full-length exact matching is not feasible due to natural variation and read errors. Even though fast heuristics exist for full-length inexact matching or alignment [<xref ref-type="bibr" rid="CR27">27</xref>], it remains a relatively slow approach. Instead, UMGAP achieves high-performance inexact matching of protein fragments by breaking them down into short peptides. Two approaches are supported: non-overlapping variable-length peptides and overlapping fixed-length peptides.</p>
      <p><bold>Tryptic peptides</bold> UMGAP breaks protein fragments into non-overlapping variable-length peptides by splitting after each lysine (K) or arginine (R) residue that is not followed by proline (P). This is the classic in silico emulation of a trypsin digest, the most widespread protein digestion used for mass spectrometry [<xref ref-type="bibr" rid="CR28">28</xref>]. It is a random fragmentation strategy in the context of metagenomics, but finds its roots in the Unipept metaproteomics analysis pipeline as the initial starting point for UMGAP, and is merely an attempt to reuse part of the metaproteomics processing pipeline for metagenomics analysis. Applying this fragmentation strategy to all proteins in the UniProt Knowledgebase (2020/04 release) yields a collection of tryptic peptides with an average length of 17.671 amino acids (with peptides shorter than 5 or longer than 50 discarded).</p>
      <p>Note that UMGAP also supports user-specified regular expressions for variable-length protein fragmentation, other than the default regular expression that mimics an in silico tryptic digest. However, the regular expression used for protein fragmentation must match the regular expression used when fragmenting proteins to build a peptide profiling index from a reference database. We currently only host a pre-built index for tryptic peptides extracted from UniProt, so for peptide profiling with a non-tryptic fragmentation strategy, a custom peptide profiling index needs to be built.</p>
      <p><bold><italic>K</italic></bold><bold>-mers</bold> With overlapping fixed-length peptides or <italic>k</italic>-mers, the only parameter is the length <italic>k</italic> of the peptides. Choosing smaller <italic>k</italic> leads to more spurious hits when matching the <italic>k</italic>-mers of a protein fragment against the <italic>k</italic>-mers inferred from a reference protein database. Choosing larger <italic>k</italic> increases the impact of natural variation and read errors. Because protein fragments are reduced to all their overlapping <italic>k</italic>-mers, the number of resulting peptides increases <italic>k</italic>-fold compared to using tryptic peptides. So, choosing larger <italic>k</italic> also increases the total length of all peptides and thus the memory footprint for indexing them. It also increases the number of lookups that need to be done during peptide profiling. Finding a well-balanced peptide length <italic>k</italic> is therefore crucial.</p>
      <p>Because UMGAP uses exact matching for mapping peptides derived from a read onto peptides derived from the proteins in a reference database, read errors and natural variation usually have a lower impact on <italic>k</italic>-mers than on tryptic peptides. This is illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref> for a single nucleotide polymorphism (either as a read error or a natural variation).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Impact of a single nucleotide polymorphism (SNP) on the peptide coverage of a protein fragment. Because tryptic peptides are non-overlapping, each read position is covered by exactly one tryptic peptide. A SNP modifies a single tryptic peptide, but all positions around the SNP covered by the modified peptide are no longer covered (correctly) after matching (53 read positions on average). Because <italic>k</italic>-mers are overlapping, each read position is covered by k peptides, except at the ends of the protein fragments. A SNP modifies k peptides, but apart from reduced peptide coverage around the SNP, only a single codon is no longer covered (correctly) after matching. The redundancy of the overlapping <italic>k</italic>-mers therefore makes up for a reduced impact of SNPs compared to non-overlapping tryptic peptides, at the cost of larger data volumes that need to be processed</p></caption><graphic xlink:href="12864_2022_8542_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Peptide profiling</title>
      <p>Fragmentation of all partial proteins found in a read yields a list of peptides (tryptic peptides or <italic>k</italic>-mers). Each peptide may have an associated consensus taxon that is looked up in an index structure. Overall, these lookups are the most time-consuming step in the pipeline, so performance is of utmost importance.</p>
      <p>Upon each UniProt release, the Unipept team builds and publishes new indexes from tryptic peptides and 9-mers extracted from all UniProt proteins in the knowledgebase (available online at <ext-link ext-link-type="uri" xlink:href="https://unipept.ugent.be/system/umgap/recent/tryptic.fst">https://unipept.ugent.be/system/umgap/recent/tryptic.fst</ext-link>and <ext-link ext-link-type="uri" xlink:href="https://unipept.ugent.be/system/umgap/recent/ninemer.fst">https://unipept.ugent.be/system/umgap/recent/ninemer.fst</ext-link>). Each of these peptides is associated with the modified lowest common ancestor (LCA*) consensus taxon computed from the set of taxonomic annotations on all UniProt proteins that exactly match the peptide [<xref ref-type="bibr" rid="CR14">14</xref>]. LCA* is the most specific taxon that does not contradict any taxon in the set, i.e., all taxa in the set must either be descendants or ancestors of the LCA* in the NCBI Taxonomy [<xref ref-type="bibr" rid="CR29">29</xref>]. See the read profiling step for a detailed discussion on the LCA* algorithm introduced by UMGAP as a variation on the lowest common ancestor (LCA) algorithm.</p>
      <p>UMGAP uses a finite state transducer [<xref ref-type="bibr" rid="CR30">30</xref>] (FST) as its index structure to lookup the LCA* consensus taxon for each peptide extracted from a read. This index structure supports high-performance and parallel lookups, supports both fixed and variable length peptides, and has a relatively small memory footprint. The latter is important, given the large number of peptides extracted from UniProt. The index should be loaded in process memory, but UMGAP can also operate with an on-disk index and very little memory at the cost of performance.</p>
      <p>The FST maps each peptide extracted from a UniProt protein to the NCBI Taxonomy Identifier (an integer) of the LCA* associated with the peptide. It is a flow graph whose edges are labeled with amino acids and integers. Peptides are matched by following the path of their amino acid sequence. The sum of the integers along this path corresponds to the identifier of the LCA*. Where tries are ordered tree data structures that take advantage of common prefixes to reduce the memory footprint, FSTs are even more compressed by taking both common prefixes and suffixes into account (Fig. <xref rid="Fig4" ref-type="fig">4</xref>).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Finite state transducer mapping all weekdays to their index number (monday =1, tuesday =2,...). Integer labels are not shown on edges with zero weight. Adding weights along the path spelled by the letters of the word Thursday, from the initial state on the left (indicated by a triangle) to the final state on the right (indicated by a double circle), yields 2+1+1=4. So, Thursday is the fourth day in the week</p></caption><graphic xlink:href="12864_2022_8542_Fig4_HTML" id="MO4"/></fig></p>
      <p>For UniProt release 2020-04, a 19.3 GiB FST-index maps all 1.2 billion tryptic peptides to their LCA* and a 132.9 GiB FST-index maps all 17 billion 9-mers to their LCA*. We also experimented with other k-mer lengths, but precision dropped significantly for <italic>k</italic>≤7 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>) and the index size became too large for <italic>k</italic>≥10. The only viable options were <italic>k</italic>=8 and <italic>k</italic>=9, with the latter giving the best balance between index size and accuracy of read profiling.
<fig id="Fig5"><label>Fig. 5</label><caption><p>All tryptic peptides found in the UniprotKB (release 2020-04-22), classified by length and associated LCA* rank. Fractions of peptides (y-axis) across all peptide lengths (left) or per peptide length (right). Short tryptic peptides are more frequently associated with less specific ranks in the NCBI Taxonomy and therefore have a lower information content. Relative taxonomic information content (depth of LCA* rank in tree of life) is low for short peptides (length 8 and below). Because tryptic peptides of length <italic>k</italic> are a random sample of all <italic>k</italic>-mers, similar ratios and conclusions are expected should this analysis be repeated for all <italic>k</italic>-mers in UniprotKB across all lengths <italic>k</italic></p></caption><graphic xlink:href="12864_2022_8542_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Peptide filtering</title>
      <p>Protein fragmentation may yield false positives: peptides that do not occur in proteins encoded in the read. Most false positives are automatically filtered as they have no exact match with any UniProt protein. As a result, they cannot be associated with a taxon during peptide profiling. This is the case for most peptides from translations of wrong gene predictions or outside coding regions in a six-frame translation (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). But peptide profiling itself may also yield false positive identifications: peptides associated with an inconsistent taxon, i.e., a taxon that is not the correct taxon or one of its ancestors in the NCBI Taxonomy tree. This could be the case for both true and false positive peptides from protein fragmentation. Peptide filtering aims at strongly reducing the number of false positive identifications, while keeping most true positives. UMGAP supports three kinds of filters.</p>
      <p><bold>Short tryptic peptides</bold> Analysis on UniProt proteins shows that short tryptic peptides are typically associated with highly unspecific LCA* consensus taxa, i.e., taxa at or close to the root of the NCBI Taxonomy tree [<xref ref-type="bibr" rid="CR14">14</xref>] (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Because these peptides match proteins occurring across all domains of life, they do not provide a strong taxonomic signal that could be useful in downstream steps of the pipeline. In addition, by being short they often cause spurious matches during peptide profiling. UMGAP can skip very short tryptic peptides, e.g., having less than 6 amino acids.</p>
      <p><bold>Low-frequency identifications</bold> In the context of peptide profiling, true positive identifications should come from the same lineage in the NCBI Taxonomy tree, whereas false positives are randomly scattered across the tree. Since one read typically yields many peptides that may each have an associated taxon, identifications along the correct lineage are expected to occur with high frequency and false positives are expected to occur with low frequency. Therefore UMGAP can skip peptides associated with low-frequency identifications.</p>
      <p><bold>Seed-and-extend</bold> The (partial) proteins in the read are typically fragmented into multiple peptides and it is expected that neighboring peptides have similar identifications (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). It therefore seems natural to use a seed-and-extend approach to exploit this expected local conservation of identifications. Peptides are first scanned to find seeds: <italic>s</italic> or more successive peptides that are associated to the same LCA*. With increased minimum seed size <italic>s</italic>, the precision of the pipeline will increase, and its sensitivity will decrease. Each seed is then extended in both directions to neighboring seeds and individual peptides that are bridged by gaps (successive peptides with no associated LCA*) of at most <italic>g</italic> peptides. With increased maximum gap size <italic>g</italic>, the precision of the pipeline will decrease, and its sensitivity will increase. UMGAP can skip peptides that are excluded from extended seeds (Fig. <xref rid="Fig6" ref-type="fig">6</xref>).
<fig id="Fig6"><label>Fig. 6</label><caption><p>Seed-and-extend strategy for filtering false positive identifications after peptide profiling, with minimum seed size <italic>s</italic>=3 and maximum gap size <italic>g</italic>=1. Successive peptides fragmented from (partial) protein are shown as a sequence of dots. Green dots indicate correct identifications (true positives). Red dots indicate wrong identifications (false positives). Brightness of colored dots indicates depth in the taxonomic tree: dark colors indicate highly specific LCA* (species level) and light colors indicate nonspecific LCA*. Grey dots indicate peptides without an associated LCA*</p></caption><graphic xlink:href="12864_2022_8542_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec9">
      <title>Read profiling</title>
      <p>Previous steps of the pipeline result in a list of taxonomic identifications, derived from a (filtered) list of peptides extracted from the read. As the read comes from a single organism, it is natural to aggregate these individual identifications that rely on partial data into one global consensus identification. UMGAP supports three heuristics that infer a consensus taxon after mapping a frequency table of the individual identifications onto the NCBI Taxonomy tree (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). They balance between providing a consensus taxon that is as far away from the root as possible and that allows for a good generalization. The first goal is progressive and leads to a very specific consensus but has to avoid overfitting. The second goal is conservative and takes into account the possibility of false positives among the individual identifications but has to avoid underfitting. All heuristics are implemented with two different data structures: a tree and a range minimum query [<xref ref-type="bibr" rid="CR31">31</xref>]. Both implementations are functionally equivalent, but the latter gives a faster implementation of the MRTL heuristic because querying ancestry is supported in constant time.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Lowest common ancestor (LCA), LCA*, hybrid <sub><italic>f</italic></sub> and maximum root-to-leaf (MRTL) are four heuristics that determine a consensus taxon for a given list of taxa. All heuristics map the list of taxa onto the NCBI Taxonomy tree, that guides the heuristic towards a consensus taxon. MRTL is the most progressive heuristic and LCA* is the most conservative heuristic, so the MRTL consensus will be deeper in the tree than the LCA* consensus. The hybrid <sub><italic>f</italic></sub> heuristic has a parameter <italic>f</italic> that can be tweaked to yield a result that is either more towards the LCA* consensus or the MRTL consensus</p></caption><graphic xlink:href="12864_2022_8542_Fig7_HTML" id="MO7"/></fig></p>
      <p><bold>MRTL</bold> Maximum root-to-leaf [<xref ref-type="bibr" rid="CR11">11</xref>] is the most progressive heuristic. It identifies the consensus among a list of taxa as a taxon having the maximal number of ancestors in the list. Ties are broken arbitrarily. By definition, the consensus taxon is always included in the original list of taxa. This property does not hold for the other two heuristics, and shows that this heuristic might not necessarily be good at generalizing.</p>
      <p><bold>LCA*</bold> This the most conservative heuristic, though less conservative than a standard lowest common ancestor (LCA). For a given list of taxa, it identifies the consensus taxon as the most specific taxon in the tree that is either an ancestor or a descendant of each taxon in the list. This is the LCA of all taxa in the list, after we have first discarded all ancestors of at least one other taxon in the list. The latter is a measure against underfitting. Because the individual identifications are only based on partial data, it is expected that some identifications might be more specific than others. The LCA* heuristic is also used to compute the consensus taxon during peptide profiling.</p>
      <p><bold>Hybrid</bold><sub><bold><italic>f</italic></bold></sub> This heuristic has a parameter <italic>f</italic>∈[0,1] that allows to balance between being conservative or progressive: with <italic>f</italic>=1 this heuristic is the same as LCA* and with <italic>f</italic>=0 this heuristic is very close to MRTL (the same for most lists of taxa). LCA* can be implemented by starting at the root of the tree and repeatedly descending to the child node whose subtree contains all taxa in the list, until such a child no longer exists (i.e., the taxa in the list are distributed over multiple subtrees). In the latter case, the hybrid heuristic continues descending to the child node whose subtree contains most taxa from the list (with ties broken arbitrarily) if the fraction of the number of descendants in the child node over the number of descendants in the current node is larger than or equal to <italic>f</italic>.</p>
    </sec>
    <sec id="Sec10">
      <title>Summary and visualization</title>
      <p>Previous steps assign a consensus taxon to each read (pair). The final step of the pipeline computes a frequency table of all identifications across the entire data set, with the option to filter low-frequency identifications. Another option is to report the frequency table at a user-specified taxonomic rank. Frequency tables are exported in CSV-format, enabling easy postprocessing.</p>
      <p>To gain insight into environmental samples with a complex biodiversity, UMGAP also supports rendering taxonomic frequency tables as interactive visualizations (Fig. <xref rid="Fig8" ref-type="fig">8</xref>) that are automatically made available on a dedicated website. The online service hosting the visualizations also support shareable links (e.g. <ext-link ext-link-type="uri" xlink:href="https://bl.ocks.org/5960ffd859fb17439d7975896f513bc3">https://bl.ocks.org/5960ffd859fb17439d7975896f513bc3</ext-link>).
<fig id="Fig8"><label>Fig. 8</label><caption><p>Taxonomic profiling by UMGAP as visualized by the Unipept Web API</p></caption><graphic xlink:href="12864_2022_8542_Fig8_HTML" id="MO8"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="results">
    <title>Results</title>
    <p>UMGAP implements multiple strategies for each step in the pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), with some strategies also driven by user-specified parameters. Runtime, memory footprint and accuracy of UMGAP were benchmarked as a two-step process. Using some smaller data sets, we first measured and analysed performance metrics for a large number of relevant combinations of strategies and parameter settings. This broad exploration allowed us to investigate how different strategies/parameter settings led to different performance trade-offs. As a result, we defined six preconfigured pipelines with different performance trade-offs. Performance of these configurations has then been compared to a selection of state-of-the shotgun metagenomics taxonomic profiling tools in an established benchmark [<xref ref-type="bibr" rid="CR19">19</xref>] that uses larger data sets.</p>
    <p>Both the parameter sweep and the benchmark were executed on a 2.60GHz 16 core Intel <italic>Ⓡ</italic> Xeon <italic>Ⓡ</italic> CPU E5-2650 v2 CPU with 195GB RAM running Debian 9.8 (stretch).</p>
    <sec id="Sec12">
      <title>Parameter tuning</title>
      <p>For protein translation we either used gene prediction or six-frame translation. FGSrs was used for gene prediction. In the protein fragmentation step we either used non-overlapping tryptic peptides or overlapping 9-mers. Tryptic peptides were filtered by length, with minimum length ranging from 5 to 10 amino acids and maximum length ranging from 45 to 50 amino acids. Peptide profiling was invariably done using LCA*. Low-frequency identifications were filtered with a minimum number of taxon hits per read that varied between 1 and 5, with a minimum of 1 hit effectively corresponding to no low-frequency identification filtering. For 9-mers, identifications were optionally also filtered using the seed-and-extend strategy with seed size <italic>s</italic> between 2 and 4, and gap size <italic>g</italic> between 0 to 4. Read profiling was done using either MRTL, LCA* or hybrid <sub><italic>f</italic></sub>, with parameter <italic>f</italic> either set to 0.25, 0.5 or 0.75.</p>
      <p>All variation included in this parameter sweep resulted in 3900 different UMGAP configurations whose performance was evaluated for taxonomic profiling of two metagenome data sets simulated by Wood and Salzberg [<xref ref-type="bibr" rid="CR11">11</xref>]. These data sets are referenced as the HiSeq metagenome and the MiSeq metagenome after the Illumina sequencing platforms whose read error models have been used for simulation. For each data set 1000 reads were simulated from 10 bacterial genomes, for a total of 10.000 reads per data set.</p>
      <p>Accuracy of each UMGAP configuration was evaluated at the genus level by computing precision and sensitivity of the taxonomic profiling for each data set. Using the UMGAP snaptaxon tool and guided by the NCBI Taxonomy tree, more specific UMGAP predictions were mapped to the genus level because expected predictions were only known at the genus level for these data sets. True positives (TP) are reads assigned to the expected genus. False positives (FP) are reads assigned to a genus other than the expected genus. False negatives (FN) are reads that UMGAP could not assign at or below the genus level. As these data sets contain no invalid reads, there are no true negatives (TN).</p>
      <p>Figure <xref rid="Fig9" ref-type="fig">9</xref> shows the precision and sensitivity of all 3900 UMGAP configurations tested. As expected, the protein fragmentation method has a major influence on sensitivity. The difference in precision is less pronounced at first glance. In general, 9-mer configurations (orange) have a higher sensitivity than tryptic configurations (blue), but they also have a higher runtime and memory footprint. To simplify further discussion, we will treat tryptic and 9-mer configurations separately in what follows.
<fig id="Fig9"><label>Fig. 9</label><caption><p>Precision and sensitivity of 3900 UMGAP configurations, with tryptic peptide configurations marked in blue and 9-mer configurations marked in orange. Six configurations are selected for further benchmarking</p></caption><graphic xlink:href="12864_2022_8542_Fig9_HTML" id="MO9"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Tryptic configurations</title>
      <p>If we look at the impact of protein translation on the accuracy of 1800 tryptic configurations (Supplementary Fig. <xref rid="Fig10" ref-type="fig">10</xref>), six-frame translation clearly improves the sensitivity of the tryptic configurations, at the cost of a steep drop in precision if spurious identifications resulting from incorrect translations are not properly filtered after peptide profiling. As it also yields much more work during the peptide profiling step, increasing execution time, combining six-frame translation with tryptic peptides proves less favorable.
<fig id="Fig10"><label>Fig. 10</label><caption><p>Precision and sensitivity of 1800 tryptic UMGAP configurations, classified per protein translation method: configurations using FGSrs gene predictions marked in orange and configurations using six-frame translations (6FT) marked in blue</p></caption><graphic xlink:href="12864_2022_8542_Fig10_HTML" id="MO10"/></fig></p>
      <p>Shorter peptides have a higher probability of random hits in a protein database. With tryptic peptides, it is therefore recommended to discard very short peptides. In general, we advise to only retain tryptic peptides with a length of at least 9 amino acids (Supplementary Fig. <xref rid="Fig11" ref-type="fig">11</xref>). We have also investigated the impact of a maximum peptide length cutoff on the accuracy of the predictions, but the effect is negligible except for a marginal gain in the speed of the pipeline.
<fig id="Fig11"><label>Fig. 11</label><caption><p>Precision and sensitivity of 1800 tryptic UMGAP configurations, classified per minimal peptide length</p></caption><graphic xlink:href="12864_2022_8542_Fig11_HTML" id="MO11"/></fig></p>
      <p>Tryptic configurations effectively profile only a limited number of peptides per read, such that filtering taxa after peptide profiling must be done carefully to avoid losing valuable information. Discarding taxa that have only been assigned to a single peptide guarantees high precision at the cost of a steep drop in sensitivity (Supplementary Fig. <xref rid="Fig12" ref-type="fig">12</xref>). This shows that tryptic configurations often profile reads based on a single peptide, increasing the risk of spurious predictions.
<fig id="Fig12"><label>Fig. 12</label><caption><p>Precision and sensitivity of 1800 tryptic UMGAP configurations, classified according to filtering of low-frequency identifications</p></caption><graphic xlink:href="12864_2022_8542_Fig12_HTML" id="MO12"/></fig></p>
      <p>The choice of read profiling method has no significant impact on the performance of the pipelines, again because of the limited number of (reliable) peptides per read whose predictions need to be aggregated.</p>
      <p>Based on the above observations we have selected two tryptic configurations with good accuracy trade-offs, either favoring higher precision or higher sensitivity (Fig. <xref rid="Fig9" ref-type="fig">9</xref>): 
<list list-type="bullet"><list-item><p><italic>tryptic precision:</italic> FGSrs, minimum peptide length 5, maximum peptide length 45, minimum 2 taxon hits, MRTL</p></list-item><list-item><p><italic>tryptic sensitivity:</italic> FGSrs, minimum peptide length 9, maximum peptide length 45, no rare taxon filtering, MRTL</p></list-item></list></p>
    </sec>
    <sec id="Sec14">
      <title>9-mer configurations</title>
      <p>When evaluating 800 UMGAP configurations that use 9-mer peptide fragmentation, the first observation is that seed-and-extend filtering has a positive effect on both precision and sensitivity (Supplementary Fig. <xref rid="Fig13" ref-type="fig">13</xref>). This filtering technique is not useful when working with tryptic peptides, but proves to be highly effective for discarding unreliable identifications after peptide profiling when working with 9-mers. As a result, we recommend to always apply seed-and-extend filtering in 9-mer configurations, and we will only focus on these configurations in any further analysis.
<fig id="Fig13"><label>Fig. 13</label><caption><p>Precision and sensitivity of 800 UMGAP configurations using 9-mer peptide fragmentation, with configurations that don’t use seed-and-extend filtering marked in blue and configurations that do use seed-and-extend filtering marked in orange</p></caption><graphic xlink:href="12864_2022_8542_Fig13_HTML" id="MO13"/></fig></p>
      <p>With respect to protein translation method, the same observations concerning accuracy hold as with the tryptic configurations (Supplementary Fig. <xref rid="Fig14" ref-type="fig">14</xref>). The sensitivity gain that can be obtained with six-frame translation is more pronounced than with the tryptic configurations, which may make up for the extra work during the peptide profiling step. However, effective filtering of spurious identifications after peptide profiling is still needed in order to avoid poor precision.
<fig id="Fig14"><label>Fig. 14</label><caption><p>Precision and sensitivity of 750 UMGAP configurations using 9-mer peptide fragmentation in combination with seed-and-extend filtering, classified per protein translation method: configurations using FGSrs gene predictions marked in orange and configurations using six-frame translations (6FT) marked in blue</p></caption><graphic xlink:href="12864_2022_8542_Fig14_HTML" id="MO14"/></fig></p>
      <p>Gene prediction is best combined with minimum seed size <italic>s</italic>=2 for optimal sensitivity and with minimum seed size <italic>s</italic>=3 for the best trade-off between precision and sensitivity (Supplementary Fig. <xref rid="Fig15" ref-type="fig">15</xref>). In combination with six-frame translation, better trade-offs between precision and sensitivity are achieved with higher minimum seed size <italic>s</italic>. With gene prediction the low-frequency identifications filter has a higher impact than the chosen read profiling method, whereas the opposite is true for six-frame translation (Supplementary Figs. <xref rid="Fig16" ref-type="fig">16</xref>–<xref rid="Fig19" ref-type="fig">19</xref>). In both cases, the maximum gap size <italic>g</italic> has no significant impact on the accuracy (data not shown).
<fig id="Fig15"><label>Fig. 15</label><caption><p>Precision and sensitivity of 750 UMGAP configurations using 9-mer peptide fragmentation in combination with seed-and-extend filtering, classified per minimal seed size and protein translation method. Gene prediction with FGS has been excluded</p></caption><graphic xlink:href="12864_2022_8542_Fig15_HTML" id="MO15"/></fig><fig id="Fig16"><label>Fig. 16</label><caption><p>Precision and sensitivity of 375 UMGAP configurations using 9-mer peptide fragmentation, seed-and-extend filtering and gene prediction, classified per read profiling method</p></caption><graphic xlink:href="12864_2022_8542_Fig16_HTML" id="MO16"/></fig><fig id="Fig17"><label>Fig. 17</label><caption><p>Precision and sensitivity of 375 UMGAP configurations using 9-mer peptide fragmentation, seed-and-extend filtering and gene prediction, classified per filtering of low-frequency identifications</p></caption><graphic xlink:href="12864_2022_8542_Fig17_HTML" id="MO17"/></fig><fig id="Fig18"><label>Fig. 18</label><caption><p>Precision and sensitivity of 375 UMGAP configurations using 9-mer peptide fragmentation, seed-and-extend filtering and six-frame translation, classified per read profiling method</p></caption><graphic xlink:href="12864_2022_8542_Fig18_HTML" id="MO18"/></fig><fig id="Fig19"><label>Fig. 19</label><caption><p>Precision and sensitivity of 375 UMGAP configurations using 9-mer peptide fragmentation, seed-and-extend filtering and six-frame translation, classified per filtering of low-frequency identifications</p></caption><graphic xlink:href="12864_2022_8542_Fig19_HTML" id="MO19"/></fig></p>
      <p>Based on the above observations we have selected four 9-mer configurations that represent different accuracy trade-offs. Ranging in optimization from precision to sensitivity they use the following UMGAP configurations (Fig. <xref rid="Fig9" ref-type="fig">9</xref>): 
<list list-type="bullet"><list-item><p><italic>max precision</italic> FGSrs, minimum 5 taxon hits, seed-and-extend with <italic>s</italic>=2 and <italic>g</italic>=2, hybrid <sub><italic>f</italic></sub> with <italic>f</italic>=0.75</p></list-item><list-item><p><italic>high precision</italic> six-frame translation, minimum 4 taxon hits, seed-and-extend with <italic>s</italic>=3 and <italic>g</italic>=4, hybrid <sub><italic>f</italic></sub> with <italic>f</italic>=0.5</p></list-item><list-item><p><italic>high sensitivity</italic> six-frame translation, no filtering on low-frequency identifications, seed-and-extend with <italic>s</italic>=3 and <italic>g</italic>=0, MRTL</p></list-item><list-item><p><italic>max sensitivity</italic> six-frame translation, no filtering on low-frequency identifications, seed-and-extend with <italic>s</italic>=2 and <italic>g</italic>=0, MRTL</p></list-item></list></p>
    </sec>
    <sec id="Sec15">
      <title>Benchmark</title>
      <p>The six preconfigured UMGAP pipelines selected from the parameter sweep analysis were compared with the two best-performing shotgun metagenomics analysis tools found in the MetaBenchmark study [<xref ref-type="bibr" rid="CR19">19</xref>] and with the popular Kaiju tool [<xref ref-type="bibr" rid="CR32">32</xref>] that was published shortly after the initial benchmark. Kraken [<xref ref-type="bibr" rid="CR11">11</xref>] and the newer Kraken 2 [<xref ref-type="bibr" rid="CR33">33</xref>] were run with their default (preloaded) indexes and 16 threads. CLARK [<xref ref-type="bibr" rid="CR34">34</xref>] was run with 20-mer indexes in full-mode. Because CLARK only supports identifications for a predefined taxonomic rank, we used indexes built from bacterial databases for the taxonomic ranks of phylum, genus, and species. Kaiju was run with its default index.</p>
      <p>Our benchmark uses the same experimental setup as the MetaBenchmark study, including its use of two simulated metagenomes that differ in relative abundance of the individual phyla and that have three replicates each. The six data sets contain between 27 and 37 million read pairs simulated from both real, simulated, and shuffled genomes, with read length 100 and mean insert size 500 (standard deviation 25). All data sets contain 20% reads simulated from shuffled genomes that serve as a negative control and also contain reads simulated from genomes that were artificially diverged from a <italic>Leptospira interrogans</italic> reference genome to test the robustness of the tools against natural variation.</p>
      <p>In addition to evaluating the accuracy of taxonomic profiling tools at the phylum and genus levels, we also evaluated their accuracy at the species level (Table <xref rid="Tab1" ref-type="table">1</xref>, genus and phylum level are included in Supplementary Tables <xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref>). Using the UMGAP snaptaxon tool and guided by the NCBI Taxonomy tree, predictions more specific than the taxonomic rank under evaluation were mapped to the taxonomic rank under evaluation. Predictions less specific than the taxonomic rank under evaluation were considered as no assignment to any taxon. Reads whose expected identification is less specific than the taxonomic rank under evaluation are ignored. True positives (TP) are non-shuffled reads assigned to the expected taxon. False positives (FP) are non-shuffled reads assigned to a taxon that differs from the expected taxon or shuffled reads assigned to a taxon. True negatives (TN) are shuffled reads not assigned to any taxon. False negatives (FN) are non-shuffled reads not assigned to any taxon.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Table: MetaBenchmark performance metrics for ten metagenomics analysis tools sorted by precision. Average numbers for the six simulated data sets are given. Accuracy evaluated at the species level and reported as sensitivity, specificity, precision (positive predictive value), negative predictive value (NPV) and Matthew’s Correlation Coefficient (MCC). Index size reported for CLARK is the sum of the phylum (46.6GiB), genus (149.5GiB) and species (146.3GiB) indexes. Performance metrics at genus and phylum ranks can be found in Supplementary Tables <xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Tool</th><th align="left">Precision</th><th align="left">Sensitivity</th><th align="left">Specificity</th><th align="left">NPV</th><th align="left">MCC</th><th align="left">Run time</th><th align="left">Index size</th></tr></thead><tbody><tr><td align="left">UMGAP tryptic prec.</td><td align="left">99.70%</td><td align="left">3.50%</td><td align="left">99.96%</td><td align="left">21.83%</td><td align="left">8.62%</td><td align="left">6.96 m</td><td align="left">19.3 GB</td></tr><tr><td align="left">Kraken</td><td align="left">99.38%</td><td align="left">81.34%</td><td align="left">98.15%</td><td align="left">59.21%</td><td align="left">68.24%</td><td align="left">210.86 m</td><td align="left">198.7 GB</td></tr><tr><td align="left">UMGAP max prec.</td><td align="left">98.94%</td><td align="left">45.87%</td><td align="left">98.22%</td><td align="left">33.35%</td><td align="left">37.73%</td><td align="left">16.47 m</td><td align="left">132.9 GB</td></tr><tr><td align="left">Kraken 2</td><td align="left">98.15%</td><td align="left">82.27%</td><td align="left">94.64%</td><td align="left">60.68%</td><td align="left">67.27%</td><td align="left">2.10 m</td><td align="left">43.3 GB</td></tr><tr><td align="left">UMGAP high prec.</td><td align="left">98.11%</td><td align="left">55.68%</td><td align="left">96.21%</td><td align="left">38.07%</td><td align="left">43.33%</td><td align="left">30.42 m</td><td align="left">132.9 GB</td></tr><tr><td align="left">Kaiju</td><td align="left">98.02%</td><td align="left">68.31%</td><td align="left">95.21%</td><td align="left">46.44%</td><td align="left">53.15%</td><td align="left">304.10 m</td><td align="left">74.4 GB</td></tr><tr><td align="left">UMGAP tryptic sens.</td><td align="left">96.07%</td><td align="left">18.03%</td><td align="left">97.36%</td><td align="left">24.88%</td><td align="left">17.95%</td><td align="left">6.10 m</td><td align="left">19.3 GB</td></tr><tr><td align="left">UMGAP high sens.</td><td align="left">92.55%</td><td align="left">66.70%</td><td align="left">84.12%</td><td align="left">46.04%</td><td align="left">44.28%</td><td align="left">30.32 m</td><td align="left">132.9 GB</td></tr><tr><td align="left">UMGAP max sens.</td><td align="left">80.78%</td><td align="left">77.73%</td><td align="left">63.34%</td><td align="left">58.94%</td><td align="left">40.39%</td><td align="left">31.12 m</td><td align="left">132.9 GB</td></tr><tr><td align="left">CLARK</td><td align="left">71.41%</td><td align="left">100.00%</td><td align="left">27.87%</td><td align="left">100.0%</td><td align="left">44.61%</td><td align="left">20.54 m</td><td align="left">342.3 GB</td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>The MetaBenchmark performance metrics for ten metagenomics analysis tools at genus level</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Tool</th><th align="left">Precision</th><th align="left">Sensitivity</th><th align="left">Specificity</th><th align="left">NPV</th><th align="left">MCC</th><th align="left">Run time</th></tr></thead><tbody><tr><td align="left">UMGAP tryptic precision</td><td align="left">99.87%</td><td align="left">5.19%</td><td align="left">99.97%</td><td align="left">20.97%</td><td align="left">10.37%</td><td align="left">7.29 min</td></tr><tr><td align="left">Kraken</td><td align="left">99.59%</td><td align="left">87.78%</td><td align="left">98.60%</td><td align="left">67.39%</td><td align="left">76.07%</td><td align="left">227.99 min</td></tr><tr><td align="left">UMGAP max precision</td><td align="left">99.56%</td><td align="left">63.49%</td><td align="left">98.89%</td><td align="left">40.86%</td><td align="left">50.22%</td><td align="left">17.28 min</td></tr><tr><td align="left">Kraken 2</td><td align="left">98.64%</td><td align="left">89.10%</td><td align="left">95.40%</td><td align="left">70.02%</td><td align="left">76.17%</td><td align="left">2.15 min</td></tr><tr><td align="left">UMGAP high precision</td><td align="left">99.08%</td><td align="left">73.24%</td><td align="left">97.40%</td><td align="left">48.63%</td><td align="left">58.05%</td><td align="left">31.59 min</td></tr><tr><td align="left">Kaiju</td><td align="left">99.04%</td><td align="left">80.49%</td><td align="left">97.02%</td><td align="left">56.51%</td><td align="left">65.62%</td><td align="left">314.55 min</td></tr><tr><td align="left">UMGAP tryptic sensitivity</td><td align="left">98.14%</td><td align="left">25.62%</td><td align="left">98.12%</td><td align="left">25.36%</td><td align="left">23.62%</td><td align="left">6.37 min</td></tr><tr><td align="left">UMGAP high sensitivity</td><td align="left">93.78%</td><td align="left">85.81%</td><td align="left">82.38%</td><td align="left">65.20%</td><td align="left">63.42%</td><td align="left">31.83 min</td></tr><tr><td align="left">UMGAP max sensitivity</td><td align="left">81.58%</td><td align="left">100.00%</td><td align="left">54.58%</td><td align="left">100.00%</td><td align="left">66.72%</td><td align="left">32.41 min</td></tr><tr><td align="left">CLARK</td><td align="left">70.76%</td><td align="left">100.00%</td><td align="left">8.97%</td><td align="left">100.00%</td><td align="left">25.19%</td><td align="left">22.27 min</td></tr></tbody></table></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>The MetaBenchmark performance metrics for ten metagenomics analysis tools at phylum level</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Tool</th><th align="left">Precision</th><th align="left">Sensitivity</th><th align="left">Specificity</th><th align="left">NPV</th><th align="left">MCC</th><th align="left">Run time</th></tr></thead><tbody><tr><td align="left">UMGAP tryptic precision</td><td align="left">100.00%</td><td align="left">6.10%</td><td align="left">100.00%</td><td align="left">21.03%</td><td align="left">11.32%</td><td align="left">7.27 min</td></tr><tr><td align="left">Kraken</td><td align="left">99.98%</td><td align="left">88.95%</td><td align="left">99.92%</td><td align="left">69.35%</td><td align="left">78.49%</td><td align="left">223.16 min</td></tr><tr><td align="left">UMGAP max precision</td><td align="left">99.99%</td><td align="left">73.50%</td><td align="left">99.96%</td><td align="left">48.55%</td><td align="left">59.71%</td><td align="left">17.08 min</td></tr><tr><td align="left">Kraken 2</td><td align="left">99.99%</td><td align="left">91.08%</td><td align="left">99.97%</td><td align="left">73.70%</td><td align="left">81.91%</td><td align="left">2.14 min</td></tr><tr><td align="left">UMGAP high precision</td><td align="left">99.96%</td><td align="left">83.02%</td><td align="left">99.88%</td><td align="left">59.56%</td><td align="left">70.25%</td><td align="left">31.74 min</td></tr><tr><td align="left">Kaiju</td><td align="left">99.96%</td><td align="left">84.32%</td><td align="left">99.88%</td><td align="left">61.47%</td><td align="left">71.92%</td><td align="left">317.04 min</td></tr><tr><td align="left">UMGAP tryptic sensitivity</td><td align="left">99.69%</td><td align="left">30.77%</td><td align="left">99.62%</td><td align="left">26.55%</td><td align="left">28.24%</td><td align="left">6.40 min</td></tr><tr><td align="left">UMGAP high sensitivity</td><td align="left">94.72%</td><td align="left">93.35%</td><td align="left">83.48%</td><td align="left">79.83%</td><td align="left">75.68%</td><td align="left">31.85 min</td></tr><tr><td align="left">UMGAP max sensitivity</td><td align="left">81.50%</td><td align="left">100.00%</td><td align="left">37.88%</td><td align="left">100.00%</td><td align="left">55.56%</td><td align="left">32.52 min</td></tr><tr><td align="left">CLARK</td><td align="left">74.28%</td><td align="left">100.00%</td><td align="left">7.87%</td><td align="left">100.00%</td><td align="left">24.17%</td><td align="left">22.39 min</td></tr></tbody></table></table-wrap></p>
      <p>In terms of precision the UMGAP tryptic precision configuration marginally surpasses Kraken, with the UMGAP max/high precision configurations, Kraken 2, and Kaiju also showing very high precision rates (Fig. <xref rid="Fig20" ref-type="fig">20</xref>, Table <xref rid="Tab1" ref-type="table">1</xref>). As expected, the UMGAP pipelines have a lower sensitivity than the other metagenomics pipelines because a priori no taxa are assigned to reads that have no or only short overlap with protein coding regions. This benchmark again underscores the difference in sensitivity between the tryptic and 9-mer configurations of UMGAP. Also take into account that precision is a more important accuracy metric than sensitivity for most biological applications, especially with deeply sequenced samples. In terms of speed Kraken 2 is the best-performing tool, with UMGAP’s tryptic configurations following in close range. Clark and the UMGAP 9-mer configurations are still considerably faster than Kraken and Kaiju.
<fig id="Fig20"><label>Fig. 20</label><caption><p>Precision and sensitivity evaluated at the species level for ten metagenomics analysis tools and the two simulated metagenomes of the MetaBenchmark. Dots indicating the accuracy metrics for the three replicates of each simulated metagenome are on top of each other, since each replicate was generated for identical proportions of phyla</p></caption><graphic xlink:href="12864_2022_8542_Fig20_HTML" id="MO20"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>In-depth analysis</title>
      <p>We would like to stress that UMGAP does not require setting a specific target taxonomic rank prior to processing a dataset. Instead, UMGAP automatically decides for each read at which taxonomic rank a reliable identification can be made, taking into account that deeper ranks are more informative. As a result, UMGAP automatically balances between optimal information content (specificity) and reliability (sensitivity), with different settings of the pipeline resulting in different trade-offs. Mapping UMGAP identifications to a specific rank is only a post-processing step we have done (using UMGAP’s snaprank tool) to comply with the experimental setup of the MetaBenchmark.</p>
      <p>Taking advantage of the dynamic taxonomic rank assignment and the fact that UMGAP reports taxonomic profiles for each individual read, we performed a more in-depth analysis to investigate two questions not elucidated by the MetaBenchmark: <italic>i</italic>) how specific are read profilings that are correctly identified but above the species level and <italic>ii</italic>) can we observe any trends that explain wrong identifications? The analysis still uses species as the target rank, but in a less stringent way compared to the MetaBenchmark.</p>
      <p>We performed the analysis using the UMGAP high precision pipeline. Accuracy metrics are reported per operational taxonomic unit (OTU), i.e. all (paired-end) reads are grouped per OTU from which they were extracted/generated. Results are reported in separate tables for one of the small datasets we used for parameter tuning (10 OTUs) and one of the large MetaBenchmark datasets (1105 OTUs), split into real (963), simulated (32) and shuffled (110) OTUs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). In what follows, we discuss some general observations from the in-depth analysis and illustrate them with specific use cases.</p>
      <p>In addition to correct identifications at the species level (the typical rank of the expected identification derived from the benchmark data), UMGAP also identifies (paired-end) reads correctly but at less specific taxonomic ranks (genus level and above) as can be seen from the second column in the reported tables. For some OTUs, UMGAP yields highly specific identifications, i.e. most of the OTU reads are correctly identified at the species level (species entry marked in bold in the second column). For other OTUs, UMGAP yields less specific identifications, i.e. most of the OTU reads are correctly identified at the genus level or above (species entry not marked in bold in the second column). One particular reason for the latter are misidentifications in the reference databases, especially because UMGAP uses broad spectrum indexes built from the entire UniProt Knowledgebase. Using the LCA* algorithm to compute the taxonomic profiling of a single peptide might correct for some misidentifications in UniProt, but definitely not all. For example, misidentifying UniProt proteins from one strain to another species of the same genus might cause that the taxonomic profiles of most peptides of the two species (the correct and wrong identification) resolve at the genus level and no longer at the species level. For some species groups it is also well known that they are extremely hard to differentiate or that there’s even debate whether it is natural to keep them taxonomically separate (as the <italic>Bacillus cereus</italic> vs. <italic>Bacillus anthracis</italic> case, with multiple OTUs included in the MetaBenchmark). Again, problematic identification in these species groups also increases the possibility of misidentifications in UniProt.</p>
      <p>Wrong identifications exceeding 2% of the total number of (paired-end) reads (marked in bold in the third column) are rare and might indicate issues with the expected identification in the benchmark dataset. For example, in the smaller dataset used for parameter tuning of UMGAP, none of the reads for the OTU identified as <italic>Aeromonas hydrophila</italic> SSU are identified by UMGAP as the species <italic>A. hydrophila</italic>, whereas 10% of the reads are identified as the species <italic>A. dhakensis</italic>. If we look into the history of the classification of these species, <italic>Aeromonas hydrophila</italic> subsp. <italic>dhakensis</italic> was established in 2002 as a new subspecies of <italic>A. hydrophila</italic> [<xref ref-type="bibr" rid="CR35">35</xref>], whereas in 2015 it was reclassified as a separate species <italic>A. dhakensis</italic> by Beaz-Hidalgo et al. [<xref ref-type="bibr" rid="CR36">36</xref>]. Grim et al. [<xref ref-type="bibr" rid="CR37">37</xref>] reclassified the virulent <italic>A. hydrophila</italic> SSU strain isolated from a patient with diarrhea in the Philippines as <italic>A. dhakensis</italic> SSU, showing that in this case UMGAP actually comes up with a correct identification and instead the identification in the benchmark should have been updated. Where Chen et al. [<xref ref-type="bibr" rid="CR38">38</xref>] mention that <italic>A. dhakensis</italic> is often misidentified as <italic>A. hydrophila</italic>, <italic>A. veronii</italic>, or <italic>A. caviae</italic> by commercial phenotypic tests in the clinical laboratory, our analysis shows that UMGAP is indeed able to correctly identify reads in a metagenomics dataset to <italic>A. dhakensis</italic>. Apart from the power of the identification pipeline used by UMGAP, this case study also reminds us that taxonomy is not a constant and underscores the importance of using broad spectrum indexes that are constantly updated.</p>
      <p>Some OTUs are only identified to the genus rank (or above) in the MetaBenchmark, whereas UMGAP consistently identifies many of the corresponding (paired-end) reads to one particular species of the same genus. An example is <italic>Methylovorus</italic> sp. MP688 in the large dataset, where UMGAP assigns 3087 of the 5556 reads (55%) to the species <italic>Methylovorus glucosotrophus</italic>. The correctness of this observation is confirmed by Doronina et al. [<xref ref-type="bibr" rid="CR39">39</xref>] based on phylogenetic analysis using 16S rRNA gene sequences and mxaF amino acid sequences, five years after the complete genome sequence of the strain MP688 has been deposited [<xref ref-type="bibr" rid="CR40">40</xref>] as <italic>Methylovorus</italic> sp., a name that has never been updated in the public sequence databases. An important factor in this case, is the fact that the complete genome sequence <italic>Methylovorus glucosetrophus</italic> strain SIP3-4 has been deposited in the public sequence database [<xref ref-type="bibr" rid="CR41">41</xref>], whose proteome is also available in UniProt.</p>
      <p>Almost all shuffled reads in the large dataset are mapped to the root of the NCBI Taxonomy, which corresponds to no identification at all. This reflects the robustness of UMGAP against spurious identifications. The large dataset contains reads simulated from genomes that were artificially diverged from a <italic>Leptospira interrogans</italic> reference genome (AE016823). In total, reads for 32 OTUs were generated from 8 simulated genomes with either little, medium, mixed or high divergence. Since these genomes are not random but simulated using an evolutionary model, it is expected that the derived reads could be assigned to the correct clade. Of the OTUs generated from simulated genomes with little divergence, we consistently observe that 35% of the reads are correctly identified to the species level and 40% to the genus level. Of the OTUs generated from simulated genomes with medium divergence, only 1-2% of the reads are correctly identified at the species level and 5% at the genus level. Of the OTUs generated from simulated genomes with high divergence, almost no reads could be identified. OTUs generated from simulated genomes with mixed divergence either follow the pattern of genomes with little divergence or the genomes with medium divergence.</p>
    </sec>
  </sec>
  <sec id="Sec17" sec-type="discussion">
    <title>Discussion</title>
    <p>The six predefined pipelines come bundled with UMGAP a separate POSIX shell script, which makes them the primary way to run UMGAP on metagenomics data sets. This section details the setup of the reference database and optional external tools, followed by a short case study using a preconfigured pipeline. Instructions on the configuration of your own pipeline and the details of all UMGAP tools are available on the Unipept website (<ext-link ext-link-type="uri" xlink:href="https://unipept.ugent.be/umgap">https://unipept.ugent.be/umgap</ext-link>).</p>
    <p>After downloading and installing UMGAP as described in the README (<ext-link ext-link-type="uri" xlink:href="https://github.com/unipept/umgap">https://github.com/unipept/umgap</ext-link>), run the umgap-setup.sh script to interactively download the relevant databases. Pass -f /opt/FragGeneScan to link the installation directory of FragGeneScan or put the FGSrs executable in your PATH.</p>
    <p>As an example, we will profile 100 paired-end reads sampled from the benchmark dataset [<xref ref-type="bibr" rid="CR19">19</xref>] (supplementary files <xref rid="MOESM2" ref-type="media">2</xref> and <xref rid="MOESM3" ref-type="media">3</xref>) using a tryptic peptide index. If these files are saved as A1.fq and A2.fq, the following command will profile the reads:</p>
    <p>
      <graphic position="anchor" xlink:href="12864_2022_8542_Figa_HTML" id="MO21"/>
    </p>
    <p>The two paired-end files are passed using the options -1 and -2. Only use the option -1 when processing single-end reads. Both files can be GZIP-compressed and will be automatically decompressed by UMGAP. The option -t is used to select one of the preconfigured pipelines. The flag -z demands UMGAP to compress the output, which is written to the file indicated with the option -o. The output file contains a single taxonomic profile for each read. For the sample files it should start with:</p>
    <p>
      <graphic position="anchor" xlink:href="12864_2022_8542_Figb_HTML" id="MO22"/>
    </p>
    <p>The umgap-visualize.sh script can be used to summarize and visualize the results. This script can create importable CSV frequency tables and interactive visualizations that are either stored locally or hosted online. This is illustrated in the following shell session. Figure <xref rid="Fig8" ref-type="fig">8</xref> contains a screenshot of one of the interactive vizualizations.</p>
    <p>
      <graphic position="anchor" xlink:href="12864_2022_8542_Figc_HTML" id="MO23"/>
    </p>
    <p>The flags -t, -w and -u select the output mode. The option -r allows setting the taxonomic rank for the output.</p>
  </sec>
  <sec id="Sec18" sec-type="conclusion">
    <title>Conclusions</title>
    <p>UMGAP’s protein space detour for taxonomic profiling makes it competitive with state-of-the-art shotgun metagenomics tools. Despite our design choices of an extra protein translation step, a broad spectrum index that can identify both archaea, bacteria, eukaryotes and viruses, and a highly configurable non-monolithic design, UMGAP achieves low runtime, manageable memory footprint and high accuracy. Integrating the command line tool with the interactive Unipept visualizations [<xref ref-type="bibr" rid="CR17">17</xref>] also allows exploration and comparison of complex communities. As such the pipeline has already been used to study the biodiversity in the rhizosphere [<xref ref-type="bibr" rid="CR42">42</xref>].</p>
    <p>As a next step, we want to further explore how the protein translation detour can be used to infer the functional capacity of an environmental sample from its metagenome, which is more challenging than inferring biodiversity. Again, Unipept’s function analysis pipeline for metaproteomes could be used as a potential starting point. In addition, both the biodiversity and the functional capacity of a sample could also be derived from its metatranscriptome, which could be analysed using pipelines similar to UMGAP but with an adjusted protein translation step.</p>
  </sec>
  <sec id="Sec19">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> UMGAP</p>
    <p>
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/unipept/umgap">https://github.com/unipept/umgap</ext-link>
    </p>
    <p>
      <bold>Archived release:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/unipept/umgap/releases/tag/v1.0.0">https://github.com/unipept/umgap/releases/tag/v1.0.0</ext-link>
    </p>
    <p><bold>Operating system(s):</bold> GNU/Linux, MacOS</p>
    <p><bold>Programming language:</bold> Rust</p>
    <p><bold>Other requirements:</bold> Rust edition 2018 or higher</p>
    <p><bold>License:</bold> MIT</p>
    <p><bold>Any restrictions to use by non-academics:</bold> None</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12864_2022_8542_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Table of misidentifications. This PDF file contains several multi-page tables showing the misidentifications in the benchmark data sets.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12864_2022_8542_MOESM2_ESM.txt">
            <caption>
              <p><bold>Additional file 2</bold> A1.fq.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12864_2022_8542_MOESM3_ESM.txt">
            <caption>
              <p><bold>Additional file 3</bold> A2.fq.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>FGS</term>
        <def>
          <p>FragGeneScan</p>
        </def>
      </def-item>
      <def-item>
        <term>FGS+</term>
        <def>
          <p>FragGeneScan+</p>
        </def>
      </def-item>
      <def-item>
        <term>FGSrs</term>
        <def>
          <p>FragGeneScanRs</p>
        </def>
      </def-item>
      <def-item>
        <term>LCA</term>
        <def>
          <p>Lowest common ancestor</p>
        </def>
      </def-item>
      <def-item>
        <term>FST</term>
        <def>
          <p>Finite state transducer</p>
        </def>
      </def-item>
      <def-item>
        <term>MRTL</term>
        <def>
          <p>Maximum root-to-leaf path</p>
        </def>
      </def-item>
      <def-item>
        <term>OTU</term>
        <def>
          <p>Operational taxonomic unit.</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Stijn Seghers for his contributions in implementing and benchmarking the initial tryptic peptide components of UMGAP. We thank Niels De Graef for his contributions in implementing and benchmarking the initial prototypes of UMGAP.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>FVDJ, PD and BM conceptualized the software. FVDJ, RM, AS and PV provided the implementation. FVDJ, CDT, PD and BM valided the results. FVDJ wrote the original draft. PD and BM reviewed and edited the draft. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>We thank the Flemish Supercomputer Center (VSC) funded by the Research Foundation - Flanders (FWO) and the Flemish Government for providing the infrastructure to build the Unipept indexes and to run the benchmarks from this manuscript. P.V., A.S., C.T., and B.M. would like to acknowledge Research Foundation - Flanders (FWO) [grants 1164420N, 1174621N, 1512619N, and 12I5220N]. The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The parameter tuning dataset can be found as the accuracy dataset at the Kraken website <ext-link ext-link-type="uri" xlink:href="https://ccb.jhu.edu/software/kraken/">https://ccb.jhu.edu/software/kraken/</ext-link>. The benchmark dataset can be found at UC Bioinformatics <ext-link ext-link-type="uri" xlink:href="http://web.archive.org/web/20170602055550/http://www.ucbioinformatics.org/metabenchmark.html">http://web.archive.org/web/20170602055550/http://www.ucbioinformatics.org/metabenchmark.html</ext-link>. The latter are also rehosted at Unipept (<ext-link ext-link-type="uri" xlink:href="https://unipept.ugent.be/system/umgap/metabenchmark/setA1_1.fq.gz">https://unipept.ugent.be/system/umgap/metabenchmark/setA1_1.fq.gz</ext-link>, setA1_2.fq.gz, setA2_1.fq.gz, setA2_2.fq.gz, setA3_1.fq.gz, setA3_2.fq.gz, setB1_1.fq.gz, setB1_2.fq.gz, setB2_1.fq.gz, setB2_2.fq.gz, setB3_1.fq.gz, and setB3_2.fq.gz) to ensure availability. The created index files are dated by UniprotKB release day and are found at <ext-link ext-link-type="uri" xlink:href="https://unipept.ugent.be/system/umgap/recent/ninemer.fst">https://unipept.ugent.be/system/umgap/recent/ninemer.fst</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://unipept.ugent.be/system/umgap/recent/tryptic.fst">tryptic.fst</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://unipept.ugent.be/system/umgap/recent/taxons.tsv">taxons.tsv</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>Metagenomics</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>455</volume>
        <fpage>481</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1038/455481a</pub-id>
        <?supplied-pmid 18818648?>
        <pub-id pub-id-type="pmid">18818648</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Shotgun metagenomics, from sampling to analysis</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>833</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3935</pub-id>
        <?supplied-pmid 28898207?>
        <pub-id pub-id-type="pmid">28898207</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>HCM</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>FYL</given-names>
          </name>
        </person-group>
        <article-title>Meta-idba: A de Novo assembler for metagenomic data</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>13</issue>
        <fpage>94</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Namiki</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hachiya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sakakibara</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Metavelvet: An extension of Velvet assembler to de novo metagenome assembly from short sequence reads</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>20</issue>
        <fpage>155</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks678</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>HCM</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>FYL</given-names>
          </name>
        </person-group>
        <article-title>Idba-ud: A de novo assembler for single-cell and metagenomic sequencing data with highly uneven depth</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>11</issue>
        <fpage>1420</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts174</pub-id>
        <?supplied-pmid 22495754?>
        <pub-id pub-id-type="pmid">22495754</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jackman</surname>
            <given-names>SD</given-names>
          </name>
        </person-group>
        <article-title>Abyss: A parallel assembler for short read sequence data</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1117</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.089532.108</pub-id>
        <?supplied-pmid 19251739?>
        <pub-id pub-id-type="pmid">19251739</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boisvert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Raymond</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Godzaridis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Laviolette</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Corbeil</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Ray Meta: scalable de novo metagenome assembly and profiling</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-12-r122</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hintze</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Canino-Koning</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Howe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tiedje</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>CT</given-names>
          </name>
        </person-group>
        <article-title>Scaling metagenome sequence assembly with probabilistic de Bruijn graphs</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>33</issue>
        <fpage>13272</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1121464109</pub-id>
        <?supplied-pmid 22847406?>
        <pub-id pub-id-type="pmid">22847406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Mitra</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ruscheweyh</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>Integrative analysis of environmental sequences using MEGAN4</article-title>
        <source>Genome Res</source>
        <year>2011</year>
        <volume>21</volume>
        <issue>9</issue>
        <fpage>1552</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.120618.111</pub-id>
        <?supplied-pmid 21690186?>
        <pub-id pub-id-type="pmid">21690186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brady</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Phymm and PhymmBL: metagenomic phylogenetic classification with interpolated Markov models</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>673</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1358</pub-id>
        <?supplied-pmid 19648916?>
        <pub-id pub-id-type="pmid">19648916</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Kraken: Ultrafast metagenomic sequence classification using exact alignments</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>46</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-3-r46</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Watson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Gann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Losick</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>Molecular Biology of the Gene</source>
        <year>2008</year>
        <publisher-loc>USA</publisher-loc>
        <publisher-name>Pearson/Benjamin Cummings</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boeckmann</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bairoch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Apweiler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Blatter</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Estreicher</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gasteiger</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Michoud</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>O’Donovan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Phan</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Pilbout</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The SWISS-PROT protein knowledgebase and its supplement TrEMBL in 2003</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>203</volume>
        <issue>31</issue>
        <fpage>365</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkg095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mesuere</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Devreese</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Debyser</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aerts</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vandamme</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dawyndt</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Unipept: Tryptic peptide-based biodiversity analysis of metaproteome samples</article-title>
        <source>J Proteome Res</source>
        <year>2012</year>
        <volume>11</volume>
        <issue>12</issue>
        <fpage>5773</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1021/pr300576s</pub-id>
        <?supplied-pmid 23153116?>
        <pub-id pub-id-type="pmid">23153116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurdeep Singh</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tanca</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Palomba</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Van der Jeugt</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Verschaffelt</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Uzzau</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dawyndt</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mesuere</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Unipept 4.0: Functional analysis of metaproteome data</article-title>
        <source>J Proteome Res</source>
        <year>2019</year>
        <volume>18</volume>
        <issue>2</issue>
        <fpage>606</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jproteome.8b00716</pub-id>
        <?supplied-pmid 30465426?>
        <pub-id pub-id-type="pmid">30465426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mesuere</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Debyser</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aerts</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Devreese</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Vandamme</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dawyndt</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The Unipept metaproteomics analysis pipeline</article-title>
        <source>Proteomics</source>
        <year>2015</year>
        <volume>15</volume>
        <issue>8</issue>
        <fpage>1437</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1002/pmic.201400361</pub-id>
        <?supplied-pmid 25477242?>
        <pub-id pub-id-type="pmid">25477242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verschaffelt</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Van Thienen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Van Den Bossche</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Van der Jeugt</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>De Tender</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dawyndt</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mesuere</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Unipept CLI 2.0: Adding support for visualizations and functional annotations</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>14</issue>
        <fpage>4220</fpage>
        <lpage>1</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa553</pub-id>
        <?supplied-pmid 32492134?>
        <pub-id pub-id-type="pmid">32492134</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Raymond</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <source>The Art of UNIX Programming</source>
        <year>2003</year>
        <publisher-loc>USA</publisher-loc>
        <publisher-name>Addison-Wesley Professional</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lindgreen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Adair</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Gardner</surname>
            <given-names>PP</given-names>
          </name>
        </person-group>
        <article-title>An evaluation of the accuracy and speed of metagenome analysis tools</article-title>
        <source>Sci Rep</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>19233</fpage>
        <pub-id pub-id-type="doi">10.1038/srep19233</pub-id>
        <?supplied-pmid 26778510?>
        <pub-id pub-id-type="pmid">26778510</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rho</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Fraggenescan: Predicting genes in short and error-prone reads</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>20</issue>
        <fpage>191</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van der Jeugt</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dawyndt</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mesuere</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Fraggenescanrs: better and faster gene prediction for short reads</article-title>
        <source>bioRxiv</source>
        <year>2021</year>
        <volume>■■■</volume>
        <fpage>■■■</fpage>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Hahn</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Hanson</surname>
            <given-names>NW</given-names>
          </name>
          <name>
            <surname>Konwar</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Hallam</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Fraggenescan-plus for scalable high-throughput short-read open reading frame prediction</article-title>
        <source>■■■</source>
        <year>2015</year>
        <volume>■■■</volume>
        <fpage>■■■</fpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hyatt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>LoCascio</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Land</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Larimer</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Hauser</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>
        <source>BMC bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id>
        <pub-id pub-id-type="pmid">20043860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lomsadze</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Borodovsky</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Ab initio gene identification in metagenomic sequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>132</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq275</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Noguchi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Taniguchi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Itoh</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Metageneannotator: Detecting species-specific patterns of ribosomal binding site for precise gene prediction in anonymous prokaryotic and phage genomes</article-title>
        <source>DNA Res</source>
        <year>2008</year>
        <volume>15</volume>
        <fpage>387</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="doi">10.1093/dnares/dsn027</pub-id>
        <?supplied-pmid 18940874?>
        <pub-id pub-id-type="pmid">18940874</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Magrane</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Consortium</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Uniprot Knowledgebase: a hub of integrated protein data</article-title>
        <source>Database (Oxford)</source>
        <year>2011</year>
        <volume>2011</volume>
        <fpage>009</fpage>
        <pub-id pub-id-type="doi">10.1093/database/bar009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <issue>3</issue>
        <fpage>403</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
        <?supplied-pmid 2231712?>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vandermarliere</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Getting intimate with trypsin, the leading protease in proteomics</article-title>
        <source>Mass Spectrom Rev</source>
        <year>2013</year>
        <volume>32</volume>
        <issue>6</issue>
        <fpage>453</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1002/mas.21376</pub-id>
        <?supplied-pmid 23775586?>
        <pub-id pub-id-type="pmid">23775586</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Federhen</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The NCBI Taxonomy database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>database issue</issue>
        <fpage>136</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr1178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Gallant</collab>
        </person-group>
        <article-title>Index 1,600,000,000 Keys with Automata and Rust</article-title>
        <source>■■■</source>
        <year>2017</year>
        <volume>■■■</volume>
        <fpage>■■■</fpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fischer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Heun</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Space-efficient preprocessing schemes for range minimum queries on static arrays</article-title>
        <source>SIAM J Comput</source>
        <year>2011</year>
        <volume>40</volume>
        <fpage>465</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1137/090779759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Menzel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Fast and sensitive taxonomic classification for metagenomics with Kaiju</article-title>
        <source>Nat Commun</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>11257</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms11257</pub-id>
        <?supplied-pmid 27071849?>
        <pub-id pub-id-type="pmid">27071849</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Improved metagenomic analysis with Kraken 2</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>257</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1891-0</pub-id>
        <?supplied-pmid 31779668?>
        <pub-id pub-id-type="pmid">31779668</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ounit</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wanamaker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Close</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Lonardi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CLARK: Fast and accurate classification of metagenomic and genomic sequences using discriminative k-mers</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>236</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1419-2</pub-id>
        <?supplied-pmid 25879410?>
        <pub-id pub-id-type="pmid">25879410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huys</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kämpfer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Albert</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Kühn</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Denys</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Swings</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Aeromonas hydrophila subsp. dhakensis subsp. nov., isolated from children with diarrhoea in Bangladesh, and extended description of Aeromonas hydrophila subsp. hydrophila (Chester 1901) Stanier 1943 (approved lists 1980)</article-title>
        <source>Int J Syst Evol Microbiol</source>
        <year>2002</year>
        <volume>52</volume>
        <issue>3</issue>
        <fpage>705</fpage>
        <lpage>12</lpage>
        <?supplied-pmid 12054229?>
        <pub-id pub-id-type="pmid">12054229</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beaz-Hidalgo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Martínez-Murcia</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Figueras</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Corrigendum to “Reclassification of Aeromonas hydrophila subsp. dhakensis Huys et al. 2002 and Aeromonas aquariorum Martínez-Murcia et al. 2008 as Aeromonas dhakensis sp. nov. comb nov. and emendation of the species Aeromonas hydrophila” [Syst. Appl. Microbiol. 36 2013 171-176]</article-title>
        <source>Syst Appl Microbiol</source>
        <year>2013</year>
        <volume>37</volume>
        <issue>7</issue>
        <fpage>■■■</fpage>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grim</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Kozlova</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Ponnusamy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fitts</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Sha</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kirtley</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>van Lier</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Tiner</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Erova</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Joseph</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Read</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Shak</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Joseph</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Singletary</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Felland</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Baze</surname>
            <given-names>WB</given-names>
          </name>
          <name>
            <surname>Horneman</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Chopra</surname>
            <given-names>AK</given-names>
          </name>
        </person-group>
        <article-title>Functional genomic characterization of virulence factors from necrotizing fasciitis-causing strains of Aeromonas hydrophila</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2014</year>
        <volume>80</volume>
        <fpage>4162</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.00486-14</pub-id>
        <?supplied-pmid 24795370?>
        <pub-id pub-id-type="pmid">24795370</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Lamy</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ko</surname>
            <given-names>WC</given-names>
          </name>
        </person-group>
        <article-title>Aeromonas dhakensis, an Increasingly Recognized Human Pathogen</article-title>
        <source>Front Microbiol</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>783</fpage>
        <?supplied-pmid 27303377?>
        <pub-id pub-id-type="pmid">27303377</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doronina</surname>
            <given-names>NV</given-names>
          </name>
          <name>
            <surname>Kaparulina</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>Trotsenko</surname>
            <given-names>YA</given-names>
          </name>
        </person-group>
        <article-title>Emended Description of Methylovorus glucosotrophus Govorukhina and Trotsenko 1991</article-title>
        <source>Mikrobiologiia</source>
        <year>2016</year>
        <volume>85</volume>
        <issue>5</issue>
        <fpage>506</fpage>
        <lpage>11</lpage>
        <?supplied-pmid 29364598?>
        <pub-id pub-id-type="pmid">29364598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiong</surname>
            <given-names>XH</given-names>
          </name>
          <name>
            <surname>Zhi</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>YJ</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>MX</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>YX</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>WC</given-names>
          </name>
        </person-group>
        <article-title>Complete Genome Sequence of the Bacterium Methylovorus sp. Strain MP688, a High-Level Producer of Pyrroloquinolone Quinone</article-title>
        <source>J Bacteriol</source>
        <year>2011</year>
        <volume>193</volume>
        <fpage>2080</fpage>
        <pub-id pub-id-type="doi">10.1128/JB.00242-11</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lapidus</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clum</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>LaButti</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kaluzhnaya</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Beck</surname>
            <given-names>DAC</given-names>
          </name>
          <name>
            <surname>del Rio</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mavromatis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Huntemann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lucas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lidstrom</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Ivanova</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chistoserdova</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Genomes of Three Methylotrophs from a Single Niche Reveal the Genetic and Metabolic Divergence of the Methylophilaceae</article-title>
        <source>J Bacteriol</source>
        <year>2011</year>
        <volume>193</volume>
        <fpage>3757</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1128/JB.00404-11</pub-id>
        <?supplied-pmid 21622745?>
        <pub-id pub-id-type="pmid">21622745</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Tender</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mesuere</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Van der Jeugt</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Haegeman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ruttink</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vandecasteele</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dawyndt</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Debode</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kuramae</surname>
            <given-names>EE</given-names>
          </name>
        </person-group>
        <article-title>Peat substrate amended with chitin modulates the n-cycle, siderophore and chitinase responses in the lettuce rhizobiome</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>8</volume>
        <fpage>9890</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-46106-x</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
