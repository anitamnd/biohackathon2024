<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7141418</article-id>
    <article-id pub-id-type="pmid">32240182</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0222733</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-21832</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Collection Review</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genomic Libraries</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genomic Libraries</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Plants</subject>
              <subj-group>
                <subject>Grasses</subject>
                <subj-group>
                  <subject>Wheat</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome-Wide Association Studies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genome-Wide Association Studies</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Human Genetics</subject>
            <subj-group>
              <subject>Genome-Wide Association Studies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Statistical Methods</subject>
            <subj-group>
              <subject>Forecasting</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Methods</subject>
              <subj-group>
                <subject>Forecasting</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Artificial Intelligence</subject>
          <subj-group>
            <subject>Machine Learning</subject>
            <subj-group>
              <subject>Support Vector Machines</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Genotyping</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Genotyping</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>DNA construction</subject>
              <subj-group>
                <subject>Marker Selection</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>DNA construction</subject>
            <subj-group>
              <subject>Marker Selection</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Agriculture</subject>
          <subj-group>
            <subject>Agronomy</subject>
            <subj-group>
              <subject>Plant Breeding</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BWGS: A R package for genomic selection and its application to a wheat breeding programme</article-title>
      <alt-title alt-title-type="running-head">A R package for genomic selection</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8927-5040</contrib-id>
        <name>
          <surname>Charmet</surname>
          <given-names>Gilles</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tran</surname>
          <given-names>Louis-Gautier</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Auzanneau</surname>
          <given-names>Jérôme</given-names>
        </name>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rincent</surname>
          <given-names>Renaud</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bouchet</surname>
          <given-names>Sophie</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>INRAE-UCA, UMR GDEC, Clermont-Ferrand, France</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Agri-Obtentions, Ferme de Gauvilliers, Orsonville, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Lukens</surname>
          <given-names>Lewis</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Guelph, CANADA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>gilles.charmet@inra.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="ecorrected">
      <day>8</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>4</issue>
    <elocation-id>e0222733</elocation-id>
    <permissions>
      <copyright-statement>© 2020 Charmet et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Charmet et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0222733.pdf"/>
    <abstract>
      <p>We developed an integrated R library called BWGS to enable easy computation of Genomic Estimates of Breeding values (GEBV) for genomic selection. BWGS, for BreedWheat Genomic selection, was developed in the framework of a cooperative private-public partnership project called Breedwheat (<ext-link ext-link-type="uri" xlink:href="https://breedwheat.fr/">https://breedwheat.fr</ext-link>) and relies on existing R-libraries, all freely available from CRAN servers. The two main functions enable to run 1) replicated random cross validations within a training set of genotyped and phenotyped lines and 2) GEBV prediction, for a set of genotyped-only lines. Options are available for 1) missing data imputation, 2) markers and training set selection and 3) genomic prediction with 15 different methods, either parametric or semi-parametric. The usefulness and efficiency of BWGS are illustrated using a population of wheat lines from a real breeding programme. Adjusted yield data from historical trials (highly unbalanced design) were used for testing the options of BWGS. On the whole, 760 candidate lines with adjusted phenotypes and genotypes for 47 839 robust SNP were used. With a simple desktop computer, we obtained results which compared with previously published results on wheat genomic selection. As predicted by the theory, factors that are most influencing predictive ability, for a given trait of moderate heritability, are the size of the training population and a minimum number of markers for capturing every QTL information. Missing data up to 40%, if randomly distributed, do not degrade predictive ability once imputed, and up to 80% randomly distributed missing data are still acceptable once imputed with Expectation-Maximization method of package rrBLUP. It is worth noticing that selecting markers that are most associated to the trait do improve predictive ability, compared with the whole set of markers, but only when marker selection is made on the whole population. When marker selection is made only on the sampled training set, this advantage nearly disappeared, since it was clearly due to overfitting. Few differences are observed between the 15 prediction models with this dataset. Although non-parametric methods that are supposed to capture non-additive effects have slightly better predictive accuracy, differences remain small. Finally, the GEBV from the 15 prediction models are all highly correlated to each other. These results are encouraging for an efficient use of genomic selection in applied breeding programmes and BWGS is a simple and powerful toolbox to apply in breeding programmes or training activities.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>Agence nationale de la recherche (FRA)US)</institution>
        </funding-source>
        <award-id>ANR-10-BTBR-03</award-id>
      </award-group>
      <funding-statement>This work was supported by the BreedWheat project thanks to funding from the French Government managed by the National Research Agency (ANR) in the framework of Investments for the Future (ANR-10-BTBR-03), France AgriMer and the French Fund to support Plant Breeding (FSOV). <ext-link ext-link-type="uri" xlink:href="https://breedwheat.fr/">https://breedwheat.fr/</ext-link>.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="1"/>
      <page-count count="20"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are available: (<ext-link ext-link-type="uri" xlink:href="https://forgemia.inra.fr/umr-gdec/bwgs">https://forgemia.inra.fr/umr-gdec/bwgs</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are available: (<ext-link ext-link-type="uri" xlink:href="https://forgemia.inra.fr/umr-gdec/bwgs">https://forgemia.inra.fr/umr-gdec/bwgs</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The use of molecular markers to provide selection criteria for quantitative traits was first proposed by [<xref rid="pone.0222733.ref001" ref-type="bibr">1</xref>]. They introduced a theory for optimizing weights to be given to each marker associated with a QTL, and they demonstrated that this index was at least as efficient as the phenotypic score for the genetic improvement of a population by truncation selection. This marker-assisted-selection (MAS) approach used only markers which had been previously associated with a QTL through statistical analysis. Therefore, the number of markers remained limited, and their effects were usually estimated by solving the linear model equations. The efficiency of MAS versus phenotypic selection is higher when the trait has a low heritability, the population size is large and the QTLs explain a large proportion of the trait variation. It was shown that the use of this marker index would facilitate early selection, bypassing a trait evaluation step and thereby shortening selection cycles [<xref rid="pone.0222733.ref002" ref-type="bibr">2</xref>]. Consequently the genetic gain per cycle would increase. However, QTL detection is often limited in practice by experimental power, particularly by the size of the studied population, and QTL with small effects often remain undetected. Therefore, this “missing heritability” can reduce the efficiency of MAS. Subsequent studies have shown that MAS efficiency is improved when more QTLs with small effects are included [<xref rid="pone.0222733.ref003" ref-type="bibr">3</xref>–<xref rid="pone.0222733.ref004" ref-type="bibr">4</xref>], and this implied relaxing the stringency threshold of significance to allow more true QTLs being detected, despite the risk of having some false positive ones being included. Extending this reasoning, it was proposed to include all markers in the selection index, thus bypassing the QTL identification step [<xref rid="pone.0222733.ref005" ref-type="bibr">5</xref>]. As the number of markers is generally larger than the number of phenotypic observations, classical fixed effects regression are intractable (P&gt;&gt;N problem). Therefore, [<xref rid="pone.0222733.ref005" ref-type="bibr">5</xref>] suggested using ridge regression models to overcome this over-parameterization problem. Soon after, [<xref rid="pone.0222733.ref006" ref-type="bibr">6</xref>] applied ridge and Bayesian regression models to animal populations for predicting breeding values, and called this approach Genomic Selection (GS). Marker effects are first estimated from the genotypic and phenotypic data in a training population. Then marker effects are used to predict breeding values in the target population with only genotypic data, and selections are based on these Genomic Estimates of Breeding Values (GEBV). This method has been used successfully for dairy cow breeding [<xref rid="pone.0222733.ref007" ref-type="bibr">7</xref>]. Indeed, in the case of dairy cow breeding (and particularly for bulls), the advantages of GS over classical breeding are obvious. 1) genotyping is much cheaper (a few 10s US$ for the 55K SNP bovine chip) than progeny testing (since bulls do not give milk), 2) genotyping can be done at birth time, while progeny testing requires &gt;7–8 years (until bulls give daughters and daughters give milk). Therefore GS of dairy bulls allowed early selection on a larger population, thus leading to nearly doubling the genetic gain per unit of time while the costs of proving bulls were reduced by 92% [<xref rid="pone.0222733.ref008" ref-type="bibr">8</xref>].</p>
    <p>To benefit from shorter cycles and increasing selection intensity, the genetic gain per cycle should be close to that expected from phenotypic selection (PS). This relative efficiency of GS vs PS thus relies on the ability of predicting the observed genetic value from the marker genotype. GEBV predictive ability is usually measured by the correlation between the predicted and observed values. Most reported studies on GS in plants have focused on measuring the accuracy of genomic predictions, usually assessed by cross-validation techniques [<xref rid="pone.0222733.ref009" ref-type="bibr">9</xref>–<xref rid="pone.0222733.ref014" ref-type="bibr">14</xref>].</p>
    <p>In the native theory, all available markers should be used without prior selection, since the statistical models were supposed to cope with the big data problem and avoid over parametrization. However, with the advance of molecular biology, the number of markers, e.g. single nucleotide polymorphisms (SNP), can be extremely high (up to some millions), particularly when compared to a few hundreds or thousands phenotypic observations. In this case, it seems reasonable to limit the number of markers to avoid too high over parametrization or over-representation of non-informative genomic regions, as well as speeding up computation. For example, one may wish to discard markers when they are in complete (or nearly complete) LD with another, thus bringing the very same information, or selecting markers which are evenly spaced, either physically or genetically, along the genome map. Since LD is related to (historical) recombination, genetic distance seems to be more suited, whenever available, for selecting markers than physical distance.</p>
    <p>Molecular data often contain missing value, particularly with the so-called genotyping-by-sequencing (GBS), likely because the fraction of the genome which is re-sequenced is not exactly the same from one individual to another [<xref rid="pone.0222733.ref015" ref-type="bibr">15</xref>]. Most prediction models do not accept missing data, therefore an imputation step is necessary to replace missing values, and various methods have been proposed to achieve the best guess (e.g. fastphase [<xref rid="pone.0222733.ref016" ref-type="bibr">16</xref>]).</p>
    <p>Finally, imputed data of (possibly selected) markers are used to predict GEBV using phenotypic observation in a training population. Several methods have been proposed to achieve GEBV prediction. They can be classified into parametric vs semi-parametric methods [<xref rid="pone.0222733.ref017" ref-type="bibr">17</xref>]. In the R environment [<xref rid="pone.0222733.ref018" ref-type="bibr">18</xref>], which is often used in research, several libraries have been specifically developed for genomic selection, such as BGLR [<xref rid="pone.0222733.ref019" ref-type="bibr">19</xref>] or rr-BLUP [<xref rid="pone.0222733.ref020" ref-type="bibr">20</xref>]. However, few of these packages proposes functions to successively achieve the three described steps of marker selection, genotype imputation and model prediction.</p>
    <p>The objectives of this manuscript are 1) to describe an integrated software (pipeline) which has been developed from open-source R functions available in various R libraries to enable the three steps to be performed easily and 2) to present an application of this software to carry out genomic predictions using historical data from a bread wheat breeding programme.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>The BWGS pipeline</title>
      <p>In the framework of the French flagship programme BreedWheat (<ext-link ext-link-type="uri" xlink:href="http://www.breedwheat.fr/">www.breedwheat.fr</ext-link>), we developed an integrated pipeline based on R [<xref rid="pone.0222733.ref018" ref-type="bibr">18</xref>] called BWGS (BreedWheat Genomic Selection pipeline). BWGS comprises three modules: 1) missing data imputation, 2) dimension reduction, for reducing the number of markers and/or training individuals and 3) Genomic Estimation of Breeding Values (GEBV) with a choice among 15 parametric and non-parametric methods.</p>
      <p>The pipeline comprises two “main” functions (<xref ref-type="fig" rid="pone.0222733.g001">Fig 1</xref>)</p>
      <fig id="pone.0222733.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0222733.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Workflow of the two main functions of BWGS.</title>
          <p>Bwgs.cv does model cross-validation on a training set and bwgs.predict does model calibration on a training set and GEBV prediction of a target set of genotypes. MAF = Minor Allele Frequency, maxNA = maximum % of marker missing data.</p>
        </caption>
        <graphic xlink:href="pone.0222733.g001"/>
      </fig>
      <p>The first function called bwgs.cv is using both genotyping and phenotyping data from a “training” set or reference population to carry on model calibration and cross validation. Data are randomly split into n “folds”, and n-1 folds are used for training models and predicting the n<sup>th</sup> one. Computation can be replicated p times, and correlation between GEBV and observed trait are computed for each fold and each replicate, enabling estimates of average and standard deviation of predictive ability (see [<xref rid="pone.0222733.ref021" ref-type="bibr">21</xref>]).</p>
      <p>Once the “best” model has been chosen based on quality assessment, a second function, named bwgs.predict is used to build the BEST model using the whole training set (genotyping + phenotyping), then apply the model to the genotyping data of the target population to get GEBV of these new genotypes.</p>
      <p>Candidate lines of the target population can then be ranked according to GEBV for single trait (truncation) selection.</p>
      <p>Going into more details of the pipeline, the workflow comprises three main steps:</p>
      <list list-type="order">
        <list-item>
          <p>A step of (missing) genotyping data imputation. This option can be useful for sources of genotyping data such as GBS. The following options are available:
<list list-type="bullet"><list-item><p>MNI: missing data are replaced by the mean allele frequency of the given marker. This imputation method is only suited when there are a few missing values, typically in marker data from SNP chips or KasPAR.</p></list-item><list-item><p>EMI: missing data are replaced using an expectation-maximization methods described in function A.mat of R-package rrBLUP [<xref rid="pone.0222733.ref020" ref-type="bibr">20</xref>]. This algorithm was specially designed by Poland et al (2012) for the use of GBS markers, which usually give many missing data which are roughly evenly distributed. However, it does not use physical map position, as do other more sophisticated software (e.g. Beagles, [<xref rid="pone.0222733.ref022" ref-type="bibr">22</xref>]). For imputing low density genotyping of a large population to high density available for only a subpopulation, i.e. many markers with many missing data, such software should be used before BWGS.</p></list-item></list></p>
        </list-item>
        <list-item>
          <p>A step of dimension reduction, i.e. reducing the number of markers. This reduction could be necessary to speed up computation on large datasets, depending on computer resources available. The following methods are available
<list list-type="bullet"><list-item><p>RMR: Random sampling (without replacement) of a subset of markers. To be used with the parameter “reduct.marker.size”.</p></list-item><list-item><p>LD (with r2 and MAP): enables “pruning” of markers which are in LD &gt; r2. Only the marker with the least missing values is kept for each pair in LD&gt;r2. To allow faster computation, r2 is estimated chromosome by chromosome, so a MAP file is required with information of marker assignation to chromosomes. The MAP file should contain at least three columns: marker_name, chromosome_name and distance_from_origin (either genetic of physical distance, only used for sorting markers, LD being re-estimated from marker Data).</p></list-item><list-item><p>ANO (with pval): one-way ANOVA are carried out with R function lm on trait “pheno” Every markers are tested one at a time, and only markers with pvalue&lt;pval are kept for GEBV prediction</p></list-item><list-item><p>ANO+LD (with pval and r2, MAP is facultative): combines a first step of marker selection with ANO, then a second step of pruning using LD option.</p><p>For research or teaching purposes, an option for randomly sampling individuals has been added, although it is little useful in practical breeding applications. Options for selecting a subset of the training population are:</p></list-item><list-item><p>RANDOM: a subset of sample.pop.size is randomly selected for training the model, and the unselected part of the population is used for validation. The process is repeated nFolds * nTimes to have the same number of replicates than with cross-validation.</p></list-item><list-item><p>OPTI: the optimization algorithm based on CDmean [<xref rid="pone.0222733.ref023" ref-type="bibr">23</xref>] to select a subset which maximizes average CD (coefficient of determination) in the validation set. Since the process is long and has some stochastic components, it is repeated only nTimes.</p></list-item></list></p>
        </list-item>
        <list-item>
          <p>A step of model building and cross validation.</p>
        </list-item>
      </list>
      <p>In the general case of genomic selection, the number of explanatory variables, <italic>i</italic>.<italic>e</italic>. markers, (largely) exceeds the number of observations, making the classical linear model equation unsolvable. In a review, [<xref rid="pone.0222733.ref024" ref-type="bibr">24</xref>] classified most of the methods that have been proposed to overcome this “big data” problem, into penalized regression (to make them solvable) or semi-parametric methods. Moreover, regression can be solved either analytically as in ridge regression (equivalent to G-BLUP) or iteratively though Bayesian computations. Bayesian methods can differ by the prior density distribution of marker effects, which can be modified boundlessly. In their review [<xref rid="pone.0222733.ref024" ref-type="bibr">24</xref>] describe the main features (e.g. prior…) for 13 methods.</p>
      <p>The options available for genomic breeding value prediction are:</p>
      <list list-type="bullet">
        <list-item>
          <p>GBLUP: performs G-BLUP using a marker-based relationship matrix, implemented through rrBLUP R-library. Equivalent to ridge regression (RR-BLUP) of marker effects.</p>
        </list-item>
        <list-item>
          <p>EGBLUP: performs EG-BLUP, i.e. BLUP using a “squared” relationship matrix to model epistatic 2x2 interactions, as described by [<xref rid="pone.0222733.ref025" ref-type="bibr">25</xref>] using the BGLR library</p>
        </list-item>
        <list-item>
          <p>RR: ridge regression, using package glmnet [<xref rid="pone.0222733.ref026" ref-type="bibr">26</xref>]. In theory, strictly equivalent to GBLUP.</p>
        </list-item>
        <list-item>
          <p>LASSO: Least Absolute Shrinkage and Selection Operator is another penalized regression methods which yield more shrinked estimates than RR. Run by glmnet library.</p>
        </list-item>
        <list-item>
          <p>EN: Elastic Net [<xref rid="pone.0222733.ref027" ref-type="bibr">27</xref>] which is a weighted combination of RR and LASSO, using glmnet library</p>
        </list-item>
      </list>
      <p>Several Bayesian methods, using the BGLR library</p>
      <list list-type="bullet">
        <list-item>
          <p>BRR: Bayesian ridge regression: same as rr-blup, but Bayesian resolution. Induces homogeneous shrinkage of all markers effects towards zero with Gaussian distribution [<xref rid="pone.0222733.ref024" ref-type="bibr">24</xref>].</p>
        </list-item>
        <list-item>
          <p>BL: Bayesian LASSO: uses an exponential prior on marker variances priors, leading to double exponential distribution of marker effects [<xref rid="pone.0222733.ref028" ref-type="bibr">28</xref>].</p>
        </list-item>
        <list-item>
          <p>BA: Bayes A uses a scaled-t prior distribution of marker effects [<xref rid="pone.0222733.ref006" ref-type="bibr">6</xref>].</p>
        </list-item>
        <list-item>
          <p>BB: Bayes B, uses a mixture of distribution with a point mass at zero and with a slab of non-zero marker effects with a scaled-t distribution [<xref rid="pone.0222733.ref029" ref-type="bibr">29</xref>].</p>
        </list-item>
        <list-item>
          <p>BC: Bayes C same as Bayes B with Gaussian a distribution for non-zero marker effects[<xref rid="pone.0222733.ref019" ref-type="bibr">19</xref>]</p>
        </list-item>
      </list>
      <p>A more detailed description of these methods can be found in the documentation of R-library “BGLR Bayesian Generalized Linear Regression” (<ext-link ext-link-type="uri" xlink:href="http://genomics.cimmyt.org/BGLR-extdoc.pdf">http://genomics.cimmyt.org/BGLR-extdoc.pdf</ext-link>.) and in [<xref rid="pone.0222733.ref019" ref-type="bibr">19</xref>]</p>
      <p>Four semi-parametric methods</p>
      <list list-type="bullet">
        <list-item>
          <p>RKHS: reproductive kernel Hilbert space and multiple kernel MRKHS, using BGLR [<xref rid="pone.0222733.ref030" ref-type="bibr">30</xref>–<xref rid="pone.0222733.ref031" ref-type="bibr">31</xref>]. Based on genetic distance and a kernel function to regulate the distribution of marker effects. This methods is claimed to be effective for detecting non additive effects.</p>
        </list-item>
        <list-item>
          <p>RF: Random forest regression, using randomForest library [<xref rid="pone.0222733.ref032" ref-type="bibr">32</xref>]. This method uses regression models on tree nodes which are rooted in bootstrapping data. Supposed to be able to capture interactions between markers.</p>
        </list-item>
        <list-item>
          <p>SVM: support vector machine, run by e1071 library. For details, see LIBSVM: a library for Support Vector Machines <ext-link ext-link-type="uri" xlink:href="https://www.csie.ntu.edu.tw/~cjlin/papers/libsvm.pdf">https://www.csie.ntu.edu.tw/~cjlin/papers/libsvm.pdf</ext-link></p>
        </list-item>
        <list-item>
          <p>BRNN: Bayesian Regularization for feed-forward Neural Network, with the R-package BRNN [<xref rid="pone.0222733.ref033" ref-type="bibr">33</xref>]. To keep computing time in reasonable limits, the parameters for the brnn function are neurons = 2 and epochs = 20.</p>
        </list-item>
      </list>
      <p>The criteria used to estimate model’s quality are 1) the Pearson correlation between adjusted phenotype and GEBV, computed over the whole data set (i.e. by merging the GEBV values from the nFolds to correlate with the whole vector of observed phenotypes) and 2) the square-root of the mean-squared error of prediction RMSEP. These criteria are provided for each replicate (nTimes) as well as mean and standard deviation over replicates. A table summarizes phenotype, estimated breeding value and its standard deviation, as well as the reliatibility for each individual GEBV computed as REL = 1-PEV/σ²g, where PEV is the prediction error variance for each individual and σ²g the genetic variance when the package used does provide estimate of prediction error variance of individual GEBV, as it is the case for BGLR.</p>
    </sec>
    <sec id="sec004">
      <title>Application to real wheat breeding: Plant materials and phenotypic data</title>
      <p>A training population was built by gathering historical data from the INRA-Agri-Obtentions breeding programme. To obtain robust phenotypes, we kept data from lines which have been evaluated in multisite trials (&gt; 6 locations), usually for 1–2 years. They were developed from inbred lines crosses, followed by 6–8 generations of self-pollination. Few selection is made during the first 3 generations (i.e. F2 to F4), which are harvested in bulk, then visual selection on simple traits is made on plants or rows at generations F4 and F5. Selected F5 families are multiplied in field plots, which allow a rough evaluation of yield. Then enough seeds are available and selected lines are put into the evaluation network, usually at the F7 generation, when breeding lines are nearly homozygous. Typically, about 300–400 pair crosses are made each year, 120–150 F7 lines are put into first year multisite trials, then 50–60 are evaluated for a second year, and the very happy few (1–3) are then entering the official registration trials in France, to hopefully become a commercial variety, 10–12 years after the initial crosses. On the whole, our database for field data had 77,176 records on 1715 genotypes, <italic>i</italic>.<italic>e</italic>. on average 45 single plot measurements per genotype, spread over 15 years (2000–2014), 10 locations in France and two managements (high <italic>vs</italic> low inputs). Of course these data are highly unbalanced, most genotypes being evaluated during one or two successive years, (on average 1.5 years) in 7.60 environments (site x year) with usually two replicates by management, and most connections in the design are between two successive years, with a few control varieties (usually four in each trial) being evaluated on a longer period to allow a higher connectivity in the dataset. These figures are for grain yield, the most documented trait. The whole dataset is described in [<xref rid="pone.0222733.ref034" ref-type="bibr">34</xref>] and is provided as supplementary Tab 1. To illustrate the use of BWGS, we will concentrate on grain yield in high input management, i.e. an estimate of the genetic and climatic potential in each environment.</p>
      <p>These highly unbalanced raw data require a pre-treatment step to correct for non-genetic factors as much as possible. The following mixed model was applied to estimate “corrected” genotypic means (BLUE) using the mixed model in R (library lme4):</p>
      <p>Y = lmer (yield~geno + (1|year*site:trial:block) + (1|year*site*geno)), where * stands for crossed factors (Year*site define environments) and: stands for nested effects, e.g. block within trial within year*site.</p>
      <p>Where geno being the main genotypic effect (fixed) and all other effects being considered as random effects to be corrected for. Note that these genotypic “BLUE” are highly correlated (r = 0.94) with BLUP estimates (<italic>i</italic>.<italic>e</italic>. when genotypes are also considered as random effects with identity matrix for modelling covariances). But BLUE are not shrinked, and thus can be more easily used in a second step involving mixed modelling.</p>
      <p>The same model with geno as random effect was used to estimate variance components and rough estimate of broad sense heritability as σ²<sub>g</sub> / (σ²<sub>g</sub> + σ²<sub>ge</sub> /nenv + σ²<sub>e</sub> /nplot) σ</p>
      <p>Where σ²<sub>g</sub> is the genotypic variance component, σ²<sub>ge</sub> is the GxE variance component (i.e. year*site*geno) and σ²<sub>e</sub> is the residual variance. nenv is the average number of environments per genotype and nplot the average number of plots per genotype in the dataset used.</p>
      <p>Out of these “HQ-phenotyped” lines, 760 were also genotyped with the TaBW280K SNP chip [<xref rid="pone.0222733.ref035" ref-type="bibr">35</xref>] and used for testing BWGS. After quality check, a matrix of 188,406 high quality, polymorphic markers was finally used. To illustrate BWGS pipeline, we used a subset of 60,912 markers with consolidated map position.</p>
      <p>Cross validation used randomly sampled 90% of the genotypes as the training set and the remaining 10% genotypes as the “validation set”. The resampling process was iterated 100 times to estimate an empirical mean and standard deviation. Since the true breeding value was unknown, predictive ability (PA) was measured by the Pearson correlation between GEBVs and the adjusted phenotypic values (BLUE) across all folds, i.e. the Hold accuracy, which is supposed to be less biased that a fold-by-fold estimate [<xref rid="pone.0222733.ref036" ref-type="bibr">36</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec005">
    <title>Results</title>
    <sec id="sec006">
      <title>Summary statistics of the breeding population</title>
      <p>Genotypic data have been used to estimate the additive relationships matrix according to [<xref rid="pone.0222733.ref037" ref-type="bibr">37</xref>] with the A.mat function of the R package rrblup. After scaling on a 0–1 scale (1 on diagonal), the values can be regarded as estimates of coancestry coefficients, whose distribution is shown in <xref ref-type="fig" rid="pone.0222733.g002">Fig 2A</xref>. Omitting the diagonal, coanscestry coefficients range between 0.05 and 0.5, with a median around 0.18. The heat map of <xref ref-type="fig" rid="pone.0222733.g002">Fig 2B</xref> displays no clear-cut structure into distinct groups, although some groups along the diagonal are made of lines that are more related than average. Such absence of structure fully justifies the use of random sampling cross-validation, while a stratified sampling should be used if structure was present. A plot of principal component analysis of Euclidian distance matrix among the 760 lines (<xref ref-type="fig" rid="pone.0222733.g002">Fig 2C</xref>, R command cmdscale) again does not show any clear structure according to the year of first evaluation, thereby justifying again the use of random cross-validation over years.</p>
      <fig id="pone.0222733.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0222733.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <p>Histogram (a), heat map (b) and PCA plot (c) of the scaled coefficient of coancestry between the 760 breeding. In Fig 2B, colours scale 0–1 as expected for coancestry coefficients. In Fig 2C, x-y-axes are in arbitratry units and Yx represents the year of first evaluation of a given line.</p>
        </caption>
        <graphic xlink:href="pone.0222733.g002"/>
      </fig>
    </sec>
    <sec id="sec007">
      <title>Imputation of missing data</title>
      <p>The first step of data cleaning with MAF = 5% and maximum marker missing data = 20% led to retain 47,839 markers out of 60,912. Since adjusted Yield BLUE were complete for the 760 genotypes, the final dimension of geno matrix was 760 x 47,839. This SNP dataset contained on average 0.93% of missing data. Given the small proportion of missing data, no difference in predictive ability was observed between the two imputation methods. To test the efficiency of imputation methods on prediction accuracy, we generated new genotypic matrices with 20%, 40%; 60% and 80% of missing data, randomly distributed in the dataset. Imputation by mean allele frequency took a few seconds, while imputation by the EM algorithm of A.mat took around 100 times longer, whatever the proportion of missing data. Predictive ability for grain yield from imputed dataset using the two methods is presented in <xref ref-type="fig" rid="pone.0222733.g003">Fig 3</xref>. The two methods give similar results for up to 20% missing Data, then imputation by EMI allows higher predictive abilities than imputation by the mean allele frequency. When 80% missing data are randomly generated, the predictive ability of EMI-imputed set is still 0.418, while it drops to 0.329 with the MNI-imputed set.</p>
      <fig id="pone.0222733.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0222733.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Predictive ability of GBLUP as a function of % of randomly generated missing data, with two imputation methods 1) mean allele frequency or 2) expectation-maximization (EM in A.mat function of rrBLUP library).</title>
        </caption>
        <graphic xlink:href="pone.0222733.g003"/>
      </fig>
    </sec>
    <sec id="sec008">
      <title>Effects of sampling markers</title>
      <p><xref rid="pone.0222733.t001" ref-type="table">Table 1</xref> shows the number of markers selected by either one-way ANOVA at different pvalue thresholds, or by pruning markers with LD &gt; threshold values from 0.5 to 0.98. For ANOVA selection, two strategies have been used, namely 1) GWAS was carried out only once using the whole dataset, i.e. training + validation lines and 2) GWAS was carried out using training lines only, i.e. within each time x fold replicate. Predictive abilities achieved with the selected marker subsets are also shown in <xref rid="pone.0222733.t001" ref-type="table">Table 1</xref>.</p>
      <p>Results are also displayed in <xref ref-type="fig" rid="pone.0222733.g004">Fig 4</xref>.</p>
      <fig id="pone.0222733.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0222733.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Predictive ability as a function of marker number selected either 1) randomly, 2) by GWAS in the training set within each replicate* fold, 3) by GWAS on the entire population and 4) by LD-pruning.</title>
        </caption>
        <graphic xlink:href="pone.0222733.g004"/>
      </fig>
      <table-wrap id="pone.0222733.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0222733.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Number of markers and predictive abilities achieved with marker subset from 1) random selection (RMR option); 2) GWAS on whole marker set (option ANO); 3) GWAS on training set only (not included) and 4) LD-pruning.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0222733.t001g" xlink:href="pone.0222733.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" colspan="2" rowspan="1">random selection</th>
                <th align="center" rowspan="1" colspan="1">GWAS</th>
                <th align="center" rowspan="1" colspan="1"> </th>
                <th align="center" rowspan="1" colspan="1">GWAS whole set</th>
                <th align="center" rowspan="1" colspan="1">GWAS training set</th>
                <th align="center" colspan="2" rowspan="1">LD prunning</th>
                <th align="center" rowspan="1" colspan="1"> </th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">Nb markers</th>
                <th align="center" rowspan="1" colspan="1">Pred ability</th>
                <th align="left" rowspan="1" colspan="1">Pvalue</th>
                <th align="center" rowspan="1" colspan="1">Nb markers</th>
                <th align="center" rowspan="1" colspan="1">Pred ability</th>
                <th align="center" rowspan="1" colspan="1">Pred ability</th>
                <th align="center" rowspan="1" colspan="1">LD_threshold</th>
                <th align="center" rowspan="1" colspan="1">Nb markers</th>
                <th align="center" rowspan="1" colspan="1">Pred ability</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">47739</td>
                <td align="center" rowspan="1" colspan="1">0.525</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="center" rowspan="1" colspan="1">47839</td>
                <td align="center" rowspan="1" colspan="1">0.526</td>
                <td align="center" rowspan="1" colspan="1">0.526</td>
                <td align="center" rowspan="1" colspan="1"> </td>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1"> </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">25000</td>
                <td align="center" rowspan="1" colspan="1">0.52</td>
                <td align="left" rowspan="1" colspan="1">0.05</td>
                <td align="center" rowspan="1" colspan="1">14390</td>
                <td align="center" rowspan="1" colspan="1">0.573</td>
                <td align="center" rowspan="1" colspan="1">0.528</td>
                <td align="center" rowspan="1" colspan="1">0.98</td>
                <td align="center" rowspan="1" colspan="1">15773</td>
                <td align="center" rowspan="1" colspan="1">0.538</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">10000</td>
                <td align="center" rowspan="1" colspan="1">0.515</td>
                <td align="left" rowspan="1" colspan="1">0.01</td>
                <td align="center" rowspan="1" colspan="1">8325</td>
                <td align="center" rowspan="1" colspan="1">0.579</td>
                <td align="center" rowspan="1" colspan="1">0.529</td>
                <td align="center" rowspan="1" colspan="1">0.95</td>
                <td align="center" rowspan="1" colspan="1">9297</td>
                <td align="center" rowspan="1" colspan="1">0.541</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">5000</td>
                <td align="center" rowspan="1" colspan="1">0.514</td>
                <td align="left" rowspan="1" colspan="1">0.001</td>
                <td align="center" rowspan="1" colspan="1">4000</td>
                <td align="center" rowspan="1" colspan="1">0.596</td>
                <td align="center" rowspan="1" colspan="1">0.519</td>
                <td align="center" rowspan="1" colspan="1">0.9</td>
                <td align="center" rowspan="1" colspan="1">6661</td>
                <td align="center" rowspan="1" colspan="1">0.54</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">2000</td>
                <td align="center" rowspan="1" colspan="1">0.505</td>
                <td align="left" rowspan="1" colspan="1">0.0001</td>
                <td align="center" rowspan="1" colspan="1">1820</td>
                <td align="center" rowspan="1" colspan="1">0.614</td>
                <td align="center" rowspan="1" colspan="1">0.515</td>
                <td align="center" rowspan="1" colspan="1">0.8</td>
                <td align="center" rowspan="1" colspan="1">4462</td>
                <td align="center" rowspan="1" colspan="1">0.544</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">1000</td>
                <td align="center" rowspan="1" colspan="1">0.493</td>
                <td align="left" rowspan="1" colspan="1">0.00001</td>
                <td align="center" rowspan="1" colspan="1">806</td>
                <td align="center" rowspan="1" colspan="1">0.576</td>
                <td align="center" rowspan="1" colspan="1">0.473</td>
                <td align="center" rowspan="1" colspan="1">0.7</td>
                <td align="center" rowspan="1" colspan="1">3234</td>
                <td align="center" rowspan="1" colspan="1">0.536</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">500</td>
                <td align="center" rowspan="1" colspan="1">0.447</td>
                <td align="left" rowspan="1" colspan="1">0.000001</td>
                <td align="center" rowspan="1" colspan="1">323</td>
                <td align="center" rowspan="1" colspan="1">0.551</td>
                <td align="center" rowspan="1" colspan="1">0.438</td>
                <td align="center" rowspan="1" colspan="1">0.6</td>
                <td align="center" rowspan="1" colspan="1">2376</td>
                <td align="center" rowspan="1" colspan="1">0.527</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">200</td>
                <td align="center" rowspan="1" colspan="1">0.392</td>
                <td align="left" rowspan="1" colspan="1"> </td>
                <td align="center" rowspan="1" colspan="1"> </td>
                <td align="center" rowspan="1" colspan="1"> </td>
                <td align="center" rowspan="1" colspan="1"> </td>
                <td align="center" rowspan="1" colspan="1">0.5</td>
                <td align="center" rowspan="1" colspan="1">1704</td>
                <td align="center" rowspan="1" colspan="1">0.521</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">100</td>
                <td align="center" rowspan="1" colspan="1">0.299</td>
                <td align="left" rowspan="1" colspan="1"> </td>
                <td align="center" rowspan="1" colspan="1"> </td>
                <td align="center" rowspan="1" colspan="1"> </td>
                <td align="center" rowspan="1" colspan="1"> </td>
                <td align="center" rowspan="1" colspan="1"> </td>
                <td align="center" rowspan="1" colspan="1"> </td>
                <td align="center" rowspan="1" colspan="1"> </td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>As expected, predictive ability increases with the number of randomly sampled markers, with a steady plateau above around 5000 markers and a best predictive ability of 0.525. This clearly shows that the extent of LD is large enough in such elite breeding lines to allow most QTLs for yield being captured with 5000–10000 markers, i.e. on average one every 1.7 Mbase. This is illustrated by marker selection based on LD-pruning, i.e. removing markers which are in LD &gt; threshold with any other marker. The marker with the least number of missing value is conserved, otherwise the choice is random. The highest value of 0.544 is obtained with 4462 markers with pairwise LD &gt;0.8. When marker selection is based on ANOVA carried out on the entire population, there is an optimum predictive ability of 0.614 achieved with 1820 markers (pvalue = 0.0001). However, these results were only found when marker selection is made only once by association analysis on the whole dataset, which is then split into a training and a validation set. When marker selection is made within the loop only in the training set, then the predictive ability of the validation set is only slightly improved for N = 2000 and 5000 markers, compared to random sampling, but never exceeds the predictive ability achieved with the whole set of markers. This clearly illustrates that overfitting does occur in the first case.</p>
    </sec>
    <sec id="sec009">
      <title>Effect of different calibration set sampling strategies on predictive ability</title>
      <p>For this study, we used the whole set of 47,839 markers; which gave a predictive ability of 0.525 in 10-fold cross validation using the complete dataset of 760 breeding lines, i.e. with a training set of 684 lines and a validation set of 76 lines. Predictive ability was estimated with GBLUP using calibration set of size CS = 50, 100, 200, 300, 400, 500, 600 and 700, validation being made using the remaining lines. <xref ref-type="fig" rid="pone.0222733.g005">Fig 5</xref> shows the increase of both predictive ability and computing time as the size of training set increases. Computing time is given as the proportion of that needed for 100 replicates x 10 folds with TS = 700, which was roughly 60 minutes. As expected, predictive ability does increase with the size of calibration set, while its variability decreases, with the notable exception of TS = 700. This may be due to the small size of the validation set, which is only 76 with TS = 700, making correlations between phenotype and GEBV more erratic than those observed with larger validation sets.</p>
      <fig id="pone.0222733.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0222733.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Distribution of predictive ability according to the size of randomly selected training population and relative computing time.</title>
        </caption>
        <graphic xlink:href="pone.0222733.g005"/>
      </fig>
      <p>Two strategies were compared as illustrated in <xref ref-type="fig" rid="pone.0222733.g006">Fig 6</xref>: 1) the random sampling among the 760 lines as in <xref ref-type="fig" rid="pone.0222733.g005">Fig 5</xref> and 2) selecting an optimized subset with the CD-mean criteria as described by [<xref rid="pone.0222733.ref023" ref-type="bibr">23</xref>]. Although this algorithm should be deterministic and give always the same subset, some stochasticity remains in the drop-replacement procedures, which explains that predictive ability still have some residual variation as illustrated by the error-bar. <xref ref-type="fig" rid="pone.0222733.g006">Fig 6</xref> shows that the optimization algorithm does improve predictive ability for small-medium size of the training set compared to random sampling. as predicted by the theory and already reported [<xref rid="pone.0222733.ref023" ref-type="bibr">23</xref>]. This advantage disappears when the proportion of sampled individuals increases.</p>
      <fig id="pone.0222733.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0222733.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Predictive ability as a function of training population size selected either 1° randomly or 2) by the CD-mean optimization algorithm of [<xref rid="pone.0222733.ref023" ref-type="bibr">23</xref>].</title>
        </caption>
        <graphic xlink:href="pone.0222733.g006"/>
      </fig>
    </sec>
    <sec id="sec010">
      <title>Efficiency of various prediction methods</title>
      <p>With again the whole set of 47,839 markers, we used all prediction methods available in BWGS to estimate prediction accuracy in 100 independent 10-fold cross validations. Computing time varied considerably from one method to another, as illustrated in <xref ref-type="fig" rid="pone.0222733.g007">Fig 7</xref>. BRNN is, by far, the most demanding methods, with 2214 minutes (nearly 4 days) needed to carry out 100 replicates of 10-folds cross validation, while the least demanding is GBLUP with 28 minutes. Of course these values must be taken only for comparison, as they are highly dependent on the computer characteristics. Note that EGBLUP, which is an extension of GBLUP with epistatic interactions being modelled by the product of additive relationship matrix with itself, takes 344 minutes instead of 28. The other computationally intensive methods are multi-kernel RKHS (637 minutes) and random Forest RF (382 minutes).</p>
      <fig id="pone.0222733.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0222733.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Distribution of predictive ability of the 100 replicates for each of the 14 methods which worked correctly, average is in red and relative computing time in green line.</title>
        </caption>
        <graphic xlink:href="pone.0222733.g007"/>
      </fig>
      <p>In <xref ref-type="fig" rid="pone.0222733.g007">Fig 7</xref>, we discarded results from SVM methods, which gave very poor predictive ability (0.25), although in a reasonable time of 31 minutes. Predictive abilities of the other 14 methods range from 0.475 to 0.543, with no relationship with computing time, which can be considered as an estimate of method complexity. Note that the support vector machine SVM compared with other methods when 5000 random markers are used, but seemed to be unable to deal with 47,000 markers. LASSO and elastic net (from glmnet library) and BRNN give the worse predictive abilities around 0.48, while random forest regression RF gives the highest of 0.543, slightly above that of the reference GBLUP (0.525). Note that the three methods that outperform GBLUP are thought to take into account non additive marker effects. However, in this practical case of grain yield prediction, they did not show a dramatic advantage over GBLUP. BRNN is another model-free, machine learning method, often supposed to give more accurate prediction than linear regression methods. The relatively poor predictive ability observed in this study can be caused by insufficient computer resources allocated. Other parameterization (e.g. number of neurone layers, epochs…) may have given better predictive abilities.</p>
      <p>Perhaps as important as predictive ability is the consistency of GEBV estimated by different methods. <xref ref-type="fig" rid="pone.0222733.g008">Fig 8</xref> shows the correlation between GEBV (averaged over the 100 replicates) predicted by the 14 successful methods (omitting SVM). The minimum correlation of 0.85 is between random Forest and Bayesian ridge regression, while many pairwise correlation are close to 1. When omitting RF, which is the method whose prediction are least related to the others, all correlations are above 0.92, thus all methods can be considered as giving highly consistent prediction of GEBV.</p>
      <fig id="pone.0222733.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0222733.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Histograms, bi-plot and correlation values among predicted GEBV obtained with 14 methods.</title>
        </caption>
        <graphic xlink:href="pone.0222733.g008"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec011">
    <title>Discussion</title>
    <p>Genomic selection programmes are now routinely used in dairy cow breeding, and benefit from huge phenotypic data recorded in past years on milk production of thousands of females, usually related by well-known pedigree relationships (i.e. mother and father known without error). This is however not yet the case in other species like sheep, although effort are being developed in so-called minor species. Therefore, using a relatively cheap genotyping, dairy cow breeders usually have very large population for training GS models, which led to highly accurate predictions. In many animal studies, the oldest animals are used as training set and the youngest as validation set.</p>
    <p>Contrasting with animal breeding, most plant breeding programmes do not have very large population sizes, although each breeding company manipulates hundreds or thousands of candidates, since companies are usually reluctant to share and merge datasets. Breeding companies have developed in-house biostatistical tools for calculating GEBV with semi-automated pipeline, since time is often short between data production (e.g. grain harvest) and selection decision (e.g. sowing next generation). There are also several publically available tools which have been developed, particularly as R libraries. Among the most popular we can mention glmnet [<xref rid="pone.0222733.ref026" ref-type="bibr">26</xref>], BGLR [<xref rid="pone.0222733.ref019" ref-type="bibr">19</xref>], rrBLUP [<xref rid="pone.0222733.ref020" ref-type="bibr">20</xref>] or Synbreed [<xref rid="pone.0222733.ref038" ref-type="bibr">38</xref>]. Recently, integrative packages have been developed, which rely on existing public R-libraries. An example of such packages are G2P and the one presented here called BWGS. G2P [<xref rid="pone.0222733.ref039" ref-type="bibr">39</xref>] proposes 17 prediction methods from 10 R-libraries, among which BGLR, glmnet and randomForest as in BWGS. As BWGS, there are also two main functions, G2PCrossValidation and G2P to apply prediction model to a test set with only marker data. Compared to BWGS, G2P offers much more options for tuning parameters of the numerous functions/libraries called by the two main functions. As a drawback, handling G2P appears more complex, and its complete use requires reading the notices of original libraries, since the notice of G2P does not provide enough details on the possible parameters and options. Moreover, although G2P does content a quality control module, it is not directly integrated into the main function as in BWGS. Comparatively, in BWGS, we have chosen to fix most internal parameters with defaults values, which have been tested to be adapted for medium size datasets as provided in the example (47 K SNP, 760 training lines), while maintaining computing time into reasonable limits for desktop computers. It is therefore easy to use, especially for beginners, and of course parameters can be modified quite easily in the source code to adapt larger datasets.</p>
    <p>In our highly unbalanced breeder’s dataset, when discarding control lines which were regularly replicated over years, the average number of environment per studied lines is 10.4, with two replicates by environment (site x year). This led to an estimate of broad sense heritability of 0.76 and therefore a theoretical upward limit of prediction accuracy of 0.872. When using random cross validation and the whole set of 47,839 markers, the achieved predictive ability is 0.525, which would correspond to an accuracy of 0.603 according to formula in [<xref rid="pone.0222733.ref021" ref-type="bibr">21</xref>]. However we do not fully trust in this formula, since heritabilities are often poorly estimated. We do prefer keeping predictive ability as a criteria for comparing models and strategies.</p>
    <p>Our results compare with previously reported predictive ability estimated through random cross-validation, for example 0.36–0.53 [<xref rid="pone.0222733.ref040" ref-type="bibr">40</xref>] and 0.32–0.59 [<xref rid="pone.0222733.ref041" ref-type="bibr">41</xref>] for grain yield in bread wheat with training population of a few hundreds lines, and up to 0.65 with a training set of 2325 elite European wheat lines [<xref rid="pone.0222733.ref042" ref-type="bibr">42</xref>]. The use of random cross validation seems to be justified, since no clear-cut structure appears in the set of lines. In particular, lines put into trial in a given year are not more related with each other than with lines put into trails another year. Then the predictive ability obtained in random cross-validation should be valid for any other set of lines showing a similar degree of relatedness than within the training set.</p>
    <sec id="sec012">
      <title>Effect of marker density and training population size</title>
      <p>Although GS theory has been elaborated to cope with the over parameterization problem (number of markers &gt;&gt; number of observations), it empirically appears that adding more markers than needed does not improve predictive ability. This was already observed in many reports. Among other, a figure similar to our Fig 3 can be found in [<xref rid="pone.0222733.ref043" ref-type="bibr">43</xref>]. In this empirical study in maize, GS accuracy reach a plateau with 7000 randomly selected markers in a “natural” population, and with only 2000 markers in biparental populations. In a recent simulation study with high density coverage, the same authors even stated that the accuracy obtained using all SNPs can be easily achieved using only 0.5 to 1.0% of all markers [<xref rid="pone.0222733.ref044" ref-type="bibr">44</xref>]. This clearly illustrates that, once every QTL information is captured by one marker in LD, adding more markers is useless. This of course relates to the average linkage disequilibrium between adjacent markers. In our study, the material is made of hundreds of related families, each of small size, and the plateau is reached around 2000–5000 random markers, a value close to that observed for maize natural population, while [<xref rid="pone.0222733.ref045" ref-type="bibr">45</xref>] reported that 256 markers were enough to achieve maximum accuracy in wheat bi-parental populations. Similarly, in a population of 235 soybean varieties, predictive ability did not change much, whatever the number of markers (ranging 200–5200) and the way they were selected, either at random or one per haplotype block [<xref rid="pone.0222733.ref046" ref-type="bibr">46</xref>]. In a study of wheat breeding lines [<xref rid="pone.0222733.ref047" ref-type="bibr">47</xref>] found a plateau for predictive ability of yield around 2000 random markers as in the present study. Avoiding selection of markers pairs which are in high LD (LD-pruning) further improves predictive ability compare to random sampling. This was reported in a soybean study, in which the authors found a 4% increase of prediction accuracy when selecting markers from haplotype blocks rather than random or equidistant.</p>
      <p>Selecting markers that are significantly associated with QTLs can achieve higher predictive ability than randomly selected markers, and surprisingly even higher predictive ability than using all markers. However, it is clear from <xref ref-type="fig" rid="pone.0222733.g004">Fig 4</xref> that selecting markers from their Pvalue in GWAS carried out on the whole population; i.e. including validation lines, does led to overfitting and this approach must be avoided and cannot be used in practice. This was reported many times. For example, in a wheat study [<xref rid="pone.0222733.ref047" ref-type="bibr">47</xref>] selected markers by GWAS on the training set only, as we did also in <xref ref-type="fig" rid="pone.0222733.g004">Fig 4</xref>. However, they observed a gain in predictive ability of up to 0.2, particularly for very small number of markers (&lt;100), while we only had small improvement of about 0.01 with a maximum gain for 2000 markers. Nearly similar results were reported by [<xref rid="pone.0222733.ref048" ref-type="bibr">48</xref>].</p>
      <p>In theory, the prediction accuracy is positively related to the training population size, as established by simulation studies [<xref rid="pone.0222733.ref049" ref-type="bibr">49</xref>–<xref rid="pone.0222733.ref051" ref-type="bibr">51</xref>]. This was confirmed in many empirical studies such as those already mentioned [<xref rid="pone.0222733.ref042" ref-type="bibr">42</xref>, <xref rid="pone.0222733.ref046" ref-type="bibr">46</xref>, <xref rid="pone.0222733.ref047" ref-type="bibr">47</xref>]. As expected from the theory, optimizing a subset of training lines gave higher PA than random selection. This was confirmed in empirical studies [<xref rid="pone.0222733.ref023" ref-type="bibr">23</xref>] then [<xref rid="pone.0222733.ref052" ref-type="bibr">52</xref>–<xref rid="pone.0222733.ref053" ref-type="bibr">53</xref>] in the case of population structure. Their optimization algorithm uses a simulated annealing approach. Other optimization methods have been proposed, such as a genetic algorithm [<xref rid="pone.0222733.ref054" ref-type="bibr">54</xref>] and also led to higher PA for a given training size.</p>
    </sec>
    <sec id="sec013">
      <title>Effect of prediction method</title>
      <p>Prediction methods have been classified into parametric and non-parametric (or semi-parametic) methods, and parametric methods sometimes split into penalized approach and Bayesian approach (for reviews see [<xref rid="pone.0222733.ref017" ref-type="bibr">17</xref>] and [<xref rid="pone.0222733.ref055" ref-type="bibr">55</xref>–<xref rid="pone.0222733.ref057" ref-type="bibr">57</xref>]). In our study, most methods gave close values of predictive abilities, ranging 0.475–0.543, with the noticeable exception of SVM, which worked with up to 5000 markers but failed with the 47 K markers. Some methods seem to give poorer results, such as LASSO and EN (elastic net) from the glmnet library, and also BRNN. In this latter case it may be due to insufficient computer resources, who led us to use restrictive parameters (e.g. number of iterations, number of neurone layers…), thereby limiting performances of this highly demanding method. In any case predictive ability is not related to computing time, with the less demanding GBLUP ranking the fifth best method.</p>
      <p>Although there is no clear-cut separation between parametric vs non-parametric methods, nor between penalized vs Bayesian approach, it seems that methods that are supposed to better capture non additive and/or non-linear effects such as EGBLUP or RKHS gave higher PA, as already reported [<xref rid="pone.0222733.ref033" ref-type="bibr">33</xref>,<xref rid="pone.0222733.ref042" ref-type="bibr">42</xref>,<xref rid="pone.0222733.ref048" ref-type="bibr">48</xref>,<xref rid="pone.0222733.ref056" ref-type="bibr">56</xref>]. Low difference in predictive ability has already been reported by [<xref rid="pone.0222733.ref039" ref-type="bibr">39</xref>] who analysed three wheat populations for GEBV using 10 statistical models, with RKHS being the most accurate and Support Vector Machine the least accurate methods, as we also found in our study.</p>
      <p>In a simulation study, [<xref rid="pone.0222733.ref058" ref-type="bibr">58</xref>] showed that with 121 markers with additive effects, RKHS and radial basis neural network (close to our BRNN option) clearly out passed the linear Bayesian LASSO, but it was no longer the case when adding the 7260 interactions between markers. The authors stated that “adding non-signal predictors can adversely affect the predictive accuracy of the non-linear regression models”. Other studies have shown the interest of machine learning methods for genomic prediction [<xref rid="pone.0222733.ref059" ref-type="bibr">59</xref>–<xref rid="pone.0222733.ref060" ref-type="bibr">60</xref>]. In our study, this was not the case for RKHS, but for SVM and BRNN. It may have been better to choose the set of LD-pruning selected markers to optimize predictive ability of these methods.</p>
      <p>But perhaps more important than the predictive ability is to know whether the different methods give similar values or at least similar rankings of GEBV for candidates. Indeed correlations between predicted GEBV with the 15 methods range from 0.85 to nearly 1. The highest values being observed between linear parametric methods, whatever based on penalized regression or Bayesian approaches. Machine learning methods such as SVM and BRNN are least related to others, except with MKRKHS. Given the close values of both predictive abilities and GEBV estimates among methods, it seems reasonable to keep the historical GBLUP as a reference method, for its simplicity and fastness, at least for polygenic traits such as grain yield chosen to illustrate this study.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec014">
    <title>Conclusion</title>
    <p>The R pipeline we have developed is based on publically available libraries and therefore offers a full freedom to operate. It is easy to handle and allows a wide range of options for missing data imputation, marker or training set selection and prediction methods. Its parameterization was fixed for medium sized datasets to make it easy to use for beginners or teaching. Applying this tool with defaults parameters to a set of elite breeding lines with historical data from yield trials allowed us to obtain similar results to those reported on other wheat populations. The options for subsampling markers and/or training set enabled us to illustrate theoretical expectations (e.g. [<xref rid="pone.0222733.ref061" ref-type="bibr">61</xref>]). The predictive abilities obtained on this population of limited size are encouraging for the success of genomic selection in applied wheat breeding. Of course, BWGS does not deal with all challenges. It is now admitted that most methods give reasonably high accuracy, although recent studies claim that prediction accuracy could be improved with new alliances to share data across breeding programmes [<xref rid="pone.0222733.ref062" ref-type="bibr">62</xref>]. Rather, the challenges for future wheat breeding are 1) efficient implementation in real breeding schemes and/or adapting selection schemes with step(s) of GS (e.g.[<xref rid="pone.0222733.ref063" ref-type="bibr">63</xref>–<xref rid="pone.0222733.ref064" ref-type="bibr">64</xref>]), 2) prediction of GxE (e.g. [<xref rid="pone.0222733.ref065" ref-type="bibr">65</xref>]for review) and 3) incorporating multitrait selection (e.g. [<xref rid="pone.0222733.ref066" ref-type="bibr">66</xref>]).</p>
    <p>Future developments of BWGS are ongoing to address these challenges, particularly multitrait selection.</p>
    <p>The source code of BWGS R functions as well as example files and notice are freely available on <ext-link ext-link-type="uri" xlink:href="https://forgemia.inra.fr/umr-gdec/bwgs">https://forgemia.inra.fr/umr-gdec/bwgs</ext-link></p>
  </sec>
  <sec sec-type="supplementary-material" id="sec015">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0222733.s001">
      <label>S1 Data</label>
      <caption>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0222733.s001.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors wish to thank Hélène Rimbert and the Bioinformatics (SIBI) team of UMR-GDEC and well as the ForgeMIA team for submission of the required files to the public repository forgemia and their maintainance. <ext-link ext-link-type="uri" xlink:href="https://forgemia.inra.fr/umr-gdec/bwgs">https://forgemia.inra.fr/umr-gdec/bwgs</ext-link></p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0222733.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Lande</surname><given-names>R</given-names></name>, <name><surname>Thompson</surname><given-names>R</given-names></name> (<year>1990</year>) <article-title>Efficiency of Marker-AssistedSelection in the Improvement of Quantitative Traits</article-title>. <source>Genetics</source>
<volume>124</volume>:<fpage>743</fpage>–<lpage>756</lpage>
<?supplied-pmid 1968875?><pub-id pub-id-type="pmid">1968875</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Hospital</surname><given-names>F</given-names></name>, <name><surname>Moreau</surname><given-names>L</given-names></name>, <name><surname>Lacoudre</surname><given-names>F</given-names></name>, <name><surname>Charcosset</surname><given-names>A</given-names></name>, <name><surname>Gallais</surname><given-names>A</given-names></name> (<year>1997</year>) <article-title>More on the efficiency of marker-assisted selection</article-title>. <source>Theoretical and Applied Genetics</source>
<volume>95</volume>:<fpage>1181</fpage>–<lpage>1189</lpage></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Bernardo</surname><given-names>R</given-names></name>, <name><surname>Moreau</surname><given-names>L</given-names></name>, <name><surname>Charcosset</surname><given-names>A</given-names></name>. <article-title>Number and fitness of selected individuals in marker-assisted and phenotypic recurrent selection</article-title>. <source>Crop Sci</source><year>2006</year>;<volume>46</volume>: <fpage>1972</fpage>–<lpage>1980</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0222733.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Moreau</surname><given-names>L</given-names></name>, <name><surname>Charcosset</surname><given-names>A</given-names></name>, <name><surname>Hospital</surname><given-names>F</given-names></name>, <name><surname>Gallais</surname><given-names>A</given-names></name> (<year>1998</year>) <article-title>Marker-assisted selection efficiency in populations of finite size</article-title>. <source>Genetics</source>
<volume>148</volume>:<fpage>1353</fpage>–<lpage>1365</lpage>
<?supplied-pmid 9539448?><pub-id pub-id-type="pmid">9539448</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Whittaker</surname><given-names>J.C.</given-names></name>, <name><surname>R., Thompson</surname><given-names>M.C</given-names></name>. <name><surname>Denham</surname></name>. <year>2000</year><article-title>Marker-assisted selection using ridge regression</article-title>. <source>Genet. Res</source>. <volume>75</volume>:<fpage>249</fpage>–<lpage>252</lpage>. <pub-id pub-id-type="doi">10.1017/s0016672399004462</pub-id><?supplied-pmid 10816982?><pub-id pub-id-type="pmid">10816982</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Meuwissen</surname><given-names>THE</given-names></name>, <name><surname>Hayes</surname><given-names>B</given-names></name>, <name><surname>Goddard</surname><given-names>ME</given-names></name> (<year>2001</year>) <article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>; <source>Genetics</source>
<volume>157</volume>:<fpage>1819</fpage>–<lpage>1829</lpage>
<?supplied-pmid 11290733?><pub-id pub-id-type="pmid">11290733</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Goddard</surname><given-names>ME</given-names></name>, <name><surname>Hayes</surname><given-names>BJ</given-names></name> (<year>2007</year>) <article-title>Genomic selection</article-title>. <source>J Anim Breed Genet</source>
<volume>124</volume>:<fpage>323</fpage>–<lpage>330</lpage>. <pub-id pub-id-type="doi">10.1111/j.1439-0388.2007.00702.x</pub-id>
<?supplied-pmid 18076469?><pub-id pub-id-type="pmid">18076469</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Schaeffer</surname><given-names>L. R.</given-names></name> (<year>2006</year>) <article-title>Strategy for applying genome-wide selection in dairy cattle</article-title>. <source>Journal of Animal Breeding and Genetics</source>
<volume>123</volume>: <fpage>218</fpage>–<lpage>223</lpage>
<pub-id pub-id-type="doi">10.1111/j.1439-0388.2006.00595.x</pub-id>
<?supplied-pmid 16882088?><pub-id pub-id-type="pmid">16882088</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Bernardo</surname><given-names>R</given-names></name>, <name><surname>Yu</surname><given-names>JM</given-names></name>. <article-title>Prospects for genomewide selection for quantitative traits in maize</article-title>. <source>Crop Sci</source><year>2007</year>;<volume>47</volume>:<fpage>1082</fpage>–<lpage>1090</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0222733.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Heffner</surname><given-names>EL</given-names></name>, <name><surname>Sorrells</surname><given-names>ME</given-names></name>, <name><surname>Jannink</surname><given-names>JL</given-names></name> (<year>2009</year>) <article-title>Genomic Selection for Crop Improvement</article-title>. <source>Crop Science</source>
<volume>49</volume>:<fpage>1</fpage>–<lpage>12</lpage></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Crossa</surname><given-names>J</given-names></name>., <name><surname>de los Campos</surname><given-names>G</given-names></name>., <name><surname>Perez</surname><given-names>P</given-names></name>., <name><surname>Gianola</surname><given-names>D</given-names></name>., <name><surname>Burgueño</surname><given-names>J</given-names></name>., <name><surname>Araus</surname><given-names>J.L</given-names></name>., <etal>et al</etal><year>2010</year><article-title>Prediction of Genetic Values of Quantitative Traits in Plant Breeding Using Pedigree and Molecular Markers</article-title>. <source>Genetics</source><volume>186</volume>: <fpage>713</fpage>–<lpage>724</lpage><pub-id pub-id-type="doi">10.1534/genetics.110.118521</pub-id><?supplied-pmid 20813882?><pub-id pub-id-type="pmid">20813882</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Jannink</surname><given-names>J. L</given-names></name>; <name><surname>Lorenz</surname><given-names>A. J.</given-names></name>; <name><surname>Iwata</surname><given-names>H</given-names></name>. (<year>2010</year>) <article-title>Genomic selection in plant breeding: from theory to practice. Briefings in Functional Genomics &amp;</article-title><source>Proteomics</source><volume>9</volume>: <fpage>166</fpage>–<lpage>177</lpage></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Iwata</surname><given-names>H</given-names></name>.; <name><surname>Jannink</surname><given-names>J. L</given-names></name>. (<year>2011</year>) <article-title>Accuracy of genomic selection prediction in barley breeding programs: a simulation study based on the real single nucleotide polymorphism data of barley breeding lines</article-title>. <source>Crop Sci</source> 2011;<volume>51</volume>: <fpage>1915</fpage>–<lpage>1927</lpage></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Lorenz</surname><given-names>AJ</given-names></name>, <name><surname>Chao</surname><given-names>S</given-names></name>, <name><surname>Asoro</surname><given-names>FG</given-names></name>, <name><surname>Heffner</surname><given-names>EL</given-names></name>, <name><surname>Hayashi</surname><given-names>T</given-names></name>, <name><surname>Iwata</surname><given-names>H</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Genomic selection in plant breeding: knowledge and prospects</article-title>
<source>Adv Agron</source>
<volume>110</volume>, <fpage>77</fpage>–<lpage>123</lpage></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Poland</surname><given-names>J.</given-names></name>, <name><surname>Endelman</surname><given-names>J.B.</given-names></name>, <name><surname>Dawson</surname><given-names>J.</given-names></name>, <name><surname>Rutkoski</surname><given-names>J.E.</given-names></name>, <name><surname>Wu</surname><given-names>S.</given-names></name>, <name><surname>Manès</surname><given-names>Y.</given-names></name>, <etal>et al</etal> (<year>2012</year>). <article-title>Genomic Selection in Wheat Breeding using Genotyping-by-Sequencing</article-title>. <source>The Plant Genome</source> 2012;<volume>5</volume>:<fpage>103</fpage>–<lpage>113</lpage>. <pub-id pub-id-type="doi">10.3835/plantgenome2012.06.0006</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Scheet</surname><given-names>P</given-names></name> and <name><surname>Stephens</surname><given-names>M</given-names></name> (<year>2006</year>). <article-title>A fast and flexible statistical model for large-scale population genotype data: applications to inferring missing genotypes and haplotypic phase</article-title>.<source>Am. J. Hum. Genet</source>. 2006; <volume>78</volume>:<fpage>629</fpage>–<lpage>644</lpage>
<pub-id pub-id-type="doi">10.1086/502802</pub-id>
<?supplied-pmid 16532393?><pub-id pub-id-type="pmid">16532393</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Desta</surname><given-names>Z.A.</given-names></name>, <name><surname>Ortiz</surname><given-names>R.</given-names></name> (<year>2014</year>) <article-title>Genomic selection: genome-wide prediction in plant improvement</article-title>. <source>Trends Plant Sci</source>. 2014 <month>9</month>;<volume>19</volume>(<issue>9</issue>):<fpage>592</fpage>–<lpage>601</lpage>. <pub-id pub-id-type="doi">10.1016/j.tplants.2014.05.006</pub-id> Epub 2014 Jun 23. <?supplied-pmid 24970707?><pub-id pub-id-type="pmid">24970707</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref018">
      <label>18</label>
      <mixed-citation publication-type="book"><collab>R Development Core Team</collab>, <year>2011</year><source>R: A Language and Environment for Statistical Computing</source>. <publisher-name>R Foundation for Statistical Computing</publisher-name>, <publisher-loc>Vienna</publisher-loc><ext-link ext-link-type="uri" xlink:href="http://www.R-project.org">http://www.R-project.org</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Pérez</surname><given-names>P</given-names></name>, <name><surname>de los Campos</surname><given-names>G</given-names></name>. <article-title>Genome-Wide Regression and Prediction with the BGLR Statistical Package</article-title>. <source>Genetics</source>. <year>2014</year>;<volume>198</volume>(<issue>2</issue>):<fpage>483</fpage>–<lpage>495</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.114.164442</pub-id><?supplied-pmid 25009151?><pub-id pub-id-type="pmid">25009151</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Endelman</surname><given-names>J.B</given-names></name>. (<year>2011</year>) <article-title>Ridge Regression and Other Kernels for Genomic Selection with R Package rrBLUP</article-title>. <source>The Plant Genome</source><volume>4</volume>:<fpage>250</fpage>–<lpage>255</lpage></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Estaghvirou</surname><given-names>SBO</given-names></name>, <name><surname>Ogutu</surname><given-names>JO</given-names></name>, <name><surname>Schulz-Streek</surname><given-names>T</given-names></name>, <name><surname>Knaak</surname><given-names>C</given-names></name>, <name><surname>Ouzunova</surname><given-names>M</given-names></name>, <name><surname>Gordillo</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>Evaluation of approaches for estimating the accuracy of genomic prediction in plant breeding</article-title>. <source>BMC Genomics</source>
<volume>12</volume>:<fpage>860</fpage>
<ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2164/14/860">http://www.biomedcentral.com/1471-2164/14/860</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Browning</surname><given-names>BL</given-names></name>, <name><surname>Browning</surname><given-names>SR</given-names></name>. <article-title>Genotype Imputation with Millions of Reference Samples</article-title>. <source>American Journal of Human Genetics</source><year>2016</year>;<volume>98</volume>(<issue>1</issue>), <fpage>116</fpage>–<lpage>126</lpage>. doi <pub-id pub-id-type="doi">10.1016/j.ajhg.2015.11.020</pub-id><?supplied-pmid 26748515?><pub-id pub-id-type="pmid">26748515</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Rincent</surname><given-names>R.</given-names></name>, <name><surname>Laloe</surname><given-names>D.</given-names></name>, <name><surname>Nicolas</surname><given-names>S.</given-names></name>, <name><surname>Altmann</surname><given-names>T.</given-names></name>, <name><surname>Brunel</surname><given-names>D.</given-names></name>, <name><surname>Revilla</surname><given-names>P.</given-names></name>, V., <etal>et al</etal><year>2012</year><article-title>Maximizing the reliability of genomic selection by optimizing the calibration set of reference individuals: Comparison of methods in two diverse groups of maize inbreds (Zea may L.)</article-title><source>Genetics</source><volume>192</volume>:<fpage>715</fpage>–<lpage>728</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.141473</pub-id><?supplied-pmid 22865733?><pub-id pub-id-type="pmid">22865733</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>De los Campos</surname><given-names>G.</given-names></name>, <name><surname>Hickey</surname><given-names>J. M.</given-names></name>, <name><surname>Pong-Wong</surname><given-names>R.</given-names></name>, <name><surname>Daetwyler</surname><given-names>H. D.</given-names></name>, &amp; <name><surname>Calus</surname><given-names>M. P. L.</given-names></name> (<year>2013</year>). <article-title>Whole-Genome Regression and Prediction Methods Applied to Plant and Animal Breeding</article-title>. <source>Genetics</source>, <volume>193</volume>(<issue>2</issue>), <fpage>327</fpage>–<lpage>345</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.112.143313</pub-id>
<pub-id pub-id-type="doi">10.1534/genetics.112.143313</pub-id>
<?supplied-pmid 22745228?><pub-id pub-id-type="pmid">22745228</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Jiang</surname><given-names>Y.</given-names></name>, &amp; <name><surname>Reif</surname><given-names>J. C.</given-names></name> (<year>2015</year>). <article-title>Modeling Epistasis in Genomic Selection.</article-title>
<source>Genetics</source>, <volume>201</volume>(<issue>2</issue>), <fpage>759</fpage>–<lpage>768</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.115.177907</pub-id>
<pub-id pub-id-type="doi">10.1534/genetics.115.177907</pub-id>
<?supplied-pmid 26219298?><pub-id pub-id-type="pmid">26219298</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Friedman</surname><given-names>J.</given-names></name>, <name><surname>Hastie</surname><given-names>T.</given-names></name> and <name><surname>Tibshirani</surname><given-names>R.</given-names></name> (<year>2008</year>) <article-title>Regularization Paths for Generalized Linear Models via Coordinate Descent</article-title>, <ext-link ext-link-type="uri" xlink:href="https://web.stanford.edu/~hastie/Papers/glmnet.pdf">https://web.stanford.edu/~hastie/Papers/glmnet.pdf</ext-link>. <source>Journal of Statistical Software</source>, Vol. <volume>33</volume>(<issue>1</issue>), <day>1–22</day>
<month>2</month> 2010</mixed-citation>
    </ref>
    <ref id="pone.0222733.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Zou</surname><given-names>H</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>. <article-title>Regularization and variable selection via the elastic net</article-title>. <source>J. Royal. Stat. Soc. B</source>. <year>2005</year>;<volume>67</volume>(<issue>2</issue>):<fpage>301</fpage>–<lpage>320</lpage>. [</mixed-citation>
    </ref>
    <ref id="pone.0222733.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Park</surname><given-names>T.</given-names></name>, <name><surname>Casella</surname><given-names>G.</given-names></name> (<year>2008</year>). <article-title>The bayesian lasso</article-title>. <source>Journal of the American Statistical Association</source>. 2008;<volume>103</volume>:<fpage>681</fpage>–<lpage>686</lpage>. 103.</mixed-citation>
    </ref>
    <ref id="pone.0222733.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Habier</surname><given-names>DRL</given-names></name><name><surname>Fernando</surname><given-names>RL</given-names></name>, <name><surname>Kizilkaya</surname><given-names>K</given-names></name>and <name><surname>Garrick</surname><given-names>DJ</given-names></name>(<year>2011</year>) <article-title>Extension of the bayesian alphabet for genomic selection</article-title>. <source>BMC Bioinformatics2011</source>. <volume>12</volume>:<fpage>186</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0222733.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Gianola</surname><given-names>D.</given-names></name>, &amp; <name><surname>van Kaam</surname><given-names>J. B. C. H. M.</given-names></name> (<year>2008</year>). <article-title>Reproducing Kernel Hilbert Spaces Regression Methods for Genomic Assisted Prediction of Quantitative Traits</article-title>. <source>Genetics</source>, <volume>178</volume>(<issue>4</issue>), <fpage>2289</fpage>–<lpage>2303</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.107.084285</pub-id>
<pub-id pub-id-type="doi">10.1534/genetics.107.084285</pub-id>
<?supplied-pmid 18430950?><pub-id pub-id-type="pmid">18430950</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>De los Campos</surname><given-names>G.</given-names></name>, <name><surname>Gianola</surname><given-names>D.</given-names></name>, <name><surname>Rosa</surname><given-names>G. J. M.</given-names></name>, <name><surname>Weigel</surname><given-names>K. A.</given-names></name>, and <name><surname>Crossa</surname><given-names>J.</given-names></name><year>2010</year><article-title>Semi-parametric genomic-enabled prediction of genetic values using reproducing kernel Hilbert spaces methods</article-title>. <source>Genetics Research</source><volume>92</volume>:<fpage>295</fpage>–<lpage>308</lpage><pub-id pub-id-type="doi">10.1017/S0016672310000285</pub-id><?supplied-pmid 20943010?><pub-id pub-id-type="pmid">20943010</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Breiman</surname><given-names>L</given-names></name> "<article-title>Random Forests</article-title>". <source>Machine Learning</source>
<year>2001</year>;<volume>45</volume> (<issue>1</issue>): <fpage>5</fpage>–<lpage>32</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0222733.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Gianola</surname><given-names>D</given-names></name>, <name><surname>Okut</surname><given-names>H</given-names></name>, <name><surname>Weigel</surname><given-names>KA</given-names></name>, <name><surname>Rosa</surname><given-names>GJ</given-names></name>. <article-title>Predicting complex quantitative traits with Bayesian neural networks: a case study with Jersey cows and wheat</article-title>. <source>BMC Genetics</source>. <year>2011</year>;<volume>12</volume>:<fpage>87</fpage><pub-id pub-id-type="doi">10.1186/1471-2156-12-87</pub-id><?supplied-pmid 21981731?><pub-id pub-id-type="pmid">21981731</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Oury</surname><given-names>F.X.</given-names></name>, <name><surname>Heumez</surname><given-names>E.</given-names></name>, <name><surname>Rolland</surname><given-names>B.</given-names></name>, <name><surname>Auzanneau</surname><given-names>J.</given-names></name>, <name><surname>Bérard</surname><given-names>P.</given-names></name>, <name><surname>Brancourt-Hulmel</surname><given-names>M.</given-names></name>, <etal>et al</etal> (<year>2015</year>) <source>Winter wheat (Triticum aestivum L) phenotypic data from the multiannual, multilocal field trials of the INRA Small Grain Cereals Network</source>. <pub-id pub-id-type="doi">10.15454/1.4489666216568333E12</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Rimbert</surname><given-names>H</given-names></name>, <name><surname>Darrier</surname><given-names>B</given-names></name>, <name><surname>Navarro</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>High throughput SNP discovery and genotyping in hexaploid wheat</article-title>. <name><surname>Zhang</surname><given-names>A</given-names></name>, ed. <source>PLoS ONE</source>. <year>2018</year>;<volume>13</volume>(<issue>1</issue>):<fpage>e0186329</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0186329</pub-id><?supplied-pmid 29293495?><pub-id pub-id-type="pmid">29293495</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>Y</given-names></name>, <name><surname>Vales</surname><given-names>MI</given-names></name>, <name><surname>Wang</surname><given-names>A</given-names></name>, <name><surname>Zhang</surname><given-names>Z</given-names></name>. <article-title>Systematic bias of correlation coefficient may explain negative accuracy of genomic prediction</article-title>. <source>Brief Bioinform</source>. <year>2016</year>:bbw065 <pub-id pub-id-type="doi">10.1093/bib/bbw064</pub-id><?supplied-pmid 27436121?><pub-id pub-id-type="pmid">27436121</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Endelman</surname><given-names>J.R.</given-names></name>, and <name><surname>Janninck</surname><given-names>J.L.</given-names></name><article-title>Shrinkage estimation of the realized relationship matrix</article-title>. <source>G3: Genes, Genomes, Genetics</source><year>2012</year>, <volume>2</volume>:<fpage>1405</fpage>–<lpage>1413</lpage><pub-id pub-id-type="doi">10.1534/g3.112.004259</pub-id><?supplied-pmid 23173092?><pub-id pub-id-type="pmid">23173092</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Wimmer</surname><given-names>V.</given-names></name>, <name><surname>Albrecht</surname><given-names>T.</given-names></name>, <name><surname>Auinger</surname><given-names>J.J.</given-names></name>, <name><surname>Schön</surname><given-names>C.C</given-names></name>. <year>2012</year><article-title>Synbreed: a framework for the analysis of genomic prediction data using R</article-title>, <source>Bioinformatics</source>, <volume>28</volume>: <fpage>2086</fpage>–<lpage>2087</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts335</pub-id><?supplied-pmid 22689388?><pub-id pub-id-type="pmid">22689388</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref039">
      <label>39</label>
      <mixed-citation publication-type="other">Ma, C., Cheng, Q., Qiu Z., Song, J. (2017). Package ‘G2P’ Genomic selection Prediction and Evaluation <ext-link ext-link-type="uri" xlink:href="https://github.com/cma2015/G2P">https://github.com/cma2015/G2P</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Heslot</surname><given-names>N.</given-names></name>, <name><surname>Yang</surname><given-names>H.P.</given-names></name>, <name><surname>Sorrells</surname><given-names>M.E.</given-names></name>, <name><surname>Jannink</surname><given-names>J.L</given-names></name>. <year>2012</year><article-title>Genomic Selection in Plant Breeding: A Comparison of Models</article-title>. <source>Crop Sci</source>. <volume>52</volume>:<fpage>146</fpage>–<lpage>160</lpage></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Michel</surname><given-names>S.</given-names></name>, <name><surname>Ametz</surname><given-names>C.</given-names></name>, <name><surname>Gungor</surname><given-names>H.</given-names></name>, <name><surname>Epure</surname><given-names>D.</given-names></name>, <name><surname>Grausgruber</surname><given-names>H.</given-names></name>, <name><surname>Löschenberger</surname><given-names>F.</given-names></name>, <etal>et al</etal> (<year>2016</year>). <article-title>Genomic selection across multiple breeding cycles in applied bread wheat breeding</article-title>. <source>TAG. Theoretical and Applied Genetics. Theoretische Und Angewandte Genetik</source>, <volume>129</volume>, <fpage>1179</fpage>–<lpage>1189</lpage>. <pub-id pub-id-type="doi">10.1007/s00122-016-2694-2</pub-id>
<pub-id pub-id-type="doi">10.1007/s00122-016-2694-2</pub-id>
<?supplied-pmid 27067826?><pub-id pub-id-type="pmid">27067826</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>S.</given-names></name>, <name><surname>Schulthess</surname><given-names>A.W.</given-names></name>, <name><surname>Mirdita</surname><given-names>V.</given-names></name>, <name><surname>Zhao</surname><given-names>Y.</given-names></name>, <name><surname>Korzun</surname><given-names>V.</given-names></name>, <name><surname>Bothe</surname><given-names>R.</given-names></name>, <etal>et al</etal> (<year>2016</year>) <article-title>Genomic selection in a commercial winter wheat populational</article-title>. <source>Theor Appl Genet</source> (2016) <volume>129</volume>: <fpage>641</fpage>
<pub-id pub-id-type="doi">10.1007/s00122-015-2655-1</pub-id>
<pub-id pub-id-type="doi">10.1007/s00122-015-2655-1</pub-id>
<?supplied-pmid 26747048?><pub-id pub-id-type="pmid">26747048</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>X.</given-names></name>, <name><surname>Wang</surname><given-names>H.</given-names></name>, <name><surname>Wang</surname><given-names>H.</given-names></name>, <name><surname>Guo</surname><given-names>Z.</given-names></name>, <name><surname>Xu</surname><given-names>X.</given-names></name>, <name><surname>Liu</surname><given-names>J.</given-names></name>, <etal>et al</etal> (<year>2018</year>), <article-title>Factors affecting genomic selection revealed by empirical evidence in maize</article-title>, <source>The Crop Journal.</source>
<pub-id pub-id-type="doi">10.1016/j.cj</pub-id>.</mixed-citation>
    </ref>
    <ref id="pone.0222733.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Ly</surname><given-names>C.</given-names></name>, <name><surname>Toghiani</surname><given-names>S.</given-names></name>, <name><surname>Ling</surname><given-names>A.</given-names></name>, <name><surname>Aggrey</surname><given-names>S.E</given-names></name>.3,4, <name><surname>Rekaya</surname><given-names>R</given-names></name>. (<year>2018</year>). <article-title>High density marker panels, SNPs prioritizing and accuracy of genomic selection</article-title>. <source>BMC Genet</source>. 2018 <month>1</month><day>5</day>;<volume>19</volume>(<issue>1</issue>):<fpage>4</fpage><pub-id pub-id-type="doi">10.1186/s12863-017-0595-2</pub-id><?supplied-pmid 29304753?><pub-id pub-id-type="pmid">29304753</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Heffner</surname><given-names>E.L.</given-names></name>, <name><surname>Jannink</surname><given-names>J-L</given-names></name>. <name><surname>Sorrells</surname><given-names>M.E</given-names></name> (<year>2011</year>) <article-title>Genomic Selection Accuracy using Multifamily Prediction Models in a Wheat Breeding Program</article-title>. <source>The Plant Genome</source>
<volume>4</volume>:<fpage>65</fpage>–<lpage>75</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0222733.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>Y.</given-names></name>, <name><surname>Reif</surname><given-names>J.C.</given-names></name>, <name><surname>Jiang</surname><given-names>Y.</given-names></name><etal>et al</etal><article-title>Potential of marker selection to increase prediction accuracy of genomic selection in soybean (Glycine max L.)</article-title><source>Mol Breeding</source> (<year>2016</year>) <volume>36</volume>: <fpage>113</fpage>
<pub-id pub-id-type="doi">10.1007/s11032-016-0504-9</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Cericola</surname><given-names>C</given-names></name>, <name><surname>Jahoor</surname><given-names>A</given-names></name>, <name><surname>Orabi</surname><given-names>J</given-names></name>, <name><surname>Andersen</surname><given-names>JR</given-names></name>, <name><surname>Janss</surname><given-names>LL</given-names></name>, <name><surname>Jensen</surname><given-names>J</given-names></name>. <article-title>Optimizing training population size and genotyping strategy for genomic prediction using association study results and pedigree information. A case study in advanced wheat breeding lines.</article-title><source>PLoS ONE</source> (<year>2017</year>);<volume>12</volume> (<issue>1</issue>) <fpage>e0169606</fpage> Doi <pub-id pub-id-type="doi">10.1371/journal.pone.0169606</pub-id>
<?supplied-pmid 28081208?><pub-id pub-id-type="pmid">28081208</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Schulz-Streeck</surname><given-names>T.</given-names></name>, <name><surname>Ogutu</surname><given-names>J. O.</given-names></name>, &amp; <name><surname>Piepho</surname><given-names>H.-P.</given-names></name> (<year>2011</year>). <article-title>Pre-selection of markers for genomic selection</article-title>. <source>BMC Proceedings</source>, <volume>5</volume>(<issue>Suppl 3</issue>), <fpage>S12</fpage>
<pub-id pub-id-type="doi">10.1186/1753-6561-5-S3-S12</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Daetwyler</surname><given-names>H.D.</given-names></name>, <name><surname>Villanueva</surname><given-names>B.</given-names></name>, and <name><surname>Woolliams</surname><given-names>J.A.</given-names></name><year>2008</year><article-title>Accuracy of predicting the genetic risk of disease using a genome-wide approach</article-title>. <source>PLoS ONE</source><volume>3</volume>:<fpage>e3395</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0003395</pub-id><?supplied-pmid 18852893?><pub-id pub-id-type="pmid">18852893</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Daetwyler</surname><given-names>H.D.</given-names></name>, <name><surname>Pong-Wong</surname><given-names>R.</given-names></name>, <name><surname>Villanueva</surname><given-names>B.</given-names></name>, and <name><surname>Woolliams</surname><given-names>J.A.</given-names></name><year>2010</year><article-title>The impact of genetic architecture on genome-wide evaluation methods</article-title>. <source>Genetics</source><volume>185</volume>:<fpage>1021</fpage>–<lpage>1031</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.110.116855</pub-id><?supplied-pmid 20407128?><pub-id pub-id-type="pmid">20407128</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Daetwyler</surname><given-names>H.D.</given-names></name>, <name><surname>Calus</surname><given-names>M.P.L.</given-names></name>, <name><surname>Poing-Wong</surname><given-names>R.</given-names></name>, <name><surname>De Los Campos</surname><given-names>G.</given-names></name>, <name><surname>Hickey</surname><given-names>J.M.</given-names></name><year>2013</year><article-title>Genomic Prediction in Animals and Plants: Simulation of Data, Validation, Reporting, and Benchmarking</article-title>. <source>Genetics</source><volume>193</volume>: <fpage>347</fpage>–<lpage>365</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.147983</pub-id><?supplied-pmid 23222650?><pub-id pub-id-type="pmid">23222650</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Isidro</surname><given-names>J.</given-names></name>, <name><surname>Jannink</surname><given-names>JL</given-names></name>., <name><surname>Akdemir</surname><given-names>D</given-names></name>., <name><surname>Poland</surname><given-names>J</given-names></name>., <name><surname>Heslot</surname><given-names>N</given-names></name>., <name><surname>Sorrels</surname><given-names>M.E</given-names></name>. (<year>2015</year>) <article-title>Training set optimization under population structure in genomic selection</article-title>. <source>Theor Appl Genet</source> (2015) <volume>128</volume>: <fpage>145</fpage>
<pub-id pub-id-type="doi">10.1007/s00122-014-2418-4</pub-id>
<pub-id pub-id-type="doi">10.1007/s00122-014-2418-4</pub-id>
<?supplied-pmid 25367380?><pub-id pub-id-type="pmid">25367380</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Rincent</surname><given-names>R.</given-names></name>, <name><surname>Charcosset</surname><given-names>A.</given-names></name> &amp; <name><surname>Moreau</surname><given-names>L.</given-names></name>
<article-title>Predicting genomic selection efficiency to optimize calibration set and to assess prediction accuracy in highly structured populations</article-title>. <source>Theor Appl Genet</source> (<volume>130</volume>: <fpage>2231</fpage>
<pub-id pub-id-type="doi">10.1007/s00122-017-2956-7</pub-id>
<pub-id pub-id-type="doi">10.1007/s00122-017-2956-7</pub-id>
<?supplied-pmid 28795202?><pub-id pub-id-type="pmid">28795202</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Akdemir</surname><given-names>D</given-names></name>, <name><surname>Sanchez</surname><given-names>JI</given-names></name>, <name><surname>Janninck</surname><given-names>JL</given-names></name>.(<year>2015</year>) <article-title>Optimization of genomic selection training populations with a genetic algorithm</article-title>. <source>Genetics Selection Evolution</source> 2015;<volume>47</volume>: <fpage>38</fpage> Doi <pub-id pub-id-type="doi">10.1186/s12711-015-0116-6</pub-id>
<?supplied-pmid 25943105?><pub-id pub-id-type="pmid">25943105</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Song</surname><given-names>J.</given-names></name>, <name><surname>Carver</surname><given-names>B.F.</given-names></name>, <name><surname>Powers</surname><given-names>C</given-names></name>, <name><surname>Yan</surname><given-names>L.</given-names></name>, <name><surname>Klapste</surname><given-names>J.</given-names></name>, <name><surname>El-Kassaby</surname><given-names>Y.A</given-names></name>, <etal>et al</etal> (<year>2017</year>) <article-title>Practical application of genomic selection in a doubled-haploid winter wheat breeding programme</article-title>. <source>Mol Breeding</source> (2017) <volume>37</volume>: <fpage>117</fpage>
<pub-id pub-id-type="doi">10.1007/s11032-017-0715-8</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>X.</given-names></name>, <name><surname>Xu</surname><given-names>Y.</given-names></name>, <name><surname>Hu</surname><given-names>Z.</given-names></name>, <name><surname>Xu</surname><given-names>C.</given-names></name> (<year>2018</year>), <article-title>Genomic selection methods for crop improvement: Current status and prospects</article-title>. <source>The Crop Journal</source> (2018) <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016:j.cj/2018.03.001">https://doi.org/10.1016:j.cj/2018.03.001</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>D.</given-names></name>, <name><surname>El-Basyoni</surname><given-names>I.S.</given-names></name>, <name><surname>Baenziger</surname><given-names>P.S.</given-names></name><name><surname>Crossa</surname><given-names>J</given-names></name>., <name><surname>Eskridge</surname><given-names>K.M</given-names></name>., <name><surname>Dweikat</surname><given-names>I</given-names></name>. (<year>2012</year>) <article-title>Prediction of genetic values of quantitative traits with epistatic effects in plant breeding populations</article-title>. <source>Heredity</source>, <volume>109</volume> (2012), pp. <fpage>313</fpage>–<lpage>319</lpage>
<pub-id pub-id-type="doi">10.1038/hdy.2012.44</pub-id>
<?supplied-pmid 22892636?><pub-id pub-id-type="pmid">22892636</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>González-Camacho</surname><given-names>J. M.</given-names></name>, <name><surname>de los Campos</surname><given-names>G.</given-names></name>, <name><surname>Pérez</surname><given-names>P.</given-names></name>, <name><surname>Gianola</surname><given-names>D.</given-names></name>, <name><surname>Cairns</surname><given-names>J. E.</given-names></name>, <name><surname>Mahuku</surname><given-names>G.</given-names></name>, <name><surname>Crossa</surname><given-names>J.</given-names></name> (<year>2012</year>). <article-title>Genome-enabled prediction of genetic values using radial basis function neural networks</article-title>. <source>TAG. Theoretical and Applied Genetics.</source>, <volume>125</volume>(<issue>4</issue>), <fpage>759</fpage>–<lpage>771</lpage>. <pub-id pub-id-type="doi">10.1007/s00122-012-1868-9</pub-id>
<pub-id pub-id-type="doi">10.1007/s00122-012-1868-9</pub-id>
<?supplied-pmid 22566067?><pub-id pub-id-type="pmid">22566067</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>B</given-names></name>, <name><surname>Zhang</surname><given-names>N</given-names></name>, <name><surname>Wang Y-</surname><given-names>G</given-names></name>, <name><surname>George</surname><given-names>AW</given-names></name>,<name><surname>Reverter</surname><given-names>A</given-names></name> and <name><surname>Li</surname><given-names>Y</given-names></name> (2018) <article-title>GenomicPrediction of Breeding Values Using aSubset of SNPs Identified by ThreeMachine Learning Methods</article-title>. <source>Front. Genet</source>. <volume>9</volume>:<fpage>237</fpage><pub-id pub-id-type="doi">10.3389/fgene.2018.00237</pub-id>
<?supplied-pmid 30023001?><pub-id pub-id-type="pmid">30023001</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>W.</given-names></name>, <name><surname>Qiu</surname><given-names>Z.</given-names></name>, <name><surname>Song</surname><given-names>J.</given-names></name>, <name><surname>Li</surname><given-names>J.</given-names></name>, ., <name><surname>Cheng</surname><given-names>Q</given-names></name>., <name><surname>Zhai</surname><given-names>J</given-names></name>., <etal>et al</etal>(<year>2018</year>) <article-title>Deep convolutional neural network approach for predicting phenotypes from genotypesPlanta</article-title> (2018) <volume>248</volume>: <fpage>1307</fpage>
<pub-id pub-id-type="doi">10.1007/s00425-018-2976-9</pub-id>
<pub-id pub-id-type="doi">10.1007/s00425-018-2976-9</pub-id>
<?supplied-pmid 30101399?><pub-id pub-id-type="pmid">30101399</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Kang</surname><given-names>H.</given-names></name>, <name><surname>Zhou</surname><given-names>L.</given-names></name>, <name><surname>Liu</surname><given-names>J.</given-names></name> (<year>2017</year>) <article-title>Statistical considerations for genomic selection</article-title>. <source>Front. Agr. Sci. Eng</source>. <volume>2017</volume>, <volume>4</volume>(<issue>3</issue>):<fpage>268</fpage>–<lpage>278</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0222733.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Spindel</surname><given-names>J.E.</given-names></name>, <name><surname>Mc Couch</surname><given-names>S.R.</given-names></name> (<year>2016</year>) <article-title>When more is better: how data sharing would accelerate genomic selection of crop plants</article-title>. <source>New Phytologist</source> (2016) <volume>212</volume>:<fpage>814</fpage>–<lpage>826</lpage>
<pub-id pub-id-type="doi">10.1111/nph.14174</pub-id>
<?supplied-pmid 27716975?><pub-id pub-id-type="pmid">27716975</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Heslot</surname><given-names>N.</given-names></name>, <name><surname>Jannink</surname><given-names>J.L.</given-names></name>, <name><surname>Sorrells</surname><given-names>M.E</given-names></name>. (<year>2015</year>). <article-title>Perspectives for Genomic Selection. Application and Research in Plants</article-title>. <source>Crop Sci</source>. <volume>55</volume>:<fpage>1</fpage>–<lpage>12</lpage></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Bassi</surname><given-names>FM</given-names></name>, <name><surname>Bentley</surname><given-names>AR</given-names></name>, <name><surname>Charmet</surname><given-names>G</given-names></name>, <name><surname>Ortiz</surname><given-names>R</given-names></name>, <name><surname>Crossa</surname><given-names>J</given-names></name>. <article-title>Breeding schemes for the implementation of genomic selection in wheat (Triticum spp.)</article-title>. <source>Plant Science</source><year>2016</year>;<volume>242</volume>:<fpage>23</fpage>–<lpage>36</lpage>. <pub-id pub-id-type="doi">10.1016/j.plantsci.2015.08.021</pub-id><?supplied-pmid 26566822?><pub-id pub-id-type="pmid">26566822</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Crossa</surname><given-names>J.</given-names></name>, <name><surname>Pérez-Rodríguez</surname><given-names>P.</given-names></name>, <name><surname>Cuevas</surname><given-names>J.</given-names></name>, <name><surname>Montesinos-López</surname><given-names>O.</given-names></name>, <name><surname>Jarquín</surname><given-names>D.</given-names></name>, <name><surname>delos Campos</surname><given-names>G.</given-names></name>, <etal>et al</etal><article-title>Genomic selection in plant breeding: methods, models, and perspectives</article-title>. <source>Trends Plant Sci.</source>, <volume>22</volume> (<year>2017</year>), pp. <fpage>961</fpage>–975, <pub-id pub-id-type="doi">10.1016/j.tplants.2017.08.011</pub-id>
<?supplied-pmid 28965742?><pub-id pub-id-type="pmid">28965742</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0222733.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Michel</surname><given-names>S.</given-names></name>, <name><surname>Kummer</surname><given-names>C.</given-names></name>, <name><surname>Gallee</surname><given-names>M.</given-names></name>, <name><surname>Hellinger</surname><given-names>J.</given-names></name>, <name><surname>Ametz</surname><given-names>C.</given-names></name>, <name><surname>Akgöl</surname><given-names>B.</given-names></name>, <etal>et al</etal> (<year>2018</year>). <article-title>Improving the baking quality of bread wheat by genomic selection in early generations</article-title>. <source>TAG. Theor Appl Gen</source>. <volume>131</volume>(<issue>2</issue>), <fpage>477</fpage>–<lpage>493</lpage>. <pub-id pub-id-type="doi">10.1007/s00122-017-2998-x</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
