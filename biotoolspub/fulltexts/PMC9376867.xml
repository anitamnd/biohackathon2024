<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">nargab</journal-id>
    <journal-title-group>
      <journal-title>NAR Genomics and Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2631-9268</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9376867</article-id>
    <article-id pub-id-type="doi">10.1093/nargab/lqac060</article-id>
    <article-id pub-id-type="publisher-id">lqac060</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00030</subject>
        <subject>AcademicSubjects/SCI00980</subject>
        <subject>AcademicSubjects/SCI01060</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Methods Article</subject>
      </subj-group>
      <subj-group subj-group-type="category-oup-series">
        <subject>Editor's Choice</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>mOTUpan: a robust Bayesian approach to leverage metagenome-assembled genomes for core-genome estimation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6632-5324</contrib-id>
        <name>
          <surname>Buck</surname>
          <given-names>Moritz</given-names>
        </name>
        <!--moritz.buck@slu.se-->
        <xref rid="COR1" ref-type="corresp"/>
        <aff><institution>Department of Aquatic Sciences and Assessment, Swedish University of Agricultural Sciences</institution>, Lennart Hjelms väg 9, 75651 Uppsala, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1108-6888</contrib-id>
        <name>
          <surname>Mehrshad</surname>
          <given-names>Maliheh</given-names>
        </name>
        <xref rid="FN1" ref-type="author-notes"/>
        <aff><institution>Department of Aquatic Sciences and Assessment, Swedish University of Agricultural Sciences</institution>, Lennart Hjelms väg 9, 75651 Uppsala, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4265-1835</contrib-id>
        <name>
          <surname>Bertilsson</surname>
          <given-names>Stefan</given-names>
        </name>
        <xref rid="FN1" ref-type="author-notes"/>
        <aff><institution>Department of Aquatic Sciences and Assessment, Swedish University of Agricultural Sciences</institution>, Lennart Hjelms väg 9, 75651 Uppsala, <country country="SE">Sweden</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +46 729 33 7652; Email: <email>moritz.buck@slu.se</email></corresp>
      <fn id="FN1">
        <p>These authors contributed equally to the paper.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-08-15">
      <day>15</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <volume>4</volume>
    <issue>3</issue>
    <elocation-id>lqac060</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>7</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of NAR Genomics and Bioinformatics.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="lqac060.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Recent advances in sequencing and bioinformatics have expanded the tree of life by providing genomes for uncultured environmentally relevant clades, either through metagenome-assembled genomes or through single-cell genomes. While this expanded diversity can provide novel insights into microbial population structure, most tools available for core-genome estimation are sensitive to genome completeness. Consequently, a major portion of the huge phylogenetic diversity uncovered by environmental genomic approaches remains excluded from such analyses. We present mOTUpan, a novel iterative Bayesian method for computing the core genome for sets of genomes of highly diverse completeness range. The likelihood for each gene cluster to belong to core or accessory genome is estimated by computing the probability of its presence/absence pattern in the target genome set. The core-genome prediction is computationally efficient and can be scaled up to thousands of genomes. It has shown comparable estimates to state-of-the-art tools Roary and PPanGGOLiN for high-quality genomes and is capable of using genomes at lower completeness thresholds. mOTUpan wraps a bootstrapping procedure to estimate the quality of a specific core-genome prediction, as the accuracy of each run will depend on the specific completeness distribution and the number of genomes in the dataset under scrutiny. mOTUpan is implemented in the mOTUlizer software package, and available at <ext-link xlink:href="http://github.com/moritzbuck/mOTUlizer" ext-link-type="uri">github.com/moritzbuck/mOTUlizer</ext-link>, under GPL 3.0 license.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004359</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017-04422</award-id>
        <award-id>2018-04685</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>The continuous advancements of high-throughput sequencing technologies and bioinformatics tools over the last two decades have fueled large-scale ecogenomic analyses leading up to a new view of the tree of life (<xref rid="B1" ref-type="bibr">1–3</xref>). This refined view enabled by metagenomics and single-cell genomics reveals that uncultured bacteria and archaea exclusively represented by metagenome-assembled genomes (MAGs) and single-cell amplified genomes (SAGs) account for ∼75% of the cataloged phylogenetic microbial diversity (<xref rid="B2" ref-type="bibr">2</xref>). Despite their unequivocal potential to reveal diversity, the inherent incompleteness of MAGs and SAGs has so far hindered attempts in the large-scale study of subpopulation diversity, core-genome structure and genome evolution of these phylogenetically diverse species.</p>
    <p>All nonredundant genes in genomes from a genome set are part of its pan-genome and can be categorized as either core or accessory (<xref rid="B4" ref-type="bibr">4</xref>). The core genome is a set of genes common among all genomes of a species and is supposedly responsible for the basic aspects of the cell’s biology and phenotypic traits (<xref rid="B5" ref-type="bibr">5</xref>). The accessory part of the genome is underpinning the subspecies diversity and is defined as genes present in two or more but not all representatives of a species. Accessory genes typically encode for functions that provide cells with adaptive advantages (e.g. supplementary metabolic pathways, enzymatic activities, antibiotic resistance, phage and predation resistance, pathogenicity, etc.) (<xref rid="B4" ref-type="bibr">4–6</xref>), but are often also relics or live selfish genetic elements (<xref rid="B7" ref-type="bibr">7</xref>).</p>
    <p>A key prerequisite for the comparative analyses of the subspecies diversity and ecological adaptations is to first have a robust estimation of the core genome that will enable a better assessment of the accessory counterparts. However, core-genome analyses are limited in taxonomic scope (<xref rid="B8" ref-type="bibr">8–13</xref>), largely because of the severe limitations in culturing microbes and obtaining high-quality genomes, combined with existing bioinformatics methods being dependent on high-quality genomes to scaffold such analyses. Most methods used for core-genome analysis only work with sets of high-quality and complete genomes and are very sensitive to missing genes and fragmented genomes (<xref rid="B14" ref-type="bibr">14</xref>). These methods often concentrate on developing novel methods for computation of clusters of orthologous genes (COGs) in the population of interest (<xref rid="B14" ref-type="bibr">14</xref>) and use only simple binary presence/absence models for the core-genome estimation (e.g. a COG is core if it is present in all the genomes of the clade). Such methods perform best when used on a moderate number of high-quality genomes generated from cultured microbial isolates. Accordingly, these methods are unable to deal with the rapidly growing database of incomplete and fragmented MAGs and SAGs of the uncultured majority of Earth’s microbiome (<xref rid="B2" ref-type="bibr">2</xref>). Due to these methodological limitations, our understanding of the size and structure of microbial core genomes and pan-genome dynamics remains elusive and lags behind our growing appreciation of microbial phylogenetic diversity. The recently released software, PPanGGOLiN, uses synteny networks to compute clusters of co-occurring gene clusters instead of presence/absence. This method is highly scalable, fast and robust enough to deal with incomplete genomes (<xref rid="B15" ref-type="bibr">15</xref>). However, this method could be sensitive to fragmentation, which is a prominent feature of most incomplete MAGs and SAGs, and is not explicitly tailored to find the core, but rather to find clusters of syntenic genes.</p>
    <p>Here, we present a novel approach for computing core genomes relying on a Bayesian estimator of the observed presence/absence patterns of discrete genome-encoded traits (any trait that can be encoded in a genome, e.g. gene cluster, COG, functional annotations, etc.) in sets of incomplete MAGs/SAGs and complete genomes. We wrote a software tool, mOTUpan, that can estimate whether any genome-encoded trait is more likely to be present in all genomes of a genome set or only in a subset. mOTUpan can compute the core-genome partitioning for genome sets of a wide range of qualities, and is computationally efficient, agnostic to the genome-encoded traits used and very robust to incompleteness.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Bayesian approach for core-genome estimation</title>
      <p>mOTUpan can use any set of genomes that is suspected to share a certain number of genome-encoded traits. We typically use clusters where all genomes are within compact clusters defined by a 95% average nucleotide identity (ANI) threshold. We call such clusters metagenomic operational taxonomic units (mOTUs), which can be seen as an operational definition of species. However, genomes clustered at any other taxonomic level, or any other way one can imagine (by niche, predator, host, etc.), could be done too, but one should consider turning off re-estimation of completeness estimates in some cases (‘<monospace>--max_iter 1</monospace>’). We will use the term genome as a shorthand for any set of nucleotide sequences originating from the same organism. This could be draft genomes, complete genomes, MAGs or SAGs. Each genome is first described as a set of genome-encoded traits. Here, we will use gene clusters, but it should be mentioned that mOTUpan is agnostic to the specific form of such traits; one could use genes, COGs, functional annotations or any other discrete trait that is encoded by a genome. mOTUpan then uses an iterative Bayesian approach to classify each trait of the genome in a genome cluster as a core or accessory trait based on a likelihood ratio. For each of the two hypotheses (core or accessory trait), a probability is computed using an initial genome completeness estimate inferred for each genome [genome completeness can be calculated using CheckM (<xref rid="B16" ref-type="bibr">16</xref>) or any other tool of your choosing, or a fixed value used]. The most likely trait category (core or accessory) is then picked as class for that trait. Using this new classification, we re-estimate completeness, which can be used as an estimate for a second iteration and then repeat this entire process until convergence.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Probability models</title>
      <p>To compute the probability of a distribution of a specific trait in the genome set mOTU under the assumption that it is in the core, we multiply the probability <italic toggle="yes">p</italic><sub>trait∈<italic toggle="yes">g</italic>|core</sub> of any genome <italic toggle="yes">g</italic> (<italic toggle="yes">g</italic> is treated as a set of traits) that has that gene cluster with the inverse probability 1 − <italic toggle="yes">p</italic><sub>trait∈<italic toggle="yes">g</italic>|core</sub> for the genomes that do not have that trait, where the probability <italic toggle="yes">p</italic><sub>trait∈<italic toggle="yes">g</italic>|core</sub> is actually directly the completeness estimate <italic toggle="yes">c</italic><sub><italic toggle="yes">g</italic></sub> of <italic toggle="yes">g</italic>, e.g. Equations (<xref rid="M1" ref-type="disp-formula">1</xref>) and (<xref rid="M2" ref-type="disp-formula">2</xref>):<disp-formula id="M1"><label>(1)</label><tex-math id="M0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} p_{{\rm trait}|{\rm core}}=\prod _{\substack{{g} \in {\rm mOTU}\\ {\rm if\,trait} \in {g}}} p_{ {{\rm trait}} \in {{g}|{\rm core}}} \prod _{\substack{ {g} \in {\rm mOTU}\\ {\rm if\,trait} \notin {g}}}(1-p_{{{\rm trait}} \in {g|{\rm core}}}), \end{equation*}$$\end{document}</tex-math></disp-formula><disp-formula id="M2"><label>(2)</label><tex-math id="M0001a" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} p_{{\rm trait} \in {g|{\rm core}}}=c_g .\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>For the probability under the assumption that it is in the accessory fraction of the genome, we will have to make some further assumptions with regard to the structure of the pan-genome. We have assumed that the traits in the pan-genome that are not in the core are independent, and each trait has a frequency <inline-formula><tex-math id="M0002" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${|{\rm trait}|}/{|T|}$\end{document}</tex-math></inline-formula>, where |trait| is the number of genomes in mOTU that have that trait and |<italic toggle="yes">T</italic>| is the total size of the traits’ pool, e.g. <inline-formula><tex-math id="M0003" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sum _{\substack{{\rm all traits}}}{|{\rm trait}|}$\end{document}</tex-math></inline-formula>. To ‘fill’ the accessory fraction of a genome, we draw ‘|<italic toggle="yes">g</italic>|’ times, where |<italic toggle="yes">g</italic>| is the number of traits in the genome, core size |core<sub>mOTU</sub>| and completeness <italic toggle="yes">c</italic><sub><italic toggle="yes">g</italic></sub>, resulting in Equations (<xref rid="M3" ref-type="disp-formula">3</xref>) and (<xref rid="M4" ref-type="disp-formula">4</xref>):<disp-formula id="M3"><label>(3)</label><tex-math id="M0004" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*} p_{{{\rm trait}|{\rm access}}}&amp;=&amp;\prod _{\substack{ {g} \in {\rm mOTU}\\ {\rm if\,trait} \in {g}}} (1-\overline{p}_{{\rm trait} \in {g|{\rm access}}}) \prod _{\substack{ {g} \in {\rm mOTU}\\ {\rm if\,trait} \notin {g}}} \overline{p}_{{\rm trait} \in {g|{\rm access}}} ,\nonumber\\ \end{eqnarray*}$$\end{document}</tex-math></disp-formula><disp-formula id="M4"><label>(4)</label><tex-math id="M0005" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \overline{p}_{{\rm trait} \in {g|{\rm access}}}=\left(1-\frac{|{\rm trait}|}{|T|}\right)^{|g|-c_g|{\rm core}_{{\rm mOTU}}|} .\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>For practical reasons, these computations are all done in log space, resulting in a log-likelihood ratio (LLHR)<disp-formula id="M5"><label>(5)</label><tex-math id="M0006" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} {\rm LLHR}=\log {(p_{ {{\rm trait}| {\rm core}}})}-\log {(p_{ {{\rm trait}|{\rm access}}})} .\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>If the LLHR of Equation (<xref rid="M5" ref-type="disp-formula">5</xref>) is positive, the trait is considered core; if negative, it is considered accessory. Using this classification, we recompute an updated completeness estimate for each genome:<disp-formula id="M6"><label>(6)</label><tex-math id="M0007" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} c_g=\frac{|{\rm core}_{\rm mOTU} \cap {g} |}{ | {\rm core}_{\rm mOTU}|}, \end{equation*}$$\end{document}</tex-math></disp-formula>where core<sub>mOTU</sub> is the set of all traits classified as core.</p>
      <p>After this step, we rerun the likelihood computation. This is repeated until convergence (when core-genome estimates remain unchanged), to obtain a final set of core traits and accessory traits, and posterior completeness estimates.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Benchmarking mOTUpan for core-genome estimation</title>
      <p>To benchmark the core genomes computed by mOTUpan against other commonly used core-genome analysis tools, we calculated the core genomes for 301 species containing a total of 11570 genomes (for larger species, only 50 genomes were randomly picked to make the runs tractable with Roary) from the Genome Taxonomy Database (GTDB release 95) (<xref rid="B3" ref-type="bibr">3</xref>) and 258 mOTUs containing 8955 genomes in total from the StratFreshDB (<xref rid="B17" ref-type="bibr">17</xref>). The MAGs were reclustered with mOTUlizer (<ext-link xlink:href="http://github.com/moritzbuck/mOTUlizer" ext-link-type="uri">github.com/moritzbuck/mOTUlizer</ext-link>), which computes a network based on average nucleotide identity of which the connected components form OTU-like clusters [see (<xref rid="B17" ref-type="bibr">17</xref>) for more details], with less stringent parameters (‘<monospace>--MAG-completeness 30 --MAG-contamination 10</monospace>’) to have more low-quality mOTUs and compare the performance of mOTUpan to Roary (<xref rid="B14" ref-type="bibr">14</xref>) (version 3.13.0) and PPanGGOLiN (<xref rid="B15" ref-type="bibr">15</xref>) (version 1.1.96). Normalized residues of the comparisons are computed by dividing the difference between mOTUpan’s predicted core size and Roary/PanGGOLiN’s predicted core size by the mean of the predictions. Genome statistics, accession numbers and taxonomy are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. This step aims to highlight and compare the performance of mOTUpan with Roary and PPanGGOLiN with regard to the ability to handle incomplete and fragmented genomes.</p>
      <p>For more detailed benchmarking of mOTUpan performance, we selected a dataset of genomes affiliated with the <italic toggle="yes">Prochlorococcus_A</italic> genus from the GTDB. All genomes classified as <italic toggle="yes">Prochlorococcus_A</italic> according to GTDB-Tk (<xref rid="B18" ref-type="bibr">18</xref>) found in RefSeq as well as GORG (<xref rid="B19" ref-type="bibr">19</xref>) were clustered into mOTUs (using mOTUlizer with standard parameters); the mOTU with the largest number of genomes was used (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> for genome statistics and accession numbers). This <italic toggle="yes">Prochlorococcus</italic> mOTU consists of 388 genomes whereof 3 are closed genomes and 16 genomes are estimated to be &gt;95% complete according to CheckM (<xref rid="B16" ref-type="bibr">16</xref>) (version 1.1.3) results. Genomes assigned to this mOTU range in completeness from 8.59% to 99.52% (median = 69.05%) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). mOTUpan’s performance for core-genome estimates for this <italic toggle="yes">Prochlorococcus</italic> mOTU was benchmarked against PPanGGOLiN using the gene clusters generated by it [PPanGGOLiN uses mmseqs (<xref rid="B20" ref-type="bibr">20</xref>) internally for gene clustering, version 13.45111 in our case]. All results shown in this paper were analyzed by mOTUpan version 0.3.2.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Bootstrapped false discovery rate and sensitivity</title>
      <p>In addition to the likelihood ratio between the two probabilities, a bootstrapping approach has been integrated in mOTUpan to estimate the false discovery rate and sensitivity of a specific partitioning. Synthetic genomes are built by drawing gene clusters from the original genome set according to the partitioning; e.g. every synthetic genome is composed of all the core gene clusters, and a number of accessory gene clusters are drawn randomly from the pool of accessory gene clusters based on an estimated genome size (mean of number of gene clusters divided by completeness estimate). The synthetic genomes are built ‘complete’ and then rarefied by randomly removing gene clusters according to the genome set’s posterior completeness estimates. This synthetic set of genomes is then run through mOTUpan again and the counts of core traits in the obtained core genome and accessory are used to estimate the false positive rate and sensitivity. Multiple synthetic datasets can be analyzed to obtain a better estimate. To evaluate the bootstrapping, we need a core genome that is assumed to be true. To achieve this, we ran 10 runs of mOTUpan with 100 randomly picked genomes of <italic toggle="yes">Prochlorococcus_A</italic> selected from the set used for benchmarking. We used the union of the obtained cores as such (this is a liberal estimation of the true core as we cannot know what the true core of this population is). We then for each run in the bootstrapping computed an empirical false positive rate by counting the genes appearing in the computed core that are not a part of our calculated true core from the previous step. We then end computed a bootstrapped false positive rate. Results are presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS AND DISCUSSION</title>
    <sec id="SEC3-1">
      <title>Overview of the mOTUpan’s Bayesian approach</title>
      <p>The Bayesian approach adopted in this tool tries to leverage the genomic diversity uncovered by incomplete and fragmented MAGs and SAGs for exploring the core-genome and pan-genome structure of bacterial and archaeal species (or any other set of genomic traits). Most available tools such as Roary rely on a hard presence/absence threshold for defining the core genome. This limitation renders such tools largely unusable when dealing with incomplete and fragmented MAGs and SAGs. Comparing the performance of Roary and mOTUpan for core-genome estimation with the gene clusters computed by Roary is equivalent to comparing mOTUpan to a hard threshold approach.</p>
      <p>The network nature of PPanGGOLiN makes it relatively robust to deal with some degree of incompleteness; however, as it is looking for patterns of synteny to determine the persistent fraction of the genomes, too much fragmentation (that is common in MAGs and SAGs) could cause problems in calculations of the persistent fraction of the genomes. The Bayesian approach of mOTUpan, on the other hand, helps by potentially bypassing both incompleteness and fragmentation limitations for core-genome and pan-genome estimation for sets of incomplete and fragmented MAGs and SAGs. To give an approximation of the runtime and memory usage, we have used 9443 <italic toggle="yes">Staphylococcus aureus</italic> genomes downloaded from the GTDB. These genomes were processed in 4 min for gene clustering on 24 threads by mmseqs2, and 2 h 15 min for mOTUpan on a single thread on a Ryzen 9 3900X using around 3 GB of RAM. mOTUpan also calculates bootstrapped false discovery rate and sensitivity for the core-genome/pan-genome partitioning.</p>
      <p>There are widespread and valid concerns that MAGs are contaminated by contigs that might not be a genuine part of their genome, as binning tools may mistakenly cluster them together with the rest of the MAG. MAGs are usually screened for putative contamination with tools such as CheckM that relies on a limited dataset of high-quality genomes to compute a set of markers. mOTUpan can, however, address this known problem in a different way, as genes annotated as core have a very low likelihood of being contaminants and can thus be used for prediction of genome quality. Thus, mOTUpan allows users to compute an alternative to the completeness values estimated by CheckM (or other tools) independent of marker gene collections or complete genomes. This alternative can be used for all kinds of genome sets, such as viruses or plasmids, that do not have dedicated tools or databases.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Benchmarking mOTUpan against Roary and PPanGGOLiN along the completeness scale</title>
      <p>To benchmark the performance of mOTUpan against Roary, we used the gene clusters generated by Roary. Comparing the performance along the completeness scale shows that Roary is highly sensitive to genome completeness, as Roary’s core-genome estimate drops away considerably from that of mOTUpan when completeness decreases (Figure <xref rid="F1" ref-type="fig">1A</xref> and B). Some of these limitations can be bypassed by manually adjusting thresholds in Roary, but while this can be done at a small scale, it is not tractable for the larger scales where mOTUpan can still function (as is stated on its web page: ‘Roary is not intended for metagenomics or for comparing extremely diverse sets of genomes’, <ext-link xlink:href="https://sanger-pathogens.github.io/Roary/" ext-link-type="uri">https://sanger-pathogens.github.io/Roary/</ext-link>).</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Benchmarking the performance of mOTUpan against Roary along the completeness scale. Three hundred one species containing 11 570 genomes from the GTDB and 258 mOTUs containing 8955 genomes in total from the StratFreshDB are used for this comparison. Gene clusters used are the ones computed by Roary. (<bold>A</bold>) Predicted core sizes. (<bold>B</bold>) Normalized residues, fold change between core size predicted by mOTUpan and Roary; if the number is &gt;1, mOTUpan’s prediction is larger. (<bold>C</bold>) Predicted gene clusters in core divided by estimated number of gene clusters per genome (bins below 40% completeness are ignored for this estimate) versus the mean. Local polynomial regression fitting is used in panel (C).</p>
        </caption>
        <graphic xlink:href="lqac060fig1" position="float"/>
      </fig>
      <p>Running mOTUpan using the COGs generated by PPanGGOLiN [which internally uses the mmseq2 (<xref rid="B15" ref-type="bibr">15</xref>) clustering tool], we obtain similar core-genome estimates for the GTDB dataset (the more complete genome sets) (Figure <xref rid="F2" ref-type="fig">2A</xref>). Looking more specifically at the deviation from the first bisector along the completeness scale (Figure <xref rid="F2" ref-type="fig">2B</xref>), we can see that in general PPanGGOLiN’s core-genome estimates are larger than those obtained with mOTUpan for the more complete genome sets. This tendency changes drastically once the average completeness drops below 70% where the mOTUpan estimates become larger. This increase could be due to an inflation of predicted core gene clusters for the more incomplete genome sets. We accounted for this possibility by inspecting the fraction of the genome classified as core (Figure <xref rid="F2" ref-type="fig">2C</xref>). While this estimate is expected to be independent of completeness, we can see that outputs from both PPanGGOLiN and mOTUpan drop away from the expected value with lower completeness, but the output from PPanGGOLiN drops faster, demonstrating mOTUpan’s robustness to incomplete and noisy genomes. Additionally, PPanGGOLiN is designed to classify genes in three partitions (persistent, shell and cloud) and thus it is not adapted for very incomplete genome sets. While at higher completeness values both tools offer good estimation of the core genome, for most ecological studies that focus on MAGs with completeness at the ≥50% completeness and ≤5% contaminations (<xref rid="B2" ref-type="bibr">2</xref>), mOTUpan could provide a better estimation of the core genome.</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>Benchmarking the performance of mOTUpan against PPanGGOLiN along the completeness scale. Three hundred one mOTUs containing 11 570 genomes from the GTDB and 258 mOTUs containing 8955 genomes in total from the StratFreshDB were used for this comparison. Gene clusters used are the ones computed by PPanGGOLiN (based on mmseqs2). (<bold>A</bold>) Predicted core sizes. (<bold>B</bold>) Normalized residues, fold change between core size predicted by mOTUpan and PPanGGOLiN; if the number is &gt;1, mOTUpan’s prediction is larger. (<bold>C</bold>) Predicted gene clusters in core divided by estimated number of gene clusters per genome (bins below 40% completeness are ignored for this estimate). Local polynomial regression fitting is used in panel (C).</p>
        </caption>
        <graphic xlink:href="lqac060fig2" position="float"/>
      </fig>
    </sec>
    <sec id="SEC3-3">
      <title>Benchmarking mOTUpan against PPanGGOLiN for a <italic toggle="yes">Prochlorococcus_A</italic> genome set</title>
      <p>For a more detailed benchmarking of mOTUpan against PPanGGOLiN, we used a set of 388 genomes from the <italic toggle="yes">Prochlorococcus_A</italic> genus, ranging in completeness from 8.59% to 99.52% (median = 69.05%) according to CheckM (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). For this analysis, we used the gene clusters generated by PPanGGOLiN.</p>
      <p>PPanGGOLiN splits the set of gene clusters by default into three subsets: persistent, shell and cloud. For very complete genomes, the persistent set of gene clusters is close to the core genome, but for more noisy genomes, such as those included in this <italic toggle="yes">Prochlorococcus_A</italic> genome set, the approach is not capturing the entire core genome (Figure <xref rid="F3" ref-type="fig">3</xref>). It is notable that gene clusters identified as ‘persistent’ (316 gene clusters) very likely belong to the core genome, while the ‘shell’ set of genes will normally correspond to frequently co-occurring genes. PPanGGOLiN estimates a total of 1537 gene clusters to be a part of the ‘shell’ category for the <italic toggle="yes">Prochlorococcus_A</italic> gene set. For the same gene set, mOTUpan estimates 1637 gene clusters to be part of the core genome. The core estimate of mOTUpan seems to be close to the sum of ‘persistent’ and ‘shell’ (1853 gene clusters). The three closed genomes have 1883 gene clusters, making the ‘persistent + shell’ estimate probably an overestimate of the core genome. The ‘shell’ set of gene clusters is picking up genes that are probably not all from the core but rather frequently occurring accessory operons. This is shown in the heatmap in Figure <xref rid="F4" ref-type="fig">4</xref>. The gene clusters, which mOTUpan called accessory and PPanGGOLiN called shell, seem to belong to blocks of gene clusters absent in sets of highly complete genomes, hinting at very prevalent operons of accessory genes. Conversely, gene clusters in mOTUpan’s accessory and PPanGGOLiN’s shell seem to be very prevalent gene clusters that have only a diffuse pattern hinting at single mobile genes, for example. This analysis also shows the robustness of mOTUpan to estimate the true core genome from more noisy mOTUs.</p>
      <fig position="float" id="F3">
        <label>Figure 3.</label>
        <caption>
          <p>Rarefaction analysis of mOTUpan’s and PPanGGOLiN’s core-genome prediction on the <italic toggle="yes">Prochlorococcus_A</italic> mOTU. The same analysis was performed on random subsets of the available 388 genomes.</p>
        </caption>
        <graphic xlink:href="lqac060fig3" position="float"/>
      </fig>
      <fig position="float" id="F4">
        <label>Figure 4.</label>
        <caption>
          <p>Distribution of 5985 generated gene clusters from 388 genomes of a <italic toggle="yes">Prochlorococcus_A</italic> mOTU. Each column represents a genome, and each row represents a gene cluster. Presence/absence pattern of each gene cluster in each genome is shown in black and white, respectively. Gene clusters are assigned to different partitions using mOTUpan and PPanGGOLiN estimations. These assignments are shown in the left side of the heatmap as colored columns. Genome stats such as number of contigs, genome length, CheckM completeness and mOTUpan completeness are shown on top of the heatmap.</p>
        </caption>
        <graphic xlink:href="lqac060fig4" position="float"/>
      </fig>
      <p>Calculations of the core genome using mOTUpan with the 3 closed genomes and 16 genomes with completeness &gt;95% of the <italic toggle="yes">Prochlorococcus_A</italic> cluster estimate 1644 gene clusters in the core (1714 ‘persistent’ gene clusters with PPanGGOLiN). This is probably an upper bound to the size of the core of this <italic toggle="yes">Prochlorococcus_A</italic> mOTU, as additional microdiversity and noise would only remove genes from this, making the 1637 gene clusters predicted to make up the core in mOTUpan for the full set a better estimate than either PPanGGOLiN’s ‘shell’ set (316 clusters) or ‘persistent + shell’ set (1853 clusters).</p>
      <p>This generally shows that mOTUpan can predict a core genome very similarly to other state-of-the-art tools, while at the same time being more robust over broader ranges of genome completeness in comparison to those tools.</p>
      <p>In order to get an idea on the effect of completeness on the core-genome estimation using mOTUpan, we generated data for 10000 idealized mOTUpan runs. For each run, one ‘good’ genome (a random genome of completeness &gt;45%, picked randomly) and a variable number of ‘bad’ genomes (of completeness &lt;45%) were picked. Empirical true and false positive rates were computed as in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> to evaluate performance in these hard border cases. The completeness of the ‘good’ genome controls mainly the amount of core genes that can be retrieved (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2A</xref>), and an excess of ‘bad’ genomes seems to reduce the number of core genes retrieved (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2B</xref>). However, increased number of ‘bad’ genomes added can decrease false positive rate (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2C</xref>). Also, there is a large amount of noise around the quality of the prediction; this makes selecting a good set of genomes and parameters complicated. The bootstrapping false positive rate can be of help as it seems to be a good predictor for the true positive rate (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S1B and S2D</xref>).</p>
      <p>Additionally, to show the effect of genome completeness on the core-genome estimation we ran mOTUpan 30 times for random subsets of 100 genomes of the <italic toggle="yes">Prochlorococcus_A</italic> mOTU with estimated completeness in the range of 0–50%, 50–70% and 70–100% (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>). By removing genomes with higher completeness value in the tested subset, mOTUpan expectedly recovers a lower fraction of the core genome.</p>
      <p>mOTUpan can be used in a number of ways. It can obviously be used to study pan-genome structure at large scale and with noisier data. This comes with some caveats; i.e. the method is highly dependent on the gene-clustering method used and it is very hard to evaluate the correctness of these at a larger scale. Additionally, mOTUpan can only classify genes that actually are in the genomes that are analyzed. Accordingly, genes that are hard to assemble or bin (due to different <italic toggle="yes">k</italic>-mer or abundance profiles) will be overlooked, leading to an inevitable underestimate of the accessory genomes. Another known issue is that uneven representations of subclades in a genome set might lead to the core of the dominating subclade to be computed. This, however, is easily spotted by a strong decrease of posterior completeness estimates and mOTUpan will print a warning for these cases. Additionally, initial estimation of completeness could potentially impact the core size calculation by mOTUpan. For those novel taxa that are poorly characterized, we might have an overestimation of completeness for the genomes, which might affect the mOTUpan core size calculation. These effects can be evaluated by the bootstrapping method. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>, the false positive rate computed with the bootstrapping method relates well to the accuracy of the core calculation and should single out if the inputted combination of the bins is problematic. It is to be noted though that the estimated false positive rates are conservative (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>). It has to be noted that in the absence of higher quality genomes in an mOTU, estimates of core genomes will be accurate, but might be very partial. However, using the bootstrapped false positive rates allows us to easily detect problematic cases. Nevertheless, it is the only tool available that can do this type of analysis, and should hence be an invaluable resource for biodiversity exploration and comparative genomics. While PPanGGOLiN is performing very well with noisy data, the specific purpose and scope of this tool are different. PPanGGOLiN can be leveraged if one needs to select and identify core genes to, for example, make a core phylogeny, and mOTUpan is a reliable choice for estimating and exploring the core and/or accessory genome structure. Another important use envisioned for mOTUpan is to strengthen functional predictions for metagenomic projects. Rather than relying on single MAGs where the presence of specific genes can be questioned, mOTUpan can robustly quantify this presence as long as highly similar MAGs are available (which is often the case in medium- to large-scale metagenomic project). Notably, it can be used with a variety of genome-encoded traits, and the currently available version has parsers available for Roary, PPanGGOLiN, eggNOG-mapper (<xref rid="B21" ref-type="bibr">21</xref>), mmseqs2 (<xref rid="B20" ref-type="bibr">20</xref>) and anvi’o (<xref rid="B22" ref-type="bibr">22</xref>), with possibly more to be included later.</p>
      <p>Ultimately, mOTUpan introduces and enables a new type of analysis within the field of microbial genomics, i.e. the usage of presence–absence of genome-encoded traits combined with some Bayesian computation to predict gene content in a genome set. This approach can be expanded into a number of different directions. We can, for example, move from presence–absence to gene count, or use this approach for gene-linkage assessment to estimate whether some traits co-occur more often than by chance.</p>
    </sec>
  </sec>
  <sec sec-type="data-availability" id="SEC4">
    <title>DATA AND CODE AVAILABILITY</title>
    <p>The mOTUpan software is written in Python 3 and is freely available under GPL 3.0 license via GitHub in the mOTUlizer package at <ext-link xlink:href="http://github.com/moritzbuck/mOTUlizer" ext-link-type="uri">github.com/moritzbuck/mOTUlizer</ext-link>. A conda recipe and pip package for user-friendly installation are also available in the appropriate repository. Scripts used for the analyses in this paper can be found at <ext-link xlink:href="http://github.com/moritzbuck/mOTUlizer/tree/master/mOTUlizer/scripts" ext-link-type="uri">github.com/moritzbuck/mOTUlizer/tree/master/mOTUlizer/scripts</ext-link>. The data used for benchmarking are from the GTDB (<xref rid="B3" ref-type="bibr">3</xref>) (release 95), available at <ext-link xlink:href="http://gtdb.ecogenomic.org" ext-link-type="uri">gtdb.ecogenomic.org</ext-link> (with actual genomes at RefSeq and GenBank); GORG-Tropics (<xref rid="B19" ref-type="bibr">19</xref>), available under GenBank at <ext-link xlink:href="PRJEB33281" ext-link-type="DDBJ/EMBL/GenBank">PRJEB33281</ext-link>; and the StratFreshDB (<xref rid="B17" ref-type="bibr">17</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>lqac060_Supplemental_Files</label>
      <media xlink:href="lqac060_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>Bioinformatics analyses were carried out at the Uppsala Multidisciplinary Center for Advanced Computational Science (UPPMAX) at Uppsala University under projects SNIC 2020/5-19 and 2021/5-53. Also big thanks to Julia Nuy and Matthias Hötzinger for some early testing, and Meren for helping me with the anvi’o script.</p>
    <p><italic toggle="yes">Author contributions</italic>: M.B.—conceptualization, programing, analysis, visualization, and writing; M.M.—conceptualization, analysis, visualization, and writing; S.B.—conceptualization and writing.</p>
  </ack>
  <sec id="SEC5">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xlink:href="https://academic.oup.com/nargab/article-lookup/doi/10.1093/nargab/lqac060#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NARGAB Online.</p>
  </sec>
  <sec id="SEC6">
    <title>FUNDING</title>
    <p>Swedish Research Council [2017-04422 and 2018-04685].</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. The authors declare no conflict of interest.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hug</surname><given-names>L.A.</given-names></string-name>, <string-name><surname>Baker</surname><given-names>B.J.</given-names></string-name>, <string-name><surname>Anantharaman</surname><given-names>K.</given-names></string-name>, <string-name><surname>Brown</surname><given-names>C.T.</given-names></string-name>, <string-name><surname>Probst</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Castelle</surname><given-names>C.J.</given-names></string-name>, <string-name><surname>Butterfield</surname><given-names>C.N.</given-names></string-name>, <string-name><surname>Hernsdorf</surname><given-names>A.W.</given-names></string-name>, <string-name><surname>Amano</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Ise</surname><given-names>K.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A new view of the tree of life</article-title>. <source>Nat. Microbiol.</source><year>2016</year>; <volume>1</volume>:<fpage>16048</fpage>.<pub-id pub-id-type="pmid">27572647</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nayfach</surname><given-names>S.</given-names></string-name>, <string-name><surname>Roux</surname><given-names>S.</given-names></string-name>, <string-name><surname>Seshadri</surname><given-names>R.</given-names></string-name>, <string-name><surname>Udwary</surname><given-names>D.</given-names></string-name>, <string-name><surname>Varghese</surname><given-names>N.</given-names></string-name>, <string-name><surname>Schulz</surname><given-names>F.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>D.</given-names></string-name>, <string-name><surname>Paez-Espino</surname><given-names>D.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>I.-M.</given-names></string-name>, <string-name><surname>Huntemann</surname><given-names>M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A genomic catalog of Earth’s microbiomes</article-title>. <source>Nat. Biotechnol.</source><year>2021</year>; <volume>39</volume>:<fpage>499</fpage>–<lpage>509</lpage>.<pub-id pub-id-type="pmid">33169036</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parks</surname><given-names>D.H.</given-names></string-name>, <string-name><surname>Chuvochina</surname><given-names>M.</given-names></string-name>, <string-name><surname>Chaumeil</surname><given-names>P.-A.</given-names></string-name>, <string-name><surname>Rinke</surname><given-names>C.</given-names></string-name>, <string-name><surname>Mussig</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Hugenholtz</surname><given-names>P.</given-names></string-name></person-group><article-title>A complete domain-to-species taxonomy for Bacteria and Archaea</article-title>. <source>Nat. Biotechnol.</source><year>2020</year>; <volume>38</volume>:<fpage>1079</fpage>–<lpage>1086</lpage>.<pub-id pub-id-type="pmid">32341564</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brockhurst</surname><given-names>M.A.</given-names></string-name>, <string-name><surname>Harrison</surname><given-names>E.</given-names></string-name>, <string-name><surname>Hall</surname><given-names>J. P.J.</given-names></string-name>, <string-name><surname>Richards</surname><given-names>T.</given-names></string-name>, <string-name><surname>McNally</surname><given-names>A.</given-names></string-name>, <string-name><surname>MacLean</surname><given-names>C.</given-names></string-name></person-group><article-title>The ecology and evolution of pangenomes</article-title>. <source>Curr. Biol.</source><year>2019</year>; <volume>29</volume>:<fpage>R1094</fpage>–<lpage>R1103</lpage>.<pub-id pub-id-type="pmid">31639358</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Medini</surname><given-names>D.</given-names></string-name>, <string-name><surname>Donati</surname><given-names>C.</given-names></string-name>, <string-name><surname>Tettelin</surname><given-names>H.</given-names></string-name>, <string-name><surname>Masignani</surname><given-names>V.</given-names></string-name>, <string-name><surname>Rappuoli</surname><given-names>R.</given-names></string-name></person-group><article-title>The microbial pan-genome</article-title>. <source>Curr. Opin. Genet. Dev.</source><year>2005</year>; <volume>15</volume>:<fpage>589</fpage>–<lpage>594</lpage>.<pub-id pub-id-type="pmid">16185861</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Domingo-Sananes</surname><given-names>M.R.</given-names></string-name>, <string-name><surname>McInerney</surname><given-names>J.O.</given-names></string-name></person-group><article-title>Mechanisms that shape microbial pangenomes</article-title>. <source>Trends Microbiol.</source><year>2021</year>; <volume>29</volume>:<fpage>493</fpage>–<lpage>503</lpage>.<pub-id pub-id-type="pmid">33423895</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gil</surname><given-names>R.</given-names></string-name>, <string-name><surname>Latorre</surname><given-names>A.</given-names></string-name></person-group><article-title>Factors behind junk DNA in bacteria</article-title>. <source>Genes</source>. <year>2012</year>; <volume>3</volume>:<fpage>634</fpage>–<lpage>650</lpage>.<pub-id pub-id-type="pmid">24705080</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Biller</surname><given-names>S.J.</given-names></string-name>, <string-name><surname>Berube</surname><given-names>P.M.</given-names></string-name>, <string-name><surname>Lindell</surname><given-names>D.</given-names></string-name>, <string-name><surname>Chisholm</surname><given-names>S.W.</given-names></string-name></person-group><article-title><italic toggle="yes">Prochlorococcus</italic>: the structure and function of collective diversity</article-title>. <source>Nat. Rev. Microbiol.</source><year>2015</year>; <volume>13</volume>:<fpage>13</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">25435307</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>J.</given-names></string-name>, <string-name><surname>Shu</surname><given-names>C.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>X.</given-names></string-name>, <string-name><surname>Yu</surname><given-names>X.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>D.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>G.</given-names></string-name>, <string-name><surname>Hu</surname><given-names>S.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A pangenomic study of <italic toggle="yes">Bacillus thuringiensis</italic></article-title>. <source>J. Genet. Genomics</source>. <year>2011</year>; <volume>38</volume>:<fpage>567</fpage>–<lpage>576</lpage>.<pub-id pub-id-type="pmid">22196399</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blaustein</surname><given-names>R.A.</given-names></string-name>, <string-name><surname>McFarland</surname><given-names>A.G.</given-names></string-name>, <string-name><surname>Ben Maamar</surname><given-names>S.</given-names></string-name>, <string-name><surname>Lopez</surname><given-names>A.</given-names></string-name>, <string-name><surname>Castro-Wallace</surname><given-names>S.</given-names></string-name>, <string-name><surname>Hartmann</surname><given-names>E.M.</given-names></string-name></person-group><article-title>Pangenomic approach to understanding microbial adaptations within a model built environment, the international space station, relative to human hosts and soil</article-title>. <source>mSystems</source>. <year>2019</year>; <volume>4</volume>:<fpage>e00281-18</fpage>.<pub-id pub-id-type="pmid">30637341</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Delmont</surname><given-names>T.O.</given-names></string-name>, <string-name><surname>Eren</surname><given-names>A.M.</given-names></string-name></person-group><article-title>Linking pangenomes and metagenomes: the <italic toggle="yes">Prochlorococcus</italic> metapangenome</article-title>. <source>PeerJ</source>. <year>2018</year>; <volume>6</volume>:<fpage>e4320</fpage>.<pub-id pub-id-type="pmid">29423345</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>López-Pérez</surname><given-names>M.</given-names></string-name>, <string-name><surname>Rodriguez-Valera</surname><given-names>F.</given-names></string-name></person-group><article-title>Pangenome evolution in the marine bacterium <italic toggle="yes">Alteromonas</italic></article-title>. <source>Genome Biol. Evol.</source><year>2016</year>; <volume>8</volume>:<fpage>1556</fpage>–<lpage>1570</lpage>.<pub-id pub-id-type="pmid">27189983</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deschamps</surname><given-names>P.</given-names></string-name>, <string-name><surname>Zivanovic</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Moreira</surname><given-names>D.</given-names></string-name>, <string-name><surname>Rodriguez-Valera</surname><given-names>F.</given-names></string-name>, <string-name><surname>López-García</surname><given-names>P.</given-names></string-name></person-group><article-title>Pangenome evidence for extensive interdomain horizontal transfer affecting lineage core and shell genes in uncultured planktonic Thaumarchaeota and Euryarchaeota</article-title>. <source>Genome Biol. Evol.</source><year>2014</year>; <volume>6</volume>:<fpage>1549</fpage>–<lpage>1563</lpage>.<pub-id pub-id-type="pmid">24923324</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Page</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Cummins</surname><given-names>C.A.</given-names></string-name>, <string-name><surname>Hunt</surname><given-names>M.</given-names></string-name>, <string-name><surname>Wong</surname><given-names>V.K.</given-names></string-name>, <string-name><surname>Reuter</surname><given-names>S.</given-names></string-name>, <string-name><surname>Holden</surname><given-names>M. T.G.</given-names></string-name>, <string-name><surname>Fookes</surname><given-names>M.</given-names></string-name>, <string-name><surname>Falush</surname><given-names>D.</given-names></string-name>, <string-name><surname>Keane</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Parkhill</surname><given-names>J.</given-names></string-name></person-group><article-title>Roary: rapid large-scale prokaryote pan genome analysis</article-title>. <source>Bioinformatics (England)</source>. <year>2015</year>; <volume>31</volume>:<fpage>3691</fpage>–<lpage>3693</lpage>.</mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gautreau</surname><given-names>G.</given-names></string-name>, <string-name><surname>Bazin</surname><given-names>A.</given-names></string-name>, <string-name><surname>Gachet</surname><given-names>M.</given-names></string-name>, <string-name><surname>Planel</surname><given-names>R.</given-names></string-name>, <string-name><surname>Burlot</surname><given-names>L.</given-names></string-name>, <string-name><surname>Dubois</surname><given-names>M.</given-names></string-name>, <string-name><surname>Perrin</surname><given-names>A.</given-names></string-name>, <string-name><surname>Médigue</surname><given-names>C.</given-names></string-name>, <string-name><surname>Calteau</surname><given-names>A.</given-names></string-name>, <string-name><surname>Cruveiller</surname><given-names>S.</given-names></string-name><etal>et al</etal>.</person-group><article-title>PPanGGOLiN: depicting microbial diversity via a partitioned pangenome graph</article-title>. <source>PLOS Comput. Biol.</source><year>2020</year>; <volume>16</volume>:<fpage>e1007732</fpage>.<pub-id pub-id-type="pmid">32191703</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parks</surname><given-names>D.H.</given-names></string-name>, <string-name><surname>Imelfort</surname><given-names>M.</given-names></string-name>, <string-name><surname>Skennerton</surname><given-names>C.T.</given-names></string-name>, <string-name><surname>Hugenholtz</surname><given-names>P.</given-names></string-name>, <string-name><surname>Tyson</surname><given-names>G.W.</given-names></string-name></person-group><article-title>CheckM: assessing the quality of microbial genomes recovered from isolates, single cells, and metagenomes</article-title>. <source>Genome Res.</source><year>2015</year>; <volume>25</volume>:<fpage>1043</fpage>–<lpage>1055</lpage>.<pub-id pub-id-type="pmid">25977477</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buck</surname><given-names>M.</given-names></string-name>, <string-name><surname>Garcia</surname><given-names>S.L.</given-names></string-name>, <string-name><surname>Fernandez</surname><given-names>L.</given-names></string-name>, <string-name><surname>Martin</surname><given-names>G.</given-names></string-name>, <string-name><surname>Martinez-Rodriguez</surname><given-names>G.A.</given-names></string-name>, <string-name><surname>Saarenheimo</surname><given-names>J.</given-names></string-name>, <string-name><surname>Zopfi</surname><given-names>J.</given-names></string-name>, <string-name><surname>Bertilsson</surname><given-names>S.</given-names></string-name>, <string-name><surname>Peura</surname><given-names>S.</given-names></string-name></person-group><article-title>Comprehensive dataset of shotgun metagenomes from oxygen stratified freshwater lakes and ponds</article-title>. <source>Sci. Data</source>. <year>2021</year>; <volume>8</volume>:<fpage>131</fpage>.<pub-id pub-id-type="pmid">33990618</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chaumeil</surname><given-names>P.-A.</given-names></string-name>, <string-name><surname>Mussig</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Hugenholtz</surname><given-names>P.</given-names></string-name>, <string-name><surname>Parks</surname><given-names>D.H.</given-names></string-name></person-group><article-title>GTDB-Tk: a toolkit to classify genomes with the Genome Taxonomy Database</article-title>. <source>Bioinformatics</source>. <year>2020</year>; <volume>36</volume>:<fpage>1925</fpage>–<lpage>1927</lpage>.</mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pachiadaki</surname><given-names>M.G.</given-names></string-name>, <string-name><surname>Brown</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Brown</surname><given-names>J.</given-names></string-name>, <string-name><surname>Bezuidt</surname><given-names>O.</given-names></string-name>, <string-name><surname>Berube</surname><given-names>P.M.</given-names></string-name>, <string-name><surname>Biller</surname><given-names>S.J.</given-names></string-name>, <string-name><surname>Poulton</surname><given-names>N.J.</given-names></string-name>, <string-name><surname>Burkart</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Clair</surname><given-names>J.J.L.</given-names></string-name>, <string-name><surname>Chisholm</surname><given-names>S.W.</given-names></string-name>, <string-name><surname>Stepanauskas</surname><given-names>R.</given-names></string-name></person-group><article-title>Charting the complexity of the marine microbiome through single-cell genomics</article-title>. <source>Cell</source>. <year>2019</year>; <volume>179</volume>:<fpage>1623</fpage>–<lpage>1635</lpage>.<pub-id pub-id-type="pmid">31835036</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M.</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J.</given-names></string-name></person-group><article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>. <source>Nat. Biotechnol.</source><year>2017</year>; <volume>35</volume>:<fpage>1026</fpage>–<lpage>1028</lpage>.<pub-id pub-id-type="pmid">29035372</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cantalapiedra</surname><given-names>C.P.</given-names></string-name>, <string-name><surname>Hernández-Plaza</surname><given-names>A.</given-names></string-name>, <string-name><surname>Letunic</surname><given-names>I.</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P.</given-names></string-name>, <string-name><surname>Huerta-Cepas</surname><given-names>J.</given-names></string-name></person-group><article-title>eggNOG-mapper v2: functional annotation, orthology assignments, and domain prediction at the metagenomic scale</article-title>. <source>Mol. Biol. Evol.</source><year>2021</year>; <volume>38</volume>:<fpage>5825</fpage>–<lpage>5829</lpage>.<pub-id pub-id-type="pmid">34597405</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eren</surname><given-names>M.A.</given-names></string-name>, <string-name><surname>Kiefl</surname><given-names>E.</given-names></string-name>, <string-name><surname>Shaiber</surname><given-names>A.</given-names></string-name>, <string-name><surname>Veseli</surname><given-names>I.</given-names></string-name>, <string-name><surname>Miller</surname><given-names>S.E.</given-names></string-name>, <string-name><surname>Schechter</surname><given-names>M.S.</given-names></string-name>, <string-name><surname>Fink</surname><given-names>I.</given-names></string-name>, <string-name><surname>Pan</surname><given-names>J.N.</given-names></string-name>, <string-name><surname>Yousef</surname><given-names>M.</given-names></string-name>, <string-name><surname>Fogarty</surname><given-names>E.C.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Community-led, integrated, reproducible multi-omics with anvi’o</article-title>. <source>Nat. Microbiol.</source><year>2021</year>; <volume>6</volume>:<fpage>3</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">33349678</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
