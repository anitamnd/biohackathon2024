<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8442444</article-id>
    <article-id pub-id-type="publisher-id">7948</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-021-07948-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Microbial trend analysis for common dynamic trend, group comparison, and classification in longitudinal microbiome study</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Chan</given-names>
        </name>
        <address>
          <email>Chan.Wang@nyulangone.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Jiyuan</given-names>
        </name>
        <address>
          <email>Jiyuan.Hu@nyulangone.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Blaser</surname>
          <given-names>Martin J.</given-names>
        </name>
        <address>
          <email>martin.blaser@cabm.rutgers.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8288-7068</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Huilin</given-names>
        </name>
        <address>
          <email>Huilin.Li@nyulangone.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.137628.9</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8753</institution-id><institution>Division of Biostatistics, Department of Population Health, New York University School of Medicine, </institution></institution-wrap>New York, 10016 NY USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.430387.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8796</institution-id><institution>Center for Advanced Biotechnology and Medicine, Rutgers University, </institution></institution-wrap>Piscataway, 08854-8021 NJ USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>667</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The human microbiome is inherently dynamic and its dynamic nature plays a critical role in maintaining health and driving disease. With an increasing number of longitudinal microbiome studies, scientists are eager to learn the comprehensive characterization of microbial dynamics and their implications to the health and disease-related phenotypes. However, due to the challenging structure of longitudinal microbiome data, few analytic methods are available to characterize the microbial dynamics over time.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose a microbial trend analysis (MTA) framework for the high-dimensional and phylogenetically-based longitudinal microbiome data. In particular, MTA can perform three tasks: 1) capture the common microbial dynamic trends for a group of subjects at the community level and identify the dominant taxa; 2) examine whether or not the microbial overall dynamic trends are significantly different between groups; 3) classify an individual subject based on its longitudinal microbial profiling. Our extensive simulations demonstrate that the proposed MTA framework is robust and powerful in hypothesis testing, taxon identification, and subject classification. Our real data analyses further illustrate the utility of MTA through a longitudinal study in mice.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The proposed MTA framework is an attractive and effective tool in investigating dynamic microbial pattern from longitudinal microbiome studies.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at (10.1186/s12864-021-07948-w).</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Composition</kwd>
      <kwd>Classification</kwd>
      <kwd>Dynamic</kwd>
      <kwd>High dimensionality</kwd>
      <kwd>Hypothesis testing</kwd>
      <kwd>Longitudinal microbiome</kwd>
      <kwd>Phylogenetic tree</kwd>
      <kwd>Variable selection</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000009</institution-id>
            <institution>foundation for the national institutes of health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01DK110014</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000009</institution-id>
            <institution>foundation for the national institutes of health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U01AI22285</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>The Fondation Leducq Transatlantic Network</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>The Zlinkoff and C&amp;D Funds</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000009</institution-id>
            <institution>foundation for the national institutes of health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1P20CA252728</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The human microbiota represents a complex and rich ecosystem of over 100 trillion microbial cells, playing a fundamental role in maintaining health and driving disease [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Considering that the human microbiota is inherently dynamic and can be substantially altered by many factors at any time point either temporally or permanently, recent microbiome studies [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR8">8</xref>] have shifted their research design from cross-sectional or case-control studies to longitudinal analyses. Rather than untangling the associations between microbes and a wide range of diseases at a fixed time point [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR13">13</xref>], longitudinal microbiome studies target understanding how the dynamic changes in microbiome are linked with disease susceptibility. For example, the Integrative Human Microbiome Project [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>] was designed to comprehensively characterize the dynamic changes in human microbiome in three disease-specific cohorts: pregnancy and preterm birth, onset of inflammatory bowel disease (IBD), and onset of type 2 diabetes. Thaiss (2018) [<xref ref-type="bibr" rid="CR5">5</xref>] found that the microbiome underwent oscillations in composition, functional activity, and localization over the course of a day and these dynamic patterns were aberrant in obesity. Lloyd-Price et al. (2019) [<xref ref-type="bibr" rid="CR6">6</xref>] reported that periods of IBD disease activity were distinguished by increases in temporal variability of gut microbiome, with taxonomic, functional, and biochemical shifts of microbiota. Such scientific results provide insights into the characterization of the microbial dynamics and raise further questions about understanding these underlying microbial dynamics as well. Do the microbial dynamics significantly relate or contribute to the group differentials? If so, which specific microbes dominate them? Can subjects be classified based on their microbial dynamics?</p>
    <p>To address such questions, recent efforts have focused on analyzing the longitudinal microbiome data. Several parametric methods have been proposed to elucidate the microbial dynamic changes, including mixed-effects model [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>], generalized Lotka-Volterra equations [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>], time series models [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR21">21</xref>], and state-space models [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. While those methods provide capabilities to capture the microbial dynamics and identify the time-dependent taxa, they assume that the microbial abundance changes at a fixed rate, in the autoregressive or autoregressive integrated moving average pattern, or following the Markov process, which cannot always be justified and implemented because of the limited sample size. In contrast, spline-based approaches [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] are proposed to examine whether one taxon’s changing pattern over time or within a time interval is significantly different between two groups or not with permutation test. MetaLonDA [<xref ref-type="bibr" rid="CR24">24</xref>] models the mapped read counts by a negative binomial (NB) distribution and fits the longitudinal profiles in each phenotypic group with NB smoothing splines. While a nonparametric approach Permuspliner [<xref ref-type="bibr" rid="CR25">25</xref>] uses the loess spline for the relative abundance. However, since these methods need to do the modeling or testing taxon by taxon, the large number of taxa can inevitably affect the statistical power after the multiple testing corrections, even at high taxonomic ranks.</p>
    <p>To support the comprehensive analyses in the longitudinal microbiome data, we propose a microbial trend analysis (MTA) as a complementary tool which can capture the overall community level microbial dynamic pattern for a group of subjects. In particular, following the path of the principal trend analysis (PTA) [<xref ref-type="bibr" rid="CR26">26</xref>], MTA integrates the spline-based method for time-course data analysis and principal component analysis for dimension reduction to extract the dynamic patterns from a group of subjects. Matrix decomposition and lasso technique are used to address the high-dimensionality feature as in PTA, and the graph Laplacian penalty [<xref ref-type="bibr" rid="CR27">27</xref>–<xref ref-type="bibr" rid="CR30">30</xref>] is additionally used to incorporate phylogenetic tree structure, the unique feature of microbiome data, into the analysis. In combination, these help MTA to identify the dominant taxa that contribute to the common trends simultaneously. To make MTA hold practical value in the microbiome research, we further propose: 1) a microbial trend group differential test to confirm the statistical significance of the group comparison and identify the key taxa contributing to the group differential trend, and 2) a distance-based classification algorithm to assign a group label to a given subject.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p>There are three components of the proposed MTA framework: MTA model, group comparison, and classification algorithm, based on the longitudinal microbiome data. Its workflow is illurstrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref> and the detailed method is provided in the Methods section. Briefly, for <italic>N</italic> subjects in a given group with the relative abundance <italic>Y</italic><sub><italic>npt</italic></sub> for the <italic>n</italic><sup>th</sup> subject of the <italic>p</italic><sup>th</sup> taxon at the <italic>t</italic><sup>th</sup> time point, <italic>n</italic>=1,…,<italic>N</italic>,<italic>t</italic>=1,…,<italic>T</italic>, and <italic>p</italic>=1,…,<italic>P</italic>, we first propose a nonlinear iterative algorithm (Algorithm 1, MTA model) to extract the common trends shared by all <italic>N</italic> subjects, identify the dominant taxa, and estimate their contributions to the common trends. Next, we propose a group differential test (Algorithm 2) to evaluate how different two groups are and quantify the differentiating taxa if the group difference is significant. At last, we propose a distance-based classification algorithm (Algorithm 3) to classify subjects based on their longitudinal microbial profiling. In the following, we explore the performance of MTA through the simulation study and illustrate the utility of MTA to investigate the relationship between antibiotic usage and the microbial dynamics using a longitudinal murine study.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow of the microbial trend analysis (MTA) framework, which consists of three components: MTA model, group comparison, and classification</p></caption><graphic xlink:href="12864_2021_7948_Fig1_HTML" id="MO1"/></fig></p>
    <p>
      <graphic position="anchor" xlink:href="12864_2021_7948_Figa_HTML" id="MO9"/>
    </p>
    <p>
      <graphic position="anchor" xlink:href="12864_2021_7948_Figb_HTML" id="MO10"/>
    </p>
    <p>
      <graphic position="anchor" xlink:href="12864_2021_7948_Figc_HTML" id="MO8"/>
    </p>
    <sec id="Sec3">
      <title>Simulation results</title>
      <p>We constructed extensive simulations to evaluate the performance of the proposed MTA method in both group comparison (Algorithm 2) and classification (Algorithm 3). Specifically, the performance of group comparison is evaluated in terms of the empirical type I error rate and statistical power at the group level, as well as in terms of sensitivity and specificity at the taxon level, compared to the competing methods Permuspliner [<xref ref-type="bibr" rid="CR25">25</xref>], MetaLonDA [<xref ref-type="bibr" rid="CR24">24</xref>], and LonGP [<xref ref-type="bibr" rid="CR16">16</xref>]. Note that Permuspliner, MetaLonDA, and LonGP all do the analysis taxon by taxon. Permuspliner and MetaLonDA are strategically similar in terms of testing the group differential, but MetaLonDA has a poorer performance. Meanwhile, LonGP, as a Baysian method, provides the component relevance and corresponding selection with a given threshold based on the linear mixed model, rather than a testing <italic>p</italic>-value, and its sampling procedure to determine the prior parameters is time-consuming. Comparisons in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S6 show that LonGP does not have the competitive sensitivities either. We include only Permuspliner in this section and report all the other comparisons in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S6. Permuspliner tests the differences in microbial abundance between two groups over the longitudinal time course based on the loess splines [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. We evaluated the performance of classification in terms of receiver operating characteristic (ROC) curve and area under the curve (AUC) [<xref ref-type="bibr" rid="CR33">33</xref>].</p>
      <sec id="Sec4">
        <title>Simulation results for group comparison</title>
        <p>Since the common trends extracted by Algorithm 2 manifest the difference between case and control groups and have a hierarchical structure as well, the overall empirical type I error rate and power for the proposed MTA method are defined as the proportion of the adjusted <italic>p</italic>-values for the first common trend less than the given significance level (usually 5%) with 1000 independent replications under the null and alternative hypotheses respectively. Since the competing method Permuspliner works at the taxon level and only provides the individual <italic>p</italic>-value for each taxon separately, its overall type I error rate and power are calculated as the proportion of at least one taxon that has a significant adjusted <italic>p</italic>-value with the Benjamini-Hochberg (BH) correction for multiple comparisons [<xref ref-type="bibr" rid="CR34">34</xref>]. The number of resamplings in Algorithm 2 is set as <italic>R</italic>=50.</p>
        <p><bold>Type I error rate and power.</bold> The first group of bars in each subfigure of Fig. <xref rid="Fig2" ref-type="fig">2</xref> reports the empirical type I error rates of the proposed MTA method and the competing method Permuspliner. They are all around the nominal significance level 5%, except that when sample size <italic>N</italic>=20 and the number of time points <italic>T</italic>=20, both methods, especially Permuspliner, have slightly conservative type I error rates. Thus, both are statistically valid tests to differenciate microbial dynamic patterns between groups in the longitudinal study.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Empirical type I error rate and power (%) for testing the difference between case and control groups with sample size <italic>N</italic>=20,30 and the number of time points <italic>T</italic>=10,20 in null model and scenarios 1-3, respectively. The dashed line represents the given significance level 5%</p></caption><graphic xlink:href="12864_2021_7948_Fig2_HTML" id="MO2"/></fig></p>
        <p>The scenarios 1-3 in each subfigure of Fig. <xref rid="Fig2" ref-type="fig">2</xref> report the estimated powers of both methods with sample size <italic>N</italic>=20,30 and the number of time points <italic>T</italic>=10,20, respectively. The relative performance of these two methods is similar across scenarios 1-3 in all combinations of <italic>N</italic> and <italic>T</italic>. MTA is more powerful than Permuspliner in most scenarios, especially when the number of time points is large at <italic>T</italic>=20. In addition, the power of MTA increases as <italic>N</italic> or <italic>T</italic> increases. Taking scenario 2 as an example, the estimated power of MTA increases from 37.1% with <italic>N</italic>=20 and <italic>T</italic>=10 to 66.0% with <italic>N</italic>=30 and <italic>T</italic>=10, and to 90.5% with <italic>N</italic>=30 and <italic>T</italic>=20. The number of time points <italic>T</italic> has an effect on the power of the competing method Permuspliner, since increasing time points from 10 to 20 diminishes its power dramatically in all scenarios. This is because Permuspliner is based on the area under the microbial splines across all time points to evaluate dynamic patterns. The area under the curve method is most effective when the temporal trend difference between the compared groups is relatively consistent along time, i.e. one trajectory is always above the other. However, when the microbial trends from two groups cross over, which is more likely to happen when the observed time period is longer, the differences between the areas under two curves balance out. Accordingly Permuspliner’s power is reduced in differentiating dynamic patterns. Since in practice, microbial dynamic patterns are nonlinear and the group changing trends are more likely to intersect, as supported by our real data in Fig. <xref rid="Fig6" ref-type="fig">6</xref>, the proposed MTA method has superior power.</p>
        <p><bold>Sensitivity and specificity.</bold> The estimated powers above illustrate that the proposed MTA method has superior performance in testing the differences between two groups than the competing method Permuspliner at the group level. We further evaluate the performance of both methods at the taxon level in terms of sensitivity and specificity. Specifically, sensitivity is defined as the proportion of taxa correctly identified from 5 dominant taxa that truly contribute to the difference between two groups, and specificity is the proportion of uninvolved taxa that are correctly identified as such. Furthermore, the proposed MTA method determines whether a taxon is significantly contributing or not by the estimated confidence interval of its factor score with the number of resamplings <italic>R</italic>=50 in Algorithm 2. For the competing method Permuspliner, the adjusted <italic>p</italic>-value with BH multiple comparison correction determines whether a taxon is significantly different between two groups or not.</p>
        <p>Figure <xref rid="Fig3" ref-type="fig">3</xref> presents the estimated sensitivity and specificity of the MTA and Permuspliner methods for identifying the dominant taxa that contribute to the microbial dynamic differences between control and case groups, with sample size <italic>N</italic>=20,30 and the number of time points <italic>T</italic>=10,20 in scenarios 1-3, respectively. The proposed MTA method has much higher sensitivity and sufficiently high specificity in all scenarios compared to Permuspliner, although Permuspliner has slightly higher specificity. This indicates that MTA has the ability to identify not only dominant taxa but also those inactive ones. But Permuspliner suffers from the limited sensitivity in identifying dominant taxa reliably, especially with <italic>T</italic>=20, which agrees with its conservative performance in the power section. Thus, the proposed MTA method has better performance in identifying whether or not taxa are dominant than Permuspliner in the taxonomic analysis.
<fig id="Fig3"><label>Fig. 3</label><caption><p>The estimated sensitivity and specificity for identifying the dominant taxa which contribute to the extracted trends with sample size <italic>N</italic>=20,30 and the number of time points <italic>T</italic>=10,20 in scenarios 1-3, respectively</p></caption><graphic xlink:href="12864_2021_7948_Fig3_HTML" id="MO3"/></fig></p>
        <p>Furthermore, the proposed MTA method has the distinct advantage that it not only identifies the dominant taxa that contribute to the extracted common trends, but also quantifies their contributions by the estimated factor scores. This suggests their individual effects on the difference between two groups and provides additional insights for followup studies. Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figures S1–S3 report the extracted group difference trends and the estimated factor scores for the corresponding dominant taxa in scenarios 1-3 with <italic>N</italic>=30 and <italic>T</italic>=10 respectively, produced by our MTA R package.</p>
        <p><bold>Simulation results based on the simulation design used in Permuspliner method.</bold> To assess the robustness of the proposed MTA method, we further evaluated both methods using the simulation design in the original Permuspliner report [<xref ref-type="bibr" rid="CR25">25</xref>], which is shown in detail in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S1. When the effect directions of the signal taxa at different time points are mixed, the relative performance of MTA and Permuspliner is quite similar to that reported above (the “Simulation results for group comparison” section). MTA exhibits general superior performance in both group and taxon levels evaluation (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figures S4(A) and S5(A)). When the effects of the signal taxon across all the time points are in the same direction, which becomes less likely as the number of time points increases, Permuspliner has higher power than MTA, since Permuspliner directly measures the area between the microbial splines of control and case groups for each taxon. However, as the effect size gets larger, the estimated powers of MTA and Permuspliner become similar (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4(B)). Furthermore, MTA has similar performance with Permuspliner in terms of sensitivity and specificity (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S5(B)). Therefore, considering that the same effect direction across a long period is less likely, the proposed MTA method is robust and has superior performance to Permuspliner in terms of statistical power at the group level, as well as in terms of sensitivity and specificity at the taxonomic level.</p>
      </sec>
      <sec id="Sec5">
        <title>Simulation results for classification</title>
        <p>In this subsection, we evaluate the performance of the proposed classification Algorithm 3 in terms of ROC curve and AUC using the 10-fold cross-validation (CV) method based on scenario 2 with different effect sizes. Specifically, we simulated the microbial relative abundances for 300 cases and 300 controls, where <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta }_{.t}^{1}$\end{document}</tex-math><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>.t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta }_{.t}^{2}$\end{document}</tex-math><mml:math id="M4"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>.t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq2.gif"/></alternatives></inline-formula> were assigned as below, 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}  \boldsymbol{\beta}_{.t}^{1} &amp;= (-1, 2, -1)' \times \text{min}(|e\times \text{sin}(t)|,\beta_{0p}/2)\\ &amp;\times \text{sign}(\text{sin}(t)), \ p\in\wedge_{1}; \end{array} $$ \end{document}</tex-math><mml:math id="M6"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>.t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:mtext>min</mml:mtext><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mi>e</mml:mi><mml:mo>×</mml:mo><mml:mtext>sin</mml:mtext><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>×</mml:mo><mml:mtext>sign</mml:mtext><mml:mo>(</mml:mo><mml:mtext>sin</mml:mtext><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mo>∧</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2021_7948_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>
          <disp-formula id="Equ2">
            <label>2</label>
            <alternatives>
              <tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}  \boldsymbol{\beta}_{.t}^{2} &amp;= (-1, 1)' \times \text{min}(|e\times \text{sin}(2t)|,\beta_{0p})\\ &amp;\times \text{sign}(\text{sin}(2t)), \ p\in\wedge_{2}, \end{array} $$ \end{document}</tex-math>
              <mml:math id="M8">
                <mml:mtable class="align" columnalign="left">
                  <mml:mtr>
                    <mml:mtd class="align-1">
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">β</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>.t</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mtd>
                    <mml:mtd class="align-2">
                      <mml:mo>=</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>,</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>′</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>×</mml:mo>
                      <mml:mtext>min</mml:mtext>
                      <mml:mo>(</mml:mo>
                      <mml:mo>|</mml:mo>
                      <mml:mi>e</mml:mi>
                      <mml:mo>×</mml:mo>
                      <mml:mtext>sin</mml:mtext>
                      <mml:mo>(</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mi>t</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>|</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>β</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>)</mml:mo>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd class="align-1"/>
                    <mml:mtd class="align-2">
                      <mml:mo>×</mml:mo>
                      <mml:mtext>sign</mml:mtext>
                      <mml:mo>(</mml:mo>
                      <mml:mtext>sin</mml:mtext>
                      <mml:mo>(</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mi>t</mml:mi>
                      <mml:mo>)</mml:mo>
                      <mml:mo>)</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="1em"/>
                      <mml:mi>p</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>∧</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="12864_2021_7948_Article_Equ2.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <italic>e</italic> is the magnitude of effect size and was assigned as 1, 2, 4, 6 and 8, respectively and sign(·) is the sign function. We then randomly divided the 600 subjects into 10 groups of equal size, each of which was in turn used as a testing set to classify a new subject, while the rest were used as a training set to establish the predicted microbial composition matrix for the control and case groups. The ROC curve and AUC were estimated as the average performance over 10 testing sets.</p>
        <p>Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S6 and Fig. <xref rid="Fig4" ref-type="fig">4</xref> present the overall ROC curves and AUCs with effect size <italic>e</italic>=1,2,4,6,8, and the number of time points <italic>T</italic>=10,20, respectively. As expected, AUC increases as the effect size <italic>e</italic> increases, with the average AUC being 0.63, 0.76, 0.88, 0.95 and 0.96 for <italic>e</italic>=1,2,4,6,8 respectively. These results show that the proposed MTA framework has satisfactory performance to classify.
<fig id="Fig4"><label>Fig. 4</label><caption><p>The classification performance of the proposed MTA framework with the number of time points <italic>T</italic>=20. (<bold>a</bold>) The overall ROC curves. (<bold>b</bold>) The mean and standard error of AUCs under various effect sizes based on 10-fold CV</p></caption><graphic xlink:href="12864_2021_7948_Fig4_HTML" id="MO4"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec6">
      <title>Real data analysis</title>
      <p>Livanos et al. (2016) [<xref ref-type="bibr" rid="CR35">35</xref>] conducted a longitudinal microbiome experiment in mice at risk for developing Type I diabetes (T1D). They found that early exposure to antibiotics altered the gut microbiota and this shift accelerated T1D onset compared to control mice. Here we apply the proposed MTA method to the longitudinal microbiome data collected in this experiment to examine the changing microbial trend differences between the STAT (antibiotic) and control groups. Specifically, MTA determines whether the overall dynamic patterns present in the STAT and control groups are significantly different or not, identifies which taxa contribute to the identified overall group difference, and subsequently provides the corresponding estimated factor scores for those identified taxa. Algorithm 3 in the MTA framework then is applied to classify the mice based on their longitudinal microbial profiles.</p>
      <p>In this study, the fecal samples collected from antibiotic and control mice at 3, 6, 10, and 13 weeks were sequenced to examine their 16S rRNA genes, and their median sequencing depths were 12,524±3,295 sequences. The OTU table and taxonomy were determined using the QIIME pipeline [<xref ref-type="bibr" rid="CR36">36</xref>], and 106 genera were originally observed. As indicated in the “Simulation design” section, we analyzed 35 genera in 17 antibiotic and 20 control male mice at 3, 6, 10 and 13 weeks.</p>
      <p>Figure <xref rid="Fig5" ref-type="fig">5</xref>a reports the primary significant microbial trend determined by the MTA method, with <italic>p</italic>-value 9.8×10<sup>−10</sup>, representing the major difference in the microbial dynamic pattern between antibiotic and control male mice. With MTA, based on the 35 genera, we identify 5 dominant genera (<italic>Lactobacillus</italic>, <italic>Lachnospiraceae_Other</italic>, <italic>S24-7_Other</italic>, <italic>Akkermansia</italic>, and <italic>Allobaculum</italic>) that contribute to the microbial trend difference. In Fig. <xref rid="Fig5" ref-type="fig">5</xref>b, we report the nonzero estimated factor scores of these 5 dominant genera and they reveal the extent of their contributions to the microbial trend group difference. In contrast, the competing test Permuspliner only identifies 3 significant genera (<italic>Lactobacillus</italic>, <italic>Coprobacillus</italic>, <italic>Coriobacteriaceae_Other</italic>) associated with STAT treatment (adjusted <italic>p</italic>-values &lt; 5<italic>%</italic>).
<fig id="Fig5"><label>Fig. 5</label><caption><p>Microbial trend comparison between the STAT and control mice in the real longitudinal murine microbiome data. (<bold>a</bold>) The microbial trend extracted by MTA represents the significant difference between STAT and control mice. (<bold>b</bold>) The estimated factor scores for the dominant taxa that contribute to this trend. The number of resamplings <italic>R</italic>=50</p></caption><graphic xlink:href="12864_2021_7948_Fig5_HTML" id="MO5"/></fig></p>
      <p>Figure <xref rid="Fig6" ref-type="fig">6</xref> presents the group average relative abundances over time for each identified genus by either method. Specifically, genus <italic>Lactobacillus</italic> identified by both methods has consistently higher relative abundances at all 4 time points in the control group than in the case group. The genera identified by MTA tend to have different changing directions between two groups, such as genera <italic>Lachnospiraceae_Other</italic>, <italic>S24-7_Other</italic>, and <italic>Akkermansia</italic>, while Permuspliner fails to identify them, which agrees with the simulation results. The 5 genera identified by MTA are relatively common with their cumulative relative abundances ranging from 46.4% to 97.6% across all 4 time points. In contrast, two of three genera identified by Permuspliner are rarer with their cumulative relative abundances ranging from 0.6% to 31.0% (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S7). Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S8 presents a principal coordinate analysis (PCoA) visualization based on the Bray-Curtis dissimilarity index using all 35 original genera; the 5 genera identified by MTA, and the 3 genera identified by Permuspliner at 3, 6, 10 and 13 weeks, respectively. As expected, the PCoA plot based on the genera identified by MTA closely resembles the original plot, while the plot based on the genera identified by Permuspliner presents a completely different pattern. These results illustrate that 5 genera identified by MTA well represent the original microbial diversities among all samples, which demonstrates that MTA is capable of capturing the differential microbial dynamic signals, and representing taxa in the longitudinal microbiome analysis.
<fig id="Fig6"><label>Fig. 6</label><caption><p>The relative abundances for 7 identified genera at 3, 6, 10 and 13 weeks, respectively. (<bold>a</bold>) 5 genera identified by the proposed MTA method. (<bold>b</bold>) 3 genera identified by the Permuspliner method. Genus <italic>Lactobacillus</italic> is identified by both methods</p></caption><graphic xlink:href="12864_2021_7948_Fig6_HTML" id="MO6"/></fig></p>
      <p>Figure <xref rid="Fig7" ref-type="fig">7</xref> presents the distances of all mice from the predicted microbial matrices of control and STAT mice which are estimated from the training set based on Algorithm 3. For a given mouse, the training set consists of all other mice. We observe that 18 of 20 control mice (specificity=90.0%) and 13 of 17 antibiotic mice (sensitivity=76.4%) are classified correctly by the proposed distance-based classification algorithm (Algorithm 3), which is superior to the clustering results based on beta diversity measurements at a single time point (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S8) as well as the results in Livanos et al. (2016) [<xref ref-type="bibr" rid="CR35">35</xref>] based on the hierarchical clustering using the samples at week 6. These results demonstrate the satisfactory performance of the proposed MTA method in classification. Furthermore, the variation of distances shows that STAT mice have more diverse microbial profiles than control mice, which is consistent with their beta diversity measurements shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S8.
<fig id="Fig7"><label>Fig. 7</label><caption><p>The boxplot of distances calculated based on Algorithm 3. For a given mouse, the training set involves all other mice except for itself. The distances of its prediction from the predicted microbial matrices of control and STAT mice were separately calculated. (<bold>a</bold>) Distances of the relative abundances of control mice from the predicted microbial matrics of control and STAT mice, respectively. (<bold>b</bold>) Distances of the relative abundances of STAT mice from the predicted microbial matrics of control and STAT mice, respectively</p></caption><graphic xlink:href="12864_2021_7948_Fig7_HTML" id="MO7"/></fig></p>
      <p>Compared to the significant signals found in Livanos et al. (2016) [<xref ref-type="bibr" rid="CR35">35</xref>], the proposed MTA method identifies more significant results in terms of dominant taxa identification and mouse classification, which provides insight into the comprehensive characterization of the gut microbiome. This further shows the importance of investigating microbial dynamic changes and their characterization in human diseases based on the longitudinal microbial profiles.</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="discussion">
    <title>Discussion</title>
    <p>Compared to the PTA method [<xref ref-type="bibr" rid="CR26">26</xref>], which was proposed to specifically extract the common gene expression trend patterns shared by the subjects of a group and identify the dominant genes, the proposed MTA framework is a more comprehensive analytical pipeline on longitudinal microbiome data with three components. First, similar to but extended from the PTA method, the MTA framework extracts the microbial common trends and identifies the key taxa, which employs not only the Lasso penalty and the smoothing technique to deal with the high dimensionality of taxa and the smoothness of the extracted trends, but also the Laplacian penalty to address the distinct feature of microbiome data, the phylogenetic tree structure. The second component is to evaluate the group differential in microbial dynamic trend with permutation strategy, and the third component is to construct a classification algorithm based on microbial dynamic profiling, which are two new add-ons in MTA. The MTA framework assumes that the microbiota act as an integrated microbial community and there are a group of key taxa that drive the overall microbial dynamics, rather than assuming that each microbe acts alone and needs to be tested individually [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. This community level integrated analysis provides a systematic view of microbial dynamic responses, which is especially important for understanding complex diseases.</p>
    <p>The compositional nature of the microbiome has raised many debates in the microbiome data studies [<xref ref-type="bibr" rid="CR38">38</xref>–<xref ref-type="bibr" rid="CR40">40</xref>]. The constant sum constraint can lead traditional statistical methods to produce spurious correlations and errant results. Various log-ratio transformation techniques have been used to deal with the compositionality of microbiome data, such as additive log-ratio transformation (ALR), centered log-ratio transformation (CLR), and isometric log-ratio transformation (ILR) [<xref ref-type="bibr" rid="CR38">38</xref>–<xref ref-type="bibr" rid="CR42">42</xref>]. These transformations can maintain the underlying covariance or correlation structure originating from the natural interaction of the components theoretically [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR42">42</xref>]. However, the utility of log-ratio transformations is not able to ease the statistical analyses entirely from the influence of the compositionality, even in the cross-sectional study [<xref ref-type="bibr" rid="CR38">38</xref>]. For the longitudinal microbiome studies, there is not much discussion on how to appropriately perform the log-ratio transformations yet. Many questions remain open. For example, how to define the invariant reference taxon, how to interpret the ratio when the denominator varies across time points, whether the transformation retains the inherent temporal pattern, etc. In this paper, we took a modest action to conduct a small simulation and the results in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S9 exhibit that both ALR and CLR transformations alter the dynamic patterns of the causal taxa that contribute to the group difference between control and case under the simulated scenario 1. Note that we didn’t include ILR in the simulation, because it relies on the choice of the orthonormal basis which can be arbitrary. For sure, more comprehensive research are needed to evaluate the effect of log-ratio and other transformations in the longitudinal microbiome study.</p>
    <p>On the other hand, we conducted additional simulations to investigate the utility of ALR and CLR transformations in the MTA method. Specifically, we applied the proposed MTA framework to the relative abundances, the corresponding log transformation, ALR, and CLR, respectively (see the details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S2). The estimated powers show that using relative abundances captures more dynamic information and produces the highest power among all the methods in all simulating scenarios. The reason that MTA based on the relative abundance has good performance is twofold. First, MTA evaluates the dynamic difference between cases and controls by comparing the trends extracted from a difference array <italic>G</italic><sup>∗</sup> to a noise trend which is randomly arranged around 0 across all time points, rather than directly compare the dynamic trends extracted from cases and controls, respectively. Second, MTA employs matrix factorization and regularization techniques to analyze all taxa together and identify the dominant taxa simultaneously, by assuming that the microbiota act as an integrated microbial community. This strategy addresses the correlations among taxa due to compositionality to some extent [<xref ref-type="bibr" rid="CR43">43</xref>, <xref ref-type="bibr" rid="CR44">44</xref>]. We recognize that all results above are based on our simulation studies, rather than on theoretical consideration. We include log, ALR, and CLR transformations in the MTA R package as options and let the users decide the transformation procedure based on their studies.</p>
    <p>Sparsity is another feature of microbiome data, as many taxa are rare and most samples show numerous zero counts. Recent microbiome quality control studies and practical data analyses indicate that many observed rare taxa are subject to sequencing artifacts, contamination, or sequencing error [<xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR47">47</xref>]. Filtering out the rare taxa is one common approach to deal with this problem. Cao et al. (2021) [<xref ref-type="bibr" rid="CR48">48</xref>] demonstrates that filtering reduces the complexity of microbiome data while preserving their integrity in downstream analysis and allows researchers to generate more reproducible and comparable results in microbiome data analysis. In Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section S7, we simulated the longitudinal microbiome data from a zero-inflated NB distribution to evaluate whether and how sparsity or zero inflation affects the performance of MTA. Both low vs. high and stable vs. time-varied zero inflations scenarios were considered in the simulation studies. We observe that the sparsity of causal taxa affects the performance of the proposed MTA, while the sparsity of non-causal taxa does not. As the sparsity of causal taxa increases, the estimated sensitivity decreases, and the specificity increases.</p>
    <p>The findings of this study have to be seen in light of some challenges. Note that the core of the MTA framework is to identify the common patterns shared by all subjects in a given group. The within-group heterogeneity and outliers potentially weaken MTA’s performance in group comparison and classification. Recently, archetypal analysis has been widely used in the clustering and classification, aiming to identify distinct archetypes (extremal points) as the representative, rather than the prototypes (central points or medoids) [<xref ref-type="bibr" rid="CR49">49</xref>, <xref ref-type="bibr" rid="CR50">50</xref>]. The idea on how to extract archetypes gives MTA framework a possible solution to address the issues of heterogeneity and outliers. The proposed MTA framework requires all subjects have microbiome sequencing data at the same time points, and does not allow the missing values, which are not in common in the longitudinal studies. Imputation strategies are suggested to address the missing value issue before applying the MTA framework. Given that the longitudinal relative abundance of one taxon can be considered as a time series, one can employ appropriate imputation methods for univariate time series [<xref ref-type="bibr" rid="CR51">51</xref>] to impute the missing relative abundance accordingly, then do the normalization to maintain the compositionality of the microbiome. As a nonparametric method, MTA is also limited for covariate adjustment.</p>
    <p>Although this paper focused on binary phenotypes, the proposed MTA framework can be easily generalized for use with more than two categories. For group comparisons, Algorithm 2 can be used to compare the paired difference between any two categories and then determine their microbial differential with correction for multiple testing. For the classification, the predicted microbial matrix for each category can be estimated based on the training set, then the distances of a new subject from its microbial profile can be calculated in relation to the predicted microbial matrices of all categories separately, and finally to determine its label by comparing those distances.</p>
  </sec>
  <sec id="Sec8" sec-type="conclusion">
    <title>Conclusions</title>
    <p>In this paper, we propose a microbial trend analysis (MTA) framework for analyzing the longitudinal microbiome data. MTA can describe microbial dynamics, test the group difference, extract key taxa driving the microbial temporal trend, and classify the subjects. Comparing to the competing method Permuspliner, MTA has superior performance in these tasks based on both extensive simulations and real data analyses. Consequently, with the recent proliferation of microbial longitudinal studies, the proposed MTA framework is an attractive analytical tool to study the comprehensive characterization of microbial dynamics and identify key bacterial species that may affect susceptibility to complex diseases.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Microbial trend analysis</title>
      <p>Suppose there are <italic>N</italic> subjects in a given group. Let <italic>Y</italic><sub><italic>npt</italic></sub> be the relative abundance of the <italic>p</italic><sup>th</sup> taxon of subject <italic>n</italic> at time point <italic>t</italic>, <italic>p</italic>=1,…,<italic>P</italic>, and <italic>t</italic>=1,…,<italic>T</italic>, and <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {Y}_{n}=\left \{Y_{npt}\right \}_{p=1, t=1}^{p=P, t=T}$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">npt</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq3.gif"/></alternatives></inline-formula> be a <italic>P</italic>×<italic>T</italic> matrix of the relative abundances of subject <italic>n</italic>. To extract the common trends shared by all <italic>N</italic> subjects, we consider the following optimization problem, as illustrated in PTA [<xref ref-type="bibr" rid="CR26">26</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3), 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}  &amp; \text{min}_{\boldsymbol{F}, \boldsymbol{C}} L(\boldsymbol{F}, \boldsymbol{C}| \boldsymbol{Y}_n)=\sum_{n=1}^{N}\| \boldsymbol{Y}_n-\boldsymbol{F}\boldsymbol{C}\boldsymbol{B}'\|_{F}^{2}, \\ &amp; \text{subject to \ } {\boldsymbol{c}'_{\boldsymbol{m}}} \boldsymbol{\Omega} \boldsymbol{c_m} \leq a_1, \ \| \boldsymbol{F}\|_1 \leq a_2, \text{\ and } \| \boldsymbol{F}\|_{2}^2=1,  \end{array} $$ \end{document}</tex-math><mml:math id="M12"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:msub><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mi mathvariant="bold-italic">C</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mtext>subject to</mml:mtext><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mstyle mathvariant="bold-italic"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>∥</mml:mo><mml:mi mathvariant="bold-italic">F</mml:mi><mml:msub><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext>and</mml:mtext><mml:mo>∥</mml:mo><mml:mi mathvariant="bold-italic">F</mml:mi><mml:msubsup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2021_7948_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <bold><italic>F</italic></bold>=(<bold><italic>f</italic></bold><sub>1</sub>,…,<bold><italic>f</italic></bold><sub><italic>M</italic></sub>) is a <italic>P</italic>×<italic>M</italic> matrix of factor scores, <bold><italic>C</italic></bold>=(<bold><italic>c</italic></bold><sub>1</sub>,…,<bold><italic>c</italic></bold><sub><italic>M</italic></sub>)<sup>′</sup> is an <italic>M</italic>×(<italic>T</italic>+2) matrix of spline coefficients, <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {B}=\left \{B_{i}(t)\right \}_{t, i=1}^{t=T, i=T+2}$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq4.gif"/></alternatives></inline-formula> is a <italic>T</italic>×(<italic>T</italic>+2) matrix containing the cubic spline basis and ∥·∥<sub><italic>F</italic></sub> is the Frobenius norm. Denote <bold><italic>Q</italic></bold>=<bold><italic>C</italic></bold><bold><italic>B</italic></bold><sup>′</sup>, which is an <italic>M</italic>×<italic>T</italic> matrix presenting the top <italic>M</italic> common trends across <italic>T</italic> time points. <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\Omega }=\left \{\Omega _{ij}\right \}_{i, j=1}^{i, j=T+2}$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq5.gif"/></alternatives></inline-formula> is a (<italic>T</italic>+2)×(<italic>T</italic>+2) matrix with <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Omega _{ij}=\int B_{i}^{{\prime }{\prime }}(t)B_{j}^{{\prime }{\prime }}(t) dt, i, j = 1, \ldots, T+2$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:munderover><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>′′</mml:mi></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>′′</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mtext mathvariant="italic">dt</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq6.gif"/></alternatives></inline-formula>. <italic>M</italic> can be either predetermined by the user or determined by specifying the percentage of variance to be explained by the top common trends (see Algorithm 1 for details). The parameter <italic>a</italic><sub>1</sub>(≥0) controls the smoothness of trends with a smaller value of <italic>a</italic><sub>1</sub> producing smoother trends. <italic>a</italic><sub>2</sub>(≥0) controls the sparsity of taxa to ease the high-dimentionality problem in the microbiome data, that the number of taxa <italic>P</italic> is usually far larger than the sample size <italic>N</italic> or the number of time points <italic>T</italic>, and only a few taxa are assumed to make substantial contributions to the community level dynamic trends [<xref ref-type="bibr" rid="CR52">52</xref>]. Note that <bold><italic>F</italic></bold> and <bold><italic>C</italic></bold> are identical for all subjects respectively, for they integrate information from all subjects and represent the common trends <bold><italic>Q</italic></bold> shared by all subjects. The elements of <bold><italic>f</italic></bold><sub><italic>m</italic></sub> are the weights of <italic>P</italic> taxa on the <italic>m</italic><sup>th</sup> common trend <bold><italic>B</italic></bold><bold><italic>c</italic></bold><sub><italic>m</italic></sub>, of which a higher absolute value indicates a stronger contribution to this common trend. With this modeling, we can find the top <italic>M</italic> common trends from a group of subjects, and quantify the contributions of <italic>P</italic> taxa to each of the common trends.</p>
      <p>In addition to the high-dimensionality, another important feature of microbiome data is the phylogenetic tree structure that describes the evolutionary relationships among taxa. Evolutionarily related taxa tend to have similar effects on human phenotypes or diseases [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR53">53</xref>]. In the existing studies, incorporating the phylogenetic tree information into the analysis improves both statistical power and biological interpretability [<xref ref-type="bibr" rid="CR27">27</xref>–<xref ref-type="bibr" rid="CR30">30</xref>]. To take this factor into account, we integrate the following Laplacian penalty in the optimization problem (<xref rid="Equ3" ref-type="">3</xref>), 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}}  g(\lambda,\boldsymbol{L})=\lambda\boldsymbol{F}'\boldsymbol{L}\boldsymbol{F}, \end{array} $$ \end{document}</tex-math><mml:math id="M20"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">L</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">L</mml:mi><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2021_7948_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>λ</italic>(≥0) is the tuning parameter. The Laplacian matrix <bold><italic>L</italic></bold> is determined by the phylogenetic tree and constructed using a similar approach to that described in Chen et al. (2012) [<xref ref-type="bibr" rid="CR27">27</xref>]. Detailed construction of <bold><italic>L</italic></bold> is given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4. Incorporating this Laplacian penalty <bold><italic>L</italic></bold> weights the OTUs closely linked on the phylogenetic tree to have similar effects on the extracted common trends. With these two additional penalties, we introduce two Lagrange multipliers to rewrite the optimization problem (<xref rid="Equ3" ref-type="">3</xref>) as 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}}  \text{min}_{\boldsymbol{F}, \boldsymbol{C}} \left[L(\boldsymbol{F}, \boldsymbol{C}| \boldsymbol{Y}_{n})+\lambda_{1}\boldsymbol{C} \boldsymbol{\Omega} \boldsymbol{C}' +\lambda_{2}\|\boldsymbol{F}\|_{1}+\lambda_{3}\boldsymbol{F}'\boldsymbol{L}\boldsymbol{F}\right], \end{array} $$ \end{document}</tex-math><mml:math id="M22"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∥</mml:mo><mml:mi mathvariant="bold-italic">F</mml:mi><mml:msub><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">L</mml:mi><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2021_7948_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>subject to <inline-formula id="IEq7"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\| \boldsymbol {F}\|_{2}^{2}=1$\end{document}</tex-math><mml:math id="M24"><mml:mo>∥</mml:mo><mml:mi mathvariant="bold-italic">F</mml:mi><mml:msubsup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq7.gif"/></alternatives></inline-formula>, where <italic>λ</italic><sub>1</sub>(≥0),<italic>λ</italic><sub>2</sub>(≥0) and <italic>λ</italic><sub>3</sub>(≥0) are tuning parameters that control smoothness of the common trends, sparsity, and smoothness of the estimated factor scores based on the phylogenetic tree distance, respectively. As demonstrated in Zhang and Davis (2013) [<xref ref-type="bibr" rid="CR26">26</xref>], the optimization problem (<xref rid="Equ5" ref-type="">5</xref>) is biconvex, though not convex. Thus we adapt an iterative nonlinear partial least square algorithm in Algorithm 1 to get estimates <inline-formula id="IEq8"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {F}}$\end{document}</tex-math><mml:math id="M26"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {C}}$\end{document}</tex-math><mml:math id="M28"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq9.gif"/></alternatives></inline-formula> by minimizing the optimization problem (<xref rid="Equ5" ref-type="">5</xref>) [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR54">54</xref>], modified from the Algorithm S1. The detailed derivation is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S5.</p>
      <p>Given the observations <bold><italic>Y</italic></bold><sub><italic>n</italic></sub>,<italic>n</italic>=1,…,<italic>N</italic>, the number of top common trends <italic>M</italic> or the percentage of variance <italic>V</italic> for the top common trends to explain, and the tuning parameters <italic>λ</italic><sub>1</sub>,<italic>λ</italic><sub>2</sub> and <italic>λ</italic><sub>3</sub>, Algorithm 1 solves for the estimated top common trends <inline-formula id="IEq10"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {Q}}_{m}=\boldsymbol {B}\hat {\boldsymbol {c}}_{m}, m=1, \ldots, M$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">Q</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq10.gif"/></alternatives></inline-formula>, shared by all <italic>N</italic> subjects, which are the linear combinations of the relative abundances of all <italic>P</italic> taxa across <italic>T</italic> time points, and <inline-formula id="IEq11"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {F}}$\end{document}</tex-math><mml:math id="M32"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq11.gif"/></alternatives></inline-formula> indicates the dominant taxa and their contributions to the common trends.</p>
      <p>Note that the choices of tuning parameters in Algorithm 1 are crucial for extracting the common trends and we use the <italic>K</italic>-fold CV [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR55">55</xref>] to determine the values of <italic>λ</italic><sub>1</sub>,<italic>λ</italic><sub>2</sub> and <italic>λ</italic><sub>3</sub>. Specifically, we randomly split the indexes of all subjects 1,…,<italic>N</italic> into <italic>K</italic> exclusive folds with roughly equal sample size <italic>G</italic><sub>1</sub>,…,<italic>G</italic><sub><italic>K</italic></sub>, and take the subjects <bold><italic>Y</italic></bold><sub><italic>n</italic></sub>,<italic>n</italic>∉<italic>G</italic><sub><italic>k</italic></sub>, as the training set and the remaining subjects as the testing set in the <italic>k</italic>th cross-validation, <italic>k</italic>=1,…,<italic>K</italic>. With the given candidate values of the tuning parameters <bold><italic>λ</italic></bold>=(<italic>λ</italic><sub>1</sub>,<italic>λ</italic><sub>2</sub>,<italic>λ</italic><sub>3</sub>), we obtain estimates <inline-formula id="IEq12"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {F}}^{-k}_{\boldsymbol {\lambda }}$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {C}}^{-k}_{\boldsymbol {\lambda }}$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq13.gif"/></alternatives></inline-formula> from the training set with Algorithm 1 in the <italic>k</italic>th cross-validation. The predicted group-level microbial composition for this training set therefore is <inline-formula id="IEq14"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {Y}}^{-k}_{\boldsymbol {\lambda }}=\hat {\boldsymbol {F}}^{-k}_{\boldsymbol {\lambda }}\hat {\boldsymbol {C}}^{-k}_{\boldsymbol {\lambda }}\boldsymbol {B}'$\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq14.gif"/></alternatives></inline-formula>. Then the total squared error on the testing set <bold><italic>Y</italic></bold><sub><italic>n</italic></sub>,<italic>n</italic>∈<italic>G</italic><sub><italic>k</italic></sub>, is defined as <inline-formula id="IEq15"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$e_{k}\left (\boldsymbol {\lambda }\right)=\sum _{n\in G_{k}}\|\boldsymbol {Y}_{n}-\hat {\boldsymbol {Y}}^{-k}_{\boldsymbol {\lambda }}\|_{F}^{2}$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq15.gif"/></alternatives></inline-formula>, and the average mean squared error over all <italic>K</italic> folds is recorded as 
<disp-formula id="Equa"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}  CV(\boldsymbol{\lambda})=\frac{1}{N}\sum_{k=1}^{K}e_{k}(\boldsymbol{\lambda})=\frac{1}{N}\sum_{k=1}^{K}\sum_{n\in G_{k}}\|\boldsymbol{Y}_{n}-\hat{\boldsymbol{Y}}^{-k}_{\boldsymbol{\lambda}}\|_{F}^{2}. \end{array} $$ \end{document}</tex-math><mml:math id="M42"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mtext mathvariant="italic">CV</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">λ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">λ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2021_7948_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Finally, we select <bold><italic>λ</italic></bold><sup>∗</sup>=arg min<sub><bold><italic>λ</italic></bold></sub><italic>C</italic><italic>V</italic>(<bold><italic>λ</italic></bold>) as the optimal tuning parameters.</p>
    </sec>
    <sec id="Sec11">
      <title>Group comparison</title>
      <p>In the subsection above, we proposed the MTA method to capture the common dynamic trends shared by all subjects in a given group and identify the dominant taxa contributing to these common trends. We next apply the MTA method to evaluate how different two groups are in terms of their microbial dynamic pattern, and if the group difference is significant, quantify the differentiating taxa. The proposed group test is based on a difference array constructed using pseudo samples and permutation technique. Specifically, let <inline-formula id="IEq16"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {X}=\left \{\boldsymbol {X}_{1}, \ldots, \boldsymbol {X}_{N_{1}}\right \}$\end{document}</tex-math><mml:math id="M44"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {Z}=\left \{\boldsymbol {Z}_{1}, \ldots, \boldsymbol {Z}_{N_{2}}\right \}$\end{document}</tex-math><mml:math id="M46"><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq17.gif"/></alternatives></inline-formula> be the arrays of relative abundances for <italic>N</italic><sub>1</sub> controls and <italic>N</italic><sub>2</sub> cases with <italic>P</italic> taxa across <italic>T</italic> time points (here, <bold><italic>X</italic></bold><sub><italic>n</italic></sub> and <bold><italic>Z</italic></bold><sub><italic>n</italic></sub> have a similar definition as <bold><italic>Y</italic></bold><sub><italic>n</italic></sub> in the subsection above), respectively. The difference array then is constructed as 
<disp-formula id="Equb"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\boldsymbol{G}^{*}=\boldsymbol{Z}^{*}-\boldsymbol{X}^{*}, $$ \end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12864_2021_7948_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq18"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {G}^{*}=\left \{\boldsymbol {G}_{1}^{*}, \ldots, \boldsymbol {G}^{*}_{N^{*}}\right \}$\end{document}</tex-math><mml:math id="M50"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq18.gif"/></alternatives></inline-formula> and <inline-formula id="IEq19"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {G}^{*}_{n}$\end{document}</tex-math><mml:math id="M52"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq19.gif"/></alternatives></inline-formula> represents the relative abundance difference between randomly paired subjects from case and control groups with <inline-formula id="IEq20"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{p=1}^{P}G^{*}_{npt}=0, n=1, \ldots, N^{*}, t=1, \ldots, T$\end{document}</tex-math><mml:math id="M54"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">npt</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq20.gif"/></alternatives></inline-formula>, and <italic>N</italic><sup>∗</sup>=min(<italic>N</italic><sub>1</sub>,<italic>N</italic><sub>2</sub>). <inline-formula id="IEq21"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {X}^{*}=\left \{\boldsymbol {X}_{1}^{*}, \ldots, \boldsymbol {X}_{N^{*}}^{*}\right \}$\end{document}</tex-math><mml:math id="M56"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {Z}^{*}=\left \{\boldsymbol {Z}_{1}^{*}, \ldots, \boldsymbol {Z}_{N^{*}}^{*}\right \}$\end{document}</tex-math><mml:math id="M58"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq22.gif"/></alternatives></inline-formula> are the permuted controls and cases, respectively.</p>
      <p>Under the null hypothesis of no difference between cases and controls, the expectation of <inline-formula id="IEq23"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {G}_{n}^{*}$\end{document}</tex-math><mml:math id="M60"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq23.gif"/></alternatives></inline-formula> should be a <italic>P</italic>×<italic>T</italic> zero matrix and the difference array <bold><italic>G</italic></bold><sup>∗</sup> thus has only noise signal. On the other hand, under the alternative hypothesis, that control and case groups hold different dynamic patterns, <inline-formula id="IEq24"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {G}_{n}^{*}$\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq24.gif"/></alternatives></inline-formula> is expected to be time-related and to contain some common trends illustrating the underlying differences between cases and controls, which should differ from the random noise signal under the null. Thus, we propose a test to evaluate the dynamic differences between cases and controls by comparing the trends extracted from <bold><italic>G</italic></bold><sup>∗</sup> to the noise trend which is randomly arranged around 0 across all time points. Specifically, the test is evaluated based on the resampling (or bootstrapping) method [<xref ref-type="bibr" rid="CR56">56</xref>], with details described in Algorithm 2.</p>
      <p>Note that Algorithm 2 consists of several components used in constructing the hypothesis test for assessing the microbial dynamic group differences. First, we determine the number of common trends extracted from the difference array <bold><italic>G</italic></bold><sup>∗(<italic>r</italic>)</sup>,<italic>M</italic><sup>(<italic>r</italic>)</sup>, by the criterion that the increasing rate of the explained variance is equal to or less than 10<sup>−3</sup>, to capture most of the information shared by all pseudo subjects. Second, we employ the straightforward and widely used Euclidean distance to measure the differences between the common trends extracted from <bold><italic>G</italic></bold><sup>∗</sup> and the random trend from <inline-formula id="IEq25"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {G}_{Noise}^{*}$\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Noise</mml:mtext></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq25.gif"/></alternatives></inline-formula>. Third, we use the Wilcoxon rank-sum test to check whether distances <bold><italic>D</italic></bold><sub><italic>m</italic></sub> are greater than <bold><italic>D</italic></bold><sub><italic>Noise</italic></sub>, and provide the corresponding <italic>p</italic>-value <italic>p</italic><sub><italic>m</italic></sub> for the <italic>m</italic><sup>th</sup> common trend, <italic>m</italic>=1,…,<italic>M</italic><sup>∗</sup>. Finally, multiple testing correction is needed to adjust these individual <italic>p</italic>-values to control the overall error rate. Since these <italic>M</italic><sup>∗</sup> hypothesis tests exhibit a hierarchical structure in which the information captured by the common trend <bold><italic>Q</italic></bold><sub><italic>m</italic></sub> monotonically decreases as <italic>m</italic> increases, we use a gatekeeping procedure [<xref ref-type="bibr" rid="CR58">58</xref>, <xref ref-type="bibr" rid="CR59">59</xref>] to take care of this hierarchical structure and obtain the adjusted <italic>p</italic>-values <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$p_{m}^{\text {adj}}, m=1, \ldots, M^{*}$\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mtext>adj</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq26.gif"/></alternatives></inline-formula>. This implies that the <italic>m</italic><sup>th</sup> common trend is meaningful only if the previous one has a significant difference.</p>
    </sec>
    <sec id="Sec12">
      <title>Classification</title>
      <p>In addition to the common dynamic trends and the estimated factor scores, the MTA method provides the predicted microbial composition matrix: <inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {Y}}=\hat {\boldsymbol {F}}\hat {\boldsymbol {C}}\boldsymbol {B}'$\end{document}</tex-math><mml:math id="M68"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq27.gif"/></alternatives></inline-formula> at the group level. Since the predicted microbial composition matrix integrates information from all subjects of a given group and represents the unique and underlying pattern defined by this group, it can serve as a prototype of this group. Therefore, we propose a distance-based classification algorithm (Algorithm 3) to classify subjects based on their distances from the predicted microbial matrices of two different groups in the training set. Specifically, Algorithm 3 employs the <italic>k</italic>-nearest neighbors strategy [<xref ref-type="bibr" rid="CR60">60</xref>] and classifies the new subjects in terms of the similarity. Suppose there is a training set involving controls <bold><italic>X</italic></bold> and cases <bold><italic>Z</italic></bold>, and a new subject <bold><italic>Y</italic></bold><sub>new</sub> with an unknown group label. First, we apply the MTA method to controls <bold><italic>X</italic></bold> and cases <bold><italic>Z</italic></bold> separately to obtain their corresponding predicted matrices <inline-formula id="IEq28"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {X}}$\end{document}</tex-math><mml:math id="M70"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {Z}}$\end{document}</tex-math><mml:math id="M72"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq29.gif"/></alternatives></inline-formula>. Here the number of common trends <italic>M</italic> integrating the predicted microbial matrix is determined by the proportion of explained variance, as illustrated in Algorithm 1. Second, we calculate distances of the new subject <bold><italic>Y</italic></bold><sub>new</sub> from <inline-formula id="IEq30"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {X}}$\end{document}</tex-math><mml:math id="M74"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq30.gif"/></alternatives></inline-formula> and <inline-formula id="IEq31"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {Z}}$\end{document}</tex-math><mml:math id="M76"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq31.gif"/></alternatives></inline-formula>, which are defined as <inline-formula id="IEq32"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D^{\text {con}}=\|\boldsymbol {Y}_{\text {new}}-\hat {\boldsymbol {X}}\|_{2}$\end{document}</tex-math><mml:math id="M78"><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>con</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mtext>new</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:msub><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq32.gif"/></alternatives></inline-formula> and <inline-formula id="IEq33"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D^{\text {ca}}=\|\boldsymbol {Y}_{\text {new}}-\hat {\boldsymbol {Z}}\|_{2}$\end{document}</tex-math><mml:math id="M80"><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext>ca</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mtext>new</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:msub><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq33.gif"/></alternatives></inline-formula> respectively. Finally, this new subject <bold><italic>Y</italic></bold><sub>new</sub> is classified as a case if <italic>D</italic><sup>con</sup>&gt;<italic>D</italic><sup>ca</sup>, otherwise as a control.</p>
    </sec>
    <sec id="Sec13">
      <title>Simulation design</title>
      <p>Following Wang et al. (2020) [<xref ref-type="bibr" rid="CR61">61</xref>], we designed our simulation at the genus level based on the real data illustrated in the “Real data analysis” section [<xref ref-type="bibr" rid="CR35">35</xref>]. The real data include 106 genera for 20 control and 17 sub-therapeutic antibiotic treatment (STAT) male mice across 4 time points (weeks 3, 6, 10 and 13). After filtering out those genera that appear in less than 10% of samples or with mean proportions less than 10<sup>−4</sup>, 35 taxa were included in the analysis. We simulated the microbial relative abundances at each time point for cases and controls respectively from the Dirichlet distribution. Specifically, the mean relative abundance of the <italic>p</italic><sup>th</sup> taxon for a subject at the <italic>t</italic><sup>th</sup> time point <italic>O</italic><sub><italic>pt</italic></sub> is assigned as below for <italic>p</italic>=1,…,<italic>P</italic> and <italic>t</italic>=1,…,<italic>T</italic>, 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ E[O_{pt}]= \frac{\gamma_{pt}}{\sum_{p=1}^{P} \gamma_{pt}}, \ \gamma_{pt}=\beta_{0p}+\beta_{pt},  $$ \end{document}</tex-math><mml:math id="M82"><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">pt</mml:mtext></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">pt</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">pt</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">pt</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">pt</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12864_2021_7948_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <bold><italic>β</italic></bold><sub>0</sub>=(<italic>β</italic><sub>01</sub>,…,<italic>β</italic><sub>0<italic>P</italic></sub>)<sup>′</sup> represents the baseline relative abundances for <italic>P</italic>=35 taxa, which were set as the corresponding estimates from the control mice using R package dirmult [<xref ref-type="bibr" rid="CR62">62</xref>]. <italic>β</italic><sub><italic>pt</italic></sub> is the deviation from the baseline relative abundance <italic>β</italic><sub>0<italic>p</italic></sub> of the <italic>p</italic><sup>th</sup> taxon at the <italic>t</italic><sup>th</sup> time point, which represents the group difference.</p>
      <p>To estimate the empirical type I error rate, the relative abundances of controls and cases were generated under the null hypothesis with no group difference by setting <italic>β</italic><sub><italic>pt</italic></sub>=0,<italic>p</italic>=1,…,<italic>P</italic> and <italic>t</italic>=1,…,<italic>T</italic>.</p>
      <p>To evaluate the statistical power, we designed three scenarios with two different common trends between control and case groups, of which 3 dominant taxa (about 10% of the total) contributed to the first one and 2 dominant taxa (about 5%) contributed to the second one. Denote the set of the indices of these 5 dominant taxa as ∧<sub>1</sub> and ∧<sub>2</sub> and their corresponding deviations as <inline-formula id="IEq34"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta }_{.t}^{1}=(\beta _{1t}^{1}, \beta _{2t}^{1}, \beta _{3t}^{1})'$\end{document}</tex-math><mml:math id="M84"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>.t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq34.gif"/></alternatives></inline-formula> and <inline-formula id="IEq35"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta }_{.t}^{2}=(\beta _{1t}^{2}, \beta _{2t}^{2})'$\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>.t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq35.gif"/></alternatives></inline-formula>. Following Zhang and Davis (2013) [<xref ref-type="bibr" rid="CR26">26</xref>], they were assigned as 
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}  \boldsymbol{\beta}_{.t}^{1}&amp;= (-1, 2, -1)' \times \text{sin}(t) \times \text{min}(1,\beta_{0p}/2), \ p\in\wedge_{1}; \end{array} $$ \end{document}</tex-math><mml:math id="M88"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>.t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:mtext>sin</mml:mtext><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:mtext>min</mml:mtext><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mo>∧</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2021_7948_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ8">
          <label>8</label>
          <alternatives>
            <tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}  \boldsymbol{\beta}_{.t}^{2} &amp;= (-1, 1)' \times \text{sin}(2t) \times \text{min}(1,\beta_{0p}), \ p\in\wedge_{2}. \end{array} $$ \end{document}</tex-math>
            <mml:math id="M90">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">β</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>.t</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>×</mml:mo>
                    <mml:mtext>sin</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mi>t</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>×</mml:mo>
                    <mml:mtext>min</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>β</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mspace width="1em"/>
                    <mml:mi>p</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo>∧</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mi>.</mml:mi>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12864_2021_7948_Article_Equ8.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>Furthermore, the ∧<sub>1</sub> and ∧<sub>2</sub> were determined by taking the phylogenetic tree structure into account as follows. We first partitioned the 35 taxa into 5 clusters using the partition around medoids algorithm [<xref ref-type="bibr" rid="CR63">63</xref>] on the patristic distance in the real phylogenetic tree. Second, we randomly selected two clusters and then randomly selected 3 and 2 taxa from these two clusters without replacement as the taxa in ∧<sub>1</sub> and ∧<sub>2</sub>, respectively. Consequently, the dominant taxa that contributed to the group differences were phylogenetically related.</p>
      <p>Three different simulation scenarios were constructed to thoroughly illustrate the performance of the proposed MTA method and the competing method Permuspliner. Scenario 1: The relative abundances in the control group were generated with <italic>β</italic><sub><italic>pt</italic></sub>=0, while the relative abundances in the case group were generated with <inline-formula id="IEq36"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta }_{.t}^{1}$\end{document}</tex-math><mml:math id="M92"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>.t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq36.gif"/></alternatives></inline-formula> for the taxa in ∧<sub>1</sub> and <italic>β</italic><sub><italic>pt</italic></sub>=0 for <italic>p</italic>∉∧<sub>1</sub>. Scenario 2: The relative abundances in the control group were generated with <italic>β</italic><sub><italic>pt</italic></sub>=0, while the relative abundances in the case group were generated with <inline-formula id="IEq37"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta }_{.t}^{1}$\end{document}</tex-math><mml:math id="M94"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>.t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq37.gif"/></alternatives></inline-formula> and <inline-formula id="IEq38"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta }_{.t}^{2}$\end{document}</tex-math><mml:math id="M96"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>.t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq38.gif"/></alternatives></inline-formula> for the taxa in ∧<sub>1</sub> and ∧<sub>2</sub> respectively and <italic>β</italic><sub><italic>pt</italic></sub>=0 for <italic>p</italic>∉∧<sub>1</sub>∪∧<sub>2</sub>. Scenario 3: The relative abundances in the control group were generated with <inline-formula id="IEq39"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta }_{.t}^{2}$\end{document}</tex-math><mml:math id="M98"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>.t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq39.gif"/></alternatives></inline-formula> for the taxa in ∧<sub>2</sub> and <italic>β</italic><sub><italic>pt</italic></sub>=0 for <italic>p</italic>∉∧<sub>2</sub>, while the relative abundances in the case group were generated with <inline-formula id="IEq40"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta }_{.t}^{1}$\end{document}</tex-math><mml:math id="M100"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>.t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta }_{.t}^{2}$\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>.t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7948_Article_IEq41.gif"/></alternatives></inline-formula> for the taxa in ∧<sub>1</sub> and ∧<sub>2</sub>, respectively, and <italic>β</italic><sub><italic>pt</italic></sub>=0,<italic>p</italic>∉∧<sub>1</sub>∪∧<sub>2</sub>; <italic>p</italic>=1,…,<italic>P</italic>,<italic>t</italic>=1,…,<italic>T</italic>. Hence, there is only one different common trend between control and case groups in both scenario 1 and scenario 3, but two different common trends in scenario 2. Finally, we considered two equal sample sizes <italic>N</italic><sub><italic>case</italic></sub>=<italic>N</italic><sub><italic>control</italic></sub>=<italic>N</italic>=20 or 30, and two numbers of time points <italic>T</italic>=10 or 20.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec14">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12864_2021_7948_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold><bold>Section S1:</bold> Simulation study based on the simulation design of the perturbation method. <bold>Section S2:</bold> Comparison between relative abundance and log-ratio transformed relative abundances. <bold>Section S3:</bold> Principal trend analysis. <bold>Section S4:</bold> Laplacian matrix construction. <bold>Section S5:</bold> The derivation of Algorithm 1. <bold>Section S6:</bold> Comparisons among the proposed MTA, Permuspliner, MetaLonDA, and LonGP. <bold>Section S7:</bold> Sparsity evaluation of MTA.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12864_2021_7948_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2</bold><bold>FIG S1.</bold> The proposed MTA method for the comparison between case and control groups in scenario 1 with sample size <italic>N</italic>=30 and the number of time points <italic>T</italic>=10. (A) The microbial trend extracted by MTA represents the significant difference between case and control groups. (B) The average and standard error of the estimated factor scores for the dominant taxa that contribute to the extracted trend, respectively. <bold>FIG S2.</bold> The proposed MTA method for the comparison between case and control groups in scenario 2 with sample size <italic>N</italic>=30 and the number of time points <italic>T</italic>=10. (A) Two microbial trends extracted by MTA represent the significant difference between case and control groups. (B) The average and standard error of the estimated factor scores for the dominant taxa that contribute to those two trends, respectively. <bold>FIG S3.</bold> The proposed MTA method for the comparison between case and control groups in scenario 3 with sample size <italic>N</italic>=30 and the number of time points <italic>T</italic>=10. (A) The microbial trend extracted by MTA represents the significant difference between case and control groups. (B) The average and standard error of the estimated factor scores for the dominant taxa that contribute to the extracted trend, respectively. <bold>FIG S4.</bold> Empirical power for testing the difference between case and control groups with sample size <italic>N</italic>=20,30 and the number of time points <italic>T</italic>=10,20 under 1X and 2X magnitudes of perturbation, respectively. Here, (A) <bold><italic>z</italic></bold>=(0,0.3,0.45,0.2,−0.3,0.3,−0.3,− 0.2,−0.1,0)<sup>′</sup> and <bold><italic>z</italic></bold>=(0,0.2,0.5,0.3,0.2,−0.2,−0.4,−0.4,−0.2,0.2,0.5,0.2,−0.3,−0.4,−0.2,0.2,0.4,0.2,0.1,0)<sup>′</sup>, (B) <bold><italic>z</italic></bold>=(0,0.1,0.2,0.3,0.4,0.3,0.2,0.1,0.1,0)<sup>′</sup> and <bold><italic>z</italic></bold>=(0,0.05,0.1,0.2,0.2,0.2,0.3,0.3,0.2,0.2,0.2,0.2,0.3,0.3,0.2,0.2,0.2,0.2,0.1,0)<sup>′</sup>, for <italic>T</italic>=10, and 20, respectively. <bold>FIG S5.</bold> The estimated sensitivity and specificity for identifying dominant taxa which contribute to the extracted trends with sample size <italic>N</italic>=20,30 and the number of time points <italic>T</italic>=10,20 under 1X and 2X magnitudes of perturbation, respectively. Here, (A) <bold><italic>z</italic></bold>=(0,0.3,0.45,0.2,−0.3,0.3,−0.3,−0.2,−0.1,0)<sup>′</sup> and <bold><italic>z</italic></bold>=(0,0.2,0.5,0.3,0.2,−0.2,−0.4,−0.4,−0.2,0.2,0.5,0.2,−0.3,−0.4,−0.2,0.2,0.4,0.2,0.1,0)<sup>′</sup>, (B) <bold><italic>z</italic></bold>=(0,0.1,0.2,0.3,0.4,0.3,0.2,0.1,0.1,0)<sup>′</sup> and <bold><italic>z</italic></bold>=(0,0.05,0.1,0.2,0.2,0.2,0.3,0.3,0.2,0.2,0.2,0.2,0.3,0.3,0.2,0.2,0.2,0.2,0.1,0)<sup>′</sup>, for <italic>T</italic>=10, and 20, respectively. <bold>FIG S6.</bold> The classification performance of the proposed MTA framework with the number of time points <italic>T</italic>=10. (A) The overall ROC curves. (B) The mean and standard error of AUCs under various effect sizes based on 10-fold CV. <bold>FIG S7.</bold> The relative abundances for the genera identified by MTA (5 genera) and Permuspliner (3 genera) at 3, 6, 10 and 13 weeks, respectively. <bold>FIG S8.</bold> Beta diversity analysis for all male mice based on the Bray-Curtis dissimilarity index. The PCoA is evaluated based on: (A1)-(A4) 35 original genera; (B1)-(B4) 5 genera identified by the proposed MTA method; and (C1)-(C4) 3 genera identified by the competing method Permuspliner at 3, 6, 10 and 13 weeks, respectively. Points represent samples. <bold>FIG S9.</bold> Evaluation of the transformations affect on the longitudinal trends of the causal taxa that contribute to group difference in scenario 1 with sample size <italic>N</italic>=30 and the number of time points <italic>T</italic>=10, respectively. (A) The true relative abundance time series of the causal taxa with equation (1). (B) The mean and standard error of the relative abundances without none transformation. (C) The mean and standard error of the relative abundances after ALR (additive log-ratio transformation), with the last one taxon being the reference. (D) The mean and standard error of the relative abundances after CLR (centered log-ratio transformation).</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ALR</term>
        <def>
          <p>Additive log-ratio transformation</p>
        </def>
      </def-item>
      <def-item>
        <term>AUC</term>
        <def>
          <p>Area under the curve</p>
        </def>
      </def-item>
      <def-item>
        <term>BH</term>
        <def>
          <p>Benjamini-Hochberg</p>
        </def>
      </def-item>
      <def-item>
        <term>CLR</term>
        <def>
          <p>Centered log-ratio transformation</p>
        </def>
      </def-item>
      <def-item>
        <term>CV</term>
        <def>
          <p>Cross-validation</p>
        </def>
      </def-item>
      <def-item>
        <term>IBD</term>
        <def>
          <p>Inflammatory bowel disease</p>
        </def>
      </def-item>
      <def-item>
        <term>ILR</term>
        <def>
          <p>Isometric log-ratio transformation</p>
        </def>
      </def-item>
      <def-item>
        <term>MTA</term>
        <def>
          <p>Microbial trend analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>OTU</term>
        <def>
          <p>Operational taxonomic unit</p>
        </def>
      </def-item>
      <def-item>
        <term>PCoA</term>
        <def>
          <p>Principal coordinate analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>PTA</term>
        <def>
          <p>Principal trend analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p>Receiver operating characteristic</p>
        </def>
      </def-item>
      <def-item>
        <term>STAT</term>
        <def>
          <p>Sub-therapeutic antibiotic treatment</p>
        </def>
      </def-item>
      <def-item>
        <term>T1D</term>
        <def>
          <p>Type 1 diabetes</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors are grateful to the anonymous reviewers for their insightful observations and comments.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CW developed the microbial trend analysis framework, performed simulation analyses, real data analyses and manuscript writing. JH contributed to real data analyses and manuscript writing. MJB contributed to the biological insights and interpretation, and manuscript writing. HL contributed to the methodological ideas for the proposed framework, simulations, real data analyses, and manuscript writing. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported in part by National Institutes of Health grants R01DK110014, 1P20CA252728, and U01AI22285, the Fondation Leducq Transatlantic Network, and the Zlinkoff and C&amp;D Funds. All grants played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All the necessary information needed to support the results of this paper are included within the article and its additional files. The longitudinal murine microbiome data [<xref ref-type="bibr" rid="CR35">35</xref>] we used in our real data analysis is publicly available at the European Bioinformatics Institute database (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk">https://www.ebi.ac.uk</ext-link>) with accession number ERP016357 and Qiita database (<ext-link ext-link-type="uri" xlink:href="https://qiita.ucsd.edu">https://qiita.ucsd.edu</ext-link>) with accession number 10508. Our methods are implemented using the R package, MTA, which is publicly available on web pages: <ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/huilinli09/software">https://sites.google.com/site/huilinli09/software</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/chanw0/MTA">https://github.com/chanw0/MTA</ext-link> together with its detailed manual which includes arguments/options, input formats, and outputs with examples.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffmann</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Proctor</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Surette</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Suchodolski</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The microbiome: the trillions of microorganisms that maintain health and cause disease in humans and companion animals</article-title>
        <source>Eur J Vet Pathol</source>
        <year>2016</year>
        <volume>53</volume>
        <issue>1</issue>
        <fpage>10</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1177/0300985815595517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Integrative</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>The integrative human microbiome project</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>569</volume>
        <issue>7758</issue>
        <fpage>641</fpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1238-8</pub-id>
        <pub-id pub-id-type="pmid">31142853</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Integrative</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>The integrative human microbiome project: dynamic analysis of microbiome-host omics profiles during periods of human health and disease</article-title>
        <source>Cell Host Microbe</source>
        <year>2014</year>
        <volume>16</volume>
        <issue>3</issue>
        <fpage>276</fpage>
        <pub-id pub-id-type="doi">10.1016/j.chom.2014.08.014</pub-id>
        <pub-id pub-id-type="pmid">25211071</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Sailani</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Contrepois</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ahadi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leopold</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Avina</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mishra</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Longitudinal multi-omics of host–microbe dynamics in prediabetes</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>569</volume>
        <issue>7758</issue>
        <fpage>663</fpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1236-x</pub-id>
        <?supplied-pmid 31142858?>
        <pub-id pub-id-type="pmid">31142858</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thaiss</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Microbiome dynamics in obesity</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>362</volume>
        <issue>6417</issue>
        <fpage>903</fpage>
        <lpage>04</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aav6870</pub-id>
        <?supplied-pmid 30467161?>
        <pub-id pub-id-type="pmid">30467161</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lloyd-Price</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Arze</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ananthakrishnan</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Schirmer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Avila-Pacheco</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Poon</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ajami</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Bonham</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Brislawn</surname>
            <given-names>CJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multi-omics of the gut microbial ecosystem in inflammatory bowel diseases</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>569</volume>
        <issue>7758</issue>
        <fpage>655</fpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1237-9</pub-id>
        <?supplied-pmid 31142855?>
        <pub-id pub-id-type="pmid">31142855</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fettweis</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Serrano</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Girerd</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Parikh</surname>
            <given-names>HI</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Arodz</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Edupuganti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Glascock</surname>
            <given-names>AL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The vaginal microbiome and preterm birth</article-title>
        <source>Nat Med</source>
        <year>2019</year>
        <volume>25</volume>
        <issue>6</issue>
        <fpage>1012</fpage>
        <pub-id pub-id-type="doi">10.1038/s41591-019-0450-2</pub-id>
        <?supplied-pmid 31142849?>
        <pub-id pub-id-type="pmid">31142849</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rose</surname>
            <given-names>S. M. S. -F.</given-names>
          </name>
          <name>
            <surname>Contrepois</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Moneghetti</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Mishra</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mataraso</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dagan-Rosenfeld</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ganz</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hornburg</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A longitudinal big data approach for precision health</article-title>
        <source>Nat Med</source>
        <year>2019</year>
        <volume>25</volume>
        <issue>5</issue>
        <fpage>792</fpage>
        <pub-id pub-id-type="doi">10.1038/s41591-019-0414-6</pub-id>
        <pub-id pub-id-type="pmid">31068711</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A powerful microbiome-based association test and a microbial taxa discovery framework for comprehensive association mapping</article-title>
        <source>Microbiome</source>
        <year>2017</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>45</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-017-0262-x</pub-id>
        <?supplied-pmid 28438217?>
        <pub-id pub-id-type="pmid">28438217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Livanos</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A highly adaptive microbiome-based association test for survival traits</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>210</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-018-4599-8</pub-id>
        <?supplied-pmid 29558893?>
        <pub-id pub-id-type="pmid">29558893</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilbert</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Jansson</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Lynch</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Current understanding of the human microbiome</article-title>
        <source>Nat Med</source>
        <year>2018</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>392</fpage>
        <pub-id pub-id-type="doi">10.1038/nm.4517</pub-id>
        <?supplied-pmid 29634682?>
        <pub-id pub-id-type="pmid">29634682</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Koh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A two-stage microbial association mapping framework with advanced fdr control</article-title>
        <source>Microbiome</source>
        <year>2018</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>131</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-018-0517-1</pub-id>
        <?supplied-pmid 30045760?>
        <pub-id pub-id-type="pmid">30045760</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The human gut microbiome: from association to modulation</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>172</volume>
        <issue>6</issue>
        <fpage>1198</fpage>
        <lpage>215</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.02.044</pub-id>
        <?supplied-pmid 29522742?>
        <pub-id pub-id-type="pmid">29522742</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bokulich</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Dillon</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Rideout</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bolyen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Albert</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>q2-longitudinal: Longitudinal and paired-sample analyses of microbiome data</article-title>
        <source>mSystems</source>
        <year>2018</year>
        <volume>3</volume>
        <issue>6</issue>
        <fpage>00219</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1128/mSystems.00219-18</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A two-part mixed-effects model for analyzing longitudinal microbiome compositional data</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>17</issue>
        <fpage>2611</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw308</pub-id>
        <?supplied-pmid 27187200?>
        <pub-id pub-id-type="pmid">27187200</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ramchandran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vatanen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lietzén</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lahesmaa</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vehtari</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>An additive gaussian process regression model for interpretable non-parametric analysis of longitudinal data</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-07882-8</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bucci</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Tzen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tanoue</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bogart</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yeliseyev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Delaney</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mdsine: Microbial dynamical systems inference engine for microbiome time-series analyses</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>121</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0980-6</pub-id>
        <?supplied-pmid 27259475?>
        <pub-id pub-id-type="pmid">27259475</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stein</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Bucci</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Toussaint</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Buffie</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Rätsch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pamer</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xavier</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Ecological modeling from time-series inference: insight into dynamics and stability of intestinal microbiota</article-title>
        <source>PLoS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <issue>12</issue>
        <fpage>1003388</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003388</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibbons</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Kearney</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Smillie</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Alm</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>Two dynamic regimes in the human gut microbiome</article-title>
        <source>PLoS Comput Biol</source>
        <year>2017</year>
        <volume>13</volume>
        <issue>2</issue>
        <fpage>1005364</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005364</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ridenhour</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Brooker</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Van Leuven</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Dearing</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Remien</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>Modeling time-series data from microbial communities</article-title>
        <source>ISME J</source>
        <year>2017</year>
        <volume>11</volume>
        <issue>11</issue>
        <fpage>2526</fpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2017.107</pub-id>
        <?supplied-pmid 28786973?>
        <pub-id pub-id-type="pmid">28786973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shenhav</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Furman</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Briscoe</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Silverman</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Mizrahi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Halperin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Modeling the temporal dynamics of the gut microbial community in adults and infants</article-title>
        <source>PLoS Comput Biol</source>
        <year>2019</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>1006960</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006960</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kelkar</surname>
            <given-names>YD</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>High-dimensional linear state space models for dynamic microbial interaction networks</article-title>
        <source>PloS ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <issue>11</issue>
        <fpage>0187822</fpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lugo-Martinez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ruiz-Perez</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Narasimhan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Dynamic interaction network inference from longitudinal microbiome data</article-title>
        <source>Microbiome</source>
        <year>2019</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>54</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-019-0660-3</pub-id>
        <?supplied-pmid 30940197?>
        <pub-id pub-id-type="pmid">30940197</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Metwally</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ascoli</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Finn</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Perkins</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <article-title>Metalonda: a flexible r package for identifying time intervals of differentially abundant features in metagenomic longitudinal studies</article-title>
        <source>Microbiome</source>
        <year>2018</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>32</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-018-0402-y</pub-id>
        <?supplied-pmid 29439731?>
        <pub-id pub-id-type="pmid">29439731</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shields-Cutler</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Al-Ghalith</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Yassour</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knights</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Splinectomer enables group comparisons in longitudinal microbiome studies</article-title>
        <source>Front Microbiol</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>785</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2018.00785</pub-id>
        <?supplied-pmid 29740416?>
        <pub-id pub-id-type="pmid">29740416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Principal trend analysis for time-course data with applications in genomic medicine</article-title>
        <source>Ann Appl Stat</source>
        <year>2013</year>
        <volume>7</volume>
        <issue>4</issue>
        <fpage>2205</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="doi">10.1214/13-AOAS659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Structure-constrained sparse canonical correlation analysis with an application to microbiome data analysis</article-title>
        <source>Biostatistics</source>
        <year>2012</year>
        <volume>14</volume>
        <issue>2</issue>
        <fpage>244</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxs038</pub-id>
        <?supplied-pmid 23074263?>
        <pub-id pub-id-type="pmid">23074263</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>False discovery rate control incorporating phylogenetic tree increases detection power in microbiome-wide multiple testing</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>18</issue>
        <fpage>2873</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx311</pub-id>
        <?supplied-pmid 28505251?>
        <pub-id pub-id-type="pmid">28505251</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Silverman</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Washburne</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>David</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>A phylogenetic transform enhances analysis of compositional microbiota data</article-title>
        <source>Elife</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>21887</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.21887</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Randolph</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Copeland</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hullar</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shojaie</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Kernel-penalized regression for analysis of microbiome data</article-title>
        <source>Ann Appl Stat</source>
        <year>2018</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>540</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1214/17-AOAS1102</pub-id>
        <?supplied-pmid 30224943?>
        <pub-id pub-id-type="pmid">30224943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cleveland</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Robust locally weighted regression and smoothing scatterplots</article-title>
        <source>J Am Stat Assoc</source>
        <year>1979</year>
        <volume>74</volume>
        <issue>368</issue>
        <fpage>829</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1979.10481038</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cleveland</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Devlin</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Locally weighted regression: an approach to regression analysis by local fitting</article-title>
        <source>J Am Stat Assoc</source>
        <year>1988</year>
        <volume>83</volume>
        <issue>403</issue>
        <fpage>596</fpage>
        <lpage>610</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1988.10478639</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanley</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>McNeil</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>The meaning and use of the area under a receiver operating characteristic (roc) curve</article-title>
        <source>Radiology</source>
        <year>1982</year>
        <volume>143</volume>
        <issue>1</issue>
        <fpage>29</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1148/radiology.143.1.7063747</pub-id>
        <?supplied-pmid 7063747?>
        <pub-id pub-id-type="pmid">7063747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Livanos</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Greiner</surname>
            <given-names>TU</given-names>
          </name>
          <name>
            <surname>Vangay</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pathmasiri</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McRitchie</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sohn</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Antibiotic-mediated gut microbiome perturbation accelerates development of type 1 diabetes in mice</article-title>
        <source>Nat Microbiol</source>
        <year>2016</year>
        <volume>1</volume>
        <issue>11</issue>
        <fpage>16140</fpage>
        <pub-id pub-id-type="doi">10.1038/nmicrobiol.2016.140</pub-id>
        <?supplied-pmid 27782139?>
        <pub-id pub-id-type="pmid">27782139</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stombaugh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Fierer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pena</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Goodrich</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Qiime allows analysis of high-throughput community sequencing data</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>5</issue>
        <fpage>335</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id>
        <?supplied-pmid 20383131?>
        <pub-id pub-id-type="pmid">20383131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pinnell</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <article-title>Shotgun metagenomics reveals the benthic microbial community response to plastic and bioplastic in a coastal marine environment</article-title>
        <source>Front Microbiol</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1252</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2019.01252</pub-id>
        <?supplied-pmid 31231339?>
        <pub-id pub-id-type="pmid">31231339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsilimigras</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Fodor</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>Compositional data analysis of the microbiome: fundamentals, tools, and challenges</article-title>
        <source>Ann Epidemiol</source>
        <year>2016</year>
        <volume>26</volume>
        <issue>5</issue>
        <fpage>330</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1016/j.annepidem.2016.03.002</pub-id>
        <?supplied-pmid 27255738?>
        <pub-id pub-id-type="pmid">27255738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gloor</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Macklaim</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Pawlowsky-Glahn</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Egozcue</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Microbiome datasets are compositional: and this is not optional</article-title>
        <source>Front Microbiol</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>2224</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2017.02224</pub-id>
        <?supplied-pmid 29187837?>
        <pub-id pub-id-type="pmid">29187837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rivera-Pinto</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Egozcue</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Pawlowsky-Glahn</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Paredes</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Noguera-Julian</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Calle</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Balances: a new perspective for microbiome analysis</article-title>
        <source>MSystems</source>
        <year>2018</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>e00053</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1128/mSystems.00053-18</pub-id>
        <?supplied-pmid 30035234?>
        <pub-id pub-id-type="pmid">30035234</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aitchison</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The statistical analysis of compositional data</article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>1982</year>
        <volume>44</volume>
        <issue>2</issue>
        <fpage>139</fpage>
        <lpage>60</lpage>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aitchison</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Egozcue</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Compositional data analysis: where are we and where should we be heading?</article-title>
        <source>Math Geol</source>
        <year>2005</year>
        <volume>37</volume>
        <issue>7</issue>
        <fpage>829</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1007/s11004-005-7383-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Sparse principal component analysis</article-title>
        <source>J Comput Graph Stat</source>
        <year>2006</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>265</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1198/106186006X113430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maxwell</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Chukwudike</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Chinedu</surname>
            <given-names>OV</given-names>
          </name>
          <name>
            <surname>Valentine</surname>
            <given-names>CO</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>OC</given-names>
          </name>
        </person-group>
        <article-title>Comparison of different parametric methods in handling critical multicollinearity: Monte carlo simulation study</article-title>
        <source>Asian J Probab Stat</source>
        <year>2019</year>
        <volume>3</volume>
        <issue>2</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.9734/ajpas/2019/v3i230085</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lahr</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Reducing the impact of pcr-mediated recombination in molecular evolution and environmental studies using a new-generation high-fidelity dna polymerase</article-title>
        <source>Biotechniques</source>
        <year>2009</year>
        <volume>47</volume>
        <issue>4</issue>
        <fpage>857</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.2144/000113219</pub-id>
        <?supplied-pmid 19852769?>
        <pub-id pub-id-type="pmid">19852769</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knights</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Charlson</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Zaneveld</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mozer</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Collman</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>ST</given-names>
          </name>
        </person-group>
        <article-title>Bayesian community-wide culture-independent microbial source tracking</article-title>
        <source>Nat Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <issue>9</issue>
        <fpage>761</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1650</pub-id>
        <?supplied-pmid 21765408?>
        <pub-id pub-id-type="pmid">21765408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Callahan</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Rosen</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>AJA</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Dada2: high-resolution sample inference from illumina amplicon data</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>7</issue>
        <fpage>581</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3869</pub-id>
        <?supplied-pmid 27214047?>
        <pub-id pub-id-type="pmid">27214047</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Rajesh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chalasani</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gelow</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>VH</given-names>
          </name>
          <name>
            <surname>Sanyal</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Smirnova</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Effects of rare microbiome taxa filtering on statistical analysis</article-title>
        <source>Front Microbiol</source>
        <year>2021</year>
        <volume>11</volume>
        <fpage>3203</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2020.607325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cutler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Archetypal analysis</article-title>
        <source>Technometrics</source>
        <year>1994</year>
        <volume>36</volume>
        <issue>4</issue>
        <fpage>338</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1080/00401706.1994.10485840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mørup</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>LK</given-names>
          </name>
        </person-group>
        <article-title>Archetypal analysis for machine learning and data mining</article-title>
        <source>Neurocomputing</source>
        <year>2012</year>
        <volume>80</volume>
        <fpage>54</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neucom.2011.06.033</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <mixed-citation publication-type="other">Moritz S, Sardá A, Bartz-Beielstein T, Zaefferer M, Stork J. Comparison of different methods for univariate time series imputation in r. arXiv preprint arXiv:1510.03924. 2015.</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerber</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>The dynamic microbiome</article-title>
        <source>FEBS Lett</source>
        <year>2014</year>
        <volume>588</volume>
        <issue>22</issue>
        <fpage>4131</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1016/j.febslet.2014.02.037</pub-id>
        <?supplied-pmid 24583074?>
        <pub-id pub-id-type="pmid">24583074</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martiny</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Martiny</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Microbiomes in light of traits: a phylogenetic perspective</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>350</volume>
        <issue>6261</issue>
        <fpage>9323</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aac9323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Rosipal</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Krämer</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Saunders</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Grobelnik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gunn</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shawe-Taylor</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Overview and Recent Advances in Partial Least Squares</article-title>
        <source>International Statistical and Optimization Perspectives Workshop “Subspace, Latent Structure and Feature Selection”</source>
        <year>2005</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer Berlin Heidelberg</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zeleznik</surname>
            <given-names>OA</given-names>
          </name>
          <name>
            <surname>Thallinger</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Kuster</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gholami</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Culhane</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Dimension reduction techniques for the integrative analysis of multi-omics data</article-title>
        <source>Brief Bioinform</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>4</issue>
        <fpage>628</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbv108</pub-id>
        <?supplied-pmid 26969681?>
        <pub-id pub-id-type="pmid">26969681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Good</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>Permutation Tests: a Practical Guide to Resampling Methods for Testing Hypotheses</source>
        <year>2013</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer-Verlag</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Haynes</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Dubitzky</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wolkenhauer</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>K-H</given-names>
          </name>
          <name>
            <surname>Yokota</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Wilcoxon rank sum test</article-title>
        <source>Encyclopedia of Systems Biology</source>
        <year>2013</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer New York</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58</label>
      <mixed-citation publication-type="other">Dmitrienko A, Tamhane AC. Pharmaceutical Statistics: The Journal of Applied Statistics in the Pharmaceutical Industry. 2007; 6(3):171–80.</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Dmitrienko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamhane</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Gatekeeping procedures in clinical trials</article-title>
        <source>Multiple Testing Problems in Pharmaceutical Statistics</source>
        <year>2009</year>
        <publisher-loc>London</publisher-loc>
        <publisher-name>Chapman and Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altman</surname>
            <given-names>NS</given-names>
          </name>
        </person-group>
        <article-title>An introduction to kernel and nearest-neighbor nonparametric regression</article-title>
        <source>Am Stat</source>
        <year>1992</year>
        <volume>46</volume>
        <issue>3</issue>
        <fpage>175</fpage>
        <lpage>85</lpage>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Estimating and testing the microbial causal mediation effect with high-dimensional and compositional microbiome data</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>2</issue>
        <fpage>347</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz565</pub-id>
        <?supplied-pmid 31329243?>
        <pub-id pub-id-type="pmid">31329243</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62</label>
      <mixed-citation publication-type="other">Tvedebrink T. dirmult: Estimation in dirichlet-multinomial distribution. R Package Version 0.1; 2009, p. 3.</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reynolds</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Richards</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>de la Iglesia</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Rayward-Smith</surname>
            <given-names>VJ</given-names>
          </name>
        </person-group>
        <article-title>Clustering rules: a comparison of partitioning and hierarchical clustering algorithms</article-title>
        <source>J Math Model Algoritm</source>
        <year>2006</year>
        <volume>5</volume>
        <issue>4</issue>
        <fpage>475</fpage>
        <lpage>504</lpage>
        <pub-id pub-id-type="doi">10.1007/s10852-005-9022-1</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
