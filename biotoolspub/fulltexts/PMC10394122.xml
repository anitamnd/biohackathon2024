<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10394122</article-id>
    <article-id pub-id-type="pmid">37467069</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad441</article-id>
    <article-id pub-id-type="publisher-id">btad441</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">otargen</italic>: GraphQL-based R package for tidy data accessing and processing from Open Targets Genetics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0566-0422</contrib-id>
        <name>
          <surname>Feizi</surname>
          <given-names>Amir</given-names>
        </name>
        <aff><institution>Bioinformatics Department, OMass Therapeutics</institution>, <addr-line>Oxford Business Park, ARC</addr-line>, Oxford OX4 2GX, <country country="GB">United Kingdom</country></aff>
        <xref rid="btad441-cor1" ref-type="corresp"/>
        <!--amir.feizi@omass.com-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ray</surname>
          <given-names>Kamalika</given-names>
        </name>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="http://credit.niso.org/contributor-roles/data-curation" degree-contribution="supporting">Data curation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="http://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Software" vocab-term-identifier="http://credit.niso.org/contributor-roles/software" degree-contribution="supporting">Software</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Validation" vocab-term-identifier="http://credit.niso.org/contributor-roles/validation" degree-contribution="supporting">Validation</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="http://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role>
        <role vocab="credit" vocab-identifier="http://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="http://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="supporting">Writing - review &amp; editing</role>
        <aff><institution>Bioinformatics Department, OMass Therapeutics</institution>, <addr-line>Oxford Business Park, ARC</addr-line>, Oxford OX4 2GX, <country country="GB">United Kingdom</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad441-cor1">Corresponding author. Bioinformatics Department, OMass Therapeutics, Building 4000, Chancellor Court, John Smith Dr, Oxford Business Park, ARC, Oxford OX4 2GX, United Kingdom. E-mail: <email>amir.feizi@omass.com</email> (A.F.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-07-19">
      <day>19</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>8</issue>
    <elocation-id>btad441</elocation-id>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>13</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>01</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad441.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Open Target Genetics is a comprehensive resource portal that offers variant-centric statistical evidence, enabling the prioritization of causal variants and the identification of potential drug targets. The portal uses GraphQL technology for efficient data query and provides endpoints for programmatic access for R and Python users. However, leveraging GraphQL for data retrieval can be challenging, time-consuming, and repetitive, requiring familiarity with the GraphQL query language and processing outputs in nested JSON (JavaScript Object Notation) format into tidy data tables. Therefore, developing open-source tools are required to simplify data retrieval processes to integrate valuable genetic information into data-driven target discovery pipelines seamlessly.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p><italic toggle="yes">otargen</italic> is an open-source R package designed to make data retrieval and analysis from the Open Target Genetics portal as simple as possible for R users. The package offers a suite of functions covering all query types, allowing streamlined data access in a tidy table format. By executing only a single line of code, the <italic toggle="yes">otargen</italic> users avoid the repetitive scripting of complex GraphQL queries, including the post-processing steps. In addition, <italic toggle="yes">otargen</italic> contains convenient plotting functions to visualize and gain insights from complex data tables returned by several key functions.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><italic toggle="yes">otargen</italic> is available at <ext-link xlink:href="https://amirfeizi.github.io/otargen/" ext-link-type="uri">https://amirfeizi.github.io/otargen/</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>OMass Therapeutics</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In recent years, various studies have demonstrated that approved drug targets often exhibit a higher enrichment of genes with genetic evidence linked to diseases (<xref rid="btad441-B1" ref-type="bibr">Carter <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad441-B5" ref-type="bibr">Nelson <italic toggle="yes">et al.</italic> 2015</xref>). Open Target Genetics (OTG) is an open-source tool to explore and prioritize potential causal variants and genes associated with human diseases and traits. Leveraging aggregated data from genome-wide association studies (GWAS) and functional genomics, OTG provides valuable insights into the genetic landscape of diseases. The GWAS data within OTG includes statistical summary data from prominent genomics projects such as UK Biobank (<ext-link xlink:href="https://www.ukbiobank.ac.uk/" ext-link-type="uri">https://www.ukbiobank.ac.uk/</ext-link>), FINNGEN (<ext-link xlink:href="https://www.finngen.fi/" ext-link-type="uri">https://www.finngen.fi/</ext-link>) (<xref rid="btad441-B4" ref-type="bibr">Mountjoy <italic toggle="yes">et al.</italic> 2021</xref>), and GWAS Catalog (a specific database for collecting and curating GWAS data) (<ext-link xlink:href="https://www.ebi.ac.uk/gwas/" ext-link-type="uri">https://www.ebi.ac.uk/gwas/</ext-link>) (<xref rid="btad441-B2" ref-type="bibr">Ghoussaini <italic toggle="yes">et al.</italic> 2021</xref>). The OTG is a spin-out database from the original portal of the Open Targets Platform (<ext-link xlink:href="https://platform.opentargets.org/" ext-link-type="uri">https://platform.opentargets.org/</ext-link>), a collaborative initiative between EMBL-EBI and several pharmaceutical companies to support systematic identification and prioritization of potential therapeutic drug targets. These two platforms integrate publicly available data sets, including Open Targets consortium data and genetic evidence for gene-disease associations. In addition, relevant annotation information about a target, disease, phenotype, drug, and their most relevant relationships are integrated (<xref rid="btad441-B6" ref-type="bibr">Ochoa <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    <p>The OTG platform supports various levels of data access. The web user interface (UI) offers a practical and user-friendly experience for low-throughput and exploratory analyses. The GraphQL API is available for medium-scale data access, providing a flexible and powerful interface for retrieving specific data subsets. Additionally, the OTG platform enables access to the complete data sets for large-scale analyses (e.g. via FTP). However, the GraphQL interface is a key advantage of OTG because it provides flexible and efficient access to underlined data. Compared to traditional REST APIs, GraphQL offers valuable benefits, including constructing queries that return only the user-defined fields and traverse the graph database to minimize the number of queries. By eliminating the need for round trips to the server, GraphQL improves query performance and reduces network overhead. Users can interact with the OTG portal’s GraphQL API using command-line tools like <italic toggle="yes">curl</italic> and <italic toggle="yes">wget</italic>, executing queries via the provided browser endpoint, or connecting from R and Python environments. While these APIs facilitate data access, they have several challenges. For instance, the browser endpoint helps explore the schema, learn GraphQL, and test queries but is unsuitable for systematic data access. Finalized queries must be transferred and executed in R or Python, leading to inefficiencies. Additionally, users often repeatedly have to write identical queries, resulting in time-consuming and redundant processes. Furthermore, the nested and complex nature of the returned data in JSON format by GraphQL queries poses difficulties in converting it into tidy data tables, a common concern among users. To address these challenges, we have developed the <italic toggle="yes">otargen</italic> R package based on the <italic toggle="yes">ghql</italic> package, which enables connecting and data transactions with OTG’s GraphQL endpoint from the R environment. The primary goal of <italic toggle="yes">otargen</italic> is to facilitate systematic access to the OTG platform, enabling efficient integration of genetic evidence with data-driven target discovery pipelines commonly used in bioinformatics and genetics research.</p>
  </sec>
  <sec>
    <title>2 Description</title>
    <p>The <italic toggle="yes">otargen</italic> package offers a wide range of functions that align with the active GraphQL queries in the OTG schema. To maintain consistency, the function names directly correspond to the query names from GraphQL query schema in OTG. In addition to data retrieval, the package includes specialized plotting functions that enhance data visualization and support insightful analysis. A dedicated function for executing custom GraphQL queries is designed to accommodate specific query requirements. In the upcoming sections, we overview the functionalities offered by <italic toggle="yes">otargen</italic>, organized into three main categories with examples.</p>
    <sec>
      <title>2.1 Schema query functions</title>
      <p>These functions are wrappers for different GraphQL query types defined in the OTG schema. They are specifically designed to retrieve data based on various search parameters, including <italic toggle="yes">variant IDs</italic>, <italic toggle="yes">gene IDs</italic>, and GWAS <italic toggle="yes">study IDs</italic> and perform post-processing steps and return tidy outputs. When executed, each function in this category returns a tidy data table in <italic toggle="yes">tibble</italic> format, ensuring structured and easily accessible data representation.</p>
      <list list-type="bullet">
        <list-item>
          <p><italic toggle="yes">Example—</italic>Retrieve L2G model summary data</p>
        </list-item>
      </list>
      <p>In this exemplary usage, we demonstrate the application of the <italic toggle="yes">studiesAndLeadVariantsForGeneByL2G()</italic> function to obtain one of the core data tables provided by OTG platform. The returned results are the outputs of the OTG’s “locus-to-gene” (L2G) machine learning model, which leverages genetic and functional genomics features to prioritize likely causal genes at each GWAS locus. By specifying the gene(s) of interest and applying customized filters, the function retrieves all partial scores for lead variants in the locus of the specified gene. The resulting data table is comprehensive and presented in a tidy <italic toggle="yes">tibble</italic> format. Below is the example code snippet for this use case.</p>
      <p>
        <inline-graphic xlink:href="btad441ilf1.jpg"/>
      </p>
      <p>As shown in <xref rid="btad441-F1" ref-type="fig">Fig. 1</xref>, users can pipe the output from this function into the <italic toggle="yes">plot_l2g()</italic> and visually explore and prioritize multiple genes for a specific disease.</p>
      <fig position="float" id="btad441-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of <italic toggle="yes">otargen</italic>.</p>
        </caption>
        <graphic xlink:href="btad441f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Plotting functions</title>
      <p><italic toggle="yes">otargen</italic> provides plotting options for several complex data tables returned by its core query functions, including PheWAS (Phenome Wide Association Study) statistics, L2G model, colocalization statistics, and GWAS summary statistics. In the below code snippet, we have shown how the user can quickly generate insightful visualizations by piping the output of such queries into the corresponding plotting function.</p>
      <list list-type="bullet">
        <list-item>
          <p><italic toggle="yes">Example—</italic>Plot data obtained from the <italic toggle="yes">PheWAS()</italic> function</p>
        </list-item>
      </list>
      <p>
        <inline-graphic xlink:href="btad441ilf2.jpg"/>
      </p>
    </sec>
    <sec>
      <title>2.3 Custom query function</title>
      <p><italic toggle="yes">otargen</italic> provides an additional wrapper function <italic toggle="yes">run_custom_ query()</italic> that can execute the user’s custom queries from the OTG GraphQL endpoint. The users must provide a custom GraphQL query code as a character string and the corresponding variable list as arguments to this function.</p>
      <p>In <italic toggle="yes">otargen</italic> package, we have extensively used diverse functionalities from <italic toggle="yes">tidyverse</italic> multi-package to convert complex nested query results in JSON format into a structured <italic toggle="yes">tibble</italic> form. We have used <italic toggle="yes">devtools</italic> package toolbox for developing <italic toggle="yes">otargen</italic> and <italic toggle="yes">pkgdown</italic> package <ext-link xlink:href="https://pkgdown.r-lib.org/" ext-link-type="uri">https://pkgdown.r-lib.org/</ext-link> to build <italic toggle="yes">otargen’</italic>s website.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Usage and documentation</title>
    <p><italic toggle="yes">otargen</italic> can be installed from CRAN running <italic toggle="yes">install.packages(“otargen”)</italic> in the R console. Each <italic toggle="yes">otargen</italic> function features an extensive manual available as function documentation in the R environment using the help flag? <italic toggle="yes">function-name()</italic> in the console. The complete manual with examples can be viewed on the <italic toggle="yes">otargen</italic> website at <ext-link xlink:href="https://amirfeizi.github.io/otargen/" ext-link-type="uri">https://amirfeizi.github.io/otargen/</ext-link>. A separate examples page is available at the “<italic toggle="yes">Get started”</italic> tab of the website, which includes multiple use cases. We recommend using <italic toggle="yes">otargen</italic> for medium-scale queries on short-listed genes or variants to avoid potential performance issues. Open Target Genetics provides alternative approaches for bulk downloading the back-end data designed to accommodate such requirements. For detailed information on data download procedures, please refer to their documentation at <ext-link xlink:href="https://genetics-docs.opentargets.org/data-access/" ext-link-type="uri">https://genetics-docs.opentargets.org/data-access/</ext-link>.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>Identifying the right target is crucial in drug development. Genetic evidence significantly enhances the success rate of drug candidates (<xref rid="btad441-B5" ref-type="bibr">Nelson <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad441-B7" ref-type="bibr">Van Norman 2019</xref>). Open Target Genetics is a collaborative effort providing curated data and machine learning tools to prioritize causal variants (<xref rid="btad441-B3" ref-type="bibr">Kurki <italic toggle="yes">et al.</italic> 2022</xref>). The <italic toggle="yes">otargen</italic> package simplifies tidy data retrieval from OTG’s GraphQL endpoint, facilitating seamless integration of genetics evidence into target discovery pipelines. By streamlining access and analysis of genetic information, <italic toggle="yes">otargen</italic> accelerates the drug development process by facilitating the identification of potential drug targets.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We acknowledge OMass Therapeutics’ support in contributing to the open source tools for accelerating genetic-led drug development.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work has been supported by OMass Therapeutics.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying otargen package access are available in at <ext-link xlink:href="https://genetics-docs.opentargets.org/data-access/data-download" ext-link-type="uri">https://genetics-docs.opentargets.org/data-access/data-download</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad441-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carter</surname><given-names>H</given-names></string-name>, <string-name><surname>Hofree</surname><given-names>M</given-names></string-name>, <string-name><surname>Ideker</surname><given-names>T</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Genotype to phenotype via network analysis</article-title>. <source>Curr Opin Genet Dev</source>  <year>2013</year>;<volume>23</volume>:<fpage>611</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">24238873</pub-id></mixed-citation>
    </ref>
    <ref id="btad441-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ghoussaini</surname><given-names>M</given-names></string-name>, <string-name><surname>Mountjoy</surname><given-names>E</given-names></string-name>, <string-name><surname>Carmona</surname><given-names>M</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>Open targets genetics: systematic identification of trait-associated genes using large-scale genetics and functional genomics</article-title>. <source>Nucleic Acids Res</source>  <year>2021</year>;<volume>49</volume>:<fpage>D1311</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">33045747</pub-id></mixed-citation>
    </ref>
    <ref id="btad441-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kurki</surname><given-names>MI</given-names></string-name>, <string-name><surname>Karjalainen</surname><given-names>J</given-names></string-name>, <string-name><surname>Palta</surname><given-names>P</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>FinnGen provides genetic insights from a well-phenotyped isolated population</article-title>. <source><italic toggle="yes">Nature</italic></source>  <year>2023</year>;<volume>613</volume>:<fpage>508</fpage>–<lpage>18</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-022-05473-8</pub-id>.<pub-id pub-id-type="pmid">36653562</pub-id></mixed-citation>
    </ref>
    <ref id="btad441-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mountjoy</surname><given-names>E</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>EM</given-names></string-name>, <string-name><surname>Carmona</surname><given-names>M</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>An open approach to systematically prioritize causal variants and genes at all published human GWAS trait-associated loci</article-title>. <source>Nat Genet</source>  <year>2021</year>;<volume>53</volume>:<fpage>1527</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">34711957</pub-id></mixed-citation>
    </ref>
    <ref id="btad441-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nelson</surname><given-names>MR</given-names></string-name>, <string-name><surname>Tipney</surname><given-names>H</given-names></string-name>, <string-name><surname>Painter</surname><given-names>JL</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>The support of human genetic evidence for approved drug indications</article-title>. <source>Nat Genet</source>  <year>2015</year>;<volume>47</volume>:<fpage>856</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">26121088</pub-id></mixed-citation>
    </ref>
    <ref id="btad441-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ochoa</surname><given-names>D</given-names></string-name>, <string-name><surname>Hercules</surname><given-names>A</given-names></string-name>, <string-name><surname>Carmona</surname><given-names>M</given-names></string-name></person-group>  <etal>et al</etal>  <article-title>The next-generation open targets platform: reimagined, redesigned, rebuilt</article-title>. <source>Nucleic Acids Res</source>  <year>2022</year>;<volume>51</volume>:<fpage>D1353</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad441-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Norman</surname><given-names>GA.</given-names></string-name></person-group>  <article-title>Phase II trials in drug development and adaptive trial design</article-title>. <source>JACC Basic Transl Sci</source>  <year>2019</year>;<volume>4</volume>:<fpage>428</fpage>–<lpage>37</lpage>.<pub-id pub-id-type="pmid">31312766</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
