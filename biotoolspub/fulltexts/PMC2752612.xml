<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2752612</article-id>
    <article-id pub-id-type="pmid">19654119</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp450</article-id>
    <article-id pub-id-type="publisher-id">btp450</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ShortRead: a bioconductor package for input, quality assessment and exploration of high-throughput sequence data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Morgan</surname>
          <given-names>Martin</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Anders</surname>
          <given-names>Simon</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lawrence</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aboyoun</surname>
          <given-names>Patrick</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pagès</surname>
          <given-names>Hervé</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gentleman</surname>
          <given-names>Robert</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Program in Computational Biology, Fred Hutchinson Cancer Research Center, Seattle, WA, USA and <sup>2</sup>European Bioinformatics Institute (EMBL-EBI), Hinxton, Cambridge, UK</aff>
    <author-notes>
      <corresp id="COR1"><sup>*</sup>To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Dmitrij Frishman</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>10</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>25</volume>
    <issue>19</issue>
    <fpage>2607</fpage>
    <lpage>2608</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>4</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>6</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>7</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5/uk/">http://creativecommons.org/licenses/by-nc/2.5/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold><monospace>ShortRead</monospace> is a package for input, quality assessment, manipulation and output of high-throughput sequencing data. <monospace>ShortRead</monospace> is provided in the <monospace>R</monospace> and <monospace>Bioconductor</monospace> environments, allowing ready access to additional facilities for advanced statistical analysis, data transformation, visualization and integration with diverse genomic resources.</p>
      <p><bold>Availability and Implementation:</bold> This package is implemented in R and available at the Bioconductor web site; the package contains a ‘vignette’ outlining typical work flows.</p>
      <p>
        <bold>Contact:</bold>
        <email>mtmorgan@fhcrc.org</email>
      </p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>High-throughput DNA sequencing technologies include Illumina (Solexa) (Bentley <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2008</xref>), Roche 454 (Torres <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2008</xref>) and other platforms. These technologies produce millions of DNA sequences of tens to hundreds of nucleotides each. Biological questions addressed with this data include SNP calling, ChIP-seq (Mardis, <xref ref-type="bibr" rid="B7">2007</xref>), and RNA-seq (Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2008</xref>).</p>
  <p>We introduce the <monospace>ShortRead</monospace> package, part of the <monospace>Bioconductor</monospace> (Gentleman <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2004</xref>) project. <monospace>ShortRead</monospace> extends <monospace>Bioconductor</monospace> with tools useful in the initial stages of short-read DNA sequence analysis. Main functionalities include data input, quality assessment, data transformation and access to downstream analysis opportunities. <monospace>ShortRead</monospace> is an important gateway to use of <monospace>Bioconductor</monospace> for processing high-throughput DNA sequence data.</p>
  <sec id="SEC1">
    <title>1 AVAILABLE FUNCTIONALITY</title>
    <sec id="SEC1.1">
      <title>1.1 Input and output</title>
      <p><monospace>ShortRead</monospace> provides mechanisms for input of diverse high-throughput sequence data. A major starting point is reads aligned to references, as from manufacturer software or aligners such as <monospace>MAQ</monospace> (Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2008</xref>) and <monospace>Bowtie</monospace> (Langmead <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2009</xref>). <monospace>ShortRead</monospace> parses additional formats (e.g. fasta, fastq and arbitrary column-oriented text files). Resulting <monospace>R</monospace> data structures allow manipulation of sequence, quality, alignment and other information. Input functions transparently parse compressed ( <monospace>.gz</monospace>) files; most file types can be read as ‘chunks’, to allow processing of data subsets. <monospace>ShortRead</monospace> inputs but does not specially represent fine-grained alignment descriptions (e.g. in Stockholm format).</p>
      <p>Facilities for data output include fasta and fastq text formats, arbitrary column-oriented output of reads and auxiliary information, serialization of objects in native <monospace>R</monospace> format, and through use of additional <monospace>R</monospace> packages such as <monospace>rtracklayer</monospace> export to common genome browser formats such as <monospace>wiggle</monospace>, <monospace>bed</monospace> and <monospace>gff</monospace> (Kuhn <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2008</xref>).</p>
    </sec>
    <sec id="SEC1.2">
      <title>1.2 Quality assessment</title>
      <p><monospace>ShortRead</monospace> includes facilities for assessment (QA) of read quality, sample processing and sequencing artifacts, and alignment characteristics. The QA pipeline can start with base calls and their quality scores (e.g. fastq or qseq files), as well as aligned data formats from special-purpose aligners. The result is an HTML report with embedded narrative to facilitate interpretation; a sample report is included with the package. Illustrative results are shown in <xref ref-type="fig" rid="F1">Figure 1</xref>. Highlights include: (i) The number of raw, filtered and aligned reads; (ii) Base call frequencies. (iii) Cycle-specific base calls and read qualities (e.g. <xref ref-type="fig" rid="F1">Fig. 1</xref>A). (iv) Tabulation of read occurrences (how often reads are represented once, twice, …, <italic>n</italic> times). For instance, reads occurring once or a few times (to the left in <xref ref-type="fig" rid="F1">Fig. 1</xref>B) may be unique due to base call errors, whereas reads occurring very frequently (at the extreme right in <xref ref-type="fig" rid="F1">Fig. 1</xref>B) typically reflect PCR or resequencing issues. (v) Preliminary alignment quality score summaries. Technology-specific quality measures are also generated, especially for Illumina's Genome Analyzer (e.g. tile-specific read counts and qualities).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Quality assessment. (<bold>A</bold>) Unlikely directional nucleotide change and base calls (cycle 26) from a Short Read Archive accession. (<bold>B</bold>) Left and right ‘tails’ correspond to infrequently and highly repeated reads, respectively, in a φX174 control lane.</p></caption><graphic xlink:href="btp450f1"/></fig>
</p>
    </sec>
    <sec id="SEC1.3">
      <title>1.3 Transformation and downstream analysis</title>
      <p><monospace>ShortRead</monospace> provides facilities for data exploration, transformation, and down-stream analysis. For example, <monospace>alphabetByCycle</monospace> summarizes cycle-specific nucleotide counts (<xref ref-type="fig" rid="F1">Fig. 1</xref>A) and base qualities. The <monospace>alphabetFrequency</monospace> function summarizes nucleotide use over all cycles, on a per-read basis or over the entire set of reads. The <monospace>tables</monospace> summarizes commonly occurring sequences, as illustrated in <xref ref-type="fig" rid="F1">Figure 1</xref>B. <monospace>ShortRead</monospace> contains facilities for sorting reads, finding duplicates, trimming left and right ends and for exploiting the extensive string pattern matching functions of <monospace>Biostrings</monospace>.</p>
      <p>The features described here are generally fast, operating on tens of millions of short reads in a few seconds; input of large text files can be slow, taking 3–5 min for 50 million 36mers. Sixty-four bit platforms with 4–8 GB of memory are typically sufficient.</p>
      <p><monospace>ShortRead</monospace> provides extensible ‘filter’ functions for removing short reads satisfying predefined or <italic>ad hoc</italic> criteria. For instance, the <monospace>dustyFilter</monospace> identifies and removes low-complexity reads. Filters can be composed to formulate complex criteria. Additional <monospace>ShortRead</monospace> functionality is a starting point for downstream analysis. The function <monospace>coverage</monospace> summarizes [possibly ‘extended’, see Kharchenko <italic>et al.</italic> (<xref ref-type="bibr" rid="B3">2008</xref>)] alignments as vectors tallying the number of reads over each nucleotide in the reference.</p>
      <p><monospace>ShortRead</monospace> is one of several <monospace>Bioconductor</monospace> packages for sequence analysis. <monospace>Biostrings</monospace> has flexible tools for pattern matching, sequence alignment and manipulation. <monospace>BSgenome</monospace> provides facilities for representing and efficiently manipulating whole genomes. <monospace>IRanges</monospace> provides range-based and other expressive representations. <monospace>rtracklayer</monospace> provides an interface to genome browsers from within <monospace>R</monospace> sessions.</p>
    </sec>
    <sec id="SEC1.4">
      <title>1.4 Advanced features</title>
      <p>The <monospace>ShortRead</monospace> package includes advanced features for handling large resequencing data. In particular the large volume of data and generation in ‘lanes’ encourages a ‘block’ processing style. For instance much of the QA functionality of <monospace>ShortRead</monospace> can be conducted on a per-lane basis. The <monospace>srapply</monospace> function exploits this work flow. A typical use takes a list of file names and a function to be applied to the file. <monospace>srapply</monospace> applies the function to each file. Usually the function reduces the data volume in the file, e.g. from a large collection of reads to a compact summary of lane quality. The distinguishing feature of <monospace>srapply</monospace> is that the calculation is distributed across processors or nodes in a computer cluster, if such resources exist.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC2">
    <title>2 CONCLUSIONS</title>
    <p>This note introduces the <monospace>Bioconductor</monospace> <monospace>ShortRead</monospace> package for analysis of resequencing data. The package allows input into <monospace>R</monospace> of diverse sequence-related files, and output of common data formats. It provides quality assessment tools and HTML-based report-generating functionality. <monospace>ShortRead</monospace> data structures allow convenient manipulation of data, such as filtering reads based on sequence characteristics. The package work flow represents an entry point for down-stream analysis using <monospace>Bioconductor</monospace> or other software. Future plans include improved support for longer and paired-end reads, and development of additional quantitative measures of quality; the challenge of incorporating the SOLiD color space model into standard work flows precludes support for this format beyond that available from data transformed to sequence and Phred-like quality scores.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We are grateful to early adopters and <monospace>Bioconductor</monospace> course participants for their helpful input.</p>
    <p><italic>Funding</italic>: National Human Genome Research Institute (grant P41HG004059 R.G.); EU (Research and Training Network ‘Chromatin Plasticity’ to S.A).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentley</surname>
            <given-names>DR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate whole human genome sequencing using reversible terminator chemistry</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>53</fpage>
        <lpage>59</lpage>
        <pub-id pub-id-type="pmid">18987734</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>
        <source>Genome Biol.</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Design and analysis of chip-seq experiments for DNA-binding protiens</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2008</year>
        <volume>12</volume>
        <fpage>1351</fpage>
        <lpage>1359</lpage>
        <pub-id pub-id-type="pmid">19029915</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhn</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UCSC genome browser database: update 2009</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>37</volume>
        <fpage>D755</fpage>
        <lpage>D761</lpage>
        <pub-id pub-id-type="pmid">18996895</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>ChIP-seq: welcome to the new frontier</article-title>
        <source>Nat. Methods</source>
        <year>2007</year>
        <volume>4</volume>
        <fpage>613</fpage>
        <lpage>614</lpage>
        <pub-id pub-id-type="pmid">17664943</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torres</surname>
            <given-names>TT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene expression profiling by massively parallel sequencing</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>172</fpage>
        <lpage>177</lpage>
        <pub-id pub-id-type="pmid">18032722</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
