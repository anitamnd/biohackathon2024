<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9841403</article-id>
    <article-id pub-id-type="pmid">36592035</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac849</article-id>
    <article-id pub-id-type="publisher-id">btac849</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PrioriTree: a utility for improving phylodynamic analyses in BEAST</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5108-828X</contrib-id>
        <name>
          <surname>Gao</surname>
          <given-names>Jiansi</given-names>
        </name>
        <aff><institution>Department of Evolution and Ecology, University of California, Davis</institution>, Davis, CA 95616, <country country="US">USA</country></aff>
        <xref rid="btac849-cor1" ref-type="corresp"/>
        <!--jsigao@ucdavis.edu-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>May</surname>
          <given-names>Michael R</given-names>
        </name>
        <aff><institution>Department of Evolution and Ecology, University of California, Davis</institution>, Davis, CA 95616, <country country="US">USA</country></aff>
        <aff><institution>Department of Integrative Biology, University of California, Berkeley</institution>, Berkeley, CA 94720, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rannala</surname>
          <given-names>Bruce</given-names>
        </name>
        <aff><institution>Department of Evolution and Ecology, University of California, Davis</institution>, Davis, CA 95616, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moore</surname>
          <given-names>Brian R</given-names>
        </name>
        <aff><institution>Department of Evolution and Ecology, University of California, Davis</institution>, Davis, CA 95616, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac849-cor1">To whom correspondence should be addressed <email>jsigao@ucdavis.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-01-02">
      <day>02</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>02</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac849</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>27</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>16</day>
        <month>1</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac849.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Phylodynamic methods are central to studies of the geographic and demographic history of disease outbreaks. Inference under discrete-geographic phylodynamic models—which involve many parameters that must be inferred from minimal information—is inherently sensitive to our prior beliefs about the model parameters. We present an interactive utility, <monospace>PrioriTree</monospace>, to help researchers identify and accommodate prior sensitivity in discrete-geographic inferences. Specifically, <monospace>PrioriTree</monospace> provides a suite of functions to generate input files for—and summarize output from—<monospace>BEAST</monospace> analyses for performing robust Bayesian inference, data-cloning analyses and assessing the relative and absolute fit of candidate discrete-geographic (prior) models to empirical datasets.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p><monospace>PrioriTree</monospace> is distributed as an R package available at <monospace><ext-link xlink:href="https://github.com/jsigao/prioritree" ext-link-type="uri">https://github.com/jsigao/prioritree</ext-link></monospace>, with a comprehensive user manual provided at <monospace><ext-link xlink:href="https://bookdown.org/jsigao/prioritree_manual/" ext-link-type="uri">https://bookdown.org/jsigao/prioritree_manual/</ext-link></monospace>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Phylogenies are increasingly used to study the dispersal history and dynamics of pathogens. The phylodynamic methods developed by <xref rid="btac849-B13" ref-type="bibr">Lemey <italic toggle="yes">et al.</italic> (2009)</xref> and <xref rid="btac849-B6" ref-type="bibr">Edwards <italic toggle="yes">et al.</italic> (2011)</xref> are frequently used to infer key aspects of the geographic history of disease outbreaks, including: (1) the area in which an epidemic originated; (2) the dispersal routes by which the pathogen spread among geographic areas, and; (3) the number of dispersal events between areas.</p>
    <p>The process of geographic dispersal among a set of discrete areas is modeled as a continuous-time Markov chain. For a geographic history with <inline-formula id="IE9000"><mml:math id="IM9000" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula> areas, this stochastic process is fully specified by a <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:math></inline-formula> instantaneous-rate matrix, <bold>Q</bold>, where an element of the matrix, <italic toggle="yes">q<sub>ij</sub></italic>, specifies the instantaneous rate of dispersal from area <italic toggle="yes">i</italic> to area <italic toggle="yes">j</italic>. An additional parameter, <italic toggle="yes">μ</italic>, specifies the average dispersal rate among all areas. We estimate parameters of these phylodynamic models within a Bayesian statistical framework using the Markov chain Monte Carlo (MCMC) algorithms implemented in <monospace>BEAST</monospace> (<xref rid="btac849-B5" ref-type="bibr">Drummond <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btac849-B19" ref-type="bibr">Suchard <italic toggle="yes">et al.</italic>, 2018</xref>). This approach requires that we first specify a prior probability distribution for each parameter (reflecting our beliefs about that parameter before evaluating the study data); the prior is then updated by the information in the data to return the corresponding posterior probability distribution (reflecting our updated beliefs about the parameter in light of our study data).</p>
    <p>To enhance the realism of phylodynamic inferences, empirical studies frequently adopt a granular discretization of continuous geographic space into many discrete areas (<xref rid="btac849-B7" ref-type="bibr">Gao <italic toggle="yes">et al.</italic>, 2022a</xref>). However, the complexity of geographic models increases rapidly as we increase the number of areas. For example, under an asymmetric geographic model (where the dispersal rate from area <italic toggle="yes">i</italic> to area <italic toggle="yes">j</italic> is allowed to differ from the dispersal rate from area <italic toggle="yes">j</italic> to area <italic toggle="yes">i</italic>), a geographic inference with <inline-formula id="IE9001"><mml:math id="IM9001" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:math></inline-formula> areas has 20 pairwise dispersal-rate parameters, with <inline-formula id="IE9002"><mml:math id="IM9002" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math></inline-formula> areas has 90 such parameters and with <inline-formula id="IE9003"><mml:math id="IM9003" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:math></inline-formula> areas has 380 such parameters. In every case, we must estimate these parameters from a dataset with minimal information; a single geographic observation (the area where each pathogen was sampled). This inference scenario raises concerns about <italic toggle="yes">prior sensitivity</italic>, <italic toggle="yes">i.e.</italic>, where posterior parameter estimates are strongly influenced by our choice of priors on the model parameters.</p>
    <p>We have previously demonstrated that prior sensitivity is, in fact, a pervasive feature of empirical phylodynamic studies (<xref rid="btac849-B7" ref-type="bibr">Gao <italic toggle="yes">et al.</italic>, 2022a</xref>). This inherent prior sensitivity is of particular concern because the priors on discrete-geographic model parameters implemented as the defaults in <monospace>BEAST</monospace>—and used in the vast majority of phylodynamic studies—reflect extremely strong and biologically unrealistic assumptions about the underlying dispersal process (<xref rid="btac849-B7" ref-type="bibr">Gao <italic toggle="yes">et al.</italic>, 2022a</xref>). These considerations motivated our development of <monospace>PrioriTree</monospace>, an interactive utility for identifying and navigating prior sensitivity in discrete-geographic analyses.</p>
  </sec>
  <sec>
    <title>2 Features</title>
    <p><monospace>PrioriTree</monospace> includes a suite of functions to generate input files for—and summarize output from—<monospace>BEAST</monospace> (v. 1.x) analyses that allow users to perform robust Bayesian inference, data-cloning analyses and assess the relative and absolute fit of candidate discrete-geographic (prior) models to empirical datasets. We briefly outline these features below.</p>
    <sec>
      <title>2.1 Robust Bayesian inference</title>
      <p><monospace>PrioriTree</monospace> allows users to assess the prior sensitivity of geographic inferences using a robust Bayesian inference approach (<xref rid="btac849-B2" ref-type="bibr">Berger, 1994</xref>). This approach simply involves performing a series of MCMC analyses—of the same dataset under the same inference model—where we iteratively change one (or more) priors of our discrete-geographic model for each separate analysis. We then compare the resulting series of marginal posterior probability distributions for a given parameter to assess whether (or how much) our estimates change under different priors. While conceptually simple, the main practical challenge with this approach is deciding which parameters to explore and how many alternative priors to evaluate for each parameter under scrutiny.</p>
      <p><monospace>PrioriTree</monospace> allows users to explore a wide range of priors for each of the discrete-geographic model parameters. Moreover, the <monospace>PrioriTree</monospace> interface dynamically generates a graphical plot of the specified prior probability distribution to help clarify the biological implications of that prior choice. For example, an investigator may lack intuition (and/or prior knowledge) about the average rate of pathogen dispersal, <italic toggle="yes">μ</italic>; however, <monospace>PrioriTree</monospace> provides plots of the prior distribution for the number of dispersal events corresponding to a given choice of prior on <italic toggle="yes">μ</italic>. This may help guide the choice of prior; <italic toggle="yes">e.g.,</italic> we minimally know that a pathogen that occurs in 10 areas must have experienced at least 9 dispersal events. This increased transparency may help researchers identify plausible priors to be explored via robust Bayesian inference.</p>
      <p><monospace>PrioriTree</monospace> provides graphical summaries of prior-sensitivity analyses, plotting distributions for a given parameter under the range of candidate priors (<xref rid="btac849-F1" ref-type="fig">Fig. 1</xref>). If the inferred marginal posterior probability distributions for a given parameter are (more or less) identical under a range of corresponding priors, then we can safely conclude that our estimates of this parameter are robust to the choice of prior. Conversely, if the marginal posterior probability distributions vary substantially (and resemble their corresponding marginal prior probability distributions), then we would conclude that this parameter exhibits prior sensitivity.</p>
      <fig position="float" id="btac849-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Assessing prior sensitivity in analyses of an example dataset. <monospace>PrioriTree</monospace> allows users to assess the prior sensitivity of discrete-geographic analyses performed using <monospace>BEAST</monospace>. Here, we explore the prior sensitivity of the average dispersal rate parameter, <italic toggle="yes">μ</italic>. Panels summarize estimates of <italic toggle="yes">μ</italic> under two priors; a CTMC-rate reference prior (used as the default in <monospace>BEAST</monospace>, left) and a hierarchical exponential prior (right). Within each panel, each boxplot summarizes the marginal distribution for <italic toggle="yes">μ</italic> inferred for different numbers of data clones (<italic toggle="yes">x</italic>-axis); the prior is inferred without data (green), the posterior is inferred from a single copy (purple) and the data-cloning posteriors are inferred from datasets with 5 or 20 copies (gray). Each pair of boxplots represents replicate analyses (to assess MCMC performance)</p>
        </caption>
        <graphic xlink:href="btac849f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Data-cloning analyses</title>
      <p><monospace>PrioriTree</monospace> also allows us to assess the prior sensitivity of our discrete-geographic inferences using an approach called data cloning (<xref rid="btac849-B12" ref-type="bibr">Lele <italic toggle="yes">et al.</italic>, 2007</xref>; <xref rid="btac849-B15" ref-type="bibr">Ponciano <italic toggle="yes">et al.</italic>, 2009</xref>, <xref rid="btac849-B16" ref-type="bibr">2012</xref>; <xref rid="btac849-B18" ref-type="bibr">Robert, 1993</xref>). In contrast to robust Bayesian inference, which explores the impact of <italic toggle="yes">different</italic> prior choices, data cloning is a tool for assessing the impact of a <italic toggle="yes">specific</italic> prior. Intuitively, data cloning measures the relative contribution of the data and the prior to the posterior distribution: an analysis is prior sensitive when the prior makes a relatively large contribution to the posterior. In practice, we perform a series of MCMC analyses—under the same inference model with identical priors—where we iteratively increment the number of copies (“clones”) of our original dataset; increasing the number of clones corresponds to increasing the relative contribution of the data to the posterior. We then explore the resulting series of posterior distributions to assess how our estimates change as the level of information in the data increases (<italic toggle="yes">i.e.</italic>, as we increment the number of data clones).</p>
      <p>Data cloning involves a series of MCMC simulations, each with a power <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the number of copies of the original dataset. When <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, we are targeting the joint prior probability distribution (<italic toggle="yes">i.e.</italic>, we would be running the MCMC without data), when <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, we are targeting the joint posterior probability distribution (<italic toggle="yes">i.e.</italic>, we would be running the MCMC using our original dataset). As <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mo>∞</mml:mo></mml:mrow></mml:math></inline-formula>, the marginal posterior distribution for the parameter under consideration will converge to a point value that is identical to the maximum-likelihood estimate (MLE) for that parameter (assuming the parameter is identifiable).</p>
      <p>Of interest here is the relative rate at which the marginal posterior probability distribution for the parameter under scrutiny—given the prior specified for that parameter—converges to the MLE as we increase the clone number. If the prior is very informative (<italic toggle="yes">i.e.</italic>, focused on a narrow range of parameter values) and/or the prior mean is far from the MLE value, the rate of convergence will be slow. Conversely, if a prior is more diffuse (<italic toggle="yes">i.e.</italic>, spread over a relatively wide range of parameter values) and/or the posterior mean is relatively close to the MLE value, the rate of convergence will be relatively fast.</p>
      <p><monospace>PrioriTree</monospace> generates summaries to assess the convergence rate by plotting marginal distributions for a given parameter under the range of <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> values that were explored. For example, <xref rid="btac849-F1" ref-type="fig">Figure 1</xref> depicts the output from data-cloning analyses of an example dataset (<xref rid="btac849-B8" ref-type="bibr">Gao <italic toggle="yes">et al.</italic>, 2022b</xref>) to explore the prior sensitivity of the average dispersal rate parameter, <italic toggle="yes">μ</italic>. Under the CTMC-rate reference prior on <italic toggle="yes">μ</italic>, the posterior-mean estimates increase significantly as we increment the number of clones (i.e., where <inline-formula id="IE9004"><mml:math id="IM9004" display="inline" overflow="scroll"><mml:mi>i</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, 5 or 20 copies of the original dataset; <xref rid="btac849-F1" ref-type="fig">Fig. 1</xref>, left panel). Accordingly, this is a highly informative prior on <italic toggle="yes">μ</italic>; i.e., the contribution of this prior to the posterior is large compared to that from the data. By contrast, under the hierarchical-exponential prior on <italic toggle="yes">μ</italic>, the posterior-mean estimates are effectively identical across clone numbers, indicating that this prior is relatively uninformative (<xref rid="btac849-F1" ref-type="fig">Fig. 1</xref>, right panel).</p>
    </sec>
    <sec>
      <title>2.3 Assessing the absolute and relative fit of (prior) models</title>
      <p><monospace>PrioriTree</monospace> implements functions to assess the adequacy (<italic toggle="yes">i.e.</italic>, absolute fit) of the specified (prior) model to our study data using an approach called posterior-predictive simulation (<xref rid="btac849-B3" ref-type="bibr">Bollback, 2002</xref>; <xref rid="btac849-B9" ref-type="bibr">Gelman <italic toggle="yes">et al.</italic>, 1996</xref>). This Bayesian approach for assessing model adequacy is based on the following premise: if our inference model provides an adequate description of the process that gave rise to our observed data, then we should be able to use that model to simulate datasets that resemble our original data. The resemblance between the observed and simulated datasets is quantified using a summary statistic. <monospace>PrioriTree</monospace> allows users to perform posterior-predictive simulations using the output of <monospace>BEAST</monospace> discrete-geographic analyses and then computes and plots the summary statistics to assess model adequacy (<xref rid="btac849-F2" ref-type="fig">Fig. 2</xref>). <monospace>PrioriTree</monospace> also provides functions to set up power-posterior analyses for estimating the marginal likelihoods of candidate models in <monospace>BEAST</monospace> (<xref rid="btac849-B1" ref-type="bibr">Baele <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btac849-B11" ref-type="bibr">Lartillot and Philippe, 2006</xref>; <xref rid="btac849-B20" ref-type="bibr">Xie <italic toggle="yes">et al.</italic>, 2011</xref>) to compare the relative fit of competing (prior) models to the geographic data using Bayes factors (<xref rid="btac849-B10" ref-type="bibr">Kass and Raftery, 1995</xref>).</p>
      <fig position="float" id="btac849-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Assessing model adequacy in analyses of an example dataset. <monospace>PrioriTree</monospace> allows users to assess the absolute fit of alternative prior models to the data using posterior-predictive simulation. Each boxplot depicts the posterior-predictive distribution of the summary statistic computed from datasets simulated under the CTMC-rate reference prior on <italic toggle="yes">μ</italic> (left panel) or an alternative (hierarchical exponential) prior (right panel). Posterior-predictive distributions under the hierarchical exponential prior overlap with the observed data (dashed horizontal line), indicating that this prior model provides an adequate description of the process that gave rise to the example dataset, whereas the CTMC-rate reference prior is inadequate. Each pair of boxplots represents posterior-predictive summaries for replicate MCMC simulations</p>
        </caption>
        <graphic xlink:href="btac849f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.4 Additional features</title>
      <p><monospace>PrioriTree</monospace> assumes that the phylogeny and geographic history are inferred sequentially. Under this sequential-inference approach, the phylogeny of the study group is first estimated from a sequence alignment using <monospace>BEAST</monospace>. These phylogenetic estimates are then read into <monospace>PrioriTree</monospace> as a single summary tree or as a posterior distribution of trees. If the input file contains a posterior distribution of trees, <monospace>PrioriTree</monospace> allows users to specify how to marginalize over the distribution to accommodate phylogenetic uncertainty in the discrete-geographic inference.</p>
      <p>Users can also set up other <monospace>BEAST</monospace> discrete-geographic inferences (<italic toggle="yes">e.g.</italic>, inferring the number of dispersal events between each pair of geographic areas) in <monospace>PrioriTree</monospace>. In addition to generating XML scripts (as input files for <monospace>BEAST</monospace> analyses) and figures and tables (summarizing various analysis), <monospace>PrioriTree</monospace> also dynamically generates an explicit description of the methods and parameters used for each biogeographic analysis to enhance the reproducibility of phylodynamic studies (<xref rid="btac849-B14" ref-type="bibr">Magee <italic toggle="yes">et al.</italic>, 2014</xref>).</p>
    </sec>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the editor and two anonymous reviewers for providing thoughtful comments that greatly improved the article.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This research was supported by the National Science Foundation grants DEB-0842181, DEB-0919529, DBI-1356737, and DEB-1457835 awarded to B.R.M., and the National Institutes of Health grant RO1GM123306-S awarded to B.R.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p><monospace>PrioriTree</monospace> is developed and distributed as an R Shiny package (<xref rid="btac849-B4" ref-type="bibr">Chang <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac849-B17" ref-type="bibr">R Core Team, 2021</xref>)—that provides a dynamic, graphical-user interface via a local web browser—hosted on GitHub (<monospace><ext-link xlink:href="https://github.com/jsigao/prioritree" ext-link-type="uri">https://github.com/jsigao/prioritree</ext-link></monospace>), with a comprehensive user manual available at <monospace><ext-link xlink:href="https://bookdown.org/jsigao/prioritree_manual/" ext-link-type="uri">https://bookdown.org/jsigao/prioritree_manual/</ext-link></monospace>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac849-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baele</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Improving the accuracy of demographic and molecular clock model comparison while accommodating phylogenetic uncertainty</article-title>. <source>Mol. Biol. Evol</source>., <volume>29</volume>, <fpage>2157</fpage>–<lpage>2167</lpage>.<pub-id pub-id-type="pmid">22403239</pub-id></mixed-citation>
    </ref>
    <ref id="btac849-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berger</surname><given-names>J.O.</given-names></string-name></person-group><etal>et al</etal> (<year>1994</year>) <article-title>An overview of robust bayesian analysis</article-title>. <source>Test</source>, <volume>3</volume>, <fpage>5</fpage>–<lpage>124</lpage>.</mixed-citation>
    </ref>
    <ref id="btac849-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bollback</surname><given-names>J.P.</given-names></string-name></person-group> (<year>2002</year>) <article-title>Bayesian model adequacy and choice in phylogenetics</article-title>. <source>Mol. Biol. Evol</source>., <volume>19</volume>, <fpage>1171</fpage>–<lpage>1180</lpage>.<pub-id pub-id-type="pmid">12082136</pub-id></mixed-citation>
    </ref>
    <ref id="btac849-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>W.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <italic toggle="yes">shiny: Web Application Framework for R</italic>. R package version 1.7.1. <ext-link xlink:href="https://shiny.rstudio.com/" ext-link-type="uri">https://shiny.rstudio.com/</ext-link>.</mixed-citation>
    </ref>
    <ref id="btac849-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drummond</surname><given-names>A.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Bayesian phylogenetics with BEAUti and the BEAST 1.7</article-title>. <source>Mol. Biol. Evol</source>., <volume>29</volume>, <fpage>1969</fpage>–<lpage>1973</lpage>.<pub-id pub-id-type="pmid">22367748</pub-id></mixed-citation>
    </ref>
    <ref id="btac849-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Edwards</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2011</year>) <article-title>Ancient hybridization and an Irish origin for the modern polar bear matriline</article-title>. <source>Curr. Biol</source>., <volume>21</volume>, <fpage>1251</fpage>–<lpage>1258</lpage>.<pub-id pub-id-type="pmid">21737280</pub-id></mixed-citation>
    </ref>
    <ref id="btac849-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gao</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2022a</year>) Model misspecification misleads inference of the spatial dynamics of disease outbreaks. <italic toggle="yes">medRxiv</italic>, <pub-id pub-id-type="doi">10.1101/2022.08.24.22278802</pub-id>.</mixed-citation>
    </ref>
    <ref id="btac849-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gao</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2022b</year>) <article-title>New phylogenetic models incorporating interval-specific dispersal dynamics improve inference of disease spread</article-title>. <source>Mol. Biol. Evol</source>., <volume>39</volume>, <fpage>msac159</fpage>.<pub-id pub-id-type="pmid">35861314</pub-id></mixed-citation>
    </ref>
    <ref id="btac849-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gelman</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>1996</year>) <article-title>Posterior predictive assessment of model fitness via realized discrepancies</article-title>. <source>Stat. Sin</source>., <bold>6</bold>, <fpage>733</fpage>–<lpage>760</lpage>.</mixed-citation>
    </ref>
    <ref id="btac849-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kass</surname><given-names>R.E.</given-names></string-name>, <string-name><surname>Raftery</surname><given-names>A.E.</given-names></string-name></person-group> (<year>1995</year>) <article-title>Bayes factors</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>90</volume>, <fpage>773</fpage>–<lpage>795</lpage>.</mixed-citation>
    </ref>
    <ref id="btac849-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lartillot</surname><given-names>N.</given-names></string-name>, <string-name><surname>Philippe</surname><given-names>H.</given-names></string-name></person-group> (<year>2006</year>) <article-title>Computing Bayes factors using theromodynamic integration</article-title>. <source>Syst. Biol</source>., <volume>55</volume>, <fpage>195</fpage>–<lpage>207</lpage>.<pub-id pub-id-type="pmid">16522570</pub-id></mixed-citation>
    </ref>
    <ref id="btac849-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lele</surname><given-names>S.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2007</year>) <article-title>Data cloning: easy maximum likelihood estimation for complex ecological models using Bayesian Markov chain Monte Carlo methods</article-title>. <source>Ecol. Lett</source>., <volume>10</volume>, <fpage>551</fpage>–<lpage>563</lpage>.<pub-id pub-id-type="pmid">17542934</pub-id></mixed-citation>
    </ref>
    <ref id="btac849-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lemey</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Bayesian phylogeography finds its roots</article-title>. <source>PLoS Comput. Biol</source>., <volume>5</volume>, <fpage>e1000520</fpage>.<pub-id pub-id-type="pmid">19779555</pub-id></mixed-citation>
    </ref>
    <ref id="btac849-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Magee</surname><given-names>A.F.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>The dawn of open access to phylogenetic data</article-title>. <source>PLoS One</source>, <volume>9</volume>, <fpage>e110268</fpage>.<pub-id pub-id-type="pmid">25343725</pub-id></mixed-citation>
    </ref>
    <ref id="btac849-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ponciano</surname><given-names>J.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Hierarchical models in ecology: confidence intervals, hypothesis testing, and model selection using data cloning</article-title>. <source>Ecology</source>, <volume>90</volume>, <fpage>356</fpage>–<lpage>362</lpage>.<pub-id pub-id-type="pmid">19323219</pub-id></mixed-citation>
    </ref>
    <ref id="btac849-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ponciano</surname><given-names>J.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Assessing parameter identifiability in phylogenetic models using data cloning</article-title>. <source>Syst. Biol</source>., <volume>61</volume>, <fpage>955</fpage>–<lpage>972</lpage>.<pub-id pub-id-type="pmid">22649181</pub-id></mixed-citation>
    </ref>
    <ref id="btac849-B17">
      <mixed-citation publication-type="book"><collab>R Core Team</collab> (<year>2021</year>) <source>R: A Language and Environment for Statistical Computing</source>. <publisher-name>R Foundation for Statistical Computing</publisher-name>, <publisher-loc>Vienna, Austria</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btac849-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robert</surname><given-names>C.P.</given-names></string-name></person-group> (<year>1993</year>) <article-title>Prior feedback: a Bayesian approach to maximum likelihood estimation</article-title>. <source>Comput. Stat</source>., <volume>8</volume>, <fpage>279</fpage>–<lpage>294</lpage>.</mixed-citation>
    </ref>
    <ref id="btac849-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Suchard</surname><given-names>M.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Bayesian phylogenetic and phylodynamic data integration using beast 1.10</article-title>. <source>Virus Evol</source>., <volume>4</volume>, <fpage>vey016</fpage>.<pub-id pub-id-type="pmid">29942656</pub-id></mixed-citation>
    </ref>
    <ref id="btac849-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname><given-names>W.</given-names></string-name></person-group><etal>et al</etal> (<year>2011</year>) <article-title>Improving marginal likelihood estimation for Bayesian phylogenetic model selection</article-title>. <source>Syst. Biol</source>., <volume>60</volume>, <fpage>150</fpage>–<lpage>160</lpage>.<pub-id pub-id-type="pmid">21187451</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
