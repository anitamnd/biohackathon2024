<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6335810</article-id>
    <article-id pub-id-type="publisher-id">2588</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-018-2588-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MITK-ModelFit: A generic open-source framework for model fits and their exploration in medical imaging – design, implementation and application on the example of DCE-MRI</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7156-2022</contrib-id>
        <name>
          <surname>Debus</surname>
          <given-names>Charlotte</given-names>
        </name>
        <address>
          <phone>+49 6221 6538281</phone>
          <email>c.debus@dkfz-heidelberg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Floca</surname>
          <given-names>Ralf</given-names>
        </name>
        <address>
          <phone>+ 49 6221 42 2560</phone>
          <email>r.floca@dkfz-heidelberg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ingrisch</surname>
          <given-names>Michael</given-names>
        </name>
        <address>
          <email>michael.ingrisch@med.uni-muenchen.de</email>
        </address>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kompan</surname>
          <given-names>Ina</given-names>
        </name>
        <address>
          <email>i.kompan@dkfz-heidelberg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maier-Hein</surname>
          <given-names>Klaus</given-names>
        </name>
        <address>
          <email>k.maier-hein@dkfz-heidelberg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Abdollahi</surname>
          <given-names>Amir</given-names>
        </name>
        <address>
          <email>a.amir@dkfz-heidelberg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nolden</surname>
          <given-names>Marco</given-names>
        </name>
        <address>
          <email>m.nolden@dkfz-heidelberg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0492 0584</institution-id><institution-id institution-id-type="GRID">grid.7497.d</institution-id><institution>German Cancer Consortium (DKTK), </institution></institution-wrap>Heidelberg, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0492 0584</institution-id><institution-id institution-id-type="GRID">grid.7497.d</institution-id><institution>Department of Translational Radiation Oncology, German Cancer Research Center (DKFZ), </institution></institution-wrap>Heidelberg, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0328 4908</institution-id><institution-id institution-id-type="GRID">grid.5253.1</institution-id><institution>Department of Radiation Oncology, Heidelberg Ion-Beam Therapy Center (HIT), </institution><institution>Heidelberg University Hospital, </institution></institution-wrap>Heidelberg, Germany </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0328 4908</institution-id><institution-id institution-id-type="GRID">grid.5253.1</institution-id><institution>National Center for Tumor Diseases (NCT), </institution></institution-wrap>Heidelberg, Germany </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.488831.e</institution-id><institution>Heidelberg Institute of Radiation Oncology (HIRO), </institution></institution-wrap>Heidelberg, Germany </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0492 0584</institution-id><institution-id institution-id-type="GRID">grid.7497.d</institution-id><institution>Division of Medical Image Computing, </institution><institution>German Cancer Research Center DKFZ, </institution></institution-wrap>Heidelberg, Germany </aff>
      <aff id="Aff7"><label>7</label>Department of Radiology, University Hospital Munich, Ludwig-Maximilians-University Munich, Munich, Germany </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0328 4908</institution-id><institution-id institution-id-type="GRID">grid.5253.1</institution-id><institution>Section Pattern Recognition, Department of Radiation Oncology, </institution><institution>Heidelberg University Hospital, </institution></institution-wrap>Heidelberg, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>1</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>1</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>31</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>8</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>12</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Many medical imaging techniques utilize fitting approaches for quantitative parameter estimation and analysis. Common examples are pharmacokinetic modeling in dynamic contrast-enhanced (DCE) magnetic resonance imaging (MRI)/computed tomography (CT), apparent diffusion coefficient calculations and intravoxel incoherent motion modeling in diffusion-weighted MRI and Z-spectra analysis in chemical exchange saturation transfer MRI. Most available software tools are limited to a special purpose and do not allow for own developments and extensions. Furthermore, they are mostly designed as stand-alone solutions using external frameworks and thus cannot be easily incorporated natively in the analysis workflow.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present a framework for medical image fitting tasks that is included in the Medical Imaging Interaction Toolkit MITK, following a rigorous open-source, well-integrated and operating system independent policy. Software engineering-wise, the local models, the fitting infrastructure and the results representation are abstracted and thus can be easily adapted to any model fitting task on image data, independent of image modality or model. Several ready-to-use libraries for model fitting and use-cases, including fit evaluation and visualization, were implemented. Their embedding into MITK allows for easy data loading, pre- and post-processing and thus a natural inclusion of model fitting into an overarching workflow. As an example, we present a comprehensive set of plug-ins for the analysis of DCE MRI data, which we validated on existing and novel digital phantoms, yielding competitive deviations between fit and ground truth.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Providing a very flexible environment, our software mainly addresses developers of medical imaging software that includes model fitting algorithms and tools. Additionally, the framework is of high interest to users in the domain of perfusion MRI, as it offers feature-rich, freely available, validated tools to perform pharmacokinetic analysis on DCE MRI data, with both interactive and automatized batch processing workflows.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Pharmacokinetic modeling</kwd>
      <kwd>Tracer-kinetics</kwd>
      <kwd>Dynamic PET</kwd>
      <kwd>Multi-purpose</kwd>
      <kwd>Software development</kwd>
      <kwd>Model fitting</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Center for Tumor diseases</institution>
        </funding-source>
        <award-id>NCT 3.0-2015.22</award-id>
        <principal-award-recipient>
          <name>
            <surname>Abdollahi</surname>
            <given-names>Amir</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>KFO-214</award-id>
        <principal-award-recipient>
          <name>
            <surname>Abdollahi</surname>
            <given-names>Amir</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002347</institution-id>
            <institution>Bundesministerium für Bildung und Forschung</institution>
          </institution-wrap>
        </funding-source>
        <award-id>01IB13001B</award-id>
        <principal-award-recipient>
          <name>
            <surname>Floca</surname>
            <given-names>Ralf</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100005972</institution-id>
            <institution>Deutsche Krebshilfe</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Max-Eder 108876</award-id>
        <principal-award-recipient>
          <name>
            <surname>Abdollahi</surname>
            <given-names>Amir</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Deutsche Forschungsgemeinschaft</institution>
        </funding-source>
        <award-id>SFB/TRR 125</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nolden</surname>
            <given-names>Marco</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par25">Model fitting plays a vital role for many analysis approaches in medical imaging. In order to determine spatially resolved T<sub>1</sub> relaxation times in magnetic resonance imaging (MRI), multiple images with different T<sub>1</sub> weightings are acquired and the signal intensities are fitted with the relaxation equation [<xref ref-type="bibr" rid="CR1">1</xref>]. Quantifying T<sub>1</sub> relaxation times can add additional morphological information for a variety of pathological conditions. In diffusion-weighted MRI (DWI), the apparent diffusion coefficient (ADC) is derived by acquiring images at increasing diffusion gradients (b-values) and fitting the signal loss with an exponential [<xref ref-type="bibr" rid="CR2">2</xref>]. In more advanced signal theory, effects such as intravoxel incoherent motion (IVIM) are included, which also rely on signal fitting with a theoretical model. For chemical exchange saturation transfer (CEST) imaging, Z-spectra, acquired through sweeping radiofrequency saturation around the bulk water resonance, are analyzed using multi-pool Lorentzian fitting [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par26">A paradigm for fitting of medical images is pharmacokinetic modeling, as applied in dynamic contrast-enhanced (DCE) MRI and computed tomography (CT), or in dynamic positron emission tomography (PET). In PET, pharmacokinetic analysis can be used to measure transport rates of certain pharmaceuticals or metabolic substances [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. Dynamic scans are acquired over the injection of a radioactive tracer, which accumulates in tissue according to the metabolic properties of its pharmacologic compound. Tissue-specific kinetic parameters are then extracted by fitting the measured time-activity curves with compartment models that describe tracer transport. The most commonly used models are the one tissue compartment model (1TCM) and two tissue compartment model (2TCM) [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p id="Par27">In DCE MRI the aim is to derive parameters on tissue perfusion and capillary permeability from analysis of the time course of contrast agent (CA) concentration in tissue by acquisition of a time series of T<sub>1</sub> weighted MR images over CA administration [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. Tissue concentration-time curves are then analysed through fitting with a pharmacokinetic (compartment) model [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. The most commonly used compartment models for gadolinium-based, extracellular contrast agents are the classical Tofts model, the extended Tofts model and the two compartment exchange model (2CXM) [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par28">DCE MRI has become a popular method to assess tissue physiology in various diseases, including cancer, multiple sclerosis [<xref ref-type="bibr" rid="CR10">10</xref>], rheumatic arthritis [<xref ref-type="bibr" rid="CR11">11</xref>] and stroke [<xref ref-type="bibr" rid="CR12">12</xref>]. For research purposes, authors usually write their own analysis code in general purpose frameworks like MATLAB [<xref ref-type="bibr" rid="CR13">13</xref>], Python, R [<xref ref-type="bibr" rid="CR14">14</xref>] or MPFit [<xref ref-type="bibr" rid="CR15">15</xref>]. However, this approach comes with a number of disadvantages: in-house developed analysis software tools often lack standardization and broad validation, which can result in errors on the estimated parameter and make comparison of results from different centers rather difficult [<xref ref-type="bibr" rid="CR16">16</xref>]. Also, code is often written without software design concepts and reusability in mind. Thus, novel applications or variations in the analysis workflow often have to be implemented from scratch. Furthermore, in-house developed tools usually lack the integration into medical image processing ecosystems, leading to excessive data conversion and transfer. This limits their application in clinical routine, as the fitting analysis cannot be performed directly together with other necessary data evaluation steps like segmentation and registration. Many times these in-house solutions are not graphical user interface (GUI)-based, and therefore require a basic knowledge of the respective programming language.</p>
    <p id="Par29">Due to these drawbacks, and especially with respect to standardization, clinically oriented studies tend to be carried out using standard scanner software tools included by the vendors (e.g [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]) or stand-alone tools [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. Apart from their commercial nature, these tools constitute black-box systems that do not offer any flexibility in extension and configuration, which makes them less suitable for research purposes. Many of these tools offer only basic analysis steps and are installed on special workstations of scanner related computers. Hence data evaluation cannot be performed offline by any researcher. On top of this, studies have shown that results from different vendor’s software yield differences in parameter estimates [<xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR23">23</xref>]. These aspects have given rise to the need of standardized, open access solutions.</p>
    <sec id="Sec2">
      <title>Challenges</title>
      <p id="Par30">Ideally, such software tools would be included into larger medical image analysis platforms, enabling fitting analysis to be carried out side by side with other image processing steps without data conversion or import to other frameworks. In addition to that, linkage to a picture archiving and communication system (PACS) and support of DICOM data facilitates application of data evaluation in clinical settings. For research purposes, software should enable easy development and implementation of extensions to the tools in terms of models, fitting algorithms, etc. In order to be usable for both research and clinical evaluation purposes, the software needs to provide a user-friendly interface for analysis to be carried out, but yet allow for algorithm automatization in order to perform large scale data evaluations. Furthermore, direct means of fit visualization and exploration can improve quality of data evaluation and give room to model validation.</p>
    </sec>
    <sec id="Sec3">
      <title>State of the art – software</title>
      <p id="Par31">Several open-source packages for analysis of DCE MRI data have been presented in the last years [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR31">31</xref>]. They can be divided into two categories: stand-alone tools, designed explicitly and only for DCE MRI analysis, and plug-ins or packages, that provide the analysis functionality within a larger analysis framework. Stand-alone tools are designed to be ready-to-use applications, with ports for data transfer (data input and results export) and can be modified and extended on basis of the source code by the user. Well-known examples of stand-alone tools are ROCKETSHIP [<xref ref-type="bibr" rid="CR24">24</xref>], DCE@urLAB [<xref ref-type="bibr" rid="CR26">26</xref>] or DCEMRI.jl [<xref ref-type="bibr" rid="CR27">27</xref>]. However, these tools are not linked to a common image processing platform, and thus require conversion and transfer of data. Hence, substantial effort is required to perform data analysis with these tools, making them feasible only for research purposes. Additionally, even though these tools are made publicly available as open-source code, many of them depend on some underlying closed source dependency, e.g. MATLAB including its toolboxes. Contrary to that, plug-ins or packages can be used within larger analysis frameworks. More general examples include published packages for R or Python, like DATforDCEMRI [<xref ref-type="bibr" rid="CR25">25</xref>], dcemriS4 [<xref ref-type="bibr" rid="CR32">32</xref>] or pydcemri [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
      <p id="Par32">More dedicated solutions were introduced to be used complementary to standard image processing software, like OsiriX [<xref ref-type="bibr" rid="CR33">33</xref>], PMI [<xref ref-type="bibr" rid="CR28">28</xref>] or 3DSlicer [<xref ref-type="bibr" rid="CR34">34</xref>]. With regards to the aspect of clinical oriented analysis workflows, these plug-in solutions provide the advantage of incorporation of the DCE MRI analysis into general image pre- and post-processing. Thus, OsiriX plug-ins for DCE MRI analysis, e.g. UMMPerfusion [<xref ref-type="bibr" rid="CR31">31</xref>] and the DCETool [<xref ref-type="bibr" rid="CR29">29</xref>], are popular tools that can be used for an entire radiological workflow. However, OsiriX is only available on Mac OS, which presents another drawback. The 3DSlicer-based option “PKModeling” [<xref ref-type="bibr" rid="CR35">35</xref>] on the other hand provides only basic features of pharmacokinetic analysis for DCE MRI data. Additionally, many of these plug-in solutions are designed for application with direct user interaction, thus not allowing for automated batch-processing analysis pipelines. Another aspect is that all the above named solutions are designed for a single application purpose, i.e. DCE MRI. In order to include other image processing tasks based on image fitting (especially on other fitting domains e.g frequency), would require entirely new implementations from scratch. However, general concepts of the underlying algorithm are not limited to DCE MRI. An ideal tool would offer means for fitting of medical image data with any model and on any domain (time, frequency, etc.)</p>
      <p id="Par33">To the best of our knowledge, there exists no solution, that can be considered truly free in terms of an open-source, operating system (OS)-independent software tool for fitting tasks on medical images, regardless of image modality, dimensionality and domain that does not depend in any way on external, commercial software frameworks. In this work, we present the framework ModelFit for the Medical Imaging Interaction Toolkit (MITK) [<xref ref-type="bibr" rid="CR36">36</xref>], which is designed to perform any fitting task with a given model on multi-dimensional image data in such a free way. Several dedicated use-cases in form of MITK workbench applications were derived from this tool. Special attention was given to pharmacokinetic analysis in DCE MRI, for which several applications were implemented and validated.</p>
    </sec>
  </sec>
  <sec id="Sec4">
    <title>Implementation</title>
    <p id="Par34">We designed and implemented a framework within the Medical Imaging Interaction Toolkit (MITK) that enables fitting of medical imaging data with any given model. This framework was implemented with regards to both end-user applications as well as developer features. The following sub-sections present the design of the framework, explain how decoupling was achieved and which extension points are offered by the framework to tailor own setups and workflows.</p>
    <sec id="Sec5">
      <title>Definition of general terms and concepts:</title>
      <p id="Par35">Before we introduce the structure of the here presented framework, let us briefly review the conceptional workflow of data fitting. Data fitting is an optimization problem with the aim of approximating the measured data points by a theoretical mathematical model of the underlying (physical) processes.</p>
      <p id="Par36">The theoretical representation of the data is referred to as the model function <italic>f</italic><sub><italic>ϕ</italic>, <italic>θ</italic></sub>(<italic>x</italic>) and maps from the signal grid domain <italic>X</italic> to the signal codomain <italic>Y</italic>. <italic>X</italic> and <italic>Y</italic> are problem dependent. <italic>X</italic> is e.g. often the time domain or frequency domain. <italic>Y</italic> represents the intensities of the images (e.g. concentration of the CA). <italic>X</italic> and <italic>Y</italic> are subsets of <italic>ℝ</italic>.</p>
      <p id="Par37">The model function is parameterized by the parameter vectors <bold><italic>ϕ</italic></bold> and <bold><italic>θ</italic></bold>. The parameter vector <bold><italic>ϕ</italic></bold> is the variable of the model fitting process and is named model parameter (MP) in the following. Parameter vector <bold><italic>θ</italic></bold> is not in the scope of the optimization and called static model parameter (SMP).</p>
      <p id="Par38">For the optimization the model <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{S}}_{\overrightarrow{\boldsymbol{x}},\boldsymbol{\theta}}^{\prime}\left(\boldsymbol{\phi} \right) $$\end{document}</tex-math><mml:math id="M2"><mml:msubsup><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2018_2588_Article_IEq1.gif"/></alternatives></inline-formula> in dependency of the signal grid <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overrightarrow{\boldsymbol{x}} $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2018_2588_Article_IEq2.gif"/></alternatives></inline-formula> and the SMP <bold><italic>θ</italic></bold> is used. The values <bold><italic>S</italic></bold><sup>′</sup> are named signal (in analogy to the measured sample <bold><italic>S</italic></bold>). The input sample <bold><italic>S</italic></bold> is the vector of measured data points on <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overrightarrow{\boldsymbol{x}} $$\end{document}</tex-math><mml:math id="M6" display="inline"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2018_2588_Article_IEq3.gif"/></alternatives></inline-formula>. The optimization is performed by iteratively adjusting the set of MP in order to minimize a similarity measure between data and model, i.e. the deviation between sample and signal. This similarity measure is referred to as cost function <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \boldsymbol{C}\left(\boldsymbol{S},{\boldsymbol{S}}_{\overrightarrow{\boldsymbol{x}},\boldsymbol{\theta}}^{\prime },\boldsymbol{\phi} \right) $$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2018_2588_Article_IEq4.gif"/></alternatives></inline-formula>. <bold><italic>C</italic></bold> may be a single scalar or vectorial. In many applications the sum of quadratic difference between the sample and theoretical signal, referred to as sum of squared residuals, is used as similarity measure.</p>
    </sec>
    <sec id="Sec6">
      <title>Decoupling strategies</title>
      <p id="Par39">An important design aspect for developers is the possibility to extend the framework in multiple ways and to reuse it for different fitting workflows and domains. Such a flexibility and reusability is achieved through the separation of concerns and decoupling (e.g. via abstraction). We regard these abstractions as equally important for a versatile fitting framework, though they are not sufficiently exploited in other publications (except for the model-view-controller pattern; see below).</p>
      <sec id="Sec7">
        <title>Abstraction of the model function</title>
        <p id="Par40">Proper abstraction of the model function <italic>f</italic><sub><italic>ϕ</italic>, <italic>θ</italic></sub>(<italic>x</italic>) seems trivial, but is nevertheless important for the versatility of the whole concept. The abstraction is done object-oriented via model classes that represent <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{S}}_{\overrightarrow{\boldsymbol{x}},\boldsymbol{\theta}}^{\prime}\left(\boldsymbol{\phi} \right) $$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">→</mml:mo></mml:mover><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi class="MJX-variant" mathvariant="bold">′</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2018_2588_Article_IEq5.gif"/></alternatives></inline-formula>, encapsulate the model function itself and generate signals for a defined signal grid upon request. Furthermore, a model class provides an abstract interface to interact with the encapsulated model function and to query its properties. The following properties are considered the most important regarding the fitting framework (e.g. for proper result serialization into DICOM and provenance tracking):<list list-type="bullet"><list-item><p id="Par41">Name/ID of the model</p></list-item><list-item><p id="Par42">Name and unit of the signal values</p></list-item><list-item><p id="Par43">Name and unit of the model parameters <bold><italic>ϕ</italic></bold> (MP) (i.e. parameters in the model function that are iteratively adjusted during fitting).</p></list-item><list-item><p id="Par44">Name and unit of the static model parameters <bold><italic>θ</italic></bold> (SMP) (i.e. parameters in the model function that are not affected by the fitting process)</p></list-item></list></p>
      </sec>
      <sec id="Sec8">
        <title>Abstraction of the fitting process</title>
        <p id="Par45">The fitting process is abstracted into three components (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>): model class (see above), cost function (e.g. sum of squared residuals; including the possibilities to define implicit regularization by boundary functions) and optimizer (e.g. LevenbergMarquart [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>] or LFGS-B [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR41">41</xref>]).<fig id="Fig1"><label>Fig. 1</label><caption><p>Abstraction of the fitting process. A ModelFitFunctor composes an optimizer and a suitable cost function. A ModelFitFunctor also depends on the input sample, initial MP values and a parameterized model instance. These are provided when calling the functor. Optionally a ModelFitFunctor class may specify additional settings (e.g. stopping criteria). Constraints may serve for explicit regularization (e.g. when using L-BFGS as optimizer) or for implicit regularization by boundary conditions that penalize the cost function. The control flow (red, double stroked arrows) of the optimization process loops through the steps 1 to 4 until a stopping criteria is met. Value class instances (green boxes) refer to input that is considered simple data. Base class instances (blue box) represent any derived class and are part of the abstraction</p></caption><graphic xlink:href="12859_2018_2588_Fig1_HTML" id="MO1"/></fig></p>
        <p id="Par46">The optimizer drives and terminates the iterative fitting process based on the cost function and the optimizer’s stopping criteria. The combination of optimizer, cost function and model can be arbitrary chosen by the developer for the desired fitting workflow. Amongst others aspects, this allows for experimental settings e.g. benchmarking the performance of different model implementations using the same optimizer and cost function [<xref ref-type="bibr" rid="CR42">42</xref>]. To facilitate reuse, meaningful combinations of optimizers and cost functions are composed as ModelFitFunctor classes. ModelFitFunctors depend only on MPs, the parameterized model itself and the sample. This design allows a great versatility and reusability in different workflows; e.g. the ModelFitFunctor itself does not change, if either a region of interest (ROI)-based (averaged curve over all voxels in a region of interest) or voxel-based fit (each voxel individually) is performed. To achieve this versatility, the fitting process (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) is completely abstracted from type or purpose of input and output data. The concrete realization and further benefits are explained in more details in the next section.</p>
      </sec>
      <sec id="Sec9">
        <title>Abstraction of data</title>
        <p id="Par47">To conduct fitting, several types of information are needed:<list list-type="bullet"><list-item><p id="Par48">Sample signal</p></list-item><list-item><p id="Par49">SMPs</p></list-item><list-item><p id="Par50">Initial MP values</p></list-item><list-item><p id="Par51">Constraints for the fitting</p></list-item></list></p>
        <p id="Par52">With regard towards fitting workflows and the above mentioned information types the following design consideration was made: Fitting is always done for an indexed discrete element (e.g. an image voxel). Therefore any data can be defined on a global scope (e.g. the sample signal in a ROI-based fitting) or a local scope (e.g. the sample signal in a voxel-based fitting; initial MP values of a model). The type of scope is not fixed. It might change depending on the chosen model, the workflow and the experimental setting. Furthermore the source of data and its representation (values stored in an image object, a value vector, etc.) might differ, depending on the workflow and state of the application.</p>
        <p id="Par53">In the here presented framework, this consideration is dealt with by introducing two groups of classes: ModelParameterizer classes and ModelFactory classes. The interplay of these classes with the fitting process is depicted in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The ModelParameterizer abstracts the way how default constraints, initial MP values and SMPs are accessed and therefore, the handling of different data representations and scopes. The ModelFitFunctor uses the ModelParameterizer for any index to request a parameterized and ready-to-use model instance with initial MP values for fitting.<fig id="Fig2"><label>Fig. 2</label><caption><p>Illustration of the fitting process using the example of voxel-wise fitting. The PixelBasedParameterFitGenerator computes the fits concurrently for all relevant voxels (identified by the optional mask). The generator interacts with a ModelParameterizer and a ModelFitFunctor instance that should be used for the generation. The control flow (red, double stroked arrows) of the generation process loops through the step 1 to 5 for each voxel index. Output is, besides the parameter images, a criterion image (representing the final cost function value of the fit), evaluation maps (representing additional user defined measures for fit quality) and optional debug images (containing ModelFitFuctor specific information like number of iteration or met stop criterion of a fit). Value class instances (green boxes) refer to input/output that is considered simple data. Base class instances (blue box) represent any derived class and are part of the abstraction</p></caption><graphic xlink:href="12859_2018_2588_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par54">ModelFactory classes are used by the application to get a valid ModelParameterizer based on the application state and available data types. Hence a ModelFactory encapsulates the decision, which ModelParameterizer should be used and how it should be initialized. A ModelFactory always represent a model class in the context of a certain problem statement. Thus, one model class might be managed by several ModelFactories, but with different ModelParameterizers and constraints regarding the specific problem statement, for which the factory was implemented.</p>
      </sec>
      <sec id="Sec10">
        <title>Model-View-Controller pattern</title>
        <p id="Par55">The model-view-controller (MVC) pattern [<xref ref-type="bibr" rid="CR43">43</xref>] and its variations are well-known strategies to decouple parts of an application and to allow thorough separation of concerns. It has been applied in other solutions [<xref ref-type="bibr" rid="CR44">44</xref>]. In our implementations based on MITK, a MVC pattern with multiple views and controllers was applied. To avoid the ambiguity of the term “model” in the context of this paper, the term “application model” will be used for the model of the MVC pattern. In all other cases “model” refers to model classes that represent <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{S}}_{\overrightarrow{\boldsymbol{x}},\boldsymbol{\theta}}^{\prime}\left(\boldsymbol{\phi} \right) $$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">→</mml:mo></mml:mover><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi class="MJX-variant" mathvariant="bold">′</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2018_2588_Article_IEq6.gif"/></alternatives></inline-formula> (see above).</p>
        <p id="Par56">In the herein presented framework, the application model not only consists of the data (e.g. input images, ROIs, resulting parameter images) but also of the fitting business logic. The fitting business logic encompasses all classes and structures introduced in the above abstraction levels (e.g. model class, ModelFitFunctor classes, etc.). The decision to make the fitting business logic part of the application model instead of the controller allows its decoupling from controllers. This decoupling enables the reuse of fitting business logic components in multiple controllers and facilitates the necessary unit testing. Within the MITK workbench implementation, a view consists of multiple graphical user elements (widgets) that display the images, model functions, model constraints etc. The controllers are provided by MITK workbench plug-ins (MFI, generator plug-ins for DCE MRI, etc.).</p>
        <p id="Par57">The application model is decoupled from the views and the controllers in two ways: data is decoupled via the MITK data storage and the MITK data / properties classes, which grant access to data and its meta data. Hence controllers and views do not interact directly, but via the information in the MITK data storage and application events. To decouple the model business logic from the controllers micro services are used to inject ModelFactory classes into the application and allow arbitrary controllers to access them. The MVC pattern of our application and its interplay is depicted in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Simplified illustration of the interplay between components for model fitting. The plug-ins (yellow boxes) represent the MVC controllers. Data (green boxes) are part of the MVC application model together with the modeling relevant classes (blue boxes; bottom part). The Model Fit Inspector visualizes raw 3D+t input data (<bold>a</bold>) and, if present in the data storage, uses the result of fits (<bold>d</bold>) to visualize the fits. Fits are generated by domain specific generator plug-ins that use the inputs (<bold>b</bold>) and store the results (<bold>c</bold>) in the data storage. The whole fit information is encoded in the result images and their meta information. All fitting plug-ins and domain specific modules (e.g. pharmacokinetics) depend on parts of the ModelFit module (<bold>e</bold>). In addition, domain-specific plug-ins also depend on specific modules (<bold>f</bold>) that provide the model, cost function or ModelFitFunctor classes of the domain. To allow every part of the application to use a specific model class, they are registered (<bold>g</bold>) by their modules via micro services (model provider). The model providers are e.g. used (<bold>h</bold>) by the Model Fit Inspector to plot the respective model signals without establishing code dependence on any generator plug-in or domain module</p></caption><graphic xlink:href="12859_2018_2588_Fig3_HTML" id="MO3"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Extension points of the framework</title>
      <p id="Par58">As an open-source project there is a vast variety of options to extend and customize the described framework. Five extension points are regarded as most important and will therefore be explained briefly.<list list-type="bullet"><list-item><p id="Par59"><bold>New models:</bold> The introduction of new models is the most obvious one. A completely new model function requires also the implementation of a respective ModelParameterizer and ModelFactory class. For both types, template base classes are provided to facilitate implementation. If a developer wants to add support of different data representations for an existing model class, only a suitable ModelParameterizer and ModelFactory must be implemented. For the registration of a factory as a micro service in order to make it available in the application, a helper class is provided.</p></list-item><list-item><p id="Par60"><bold>New cost functions and fitting strategies:</bold> Custom cost functions can be integrated based on two base classes: SVModelFitCostFunction is used for single-value cost functions (e.g. sum of squared residuals) and MVModelfitCostFunction for multi-value cost functions (e.g. array of squared residuals). Both classes are based on cost function classes of the Insight Toolkit (ITK)[<xref ref-type="bibr" rid="CR45">45</xref>], itk::SingleValuedCostFunction and itk::MultipleValuedCostFunction respectively. Therefore, every thread-safe optimizer offered by ITK can be used to drive the fitting process. In addition, own implementations or wrapping of existent optimizer implementations are possible. In order to regard different types of fitting constraints and boundary conditions, an abstract interface is provided along with a ready-to-use implementation of simple boundary conditions. The interface can either be used to inject constraints implicitly or explicitly into the fitting process. The latter option must be supported by the optimizer itself (e.g. LBFGS-B). The implicit injection is realized by a penalty term added to the cost function. This is easily done by using SVConstrainedCostFunctionDecorator or MVConstrainedCostFunctionDecorator. Both take the constraints and the original cost function and can then be used as cost functions with penalty term.</p></list-item><list-item><p id="Par61"><bold>New domains:</bold> The main area of usage is currently time-resolved data, e.g. in pharmacokinetic analysis or for simple trend fitting (e.g. linear or exponential fits). Nevertheless, the framework itself is not limited to a special domain, neither data specific (e.g. time domain or frequency domain) nor regarding the use-case (e.g. image modalities, types of models). This covers e.g. the fitting of diffusion data over different b-values for ADC extraction, the determination of T<sub>1</sub> over different inversion times and flip angles or T<sub>2</sub>* fitting for variant echo times. Due to the above introduced abstraction levels the only restriction imposed by the framework is the possibility to implement the model function. Everything else is covered by ready-to-use classes or can be extended.</p></list-item><list-item><p id="Par62"><bold>New controller/generation plug-ins:</bold> At the latest when adding a new domain to MITK GUI applications, one has to add a new generation plug-in to serve as a controller. To ease the implementation of custom generation plug-ins, many typical generation aspects are encapsulated into ready-to-use widgets (e.g. definition of initial values or definition of constraints). Due to the above introduced abstractions those widgets can work with any model. Therefore developers can concentrate on implementing the logic that initializes the needed ModelFitFunctor.</p></list-item></list></p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Results</title>
    <p id="Par63">Due to the presented used decoupling strategies, the fitting framework is very flexible in terms of which use-case can be addressed and how the use-case is implemented. The first aspect (what/which) is possible due to abstraction between model, data and fit representation (see abstraction strategy 1 and 3). Thus, the framework can be applied to any kind of fitting task regardless of the image modality (CT, MRI, PET, etc.), fitting dimension (time, frequency, etc.) and applied model (linear, pharmacokinetic, etc.).</p>
    <p id="Par64">The second aspect (how) is achieved by separation and standardization of the fitting routine components in terms of model, cost function (respective fitting criteria) and fitting engine (optimizer) as well as by the used MVC pattern (see abstraction strategy 1, 2 and 4). This leads to modularity and high flexibility for implementations of concrete fitting workflows and applications. The versatility is demonstrated by the implementation of several ready-to-use tools, which will be shortly presented in the following</p>
    <p id="Par65">There are several different solutions, including our own work, available for the fitting of medical data (especially for DCE MRI). To ease the comparison and assessment for developers and users, Table <xref rid="Tab1" ref-type="table">1</xref> compiles software characteristics for a selection of solutions. The selection of solutions represents well-known or relatively similar solutions compared to our work, in order to show differences between potential alternatives. The selection is not exhaustive.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Software characteristics</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>MITK- ModelFit</th><th>UMM Perfusion</th><th>Rocketship</th><th>DCEMRI.jl</th><th>PMI</th><th>DATforDCEMRI</th><th>3DSlicer PkModeling</th></tr></thead><tbody><tr><td>Operating system</td><td>Linux, Mac OS, Windows</td><td>Mac OS</td><td>Linux, Mac OS, Windows</td><td>Linux, Mac OS, Windows</td><td>Windows</td><td>Linux, Mac OS, Windows</td><td>Linux, Mac OS, Windows</td></tr><tr><td>Language</td><td>C++</td><td>C</td><td>Matlab</td><td>Julia</td><td>IDL</td><td>R</td><td>C++</td></tr><tr><td>License</td><td>BSD</td><td>BSD</td><td>GNUGPL</td><td>MIT</td><td>GNU GPL</td><td>Creative Commons</td><td>Slicer (BSD like)</td></tr><tr><td>Advanced extensibility</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>No</td><td>No</td><td>Yes</td></tr><tr><td>Fitting domain</td><td>Time, Frequency, any<sup>a</sup></td><td>Time</td><td>Time</td><td>Time</td><td>Time</td><td>Time</td><td>Time</td></tr><tr><td>Eco-system</td><td>Yes (MITK)</td><td>Yes (OsiriX)</td><td>No</td><td>No</td><td>Yes (PMI)</td><td>No</td><td>Yes (3DSlicer)</td></tr><tr><td>Image modalities</td><td>DCE-MRI, DCE-CT, PET, dynamic MRI, dynamic CT, CESL/CEST,<sup>a</sup></td><td>DCE-MRI</td><td>DCE-MRI</td><td>DCE-MRI</td><td>DCE-MRI, DSC-MRI, DCE-CT</td><td>DCE-MRI</td><td>DCE-MRI</td></tr><tr><td>Models</td><td>Tofts, Extended Tofts, 2CXM, 1TCM, 2TCM, Brix, Three-step linear (3SL), Semi-quantitative metrics (BAT, TTP, AUC, C<sub>max</sub>, Wash-in/Wash-out Slope, final uptake, mean residence time)</td><td>Extended Tofts, 1CP, 2CXM, 2C uptake model, two compartment filtration model (2FM)</td><td>Tofts, Extended Tofts, Fast Exchange Regime, 2CXM, Tissue uptake, Nested-model selection, Patlak, Semi-quantitative metrics (AUC)</td><td>Tofts, Extended Tofts, Plasma Only</td><td>Uptake models, Steady-state, Patlak, Model-free deconvolution, Tofts, Extended Tofts, 2CXM, 2C filtration model for kidney, Dual-inlet models for Liver, Semi-quantitative metrics (Slope/Signal enhancement)</td><td>Tofts, Semi-quantitative metrics (AUC, MRT - mean residence time)</td><td>Tofts, Semi-quantitative metrics (AUC, slope)</td></tr><tr><td>Input / Output</td><td>DICOM, Analyze, NIFTI, NRRD, VTK, Raw data</td><td>DICOM</td><td>DICOM, Analyze, NIFTI, Raw data, Matlab data</td><td>Matlab data</td><td>DICOM, Raw data</td><td>R readable data formats</td><td>DICOM, Analyze, NIFTI, NRRD, VTK, Raw data</td></tr><tr><td>GUI</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>Yes</td><td>No</td><td>Yes</td></tr><tr><td>Fit exploration</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>Yes</td><td>No</td><td>Yes<sup>b</sup></td></tr><tr><td>PACS Support</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>No</td><td>No</td><td>Yes</td></tr><tr><td>Automatization</td><td>Yes</td><td>Partially<sup>c</sup></td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Source</td><td><ext-link ext-link-type="uri" xlink:href="http://mitk.org/wiki/MITK">http://mitk.org/wiki/MITK</ext-link></td><td><ext-link ext-link-type="uri" xlink:href="http://ikrsrv1.medma.uni-heidelberg.de/redmine/projects/ummperfusion">http://ikrsrv1.medma.uni-heidelberg.de/redmine/projects/ummperfusion</ext-link></td><td><ext-link ext-link-type="uri" xlink:href="https://github.com/petmri/ROCKETSHIP">https://github.com/petmri/ROCKETSHIP</ext-link></td><td><ext-link ext-link-type="uri" xlink:href="https://github.com/davidssmith/DCEMRI.jl">https://github.com/davidssmith/DCEMRI.jl</ext-link></td><td><ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/plaresmedima/">https://sites.google.com/site/plaresmedima/</ext-link></td><td><ext-link ext-link-type="uri" xlink:href="https://github.com/cran/DATforDCEMRI">https://github.com/cran/DATforDCEMRI</ext-link></td><td><ext-link ext-link-type="uri" xlink:href="https://www.slicer.org/wiki/Documentation/4.8/Modules/PkModeling">https://www.slicer.org/wiki/Documentation/4.8/Modules/PkModeling</ext-link></td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Possibility to extend framework to support other fitting domains</p><p><sup>b</sup>Possibility to generate a 3D+t image that encode the voxel-wise model signal and to explore the image with the MultiVolumeExplorer</p><p><sup>c</sup>Possibility to loop over all models and selected tissue ROIs for the loaded Data in the UMMPerfusion user interface</p><p>The selection of solutions represents well-known or relative similar solutions compared to our work in order to clarify the differences. The selection does not claim to be exhaustive. Commercial solutions are not included. Further R or Matlab are only included in context of concrete tools (DATforDCEMRI and Rocketship) and not as generic fitting environments on their own. The later would be a categorical error. R as well as Matlab can handle generic fitting problems or allow GUIs but by implementing an application from scratch and not by just using it of the shelf or extending an existing one. The following characteristics are assessed in the table: Operating system; Language (Programming language of the software); License (needed to regard if software is used/extended); Advanced extensibility (Indicates if software was designed to easily be extended with new models without the need to change the basis application or its programming logic; implies a advanced level of abstraction and decoupling); Fitting domain (Indicates which domains are supported for the fitting); Eco-system (indicates if software is embedded into image processing eco-system); Image modalities (medical image modalities that are supported be model and fitting techniques); Models (included pharmacokinetic models); Input / Output (most relevant data formats supported by the software); GUI (indicates if software offers a graphical user interface); Fit exploration (indicates if the software allows to interactively investigate the fit and signal curve per voxel/ROI); PACS Support (indicates if the software allows to use DICOM Q/R or receive data via DICOM Send); Automatization (indicates if the software can be used to automatize the analysis with no user interaction); Source (Link to the source codes or developer’s site)</p></table-wrap-foot></table-wrap></p>
    <p id="Par66">For exploration of dynamic data and respective fits, the Model Fit Inspector (MFI) allows voxel-wise display of multi-dimensional data and associated fits. If no model is fitted to the data, it displays the raw image intensity values over time in the selected voxel. The plug-in can be used to scout the data (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>), visually assessing data quality (temporal sampling, noise, etc.) and qualitatively evaluate the course of signal-time curves. After fitting, the resulting fit curve can be displayed together with the measured intensity time curve it was fitted to. Data properties like noise or different curve shapes can be assessed visually by navigating through the image. For ROI-based fits, both averaged curve and curve at the specific image position are shown. If an additional curve was defined (e.g. as input for the model, such as an arterial input function (AIF)), it is displayed as well in a different color. Display settings (axis range, curve display color) can be adjusted manually. An info box shows all resulting parameter estimates, evaluation and derived parameters for that specific fit. Data curves can be exported as [Time, Signal] arrays for external analysis.<fig id="Fig4"><label>Fig. 4</label><caption><p>Screenshot of the MITK workbench and the MFI plug-in (right), with exemplary DCE MRI data from a glioblastoma patient. In the 4-window view, the acquired 3D images can be viewed at each time point. The MFI plug-in enables display of the signal-time curves in each image voxel (crosshair). The respective signal-time curve can be exported as 2-column .csv file</p></caption><graphic xlink:href="12859_2018_2588_Fig4_HTML" id="MO4"/></fig></p>
    <p id="Par67">For fitting tasks outside of pharmacokinetic analysis we provide a simple tool. Currently this multi-purpose fitting tool offers conduction of simple fits e.g. with linear or exponential models as well as a generic model. The generic model uses a formula parser to fit any explicit analytical model formula to data. The user needs to specify the functional representation of the model and the number of model parameters that are adjusted during fitting.</p>
    <p id="Par68">When data quality is not sufficient to enable proper fitting analysis or no suitable model is known, simple, semi-quantitative parameters describing the curve shape can be calculated to evaluate the data [<xref ref-type="bibr" rid="CR46">46</xref>–<xref ref-type="bibr" rid="CR48">48</xref>].</p>
    <p id="Par69">For these cases a plug-in for non-compartmental analysis of signal-time curves using semi-quantitative parameters (depicted in Fig. <xref rid="Fig5" ref-type="fig">5</xref>) is provided. Common examples are the integral area-under-the-curve (AUC), the maximum signal intensity or time-to-peak (TTP). In pharmacokinetic theory, this approach is often referred to as non-compartmental or descriptive analysis. The set of parameters is extendable and currently includes AUC, maximum intensity, TTP, area-under-the-first-moment curve and mean residence time [<xref ref-type="bibr" rid="CR49">49</xref>]. The resulting parameter images can be further analyzed or used to identify regions of interest for detailed pharmacokinetic analysis.<fig id="Fig5"><label>Fig. 5</label><caption><p>Screenshot of the MITK workbench and the curve description parameters plug-in that enables calculation of several semi-quantitative parameters, like the area-under-the-curve (AUC), time-to-peak and maximum signal. The images show the AUC calculated from the 4D DCE MRI data of a glioblastoma patient</p></caption><graphic xlink:href="12859_2018_2588_Fig5_HTML" id="MO5"/></fig></p>
    <p id="Par70">DCE MRI data can be quantitatively analyzed with pharmacokinetic models using the DCE MRI fitting plug-in. It includes a descriptive model [<xref ref-type="bibr" rid="CR50">50</xref>], the classical Tofts model, the extended Tofts model and the two compartment exchange model (2CXM). The 2CXM is provided in both the convolution and differential equation form [<xref ref-type="bibr" rid="CR42">42</xref>]. Figure <xref rid="Fig6" ref-type="fig">6</xref> shows an example for pharmacokinetic analysis, in this case DCE MRI data from a glioblastoma patient that was analyzed using the 2CXM. Furthermore, a simple three-step linear model was implemented, that assumes linear functions for each three segments of the curve in order to derive semi-quantitative measures, like the wash-in or wash-out slope.<fig id="Fig6"><label>Fig. 6</label><caption><p>Example of pharmacokinetic fitting analysis with the presented plug-in in a glioblastoma patient using the 2CXM within the tumor ROI (red). The 4-window view shows the first time frame of the dynamic MRI series, overlaid with the parameter map of plasma flow <italic>F</italic><sub><italic>p</italic></sub>. The MFI (right) shows the measured concentration-time curve in a single voxel (red dots), together with the estimated model fit (black line) and the used AIF (green dots). The respective model parameter estimates of the fit are listed in the table below</p></caption><graphic xlink:href="12859_2018_2588_Fig6_HTML" id="MO6"/></fig></p>
    <p id="Par71">The plug-in comprises several options shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. The AIF, required as input for these models, can be defined in different ways. Image-based AIFs can be defined through segmentation of a feeding artery and are then extracted from dynamic images, equivalent to the tissue concentration-time curves. The segmentation can be defined on the same dynamic image as the tissue of interest or on any other dynamic image. This feature is especially useful in preclinical studies, where usually a slice through the heart is acquired separately and used for derivation of the CA concentration in the blood pool. Another option to provide an AIF is via an external file in .csv format, which can be used e.g. for population-derived input curves [<xref ref-type="bibr" rid="CR51">51</xref>]. Initial parameter values can be defined for each individual model parameter, either as a constant global value for all voxels or locally in form of a parameter image. Default values for the respective model are natively set. Constraints can be imposed on the model parameters, in order to exclude unrealistic values and to limit the search space. Upper and lower constraint values can be defined individually for each model parameter. Combinations, such as sums of parameters, are also possible. The tool allows limitation of the fitting region by definition of a segmentation for the region/volume of interest. Within this ROI, fitting can be performed in each individual voxel (voxel-wise) or on the averaged curve (ROI-based). Parameter estimates of the respective model, together with the used fitting criterion (e.g. the sum of squared residuals), are displayed in parameter images. Individual fit curves can be assessed using the MFI. There is also an option to extract certain debug parameters describing technical statistics of the fitting process, such as the required optimization time, the number of fit iterations, or the convergence criterion. These are useful for evaluation of fit quality beyond standard criterion parameters and visual fit assessment, especially in cases of failed or non-terminated fits.<fig id="Fig7"><label>Fig. 7</label><caption><p>The DCE MRI analysis plug-in. Several models are currently implemented: a simple three-step linear function, a descriptive model, the standard and extended Tofts model and the 2CXM. Arterial input functions can be image-based (from the same image as the analyzed ROI or a different one) and file-based (.csv format). The fit configuration allows for definition of model parameter starting values, parameter constraints and the desired conversion of signal to concentration units</p></caption><graphic xlink:href="12859_2018_2588_Fig7_HTML" id="MO7"/></fig></p>
    <p id="Par72">Before fitting can be performed, 4D DCE MRI image intensities usually need to be converted into the corresponding CA concentration. If pre-contrast T<sub>1</sub> maps are available (e.g. from multiple flip-angle measurements), analytic conversion of the signal to concentration units is provided in the DCE MRI fitting tool (as described in [<xref ref-type="bibr" rid="CR27">27</xref>]). Otherwise, conversion by means of relative and absolute signal enhancement can be performed. The conversion can be performed in a dedicated plug-in or as convenient alternative directly in the fitting plug-in.</p>
    <p id="Par73">The versatility of our framework enabled also the implementation of a tool for simulating concentration-time curves by forward calculation of the signal from parameter images in combination with an AIF. With this simulation tool, curves can be generated according to the standard Tofts Model, the extended Tofts model and the 2CXM. Noise in form of Gaussian random numbers can be added with user-defined contrast-to-noise ratios (defined as ratio between the maximum of the AIF and the standard deviation of the noise). The generation of synthetic concentration-time curves allows for validation of models and benchmarking of different configurations of fitting algorithms [<xref ref-type="bibr" rid="CR42">42</xref>].</p>
    <p id="Par74">For tracer-kinetic analysis of dynamic PET images, a dedicated tool was implemented in analogy to the DCE MRI tool. It includes the one tissue compartment model (1TCM) and the two tissue compartment model (2TCM). The first is provided in the general three-parameter form and a simplified 2 parameter version, while the latter is provided in a general form and in an adapted form for FDG PET, the most commonly used tracer [<xref ref-type="bibr" rid="CR52">52</xref>, <xref ref-type="bibr" rid="CR53">53</xref>]. The general 2TCM function is provided in both the convolution and differential equation form. The fit options (e.g. types of AIF, initial parameters, constraints) are similar to the presented options for DCE MRI fitting (see Fig. <xref rid="Fig7" ref-type="fig">7</xref>). Conversion of signal intensities from raw data time-activity curves (TAC) to standard uptake value (SUV) curves can be performed using a separate plug-in. Figure <xref rid="Fig8" ref-type="fig">8</xref> shows an example case for the <sup>18</sup>F-labeled fluoroethyl-tyrosine (FET) tracer, which is commonly used for detection and staging of brain tumors [<xref ref-type="bibr" rid="CR54">54</xref>, <xref ref-type="bibr" rid="CR55">55</xref>]. Time-activity curves were fitted with the standard 1TCM. Parameter maps of the exchange rates are shown together with fitted curves in a representative voxel.<fig id="Fig8"><label>Fig. 8</label><caption><p>Example case of application of the fitting software for tracer-kinetic analysis in dynamic PET, using the tracer kinetic one tissue compartment model. The image shows the parameter map of the exchange rate <italic>K</italic><sub>1</sub>. In the MFI, the measured time-activity curve in tissue (red) with corresponding fit (black) and the utilized arterial time-activity curve (green) are displayed</p></caption><graphic xlink:href="12859_2018_2588_Fig8_HTML" id="MO8"/></fig></p>
    <p id="Par75">A number of additional analysis tools for other workflows and fitting domains (e.g. for fitting of Z-spectra in chemical exchange saturation transfer (CEST) MRI, general T<sub>1</sub>/T<sub>2</sub> mapping) were further derived from the fitting framework.</p>
    <p id="Par76">The above presented ready-to-use analysis tools are integrated as plug-ins into the MITK workbench and can be run directly via the user interface. In addition, they can be used as command-line tools (CLI tool) for (semi-) automatic analysis, which makes efficient evaluation of large data cohorts feasible. The CLI tools are implemented using the CommonTK/Slicer execution model [<xref ref-type="bibr" rid="CR56">56</xref>] and therefore offer an easy integration path into other applications without any compile or linkage dependencies.</p>
    <p id="Par77">The integration into MITK allows establishing a complete analysis pipeline. Pre- and post-processing of raw data and resulting parameter maps can be done using all available MITK functionalities. Dynamic images can be co-registered with other, static images of higher signal-to-noise ratio (SNR) or spatial resolution, which enables more precise lesion detection and subsequent segmentation. Manual and semi-automated image segmentation techniques facilitate definition of fitting ROIs and other inputs (e.g. AIF). Segmentations can then be directly used for voxel-based as well as ROI-based fitting without further data conversion. Generated model parameter maps from fitting or non-compartmental analysis can be handled independently as MITK images, and thus analyzed. Besides visual inspection of the individual fit values and curves using the MFI plug-in, statistics and histogram evaluations can be performed. Further segmentations of sub-regions can be derived for in-depth analysis. Parameter maps can be saved in various image formats or exported to .csv files for further analysis with other programs.</p>
    <sec id="Sec13">
      <title>Validation</title>
      <p id="Par78">Validation was performed for the standard and the extended Tofts model as well as the 2CXM. The quantitative imaging biomarker alliance (QIBA) offers virtual phantom data, so-called digital reference objects (DRO), for pharmacokinetic analysis in DCE MRI. For validation of the standard 2-parameter Tofts model, the QIBA_v6_Tofts DRO was used (available from <ext-link ext-link-type="uri" xlink:href="https://sites.duke.edu/dblab/qibacontent/">https://sites.duke.edu/dblab/qibacontent/</ext-link>). It contains 30 blocks of each 10 × 10 squares of combinations of <italic>K</italic><sub><italic>trans</italic></sub> ∈ {0, 1, 2, 5, 10, 20, 35} ml/ min /100 ml and <italic>v</italic><sub><italic>e</italic></sub> ∈ {0.01, 0.05, 0.1, 0.2, 0.5}. Concentration curves are sampled at a temporal resolution of 0.5 s over a total of 1361 time points. For validation of the extended 3-parameter Tofts model, the noise free 4D DRO (<ext-link ext-link-type="uri" xlink:href="https://sites.duke.edu/dblab/dce-mri-test-images/">https://sites.duke.edu/dblab/dce-mri-test-images/</ext-link>) was chosen. It includes DICOM images of a 2D+t DCE MRI series, with each 10 x 10 voxel blocks of 108 different, spatially encoded concentration-time curves, using all combinations of <italic>K</italic><sub><italic>trans</italic></sub> ∈ {0, 1, 2, 5, 10, 20} ml/ min /100 ml , <italic>v</italic><sub><italic>p</italic></sub> ∈ {0.001, 0.005, 0.01, 0.02, 0.05, 0.1} and <italic>v</italic><sub><italic>e</italic></sub> ∈ {0.1, 0.2, 0.5}. Concentration curves are sampled at a temporal resolution of 0.5 s over a total of 661 time points. The dataset was fitted with the DCE MRI tool and resulting parameter estimates were compared to the ground truth. Unfortunately, no DRO is available for the 2CXM to our knowledge. Thus, we created a third DRO for the 2CXM, similar to those for the standard and extended Tofts model. Concentration-time curves for different combinations of <italic>F</italic><sub><italic>p</italic></sub>, <italic>PS</italic>, <italic>v</italic><sub><italic>p</italic></sub> and <italic>v</italic><sub><italic>e</italic></sub> were generated from the 2CompFlowExch model in JSim [<xref ref-type="bibr" rid="CR57">57</xref>]. Values used for generation of concentration-time curves were <italic>F</italic><sub><italic>p</italic></sub> ∈ {5, 10, 25, 40} ml/ min /100 ml, <italic>PS</italic> ∈ {0, 5, 15} ml/ min /100 ml, <italic>v</italic><sub><italic>p</italic></sub> ∈ {0.02, 0.05, 0.1, 0.2} and <italic>v</italic><sub><italic>e</italic></sub> ∈ {0.1, 0.2, 0.5}. Curves were simulated on 0.5 s temporal sampling using the arterial input curve extracted from the extended Tofts DRO data. Signal curves were arranged in a 3D+t image of spatial dimensions &lt;10 ∙ <italic>F</italic><sub><italic>p</italic></sub>, 10 ∙ <italic>v</italic><sub><italic>e</italic></sub> ∙ <italic>v</italic><sub><italic>p</italic></sub>, <italic>PS</italic> &gt;  =  &lt; 40, 120, 3&gt;, where each &lt;10 × 10 × 1&gt; voxels contained one curve type. The AIF was added as &lt;40, 20, 3&gt; block on the bottom of the image, leading to a final DCE MRI data set of dimension &lt;40, 140, 3, 661&gt;. The data is available in DICOM format under: <ext-link ext-link-type="uri" xlink:href="http://mitk.org/wiki/MITK-ModelFit">http://mitk.org/wiki/MITK-ModelFit</ext-link>.</p>
      <p id="Par79">All three DROs of synthetic DCE MRI data were fitted with our model implementation, using the AIF within the images, and resulting parameter estimates were compared to the true values. Mean relative errors on parameter estimates are listed in Table <xref rid="Tab2" ref-type="table">2</xref>. For the 2CXM, errors are subdivided into different cases of <italic>PS</italic>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Relative errors on parameter estimates from fitting the validation data sets</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th/><th/><th>Mean Error [%]</th></tr></thead><tbody><tr><td rowspan="2">Standard Tofts</td><td><italic>K</italic><sub><italic>trans</italic></sub></td><td>3.24</td><td/></tr><tr><td><italic>v</italic><sub><italic>e</italic></sub></td><td>0.38</td><td/></tr><tr><td rowspan="3">extended Tofts</td><td><italic>K</italic><sub><italic>trans</italic></sub></td><td>7.01</td><td/></tr><tr><td><italic>v</italic><sub><italic>p</italic></sub></td><td>22.06</td><td/></tr><tr><td><italic>v</italic><sub><italic>e</italic></sub></td><td>5.95</td><td/></tr><tr><td rowspan="10">2CXM</td><td rowspan="3"><italic>F</italic><sub><italic>p</italic></sub></td><td>푃푆 = 0 푚푙/푚푖푛/100 푚푙</td><td>2.54</td></tr><tr><td>푃푆 = 5 푚푙/푚푖푛/100 푚푙</td><td>1.99</td></tr><tr><td>푃푆 = 15 푚푙/푚푖푛/100 푚푙</td><td>1.86</td></tr><tr><td rowspan="3"><italic>v</italic><sub><italic>p</italic></sub></td><td>푃푆 = 0 푚푙/푚푖푛/100 푚푙</td><td>10.55</td></tr><tr><td>푃푆 = 5 푚푙/푚푖푛/100 푚푙</td><td>1.83</td></tr><tr><td>푃푆 = 15 푚푙/푚푖푛/100 푚푙</td><td>2.87</td></tr><tr><td rowspan="2"><italic>PS</italic></td><td>푃푆 = 5 푚푙/푚푖푛/100 푚푙</td><td>3.05</td></tr><tr><td>푃푆 = 15 푚푙/푚푖푛/100 푚푙</td><td>2.69</td></tr><tr><td rowspan="2"><italic>v</italic><sub><italic>e</italic></sub></td><td>푃푆 = 5 푚푙/푚푖푛/100 푚푙</td><td>3.22</td></tr><tr><td>푃푆 = 15 푚푙/푚푖푛/100 푚푙</td><td>2.48</td></tr></tbody></table></table-wrap></p>
      <p id="Par80">The standard Tofts model yielded mean errors of 3.24 %  ± 0.97% for <italic>K</italic><sub><italic>trans</italic></sub> and 0.38 %  ± 1.99% for <italic>v</italic><sub><italic>e</italic></sub>, ranging between −7.44% and +2.22% (error maps not shown). Figure <xref rid="Fig9" ref-type="fig">9</xref> shows relative errors on parameter estimates <italic>K</italic><sub><italic>trans</italic></sub>, <italic>v</italic><sub><italic>p</italic></sub> and <italic>v</italic><sub><italic>e</italic></sub> for the extended Tofts model. Largest errors on <italic>K</italic><sub><italic>trans</italic></sub> and <italic>v</italic><sub><italic>e</italic></sub> were observed for lowest <italic>K</italic><sub><italic>trans</italic></sub> values of 1 ml/ min /100 ml. <italic>v</italic><sub><italic>p</italic></sub> exhibited largest errors for <italic>v</italic><sub><italic>p</italic></sub> = 0.001. These findings are reasonable, since perfusion is difficult to measure in cases with low overall perfusion (low <italic>K</italic><sub><italic>trans</italic></sub>) and low vascularization (low <italic>v</italic><sub><italic>p</italic></sub>). Apart from these cases, errors on parameter estimates were low, between 0% and 10% in most cases.<fig id="Fig9"><label>Fig. 9</label><caption><p>Relative errors on <italic>K</italic><sub><italic>trans</italic></sub>, <italic>v</italic><sub><italic>p</italic></sub>and <italic>v</italic><sub><italic>e</italic></sub> from fits with our implementation of the extended Tofts model to the noise free 4D QIBA digital reference object. True parameter values, used to create the DRO, are indicated on the left (<italic>v</italic><sub><italic>p</italic></sub>), right (<italic>v</italic><sub><italic>e</italic></sub>) and bottom (<italic>K</italic><sub><italic>trans</italic></sub>) scale, in order to see patterns of errors for certain tissue types</p></caption><graphic xlink:href="12859_2018_2588_Fig9_HTML" id="MO9"/></fig></p>
      <p id="Par81">Figure <xref rid="Fig10" ref-type="fig">10</xref> shows relative errors on <italic>F</italic><sub><italic>p</italic></sub> and <italic>v</italic><sub><italic>p</italic></sub>, for each of the three different original values of <italic>PS</italic> = 0, 5, 15 ml/ min /100 ml. Original values of <italic>v</italic><sub><italic>p</italic></sub>, <italic>v</italic><sub><italic>e</italic></sub> and <italic>F</italic><sub><italic>p</italic></sub> are indicated on the axes. These 2D error maps were generated by averaging each 10 slices with respective <italic>PS</italic> values. Estimates on <italic>F</italic><sub><italic>p</italic></sub> presented with very low errors of approximately 2% on average. Largest errors of about 4% are found for <italic>PS</italic> = 0 ml/ min /100 ml, <italic>v</italic><sub><italic>p</italic></sub> = 0.1 and <italic>F</italic><sub><italic>p</italic></sub> = 40 ml/ min /100 ml. For estimates on <italic>v</italic><sub><italic>p</italic></sub>, largest errors were found for <italic>PS</italic> = 0 ml/ min /100 ml, at <italic>v</italic><sub><italic>p</italic></sub> = 0.1 and <italic>F</italic><sub><italic>p</italic></sub> = 25 ml/ min /100 ml. Overall errors on <italic>v</italic><sub><italic>p</italic></sub> for the other two cases of <italic>PS</italic> = 5, 15 ml/ min /100 ml were around 2 %  − 3%. For analysis of estimates on <italic>PS</italic> and <italic>v</italic><sub><italic>e</italic></sub>, cases with <italic>PS</italic> = 0 ml/ min /100 ml were excluded, as large errors are to be expected for these two parameters in cases with vanishing vascular permeability. For <italic>PS</italic> = 5 ml/ min /100 ml and <italic>PS</italic> = 15 ml/ min /100 ml, resulting errors on parameter estimates for <italic>PS</italic> and <italic>v</italic><sub><italic>e</italic></sub> are presented in Fig. <xref rid="Fig11" ref-type="fig">11</xref>. Errors on both <italic>PS</italic> and <italic>v</italic><sub><italic>e</italic></sub> were about 3% on average, except for <italic>PS</italic> = 5 ml/ min /100 ml, <italic>F</italic><sub><italic>p</italic></sub> = 5 ml/ min /100 ml with <italic>v</italic><sub><italic>p</italic></sub> = 0.2 and 0.02 and <italic>v</italic><sub><italic>e</italic></sub> = 0.1 and 0.5, respectively. All these findings are reasonable, since limit tissues (low <italic>F</italic><sub><italic>p</italic></sub>in combination with high <italic>v</italic><sub><italic>p</italic></sub>, low <italic>PS</italic> in combination with high <italic>v</italic><sub><italic>e</italic></sub>) are expected to yield larger errors, as correct determination of concentration-time curves is difficult and assumptions of the 2CXM are not entirely valid in these cases.<fig id="Fig10"><label>Fig. 10</label><caption><p>Relative errors on parameter estimates of <italic>F</italic><sub><italic>p</italic></sub> and <italic>v</italic><sub><italic>p</italic></sub> for three cases of <italic>PS</italic> = 0 <italic>ml</italic>/ <italic>min</italic> /100 <italic>ml</italic>, <italic>PS</italic> = 5 <italic>ml</italic>/ <italic>min</italic> /100 <italic>ml</italic> and <italic>PS</italic> = 15 <italic>ml</italic>/ <italic>min</italic> /100 <italic>ml</italic> from fits with our implementation of the 2CXM to the digital reference object created using JSim. True parameter values, used to create the DRO, are indicated on the left (<italic>v</italic><sub><italic>p</italic></sub>), right (<italic>v</italic><sub><italic>e</italic></sub>) and bottom (<italic>F</italic><sub><italic>p</italic></sub>) scale, in order to see patterns of errors for certain tissue types</p></caption><graphic xlink:href="12859_2018_2588_Fig10_HTML" id="MO10"/></fig><fig id="Fig11"><label>Fig. 11</label><caption><p>Relative errors on parameter estimates of <italic>PS</italic> and <italic>v</italic><sub><italic>e</italic></sub> for two cases of <italic>PS</italic> = 5 <italic>ml</italic>/ <italic>min</italic> /100 <italic>ml</italic> and <italic>PS</italic> = 15 <italic>ml</italic>/ <italic>min</italic> /100 <italic>ml</italic> from fits with our implementation of the 2CXM to the digital reference object created using JSim. True parameter values, used to create the DRO, are indicated on the left (<italic>v</italic><sub><italic>p</italic></sub>), right (<italic>v</italic><sub><italic>e</italic></sub>) and bottom (<italic>F</italic><sub><italic>p</italic></sub>) scale, in order to see patterns of errors for certain tissue types</p></caption><graphic xlink:href="12859_2018_2588_Fig11_HTML" id="MO11"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par82">We presented an open-source software framework for fitting of medical images within the Medical Imaging Interaction Toolkit MITK. Its implementation offers high flexibility and reusability, making it easily adaptable and extendable for own developments. This versatility enables development of analysis tools for various fitting tasks and image modalities, as for example fitting of Z-spectra in CEST MRI or tracer-kinetic analysis in dynamic PET using compartment models. Furthermore, means of qualitative and quantitative fit quality evaluation and result visualization are provided.</p>
    <p id="Par83">Ready-to-use applications in form of plug-ins for the MITK workbench were implemented for several dedicated use-cases, which allows for direct GUI-based analysis. An extensive toolbox for pharmacokinetic analysis of DCE MRI data was designed with several commonly used pharmacokinetic models. It offers a wide range of configuration options, such as definition of parameter starting values, constraints for model parameters and different methods to convert the acquired MR signal to contrast agent concentration. Several strategies for AIF definition are supported, in order to enable most common approaches, e.g. image-based or population-based AIFs. Fitting can be performed either on an individual voxel basis or in a ROI-based average approach. The most commonly used models “standard Tofts”, “extended Tofts” and “2CXM” were validated on digital reference data sets. Results of estimated parameters for the standard and extended Tofts model were comparable to other published data [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR27">27</xref>]. For the 2CXM we created a synthetic data set using JSim [<xref ref-type="bibr" rid="CR57">57</xref>]. In order to spread validation methods and thus standardize pharmacokinetic modeling in DCE MRI, we provide free access to our validation DRO for the 2CXM.</p>
    <p id="Par84">Many approaches in medical image analysis utilize fitting, from pre-processing over extraction of parameters as in pharmacokinetic analysis to simple modeling of time-dependent treatment effects. Commonly, image fitting is performed using in-house developed code in large data analysis platforms such as MATLAB, IDL/MPFIT or R [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]. For analysis of DCE MRI data using pharmacokinetic modeling, several groups have presented open-source software solutions. Even though these tools are made publicly available as open-source code, several (e.g. PMI based on IDL or ROCKETSHIP based on MATLAB) depend on commercial software. Smith et al. presented DCEMRI.jl [<xref ref-type="bibr" rid="CR27">27</xref>], a toolkit for NLLS fitting analysis of DCE MRI written purely in the programming language <italic>julia</italic>, hence it does not depend on any commercial licenses. It is open-source and compatible with MacOS, Linux and Windows systems. However, no graphical user interface or fit visualization is provided. Furthermore, it is not incorporated into any image processing platform, and input and output of data is possible only in MAT-v5 files. Hence a clinical oriented workflow, depending on the support of DICOM formats, is very difficult to realize. Published packages for R or Python, for example DATforDCEMRI [<xref ref-type="bibr" rid="CR25">25</xref>], depend on no commercial licenses, as these frameworks are freely available and applicable to all operating systems. However, they are not dedicated to medical image analysis, thus data import and integration into a DICOM workstation are not provided. Additionally, other image processing tasks, like segmentation or registration, have to be performed externally. The OsiriX [<xref ref-type="bibr" rid="CR33">33</xref>] open-source DICOM workstation can be used for an entire radiological workflow. Thus, OsiriX plug-ins for DCE MRI analysis, e.g. UMMPerfusion [<xref ref-type="bibr" rid="CR31">31</xref>], are popular tools in the context of clinical research. However, OsiriX is only available on Mac OS, which presents another drawback. Furthermore, these plug-ins are specifically designed and implemented for OsiriX, hence they cannot be used as stand-alone tools, or with in automated, batch-processing analysis pipelines. 3DSlicer offers a rich, open-source and OS-independent platform for medical image analysis and visualization. The PKModeling module [<xref ref-type="bibr" rid="CR35">35</xref>] can be used in automated workflows or via the 3DSlicer GUI. The major drawbacks compared to other options are the limited number of available models.</p>
    <p id="Par85">Our framework overcomes these limitations, by offering a standardized software concept for data handling, fitting algorithmic and analysis pipelines that can be applied modularly and extended easily. The level of abstraction, compared to other solutions, does not stop with the introduction of normal MVC patterns to separate GUI and algorithms. The fitting infrastructure itself is carefully abstracted and standardized. This ensures a large degree of freedom with respect to both the use-case in question (image modality, fitting domain) as well as the specific algorithm configuration in a use-case (optimizer and cost function, model). Due to the toolkit nature of MITK and the framework, the implemented tools for specific use-cases (DCE MRI, dynamic PET, general purpose fitting) can be used for automated batch processing, for integration into other applications (e.g. as CLI tool), as well as for direct user-interaction with GUI-based applications (plug-ins for the MITK workbench) for end-users without need for advanced software development. Furthermore, the embedding in MITK allows for fitting to be performed within an eco-system of medical image processing combining all other relevant processing steps and without the burden of data conversion or inter-application transfer. This embedding, together with the capability of MITK to handle all different kinds of imaging modalities, is especially useful in the light of current efforts regarding modern hybrid PET-MRI scanners or other kinds of multi-parametric imaging data. Different dynamic data types can be evaluated side-by-side in the same software framework and thus allow direct comparison of the derived multi-parametric maps. MITK also enables the analysis of longitudinal data generated by treatment response studies like in neoadjuvant chemotherapy, radiation therapy or anti-angiogenic treatment. The data analysis tools of ModelFit can be utilized to evaluate the physiologic, metabolic and vascular status of the tumor tissue and thus assess treatment efficacy, as changes in parametric maps reflect responses to therapy. Additionally, the presented software framework can be considered as truly free and open-source as it requires neither further proprietary licenses nor is it limited to specific operating systems. These features also facilitate the wide spread use of the implemented tools and thus can aid in standardization and multi-center analyses.</p>
    <p id="Par86">The quantitative imaging biomarker alliance (QIBA) [<xref ref-type="bibr" rid="CR58">58</xref>] aims to reduce variability of quantitative imaging biomarkers across devices, sites, patients and time, and thus improve their value and practicality. In recent years, substantial efforts have been made to include, amongst others, pharmacokinetic approaches in MRI and PET into the alliance through standardized validation datasets, software approaches and acquisition protocols. Within this context, our framework for fitting of medical image data could provide a huge step forward in standardizing software not only for DCE MRI, as it can provide a common basis for all application of fitting approaches, whilst being freely available, maintained and transparent (i.e. source code can be directly accessed).</p>
    <p id="Par87">To our knowledge there is no software package for DCE MRI pharmacokinetic analysis that (1) has more functionalities regarding pharmacokinetics (2) can be considered truly free as in open-source and operating system independent, (3) with both GUI and batch processing applicability, (4) integration into a global image processing platform for pre- and post-processing and (5) no dependencies on commercial software packages or licenses.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusion</title>
    <p id="Par88">In summary we have designed and implement a highly flexible and easily extendable software environment for fitting analysis in medical imaging, that allows for the analysis to be performed directly integrated into a larger image pre- and post-processing workflow. This includes, amongst others, highly automatized evaluation workflows regarding longitudinal data, where modeling of responses (e.g. follow-up under therapy) comes into play and which has become increasingly important in the era of big data. The framework can be used by developers for custom developments, but also offers ready-to-use GUI based applications for end-users. It is open-source and OS-independent, which together with its high modularity, versatility and rich feature set makes it superior to other existing solutions, especially in the context of pharmacokinetic analysis of dynamic imaging data.</p>
  </sec>
  <sec id="Sec16">
    <title>Availability and requirements</title>
    <p id="Par89"><bold>Project name:</bold> MITK ModelFit</p>
    <p id="Par90">
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="http://mitk.org/wiki/MITK-ModelFit">http://mitk.org/wiki/MITK-ModelFit</ext-link>
    </p>
    <p id="Par91"><bold>Operating system(s):</bold> Platform independent</p>
    <p id="Par92">
      <bold>Programming language: C++14</bold>
    </p>
    <p id="Par93"><bold>Other requirements:</bold> Qt 5.9 or higher, Cmake 3.10 or higher; Git from <ext-link ext-link-type="uri" xlink:href="http://git-scm.com">http://git-scm.com</ext-link></p>
    <p id="Par94"><bold>License:</bold> BSD-like</p>
    <p id="Par95"><bold>Any restrictions to use by non-academics:</bold> none</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AIF</term>
        <def>
          <p id="Par4">Arterial input function</p>
        </def>
      </def-item>
      <def-item>
        <term>AUC</term>
        <def>
          <p id="Par5">Area-under-the-curve</p>
        </def>
      </def-item>
      <def-item>
        <term>CEST</term>
        <def>
          <p id="Par6">Chemical exchange saturation transfer</p>
        </def>
      </def-item>
      <def-item>
        <term>CLI</term>
        <def>
          <p id="Par7">Command line interface</p>
        </def>
      </def-item>
      <def-item>
        <term>CNR</term>
        <def>
          <p id="Par8">Contrast-to-noise ratio</p>
        </def>
      </def-item>
      <def-item>
        <term>DRO</term>
        <def>
          <p id="Par9">Digital reference object</p>
        </def>
      </def-item>
      <def-item>
        <term>GUI</term>
        <def>
          <p id="Par10">Graphical user-interface</p>
        </def>
      </def-item>
      <def-item>
        <term>MITK</term>
        <def>
          <p id="Par11">Medical Imaging Interaction Toolkit</p>
        </def>
      </def-item>
      <def-item>
        <term>MP</term>
        <def>
          <p id="Par12">Model parameters</p>
        </def>
      </def-item>
      <def-item>
        <term>MFI</term>
        <def>
          <p id="Par13">Model-fit inspector</p>
        </def>
      </def-item>
      <def-item>
        <term>MVC</term>
        <def>
          <p id="Par14">Model-View-Controller</p>
        </def>
      </def-item>
      <def-item>
        <term>QIBA</term>
        <def>
          <p id="Par15">Quantitative imaging biomarker alliance</p>
        </def>
      </def-item>
      <def-item>
        <term>ROI</term>
        <def>
          <p id="Par16">Region of interest</p>
        </def>
      </def-item>
      <def-item>
        <term>SMP</term>
        <def>
          <p id="Par17">Static model parameters</p>
        </def>
      </def-item>
      <def-item>
        <term>SNR</term>
        <def>
          <p id="Par18">Signal-to-noise ratio</p>
        </def>
      </def-item>
      <def-item>
        <term>SUV</term>
        <def>
          <p id="Par19">Standard uptake value</p>
        </def>
      </def-item>
      <def-item>
        <term>TAC</term>
        <def>
          <p id="Par20">Time-activity curve</p>
        </def>
      </def-item>
      <def-item>
        <term>TTP</term>
        <def>
          <p id="Par21">Time-to-peak</p>
        </def>
      </def-item>
      <def-item>
        <term>1TCM</term>
        <def>
          <p id="Par22">One tissue compartment model</p>
        </def>
      </def-item>
      <def-item>
        <term>2CXM</term>
        <def>
          <p id="Par23">Two compartment exchange model</p>
        </def>
      </def-item>
      <def-item>
        <term>2TCM</term>
        <def>
          <p id="Par24">Two tissue compartment model</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>Charlotte Debus and Ralf Floca Shared first-authors</p>
    </fn>
    <fn>
      <p>Charlotte Debus and Ralf Floca contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Alina Bendinger, Christin Glowa, Maria Saager, Christian Karger, Patrick Schünke, Jennifer Mosebach, David Bonekamp, Patrick Badura and Dorde Komljenovic, for fruitful discussions on perfusion imaging and pharmacokinetic analysis, and testing of developed plug-ins. Furthermore we acknowledge Caspar Goch, Stefan Dinkelacker and the division of medical image computing for continuous software support and Ali Afshar and Uwe Haberkorn for insight knowledge on dynamic PET data evaluation.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par96">This work was supported by the National Center for Tumor diseases (NCT 3.0-2015.22 BioDose, to AA) the German Research Foundation (DFG-KFO-214, to AA; and SFB/TRR 125 “Cognition-Guided Surgery”, to KMH and MN), the Federal Ministry of Education and Research Germany (BMBF 01IB13001B, to RF) and the Deutsche Krebshilfe (Max-Eder 108876, to AA). The funders had no role in study design, data collection and analysis, decision to publish or preparation of the manuscript.</p>
    </sec>
    <sec id="FPar2" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par97">The software and the validation dataset generated during the current study are available under <ext-link ext-link-type="uri" xlink:href="http://mitk.org/wiki/MITK-ModelFit">http://mitk.org/wiki/MITK-ModelFit</ext-link></p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CD, RF, MN, KMH and AA participated in design and supervision of the project. CD and RF implemented the software. CD analyzed the data. MI and IK provided background knowledge on DCE MRI. CD and MI collected patient data. MN and KMH supplied the necessary software support for MITK. CD and RF wrote the manuscript. All authors read and approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taylor</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Salerno</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dharmakumar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jerosch-Herold</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>T1 Mapping: Basic Techniques and Clinical Applications</article-title>
        <source>JACC Cardiovasc Imaging</source>
        <year>2016</year>
        <volume>9</volume>
        <fpage>67</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jcmg.2015.11.005</pub-id>
        <pub-id pub-id-type="pmid">26762877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Le Bihan</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Looking into the functional architecture of the brain with diffusion MRI</article-title>
        <source>Nat Rev Neurosci</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>469</fpage>
        <lpage>480</lpage>
        <pub-id pub-id-type="doi">10.1038/nrn1119</pub-id>
        <pub-id pub-id-type="pmid">12778119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Pagel</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Clinical applications of chemical exchange saturation transfer (CEST) MRI</article-title>
        <source>J Magn Reson Imaging JMRI</source>
        <year>2018</year>
        <volume>47</volume>
        <fpage>11</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1002/jmri.25838</pub-id>
        <pub-id pub-id-type="pmid">28792646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Phelps</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <source>PET: Molecular Imaging and Its Biological Applications</source>
        <year>2004</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer New York</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Morris</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Endres</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Christian</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Muzic</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>Kinetic modeling in positron emission tomography</article-title>
        <source>Emiss Tomogr Fundam PET SPECT Acad San Diego</source>
        <year>2004</year>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sourbron</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Buckley</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <article-title>Tracer kinetic modelling in MRI: estimating perfusion and capillary permeability</article-title>
        <source>Phys Med Biol.</source>
        <year>2012</year>
        <volume>57</volume>
        <fpage>269</fpage>
        <lpage>276</lpage>
        <pub-id pub-id-type="doi">10.1088/0031-9155/57/2/R1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ingrisch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sourbron</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Tracer-kinetic modeling of dynamic contrast-enhanced MRI and CT: a primer</article-title>
        <source>J Pharmacokinet Pharmacodyn.</source>
        <year>2013</year>
        <volume>40</volume>
        <fpage>281</fpage>
        <lpage>300</lpage>
        <pub-id pub-id-type="doi">10.1007/s10928-013-9315-3</pub-id>
        <pub-id pub-id-type="pmid">23563847</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khalifa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Soliman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>El-Baz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Abou El-Ghar</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>El-Diasty</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gimel’farb</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Models and methods for analyzing DCE-MRI: a review</article-title>
        <source>Med Phys.</source>
        <year>2014</year>
        <volume>41</volume>
        <fpage>124301</fpage>
        <pub-id pub-id-type="doi">10.1118/1.4898202</pub-id>
        <pub-id pub-id-type="pmid">25471985</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sourbron</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Technical aspects of MR perfusion</article-title>
        <source>Eur J Radiol.</source>
        <year>2010</year>
        <volume>76</volume>
        <fpage>304</fpage>
        <lpage>313</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ejrad.2010.02.017</pub-id>
        <pub-id pub-id-type="pmid">20363574</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ingrisch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sourbron</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Morhard</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ertl-Wagner</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kümpfel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hohlfeld</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantification of perfusion and permeability in multiple sclerosis: dynamic contrast-enhanced MRI in 3D at 3T</article-title>
        <source>Invest Radiol.</source>
        <year>2012</year>
        <volume>47</volume>
        <fpage>252</fpage>
        <lpage>258</lpage>
        <pub-id pub-id-type="doi">10.1097/RLI.0b013e31823bfc97</pub-id>
        <pub-id pub-id-type="pmid">22373532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ledsam</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hodgson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Moots</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Sourbron</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Modeling DCE-MRI at low temporal resolution: A case study on rheumatoid arthritis</article-title>
        <source>J Magn Reson Imaging</source>
        <year>2013</year>
        <volume>38</volume>
        <fpage>1554</fpage>
        <lpage>1563</lpage>
        <pub-id pub-id-type="doi">10.1002/jmri.24061</pub-id>
        <pub-id pub-id-type="pmid">23857776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kassner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Silver</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mikulis</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Prediction of Hemorrhage in Acute Ischemic Stroke Using Permeability MR Imaging</article-title>
        <source>Am J Neuroradiol</source>
        <year>2005</year>
        <volume>26</volume>
        <fpage>2213</fpage>
        <lpage>2217</lpage>
        <?supplied-pmid 16219824?>
        <pub-id pub-id-type="pmid">16219824</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">The MathWorks, Inc. MATLAB - MathWorks. <ext-link ext-link-type="uri" xlink:href="https://de.mathworks.com/">https://de.mathworks.com/</ext-link>. Accessed 10 July 2018.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">The R Foundation. R: The R Project for Statistical Computing. <ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">https://www.r-project.org/</ext-link>. Accessed 10 July 2018.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Markwardt CB. Non-linear Least Squares Fitting in IDL with MPFIT. ArXiv09022850 Astro-Ph. 2009. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/0902.2850">http://arxiv.org/abs/0902.2850</ext-link>. Accessed 6 Feb 2017.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>M-C</given-names>
          </name>
          <name>
            <surname>Oborski</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Variations of Dynamic Contrast-Enhanced Magnetic Resonance Imaging in Evaluation of Breast Cancer Therapy Response: A Multicenter Data Analysis Challenge</article-title>
        <source>Transl Oncol</source>
        <year>2014</year>
        <volume>7</volume>
        <fpage>153</fpage>
        <lpage>166</lpage>
        <pub-id pub-id-type="doi">10.1593/tlo.13838</pub-id>
        <pub-id pub-id-type="pmid">24772219</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Siemens. Tissue 4D. <ext-link ext-link-type="uri" xlink:href="https://www.healthcare.siemens.de/magnetic-resonance-imaging/options-and-upgrades/clinical-applications/tissue-4d">https://www.healthcare.siemens.de/magnetic-resonance-imaging/options-and-upgrades/clinical-applications/tissue-4d</ext-link>. Accessed 6 Feb 2017.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Philips Healthcare. IntelliSpace Portal 8.0. <ext-link ext-link-type="uri" xlink:href="https://www.philips.de/healthcare/resources/landing/intellispace-portal-enterprise">https://www.philips.de/healthcare/resources/landing/intellispace-portal-enterprise</ext-link>. Accessed 26 June 2017.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">NordicNeuroLab AS. nordicICE. <ext-link ext-link-type="uri" xlink:href="http://www.nordicneurolab.com/products/nordicICE.html">http://www.nordicneurolab.com/products/nordicICE.html</ext-link>. Accessed 20 Feb 2018.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Olea Medical. Olea Sphere 3.0. Olea medical. <ext-link ext-link-type="uri" xlink:href="http://www.olea-medical.com/en/olea-sphere-3-0/">http://www.olea-medical.com/en/olea-sphere-3-0/</ext-link>. Accessed 20 Feb 2018.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beuzit</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Eliat</surname>
            <given-names>P-A</given-names>
          </name>
          <name>
            <surname>Brun</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ferré</surname>
            <given-names>J-C</given-names>
          </name>
          <name>
            <surname>Gandon</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bannier</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamic contrast-enhanced MRI: Study of inter-software accuracy and reproducibility using simulated and clinical data</article-title>
        <source>J Magn Reson Imaging</source>
        <year>2016</year>
        <volume>43</volume>
        <fpage>1288</fpage>
        <lpage>1300</lpage>
        <pub-id pub-id-type="doi">10.1002/jmri.25101</pub-id>
        <pub-id pub-id-type="pmid">26687041</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cron</surname>
            <given-names>GO</given-names>
          </name>
          <name>
            <surname>Sourbron</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Barnoriak</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Abdeen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hogan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>TB</given-names>
          </name>
        </person-group>
        <article-title>Bias and precision of three different DCE-MRI analysis software packages: a comparison using simulated data</article-title>
        <source>Milan: Proceedings in Internaltional Conference for Magnetic Resonance in Medicine</source>
        <year>2014</year>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goh</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Schaeffter</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Leach</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Reproducibility of Dynamic Contrast-enhanced MR Imaging: Why We Should Care</article-title>
        <source>Radiology</source>
        <year>2013</year>
        <volume>266</volume>
        <fpage>698</fpage>
        <lpage>700</lpage>
        <pub-id pub-id-type="doi">10.1148/radiol.12122447</pub-id>
        <pub-id pub-id-type="pmid">23431225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barnes</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>TSC</given-names>
          </name>
          <name>
            <surname>Santa-Maria</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Montagne</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zlokovic</surname>
            <given-names>BV</given-names>
          </name>
          <name>
            <surname>Jacobs</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>ROCKETSHIP: a flexible and modular software tool for the planning, processing and analysis of dynamic MRI studies</article-title>
        <source>BMC Med Imaging</source>
        <year>2015</year>
        <volume>15</volume>
        <fpage>19</fpage>
        <pub-id pub-id-type="doi">10.1186/s12880-015-0062-3</pub-id>
        <pub-id pub-id-type="pmid">26076957</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Ferl GZ. DATforDCEMRI: An R Package for Deconvolution Analysis and Visualization of DCE-MRI Data. J Stat Softw. 2011;44. 10.18637/jss.v044.i03.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ortuño</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Ledesma-Carbayo</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Simões</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Candiota</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Arús</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Santos</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>DCE@urLAB: a dynamic contrast-enhanced MRI pharmacokinetic analysis tool for preclinical data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>316</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-316</pub-id>
        <pub-id pub-id-type="pmid">24180558</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Arlinghaus</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Yankeelov</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>EB</given-names>
          </name>
        </person-group>
        <article-title>DCEMRI.jl: a fast, validated, open source toolkit for dynamic contrast enhanced MRI analysis</article-title>
        <source>PeerJ.</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>e909</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.909</pub-id>
        <pub-id pub-id-type="pmid">25922795</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Sourbron, Biffar, Ingrisch. PMI:platform for research in medical imaging. In: Magnetic Resonance Materials in Physics, Biology and Medicine. 2009.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Sung K. DCE_Tool. <ext-link ext-link-type="uri" xlink:href="http://kyungs.bol.ucla.edu/software/DCE_tool/DCE_tool.html">http://kyungs.bol.ucla.edu/software/DCE_tool/DCE_tool.html</ext-link>. Accessed 6 Feb 2017.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Welch EB. pydcemri: Python module for processing dynamic contrast enhanced magnetic resonance imaging (DCE-MRI) data. Python. 2017. <ext-link ext-link-type="uri" xlink:href="https://github.com/welcheb/pydcemri">https://github.com/welcheb/pydcemri</ext-link>. Accessed 30 Apr 2018.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Zöllner FG, Weisser G, Reich M, Kaiser S, Schoenberg SO, Sourbron SP, Schad LR. UMMPerfusion: an open source software tool towards quantitative MRI perfusion analysis in clinical routine. J Digit Imaging. 2013;26(2):344-52.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whitcher</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>VJ</given-names>
          </name>
        </person-group>
        <article-title>others. Quantitative analysis of dynamic contrast-enhanced and diffusion-weighted magnetic resonance imaging for oncology in R</article-title>
        <source>J Stat Softw</source>
        <year>2011</year>
        <volume>44</volume>
        <fpage>1</fpage>
        <lpage>29</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosset</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Spadola</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ratib</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>OsiriX: an open-source software for navigating in multidimensional DICOM images</article-title>
        <source>J Digit Imaging</source>
        <year>2004</year>
        <volume>17</volume>
        <fpage>205</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="doi">10.1007/s10278-004-1014-6</pub-id>
        <pub-id pub-id-type="pmid">15534753</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Kikinis R, Pieper SD, Vosburgh KG. 3D Slicer: A Platform for Subject-Specific Image Analysis, Visualization, and Clinical Support. In: Intraoperative Imaging and Image-Guided Therapy. New York: Springer; 2014. p. 277–89. 10.1007/978-1-4614-7657-3_19.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Miller J. PkModeling: Slicer Extension providing pharmacokinetic modeling. C++. 2018. <ext-link ext-link-type="uri" xlink:href="https://github.com/millerjv/PkModeling">https://github.com/millerjv/PkModeling</ext-link>. Accessed 7 May 2018.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nolden</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zelzer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Seitel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Franz</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Medical Imaging Interaction Toolkit: challenges and advances</article-title>
        <source>Int J Comput Assist Radiol Surg</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>607</fpage>
        <lpage>620</lpage>
        <pub-id pub-id-type="doi">10.1007/s11548-013-0840-8</pub-id>
        <pub-id pub-id-type="pmid">23588509</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahearn</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Staff</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Redpath</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Semple</surname>
            <given-names>SIK</given-names>
          </name>
        </person-group>
        <article-title>The use of the Levenberg–Marquardt curve-fitting algorithm in pharmacokinetic modelling of DCE-MRI data</article-title>
        <source>Phys Med Biol</source>
        <year>2005</year>
        <volume>50</volume>
        <fpage>N85</fpage>
        <pub-id pub-id-type="doi">10.1088/0031-9155/50/9/N02</pub-id>
        <pub-id pub-id-type="pmid">15843726</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Moré, Jorge. The Levenberg-Marquardt algorithm: implementation and theory. 1978.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Broyden</surname>
            <given-names>CG</given-names>
          </name>
        </person-group>
        <article-title>The Convergence of a Class of Double-rank Minimization Algorithms 1. General Considerations</article-title>
        <source>IMA J Appl Math</source>
        <year>1970</year>
        <volume>6</volume>
        <fpage>76</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="doi">10.1093/imamat/6.1.76</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fletcher</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A new approach to variable metric algorithms</article-title>
        <source>Comput J</source>
        <year>1970</year>
        <volume>13</volume>
        <fpage>317</fpage>
        <lpage>322</lpage>
        <pub-id pub-id-type="doi">10.1093/comjnl/13.3.317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldfarb</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A family of variable-metric methods derived by variational means</article-title>
        <source>Math Comput</source>
        <year>1970</year>
        <volume>24</volume>
        <fpage>23</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1090/S0025-5718-1970-0258249-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Debus C, Floca R, Nörenberg D, Abdollahi A, Ingrisch M. Impact of fitting algorithms on errors of parameter estimates in dynamic contrast enhanced MRI. Phys Med Biol. 2017. 10.1088/1361-6560/aa8989.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krasner</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Pope</surname>
            <given-names>STA</given-names>
          </name>
        </person-group>
        <article-title>Cookbook for Using the Model-view Controller User Interface Paradigm in Smalltalk-80</article-title>
        <source>J Object Oriented Program</source>
        <year>1988</year>
        <volume>1</volume>
        <fpage>26</fpage>
        <lpage>49</lpage>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zöllner</surname>
            <given-names>FG</given-names>
          </name>
          <name>
            <surname>Daab</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sourbron</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Schad</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Schoenberg</surname>
            <given-names>SO</given-names>
          </name>
          <name>
            <surname>Weisser</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>An open source software for analysis of dynamic contrast enhanced magnetic resonance images: UMMPerfusion revisited</article-title>
        <source>BMC Med Imaging</source>
        <year>2016</year>
        <volume>16</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/s12880-016-0109-0</pub-id>
        <pub-id pub-id-type="pmid">26767969</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Ibanez L, Schroeder W, Ng L, Cates J. The ITK Software Guide. 2003. <ext-link ext-link-type="uri" xlink:href="http://insight-journal.org/midas/item/view/948">http://insight-journal.org/midas/item/view/948</ext-link>. Accessed 19 Feb 2018.</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Connor</surname>
            <given-names>JPB</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>GJM</given-names>
          </name>
          <name>
            <surname>Jayson</surname>
            <given-names>GC</given-names>
          </name>
        </person-group>
        <article-title>DCE-MRI biomarkers in the clinical evaluation of antiangiogenic and vascular disrupting agents</article-title>
        <source>Br J Cancer</source>
        <year>2007</year>
        <volume>96</volume>
        <fpage>189</fpage>
        <lpage>195</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.bjc.6603515</pub-id>
        <pub-id pub-id-type="pmid">17211479</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Connor</surname>
            <given-names>JPB</given-names>
          </name>
          <name>
            <surname>Tofts</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Miles</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Parkes</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Dynamic contrast-enhanced imaging techniques: CT and MRI</article-title>
        <source>Br J Radiol</source>
        <year>2011</year>
        <volume>84</volume>
        <issue>special_issue_2</issue>
        <fpage>S112</fpage>
        <lpage>S120</lpage>
        <pub-id pub-id-type="doi">10.1259/bjr/55166688</pub-id>
        <pub-id pub-id-type="pmid">22433822</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DiStefano</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Noncompartmental vs. compartmental analysis: some bases for choice</article-title>
        <source>Am J Physiol - Regul Integr Comp Physiol</source>
        <year>1982</year>
        <volume>243</volume>
        <fpage>R1</fpage>
        <lpage>R6</lpage>
        <pub-id pub-id-type="doi">10.1152/ajpregu.1982.243.1.R1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Riviere JE. Comparative Pharmacokinetics: Principles, Techniques and Applications: Wiley; 2011. 10.1002/9780470959916.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brix</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Semmler</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Port</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schad</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Layer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lorenz</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Pharmacokinetic parameters in CNS Gd-DTPA enhanced MR imaging</article-title>
        <source>J Comput Assist Tomogr</source>
        <year>1991</year>
        <volume>15</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="doi">10.1097/00004728-199107000-00018</pub-id>
        <pub-id pub-id-type="pmid">2061479</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parker</surname>
            <given-names>GJM</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Macdonald</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Buonaccorsi</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Cheung</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Buckley</surname>
            <given-names>DL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Experimentally-derived functional form for a population-averaged high-temporal-resolution arterial input function for dynamic contrast-enhanced MRI</article-title>
        <source>Magn Reson Med</source>
        <year>2006</year>
        <volume>56</volume>
        <fpage>993</fpage>
        <lpage>1000</lpage>
        <pub-id pub-id-type="doi">10.1002/mrm.21066</pub-id>
        <pub-id pub-id-type="pmid">17036301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sokoloff</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Reivich</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Des Rosiers</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Patlak</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Pettigrew</surname>
            <given-names>KD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The [14C] deoxyglucose method for the measurement of local cerebral glucose utilization: theory, procedure, and normal values in the conscious and anesthetized albino rat</article-title>
        <source>J Neurochem</source>
        <year>1977</year>
        <volume>28</volume>
        <fpage>897</fpage>
        <lpage>916</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1471-4159.1977.tb10649.x</pub-id>
        <pub-id pub-id-type="pmid">864466</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phelps</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Selin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sokoloff</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kuhl</surname>
            <given-names>DE</given-names>
          </name>
        </person-group>
        <article-title>Tomographic measurement of local cerebral glucose metabolic rate in humans with (F-18)2-fluoro-2-deoxy-D-glucose: validation of method</article-title>
        <source>Ann Neurol</source>
        <year>1979</year>
        <volume>6</volume>
        <fpage>371</fpage>
        <lpage>388</lpage>
        <pub-id pub-id-type="doi">10.1002/ana.410060502</pub-id>
        <pub-id pub-id-type="pmid">117743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langen</surname>
            <given-names>K-J</given-names>
          </name>
          <name>
            <surname>Hamacher</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Weckesser</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Floeth</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Stoffels</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bauer</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>O-(2-[18F]fluoroethyl)-l-tyrosine: uptake mechanisms and clinical applications</article-title>
        <source>Nucl Med Biol</source>
        <year>2006</year>
        <volume>33</volume>
        <fpage>287</fpage>
        <lpage>294</lpage>
        <pub-id pub-id-type="doi">10.1016/j.nucmedbio.2006.01.002</pub-id>
        <pub-id pub-id-type="pmid">16631076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wester</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Herz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Heiss</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Senekowitsch-Schmidtke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schwaiger</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Synthesis and Radiopharmacology of O-(2-[18F]fluoroethyl)-L-Tyrosine for Tumor Imaging</article-title>
        <source>J Nucl Med</source>
        <year>1999</year>
        <volume>40</volume>
        <fpage>205</fpage>
        <lpage>212</lpage>
        <?supplied-pmid 9935078?>
        <pub-id pub-id-type="pmid">9935078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">CommonTK Command Line Interface. <ext-link ext-link-type="uri" xlink:href="http://www.commontk.org/index.php/Documentation/Command_Line_Interface">http://www.commontk.org/index.php/Documentation/Command_Line_Interface</ext-link>. Accessed 16 Nov 2018.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Butterworth E, Jardine BE, Raymond GM, Neal ML, Bassingthwaighte JB. JSim, an open-source modeling system for data analysis. F1000Research. 2014. 10.12688/f1000research.2-288.v3.</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">Radiological Society of North America. Quantitative Imaging Biomarkers Alliance (QIBA). <ext-link ext-link-type="uri" xlink:href="https://www.rsna.org/QIBA/">https://www.rsna.org/QIBA/</ext-link>. Accessed 23 May 2018.</mixed-citation>
    </ref>
  </ref-list>
</back>
