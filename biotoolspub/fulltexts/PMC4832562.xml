<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4832562</article-id>
    <article-id pub-id-type="publisher-id">930</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-016-0930-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Beyond comparisons of means: understanding changes in gene expression at the single-cell level</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Vallejos</surname>
          <given-names>Catalina A.</given-names>
        </name>
        <address>
          <email>catalina.vallejos@mrc-bsu.cam.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Richardson</surname>
          <given-names>Sylvia</given-names>
        </name>
        <address>
          <email>sylvia.richardson@mrc-bsu.cam.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Marioni</surname>
          <given-names>John C.</given-names>
        </name>
        <address>
          <email>marioni@ebi.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <aff id="Aff1"><label/>MRC Biostatistics Unit, Cambridge Institute of Public Health, Cambridge, UK </aff>
      <aff id="Aff2"><label/>EMBL European Bioinformatics Institute, Wellcome Trust Genome Campus, Cambridge, UK </aff>
      <aff id="Aff3"><label/>Cancer Research UK Cambridge Institute, University of Cambridge, Li Ka Shing Centre, Cambridge, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>4</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>4</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <elocation-id>70</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>12</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>3</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Vallejos et al. 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>Traditional differential expression tools are limited to detecting changes in overall expression, and fail to uncover the rich information provided by single-cell level data sets. We present a Bayesian hierarchical model that builds upon BASiCS to study changes that lie beyond comparisons of means, incorporating built-in normalization and quantifying technical artifacts by borrowing information from spike-in genes. Using a probabilistic approach, we highlight genes undergoing changes in cell-to-cell heterogeneity but whose overall expression remains unchanged. Control experiments validate our method’s performance and a case study suggests that novel biological insights can be revealed. Our method is implemented in R and available at <ext-link ext-link-type="uri" xlink:href="https://github.com/catavallejos/BASiCS">https://github.com/catavallejos/BASiCS</ext-link>.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-016-0930-3) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell RNA-seq</kwd>
      <kwd>Differential expression</kwd>
      <kwd>Cellular heterogeneity</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id>
            <institution>Medical Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Core Funding (MRC_MC_UP_0801/1)</award-id>
        <principal-award-recipient>
          <name>
            <surname>Vallejos</surname>
            <given-names>Catalina A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id>
            <institution>Medical Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Core Funding (MRC_MC_UP_0801/1)</award-id>
        <principal-award-recipient>
          <name>
            <surname>Richardson</surname>
            <given-names>Sylvia</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution>EMBL European Bioinformatics Institute</institution>
        </funding-source>
        <award-id>Core Funding</award-id>
        <principal-award-recipient>
          <name>
            <surname>Richardson</surname>
            <given-names>Sylvia</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution>EMBL European Bioinformatics Institute</institution>
        </funding-source>
        <award-id>Core Funding</award-id>
        <principal-award-recipient>
          <name>
            <surname>Marioni</surname>
            <given-names>John C.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000289</institution-id>
            <institution>Cancer Research UK</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Core Funding</award-id>
        <principal-award-recipient>
          <name>
            <surname>Marioni</surname>
            <given-names>John C.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The transcriptomics revolution – moving from bulk samples to single-cell (SC) resolution – provides novel insights into a tissue’s function and regulation. In particular, single-cell RNA sequencing (scRNA-seq) has led to the identification of novel sub-populations of cells in multiple contexts [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. However, compared to bulk RNA-seq, a critical aspect of scRNA-seq data sets is an increased cell-to-cell variability among the expression counts. Part of this variance inflation is related to biological differences in the expression profiles of the cells (e.g., changes in mRNA content and the existence of cell sub-populations or transient states), which disappears when measuring bulk gene expression as an average across thousands of cells. Nonetheless, this increase in variability is also due in part to <italic>technical noise</italic> arising from the manipulation of small amounts of starting material, which is reflected in weak correlations between technical replicates [<xref ref-type="bibr" rid="CR4">4</xref>]. Such technical artifacts are confounded with genuine transcriptional heterogeneity and can mask the biological signal.</p>
    <p>Among others, one objective of RNA-seq experiments is to characterize transcriptional differences between pre-specified populations of cells (given by experimental conditions or cell types). This is a key step for understanding a cell’s fate and functionality. In the context of bulk RNA-seq, two popular methods for this purpose are edgeR [<xref ref-type="bibr" rid="CR5">5</xref>] and DESeq2 [<xref ref-type="bibr" rid="CR6">6</xref>]. However, these are not designed to capture features that are specific to scRNA-seq data sets. In contrast, SCDE [<xref ref-type="bibr" rid="CR7">7</xref>] has been specifically developed to deal with scRNA-seq data sets. All of these methods target the detection of <italic>differentially expressed genes</italic> based on log-fold changes (LFCs) of overall expression between the populations. However, restricting the analysis to changes in overall expression does not take full advantage of the rich information provided by scRNA-seq. In particular – and unlike bulk RNA-seq – scRNA-seq can also reveal information about cell-to-cell expression heterogeneity. Critically, traditional approaches will fail to highlight genes whose expression is less stable in any given population but whose overall expression remains unchanged between populations.</p>
    <p>More flexible approaches, capable of studying changes that lie beyond comparisons of means, are required to characterize differences between distinct populations of cells better. In this article, we develop a quantitative method to fill this gap, allowing the identification of genes whose cell-to-cell heterogeneity pattern changes between pre-specified populations of cells. In particular, genes with less variation in expression levels within a specific population of cells might be under more stringent regulatory control. Additionally, genes having increased biological variability in a given population of cells could suggest the existence of additional sub-groups within the analyzed populations. To the best of our knowledge, this is the first probabilistic tool developed for this purpose in the context of scRNA-seq analyses. We demonstrate the performance of our method using control experiments and by comparing expression patterns of mouse embryonic stem cells (mESCs) between different stages of the cell cycle.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>A statistical model to detect changes in expression patterns for scRNA-seq data sets</title>
      <p>We propose a statistical approach to compare expression patterns between <italic>P</italic> pre-specified populations of cells. It builds upon BASiCS [<xref ref-type="bibr" rid="CR8">8</xref>], a Bayesian model for the analysis of scRNA-seq data. As in traditional differential expression analyses, for any given gene <italic>i</italic>, changes in overall expression are identified by comparing population-specific expression rates <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq1.gif"/></alternatives></inline-formula> (<italic>p</italic>=1,…,<italic>P</italic>), defined as the relative abundance of gene <italic>i</italic> within the cells in population <italic>p</italic>. However, the main focus of our approach is to assess differences in biological cell-to-cell heterogeneity between the populations. These are quantified through changes in population- and gene-specific biological <italic>over-dispersion</italic> parameters <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M4"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq2.gif"/></alternatives></inline-formula> (<italic>p</italic>=1,…,<italic>P</italic>), designed to capture residual variance inflation (after normalization and technical noise removal) while attenuating the well-known confounding relationship between mean and variance in count-based data sets [<xref ref-type="bibr" rid="CR9">9</xref>] (a similar concept was defined in the context of bulk RNA-seq by [<xref ref-type="bibr" rid="CR10">10</xref>], using the term <italic>biological coefficient of variation</italic>). Importantly, such changes cannot be uncovered by standard differential expression methods, which are restricted to changes in overall expression. Hence, our approach provides novel biological insights by highlighting genes that undergo changes in cell-to-cell heterogeneity between the populations despite the overall expression level being preserved.</p>
      <p>To disentangle technical from biological effects, we exploit <italic>spike-in</italic> genes that are added to the lysis buffer and thence theoretically present at the same amount in every cell (e.g., the 92 ERCC molecules developed by the External RNA Control Consortium [<xref ref-type="bibr" rid="CR11">11</xref>]). These provide an internal control or gold standard to estimate the strength of technical variability and to aid normalization. In particular, these control genes allow inference on cell-to-cell differences in mRNA content, providing additional information about the analyzed populations of cells [<xref ref-type="bibr" rid="CR12">12</xref>]. These are quantified through changes between cell-specific normalizing constants <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phi ^{(p)}_{j}$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq3.gif"/></alternatives></inline-formula> (for the <italic>j</italic>th cell within the <italic>p</italic>th population). Critically, as described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S1 and Fig. S1, global shifts in mRNA content between populations do not induce spurious differences when comparing gene-specific parameters (provided the offset correction described in ‘<xref rid="Sec9" ref-type="sec">Methods</xref>’ is applied).</p>
      <p>A graphical representation of our model is displayed in Fig. <xref rid="Fig1" ref-type="fig">1</xref> (based on a two-group comparison). It illustrates how our method borrows information across all cells and genes (biological transcripts and spike-in genes) to perform inference. Posterior inference is implemented via a Markov chain Monte Carlo (MCMC) algorithm, generating draws from the posterior distribution of all model parameters. Post-processing of these draws allows quantification of supporting evidence regarding changes in expression patterns (mean and over-dispersion). These are measured using a probabilistic approach based on tail posterior probabilities associated with decision rules, where a probability cut-off is calibrated through the expected false discovery rate (EFDR) [<xref ref-type="bibr" rid="CR13">13</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption><p>Graphical representation of our model for detecting changes in expression patterns (mean and over-dispersion) based on comparing two predefined population of cells. The diagram considers expression counts of two genes (<italic>i</italic> is biological and <italic>i</italic>
<sup>′</sup> is technical) and two cells (<italic>j</italic>
<sub><italic>p</italic></sub> and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$j^{\prime }_{p}$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq4.gif"/></alternatives></inline-formula>) from each population <italic>p</italic>=1,2. Observed expression counts are represented by <italic>square nodes</italic>. The central <italic>rhomboid node</italic> denotes the known input number of mRNA molecules for a technical gene <italic>i</italic>
<sup>′</sup>, which is assumed to be constant across all cells. The remaining <italic>circular nodes</italic> represent unknown elements, using <italic>black</italic> to denote random effects and <italic>red</italic> to denote model parameters (fixed effects) that lie on the top of the model’s hierarchy. Here, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phi ^{(p)}_{j}$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq5.gif"/></alternatives></inline-formula>’s and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s^{(p)}_{j}$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq6.gif"/></alternatives></inline-formula>’s act as normalizing constants that are cell-specific and <italic>θ</italic>
<sub><italic>p</italic></sub>’s are global over-dispersion parameters capturing technical variability, which affect the expression counts of all genes and cells within each population. In this diagram, <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\nu ^{(p)}_{j}$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq7.gif"/></alternatives></inline-formula>’s and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\rho ^{(p)}_{ij}$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq8.gif"/></alternatives></inline-formula>’s represent random effects related to technical and biological variability components, whose variability is controlled by <italic>θ</italic>
<sub><italic>p</italic></sub>’s and <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq9.gif"/></alternatives></inline-formula>’s, respectively (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note 6.1). Finally, <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq10.gif"/></alternatives></inline-formula>’s and <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq11.gif"/></alternatives></inline-formula>’s, respectively, measure the overall expression of a gene <italic>i</italic> and its residual biological cell-to-cell over-dispersion (after normalization, technical noise removal and adjustment for overall expression) within each population. Colored areas highlight elements that are shared within a gene and/or cell. The latter emphasizes how our model borrows information across all cells to estimate parameters that are gene-specific and all genes to estimate parameters that are cell-specific. More details regarding the model setup can be found in the ‘<xref rid="Sec9" ref-type="sec">Methods</xref>’ section of this article</p></caption><graphic xlink:href="13059_2016_930_Fig1_HTML" id="MO1"/></fig></p>
      <p>Our strategy is flexible and can be combined with a variety of decision rules, which can be altered to reflect the biological question of interest. For example, if the aim is to detect genes whose overall expression changes between populations <italic>p</italic> and <italic>p</italic><sup>′</sup>, a natural decision rule is <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$|\log (\mu ^{(p)}_{i}/\mu ^{(p')}_{i})| &gt; \tau _{0}$\end{document}</tex-math><mml:math id="M24"><mml:mo>|</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:munderover><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq12.gif"/></alternatives></inline-formula>, where <italic>τ</italic><sub>0</sub>≥0 is an a priori chosen biologically significant threshold for LFCs in overall expression, to avoid highlighting genes with small changes in expression that are likely to be less biologically relevant [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. Alternatively, changes in biological cell-to-cell heterogeneity can be assessed using <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$|\log (\delta ^{(p)}_{i}/\delta ^{(p')}_{i})| &gt; \omega _{0}$\end{document}</tex-math><mml:math id="M26"><mml:mo>|</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:munderover><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq13.gif"/></alternatives></inline-formula>, for a given minimum tolerance threshold <italic>ω</italic><sub>0</sub>≥0. This is the main focus of this article. As a default option, we suggest setting <italic>τ</italic><sub>0</sub>=<italic>ω</italic><sub>0</sub>=0.4, which roughly coincides with a 50 <italic>%</italic> increase in overall expression or over-dispersion in whichever group of cells has the largest value (this choice is also supported by the control experiments shown in this article). To improve the interpretation of the genes highlighted by our method, these decision rules can also be complemented by, e.g., requiring a minimum number of cells where the expression of a gene is detected.</p>
      <p>More details regarding the model setup and the implementation of posterior inference can be found in ‘<xref rid="Sec9" ref-type="sec">Methods</xref>’.</p>
    </sec>
    <sec id="Sec4">
      <title>Alternative approaches for identifying changes in mean expression</title>
      <p>To date, most differential expression analyses of scRNA-seq data sets have borrowed methodology from bulk RNA-seq literature (e.g., DESeq2 [<xref ref-type="bibr" rid="CR6">6</xref>] and edgeR [<xref ref-type="bibr" rid="CR5">5</xref>]). However, such methods are not designed to capture features that are specific to SC-level experiments (e.g., the increased levels of technical noise). Instead, BASiCS, SCDE [<xref ref-type="bibr" rid="CR7">7</xref>] and MAST [<xref ref-type="bibr" rid="CR15">15</xref>] have been specifically developed with scRNA-seq data sets in mind. SCDE is designed to detect changes in mean expression while accounting for <italic>dropout</italic> events, where the expression of a gene is undetected in some cells due to biological variability or technical artifacts. For this purpose, SCDE employs a two-component mixture model where negative binomial and low-magnitude Poisson components model amplified genes and the background signal related to <italic>dropout</italic> events, respectively. MAST is designed to capture more complex changes in expression, using a hurdle model to study both changes in the proportion of cells where a gene is expressed above background and in the <italic>positive expression mean</italic>, defined as a conditional value – given than the gene is expressed above background levels. Additionally, MAST uses the fraction of genes that are detectably expressed in each cell (the cellular detection rate or CDR) as a proxy to quantify technical and biological artifacts (e.g., cell volume). SCDE and MAST rely on pre-normalized expression counts. Moreover, unlike BASiCS, SCDE and MAST use a definition of changes in expression mean that is conceptually different to what would be obtained based on a bulk population (which would consider all cells within a group, regardless of whether a gene is expressed above background or not).</p>
      <p>The performance of these methods is compared in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S2 using real and simulated data sets. While control of the false discovery rate (FDR) is not well calibrated for BASiCS when setting <italic>τ</italic><sub>0</sub>=0, this control is substantially improved when increasing the LFC threshold to <italic>τ</italic><sub>0</sub>=0.4 – which is the default option we recommend (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Not surprisingly, the higher FDR rates of BASiCS lead to higher sensitivity. In fact, our simulations suggest that BASiCS can correctly identify more genes that are differentially expressed than other methods. While this conclusion is based on synthetic data, it is also supported by the analysis of the cell-cycle data set described in [<xref ref-type="bibr" rid="CR16">16</xref>] (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2), where we observe that SCDE and MAST fail to highlight a large number of genes for which a visual inspection suggests clear changes in overall expression (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S3 and S4). We hypothesize that this is partly due to conceptual differences in the definition of overall expression and, for MAST, the use of CDR as a covariate.</p>
    </sec>
    <sec id="Sec5">
      <title>Alternative approaches for identifying changes in heterogeneity of expression</title>
      <p>To the best of our knowledge, BASiCS is the first probabilistic tool to quantify gene-specific changes in the variability of expression between populations of cells. Instead, previous literature has focused on comparisons based on the coefficient of variation (CV), calculated from pre-normalized expression counts (e.g., [<xref ref-type="bibr" rid="CR17">17</xref>]), for which no quantitative measure of differential variability has been obtained. More recently, [<xref ref-type="bibr" rid="CR9">9</xref>] proposed a mean-corrected measure of variability to avoid the confounding effect between mean expression and CV. Nonetheless, the latter was designed to compare expression patterns for sets of genes, rather than for individual genes.</p>
      <p>Not surprisingly, our analysis suggests that a quantification of technical variability is critical when comparing variability estimates between cell populations (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S3 and Fig. S5). In particular, comparisons based on CV estimates can mask the biological signal if the strength of technical variability varies between populations.</p>
    </sec>
    <sec id="Sec6">
      <title>A control experiment: comparing single cells vs pool-and-split samples</title>
      <p>To demonstrate the efficacy of our method, we use the control experiment described in [<xref ref-type="bibr" rid="CR17">17</xref>], where single mESCs are compared against <italic>pool-and-split</italic> (P&amp;S) samples, consisting of pooled RNA from thousands of mESCs split into SC equivalent volumes. Such a controlled setting provides a situation where substantial changes in overall expression are not expected as, on average, the overall expression of SCs should match the levels measured in P&amp;S samples. Additionally, the design of P&amp;S samples should remove biological variation, leading to a homogeneous set of samples. Hence, P&amp;S samples are expected to show a genuine reduction in biological cell-to-cell heterogeneity compared to SCs.</p>
      <p>Here, we display the analysis of samples cultured in a 2i media. Hyper-parameter values for <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu _{i}^{(p)}$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq14.gif"/></alternatives></inline-formula>’s and <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta _{i}^{(p)}$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq15.gif"/></alternatives></inline-formula>’s were set to <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a^{2}_{\mu } = a^{2}_{\delta } = 0.5$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq16.gif"/></alternatives></inline-formula>, so that extreme LFC estimates are shrunk towards (−3,3) (see ‘<xref rid="Sec9" ref-type="sec">Methods</xref>’). However, varying <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a^{2}_{\mu }$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a^{2}_{\delta }$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq18.gif"/></alternatives></inline-formula> leads to almost identical results (not shown), suggesting that posterior inference is in fact dominated by the data. In these data, expression counts correspond to the number of molecules mapping to each gene within each cell. This is achieved by using unique molecular identifiers (UMIs), which remove amplification biases and reduce sources of technical variation [<xref ref-type="bibr" rid="CR18">18</xref>]. Our analysis includes 74 SCs and 76 P&amp;S samples (same inclusion criteria as in [<xref ref-type="bibr" rid="CR17">17</xref>]) and expression counts for 9378 genes (9343 biological and 35 ERCC spikes) defined as those with at least 50 detected molecules in total across all cells. The R code used to perform this analysis is provided in Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
      <p>To account for potential batch effects, we allowed different levels of technical variability to be estimated in each batch (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S4 and Fig. S6). Moreover, we also performed an independent analysis of each batch of cells. As seen in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7, the results based on the full data are roughly replicated in each batch, suggesting that our strategy is able to remove potential artifacts related to this batch effect.</p>
      <p>As expected, our method does not reveal major changes in overall expression between SCs and P&amp;S samples as the distribution of LFC estimates is roughly symmetric with respect to the origin (see Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">a</xref>) and the majority of genes are not classified as differentially expressed at 5 % EFDR (see Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig3" ref-type="fig">b</xref>). However, this analysis suggests that setting the minimum LFC tolerance threshold <italic>τ</italic><sub>0</sub> equal to 0 is too liberal as small LFCs are associated with high posterior probabilities of changes in expression (see Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig3" ref-type="fig">a</xref>) and the number of differentially expressed genes is inflated (see Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig3" ref-type="fig">b</xref>). In fact, counter-intuitively, 4710 genes (≈50 <italic>%</italic> of all analyzed genes) are highlighted to have a change in overall expression when using <italic>τ</italic><sub>0</sub>=0. This is partially explained by the high nominal FDR rates displayed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S2.1 where, for <italic>τ</italic><sub>0</sub>=0, FDR is poorly calibrated when simulating under the null model. In addition, we hypothesize this heavy inflation is also due to small but statistically significant differences in expression that are not biologically meaningful. In fact, the number of genes whose overall expression changes is reduced to 559 (≈6 <italic>%</italic> of all analyzed genes) when setting <italic>τ</italic><sub>0</sub>=0.4. As discussed earlier, this minimum threshold roughly coincides with a 50 % increase in overall expression and with the 90th percentile of empirical LFC estimates when simulating under the null model (no changes in expression). Posterior inference regarding biological over-dispersion is consistent with the experimental design, where the P&amp;S samples are expected to have more homogeneous expression patterns. In fact, as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">b</xref>, the distribution of estimated LFCs in biological over-dispersion is skewed towards positive values (higher biological over-dispersion in SCs). This is also supported by the results shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig3" ref-type="fig">b</xref>, where slightly more than 2000 genes exhibit increased biological over-dispersion in SCs and almost no genes (≈60 genes) are highlighted to have higher biological over-dispersion in the P&amp;S samples (EFDR = 5 %). In this case, the choice of <italic>ω</italic><sub>0</sub> is less critical (within the range explored here). This is illustrated by the left panels in Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig2" ref-type="fig">a</xref>, where tail posterior probabilities exceeding the cut-off defined by EFDR = 5 % correspond to similar ranges of LFC estimates.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Estimated LFCs in expression (mean and over-dispersion) when comparing SCs vs P&amp;S samples (2i serum culture). Posterior medians of LFC in (<bold>a</bold>) overall expression log(<italic>μ</italic>
<italic>i</italic>(SC)/<italic>μ</italic>
<italic>i</italic>(P&amp;S)) and (<bold>b</bold>) biological over-dispersion log(<italic>δ</italic>
<italic>i</italic>(SC)/<italic>δ</italic>
<italic>i</italic>(P&amp;S)) against the average between estimates of overall expression rates for SCs and P&amp;S samples. Average values are defined as a weighted average between groups, with weights given by the number of samples within each group of cells. As expected, our analysis does not reveal major changes in expression levels between SC and P&amp;S samples. In fact, the distribution of estimated LFCs in overall expression is roughly symmetric with respect to the origin. In contrast, we infer a substantial decrease in biological over-dispersion in the P&amp;S samples. This is reflected by a skewed distribution of estimated LFCs in biological over-dispersion towards positive values. <italic>LFC</italic> log-fold change, <italic>P&amp;S</italic> pool-and-split, <italic>SC</italic> single cell</p></caption><graphic xlink:href="13059_2016_930_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Summary of changes in expression patterns (mean and over-dispersion) for SCs vs P&amp;S samples (EFDR = 5 %). <bold>a</bold> Volcano plots showing posterior medians of LFCs against estimated tail posterior probabilities. <italic>Left panels</italic> relate to the test where we assess if the absolute LFC in overall expression between SCs and P&amp;S samples exceeds a minimum threshold <italic>τ</italic>
<sub>0</sub>. Estimates for LFCs in overall expression are truncated to the range (−1.5,1.5). <italic>Pink</italic> and <italic>green dots</italic> represent genes highlighted to have higher overall expression in the SC and P&amp;S samples, respectively. <italic>Right panels</italic> relate to the test where we assess if the absolute LFC in biological over-dispersion between SC and P&amp;S samples exceeds a minimum threshold <italic>ω</italic>
<sub>0</sub>. In all cases, <italic>horizontal dashed lines</italic> are located at probability cut-offs defined by EFDR = 5 %. <italic>Pink</italic> and <italic>green dots</italic> represent genes highlighted to have higher biological over-dispersion in the SC and P&amp;S samples, respectively. <bold>b</bold> Bins in the horizontal axis summarize changes in overall expression between the groups. We use SC+ and P&amp;S+ to denote that higher overall expression was detected in SC and P&amp;S samples, respectively [the central group of <italic>bars</italic> (No diff.) corresponds to those genes where no significant differences were found]. <italic>Colored bars</italic> within each group summarize changes in biological over-dispersion between the groups. We use <italic>pink</italic> and <italic>green bars</italic> to denote higher biological over-dispersion in SC and P&amp;S+ samples, respectively (and <italic>gray</italic> to denote no significant differences were found). The numbers of genes are displayed in log-scale. <italic>LFC</italic> log-fold change, <italic>P&amp;S</italic> pool-and-split, <italic>SC</italic> single cell</p></caption><graphic xlink:href="13059_2016_930_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>mESCs across different cell-cycle stages</title>
      <p>Our second example shows the analysis of the mESC data set presented in [<xref ref-type="bibr" rid="CR16">16</xref>], which contains cells where the cell-cycle phase is known (G1, S and G2M). After applying the same quality control criteria as in [<xref ref-type="bibr" rid="CR16">16</xref>], our analysis considers 182 cells (59, 58 and 65 cells in stages G1, S and G2M, respectively). To remove genes with consistently low expression across all cells, we excluded those genes with less than 20 reads per million (RPM), on average, across all cells. After this filter, 5,687 genes remain (including 5,634 intrinsic transcripts, and 53 ERCC spike-in genes). The R code used to perform this analysis is provided in Additional file <xref rid="MOESM3" ref-type="media">3</xref>.</p>
      <p>As a proof of concept, to demonstrate the efficacy of our approach under a negative control, we performed permutation experiments, where cell labels were randomly permuted into three groups (containing 60, 60 and 62 samples, respectively). In this case, our method correctly infers that mRNA content as well as gene expression profiles do not vary across groups of randomly permuted cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Posterior estimates of model parameters based on random permutations of the mESC cell-cycle data set. For a single permuted data set: <bold>a</bold> Empirical distribution of posterior medians for mRNA content normalizing constants <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phi _{j_{p}}$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq19.gif"/></alternatives></inline-formula> across all cells. <bold>b</bold> Empirical distribution of posterior medians for gene-specific expression rates <italic>μ</italic>
<sub><italic>ip</italic></sub> across all genes. <bold>c</bold> Empirical distribution of posterior medians for gene-specific biological over-dispersion parameters <italic>δ</italic>
<sub><italic>ip</italic></sub> across all genes. <bold>d</bold> As an average across ten random permutations. <italic>Upper diagonal panels</italic> compare estimates for gene-specific expression rates <italic>μ</italic>
<sub><italic>ip</italic></sub> between groups of cells. <italic>Lower diagonal panels</italic> compare gene-specific biological over-dispersion parameters <italic>δ</italic>
<sub><italic>ip</italic></sub> between groups of cells</p></caption><graphic xlink:href="13059_2016_930_Fig4_HTML" id="MO4"/></fig></p>
      <p>As cells progress through the cell cycle, cellular mRNA content increases. In particular, our model infers that mRNA content is roughly doubled when comparing cells in G1 vs G2M, which is consistent with the duplication of genetic material prior to cell division (Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">a</xref>). Our analysis suggests there are no major shifts in expression levels between cell-cycle stages (Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">b</xref> and upper triangular panels in Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">d</xref>). Nonetheless, a small number of genes are identified as displaying changes in overall expression between cell-cycle phases at 5 % EFDR for <italic>τ</italic><sub>0</sub>=0.4 (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). To validate our results, we performed gene ontology (GO) enrichment analysis within those genes classified as differentially expressed between cell-cycle phases (see Additional file <xref rid="MOESM3" ref-type="media">3</xref>). Not surprisingly, we found an enrichment of mitotic genes among the 545 genes classified as differentially expressed between G1 and G2M cells. In addition, the 209 differentially expressed genes between S and G2M are enriched for regulators of cytokinesis, which is the final stage of the cell cycle where a progenitor cell divides into two daughter cells [<xref ref-type="bibr" rid="CR19">19</xref>].
<fig id="Fig5"><label>Fig. 5</label><caption><p>Posterior estimates of model parameters for mESCs across different cell-cycle phases. <bold>a</bold> Empirical distribution of posterior medians for mRNA content normalizing constants <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phi ^{(p)}_{j}$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq20.gif"/></alternatives></inline-formula> across all cells. <bold>b</bold> Empirical distribution of posterior medians for gene-specific expression rates <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq21.gif"/></alternatives></inline-formula> across all genes. <bold>c</bold> Empirical distribution of posterior medians for gene-specific biological over-dispersion parameters <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq22.gif"/></alternatives></inline-formula> across all genes. <bold>d</bold>
<italic>Upper diagonal panels</italic> compare estimates for gene-specific expression rates <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq23.gif"/></alternatives></inline-formula> between groups of cells. <italic>Lower diagonal panels</italic> compare gene-specific biological over-dispersion parameters <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M48"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq24.gif"/></alternatives></inline-formula> between groups of cells. While our results suggest there are no major shifts in mean expression between cell-cycle stages, our results suggest a substantial decrease in biological over-dispersion when cells move from G1 to the S phase, followed by a slight increase after the transition from S to the G2M phase (to give a rough quantification of this statement, panel (<bold>d</bold>) includes the percentage of point estimates that lie on each side of the <italic>diagonal line</italic>)</p></caption><graphic xlink:href="13059_2016_930_Fig5_HTML" id="MO5"/></fig><fig id="Fig6"><label>Fig. 6</label><caption><p>Summary of changes in expression patterns (mean and over-dispersion) for the mESC cell-cycle data set (EFDR = 5 %). Bins in the horizontal axis summarize changes in overall expression between each pair of groups. We use G1+, S+ and G2M+ to denote that higher overall expression was detected in cell-cycle phase G1, S and G2M, respectively [the central group of <italic>bars</italic> (No diff.) corresponds to those genes where no significant differences were found]. <italic>Colored bars</italic> within each group summarize changes in biological over-dispersion between the groups. We use <italic>pink</italic>, <italic>green</italic> and <italic>yellow bars</italic> to denote higher biological over-dispersion in cell-cycle phases G1, S and G2M, respectively (and <italic>gray</italic> to denote no significant differences were found). The numbers of genes are displayed in log-scale</p></caption><graphic xlink:href="13059_2016_930_Fig6_HTML" id="MO6"/></fig></p>
      <p>Our method suggests a substantial decrease in biological over-dispersion when cells move from G1 to the S phase, followed by a slight increase after the transition from S to the G2M phase (see Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">c</xref> and the lower triangular panels in Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">d</xref>). This is consistent with the findings in [<xref ref-type="bibr" rid="CR19">19</xref>], where the increased gene expression variability observed in G2M cells is attributed to an unequal distribution of genetic material during cytokinesis and the S phase is shown to have the most stable expression patterns within the cell cycle. Here, we discuss GO enrichment of those genes whose overall expression rate remains constant (EFDR = 5 %, <italic>τ</italic><sub>0</sub>=0.4) but that exhibit changes in biological over-dispersion between cell-cycle stages (EFDR = 5 %, <italic>ω</italic><sub>0</sub>=0.4). Critically, these genes will not be highlighted by traditional differential expression tools, which are restricted to differences in overall expression rates. For example, among the genes with higher biological over-dispersion in G1 with respect to the S phase, we found an enrichment of genes related to protein dephosphorylation. These are known regulators of the cell cycle [<xref ref-type="bibr" rid="CR20">20</xref>]. Moreover, we found that genes with lower biological over-dispersion in G2M cells are enriched for genes related to DNA replication checkpoint regulation (which delays entry into mitosis until DNA synthesis is completed [<xref ref-type="bibr" rid="CR21">21</xref>]) relative to G1 cells and mitotic cytokinesis when comparing to S cells. Both of these processes are likely to be more tightly regulated in the G2M phase. A full table with GO enrichment analysis of the results described here is provided in Additional file <xref rid="MOESM3" ref-type="media">3</xref>.</p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="conclusion">
    <title>Conclusions</title>
    <p>Our method provides a quantitative tool to study changes in gene expression patterns between pre-specified populations of cells. Unlike traditional differential expression analyses, our model is able to identify changes in expression that are not necessarily reflected by shifts in the mean. This allows a better understanding of the differences between distinct populations of cells. In particular, we focus on the detection of genes whose residual biological heterogeneity (after normalization and technical noise removal) varies between the populations. This is quantified through biological over-dispersion parameters, which capture variance inflation with respect to the level that would be expected in a homogeneous population of cells while attenuating the well-known confounding relationship between mean and variance in count-based data sets. Despite this, several case studies (including the ones displayed in the manuscript and other examples analyzed throughout model development) suggest that – for a homogeneous population of cells – there is a strong relationship between posterior estimates of overall expression parameters <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq25.gif"/></alternatives></inline-formula> and over-dispersion parameters <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M52"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq26.gif"/></alternatives></inline-formula> (this is broken when analyzing heterogeneous populations, see Section S8 in [<xref ref-type="bibr" rid="CR8">8</xref>]). This is illustrated in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S5 using the cell-cycle data set analyzed here (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S8 and S9). Due to this interplay between overall expression and over-dispersion, the interpretation of over-dispersion parameters <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M54"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq27.gif"/></alternatives></inline-formula> requires careful consideration. In particular, it is not trivial to interpret differences between <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq28.gif"/></alternatives></inline-formula>’s when the <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq29.gif"/></alternatives></inline-formula>’s also change. As a consequence, our analysis focuses on genes undergoing changes in over-dispersion but whose overall expression remains unchanged. This set of genes can provide novel biological insights that would not be uncovered by traditional differential expression analysis tools.</p>
    <p>A decision rule to determine changes in expression patterns is defined through a probabilistic approach based on tail posterior probabilities and calibrated using the EFDR. The performance of our method was demonstrated using a controlled experiment where we recovered the expected behavior of gene expression patterns.</p>
    <p>One caveat of our approach is the limited interpretation of the over-dispersion parameter when a gene is not expressed in a given population of cells or when the expression of a gene is only detected in a small proportion of cells (e.g., high expression in a handful of cells but no expression in the remaining cells). These situations will be reflected in low and high estimates of <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta _{i}^{(p)}$\end{document}</tex-math><mml:math id="M60"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq30.gif"/></alternatives></inline-formula>, respectively. However, the biological relevance of these estimates is not clear. Hence, to improve the interpretation of the genes highlighted by our method, we suggest complementing the decision rules presented here by conditioning the results of the test on a minimum number of cells where the expression of a gene is detected.</p>
    <p>Currently, our approach requires predefined populations of cells (e.g., defined by cell types or experimental conditions). However, a large number of scRNA-seq experiments involve a mixed population of cells, where cell types are not known a priori (e.g., [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]). In such cases, expression profiles can be used to <italic>cluster</italic> cells into distinct groups and to characterize markers for such sub-populations. Nonetheless, unknown group structures introduce additional challenges for normalization and quantification of technical variability since, e.g., noise levels can vary substantially between different cell populations. A future extension of our work is to combine the estimation procedure within our model with a clustering step, propagating the uncertainty associated with each of these steps into downstream analysis. In the meantime, if the analyzed population of cells contains a sub-population structure, we advise the user to cluster cells first (e.g., using a rank-based correlation, which is more robust to normalization), thus defining groups of cells that can be used as an input for BASiCS. This step will also aid the interpretation of model parameters that are gene-specific.</p>
    <p>Until recently, most scRNA-seq data sets consisted of hundreds (and sometimes thousands) of cells. However, droplet-based approaches [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] have recently allowed parallel sequencing of substantially larger numbers of cells in an effective manner. This brings additional challenges to the statistical analysis of scRNA-seq data sets (e.g., due to the existence of unknown sub-populations, requiring unsupervised approaches). In particular, current protocols do not allow the addition of technical spike-in genes. As a result, the deconvolution of biological and technical artifacts has become less straightforward. Moreover, the increased sample sizes emphasize the need for more computationally efficient approaches that are still able to capture the complex structure embedded within scRNA-seq data sets. To this end, we foresee the use of parallel programming as a tool for reducing computing times. Additionally, we are also exploring approximated posterior inference based, for example, on an integrated nested Laplace approximation [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
    <p>Finally, our approach lies within a generalized linear mixed model framework. Hence, it can be easily extended to include additional information such as covariates (e.g., cell-cycle stage, gene length and GC content) and experimental design (e.g., batch effects) using fixed and/or random effects.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>A statistical model to detect changes in expression patterns for scRNA-seq data sets</title>
      <p>In this article, we introduce a statistical model for identifying genes whose expression patterns change between predefined populations of cells (given by experimental conditions or cell types). Such changes can be reflected via the overall expression level of each gene as well as through changes in cell-to-cell biological heterogeneity. Our method is motivated by features that are specific to scRNA-seq data sets. In this context, it is essential to normalize and remove technical artifacts appropriately from the data before extracting the biological signal. This is particularly critical when there are substantial differences in cellular mRNA content, amplification biases and other sources of technical variation. For this purpose, we exploit technical spike-in genes, which are added at the (theoretically) same quantity to each cell’s lysate. A typical example is the set of 92 ERCC molecules developed by the External RNA Control Consortium [<xref ref-type="bibr" rid="CR11">11</xref>]. Our method builds upon BASiCS [<xref ref-type="bibr" rid="CR8">8</xref>] and can perform comparisons between multiple populations of cells using a single model. Importantly, our strategy avoids stepwise procedures where data sets are normalized prior to any downstream analysis. This is an advantage over methods using pre-normalized counts, as the normalization step can be distorted by technical artifacts.</p>
      <p>We assume that there are <italic>P</italic> groups of cells to be compared, each containing <italic>n</italic><sub><italic>p</italic></sub> cells (<italic>p</italic>=1,…,<italic>P</italic>). Let <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X^{(p)}_{ij}$\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq31.gif"/></alternatives></inline-formula> be a random variable representing the expression count of a gene <italic>i</italic> (<italic>i</italic>=1,…,<italic>q</italic>) in the <italic>j</italic>th cell from group <italic>p</italic>. Without loss of generality, we assume the first <italic>q</italic><sub>0</sub> genes are biological and the remaining <italic>q</italic>−<italic>q</italic><sub>0</sub> are technical spikes. Extending the formulation in BASiCS, we assume that 
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \text{E}\left(X^{(p)}_{ij}\right) = \left\{ \begin{array}{ll} \phi^{(p)}_{j} s^{(p)}_{j} \mu^{(p)}_{i}, &amp; i = 1, \ldots, q_{0}; \\ s^{(p)}_{j} \mu^{(p)}_{i}, &amp; i = q_{0}+1, \ldots, q. \end{array} \right. \text{and}  $$ \end{document}</tex-math><mml:math id="M64"><mml:mtext>E</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>q.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mtext>and</mml:mtext></mml:math><graphic xlink:href="13059_2016_930_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ2">
          <label>(2)</label>
          <alternatives>
            <tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\begin{aligned} \text{CV}^{2}\left(X^{(p)}_{ij}\right) = \left\{ \begin{array}{ll} (\phi^{(p)}_{j} s^{(p)}_{j} \mu^{(p)}_{i})^{-1} + \theta_{p} + \delta^{(p)}_{i} (\theta_{p} + 1), &amp; i = 1, \ldots, q_{0}; \\ (s^{(p)}_{j} \mu^{(p)}_{i})^{-1} + \theta_{p}, &amp; i = q_{0}+1, \ldots, q, \end{array} \right. \end{aligned}}  $$ \end{document}</tex-math>
            <mml:math id="M66">
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mtext>CV</mml:mtext>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mfenced close=")" open="(" separators="">
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>X</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext mathvariant="italic">ij</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mi>p</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mo>=</mml:mo>
                    <mml:mfenced close="" open="{" separators="">
                      <mml:mrow>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>ϕ</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>(</mml:mo>
                                      <mml:mi>p</mml:mi>
                                      <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>(</mml:mo>
                                      <mml:mi>p</mml:mi>
                                      <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>μ</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>(</mml:mo>
                                      <mml:mi>p</mml:mi>
                                      <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msup>
                              <mml:mo>+</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>θ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>p</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>+</mml:mo>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>δ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mi>p</mml:mi>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:msubsup>
                              <mml:mo>(</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>θ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>p</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>)</mml:mo>
                              <mml:mo>,</mml:mo>
                            </mml:mtd>
                            <mml:mtd>
                              <mml:mi>i</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>,</mml:mo>
                              <mml:mo>…</mml:mo>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>q</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>0</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>;</mml:mo>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>s</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>(</mml:mo>
                                      <mml:mi>p</mml:mi>
                                      <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>μ</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>(</mml:mo>
                                      <mml:mi>p</mml:mi>
                                      <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msup>
                              <mml:mo>+</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>θ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>p</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                            </mml:mtd>
                            <mml:mtd>
                              <mml:mi>i</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>q</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>0</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>,</mml:mo>
                              <mml:mo>…</mml:mo>
                              <mml:mo>,</mml:mo>
                              <mml:mi>q</mml:mi>
                              <mml:mo>,</mml:mo>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="13059_2016_930_Article_Equ2.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>with <inline-formula id="IEq32"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu ^{(p)}_{i} \equiv \mu _{i}$\end{document}</tex-math><mml:math id="M68"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>≡</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq32.gif"/></alternatives></inline-formula> for <italic>i</italic>=<italic>q</italic><sub>0</sub>+1,…,<italic>q</italic> and where CV stands for <italic>coefficient of variation</italic> (i.e., the ratio between standard deviation and mean). These expressions are the result of a Poisson hierarchical structure (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S6.1). Here, <inline-formula id="IEq33"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phi ^{(p)}_{j}$\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq33.gif"/></alternatives></inline-formula>’s act as cell-specific normalizing constants (fixed effects), capturing differences in input mRNA content across cells (reflected by the expression counts of intrinsic transcripts only). A second set of normalizing constants, <inline-formula id="IEq34"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s^{(p)}_{j}$\end{document}</tex-math><mml:math id="M72"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq34.gif"/></alternatives></inline-formula>’s, capture cell-specific scale differences affecting the expression counts of all genes (intrinsic and technical). Among others, these differences can relate to sequencing depth, capture efficiency and amplification biases. However, a precise interpretation of the <inline-formula id="IEq35"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s^{(p)}_{j}$\end{document}</tex-math><mml:math id="M74"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq35.gif"/></alternatives></inline-formula>’s varies across experimental protocols, e.g., amplification biases are removed when using UMIs [<xref ref-type="bibr" rid="CR18">18</xref>]. In addition, <italic>θ</italic><sub><italic>p</italic></sub>’s are global technical noise parameters controlling the over-dispersion (with respect to Poisson sampling) of all genes within group <italic>p</italic>. The overall expression rate of a gene <italic>i</italic> in group <italic>p</italic> is denoted by <inline-formula id="IEq36"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M76"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq36.gif"/></alternatives></inline-formula>. These are used to quantify changes in the overall expression of a gene across groups. Similarly, the <inline-formula id="IEq37"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M78"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq37.gif"/></alternatives></inline-formula>’s capture residual over-dispersion (beyond what is due to technical artifacts) of every gene within each group. These so-called biological over-dispersion parameters relate to heterogeneous expression of a gene across cells. For each group, stable <italic>housekeeping-like</italic> genes lead to <inline-formula id="IEq38"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta ^{(p)}_{i} \approx 0$\end{document}</tex-math><mml:math id="M80"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq38.gif"/></alternatives></inline-formula> (low residual variance in expression across cells) and highly variable genes are linked to large values of <inline-formula id="IEq39"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M82"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq39.gif"/></alternatives></inline-formula>. A novelty of our approach is the use of <inline-formula id="IEq40"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\delta ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M84"><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq40.gif"/></alternatives></inline-formula> to quantify changes in biological over-dispersion. Importantly, this attenuates confounding effects due to changes in overall expression between the groups.</p>
      <p>A graphical representation of this model is displayed in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. To ensure identifiability of all model parameters, we assume that <inline-formula id="IEq41"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq41.gif"/></alternatives></inline-formula>’s are known for the spike-in genes (and given by the number of spike-in molecules that are added to each well). Additionally, we impose the identifiability restriction 
<disp-formula id="Equ3"><label>(3)</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \frac{1}{n_{p}}\sum\limits_{j=1}^{n_{p}} \phi^{(p)}_{j} = 1, \text{for}~ p = 1,\ldots, P.  $$ \end{document}</tex-math><mml:math id="M88"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>P.</mml:mi></mml:math><graphic xlink:href="13059_2016_930_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Here, we discuss the priors assigned to parameters that are gene- and group-specific (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S6.2 for the remaining elements of the prior). These are given by 
<disp-formula id="Equ4"><label>(4)</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} \mu^{(p)}_{i} \stackrel{\text{iid}}{\sim} \log\text{N}\left(0, a^{2}_{\mu}\right)~ \text{and}&amp;~ \delta^{(p)}_{i} \stackrel{\text{iid}}{\sim} {\log\text{N}}\left(0, a^{2}_{\delta}\right)~\\&amp;\text{for}~ i = 1, \ldots, q_{0}. \end{aligned}  $$ \end{document}</tex-math><mml:math id="M90"><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mover><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mtext>iid</mml:mtext></mml:mrow></mml:mrow></mml:mover><mml:mo>log</mml:mo><mml:mtext>N</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:munderover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mtext>and</mml:mtext></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mover><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mtext>iid</mml:mtext></mml:mrow></mml:mrow></mml:mover><mml:mo>log</mml:mo><mml:mtext>N</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mspace width="1em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_930_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Hereafter, without loss of generality, we simplify our notation to focus on two-group comparisons. This is equivalent to assigning Gaussian prior distributions for LFCs in overall expression (<italic>τ</italic><sub><italic>i</italic></sub>) or biological over-dispersion (<italic>ω</italic><sub><italic>i</italic></sub>). In such a case, it follows that 
<disp-formula id="Equ5"><label>(5)</label><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} \tau_{i} &amp;\equiv \log \left(\mu^{(1)}_{i} \big/ \mu^{(2)}_{i}\right) \sim~\text{N}\left(0, 2 a^{2}_{\mu}\right)~\text{and}~ \\&amp;\!\!\!\!\!\omega_{i} \equiv \log\left(\delta^{(1)}_{i} \big/ \delta^{(2)}_{i}\right) \sim~\text{N}\left(0, 2 a^{2}_{\delta}\right). \end{aligned}  $$ \end{document}</tex-math><mml:math id="M92"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>≡</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mstyle mathsize="1.19em"><mml:mfenced close="" open="/" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>∼</mml:mo><mml:mspace width="1em"/><mml:mtext>N</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:munderover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mstyle mathsize="1.19em"><mml:mfenced close="" open="/" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>∼</mml:mo><mml:mspace width="1em"/><mml:mtext>N</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:munderover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_930_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Hence, our prior is <italic>symmetric</italic>, meaning that we do not a priori expect changes in expression to be skewed towards either group of cells. Values for <inline-formula id="IEq42"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a^{2}_{\mu }$\end{document}</tex-math><mml:math id="M94"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq42.gif"/></alternatives></inline-formula> and <inline-formula id="IEq43"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a^{2}_{\delta }$\end{document}</tex-math><mml:math id="M96"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq43.gif"/></alternatives></inline-formula> can be elicited using an <italic>expected</italic> range of values for LFC in expression and biological over-dispersion, respectively. The latter is particularly useful in situations where a gene is not expressed (or very lowly expressed) in one of the groups, where, e.g., LFCs in overall expression are undefined (the maximum likelihood estimate of <italic>τ</italic><sub><italic>i</italic></sub> would be ±<italic>∞</italic>, the sign depending on which group expresses gene <italic>i</italic>). A popular solution to this issue is the addition of <italic>pseudo-counts</italic>, where an arbitrary number is added to all expression counts (in all genes and cells). This strategy is also adopted in models that are based on log-transformed expression counts (e.g., [<xref ref-type="bibr" rid="CR15">15</xref>]). While the latter guarantees that <italic>τ</italic><sub><italic>i</italic></sub> is well defined, it leads to artificial estimates for <italic>τ</italic><sub><italic>i</italic></sub> (see Table <xref rid="Tab1" ref-type="table">1</xref>). Instead, our approach exploits an informative prior (indexed by <inline-formula id="IEq44"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a^{2}_{\mu }$\end{document}</tex-math><mml:math id="M98"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq44.gif"/></alternatives></inline-formula>) to <italic>shrink</italic> extreme estimates of <italic>τ</italic><sub><italic>i</italic></sub> towards an expected range. This strategy leads to a meaningful shrinkage strength, which is based on prior knowledge. Importantly – and unlike the addition of pseudo-counts – our approach is also helpful when comparing biological over-dispersion between the groups. In fact, if a gene <italic>i</italic> is not expressed in one of the groups, this will lead to a non-finite estimate of <italic>ω</italic><sub><italic>i</italic></sub> (if all expression counts in a group are equal to zero, the corresponding estimate of the biological over-dispersion parameters would be equal to zero). Adding pseudo-counts cannot resolve this issue, but imposing an informative prior for <italic>ω</italic><sub><italic>i</italic></sub> (indexed by <inline-formula id="IEq45"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a^{2}_{\omega }$\end{document}</tex-math><mml:math id="M100"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq45.gif"/></alternatives></inline-formula>) will shrink estimates towards the appropriate range.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Synthetic example to illustrate the effect of addition of pseudo-counts over the estimation of LFCs in overall expression</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Empirical</th><th align="left">Adding 0.5</th><th align="left">Adding 1</th></tr><tr><th align="left"/><th align="left">estimate</th><th align="left">pseudo-counts</th><th align="left">pseudo-count</th></tr></thead><tbody><tr><td align="left">Overall expression rate in population 1 (<inline-formula id="IEq46"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu ^{(1)}_{i}$\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq46.gif"/></alternatives></inline-formula>)</td><td align="left">10</td><td align="left">10.5</td><td align="left">11</td></tr><tr><td align="left">Overall expression rate in population 2 (<inline-formula id="IEq47"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu ^{(2)}_{i}$\end{document}</tex-math><mml:math id="M104"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq47.gif"/></alternatives></inline-formula>)</td><td align="left">0</td><td align="left">0.5</td><td align="left">1</td></tr><tr><td align="left">LFC in overall expression 1 vs 2</td><td align="left">+<italic>∞</italic>
</td><td align="left">3.04</td><td align="left">2.40</td></tr></tbody></table><table-wrap-foot><p>For simplicity, we assume that normalization is not required so that pseudo-counts are linearly reflected in the overall expression rates. While pseudo-counts introduce an additive effect, LFC estimates measure changes on a multiplicative scale. Hence, addition of pseudo-counts leads to an artificial deflation of LFC estimates. As a consequence, such estimates cannot be meaningfully interpreted</p></table-wrap-foot></table-wrap></p>
      <p>Generally, posterior estimates of <italic>τ</italic><sub><italic>i</italic></sub> and <italic>ω</italic><sub><italic>i</italic></sub> are robust to the choice of <inline-formula id="IEq48"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a^{2}_{\mu }$\end{document}</tex-math><mml:math id="M106"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a^{2}_{\delta }$\end{document}</tex-math><mml:math id="M108"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq49.gif"/></alternatives></inline-formula>, as the data is informative and dominates posterior inference. In fact, these values are only influential when shrinkage is needed, e.g., when there are zero total counts in one of the groups. In such cases, posterior estimates of <italic>τ</italic><sub><italic>i</italic></sub> and <italic>ω</italic><sub><italic>i</italic></sub> are dominated by the prior, yet the method described below still provides a tool to quantify evidence of changes in expression. As a default option, we use <inline-formula id="IEq50"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a^{2}_{\mu } = a^{2}_{\delta } = 0.5$\end{document}</tex-math><mml:math id="M110"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq50.gif"/></alternatives></inline-formula> leading to <italic>τ</italic><sub><italic>i</italic></sub>,<italic>ω</italic><sub><italic>i</italic></sub>∼ N(0,1). These default values imply that approximately 99 % of the LFCs in overall expression and over-dispersion are expected a priori to lie in the interval (−3,3). This range seems reasonable in light of the case studies we have explored. If a different range is expected, this can be easily modified by the user by setting different values for <inline-formula id="IEq51"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a^{2}_{\mu }$\end{document}</tex-math><mml:math id="M112"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq51.gif"/></alternatives></inline-formula> and <inline-formula id="IEq52"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$a^{2}_{\delta }$\end{document}</tex-math><mml:math id="M114"><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq52.gif"/></alternatives></inline-formula>.</p>
      <p>Posterior samples for all model parameters are generated via an adaptive Metropolis within a Gibbs sampling algorithm [<xref ref-type="bibr" rid="CR25">25</xref>]. A detailed description of our implementation can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S6.3.</p>
    </sec>
    <sec id="Sec11">
      <title>Post hoc correction of global shifts in input mRNA content between the groups</title>
      <p>The identifiability restriction in Eq. <xref rid="Equ3" ref-type="">3</xref> applies only to cells within each group. As a consequence, if they exist, global shifts in cellular mRNA content between groups (e.g., if all mRNAs were present at twice the level in one population related to another) are absorbed by the <inline-formula id="IEq53"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M116"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq53.gif"/></alternatives></inline-formula>’s. To assess changes in the relative abundance of a gene, we adopt a two-step strategy where: (1) model parameters are estimated using the identifiability restriction in Eq. <xref rid="Equ3" ref-type="">3</xref> and (2) global shifts in endogenous mRNA content are treated as a fixed <italic>offset</italic> and corrected post hoc. For this purpose, we use the sum of overall expression rates (intrinsic genes only) as a proxy for the total mRNA content within each group. Without loss of generality, we use the first group of cells as a reference population. For each population <italic>p</italic> (<italic>p</italic>=1,…,<italic>P</italic>), we define a population-specific offset effect: 
<disp-formula id="Equ6"><label>(6)</label><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \Lambda_{p} = \left(\sum\limits_{i=1}^{q_{0}} \mu^{(p)}_{i} \right) \bigg/ \left(\sum\limits_{i=1}^{q_{0}} \mu^{(1)}_{i} \right)  $$ \end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mstyle mathsize="2.03em"><mml:mfenced close="" open="/" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2016_930_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>and perform the following offset correction: 
<disp-formula id="Equ7"><label>(7)</label><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} \tilde{\mu}^{(p)}_{i} &amp;= \mu^{(p)}_{i} \big/ \Lambda_{p}, \quad\tilde{\phi}^{(p)}_{j} = \phi^{(p)}_{j} \times \Lambda_{p},\\&amp; \!\! i = 1,\ldots,q_{0}; \quad\quad j_{p} = 1, \ldots, n_{p}. \end{aligned}  $$ \end{document}</tex-math><mml:math id="M120"><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mstyle mathsize="1.19em"><mml:mfenced close="" open="/" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_930_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>This is equivalent to replacing the identifiability restriction in Eq. <xref rid="Equ3" ref-type="">3</xref> by 
<disp-formula id="Equ8"><label>(8)</label><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \frac{1}{n_{p}}\sum\limits_{j=1}^{n_{p}} \phi^{(p)}_{j} = \Lambda_{p}, \quad \text{for}~ p = 1,\ldots, P.  $$ \end{document}</tex-math><mml:math id="M122"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>P.</mml:mi></mml:math><graphic xlink:href="13059_2016_930_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Technical details regarding the implementation of this post hoc offset correction are explained in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S6.4. The effect of this correction is illustrated in Fig. <xref rid="Fig7" ref-type="fig">7</xref> using the cell-cycle data set described in the main text. As an alternative, we also explored the use of the ratio between the total intrinsic counts over total spike-in counts to define a similar offset correction based on 
<disp-formula id="Equ9"><label>(9)</label><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\begin{aligned} \Lambda'_{p} = \left(\underset{j = 1, \ldots, n_{p}}{\text{median}} \left\{ \frac{\sum_{i=1}^{q_{0}} X^{(p)}_{ij}}{\sum_{i=q_{0} + 1}^{q} X^{(p)}_{ij}} \right\} \right) \bigg/ \left(\underset{j = 1, \ldots, n_{1}}{\text{median}} \left\{ \frac{\sum_{i=1}^{q_{0}} X^{(1)}_{ij}}{\sum_{i=q_{0} + 1}^{q} X^{(1)}_{ij}} \right\} \right). \end{aligned}}  $$ \end{document}</tex-math><mml:math id="M124"><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mtext>median</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mstyle mathsize="2.03em"><mml:mfenced close="" open="/" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mtext>median</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_930_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><fig id="Fig7"><label>Fig. 7</label><caption><p>Post hoc offset correction for cell-cycle data set. <italic>Upper panels</italic> display posterior medians for LFC in overall expression against the weighted average between estimates of overall expression rates for G1, S and G2M cells (weights defined by the number of cells in each group). <italic>Lower panels</italic> illustrate the effect of the offset correction upon the empirical distribution of posterior estimates for mRNA content normalizing constants <inline-formula id="IEq54"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phi ^{(p)}_{j}$\end{document}</tex-math><mml:math id="M126"><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq54.gif"/></alternatives></inline-formula>. These figures illustrate a shift in mRNA content throughout cell-cycle phases. In particular, our model infers that cellular mRNA is roughly duplicated when comparing G1 to G2M cells. <italic>LFC</italic> log-fold change</p></caption><graphic xlink:href="13059_2016_930_Fig7_HTML" id="MO7"/></fig></p>
      <p>For the cell-cycle data set, both alternatives are equivalent. Nonetheless, the first option is more robust in cases where a large number of differentially expressed genes are present. Hereafter, we use <inline-formula id="IEq55"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu ^{(p)}_{i}$\end{document}</tex-math><mml:math id="M128"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq55.gif"/></alternatives></inline-formula> and <inline-formula id="IEq56"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phi ^{(p)}_{j}$\end{document}</tex-math><mml:math id="M130"><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq56.gif"/></alternatives></inline-formula> to denote <inline-formula id="IEq57"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\mu }^{(p)}_{i}$\end{document}</tex-math><mml:math id="M132"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq57.gif"/></alternatives></inline-formula> and <inline-formula id="IEq58"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\phi }^{(p)}_{j}$\end{document}</tex-math><mml:math id="M134"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq58.gif"/></alternatives></inline-formula>, respectively.</p>
    </sec>
    <sec id="Sec12">
      <title>A probabilistic approach to quantify evidence of changes in expression patterns</title>
      <p>A probabilistic approach is adopted, assessing changes in expression patterns (mean and over-dispersion) through a simple and intuitive scale of evidence. Our strategy is flexible and can be combined with a variety of decision rules. In particular, here we focus on highlighting genes whose absolute LFC in overall expression and biological over-dispersion between the populations exceeds minimum tolerance thresholds <italic>τ</italic><sub>0</sub> and <italic>ω</italic><sub>0</sub>, respectively (<italic>τ</italic><sub>0</sub>,<italic>ω</italic><sub>0</sub>≥0), set a priori. The usage of such minimum tolerance levels for LFCs in expression has also been discussed in [<xref ref-type="bibr" rid="CR14">14</xref>] and [<xref ref-type="bibr" rid="CR6">6</xref>] as a tool to improve the biological significance of detected changes in expression and to improve upon FDRs.</p>
      <p>For a given probability threshold <inline-formula id="IEq59"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{_{M}}$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq59.gif"/></alternatives></inline-formula> (<inline-formula id="IEq60"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$0.5 &lt; \alpha _{_{M}} &lt; 1$\end{document}</tex-math><mml:math id="M138"><mml:mn>0.5</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq60.gif"/></alternatives></inline-formula>), a gene <italic>i</italic> is identified as exhibiting a change in overall expression between populations <italic>p</italic> and <italic>p</italic><sup>′</sup> if 
<disp-formula id="Equ10"><label>(10)</label><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} \pi^{M}_{i p p'} (\tau_{0}) &amp;\equiv \text{P}(|\log(\mu^{(p)}_{i}/\mu^{(p')}_{i})| &gt; \tau_{0} | \{\text{data}\}) &gt; \alpha_{_{M}},\\&amp; \quad i = 1,\ldots, q_{0}. \end{aligned}  $$ \end{document}</tex-math><mml:math id="M140"><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ip</mml:mtext><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>≡</mml:mo><mml:mtext>P</mml:mtext><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:munderover><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mtext>data</mml:mtext><mml:mo>}</mml:mo><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_930_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>If <italic>τ</italic><sub>0</sub>→0, <inline-formula id="IEq61"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\pi ^{M}_{i}}(\tau _{0}) \rightarrow 1$\end{document}</tex-math><mml:math id="M142"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq61.gif"/></alternatives></inline-formula> becoming uninformative to detect changes in expression. As in [<xref ref-type="bibr" rid="CR26">26</xref>], in the limiting case where <italic>τ</italic><sub>0</sub>=0, we define 
<disp-formula id="Equ11"><label>(11)</label><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \pi^{M}_{i p p'} (0) = 2 \max\left\{\tilde{\pi}^{M}_{i p p'}, 1- \tilde{\pi}^{M}_{i p p'}\right\} - 1  $$ \end{document}</tex-math><mml:math id="M144"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ip</mml:mtext><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>max</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ip</mml:mtext><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ip</mml:mtext><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math><graphic xlink:href="13059_2016_930_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>with 
<disp-formula id="Equ12"><label>(12)</label><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \tilde{\pi}^{M}_{i p p'} = \mathrm{P}\left(\log\left(\mu^{(p)}_{i}/\mu^{(p')}_{i}\right) &gt; 0 \mid \{\text{data}\}\right).  $$ \end{document}</tex-math><mml:math id="M146"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ip</mml:mtext><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>∣</mml:mo><mml:mo>{</mml:mo><mml:mtext>data</mml:mtext><mml:mo>}</mml:mo></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2016_930_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>A similar approach is adopted to study changes in biological over-dispersion between populations <italic>p</italic> and <italic>p</italic><sup>′</sup>, using 
<disp-formula id="Equ13"><label>(13)</label><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \pi^{D}_{i p p'} (\omega_{0}) \equiv \text{P}\left(|\log\left(\delta^{(p)}_{i}/\delta^{(p')}_{i}\right)| &gt; \omega_{0} | \{\text{data}\}\right) &gt; \alpha_{_{D}},  $$ \end{document}</tex-math><mml:math id="M148"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ip</mml:mtext><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>≡</mml:mo><mml:mtext>P</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>|</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mtext>data</mml:mtext><mml:mo>}</mml:mo></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2016_930_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>for a fixed probability threshold <inline-formula id="IEq62"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{_{D}}$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq62.gif"/></alternatives></inline-formula> (<inline-formula id="IEq63"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$0.5 &lt; \alpha _{_{D}} &lt; 1$\end{document}</tex-math><mml:math id="M152"><mml:mn>0.5</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq63.gif"/></alternatives></inline-formula>). In line with Eqs. <xref rid="Equ11" ref-type="">11</xref> and <xref rid="Equ12" ref-type="">12</xref>, we also define 
<disp-formula id="Equ14"><label>(14)</label><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \pi^{D}_{i p p'} (0) = 2 \max\left\{\tilde{\pi}^{D}_{i p p'}, 1-\tilde{\pi}^{D}_{i p p'}\right\} - 1  $$ \end{document}</tex-math><mml:math id="M154"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ip</mml:mtext><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>max</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ip</mml:mtext><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:munderover><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ip</mml:mtext><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math><graphic xlink:href="13059_2016_930_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>with 
<disp-formula id="Equ15"><label>(15)</label><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \tilde{\pi}^{D}_{i p p'} = \text{P}\left(\log\left(\delta^{(p)}_{i}/\delta^{(p')}_{i} \right) &gt; 0 \mid \{\text{data}\}\right).  $$ \end{document}</tex-math><mml:math id="M156"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ip</mml:mtext><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>P</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>∣</mml:mo><mml:mo>{</mml:mo><mml:mtext>data</mml:mtext><mml:mo>}</mml:mo></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2016_930_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Evidence thresholds <inline-formula id="IEq64"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{_{M}}$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq64.gif"/></alternatives></inline-formula> and <inline-formula id="IEq65"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{_{D}}$\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq65.gif"/></alternatives></inline-formula> can be fixed a priori. Otherwise, these can be defined by controlling the EFDR [<xref ref-type="bibr" rid="CR13">13</xref>]. In our context, these are given by 
<disp-formula id="Equ16"><label>(16)</label><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{EFDR}_{\alpha_{_{M}}}(\tau_{0})= \frac{\sum_{i=1}^{q_{0}} \left(1-\pi^{M}_{i} (\tau_{0})\right) \text{I}\left(\pi^{M}_{i} (\tau_{0}) &gt; \alpha_{_{M}}\right)}{\sum_{i=1}^{q_{0}} I\left(\pi^{M}_{i} (\tau_{0}) &gt; \alpha_{_{M}}\right)}  $$ \end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mrow><mml:mtext>EFDR</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mtext>I</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2016_930_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>and 
<disp-formula id="Equ17"><label>(17)</label><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{EFDR}_{\alpha_{_{D}}}(\omega_{0})= \frac{\sum_{i=1}^{q_{0}} \left(1-\pi^{D}_{i} (\omega_{0})\right) \text{I}\left(\pi^{D}_{i} (\omega_{0}) &gt; \alpha_{_{D}}\right)}{\sum_{i=1}^{q_{0}} I\left(\pi^{D}_{i} (\omega_{0}) &gt; \alpha_{_{D}}\right)},  $$ \end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mrow><mml:mtext>EFDR</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mtext>I</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2016_930_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where I(<italic>A</italic>)=1 if event <italic>A</italic> is true, 0 otherwise. Critically, the usability of this calibration rule relies on the existence of genes under both the null and the alternative hypothesis (i.e., with and without changes in expression). While this is not a practical limitation in real case studies, this calibration might fail to return a value in benchmark data sets (e.g., simulation studies), where there are no changes in expression. As a default, if EFDR calibration is not possible, we set <inline-formula id="IEq66"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{_{M}} = \alpha _{_{D}} = 0.90$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.90</mml:mn></mml:math><inline-graphic xlink:href="13059_2016_930_Article_IEq66.gif"/></alternatives></inline-formula>.</p>
      <p>The posterior probabilities in Eqs. <xref rid="Equ10" ref-type="">10</xref>, <xref rid="Equ11" ref-type="">11</xref>, <xref rid="Equ13" ref-type="">13</xref> and <xref rid="Equ14" ref-type="">14</xref> can be easily estimated – as a post-processing step – once the model has been fitted (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S6.5). In addition, our strategy is flexible and can be easily extended to investigate more complex hypotheses, which can be defined post hoc, e.g., to identify those genes that show significant changes in cell-to-cell biological over-dispersion but that maintain a constant level of overall expression between the groups, or conditional decision rules where we require a minimum number of cells where the expression of a gene is detected.</p>
    </sec>
    <sec id="Sec13">
      <title>Software</title>
      <p>Our implementation is freely available as an R package [<xref ref-type="bibr" rid="CR27">27</xref>], using a combination of R and C++ functions through the Rcpp library [<xref ref-type="bibr" rid="CR28">28</xref>]. This can be found in <ext-link ext-link-type="uri" xlink:href="https://github.com/catavallejos/BASiCS">https://github.com/catavallejos/BASiCS</ext-link>, released under the GPL license.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Availability of supporting data</title>
    <p>All data sets analyzed in this article are publicly available in the cited references.</p>
  </sec>
  <sec id="Sec15">
    <title>Ethics</title>
    <p>Not applicable.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec16">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="13059_2016_930_MOESM1_ESM.pdf">
          <label>Additional file 1</label>
          <caption>
            <p>Supplementary material. Section S1 illustrates the interaction between cell- and gene-specific model parameters. Section S2 provides a comparative analysis of BASiCS and alternative methods regarding the detection of differentially expressed genes (changes in mean). Section S3 illustrates the usage of the coefficient of variation as a measure of cellular heterogeneity. Section S4 describes the treatment of potential batch effects used for the analysis of the data set provided by [<xref ref-type="bibr" rid="CR17">17</xref>]. Section S5 illustrates the interplay between mean and over-dispersion parameters that is typically observed in homogeneous populations of cells. Section S6 contains additional details regarding the statistical model presented in this article and the implementation of Bayesian inference. (PDF 1443 kb)</p>
          </caption>
        </media>
      </supplementary-material>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2016_930_MOESM2_ESM.pdf">
            <label>Additional file 2</label>
            <caption>
              <p>Data analysis (part 1). R code used to analyze the single cells vs pool-and-split samples data set. (PDF 3952 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2016_930_MOESM3_ESM.pdf">
            <label>Additional file 3</label>
            <caption>
              <p>Data analysis (part 2). R code used to analyze the cell-cycle data set. (PDF 3051 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BASiCS</term>
        <def>
          <p>Bayesian analysis of single-cell sequencing data</p>
        </def>
      </def-item>
      <def-item>
        <term>bulk RNA-seq</term>
        <def>
          <p>bulk RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>CDR</term>
        <def>
          <p>cellular detection rate</p>
        </def>
      </def-item>
      <def-item>
        <term>CV</term>
        <def>
          <p>coefficient of variation</p>
        </def>
      </def-item>
      <def-item>
        <term>EFDR</term>
        <def>
          <p>expected false discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>ERCC</term>
        <def>
          <p>External RNA Control Consortium</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p>false discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>GO</term>
        <def>
          <p>gene ontology</p>
        </def>
      </def-item>
      <def-item>
        <term>LFC</term>
        <def>
          <p>log-fold change</p>
        </def>
      </def-item>
      <def-item>
        <term>MCMC</term>
        <def>
          <p>Markov chain Monte Carlo</p>
        </def>
      </def-item>
      <def-item>
        <term>mESC</term>
        <def>
          <p>mouse embryonic stem cell</p>
        </def>
      </def-item>
      <def-item>
        <term>P&amp;S</term>
        <def>
          <p>pool-and-split</p>
        </def>
      </def-item>
      <def-item>
        <term>SC</term>
        <def>
          <p>single cell</p>
        </def>
      </def-item>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p>single-cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>UMI</term>
        <def>
          <p>unique molecular identifier</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>CAV, JCM and SR conceived and designed the methods and experiments. CAV implemented the methods and analyzed the data. All authors were involved in writing the paper and have approved the final version.</p>
    </fn>
    <fn>
      <p>
        <bold>Funding</bold>
      </p>
      <p>JCM and CAV acknowledge core EMBL funding. SR and CAV acknowledge core MRC funding (MRC_MC_UP_0801/1). JCM acknowledges core support from CRUK.</p>
    </fn>
  </fn-group>
  <ack>
    <p>We acknowledge all members of the Richardson research group (Medical Research Council - Biostatistics Unit, MRC-BSU) and Marioni laboratory (European Molecular Biology Laboratory - European Bioinformatics Institute, EMBL-EBI; Cancer Research UK - Cambridge Institute, CRUK-CI) for support and discussions during the preparation of this document. In particular, we are grateful to Nils Eling (EMBL-EBI), Antonio Scialdone (EMBL-EBI) and Aaron Lun (CRUK-CI) for numerous discussions and suggestions that enriched the final version of the manuscript. We also thank the editorial team of <italic>Genome Biology</italic> and two independent reviewers for the positive feedback and many insightful and constructive comments provided.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Muñoz-Manchado</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Codeluppi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lönnerberg</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Juréus</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>347</volume>
        <issue>6226</issue>
        <fpage>1138</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id>
        <?supplied-pmid 25700174?>
        <pub-id pub-id-type="pmid">25700174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaitin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Kenigsberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Keren-Shaul</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Elefant</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zaretsky</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel single-cell RNA-seq for marker-free decomposition of tissues into cell types</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>343</volume>
        <issue>6172</issue>
        <fpage>776</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1247651</pub-id>
        <?supplied-pmid 24531970?>
        <pub-id pub-id-type="pmid">24531970</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Gillespie</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wakimoto</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>344</volume>
        <issue>6190</issue>
        <fpage>1396</fpage>
        <lpage>401</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1254257</pub-id>
        <?supplied-pmid 24925914?>
        <pub-id pub-id-type="pmid">24925914</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brennecke</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Kołodziejczyk</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Proserpio</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>11</issue>
        <fpage>1093</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2645</pub-id>
        <?supplied-pmid 24056876?>
        <pub-id pub-id-type="pmid">24056876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <?supplied-pmid 19910308?>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <?supplied-pmid 25516281?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Silberstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Scadden</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>Bayesian approach to single-cell differential expression analysis</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>7</issue>
        <fpage>740</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2967</pub-id>
        <?supplied-pmid 24836921?>
        <pub-id pub-id-type="pmid">24836921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vallejos</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>BASiCS: Bayesian analysis of single-cell sequencing data</article-title>
        <source>PLoS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>6</issue>
        <fpage>1004333</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004333</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolodziejczyk</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Tsang</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Ilicic</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Henriksson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>KN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single cell RNA-sequencing of pluripotent states unlocks modular transcriptional variation</article-title>
        <source>Cell Stem Cell</source>
        <year>2015</year>
        <volume>17</volume>
        <issue>4</issue>
        <fpage>471</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1016/j.stem.2015.09.011</pub-id>
        <?supplied-pmid 26431182?>
        <pub-id pub-id-type="pmid">26431182</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <mixed-citation publication-type="other">McCarthy DJ, Chen Y, Smyth GK. Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation. Nucleic Acids Res. 2012;40(10).</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Salit</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Synthetic spike-in standards for RNA-seq experiments</article-title>
        <source>Genome Res</source>
        <year>2011</year>
        <volume>21</volume>
        <issue>9</issue>
        <fpage>1543</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.121095.111</pub-id>
        <?supplied-pmid 21816910?>
        <pub-id pub-id-type="pmid">21816910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lovén</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Orlando</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Sigova</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Rahl</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Burge</surname>
            <given-names>CB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Revisiting global gene expression analysis</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>151</volume>
        <issue>3</issue>
        <fpage>476</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.10.012</pub-id>
        <?supplied-pmid 23101621?>
        <pub-id pub-id-type="pmid">23101621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newton</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Noueiry</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sarkar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ahlquist</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Detecting differential gene expression with a semiparametric hierarchical mixture method</article-title>
        <source>Biostatistics</source>
        <year>2004</year>
        <volume>5</volume>
        <issue>2</issue>
        <fpage>155</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/5.2.155</pub-id>
        <?supplied-pmid 15054023?>
        <pub-id pub-id-type="pmid">15054023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Testing significance relative to a fold-change threshold is a treat</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>6</issue>
        <fpage>765</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp053</pub-id>
        <?supplied-pmid 19176553?>
        <pub-id pub-id-type="pmid">19176553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>McDavid</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yajima</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gersuk</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mast: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0844-5</pub-id>
        <pub-id pub-id-type="pmid">25583448</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Casale</surname>
            <given-names>FP</given-names>
          </name>
          <name>
            <surname>Proserpio</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Scialdone</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>155</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3102</pub-id>
        <?supplied-pmid 25599176?>
        <pub-id pub-id-type="pmid">25599176</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kester</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Validation of noise models for single-cell transcriptomics</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>6</issue>
        <fpage>637</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2930</pub-id>
        <?supplied-pmid 24747814?>
        <pub-id pub-id-type="pmid">24747814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Islam</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joost</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zajac</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kasper</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>2</issue>
        <fpage>163</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2772</pub-id>
        <?supplied-pmid 24363023?>
        <pub-id pub-id-type="pmid">24363023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darzynkiewicz</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Crissman</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Traganos</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Steinkamp</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Cell heterogeneity during the cell cycle</article-title>
        <source>J Cell Physiol</source>
        <year>1982</year>
        <volume>113</volume>
        <issue>3</issue>
        <fpage>465</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1002/jcp.1041130316</pub-id>
        <?supplied-pmid 6184378?>
        <pub-id pub-id-type="pmid">6184378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Clemens</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Protein phosphorylation in cell growth regulation</source>
        <year>1996</year>
        <publisher-loc>Amsterdam</publisher-loc>
        <publisher-name>Harwood Academic Publishers</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boddy</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Russell</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>DNA replication checkpoint</article-title>
        <source>Curr Biol</source>
        <year>2001</year>
        <volume>11</volume>
        <issue>23</issue>
        <fpage>953</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1016/S0960-9822(01)00572-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Mazutis</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Akartuna</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Tallapragada</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1187</fpage>
        <lpage>201</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.04.044</pub-id>
        <?supplied-pmid 26000487?>
        <pub-id pub-id-type="pmid">26000487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1202</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rue</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Martino</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chopin</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Approximate Bayesian inference for latent Gaussian models by using integrated nested Laplace approximations</article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>2009</year>
        <volume>71</volume>
        <issue>2</issue>
        <fpage>319</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9868.2008.00700.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>GO</given-names>
          </name>
          <name>
            <surname>Rosenthal</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Examples of adaptive MCMC</article-title>
        <source>J Comput Graph Stat</source>
        <year>2009</year>
        <volume>18</volume>
        <issue>2</issue>
        <fpage>349</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1198/jcgs.2009.06134</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bochkina</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Tail posterior probability for inference in pairwise and multiclass gene expression data</article-title>
        <source>Biometrics</source>
        <year>2007</year>
        <volume>63</volume>
        <issue>4</issue>
        <fpage>1117</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1541-0420.2007.00807.x</pub-id>
        <?supplied-pmid 18078482?>
        <pub-id pub-id-type="pmid">18078482</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <source>R: a language and environment for statistical computing</source>
        <year>2014</year>
        <publisher-loc>Vienna</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddelbuettel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Allaire</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chambers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ushey</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Rcpp: Seamless R and C++ integration</article-title>
        <source>J Stat Softw</source>
        <year>2011</year>
        <volume>40</volume>
        <issue>8</issue>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v040.i08</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
