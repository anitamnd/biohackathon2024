<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature Methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
    <publisher>
      <publisher-name>Nature Publishing Group US</publisher-name>
      <publisher-loc>New York</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10406601</article-id>
    <article-id pub-id-type="pmid">37365340</article-id>
    <article-id pub-id-type="publisher-id">1914</article-id>
    <article-id pub-id-type="doi">10.1038/s41592-023-01914-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Multiscale analysis of pangenomes enables improved representation of genomic diversity for repetitive and clinically relevant genes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4394-2455</contrib-id>
        <name>
          <surname>Chin</surname>
          <given-names>Chen-Shan</given-names>
        </name>
        <address>
          <email>jchin@genedx.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9047-0203</contrib-id>
        <name>
          <surname>Behera</surname>
          <given-names>Sairam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0009-0005-5751-5245</contrib-id>
        <name>
          <surname>Khalak</surname>
          <given-names>Asif</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6040-2691</contrib-id>
        <name>
          <surname>Sedlazeck</surname>
          <given-names>Fritz J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9573-8248</contrib-id>
        <name>
          <surname>Sudmant</surname>
          <given-names>Peter H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wagner</surname>
          <given-names>Justin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2309-8402</contrib-id>
        <name>
          <surname>Zook</surname>
          <given-names>Justin M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>GeneDX, Stamford, CT USA </aff>
      <aff id="Aff2"><label>2</label>Foundation of Biological Data Science, Belmont, CA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.39382.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2160 926X</institution-id><institution>Human Genome Sequencing Center, </institution><institution>Baylor College of Medicine, </institution></institution-wrap>Houston, TX USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.21940.3e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8278</institution-id><institution>Department of Computer Science, </institution><institution>Rice University, </institution></institution-wrap>Houston, TX USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.47840.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 2181 7878</institution-id><institution>Department of Integrative Biology, </institution><institution>University of California Berkeley, </institution></institution-wrap>Berkeley, CA USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.94225.38</institution-id><institution-id institution-id-type="ISNI">000000012158463X</institution-id><institution>Material Measurement Laboratory, </institution><institution>National Institute of Standards and Technology, </institution></institution-wrap>Gaithersburg, MD USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2023</year>
    </pub-date>
    <volume>20</volume>
    <issue>8</issue>
    <fpage>1213</fpage>
    <lpage>1221</lpage>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s), under exclusive licence to Springer Nature America, Inc. 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Advancements in sequencing technologies and assembly methods enable the regular production of high-quality genome assemblies characterizing complex regions. However, challenges remain in efficiently interpreting variation at various scales, from smaller tandem repeats to megabase rearrangements, across many human genomes. We present a PanGenome Research Tool Kit (PGR-TK) enabling analyses of complex pangenome structural and haplotype variation at multiple scales. We apply the graph decomposition methods in PGR-TK to the class II major histocompatibility complex demonstrating the importance of the human pangenome for analyzing complicated regions. Moreover, we investigate the Y-chromosome genes, <italic>DAZ1</italic>/<italic>DAZ2</italic>/<italic>DAZ3</italic>/<italic>DAZ4</italic>, of which structural variants have been linked to male infertility, and X-chromosome genes <italic>OPN1LW</italic> and <italic>OPN1MW</italic> linked to eye disorders. We further showcase PGR-TK across 395 complex repetitive medically important genes. This highlights the power of PGR-TK to resolve complex variation in regions of the genome that were previously too complex to analyze.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">The PanGenome Research Tool Kit (PGR-TK) achieves flexible and scalable representation, visualization and analysis of genomic variation using pangenome graphs.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>Genome assembly algorithms</kwd>
      <kwd>Structural variation</kwd>
      <kwd>Genome assembly algorithms</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000051</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Human Genome Research Institute (NHGRI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1U01HG011758-01</award-id>
        <award-id>1U01HG011758-01</award-id>
        <principal-award-recipient>
          <name>
            <surname>Behera</surname>
            <given-names>Sairam</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>Fritz J.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000161</institution-id>
            <institution>United States Department of Commerce | National Institute of Standards and Technology (NIST)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000057</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Institute of General Medical Sciences (NIGMS)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35GM142916</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sudmant</surname>
            <given-names>Peter H.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature America, Inc. 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Main</title>
    <p id="Par3">Studying genomes, the fundamental information contained in all living beings, is the foundation for understanding the biology and evolution of all organisms, as well as the genetic diseases of humans. Despite the millions of human genomes that have been sequenced since the onset of the Human Genome Project<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup> and the dramatic reduction in the cost of short-read (roughly 150 bp) DNA sequencing, there is still fundamental information yet to be revealed in genomics<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. While it is important to recognize successes so far, including small variant surveys, genome-wide association studies<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR7">7</xref></sup> and the development of routine laboratory tests for genetic-based precision medicine<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>, there remain fundamental biological questions that involve structures at greater length scales that can only be captured using long-range information accessible by long-read technologies and diploid phased assemblies<sup><xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref></sup>.</p>
    <p id="Par4">With the possibility of resolving variants at multiple scales, small and large, researchers now can fully characterize previously inaccessible regions by focusing on single-nucleotide polymorphisms and small indels alone<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>. Examples of such previously inaccessible regions include centromere, telomeres and complex repeat regions. Recent results with pangenome-scale de novo human assemblies and the CHM13 telomere to telomere assembly have already shown the potential for revealing biological insights<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR20">20</xref></sup>, which are the foundation for understanding complex genetic diseases.</p>
    <p id="Par5">A concept that becomes powerful in such analyses is that of the pangenome: that is, a characterization of both the genetic structure and the genetic variation across diverse individuals of a species. However, such complexity and diversity generate interpretive challenges that require more advanced tools. A graph representing many genome assemblies at once provides a way to visualize and analyze complicated structural variations among different haplotypes<sup><xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR28">28</xref></sup>. Previously, distinct approaches to generate graphs representing pangenome structures have been proposed for various applications. For example, variant graph<sup><xref ref-type="bibr" rid="CR27">27</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup> and PanGenie<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> focus on improving variant calling and genotyping with pangenome references. Cactus graphs<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, Progressive Cactus graphs<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, PGGB<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> and cactus-mingraph<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup> build pangenome graphs aiming for large-scale structural rearrangement comparisons. Stringomics graph with ‘stringlet‘<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, Seqwish<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> and de Bruijn graph based approaches<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR31">31</xref></sup> provide algorithms and data structures for improving storage and query efficiency and reduce bias caused by the alignment processes. These tools provide more accessible pictures for researchers to understand repeats and rearrangements than using computational intensive and visually complicated multiple sequence alignments (MSA)<sup><xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR33">33</xref></sup>. The traditional MSA view is typically represented as a big matrix where each row represents a different genome, and the columns represent the bases. With MSA, the relationships between sequences are not obvious when there are complicated repeats or structural variations. Instead of per base alignment, a pangenome graph effectively condenses the homologous regions and can express the relationship between those different regions through graph edge connections that are easier to trace. Meanwhile, although a graph is an elegant data structure for gathering information from pangenomic assemblies, there remains a gap in projecting the underlying linear sequences onto a graph at various scales to reveal and compare features of many different haplotypes<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>.</p>
    <p id="Par6">To address this gap, we present a generalized graph framework as a software package, PanGenome Research Tool Kit (PGR-TK, <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDx/pgr-tk">https://github.com/GeneDx/pgr-tk</ext-link>), that is scalable to rapidly represent multiple samples at varying resolution levels by adopting different parameters to facilitate exploratory analysis. PGR-TK is able to resolve and visualize the most complex regions of the human genome that often affect multiple medical important phenotypes (for example, <italic>LPA</italic>, <italic>HLA</italic> and so on).</p>
    <p id="Par7">We demonstrate the ability of PGR-TK to visualize and enable deeper insights into complex variants in repetitive genes, including a gene within nested palindromic and tandem repeats (<italic>AMY1A</italic>), the major histocompatibility complex (MHC) region including the complex human leukocyte antigen (HLA) class II locus<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, the Genome in a Bottle (GIAB) challenging medically relevant gene list<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> and chrX and chrY ampliconic genes<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. Many genome-wide studies including GIAB have excluded many of these genes from their analyses because they are difficult to represent in VCF and it is challenging to compare differing representations<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. To understand how PGR-TK can help with the challenge of variant calling, variant representation and comparison across these genes and genomic loci we use the Human Pangenome Reference Consortium (HPRC)<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR38">38</xref></sup> year one 47 human genome assemblies (94 diverse haplotypes). With the ability to survey a large set of genes swiftly with PGR-TK, we hope to understand how to better provide a broader benchmark set for challenging genes using HPRC assemblies in the future. We examine <italic>OPN1LW</italic> and <italic>OPN1MW</italic> on chromosome X and <italic>DAZ1</italic>/<italic>2</italic>/<italic>3</italic>/<italic>4</italic> on chromosome Y in detail to understand how the limit due to complicated large-scale genome rearrangement affects the current methodology of generating variant call benchmarks. Our initial analysis of the GIAB clinical and medically important genes (CMRG) with a pangenome graph approach will help the research community to adapt the pangenome resource for clinical and medical genetic applications. Tools for visualizing and analyzing complicated rearrangement loci such as PGR-TK will be essential for better variant calling and understanding how structural variations with repeats affect the results for the community.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>PGR-TK</title>
      <p id="Par8">The PGR-TK has several different components to facilitate rapid pangenome analysis. The general scope and design of the PGR-TK is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1a</xref>. PGR-TK applies the computation techniques and data structures initially developed for fast genome assemblers<sup><xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR41">41</xref></sup> to pangenome analysis tasks. Instead of building a whole genome graph at once, which can be computationally expensive. PGR-TK provides tools for building an indexed sequence database, fetching and querying sequences of interest (for example, genes or regions with large-scale structural variations) from the database to create pangenomics graphs accordingly. It uses minimizer anchors to generate pangenome graphs at different scales without more computationally intensive sequence-to-sequence alignment or explicitly calling variants with respect to a reference. The generation step of the pangenome graph considers all input sequences equivalently without a preferential reference. Note that the sequence fetching step using a query sequence may introduce bias due to missing or incorrect alignments. We also developed an algorithm to decompose tangled pangenome graphs to more manageable units (principal bundles). With such decomposition, we can easily project the linear genomics sequence onto the principal bundles. It can provide more straightforward visualization to generate insight by revealing the contrast of the repeat and rearrangement variations among the haplotypes. Such pangenome-level graph decomposition provides utilities similar to the A-de Bruijn graph approach for identifying repeats and conserved segmental duplications<sup><xref ref-type="bibr" rid="CR42">42</xref>–<xref ref-type="bibr" rid="CR45">45</xref></sup>, but for the whole human pangenome collection at once.<fig id="Fig1"><label>Fig. 1</label><caption><title>The architecture of PGR-TK and minimizer anchored graph construction.</title><p><bold>a</bold>, Overall architecture and design scope of the PGR-TK library. <bold>b</bold>, Each sequence in the database is scanned, and the location of the minimizers are recorded to construct the SHIMMER database and MAP-graph. <bold>c</bold>, Each vertex in the MAP-graph represents a collection of sequence fragments sharing the two ending SHIMMERs in the database. <bold>d</bold>, The MAP-graph is constructed by merging all paths from all sequences into a graph.</p></caption><graphic xlink:href="41592_2023_1914_Fig1_HTML" id="d32e605"/></fig></p>
      <p id="Par9">PGR-TK uses the Assembly Genome Compressor<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> for storing pangenome assembly contigs and includes binary for creating the sparse hierarchical minimizer (SHIMMER) index. For the HPRC year one data release (94 fully assembled haplotypes from 47 samples), it takes 18 minutes to create the index file on an Amazon Web Services c5.12xlarge instance, with the default parameters. This is substantially faster than building an alignment index for query with tools such as mimimap2 (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). Although PGR-TK was designed to retrieve homologous sequences from the database, rather than finding the best alignments, our evaluations indicate that the query results are generally consistent with other alignment tools (Supplementary Tables <xref rid="MOESM1" ref-type="media">2</xref> and <xref rid="MOESM1" ref-type="media">3</xref>).</p>
      <p id="Par10">Once the index is built, it can be loaded into memory within minutes. As shown in Fig. <xref rid="Fig1" ref-type="fig">1a</xref>, there are three main functional modules using the index: (1) fetching homologous regions and sequences of the pangenome database given a query sequence, (2) creating a minimizer anchored pangenome-graph (MAP-graph) and (3) command line tools and a software library for interactive analysis and visualization on the generated graph and the underlying sequences. One of the main applications of PGR-TK is for deconvolving large regions of the human genome to reveal complex variations. It offers a set of efficient command line tools for various tasks, but also allows for more interactive and in-depth analysis through its integration with the Jupyter Laboratory<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> and other data science tools. This makes it a valuable resource for researchers seeking to uncover insights from their genomic data.</p>
      <p id="Par11">The source code and library can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDX/pgr-tk">https://github.com/GeneDX/pgr-tk</ext-link>. The documentation of the Python APIs is at <ext-link ext-link-type="uri" xlink:href="https://genedx.github.io/pgr-tk/">https://genedx.github.io/pgr-tk/</ext-link>.</p>
    </sec>
    <sec id="Sec4">
      <title>SHIMMER index</title>
      <p id="Par12">SHIMMER is a data structure extending the minimizer for more efficient indexing over larger regions. Additional minimizer reduction steps to generate sparse minimizers are applied to the minimizer sequences instead of the original base-pair sequences in a hierarchical way<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. Such sparse minimizers can serve as natural ‘anchors’ or ‘markers’ on genomics sequences without an explicit reference coordinate system. We use the SHIMMERs for quick sequence queries as initially proposed by Roberts et al.<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. PGR-TK identifies all neighboring pairs of SHIMMERs and indexes all the sequence segments between the pairs. Figure <xref rid="Fig1" ref-type="fig">1b</xref> shows a cartoon of the SHIMMERs identified on each sequence. Then, the pairs of the neighboring SHIMMERs are used for indexing the corresponding sequence segments within the paired SHIMMERs. After that, we build a look-up table of all pairs of SHIMMERs to all segments with the same pair at both ends (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). For the query, we compute the neighboring SHIMMER pairs from a query sequence and search the database for all segments indexed by the same pairs. Finally, we can fetch all target segments stored in the database to get all related sequence information for further analysis. PGR-TK provides functions to refine the raw query results and filter out spurious alignments likely caused by repeats outside the region of interest. With the set of sequences homologous to the query sequence, we can quickly perform downstream analysis work, for example, variant discovery by aligning the sequences to each other. Furthermore, we can generate a local pangenomics (MAP-graph) for comparing the sequences in the pangenome dataset at various scales by adjusting parameters to fit different analysis tasks.</p>
    </sec>
    <sec id="Sec5">
      <title>MAP-graph</title>
      <p id="Par13">PGR-TK provides tools to generate the MAP-graph from a set of homologous sequences. The vertices in a MAP-graph are labeled with the neighboring SHIMMER pairs representing a set of sequence segments in the database (Fig. <xref rid="Fig1" ref-type="fig">1c,d</xref> and <xref rid="Sec10" ref-type="sec">Methods</xref>). The edges in the MAP-graph are induced when at least one sequence connects the two fragments. Thus, each sequence naturally corresponds to a path in the graph, and the vertices in the path also contain the segments of other sequences in the database that share the same SHIMMER pair label (see the <xref rid="Sec10" ref-type="sec">Methods</xref> for a precise mathematical definition of a MAP-graph). The successful deployment of minimizer- or minhash- based approaches in sequence comparison<sup><xref ref-type="bibr" rid="CR39">39</xref>,<xref ref-type="bibr" rid="CR40">40</xref>,<xref ref-type="bibr" rid="CR49">49</xref></sup> indicates that sequence segments with the same minimizer labels are also likely to be highly homologous. The homology between sequences can be further confirmed by explicit sequence alignment of the segment inside a MAP-graph vertex. However, the computation intensive base-to-base alignment is not required for building the MAP-graph.</p>
      <p id="Par14">The MAP-graph construction in PGR-TK is highly efficient, as it does not rely on traditional sequence-to-sequence alignment. This is demonstrated by the fast graph construction for a set of 147 MHC class II region sequences from the pangenome reference, which was completed in under 5 seconds of wall-clock time using PGR-TK, compared to the 3.5 minutes using seqwish<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> and 13 minutes using minigraph<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> (Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>).</p>
      <p id="Par15">The size of vertices in the MAP-graph, which represents the lengths of the sequence segments in the pangenome, can be adjusted by changing the parameters that determine the distance between minimizers. This allows us to study genomic features at different length scales and generate pangenome graphs with varying levels of detail. This is particularly useful when analyzing features that vary in size, such as tandem repeats in the human genome, which can range from a few hundred base pairs to 1–2 kilobases (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>). By generating pangenome graphs at different levels of detail, we can gain a more comprehensive understanding of complex variation patterns within populations and focus on specific features of interest.</p>
      <p id="Par16">The analysis of pangenomic structure can be adjusted by controlling the parameters of minimizer window size (<italic>w</italic>), minimizer size (<italic>k</italic>) and hierarchical reduction factor (<italic>r</italic>), along with an auxiliary parameter min_span, which sets the minimum distance between minimizers in the construction of the SHIMMER index and MAP-graph (<xref rid="Sec10" ref-type="sec">Methods</xref>). The length of each vertex in the MAP-graph, representing a sequence segment, can be modified by adjusting these parameters. This allows us to study genomics features at different length scales.</p>
      <p id="Par17">Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref> illustrates the vertex length distribution for different parameter sets using chromosome 1 of CHM13 assembly. An increase in either <italic>w</italic> or <italic>r</italic> results in longer sequences being represented by each vertex, enabling a sparser sampling of the pangenome. The choice of parameters depends on the length of the region of interest and the size of relevant biological features, such as repeat sizes and distances. For example, when studying large-scale differences, bigger <italic>w</italic> and <italic>r</italic> values are preferable to generate a sparse index that can efficiently capture large-scale differences. Conversely, to compare small-scale differences, smaller <italic>w</italic> or <italic>r</italic> values should be used. Determining the optimal parameters for the pangenome graph generation step can be challenging if the underlying interesting features are less understood. Considering this, we have found that the best initial parameter choice is determined by the length of the sequences of interest to ensure comprehensible results. Based on our observation, we provide a simple formula for selecting the parameters (Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref>, Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref> for related examples).<fig id="Fig2"><label>Fig. 2</label><caption><title>AMY1A MAP-graph in two different scales.</title><p><bold>a</bold>, The left panel shows a sparse MAP-graph representation of the AMY region with (<italic>w</italic>, <italic>k</italic>, <italic>r</italic>, min_span) = (48, 56, 12, 12). 503 vertices and 699 edges represent the 200–550 kb AMY region. The graph vertices are colored by the principal bundles that correspond to the principal bundle decomposition of selected genomes on the right panel (gray vertices are those that are not in the principal bundles). <bold>b</bold>, The left panel shows a denser MAP-graph with <italic>r</italic> = 4. The graph has 3,471 vertices and 2,684 edges, which is about 5 times as much as the MAP-graph in <bold>a</bold>. The principal bundle decomposition reveals a more detailed repeat structure than in <bold>a</bold>.</p></caption><graphic xlink:href="41592_2023_1914_Fig2_HTML" id="d32e784"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Principal bundle decomposition</title>
      <p id="Par18">A pangenome graph can serve as a cornerstone for analyzing repeat structure variation in population<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>. It is usually hard to compare multiple sequences with complicated repeat structure by examining pairwise sequence alignments directly. The traditional visualization technique of the dot plot<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> allows us to perceive the complexity of the repeats but it does not provide insights into the repeat structures as linear representations across each individual sequence directly. Furthermore, only two sequences can be compared with a dot plot.</p>
      <p id="Par19">As an example, we use PGR-TK to investigate the repeat structure of the <italic>AMY1A</italic> gene (Alpha-amylase 1, an enzyme for the first step of catalyzing starch and glycogen in saliva) locus. We pick <italic>AMY1A</italic> as it has various numbers of copies caused by larger-scale structure variation related to the repeat surrounding the gene. The dot plots from randomly picking 36 sequences of a 400 kb region around <italic>AMY1A</italic> in the first year HPRC assemblies to the GRCh38 <italic>AMY1A</italic> reference sequence are shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">3a</xref>. Visual inspections of the dot plots show there are various numbers of copies of forward and inverted repeats forming palindromic sequences at the scales of 100 kb, and from zero up to five palindrome units. Still, only pairwise comparisons are enabled with dot plots and, thus, we lack a comprehensive assessment.</p>
      <p id="Par20">For comparison, we generate the <italic>AMY1A</italic> MAP-graphs at two different scales (Fig. <xref rid="Fig2" ref-type="fig">2</xref>) from the HPRC year one assemblies (47 samples). These can be generated with PRG-TK in less than 3 minutes from indexed sequence data. In additional to the MAP-graph, we provide tools analyzing a MAP-graph to ‘relinearize’ the graph into a set of ‘principal bundles’. We design the algorithm to generate the principal bundles representing those consensus paths that are most likely corresponding to repeat units in the pangenomes. The algorithm searches the paths that most of the pangenome sequences go through without branching as the principal bundles. This is analogous to identifying the contigs<sup><xref ref-type="bibr" rid="CR51">51</xref>,<xref ref-type="bibr" rid="CR52">52</xref></sup> in genome assembly algorithms.</p>
      <p id="Par21">Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the principal bundle decomposition of the <italic>AMY1A</italic> region MAP-graph in two different scales for comparison. The smaller choice of ‘<italic>r</italic>’ generates a MAP-graph with more vertices in the graph and each vertex only represents a smaller portion of the pangenome. This leads to a finer scale of principal bundle decompositions.</p>
      <p id="Par22">The linear representation derived from the MAP-graph allows for efficient identification and classification of repeat structures, which are otherwise challenging to characterize. Seven genomes were selected for analysis in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, each demonstrating distinct repeat structures. For example, HG00438 no. 2 mostly lacks repetitive sequences. The GRCh38 one has one relatively simple invert repeat (forming a palindrome region). HG02145 no. 1 has three copies of non-inverted repeats (labeled as repeat 1, 2 and 3). HG02257 no. 2 has three palindromic repeats (labeled as P1, P2 and P3). The two haplotypes from HG002 have similar structures to the GRCh38, except there is an inversion in the middle of the palindrome repeats in one of the two haplotypes. A full plot with all 96 repeat structures, including a hierarchical clustering tree identifying the similarities, is shown in the Supplementary Fig. <xref rid="MOESM1" ref-type="media">3b</xref>. This decomposition approach can be used by researchers to effectively classify the repeat structures of regions of interest.</p>
    </sec>
    <sec id="Sec7">
      <title>Pangenome analysis of the MHC class II locus</title>
      <p id="Par23">The MHC region in human genomes is highly polymorphic. The genomic sequences of the MHC are fundamental for understanding a human’s adaptive immune system and autoimmune diseases<sup><xref ref-type="bibr" rid="CR53">53</xref>,<xref ref-type="bibr" rid="CR54">54</xref></sup>. Owing to its complexity and polymorphic nature, it has been challenging to get a complete picture of the MHC genomics in the human population and to benchmark variant calling in the most variable regions<sup><xref ref-type="bibr" rid="CR34">34</xref>,<xref ref-type="bibr" rid="CR55">55</xref></sup>. The HPRC assemblies provide a new opportunity to analyze the MHC sequences with nearly fully assembled sequences of the region.</p>
      <p id="Par24">To showcase the effectiveness of PGR-TK in analyzing complicated human haplotype structures and sequences, we applied it to the HLA class II locus (GRCh38, chr6:32,313,513-32,992,088). We fetched the HPRC HLA class II haplotype sequences by anchoring them with more conserved flanking regions. Our dataset consists of a total of 105 full-length sequences, ranging from 650 to 800 kbp. Figure <xref rid="Fig3" ref-type="fig">3a</xref> shows the principal bundle decomposition of the collection of the sequence and Fig. <xref rid="Fig3" ref-type="fig">3b</xref> illustrates the MAP-graph of the 105 sequences. The tangled region in the MAP-graph represents highly polymorphic haplotypes in the human population. We can uncover the combinatorial nature of haplotype variation, such as the appearance of different combinations of HLA class II gene types in different haplotypes, in relation to the newly released human pangenome references (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>) by generating the MAP-graph and the principal bundle decomposition of the MHC class II.<fig id="Fig3"><label>Fig. 3</label><caption><title>Principal bundle decomposition reveals distinct haplotype groups.</title><p><bold>a</bold>, The principal bundle decomposition and annotated HLA class II genes in each of the haplotype sequences. The auxiliary tracks below each sequence on the left panel show the locations of the genes. The colors of the auxiliary tracks match the gene list of genes identified for each haplotype on the right. <bold>b</bold>, The MAP-graph generated by PGR-TK. <bold>c</bold>, PCA plots of the MHC class II sequences. Each panel highlights the different gene haplotype combinations. The vertical color bars indicate the matched haplotype groups in <bold>b</bold> and <bold>c</bold>. The circled symbols indicate the haplotypes belong to the corresponding group. The dotted lines represent the connection between the two haplotypes of individuals included in the analysis set who possess both haplotypes. The population groups, African Ancestry(AFR), American Ancestry (AMR), South Asia Ancestry(SAS), East Asia Ancestry(EAS) and not applicable (NA), are indicated with different markers of different colors.</p></caption><graphic xlink:href="41592_2023_1914_Fig3_HTML" id="d32e906"/></fig></p>
      <p id="Par25">We constructed a hierarchical dendrogram on top of the principal bundle decomposition to study the relationships of highly polymorphic haplotypes in the MHC region of the human population. The PGR-TK provides a command line tool to compute a distance metric derived from pairwise sparse alignment of the bundles between two sequences and generate a dendrogram from all pairwise distances. Known HLA class II gene sequences were also mapped to 105 pangenome sequences. The full annotated principal bundle decomposition, which was annotated with HLA class II genes and the hierarchical clustering dendrogram, is shown in Fig. <xref rid="Fig3" ref-type="fig">3a</xref>. The highly polymorphic region in the MAP-graph was found to correspond to the <italic>DRB-1</italic>/<italic>3</italic>/<italic>4</italic>/<italic>5</italic>, <italic>DOB</italic> and <italic>DOA1</italic>/<italic>2</italic> region. By clustering the full set of haplotype sequences, we can identify the combination of bundles in the entire region that correspond to the gene combinations of each cluster. Our approach uses the principal bundles to classify the complete sequence, rather than relying solely on gene fragments. This classification has the potential to facilitate new applications for improved genotyping or haplotyping of larger population data in this complex region. The results could offer valuable insights into the relationship between haplotype sequences and gene combinations in the context of genetic variation and disease susceptibility.</p>
      <p id="Par26">We can also use the vertices in the MAP-graph to conduct a principal component analysis (PCA) of the MHC class II regions. We collected all vertices in the MAP-graph to form the basis of vectors. Then, we constructed a binary vector for each haplotype path by indicating whether the path of the haplotype passes through the vertex. Figure <xref rid="Fig3" ref-type="fig">3c</xref> displays the principal component plot of the haplotype path vectors, along with the ethnic groups. The dotted line connects the two haplotypes of an individual in the sample. We have highlighted four different groups based on the HLA class II gene combinations (excluding the subtypes). Each group contains 10–49 haplotypes. With the current dataset of a limited number of haplotypes, we have not found any statistically significant patterns yet. However, as additional data will be released from HPRC in the coming years, we anticipate that the MAP-graph can be used to systematically analyze this region and better understand its impact on human disease within ethnic group structure.</p>
    </sec>
    <sec id="Sec8">
      <title>Analyzing medically relevant amplicon genes</title>
      <p id="Par27">GIAB is using the fully assembled HG002 chrX and chrY from T2T to form new small variant and structural variant benchmarks. The assembly fully resolves the medically relevant ampliconic genes<sup><xref ref-type="bibr" rid="CR36">36</xref>,<xref ref-type="bibr" rid="CR56">56</xref>,<xref ref-type="bibr" rid="CR57">57</xref></sup>
<italic>OPN1LW</italic>/<italic>OPN1MW</italic>/<italic>OPN1MW2</italic>/<italic>OPN1MW3</italic> and <italic>DAZ1</italic>/<italic>DAZ2</italic>/<italic>DAZ3</italic>/<italic>DAZ4</italic>, but the variation in these genes is too complex for current approaches to make reliable variant calls compatible with current benchmarking tools.</p>
      <p id="Par28">For example, the genes <italic>OPN1MW</italic> and <italic>OPN1MW2</italic> are inside a 74 kb deletion in HG002 relative to GRCh38, so HG002 contains only two of the four copies of the array in GRCh38: <italic>OPN1LW</italic> and one copy of <italic>OPN1MW</italic>/<italic>OPN1MW2</italic>/<italic>OPN1MW3</italic>. Dipcall<sup><xref ref-type="bibr" rid="CR58">58</xref></sup> can call the 74 kb deletion and variants in the other gene copies, but it may be possible to align the assembly to GRCh38 in alternative ways. The visualization from PGR-TK makes clear the varying number of genes in this array in each haplotype in Fig. <xref rid="Fig4" ref-type="fig">4a</xref>, which is important for some phenotypes such as color blindness, since seeing full color requires <italic>OPN1LW</italic> and at least one copy of <italic>OPN1MW</italic>/<italic>OPN1MW2</italic>/<italic>OPN1MW3</italic> (refs. <sup><xref ref-type="bibr" rid="CR56">56</xref>,<xref ref-type="bibr" rid="CR59">59</xref></sup>).<fig id="Fig4"><label>Fig. 4</label><caption><title>Principal bundle decomposition for genes in the repetitive regions of chromosome X and Y.</title><p><bold>a</bold>, MAP-graph principal bundle decomposition shows the repeat number changes of the <italic>OPN1LW</italic>, <italic>OPN1MW1</italic>/<italic>2</italic>/<italic>3</italic> to <italic>FLNA</italic> loci. Auxiliary tracks are as follows: top <italic>OPN1LW</italic>, middle <italic>OPN1MW1</italic>/<italic>2</italic>/<italic>3</italic> and bottom <italic>FLNA</italic>. <bold>b</bold>, The upper left image displays a dot plot comparing the HG002 assembly to GRCh38 over a 5 Mb region containing the <italic>DAZ1</italic>/<italic>2</italic>/<italic>3</italic>/<italic>4</italic> loci, highlighting an inversion between <italic>DAZ1</italic>/<italic>2</italic> and <italic>DAZ3</italic>/<italic>4</italic>. The image on the right provides a detailed view of the rearrangements at the gene scale level, with four tracks indicating the local matches to <italic>DAZ1</italic>/<italic>2</italic>/<italic>3</italic>/<italic>4</italic> from top to bottom. Comparison to GRCh38’s <italic>DAZ2</italic> reveals that the HG002 assembly is missing a segment (roughly 10 kb) of the darker green. The intergenic region between <italic>DAZ3</italic> and <italic>DAZ4</italic> also displays a rearrangement that can be described as an incomplete inversion or separate insertions and deletions. The bottom image shows a rearrangement at the whole locus, including all <italic>DAZ1</italic>/<italic>2</italic>/<italic>3</italic>/<italic>4</italic> over a 5 Mb region. The principal bundle decomposition reveals the different inverted structure of the HG002 T2T assembly and the HG1258 assembly compared to GRCh38. <bold>c</bold>, MAP-graph diffusion entropy versus repetitiveness survey for the 385 GIAB challenge CMRGs.</p></caption><graphic xlink:href="41592_2023_1914_Fig4_HTML" id="d32e1137"/></fig></p>
      <p id="Par29">Another important gene family <italic>DAZ1</italic>/<italic>DAZ2</italic>/<italic>DAZ3</italic>/<italic>DAZ4</italic> are in a set of nested palindromic repeats. It has been reported that partial deletions in this region may cause male infertility<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>. It would be useful to understand the natural distribution of non-pathogenic structural variants across this ampliconic gene cluster. <italic>DAZ1</italic> and <italic>DAZ2</italic> are roughly 1.5 Mbp (megabasepairs) from <italic>DAZ3</italic> and <italic>DAZ4</italic>, and HG002 has a 1 to 2 Mbp inversion relative to GRCh38 with breakpoints in the segmental duplications that contain the <italic>DAZ</italic> genes (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). In addition to the large inversion, the <italic>DAZ</italic> genes contain structural variants, including a roughly 10 kb deletion in <italic>DAZ2</italic>, two deletions in <italic>DAZ4</italic> and two insertions in <italic>DAZ3</italic> of sequences that are only in <italic>DAZ1</italic> and <italic>DAZ4</italic> in GRCh38. PGR-TK’s ability to color and visualize variation with the principal bundle decomposition algorithm at multiple scales enables intuitive understanding of this type of very complex variation, which would be very difficult to represent and understand as simple structural variant calls in VCF format.</p>
      <p id="Par30">The efficiency of PGR-TK makes it suitable for analyzing complex variants at isolated loci, as well as a set of region of interest. For example, GIAB has identified a set of 395 challenging but medically relevant genes. Analyzing this set in the pangenome references will provide some insight into the related complicated variation at the population level.</p>
      <p id="Par31">Using PGR-TK, we extracted all sequences of the 395 genes from the HPRC year one release (94 haplotype assemblies), CHM13 v.1.1, GRCh38 and hg19 of all 385 CMRG. We generated a MAP-graph for each gene and output it in GFA format (as seen in the Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>). For each graph, we derived two metrics to estimate (1) the degree of polymorphism among the pangenomes, and (2) the repeat content considering the variations of the pangenomes (as shown in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). These two measurements provide independent assessments of the MAP-graph structures of these genes. We found, as expected, that highly repetitive genes (such as <italic>LPA</italic> and <italic>KATNAL2</italic>) are more difficult to create a reliable variant benchmark call set. Many highly repetitive genes are excluded from the current CMRG benchmark set. We did not observe a correlation between higher entropy and the reduction of the gene in the benchmark set. We found that the high entropy genes also span larger regions in the genome. While entropy can indicate the complexity of variations in the population, we observed different clustering structures of the top entropy genes (see the comparison of the MAP-graph PCA plots of <italic>SNTG2</italic> and <italic>KMT2C</italic> in Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>).</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par32">With the advance in DNA sequencing technologies, more comprehensive human genomes at, or close to, telomere to telomere will be collected and made available in the coming years. It will enable researchers to study and characterize those previously inaccessible complex, but likely relevant, regions. The current HPRC assembly release has significantly affected our understanding of the human genome architecture. It will also be essential for building applications for clinical and medical tests and diagnostics soon. Flexible and scalable computational tools for analyzing pangenome-level genome assemblies will be part of the vital task of improving the practice of precision medicine with rich genomic data such as those from HPRC.</p>
    <p id="Par33">Many of the recently developed pangenome analysis tools allow graph analysis at the whole-genome level<sup><xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR24">24</xref></sup>. Meanwhile, the richness of diversity of human genomes over the repetitive regions poses unique challenges for analysis. In our work developing PGR-TK, we focus on providing a flexible library of useful algorithms. Furthermore, it enables analyzing the genome assemblies such that a developer or a researcher can rapidly access certain complex regions by adjusting parameters for visualization and integrating with subsequent analysis. PGR-TK may not be suitable for analysis at the whole-genome scale yet, and obtaining optimized results with the tool might not be straightforward. The challenges associated with the diversity of human genomes over repetitive regions can complicate the analysis process. It is crucial to ensure that the parameters chosen for visualization and subsequent analysis are appropriate for the specific genomic characteristics being examined. It may require careful consideration and expertise of a user to fine-tune the parameters and algorithms for optimization. Each main building unit (the vertex) of the MAP-graph represents a set of closely related sequence fragments. This is more analogous to the stringomics method proposed by Ferragina<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> than other methods building graphs on top of MSA or variant calls. Such approaches combined with the sparse minimizers are efficient to reduce the computational complexity (fewer vertices) to represent larger-scale scale structures. Complementary to that, PGR-TK provides an interface to fetch the sequences within each vertex such that it is possible to combine a MAP-graph with other graph analysis approaches. For example, it can be integrated with Cactus graph<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> and A-de Bruijn Graph<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> for base-level analysis, such as variant calling, genotyping and point mutation analysis, with recursive hybrid graph data structures.</p>
    <p id="Par34">We demonstrate how to use the PGR-TK for studying and characterizing the repetitive region <italic>AMY1A</italic> and the highly polymorphic HLA class Il region. We present a tool in PGR-TK backed by a new pangenome graph traversal algorithm, relinearizing tangled graphs caused by repetitive sequences to principal bundles for visualization. With the principal bundle decomposition, we can automatically visualize the repetitive and non-repetitive components of haplotype assembly contig. The PGR-TK can provide intuitive qualitative information about different genome arrangement architectures with decomposition and associated visualizations. For example, it enables visualization of both the very large inversion in the <italic>DAZ</italic> locus and much smaller complex structural variation within the genes. The visualization of the <italic>OPN1LW</italic>/<italic>OPN1MW</italic> gene array shows subtle copy number variations, which can affect vision, as well as nearby structural variants. We also use PGR-TK to survey a set of regions of interest across the whole genome. We derive two metrics for measuring the polymorphism and repetitiveness in human pangenome to more systematically survey complexity of a large set of medically and clinically relevant genes. In the future, we aim to extend the PGR-TK library to provide more quantitative and base-level analysis for both fundamental and translational research using pangenome resources.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Sequence database and SHIMMER index construction</title>
      <p id="Par35">To generate the SHIMMER index, each sequence was scanned and the symmetrical minimizers were generated with the specific minimizer window size <italic>w</italic> and kmer size <italic>k</italic>. We called this the first level of minimizer. Given a reduction factor <italic>r</italic> &gt; 1, additional levels of minimizer sets were generated to increase the span between the minimizers by a reduction step to facilitate pangenomics analysis. Even with the reduction step, in some simple sequence context, for example, long or short tandem repeats, two minimizers can remain too close to each other. A parameter ‘min_span’ can be applied to eliminate a pair of minimizers that are too close. We used a heuristic algorithm to eliminate those minimizers that were within the distance of min_span to each other. This helped to reduce the minimizer density when detailed analysis for those simple context regions was not desired. Setting min_span to zero and <italic>r</italic> to one generated the standard minimizers for each sequence.</p>
      <p id="Par36">Each pair of the reduced minimizers (SHIMMERs) was used as the key to build a hashmap to the sequence ID, and coordinates and matching orientation of the minimizer pairs on the sequences.</p>
      <p id="Par37">We also present examples of API calling and command line usage below.</p>
    </sec>
    <sec id="Sec12">
      <title>Generate MAP-graph</title>
      <p id="Par38">The MAP-graph is constructed by scanning through each sequence in the database. The vertices are simply the set of the tuples of neighboring minimizers (minimizer anchored segments). The edges are constructed by connecting minimizer anchored segments as a bidirected graph. One can consider this to be an extension of the string graph<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> where the overlaps are the minimizers at both ends. However, in the pangenome graph, each vertex includes a set of sequence segments from multiple genomes rather than one sequence.</p>
      <p id="Par39">As the MAP-graph can be constructed by scanning the SHIMMER pairs through the sequences. For a given set of <italic>n</italic> sequences, <italic>S</italic> = {<italic>s</italic><sub><italic>i</italic></sub>|<italic>i</italic> = 0…<italic>n</italic> − 1}, the vertices of the MAP-graph are<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}V = \left\{\right.({m^{(i)}}_{p},{m^{(i)}}_{p+1})|{m^{(i)}}_{p}, {\mathrm{and}}\, {m^{(i)}}_{p+1}\, {\mathrm{are}}\, {\mathrm{the}}\, p{\mathrm{th}}\, {\mathrm{and}} (p + 1){\mathrm{th}} \\\qquad{\mathrm{minimizers}}\, {\mathrm{of}}\, {\mathrm{a}}\, {\mathrm{sequence}}\, s_{i}, {\mathrm{in}}\, {\mathrm{all}}\, s_{i}\, {\mathrm{in}}\, S\left.\right\}.\end{array}$$\end{document}</tex-math><mml:math id="M2"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow/></mml:mfenced><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">are</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">the</mml:mi><mml:mspace width="0.25em"/><mml:mi>p</mml:mi><mml:mi mathvariant="normal">th</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="2.0em"/><mml:mi mathvariant="normal">minimizers</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">of</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">a</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">sequence</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">in</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">all</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">in</mml:mi><mml:mspace width="0.25em"/><mml:mi>S</mml:mi><mml:mfenced close="}"><mml:mrow/></mml:mfenced><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41592_2023_1914_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par40">We can assign a weight <italic>w</italic><sub><italic>i</italic></sub> of a vertex <italic>v</italic><sub><italic>i</italic></sub> = (<italic>m</italic><sub>a</sub>, <italic>m</italic><sub>b</sub>) as the total number of observed (<italic>m</italic><sub>a</sub>, <italic>m</italic><sub>b</sub>) pairs in <italic>S</italic>.</p>
      <p id="Par41">The edges of the MAP-graph are<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}E = \left\{\right.(v_{i}, v_{j})|v_{i} = ({m^{(i)}}_p,{m^{(i)}}_{p+1})\, {\mathrm{and}}\, v_{i} = ({m^{(i)}}_{p+1},{m^{(i)}}_{p+2})\, {\mathrm{for}}\, {\mathrm{all}}\\\qquad ({m^{(i)}}_p, {m^{(i)}}_{p+1},{m^{(i)}}_{p+2})\, {\mathrm{in}}\, {\mathrm{all}}\, s_{i}\, {\mathrm{in}}\, S\left.\right\}\end{array}$$\end{document}</tex-math><mml:math id="M4"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow/></mml:mfenced><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">for</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">all</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="2.0em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">in</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">all</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">in</mml:mi><mml:mspace width="0.25em"/><mml:mi>S</mml:mi><mml:mfenced close="}"><mml:mrow/></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41592_2023_1914_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec13">
      <title>Identify the principal bundles in a MAP-graph</title>
      <p id="Par42">To decompose a MAP-graph into principal bundles for downstream analysis, we apply a variation of depth first search<sup><xref ref-type="bibr" rid="CR60">60</xref></sup> (DFS) to build the traversal trees from the graph. Our DFS prioritized vertices with high ‘weight’ (defined as the number of sequence segments contained in a vertex) and accounting for the bidirected nature of the MAP-graph.</p>
      <p id="Par43">The DFS traversal through the graph is then converted to a tree structure internally. The leaf nodes in the tree are typically when the DFSs are terminated by no out edge from a node or a bubble or a loop is found. As we prioritize the weights of the vertices during DFS, long paths usually correspond to the ‘common’ paths that most sequences in the data would go through. Rarer haplotypes typically correspond to short bubble paths in the MAP-graph. Thus, they can be identified as short branches in the DFS traversal tree. We use the tree to remove those vertices in the MAP-graph if those are shorter than prespecified length in the DFS tree. In general, the vertices in the principal bundle represent more sequences in the set of input sequences (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>) and are likely more conservative in the pangenome.</p>
      <p id="Par44">After removing the vertices corresponding to the short branches, we further remove vertices in the MAP-graph that have more than three out edges after converting the MAP-graph as an undirected graph. After such removal, the graph will only consist of simple paths, and we output those paths as the principal bundles.</p>
      <p id="Par45">In summary, here is the sketch of the algorithm:<list list-type="order"><list-item><p id="Par46">Build a DFS traversal tree with a deep first search for a given MAP-graph. To capture paths that are more conserved among the pangenome sequences of interest as the principal bundles, our DFS search prioritizes high-weight vertices when constructing the DFS traversal tree</p></list-item><list-item><p id="Par47">In MAP-graph, remove vertices that correspond to nodes in short branches of the DFS traversal tree</p></list-item><list-item><p id="Par48">Remove branching vertices in MAP-graph (by considering it as an undirected graph)</p></list-item><list-item><p id="Par49">Output the simple paths from the resulting graph as the principal bundles.</p></list-item></list></p>
    </sec>
    <sec id="Sec14">
      <title>Principal component plot for the HLA class II locus</title>
      <p id="Par50">To generate the principal component of the pangenome HLA class II sequences, we convert each of the haplotype sequences to a binary vector. The binary vector has the same length of the total number of vertices of all principal bundles. Let us call these vertices <italic>V</italic> = {<italic>v</italic><sub><italic>i</italic></sub>|<italic>v</italic><sub><italic>i</italic></sub> in principle bundles, <italic>i</italic> = 0<sub><italic>n</italic>−1</sub>}, where <italic>n</italic> is the total number of vertices in the principal bundles. For each sequence <italic>s</italic>, we construct a binary vector <italic>w</italic><sub><italic>s</italic></sub> = {<italic>b</italic><sub>0</sub>, <italic>b</italic><sub>1</sub>,…, <italic>b</italic><sub><italic>n</italic>−1</sub>} where <italic>b</italic><sub><italic>i</italic></sub> = 1 if the sequence <italic>s</italic> contains the vertex <italic>v</italic><sub><italic>i</italic></sub>, and <italic>b</italic><sub><italic>i</italic></sub> = 0 if not. Then, we perform the standard principal component transformation with the binary vectors of all sequences from the HLA class II region.</p>
    </sec>
    <sec id="Sec15">
      <title>General workflow for analyzing a region of interest</title>
      <p id="Par51">Here we outline the general workflow on how to use PGR-TK to generate MAP-graph and the principal bundle decomposition.<list list-type="order"><list-item><p id="Par52">For a region or sequences of interest, put the sequences as a fasta file for querying the PGR-TK pangenome sequence database. (PGR-TK provides a command line tool ‘pgr-fetch’ and python APIs to fetch such sequence from the PGR-TK sequence database.)</p></list-item><list-item><p id="Par53">Query the whole pangenome database to get initial hits that match the query sequence with the command line tool ‘pgr-query’ or using the Python APIs.</p></list-item><list-item><p id="Par54">Filter the hits to remove unwanted matches that do match a user’s analysis objectives. With the command line tool ‘pgr-query’, it generates a summary table of the hits for filtering.</p></list-item><list-item><p id="Par55">With the filtered sequences, using ‘pgr-pbundle-decomp’ command line tool to generate the MAP-graph in GFA format and principal bundle decomposition in the BED format. Beside analyzing the generated data, the generated bed file of the decomposition can be rendered by the pgr-pbundle-bed2svg to generate visualization. Python APIs are also provided for more scripting to resolve complicated analysis cases.</p></list-item><list-item><p id="Par56">Optionally, we can take the fetched sequences from ‘pgr-query’ to use with other third party tools, for example, calling variant with dipcall, create an MSA, or building other local pangenome graphs with minigraph or pggb.</p></list-item><list-item><p id="Par57">Re-adjust the parameters (<italic>w</italic>, <italic>k</italic>, <italic>r</italic>, min_span) and repeat (3) and (4) with additional analysis of the results if necessary.</p></list-item></list></p>
    </sec>
    <sec id="Sec16">
      <title>Building index</title>
      <p id="Par58">For a large sequence set, for example 47 whole-genome HPRC assemblies, PGR-TK uses the AGC format<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> to store the sequence efficiently. A command line tool ‘pgr-mdb’ is developed with the PGR-TK package to create the index file on top of the AGC file. For example, for a prebuild HPRC year one assembly AGC file (1.33 Gb), we create a file (/data/pgr-tk-HGRP-y1-evaluation-set-v0_input) include a file system path to the AGC file, /data/gr-tk-HGRP-y1-evaluation-set-v0.agc and call ‘pgr-mdb‘ to create the index files with a prespecified prefix (/data/pgr-tk-HGRP-y1-evaluation-set-v0):</p>
      <p id="Par59">
        <code>echo /data/pgr-tk-HGRP-y1-evaluation-set-v0.agc \&gt; /data/pgr-tk-HGRP-y1-evaluation-set-v0_input/code/pgr-mdb /data/pgr-tk-HGRP-y1-evaluation-set-v0_input \/data/pgr-tk-HGRP-y1-evaluation-set-v0</code>
      </p>
      <p id="Par60">Two files will be generated in this example</p>
      <p id="Par61">
        <code>/data/pgr-tk-HGRP-y1-evaluation-set-v0.mdb # 15 Gb for (w, k, r, min_span) = (80,56,4,64)/data/pgr-tk-HGRP-y1-evaluation-set-v0.midx # 3.1 Mb</code>
      </p>
      <p id="Par62">The index and sequence data can be loaded into a python workspace by</p>
      <p id="Par63">
        <code>import pgrtksdb = pgrtk.SeqIndexDB()sdb.load_from_agc_index(‘pgr-tk-HGRP-y1-evaluation-set-v0’)</code>
      </p>
      <p id="Par64">As the indexes are loaded into memory, we suggest using a computing instance that has a random access memory larger than about four times that of the index file to avoid swapping thrashing.</p>
      <p id="Par65">For smaller sequence files, the sequence database object (for example, the ‘sdb’ in the example above) created by pgrtk.SeqIndexDB()can create and load sequences using load_from_fastx() method. See the library documentation at <ext-link ext-link-type="uri" xlink:href="https://genedx.github.io/pgr-tk/">https://genedx.github.io/pgr-tk/</ext-link> for more detailed descriptions of all python objects, methods and functions in the PGR-TK package.</p>
    </sec>
    <sec id="Sec17">
      <title>Query sequence in the PGR-TK sequence database</title>
      <sec id="Sec18">
        <title>Command line example</title>
        <p id="Par66">A command line tool named pgr-query is provided to query a PGR-TK database with a set of sequences, each of which represents a region of interest. It is recommended to select regions larger than 20 kb, as they contain enough SHIMMER anchors. If smaller regions are of interest, padding with flanking sequences can improve the results.</p>
        <p id="Par67">The follow command shows an example querying the database: pgr-query /data/pgr-tk-HGRP-y1-evaluation-set-v0 ROI_seq.fa pg_seqs --merge-range-tol 100,000.</p>
        <p id="Par68">In this example, the ROI_seq.fa file contains sequences from the regions of interest. The pgr-query tool generates a set of fasta files with the prefix ‘pg_seqs’ for each query sequence in the ‘ROI_seq.fa’ file. Additionally, a ‘pg_seqs.hit’ file is produced, which contains information about the alignment range between the query and the results, as well as the number of anchors identified between each pair of query results. This information can be used to filter out unwanted alignments.</p>
      </sec>
      <sec id="Sec19">
        <title>Python API example</title>
        <p id="Par69">For finding homologous sequences in a PGR-TK database, we need to start with a query sequence. We can fetch a sequence in the database giving a known ‘data source’, ‘contig name’ tuple and the beginning and ending coordinates. As the SHIMMERs are sparsely distributed in a sequence, the query sequence should be long enough to cover enough minimizer anchors. The python statement shows a typical code fragment to generate query results of a region of interest:</p>
        <p id="Par70">
          <code>ref_file_name, roi_chr, roi_b, roi_e = ‘hg19_tagged.fa’, ‘chr6_hg19’, 32130918, 32959917padding = 10000#get a segment of a referenceroi_seq = ref_db.get_sub_seq(ref_file_name, roi_chr, roi_b-padding, roi_e+padding)# using the roi_seq to find hits in ‘sdb’aln_range = pgrtk.query_sdb(sdb, roi_seq, merge_range_tol=200000)</code>
        </p>
        <p id="Par71">The output aln_range from the query_sdb() call contains data of the hits in the PGR-TK database. Internally, the query_sdb() method performs:<list list-type="order"><list-item><p id="Par72">create SHIMMER pairs of the query sequence (2) use the SHIMMER pairs and the hashmap index to find all hits in the database</p></list-item><list-item><p id="Par73">perform sparse dynamic programming to find sparse alignments between the query sequence and all hits in the database</p></list-item><list-item><p id="Par74">merge the alignment segments if any of them are within the merge_range_tol parameter.</p></list-item></list></p>
        <p id="Par75">The parameter merge_range_tol is introduced to avoid alignment fragmentation when the query sequence contains a region of high polymorphism but we still want to fetch those diverse sequences for constructing the pangenomics graph.</p>
        <p id="Par76">Typically, a user needs to process the data in aln_range for different analysis. Our example Jupyter Notebooks provides various examples for processing the output to generate dot plot or MAP-graphs and so on.</p>
      </sec>
    </sec>
    <sec id="Sec20">
      <title>Build minimizer anchor pangenome graph and principal bundle decomposition</title>
      <sec id="Sec21">
        <title>Command line example</title>
        <p id="Par77">Given a set of sequence in a fasta file, for example, the query results from pgr-query command, we can build the pangenome graph and the principal bundle decomposition (outputted as a bed file) by</p>
        <p id="Par78">
          <code>pgr-pbundle-decomp -w 48 -k 56 -r 8 \--min-span 12 --bundle-length-cutoff 100 \--bundle-merge-distance 1000 --min-branch-size 8 \--min-cov 0 --include file_contain_contig_names \pgr-query pgr_out</code>
        </p>
        <p id="Par79">In the pangenome graph construction process, the following options can be used to control the graph construction: -w, -k, -r and --min-span. The --min-cov option sets the minimum coverage requirement for a vertex to be included in the principal bundle graph. The --min-branch-size option allows the user to filter out short branches that contain less than a specified number of vertices in the MAP-graph. The --bundle-length-cutoff option allows the user to exclude bundles shorter than the specified length. When two bundles have the same identifier and are within the distance specified by --bundle-merge-distance, they will be merged. If the --include option is specified, only those contigs specified in the file_contain_contig_names file will be analyzed.</p>
        <p id="Par80">The command generates a set of files with the prefix pgr_out:</p>
        <p id="Par81">
          <code>pgr_out.bed # the bed file contains the principal bundle decompositionpgr_out.ctg.summary.tsv # summary for bundle statistics for each contigpgr_out.mapg.gfa # MAP-graph in GFA formatpgr_out.mapg.idx # index for the sequence in the GFA filepgr_out.pmapg.gfa #principal bundle graph in the GFA format</code>
        </p>
        <p id="Par82">The pgr_out.bed has the following format. Each line is a bundle contain in a contig: contig_name begin_coordinate end_coordinate bundle_specification where the bundle_specification is six fields delimited by ‘:’. The fields are bundle identifier, bundle vertex count, orientation, begin vertex number, end vertex number, ‘R’ or ‘U’ for repetitive or unique in the contig. Note such a region in a contig may not only project to the full bundle. In such cases, end_vertex-bgn_vertex is less than bundle_vertex_count.</p>
        <p id="Par83">The *.mapg.idx file contains the information about each vertex in the .gfa files. It contains three kinds of tagged line starting with ‘K’, ‘C’ and ‘F’. The K line specifies the parameters used to generate the graph. The C lines specify the contigs contained in the graph. The F lines specify the fragment of sequences contained in each vertex. Here are the fields for echo of them: K line: <italic>w</italic>, <italic>k</italic>, <italic>r</italic>, min_span</p>
        <p id="Par84">S line: contig_identifer, contg_name, contig_source, contig_length</p>
        <p id="Par85">F line: frag_unique_identifier, frag_numeric_identifer, contig_identifer, start_coordinate, end_coordinate, orientation</p>
        <p id="Par86">Python API:</p>
        <p id="Par87">To build the MAP-graph and principal bundle decomposition within a python program, one can use the instance methods generate_mapg_gfa() and get_principal_bundle_decomposition() of an pgrtk.SeqIndexDB() object. Please read the documentation at <ext-link ext-link-type="uri" xlink:href="https://genedx.github.io/pgr-tk/">https://genedx.github.io/pgr-tk/</ext-link> for the API details.</p>
      </sec>
    </sec>
    <sec id="Sec22">
      <title>Clustering principal bundle decomposition structure</title>
      <p id="Par88">The follow command performs clustering of the principal bundles stored in a bed file: pgr-pbundle-bed2dist pgr_out.bed pgr_out.</p>
      <p id="Par89">It will generate these output files: pgr_out.dist # all pairwise distance</p>
      <p id="Par90">
        <code>pgr_out.nwk # a hierarchical tree in Newick formatpgr_out.ddg # a file contain the dendrogram for the pgr-pbundle-bed2svg to draw the dendrogram panel</code>
      </p>
    </sec>
    <sec id="Sec23">
      <title>Generate principal bundle decomposition plot in scalable vector graph format</title>
      <p id="Par91">The following is an example to generate a SVG file pgr_out.svg from pgr_out.bed that layout 500,000 bp with annotation specified in a file called pgr_annotation with a dendrogram panel on the left from the pgr_out.ddg dendrogram data</p>
      <p id="Par92">
        <code>/code/pgr-pbundle-bed2svg pgr_out.bed pgr_out \--track-range 500000 --track-tick-interval 100000 \--track-panel-width 1200 --stroke-width 0.5 \--annotations pgr_annotation \--ddg-file pgr_out.ddg \--highlight-repeats 3</code>
      </p>
    </sec>
    <sec id="Sec24">
      <title>Survey on the genome in bottle challenging clinical and medically relevant genes with the MAP-graphs</title>
      <p id="Par93">The GIAB Consortium provides variant call benchmarks on seven benchmark genomes<sup><xref ref-type="bibr" rid="CR35">35</xref>,<xref ref-type="bibr" rid="CR61">61</xref>,<xref ref-type="bibr" rid="CR62">62</xref></sup>. These benchmarks were initially formed by integrating multiple short-read technologies, but the latest version integrated linked-read and long-read technologies to form benchmarks in regions difficult to map with short reads. However, a set of 395 challenging but medically relevant genes were identified as substantially (more than 10%) excluded from the mapping-based benchmark due to long repeats, large structural variations, segmental duplications and/or high polymorphism between the benchmark genome HG002 and the reference genome hg19 or GRCh38. A long-read genome assembly approach provided a reliable benchmark call set of 273 out of the 395 genes<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. The remaining 122 were still excluded mainly because they were not accurately assembled, or no benchmarking tools exist to compare different representations of complex variants in the genes. Overall, 395 genes have recently shown to include high levels of polymorphism across different ethnicities making it highly challenging to represent their variations<sup><xref ref-type="bibr" rid="CR63">63</xref></sup>.</p>
      <p id="Par94">The current GIAB variant benchmarks focus on a small set of seven well-characterized genomes with extensive short-, linked- and long-read data to ensure robust benchmarks and more tractable method development and benchmark evaluations. Meanwhile, a limited representation of genomes in a population may miss significant structural variants, additional copies of genes and context for important variants for diseases not observed in a smaller dataset. Given that increasingly accurate long-read and assembly level data are being produced at pangenome scales now, we are surveying how we can use such resources to benchmark variant accuracy at a broader population level for the challenging CMRG. Such pangenome analysis will help to generate guidelines for future practice.</p>
      <p id="Par95">With PGR-TK, we extract all sequences from the HPRC year one release (94 haplotype assemblies), and CHM13 v.1.1, GRCh38 and hg19 of all 385 CMRG. We generate a MAP-graph of each gene and output this in GFA format. For each graph, we derived two metrics to estimate (1) the degree of polymorphism among the pangenomes, and (2) the repeat content taking account of the variations of the pangenomes.</p>
      <p id="Par96">To estimate the degree of polymorphism, we consider a diffusion process in the graph (below) and derive an entropy-like quantity from a normalized equilibrium distribution. The higher entropy values indicate more complicated graphs likely from the polymorphism from different genomes. The diffusion weight on each vertex is also associated with multiplicity and repetitiveness of the corresponding segments in the pangenomes. We pick the average of the top 32 diffusion weights from the MAP-graph of each gene as a simple metric to measure the most challenging repeat content within a gene.</p>
      <p id="Par97">To gain insight about the challenge for calling variants of the CMRG set at a pangenome scale, we plot the diffusion entropy versus the maximum local repeat weights for each gene (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). As there are no obvious correlations, these two quantities provide independent measurements of two aspects of the MAP-graph structures of these genes. We find high repetitive genes are harder to create a reliable variant benchmark call set for. Many highly repetitive genes are excluded from the current CMRG benchmark set. We do not observe that higher entropy is correlated with the reduction of the gene in the benchmark set.</p>
      <p id="Par98">We highlight several genes with high entropy or high repetitiveness. The MAP-graphs and the Integrative Genomics Viewer view of the pangenome assemblies of a selected set genes (<italic>LMF1</italic>, <italic>ANKRD11</italic>, <italic>SRGAP2</italic>, <italic>KMT2C</italic>, <italic>LPA</italic>, <italic>MUC4</italic>, <italic>MUC3A</italic>, <italic>KATNAL2</italic>, <italic>FLG</italic>) aligned to GRCh38 are shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>. In the Integrative Genomics Viewer view of <italic>LMF1</italic> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4a</xref>), several variation hotspots are visible and may correspond to localized structural variants. This serves as a simple example to examine the concordance of structural variation in the population and the principal bundle decomposition. We use PAV<sup><xref ref-type="bibr" rid="CR64">64</xref></sup> to call structural variants for comparison. In Supplementary Fig. <xref rid="MOESM1" ref-type="media">4b</xref>, the structural variant calls resulting from PAV are provided as an auxiliary track (black) below the principal bundle decomposition tracks for a selected set of HPRC year one genomes, where both haplotypes are resolved in the region. It is evident that the structural variation calls correspond to the regions where principal bundles have complex structure and are distinct from the reference genome GRCh38 (the top track). As shown in <italic>LPA</italic> (associated with coronary disease<sup><xref ref-type="bibr" rid="CR65">65</xref></sup>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>), <italic>KATNAL2</italic> (loss of function variant discovered in autistic proband<sup><xref ref-type="bibr" rid="CR66">66</xref>,<xref ref-type="bibr" rid="CR67">67</xref></sup>) also has long tandem repeat variations in the HPRC pangenome cohort. We find the number of the 5.8 kbp repeats inside <italic>KATNAL2</italic> ranges from 3 to 25 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>). Applying MAP-graph decomposition on genes such as <italic>KATNAL2</italic> with a big pangenome reference panel will provide additional insights to the natural of the variability of the repetitiveness and its effects on the underlying biology like other, more well-studied genes, for example, <italic>LPA</italic>, in the coming years.</p>
    </sec>
    <sec id="Sec25">
      <title>Compute graph diffusion entropy and max repetitive weight</title>
      <p id="Par99">It would be desirable to derive quantitative measurements so we can characterize a set of large numbers of MAP-graphs fast. One thing we are interested in quantifying is how complex a graph is. The intuition is that if a region of the genome is more polymorphic in the population, the graph will have more alternative paths, or bubbles. We like to generate a quantity as a proxy for that. For this, we borrow the idea from network science study and spectral graph theory to consider a diffusion/random walk process on a graph<sup><xref ref-type="bibr" rid="CR68">68</xref></sup>. For a graph, we consider a set of random walkers starting at each vertex. The random walkers can drift on the graph through the edge-connection. We can consider the distribution of the random walkers in the final equilibrium state. If a graph is relatively simple, then the final distribution will be uniform (subject to minor boundary condition corrections). On the other hand, if the weights of the vertices or topology of the graph are more complex, we would expect the final distribution of the walkers would be less uniform and reflect the complicated nature of the graph.</p>
      <p id="Par100">The final distribution of the such diffusion process can be obtained by simple matrix multiplication iteration from the adjacent matrix of a MAP-graph. Given an adjacency matrix <italic>A</italic>, where the matrix element <italic>A</italic><sub><italic>ij</italic></sub> is the number of sequences supports edge from <italic>v</italic><sub><italic>i</italic></sub> to <italic>v</italic><sub><italic>j</italic></sub>. The final distribution <italic>P</italic> can be written as <italic>P</italic> = (1/<italic>N</italic>) lim<sub><italic>n</italic>→∞</sub>
<italic>M</italic><sup><italic>n</italic></sup>
<bold>1</bold>, where <italic>M</italic> = <italic>AD</italic><sup>−1</sup>, <italic>D</italic> is the degree matrix defined as <italic>D</italic><sub><italic>ii</italic></sub> being the degree of vertex <italic>v</italic><sub><italic>i</italic></sub> and <italic>D</italic><sub><italic>ij</italic></sub> = 0 if <italic>i</italic> ≠ <italic>j</italic>, <italic>N</italic> is the total number of vertices and <bold>1</bold> is a column vector in which every element is one. (When we compute <italic>P</italic>, we only repeat the number of multiplications <italic>N</italic> times to approximate the final distribution.)</p>
      <p id="Par101"><bold>P</bold> is a normalized column vector [<italic>p</italic><sub>0</sub>, <italic>p</italic><sub>1</sub>,…,<italic>p</italic><sub><italic>n</italic>−</sub><sub>1</sub>]<sup><italic>T</italic></sup> such that ∑<sub><italic>i</italic>=0…<italic>n</italic>−1</sub><italic>p</italic><sub><italic>i</italic></sub> = 1 (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">4a</xref> for an example). The diffusion entropy used in this work is defined as <italic>S</italic> = −∑<sub><italic>i</italic>=0…<italic>n</italic>−</sub><sub>1</sub>
<italic>p</italic><sub><italic>i</italic></sub> log<sub>2</sub>(<italic>p</italic><sub><italic>i</italic></sub>).</p>
      <p id="Par102">To find the highly repetitive elements inside a region of interest, we look into largest elements in the unnormalized vector <italic>N</italic><bold>P</bold> as a proxy of average number of repeats considering the graph structure. We pick the top 32 elements in <italic>N</italic><bold>P</bold> and use the average of those as a proxy number to estimate the repetitiveness of potential repeat units inside a region of interest.</p>
    </sec>
    <sec id="Sec26">
      <title>Reporting summary</title>
      <p id="Par103">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec id="Sec27" sec-type="materials|methods">
    <title>Online content</title>
    <p id="Par104">Any methods, additional references, Nature Portfolio reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at 10.1038/s41592-023-01914-y.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec28">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41592_2023_1914_MOESM1_ESM.pdf">
            <label>Supplementary Information</label>
            <caption>
              <p>Supplementary Tables 1–6 and Figs. 1–8.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41592_2023_1914_MOESM2_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41592-023-01914-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank B. Mishra for reading and commenting on the draft of the manuscript. Certain commercial equipment, instruments or materials are identified to specify adequately experimental conditions or reported results. Such identification does not imply recommendation or endorsement by the National Institute of Standards and Technology, nor does it imply that the equipment, instruments or materials identified are necessarily the best available for the purpose. F.J.S. and S.B. are supported by National Institutes of Health grants (nos. UM1HG008898 and 1U01HG011758-01). P.S. is supported by an National Institutes of Health/National Institute of General Medical Sciences grant (no. R35GM142916).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Conceptualization and design were done by C.-S.C., A.K., F.J.S., P.H.S., J.W. and J.M.Z. Algorithm, code and documentation development were done using PGR-TK by C.-S.C. The manuscript was written by C.-S.C., A.K., F.J.S. and J.M.Z. Manuscript revision, data management and code validation were carried out by S.B., F.J.S., P.H.S. and J.W.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par105"><italic>Nature Methods</italic> thanks Bjarni Halldorsson and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Primary Handling Editor: Lin Tang, in collaboration with the <italic>Nature Methods</italic> team.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The HPRC year one release sequence and prebuilt index: <ext-link ext-link-type="uri" xlink:href="https://giab-data.s3.amazonaws.com/PGR-TK-Files/pgr-tk-HGRP-y1-evaluation-set-v0.tar">https://giab-data.s3.amazonaws.com/PGR-TK-Files/pgr-tk-HGRP-y1-evaluation-set-v0.tar</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/journal_contribution/HPRC-Y1-sequence-data_zip/22584403">https://figshare.com/articles/journal_contribution/HPRC-Y1-sequence-data_zip/22584403</ext-link> (10.6084/m9.figshare.22584403). Scripts and source data URLs for constructing the HPRC AGC file: <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDX/pgr-tk-notebooks/tree/main/pgr-tk-sequence-source">https://github.com/GeneDX/pgr-tk-notebooks/tree/main/pgr-tk-sequence-source.</ext-link> All GFA files, fetched sequences from HPRC year one release of the 385 CMRG: <ext-link ext-link-type="uri" xlink:href="https://giab-data.s3.amazonaws.com/PGR-TK-Files/CMRG_output_dir_v0.3.3.tar">https://giab-data.s3.amazonaws.com/PGR-TK-Files/CMRG_output_dir_v0.3.3.tar</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The code of the PGR-TK is hosted in a GitHub repository, <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDX/pgr-tk">https://github.com/GeneDX/pgr-tk</ext-link>, and the code can be obtained using the standard ‘git clone’ command. Follow the README.md document for building the PGR-TK. A document for Python API is provided at <ext-link ext-link-type="uri" xlink:href="https://genedx.github.io/pgr-tk/">https://genedx.github.io/pgr-tk/</ext-link>. The source code for the v.0.4.1 version is also hosted at <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/journal_contribution/pgr-tk-0_4_1_zip/22584793">https://figshare.com/articles/journal_contribution/pgr-tk-0_4_1_zip/22584793</ext-link> (10.6084/m9.figshare.22584793). Prebuilt binaries for Linux Ubuntu distribution 22.04 can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDX/pgr-tk/releases/tag/v0.4.1">https://github.com/GeneDX/pgr-tk/releases/tag/v0.4.1</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/journal_contribution/pgr-bin-pacakge-v0_4_1_tgz/22584787">https://figshare.com/articles/journal_contribution/pgr-bin-pacakge-v0_4_1_tgz/22584787</ext-link> (10.6084/m9.figshare.22584787). Example Notebooks using PGR-TK including code making most of (the source of) the plots in this paper can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDX/pgr-tk-notebooks">https://github.com/GeneDX/pgr-tk-notebooks</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/journal_contribution/scripts_and_artifects_zip/22584118">https://figshare.com/articles/journal_contribution/scripts_and_artifects_zip/22584118</ext-link> (10.6084/m9.figshare.22584118) Additional information about a docker image with prebuilt PGR-TK library and Jupyter Laboratory Server and usage is at <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDX/pgr-tk/blob/main/pgr-tk-workstation/Readme.md">https://github.com/GeneDX/pgr-tk/blob/main/pgr-tk-workstation/Readme.md</ext-link>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par106">C.-S.C. is an employee and shareholder of GeneDX. F.J.S. obtains research support from Illumina, PacBio and Oxford Nanopore. The remaining authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Initial sequencing and analysis of the human genome</article-title>
        <source>Nature</source>
        <year>2001</year>
        <volume>409</volume>
        <fpage>860</fpage>
        <lpage>921</lpage>
        <pub-id pub-id-type="doi">10.1038/35057062</pub-id>
        <?supplied-pmid 11237011?>
        <pub-id pub-id-type="pmid">11237011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venter</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence of the human genome</article-title>
        <source>Science</source>
        <year>2001</year>
        <volume>291</volume>
        <fpage>1304</fpage>
        <lpage>1351</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1058040</pub-id>
        <?supplied-pmid 11181995?>
        <pub-id pub-id-type="pmid">11181995</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The complete sequence of a human genome</article-title>
        <source>Science</source>
        <year>2022</year>
        <volume>376</volume>
        <fpage>44</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1126/science.abj6987</pub-id>
        <?supplied-pmid 35357919?>
        <pub-id pub-id-type="pmid">35357919</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Siva</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>1000 Genomes project</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>256</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt0308-256b</pub-id>
        <?supplied-pmid 18327223?>
        <pub-id pub-id-type="pmid">18327223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Canela-Xandri</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Rawlik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tenesa</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>An atlas of genetic associations in UK Biobank</article-title>
        <source>Nat. Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>1593</fpage>
        <lpage>1599</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0248-z</pub-id>
        <?supplied-pmid 30349118?>
        <pub-id pub-id-type="pmid">30349118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bycroft</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UK Biobank resource with deep phenotyping and genomic data</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <fpage>203</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0579-z</pub-id>
        <?supplied-pmid 30305743?>
        <pub-id pub-id-type="pmid">30305743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">The ‘All of Us’ Research Program Investigators. The ‘All of Us’ Research Program. <italic>N. Engl. J. Med</italic>. <bold>381</bold>, 668–676 (2019).</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Voelkerding</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Dames</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Durtschi</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Next-generation sequencing: from basic research to diagnostics</article-title>
        <source>Clin. Chem.</source>
        <year>2009</year>
        <volume>55</volume>
        <fpage>641</fpage>
        <lpage>658</lpage>
        <pub-id pub-id-type="doi">10.1373/clinchem.2008.112789</pub-id>
        <?supplied-pmid 19246620?>
        <pub-id pub-id-type="pmid">19246620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rehder</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation sequencing for constitutional variants in the clinical laboratory, 2021 revision: a technical standard of the American College of Medical Genetics and Genomics (ACMG)</article-title>
        <source>Genet. Med.</source>
        <year>2021</year>
        <volume>23</volume>
        <fpage>1399</fpage>
        <lpage>1415</lpage>
        <pub-id pub-id-type="doi">10.1038/s41436-021-01139-4</pub-id>
        <?supplied-pmid 33927380?>
        <pub-id pub-id-type="pmid">33927380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yohe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Thyagarajan</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Review of clinical next-generation sequencing</article-title>
        <source>Arch. Pathol. Lab. Med.</source>
        <year>2017</year>
        <volume>141</volume>
        <fpage>1544</fpage>
        <lpage>1557</lpage>
        <pub-id pub-id-type="doi">10.5858/arpa.2016-0501-RA</pub-id>
        <?supplied-pmid 28782984?>
        <pub-id pub-id-type="pmid">28782984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Green</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>MV</given-names>
          </name>
        </person-group>
        <article-title>The future of DNA sequencing</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>550</volume>
        <fpage>179</fpage>
        <lpage>181</lpage>
        <pub-id pub-id-type="doi">10.1038/550179a</pub-id>
        <?supplied-pmid 29022931?>
        <pub-id pub-id-type="pmid">29022931</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mahmoud</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structural variant calling: the long and the short of it</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>246</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1828-7</pub-id>
        <?supplied-pmid 31747936?>
        <pub-id pub-id-type="pmid">31747936</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Darby</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Piercing the dark matter: bioinformatics of long-range sequencing and mapping</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>329</fpage>
        <lpage>346</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-018-0003-4</pub-id>
        <?supplied-pmid 29599501?>
        <pub-id pub-id-type="pmid">29599501</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Coster</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Weissensteiner</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Towards population-scale long-read sequencing</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>572</fpage>
        <lpage>587</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-021-00367-3</pub-id>
        <?supplied-pmid 34050336?>
        <pub-id pub-id-type="pmid">34050336</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olson</surname>
            <given-names>ND</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PrecisionFDA Truth Challenge V2: calling variants from short and long reads in difficult-to-map regions</article-title>
        <source>Cell Genom.</source>
        <year>2022</year>
        <volume>2</volume>
        <fpage>100129</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100129</pub-id>
        <?supplied-pmid 35720974?>
        <pub-id pub-id-type="pmid">35720974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aganezov</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A complete reference genome improves analysis of human genetic variation</article-title>
        <source>Science</source>
        <year>2022</year>
        <volume>376</volume>
        <fpage>eabl3533</fpage>
        <pub-id pub-id-type="doi">10.1126/science.abl3533</pub-id>
        <?supplied-pmid 35357935?>
        <pub-id pub-id-type="pmid">35357935</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Human Pangenome Project: a global resource to map genomic diversity</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>604</volume>
        <fpage>437</fpage>
        <lpage>446</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-04601-8</pub-id>
        <?supplied-pmid 35444317?>
        <pub-id pub-id-type="pmid">35444317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sir‚n</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pangenomics enables genotyping of known structural variants in 5202 diverse genomes</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>374</volume>
        <fpage>abg8871</fpage>
        <pub-id pub-id-type="doi">10.1126/science.abg8871</pub-id>
        <pub-id pub-id-type="pmid">34914532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>W-W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A draft human pangenome reference</article-title>
        <source>Nature</source>
        <year>2023</year>
        <volume>617</volume>
        <fpage>312</fpage>
        <lpage>324</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-023-05896-x</pub-id>
        <?supplied-pmid 37165242?>
        <pub-id pub-id-type="pmid">37165242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jarvis</surname>
            <given-names>ED</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Semi-automated assembly of high-quality diploid human reference genomes</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>611</volume>
        <fpage>519</fpage>
        <lpage>531</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-05325-5</pub-id>
        <?supplied-pmid 36261518?>
        <pub-id pub-id-type="pmid">36261518</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Ferragina, P. &amp; Mishra, B. Algorithms in stringomics (I): pattern-matching against ‘stringomes’. Preprint at <italic>bioRxiv</italic>10.1101/001669 (2014).</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garrison</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Guarracino</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Unbiased pangenome graphs</article-title>
        <source>Bioinformatics</source>
        <year>2023</year>
        <volume>39</volume>
        <fpage>btac743</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac743</pub-id>
        <?supplied-pmid 36448683?>
        <pub-id pub-id-type="pmid">36448683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eizenga</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pangenome graphs</article-title>
        <source>Annu. Rev. Genom. Hum. Genet.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>139</fpage>
        <lpage>162</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-genom-120219-080406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>The design and construction of reference pangenome graphs with minigraph</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>265</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02168-z</pub-id>
        <?supplied-pmid 33066802?>
        <pub-id pub-id-type="pmid">33066802</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cactus graphs for genome comparisons</article-title>
        <source>J. Comput. Biol.</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>469</fpage>
        <lpage>481</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2010.0252</pub-id>
        <?supplied-pmid 21385048?>
        <pub-id pub-id-type="pmid">21385048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ebler</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pangenome-based genome inference allows efficient and accurate genotyping across a wide spectrum of variant classes</article-title>
        <source>Nat. Genet.</source>
        <year>2022</year>
        <volume>54</volume>
        <fpage>518</fpage>
        <lpage>525</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-022-01043-w</pub-id>
        <?supplied-pmid 35410384?>
        <pub-id pub-id-type="pmid">35410384</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garrison</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Variation graph toolkit improves read mapping by representing genetic variation in the reference</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>875</fpage>
        <lpage>879</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4227</pub-id>
        <?supplied-pmid 30125266?>
        <pub-id pub-id-type="pmid">30125266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Computational Pan-Genomics Consortium.</collab>
        </person-group>
        <article-title>Computational pan-genomics: status, promises and challenges</article-title>
        <source>Brief. Bioinform.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>118</fpage>
        <lpage>135</lpage>
        <pub-id pub-id-type="pmid">27769991</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hickey</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genotyping structural variants in pangenome graphs using the vg toolkit</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>35</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-1941-7</pub-id>
        <?supplied-pmid 32051000?>
        <pub-id pub-id-type="pmid">32051000</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Armstrong</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Progressive Cactus is a multiple-genome aligner for the thousand-genome era</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>587</volume>
        <fpage>246</fpage>
        <lpage>251</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2871-y</pub-id>
        <?supplied-pmid 33177663?>
        <pub-id pub-id-type="pmid">33177663</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beller</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ohlebusch</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>A representation of a compressed de Bruijn graph for pan-genome analysis that enables search</article-title>
        <source>Algorithms Mol. Biol.</source>
        <year>2016</year>
        <volume>11</volume>
        <fpage>20</fpage>
        <pub-id pub-id-type="doi">10.1186/s13015-016-0083-7</pub-id>
        <?supplied-pmid 27437028?>
        <pub-id pub-id-type="pmid">27437028</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darling</surname>
            <given-names>ACE</given-names>
          </name>
          <name>
            <surname>Mau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Blattner</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Perna</surname>
            <given-names>NT</given-names>
          </name>
        </person-group>
        <article-title>Mauve: multiple alignment of conserved genomic sequence with rearrangements</article-title>
        <source>Genome Res.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>1394</fpage>
        <lpage>1403</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.2289704</pub-id>
        <?supplied-pmid 15231754?>
        <pub-id pub-id-type="pmid">15231754</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guarracino</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Heumos</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nahnsen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Prins</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Garrison</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>ODGI: understanding pangenome graphs</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>3319</fpage>
        <lpage>3326</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac308</pub-id>
        <?supplied-pmid 35552372?>
        <pub-id pub-id-type="pmid">35552372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chin</surname>
            <given-names>C-S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A diploid assembly-based benchmark for variants in the major histocompatibility complex</article-title>
        <source>Nat. Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>4794</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-18564-9</pub-id>
        <?supplied-pmid 32963235?>
        <pub-id pub-id-type="pmid">32963235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Curated variation benchmarks for challenging medically relevant autosomal genes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>672</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-01158-1</pub-id>
        <?supplied-pmid 35132260?>
        <pub-id pub-id-type="pmid">35132260</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bhowmick</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Satta</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Takahata</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>The origin and evolution of human ampliconic gene families and ampliconic structure</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>441</fpage>
        <lpage>450</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.5734907</pub-id>
        <?supplied-pmid 17185645?>
        <pub-id pub-id-type="pmid">17185645</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zook</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A robust benchmark for detection of germline large deletions and insertions</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>1347</fpage>
        <lpage>1355</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0538-8</pub-id>
        <?supplied-pmid 32541955?>
        <pub-id pub-id-type="pmid">32541955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Cody, S. Year 1 Sequencing data release. <italic>Human Pangenome Reference Consortium</italic><ext-link ext-link-type="uri" xlink:href="https://humanpangenome.org/year-1-sequencing-data-release/">https://humanpangenome.org/year-1-sequencing-data-release/</ext-link> (2021).</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Chin, C.-S. &amp; Khalak, A. Human genome assembly in 100 minutes. Preprint at <italic>bioRxiv</italic>10.1101/705616 (2019).</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ekim</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chikhi</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Minimizer-space de Bruijn graphs: whole-genome assembly of long reads in minutes on a personal computer</article-title>
        <source>Cell Syst.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>958</fpage>
        <lpage>968.e6</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2021.08.009</pub-id>
        <?supplied-pmid 34525345?>
        <pub-id pub-id-type="pmid">34525345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap and miniasm: fast mapping and de novo assembly for noisy long sequences</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>2103</fpage>
        <lpage>2110</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw152</pub-id>
        <?supplied-pmid 27153593?>
        <pub-id pub-id-type="pmid">27153593</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>De novo repeat classification and fragment assembly</article-title>
        <source>Genome Res.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>1786</fpage>
        <lpage>1796</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.2395204</pub-id>
        <?supplied-pmid 15342561?>
        <pub-id pub-id-type="pmid">15342561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ancestral reconstruction of segmental duplications reveals punctuated cores of human genome evolution</article-title>
        <source>Nat. Genet.</source>
        <year>2007</year>
        <volume>39</volume>
        <fpage>1361</fpage>
        <lpage>1368</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2007.9</pub-id>
        <?supplied-pmid 17922013?>
        <pub-id pub-id-type="pmid">17922013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A de Bruijn graph approach to the quantification of closely-related genomes in a microbial community</article-title>
        <source>J. Computat. Biol.</source>
        <year>2012</year>
        <volume>19</volume>
        <fpage>814</fpage>
        <lpage>825</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2012.0058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Detection and analysis of ancient segmental duplications in mammalian genomes</article-title>
        <source>Genome Res.</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>901</fpage>
        <lpage>909</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.228718.117</pub-id>
        <?supplied-pmid 29735604?>
        <pub-id pub-id-type="pmid">29735604</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Danek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>AGC: compact representation of assembled genomes</article-title>
        <source>Bioinformatics</source>
        <year>2023</year>
        <volume>39</volume>
        <fpage>btad097</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btad097</pub-id>
        <?supplied-pmid 36864624?>
        <pub-id pub-id-type="pmid">36864624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Project jupyter (Jupyter, 2023); <ext-link ext-link-type="uri" xlink:href="https://jupyter.org">https://jupyter.org</ext-link></mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Yorke</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Reducing storage requirements for biological sequence comparison</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>3363</fpage>
        <lpage>3369</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth408</pub-id>
        <?supplied-pmid 15256412?>
        <pub-id pub-id-type="pmid">15256412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ondov</surname>
            <given-names>BD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>132</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0997-x</pub-id>
        <?supplied-pmid 27323842?>
        <pub-id pub-id-type="pmid">27323842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibbs</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>McIntyre</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>The diagram, a method for comparing sequences. Its use with amino acid and nucleotide sequences</article-title>
        <source>Eur. J. Biochem.</source>
        <year>1970</year>
        <volume>16</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1432-1033.1970.tb01046.x</pub-id>
        <?supplied-pmid 5456129?>
        <pub-id pub-id-type="pmid">5456129</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kececioglu</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Combinatorial algorithms for DNA sequence assembly</article-title>
        <source>Algorithmica</source>
        <year>1995</year>
        <volume>13</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1007/BF01188580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>The fragment assembly string graph</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>ii79</fpage>
        <lpage>ii85</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti1114</pub-id>
        <?supplied-pmid 16204131?>
        <pub-id pub-id-type="pmid">16204131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trowsdale</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Major Histocompatibility Complex genomics and human disease</article-title>
        <source>Annu. Rev. Genomics Hum. Genet.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>301</fpage>
        <lpage>323</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-genom-091212-153455</pub-id>
        <?supplied-pmid 23875801?>
        <pub-id pub-id-type="pmid">23875801</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vandiedonck</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>The human Major Histocompatibility Complex as a paradigm in genomics research</article-title>
        <source>Brief. Funct. Genomics Proteom.</source>
        <year>2009</year>
        <volume>8</volume>
        <fpage>379</fpage>
        <lpage>394</lpage>
        <pub-id pub-id-type="doi">10.1093/bfgp/elp010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horton</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Variation analysis and gene annotation of eight MHC haplotypes: the MHC Haplotype Project</article-title>
        <source>Immunogenetics</source>
        <year>2008</year>
        <volume>60</volume>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1007/s00251-007-0262-2</pub-id>
        <?supplied-pmid 18193213?>
        <pub-id pub-id-type="pmid">18193213</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Michaelides</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hardcastle</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Cone opsins, colour blindness and cone dystrophy: genotype-phenotype correlations</article-title>
        <source>S. Afr. Med. J.</source>
        <year>2016</year>
        <volume>106</volume>
        <fpage>S75</fpage>
        <lpage>S78</lpage>
        <pub-id pub-id-type="doi">10.7196/SAMJ.2016.v106i6.11001</pub-id>
        <?supplied-pmid 27245533?>
        <pub-id pub-id-type="pmid">27245533</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moro</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Male infertility caused by a de novo partial deletion of the DAZ cluster on the Y Chromosome1</article-title>
        <source>J. Clin. Endocrinol. Metab.</source>
        <year>2000</year>
        <volume>85</volume>
        <fpage>4069</fpage>
        <lpage>4073</lpage>
        <?supplied-pmid 11095434?>
        <pub-id pub-id-type="pmid">11095434</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">lh3/dipcall. <italic>GitHub</italic><ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/dipcall">https://github.com/lh3/dipcall</ext-link> (2021).</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>X-linked cone dystrophy caused by mutation of the red and green cone opsins</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2010</year>
        <volume>87</volume>
        <fpage>26</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2010.05.019</pub-id>
        <?supplied-pmid 20579627?>
        <pub-id pub-id-type="pmid">20579627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Skiena, S. S. <italic>The Algorithm Design Manual</italic> (Springer, 2008).</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zook</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Salit</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Advancing benchmarks for genome sequencing</article-title>
        <source>Cell Syst.</source>
        <year>2015</year>
        <volume>1</volume>
        <fpage>176</fpage>
        <lpage>177</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2015.09.004</pub-id>
        <?supplied-pmid 27135909?>
        <pub-id pub-id-type="pmid">27135909</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Benchmarking challenging small variants with linked and long reads</article-title>
        <source>Cell Genom.</source>
        <year>2022</year>
        <volume>2</volume>
        <fpage>100128</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100128</pub-id>
        <?supplied-pmid 36452119?>
        <pub-id pub-id-type="pmid">36452119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <mixed-citation publication-type="other">Ji, Y., Gong, J., Sedlazeck, F. J. &amp; Fan, S. Characterizing the genetic polymorphisms in 370 challenging medically relevant genes using long-read sequencing data from 41 human individuals among 19 global populations. Preprint at <italic>bioRxiv</italic>10.1101/2022.08.03.502734 (2022).</mixed-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ebert</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype-resolved diverse human genomes and integrated analysis of structural variation</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>372</volume>
        <fpage>eabf7117</fpage>
        <pub-id pub-id-type="doi">10.1126/science.abf7117</pub-id>
        <?supplied-pmid 33632895?>
        <pub-id pub-id-type="pmid">33632895</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burgess</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Association of LPA variants with risk of coronary disease and the implications for lipoprotein(a)-lowering therapies: a Mendelian randomization analysis</article-title>
        <source>J. Am. Med. Assoc. Cardiol.</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>619</fpage>
        <lpage>627</lpage>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanders</surname>
            <given-names>SJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo mutations revealed by whole-exome sequencing are strongly associated with autism</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <fpage>237</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10945</pub-id>
        <?supplied-pmid 22495306?>
        <pub-id pub-id-type="pmid">22495306</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Roak</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sporadic autism exomes reveal a highly interconnected protein network of de novo mutations</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <fpage>246</fpage>
        <lpage>250</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10989</pub-id>
        <?supplied-pmid 22495309?>
        <pub-id pub-id-type="pmid">22495309</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <mixed-citation publication-type="other">Spielman, D. A. Spectral graph theory and its applications. in <italic>Proc.</italic><italic>48th Annual IEEE Symposium on Foundations of Computer Science (FOCS’07)</italic> 29–38 (IEEE, 2007).</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature Methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
    <publisher>
      <publisher-name>Nature Publishing Group US</publisher-name>
      <publisher-loc>New York</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10406601</article-id>
    <article-id pub-id-type="pmid">37365340</article-id>
    <article-id pub-id-type="publisher-id">1914</article-id>
    <article-id pub-id-type="doi">10.1038/s41592-023-01914-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Multiscale analysis of pangenomes enables improved representation of genomic diversity for repetitive and clinically relevant genes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4394-2455</contrib-id>
        <name>
          <surname>Chin</surname>
          <given-names>Chen-Shan</given-names>
        </name>
        <address>
          <email>jchin@genedx.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9047-0203</contrib-id>
        <name>
          <surname>Behera</surname>
          <given-names>Sairam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0009-0005-5751-5245</contrib-id>
        <name>
          <surname>Khalak</surname>
          <given-names>Asif</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6040-2691</contrib-id>
        <name>
          <surname>Sedlazeck</surname>
          <given-names>Fritz J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9573-8248</contrib-id>
        <name>
          <surname>Sudmant</surname>
          <given-names>Peter H.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wagner</surname>
          <given-names>Justin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2309-8402</contrib-id>
        <name>
          <surname>Zook</surname>
          <given-names>Justin M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>GeneDX, Stamford, CT USA </aff>
      <aff id="Aff2"><label>2</label>Foundation of Biological Data Science, Belmont, CA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.39382.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2160 926X</institution-id><institution>Human Genome Sequencing Center, </institution><institution>Baylor College of Medicine, </institution></institution-wrap>Houston, TX USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.21940.3e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8278</institution-id><institution>Department of Computer Science, </institution><institution>Rice University, </institution></institution-wrap>Houston, TX USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.47840.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 2181 7878</institution-id><institution>Department of Integrative Biology, </institution><institution>University of California Berkeley, </institution></institution-wrap>Berkeley, CA USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.94225.38</institution-id><institution-id institution-id-type="ISNI">000000012158463X</institution-id><institution>Material Measurement Laboratory, </institution><institution>National Institute of Standards and Technology, </institution></institution-wrap>Gaithersburg, MD USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2023</year>
    </pub-date>
    <volume>20</volume>
    <issue>8</issue>
    <fpage>1213</fpage>
    <lpage>1221</lpage>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s), under exclusive licence to Springer Nature America, Inc. 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Advancements in sequencing technologies and assembly methods enable the regular production of high-quality genome assemblies characterizing complex regions. However, challenges remain in efficiently interpreting variation at various scales, from smaller tandem repeats to megabase rearrangements, across many human genomes. We present a PanGenome Research Tool Kit (PGR-TK) enabling analyses of complex pangenome structural and haplotype variation at multiple scales. We apply the graph decomposition methods in PGR-TK to the class II major histocompatibility complex demonstrating the importance of the human pangenome for analyzing complicated regions. Moreover, we investigate the Y-chromosome genes, <italic>DAZ1</italic>/<italic>DAZ2</italic>/<italic>DAZ3</italic>/<italic>DAZ4</italic>, of which structural variants have been linked to male infertility, and X-chromosome genes <italic>OPN1LW</italic> and <italic>OPN1MW</italic> linked to eye disorders. We further showcase PGR-TK across 395 complex repetitive medically important genes. This highlights the power of PGR-TK to resolve complex variation in regions of the genome that were previously too complex to analyze.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">The PanGenome Research Tool Kit (PGR-TK) achieves flexible and scalable representation, visualization and analysis of genomic variation using pangenome graphs.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>Genome assembly algorithms</kwd>
      <kwd>Structural variation</kwd>
      <kwd>Genome assembly algorithms</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000051</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Human Genome Research Institute (NHGRI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1U01HG011758-01</award-id>
        <award-id>1U01HG011758-01</award-id>
        <principal-award-recipient>
          <name>
            <surname>Behera</surname>
            <given-names>Sairam</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>Fritz J.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000161</institution-id>
            <institution>United States Department of Commerce | National Institute of Standards and Technology (NIST)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000057</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Institute of General Medical Sciences (NIGMS)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35GM142916</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sudmant</surname>
            <given-names>Peter H.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature America, Inc. 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Main</title>
    <p id="Par3">Studying genomes, the fundamental information contained in all living beings, is the foundation for understanding the biology and evolution of all organisms, as well as the genetic diseases of humans. Despite the millions of human genomes that have been sequenced since the onset of the Human Genome Project<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup> and the dramatic reduction in the cost of short-read (roughly 150 bp) DNA sequencing, there is still fundamental information yet to be revealed in genomics<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. While it is important to recognize successes so far, including small variant surveys, genome-wide association studies<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR7">7</xref></sup> and the development of routine laboratory tests for genetic-based precision medicine<sup><xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>, there remain fundamental biological questions that involve structures at greater length scales that can only be captured using long-range information accessible by long-read technologies and diploid phased assemblies<sup><xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref></sup>.</p>
    <p id="Par4">With the possibility of resolving variants at multiple scales, small and large, researchers now can fully characterize previously inaccessible regions by focusing on single-nucleotide polymorphisms and small indels alone<sup><xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>. Examples of such previously inaccessible regions include centromere, telomeres and complex repeat regions. Recent results with pangenome-scale de novo human assemblies and the CHM13 telomere to telomere assembly have already shown the potential for revealing biological insights<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR20">20</xref></sup>, which are the foundation for understanding complex genetic diseases.</p>
    <p id="Par5">A concept that becomes powerful in such analyses is that of the pangenome: that is, a characterization of both the genetic structure and the genetic variation across diverse individuals of a species. However, such complexity and diversity generate interpretive challenges that require more advanced tools. A graph representing many genome assemblies at once provides a way to visualize and analyze complicated structural variations among different haplotypes<sup><xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR28">28</xref></sup>. Previously, distinct approaches to generate graphs representing pangenome structures have been proposed for various applications. For example, variant graph<sup><xref ref-type="bibr" rid="CR27">27</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup> and PanGenie<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> focus on improving variant calling and genotyping with pangenome references. Cactus graphs<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, Progressive Cactus graphs<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, PGGB<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> and cactus-mingraph<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup> build pangenome graphs aiming for large-scale structural rearrangement comparisons. Stringomics graph with ‘stringlet‘<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, Seqwish<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> and de Bruijn graph based approaches<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR31">31</xref></sup> provide algorithms and data structures for improving storage and query efficiency and reduce bias caused by the alignment processes. These tools provide more accessible pictures for researchers to understand repeats and rearrangements than using computational intensive and visually complicated multiple sequence alignments (MSA)<sup><xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR33">33</xref></sup>. The traditional MSA view is typically represented as a big matrix where each row represents a different genome, and the columns represent the bases. With MSA, the relationships between sequences are not obvious when there are complicated repeats or structural variations. Instead of per base alignment, a pangenome graph effectively condenses the homologous regions and can express the relationship between those different regions through graph edge connections that are easier to trace. Meanwhile, although a graph is an elegant data structure for gathering information from pangenomic assemblies, there remains a gap in projecting the underlying linear sequences onto a graph at various scales to reveal and compare features of many different haplotypes<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>.</p>
    <p id="Par6">To address this gap, we present a generalized graph framework as a software package, PanGenome Research Tool Kit (PGR-TK, <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDx/pgr-tk">https://github.com/GeneDx/pgr-tk</ext-link>), that is scalable to rapidly represent multiple samples at varying resolution levels by adopting different parameters to facilitate exploratory analysis. PGR-TK is able to resolve and visualize the most complex regions of the human genome that often affect multiple medical important phenotypes (for example, <italic>LPA</italic>, <italic>HLA</italic> and so on).</p>
    <p id="Par7">We demonstrate the ability of PGR-TK to visualize and enable deeper insights into complex variants in repetitive genes, including a gene within nested palindromic and tandem repeats (<italic>AMY1A</italic>), the major histocompatibility complex (MHC) region including the complex human leukocyte antigen (HLA) class II locus<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, the Genome in a Bottle (GIAB) challenging medically relevant gene list<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> and chrX and chrY ampliconic genes<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. Many genome-wide studies including GIAB have excluded many of these genes from their analyses because they are difficult to represent in VCF and it is challenging to compare differing representations<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. To understand how PGR-TK can help with the challenge of variant calling, variant representation and comparison across these genes and genomic loci we use the Human Pangenome Reference Consortium (HPRC)<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR38">38</xref></sup> year one 47 human genome assemblies (94 diverse haplotypes). With the ability to survey a large set of genes swiftly with PGR-TK, we hope to understand how to better provide a broader benchmark set for challenging genes using HPRC assemblies in the future. We examine <italic>OPN1LW</italic> and <italic>OPN1MW</italic> on chromosome X and <italic>DAZ1</italic>/<italic>2</italic>/<italic>3</italic>/<italic>4</italic> on chromosome Y in detail to understand how the limit due to complicated large-scale genome rearrangement affects the current methodology of generating variant call benchmarks. Our initial analysis of the GIAB clinical and medically important genes (CMRG) with a pangenome graph approach will help the research community to adapt the pangenome resource for clinical and medical genetic applications. Tools for visualizing and analyzing complicated rearrangement loci such as PGR-TK will be essential for better variant calling and understanding how structural variations with repeats affect the results for the community.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>PGR-TK</title>
      <p id="Par8">The PGR-TK has several different components to facilitate rapid pangenome analysis. The general scope and design of the PGR-TK is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1a</xref>. PGR-TK applies the computation techniques and data structures initially developed for fast genome assemblers<sup><xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR41">41</xref></sup> to pangenome analysis tasks. Instead of building a whole genome graph at once, which can be computationally expensive. PGR-TK provides tools for building an indexed sequence database, fetching and querying sequences of interest (for example, genes or regions with large-scale structural variations) from the database to create pangenomics graphs accordingly. It uses minimizer anchors to generate pangenome graphs at different scales without more computationally intensive sequence-to-sequence alignment or explicitly calling variants with respect to a reference. The generation step of the pangenome graph considers all input sequences equivalently without a preferential reference. Note that the sequence fetching step using a query sequence may introduce bias due to missing or incorrect alignments. We also developed an algorithm to decompose tangled pangenome graphs to more manageable units (principal bundles). With such decomposition, we can easily project the linear genomics sequence onto the principal bundles. It can provide more straightforward visualization to generate insight by revealing the contrast of the repeat and rearrangement variations among the haplotypes. Such pangenome-level graph decomposition provides utilities similar to the A-de Bruijn graph approach for identifying repeats and conserved segmental duplications<sup><xref ref-type="bibr" rid="CR42">42</xref>–<xref ref-type="bibr" rid="CR45">45</xref></sup>, but for the whole human pangenome collection at once.<fig id="Fig1"><label>Fig. 1</label><caption><title>The architecture of PGR-TK and minimizer anchored graph construction.</title><p><bold>a</bold>, Overall architecture and design scope of the PGR-TK library. <bold>b</bold>, Each sequence in the database is scanned, and the location of the minimizers are recorded to construct the SHIMMER database and MAP-graph. <bold>c</bold>, Each vertex in the MAP-graph represents a collection of sequence fragments sharing the two ending SHIMMERs in the database. <bold>d</bold>, The MAP-graph is constructed by merging all paths from all sequences into a graph.</p></caption><graphic xlink:href="41592_2023_1914_Fig1_HTML" id="d32e605"/></fig></p>
      <p id="Par9">PGR-TK uses the Assembly Genome Compressor<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> for storing pangenome assembly contigs and includes binary for creating the sparse hierarchical minimizer (SHIMMER) index. For the HPRC year one data release (94 fully assembled haplotypes from 47 samples), it takes 18 minutes to create the index file on an Amazon Web Services c5.12xlarge instance, with the default parameters. This is substantially faster than building an alignment index for query with tools such as mimimap2 (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). Although PGR-TK was designed to retrieve homologous sequences from the database, rather than finding the best alignments, our evaluations indicate that the query results are generally consistent with other alignment tools (Supplementary Tables <xref rid="MOESM1" ref-type="media">2</xref> and <xref rid="MOESM1" ref-type="media">3</xref>).</p>
      <p id="Par10">Once the index is built, it can be loaded into memory within minutes. As shown in Fig. <xref rid="Fig1" ref-type="fig">1a</xref>, there are three main functional modules using the index: (1) fetching homologous regions and sequences of the pangenome database given a query sequence, (2) creating a minimizer anchored pangenome-graph (MAP-graph) and (3) command line tools and a software library for interactive analysis and visualization on the generated graph and the underlying sequences. One of the main applications of PGR-TK is for deconvolving large regions of the human genome to reveal complex variations. It offers a set of efficient command line tools for various tasks, but also allows for more interactive and in-depth analysis through its integration with the Jupyter Laboratory<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> and other data science tools. This makes it a valuable resource for researchers seeking to uncover insights from their genomic data.</p>
      <p id="Par11">The source code and library can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDX/pgr-tk">https://github.com/GeneDX/pgr-tk</ext-link>. The documentation of the Python APIs is at <ext-link ext-link-type="uri" xlink:href="https://genedx.github.io/pgr-tk/">https://genedx.github.io/pgr-tk/</ext-link>.</p>
    </sec>
    <sec id="Sec4">
      <title>SHIMMER index</title>
      <p id="Par12">SHIMMER is a data structure extending the minimizer for more efficient indexing over larger regions. Additional minimizer reduction steps to generate sparse minimizers are applied to the minimizer sequences instead of the original base-pair sequences in a hierarchical way<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. Such sparse minimizers can serve as natural ‘anchors’ or ‘markers’ on genomics sequences without an explicit reference coordinate system. We use the SHIMMERs for quick sequence queries as initially proposed by Roberts et al.<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. PGR-TK identifies all neighboring pairs of SHIMMERs and indexes all the sequence segments between the pairs. Figure <xref rid="Fig1" ref-type="fig">1b</xref> shows a cartoon of the SHIMMERs identified on each sequence. Then, the pairs of the neighboring SHIMMERs are used for indexing the corresponding sequence segments within the paired SHIMMERs. After that, we build a look-up table of all pairs of SHIMMERs to all segments with the same pair at both ends (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). For the query, we compute the neighboring SHIMMER pairs from a query sequence and search the database for all segments indexed by the same pairs. Finally, we can fetch all target segments stored in the database to get all related sequence information for further analysis. PGR-TK provides functions to refine the raw query results and filter out spurious alignments likely caused by repeats outside the region of interest. With the set of sequences homologous to the query sequence, we can quickly perform downstream analysis work, for example, variant discovery by aligning the sequences to each other. Furthermore, we can generate a local pangenomics (MAP-graph) for comparing the sequences in the pangenome dataset at various scales by adjusting parameters to fit different analysis tasks.</p>
    </sec>
    <sec id="Sec5">
      <title>MAP-graph</title>
      <p id="Par13">PGR-TK provides tools to generate the MAP-graph from a set of homologous sequences. The vertices in a MAP-graph are labeled with the neighboring SHIMMER pairs representing a set of sequence segments in the database (Fig. <xref rid="Fig1" ref-type="fig">1c,d</xref> and <xref rid="Sec10" ref-type="sec">Methods</xref>). The edges in the MAP-graph are induced when at least one sequence connects the two fragments. Thus, each sequence naturally corresponds to a path in the graph, and the vertices in the path also contain the segments of other sequences in the database that share the same SHIMMER pair label (see the <xref rid="Sec10" ref-type="sec">Methods</xref> for a precise mathematical definition of a MAP-graph). The successful deployment of minimizer- or minhash- based approaches in sequence comparison<sup><xref ref-type="bibr" rid="CR39">39</xref>,<xref ref-type="bibr" rid="CR40">40</xref>,<xref ref-type="bibr" rid="CR49">49</xref></sup> indicates that sequence segments with the same minimizer labels are also likely to be highly homologous. The homology between sequences can be further confirmed by explicit sequence alignment of the segment inside a MAP-graph vertex. However, the computation intensive base-to-base alignment is not required for building the MAP-graph.</p>
      <p id="Par14">The MAP-graph construction in PGR-TK is highly efficient, as it does not rely on traditional sequence-to-sequence alignment. This is demonstrated by the fast graph construction for a set of 147 MHC class II region sequences from the pangenome reference, which was completed in under 5 seconds of wall-clock time using PGR-TK, compared to the 3.5 minutes using seqwish<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> and 13 minutes using minigraph<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> (Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>).</p>
      <p id="Par15">The size of vertices in the MAP-graph, which represents the lengths of the sequence segments in the pangenome, can be adjusted by changing the parameters that determine the distance between minimizers. This allows us to study genomic features at different length scales and generate pangenome graphs with varying levels of detail. This is particularly useful when analyzing features that vary in size, such as tandem repeats in the human genome, which can range from a few hundred base pairs to 1–2 kilobases (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>). By generating pangenome graphs at different levels of detail, we can gain a more comprehensive understanding of complex variation patterns within populations and focus on specific features of interest.</p>
      <p id="Par16">The analysis of pangenomic structure can be adjusted by controlling the parameters of minimizer window size (<italic>w</italic>), minimizer size (<italic>k</italic>) and hierarchical reduction factor (<italic>r</italic>), along with an auxiliary parameter min_span, which sets the minimum distance between minimizers in the construction of the SHIMMER index and MAP-graph (<xref rid="Sec10" ref-type="sec">Methods</xref>). The length of each vertex in the MAP-graph, representing a sequence segment, can be modified by adjusting these parameters. This allows us to study genomics features at different length scales.</p>
      <p id="Par17">Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref> illustrates the vertex length distribution for different parameter sets using chromosome 1 of CHM13 assembly. An increase in either <italic>w</italic> or <italic>r</italic> results in longer sequences being represented by each vertex, enabling a sparser sampling of the pangenome. The choice of parameters depends on the length of the region of interest and the size of relevant biological features, such as repeat sizes and distances. For example, when studying large-scale differences, bigger <italic>w</italic> and <italic>r</italic> values are preferable to generate a sparse index that can efficiently capture large-scale differences. Conversely, to compare small-scale differences, smaller <italic>w</italic> or <italic>r</italic> values should be used. Determining the optimal parameters for the pangenome graph generation step can be challenging if the underlying interesting features are less understood. Considering this, we have found that the best initial parameter choice is determined by the length of the sequences of interest to ensure comprehensible results. Based on our observation, we provide a simple formula for selecting the parameters (Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref>, Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref> for related examples).<fig id="Fig2"><label>Fig. 2</label><caption><title>AMY1A MAP-graph in two different scales.</title><p><bold>a</bold>, The left panel shows a sparse MAP-graph representation of the AMY region with (<italic>w</italic>, <italic>k</italic>, <italic>r</italic>, min_span) = (48, 56, 12, 12). 503 vertices and 699 edges represent the 200–550 kb AMY region. The graph vertices are colored by the principal bundles that correspond to the principal bundle decomposition of selected genomes on the right panel (gray vertices are those that are not in the principal bundles). <bold>b</bold>, The left panel shows a denser MAP-graph with <italic>r</italic> = 4. The graph has 3,471 vertices and 2,684 edges, which is about 5 times as much as the MAP-graph in <bold>a</bold>. The principal bundle decomposition reveals a more detailed repeat structure than in <bold>a</bold>.</p></caption><graphic xlink:href="41592_2023_1914_Fig2_HTML" id="d32e784"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Principal bundle decomposition</title>
      <p id="Par18">A pangenome graph can serve as a cornerstone for analyzing repeat structure variation in population<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>. It is usually hard to compare multiple sequences with complicated repeat structure by examining pairwise sequence alignments directly. The traditional visualization technique of the dot plot<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> allows us to perceive the complexity of the repeats but it does not provide insights into the repeat structures as linear representations across each individual sequence directly. Furthermore, only two sequences can be compared with a dot plot.</p>
      <p id="Par19">As an example, we use PGR-TK to investigate the repeat structure of the <italic>AMY1A</italic> gene (Alpha-amylase 1, an enzyme for the first step of catalyzing starch and glycogen in saliva) locus. We pick <italic>AMY1A</italic> as it has various numbers of copies caused by larger-scale structure variation related to the repeat surrounding the gene. The dot plots from randomly picking 36 sequences of a 400 kb region around <italic>AMY1A</italic> in the first year HPRC assemblies to the GRCh38 <italic>AMY1A</italic> reference sequence are shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">3a</xref>. Visual inspections of the dot plots show there are various numbers of copies of forward and inverted repeats forming palindromic sequences at the scales of 100 kb, and from zero up to five palindrome units. Still, only pairwise comparisons are enabled with dot plots and, thus, we lack a comprehensive assessment.</p>
      <p id="Par20">For comparison, we generate the <italic>AMY1A</italic> MAP-graphs at two different scales (Fig. <xref rid="Fig2" ref-type="fig">2</xref>) from the HPRC year one assemblies (47 samples). These can be generated with PRG-TK in less than 3 minutes from indexed sequence data. In additional to the MAP-graph, we provide tools analyzing a MAP-graph to ‘relinearize’ the graph into a set of ‘principal bundles’. We design the algorithm to generate the principal bundles representing those consensus paths that are most likely corresponding to repeat units in the pangenomes. The algorithm searches the paths that most of the pangenome sequences go through without branching as the principal bundles. This is analogous to identifying the contigs<sup><xref ref-type="bibr" rid="CR51">51</xref>,<xref ref-type="bibr" rid="CR52">52</xref></sup> in genome assembly algorithms.</p>
      <p id="Par21">Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the principal bundle decomposition of the <italic>AMY1A</italic> region MAP-graph in two different scales for comparison. The smaller choice of ‘<italic>r</italic>’ generates a MAP-graph with more vertices in the graph and each vertex only represents a smaller portion of the pangenome. This leads to a finer scale of principal bundle decompositions.</p>
      <p id="Par22">The linear representation derived from the MAP-graph allows for efficient identification and classification of repeat structures, which are otherwise challenging to characterize. Seven genomes were selected for analysis in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, each demonstrating distinct repeat structures. For example, HG00438 no. 2 mostly lacks repetitive sequences. The GRCh38 one has one relatively simple invert repeat (forming a palindrome region). HG02145 no. 1 has three copies of non-inverted repeats (labeled as repeat 1, 2 and 3). HG02257 no. 2 has three palindromic repeats (labeled as P1, P2 and P3). The two haplotypes from HG002 have similar structures to the GRCh38, except there is an inversion in the middle of the palindrome repeats in one of the two haplotypes. A full plot with all 96 repeat structures, including a hierarchical clustering tree identifying the similarities, is shown in the Supplementary Fig. <xref rid="MOESM1" ref-type="media">3b</xref>. This decomposition approach can be used by researchers to effectively classify the repeat structures of regions of interest.</p>
    </sec>
    <sec id="Sec7">
      <title>Pangenome analysis of the MHC class II locus</title>
      <p id="Par23">The MHC region in human genomes is highly polymorphic. The genomic sequences of the MHC are fundamental for understanding a human’s adaptive immune system and autoimmune diseases<sup><xref ref-type="bibr" rid="CR53">53</xref>,<xref ref-type="bibr" rid="CR54">54</xref></sup>. Owing to its complexity and polymorphic nature, it has been challenging to get a complete picture of the MHC genomics in the human population and to benchmark variant calling in the most variable regions<sup><xref ref-type="bibr" rid="CR34">34</xref>,<xref ref-type="bibr" rid="CR55">55</xref></sup>. The HPRC assemblies provide a new opportunity to analyze the MHC sequences with nearly fully assembled sequences of the region.</p>
      <p id="Par24">To showcase the effectiveness of PGR-TK in analyzing complicated human haplotype structures and sequences, we applied it to the HLA class II locus (GRCh38, chr6:32,313,513-32,992,088). We fetched the HPRC HLA class II haplotype sequences by anchoring them with more conserved flanking regions. Our dataset consists of a total of 105 full-length sequences, ranging from 650 to 800 kbp. Figure <xref rid="Fig3" ref-type="fig">3a</xref> shows the principal bundle decomposition of the collection of the sequence and Fig. <xref rid="Fig3" ref-type="fig">3b</xref> illustrates the MAP-graph of the 105 sequences. The tangled region in the MAP-graph represents highly polymorphic haplotypes in the human population. We can uncover the combinatorial nature of haplotype variation, such as the appearance of different combinations of HLA class II gene types in different haplotypes, in relation to the newly released human pangenome references (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>) by generating the MAP-graph and the principal bundle decomposition of the MHC class II.<fig id="Fig3"><label>Fig. 3</label><caption><title>Principal bundle decomposition reveals distinct haplotype groups.</title><p><bold>a</bold>, The principal bundle decomposition and annotated HLA class II genes in each of the haplotype sequences. The auxiliary tracks below each sequence on the left panel show the locations of the genes. The colors of the auxiliary tracks match the gene list of genes identified for each haplotype on the right. <bold>b</bold>, The MAP-graph generated by PGR-TK. <bold>c</bold>, PCA plots of the MHC class II sequences. Each panel highlights the different gene haplotype combinations. The vertical color bars indicate the matched haplotype groups in <bold>b</bold> and <bold>c</bold>. The circled symbols indicate the haplotypes belong to the corresponding group. The dotted lines represent the connection between the two haplotypes of individuals included in the analysis set who possess both haplotypes. The population groups, African Ancestry(AFR), American Ancestry (AMR), South Asia Ancestry(SAS), East Asia Ancestry(EAS) and not applicable (NA), are indicated with different markers of different colors.</p></caption><graphic xlink:href="41592_2023_1914_Fig3_HTML" id="d32e906"/></fig></p>
      <p id="Par25">We constructed a hierarchical dendrogram on top of the principal bundle decomposition to study the relationships of highly polymorphic haplotypes in the MHC region of the human population. The PGR-TK provides a command line tool to compute a distance metric derived from pairwise sparse alignment of the bundles between two sequences and generate a dendrogram from all pairwise distances. Known HLA class II gene sequences were also mapped to 105 pangenome sequences. The full annotated principal bundle decomposition, which was annotated with HLA class II genes and the hierarchical clustering dendrogram, is shown in Fig. <xref rid="Fig3" ref-type="fig">3a</xref>. The highly polymorphic region in the MAP-graph was found to correspond to the <italic>DRB-1</italic>/<italic>3</italic>/<italic>4</italic>/<italic>5</italic>, <italic>DOB</italic> and <italic>DOA1</italic>/<italic>2</italic> region. By clustering the full set of haplotype sequences, we can identify the combination of bundles in the entire region that correspond to the gene combinations of each cluster. Our approach uses the principal bundles to classify the complete sequence, rather than relying solely on gene fragments. This classification has the potential to facilitate new applications for improved genotyping or haplotyping of larger population data in this complex region. The results could offer valuable insights into the relationship between haplotype sequences and gene combinations in the context of genetic variation and disease susceptibility.</p>
      <p id="Par26">We can also use the vertices in the MAP-graph to conduct a principal component analysis (PCA) of the MHC class II regions. We collected all vertices in the MAP-graph to form the basis of vectors. Then, we constructed a binary vector for each haplotype path by indicating whether the path of the haplotype passes through the vertex. Figure <xref rid="Fig3" ref-type="fig">3c</xref> displays the principal component plot of the haplotype path vectors, along with the ethnic groups. The dotted line connects the two haplotypes of an individual in the sample. We have highlighted four different groups based on the HLA class II gene combinations (excluding the subtypes). Each group contains 10–49 haplotypes. With the current dataset of a limited number of haplotypes, we have not found any statistically significant patterns yet. However, as additional data will be released from HPRC in the coming years, we anticipate that the MAP-graph can be used to systematically analyze this region and better understand its impact on human disease within ethnic group structure.</p>
    </sec>
    <sec id="Sec8">
      <title>Analyzing medically relevant amplicon genes</title>
      <p id="Par27">GIAB is using the fully assembled HG002 chrX and chrY from T2T to form new small variant and structural variant benchmarks. The assembly fully resolves the medically relevant ampliconic genes<sup><xref ref-type="bibr" rid="CR36">36</xref>,<xref ref-type="bibr" rid="CR56">56</xref>,<xref ref-type="bibr" rid="CR57">57</xref></sup>
<italic>OPN1LW</italic>/<italic>OPN1MW</italic>/<italic>OPN1MW2</italic>/<italic>OPN1MW3</italic> and <italic>DAZ1</italic>/<italic>DAZ2</italic>/<italic>DAZ3</italic>/<italic>DAZ4</italic>, but the variation in these genes is too complex for current approaches to make reliable variant calls compatible with current benchmarking tools.</p>
      <p id="Par28">For example, the genes <italic>OPN1MW</italic> and <italic>OPN1MW2</italic> are inside a 74 kb deletion in HG002 relative to GRCh38, so HG002 contains only two of the four copies of the array in GRCh38: <italic>OPN1LW</italic> and one copy of <italic>OPN1MW</italic>/<italic>OPN1MW2</italic>/<italic>OPN1MW3</italic>. Dipcall<sup><xref ref-type="bibr" rid="CR58">58</xref></sup> can call the 74 kb deletion and variants in the other gene copies, but it may be possible to align the assembly to GRCh38 in alternative ways. The visualization from PGR-TK makes clear the varying number of genes in this array in each haplotype in Fig. <xref rid="Fig4" ref-type="fig">4a</xref>, which is important for some phenotypes such as color blindness, since seeing full color requires <italic>OPN1LW</italic> and at least one copy of <italic>OPN1MW</italic>/<italic>OPN1MW2</italic>/<italic>OPN1MW3</italic> (refs. <sup><xref ref-type="bibr" rid="CR56">56</xref>,<xref ref-type="bibr" rid="CR59">59</xref></sup>).<fig id="Fig4"><label>Fig. 4</label><caption><title>Principal bundle decomposition for genes in the repetitive regions of chromosome X and Y.</title><p><bold>a</bold>, MAP-graph principal bundle decomposition shows the repeat number changes of the <italic>OPN1LW</italic>, <italic>OPN1MW1</italic>/<italic>2</italic>/<italic>3</italic> to <italic>FLNA</italic> loci. Auxiliary tracks are as follows: top <italic>OPN1LW</italic>, middle <italic>OPN1MW1</italic>/<italic>2</italic>/<italic>3</italic> and bottom <italic>FLNA</italic>. <bold>b</bold>, The upper left image displays a dot plot comparing the HG002 assembly to GRCh38 over a 5 Mb region containing the <italic>DAZ1</italic>/<italic>2</italic>/<italic>3</italic>/<italic>4</italic> loci, highlighting an inversion between <italic>DAZ1</italic>/<italic>2</italic> and <italic>DAZ3</italic>/<italic>4</italic>. The image on the right provides a detailed view of the rearrangements at the gene scale level, with four tracks indicating the local matches to <italic>DAZ1</italic>/<italic>2</italic>/<italic>3</italic>/<italic>4</italic> from top to bottom. Comparison to GRCh38’s <italic>DAZ2</italic> reveals that the HG002 assembly is missing a segment (roughly 10 kb) of the darker green. The intergenic region between <italic>DAZ3</italic> and <italic>DAZ4</italic> also displays a rearrangement that can be described as an incomplete inversion or separate insertions and deletions. The bottom image shows a rearrangement at the whole locus, including all <italic>DAZ1</italic>/<italic>2</italic>/<italic>3</italic>/<italic>4</italic> over a 5 Mb region. The principal bundle decomposition reveals the different inverted structure of the HG002 T2T assembly and the HG1258 assembly compared to GRCh38. <bold>c</bold>, MAP-graph diffusion entropy versus repetitiveness survey for the 385 GIAB challenge CMRGs.</p></caption><graphic xlink:href="41592_2023_1914_Fig4_HTML" id="d32e1137"/></fig></p>
      <p id="Par29">Another important gene family <italic>DAZ1</italic>/<italic>DAZ2</italic>/<italic>DAZ3</italic>/<italic>DAZ4</italic> are in a set of nested palindromic repeats. It has been reported that partial deletions in this region may cause male infertility<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>. It would be useful to understand the natural distribution of non-pathogenic structural variants across this ampliconic gene cluster. <italic>DAZ1</italic> and <italic>DAZ2</italic> are roughly 1.5 Mbp (megabasepairs) from <italic>DAZ3</italic> and <italic>DAZ4</italic>, and HG002 has a 1 to 2 Mbp inversion relative to GRCh38 with breakpoints in the segmental duplications that contain the <italic>DAZ</italic> genes (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). In addition to the large inversion, the <italic>DAZ</italic> genes contain structural variants, including a roughly 10 kb deletion in <italic>DAZ2</italic>, two deletions in <italic>DAZ4</italic> and two insertions in <italic>DAZ3</italic> of sequences that are only in <italic>DAZ1</italic> and <italic>DAZ4</italic> in GRCh38. PGR-TK’s ability to color and visualize variation with the principal bundle decomposition algorithm at multiple scales enables intuitive understanding of this type of very complex variation, which would be very difficult to represent and understand as simple structural variant calls in VCF format.</p>
      <p id="Par30">The efficiency of PGR-TK makes it suitable for analyzing complex variants at isolated loci, as well as a set of region of interest. For example, GIAB has identified a set of 395 challenging but medically relevant genes. Analyzing this set in the pangenome references will provide some insight into the related complicated variation at the population level.</p>
      <p id="Par31">Using PGR-TK, we extracted all sequences of the 395 genes from the HPRC year one release (94 haplotype assemblies), CHM13 v.1.1, GRCh38 and hg19 of all 385 CMRG. We generated a MAP-graph for each gene and output it in GFA format (as seen in the Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>). For each graph, we derived two metrics to estimate (1) the degree of polymorphism among the pangenomes, and (2) the repeat content considering the variations of the pangenomes (as shown in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). These two measurements provide independent assessments of the MAP-graph structures of these genes. We found, as expected, that highly repetitive genes (such as <italic>LPA</italic> and <italic>KATNAL2</italic>) are more difficult to create a reliable variant benchmark call set. Many highly repetitive genes are excluded from the current CMRG benchmark set. We did not observe a correlation between higher entropy and the reduction of the gene in the benchmark set. We found that the high entropy genes also span larger regions in the genome. While entropy can indicate the complexity of variations in the population, we observed different clustering structures of the top entropy genes (see the comparison of the MAP-graph PCA plots of <italic>SNTG2</italic> and <italic>KMT2C</italic> in Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>).</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par32">With the advance in DNA sequencing technologies, more comprehensive human genomes at, or close to, telomere to telomere will be collected and made available in the coming years. It will enable researchers to study and characterize those previously inaccessible complex, but likely relevant, regions. The current HPRC assembly release has significantly affected our understanding of the human genome architecture. It will also be essential for building applications for clinical and medical tests and diagnostics soon. Flexible and scalable computational tools for analyzing pangenome-level genome assemblies will be part of the vital task of improving the practice of precision medicine with rich genomic data such as those from HPRC.</p>
    <p id="Par33">Many of the recently developed pangenome analysis tools allow graph analysis at the whole-genome level<sup><xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR24">24</xref></sup>. Meanwhile, the richness of diversity of human genomes over the repetitive regions poses unique challenges for analysis. In our work developing PGR-TK, we focus on providing a flexible library of useful algorithms. Furthermore, it enables analyzing the genome assemblies such that a developer or a researcher can rapidly access certain complex regions by adjusting parameters for visualization and integrating with subsequent analysis. PGR-TK may not be suitable for analysis at the whole-genome scale yet, and obtaining optimized results with the tool might not be straightforward. The challenges associated with the diversity of human genomes over repetitive regions can complicate the analysis process. It is crucial to ensure that the parameters chosen for visualization and subsequent analysis are appropriate for the specific genomic characteristics being examined. It may require careful consideration and expertise of a user to fine-tune the parameters and algorithms for optimization. Each main building unit (the vertex) of the MAP-graph represents a set of closely related sequence fragments. This is more analogous to the stringomics method proposed by Ferragina<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> than other methods building graphs on top of MSA or variant calls. Such approaches combined with the sparse minimizers are efficient to reduce the computational complexity (fewer vertices) to represent larger-scale scale structures. Complementary to that, PGR-TK provides an interface to fetch the sequences within each vertex such that it is possible to combine a MAP-graph with other graph analysis approaches. For example, it can be integrated with Cactus graph<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> and A-de Bruijn Graph<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> for base-level analysis, such as variant calling, genotyping and point mutation analysis, with recursive hybrid graph data structures.</p>
    <p id="Par34">We demonstrate how to use the PGR-TK for studying and characterizing the repetitive region <italic>AMY1A</italic> and the highly polymorphic HLA class Il region. We present a tool in PGR-TK backed by a new pangenome graph traversal algorithm, relinearizing tangled graphs caused by repetitive sequences to principal bundles for visualization. With the principal bundle decomposition, we can automatically visualize the repetitive and non-repetitive components of haplotype assembly contig. The PGR-TK can provide intuitive qualitative information about different genome arrangement architectures with decomposition and associated visualizations. For example, it enables visualization of both the very large inversion in the <italic>DAZ</italic> locus and much smaller complex structural variation within the genes. The visualization of the <italic>OPN1LW</italic>/<italic>OPN1MW</italic> gene array shows subtle copy number variations, which can affect vision, as well as nearby structural variants. We also use PGR-TK to survey a set of regions of interest across the whole genome. We derive two metrics for measuring the polymorphism and repetitiveness in human pangenome to more systematically survey complexity of a large set of medically and clinically relevant genes. In the future, we aim to extend the PGR-TK library to provide more quantitative and base-level analysis for both fundamental and translational research using pangenome resources.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Sequence database and SHIMMER index construction</title>
      <p id="Par35">To generate the SHIMMER index, each sequence was scanned and the symmetrical minimizers were generated with the specific minimizer window size <italic>w</italic> and kmer size <italic>k</italic>. We called this the first level of minimizer. Given a reduction factor <italic>r</italic> &gt; 1, additional levels of minimizer sets were generated to increase the span between the minimizers by a reduction step to facilitate pangenomics analysis. Even with the reduction step, in some simple sequence context, for example, long or short tandem repeats, two minimizers can remain too close to each other. A parameter ‘min_span’ can be applied to eliminate a pair of minimizers that are too close. We used a heuristic algorithm to eliminate those minimizers that were within the distance of min_span to each other. This helped to reduce the minimizer density when detailed analysis for those simple context regions was not desired. Setting min_span to zero and <italic>r</italic> to one generated the standard minimizers for each sequence.</p>
      <p id="Par36">Each pair of the reduced minimizers (SHIMMERs) was used as the key to build a hashmap to the sequence ID, and coordinates and matching orientation of the minimizer pairs on the sequences.</p>
      <p id="Par37">We also present examples of API calling and command line usage below.</p>
    </sec>
    <sec id="Sec12">
      <title>Generate MAP-graph</title>
      <p id="Par38">The MAP-graph is constructed by scanning through each sequence in the database. The vertices are simply the set of the tuples of neighboring minimizers (minimizer anchored segments). The edges are constructed by connecting minimizer anchored segments as a bidirected graph. One can consider this to be an extension of the string graph<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> where the overlaps are the minimizers at both ends. However, in the pangenome graph, each vertex includes a set of sequence segments from multiple genomes rather than one sequence.</p>
      <p id="Par39">As the MAP-graph can be constructed by scanning the SHIMMER pairs through the sequences. For a given set of <italic>n</italic> sequences, <italic>S</italic> = {<italic>s</italic><sub><italic>i</italic></sub>|<italic>i</italic> = 0…<italic>n</italic> − 1}, the vertices of the MAP-graph are<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}V = \left\{\right.({m^{(i)}}_{p},{m^{(i)}}_{p+1})|{m^{(i)}}_{p}, {\mathrm{and}}\, {m^{(i)}}_{p+1}\, {\mathrm{are}}\, {\mathrm{the}}\, p{\mathrm{th}}\, {\mathrm{and}} (p + 1){\mathrm{th}} \\\qquad{\mathrm{minimizers}}\, {\mathrm{of}}\, {\mathrm{a}}\, {\mathrm{sequence}}\, s_{i}, {\mathrm{in}}\, {\mathrm{all}}\, s_{i}\, {\mathrm{in}}\, S\left.\right\}.\end{array}$$\end{document}</tex-math><mml:math id="M2"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow/></mml:mfenced><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">are</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">the</mml:mi><mml:mspace width="0.25em"/><mml:mi>p</mml:mi><mml:mi mathvariant="normal">th</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="2.0em"/><mml:mi mathvariant="normal">minimizers</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">of</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">a</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">sequence</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">in</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">all</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">in</mml:mi><mml:mspace width="0.25em"/><mml:mi>S</mml:mi><mml:mfenced close="}"><mml:mrow/></mml:mfenced><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41592_2023_1914_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par40">We can assign a weight <italic>w</italic><sub><italic>i</italic></sub> of a vertex <italic>v</italic><sub><italic>i</italic></sub> = (<italic>m</italic><sub>a</sub>, <italic>m</italic><sub>b</sub>) as the total number of observed (<italic>m</italic><sub>a</sub>, <italic>m</italic><sub>b</sub>) pairs in <italic>S</italic>.</p>
      <p id="Par41">The edges of the MAP-graph are<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}E = \left\{\right.(v_{i}, v_{j})|v_{i} = ({m^{(i)}}_p,{m^{(i)}}_{p+1})\, {\mathrm{and}}\, v_{i} = ({m^{(i)}}_{p+1},{m^{(i)}}_{p+2})\, {\mathrm{for}}\, {\mathrm{all}}\\\qquad ({m^{(i)}}_p, {m^{(i)}}_{p+1},{m^{(i)}}_{p+2})\, {\mathrm{in}}\, {\mathrm{all}}\, s_{i}\, {\mathrm{in}}\, S\left.\right\}\end{array}$$\end{document}</tex-math><mml:math id="M4"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow/></mml:mfenced><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">for</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">all</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="2.0em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">in</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">all</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">in</mml:mi><mml:mspace width="0.25em"/><mml:mi>S</mml:mi><mml:mfenced close="}"><mml:mrow/></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41592_2023_1914_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec13">
      <title>Identify the principal bundles in a MAP-graph</title>
      <p id="Par42">To decompose a MAP-graph into principal bundles for downstream analysis, we apply a variation of depth first search<sup><xref ref-type="bibr" rid="CR60">60</xref></sup> (DFS) to build the traversal trees from the graph. Our DFS prioritized vertices with high ‘weight’ (defined as the number of sequence segments contained in a vertex) and accounting for the bidirected nature of the MAP-graph.</p>
      <p id="Par43">The DFS traversal through the graph is then converted to a tree structure internally. The leaf nodes in the tree are typically when the DFSs are terminated by no out edge from a node or a bubble or a loop is found. As we prioritize the weights of the vertices during DFS, long paths usually correspond to the ‘common’ paths that most sequences in the data would go through. Rarer haplotypes typically correspond to short bubble paths in the MAP-graph. Thus, they can be identified as short branches in the DFS traversal tree. We use the tree to remove those vertices in the MAP-graph if those are shorter than prespecified length in the DFS tree. In general, the vertices in the principal bundle represent more sequences in the set of input sequences (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>) and are likely more conservative in the pangenome.</p>
      <p id="Par44">After removing the vertices corresponding to the short branches, we further remove vertices in the MAP-graph that have more than three out edges after converting the MAP-graph as an undirected graph. After such removal, the graph will only consist of simple paths, and we output those paths as the principal bundles.</p>
      <p id="Par45">In summary, here is the sketch of the algorithm:<list list-type="order"><list-item><p id="Par46">Build a DFS traversal tree with a deep first search for a given MAP-graph. To capture paths that are more conserved among the pangenome sequences of interest as the principal bundles, our DFS search prioritizes high-weight vertices when constructing the DFS traversal tree</p></list-item><list-item><p id="Par47">In MAP-graph, remove vertices that correspond to nodes in short branches of the DFS traversal tree</p></list-item><list-item><p id="Par48">Remove branching vertices in MAP-graph (by considering it as an undirected graph)</p></list-item><list-item><p id="Par49">Output the simple paths from the resulting graph as the principal bundles.</p></list-item></list></p>
    </sec>
    <sec id="Sec14">
      <title>Principal component plot for the HLA class II locus</title>
      <p id="Par50">To generate the principal component of the pangenome HLA class II sequences, we convert each of the haplotype sequences to a binary vector. The binary vector has the same length of the total number of vertices of all principal bundles. Let us call these vertices <italic>V</italic> = {<italic>v</italic><sub><italic>i</italic></sub>|<italic>v</italic><sub><italic>i</italic></sub> in principle bundles, <italic>i</italic> = 0<sub><italic>n</italic>−1</sub>}, where <italic>n</italic> is the total number of vertices in the principal bundles. For each sequence <italic>s</italic>, we construct a binary vector <italic>w</italic><sub><italic>s</italic></sub> = {<italic>b</italic><sub>0</sub>, <italic>b</italic><sub>1</sub>,…, <italic>b</italic><sub><italic>n</italic>−1</sub>} where <italic>b</italic><sub><italic>i</italic></sub> = 1 if the sequence <italic>s</italic> contains the vertex <italic>v</italic><sub><italic>i</italic></sub>, and <italic>b</italic><sub><italic>i</italic></sub> = 0 if not. Then, we perform the standard principal component transformation with the binary vectors of all sequences from the HLA class II region.</p>
    </sec>
    <sec id="Sec15">
      <title>General workflow for analyzing a region of interest</title>
      <p id="Par51">Here we outline the general workflow on how to use PGR-TK to generate MAP-graph and the principal bundle decomposition.<list list-type="order"><list-item><p id="Par52">For a region or sequences of interest, put the sequences as a fasta file for querying the PGR-TK pangenome sequence database. (PGR-TK provides a command line tool ‘pgr-fetch’ and python APIs to fetch such sequence from the PGR-TK sequence database.)</p></list-item><list-item><p id="Par53">Query the whole pangenome database to get initial hits that match the query sequence with the command line tool ‘pgr-query’ or using the Python APIs.</p></list-item><list-item><p id="Par54">Filter the hits to remove unwanted matches that do match a user’s analysis objectives. With the command line tool ‘pgr-query’, it generates a summary table of the hits for filtering.</p></list-item><list-item><p id="Par55">With the filtered sequences, using ‘pgr-pbundle-decomp’ command line tool to generate the MAP-graph in GFA format and principal bundle decomposition in the BED format. Beside analyzing the generated data, the generated bed file of the decomposition can be rendered by the pgr-pbundle-bed2svg to generate visualization. Python APIs are also provided for more scripting to resolve complicated analysis cases.</p></list-item><list-item><p id="Par56">Optionally, we can take the fetched sequences from ‘pgr-query’ to use with other third party tools, for example, calling variant with dipcall, create an MSA, or building other local pangenome graphs with minigraph or pggb.</p></list-item><list-item><p id="Par57">Re-adjust the parameters (<italic>w</italic>, <italic>k</italic>, <italic>r</italic>, min_span) and repeat (3) and (4) with additional analysis of the results if necessary.</p></list-item></list></p>
    </sec>
    <sec id="Sec16">
      <title>Building index</title>
      <p id="Par58">For a large sequence set, for example 47 whole-genome HPRC assemblies, PGR-TK uses the AGC format<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> to store the sequence efficiently. A command line tool ‘pgr-mdb’ is developed with the PGR-TK package to create the index file on top of the AGC file. For example, for a prebuild HPRC year one assembly AGC file (1.33 Gb), we create a file (/data/pgr-tk-HGRP-y1-evaluation-set-v0_input) include a file system path to the AGC file, /data/gr-tk-HGRP-y1-evaluation-set-v0.agc and call ‘pgr-mdb‘ to create the index files with a prespecified prefix (/data/pgr-tk-HGRP-y1-evaluation-set-v0):</p>
      <p id="Par59">
        <code>echo /data/pgr-tk-HGRP-y1-evaluation-set-v0.agc \&gt; /data/pgr-tk-HGRP-y1-evaluation-set-v0_input/code/pgr-mdb /data/pgr-tk-HGRP-y1-evaluation-set-v0_input \/data/pgr-tk-HGRP-y1-evaluation-set-v0</code>
      </p>
      <p id="Par60">Two files will be generated in this example</p>
      <p id="Par61">
        <code>/data/pgr-tk-HGRP-y1-evaluation-set-v0.mdb # 15 Gb for (w, k, r, min_span) = (80,56,4,64)/data/pgr-tk-HGRP-y1-evaluation-set-v0.midx # 3.1 Mb</code>
      </p>
      <p id="Par62">The index and sequence data can be loaded into a python workspace by</p>
      <p id="Par63">
        <code>import pgrtksdb = pgrtk.SeqIndexDB()sdb.load_from_agc_index(‘pgr-tk-HGRP-y1-evaluation-set-v0’)</code>
      </p>
      <p id="Par64">As the indexes are loaded into memory, we suggest using a computing instance that has a random access memory larger than about four times that of the index file to avoid swapping thrashing.</p>
      <p id="Par65">For smaller sequence files, the sequence database object (for example, the ‘sdb’ in the example above) created by pgrtk.SeqIndexDB()can create and load sequences using load_from_fastx() method. See the library documentation at <ext-link ext-link-type="uri" xlink:href="https://genedx.github.io/pgr-tk/">https://genedx.github.io/pgr-tk/</ext-link> for more detailed descriptions of all python objects, methods and functions in the PGR-TK package.</p>
    </sec>
    <sec id="Sec17">
      <title>Query sequence in the PGR-TK sequence database</title>
      <sec id="Sec18">
        <title>Command line example</title>
        <p id="Par66">A command line tool named pgr-query is provided to query a PGR-TK database with a set of sequences, each of which represents a region of interest. It is recommended to select regions larger than 20 kb, as they contain enough SHIMMER anchors. If smaller regions are of interest, padding with flanking sequences can improve the results.</p>
        <p id="Par67">The follow command shows an example querying the database: pgr-query /data/pgr-tk-HGRP-y1-evaluation-set-v0 ROI_seq.fa pg_seqs --merge-range-tol 100,000.</p>
        <p id="Par68">In this example, the ROI_seq.fa file contains sequences from the regions of interest. The pgr-query tool generates a set of fasta files with the prefix ‘pg_seqs’ for each query sequence in the ‘ROI_seq.fa’ file. Additionally, a ‘pg_seqs.hit’ file is produced, which contains information about the alignment range between the query and the results, as well as the number of anchors identified between each pair of query results. This information can be used to filter out unwanted alignments.</p>
      </sec>
      <sec id="Sec19">
        <title>Python API example</title>
        <p id="Par69">For finding homologous sequences in a PGR-TK database, we need to start with a query sequence. We can fetch a sequence in the database giving a known ‘data source’, ‘contig name’ tuple and the beginning and ending coordinates. As the SHIMMERs are sparsely distributed in a sequence, the query sequence should be long enough to cover enough minimizer anchors. The python statement shows a typical code fragment to generate query results of a region of interest:</p>
        <p id="Par70">
          <code>ref_file_name, roi_chr, roi_b, roi_e = ‘hg19_tagged.fa’, ‘chr6_hg19’, 32130918, 32959917padding = 10000#get a segment of a referenceroi_seq = ref_db.get_sub_seq(ref_file_name, roi_chr, roi_b-padding, roi_e+padding)# using the roi_seq to find hits in ‘sdb’aln_range = pgrtk.query_sdb(sdb, roi_seq, merge_range_tol=200000)</code>
        </p>
        <p id="Par71">The output aln_range from the query_sdb() call contains data of the hits in the PGR-TK database. Internally, the query_sdb() method performs:<list list-type="order"><list-item><p id="Par72">create SHIMMER pairs of the query sequence (2) use the SHIMMER pairs and the hashmap index to find all hits in the database</p></list-item><list-item><p id="Par73">perform sparse dynamic programming to find sparse alignments between the query sequence and all hits in the database</p></list-item><list-item><p id="Par74">merge the alignment segments if any of them are within the merge_range_tol parameter.</p></list-item></list></p>
        <p id="Par75">The parameter merge_range_tol is introduced to avoid alignment fragmentation when the query sequence contains a region of high polymorphism but we still want to fetch those diverse sequences for constructing the pangenomics graph.</p>
        <p id="Par76">Typically, a user needs to process the data in aln_range for different analysis. Our example Jupyter Notebooks provides various examples for processing the output to generate dot plot or MAP-graphs and so on.</p>
      </sec>
    </sec>
    <sec id="Sec20">
      <title>Build minimizer anchor pangenome graph and principal bundle decomposition</title>
      <sec id="Sec21">
        <title>Command line example</title>
        <p id="Par77">Given a set of sequence in a fasta file, for example, the query results from pgr-query command, we can build the pangenome graph and the principal bundle decomposition (outputted as a bed file) by</p>
        <p id="Par78">
          <code>pgr-pbundle-decomp -w 48 -k 56 -r 8 \--min-span 12 --bundle-length-cutoff 100 \--bundle-merge-distance 1000 --min-branch-size 8 \--min-cov 0 --include file_contain_contig_names \pgr-query pgr_out</code>
        </p>
        <p id="Par79">In the pangenome graph construction process, the following options can be used to control the graph construction: -w, -k, -r and --min-span. The --min-cov option sets the minimum coverage requirement for a vertex to be included in the principal bundle graph. The --min-branch-size option allows the user to filter out short branches that contain less than a specified number of vertices in the MAP-graph. The --bundle-length-cutoff option allows the user to exclude bundles shorter than the specified length. When two bundles have the same identifier and are within the distance specified by --bundle-merge-distance, they will be merged. If the --include option is specified, only those contigs specified in the file_contain_contig_names file will be analyzed.</p>
        <p id="Par80">The command generates a set of files with the prefix pgr_out:</p>
        <p id="Par81">
          <code>pgr_out.bed # the bed file contains the principal bundle decompositionpgr_out.ctg.summary.tsv # summary for bundle statistics for each contigpgr_out.mapg.gfa # MAP-graph in GFA formatpgr_out.mapg.idx # index for the sequence in the GFA filepgr_out.pmapg.gfa #principal bundle graph in the GFA format</code>
        </p>
        <p id="Par82">The pgr_out.bed has the following format. Each line is a bundle contain in a contig: contig_name begin_coordinate end_coordinate bundle_specification where the bundle_specification is six fields delimited by ‘:’. The fields are bundle identifier, bundle vertex count, orientation, begin vertex number, end vertex number, ‘R’ or ‘U’ for repetitive or unique in the contig. Note such a region in a contig may not only project to the full bundle. In such cases, end_vertex-bgn_vertex is less than bundle_vertex_count.</p>
        <p id="Par83">The *.mapg.idx file contains the information about each vertex in the .gfa files. It contains three kinds of tagged line starting with ‘K’, ‘C’ and ‘F’. The K line specifies the parameters used to generate the graph. The C lines specify the contigs contained in the graph. The F lines specify the fragment of sequences contained in each vertex. Here are the fields for echo of them: K line: <italic>w</italic>, <italic>k</italic>, <italic>r</italic>, min_span</p>
        <p id="Par84">S line: contig_identifer, contg_name, contig_source, contig_length</p>
        <p id="Par85">F line: frag_unique_identifier, frag_numeric_identifer, contig_identifer, start_coordinate, end_coordinate, orientation</p>
        <p id="Par86">Python API:</p>
        <p id="Par87">To build the MAP-graph and principal bundle decomposition within a python program, one can use the instance methods generate_mapg_gfa() and get_principal_bundle_decomposition() of an pgrtk.SeqIndexDB() object. Please read the documentation at <ext-link ext-link-type="uri" xlink:href="https://genedx.github.io/pgr-tk/">https://genedx.github.io/pgr-tk/</ext-link> for the API details.</p>
      </sec>
    </sec>
    <sec id="Sec22">
      <title>Clustering principal bundle decomposition structure</title>
      <p id="Par88">The follow command performs clustering of the principal bundles stored in a bed file: pgr-pbundle-bed2dist pgr_out.bed pgr_out.</p>
      <p id="Par89">It will generate these output files: pgr_out.dist # all pairwise distance</p>
      <p id="Par90">
        <code>pgr_out.nwk # a hierarchical tree in Newick formatpgr_out.ddg # a file contain the dendrogram for the pgr-pbundle-bed2svg to draw the dendrogram panel</code>
      </p>
    </sec>
    <sec id="Sec23">
      <title>Generate principal bundle decomposition plot in scalable vector graph format</title>
      <p id="Par91">The following is an example to generate a SVG file pgr_out.svg from pgr_out.bed that layout 500,000 bp with annotation specified in a file called pgr_annotation with a dendrogram panel on the left from the pgr_out.ddg dendrogram data</p>
      <p id="Par92">
        <code>/code/pgr-pbundle-bed2svg pgr_out.bed pgr_out \--track-range 500000 --track-tick-interval 100000 \--track-panel-width 1200 --stroke-width 0.5 \--annotations pgr_annotation \--ddg-file pgr_out.ddg \--highlight-repeats 3</code>
      </p>
    </sec>
    <sec id="Sec24">
      <title>Survey on the genome in bottle challenging clinical and medically relevant genes with the MAP-graphs</title>
      <p id="Par93">The GIAB Consortium provides variant call benchmarks on seven benchmark genomes<sup><xref ref-type="bibr" rid="CR35">35</xref>,<xref ref-type="bibr" rid="CR61">61</xref>,<xref ref-type="bibr" rid="CR62">62</xref></sup>. These benchmarks were initially formed by integrating multiple short-read technologies, but the latest version integrated linked-read and long-read technologies to form benchmarks in regions difficult to map with short reads. However, a set of 395 challenging but medically relevant genes were identified as substantially (more than 10%) excluded from the mapping-based benchmark due to long repeats, large structural variations, segmental duplications and/or high polymorphism between the benchmark genome HG002 and the reference genome hg19 or GRCh38. A long-read genome assembly approach provided a reliable benchmark call set of 273 out of the 395 genes<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. The remaining 122 were still excluded mainly because they were not accurately assembled, or no benchmarking tools exist to compare different representations of complex variants in the genes. Overall, 395 genes have recently shown to include high levels of polymorphism across different ethnicities making it highly challenging to represent their variations<sup><xref ref-type="bibr" rid="CR63">63</xref></sup>.</p>
      <p id="Par94">The current GIAB variant benchmarks focus on a small set of seven well-characterized genomes with extensive short-, linked- and long-read data to ensure robust benchmarks and more tractable method development and benchmark evaluations. Meanwhile, a limited representation of genomes in a population may miss significant structural variants, additional copies of genes and context for important variants for diseases not observed in a smaller dataset. Given that increasingly accurate long-read and assembly level data are being produced at pangenome scales now, we are surveying how we can use such resources to benchmark variant accuracy at a broader population level for the challenging CMRG. Such pangenome analysis will help to generate guidelines for future practice.</p>
      <p id="Par95">With PGR-TK, we extract all sequences from the HPRC year one release (94 haplotype assemblies), and CHM13 v.1.1, GRCh38 and hg19 of all 385 CMRG. We generate a MAP-graph of each gene and output this in GFA format. For each graph, we derived two metrics to estimate (1) the degree of polymorphism among the pangenomes, and (2) the repeat content taking account of the variations of the pangenomes.</p>
      <p id="Par96">To estimate the degree of polymorphism, we consider a diffusion process in the graph (below) and derive an entropy-like quantity from a normalized equilibrium distribution. The higher entropy values indicate more complicated graphs likely from the polymorphism from different genomes. The diffusion weight on each vertex is also associated with multiplicity and repetitiveness of the corresponding segments in the pangenomes. We pick the average of the top 32 diffusion weights from the MAP-graph of each gene as a simple metric to measure the most challenging repeat content within a gene.</p>
      <p id="Par97">To gain insight about the challenge for calling variants of the CMRG set at a pangenome scale, we plot the diffusion entropy versus the maximum local repeat weights for each gene (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). As there are no obvious correlations, these two quantities provide independent measurements of two aspects of the MAP-graph structures of these genes. We find high repetitive genes are harder to create a reliable variant benchmark call set for. Many highly repetitive genes are excluded from the current CMRG benchmark set. We do not observe that higher entropy is correlated with the reduction of the gene in the benchmark set.</p>
      <p id="Par98">We highlight several genes with high entropy or high repetitiveness. The MAP-graphs and the Integrative Genomics Viewer view of the pangenome assemblies of a selected set genes (<italic>LMF1</italic>, <italic>ANKRD11</italic>, <italic>SRGAP2</italic>, <italic>KMT2C</italic>, <italic>LPA</italic>, <italic>MUC4</italic>, <italic>MUC3A</italic>, <italic>KATNAL2</italic>, <italic>FLG</italic>) aligned to GRCh38 are shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>. In the Integrative Genomics Viewer view of <italic>LMF1</italic> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4a</xref>), several variation hotspots are visible and may correspond to localized structural variants. This serves as a simple example to examine the concordance of structural variation in the population and the principal bundle decomposition. We use PAV<sup><xref ref-type="bibr" rid="CR64">64</xref></sup> to call structural variants for comparison. In Supplementary Fig. <xref rid="MOESM1" ref-type="media">4b</xref>, the structural variant calls resulting from PAV are provided as an auxiliary track (black) below the principal bundle decomposition tracks for a selected set of HPRC year one genomes, where both haplotypes are resolved in the region. It is evident that the structural variation calls correspond to the regions where principal bundles have complex structure and are distinct from the reference genome GRCh38 (the top track). As shown in <italic>LPA</italic> (associated with coronary disease<sup><xref ref-type="bibr" rid="CR65">65</xref></sup>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>), <italic>KATNAL2</italic> (loss of function variant discovered in autistic proband<sup><xref ref-type="bibr" rid="CR66">66</xref>,<xref ref-type="bibr" rid="CR67">67</xref></sup>) also has long tandem repeat variations in the HPRC pangenome cohort. We find the number of the 5.8 kbp repeats inside <italic>KATNAL2</italic> ranges from 3 to 25 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>). Applying MAP-graph decomposition on genes such as <italic>KATNAL2</italic> with a big pangenome reference panel will provide additional insights to the natural of the variability of the repetitiveness and its effects on the underlying biology like other, more well-studied genes, for example, <italic>LPA</italic>, in the coming years.</p>
    </sec>
    <sec id="Sec25">
      <title>Compute graph diffusion entropy and max repetitive weight</title>
      <p id="Par99">It would be desirable to derive quantitative measurements so we can characterize a set of large numbers of MAP-graphs fast. One thing we are interested in quantifying is how complex a graph is. The intuition is that if a region of the genome is more polymorphic in the population, the graph will have more alternative paths, or bubbles. We like to generate a quantity as a proxy for that. For this, we borrow the idea from network science study and spectral graph theory to consider a diffusion/random walk process on a graph<sup><xref ref-type="bibr" rid="CR68">68</xref></sup>. For a graph, we consider a set of random walkers starting at each vertex. The random walkers can drift on the graph through the edge-connection. We can consider the distribution of the random walkers in the final equilibrium state. If a graph is relatively simple, then the final distribution will be uniform (subject to minor boundary condition corrections). On the other hand, if the weights of the vertices or topology of the graph are more complex, we would expect the final distribution of the walkers would be less uniform and reflect the complicated nature of the graph.</p>
      <p id="Par100">The final distribution of the such diffusion process can be obtained by simple matrix multiplication iteration from the adjacent matrix of a MAP-graph. Given an adjacency matrix <italic>A</italic>, where the matrix element <italic>A</italic><sub><italic>ij</italic></sub> is the number of sequences supports edge from <italic>v</italic><sub><italic>i</italic></sub> to <italic>v</italic><sub><italic>j</italic></sub>. The final distribution <italic>P</italic> can be written as <italic>P</italic> = (1/<italic>N</italic>) lim<sub><italic>n</italic>→∞</sub>
<italic>M</italic><sup><italic>n</italic></sup>
<bold>1</bold>, where <italic>M</italic> = <italic>AD</italic><sup>−1</sup>, <italic>D</italic> is the degree matrix defined as <italic>D</italic><sub><italic>ii</italic></sub> being the degree of vertex <italic>v</italic><sub><italic>i</italic></sub> and <italic>D</italic><sub><italic>ij</italic></sub> = 0 if <italic>i</italic> ≠ <italic>j</italic>, <italic>N</italic> is the total number of vertices and <bold>1</bold> is a column vector in which every element is one. (When we compute <italic>P</italic>, we only repeat the number of multiplications <italic>N</italic> times to approximate the final distribution.)</p>
      <p id="Par101"><bold>P</bold> is a normalized column vector [<italic>p</italic><sub>0</sub>, <italic>p</italic><sub>1</sub>,…,<italic>p</italic><sub><italic>n</italic>−</sub><sub>1</sub>]<sup><italic>T</italic></sup> such that ∑<sub><italic>i</italic>=0…<italic>n</italic>−1</sub><italic>p</italic><sub><italic>i</italic></sub> = 1 (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">4a</xref> for an example). The diffusion entropy used in this work is defined as <italic>S</italic> = −∑<sub><italic>i</italic>=0…<italic>n</italic>−</sub><sub>1</sub>
<italic>p</italic><sub><italic>i</italic></sub> log<sub>2</sub>(<italic>p</italic><sub><italic>i</italic></sub>).</p>
      <p id="Par102">To find the highly repetitive elements inside a region of interest, we look into largest elements in the unnormalized vector <italic>N</italic><bold>P</bold> as a proxy of average number of repeats considering the graph structure. We pick the top 32 elements in <italic>N</italic><bold>P</bold> and use the average of those as a proxy number to estimate the repetitiveness of potential repeat units inside a region of interest.</p>
    </sec>
    <sec id="Sec26">
      <title>Reporting summary</title>
      <p id="Par103">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec id="Sec27" sec-type="materials|methods">
    <title>Online content</title>
    <p id="Par104">Any methods, additional references, Nature Portfolio reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at 10.1038/s41592-023-01914-y.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec28">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41592_2023_1914_MOESM1_ESM.pdf">
            <label>Supplementary Information</label>
            <caption>
              <p>Supplementary Tables 1–6 and Figs. 1–8.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41592_2023_1914_MOESM2_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41592-023-01914-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank B. Mishra for reading and commenting on the draft of the manuscript. Certain commercial equipment, instruments or materials are identified to specify adequately experimental conditions or reported results. Such identification does not imply recommendation or endorsement by the National Institute of Standards and Technology, nor does it imply that the equipment, instruments or materials identified are necessarily the best available for the purpose. F.J.S. and S.B. are supported by National Institutes of Health grants (nos. UM1HG008898 and 1U01HG011758-01). P.S. is supported by an National Institutes of Health/National Institute of General Medical Sciences grant (no. R35GM142916).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>Conceptualization and design were done by C.-S.C., A.K., F.J.S., P.H.S., J.W. and J.M.Z. Algorithm, code and documentation development were done using PGR-TK by C.-S.C. The manuscript was written by C.-S.C., A.K., F.J.S. and J.M.Z. Manuscript revision, data management and code validation were carried out by S.B., F.J.S., P.H.S. and J.W.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par105"><italic>Nature Methods</italic> thanks Bjarni Halldorsson and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Primary Handling Editor: Lin Tang, in collaboration with the <italic>Nature Methods</italic> team.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The HPRC year one release sequence and prebuilt index: <ext-link ext-link-type="uri" xlink:href="https://giab-data.s3.amazonaws.com/PGR-TK-Files/pgr-tk-HGRP-y1-evaluation-set-v0.tar">https://giab-data.s3.amazonaws.com/PGR-TK-Files/pgr-tk-HGRP-y1-evaluation-set-v0.tar</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/journal_contribution/HPRC-Y1-sequence-data_zip/22584403">https://figshare.com/articles/journal_contribution/HPRC-Y1-sequence-data_zip/22584403</ext-link> (10.6084/m9.figshare.22584403). Scripts and source data URLs for constructing the HPRC AGC file: <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDX/pgr-tk-notebooks/tree/main/pgr-tk-sequence-source">https://github.com/GeneDX/pgr-tk-notebooks/tree/main/pgr-tk-sequence-source.</ext-link> All GFA files, fetched sequences from HPRC year one release of the 385 CMRG: <ext-link ext-link-type="uri" xlink:href="https://giab-data.s3.amazonaws.com/PGR-TK-Files/CMRG_output_dir_v0.3.3.tar">https://giab-data.s3.amazonaws.com/PGR-TK-Files/CMRG_output_dir_v0.3.3.tar</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The code of the PGR-TK is hosted in a GitHub repository, <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDX/pgr-tk">https://github.com/GeneDX/pgr-tk</ext-link>, and the code can be obtained using the standard ‘git clone’ command. Follow the README.md document for building the PGR-TK. A document for Python API is provided at <ext-link ext-link-type="uri" xlink:href="https://genedx.github.io/pgr-tk/">https://genedx.github.io/pgr-tk/</ext-link>. The source code for the v.0.4.1 version is also hosted at <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/journal_contribution/pgr-tk-0_4_1_zip/22584793">https://figshare.com/articles/journal_contribution/pgr-tk-0_4_1_zip/22584793</ext-link> (10.6084/m9.figshare.22584793). Prebuilt binaries for Linux Ubuntu distribution 22.04 can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDX/pgr-tk/releases/tag/v0.4.1">https://github.com/GeneDX/pgr-tk/releases/tag/v0.4.1</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/journal_contribution/pgr-bin-pacakge-v0_4_1_tgz/22584787">https://figshare.com/articles/journal_contribution/pgr-bin-pacakge-v0_4_1_tgz/22584787</ext-link> (10.6084/m9.figshare.22584787). Example Notebooks using PGR-TK including code making most of (the source of) the plots in this paper can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDX/pgr-tk-notebooks">https://github.com/GeneDX/pgr-tk-notebooks</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/journal_contribution/scripts_and_artifects_zip/22584118">https://figshare.com/articles/journal_contribution/scripts_and_artifects_zip/22584118</ext-link> (10.6084/m9.figshare.22584118) Additional information about a docker image with prebuilt PGR-TK library and Jupyter Laboratory Server and usage is at <ext-link ext-link-type="uri" xlink:href="https://github.com/GeneDX/pgr-tk/blob/main/pgr-tk-workstation/Readme.md">https://github.com/GeneDX/pgr-tk/blob/main/pgr-tk-workstation/Readme.md</ext-link>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par106">C.-S.C. is an employee and shareholder of GeneDX. F.J.S. obtains research support from Illumina, PacBio and Oxford Nanopore. The remaining authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Initial sequencing and analysis of the human genome</article-title>
        <source>Nature</source>
        <year>2001</year>
        <volume>409</volume>
        <fpage>860</fpage>
        <lpage>921</lpage>
        <pub-id pub-id-type="doi">10.1038/35057062</pub-id>
        <?supplied-pmid 11237011?>
        <pub-id pub-id-type="pmid">11237011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venter</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence of the human genome</article-title>
        <source>Science</source>
        <year>2001</year>
        <volume>291</volume>
        <fpage>1304</fpage>
        <lpage>1351</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1058040</pub-id>
        <?supplied-pmid 11181995?>
        <pub-id pub-id-type="pmid">11181995</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The complete sequence of a human genome</article-title>
        <source>Science</source>
        <year>2022</year>
        <volume>376</volume>
        <fpage>44</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1126/science.abj6987</pub-id>
        <?supplied-pmid 35357919?>
        <pub-id pub-id-type="pmid">35357919</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Siva</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>1000 Genomes project</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>256</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt0308-256b</pub-id>
        <?supplied-pmid 18327223?>
        <pub-id pub-id-type="pmid">18327223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Canela-Xandri</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Rawlik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tenesa</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>An atlas of genetic associations in UK Biobank</article-title>
        <source>Nat. Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>1593</fpage>
        <lpage>1599</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0248-z</pub-id>
        <?supplied-pmid 30349118?>
        <pub-id pub-id-type="pmid">30349118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bycroft</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UK Biobank resource with deep phenotyping and genomic data</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <fpage>203</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0579-z</pub-id>
        <?supplied-pmid 30305743?>
        <pub-id pub-id-type="pmid">30305743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">The ‘All of Us’ Research Program Investigators. The ‘All of Us’ Research Program. <italic>N. Engl. J. Med</italic>. <bold>381</bold>, 668–676 (2019).</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Voelkerding</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Dames</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Durtschi</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Next-generation sequencing: from basic research to diagnostics</article-title>
        <source>Clin. Chem.</source>
        <year>2009</year>
        <volume>55</volume>
        <fpage>641</fpage>
        <lpage>658</lpage>
        <pub-id pub-id-type="doi">10.1373/clinchem.2008.112789</pub-id>
        <?supplied-pmid 19246620?>
        <pub-id pub-id-type="pmid">19246620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rehder</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation sequencing for constitutional variants in the clinical laboratory, 2021 revision: a technical standard of the American College of Medical Genetics and Genomics (ACMG)</article-title>
        <source>Genet. Med.</source>
        <year>2021</year>
        <volume>23</volume>
        <fpage>1399</fpage>
        <lpage>1415</lpage>
        <pub-id pub-id-type="doi">10.1038/s41436-021-01139-4</pub-id>
        <?supplied-pmid 33927380?>
        <pub-id pub-id-type="pmid">33927380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yohe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Thyagarajan</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Review of clinical next-generation sequencing</article-title>
        <source>Arch. Pathol. Lab. Med.</source>
        <year>2017</year>
        <volume>141</volume>
        <fpage>1544</fpage>
        <lpage>1557</lpage>
        <pub-id pub-id-type="doi">10.5858/arpa.2016-0501-RA</pub-id>
        <?supplied-pmid 28782984?>
        <pub-id pub-id-type="pmid">28782984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Green</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>MV</given-names>
          </name>
        </person-group>
        <article-title>The future of DNA sequencing</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>550</volume>
        <fpage>179</fpage>
        <lpage>181</lpage>
        <pub-id pub-id-type="doi">10.1038/550179a</pub-id>
        <?supplied-pmid 29022931?>
        <pub-id pub-id-type="pmid">29022931</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mahmoud</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structural variant calling: the long and the short of it</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>246</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1828-7</pub-id>
        <?supplied-pmid 31747936?>
        <pub-id pub-id-type="pmid">31747936</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Darby</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Piercing the dark matter: bioinformatics of long-range sequencing and mapping</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>329</fpage>
        <lpage>346</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-018-0003-4</pub-id>
        <?supplied-pmid 29599501?>
        <pub-id pub-id-type="pmid">29599501</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Coster</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Weissensteiner</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Towards population-scale long-read sequencing</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>572</fpage>
        <lpage>587</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-021-00367-3</pub-id>
        <?supplied-pmid 34050336?>
        <pub-id pub-id-type="pmid">34050336</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olson</surname>
            <given-names>ND</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PrecisionFDA Truth Challenge V2: calling variants from short and long reads in difficult-to-map regions</article-title>
        <source>Cell Genom.</source>
        <year>2022</year>
        <volume>2</volume>
        <fpage>100129</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100129</pub-id>
        <?supplied-pmid 35720974?>
        <pub-id pub-id-type="pmid">35720974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aganezov</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A complete reference genome improves analysis of human genetic variation</article-title>
        <source>Science</source>
        <year>2022</year>
        <volume>376</volume>
        <fpage>eabl3533</fpage>
        <pub-id pub-id-type="doi">10.1126/science.abl3533</pub-id>
        <?supplied-pmid 35357935?>
        <pub-id pub-id-type="pmid">35357935</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Human Pangenome Project: a global resource to map genomic diversity</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>604</volume>
        <fpage>437</fpage>
        <lpage>446</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-04601-8</pub-id>
        <?supplied-pmid 35444317?>
        <pub-id pub-id-type="pmid">35444317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sir‚n</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pangenomics enables genotyping of known structural variants in 5202 diverse genomes</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>374</volume>
        <fpage>abg8871</fpage>
        <pub-id pub-id-type="doi">10.1126/science.abg8871</pub-id>
        <pub-id pub-id-type="pmid">34914532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>W-W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A draft human pangenome reference</article-title>
        <source>Nature</source>
        <year>2023</year>
        <volume>617</volume>
        <fpage>312</fpage>
        <lpage>324</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-023-05896-x</pub-id>
        <?supplied-pmid 37165242?>
        <pub-id pub-id-type="pmid">37165242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jarvis</surname>
            <given-names>ED</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Semi-automated assembly of high-quality diploid human reference genomes</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>611</volume>
        <fpage>519</fpage>
        <lpage>531</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-05325-5</pub-id>
        <?supplied-pmid 36261518?>
        <pub-id pub-id-type="pmid">36261518</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Ferragina, P. &amp; Mishra, B. Algorithms in stringomics (I): pattern-matching against ‘stringomes’. Preprint at <italic>bioRxiv</italic>10.1101/001669 (2014).</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garrison</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Guarracino</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Unbiased pangenome graphs</article-title>
        <source>Bioinformatics</source>
        <year>2023</year>
        <volume>39</volume>
        <fpage>btac743</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac743</pub-id>
        <?supplied-pmid 36448683?>
        <pub-id pub-id-type="pmid">36448683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eizenga</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pangenome graphs</article-title>
        <source>Annu. Rev. Genom. Hum. Genet.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>139</fpage>
        <lpage>162</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-genom-120219-080406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>The design and construction of reference pangenome graphs with minigraph</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>265</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02168-z</pub-id>
        <?supplied-pmid 33066802?>
        <pub-id pub-id-type="pmid">33066802</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cactus graphs for genome comparisons</article-title>
        <source>J. Comput. Biol.</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>469</fpage>
        <lpage>481</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2010.0252</pub-id>
        <?supplied-pmid 21385048?>
        <pub-id pub-id-type="pmid">21385048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ebler</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pangenome-based genome inference allows efficient and accurate genotyping across a wide spectrum of variant classes</article-title>
        <source>Nat. Genet.</source>
        <year>2022</year>
        <volume>54</volume>
        <fpage>518</fpage>
        <lpage>525</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-022-01043-w</pub-id>
        <?supplied-pmid 35410384?>
        <pub-id pub-id-type="pmid">35410384</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garrison</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Variation graph toolkit improves read mapping by representing genetic variation in the reference</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>875</fpage>
        <lpage>879</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4227</pub-id>
        <?supplied-pmid 30125266?>
        <pub-id pub-id-type="pmid">30125266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Computational Pan-Genomics Consortium.</collab>
        </person-group>
        <article-title>Computational pan-genomics: status, promises and challenges</article-title>
        <source>Brief. Bioinform.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>118</fpage>
        <lpage>135</lpage>
        <pub-id pub-id-type="pmid">27769991</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hickey</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genotyping structural variants in pangenome graphs using the vg toolkit</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>35</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-1941-7</pub-id>
        <?supplied-pmid 32051000?>
        <pub-id pub-id-type="pmid">32051000</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Armstrong</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Progressive Cactus is a multiple-genome aligner for the thousand-genome era</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>587</volume>
        <fpage>246</fpage>
        <lpage>251</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2871-y</pub-id>
        <?supplied-pmid 33177663?>
        <pub-id pub-id-type="pmid">33177663</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beller</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ohlebusch</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>A representation of a compressed de Bruijn graph for pan-genome analysis that enables search</article-title>
        <source>Algorithms Mol. Biol.</source>
        <year>2016</year>
        <volume>11</volume>
        <fpage>20</fpage>
        <pub-id pub-id-type="doi">10.1186/s13015-016-0083-7</pub-id>
        <?supplied-pmid 27437028?>
        <pub-id pub-id-type="pmid">27437028</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darling</surname>
            <given-names>ACE</given-names>
          </name>
          <name>
            <surname>Mau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Blattner</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Perna</surname>
            <given-names>NT</given-names>
          </name>
        </person-group>
        <article-title>Mauve: multiple alignment of conserved genomic sequence with rearrangements</article-title>
        <source>Genome Res.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>1394</fpage>
        <lpage>1403</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.2289704</pub-id>
        <?supplied-pmid 15231754?>
        <pub-id pub-id-type="pmid">15231754</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guarracino</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Heumos</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nahnsen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Prins</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Garrison</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>ODGI: understanding pangenome graphs</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>3319</fpage>
        <lpage>3326</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac308</pub-id>
        <?supplied-pmid 35552372?>
        <pub-id pub-id-type="pmid">35552372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chin</surname>
            <given-names>C-S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A diploid assembly-based benchmark for variants in the major histocompatibility complex</article-title>
        <source>Nat. Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>4794</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-18564-9</pub-id>
        <?supplied-pmid 32963235?>
        <pub-id pub-id-type="pmid">32963235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Curated variation benchmarks for challenging medically relevant autosomal genes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>672</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-01158-1</pub-id>
        <?supplied-pmid 35132260?>
        <pub-id pub-id-type="pmid">35132260</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bhowmick</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Satta</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Takahata</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>The origin and evolution of human ampliconic gene families and ampliconic structure</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>441</fpage>
        <lpage>450</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.5734907</pub-id>
        <?supplied-pmid 17185645?>
        <pub-id pub-id-type="pmid">17185645</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zook</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A robust benchmark for detection of germline large deletions and insertions</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>1347</fpage>
        <lpage>1355</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0538-8</pub-id>
        <?supplied-pmid 32541955?>
        <pub-id pub-id-type="pmid">32541955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Cody, S. Year 1 Sequencing data release. <italic>Human Pangenome Reference Consortium</italic><ext-link ext-link-type="uri" xlink:href="https://humanpangenome.org/year-1-sequencing-data-release/">https://humanpangenome.org/year-1-sequencing-data-release/</ext-link> (2021).</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Chin, C.-S. &amp; Khalak, A. Human genome assembly in 100 minutes. Preprint at <italic>bioRxiv</italic>10.1101/705616 (2019).</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ekim</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chikhi</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Minimizer-space de Bruijn graphs: whole-genome assembly of long reads in minutes on a personal computer</article-title>
        <source>Cell Syst.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>958</fpage>
        <lpage>968.e6</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2021.08.009</pub-id>
        <?supplied-pmid 34525345?>
        <pub-id pub-id-type="pmid">34525345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap and miniasm: fast mapping and de novo assembly for noisy long sequences</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>2103</fpage>
        <lpage>2110</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw152</pub-id>
        <?supplied-pmid 27153593?>
        <pub-id pub-id-type="pmid">27153593</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>De novo repeat classification and fragment assembly</article-title>
        <source>Genome Res.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>1786</fpage>
        <lpage>1796</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.2395204</pub-id>
        <?supplied-pmid 15342561?>
        <pub-id pub-id-type="pmid">15342561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ancestral reconstruction of segmental duplications reveals punctuated cores of human genome evolution</article-title>
        <source>Nat. Genet.</source>
        <year>2007</year>
        <volume>39</volume>
        <fpage>1361</fpage>
        <lpage>1368</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2007.9</pub-id>
        <?supplied-pmid 17922013?>
        <pub-id pub-id-type="pmid">17922013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A de Bruijn graph approach to the quantification of closely-related genomes in a microbial community</article-title>
        <source>J. Computat. Biol.</source>
        <year>2012</year>
        <volume>19</volume>
        <fpage>814</fpage>
        <lpage>825</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2012.0058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Detection and analysis of ancient segmental duplications in mammalian genomes</article-title>
        <source>Genome Res.</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>901</fpage>
        <lpage>909</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.228718.117</pub-id>
        <?supplied-pmid 29735604?>
        <pub-id pub-id-type="pmid">29735604</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Danek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>AGC: compact representation of assembled genomes</article-title>
        <source>Bioinformatics</source>
        <year>2023</year>
        <volume>39</volume>
        <fpage>btad097</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btad097</pub-id>
        <?supplied-pmid 36864624?>
        <pub-id pub-id-type="pmid">36864624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Project jupyter (Jupyter, 2023); <ext-link ext-link-type="uri" xlink:href="https://jupyter.org">https://jupyter.org</ext-link></mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Yorke</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Reducing storage requirements for biological sequence comparison</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>3363</fpage>
        <lpage>3369</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth408</pub-id>
        <?supplied-pmid 15256412?>
        <pub-id pub-id-type="pmid">15256412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ondov</surname>
            <given-names>BD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>132</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0997-x</pub-id>
        <?supplied-pmid 27323842?>
        <pub-id pub-id-type="pmid">27323842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibbs</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>McIntyre</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>The diagram, a method for comparing sequences. Its use with amino acid and nucleotide sequences</article-title>
        <source>Eur. J. Biochem.</source>
        <year>1970</year>
        <volume>16</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1432-1033.1970.tb01046.x</pub-id>
        <?supplied-pmid 5456129?>
        <pub-id pub-id-type="pmid">5456129</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kececioglu</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Combinatorial algorithms for DNA sequence assembly</article-title>
        <source>Algorithmica</source>
        <year>1995</year>
        <volume>13</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1007/BF01188580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>The fragment assembly string graph</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>ii79</fpage>
        <lpage>ii85</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti1114</pub-id>
        <?supplied-pmid 16204131?>
        <pub-id pub-id-type="pmid">16204131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trowsdale</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Major Histocompatibility Complex genomics and human disease</article-title>
        <source>Annu. Rev. Genomics Hum. Genet.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>301</fpage>
        <lpage>323</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-genom-091212-153455</pub-id>
        <?supplied-pmid 23875801?>
        <pub-id pub-id-type="pmid">23875801</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vandiedonck</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>The human Major Histocompatibility Complex as a paradigm in genomics research</article-title>
        <source>Brief. Funct. Genomics Proteom.</source>
        <year>2009</year>
        <volume>8</volume>
        <fpage>379</fpage>
        <lpage>394</lpage>
        <pub-id pub-id-type="doi">10.1093/bfgp/elp010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horton</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Variation analysis and gene annotation of eight MHC haplotypes: the MHC Haplotype Project</article-title>
        <source>Immunogenetics</source>
        <year>2008</year>
        <volume>60</volume>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1007/s00251-007-0262-2</pub-id>
        <?supplied-pmid 18193213?>
        <pub-id pub-id-type="pmid">18193213</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Michaelides</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hardcastle</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Cone opsins, colour blindness and cone dystrophy: genotype-phenotype correlations</article-title>
        <source>S. Afr. Med. J.</source>
        <year>2016</year>
        <volume>106</volume>
        <fpage>S75</fpage>
        <lpage>S78</lpage>
        <pub-id pub-id-type="doi">10.7196/SAMJ.2016.v106i6.11001</pub-id>
        <?supplied-pmid 27245533?>
        <pub-id pub-id-type="pmid">27245533</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moro</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Male infertility caused by a de novo partial deletion of the DAZ cluster on the Y Chromosome1</article-title>
        <source>J. Clin. Endocrinol. Metab.</source>
        <year>2000</year>
        <volume>85</volume>
        <fpage>4069</fpage>
        <lpage>4073</lpage>
        <?supplied-pmid 11095434?>
        <pub-id pub-id-type="pmid">11095434</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">lh3/dipcall. <italic>GitHub</italic><ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/dipcall">https://github.com/lh3/dipcall</ext-link> (2021).</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>X-linked cone dystrophy caused by mutation of the red and green cone opsins</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2010</year>
        <volume>87</volume>
        <fpage>26</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2010.05.019</pub-id>
        <?supplied-pmid 20579627?>
        <pub-id pub-id-type="pmid">20579627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Skiena, S. S. <italic>The Algorithm Design Manual</italic> (Springer, 2008).</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zook</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Salit</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Advancing benchmarks for genome sequencing</article-title>
        <source>Cell Syst.</source>
        <year>2015</year>
        <volume>1</volume>
        <fpage>176</fpage>
        <lpage>177</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2015.09.004</pub-id>
        <?supplied-pmid 27135909?>
        <pub-id pub-id-type="pmid">27135909</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Benchmarking challenging small variants with linked and long reads</article-title>
        <source>Cell Genom.</source>
        <year>2022</year>
        <volume>2</volume>
        <fpage>100128</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100128</pub-id>
        <?supplied-pmid 36452119?>
        <pub-id pub-id-type="pmid">36452119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <mixed-citation publication-type="other">Ji, Y., Gong, J., Sedlazeck, F. J. &amp; Fan, S. Characterizing the genetic polymorphisms in 370 challenging medically relevant genes using long-read sequencing data from 41 human individuals among 19 global populations. Preprint at <italic>bioRxiv</italic>10.1101/2022.08.03.502734 (2022).</mixed-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ebert</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype-resolved diverse human genomes and integrated analysis of structural variation</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>372</volume>
        <fpage>eabf7117</fpage>
        <pub-id pub-id-type="doi">10.1126/science.abf7117</pub-id>
        <?supplied-pmid 33632895?>
        <pub-id pub-id-type="pmid">33632895</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burgess</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Association of LPA variants with risk of coronary disease and the implications for lipoprotein(a)-lowering therapies: a Mendelian randomization analysis</article-title>
        <source>J. Am. Med. Assoc. Cardiol.</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>619</fpage>
        <lpage>627</lpage>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanders</surname>
            <given-names>SJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo mutations revealed by whole-exome sequencing are strongly associated with autism</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <fpage>237</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10945</pub-id>
        <?supplied-pmid 22495306?>
        <pub-id pub-id-type="pmid">22495306</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Roak</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sporadic autism exomes reveal a highly interconnected protein network of de novo mutations</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <fpage>246</fpage>
        <lpage>250</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10989</pub-id>
        <?supplied-pmid 22495309?>
        <pub-id pub-id-type="pmid">22495309</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <mixed-citation publication-type="other">Spielman, D. A. Spectral graph theory and its applications. in <italic>Proc.</italic><italic>48th Annual IEEE Symposium on Foundations of Computer Science (FOCS’07)</italic> 29–38 (IEEE, 2007).</mixed-citation>
    </ref>
  </ref-list>
</back>
