<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4595898</article-id>
    <article-id pub-id-type="pmid">26076722</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv365</article-id>
    <article-id pub-id-type="publisher-id">btv365</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>REDEMPTION: reduced dimension ensemble modeling and parameter estimation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Yang</given-names>
        </name>
        <xref ref-type="aff" rid="btv365-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv365-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Manesso</surname>
          <given-names>Erica</given-names>
        </name>
        <xref ref-type="aff" rid="btv365-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv365-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gunawan</surname>
          <given-names>Rudiyanto</given-names>
        </name>
        <xref ref-type="aff" rid="btv365-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv365-AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btv365-COR1">*</xref>
      </contrib>
      <aff id="btv365-AFF1"><sup>1</sup>Institute for Chemical and Bioengineering, Department of Chemistry and Applied Biosciences, ETH Zurich, 8093, Zurich, Switzerland and</aff>
      <aff id="btv365-AFF2"><sup>2</sup>Swiss Institute of Bioinformatics, 1015, Lausanne, Switzerland</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv365-COR1">*To whom correspondence should be addressed. </corresp>
      <fn id="btv365-FN1">
        <p>Associate Editor: Jonathan Wren</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>10</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>20</issue>
    <fpage>3387</fpage>
    <lpage>3389</lpage>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>4</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>31</day>
        <month>5</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>6</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Here, we present REDEMPTION (<bold>Re</bold>duced <bold>D</bold>imension <bold>E</bold>nsemble <bold>M</bold>odeling and <bold>P</bold>arameter estima<bold>tion</bold>), a toolbox for parameter estimation and ensemble modeling of ordinary differential equations (ODEs) using time-series data. For models with more reactions than measured species, a common scenario in biological modeling, the parameter estimation is formulated as a nested optimization problem based on incremental parameter estimation strategy. REDEMPTION also includes a tool for the identification of an ensemble of parameter combinations that provide satisfactory goodness-of-fit to the data. The functionalities of REDEMPTION are accessible through a MATLAB user interface (UI), as well as through programming script. For computational speed-up, REDEMPTION provides a numerical parallelization option using MATLAB Parallel Computing toolbox.</p>
      <p><bold>Availability and implementation:</bold> REDEMPTION can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.cabsel.ethz.ch/tools/redemption">http://www.cabsel.ethz.ch/tools/redemption</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>rudi.gunawan@chem.ethz.ch</email>
      </p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Mathematical modeling plays an increasingly important role in understanding and predicting biological phenomena. In this regard, ordinary differential equation (ODE) models are often created to describe the dynamic behavior of biological systems based on mass or molar conservation, as follow:
<disp-formula id="btv365-M1"><label>(1)</label><mml:math id="MM1"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>S</mml:mi><mml:mi>v</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>p</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>t</italic> denotes time, <inline-formula><mml:math id="MM2"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the species concentration vector, <inline-formula><mml:math id="MM3"><mml:mi mathvariant="bold">S</mml:mi></mml:math></inline-formula> is the stoichiometric or connectivity matrix, <inline-formula><mml:math id="MM4"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>p</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the reaction rate or flux equation vector, <inline-formula><mml:math id="MM5"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>p</mml:mi></mml:mstyle></mml:math></inline-formula> denotes the kinetic parameter vector and <inline-formula><mml:math id="MM6"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the initial concentration vector. The estimation of unknown kinetic parameters from time-series data is the most challenging step in the creation of such biological models, due to: (i) high computational cost associated with global optimizations and with integrating ODEs (<xref rid="btv365-B1" ref-type="bibr">Chou and Voit, 2009</xref>), and (ii) the lack of parameter identifiability (<xref rid="btv365-B7" ref-type="bibr">Srinath and Gunawan, 2010</xref>).</p>
    <p>The high computational complexity could be addressed by performing the parameter estimation incrementally. Here, time-series data are first smoothened and differentiated, and subsequently the dynamic flux values are computed by viewing <xref ref-type="disp-formula" rid="btv365-M1">Equation (1)</xref> as an algebraic equation. The parameters are estimated one flux at a time while avoiding ODE integrations (<xref rid="btv365-B8" ref-type="bibr">Voit and Almeida, 2004</xref>). However, such an approach requires that <bold>S</bold> has a full column rank, which is often not satisfied in the modeling of biological systems.</p>
    <p>We recently developed incremental parameter estimation (IPE) and integrated flux parameter estimation (IFPE) to address the limitation related to the matrix <bold>S</bold>. In IPE (IFPE), we formulated the parameter estimation as a nested optimization, where the outer optimization was performed over a subset of parameters corresponding to the independent (integrated) fluxes, defined such that given their values, the remaining (integrated) fluxes could be estimated from the slope of time-series data (<xref rid="btv365-B4" ref-type="bibr">Jia <italic>et al.</italic>, 2012a</xref>; <xref rid="btv365-B6" ref-type="bibr">Liu and Gunawan, 2014</xref>). The inner optimizations involved estimating parameters associated with the dependent flux subset using their estimated (integrated) flux values, performed one flux at a time.</p>
    <p>Meanwhile, incomplete parameter identifiability implies that many parameter combinations could fit the data equally well (<xref rid="btv365-B5" ref-type="bibr">Jia <italic>et al.</italic>, 2012b</xref>). In ensemble modeling, instead of generating one best-fit parameter estimate, one looks for a set of parameter combinations which fit the data within an acceptable prediction accuracy, e.g. an upper bound for the error function. We extended our incremental estimation strategy above such that the identification of parameter ensemble could be efficiently performed over smaller parameter dimensions (<xref rid="btv365-B5" ref-type="bibr">Jia <italic>et al.</italic>, 2012b</xref>).</p>
    <p><bold>Re</bold>duced <bold>D</bold>imension <bold>E</bold>nsemble <bold>M</bold>odeling and <bold>P</bold>arameter estima<bold>tion</bold> (REDEMPTION) provides a UI for efficient parameter estimation and ensemble modeling based on IPE and IFPE in MATLAB. The functions within REDEMPTION were designed to address a common scenario in biological modeling, where the number of reactions exceeds that of the (measured) species. When this scenario does not apply, REDEMPTION automatically reverts to a standard IPE. For ensemble modeling, REDEMPTION employs an efficient parameter exploration algorithm HYPERSPACE, which combines an Adaptive Monte Carlo method and a multiple ellipsoids based sampling (<xref rid="btv365-B9" ref-type="bibr">Zamora-Sillero <italic>et al.</italic>, 2011</xref>).</p>
  </sec>
  <sec>
    <title>2 Main features</title>
    <p><italic>Model and data specifications:</italic> REDEMPTION’s UI starts with the Main window (<xref ref-type="fig" rid="btv365-F1">Fig. 1</xref>a), from which users can access all functionalities. The ODE model equations can be specified manually through the Model Editor using power-law or linear-logarithmic (lin-log) kinetics (<xref ref-type="fig" rid="btv365-F1">Fig. 1</xref>c), or by importing an SBML file. In addition, REDEMPTION requires upper and lower bound values for the model parameters. A parameter will be estimated from data when the upper and lower bounds differ. Users also need to provide the time-series concentration data in Comma-Separated Values (CSV) format. For data pre-processing, REDEMPTION includes piecewise polynomial spline-fitting, where users can adjust the number of pieces and the order of polynomials (<xref ref-type="fig" rid="btv365-F1">Fig 1</xref>d).
<fig id="btv365-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Workflow of parameter estimation and ensemble generation in REDEMPTION applied to branched pathway example</p></caption><graphic xlink:href="btv365f1p"/></fig>
</p>
    <p><italic>Parameter estimation:</italic><xref ref-type="fig" rid="btv365-F1">Figure 1</xref>e depicts REDEMPTION’s parameter estimation UI. For parameter estimation, REDEMPTION provides four variants of the IPE and IFPE methods and two error functions using sum of squares of the absolute or relative model prediction errors (User Guide for more details). Here, users can select MATLAB’s Genetic Algorithm (GA) or enhanced Scatter Search (eSS) (<xref rid="btv365-B3" ref-type="bibr">Egea <italic>et al.</italic>, 2010</xref>) as the global optimization algorithm.</p>
    <p><italic>Ensemble modeling:</italic> After a successful run of parameter estimation, users can generate parameter ensemble corresponding to parameter combinations whose error function values are smaller than a user-specified threshold (<xref ref-type="fig" rid="btv365-F1">Fig. 1</xref>f). The optimal error function value obtained from the prior parameter estimation step is provided as a reference for setting this threshold. The appropriate threshold could for example be calculated by bootstrapping the original data (<xref rid="btv365-B5" ref-type="bibr">Jia <italic>et al.</italic>, 2012b</xref>). <xref ref-type="fig" rid="btv365-F1">Figure 1</xref>f shows a 2D parameter projection of the generated parameter ensemble, in which each blue dot represents a parameter combination in the ensemble and the largest dot corresponds to the optimal solution of the parameter estimation step. To include an additional dataset, users can perform parameter estimation and ensemble modeling again using the additional data and new parameter bounds based on the parameter ensemble (User Guide for more information).</p>
  </sec>
  <sec>
    <title>3 Examples</title>
    <p><xref ref-type="fig" rid="btv365-F1">Figure 1</xref> illustrates the workflow of REDEMPTION for parameter estimation and ensemble generation using a branched pathway example as shown in <xref ref-type="fig" rid="btv365-F1">Figure 1</xref>b (<xref rid="btv365-B8" ref-type="bibr">Voit and Almeida, 2004</xref>). REDEMPTION also includes the lin-log modeling of <italic>Lactococcus lactis</italic> glycolytic pathway as another example (<xref rid="btv365-B2" ref-type="bibr">del Rosario <italic>et al.</italic>, 2008</xref>). Details of these examples can be found in the User Guide.</p>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>REDEMPTION provides an integrated, numerically efficient tool for estimating kinetic parameters and parameter ensemble of ODE models. The tools within REDEMPTION are accessible through a user-friendly MATLAB UI and applicable for ODE models with power-law or lin-log kinetics, and those in SBML format.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>YL and RG designed the toolbox. YL programmed the toolbox. YL, EM and RG coordinated the testing and wrote the manuscript. The authors would like to thank Prof. Julio Banga for providing the eSS algorithm, and members of CABSEL for testing the toolbox. The authors would also like to thank Dr. Lakshminarayanan Lakshmanan for his help in setting up the REDEMPTION website.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was supported by funding from <funding-source>ETH Zurich</funding-source> and <funding-source>Swiss National Science Foundation</funding-source> (grant number <award-id>137614</award-id>).</p>
    <p><italic>Conflict of Interest:</italic> none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btv365-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chou</surname><given-names>I.C.</given-names></name><name><surname>Voit</surname><given-names>E.O.</given-names></name></person-group> (<year>2009</year>) <article-title>Recent developments in parameter estimation and structure identification of biochemical and genomic systems</article-title>. <source>Math. Biosci.</source>, <volume>219</volume>, <fpage>57</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">19327372</pub-id></mixed-citation>
    </ref>
    <ref id="btv365-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>del Rosario</surname><given-names>R.C.</given-names></name><etal/></person-group> (<year>2008</year>) <article-title>Challenges in lin-log modelling of glycolysis in Lactococcus lactis</article-title>. <source>IET Syst. Biol.</source>, <volume>2</volume>, <fpage>136</fpage>–<lpage>149</lpage>.<pub-id pub-id-type="pmid">18537454</pub-id></mixed-citation>
    </ref>
    <ref id="btv365-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Egea</surname><given-names>J.A.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>An evolutionary method for complex-process optimization</article-title>. <source>Comput. Oper. Res.</source>, <volume>37</volume>, <fpage>315</fpage>–<lpage>324</lpage>.</mixed-citation>
    </ref>
    <ref id="btv365-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jia</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2012a</year>) <article-title>Incremental parameter estimation of kinetic metabolic network models</article-title>. <source>BMC Syst. Biol.</source>, <volume>6</volume>, <fpage>142</fpage>.<pub-id pub-id-type="pmid">23171810</pub-id></mixed-citation>
    </ref>
    <ref id="btv365-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jia</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2012b</year>) <article-title>Ensemble kinetic modeling of metabolic networks from dynamic metabolic profiles</article-title>. <source>Metabolites</source>, <volume>2</volume>, <fpage>891</fpage>–<lpage>912</lpage>.<pub-id pub-id-type="pmid">24957767</pub-id></mixed-citation>
    </ref>
    <ref id="btv365-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Y.</given-names></name><name><surname>Gunawan</surname><given-names>R.</given-names></name></person-group> (<year>2014</year>) <article-title>Parameter estimation of dynamic biological network models using integrated fluxes</article-title>. <source>BMC Syst. Biol.</source>, <volume>8</volume>, <fpage>127</fpage>.<pub-id pub-id-type="pmid">25403239</pub-id></mixed-citation>
    </ref>
    <ref id="btv365-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srinath</surname><given-names>S.</given-names></name><name><surname>Gunawan</surname><given-names>R.</given-names></name></person-group> (<year>2010</year>) <article-title>Parameter identifiability of power-law biochemical system models</article-title>. <source>J. Biotechnol.</source>, <volume>149</volume>, <fpage>132</fpage>–<lpage>140</lpage>.<pub-id pub-id-type="pmid">20197073</pub-id></mixed-citation>
    </ref>
    <ref id="btv365-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Voit</surname><given-names>E.O.</given-names></name><name><surname>Almeida</surname><given-names>J.</given-names></name></person-group> (<year>2004</year>) <article-title>Decoupling dynamical systems for pathway identification from metabolic profiles</article-title>. <source>Bioinformatics</source>, <volume>20</volume>, <fpage>1670</fpage>–<lpage>1681</lpage>.<pub-id pub-id-type="pmid">14988125</pub-id></mixed-citation>
    </ref>
    <ref id="btv365-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zamora-Sillero</surname><given-names>E.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Efficient characterization of high-dimensional parameter spaces for systems biology</article-title>. <source>BMC Syst. Biol.</source>, <volume>5</volume>, <fpage>142</fpage>.<pub-id pub-id-type="pmid">21920040</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
