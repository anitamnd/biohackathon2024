<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="hwp">molbiolevol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2760465</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/msp174</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Biological Sequence Simulation for Testing Complex Evolutionary Hypotheses: indel-Seq-Gen Version 2.0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Strope</surname>
          <given-names>Cory L.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Abel</surname>
          <given-names>Kevin</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Scott</surname>
          <given-names>Stephen D.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Moriyama</surname>
          <given-names>Etsuko N.</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">†</xref>
        <xref ref-type="aff" rid="aff3">‡</xref>
      </contrib>
    </contrib-group>
    <aff id="aff1"><label>*</label>Department of Computer Science and Engineering, University of Nebraska</aff>
    <aff id="aff2"><label>†</label>School of Biological Sciences, University of Nebraska</aff>
    <aff id="aff3"><label>‡</label>Center for Plant Science Innovation, University of Nebraska</aff>
    <author-notes>
      <corresp>E-mail: <email>emoriyama2@unl.edu</email>.</corresp>
      <fn>
        <p>Sudhir Kumar, Associate Editor</p>
      </fn>
    </author-notes>
    <!--Fake ppub date generated  by PMC from publisher pub-date/@pub-type='epub-ppub' -->
    <pub-date pub-type="ppub">
      <month>11</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>26</volume>
    <issue>11</issue>
    <fpage>2581</fpage>
    <lpage>2593</lpage>
    <history>
      <date date-type="accepted">
        <day>29</day>
        <month>7</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2009 The Authors</copyright-statement>
      <copyright-year>2009</copyright-year>
      <license license-type="open-access">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Sequence simulation is an important tool in validating biological hypotheses as well as testing various bioinformatics and molecular evolutionary methods. Hypothesis testing relies on the representational ability of the sequence simulation method. Simple hypotheses are testable through simulation of random, homogeneously evolving sequence sets. However, testing complex hypotheses, for example, local similarities, requires simulation of sequence evolution under heterogeneous models. To this end, we previously introduced indel-Seq-Gen version 1.0 (iSGv1.0; indel, insertion/deletion). iSGv1.0 allowed heterogeneous protein evolution and motif conservation as well as insertion and deletion constraints in subsequences. Despite these advances, for complex hypothesis testing, neither iSGv1.0 nor other currently available sequence simulation methods is sufficient. indel-Seq-Gen version 2.0 (iSGv2.0) aims at simulating evolution of highly divergent DNA sequences and protein superfamilies. iSGv2.0 improves upon iSGv1.0 through the addition of lineage-specific evolution, motif conservation using PROSITE-like regular expressions, indel tracking, subsequence-length constraints, as well as coding and noncoding DNA evolution. Furthermore, we formalize the sequence representation used for iSGv2.0 and uncover a flaw in the modeling of indels used in current state of the art methods, which biases simulation results for hypotheses involving indels. We fix this flaw in iSGv2.0 by using a novel discrete stepping procedure. Finally, we present an example simulation of the calycin-superfamily sequences and compare the performance of iSGv2.0 with iSGv1.0 and random model of sequence evolution.</p>
    </abstract>
    <kwd-group>
      <kwd>protein superfamily</kwd>
      <kwd>sequence simulation</kwd>
      <kwd>domains</kwd>
      <kwd>motifs</kwd>
      <kwd>indels</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>The goal of simulating sequence evolution is to realistically portray the evolutionary wrestling match between 1) processes that change a biological sequence through point mutations, insertion/deletion (indel), as well as more dynamic chromosomal rearrangement, and 2) functional constraints of a sequence that restrict such changes. Such processes are intertwined during the course of evolution, forming the patterns that we see in extant homologous biological sequences.</p>
    <p>When sequence simulation was initiated, simulation methods mainly dealt with substitution processes, incorporating information on substitution patterns, relative substitution rates across sites based on the Gamma distribution, and sites that are invariable throughout the evolutionary history of a group of sequences (<xref ref-type="bibr" rid="bib33">Yang 1994</xref>; <xref ref-type="bibr" rid="bib22">Rambaut and Grassly 1997</xref>). These simulation methods, however, did not incorporate processes of insertion and deletion of sequence positions, that is, indels.</p>
    <p>The pioneering sequence simulation application to introduce indel events is random model of sequence evolution (ROSE; <xref ref-type="bibr" rid="bib27">Stoye et al. 1998</xref>). ROSE extended the Gamma distribution to encompass indel constraints as well, that is, if the Gamma substitution rate is below a certain threshold, it forbids an indel to occur in the region. ROSE also provides the “true” multiple alignment that reflects the true evolutionary path of the sequences. True multiple alignments can be used to test the accuracy of multiple sequence alignment methods and various hypotheses (<xref ref-type="bibr" rid="bib26">Stoye et al. 1997</xref>; <xref ref-type="bibr" rid="bib15">Lassmann and Sonnhammer 2002</xref>; <xref ref-type="bibr" rid="bib29">Subramanian et al. 2005</xref>). However, due to the limitations in biological realism with simulated sequences, benchmark data sets are generated based on mainly hand-curated or structure-based alignments of protein sequences (<xref ref-type="bibr" rid="bib21">Raghava et al. 2003</xref>; <xref ref-type="bibr" rid="bib7">Edgar 2004</xref>; <xref ref-type="bibr" rid="bib29">Subramanian et al. 2005</xref>; <xref ref-type="bibr" rid="bib30">Thompson et al. 2005</xref>; <xref ref-type="bibr" rid="bib31">van Walle et al. 2005</xref>). These data sets also have limitations, such as their small data set size and ambiguous positional homology among others (<xref ref-type="bibr" rid="bib17">Notredame 2007</xref>). Furthermore, the benchmark alignments cannot be used for testing phylogenetic methods, because the evolutionary history among the sequences is unknown. The primary advantage of simulated data sets is that the true evolutionary history of the sequences is known.</p>
    <p>To improve the realism of simulated sequences, two areas must be addressed: sequence conservation and indel processes. <xref ref-type="table" rid="tbl1">Table 1</xref> compares the functions of various simulation methods. Lineage- and site-specific conservation as well as heterogeneous evolution is needed to improve the realism of sequence evolution simulators. Homogeneous sequence evolution, as illustrated in <xref ref-type="fig" rid="fig1">figure 1<italic>B</italic></xref>, is found in many simulation methods, including EvolveAGene3 (<xref ref-type="bibr" rid="bib11">Hall 2008</xref>) and DNA assembly with gaps (DAWG; <xref ref-type="bibr" rid="bib3">Cartwright 2005</xref>). Richer representations allow heterogeneous evolution among sequence “partitions,” where each partition can be defined by a different set of substitution and indel parameters (e.g., <xref ref-type="fig" rid="fig1">fig. 1<italic>C</italic></xref>, gray lineage). SIMPROT (<xref ref-type="bibr" rid="bib18">Pang et al. 2006</xref>) and iSGv1.0 (<xref ref-type="bibr" rid="bib28">Strope et al. 2007</xref>) include such “partition”wise simulation. For site-specific conservation, the current state of the art is found in iSGv1.0 and ROSE (<xref ref-type="bibr" rid="bib26">Stoye et al. 1997</xref>), implemented by disallowing sites and subsequences from accepting indels. Site-specific substitution processes, however, are either constrained to be either completely invariable or mutable to any other character. Thus, functional constraints on substitution patterns within the conserved region cannot be simulated, although functional regions often depend on the properties of their residues to maintain their functions. This inability to conserve residue sets in the sequences affects the ability to simulate highly diverged superfamily-level evolution. Lineage-specific evolution is represented only by MySSP (<xref ref-type="bibr" rid="bib23">Rosenberg 2005</xref>), which allows users to set substitution and indel parameters on each branch of the input guide tree.</p>
    <table-wrap id="tbl1" position="float">
      <label>Table 1</label>
      <caption>
        <p>A Comparison of Sequence Simulation Methods</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td align="center" rowspan="1" colspan="1">ROSE</td>
            <td align="center" rowspan="1" colspan="1">DAWG</td>
            <td align="center" rowspan="1" colspan="1">MySSP</td>
            <td align="center" rowspan="1" colspan="1">SIMPROT v1.03</td>
            <td align="center" rowspan="1" colspan="1">iSGv1.0</td>
            <td align="center" rowspan="1" colspan="1">EvolveAGene3</td>
            <td align="center" rowspan="1" colspan="1">iSGv2.0</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td colspan="8" rowspan="1">Data simulated</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Noncoding DNA</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Coding DNA</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Protein</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No<xref ref-type="table-fn" rid="tblfn1">a</xref></td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td colspan="8" rowspan="1">Indel treatment</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Continuous</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Dynamic length adjustment</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Event tracking</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    <italic>P</italic><sub>ins</sub>, <italic>P</italic><sub>del</sub> independent</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Indel placement treated differently</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Empirical length distribution<xref ref-type="table-fn" rid="tblfn2">b</xref></td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">CB04</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">CB04,QG01</td>
            <td rowspan="1" colspan="1">CB04</td>
            <td rowspan="1" colspan="1">
              <italic>Escherichia coli</italic>
            </td>
            <td rowspan="1" colspan="1">CB04</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Overlapping indels</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td colspan="8" rowspan="1">Heterogeneous evolution (partitions)</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Gamma distribution</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Invariable site proportion</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Indel probabilities</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td colspan="8" rowspan="1">Lineage treatment &amp; functional constraints</td>
          </tr>
          <tr>
            <td colspan="8" rowspan="1">Lineage options</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Parameter changing</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Pseudogene simulation</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td colspan="8" rowspan="1">Indel modeling</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Indel depends on <italic>N</italic><sub>ins</sub>, <italic>N</italic><sub>del</sub></td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td colspan="8" rowspan="1">Motif conservation</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Lineage-specific</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Length-specific</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">    Site-specific</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <label>a</label>
          <p>EvolveAGene3 can output amino acid sequences. However, simulation is done only at the DNA level. The amino acid sequence outputs are translations of the resulting DNA sequences.</p>
        </fn>
        <fn id="tblfn2">
          <label>b</label>
          <p>CB04: Zipfian distribution (<xref ref-type="bibr" rid="bib4">Chang and Benner 2004</xref>), QG01: Qian–Goldstein distribution (<xref ref-type="bibr" rid="bib20">Qian and Goldstein 2001</xref>).</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <fig id="fig1" position="float">
      <label>F<sc>IG</sc>. 1.—</label>
      <caption>
        <p>A comparison of the basic simulation paradigm and more realistic biological sequence evolution. (<italic>A</italic>) Substitution (<italic>Θ</italic>) and indel (<italic>Λ</italic>) parameters used for simulation methods. (<italic>B</italic>) The basic simulation paradigm. Given a root sequence and a global set of substitution and indel parameters (<italic>Θ<sub>G</sub></italic> and <italic>Λ<sub>G</sub></italic>, respectively), simulation proceeds by applying changes in a Monte Carlo manner over all sequence positions, following the guide tree and ending with a set of operational taxonomic units (OTUs). (<italic>C</italic>) More realistic biological sequence evolution. Starting with a root sequence and an initial level of substitution and indel parameters (<italic>Θ<sub>G</sub></italic> and <italic>Λ<sub>G</sub></italic>, respectively), evolution at sites may become constrained by gaining a functional motif (the gray box shown in the gray lineage), and the substitution and indel parameters may be changed (<italic>Θ<sub>L</sub></italic> and <italic>Λ<sub>L</sub></italic>) or the initial parameters are maintained without gaining any functional motif as shown with OTU<italic><sub>X</sub></italic>.</p>
      </caption>
      <graphic xlink:href="molbiolevolmsp174f01_ht"/>
    </fig>
    <p>For ROSE, indels are simulated based only upon user-input probabilities and length distributions. Other sequence evolution simulators follow similar schemes but add novel functionalities that fit the developers’ purposes. DAWG (<xref ref-type="bibr" rid="bib3">Cartwright 2005</xref>), which simulates noncoding DNA evolution, introduced indels based on an exponential time distribution that determines the waiting time until the next indel event. The waiting time is calculated based on the indel probability as a function of sequence size. DAWG adjusts the sequence length after each indel event, the effect of which is described in more detail in Results. DAWG also introduced an indel length distribution that follows the empirically derived power law distribution of <xref ref-type="bibr" rid="bib4">Chang and Benner (2004)</xref>. MySSP simulates noncoding DNA and chooses indel lengths in a normally distributed fashion centered around a user-input mean length (<xref ref-type="bibr" rid="bib23">Rosenberg 2005</xref>). SIMPROT introduced a parameterized model of another empirically determined indel length model, the Qian–Goldstein distribution (<xref ref-type="bibr" rid="bib20">Qian and Goldstein 2001</xref>), and simulates a continuous indel model by correcting for multiple indels in the same position based on the starting branch length (<xref ref-type="bibr" rid="bib18">Pang et al. 2006</xref>). EvolveAGene3 simulates coding sequences and indel frequencies as empirically observed in <italic>Escherichia coli</italic> evolution (<xref ref-type="bibr" rid="bib11">Hall 2008</xref>). Recently introduced GSIMULATOR directly estimates parameters by training transducers on a set of pairwise alignments and uses these transducers to perform the simulations (<xref ref-type="bibr" rid="bib2">Bradley and Holmes 2007</xref>; <xref ref-type="bibr" rid="bib32">Varadarajan et al. 2008</xref>). Consequently, users cannot set indel parameters in GSIMULATOR. indel-Seq-Gen version 1.0 (iSGv1.0) (<xref ref-type="bibr" rid="bib28">Strope et al. 2007</xref>), which used Seq-Gen (<xref ref-type="bibr" rid="bib22">Rambaut and Grassly 1997</xref>) as the substitution engine, specifically addressed functional subsequence conservation for indels using a novel quaternary invariable array and also allowed for heterogeneous subsequence parameters. In this study, we upgrade iSGv1.0 to indel-Seq-Gen version 2.0 (iSGv2.0) by 1) further improving the realism of biological sequence evolution through the introduction of motif conservation using PROSITE-like regular expressions and lineage-specific evolution and 2) incorporating the DNA substitution engine of Seq-Gen to add both coding and noncoding DNA-sequence simulations. We introduce novel functional constraint enforcement in sequence simulation and formalize how these constraints change the modeling of substitutions, insertions, and deletions (their probabilities of occurrence and placement). We demonstrate a fundamental flaw in simulation of indel processes in many of the current simulation algorithms and perform a comparative analysis of the indel schemes among these methods. In iSGv2.0, we introduce our solution to this problem by incorporating indel simulation in discrete evolutionary steps. The output of iSGv2.0 includes true multiple alignments and information on each indel event including the relative timing and location on the branch (event tracking). iSGv2.0 allows restrictions on minimum and maximum lengths of subsequences by constraining indel events, as is often the case for protein regions with secondary structures. Conservation of folds, as well as motif conservation/gain along different lineages, will be useful to simulate protein superfamily evolution. In addition to the ability to conserve subsequence lengths in DNA sequences, exon–intron structure can also be incorporated to coding-sequence simulation.</p>
    <p>iSGv2.0 is the first tool that is capable of simulating complex substitution and indel processes in constrained evolutionary scenarios. iSGv2.0 incorporates coding DNA, noncoding DNA, and protein simulation. It allows for testing problems such as phylogenetic reconstruction, functional-site inference, joint estimation of alignment and phylogeny, and multiple sequence alignments. As an example of a complex evolutionary scenario, we present a simulation of calycin protein superfamily evolution.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and Methods</title>
    <p>We first describe the discrete evolution paradigm introduced in iSGv2.0, along with the implications for substitution and indel evolution. We formalize the sequence representation for simulating evolutionary events such as substitutions and indels for a functionally constrained sequence. We then describe iSGv2.0′s other novel mechanisms: 1) lineage-specific models, 2) site-specific functional constraints, 3) coding DNA-sequence simulation, and 4) indel-event tracking.</p>
    <sec>
      <title>Discrete Evolution</title>
      <p>The most fundamental structure needed for sequence simulation is the guide tree, which specifies the branching order and the expected number of substitutions that will occur from an ancestral sequence to its descendant. Substitution processes are generally modeled over continuous time, allowing multiple substitutions at the same site. No established model exists for insertions and deletions. Current sequence simulation methods introduce indels in a continuous fashion (<xref ref-type="bibr" rid="bib26">Stoye et al. 1997</xref>; <xref ref-type="bibr" rid="bib23">Rosenberg 2005</xref>; <xref ref-type="bibr" rid="bib18">Pang et al. 2006</xref>; <xref ref-type="bibr" rid="bib28">Strope et al. 2007</xref>; <xref ref-type="bibr" rid="bib11">Hall 2008</xref>), even though indels alter the sequence length, as shown in <xref ref-type="fig" rid="fig2">figure 2</xref>. In order to keep the indel rate constant along the branch, the number of expected indels needs to be recalculated based on the sequence length after each event. The current continuous model uses the same rate no matter how many positions are inserted or deleted along the branch. Consequently, the number of events can be under or overestimated, which in turn incorrectly decreases or increases the indel rate after insertion or deletion events, respectively, for the remainder of the branch until the probability of an indel event is recalculated based on the length of the descendant sequence at the next node. The order and time of events within the branch are also unknown in the continuous model of sequence evolution, because the expected numbers of substitutions and indels are estimated based on the entire branch length.</p>
      <fig id="fig2" position="float">
        <label>F<sc>IG</sc>. 2.—</label>
        <caption>
          <p>The continuous and discrete-step models of indel events. The continuous model calculates the expected number of indel events based on sequence length at node <italic>i</italic> and uses this same value throughout the branch length, <italic>BL<sub>i</sub></italic><sub>→<italic>i</italic>+1</sub>. This causes either over or underestimating the number of indels along the branch until recalculating the expected number of indel events at node <italic>i</italic> + 1. The discrete-step model reduces the impact of this by recalculating the expected number of indel events based on the sequence length after each such event.</p>
        </caption>
        <graphic xlink:href="molbiolevolmsp174f02_ht"/>
      </fig>
      <p>To minimize the effects of sequence-length changes and to allow for event tracking (described later in this section), iSGv2.0 simulates sequence evolution with discrete steps using a sufficiently small step size. The step size <italic>ε</italic> is defined as<disp-formula id="fd1"><label>(1)</label><inline-graphic xlink:href="molbiolevolmsp174fx1_ht.jpg"/></disp-formula>where max_path is the maximum length of the root-to-tip paths in the guide tree. The constant <italic>c</italic> is set such that <italic>ε</italic> is less than 0.01 substitutions per site or smaller than the minimum branch length. If the minimum branch length is less than 0.00001, which is the minimum value <italic>ε</italic> can take, it is considered to be a zero branch length. We call this simulation method the “discrete evolutionary steps” (DES) model.</p>
      <sec>
        <title>Substitution and Indel Models</title>
        <p>The branch lengths given in the guide tree determine the rates of evolution, which are expressed as the number of substitutions per site for the branch and are introduced based on models of continuous substitution evolution processes, for example, Jones–Taylor–Thornton (<xref ref-type="bibr" rid="bib14">Jones et al. 1992</xref>), PAM (<xref ref-type="bibr" rid="bib6">Dayhoff et al. 1978</xref>), or BLOSUM (<xref ref-type="bibr" rid="bib13">Henikoff and Henikoff 1992</xref>) for proteins, and Hasegawa–Kishino–Yano (<xref ref-type="bibr" rid="bib12">Hasegawa et al. 1985</xref>) or general time reversible model (<xref ref-type="bibr" rid="bib33">Yang 1994</xref>) for nucleotides. In the current simulation methods, indels are also introduced in a continuous fashion. As mentioned earlier, this continuous method assumes that the length of the sequence will remain the same during the evolution along the branch (<xref ref-type="fig" rid="fig2">fig. 2</xref>). This is clearly incompatible with insertion and deletion processes and is the primary motivation for adopting the DES model. In the following section, we formalize the model of insertions and deletions with respect to the sequence and functional constraints, which will make clear the flaw in the indel representation used in current methods.</p>
      </sec>
      <sec>
        <title>Formalization of Substitution and Indel Processes</title>
        <p>Note that although we refer to our model as “discrete,” our substitution processes are simulated using the continuous evolutionary models described above, the difference being that substitutions are simulated in multiple <italic>ε</italic>-sized steps. With respect to insertion and deletion processes, most simulation methods treat them similarly. However, insertions, deletions, and substitutions all work differently with respect to the sequence and functional constraints placed on them. One major difference between insertion and deletion processes is that insertions occur “between” sites, whereas deletions occur “on” sites. This fundamental difference not only affects the number of sites that can accept a deletion versus an insertion but also introduces maximum and minimum length requirements to subsequences in order to enforce possible selective constraints on such subsequence length. This in turn restricts the number of acceptable deletion and insertion lengths in subsequences. <xref ref-type="fig" rid="fig3">Figure 3</xref> specifies the model of these constraints for realistic sequence evolution, where the positions <italic>X</italic><sub>3</sub><italic>L</italic> to <italic>X</italic><sub>6</sub>, for example, approximate the “CXXC” motif of Thioredoxin-fold proteins (<xref ref-type="bibr" rid="bib5">Chivers et al. 1996</xref>). Although amino acids <italic>X</italic><sub>3</sub> and <italic>X</italic><sub>6</sub> can be neither changed nor deleted, amino acids <italic>X</italic><sub>4</sub> and <italic>X</italic><sub>5</sub> can be substituted but cannot be deleted. Furthermore, the length from <italic>X</italic><sub>3</sub> to <italic>X</italic><sub>6</sub> (four residues) is constrained and no indel is allowed in this region.</p>
        <fig id="fig3" position="float">
          <label>F<sc>IG</sc>. 3.—</label>
          <caption>
            <p>A sequence model that includes substitutions (Sub), insertions (Ins), and deletions (Del) for a length-constrained subsequence <italic>S</italic>(<italic>X</italic><sub>0</sub>,<italic>X</italic><sub>1</sub>…<italic>X</italic><sub>7</sub>, where <italic>X<sub>i</sub></italic> is the <italic>i</italic>th residue of the sequence). The description of the symbols used and their effects are listed in the table below. For example, positions <italic>X</italic><sub>3</sub>…<italic>X</italic><sub>7</sub> are conserved in a way akin to the CXXC motif of the Thioredoxin sequence motif (<xref ref-type="bibr" rid="bib5">Chivers et al. 1996</xref>). The maximum lengths of insertions are shown above the sequence ranging from 0 (no insertion), 1, 2,… to <italic>i</italic><sub>S</sub> (upper bound of the subsequence length). The maximum lengths of deletions are determined by either 1) the number of sequence positions to the first deletion-constrained position (2 for <italic>X</italic><sub>1</sub> in this figure) or <italic>d</italic><sub>S</sub>, defined as the number of positions that can be deleted before reaching the minimum subsequence length.</p>
          </caption>
          <graphic xlink:href="molbiolevolmsp174f03_ht"/>
        </fig>
      </sec>
      <sec>
        <title>Novel Indel Characterization</title>
        <p>Indel modeling requires four parameters: <italic>Λ</italic> = {<italic>P</italic><sub>ins</sub>, <italic>P</italic><sub>del</sub>, <italic>λ</italic><sub>ins</sub>, <italic>λ</italic><sub>del</sub>}, where <italic>P</italic><sub>ins</sub> and <italic>P</italic><sub>del</sub> are the probabilities of an insertion and a deletion, respectively, and <italic>λ</italic><sub>ins</sub> and <italic>λ</italic><sub>del</sub> are the length probability distributions defined as<disp-formula id="fd2"><label>(2)</label><inline-graphic xlink:href="molbiolevolmsp174fx2_ht.jpg"/></disp-formula>where <italic>x</italic> is the number of residues and <italic>x</italic><sub>max</sub> is the maximum insertion or deletion size. <italic>λ</italic><sub>del</sub> is defined similarly as <italic>λ</italic><sub>ins</sub>. For convenience, we assume <italic>λ</italic><sub>ins</sub> = <italic>λ</italic><sub>del</sub> for the remainder of this section, although iSGv2.0 does allow for <italic>λ</italic><sub>ins</sub> and <italic>λ</italic><sub>del</sub> to be different. <italic>f</italic>(<italic>x</italic>) is the probability density function of indel lengths.</p>
      </sec>
      <sec>
        <title>Simulating Indel Occurrence</title>
        <p>As shown in <xref ref-type="fig" rid="fig3">figure 3</xref>, the maximum number of sites that potentially accept insertions is equal to the number of positions plus 1. Therefore, for an unconstrained sequence at node <italic>i</italic> with <italic>N</italic>(<italic>i</italic>) residues, the number of sites that accept insertions, <italic>N</italic><sub>ins</sub>(<italic>i</italic>), is <italic>N</italic>(<italic>i</italic>) + 1, whereas the maximum number of sites that potentially accept deletions, <italic>N</italic><sub>del</sub>(<italic>i</italic>), is <italic>N</italic>(<italic>i</italic>).</p>
        <p>The expected number of residues at node <italic>N</italic>(<italic>i</italic> + 1<italic>)</italic> is calculated as<disp-formula id="fd3"><label>(3)</label><inline-graphic xlink:href="molbiolevolmsp174fx3_ht.jpg"/></disp-formula>where <italic>BL<sub>i</sub></italic><sub>→<italic>i</italic>+1</sub> is the branch length from node <italic>i</italic> to node <italic>i</italic> <italic>+</italic> 1 and <italic>N</italic><sub>ins</sub>(<italic>i</italic>) = <italic>N</italic>(<italic>i</italic>) + 1, <italic>N</italic><sub>del</sub>(<italic>i</italic>) = <italic>N</italic>(<italic>i</italic>). BL<sub><italic>i</italic> → <italic>i</italic> + 1</sub> × <italic>N</italic><sub>ins</sub>(<italic>i</italic>) × <italic>P</italic><sub>ins</sub> and BL<sub><italic>i</italic> → <italic>i</italic> + 1</sub> × <italic>N</italic><sub>del</sub>(<italic>i</italic>) × <italic>P</italic><sub>del</sub> are the expected numbers of insertions and deletions on the branch <italic>i</italic> → <italic>i</italic> + 1, respectively. Note that in equation <xref ref-type="disp-formula" rid="fd3">(3)</xref>, each time an indel event occurs, <italic>N</italic><sub>ins</sub>(<italic>i</italic>) and <italic>N</italic><sub>del</sub>(<italic>i</italic>) fluctuate, in turn changing the expectation of future indel events for the remainder of <italic>BL<sub>i</sub></italic><sub>→<italic>i+</italic>1</sub>. For brevity, hereafter, we avoid using the node index (<italic>i</italic>) unless it is necessary. Thus, for example, we use <italic>N</italic><sub>ins</sub> instead of <italic>N</italic><sub>ins</sub>(<italic>i</italic>).</p>
        <p>With constraints as shown in <xref ref-type="fig" rid="fig3">figure 3</xref>, the number of sites available for insertion (<italic>N</italic><sub>ins</sub><sup>′</sup>) and deletion (<italic>N</italic><sub>del</sub><sup>′</sup>) is subject to the constraints <italic>N</italic><sub>del</sub><sup>′</sup> ≤<italic>N</italic><sub>del</sub> = <italic>N</italic> and <italic>N</italic><sub>ins</sub><sup>′</sup> ≤ <italic>N</italic><sub>ins</sub> = <italic>N</italic> + 1. Therefore, under these constraints, equation <xref ref-type="disp-formula" rid="fd3">(3)</xref> becomes<disp-formula id="fd4"><label>(4)</label><inline-graphic xlink:href="molbiolevolmsp174fx4_ht.jpg"/></disp-formula>Most current simulation methods do not correct for sequence-length fluctuation during the evolution with indels, which causes either the underestimation or overestimation of the number of events that will occur for the remainder of the branch as illustrated in <xref ref-type="fig" rid="fig2">figure 2</xref>. In Results and Discussion, we examine the consequences of these oversights.</p>
      </sec>
    </sec>
    <sec>
      <title>Lineage-Specific Evolution</title>
      <p>iSGv2.0 accepts guide trees in Newick format with clade labels. Specifying clades allows lineage-specific parameters to be set. The sequence parameters (character frequency, proportion of invariable sites, site rates, and substitution matrix) and indel parameters (maximum indel size, <italic>P</italic><sub>ins</sub>, <italic>P</italic><sub>del</sub>, <italic>λ</italic><sub>ins</sub>, and <italic>λ</italic><sub>del</sub>) can be changed among subtrees (clades). iSGv2.0 also provides a lineage-specific flag for a lineage evolving as a pseudogene. With this flag, all constraints to the sequence positions, that is, invariable array, positional <italic>γ</italic> parameters, and codon rates are removed. It causes the lineage to evolve with a uniform rate and unconstrained for indel events across all sites.</p>
    </sec>
    <sec>
      <title>Functional Constraint Modeling</title>
      <sec>
        <title>Site-Specific Constraints</title>
        <p>iSGv2.0 introduces site-specific conservation using regular expression patterns found in PROSITE (<xref ref-type="bibr" rid="bib25">Sigrist et al. 2002</xref>). The quaternary invariable array introduced in iSGv1.0 (<xref ref-type="bibr" rid="bib28">Strope et al. 2007</xref>) is also retained because of its simplicity of representation. Because motifs are preserved along lineages, sites that correspond with the potential motif in the ancestral sequences still carry the length constraints of the motif, that is, motifs cannot be gained from insertions and potential motif sites cannot be deleted. Although indels are constrained on these sites, substitutions are freely accepted until the sites are accepted as the motif. When the site becomes a part of the motif, which occurs when the site is mutated into a motif-satisfying residue, the site becomes constrained based on the patterns specified in the motif. These constraints on a motif, by definition, cause a slower evolutionary rate within the motif region. Thus, iSGv2.0 compensates for the slower evolutionary rate by increasing the substitution rate in the partition that includes the motifs so that the resultant sequences will evolve at the expected rate, on average, based on the input branch length. For a motif with <italic>k</italic> characters, <italic>m</italic> = <italic>m</italic><sub>0</sub> … <italic>m</italic><sub>k − 1</sub>, we calculate the average rate of substitution rejection at each motif site, <inline-formula><mml:math id="n15"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, as follows:<disp-formula id="fd5"><label>(5)</label><inline-graphic xlink:href="molbiolevolmsp174fx5_ht.jpg"/></disp-formula>where <italic>a<sub>n</sub></italic> is the set of acceptable residues for the motif position <italic>n</italic>, |<italic>a<sub>n</sub></italic>| is the number of acceptable residues in the set, and <italic>s<sub>ij</sub></italic> is the probability of substitution of residue <italic>i</italic> to residue <italic>j</italic> (for the chosen substitution matrix and character frequencies) over the DES size <italic>ε</italic>. The term <inline-formula><mml:math id="n16"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability of rejected substitutions from residue <italic>i</italic>. We then define <inline-formula><mml:math id="n17"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>, the amount of reduction in evolutionary rate in the motif. Because the expected number of substitutions in an unconstrained sequence with <italic>N</italic> characters along the branch length BL is <italic>N</italic> × <italic>BL</italic>, adjusting for the reduced evolutionary rate in the motif, we calculate <italic>BL</italic>′ as follows:<disp-formula id="fd6"><label>(6)</label><inline-graphic xlink:href="molbiolevolmsp174fx6_ht.jpg"/></disp-formula></p>
      </sec>
      <sec>
        <title>Subsequence-Length Constraints</title>
        <p>Protein family sequences are often composed of a set of domains that define the folding pattern of member sequences. Functional domains are often under length constraints whose violation could be detrimental to protein function, such as the destabilization of tertiary structure, improper folding, or removal of functionally important regions. iSGv2.0 represents these constraints through the introduction of a sequence “template.” The template specifies both the minimum and maximum number of residues or nucleotides that can occupy a region. Such constraints limit the number of insertion or deletion events. An example of sequence templates is given in <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">supplementary figure S1</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online.</p>
      </sec>
    </sec>
    <sec>
      <title>Nucleotide Sequence Simulation</title>
      <p>Coding and noncoding nucleotide sequence simulation has been added to iSGv2.0 using the substitution engine Seq-Gen (<xref ref-type="bibr" rid="bib22">Rambaut and Grassly 1997</xref>). In the coding-sequence simulation, exons and introns can be specified as partitions. Exons are influenced by different rates for codon positions and restriction of stop codon formation. Introns can split codons (i.e., phase 1 and phase 2 introns). In introns, elements (such as the lariat formation sites) can be controlled by the quaternary invariable array and through motifs. Indel length distributions for exons can be set to zero for all lengths not divisible by 3 to avoid introducing frameshifting indel mutations. Although Indels in exons can be restricted to be between codons, such restrictions are not mandatory.</p>
    </sec>
    <sec>
      <title>Event Tracking</title>
      <p>One benefit introduced with the DES model is the ability to track indel events by the time of the events, affected taxa, event type (insertion or deletion), and indel length. The positions of indels can be reported in the true alignment. Along with the DES model, iSGv2.0 has added a new presentation method, “time-relative steps” (TRS). With the TRS presentation, the tree is rescaled relative to the time. The resultant tree is “ultrametric-like,” having equal height (time) from the root to tips, which allows the mapping of all indel events with respect to the relative time of occurrence. <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary figure S2</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online, illustrates this TRS presentation. With the TRS presentation, events are reported as an ordered list based on the relative time of occurrence as shown in <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">supplementary figure S2C</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online. When the TRS presentation is not used, events are listed by partition.</p>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>iSGv.2.0 is written in ANSI C++. iSGv2.0 calculates substitution probabilities using the Seq-Gen (<xref ref-type="bibr" rid="bib22">Rambaut and Grassly 1997</xref>) formulation. Only rooted trees can be used as guide trees. It has been tested on Linux, Mac OS X 10.4–10.5, and also on Windows XP running MinGW (<ext-link ext-link-type="uri" xlink:href="http://www.mingw.org/">http://www.mingw.org/</ext-link>), MSYS, and GNU gzip and tar. It is packaged using GNU autotools and should compile on most systems with a standard C++ compiler. The output can be in PHYLIP, Nexus, and FASTA formats. iSGv2.0 (executables and source codes) and its user manual describing the functionalities are freely available at <ext-link ext-link-type="uri" xlink:href="http://bioinfolab.unl.edu/~cstrope/iSG/">http://bioinfolab.unl.edu/∼cstrope/iSG/</ext-link>.</p>
    </sec>
    <sec>
      <title>Indel Simulation Comparison</title>
      <p>We compared seven indel-capable simulation methods, including iSGv1.0 and iSGv2.0. These methods are listed in <xref ref-type="table" rid="tbl1">table 1</xref>. Two tests were performed to examine the indel formulation of each method. In the first test, we analyzed the over and underestimation of insertions and deletions individually for each simulation method using guide trees with varying numbers of internal nodes. In the second test, a similar analysis was done, varying the relative rates of insertions versus deletions.</p>
      <p>Note that the indel scheme implemented in EvolveAGene3 (<xref ref-type="bibr" rid="bib11">Hall 2008</xref>) is very different from other methods. EvolveAGene3 simulates codon evolution based on empirical models obtained from <italic>E. coli</italic>. EvolveAGene3 calculates indel probabilities with two spectra: The first spectrum determines the event to take place, with probabilities to be 0.6284, 0.0744, or 0.2972 for a substitution, insertion, or deletion, respectively. In the second spectrum, EvolveAGene3 determines the indel length, rejecting any event that is not a factor of 3. For the second spectrum, we summed up the probabilities of all acceptable lengths to obtain single accepting probabilities for insertions and deletions: 0.144 and 0.261, respectively, and used them for each type of event regardless of the length. “Selection against deletions and insertions” were both set to 1 (no selection). Thus, with EvolveAGene3, the insertion and deletion probabilities are 0.0107 = 0.0744 × 0.144 × 1 and 0.0776 = 0.2972 × 0.261 × 1, respectively (“event probability” × “accepting probability” × selection against insertions or deletions). We also modified the EvolveAGene3 code to allow frameshifting indel mutations, in order to create similar indel-generation conditions with other methods.</p>
      <sec>
        <title>Experimental Setup</title>
        <p>For our tests, we set the total tree length to be 8 substitutions per site, with an indel rate of 1 insertion or deletion per 50 substitutions. For EvolveAGene3, insertion and deletion rates were 0.535 and 3.88 per 50 substitutions, respectively, as explained above. We simulated with random root sequences of 1,000 characters. DNA sequences were generated by DAWG, EvolveAGene3, and MySSP, and protein sequences were generated by ROSE, SIMPROT, iSGv1.0, and iSGv2.0. The difference in character sets (DNA or protein) is of no consequence in our tests for two reasons: 1) We used the same indel length distributions for both sets and 2) we set the probability of insertion and deletion occurrence equally regardless of the character set. <xref ref-type="fig" rid="fig4">Figure 4</xref> illustrates the four simple guide trees with varied numbers of internal nodes. At each node, the external branch was set to zero length, as shown in the Newick format in <xref ref-type="fig" rid="fig4">figure 4</xref>, effectively making it a leaf node, so that the direct effect of the different number of nodes can be examined. We performed two tests: 1) simulating insertions alone or deletions alone and 2) simulating both insertions and deletions with varying relative rates. Test 1 is intended to show the effect of the indel placement paradigms of each sequence simulation method. Test 2 is intended to show the effect of the indel methods when both insertions and deletions are generated. If insertions and deletions are simulated properly, all simulation runs are expected to return similar numbers of insertions or deletions regardless of the number of internal nodes, because all four guide trees have identical lengths. Differing results between guide trees implies that adding branching points (nodes) affects the remainder of evolution, which is clearly undesirable.</p>
        <fig id="fig4" position="float">
          <label>F<sc>IG</sc>. 4.—</label>
          <caption>
            <p>The four simple guide trees and their corresponding Newick formats used to test indel simulation schemes. These have 0, 1, 3, and 7 branching points for Trees 1, 2, 3, and 4, respectively. Note that at each branching point (or node), one branch is given a zero length branch, as shown in the Newick format. The total length of the guide tree is set to eight substitutions per site. Branching points are named from “node0” (at the root) to “node8.” During the simulation, sequences are saved at each internal node as well as terminal nodes and used for indel analysis.</p>
          </caption>
          <graphic xlink:href="molbiolevolmsp174f04_lw"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Protein Superfamily Comparison</title>
      <p>To present the sequence simulation capabilities of iSGv2.0, we simulated the calycin-superfamily proteins. We performed the simulation using iSGv2.0, ROSE, and iSGv1.0, and compared their simulation results.</p>
      <sec>
        <title>Overview of the Calycin Superfamily</title>
        <p>In the Structural Classification of Proteins database (<xref ref-type="bibr" rid="bib16">Lo Conte et al. 2000</xref>), they belong to the “all-beta proteins” class. The calycin superfamily consists of a number of beta-barrel protein families, such as the lipocalins, avidins, and metalloproteinase inhibitors (MPIs). As illustrated in <xref ref-type="fig" rid="fig7">figure 7</xref>, the lipocalin family proteins have three structurally conserved regions (SCRs 1, 2, and 3; <xref ref-type="bibr" rid="bib9">Flower et al. 2000</xref>). Lipocalins are divided into two groups: kernel lipocalins, which contain all three SCRs, and outlier lipocalins, which contain at least one SCR. Each group of lipocalins is further divided into subfamilies. The avidin family contains a motif different from the lipocalins, whereas the MPIs have no motif recorded.</p>
      </sec>
      <sec>
        <title>Experimental Setup</title>
        <p>We sampled two sequences each from the avidins, MPIs, two subfamilies of outlier lipocalins, and four subfamilies of kernel lipocalins. The base alignment of these sequences was obtained using PROMALS3D (<xref ref-type="bibr" rid="bib19">Pei et al. 2008</xref>) with manual adjustment. The alignment, along with the annotated beta-strands and motifs, is given in <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">supplementary figure S1</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online. <xref ref-type="fig" rid="fig7">Figure 7</xref> shows the phylogeny reconstructed using proml from PHYLIP version 3.68 (<xref ref-type="bibr" rid="bib8">Felsenstein 2008</xref>). Based on the phylogeny, we determined the most likely scenario of motif gain and loss as follows: 1) SCR1 was gained before the divergence of the lipocalin family and subsequently lost in the alpha-1-acid glycoprotein lineage; 2) SCR2 and SCR3 were gained before the divergence of the kernel lipocalin family; and 3) the avidin motif was gained after the avidin family was diverged from the MPI family. SCR1 and the avidin motifs are obtained from PROSITE regular expressions PS00213 and PS00577, respectively (<xref ref-type="bibr" rid="bib25">Sigrist et al. 2002</xref>). For SCR2 and SCR3, we gathered the motif alignments in the PRINTS database (the lipocalin family motifs 2 and 3; PR00179: <xref ref-type="bibr" rid="bib1">Attwood et al. 1994</xref>) and calculated the percentage of each amino acid in each column of the alignment. The regular expression patterns were generated using amino acids with at least 5% representation as the acceptable residue set for each alignment position. <xref ref-type="fig" rid="fig7">Figure 7</xref> lists these regular expressions. Using the guide tree shown in <xref ref-type="fig" rid="fig7">figure 7</xref>, we simulated the calycin-superfamily evolution. We specified the template for the input sequences based on the secondary structures of the sequence, and specified four motifs: SCR1, SCR2, SCR3, and the avidin motif. Because iSGv1.0 and ROSE do not have the ability to conserve specific lineages, we chose to conserve the motifs in the global invariable and the I + <italic>γ</italic> arrays, respectively. We conserved fixed-length regions using the invariable array option that forbids indels between sites and held sites with single acceptable states as invariable for all methods. All specifications are available in <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">supplementary figure S1</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online. We simulated 100 data sets for each method. <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary figure S3</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online, gives the input files used for the simulations.</p>
      </sec>
      <sec>
        <title>Indel Statistics</title>
        <p>To test the minimum and maximum subsequence constraints (template) in iSGv2.0, we flagged insertions and deletions in ROSE and iSGv1.0 that broke minimum and maximum subsequence constraints. In order to do this, the template constraints needed to be introduced to each method. It was possible for iSGv1.0 by simulating within the iSGv2.0 template framework. However, we were unable to incorporate ROSE in the iSGv2.0 framework. For ROSE, to detect template-breaking indels, we inspected the true multiple alignment including ancestral sequences. From this alignment, we traversed all root-to-tip paths, examining the regions corresponding to the templated subsequences. When we found an unacceptable number of residues in a region, we counted one template-breaking indel. If the descendant sequences had a region shorter or longer than the corresponding template, we counted another template-breaking indel only if the indel pattern (gap columns) was different from the ancestral sequence.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results|discussion">
    <title>Results and Discussion</title>
    <sec>
      <title>Test 1: Insertions Alone or Deletions Alone</title>
      <p>Our first test was to run insertion-only and deletion-only simulations. Indel lengths were fixed with 1, 2, 4, and 8 residues or bases. We measured the performance of each method by 1) the length of the true multiple alignment for insertions, where the number of sites inserted is equal to the alignment length minus 1,000, and 2) the number of characters remaining in the output sequence for deletions.</p>
      <p><xref ref-type="fig" rid="fig5">Figure 5</xref> and <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">supplementary figure S3</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online, show the test results. The number of internal nodes in the guide tree had an adverse effect on the performance of SIMPROT, iSGv1.0, ROSE, and MySSP (only in the case of insertions). As a side effect of their continuous modeling of indels, overestimation of deletions (<xref ref-type="fig" rid="fig5">fig. 5<italic>A</italic> and <italic>B</italic></xref>) and underestimation of insertions (<xref ref-type="fig" rid="fig5">fig. 5<italic>C</italic> and <italic>D</italic></xref>) are clearly shown with fewer numbers of internal nodes. These methods calculate the expected number of indel events without adjusting the sequence length when an event occurs. DAWG, iSGv2.0, and EvolveAGene3 show no or very slight effects in indel numbers. For DAWG and iSGv2.0, this is because sequence lengths are adjusted dynamically along the branch. The unaffected results by EvolveAGene3 are likely due to the fact that this method treats branch lengths as the number of mutation-event tests that occur along a branch. For our purpose, we set the branch length to 8,000 mutation-event tests (1,000-character sequence with each site undergoing eight substitutions). EvolveAGene3 also forbids overlapping insertions and deletions, effectively reducing the deletion rates with larger deletions. This effect can be seen in <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">supplementary figure S3</ext-link> (I), <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online, where “more” characters are left after simulations with larger deletion sizes. Because of the constant insertion and deletion probabilities set in EvolveAGene3 and our removal of codon constraints in EvolveAGene3, the lengths of the alignments are often shorter than other simulation methods.</p>
      <fig id="fig5" position="float">
        <label>F<sc>IG</sc>. 5.—</label>
        <caption>
          <p>Comparison of indel simulation performance (Test 1) among seven methods. Correct simulations are expected to produce a plot with a horizontal line. Indel sizes used are (<italic>A</italic>) size-1 deletions, (<italic>B</italic>) size-4 deletions, (<italic>C</italic>) size-1 insertions, and (<italic>D</italic>) size-4 insertions. The <italic>y</italic>-axes show the number of characters left in the leaf sequence (<italic>A</italic>,<italic>B</italic>) and the true alignment length (<italic>C</italic>, <italic>D</italic>). The average values obtained from 100 simulations are plotted. The table below summarizes the standard deviations for each data point. <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary figure S4</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online, shows all test results in color.</p>
        </caption>
        <graphic xlink:href="molbiolevolmsp174f05_lw"/>
      </fig>
      <p>These results show that iSGv2.0 and DAWG performed appropriately, producing consistent results regardless of the number of internal nodes. EvolveAGene3 also behaved appropriately according to its own indel model. iSGv1.0, ROSE, SIMPROT, and MySSP are all affected by the number of internal nodes, producing artificially high or low rates for deletions or insertions, respectively.</p>
    </sec>
    <sec>
      <title>Test 2: Including Both Insertions and Deletions with Various <italic>P</italic><sub>ins</sub> and <italic>P</italic><sub>del</sub></title>
      <p>To further examine the effect of indel models, we simulated both insertions and deletions using the Zipfian distribution (<xref ref-type="bibr" rid="bib4">Chang and Benner 2004</xref>) with five methods: DAWG, ROSE, SIMPROT, iSGv1.0, and iSGv2.0. We simulated three scenarios: 1) <italic>P</italic><sub>ins</sub> = 0.01 and <italic>P</italic><sub>del</sub> = 0.03, 2) <italic>P</italic><sub>ins</sub> = 0.02 and <italic>P</italic><sub>del</sub> = 0.02, and 3) <italic>P</italic><sub>ins</sub> = 0.03 and <italic>P</italic><sub>del</sub> = 0.01, where <italic>P</italic><sub>ins</sub> and <italic>P</italic><sub>del</sub> are the number of insertions and deletions per substitution, respectively. We chose to use the Zipfian distribution because it is an empirically determined length distribution for insertion and deletion events. For MySSP, which implements a length distribution that is normally distributed based on the mean indel length given by the user, we used the expected indel length of 2.082, which is based on the Zipfian distribution with a maximum indel size of 10. EvolveAGene3 was excluded from this test because changing <italic>P</italic><sub>ins</sub> and <italic>P</italic><sub>del</sub> fundamentally alters the indel creation method in EvolveAGene3. In this test, an event counter reporting the numbers of insertions and deletions that occurred during the simulation was added to each method. Because we were unable to obtain the source code for MySSP, we calculated the number of events as follows: Each gap in the root sequence in the true multiple alignment is the effect of an insertion in the descendant sequences, and likewise, each gap in the tip sequence is the result of a deletion in the ancestral sequence. To obtain the number of insertion and deletion events, we tallied the total number of gaps in the root and tip sequences, respectively, and divided that number by the mean indel size. We measured the quality of indel simulation by comparing the numbers of insertions and deletions generated. We calculated the coefficient of variation (<italic>σ</italic><sup>2</sup>/<italic>μ</italic>), which is dimensionless and makes results from different simulation methods comparable. If <italic>σ</italic><sup>2</sup>/<italic>μ</italic> ≈ 0, it means that the simulation method behaved similarly between the guide trees (no effect of different number of nodes). A larger <italic>σ</italic><sup>2</sup>/<italic>μ</italic> suggests that the simulation method performed differently between the guide trees with different number of nodes.</p>
      <p><xref ref-type="fig" rid="fig6">Figure 6</xref> and <xref ref-type="table" rid="tbl2">table 2</xref> show the results of this test. As expected, the number of insertions and deletions generated is affected by the insertion and deletion probabilities. For iSGv1.0 and ROSE, when <italic>P</italic><sub>ins</sub> ≠ <italic>P</italic><sub>del</sub>, the number of internal nodes affects both the numbers of insertions and deletions. SIMPROT, as a result of their multiple-hit correction feature, shows much more drastic effects with the internal-node numbers than iSGv1.0 and ROSE when the insertion rate is larger than the deletion rate (<italic>P</italic><sub>ins</sub> = 0.03 and <italic>P</italic><sub>del</sub> = 0.01). Such effects are not shown when the deletion rate is larger (<italic>P</italic><sub>ins</sub> = 0.01 and <italic>P</italic><sub>del</sub> = 0.03). MySSP shows increasing numbers of indels for each test, with the most drastic change occurring when <italic>P</italic><sub>ins</sub> = 0.03 and <italic>P</italic><sub>del</sub> = 0.01. This behavior can be better understood using the results of Test 1, where in the case of insertions, the sequence length grows as more internal nodes are added, but the sequence length is stable for deletions under the same conditions.</p>
      <table-wrap id="tbl2" position="float">
        <label>Table 2</label>
        <caption>
          <p>The Effects of Internal-Node Numbers with Varying Insertion and Deletion Rates among Methods<xref ref-type="table-fn" rid="tblfn3">a</xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td colspan="12" align="center" rowspan="1"><italic>σ</italic><sup>2</sup>/<italic>μ</italic><hr/></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td align="center" colspan="2" rowspan="1">MySSP<hr/></td>
              <td align="center" colspan="2" rowspan="1">SIMPROT<hr/></td>
              <td align="center" colspan="2" rowspan="1">DAWG<hr/></td>
              <td align="center" colspan="2" rowspan="1">iSGv1.0<hr/></td>
              <td align="center" colspan="2" rowspan="1">iSGv2.0<hr/></td>
              <td align="center" colspan="2" rowspan="1">ROSE<hr/></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1">ins</td>
              <td align="center" rowspan="1" colspan="1">del</td>
              <td align="center" rowspan="1" colspan="1">ins</td>
              <td align="center" rowspan="1" colspan="1">del</td>
              <td align="center" rowspan="1" colspan="1">ins</td>
              <td align="center" rowspan="1" colspan="1">del</td>
              <td align="center" rowspan="1" colspan="1">ins</td>
              <td align="center" rowspan="1" colspan="1">del</td>
              <td align="center" rowspan="1" colspan="1">ins</td>
              <td align="center" rowspan="1" colspan="1">del</td>
              <td align="center" rowspan="1" colspan="1">ins</td>
              <td align="center" rowspan="1" colspan="1">del</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">(A) <italic>P</italic><sub>ins</sub> = 0.01, <italic>P</italic><sub>del</sub> = 0.03</td>
              <td align="char" char="." rowspan="1" colspan="1">0.145</td>
              <td align="char" char="." rowspan="1" colspan="1">0.433</td>
              <td align="char" char="." rowspan="1" colspan="1">0.003</td>
              <td align="char" char="." rowspan="1" colspan="1">0.012</td>
              <td align="char" char="." rowspan="1" colspan="1">0.015</td>
              <td align="char" char="." rowspan="1" colspan="1">0.004</td>
              <td align="char" char="." rowspan="1" colspan="1">0.216</td>
              <td align="char" char="." rowspan="1" colspan="1">0.726</td>
              <td align="char" char="." rowspan="1" colspan="1">0.021</td>
              <td align="char" char="." rowspan="1" colspan="1">0.002</td>
              <td align="char" char="." rowspan="1" colspan="1">0.226</td>
              <td align="char" char="." rowspan="1" colspan="1">0.734</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">(B) <italic>P</italic><sub>ins</sub> = 0.02, <italic>P</italic><sub>del</sub> = 0.02</td>
              <td align="char" char="." rowspan="1" colspan="1">0.507</td>
              <td align="char" char="." rowspan="1" colspan="1">0.417</td>
              <td align="char" char="." rowspan="1" colspan="1">0.380</td>
              <td align="char" char="." rowspan="1" colspan="1">0.435</td>
              <td align="char" char="." rowspan="1" colspan="1">0.014</td>
              <td align="char" char="." rowspan="1" colspan="1">0.002</td>
              <td align="char" char="." rowspan="1" colspan="1">0.004</td>
              <td align="char" char="." rowspan="1" colspan="1">0.001</td>
              <td align="char" char="." rowspan="1" colspan="1">0.022</td>
              <td align="char" char="." rowspan="1" colspan="1">0.007</td>
              <td align="char" char="." rowspan="1" colspan="1">0.003</td>
              <td align="char" char="." rowspan="1" colspan="1">0.000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">(C) <italic>P</italic><sub>ins</sub> = 0.03, <italic>P</italic><sub>del</sub> = 0.01</td>
              <td align="char" char="." rowspan="1" colspan="1">4.871</td>
              <td align="char" char="." rowspan="1" colspan="1">1.675</td>
              <td align="char" char="." rowspan="1" colspan="1">2.736</td>
              <td align="char" char="." rowspan="1" colspan="1">0.757</td>
              <td align="char" char="." rowspan="1" colspan="1">0.006</td>
              <td align="char" char="." rowspan="1" colspan="1">0.003</td>
              <td align="char" char="." rowspan="1" colspan="1">0.734</td>
              <td align="char" char="." rowspan="1" colspan="1">0.295</td>
              <td align="char" char="." rowspan="1" colspan="1">0.005</td>
              <td align="char" char="." rowspan="1" colspan="1">0.031</td>
              <td align="char" char="." rowspan="1" colspan="1">0.816</td>
              <td align="char" char="." rowspan="1" colspan="1">0.265</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <label>a</label>
            <p>ins: insertion, del: deletion.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <fig id="fig6" position="float">
        <label>F<sc>IG</sc>. 6.—</label>
        <caption>
          <p>Test 2 results with different indel probability ratios. For each method, the total numbers of insertions (dark bars) and deletions (light bars) generated are shown for simulation experiments using the guide trees with different numbers of segments (see <xref ref-type="fig" rid="fig4">fig. 4</xref>). Note that for MySSP, we used the average expected value of the Zipfian distribution to obtain the results. For all methods, the average values obtained from 100 simulations are used.</p>
        </caption>
        <graphic xlink:href="molbiolevolmsp174f06_ht"/>
      </fig>
      <p><xref ref-type="table" rid="tbl2">Table 2</xref> summarizes the degree of variation (<italic>σ</italic><sup>2</sup>/<italic>μ</italic>) in the numbers of insertions and deletions among Test 2 experiments. For iSGv1.0 and ROSE, we note that the variation in the number of insertion and deletion events is higher trending toward the dominant event-probability as shown in <xref ref-type="fig" rid="fig6">figure 6</xref>, whereas MySSP shows high variability in all tests, although it is most pronounced when the relative insertion rate is high. SIMPROT also shows high variation when <italic>P</italic><sub>ins</sub> = 0.03 and <italic>P</italic><sub>del</sub> = 0.01 or <italic>P</italic><sub>ins</sub> = <italic>P</italic><sub>del</sub>, although it is comparable with iSGv2.0 and DAWG when <italic>P</italic><sub>ins</sub> = 0.01 and <italic>P</italic><sub>del</sub> = 0.03. When <italic>P</italic><sub>ins</sub> = <italic>P</italic><sub>del</sub>, the indel models of iSGv1.0 and ROSE appear to be affected very little by internal-node numbers. Note that when <italic>P</italic><sub>ins</sub> = <italic>P</italic><sub>del</sub>, iSGv2.0 and DAWG show slightly larger <italic>σ</italic><sup>2</sup>/<italic>μ</italic> values than iSGv1.0 and ROSE. This is a consequence of the larger number of steps with indel events and sequence-length evaluations performed by these methods. Simulation as a random walk increases the variance in sequence length at each step. DAWG and iSGv2.0 take much larger numbers of steps (600 and 1,024, respectively) compared with at most eight steps taken by all other simulators. We confirmed this result by varying the number of steps taken by iSGv2 (data not shown).</p>
    </sec>
    <sec>
      <title>Example Application for a Protein Superfamily Simulation</title>
      <p><xref ref-type="fig" rid="fig7">Figure 7</xref> shows examples of “true alignment” output obtained from ROSE and iSGv2.0 (see <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">supplementary fig. S5</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online, for the output including iSGv1.0). As shown in <xref ref-type="table" rid="tbl3">table 3</xref>, iSGv2.0 correctly conserved 80.98% of the sequence positions, whereas iSGv1.0 and ROSE, both of which cannot conserve sets of characters, correctly modeled only 61.82% and 61.88% of the positions, respectively. Of the different motifs, iSGv2.0 perfectly conserved all sites of SCR1 (see <xref ref-type="fig" rid="fig7">fig. 7</xref>). This is because this motif was present in the root alignment and conserved from the beginning of the simulation run along the lipocalin lineage. For other motifs, all substitutions were accepted until the motif became effective later in the tree, after which only substitutions conforming to the position-specific constraints were accepted.</p>
      <table-wrap id="tbl3" position="float">
        <label>Table 3</label>
        <caption>
          <p>Performance Comparison among iSGv1.0, ROSE, and iSGv2.0 for the Calycin Superfamily Simulation<xref ref-type="table-fn" rid="tblfn4">a</xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1">iSGv1.0</td>
              <td align="center" rowspan="1" colspan="1">ROSE</td>
              <td align="center" rowspan="1" colspan="1">iSGv2.0</td>
              <td align="center" rowspan="1" colspan="1">Input Alignment</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Percent sequence identity</td>
              <td align="char" char="." rowspan="1" colspan="1">19.78</td>
              <td align="char" char="." rowspan="1" colspan="1">17.72</td>
              <td align="char" char="." rowspan="1" colspan="1">14.62</td>
              <td align="char" char="." rowspan="1" colspan="1">15.65</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Percent motif positions conserved</td>
              <td align="char" char="." rowspan="1" colspan="1">61.82</td>
              <td align="char" char="." rowspan="1" colspan="1">61.88</td>
              <td align="char" char="." rowspan="1" colspan="1">80.98</td>
              <td align="center" rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Number of template violating indels<xref ref-type="table-fn" rid="tblfn5">b</xref></td>
              <td align="char" char="." rowspan="1" colspan="1">13.18</td>
              <td align="char" char="." rowspan="1" colspan="1">19.91 <xref ref-type="table-fn" rid="tblfn7">d</xref></td>
              <td align="char" char="." rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Number of rejected indels<xref ref-type="table-fn" rid="tblfn6">c</xref></td>
              <td align="center" rowspan="1" colspan="1">NA</td>
              <td align="center" rowspan="1" colspan="1">NA</td>
              <td align="char" char="." rowspan="1" colspan="1">0.38</td>
              <td align="center" rowspan="1" colspan="1">—</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn4">
            <label>a</label>
            <p>Statistics for iSGv1.0, ROSE, and iSGv2.0 are averages from 100 simulations.</p>
          </fn>
          <fn id="tblfn5">
            <label>b</label>
            <p>The number of indels that produced subsequences that were larger or smaller than the maximum or minimum values given by the template specified for iSGv2.0.</p>
          </fn>
          <fn id="tblfn6">
            <label>c</label>
            <p>A rejected indel occurs when a scan of the sequence returns no positions in which an indel can be placed because of subsequence size constraints imposed by the template. NA: not available.</p>
          </fn>
          <fn id="tblfn7">
            <label>d</label>
            <p>Approximate values inferred from the sequences as given in the true multiple alignment including internal nodes in the guide tree.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <fig id="fig7" position="float">
        <label>F<sc>IG</sc>. 7.—</label>
        <caption>
          <p>Simulation of the calycin protein superfamily using ROSE and iSGv2.0. The phylogeny at the top is the guide tree used for the simulation. The signature motifs for each protein sequence (SCR1, SCR2, SCR3, and avidin) are listed by the UniProt protein IDs. Where the motifs are gained or lost are illustrated on the tree by black or gray symbols, respectively. The regular expression patterns defining these motifs are listed below the tree. The input specification data used for these simulations are given in <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">supplementary figure S3</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online. In the output alignments, lowercase letters indicate nonmotif positions, whereas uppercase letters belong to motifs. Each motif is boxed in the alignment, and the identity of the motif is given by the corresponding symbols at the top of the alignment. See <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">supplementary figure S5</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online for the results including iSGv1.0.</p>
        </caption>
        <graphic xlink:href="molbiolevolmsp174f07_ht"/>
      </fig>
      <p>We observed multiple side effects due to the restrictions imposed by the quaternary invariable and <italic>I</italic> + γ arrays of iSGv1.0 and ROSE, respectively. As seen in figure 7 and <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">supplementary figure S5</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online, conserved motifs in the multiple alignment appeared as “islands” where indels were absent. Additionally, invariable sites such as the GXW region of SCR1 were conserved for the entire column of the alignment, despite the fact that it should only be conserved among kernel lipocalins and the outlier lipocalin family of odorant-binding proteins. iSGv1.0 also simulated fewer indels, which is a side effect of the number of alignment positions that contain motif positions, reducing the number of accepting positions for indels. It appears that ROSE uses the absolute number of residues in the sequence to calculate the overall probability of an indel for a branch, regardless of the number of nonaccepting sites for indels. Differences in the indel placements between iSGv1.0 and ROSE versus iSGv2.0 are also evident. As shown in <xref ref-type="fig" rid="fig7">figure 7</xref>, iSGv2.0 has a much higher number of indels along the N- and C-terminal regions of the alignment. This is because these regions had only weak constraints on their sizes: The N-terminal was constrained to 10–43 residues and the C-terminal 10 to 30 residues. During the simulation process, iSGv2.0 determined the size of the indel, and based on both template and motif constraints searched the sequences to find regions that could accept the indel. Most of the larger indels tended to fall in the least constrained regions. Because neither iSGv1.0 nor ROSE has such constraint capabilities, indels were placed wherever they were not forbidden by the quaternary invariable and <italic>I</italic> + <italic>γ</italic> arrays. Furthermore, the superfamily fold could not be modeled by either iSGv1.0 or ROSE. They placed an average of 13.18 and 19.91 template-breaking indels, respectively (<xref ref-type="table" rid="tbl3">table 3</xref>). iSGv2.0 upheld the template restrictions. On average, 0.35 indels per simulation run were rejected using iSGv2.0 because there were limited acceptable positions for indels due to template constraints.</p>
      <p>The input multiple alignment (<ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">supplementary fig. S1</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary Material</ext-link> online) had an average pairwise sequence identity of 15.65% (<xref ref-type="table" rid="tbl3">table 3</xref>). The 20–35% range of sequence identity or lower is the so-called “twilight zone” of sequence identity (<xref ref-type="bibr" rid="bib24">Rost 1999</xref>), which is often seen among proteins belonging to highly divergent families. iSGv1.0, ROSE, and iSGv2.0 simulated data sets in this range, with the average values over 100 runs of 19.78%, 17.72%, and 14.62%, respectively. The difference in sequence identities between iSGv1.0 and ROSE versus iSGv2.0 is explained by the global conservation of invariable sites by iSGv1.0 and ROSE, even for sequences without the lineage-specific motifs. iSGv1.0 and ROSE both showed a lower “percent motif positions conserved” (<xref ref-type="table" rid="tbl3">table 3</xref>) indicating that some positions were conserved by them even if they did not conform to the residue constraints for different protein families.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusion</title>
    <p>Good sequence evolution simulation requires not only realistic event simulation through substitution, insertion, and deletion but also needs realistic constraint enforcement and heterogeneous evolution among between subsequences and among subtrees. In this study, we showed that although many of current simulation methods introduce insertion and deletion events, only iSGv2.0 and DAWG have robust models. We introduced a formal model of functional constraints on substitution and indel events. We improved the modeling of sequence evolution by fixing indel evolution, incorporating novel functional constraints for motif conservation and subsequence-length preservation, and improved heterogeneous sequence evolution and lineage-specific evolution. iSGv2.0 also added modeling of coding and noncoding DNA evolutions.</p>
    <p>We showed that the majority of indel-simulating programs incorporate indel models that do not account for sequence-length variations during the branch evolution. They introduce bias into the results of the sequence simulation, although such biases are not evident when insertion and deletion frequencies are equal. We also showed that adding subsequence-length constraints and motif constraints allows iSGv2.0 to correctly model superfamily evolution in the twilight zone of sequence similarity.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">Supplementary figures S1</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">S2</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">S3</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">S4</ext-link>, and <ext-link ext-link-type="uri" xlink:href="http://mbe.oxfordjournals.org/cgi/content/full/msp174/DC1">S5</ext-link> are available at <italic>Molecular Biology and Evolution</italic> online (<ext-link ext-link-type="uri" xlink:href="http://www.mbe.oxfordjournals.org/">http://www.mbe.oxfordjournals.org/</ext-link>).</p>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>[Supplementary Data]</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="msp174_index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="msp174_1.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="msp174_2.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="msp174_3.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="msp174_4.pdf"/>
      <media xlink:role="associated-file" mimetype="text" mime-subtype="plain" xlink:href="msp174_mbe-09-0399-File003_msp174.txt"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to thank Dr Elisabeth Tillier (University of Toronto, Ontario Cancer Institute) for incorporating the functionalities necessary to perform our tests into SIMPROT and also for her comments. We are also grateful to Dr Steve Kachman (University of Nebraska) for his input. We thank the anonymous reviewers for their productive comments.</p>
    <p>This work was supported in part by National Science Foundation AToL grant 0732863 to E.N.M., the Department of Education grant P200A040150 to the Department of Computer Science and Engineering at University of Nebraska—Lincoln (UNL), and by an Undergraduate Creative Activities and Research Experiences (UCARE) grant to K.A. from UNL.</p>
  </ack>
  <ref-list>
    <ref id="bib1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Attwood</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Beck</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Bleasby</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Parry-Smith</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>PRINTS—a database of protein motif fingerprints</article-title>
        <source>Nucleic Acids Res</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>3590</fpage>
        <lpage>3596</lpage>
        <pub-id pub-id-type="pmid">7937065</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bradley</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>IH</given-names>
          </name>
        </person-group>
        <article-title>Transducers: an emerging probabilistic framework for modeling indels on trees</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>3258</fpage>
        <lpage>3262</lpage>
        <pub-id pub-id-type="pmid">17804440</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cartwright</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>DNA assembly with gaps (Dawg): simulating sequence evolution</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>iii31</fpage>
        <lpage>iii38</lpage>
        <pub-id pub-id-type="pmid">16306390</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>MSS</given-names>
          </name>
          <name>
            <surname>Benner</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Empirical analysis of protein insertions and deletions determining parameters for the correct placement of gaps in protein sequence alignments</article-title>
        <source>J Mol Biol</source>
        <year>2004</year>
        <volume>341</volume>
        <fpage>617</fpage>
        <lpage>631</lpage>
        <pub-id pub-id-type="pmid">15276848</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chivers</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Laboissiere</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Raines</surname>
            <given-names>RT</given-names>
          </name>
        </person-group>
        <article-title>The CXXC motif: imperatives for the formation of native disulfide bonds in the cell</article-title>
        <source>EMBO J</source>
        <year>1996</year>
        <volume>15</volume>
        <fpage>2659</fpage>
        <lpage>2667</lpage>
        <pub-id pub-id-type="pmid">8654363</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Dayhoff</surname>
            <given-names>MO</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Orcutt</surname>
            <given-names>BC</given-names>
          </name>
        </person-group>
        <article-title>A model for evolutionary change in proteins</article-title>
        <source>In Atlas of protein sequence and structure</source>
        <year>1978</year>
        <volume>Vol. 5</volume>
        <publisher-loc>Washington (DC)</publisher-loc>
        <publisher-name>National Biochemical Research Foundation</publisher-name>
        <fpage>345</fpage>
        <lpage>352</lpage>
      </element-citation>
    </ref>
    <ref id="bib7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: a multiple sequence alignment method with reduced time and space complexity</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>113</fpage>
        <pub-id pub-id-type="pmid">15318951</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>PHYLIP (Phylogeny Inference Package) Version 3.68</source>
        <year>2008</year>
        <comment>Distributed by the author. Department of Genetics, University of Washington, Seattle (WA)</comment>
      </element-citation>
    </ref>
    <ref id="bib9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Flower</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>North</surname>
            <given-names>ACT</given-names>
          </name>
          <name>
            <surname>Sansom</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>The lipocalin protein family: structural and sequence overview</article-title>
        <source>BBA</source>
        <year>2000</year>
        <volume>1482</volume>
        <fpage>9</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="pmid">11058743</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hall</surname>
            <given-names>BG</given-names>
          </name>
        </person-group>
        <article-title>Simulating DNA coding sequence evolution with EvolveAGene 3</article-title>
        <source>Mol Biol Evol</source>
        <year>2008</year>
        <volume>25</volume>
        <fpage>688</fpage>
        <lpage>695</lpage>
        <pub-id pub-id-type="pmid">18192698</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hasegawa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kishino</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yano</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Dating the human–ape splitting by a molecular clock of mitochondrial DNA</article-title>
        <source>J Mol Evol</source>
        <year>1985</year>
        <volume>22</volume>
        <fpage>672</fpage>
        <lpage>677</lpage>
      </element-citation>
    </ref>
    <ref id="bib13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henikoff</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Henikoff</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>Amino acid substitution matrices from protein blocks</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>1992</year>
        <volume>15</volume>
        <fpage>10915</fpage>
        <lpage>10919</lpage>
        <pub-id pub-id-type="pmid">1438297</pub-id>
      </element-citation>
    </ref>
    <ref id="bib14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>The rapid generation of mutation data matrices from protein sequences</article-title>
        <source>Bioinformatics</source>
        <year>1992</year>
        <volume>8</volume>
        <fpage>275</fpage>
        <lpage>282</lpage>
      </element-citation>
    </ref>
    <ref id="bib15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lassmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Quality assessment of multiple alignment programs</article-title>
        <source>FEBS Lett</source>
        <year>2002</year>
        <volume>529</volume>
        <fpage>126</fpage>
        <lpage>130</lpage>
        <pub-id pub-id-type="pmid">12354624</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lo Conte</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ailey</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hubbard</surname>
            <given-names>TJP</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Murzin</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Chothia</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>SCOP: a structural classification of proteins database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>257</fpage>
        <lpage>259</lpage>
        <pub-id pub-id-type="pmid">10592240</pub-id>
      </element-citation>
    </ref>
    <ref id="bib17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Recent evolutions of multiple sequence alignment algorithms</article-title>
        <source>PLoS Comput Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>1405</fpage>
        <lpage>1408</lpage>
      </element-citation>
    </ref>
    <ref id="bib18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pang</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Nuin</surname>
            <given-names>PAS</given-names>
          </name>
          <name>
            <surname>Tillier</surname>
            <given-names>ERM</given-names>
          </name>
        </person-group>
        <article-title>SIMPROT: using an empirically determined indel distribution in simulations of protein evolution</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>6</volume>
        <fpage>236</fpage>
        <pub-id pub-id-type="pmid">16188037</pub-id>
      </element-citation>
    </ref>
    <ref id="bib19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pei</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>B-H</given-names>
          </name>
          <name>
            <surname>Grishin</surname>
            <given-names>NV</given-names>
          </name>
        </person-group>
        <article-title>PROMALS3D: a tool for multiple sequence and structure alignment</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>2295</fpage>
        <lpage>2300</lpage>
        <pub-id pub-id-type="pmid">18287115</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qian</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Goldstein</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Distribution of indel lengths</article-title>
        <source>Proteins</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>102</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="pmid">11536366</pub-id>
      </element-citation>
    </ref>
    <ref id="bib21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raghava</surname>
            <given-names>GPS</given-names>
          </name>
          <name>
            <surname>Searle</surname>
            <given-names>SMJ</given-names>
          </name>
          <name>
            <surname>Audley</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Barber</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>OXBench: a benchmark for evaluation of protein multiple sequence alignment accuracy</article-title>
        <source>BMC Bioinformatics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>47</fpage>
        <pub-id pub-id-type="pmid">14552658</pub-id>
      </element-citation>
    </ref>
    <ref id="bib22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grassly</surname>
            <given-names>NC</given-names>
          </name>
        </person-group>
        <article-title>Seq-Gen: an application for the Monte Carlo simulation of DNA sequence evolution along phylogenetic trees</article-title>
        <source>Bioinformatics</source>
        <year>1997</year>
        <volume>13</volume>
        <fpage>235</fpage>
        <lpage>238</lpage>
      </element-citation>
    </ref>
    <ref id="bib23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenberg</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>MySSP: non-stationary evolutionary sequence simulation, including indels</article-title>
        <source>Evol Bioinform Online</source>
        <year>2005</year>
        <volume>1</volume>
        <fpage>81</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="pmid">19325855</pub-id>
      </element-citation>
    </ref>
    <ref id="bib24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rost</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Twilight zone of protein sequence alignments</article-title>
        <source>Prot Eng</source>
        <year>1999</year>
        <volume>12</volume>
        <fpage>85</fpage>
        <lpage>94</lpage>
      </element-citation>
    </ref>
    <ref id="bib25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sigrist</surname>
            <given-names>CJA</given-names>
          </name>
          <name>
            <surname>Cerutti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hulo</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gattiker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Falquet</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pagni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bairoch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bucher</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>PROSITE: a documented database using patterns and profiles as motif descriptors</article-title>
        <source>Brief Bioinformatics</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>265</fpage>
        <lpage>274</lpage>
        <pub-id pub-id-type="pmid">12230035</pub-id>
      </element-citation>
    </ref>
    <ref id="bib26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Evers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Generating benchmarks for multiple sequence alignments and phylogenetic reconstructions</article-title>
        <source>Proc Int Conf Intel Syst Mol Biol</source>
        <year>1997</year>
        <volume>5</volume>
        <fpage>303</fpage>
        <lpage>306</lpage>
      </element-citation>
    </ref>
    <ref id="bib27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Evers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>ROSE: generating sequence families</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>157</fpage>
        <lpage>163</lpage>
        <pub-id pub-id-type="pmid">9545448</pub-id>
      </element-citation>
    </ref>
    <ref id="bib28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strope</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Moriyama</surname>
            <given-names>EN</given-names>
          </name>
        </person-group>
        <article-title>indel-Seq-Gen: a new protein family Simulator incorporating domains, motifs, and indels</article-title>
        <source>Mol Biol Evol</source>
        <year>2007</year>
        <volume>24</volume>
        <fpage>640</fpage>
        <lpage>649</lpage>
        <pub-id pub-id-type="pmid">17158778</pub-id>
      </element-citation>
    </ref>
    <ref id="bib29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Weyer-Menkhoff</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kaufmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Morgenstern</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>DIALIGN-T: an improved algorithm for segment-based multiple sequence alignment</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>66</fpage>
        <pub-id pub-id-type="pmid">15784139</pub-id>
      </element-citation>
    </ref>
    <ref id="bib30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Koehl</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ripp</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Poch</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>BAliBASE 3.0: latest developments of the multiple sequence alignment benchmark</article-title>
        <source>Proteins</source>
        <year>2005</year>
        <volume>61</volume>
        <fpage>127</fpage>
        <lpage>136</lpage>
        <pub-id pub-id-type="pmid">16044462</pub-id>
      </element-citation>
    </ref>
    <ref id="bib31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Walle</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lasters</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wyns</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>SABmark—a benchmark for sequence alignment that covers the entire known fold space</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>1267</fpage>
        <lpage>1268</lpage>
        <pub-id pub-id-type="pmid">15333456</pub-id>
      </element-citation>
    </ref>
    <ref id="bib32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Varadarajan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bradley</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>IH</given-names>
          </name>
        </person-group>
        <article-title>Tools for simulating evolution of aligned genomic regions with integrated parameter estimation</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R147</fpage>
        <pub-id pub-id-type="pmid">18840304</pub-id>
      </element-citation>
    </ref>
    <ref id="bib33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Estimating the pattern of nucleotide substitution</article-title>
        <source>J Mol Evol</source>
        <year>1994</year>
        <volume>39</volume>
        <fpage>105</fpage>
        <lpage>111</lpage>
        <pub-id pub-id-type="pmid">8064867</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
