<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9410915</article-id>
    <article-id pub-id-type="pmid">35639499</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkac412</article-id>
    <article-id pub-id-type="publisher-id">gkac412</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>Narese/9</subject>
        <subject>Narese/24</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Inference of cell state transitions and cell fate plasticity from single-cell with MARGARET</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pandey</surname>
          <given-names>Kushagra</given-names>
        </name>
        <aff><institution>Department of Computer Science and Engineering, Indian Institute of Technology Kanpur</institution>, Kanpur 208016, <country country="IN">India</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1617-2806</contrib-id>
        <name>
          <surname>Zafar</surname>
          <given-names>Hamim</given-names>
        </name>
        <!--hamim@iitk.ac.in-->
        <aff><institution>Department of Computer Science and Engineering, Indian Institute of Technology Kanpur</institution>, Kanpur 208016, <country country="IN">India</country></aff>
        <aff><institution>Department of Biological Sciences and Bioengineering, Indian Institute of Technology Kanpur</institution>, Kanpur 208016, <country country="IN">India</country></aff>
        <aff><institution>Mehta Family Centre for Engineering in Medicine, Indian Institute of Technology Kanpur</institution>, Kanpur 208016, <country country="IN">India</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +91 8737992101; Email: <email>hamim@iitk.ac.in</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>26</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-05-25">
      <day>25</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <volume>50</volume>
    <issue>15</issue>
    <fpage>e86</fpage>
    <lpage>e86</lpage>
    <history>
      <date date-type="accepted">
        <day>17</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="received">
        <day>21</day>
        <month>1</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkac412.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Despite recent advances in inferring cellular dynamics using single-cell RNA-seq data, existing trajectory inference (TI) methods face difficulty in accurately reconstructing the cell-state manifold and cell-fate plasticity for complex topologies. Here, we present MARGARET (<ext-link xlink:href="https://github.com/Zafar-Lab/Margaret" ext-link-type="uri">https://github.com/Zafar-Lab/Margaret</ext-link>) for inferring single-cell trajectory and fate mapping for diverse dynamic cellular processes. MARGARET reconstructs complex trajectory topologies using a deep unsupervised metric learning and a graph-partitioning approach based on a novel connectivity measure, automatically detects terminal cell states, and generalizes the quantification of fate plasticity for complex topologies. On a diverse benchmark consisting of synthetic and real datasets, MARGARET outperformed state-of-the-art methods in recovering global topology and cell pseudotime ordering. For human hematopoiesis, MARGARET accurately identified all major lineages and associated gene expression trends and helped identify transitional progenitors associated with key branching events. For embryoid body differentiation, MARGARET identified novel transitional populations that were validated by bulk sequencing and functionally characterized different precursor populations in the mesoderm lineage. For colon differentiation, MARGARET characterized the lineage for BEST4/OTOP2 cells and the heterogeneity in goblet cell lineage in the colon under normal and inflamed ulcerative colitis conditions. Finally, we demonstrated that MARGARET can scale to large scRNA-seq datasets consisting of ∼ millions of cells.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Science and Engineering Research Board</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001843</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>SRG/2020/001333</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>IIT Kanpur</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001403</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>20030163</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="24"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Dynamic cellular processes such as differentiation involve cell-state transitions that are characterized by cascades of epigenetic and transcriptional changes (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B2" ref-type="bibr">2</xref>). High-throughput single-cell RNA sequencing (scRNA-seq) datasets allow us to identify cellular identities at a single-cell resolution (<xref rid="B3" ref-type="bibr">3</xref>,<xref rid="B4" ref-type="bibr">4</xref>) and thus can be utilized for elucidating the cellular heterogeneity of a dynamic cellular process and tracking cell fate decisions in normal as well as pathological development (<xref rid="B5" ref-type="bibr">5</xref>). Despite recent advances (<xref rid="B6" ref-type="bibr">6</xref>,<xref rid="B7" ref-type="bibr">7</xref>) in inferring cellular dynamics from the underlying developmental process, existing computational trajectory inference (TI) methods (<xref rid="B7" ref-type="bibr">7–11</xref>) face several critical challenges. Most TI methods have largely overlooked the importance of dimensionality reduction by focusing more on trajectory modelling and relying on generalized dimension reduction techniques such as UMAP (<xref rid="B12" ref-type="bibr">12</xref>), local linear embedding (<xref rid="B11" ref-type="bibr">11</xref>), or diffusion maps (<xref rid="B9" ref-type="bibr">9</xref>) which may obscure the identification of some intermediate cell states. Moreover, most TI methods impose strong assumptions on the topology of the trajectory and cannot generalize to disconnected or hybrid topologies without imposing further restrictions (<xref rid="B13" ref-type="bibr">13</xref>). Lastly, accurate detection of terminal cell states remain difficult as only a few methods (e.g. Slingshot (<xref rid="B10" ref-type="bibr">10</xref>), Palantir (<xref rid="B9" ref-type="bibr">9</xref>), Monocle3 (<xref rid="B7" ref-type="bibr">7</xref>), VIA (<xref rid="B14" ref-type="bibr">14</xref>)) can automatically identify cell fates (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). Existing gene-expression similarity-based TI methods also focus mostly on reconstructing the order of cell states, how cell fate choices evolve along a dynamic process remain less explored. Recently, a Markov chain model has been introduced by Palantir (<xref rid="B9" ref-type="bibr">9</xref>) to quantify the plasticity of cell fates along a trajectory. However this approach predominantly assumes a connected trajectory and cannot generalize to disconnected trajectories.</p>
    <p>To overcome these challenges, we developed MARGARET (<underline>M</underline>etric le<underline>AR</underline>ned <underline>G</underline>raph p<underline>AR</underline>tition<underline>E</underline>d <underline>T</underline>rajectory) which provides an end-to-end framework that utilizes scRNA-seq data for inferring the cell state trajectory and dynamics of cell fate plasticity and thereby characterizes the differentiation landscape. MARGARET employs an unsupervised metric learning-based approach for inferring the cell-state manifold where the distinct cell states are represented by compact cell clusters. To capture complex trajectory topologies, MARGARET employs the inferred cellular embeddings and the cell clusters to construct a cluster connectivity graph by using a novel measure of connectivity between cell clusters. The cluster connectivity graph is used in conjunction with the cell-nearest-neighbor graph to compute a pseudotime ordering of cells. To identify terminal states in the trajectory, MARGARET introduces a shortest-path betweenness-based measure. Finally, MARGARET refines the absorbing Markov chain model of Palantir and introduces a local random walk-based novel algorithm for computing cell fate probabilities which in turn generalizes the quantification of the cell fate plasticity for complex trajectory topologies.</p>
    <p>We demonstrate the performance of MARGARET in trajectory inference and cell-fate prediction across a variety of synthetic and experimental scRNA-seq datasets. For simulated datasets with known ground-truth (<xref rid="B13" ref-type="bibr">13</xref>) consisting of diverse topologies and a real benchmark consisting of datasets from placenta trophoblast differentiation (<xref rid="B15" ref-type="bibr">15</xref>), mouse cell atlas (<xref rid="B15" ref-type="bibr">15</xref>), oligodendrocyte differentiation (<xref rid="B16" ref-type="bibr">16</xref>) and planaria parenchyme differentiation (<xref rid="B17" ref-type="bibr">17</xref>), MARGARET outperformed state-of-the-art TI methods both in terms of capturing the global topology and recovering the underlying pseudotime ordering. Using simulated datasets with ground-truth pseudotime ordering, we further showed that MARGARET’s quantification of cell fate plasticity is superior to that of Palantir and generalizes for complex disconnected trajectories. When applied to real biological datasets (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B18" ref-type="bibr">18</xref>,<xref rid="B19" ref-type="bibr">19</xref>) representing human hematopoiesis, embryogenesis and colon differentiation, MARGARET accurately identified all major lineages along a pseudotemporal order that epitomized the expression trends of canonical cell-type markers in these processes. For hematopoiesis, in the myeloid and erythroid-megakaryocytic lineages, MARGARET helped identify transitional progenitors associated with key branching events, which were also characterized by a drastic shift in MARGARET inferred cell-fate plasticity. For embryoid body differentiation, MARGARET accurately characterized all ectodermal, endodermal and mesodermal lineages; identified novel transitional populations that were validated by bulk sequencing; and functionally characterized different precursor populations in the mesoderm lineage. For colon differentiation, MARGARET delineated the secretive and absorptive cell lineages for human colon differentiation; characterized the lineage for BEST4/OTOP2 cells and the heterogeneity in goblet cell lineage in the colon under normal and inflamed ulcerative colitis conditions. Finally, using a 1.3 million neuronal cells dataset (<xref rid="B20" ref-type="bibr">20</xref>), we demonstrate that MARGARET can scale to large scRNA-seq datasets making it suitable for analyzing atlas-level scRNA-seq datasets.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Preprocessing scRNA-seq data</title>
      <p>We downloaded the filtered, normalized and log-transformed count matrices for early Human Hematopoiesis datasets (replicates 1 and 2) provided by (<xref rid="B9" ref-type="bibr">9</xref>) (see Data Availability). Pre-processed replicate 1 consisted of 5780 cells and 14 651 genes while replicate 2 consisted of 6501 cells and 14 913 genes. For each replicate, we performed imputation using MAGIC (<xref rid="B21" ref-type="bibr">21</xref>), and then computed 300-dimensional PCA embeddings on the imputed data as suggested in (<xref rid="B9" ref-type="bibr">9</xref>). For the embryoid body (EB) dataset, we downloaded the filtered, normalized and square-root transformed count matrix as provided in (<xref rid="B18" ref-type="bibr">18</xref>) (see Data Availability). The EB dataset consisted of 16 821 cells and 17 845 genes. We then performed initial denoising on the dataset to extract 50-dimensional PCA embeddings as performed in (<xref rid="B18" ref-type="bibr">18</xref>). For studying colon differentiation under normal and UC conditions, we downloaded the preprocessed count matrix provided by (<xref rid="B19" ref-type="bibr">19</xref>). Top 2000 highly variable genes were identified in this dataset and then PCA was performed to compute 300-dimensional embeddings, which were used for further analysis. For real benchmarking datasets (Placenta Trophoblast differentiation, Mouse cell atlas, Oligodendrocyte differentiation and Planaria parenchyme differentiation), we downloaded filtered, normalized and log-transformed count matrices and then computed 10-dimensional PCA embeddings for subsequent analysis using other methods. We downloaded the real datasets utilized in embedding quality evaluations (PBMC-8k, PBMC-4k, Heart Cell Atlas and CORTEX) and runtime benchmarking (1.3M neuronal cells) using scvi-tools (<xref rid="B22" ref-type="bibr">22</xref>) and performed filtering, normalization and log-transformation followed by z-score normalization. We then performed PCA with 100 components on the 1.3M dataset and 10 components on the other real datasets. All preprocessing was performed using Scanpy (<xref rid="B8" ref-type="bibr">8</xref>).</p>
    </sec>
    <sec id="SEC2-2">
      <title>Overview of MARGARET</title>
      <p>The overall framework of MARGARET consists of two main steps. We first infer the lower-dimensional cell-state manifold using preprocessed scRNA-seq data. This is followed by trajectory modelling which encompasses constructing an undirected graph on the cell clusters inferred from the cellular embeddings followed by the inference of pseudotime ordering of the cells (Figure <xref rid="F1" ref-type="fig">1</xref>). Each of these computational stages are described in more detail in the following sections.</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of MARGARET. (<bold>A</bold>) Given a preprocessed scRNA-seq dataset, MARGARET uses an unsupervised metric-learning-based approach to learn compact cell-state representations from pseudolabels generated from an initial cell embedding. The cell cluster assignments and the MARGARET embedding are refined through an episodic training which results in the final refined embeddings and refined cell type clusters. (<bold>B</bold>) MARGARET infers the connectivity graph between the refined cell partitions by computing connectivities between clusters using a cell-level <italic toggle="yes">k</italic>-nearest-neighbor (kNN) graph. (<bold>C</bold>) MARGARET prunes the kNN graph by removing <italic toggle="yes">short-circuit</italic> edges and infers cell pseudotime from the pruned kNN graph by computing geodesic distances from the start cell(s). The pseudotime values are then utilized to infer a directed trajectory. MARGARET utilizes the inferred cell-state embeddings and the trajectory for several downstream tasks.</p>
        </caption>
        <graphic xlink:href="gkac412fig1" position="float"/>
      </fig>
    </sec>
    <sec id="SEC2-3">
      <title>Inference of lower-dimensional cell-state manifold</title>
      <p>For inferring the cell-state manifold, given preprocessed scRNA-seq data, we propose an unsupervised metric-learning-based approach to learn a meaningful lower-dimensional representation of each cell in the scRNA-seq dataset (see Figure <xref rid="F1" ref-type="fig">1A</xref>). The central idea is to learn a non-linear manifold over cell representations such that the cells which belong to the same cell type (cluster) are packed compactly while the cells belonging to different clusters are far apart in the manifold. The key steps of our proposed approach are as follows:</p>
      <list list-type="order">
        <list-item>
          <p><bold>Computing initial clusters:</bold> Given the preprocessed scRNA-seq data with <italic toggle="yes">N</italic> cells and an initial embedding of dimension <italic toggle="yes">D</italic>, we perform initial clustering on the data. The cluster label assigned to each cell is then treated as a pseudo-label, which is used in subsequent steps. The pseudo-labelled dataset is denoted as <inline-formula><tex-math id="M0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {D}_{PL} = \lbrace (x_i, y_i)\rbrace _{i=1}^N$\end{document}</tex-math></inline-formula>, where the pair (<italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">y</italic><sub><italic toggle="yes">i</italic></sub>) represents the initial embedding and the pseudo-label of the <italic toggle="yes">i</italic>th cell in the dataset respectively. It is worth noting that the choice of the clustering method in this step can be arbitrary and the users can choose any single-cell clustering method of their choice. However, in this work, we primarily use community detection-based clustering methods such as Louvain and Leiden clustering (<xref rid="B23" ref-type="bibr">23</xref>) due to their widespread use in the single-cell literature (<xref rid="B24" ref-type="bibr">24</xref>) and availability of efficient implementations in Scanpy (<xref rid="B8" ref-type="bibr">8</xref>).</p>
        </list-item>
        <list-item>
          <p><bold>Metric learning:</bold> We then learn a low-dimensional representation of each pseudo-labelled cell using a non-linear mapping <inline-formula><tex-math id="M0001a" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f_{\theta }: \mathbb {R}^D \rightarrow \mathbb {R}^d$\end{document}</tex-math></inline-formula> parameterized by θ where <italic toggle="yes">d</italic> ≤ <italic toggle="yes">D</italic>. In this work, we represent <italic toggle="yes">f</italic><sub>θ</sub> using a feed-forward deep neural network with parameters θ. Given this parameterization and a pseudo-labelled dataset <inline-formula><tex-math id="M0002" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {D}_{PL}$\end{document}</tex-math></inline-formula>, we learn a low-dimensional representation of each cell as follows:</p>
          <p>Given an initial representation (<italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">y</italic><sub><italic toggle="yes">i</italic></sub>) for the <italic toggle="yes">i</italic>th cell, two additional cells (<italic toggle="yes">x</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">y</italic><sub><italic toggle="yes">j</italic></sub>) and (<italic toggle="yes">x</italic><sub><italic toggle="yes">k</italic></sub>, <italic toggle="yes">y</italic><sub><italic toggle="yes">k</italic></sub>) are sampled from <inline-formula><tex-math id="M0003" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {D}_{PL}- \lbrace (x_i, y_i)\rbrace$\end{document}</tex-math></inline-formula> such that <italic toggle="yes">y</italic><sub><italic toggle="yes">i</italic></sub> = <italic toggle="yes">y</italic><sub><italic toggle="yes">j</italic></sub> and <italic toggle="yes">y</italic><sub><italic toggle="yes">i</italic></sub> ≠ <italic toggle="yes">y</italic><sub><italic toggle="yes">k</italic></sub>. Let us assume that <italic toggle="yes">f</italic><sub><italic toggle="yes">a</italic></sub>, <italic toggle="yes">f</italic><sub><italic toggle="yes">p</italic></sub> and <italic toggle="yes">f</italic><sub><italic toggle="yes">n</italic></sub> denote the low-dimensional embeddings of <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">x</italic><sub><italic toggle="yes">j</italic></sub> and <italic toggle="yes">x</italic><sub><italic toggle="yes">k</italic></sub> such that:<disp-formula><tex-math id="M0004" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*} f_a &amp;= f_{\theta }(x_i)\\ f_p &amp;= f_{\theta }(x_j)\\ f_n &amp;= f_{\theta }(x_k) \end{eqnarray*}$$\end{document}</tex-math></disp-formula></p>
          <p>θ is updated such that the Triplet-Margin loss function (<xref rid="B25" ref-type="bibr">25</xref>) <inline-formula><tex-math id="M0005" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {L}(f_a, f_p, f_n)$\end{document}</tex-math></inline-formula> is minimized, where the loss <inline-formula><tex-math id="M0006" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {L}(f_a, f_p, f_n)$\end{document}</tex-math></inline-formula> is given by:<disp-formula id="M1"><label>(1)</label><tex-math id="M0007" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*} \mathcal {L}(f_a, f_p, f_n) = \max {\lbrace d(f_a, f_p) - d(f_a, f_n) + margin, 0\rbrace } \end{eqnarray*}$$\end{document}</tex-math></disp-formula><disp-formula id="M2"><label>(2)</label><tex-math id="M0008" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} d(f_i, f_j) = \Vert f_i - f_j \Vert _p \end{equation*}$$\end{document}</tex-math></disp-formula></p>
          <p>The value of <italic toggle="yes">margin</italic> and <italic toggle="yes">p</italic> are chosen as 1 and 2, respectively. Intuitively, for each cell <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> (denoting the anchor), we sample positive (<italic toggle="yes">x</italic><sub><italic toggle="yes">j</italic></sub>) and negative samples (<italic toggle="yes">x</italic><sub><italic toggle="yes">k</italic></sub>) such that the distance between the anchor and the positive sample is minimized while the distance between the anchor and the negative sample is maximized. This training step is repeated for <italic toggle="yes">e</italic> epochs, where <italic toggle="yes">e</italic> is a hyperparameter.</p>
        </list-item>
        <list-item>
          <p><bold>Cluster refinement:</bold> We generate the low-dimensional representations of all cells in the dataset using pre-trained <italic toggle="yes">f</italic><sub>θ</sub> from step 2. Using the updated low-dimensional embedding <italic toggle="yes">f</italic><sub>θ</sub>(<italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>) for all <italic toggle="yes">N</italic> cells, cells are clustered again to generate refined cluster assignments, which act as new pseudo-labels for the cells <inline-formula><tex-math id="M0009" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lbrace x_i\rbrace _{i=1}^N$\end{document}</tex-math></inline-formula>.</p>
        </list-item>
        <list-item>
          <p><bold>Episodic training:</bold> The sequence of steps 2 and 3 form a single <italic toggle="yes">episode</italic>. We repeat steps 2 and 3 alternatively for a total of <italic toggle="yes">E</italic> episodes, where <italic toggle="yes">E</italic> is a hyperparameter. We can also alternate between the two steps until convergence which can be assessed by monitoring the quality of the clusters generated from step 3. For example, when using Leiden or Louvain clustering, convergence can be assessed by monitoring the <italic toggle="yes">modularity</italic> score of the refined clusters.</p>
        </list-item>
        <list-item>
          <p><bold>Inferring final low-dimensional manifold:</bold> After training, the final low-dimensional representation, <inline-formula><tex-math id="M00010" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f_i^*$\end{document}</tex-math></inline-formula> for cell <italic toggle="yes">i</italic> can be obtained by <inline-formula><tex-math id="M00011" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$f_{\theta ^*}(x_i)$\end{document}</tex-math></inline-formula> where θ* denotes the trained parameters of the deep neural network <italic toggle="yes">f</italic>. As a by-product of training, we also obtain the refined cluster assignments, <inline-formula><tex-math id="M00012" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$y_i^*$\end{document}</tex-math></inline-formula> for each cell in the scRNA-seq dataset. The refined embeddings <inline-formula><tex-math id="M00013" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {M}_f = \lbrace f_i^*\rbrace _{i=1}^{N}$\end{document}</tex-math></inline-formula> and cluster assignments {<inline-formula><tex-math id="M00014" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$y_i^*\rbrace _{i=1}^{N}$\end{document}</tex-math></inline-formula> are used in subsequent steps of MARGARET.</p>
        </list-item>
      </list>
    </sec>
    <sec id="SEC2-4">
      <title>Network architecture and training hyperparameters</title>
      <p>We use a simple feed-forward deep neural network architecture in MARGARET consisting of 2-fully connected layers of sizes 128 and 64, respectively. The size of the input layer depends on the size of the embedding of the preprocessed scRNA-seq dataset. The number of neurons in the final output layer is the same as the size of the desired low-dimensional embedding which is a hyperparameter. In addition, each fully connected layer in MARGARET is followed by a Batch Normalization (BN) (<xref rid="B26" ref-type="bibr">26</xref>) layer followed by the ReLU activation. To regularize and enrich the intermediate representations, we use Dropout (<xref rid="B27" ref-type="bibr">27</xref>) after each Linear-BN-ReLU module. The dropout rate is set to 0.3 for all the experiments. Moreover, the layer sizes were also kept fixed for all the experiments.</p>
      <p>During training, we used Stochastic Gradient Descent (SGD) with an initial learning rate of 0.01 to update the metric learner parameters. To adjust the learning rate during training, we used a poly-learning rate scheduler with the following update schedule:<disp-formula id="M3"><label>(3)</label><tex-math id="M00015" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} lr(t) = lr(0) * (1 - \frac{t}{num\_epochs})^{\alpha } \end{equation*}$$\end{document}</tex-math></disp-formula>α = 0.9 was used during training.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Trajectory modelling</title>
      <p>Given a low dimensional representation of cells, <inline-formula><tex-math id="M00016" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {M}_f$\end{document}</tex-math></inline-formula> and refined cluster assignments <inline-formula><tex-math id="M00017" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lbrace y_i^*\rbrace _{i=1}^{N}$\end{document}</tex-math></inline-formula>, MARGARET learns a connectivity graph over the set of refined clusters similar to PAGA (<xref rid="B28" ref-type="bibr">28</xref>) to model the trajectory over the underlying dynamic process. The key steps involved in learning the trajectory are described below.</p>
      <list list-type="order">
        <list-item>
          <p><bold>Learning an undirected graph:</bold> MARGARET first learns an undirected graph <inline-formula><tex-math id="M00018" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {U}$\end{document}</tex-math></inline-formula> over the refined partition of cells <inline-formula><tex-math id="M00019" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$y_i^*$\end{document}</tex-math></inline-formula> (Figure <xref rid="F1" ref-type="fig">1B</xref>). This learned graph <inline-formula><tex-math id="M00020" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {U}$\end{document}</tex-math></inline-formula> models the connectivity of the cell clusters and identifies the connected and disconnected neighborhoods in the cell-state manifold. To learn <inline-formula><tex-math id="M00021" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {U}$\end{document}</tex-math></inline-formula>, we first compute the k-nearest-neighbor (kNN) graph, <inline-formula><tex-math id="M00022" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}$\end{document}</tex-math></inline-formula> at the single-cell level using the learned low-dimensional manifold (<inline-formula><tex-math id="M00023" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {M}_f$\end{document}</tex-math></inline-formula>). The resulting graph, <inline-formula><tex-math id="M00024" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}$\end{document}</tex-math></inline-formula> is represented as a <italic toggle="yes">N</italic> × <italic toggle="yes">N</italic> sparse adjacency matrix. We then assess the connectivity between two clusters <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">c</italic><sub><italic toggle="yes">j</italic></sub> by introducing a novel measure of connectedness. Formally, we define the connectivity between two clusters <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">c</italic><sub><italic toggle="yes">j</italic></sub> as:<disp-formula id="M4"><label>(4)</label><tex-math id="M00025" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \psi _{ij} = \frac{e_{ij} + e_{ji} - e_{rand}}{e_i + e_j - e_{rand}} \end{equation*}$$\end{document}</tex-math></disp-formula></p>
          <p>where <italic toggle="yes">e</italic><sub><italic toggle="yes">ij</italic></sub> denotes the number of kNN graph edges from cluster <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub> to <italic toggle="yes">c</italic><sub><italic toggle="yes">j</italic></sub>, <italic toggle="yes">e</italic><sub><italic toggle="yes">ji</italic></sub> denotes the number of kNN graph edges from cluster <italic toggle="yes">c</italic><sub><italic toggle="yes">j</italic></sub> to <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">e</italic><sub><italic toggle="yes">i</italic></sub> denotes the number of outgoing edges from cluster <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">e</italic><sub><italic toggle="yes">j</italic></sub> denotes the number of outgoing edges from cluster <italic toggle="yes">c</italic><sub><italic toggle="yes">j</italic></sub>, and <italic toggle="yes">e</italic><sub><italic toggle="yes">rand</italic></sub> denotes the number of edges from cluster <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub> to <italic toggle="yes">c</italic><sub><italic toggle="yes">j</italic></sub> and vice-versa under the random assignment of edges. Intuitively, when computing the connectivity between two clusters, we adjust the connectivity score to account for the random assignment of edges from cluster <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub> to <italic toggle="yes">c</italic><sub><italic toggle="yes">j</italic></sub> to prevent spurious connections in <inline-formula><tex-math id="M00026" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {U}$\end{document}</tex-math></inline-formula>.</p>
          <p>Following PAGA (<xref rid="B28" ref-type="bibr">28</xref>), we model the random assignment of edges between two clusters using a binomial distribution. In this scenario, <italic toggle="yes">e</italic><sub><italic toggle="yes">rand</italic></sub> is given by:<disp-formula id="M5"><label>(5)</label><tex-math id="M00027" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} e_{rand} = \frac{e_in_j + e_jn_i}{N - 1}, \end{equation*}$$\end{document}</tex-math></disp-formula></p>
          <p>where <italic toggle="yes">n</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">n</italic><sub><italic toggle="yes">j</italic></sub> represent the number of cells (size) in the clusters <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">c</italic><sub><italic toggle="yes">j</italic></sub> respectively and <italic toggle="yes">N</italic> represents the total number of nodes in the kNN graph (i.e. the number of cells). Given a threshold (lower-bound for ψ<sub><italic toggle="yes">ij</italic></sub>) <italic toggle="yes">t</italic><sub><italic toggle="yes">c</italic></sub>, two clusters <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">c</italic><sub><italic toggle="yes">j</italic></sub> are said to be connected when ψ<sub><italic toggle="yes">ij</italic></sub> &gt; <italic toggle="yes">t</italic><sub><italic toggle="yes">c</italic></sub>. In this work, we define a simple statistical test and compute the z-score between two clusters <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">c</italic><sub><italic toggle="yes">j</italic></sub> given by:<disp-formula id="M6"><label>(6)</label><tex-math id="M00028" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} z_{ij} = \frac{e_{ij} + e_{ji} - e_{rand}}{\sigma _{rand}}, \end{equation*}$$\end{document}</tex-math></disp-formula></p>
          <p>where σ<sub><italic toggle="yes">rand</italic></sub> denotes the standard deviation of the binomial model and can be specified as:<disp-formula id="M7"><label>(7)</label><tex-math id="M00029" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \sigma _{rand} = \frac{e_i n_j (N - n_j - 1) + e_j n_i (N - n_i - 1)}{(N - 1)^2} \end{equation*}$$\end{document}</tex-math></disp-formula></p>
          <p>The statistical test proposed in <xref rid="M6" ref-type="disp-formula">6</xref> is a direct consequence of the fact that under sufficiently large partitions, binomial random variables can be well approximated by a normal distribution. Therefore, the connectivity between two clusters <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">c</italic><sub><italic toggle="yes">j</italic></sub> is given by ψ<sub><italic toggle="yes">ij</italic></sub> when <italic toggle="yes">z</italic><sub><italic toggle="yes">ij</italic></sub> &gt; <italic toggle="yes">t</italic><sub><italic toggle="yes">c</italic></sub> where <italic toggle="yes">t</italic><sub><italic toggle="yes">c</italic></sub> is a user-defined threshold.</p>
        </list-item>
        <list-item>
          <p><bold>Pseudotime computation:</bold> As in prior works (<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B28" ref-type="bibr">28</xref>), MARGARET learns a temporal ordering over cells to uncover the dynamics of the underlying dynamic process. To determine the temporal order of the cells, for each cell, we infer <italic toggle="yes">pseudotime</italic>, which denotes the position of the cell in the underlying cell-state manifold representing the dynamic process (Figure <xref rid="F1" ref-type="fig">1C</xref>).</p>
          <p>Given the kNN graph <inline-formula><tex-math id="M00030" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}$\end{document}</tex-math></inline-formula> and a prior starting cell index <italic toggle="yes">s</italic>, one possible way to estimate the pseudotime can be to compute the shortest-path distance of each cell from the starting cell <italic toggle="yes">s</italic> because the shortest-path distances better approximate the geodesic distances in a non-linear manifold (<xref rid="B29" ref-type="bibr">29</xref>). However, the kNN graph <inline-formula><tex-math id="M00031" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}$\end{document}</tex-math></inline-formula> can be inherently noisy due to spurious connections between cells. Hence, directly computing the shortest-path distances using <inline-formula><tex-math id="M00032" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}$\end{document}</tex-math></inline-formula> would give inaccurate estimates of the distance of each cell in the manifold from <italic toggle="yes">s</italic>. To mitigate this problem, we prune the kNN graph <inline-formula><tex-math id="M00033" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}$\end{document}</tex-math></inline-formula> by using our undirected graph <inline-formula><tex-math id="M00034" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {U}$\end{document}</tex-math></inline-formula> as a reference model.</p>
          <p>Formally, given an undirected graph <inline-formula><tex-math id="M00035" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {U}$\end{document}</tex-math></inline-formula> and the kNN graph <inline-formula><tex-math id="M00036" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}$\end{document}</tex-math></inline-formula>, we prune an edge between two cells <inline-formula><tex-math id="M00037" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$x_{c_i}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M00038" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$x_{c_j}$\end{document}</tex-math></inline-formula> belonging to two clusters <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">c</italic><sub><italic toggle="yes">j</italic></sub> respectively, iff <inline-formula><tex-math id="M00039" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\exists \:\: e_{ij} \in \mathcal {G}$\end{document}</tex-math></inline-formula> and ψ<sub><italic toggle="yes">ij</italic></sub> = 0 where <italic toggle="yes">e</italic><sub><italic toggle="yes">ij</italic></sub> represents a (short-circuit) edge between cells <inline-formula><tex-math id="M00040" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$x_{c_i}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M00041" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$x_{c_j}$\end{document}</tex-math></inline-formula> in the kNN graph <inline-formula><tex-math id="M00042" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}$\end{document}</tex-math></inline-formula>. Given a pruned kNN graph <inline-formula><tex-math id="M00043" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G^*}$\end{document}</tex-math></inline-formula>, we compute the shortest-path distance of each cell from a user-defined starting cell <italic toggle="yes">s</italic> to infer the pseudotime for each cell in the scRNA-seq dataset.</p>
        </list-item>
        <list-item>
          <p><bold>Orientation of edges in trajectory</bold>: Given an undirected graph <inline-formula><tex-math id="M00044" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {U}$\end{document}</tex-math></inline-formula> and the pseudotime <inline-formula><tex-math id="M00045" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lbrace \tau _n^p\rbrace _{n=1}^N$\end{document}</tex-math></inline-formula>, we compute the mean-pseudotime for each cluster <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub> as:<disp-formula id="M8"><label>(8)</label><tex-math id="M00046" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} m_{c_i} = \frac{\sum _{n=1}^N {1\!\!1}[x_n \in c_i]\tau _n^p}{\sum _{n=1}^N {1\!\!1}[x_n \in c_i]} \end{equation*}$$\end{document}</tex-math></disp-formula></p>
          <p>We then orient an edge from cluster <italic toggle="yes">c</italic><sub><italic toggle="yes">i</italic></sub> to <italic toggle="yes">c</italic><sub><italic toggle="yes">j</italic></sub> iff: <inline-formula><tex-math id="M00047" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$m_{c_i} &lt; m_{c_j}$\end{document}</tex-math></inline-formula> and ψ<sub><italic toggle="yes">ij</italic></sub> ≠ 0 to obtain the final trajectory <inline-formula><tex-math id="M00048" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {T}$\end{document}</tex-math></inline-formula> with node-set <inline-formula><tex-math id="M00049" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {V}$\end{document}</tex-math></inline-formula> and directed edge-set <inline-formula><tex-math id="M00050" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {E}$\end{document}</tex-math></inline-formula> (Figure <xref rid="F1" ref-type="fig">1C</xref>).</p>
        </list-item>
      </list>
    </sec>
    <sec id="SEC2-6">
      <title>Prediction of terminal states</title>
      <p>Given a trajectory <inline-formula><tex-math id="M00051" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {T} = (\mathcal {V}, \mathcal {E})$\end{document}</tex-math></inline-formula>, we compute the shortest-path betweenness (<xref rid="B30" ref-type="bibr">30</xref>) of every node in <inline-formula><tex-math id="M00052" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {T}$\end{document}</tex-math></inline-formula> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1A</xref>). Formally, the shortest-path betweenness can be defined as:<disp-formula id="M9"><label>(9)</label><tex-math id="M00053" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} b(v) = \sum _{(u, w) \in \mathcal {V}}\frac{d_{sp}(u, w | v)}{d_{sp}(u, w)} \end{equation*}$$\end{document}</tex-math></disp-formula>where <italic toggle="yes">b</italic>(<italic toggle="yes">v</italic>) is the betweenness for node <italic toggle="yes">v</italic>, <italic toggle="yes">d</italic><sub><italic toggle="yes">sp</italic></sub>(<italic toggle="yes">u</italic>, <italic toggle="yes">w</italic>|<italic toggle="yes">v</italic>) represents the shortest-path distance between nodes <italic toggle="yes">u</italic> and <italic toggle="yes">w</italic> that passes through node <italic toggle="yes">v</italic> and <italic toggle="yes">d</italic><sub><italic toggle="yes">sp</italic></sub>(<italic toggle="yes">u</italic>, <italic toggle="yes">w</italic>) represents the shortest-path distance between nodes <italic toggle="yes">u</italic> and <italic toggle="yes">w</italic>. Intuitively, the betweenness for any node <inline-formula><tex-math id="M00054" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v \in \mathcal {V}$\end{document}</tex-math></inline-formula> is the sum of the fraction of all-pairs shortest paths that pass through node <italic toggle="yes">v</italic> thus indicating its importance in the network. Given the shortest-path betweenness values <inline-formula><tex-math id="M00055" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${b(v)}_{v \in \mathcal {V}}$\end{document}</tex-math></inline-formula>, we compute the median (<italic toggle="yes">b</italic><sub><italic toggle="yes">med</italic></sub>) and the median absolute-deviation (MAD) (<italic toggle="yes">b</italic><sub><italic toggle="yes">mad</italic></sub>) of the betweenness values respectively. A node <italic toggle="yes">v</italic> is added to the set of terminal states if<disp-formula id="M10"><label>(10)</label><tex-math id="M00056" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} b(v)\, &lt;\, (b_{med} - t_{TS} \times b_{mad}), \end{equation*}$$\end{document}</tex-math></disp-formula>where <italic toggle="yes">t</italic><sub><italic toggle="yes">TS</italic></sub> is a user-defined scalar multiplier. Higher values of <italic toggle="yes">t</italic><sub><italic toggle="yes">TS</italic></sub> typically lead to nodes with no outgoing edges in <inline-formula><tex-math id="M00057" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {V}$\end{document}</tex-math></inline-formula> being selected as the terminal states. At the single-cell level, we select the cells having the maximum pseudotime value in each terminal state as the terminal cell for the underlying developmental process.</p>
    </sec>
    <sec id="SEC2-7">
      <title>Inferring cell branch probabilities and differentiation potential</title>
      <p>Similar to (<xref rid="B9" ref-type="bibr">9</xref>), we model differentiation as a stochastic process on our learned cell-state manifold where the cells can follow the paths in the pruned kNN graph <inline-formula><tex-math id="M00058" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G^*}$\end{document}</tex-math></inline-formula> to reach any of the terminal states. Following (<xref rid="B9" ref-type="bibr">9</xref>), we model this stochastic process using an absorbing Markov Chain with the terminal cells acting as the absorbing states. Essentially, this formulation enables us to calculate the differentiation potential (DP) for each cell, a quantity that represents the potency of a cell to differentiate into specialized cell types. Given a set of terminal cells <inline-formula><tex-math id="M00059" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbb {T}_c$\end{document}</tex-math></inline-formula>, for each cell <italic toggle="yes">i</italic>, we compute the branch probabilities <inline-formula><tex-math id="M00060" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p_{b_{ij}} (j \in \mathbb {T}_c)$\end{document}</tex-math></inline-formula>, which represents the probability of cell <italic toggle="yes">i</italic> reaching a terminal cell <italic toggle="yes">j</italic> (Figure S1B). Since DP of a cell (<inline-formula><tex-math id="M00061" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$d_{p_{i}}$\end{document}</tex-math></inline-formula>) quantitatively characterizes the potency of a cell to maturate to different terminal states it can be obtained by computing the entropy of the branch probabilities of each cell as follows (Figure S1C):<disp-formula id="M11"><label>(11)</label><tex-math id="M00062" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} d_{p_{i}} = -\sum _{j \in \mathbb {T}_c} p_{b_{ij}}\log {p_{b_{ij}}} \end{equation*}$$\end{document}</tex-math></disp-formula>This is a reasonable way of modelling DP because cells with heterogeneous branch probabilities can be expected to have lesser potency of differentiating into diverse cell types. In the remainder of this section, we discuss the key steps involved in computing the branch probabilities for each cell <italic toggle="yes">i</italic>.</p>
      <list list-type="order">
        <list-item>
          <p><bold>Waypoint sampling for scalable modelling of DP</bold>: Given the scRNA-seq dataset with <italic toggle="yes">N</italic> cells, fitting an absorbing Markov Chain can be computationally intractable for large <italic toggle="yes">N</italic>. To scale our absorbing Markov Chain model to large datasets, we sample a subset of cells <italic toggle="yes">M</italic>, from the scRNA-seq dataset such that <italic toggle="yes">M</italic> &lt; &lt;<italic toggle="yes">N</italic>. We call these subset of cells as <italic toggle="yes">landmarks</italic> or <italic toggle="yes">waypoints</italic>. Specifically, given a set of <italic toggle="yes">K</italic> disjoint partitions of the embedding space <italic toggle="yes">y</italic>*, we sample <italic toggle="yes">k</italic> waypoints per cluster by applying <italic toggle="yes">k</italic>-means++ initialization for each cluster. We use the refined clusters obtained from the Metric-learning step for sampling the waypoints. Using such a scheme for waypoint sampling has two main advantages. Firstly, using a kmeans++ like scheme in each cluster ensures high intra-cluster waypoint coverage. Secondly, sampling waypoints from each cluster guarantees coverage of the entire embedding landscape. In contrast, (<xref rid="B31" ref-type="bibr">31</xref>,<xref rid="B32" ref-type="bibr">32</xref>) use random sampling to compute waypoints which provides no coverage guarantees. Palantir (<xref rid="B9" ref-type="bibr">9</xref>) uses Max-min sampling (<xref rid="B33" ref-type="bibr">33</xref>) to compute waypoints which is more efficient than random sampling but might require a large number of waypoints to cover the embedding space.</p>
        </list-item>
        <list-item>
          <p><bold>Computing waypoint to terminal cell(s) probabilities</bold>: Given a set of waypoints <inline-formula><tex-math id="M00063" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {W}$\end{document}</tex-math></inline-formula> consisting of <italic toggle="yes">M</italic> waypoints, we compute a nearest-neighbor graph <inline-formula><tex-math id="M00064" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}_w$\end{document}</tex-math></inline-formula> using the low-dimensional representations of <inline-formula><tex-math id="M00065" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {W}$\end{document}</tex-math></inline-formula>. We then prune <inline-formula><tex-math id="M00066" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}_w$\end{document}</tex-math></inline-formula> using the short-circuit edge pruning (see Pseudotime computation) with the undirected connectivity graph <inline-formula><tex-math id="M00067" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {U}$\end{document}</tex-math></inline-formula> as a reference model. Furthermore, following (<xref rid="B9" ref-type="bibr">9</xref>), we also remove edges in <inline-formula><tex-math id="M00068" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}_w$\end{document}</tex-math></inline-formula> which violate the pseudotime ordering between waypoint cells. Formally, an edge <inline-formula><tex-math id="M00069" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$w_{ij} \in \mathcal {G}_w$\end{document}</tex-math></inline-formula> from waypoint <italic toggle="yes">w</italic><sub><italic toggle="yes">i</italic></sub> to <italic toggle="yes">w</italic><sub><italic toggle="yes">j</italic></sub> is pruned iff:<disp-formula id="M12"><label>(12)</label><tex-math id="M00070" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \tau ^p_i &gt;\tau ^p_j + \alpha \sigma _{ij} \end{equation*}$$\end{document}</tex-math></disp-formula></p>
          <p>where <inline-formula><tex-math id="M00071" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tau ^p_i$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M00072" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tau ^p_j$\end{document}</tex-math></inline-formula> represent the pseudotime for waypoints <italic toggle="yes">w</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">w</italic><sub><italic toggle="yes">j</italic></sub> respectively and σ<sub><italic toggle="yes">ij</italic></sub> represents the scaling factor for cell <italic toggle="yes">w</italic><sub><italic toggle="yes">i</italic></sub> given by the distance of <italic toggle="yes">w</italic><sub><italic toggle="yes">i</italic></sub> to its <italic toggle="yes">l</italic>th neighbor in <inline-formula><tex-math id="M00073" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}_w$\end{document}</tex-math></inline-formula>. The statistical test in Equation (<xref rid="M12" ref-type="disp-formula">12</xref>) differs from the formulation in (<xref rid="B9" ref-type="bibr">9</xref>) in terms of the parameter α. We found that parameterizing Equation (<xref rid="M12" ref-type="disp-formula">12</xref>) with the user-defined parameter α provides an additional flexibility in controlling the number of edges that are pruned, which is an important aspect of fitting an absorbing Markov Chain.</p>
          <p>Given a pruned waypoint nearest-neighbor graph <inline-formula><tex-math id="M00074" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}_w^*$\end{document}</tex-math></inline-formula> and a set of terminal cells <inline-formula><tex-math id="M00075" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbb {T}_c$\end{document}</tex-math></inline-formula>, we row-normalize <inline-formula><tex-math id="M00076" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}_w^*$\end{document}</tex-math></inline-formula> to obtain the transition matrix <italic toggle="yes">T</italic>. For two waypoints <italic toggle="yes">w</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">w</italic><sub><italic toggle="yes">j</italic></sub>, the entry <italic toggle="yes">t</italic><sub><italic toggle="yes">ij</italic></sub> in <italic toggle="yes">T</italic> represents the probability of transitioning from waypoint <italic toggle="yes">w</italic><sub><italic toggle="yes">i</italic></sub> to <italic toggle="yes">w</italic><sub><italic toggle="yes">j</italic></sub>. An absorbing Markov Chain is specified by a transition matrix of the form <inline-formula><tex-math id="M00077" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$[\overset{Q}{0}\ \overset{R}{I}]$\end{document}</tex-math></inline-formula>, where <italic toggle="yes">Q</italic> represents the transition probabilities of moving between intermediate states and <italic toggle="yes">R</italic> represents the transition probabilities of moving from intermediate states to the terminal states. We represent our transition matrix <italic toggle="yes">T</italic> using this formulation and compute the waypoint to terminal cell branch probabilities as follows:<disp-formula id="M13"><label>(13)</label><tex-math id="M00078" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} P_{\mathcal {W}\mathbb {T}_c} = FR \end{equation*}$$\end{document}</tex-math></disp-formula></p>
          <p>where <italic toggle="yes">F</italic> is the fundamental matrix given by <italic toggle="yes">F</italic> = (<italic toggle="yes">I</italic> − <italic toggle="yes">Q</italic>)<sup>−1</sup>. Since our Transition matrix <italic toggle="yes">T</italic> can be sparse, we recommend computing the fundamental matrix using the Moore–Penrose pseudoinverse to avoid numerical issues.</p>
        </list-item>
        <list-item>
          <p><bold>Computing cell to waypoint connectivity</bold>: Given the pruned nearest neighbor graph <inline-formula><tex-math id="M00079" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}^*$\end{document}</tex-math></inline-formula>, we compute cell to cell connectivity using a local random walk (LRW) (<xref rid="B34" ref-type="bibr">34</xref>) formulation. LRW is a quasi-local method to estimate connectivity between nodes in a graph based on limiting a random-walk to a fixed number of steps. Hence, the approach is computationally much more efficient than using a global random walk until convergence. Formally, the LRW connectivity ζ<sup>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>)</sup> between two cells indexed by <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> is given by:<disp-formula id="M14"><label>(14)</label><tex-math id="M00080" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \zeta ^{(i, j)}(t) = k_ip_{ij}(t) + k_jp_{ji}(t) \end{equation*}$$\end{document}</tex-math></disp-formula></p>
          <p>where <italic toggle="yes">p</italic><sub><italic toggle="yes">ij</italic></sub>(<italic toggle="yes">t</italic>) and <italic toggle="yes">p</italic><sub><italic toggle="yes">ji</italic></sub>(<italic toggle="yes">t</italic>) represent the probabilities obtained when moving from cell <italic toggle="yes">i</italic> to <italic toggle="yes">j</italic> and vice-versa at time <italic toggle="yes">t</italic> respectively. The constants <italic toggle="yes">k</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">k</italic><sub><italic toggle="yes">j</italic></sub> are set to <inline-formula><tex-math id="M00081" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\frac{k}{|\mathcal {E}^*_k|}$\end{document}</tex-math></inline-formula> where <italic toggle="yes">k</italic> is the number of nearest neighbors and <inline-formula><tex-math id="M00082" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$|\mathcal {E}^*_k|$\end{document}</tex-math></inline-formula> is the total number of edges in <inline-formula><tex-math id="M00083" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}^*$\end{document}</tex-math></inline-formula>. Given the similarity matrix <inline-formula><tex-math id="M00084" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {Z}$\end{document}</tex-math></inline-formula> representing LRW-based connectivities between different cells we can index <inline-formula><tex-math id="M00085" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {Z}$\end{document}</tex-math></inline-formula> to compute cell to waypoint similarities, <inline-formula><tex-math id="M00086" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {Z}_w$\end{document}</tex-math></inline-formula>.</p>
        </list-item>
      </list>
      <p>Given the cell to waypoint similarities <inline-formula><tex-math id="M00087" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {Z}_w$\end{document}</tex-math></inline-formula>, and waypoint to terminal state probabilities <inline-formula><tex-math id="M00088" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P_{\mathcal {W}\mathbb {T}_c}$\end{document}</tex-math></inline-formula>, we compute the cell to terminal states branch probabilities <inline-formula><tex-math id="M00089" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p_{b_{ij}}$\end{document}</tex-math></inline-formula> by a simple projection:<disp-formula id="M15"><label>(15)</label><tex-math id="M00090" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} P_b = \mathcal {Z}_w P_{\mathcal {W}\mathbb {T}_c} \end{equation*}$$\end{document}</tex-math></disp-formula>where <italic toggle="yes">P</italic><sub><italic toggle="yes">b</italic></sub> is a <inline-formula><tex-math id="M00091" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N \times |\mathbb {T}_c|$\end{document}</tex-math></inline-formula> matrix representing branch probabilities for each cell. We then compute the DP for each cell using Equation (<xref rid="M11" ref-type="disp-formula">11</xref>).</p>
    </sec>
    <sec id="SEC2-7a">
      <title>Inference of gene expression trends along lineages</title>
      <p>To visualize the variation in the expression of a gene <italic toggle="yes">g</italic> across different lineages with pseudotime, we fit generalized additive models (GAMs) to the gene expressions and pseudotime values (<italic toggle="yes">g</italic><sub><italic toggle="yes">i</italic></sub>, <inline-formula><tex-math id="M00092" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tau ^p_i$\end{document}</tex-math></inline-formula>) of cells along a particular lineage <italic toggle="yes">j</italic> weighted by their branch probabilities <inline-formula><tex-math id="M00093" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p_{b_{ij}}$\end{document}</tex-math></inline-formula> for that lineage (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Note 2</xref> in (<xref rid="B9" ref-type="bibr">9</xref>) for more details). We imputed the preprocessed expression value of gene <italic toggle="yes">g</italic> using MAGIC (<xref rid="B21" ref-type="bibr">21</xref>), when computing the lineage trends for the hematopoiesis and EB datasets. No imputation was performed for the colon IBD dataset. We used the LinearGAM implementation available in the <italic toggle="yes">pyGAM</italic> Python package (<ext-link xlink:href="https://doi.org/10.5281/zenodo.1208724" ext-link-type="uri">https://doi.org/10.5281/zenodo.1208724</ext-link>) to fit the lineage trends with the regularization penalty set to 10 and the order of the splines set to 4 for all the experiments.</p>
    </sec>
    <sec id="SEC2-8">
      <title>Differential expression and gene ontology analysis</title>
      <p>We used the Wilcoxon-rank sum test available in <italic toggle="yes">Scanpy</italic> (<xref rid="B8" ref-type="bibr">8</xref>) to estimate differentially expressed (DE) genes for each cluster and the Benjamini-Hochberg correction for adjusting the p-values. All genes were ranked in the DE analysis, which is the default behavior in Scanpy 1.7.2. To assess the functional significance of MARGARET inferred clusters, we performed Gene Ontology (GO) analysis using the <italic toggle="yes">gprofiler-official</italic> (<xref rid="B35" ref-type="bibr">35</xref>) package. To determine the GO terms for a cluster, we selected the top DE genes with a log fold change value greater than 1.0 and the adjusted p-value less than 0.05. In case more than 500 genes were included, we selected the top 500 genes to obtain a list of GO terms associated with that cluster.</p>
    </sec>
    <sec id="SEC2-9">
      <title>Performance metrics for trajectory inference</title>
      <p>Here we describe the quantitative performance metrics used for evaluating the trajectory inferred by a TI method:</p>
      <list list-type="order">
        <list-item>
          <p><italic toggle="yes">Ipsen–Mikhailov (IM) similarity</italic>: We used the IM distance (<xref rid="B36" ref-type="bibr">36</xref>) metric for global topology comparison between PAGA and MARGARET. Before computing the IM distance, the trajectories inferred from both the methods (including the ground-truth trajectory) were coerced to an undirected graph. Formally, the Laplacian spectra for a graph <inline-formula><tex-math id="M00094" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}$\end{document}</tex-math></inline-formula> can be specified as a mixture of Lorentz distributions (Eqn. <xref rid="M16" ref-type="disp-formula">16</xref>) with the same half-width at half-maximum γ and centered at the frequencies ω<sub><italic toggle="yes">k</italic></sub> given by <inline-formula><tex-math id="M00095" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\omega _k = \sqrt{|\lambda _k|}$\end{document}</tex-math></inline-formula>, where λ<sub><italic toggle="yes">k</italic></sub> is the <italic toggle="yes">k</italic><sup><italic toggle="yes">th</italic></sup> eigenvalue of the graph Laplacian of <inline-formula><tex-math id="M00096" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}$\end{document}</tex-math></inline-formula>. The constant <italic toggle="yes">C</italic> is a normalization constant for the resulting probability distribution.<disp-formula id="M16"><label>(16)</label><tex-math id="M00097" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \rho (\omega ) = C\sum _{k=1}^{N-1}\frac{\gamma }{(\omega - \omega _k)^2 + \gamma ^2} \end{equation*}$$\end{document}</tex-math></disp-formula></p>
          <p>The IM distance measures the difference between the Laplacian spectra of two graphs as follows:<disp-formula id="M17"><label>(17)</label><tex-math id="M00098" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} IM(\rho _1, \rho _2) = \sqrt{\int _0^{\infty }(\rho _1(\omega ) - \rho _2(\omega ))^2 d\omega } \end{equation*}$$\end{document}</tex-math></disp-formula></p>
          <p>The IM similarity between two graphs can then be computed as <italic toggle="yes">IS</italic>(<italic toggle="yes">G</italic><sub>1</sub>, <italic toggle="yes">G</italic><sub>2</sub>) = 1 − <italic toggle="yes">IM</italic>(<italic toggle="yes">G</italic><sub>1</sub>, <italic toggle="yes">G</italic><sub>2</sub>).</p>
          <p>Since, among competing methods, only PAGA and VIA output a connected graph, we adapt the cell landscape in Monocle3 to the milestone framework by implementing the coarse trajectory inference procedure outlined in (<xref rid="B7" ref-type="bibr">7</xref>). Similarly, for Palantir (which outputs a continuous cell landscape), we apply PAGA using the cell embeddings inferred using Palantir to convert a continuous trajectory to a network of milestones.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Rank correlation metrics</italic>: We used two rank correlation metrics to compare the ground truth ordering and pseudotime orderings inferred by the TI methods. More specifically, we used the <italic toggle="yes">Kendall’s tau (KT)</italic> and the <italic toggle="yes">Spearman’s rank (SR)</italic> correlation coefficients to estimate the similarity in rank orderings of the data. The KT correlation coefficient can be specified as follows:<disp-formula id="M18"><label>(18)</label><tex-math id="M00099" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \tau _b = \frac{P - Q}{\sqrt{(P + Q + T) * (P + Q + U)}} \end{equation*}$$\end{document}</tex-math></disp-formula></p>
          <p>where <italic toggle="yes">P</italic> and <italic toggle="yes">Q</italic> represent the number of concordant and discordant pairs, respectively. <italic toggle="yes">T</italic> and <italic toggle="yes">U</italic> represent the number of ties in the two orderings, respectively. The SR correlation coefficient is simply defined as the Pearson’s correlation coefficient applied to the ranks of the variables measured in the two orderings. We used the <italic toggle="yes">scipy.stats</italic> package to compute both KT and SR correlation coefficients.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Combined score</italic>: We benchmarked all candidate methods based on their performance in capturing the global topology and the pseudotime ordering. We first computed the IM similarity between the inferred trajectory and the ground truth trajectory. We set the IM similarity score for a method as the best score that can be obtained when using either Louvain or Leiden clustering at resolution 1.0. Similarly, we also computed the KT correlation between the predicted and the ground-truth pseudotime orderings. We then perform min-max normalization of the IM and KT scores obtained by all candidate methods separately for the multifurcating and the disconnected datasets. The combined score for a method is then obtained by averaging the normalized IM and KT scores of that method applied across the simulated datasets.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Clustering metrics</italic>: We used <italic toggle="yes">adjusted Rand index</italic> (ARI) and <italic toggle="yes">normalized mutual information</italic> (NMI) metrics to assess the clustering performance of MARGARET embeddings. The ARI metric corrects the Rand index for chance and is specified by the following formulation:<disp-formula id="M19"><label>(19)</label><tex-math id="M000100" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*} ARI = \frac{\sum _{ij} {n_{ij} \atopwithdelims ()2} - [\sum _i {a_i \atopwithdelims ()2}\sum _j {b_j \atopwithdelims ()2}]/{n \atopwithdelims ()2}}{\frac{1}{2} [\sum _i {a_i \atopwithdelims ()2} + \sum _j {b_j \atopwithdelims ()2}] - [\sum _i {a_i \atopwithdelims ()2}\sum _j {b_j \atopwithdelims ()2}]/{n \atopwithdelims ()2}} \end{eqnarray*}$$\end{document}</tex-math></disp-formula></p>
          <p>where <italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">b</italic><sub><italic toggle="yes">j</italic></sub> and <italic toggle="yes">n</italic><sub><italic toggle="yes">ij</italic></sub> are values from the contingency table which is used to estimate the overlap between two partitionings. The NMI metric between two clusterings <italic toggle="yes">C</italic><sub>1</sub> and <italic toggle="yes">C</italic><sub>2</sub> can be formulated as follows:<disp-formula id="M20"><label>(20)</label><tex-math id="M000101" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} NMI = \frac{\mathbb {I}(C_1, C_2)}{\sqrt{\mathbb {H}(C_1)\mathbb {H}(C_2)}} \end{equation*}$$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M000102" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbb {I}$\end{document}</tex-math></inline-formula> is the mutual information between the two clusterings <italic toggle="yes">C</italic><sub>1</sub> and <italic toggle="yes">C</italic><sub>2</sub> and <inline-formula><tex-math id="M000103" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbb {H}$\end{document}</tex-math></inline-formula> is the Shannon-Entropy of the clustering.</p>
        </list-item>
      </list>
    </sec>
    <sec id="SEC2-10">
      <title>Visualization of embedding</title>
      <p>We used UMAP (<xref rid="B12" ref-type="bibr">12</xref>) (with default parameters) for visualization of all the datasets except the early Hematopoiesis scRNA-seq data provided by (<xref rid="B9" ref-type="bibr">9</xref>), for which we used tSNE (<xref rid="B37" ref-type="bibr">37</xref>) visualization with a perplexity value of 180 for replicate 1 and 150 for replicate 2.</p>
    </sec>
    <sec id="SEC2-11">
      <title>Computing Crypt-axis score</title>
      <p>As suggested in (<xref rid="B19" ref-type="bibr">19</xref>), we used the expression of the following genes to define the crypt-axis (CA) score: <italic toggle="yes">SEPP1</italic>, <italic toggle="yes">CEACAM7</italic>, <italic toggle="yes">PLAC8</italic>, <italic toggle="yes">CEACAM1</italic>, <italic toggle="yes">TSPAN1</italic>, <italic toggle="yes">CEACAM5</italic>, <italic toggle="yes">CEACAM6</italic>, <italic toggle="yes">IFI27</italic>, <italic toggle="yes">DHRS9</italic>, <italic toggle="yes">KRT20</italic>, <italic toggle="yes">RHOC</italic>, <italic toggle="yes">CD177</italic>, <italic toggle="yes">PKIB</italic>, <italic toggle="yes">HPGD</italic> and <italic toggle="yes">LYPD8</italic>. The final crypt-axis score for each cell was then computed by summing over the normalized expression (between 0 and 1) values of each gene included in our set.</p>
    </sec>
    <sec id="SEC2-12">
      <title>Simulation of benchmark datasets</title>
      <p>To benchmark MARGARET’s performance on several aspects of trajectory inference, we generated a suite of synthetic single-cell gene expression datasets representing different complex trajectory models. We used <italic toggle="yes">dyntoy</italic> (<xref rid="B13" ref-type="bibr">13</xref>) (<ext-link xlink:href="https://github.com/dynverse/dyntoy" ext-link-type="uri">https://github.com/dynverse/dyntoy</ext-link>) to generate the synthetic benchmark (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref> for the details of different synthetic datasets) spanning multifurcating and disconnected topologies. For benchmarking MARGARET, PAGA (<xref rid="B28" ref-type="bibr">28</xref>) and Monocle3 (<xref rid="B7" ref-type="bibr">7</xref>), all the simulated datasets were subjected to the same data preprocessing steps following Seurat (<xref rid="B24" ref-type="bibr">24</xref>): removal of genes expressed in less than 3 cells, normalization, log transformation with a pseudo count of 1.0, and finally z-score normalization. For benchmarking <italic toggle="yes">Palantir</italic>, the steps proposed by the authors in (<xref rid="B9" ref-type="bibr">9</xref>) were used to preprocess the simulated datasets.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>MARGARET outperforms other TI methods on a diverse simulated benchmark</title>
      <p>We benchmarked MARGARET’s performance on a variety of synthetic datasets (Materials and Methods) consisting of multifurcating and disconnected trajectories (with complex multifurcating components)(<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>) against state-of-the-art TI methods—Partition-Based Graph Abstraction (PAGA) (<xref rid="B28" ref-type="bibr">28</xref>), Palantir (<xref rid="B9" ref-type="bibr">9</xref>), Monocle3 (<xref rid="B7" ref-type="bibr">7</xref>) and VIA (<xref rid="B14" ref-type="bibr">14</xref>).</p>
      <p>Figure <xref rid="F2" ref-type="fig">2A</xref> and B qualitatively compares the trajectories inferred by the algorithms on a multifurcating and a disconnected dataset sampled from our simulated benchmark (Figure <xref rid="F2" ref-type="fig">2A</xref>). Monocle3 correctly captured the overall topology of the disconnected dataset but underestimated the number of clusters in the two components severely. PAGA and Palantir failed to capture the disconnected topology altogether as PAGA represented two components as cyclic topologies while Palantir represented the entire embedding landscape as a single component (Figure <xref rid="F2" ref-type="fig">2B</xref>). VIA failed to capture the correct number of components in the disconnected trajectory. Moreover, the directionality in the VIA inferred trajectory suggested a <italic toggle="yes">converging</italic> topology in the larger of the two components leading to highly inaccurate pseudotime estimates. MARGARET outperformed the other algorithms on this dataset by most closely recovering the underlying global topology accompanied by accurate detection of terminal state clusters. For the multifurcating dataset, PAGA and Palantir failed to capture the correct branching topology, whereas Monocle3 failed to recover the global topology as it inferred the overall trajectory as two separate components (Figure <xref rid="F2" ref-type="fig">2B</xref>). In contrast, VIA and MARGARET were able to capture the underlying multifurcating topology accurately. However, VIA failed to detect multiple branchings and terminal states in the trajectory and the MARGARET captured topology was qualitatively the most similar to the ground truth topology.</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>MARGARET outperforms state-of-the-art TI methods on a simulated benchmark. MARGARET outperformed state-of-the-art TI methods on qualitative and quantitative metrics when applied to a simulated benchmark consisting of ten datasets with diverse trajectory types. (<bold>A</bold>) (left) A sample disconnected dataset (4929 cells), and (right) a sample multifurcating dataset (5000 cells) (<bold>B</bold>) Visualization of the cell embedding landscape inferred by different TI methods on the disconnected (Top) and multifurcating (bottom) datasets. Palantir embedding landscapes shown with projected pseudotime values. Monocle3 inferred trajectory graph projected on the embedding with colors denoting cluster information. PAGA, VIA and MARGARET outputs shown as connectivity graphs. PAGA, Monocle3 and MARGARET inferred graphs were computed using Leiden clustering while VIA inferred graphs were computed using PARC clustering. The clustering resolution was set to 0.4 for all methods (except Monocle3 which selects the best resolution). For the MARGARET connectivity graph, the red nodes denote starting cell clusters and the cyan nodes denote detected terminal states. (<bold>C</bold>) Combined score (higher score is better, see Materials and Methods) comparison between MARGARET and other TI methods for the disconnected (left) and the multifurcating (right) datasets (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> for the detail comparison of IM similarity, Kendall’s tau (KT), and SpearmanRank (SR) correlation metrics.</p>
        </caption>
        <graphic xlink:href="gkac412fig2" position="float"/>
      </fig>
      <p>We quantitatively benchmarked MARGARET’s performance against other methods on two main aspects of TI: <italic toggle="yes">accuracy in inferring the global topology</italic> and <italic toggle="yes">accuracy of pseudotime ordering</italic>. We assessed the effectiveness of a TI method in recovering the underlying global topology of cells by evaluating the Ipsen-Mikhailov (IM) similarity (Materials and Methods) between the ground truth and the inferred trajectory graph. To compare two undirected trajectories (represented as graphs), we adopted the network of ‘milestones’ representation framework as proposed by (<xref rid="B13" ref-type="bibr">13</xref>). Next, we assessed the accuracy in recovering the pseudotime ordering of cells by computing the Kendall’s tau (KT) and the Spearman rank (SR) correlation (Materials and Methods) between the ground truth and the inferred ordering. We then assign a combined score (see Materials and Methods) to each TI method which represents the efficacy of the method in capturing both global topology and ordering information. Figure <xref rid="F2" ref-type="fig">2C</xref> presents a comparison between MARGARET and other methods on our simulated benchmark.</p>
      <p>For the disconnected benchmark, MARGARET outperformed other methods on all the five datasets with up to 19.2 % improvement over the next best method. Similarly, for the multifurcating benchmark, MARGARET achieved up to 18.57% improvement over the next best method. The superior performance of MARGARET on both benchmarks suggests its ability to perfectly capture diverse trajectory types. In contrast, other methods performed well for only one type of trajectory (either disconnected or multifurcating) but poorly for the other trajectory type. For example, PAGA and Palantir performed well for the multifurcating datasets but their combined score was lower compared to other methods for the disconnected datasets. On the other hand, Monocle3 and VIA, while performing better than PAGA and Palantir for the disconnected datasets, performed poorly for the complex multifurcating trajectories. Moreover, qualitative analysis of the results on the mutlifurcating benchmark suggests Monocle3 to be biased towards capturing disconnected components as it partitioned several multifurcating datasets in our benchmark into independent disconnected components (data not shown). The detailed comparison of the TI methods for the global topology and pseudotime ordering tasks (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>) demonstrated MARGARET’s superior performance over other methods in reconstructing the underlying global topology and recovering the pseudotime order for the majority of the datasets in our benchmarks. Across a range of clustering resolutions and clustering methods, MARGARET consistently performed well (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S3 and S4</xref>) illustrating its robustness towards these parameters. It is worth noting that for evaluating VIA on the global topology and the pseudotime ordering tasks, we used PARC clustering (<xref rid="B38" ref-type="bibr">38</xref>) which can also be used with MARGARET. Moreover, for VIA, we performed coarse analysis as we found the VIA inferred IM and correlation scores to worsen after the fine analysis. We also applied MARGARET to a simulated dataset with a cyclic ground-truth trajectory (Cyclic_1) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5A</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3A</xref>). For this dataset, MARGARET, VIA and PAGA were able to capture the global topology accurately while Palantir and Monocle3 failed to capture the cyclic structure (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5B</xref>).</p>
      <p>Thus, our analysis shows the broad applicability of MARGARET to a diverse suite of trajectory types compared to other TI methods that usually perform well on one type of trajectory but fail to model other trajectory types.</p>
    </sec>
    <sec id="SEC3-2">
      <title>MARGARET outperforms competing TI methods on a real dataset benchmark</title>
      <p>We next compared the performance of different TI methods on real biological datasets. For this evaluation, we selected two multifurcating (oligodendrocyte differentiation (<xref rid="B16" ref-type="bibr">16</xref>) and planaria parenchyme differentiation (<xref rid="B17" ref-type="bibr">17</xref>)) and two disconnected (placenta trophoblast differentiation (<xref rid="B15" ref-type="bibr">15</xref>) and mouse cell atlas (<xref rid="B15" ref-type="bibr">15</xref>)) datasets (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref> for dataset statistics) with ground-truth trajectories available as a network of milestones representation (<xref rid="B13" ref-type="bibr">13</xref>).</p>
      <p>Figure <xref rid="F3" ref-type="fig">3A</xref> shows MARGARET inferred trajectories and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6</xref> shows the qualitative performance of other state-of-the-art TI methods on the real dataset benchmark. For the datasets with disconnected reference trajectories (<italic toggle="yes">placenta trophoblast differentiation</italic> and <italic toggle="yes">mouse cell atlas</italic>), only MARGARET inferred trajectories correctly captured the number of disconnected components while accurately preserving different cell types specific to each component (see cell-type annotations in Figure <xref rid="F3" ref-type="fig">3A</xref> (i-ii)). VIA and Palantir were unable to capture the underlying disconnected topology for both the datasets. PAGA was able to capture the number of components in the mouse cell atlas dataset but failed to capture the disconnected topology for trophoblast differentiation. While Monocle 3 was able to infer disconnected trajectory for both these datasets, it also overestimated the number of disconnected components for both datasets. Quantitative comparison on these datasets (Figure <xref rid="F3" ref-type="fig">3B</xref>) revealed MARGARET to be the best performer which achieved 30.56–97.13% improvement in combined score over the next best performing method indicating its superiority for both global topology and cell ordering tasks. For topology inference task, PAGA performed the worst and exhibited the lowest IM similarity (or highest IM distance) scores while VIA, Monocle 3 and Palantir performed similarly (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7A</xref>). MARGARET achieved up to <inline-formula><tex-math id="M000104" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$21.04\%$\end{document}</tex-math></inline-formula> improvement (over the next best method) in lowering IM distance. For the cell ordering task, MARGARET outperformed the other methods by a large margin (KT correlation of MARGARET for <italic toggle="yes">placenta trophoblast differentiation</italic> was 0.53 as compared to 0.02 by the next best method Palantir, <inline-formula><tex-math id="M000105" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sim 23\%$\end{document}</tex-math></inline-formula> improvement for mouse cell atlas). Monocle 3 exhibited the lowest KT correlation scores among all methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7B</xref>). Particularly for placenta trophoblast differentiation, only MARGARET was able to recover the temporal order of cells which other methods failed to capture leading to near zero or negative KT and SR correlation scores (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7B</xref>).</p>
      <fig position="float" id="F3">
        <label>Figure 3.</label>
        <caption>
          <p>MARGARET outperforms state-of-the-art TI methods on a real benchmark. MARGARET outperformed state-of-the-art TI methods on qualitative and quantitative metrics when applied to a real benchmark consisting of four datasets with disconnected (placenta trophoblast differentiation and mouse cell atlas) and multifurcating (oligodendrocyte differentiation and planaria parenchyme differentiation) trajectories. (<bold>A</bold>) Visualization of MARGARET inferred pseudotime and trajectories on the real dataset benchmark. The first column shows the ground-truth trajectory represented as network-of-milestones. The second column shows MARGARET inferred pseudotime projected on the 2D embeddings. The third column shows MARGARET inferred trajectories where initial and terminal states were annotated with ground-truth cell-type information. (<bold>B</bold>) Combined score (higher score is better, see Materials and Methods) comparison between MARGARET and other TI methods for the disconnected (left) and the multifurcating (right) real datasets (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref> for a detailed comparison of IM distance, Kendall’s tau (KT), and Spearman-rank (SR) correlation metrics).</p>
        </caption>
        <graphic xlink:href="gkac412fig3" position="float"/>
      </fig>
      <p>For the datasets with multifurcating reference trajectories (<italic toggle="yes">oligodendrocyte differentiation</italic> and <italic toggle="yes">planaria parenchyme differentiation</italic>), Monocle 3 incorrectly captured the underlying trajectory as a disconnected graph further justifying our observation that Monocle 3 might be biased towards disconnected trajectories. While all other methods were able to capture the multifurcations in the underlying trajectory (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6</xref>), MARGARET outperformed all the methods based on the combined score (Figure <xref rid="F3" ref-type="fig">3B</xref>, up to <inline-formula><tex-math id="M000106" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$13.37\%$\end{document}</tex-math></inline-formula> improvement over the next best method). PAGA performed the worst on the global-topology task with other methods exhibiting comparable performance while Monocle3 performed the worst on the cell ordering task with consistent negative KT scores on both multifurcating datasets. MARGARET consistently exhibited high IM similarity, KT, and SR scores on both datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7</xref>). We further visualized the spectrum, ρ(ω), for the ground-truth trajectory and the trajectory inferred by different TI methods for one multifurcating (oligodendrocyte differentiation, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7C</xref>) and one disconnected (mouse cell atlas, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7D</xref>) dataset which further demonstrated superior overlap of the spectrum for MARGARET inferred trajectory with that of the ground-truth trajectory spectrum as compared to that of other methods. These results demonstrate that while other TI methods are more suited towards specific trajectory types, MARGARET can generalize much better for different types of trajectories.</p>
    </sec>
    <sec id="SEC3-3">
      <title>MARGARET generalizes the quantification of differentiation potential for complex trajectories</title>
      <p>Differentiation potential (DP) as introduced by Palantir measures cell fate plasticity along a trajectory and can also characterize key events in the underlying dynamic process (<xref rid="B9" ref-type="bibr">9</xref>). However, Palantir is able to quantify DP only for connected trajectories as it models the trajectory as a continuum of states. To evaluate whether MARGARET’s DP formulation can generalize to more complex disconnected trajectories, we benchmarked MARGARET’s DP inference against that of Palantir for two complex simulated disconnected trajectories (Disconnected_4 and Disconnected_6) (Figure <xref rid="F4" ref-type="fig">4</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3A</xref>). For both the datasets, MARGARET accurately captured the DP trends in different disconnected components and MARGARET inferred DP showed high negative Spearman-Rank correlation with the ground-truth pseudotime. DP is expected to have negative correlation with pseudotime (<xref rid="B9" ref-type="bibr">9</xref>) since as cells differentiate and proceed towards terminal states, pseudotime increases while the DP of the cell decreases. In contrast, Palantir’s DP inference performed poorly for disconnected trajectories as observed from the correlation analysis between DP and ground truth pseudotime (Figure <xref rid="F4" ref-type="fig">4</xref>). The poor performance of Palantir could be the result of its single component assumption when inferring the DP which does not extend to multiple independent disconnected components within the same dataset. Hence, for both the disconnected datasets, the DP inference by MARGARET was superior to that of Palantir indicating the applicability of MARGARET’s DP inference to a wider variety of trajectories.</p>
      <fig position="float" id="F4">
        <label>Figure 4.</label>
        <caption>
          <p>MARGARET inferred DP generalizes to disconnected trajectories. (<bold>A</bold>) (top-left) Schematic of a ground truth simulated dataset with three disconnected components (Disconnected-4, 7500 cells). The starting cells are shown in red color while the trajectories can be uniquely identified by three different colors. (Top-Middle-1) MARGARET inferred trajectory. (Top-middle-2) MARGARET inferred DP for this dataset. Inferred DP trends are qualitatively consistent across independent components. (Top-right) Palantir inferred DP. The results are qualitatively inconsistent as Palantir is unable to capture the disconnected nature of the underlying trajectory. (Bottom) Scatter plot of Normalized DP vs ground truth pseudotime for both MARGARET (left) and Palantir (right). MARGARET shows a higher negative Spearman-rank correlation with the ground truth pseudotime as compared with Palantir. The cells in the scatter-plot are colored by their disconnected component id in the ground-truth trajectory. (<bold>B</bold>) Same as (A) but for a disconnected dataset with two components (Disconnected-6, 2500 cells).</p>
        </caption>
        <graphic xlink:href="gkac412fig4" position="float"/>
      </fig>
    </sec>
    <sec id="SEC3-4">
      <title>MARGARET learns modular cluster representations during episodic training</title>
      <p>Since MARGARET’s metric-learning approach is aimed at inferring a lower-dimensional cell-state manifold where the distinct cell states are represented by compact cell clusters, we evaluated the compactness of the inferred clusters by tracking the clustering modularity scores and the number of clusters inferred at the end of each episode during training of two single-cell RNA sequencing human hematopoiesis datasets (<xref rid="B9" ref-type="bibr">9</xref>) using Phenograph (<xref rid="B39" ref-type="bibr">39</xref>) across Louvain and Leiden clustering backends. For both datasets, at the end of each training episode, MARGARET improved upon the modularity score of the previous episode before finally converging (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S8</xref>). The clustering modularity score can also be used for estimating MARGARET’s convergence. Interestingly, the number of inferred clusters did not always increase monotonically with the number of episodes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S8A–C</xref>), suggesting that the increase in modularity is due to the improved clustering quality at each episode.</p>
    </sec>
    <sec id="SEC3-5">
      <title>MARGARET can refine the single-cell embeddings learned using other methods</title>
      <p>To investigate the ability of MARGARET’s unsupervised metric learning-based approach, we initialized MARGARET with <italic toggle="yes">d</italic>-dimensional cell embeddings (as obtained from a linear or nonlinear dimension reduction method such as PCA or scVI (<xref rid="B40" ref-type="bibr">40</xref>)) to infer MARGARET-refined <italic toggle="yes">d</italic>-dimensional embeddings. The quality of MARGARET-inferred cell embeddings was evaluated by comparing its cell-type clustering performance (as measured by adjusted rand index (ARI) and normalized mutual information (NMI) metrics) against that of the initial embeddings on a suite of biological datasets for which the ground-truth clustering annotations were available (Methods). As compared to scVI-inferred cell embeddings, MARGARET’s refined embeddings achieved higher ARI and NMI scores across all the datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S9A</xref>). Similar results were observed using a PCA-based initialization (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S9B</xref>), which suggests that MARGARET’s metric learning-based approach can refine the latent representations captured during earlier dimension reduction stages. We also assessed the impact of using different initial clustering methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note 1</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S10</xref>) and training hyperparameters with MARGARET (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note 1</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S11</xref>) and our analysis showed that MARGARET’s metric learning approach is robust to the choice of initial clustering method and training hyperparameters.</p>
    </sec>
    <sec id="SEC3-6">
      <title>MARGARET correctly predicts human hematopoietic differentiation trajectory and associated gene expression changes</title>
      <p>Due to the availability of established lineage-specific markers, hematopoiesis (<xref rid="B41" ref-type="bibr">41</xref>) has been used as a model biological system by several trajectory inference methods (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B31" ref-type="bibr">31</xref>). Using MARGARET, we first explored early human hematopoiesis where hematopoietic stem cells (HSCs), through a hierarchy of progenitors and bifurcation events, give rise to different mature cell types (<xref rid="B41" ref-type="bibr">41</xref>). We applied MARGARET to two human bone marrow scRNA-seq datasets (10X Chromium) (<xref rid="B9" ref-type="bibr">9</xref>) (replicates 1 and 2 consisting of 5780 and 6501 cells, respectively). For both datasets, MARGARET correctly identified all major hematopoietic cell types, including hematopoietic stem cells (HSCs), common lymphoid and myeloid progenitors (CLPs and CMPs respectively), as well as cells committed towards erythroid (erythrocytes and megakaryocytes), monocytic and dendritic cell (classical and plasmacytoid dendritic cells (cDCs and pDCs)) lineages (Figure <xref rid="F5" ref-type="fig">5A</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12A</xref>). The cell type clusters inferred by MARGARET were characterized by the expression of key marker genes, obtained by manually curating a set of marker genes for major hematopoietic cell types through prior literature review (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B42" ref-type="bibr">42–44</xref>) (Figure <xref rid="F5" ref-type="fig">5D</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S12F and 13</xref>). The expression of the marker genes corresponding to major hematopoietic cell types correlated well with the topology of the MARGARET inferred trajectory (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S14</xref>). We utilized the starting cell information provided by (<xref rid="B9" ref-type="bibr">9</xref>) for pseudotime inference (Figure <xref rid="F5" ref-type="fig">5B</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12C</xref>). For both replicates, MARGARET inferred pseudotime follows expected progression, where the pseudotime increases as cells progress towards more specialized cell types from <italic toggle="yes">CD34</italic> enriched stem cells. Moreover, the probability of cells branching to different lineages diminishes as cells commit towards specific lineages (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S15–S17</xref>). Consequently, as expected, MARGARET inferred DP (Figure <xref rid="F5" ref-type="fig">5C</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12B</xref>) decreases as we move towards terminal states in the trajectory since commitment towards a specific lineage is accompanied by a gradual reduction in cell plasticity. Figure <xref rid="F5" ref-type="fig">5E</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12D</xref> represent the annotated hematopoietic trajectory inferred by MARGARET for the two replicates, where the arrows represent transition between cell types.</p>
      <fig position="float" id="F5">
        <label>Figure 5.</label>
        <caption>
          <p>MARGARET delineates major lineages and identifies important transcriptional switches in early human hematopoiesis. Analysis of scRNA-seq data for human hematopoiesis replicate 1 by MARGARET. (<bold>A</bold>) tSNE plot of cell-state embedding inferred by MARGARET for the human hematopoiesis dataset, cells are colored by MARGARET inferred clusters. (<bold>B</bold>) MARGARET pseudotime and (<bold>C</bold>) differentiation potential calculated using one HSC as a start cell. (<bold>D</bold>) Heat map for marker genes for all MARGARET inferred clusters. (<bold>E</bold>) MARGARET inferred trajectory annotated with cell-type and lineage information (important marker genes are mentioned within parantheses with the cell type annotation). Ery: Erythrocyte; Mk: Megakaryocyte; MEP: Megakaryocyte-Erythroid Progenitors; HSC: Hematopoeitic Stem Cells; CLP: Common Lymphoid Progenitors; CMP: Common Myeloid Progenitors; GMP: Granulocyte-Monocyte Progenitors; MDP: Monocyte-Dendritic Cell Progenitors; cDC: Classical Dendritic Cells; pDC: Plasmacytoid Dendritic Cells; Mono: Monocytes. (<bold>F</bold>) Gene expression trends for essential genes for major inferred lineages. (<bold>G</bold>) Differential expression (DE) analysis between cluster 4 (MDP) and cluster 5 (GMP) (<bold>H</bold>) Variation of <italic toggle="yes">CEBPA</italic> and <italic toggle="yes">ID2</italic> gene expressions in the monocyte (Mono) lineage (top) and the dendritic cell (DC) lineage (bottom) for replicate 1. The boxplots summarize the expression of the gene in each cluster in the lineage, where the box depicts the interquartile range (IQR, the range between the 25th and 75th percentile) with the median value, whiskers indicate the maximum and minimum value within 1.5 times the IQR. The red dotted line represents the mean differentiation potential for each cluster in the lineage.</p>
        </caption>
        <graphic xlink:href="gkac412fig5" position="float"/>
      </fig>
      <p>To validate MARGARET inferred trajectories, we computed expression trends for essential marker genes for all major hematopoietic lineages (Figure <xref rid="F5" ref-type="fig">5f</xref>). As expected, expression of <italic toggle="yes">CD34</italic> decreases with increasing pseudotime as cells commit to particular lineages (<xref rid="B41" ref-type="bibr">41</xref>). In contrast, <italic toggle="yes">CD79B</italic> is selectively upregulated in the lymphoid lineage (<xref rid="B45" ref-type="bibr">45</xref>) while <italic toggle="yes">MPO</italic> and <italic toggle="yes">IRF8</italic> are upregulated in the monocyte (<xref rid="B46" ref-type="bibr">46</xref>) and dendritic cell (DC) (<xref rid="B47" ref-type="bibr">47</xref>) lineages, respectively. <italic toggle="yes">ITGA2B</italic> and <italic toggle="yes">GATA1</italic> are selectively upregulated in the megakaryocytic (<xref rid="B48" ref-type="bibr">48</xref>) and erythroid (<xref rid="B49" ref-type="bibr">49</xref>) lineages, respectively. Similar expression trends were observed for replicate 2 demonstrating MARGARET’s robustness (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12E</xref>).</p>
    </sec>
    <sec id="SEC3-7">
      <title>MARGARET characterized progenitor populations for monocytic and dendritic cell lineages</title>
      <p>Interestingly, we observed an initial upregulation in <italic toggle="yes">MPO</italic> expression in both the monocyte and DC lineages (Figure <xref rid="F5" ref-type="fig">5F</xref>). However, with pseudotime progression, <italic toggle="yes">MPO</italic> expression is upregulated in the monocyte lineage but gets downregulated in the DC lineage. To explore the branching of monocyte and DC lineages from CMPs in replicate 1, we investigated the transitions from cluster 10 to cluster 4 and cluster 10 to cluster 5 that are also associated with substantial changes in DP indicating that these transitions accompany important molecular events corresponding to lineage commitment (<xref rid="B9" ref-type="bibr">9</xref>). At the transition from CMPs to monocytes, we observed elevated expressions of monocyte markers ((<xref rid="B42" ref-type="bibr">42</xref>)) including <italic toggle="yes">CEBPA</italic>, and <italic toggle="yes">CEBPE</italic> (Figure 5D, H (top), Figure <xref rid="F6" ref-type="fig">6A</xref>), which correlated with a decrease in DP. The transcription factor (TF) <italic toggle="yes">CEBPA</italic> plays a crucial role in cell fate decisions in granulocyte-monocyte progenitors (GMPs) (<xref rid="B50" ref-type="bibr">50</xref>,<xref rid="B51" ref-type="bibr">51</xref>) to differentiate into granulocyte and monocyte (<xref rid="B42" ref-type="bibr">42</xref>). Apart from elevated expression of <italic toggle="yes">CEBPE</italic> and monocyte markers <italic toggle="yes">MPO</italic>, <italic toggle="yes">LYZ</italic> and <italic toggle="yes">MS4A6A</italic> (<xref rid="B43" ref-type="bibr">43</xref>), the monocyte clusters also strongly expressed granule genes such as <italic toggle="yes">CTSG</italic>, <italic toggle="yes">PRTN3</italic> and <italic toggle="yes">ELANE</italic> (Figure <xref rid="F5" ref-type="fig">5D</xref>), each of which were also highly correlated (&gt;0.92) with the MARGARET inferred monocytic branch probabilities (Figure <xref rid="F6" ref-type="fig">6C</xref>). Monocytes derived from granulocyte-monocyte progenitors (GMPs) are known to express these granule proteases (<xref rid="B52" ref-type="bibr">52</xref>). Therefore, expression of <italic toggle="yes">CEBPA</italic>, <italic toggle="yes">CEBPE</italic> and granule proteases and reduced <italic toggle="yes">FLT3</italic> expression in cluster 5 (Figure <xref rid="F6" ref-type="fig">6A</xref> (left)) indicates the presence of GMPs in cluster 5 (<xref rid="B52" ref-type="bibr">52</xref>). We also observed similar trends for replicate 2 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S18</xref>).</p>
      <fig position="float" id="F6">
        <label>Figure 6.</label>
        <caption>
          <p>MARGARET characterizes cellular heterogeneity in the monocytic and dendritic cell lineages. (<bold>A</bold>) Variation of the expression of <italic toggle="yes">CEBPE</italic> and <italic toggle="yes">FLT3</italic> across the monocyte (Mono) lineage (left) and the DC lineage (right) for replicate 1. The boxplots summarize the expression of the gene in each cluster in the lineage, where the box depicts the interquartile range (IQR, the range between the 25th and 75th percentile) with the median value, whiskers indicate the maximum and minimum value within 1.5 times the IQR. The red dotted line represents the mean differentiation potential for each cluster in the lineage. (<bold>B</bold>) Mean expression of <italic toggle="yes">ITGAX</italic> (top) and <italic toggle="yes">CSF1R</italic> (bottom), projected on the MARGARET inferred connectivity graph. (<bold>C</bold>) Gene expression trends for neutrophil-like monocyte marker genes: <italic toggle="yes">PRTN3</italic>, <italic toggle="yes">ELANE</italic>, <italic toggle="yes">CTSG</italic> are highly correlated with monocyte branch probability (dotted black line). (<bold>D</bold>) MARGARET inferred trajectory for the DC sub-lineage obtained from the combined analysis of replicates 1 and 2. MARGARET accurately recovers the cDC and pDC lineages. (<bold>E</bold>) Gene expression trends for pDC markers (top): <italic toggle="yes">IRF7</italic>, <italic toggle="yes">TCF4</italic> and cDC markers (bottom): <italic toggle="yes">CLEC12A</italic>, <italic toggle="yes">CLEC10A</italic>. (<bold>F</bold>) Heat map of DC-lineage specific marker genes for MARGARET inferred DC sub-lineage clusters. (<bold>G</bold>) Comparison of differentially Expressed genes between cDCs (cluster DC8) and pDCs (cluster DC0).</p>
        </caption>
        <graphic xlink:href="gkac412fig6" position="float"/>
      </fig>
      <p>In contrast, we observed elevated expressions of <italic toggle="yes">FLT3</italic> in cluster 4 (Figure <xref rid="F6" ref-type="fig">6A</xref> (right)) which also correlated with a decrease in DP on the transition from cluster 10 (<italic toggle="yes">FLT</italic>3<sup>+</sup> CMP) to cluster 4. Moreover, this cluster showed elevated expression of <italic toggle="yes">CSF1R</italic> (<italic toggle="yes">CD115</italic>), dendritic cell marker <italic toggle="yes">ITGAX</italic> (<italic toggle="yes">CD11c</italic>) (Figure <xref rid="F6" ref-type="fig">6B</xref>), and <italic toggle="yes">MPO</italic> (Figure <xref rid="F5" ref-type="fig">5D</xref>). Altogether, the <italic toggle="yes">FLT</italic>3<sup>+</sup><italic toggle="yes">CD</italic>115<sup><italic toggle="yes">hi</italic></sup> signature of this cluster suggests the presence of monocyte-dendritic cell progenitors (MDPs) in cluster 4 which gives rise to both monocytes and dendritic cells (<xref rid="B52" ref-type="bibr">52</xref>). Therefore, MARGARET inferred branching structure in the myeloid lineage characterized the differentiation of monocytes and dendritic cells from GMPs and MDPs respectively and these important events were also marked by a decrease in MARGARET inferred DP. These progenitor populations and their lineage branchings were not characterized in the original study (<xref rid="B9" ref-type="bibr">9</xref>) that used Palantir.</p>
    </sec>
    <sec id="SEC3-8">
      <title>MARGARET characterized the heterogeneity in DC lineage</title>
      <p>In the DC lineage for replicate 1, MARGARET inferred cluster 7 expressed markers for both cDCs (<italic toggle="yes">ITGAX, CLEC10A</italic>) and pDCs (<italic toggle="yes">IRF7, IRF8, IL3RA</italic>) (Figure <xref rid="F5" ref-type="fig">5D</xref>) while cluster 23 only expressed pDC markers. We made a similar observation in replicate 2 with clusters 1 and 20 equivalent to clusters 7 and 23 in replicate 1 , respectively. To characterize the heterogeneity in the DC lineage at a finer resolution, we combined the cells in the DC lineage from clusters 4, 7 and 23 in replicate 1 and clusters 5, 1 and 20 in replicate 2 and analyzed the resulting 1406 cells using MARGARET. Figure <xref rid="F6" ref-type="fig">6D</xref> shows the MARGARET inferred trajectory, consisting of 10 clusters (DC0-DC9). Since MDPs give rise to DC populations, based on the expression of MDP-specific markers <italic toggle="yes">CSF1R</italic>, and <italic toggle="yes">ITGAX</italic> (<xref rid="B52" ref-type="bibr">52</xref>) (Figure <xref rid="F6" ref-type="fig">6B</xref>) we inferred cluster DC7 as the starting cluster for our analysis. Based on manually curated set of markers specific to pDCs and cDCs through prior literature review (<xref rid="B53" ref-type="bibr">53–55</xref>), we then identified pDCs marked by high expression of <italic toggle="yes">E2-2</italic> (<italic toggle="yes">TCF4</italic>) TF, its target TFs <italic toggle="yes">IRF7</italic>, <italic toggle="yes">SPIB</italic>, and pDC-specific marker genes <italic toggle="yes">LILRA4</italic> (<italic toggle="yes">ILT7</italic>) (<xref rid="B56" ref-type="bibr">56</xref>) and <italic toggle="yes">PACSIN1</italic> (<xref rid="B57" ref-type="bibr">57</xref>), in cluster DC0 (Figure <xref rid="F6" ref-type="fig">6E</xref> (top), F) which was a terminal state. <italic toggle="yes">E2-2</italic> expression serves as a key event in pDC cell fate choice (<xref rid="B58" ref-type="bibr">58</xref>), <italic toggle="yes">IRF7</italic> is a key regulator of IFN expression and has been shown to be highly expressed in pDCs as compared to other cell types (<xref rid="B59" ref-type="bibr">59</xref>). Similarly, we localized the cDC lineage by observing high expression of <italic toggle="yes">ITGAX</italic> (<italic toggle="yes">CD11b</italic>), <italic toggle="yes">ID2</italic> and <italic toggle="yes">CD1c</italic> (<xref rid="B60" ref-type="bibr">60</xref>) in clusters DC3 and DC8 (Figure <xref rid="F6" ref-type="fig">6F</xref>). Furthermore, we observed high expression of cDC2-specfic TFs <italic toggle="yes">NR4A3, SREBF2</italic> and marker genes <italic toggle="yes">CLEC10A, CD1E, CLEC12A, CX3CR1</italic> (<xref rid="B54" ref-type="bibr">54</xref>) (Figure <xref rid="F6" ref-type="fig">6E</xref> (bottom), F) and negligible expression of cDC1 marker gene <italic toggle="yes">CLEC9A</italic> (<xref rid="B61" ref-type="bibr">61</xref>) in clusters DC3 and DC8 (data not shown) indicating the presence of cDC2 and absence of cDC1 cells in these clusters.</p>
    </sec>
    <sec id="SEC3-9">
      <title>MARGARET characterized erythroid-megakaryocytic lineage</title>
      <p>We also characterized the erythroid-megakaryocytic lineage branching in MARGARET inferred trajectory. Both erythroid and megakaryocytic commitment were associated with a sharp decrease in DP (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S19</xref>). In the erythroid lineage, this decrease in DP was concordant with the elevated expressions of TFs <italic toggle="yes">GATA1</italic>, <italic toggle="yes">KLF1</italic> and <italic toggle="yes">MYB</italic>, which are known to play crucial roles in erythropoiesis: <italic toggle="yes">GATA1</italic> is indispensable for erythropoiesis (<xref rid="B49" ref-type="bibr">49</xref>), <italic toggle="yes">KLF1</italic> modulates erythroid cell differentiation by regulating erythroid precursor genes and also antagonizes megakaryocyte differentiation (<xref rid="B42" ref-type="bibr">42</xref>,<xref rid="B62" ref-type="bibr">62</xref>), <italic toggle="yes">MYB</italic> enhances erythropoiesis by suppressing megakaryopoiesis (<xref rid="B63" ref-type="bibr">63</xref>). Expression of these TFs also highly correlated with the erythroid branch probabilities (&gt;0.9) indicating their crucial regulatory role in erythroid commitment (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S20A</xref>). In the megakaryocyte lineage, the drop in DP was concordant with increasing expression of transcription factors <italic toggle="yes">PBX1</italic>, <italic toggle="yes">FLI1</italic>, and <italic toggle="yes">MEIS1</italic> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S19</xref>), which were also closely correlated (&gt;0.9) with megakaryocytic branch probabilities (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S20B</xref>). These TFs are known to play central role in megakaryopoiesis: <italic toggle="yes">FLI1</italic> and <italic toggle="yes">PBX1</italic> are essential TFs for megakaryocyte differentiation (<xref rid="B42" ref-type="bibr">42</xref>,<xref rid="B64" ref-type="bibr">64</xref>), and <italic toggle="yes">MEIS1</italic> is essential for fetal megakaryopoiesis (<xref rid="B65" ref-type="bibr">65</xref>). The cluster 15 (in replicate 1) at which the erythroid and megakaryocytic lineages diverged, expressed both <italic toggle="yes">GATA2</italic> (driver of erythroid commitment (<xref rid="B66" ref-type="bibr">66</xref>)) and <italic toggle="yes">CD41</italic> (responsible for megakaryocytic lineage commitment (<xref rid="B42" ref-type="bibr">42</xref>)), as well as genes like <italic toggle="yes">SLC14A1</italic> and <italic toggle="yes">VWF</italic>, which are responsible for a continuous transition from megakaryocyte-erythroid progenitors (MEP) to erythroid and megakaryocyte progenitors respectively (<xref rid="B44" ref-type="bibr">44</xref>) suggesting the presence of MEPs in cluster 15.</p>
    </sec>
    <sec id="SEC3-10">
      <title>MARGARET applied to early human embryogenesis data</title>
      <p>To investigate MARGARET’s ability in extracting novel insights from a complex biological system, we applied MARGARET to an scRNA-seq dataset generated from embryoid bodies (EB) (<xref rid="B18" ref-type="bibr">18</xref>), which recapitulates the differentiation process in early embryogenesis where pluripotent embryonic stem cells (ESCs) give rise to early lineage precursors. Even though EB differentiation has been successfully utilized to drive a diverse set of differentiation protocols (<xref rid="B67" ref-type="bibr">67</xref>,<xref rid="B68" ref-type="bibr">68</xref>), the cellular and molecular states associated with the early lineage precursors as well as their differentiation trajectories from human ESCs remain fairly less explored. The dataset consisted of 16821 cells, sampled at 3-day intervals over a 27-day differentiation time course (<xref rid="B18" ref-type="bibr">18</xref>). Even though the sampling time information was not utilized to learn the cell-state manifold, MARGARET inferred embedding that consisted of 26 clusters (Figure <xref rid="F7" ref-type="fig">7A</xref>) retained the time trend accurately (Figure <xref rid="F7" ref-type="fig">7B</xref>), thus preserving the global topology associated with the data. Next, we identified the major lineages recovered by MARGARET by examining the expression of essential marker genes for major lineages previously reported in the literature for this dataset (<xref rid="B18" ref-type="bibr">18</xref>) (Figure <xref rid="F7" ref-type="fig">7D</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S21A,B</xref>). This preliminary analysis revealed the presence of endoderm (EN), mesoderm (ME), neural crest (NC), neuroectoderm (NE) and neuronal subtypes (NS) (including neural progenitors (NP)) lineages along with ESCs in the data. To further validate the inferred lineages, we grouped MARGARET clusters based on their lineage information to obtain five major clusters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S22A</xref>) for which we performed differential expression (DE) analysis (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S22B</xref>). Gene ontology (GO) analysis (Materials and Methods, Data Availability) of the DE genes for these combined clusters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S22C</xref>) revealed major functional differences between these clusters, with the enrichment of GO terms corresponding to these major lineages suggesting the validity of the inferred lineages (<xref rid="sup1" ref-type="supplementary-material">Supplementary File 1</xref>).</p>
      <fig position="float" id="F7">
        <label>Figure 7.</label>
        <caption>
          <p>MARGARET characterizes the differentiation trajectory in human embryoid bodies. MARGARET reconstructs a detailed lineage map and identifies novel cell types and differentiation intermediates in the embryoid body (EB) dataset. (<bold>A</bold>) UMAP plot of cell-state embedding inferred by MARGARET for EB dataset. (<bold>B</bold>) MARGARET inferred cell embedding preserves real time information. (<bold>C</bold>) MARGARET pseudotime projected on the cell embeddings. (<bold>D</bold>) Heat map of marker genes for all MARGARET inferred clusters. (<bold>E</bold>) MARGARET inferred trajectory annotated with cell-type and lineage information (characteristic marker genes are mentioned within parantheses with the cell-type annotation). ESC: Embryoid stem cells; PS: primitive streak; NE: neuroectoderm; NC: neural crest; NS: neuronal subtypes; EN: endoderm; H: hemangioblasts; ME: mesoderm; SMP: smooth muscle precursors; ECP: epicardial precursors; CP: cardiac precursors. (<bold>F</bold>) Gene expression trends for the inferred lineages. (<bold>G</bold>) Gene ontology (GO) analysis of MARGARET inferred clusters (grouped by major lineages). The heatmap value for a GO term was set to <inline-formula><tex-math id="M000107" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sqrt{-\log ({p_{val}})}$\end{document}</tex-math></inline-formula>, where <italic toggle="yes">p</italic><sub><italic toggle="yes">val</italic></sub> is the <italic toggle="yes">P</italic>-value for the corresponding GO term.</p>
        </caption>
        <graphic xlink:href="gkac412fig7" position="float"/>
      </fig>
      <p>Due to the presence of ESCs in cluster 6 as marked by the high expression of <italic toggle="yes">POU5F1</italic>, <italic toggle="yes">NANOG</italic> (essential for maintaining pluripotency in ESCs (<xref rid="B69" ref-type="bibr">69</xref>)), and <italic toggle="yes">DDPA2/4</italic> (Figure 7D, F), we selected a starting cell from cluster 6 for further trajectory analysis, including the inference of pseudotime and DP. MARGARET inferred pseudotime (Figure <xref rid="F7" ref-type="fig">7C</xref>) followed the progression of cell types, where the pseudotime increased as cells progressed towards more specialized cell types from <italic toggle="yes">POU5F1</italic> enriched ESCs.</p>
      <p>Furthermore, MARGARET recovered a detailed lineage specification map of embryoid bodies in a fully unsupervised manner (Figure <xref rid="F7" ref-type="fig">7E</xref>). We further characterized the MARGARET inferred clusters for specific cell types. In the ectoderm lineage: neuroectoderm, neural crest, and neuronal subtype clusters were detected as terminal states. In the mesoderm lineage, MARGARET identified hemangioblasts (H), cardiac precursors (CPs), and smooth muscle precursors (SMPs) as the terminal states. Lastly, a single cluster in the endoderm lineage was also identified as a terminal state. To characterize the recovered lineage map, we explored the expression trends of key marker genes for the terminal cell types (Figure <xref rid="F7" ref-type="fig">7F</xref>). The expression of ESC marker gene <italic toggle="yes">POU5F1</italic> decreased with pseudotime in all lineages. <italic toggle="yes">CD34</italic> was selectively upregulated in hemangioblasts, while <italic toggle="yes">TNNT2</italic>, and <italic toggle="yes">TBX18</italic> were upregulated in the CPs and SMPs, respectively. <italic toggle="yes">KLF5</italic> and <italic toggle="yes">SOX10</italic> were upregulated in the EN, and NC lineages respectively. <italic toggle="yes">LHX5</italic> was initially upregulated in the NS, NC and NE lineages but was subsequently downregulated in the NS and NC lineages suggesting its importance in NE lineage commitment. While we identified five NS clusters, <italic toggle="yes">ONECUT1</italic> was upregulated in NS-5, the terminal neuronal subtype cluster.</p>
      <p>The probability of cells branching towards a specific lineage as inferred by MARGARET increased towards later stages in cell differentiation (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S23</xref>). For this dataset also, DP decreased with an increase in pseudotime (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S24A</xref>) with the ESC cluster having the highest DP, followed by the transitional cell types and the terminal states having the lowest DP (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S24 and S25</xref>). Thus decrease in DP was concordant with the major lineage commitments in EB differentiation.</p>
      <p>In the ectodermal lineage, ESCs differentiate into preneuroectoderm cells (showing downregulation of <italic toggle="yes">POU5F1</italic> (Figure <xref rid="F7" ref-type="fig">7F</xref>)), which give rise to neuroectoderm cells (expressing <italic toggle="yes">LHX2/5, SIX3</italic> (Figure 5D,F)). Similar to (<xref rid="B18" ref-type="bibr">18</xref>), MARGARET was able to identify the bipotent precursors (cluster 9 expressing <italic toggle="yes">HOXA2, HOXB1</italic> and <italic toggle="yes">OLIG3</italic> (Figure <xref rid="F7" ref-type="fig">7D</xref>)) that originated from the neuroectoderm cells expressing <italic toggle="yes">GBX2</italic> and bifurcated from cluster 9 into the neural crest and neuronal sub-lineages (Figure <xref rid="F7" ref-type="fig">7E</xref>). Further characterization of this branching revealed correlation between a decrease in MARGARET inferred DP and the up/down regulation of important TFs in the neural crest and neuronal lineages (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S26</xref>). The DP drop in the neural crest lineage was concordant with the upregulation of canonical TFs <italic toggle="yes">SOX9/10</italic> (<xref rid="B70" ref-type="bibr">70</xref>,<xref rid="B71" ref-type="bibr">71</xref>) (Figure 7D,F, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S26A,B</xref> (right)) while neuronal-subtype cluster 3 exhibited upregulation of TFs <italic toggle="yes">SOX1</italic> and <italic toggle="yes">LHX2</italic> (Figure <xref rid="F7" ref-type="fig">7D</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S26A, B</xref> (left)), which have been shown to be important for subtype specification in certain types of neurons (<xref rid="B72" ref-type="bibr">72</xref>,<xref rid="B73" ref-type="bibr">73</xref>). GO analysis at finer resolution (Figure 7G, Data Availabililty) also revealed the enrichment of both neural crest and neuronal differentiation-related functions in cluster 9 further validating its bi-potency. We next validated the neural crest sub-branch detected by MARGARET using the bulk RNA-seq data provided by (<xref rid="B18" ref-type="bibr">18</xref>) for FACS purified <italic toggle="yes">CD</italic>49<italic toggle="yes">d</italic><sup>+</sup><italic toggle="yes">CD</italic>63<sup>−</sup> cells. The Spearman correlation analysis between scRNA-seq profiles of cells in the EB dataset with the bulk RNA-seq expressions corresponding to <italic toggle="yes">CD</italic>49<sup>+</sup> cells revealed the highest correlation in the neural crest lineage which also showed high <italic toggle="yes">ITGA4</italic> expression (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S27A</xref>), suggesting the accurate localization of the neural crest cells in MARGARET trajectory.</p>
      <p>In the mesoderm lineage, differentiation proceeds via the primitive streak progenitor cells (cluster 22 expressing <italic toggle="yes">EOMES</italic> and <italic toggle="yes">T</italic>), towards a number of sub-lineages within the mesoderm. MARGARET trajectory (Figure <xref rid="F7" ref-type="fig">7E</xref>) identified a series of intermediate precursors expressing (<italic toggle="yes">CER1, GATA1</italic>), (<italic toggle="yes">GATA6, HOXB4</italic>) and (<italic toggle="yes">GATA5/6, HAND1</italic>), respectively which finally gave rise to cardiac precursors (expressing <italic toggle="yes">TNNT2</italic>). Bulk-RNA analysis for FACS purified <italic toggle="yes">CD</italic>82<sup>+</sup><italic toggle="yes">CD</italic>142<sup>+</sup> cells revealed the highest correlation of the single-cell expression profiles in the mesoderm sub-lineage harboring cardiac precursors (cells with high <italic toggle="yes">CD82</italic> and <italic toggle="yes">CD142</italic> expressions) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S27B</xref>), suggesting that MARGARET accurately detects this sub-lineage. In the mesoderm lineage, we found three types of smooth muscle precursors (SMPs) which expressed different markers (<italic toggle="yes">SIX2</italic>, <italic toggle="yes">PRRX2</italic> and <italic toggle="yes">TBX15/18</italic>) suggesting that SMP differentiation in the mesoderm lineage proceeds via one or more differentiation intermediates from plate ME cells. Thus, MARGARET accurately resolved the underlying trajectory structure in the EB dataset by inferring branchings and intermediate cell populations essential for cell lineage commitment in early embryogenesis.</p>
    </sec>
    <sec id="SEC3-11">
      <title>Analysis of colon differentiation using MARGARET</title>
      <p>To investigate the epithelial differentiation in colon, we applied MARGARET to a scRNA-seq dataset (11175 cells) comprising three conditions - healthy (4249 cells), clinically inflamed ulcerative colitis (UC) (2848 cells), and non-inflamed UC (4078 cells) across three replicates (<xref rid="B19" ref-type="bibr">19</xref>). For the healthy colon, MARGARET identified 15 clusters (Figure <xref rid="F8" ref-type="fig">8A</xref>) and the inferred trajectory accurately delineated the absorptive and the secretory lineages (Figure <xref rid="F8" ref-type="fig">8F</xref>). Projection of crypt-axis (CA) scores (<xref rid="B19" ref-type="bibr">19</xref>) (see Materials and Methods) for each cell (obtained from the combined expression of 15 gene markers expressed in absorptive and secretory cells) on the 2D representation of the MARGARET-inferred cell embedding (Figure <xref rid="F8" ref-type="fig">8D</xref>) revealed the cells in the absorptive lineage to have higher CA scores as compared to stem cells or cells in the secretory lineage indicating the presence of these cells towards the crypt-top indicating that MARGARET correctly localized the cell-types within the trajectory. We then investigated the expression of key marker genes (curated from prior literature (<xref rid="B19" ref-type="bibr">19</xref>,<xref rid="B74" ref-type="bibr">74</xref>)) for different cell types in the absorptive and secretory lineages (Figure <xref rid="F8" ref-type="fig">8E</xref>). We identified absorptive progenitors, colonocytes, crypt-top (CT) colonocytes, and BEST4/OTOP2 cells in the absorptive lineage; and secretory progenitors, goblet cells, and enteroendocrine cells (EECs) in the secretory lineage. Based on high expression of stem cell markers genes <italic toggle="yes">MLEC</italic> and <italic toggle="yes">LGR5</italic> in cluster 0 (Figure <xref rid="F8" ref-type="fig">8E</xref>), we selected a cell from this cluster as the starting cell for the subsequent inference of pseudotime (Figure <xref rid="F8" ref-type="fig">8B</xref>) and DP (Figure <xref rid="F8" ref-type="fig">8C</xref>). Terminal state prediction using MARGARET further revealed four terminal states namely: EECs (cluster 14) and goblet cells (cluster 5) in the secretory cell lineage, and BEST4/OTOP2 cells (cluster 13) and CT colonocytes (cluster 3) in the absorptive cell lineage. MARGARET inferred branch probabilities (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S28</xref>) and gene expression trends (Figure 8H) in the detected lineages further validated the cell populations detected in the absorptive and the secretory cell lineages as the marker genes <italic toggle="yes">MUC2</italic>, <italic toggle="yes">SCGN</italic>, <italic toggle="yes">AQP8</italic> and <italic toggle="yes">BEST4</italic>, were selectively upregulated in the goblet (<xref rid="B75" ref-type="bibr">75</xref>), EECs (<xref rid="B76" ref-type="bibr">76</xref>), CT colonocytes (<xref rid="B77" ref-type="bibr">77</xref>) and BEST4/OTOP2 cell (<xref rid="B19" ref-type="bibr">19</xref>) lineages respectively.</p>
      <fig position="float" id="F8">
        <label>Figure 8.</label>
        <caption>
          <p>MARGARET delineates the differentiation trajectory for colonic epithelial cells for healthy humans. (<bold>A</bold>) UMAP plot of cell-state embedding inferred by MARGARET for healthy human colonic epithelium, cells are colored by clusters inferred by MARGARET. (<bold>B</bold>) MARGARET pseudotime and (<bold>C</bold>) differentiation potential for each cell projected on the cell embeddings. (<bold>D</bold>) Crypt-axis score (See Methods) projected on MARGARET cell embeddings. (<bold>E</bold>) Heat map showing marker genes for each MARGARET inferred cluster. Marker genes were curated from (<xref rid="B19" ref-type="bibr">19</xref>). (<bold>F</bold>) MARGARET inferred trajectory annotated with cell type and lineage information (important marker genes for each cell type are mentioned within parantheses with the cell type information). CT: Crypt-top; EEC: enteroendocrine cells (<bold>G</bold>) Gene Ontology (GO) analysis for major inferred cell types in the absorptive cell lineage. Top GO:BP terms were included for each cell type. The value for a GO term in the heat map was set to <inline-formula><tex-math id="M000108" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sqrt{-\log ({p_{val}})}$\end{document}</tex-math></inline-formula>, where <italic toggle="yes">p</italic><sub><italic toggle="yes">val</italic></sub> is the <italic toggle="yes">P</italic>-value for the corresponding GO term. (<bold>H</bold>) Gene expression trends for essential genes for major inferred lineages. <bold>(I)</bold> Mean expression of TFs <italic toggle="yes">CDX1</italic>, <italic toggle="yes">ESRRA</italic> and <italic toggle="yes">PPARG</italic>, projected on the MARGARET inferred connectivity graph.</p>
        </caption>
        <graphic xlink:href="gkac412fig8" position="float"/>
      </fig>
      <p>In the absorptive cell lineage, BEST4/OTOP2 cells were detected as a terminal state that branched from the absorptive progenitors (APs) before they gave rise to colonocytes. To characterize this novel branching point, we performed GO analysis of BEST4/OTOP2 cells, CT colonocytes, colonocytes, and APs, which revealed the role of BEST4/OTOP2 cells in maintaining metal-ion transport and homeostasis in the colonic epithelium (Figure 8G). The GO analysis of the BEST4/OTOP2 cell cluster did not include any overlapping GO terms with CT colonocytes and colonocytes, suggesting the functional variability between these cell types. However, BEST4/OTOP2 cells exhibited high CA scores (Figure <xref rid="F8" ref-type="fig">8D</xref>) and expressed several colonocyte-specific markers <italic toggle="yes">GUCA2A</italic>, <italic toggle="yes">CEACAM1</italic> and <italic toggle="yes">CEACAM7</italic>, which suggests that these cells are similar to mature colonocytes and lie towards the crypt top. Moreover, APs showed enrichment of GO terms corresponding to both BEST4 cells and colonocytes (Figure 8G). The branching of BEST4/OTOP2 cells was also marked by the downregulation of the TF <italic toggle="yes">ESRRA</italic> and the high expression of TFs <italic toggle="yes">CDX1</italic> and <italic toggle="yes">PPARG</italic> (Figure 8I). We observed a similar branching in the absorptive lineage under non-inflamed UC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S29</xref>) with similar GO enrichment for the BEST4/OTOP2 cells, CT colonocytes, and colonocytes. Therefore, our findings suggest that BEST4/OTOP2 cells are mature colonocytes with a different functional profile as compared to CT colonocytes and originate from APs as a different sub-lineage within the absorptive lineage.</p>
      <p>Given the crucial role of goblet cells in colonic barrier maintenance (<xref rid="B78" ref-type="bibr">78</xref>), we further characterized the transcriptional landscape of the goblet cell lineages under healthy and inflamed UC conditions using MARGARET (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S30</xref>). Under both conditions, MARGARET reconstructed a linear trajectory in the goblet cell lineage from immature goblet cells to mature goblet cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S30G, H</xref>) (maturity of cells inferred by pseudotime order (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S30C, F</xref>)). We observed relatively higher expression levels of <italic toggle="yes">WFDC2</italic> in immature goblet cells than in mature goblet cells under both healthy and inflamed conditions. In contrast, <italic toggle="yes">MUC2</italic> was more expressed in mature goblet cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S30I</xref>). Moreover, we found mature goblet cells to have higher CA scores than immature goblet cells, suggesting that the mature cells reside at the top of the colonic crypt (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S30B, E</xref>). The functional characterization (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S30J</xref>) of the goblet cell clusters revealed the enrichment of GO terms related to wound healing, immune, and stress response in the mature goblet cells under inflamed UC condition indicating their potential role in inflammatory responses to inflammatory bowel disease (IBD). The goblet cells in inflamed UC further showed spatial and crypt-wide transcriptional heterogeneity. The mature goblets in inflamed UC that reside in the crypt-top showed elevated expressions of <italic toggle="yes">SPINK1</italic> and <italic toggle="yes">SPINK4</italic> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S31A</xref>), genes that are normally expressed by immature goblets residing at the crypt bottom in healthy colon. Moreover, we also observed transcriptional dysregulation of interferon-regulated cytokines including <italic toggle="yes">CD164</italic>, <italic toggle="yes">CD55</italic> and <italic toggle="yes">IRF7</italic> (<xref rid="B79" ref-type="bibr">79</xref>) throughout the goblet cell lineage in inflamed UC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S31B</xref>).</p>
    </sec>
    <sec id="SEC3-12">
      <title>MARGARET can scale to large scRNA-seq datasets</title>
      <p>To assess MARGARET’s scalability to large scRNA-seq datasets, we measured the runtimes of different computational stages in MARGARET on scRNA-seq datasets of different sizes subsampled from a 1.3 million neuronal cells dataset of 10× Genomics (<xref rid="B20" ref-type="bibr">20</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S32A</xref>). For a large scRNA-seq dataset consisting of 500 000 cells, training MARGARET’s neural network-based encoder in the metric learning stage took around 4 min per epoch (on a server with one Nvidia Quadro RTX 5000 GPU). Moreover, due to extensive hardware support in modern computation libraries, MARGARET can also utilize multiple GPUs during the training stage, thus making it scalable for inferring cell-state manifold even for very large scRNA-seq datasets. For the same dataset, undirected graph construction in MARGARET took only ∼20 s making exploratory analysis and visualization of large datasets extremely fast. For pseudotime inference, MARGARET took around 2 h for the 500k cells dataset thus exhibiting scalability across all computational stages when run on a large scRNA-seq dataset. We also compared MARGARET’s runtime for trajectory inference (undirected graph construction and pseudotime inference) with that of other TI methods on two relatively large subsampled datasets consisting of 50k and 100k cells and found that MARGARET’s runtimes were comparable to that of other methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S32B</xref> (left)). Moreover, on two smaller datasets sampled from our real dataset benchmark, MARGARET outperformed all other methods in terms of runtime for trajectory inference (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S32B</xref> (right)).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>As single-cell datasets grow in size and complexity, MARGARET addresses the need for scalable and accurate detection of cell-state lineages, prediction of cell fates, and the inference of cell fate plasticity in complex topologies underlying dynamic cellular processes. The end-to-end computational framework of MARGARET alleviates the challenges faced by existing TI methods: inability of the classical dimensionality reduction methods to accurately recover the underlying topology, insufficient generalizability to connected and disconnected graph trajectories beyond tree-structured topologies, accurate detection of less-sampled cell fates, and inference of cell fate plasticity for complex trajectory types. Our analysis of a diverse simulated benchmark as well as real benchmark consisting of challenging topologies showed that MARGARET generalizes to complex trajectories and can accurately infer the underlying topology and pseudotime order of cells in the trajectory while outperforming state-of-the-art methods on the same. Specifically, the benchmarking with the real biological datasets showed MARGARET’s ability to recapitulate the cell pseudotime order for complex trajectories where other methods completely failed (e.g. placenta trophoblast differentiation). Moreover, using synthetic disconnected trajectories, we showed that MARGARET can accurately infer DP for each component in the disconnected trajectories whereas Palantir’s DP inference is mostly incorrect for such datasets. (Figure <xref rid="F4" ref-type="fig">4</xref>).</p>
    <p>Using multiple biological datasets, we also showed that MARGARET’s metric learning-based approach can <italic toggle="yes">refine</italic> the cellular latent space inferred by other dimensionality reduction methods. On a variety of important biological systems, we showed that MARGARET identified all the major lineages and the established cell fates and recovered the marker gene expression trends. In early human hematopoiesis, MARGARET identified progenitor populations associated with the branching points (MDP and GMP in the myeloid and MEP in the erythroid lineages respectively), which were not characterized in the original study that used Palantir. MARGARET also identified cDC2 as a terminal state in the dendritic cell lineage along with pDCs. For embryoid body differentiation, MARGARET reconstructed a detailed lineage map of all major and sub-lineages and further validated the presence of novel differentiation intermediates in the neuroectoderm and mesoderm lineages and identified novel smooth muscle precursor populations. For colonic epithelial differentiation, MARGARET helped identify a branch point for BEST4/OTOP2 cells in the absorptive lineage, while also uncovering the dysregulation of essential marker genes and cytokines in goblet cells under the inflamed UC condition. Our runtime experiment with a 1.3 million cells dataset (<xref rid="B20" ref-type="bibr">20</xref>) further demonstrated that MARGARET’s trajectory inference scales even to datasets with millions of cells.</p>
    <p>Similar to other pseudotime methods, MARGARET assumes unidirectional cell differentiation where immature stem cells differentiate into more mature cell types. This assumption is violated for trans-differentiation and de-differentiation, events that can lead to ancestral cell-states and scRNA-seq data alone might be insufficient in characterizing such events (<xref rid="B9" ref-type="bibr">9</xref>). Recent methods (<xref rid="B80" ref-type="bibr">80–82</xref>) utilized naturally occurring somatic mutations or synthetic mutations for lineage tracing. It would be an interesting direction to extend MARGARET by incorporating auxiliary signals like lineage information and real-time information for elucidating reprogramming. Lastly, while we focus on scRNA-seq datasets in this study, it is worth noting that our framework can easily be extended for other single-cell omics as well as multi-omics datasets. The modular structure of our method also allows for effortless integration with other dimension reduction, clustering and omics-integration methods. The implementation of MARGARET also allows the users to provide their own clustering as an input to MARGARET and thus supports the inclusion of domain knowledge in subsequent stages of trajectory inference. Given the explosion of single-cell datasets fuelled by collaborative efforts such as Human Cell Atlas (HCA) project (<xref rid="B83" ref-type="bibr">83</xref>) and Human Biomolecular Atlas Program (HubMAP) (<xref rid="B84" ref-type="bibr">84</xref>), we anticipate MARGARET to be a valuable tool for a scalable and multifaceted exploration of dynamic cellular processes from varied biological systems.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>All data needed to evaluate the conclusions in the paper are present in the paper and/or the Supplementary Materials. The human hematpoiesis dataset is available through the Human Cell Atlas portal at <ext-link xlink:href="https://prod.data.humancellatlas.org/explore/projects/29f53b7e-071b-44b5-998a-0ae70d0229a4" ext-link-type="uri">https://prod.data.humancellatlas.org/explore/projects/29f53b7e-071b-44b5-998a-0ae70d0229a4</ext-link>. The scRNA-seq and bulk RNA-seq datasets for the embryoid body dataset can be accessed via the Mendeley Data repository at <ext-link xlink:href="https://doi.org/10.17632/v6n743h5ng.1" ext-link-type="uri">https://doi.org/10.17632/v6n743h5ng.1</ext-link>. The scRNA-seq data for colon differentiation can be accessed using the GEO accession number GSE116222. All the real datasets used for demonstrating the clustering efficiency of MARGARET (PBMC-8k, PBMC-4k, Heart Cell Atlas and CORTEX) and runtime benchmarking (1.3M neuron dataset) can be accessed via the <italic toggle="yes">scvi-tools</italic> package (<xref rid="B22" ref-type="bibr">22</xref>). The Gene-Ontology terms used for the EB dataset can be accessed via Zenodo at <ext-link xlink:href="https://doi.org/10.5281/zenodo.5751235" ext-link-type="uri">https://doi.org/10.5281/zenodo.5751235</ext-link>. All simulated and real datasets (Placenta Trophoblast differentiation, Mouse cell atlas, Oligodendrocyte differentiation and Planaria parenchyme differentiation) used for comparing MARGARET to other TI methods can be accessed via Zenodo at <ext-link xlink:href="https://doi.org/10.5281/zenodo.5850114" ext-link-type="uri">https://doi.org/10.5281/zenodo.5850114</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>gkac412_Supplemental_File</label>
      <media xlink:href="gkac412_supplemental_file.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors thank the funding agencies for the research grants supporting this study.</p>
  </ack>
  <sec id="SEC6">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkac412#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC7">
    <title>FUNDING</title>
    <p>Science and Engineering Research Board (SERB), Government of India [SRG/2020/001333] to H.Z. Funding for open access charge: IIT Kanpur Research I Foundation grant 20030163.</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bendall</surname><given-names>S.C.</given-names></string-name>, <string-name><surname>Davis</surname><given-names>K.L.</given-names></string-name>, <string-name><surname>Amir</surname><given-names>E.-A.D.</given-names></string-name>, <string-name><surname>Tadmor</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Simonds</surname><given-names>E.F.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>T.J.</given-names></string-name>, <string-name><surname>Shenfeld</surname><given-names>D.K.</given-names></string-name>, <string-name><surname>Nolan</surname><given-names>G.P.</given-names></string-name>, <string-name><surname>Pe’er</surname><given-names>D.</given-names></string-name></person-group><article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</article-title>. <source>Cell</source>. <year>2014</year>; <volume>157</volume>:<fpage>714</fpage>–<lpage>725</lpage>.<pub-id pub-id-type="pmid">24766814</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tanay</surname><given-names>A.</given-names></string-name>, <string-name><surname>Regev</surname><given-names>A.</given-names></string-name></person-group><article-title>Scaling single-cell genomics from phenomenology to mechanism</article-title>. <source>Nature</source>. <year>2017</year>; <volume>541</volume>:<fpage>331</fpage>–<lpage>338</lpage>.<pub-id pub-id-type="pmid">28102262</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poulin</surname><given-names>J.-F.</given-names></string-name>, <string-name><surname>Tasic</surname><given-names>B.</given-names></string-name>, <string-name><surname>Hjerling-Leffler</surname><given-names>J.</given-names></string-name>, <string-name><surname>Trimarchi</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Awatramani</surname><given-names>R.</given-names></string-name></person-group><article-title>Disentangling neural cell diversity using single-cell transcriptomics</article-title>. <source>Nat. Neurosci.</source><year>2016</year>; <volume>19</volume>:<fpage>1131</fpage>.<pub-id pub-id-type="pmid">27571192</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Halpern</surname><given-names>K.B.</given-names></string-name>, <string-name><surname>Shenhav</surname><given-names>R.</given-names></string-name>, <string-name><surname>Matcovitch-Natan</surname><given-names>O.</given-names></string-name>, <string-name><surname>Tóth</surname><given-names>B.</given-names></string-name>, <string-name><surname>Lemze</surname><given-names>D.</given-names></string-name>, <string-name><surname>Golan</surname><given-names>M.</given-names></string-name>, <string-name><surname>Massasa</surname><given-names>E.E.</given-names></string-name>, <string-name><surname>Baydatch</surname><given-names>S.</given-names></string-name>, <string-name><surname>Landen</surname><given-names>S.</given-names></string-name>, <string-name><surname>Moor</surname><given-names>A.E.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Single-cell spatial reconstruction reveals global division of labour in the mammalian liver</article-title>. <source>Nature</source>. <year>2017</year>; <volume>542</volume>:<fpage>352</fpage>.<pub-id pub-id-type="pmid">28166538</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Etzrodt</surname><given-names>M.</given-names></string-name>, <string-name><surname>Endele</surname><given-names>M.</given-names></string-name>, <string-name><surname>Schroeder</surname><given-names>T.</given-names></string-name></person-group><article-title>Quantitative single-cell approaches to stem cell research</article-title>. <source>Cell Stem Cell</source>. <year>2014</year>; <volume>15</volume>:<fpage>546</fpage>–<lpage>558</lpage>.<pub-id pub-id-type="pmid">25517464</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wagner</surname><given-names>D.E.</given-names></string-name>, <string-name><surname>Weinreb</surname><given-names>C.</given-names></string-name>, <string-name><surname>Collins</surname><given-names>Z.M.</given-names></string-name>, <string-name><surname>Briggs</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Megason</surname><given-names>S.G.</given-names></string-name>, <string-name><surname>Klein</surname><given-names>A.M.</given-names></string-name></person-group><article-title>Single-cell mapping of gene expression landscapes and lineage in the zebrafish embryo</article-title>. <source>Science</source>. <year>2018</year>; <volume>360</volume>:<fpage>981</fpage>–<lpage>987</lpage>.<pub-id pub-id-type="pmid">29700229</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>J.</given-names></string-name>, <string-name><surname>Spielmann</surname><given-names>M.</given-names></string-name>, <string-name><surname>Qiu</surname><given-names>X.</given-names></string-name>, <string-name><surname>Huang</surname><given-names>X.</given-names></string-name>, <string-name><surname>Ibrahim</surname><given-names>D.M.</given-names></string-name>, <string-name><surname>Hill</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>F.</given-names></string-name>, <string-name><surname>Mundlos</surname><given-names>S.</given-names></string-name>, <string-name><surname>Christiansen</surname><given-names>L.</given-names></string-name>, <string-name><surname>Steemers</surname><given-names>F.J.</given-names></string-name><etal>et al</etal>.</person-group><article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title>. <source>Nature</source>. <year>2019</year>; <volume>566</volume>:<fpage>496</fpage>–<lpage>502</lpage>.<pub-id pub-id-type="pmid">30787437</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>F.A.</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P.</given-names></string-name>, <string-name><surname>Theis</surname><given-names>F.J.</given-names></string-name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol.</source><year>2018</year>; <volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Setty</surname><given-names>M.</given-names></string-name>, <string-name><surname>Kiseliovas</surname><given-names>V.</given-names></string-name>, <string-name><surname>Levine</surname><given-names>J.</given-names></string-name>, <string-name><surname>Gayoso</surname><given-names>A.</given-names></string-name>, <string-name><surname>Mazutis</surname><given-names>L.</given-names></string-name>, <string-name><surname>Pe’er</surname><given-names>D.</given-names></string-name></person-group><article-title>Characterization of cell fate probabilities in single-cell data with Palantir</article-title>. <source>Nat. Biotechnol.</source><year>2019</year>; <volume>37</volume>:<fpage>451</fpage>–<lpage>460</lpage>.<pub-id pub-id-type="pmid">30899105</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Street</surname><given-names>K.</given-names></string-name>, <string-name><surname>Risso</surname><given-names>D.</given-names></string-name>, <string-name><surname>Fletcher</surname><given-names>R.B.</given-names></string-name>, <string-name><surname>Das</surname><given-names>D.</given-names></string-name>, <string-name><surname>Ngai</surname><given-names>J.</given-names></string-name>, <string-name><surname>Yosef</surname><given-names>N.</given-names></string-name>, <string-name><surname>Purdom</surname><given-names>E.</given-names></string-name>, <string-name><surname>Dudoit</surname><given-names>S.</given-names></string-name></person-group><article-title>Slingshot: cell lineage and pseudotime inference for single-cell transcriptomics</article-title>. <source>BMC Genomics</source>. <year>2018</year>; <volume>19</volume>:<fpage>477</fpage>.<pub-id pub-id-type="pmid">29914354</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>H.</given-names></string-name>, <string-name><surname>Albergante</surname><given-names>L.</given-names></string-name>, <string-name><surname>Hsu</surname><given-names>J.Y.</given-names></string-name>, <string-name><surname>Lareau</surname><given-names>C.A.</given-names></string-name>, <string-name><surname>Bosco</surname><given-names>G.L.</given-names></string-name>, <string-name><surname>Guan</surname><given-names>J.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>S.</given-names></string-name>, <string-name><surname>Gorban</surname><given-names>A.N.</given-names></string-name>, <string-name><surname>Bauer</surname><given-names>D.E.</given-names></string-name>, <string-name><surname>Aryee</surname><given-names>M.J.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Single-cell trajectories reconstruction, exploration and mapping of omics data with STREAM</article-title>. <source>Nat. Commun.</source><year>2019</year>; <volume>10</volume>:<fpage>1903</fpage>.<pub-id pub-id-type="pmid">31015418</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L.</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J.</given-names></string-name>, <string-name><surname>Saul</surname><given-names>N.</given-names></string-name>, <string-name><surname>Großberger</surname><given-names>L.</given-names></string-name></person-group><article-title>UMAP: Uniform Manifold Approximation and Projection</article-title>. <source>Journal of Open Source Software</source>. <year>2018</year>; <volume>3</volume>:<fpage>861</fpage>.</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saelens</surname><given-names>W.</given-names></string-name>, <string-name><surname>Cannoodt</surname><given-names>R.</given-names></string-name>, <string-name><surname>Todorov</surname><given-names>H.</given-names></string-name>, <string-name><surname>Saeys</surname><given-names>Y.</given-names></string-name></person-group><article-title>A comparison of single-cell trajectory inference methods</article-title>. <source>Nat. Biotechnol.</source><year>2019</year>; <volume>37</volume>:<fpage>547</fpage>–<lpage>554</lpage>.<pub-id pub-id-type="pmid">30936559</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stassen</surname><given-names>S.V.</given-names></string-name>, <string-name><surname>Yip</surname><given-names>G. G.K.</given-names></string-name>, <string-name><surname>Wong</surname><given-names>K. K.Y.</given-names></string-name>, <string-name><surname>Ho</surname><given-names>J. W.K.</given-names></string-name>, <string-name><surname>Tsia</surname><given-names>K.K.</given-names></string-name></person-group><article-title>Generalized and scalable trajectory inference in single-cell omics data with VIA</article-title>. <source>Nat. Commun.</source><year>2021</year>; <volume>12</volume>:<fpage>5528</fpage>.<pub-id pub-id-type="pmid">34545085</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>X.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>R.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Fei</surname><given-names>L.</given-names></string-name>, <string-name><surname>Sun</surname><given-names>H.</given-names></string-name>, <string-name><surname>Lai</surname><given-names>S.</given-names></string-name>, <string-name><surname>Saadatpour</surname><given-names>A.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H.</given-names></string-name>, <string-name><surname>Ye</surname><given-names>F.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Mapping the Mouse Cell Atlas by Microwell-Seq</article-title>. <source>Cell</source>. <year>2018</year>; <volume>172</volume>:<fpage>1091</fpage>–<lpage>1107</lpage>.<pub-id pub-id-type="pmid">29474909</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marques</surname><given-names>S.</given-names></string-name>, <string-name><surname>Zeisel</surname><given-names>A.</given-names></string-name>, <string-name><surname>Codeluppi</surname><given-names>S.</given-names></string-name>, <string-name><surname>van Bruggen</surname><given-names>D.</given-names></string-name>, <string-name><surname>Falcão</surname><given-names>A.M.</given-names></string-name>, <string-name><surname>Xiao</surname><given-names>L.</given-names></string-name>, <string-name><surname>Li</surname><given-names>H.</given-names></string-name>, <string-name><surname>Häring</surname><given-names>M.</given-names></string-name>, <string-name><surname>Hochgerner</surname><given-names>H.</given-names></string-name>, <string-name><surname>Romanov</surname><given-names>R.A.</given-names></string-name>, <string-name><surname>et</surname><given-names>al.</given-names></string-name></person-group><article-title>Oligodendrocyte heterogeneity in the mouse juvenile and adult central nervous system</article-title>. <source>Science</source>. <year>2016</year>; <volume>352</volume>:<fpage>1326</fpage>–<lpage>1329</lpage>.<pub-id pub-id-type="pmid">27284195</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Plass</surname><given-names>M.</given-names></string-name>, <string-name><surname>Solana</surname><given-names>J.</given-names></string-name>, <string-name><surname>Wolf</surname><given-names>F.A.</given-names></string-name>, <string-name><surname>Ayoub</surname><given-names>S.</given-names></string-name>, <string-name><surname>Misios</surname><given-names>A.</given-names></string-name>, <string-name><surname>Glažar</surname><given-names>P.</given-names></string-name>, <string-name><surname>Obermayer</surname><given-names>B.</given-names></string-name>, <string-name><surname>Theis</surname><given-names>F.J.</given-names></string-name>, <string-name><surname>Kocks</surname><given-names>C.</given-names></string-name>, <string-name><surname>Rajewsky</surname><given-names>N.</given-names></string-name></person-group><article-title>Cell type atlas and lineage tree of a whole complex animal by single-cell transcriptomics</article-title>. <source>Science</source>. <year>2018</year>; <volume>360</volume>:<fpage>6391</fpage>.</mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moon</surname><given-names>K.R.</given-names></string-name>, <string-name><surname>van Dijk</surname><given-names>D.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Gigante</surname><given-names>S.</given-names></string-name>, <string-name><surname>Burkhardt</surname><given-names>D.B.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>W.S.</given-names></string-name>, <string-name><surname>Yim</surname><given-names>K.</given-names></string-name>, <string-name><surname>Elzen</surname><given-names>A.v.d.</given-names></string-name>, <string-name><surname>Hirn</surname><given-names>M.J.</given-names></string-name>, <string-name><surname>Coifman</surname><given-names>R.R.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Visualizing structure and transitions in high-dimensional biological data</article-title>. <source>Nat. Biotechnol.</source><year>2019</year>; <volume>37</volume>:<fpage>1482</fpage>–<lpage>1492</lpage>.<pub-id pub-id-type="pmid">31796933</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parikh</surname><given-names>K.</given-names></string-name>, <string-name><surname>Antanaviciute</surname><given-names>A.</given-names></string-name>, <string-name><surname>Fawkner-Corbett</surname><given-names>D.</given-names></string-name>, <string-name><surname>Jagielowicz</surname><given-names>M.</given-names></string-name>, <string-name><surname>Aulicino</surname><given-names>A.</given-names></string-name>, <string-name><surname>Lagerholm</surname><given-names>C.</given-names></string-name>, <string-name><surname>Davis</surname><given-names>S.</given-names></string-name>, <string-name><surname>Kinchen</surname><given-names>J.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H.H.</given-names></string-name>, <string-name><surname>Alham</surname><given-names>N.K.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Colonic epithelial cell diversity in health and inflammatory bowel disease</article-title>. <source>Nature</source>. <year>2019</year>; <volume>567</volume>:<fpage>49</fpage>–<lpage>55</lpage>.<pub-id pub-id-type="pmid">30814735</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>G. X.Y.</given-names></string-name>, <string-name><surname>Terry</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Belgrader</surname><given-names>P.</given-names></string-name>, <string-name><surname>Ryvkin</surname><given-names>P.</given-names></string-name>, <string-name><surname>Bent</surname><given-names>Z.W.</given-names></string-name>, <string-name><surname>Wilson</surname><given-names>R.</given-names></string-name>, <string-name><surname>Ziraldo</surname><given-names>S.B.</given-names></string-name>, <string-name><surname>Wheeler</surname><given-names>T.D.</given-names></string-name>, <string-name><surname>McDermott</surname><given-names>G.P.</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>J.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun.</source><year>2017</year>; <volume>8</volume>:<fpage>14049</fpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Dijk</surname><given-names>D.</given-names></string-name>, <string-name><surname>Sharma</surname><given-names>R.</given-names></string-name>, <string-name><surname>Nainys</surname><given-names>J.</given-names></string-name>, <string-name><surname>Yim</surname><given-names>K.</given-names></string-name>, <string-name><surname>Kathail</surname><given-names>P.</given-names></string-name>, <string-name><surname>Carr</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Burdziak</surname><given-names>C.</given-names></string-name>, <string-name><surname>Moon</surname><given-names>K.R.</given-names></string-name>, <string-name><surname>Chaffer</surname><given-names>C.L.</given-names></string-name>, <string-name><surname>Pattabiraman</surname><given-names>D.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Recovering gene interactions from single-cell data using data diffusion</article-title>. <source>Cell</source>. <year>2018</year>; <volume>174</volume>:<fpage>716</fpage>–<lpage>729</lpage>.<pub-id pub-id-type="pmid">29961576</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gayoso</surname><given-names>A.</given-names></string-name>, <string-name><surname>Lopez</surname><given-names>R.</given-names></string-name>, <string-name><surname>Xing</surname><given-names>G.</given-names></string-name>, <string-name><surname>Boyeau</surname><given-names>P.</given-names></string-name>, <string-name><surname>Amiri</surname><given-names>V.V.P.</given-names></string-name>, <string-name><surname>Hong</surname><given-names>J.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>K.</given-names></string-name>, <string-name><surname>Jayasuriya</surname><given-names>M.</given-names></string-name>, <string-name><surname>Mehlman</surname><given-names>E.</given-names></string-name>, <string-name><surname>Langevin</surname><given-names>M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A Python library for probabilistic analysis of single-cell omics data</article-title>. <source>Nat. Biotechnol.</source><year>2022</year>; <volume>40</volume>:<fpage>163</fpage>–<lpage>166</lpage>.<pub-id pub-id-type="pmid">35132262</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Traag</surname><given-names>V.A.</given-names></string-name>, <string-name><surname>Waltman</surname><given-names>L.</given-names></string-name>, <string-name><surname>van Eck</surname><given-names>N.J.</given-names></string-name></person-group><article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>. <source>Scientific Rep.</source><year>2019</year>; <volume>9</volume>:<fpage>5233</fpage>.</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satija</surname><given-names>R.</given-names></string-name>, <string-name><surname>Farrell</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Gennert</surname><given-names>D.</given-names></string-name>, <string-name><surname>Schier</surname><given-names>A.F.</given-names></string-name>, <string-name><surname>Regev</surname><given-names>A.</given-names></string-name></person-group><article-title>Spatial reconstruction of single-cell gene expression data</article-title>. <source>Nat. Biotechnol.</source><year>2015</year>; <volume>33</volume>:<fpage>495</fpage>–<lpage>502</lpage>.<pub-id pub-id-type="pmid">25867923</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Balntas</surname><given-names>V.</given-names></string-name>, <string-name><surname>Riba</surname><given-names>E.</given-names></string-name>, <string-name><surname>Ponsa</surname><given-names>D.</given-names></string-name>, <string-name><surname>Mikolajczyk</surname><given-names>K.</given-names></string-name></person-group><article-title>Learning local feature descriptors with triplets and shallow convolutional neural networks</article-title>. <source>Procedings of the British Machine Vision Conference 2016</source>. <year>2016</year>; <publisher-name>British Machine Vision Association</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ioffe</surname><given-names>S.</given-names></string-name>, <string-name><surname>Szegedy</surname><given-names>C.</given-names></string-name></person-group><person-group person-group-type="editor"><string-name><surname>Bach</surname><given-names>F.</given-names></string-name>, <string-name><surname>Blei</surname><given-names>D.</given-names></string-name></person-group><article-title>Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift</article-title>. <source>Proceedings of the 32nd International Conference on Machine Learning</source>. <year>2015</year>; <publisher-loc>Lille, France</publisher-loc><publisher-name>PMLR Vol.37 of Proceedings of Machine Learning Research</publisher-name><fpage>448</fpage>–<lpage>456</lpage>.</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Srivastava</surname><given-names>N.</given-names></string-name>, <string-name><surname>Hinton</surname><given-names>G.</given-names></string-name>, <string-name><surname>Krizhevsky</surname><given-names>A.</given-names></string-name>, <string-name><surname>Sutskever</surname><given-names>I.</given-names></string-name>, <string-name><surname>Salakhutdinov</surname><given-names>R.</given-names></string-name></person-group><article-title>Dropout: a simple way to prevent neural networks from overfitting</article-title>. <source>J. Mach. Learn. Res.</source><year>2014</year>; <volume>15</volume>:<fpage>1929</fpage>–<lpage>1958</lpage>.</mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>F.A.</given-names></string-name>, <string-name><surname>Hamey</surname><given-names>F.K.</given-names></string-name>, <string-name><surname>Plass</surname><given-names>M.</given-names></string-name>, <string-name><surname>Solana</surname><given-names>J.</given-names></string-name>, <string-name><surname>Dahlin</surname><given-names>J.S.</given-names></string-name>, <string-name><surname>Göttgens</surname><given-names>B.</given-names></string-name>, <string-name><surname>Rajewsky</surname><given-names>N.</given-names></string-name>, <string-name><surname>Simon</surname><given-names>L.</given-names></string-name>, <string-name><surname>Theis</surname><given-names>F.J.</given-names></string-name></person-group><article-title>PAGA: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>. <source>Genome Biol.</source><year>2019</year>; <volume>20</volume>:<fpage>59</fpage>.<pub-id pub-id-type="pmid">30890159</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tenenbaum</surname><given-names>J.B.</given-names></string-name>, <string-name><surname>Silva</surname><given-names>V.d.</given-names></string-name>, <string-name><surname>Langford</surname><given-names>J.C.</given-names></string-name></person-group><article-title>A global geometric framework for nonlinear dimensionality reduction</article-title>. <source>Science</source>. <year>2000</year>; <volume>290</volume>:<fpage>2319</fpage>–<lpage>2323</lpage>.<pub-id pub-id-type="pmid">11125149</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brandes</surname><given-names>U.</given-names></string-name></person-group><article-title>A faster algorithm for betweenness centrality</article-title>. <source>J. Math. Soc.</source><year>2001</year>; <volume>25</volume>:<fpage>163</fpage>–<lpage>177</lpage>.</mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Setty</surname><given-names>M.</given-names></string-name>, <string-name><surname>Tadmor</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Reich-Zeliger</surname><given-names>S.</given-names></string-name>, <string-name><surname>Angel</surname><given-names>O.</given-names></string-name>, <string-name><surname>Salame</surname><given-names>T.M.</given-names></string-name>, <string-name><surname>Kathail</surname><given-names>P.</given-names></string-name>, <string-name><surname>Choi</surname><given-names>K.</given-names></string-name>, <string-name><surname>Bendall</surname><given-names>S.</given-names></string-name>, <string-name><surname>Friedman</surname><given-names>N.</given-names></string-name>, <string-name><surname>Pe’er</surname><given-names>D.</given-names></string-name></person-group><article-title>Wishbone identifies bifurcating developmental trajectories from single-cell data</article-title>. <source>Nat. Biotechnol.</source><year>2016</year>; <volume>34</volume>:<fpage>637</fpage>–<lpage>645</lpage>.<pub-id pub-id-type="pmid">27136076</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bendall</surname><given-names>S.C.</given-names></string-name>, <string-name><surname>Davis</surname><given-names>K.L.</given-names></string-name>, <string-name><surname>ad David Amir</surname><given-names>E.</given-names></string-name>, <string-name><surname>Tadmor</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Simonds</surname><given-names>E.F.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>T.J.</given-names></string-name>, <string-name><surname>Shenfeld</surname><given-names>D.K.</given-names></string-name>, <string-name><surname>Nolan</surname><given-names>G.P.</given-names></string-name>, <string-name><surname>Pe’er</surname><given-names>D.</given-names></string-name></person-group><article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</article-title>. <source>Cell</source>. <year>2014</year>; <volume>157</volume>:<fpage>714</fpage>–<lpage>725</lpage>.<pub-id pub-id-type="pmid">24766814</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Silva</surname><given-names>V.</given-names></string-name>, <string-name><surname>Tenenbaum</surname><given-names>J.</given-names></string-name></person-group><article-title>Sparse multidimensional scaling using landmark points</article-title>. <year>2004</year>; <publisher-name>Stanford University</publisher-name><comment>Technical report</comment>.</mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>W.</given-names></string-name>, <string-name><surname>Lü</surname><given-names>L.</given-names></string-name></person-group><article-title>Link prediction based on local random walk</article-title>. <source>EPL (Europhys. Lett.)</source>. <year>2010</year>; <volume>89</volume>:<fpage>58007</fpage>.</mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Raudvere</surname><given-names>U.</given-names></string-name>, <string-name><surname>Kolberg</surname><given-names>L.</given-names></string-name>, <string-name><surname>Kuzmin</surname><given-names>I.</given-names></string-name>, <string-name><surname>Arak</surname><given-names>T.</given-names></string-name>, <string-name><surname>Adler</surname><given-names>P.</given-names></string-name>, <string-name><surname>Peterson</surname><given-names>H.</given-names></string-name>, <string-name><surname>Vilo</surname><given-names>J.</given-names></string-name></person-group><article-title>g:Profiler: a web server for functional enrichment analysis and conversions of gene lists (2019 update)</article-title>. <source>Nucleic Acids Res.</source><year>2019</year>; <volume>47</volume>:<fpage>W191</fpage>–<lpage>W198</lpage>.<pub-id pub-id-type="pmid">31066453</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ipsen</surname><given-names>M.</given-names></string-name>, <string-name><surname>Mikhailov</surname><given-names>A.S.</given-names></string-name></person-group><article-title>Evolutionary reconstruction of networks</article-title>. <source>Phys. Rev. E</source>. <year>2002</year>; <volume>66</volume>:<fpage>046109</fpage>.</mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van der Maaten</surname><given-names>L.</given-names></string-name>, <string-name><surname>Hinton</surname><given-names>G.</given-names></string-name></person-group><article-title>Visualizing Data using t-SNE</article-title>. <source>J. Mach. Learn. Res.</source><year>2008</year>; <volume>9</volume>:<fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stassen</surname><given-names>S.V.</given-names></string-name>, <string-name><surname>Siu</surname><given-names>D.M.D.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>K.C.M.</given-names></string-name>, <string-name><surname>Ho</surname><given-names>J.W.K.</given-names></string-name>, <string-name><surname>So</surname><given-names>H.K.H.</given-names></string-name>, <string-name><surname>Tsia</surname><given-names>K.K.</given-names></string-name></person-group><article-title>PARC: ultrafast and accurate clustering of phenotypic data of millions of single cells</article-title>. <source>Bioinformatics</source>. <year>2020</year>; <volume>36</volume>:<fpage>2778</fpage>–<lpage>2786</lpage>.<pub-id pub-id-type="pmid">31971583</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levine</surname><given-names>J.H.</given-names></string-name>, <string-name><surname>Simonds</surname><given-names>E.F.</given-names></string-name>, <string-name><surname>Bendall</surname><given-names>S.C.</given-names></string-name>, <string-name><surname>Davis</surname><given-names>K.L.</given-names></string-name>, <string-name><surname>Amir</surname><given-names>E.D.</given-names></string-name>, <string-name><surname>Tadmor</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Litvin</surname><given-names>O.</given-names></string-name>, <string-name><surname>Fienberg</surname><given-names>H.G.</given-names></string-name>, <string-name><surname>Jager</surname><given-names>A.</given-names></string-name>, <string-name><surname>Zunder</surname><given-names>E.R.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Data-driven phenotypic dissection of AML reveals progenitor-like cells that correlate with prognosis</article-title>. <source>Cell</source>. <year>2015</year>; <volume>162</volume>:<fpage>184</fpage>–<lpage>197</lpage>.<pub-id pub-id-type="pmid">26095251</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez</surname><given-names>R.</given-names></string-name>, <string-name><surname>Regier</surname><given-names>J.</given-names></string-name>, <string-name><surname>Cole</surname><given-names>M.B.</given-names></string-name>, <string-name><surname>Jordan</surname><given-names>M.I.</given-names></string-name>, <string-name><surname>Yosef</surname><given-names>N.</given-names></string-name></person-group><article-title>Deep generative modeling for single-cell transcriptomics</article-title>. <source>Nat. Methods</source>. <year>2018</year>; <volume>15</volume>:<fpage>1053</fpage>–<lpage>1058</lpage>.<pub-id pub-id-type="pmid">30504886</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Orkin</surname><given-names>S.H.</given-names></string-name>, <string-name><surname>Zon</surname><given-names>L.I.</given-names></string-name></person-group><article-title>Hematopoiesis: an evolving paradigm for stem cell biology</article-title>. <source>Cell</source>. <year>2008</year>; <volume>132</volume>:<fpage>631</fpage>–<lpage>644</lpage>.<pub-id pub-id-type="pmid">18295580</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paul</surname><given-names>F.</given-names></string-name>, <string-name><surname>Arkin</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Giladi</surname><given-names>A.</given-names></string-name>, <string-name><surname>Jaitin</surname><given-names>D.A.</given-names></string-name>, <string-name><surname>Kenigsberg</surname><given-names>E.</given-names></string-name>, <string-name><surname>Keren-Shaul</surname><given-names>H.</given-names></string-name>, <string-name><surname>Winter</surname><given-names>D.</given-names></string-name>, <string-name><surname>Lara-Astiaso</surname><given-names>D.</given-names></string-name>, <string-name><surname>Gury</surname><given-names>M.</given-names></string-name>, <string-name><surname>Weiner</surname><given-names>A.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Transcriptional heterogeneity and lineage commitment in myeloid progenitors</article-title>. <source>Cell</source>. <year>2015</year>; <volume>163</volume>:<fpage>1663</fpage>–<lpage>1677</lpage>.<pub-id pub-id-type="pmid">26627738</pub-id></mixed-citation>
    </ref>
    <ref id="B43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pellin</surname><given-names>D.</given-names></string-name>, <string-name><surname>Loperfido</surname><given-names>M.</given-names></string-name>, <string-name><surname>Baricordi</surname><given-names>C.</given-names></string-name>, <string-name><surname>Wolock</surname><given-names>S.L.</given-names></string-name>, <string-name><surname>Montepeloso</surname><given-names>A.</given-names></string-name>, <string-name><surname>Weinberg</surname><given-names>O.K.</given-names></string-name>, <string-name><surname>Biffi</surname><given-names>A.</given-names></string-name>, <string-name><surname>Klein</surname><given-names>A.M.</given-names></string-name>, <string-name><surname>Biasco</surname><given-names>L.</given-names></string-name></person-group><article-title>A comprehensive single cell transcriptional landscape of human hematopoietic progenitors</article-title>. <source>Nat. Commun.</source><year>2019</year>; <volume>10</volume>:<fpage>2395</fpage>.<pub-id pub-id-type="pmid">31160568</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>Y.-C.</given-names></string-name>, <string-name><surname>Sanada</surname><given-names>C.</given-names></string-name>, <string-name><surname>Xavier-Ferrucio</surname><given-names>J.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>P.-X.</given-names></string-name>, <string-name><surname>Grimes</surname><given-names>H.L.</given-names></string-name>, <string-name><surname>Venkatasubramanian</surname><given-names>M.</given-names></string-name>, <string-name><surname>Chetal</surname><given-names>K.</given-names></string-name>, <string-name><surname>Aronow</surname><given-names>B.</given-names></string-name>, <string-name><surname>Salomonis</surname><given-names>N.</given-names></string-name><etal>et al</etal>.</person-group><article-title>The molecular signature of megakaryocyte-erythroid progenitors reveals a role for the cell cycle in fate specification</article-title>. <source>Cell Rep.</source><year>2018</year>; <volume>25</volume>:<fpage>2083</fpage>–<lpage>2093</lpage>.<pub-id pub-id-type="pmid">30463007</pub-id></mixed-citation>
    </ref>
    <ref id="B45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benschop</surname><given-names>R.J.</given-names></string-name>, <string-name><surname>Cambier</surname><given-names>J.C.</given-names></string-name></person-group><article-title>B cell development: signal transduction by antigen receptors and their surrogates</article-title>. <source>Curr. Opin. Immunol.</source><year>1999</year>; <volume>11</volume>:<fpage>143</fpage>–<lpage>151</lpage>.<pub-id pub-id-type="pmid">10322153</pub-id></mixed-citation>
    </ref>
    <ref id="B46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>L.</given-names></string-name>, <string-name><surname>Yu</surname><given-names>C.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>X.-F.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>H.</given-names></string-name></person-group><article-title>Monocyte and macrophage differentiation: circulation inflammatory monocyte as biomarker for inflammatory diseases</article-title>. <source>Biomarker Res.</source><year>2014</year>; <volume>2</volume>:<fpage>1</fpage>.</mixed-citation>
    </ref>
    <ref id="B47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>J.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Y.J.</given-names></string-name>, <string-name><surname>Ma</surname><given-names>W.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>W.</given-names></string-name>, <string-name><surname>Aljoufi</surname><given-names>A.</given-names></string-name>, <string-name><surname>Luh</surname><given-names>T.</given-names></string-name>, <string-name><surname>Lucero</surname><given-names>K.</given-names></string-name>, <string-name><surname>Liang</surname><given-names>D.</given-names></string-name>, <string-name><surname>Thomsen</surname><given-names>M.</given-names></string-name>, <string-name><surname>Bhagat</surname><given-names>G.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Lineage specification of human dendritic cells is marked by IRF8 expression in hematopoietic stem cells and multipotent progenitors</article-title>. <source>Nat. Immunol.</source><year>2017</year>; <volume>18</volume>:<fpage>877</fpage>–<lpage>888</lpage>.<pub-id pub-id-type="pmid">28650480</pub-id></mixed-citation>
    </ref>
    <ref id="B48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Psaila</surname><given-names>B.</given-names></string-name>, <string-name><surname>Barkas</surname><given-names>N.</given-names></string-name>, <string-name><surname>Iskander</surname><given-names>D.</given-names></string-name>, <string-name><surname>Roy</surname><given-names>A.</given-names></string-name>, <string-name><surname>Anderson</surname><given-names>S.</given-names></string-name>, <string-name><surname>Ashley</surname><given-names>N.</given-names></string-name>, <string-name><surname>Caputo</surname><given-names>V.S.</given-names></string-name>, <string-name><surname>Lichtenberg</surname><given-names>J.</given-names></string-name>, <string-name><surname>Loaiza</surname><given-names>S.</given-names></string-name>, <string-name><surname>Bodine</surname><given-names>D.M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Single-cell profiling of human megakaryocyte-erythroid progenitors identifies distinct megakaryocyte and erythroid differentiation pathways</article-title>. <source>Genome Biol.</source><year>2016</year>; <volume>17</volume>:<fpage>83</fpage>.<pub-id pub-id-type="pmid">27142433</pub-id></mixed-citation>
    </ref>
    <ref id="B49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ferreira</surname><given-names>R.</given-names></string-name>, <string-name><surname>Ohneda</surname><given-names>K.</given-names></string-name>, <string-name><surname>Yamamoto</surname><given-names>M.</given-names></string-name>, <string-name><surname>Philipsen</surname><given-names>S.</given-names></string-name></person-group><article-title>GATA1 Function, a Paradigm for Transcription Factors in Hematopoiesis</article-title>. <source>Mol. Cell. Biol.</source><year>2005</year>; <volume>25</volume>:<fpage>1215</fpage>–<lpage>1227</lpage>.<pub-id pub-id-type="pmid">15684376</pub-id></mixed-citation>
    </ref>
    <ref id="B50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Porse</surname><given-names>B.T.</given-names></string-name>, <string-name><surname>Pedersen</surname><given-names>T.Å.</given-names></string-name>, <string-name><surname>Xu</surname><given-names>X.</given-names></string-name>, <string-name><surname>Lindberg</surname><given-names>B.</given-names></string-name>, <string-name><surname>Wewer</surname><given-names>U.M.</given-names></string-name>, <string-name><surname>Friis-Hansen</surname><given-names>L.</given-names></string-name>, <string-name><surname>Nerlov</surname><given-names>C.</given-names></string-name></person-group><article-title>E2F repression by C/EBPα is required for adipogenesis and granulopoiesis in vivo</article-title>. <source>Cell</source>. <year>2001</year>; <volume>107</volume>:<fpage>247</fpage>–<lpage>258</lpage>.<pub-id pub-id-type="pmid">11672531</pub-id></mixed-citation>
    </ref>
    <ref id="B51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Akashi</surname><given-names>K.</given-names></string-name>, <string-name><surname>Traver</surname><given-names>D.</given-names></string-name>, <string-name><surname>Miyamoto</surname><given-names>T.</given-names></string-name>, <string-name><surname>Weissman</surname><given-names>I.L.</given-names></string-name></person-group><article-title>A clonogenic common myeloid progenitor that gives rise to all myeloid lineages</article-title>. <source>Nature</source>. <year>2000</year>; <volume>404</volume>:<fpage>193</fpage>–<lpage>197</lpage>.<pub-id pub-id-type="pmid">10724173</pub-id></mixed-citation>
    </ref>
    <ref id="B52">
      <label>52.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yáñez</surname><given-names>A.</given-names></string-name>, <string-name><surname>Coetzee</surname><given-names>S.G.</given-names></string-name>, <string-name><surname>Olsson</surname><given-names>A.</given-names></string-name>, <string-name><surname>Muench</surname><given-names>D.E.</given-names></string-name>, <string-name><surname>Berman</surname><given-names>B.P.</given-names></string-name>, <string-name><surname>Hazelett</surname><given-names>D.J.</given-names></string-name>, <string-name><surname>Salomonis</surname><given-names>N.</given-names></string-name>, <string-name><surname>Grimes</surname><given-names>H.L.</given-names></string-name>, <string-name><surname>Goodridge</surname><given-names>H.S.</given-names></string-name></person-group><article-title>Granulocyte-monocyte progenitors and monocyte-dendritic cell progenitors independently produce functionally distinct monocytes</article-title>. <source>Immunity</source>. <year>2017</year>; <volume>47</volume>:<fpage>890</fpage>–<lpage>902</lpage>.<pub-id pub-id-type="pmid">29166589</pub-id></mixed-citation>
    </ref>
    <ref id="B53">
      <label>53.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reizis</surname><given-names>B.</given-names></string-name>, <string-name><surname>Bunin</surname><given-names>A.</given-names></string-name>, <string-name><surname>Ghosh</surname><given-names>H.S.</given-names></string-name>, <string-name><surname>Lewis</surname><given-names>K.L.</given-names></string-name>, <string-name><surname>Sisirak</surname><given-names>V.</given-names></string-name></person-group><article-title>Plasmacytoid dendritic cells: recent progress and open questions</article-title>. <source>Ann. Rev. Immunol.</source><year>2011</year>; <volume>29</volume>:<fpage>163</fpage>–<lpage>183</lpage>.<pub-id pub-id-type="pmid">21219184</pub-id></mixed-citation>
    </ref>
    <ref id="B54">
      <label>54.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brown</surname><given-names>C.C.</given-names></string-name>, <string-name><surname>Gudjonson</surname><given-names>H.</given-names></string-name>, <string-name><surname>Pritykin</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Deep</surname><given-names>D.</given-names></string-name>, <string-name><surname>Lavallée</surname><given-names>V.-P.</given-names></string-name>, <string-name><surname>Mendoza</surname><given-names>A.</given-names></string-name>, <string-name><surname>Fromme</surname><given-names>R.</given-names></string-name>, <string-name><surname>Mazutis</surname><given-names>L.</given-names></string-name>, <string-name><surname>Ariyan</surname><given-names>C.</given-names></string-name>, <string-name><surname>Leslie</surname><given-names>C.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Transcriptional basis of mouse and human dendritic cell heterogeneity</article-title>. <source>Cell</source>. <year>2019</year>; <volume>179</volume>:<fpage>846</fpage>–<lpage>863</lpage>.<pub-id pub-id-type="pmid">31668803</pub-id></mixed-citation>
    </ref>
    <ref id="B55">
      <label>55.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Merad</surname><given-names>M.</given-names></string-name>, <string-name><surname>Sathe</surname><given-names>P.</given-names></string-name>, <string-name><surname>Helft</surname><given-names>J.</given-names></string-name>, <string-name><surname>Miller</surname><given-names>J.</given-names></string-name>, <string-name><surname>Mortha</surname><given-names>A.</given-names></string-name></person-group><article-title>The dendritic cell lineage: ontogeny and function of dendritic cells and their subsets in the steady state and the inflamed setting</article-title>. <source>Ann. Rev. Immunol.</source><year>2013</year>; <volume>31</volume>:<fpage>563</fpage>–<lpage>604</lpage>.<pub-id pub-id-type="pmid">23516985</pub-id></mixed-citation>
    </ref>
    <ref id="B56">
      <label>56.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>W.</given-names></string-name>, <string-name><surname>Bover</surname><given-names>L.</given-names></string-name>, <string-name><surname>Cho</surname><given-names>M.</given-names></string-name>, <string-name><surname>Wen</surname><given-names>X.</given-names></string-name>, <string-name><surname>Hanabuchi</surname><given-names>S.</given-names></string-name>, <string-name><surname>Bao</surname><given-names>M.</given-names></string-name>, <string-name><surname>Rosen</surname><given-names>D.B.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y.-H.</given-names></string-name>, <string-name><surname>Shaw</surname><given-names>J.L.</given-names></string-name>, <string-name><surname>Du</surname><given-names>Q.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Regulation of TLR7/9 responses in plasmacytoid dendritic cells by BST2 and ILT7 receptor interaction</article-title>. <source>J. Exp. Med.</source><year>2009</year>; <volume>206</volume>:<fpage>1603</fpage>–<lpage>1614</lpage>.<pub-id pub-id-type="pmid">19564354</pub-id></mixed-citation>
    </ref>
    <ref id="B57">
      <label>57.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robbins</surname><given-names>S.H.</given-names></string-name>, <string-name><surname>Walzer</surname><given-names>T.</given-names></string-name>, <string-name><surname>Dembélé</surname><given-names>D.</given-names></string-name>, <string-name><surname>Thibault</surname><given-names>C.</given-names></string-name>, <string-name><surname>Defays</surname><given-names>A.</given-names></string-name>, <string-name><surname>Bessou</surname><given-names>G.</given-names></string-name>, <string-name><surname>Xu</surname><given-names>H.</given-names></string-name>, <string-name><surname>Vivier</surname><given-names>E.</given-names></string-name>, <string-name><surname>Sellars</surname><given-names>M.</given-names></string-name>, <string-name><surname>Pierre</surname><given-names>P.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Novel insights into the relationships between dendritic cell subsets in human and mouse revealed by genome-wide expression profiling</article-title>. <source>Genome Biol.</source><year>2008</year>; <volume>9</volume>:<fpage>R17</fpage>.<pub-id pub-id-type="pmid">18218067</pub-id></mixed-citation>
    </ref>
    <ref id="B58">
      <label>58.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cisse</surname><given-names>B.</given-names></string-name>, <string-name><surname>Caton</surname><given-names>M.L.</given-names></string-name>, <string-name><surname>Lehner</surname><given-names>M.</given-names></string-name>, <string-name><surname>Maeda</surname><given-names>T.</given-names></string-name>, <string-name><surname>Scheu</surname><given-names>S.</given-names></string-name>, <string-name><surname>Locksley</surname><given-names>R.</given-names></string-name>, <string-name><surname>Holmberg</surname><given-names>D.</given-names></string-name>, <string-name><surname>Zweier</surname><given-names>C.</given-names></string-name>, <string-name><surname>den Hollander</surname><given-names>N.S.</given-names></string-name>, <string-name><surname>Kant</surname><given-names>S.G.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Transcription factor E2-2 is an essential and specific regulator of plasmacytoid dendritic cell development</article-title>. <source>Cell</source>. <year>2008</year>; <volume>135</volume>:<fpage>37</fpage>–<lpage>48</lpage>.<pub-id pub-id-type="pmid">18854153</pub-id></mixed-citation>
    </ref>
    <ref id="B59">
      <label>59.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Crozat</surname><given-names>K.</given-names></string-name>, <string-name><surname>Guiton</surname><given-names>R.</given-names></string-name>, <string-name><surname>Guilliams</surname><given-names>M.</given-names></string-name>, <string-name><surname>Henri</surname><given-names>S.</given-names></string-name>, <string-name><surname>Baranek</surname><given-names>T.</given-names></string-name>, <string-name><surname>Schwartz-Cornil</surname><given-names>I.</given-names></string-name>, <string-name><surname>Malissen</surname><given-names>B.</given-names></string-name>, <string-name><surname>Dalod</surname><given-names>M.</given-names></string-name></person-group><article-title>Comparative genomics as a tool to reveal functional equivalences between human and mouse dendritic cell subsets</article-title>. <source>Immunol. Rev.</source><year>2010</year>; <volume>234</volume>:<fpage>177</fpage>–<lpage>198</lpage>.<pub-id pub-id-type="pmid">20193019</pub-id></mixed-citation>
    </ref>
    <ref id="B60">
      <label>60.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Collin</surname><given-names>M.</given-names></string-name>, <string-name><surname>Bigley</surname><given-names>V.</given-names></string-name></person-group><article-title>Human dendritic cell subsets: an update</article-title>. <source>Immunology</source>. <year>2018</year>; <volume>154</volume>:<fpage>3</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">29313948</pub-id></mixed-citation>
    </ref>
    <ref id="B61">
      <label>61.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huysamen</surname><given-names>C.</given-names></string-name>, <string-name><surname>Willment</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Dennehy</surname><given-names>K.M.</given-names></string-name>, <string-name><surname>Brown</surname><given-names>G.D.</given-names></string-name></person-group><article-title>CLEC9A is a novel activation C-type lectin-like receptor expressed on BDCA3+ dendritic cells and a subset of monocytes</article-title>. <source>J. Biol. Chem.</source><year>2008</year>; <volume>283</volume>:<fpage>16693</fpage>–<lpage>16701</lpage>.<pub-id pub-id-type="pmid">18408006</pub-id></mixed-citation>
    </ref>
    <ref id="B62">
      <label>62.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Siatecka</surname><given-names>M.</given-names></string-name>, <string-name><surname>Bieker</surname><given-names>J.J.</given-names></string-name></person-group><article-title>The multifunctional role of EKLF/KLF1 during erythropoiesis</article-title>. <source>Blood</source>. <year>2011</year>; <volume>118</volume>:<fpage>2044</fpage>–<lpage>2054</lpage>.<pub-id pub-id-type="pmid">21613252</pub-id></mixed-citation>
    </ref>
    <ref id="B63">
      <label>63.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bianchi</surname><given-names>E.</given-names></string-name>, <string-name><surname>Bulgarelli</surname><given-names>J.</given-names></string-name>, <string-name><surname>Ruberti</surname><given-names>S.</given-names></string-name>, <string-name><surname>Rontauroli</surname><given-names>S.</given-names></string-name>, <string-name><surname>Sacchi</surname><given-names>G.</given-names></string-name>, <string-name><surname>Norfo</surname><given-names>R.</given-names></string-name>, <string-name><surname>Pennucci</surname><given-names>V.</given-names></string-name>, <string-name><surname>Zini</surname><given-names>R.</given-names></string-name>, <string-name><surname>Salati</surname><given-names>S.</given-names></string-name>, <string-name><surname>Prudente</surname><given-names>Z.</given-names></string-name><etal>et al</etal>.</person-group><article-title>MYB controls erythroid versus megakaryocyte lineage fate decision through the miR-486-3p-mediated downregulation of MAF</article-title>. <source>Cell Death Differ.</source><year>2015</year>; <volume>22</volume>:<fpage>1906</fpage>–<lpage>1921</lpage>.<pub-id pub-id-type="pmid">25857263</pub-id></mixed-citation>
    </ref>
    <ref id="B64">
      <label>64.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>F.</given-names></string-name>, <string-name><surname>Feng</surname><given-names>M.</given-names></string-name>, <string-name><surname>Sinha</surname><given-names>R.</given-names></string-name>, <string-name><surname>Seita</surname><given-names>J.</given-names></string-name>, <string-name><surname>Mori</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Weissman</surname><given-names>I.L.</given-names></string-name></person-group><article-title>Screening for genes that regulate the differentiation of human megakaryocytic lineage cells</article-title>. <source>Proc. Nat. Acad. Sci.</source><year>2018</year>; <volume>115</volume>:<fpage>E9308</fpage>–<lpage>E9316</lpage>.<pub-id pub-id-type="pmid">30150396</pub-id></mixed-citation>
    </ref>
    <ref id="B65">
      <label>65.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Azcoitia</surname><given-names>V.</given-names></string-name>, <string-name><surname>Aracil</surname><given-names>M.</given-names></string-name>, <string-name><surname>Martínez-A</surname><given-names>C.</given-names></string-name>, <string-name><surname>Torres</surname><given-names>M.</given-names></string-name></person-group><article-title>The homeodomain protein Meis1 is essential for definitive hematopoiesis and vascular patterning in the mouse embryo</article-title>. <source>Dev. Biol.</source><year>2005</year>; <volume>280</volume>:<fpage>307</fpage>–<lpage>320</lpage>.<pub-id pub-id-type="pmid">15882575</pub-id></mixed-citation>
    </ref>
    <ref id="B66">
      <label>66.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tusi</surname><given-names>B.K.</given-names></string-name>, <string-name><surname>Wolock</surname><given-names>S.L.</given-names></string-name>, <string-name><surname>Weinreb</surname><given-names>C.</given-names></string-name>, <string-name><surname>Hwang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Hidalgo</surname><given-names>D.</given-names></string-name>, <string-name><surname>Zilionis</surname><given-names>R.</given-names></string-name>, <string-name><surname>Waisman</surname><given-names>A.</given-names></string-name>, <string-name><surname>Huh</surname><given-names>J.R.</given-names></string-name>, <string-name><surname>Klein</surname><given-names>A.M.</given-names></string-name>, <string-name><surname>Socolovsky</surname><given-names>M.</given-names></string-name></person-group><article-title>Population snapshots predict early haematopoietic and erythroid hierarchies</article-title>. <source>Nature</source>. <year>2018</year>; <volume>555</volume>:<fpage>54</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">29466336</pub-id></mixed-citation>
    </ref>
    <ref id="B67">
      <label>67.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nakano</surname><given-names>T.</given-names></string-name>, <string-name><surname>Kodama</surname><given-names>H.</given-names></string-name>, <string-name><surname>Honjo</surname><given-names>T.</given-names></string-name></person-group><article-title>In vitro development of primitive and definitive erythrocytes from different precursors</article-title>. <source>Science</source>. <year>1996</year>; <volume>272</volume>:<fpage>722</fpage>–<lpage>724</lpage>.<pub-id pub-id-type="pmid">8614833</pub-id></mixed-citation>
    </ref>
    <ref id="B68">
      <label>68.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rohwedel</surname><given-names>J.</given-names></string-name>, <string-name><surname>Maltsev</surname><given-names>V.</given-names></string-name>, <string-name><surname>Bober</surname><given-names>E.</given-names></string-name>, <string-name><surname>Arnold</surname><given-names>H.-H.</given-names></string-name>, <string-name><surname>Hescheler</surname><given-names>J.</given-names></string-name>, <string-name><surname>Wobus</surname><given-names>A.</given-names></string-name></person-group><article-title>Muscle cell differentiation of embryonic stem cells reflects myogenesis in vivo: developmentally regulated expression of myogenic determination genes and functional expression of ionic currents</article-title>. <source>Dev. Biol.</source><year>1994</year>; <volume>164</volume>:<fpage>87</fpage>–<lpage>101</lpage>.<pub-id pub-id-type="pmid">8026639</pub-id></mixed-citation>
    </ref>
    <ref id="B69">
      <label>69.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pan</surname><given-names>G.</given-names></string-name>, <string-name><surname>Thomson</surname><given-names>J.A.</given-names></string-name></person-group><article-title>Nanog and transcriptional networks in embryonic stem cell pluripotency</article-title>. <source>Cell Res.</source><year>2007</year>; <volume>17</volume>:<fpage>42</fpage>–<lpage>49</lpage>.<pub-id pub-id-type="pmid">17211451</pub-id></mixed-citation>
    </ref>
    <ref id="B70">
      <label>70.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carney</surname><given-names>T.J.</given-names></string-name>, <string-name><surname>Dutton</surname><given-names>K.A.</given-names></string-name>, <string-name><surname>Greenhill</surname><given-names>E.</given-names></string-name>, <string-name><surname>Delfino-Machin</surname><given-names>M.</given-names></string-name>, <string-name><surname>Dufourcq</surname><given-names>P.</given-names></string-name>, <string-name><surname>Blader</surname><given-names>P.</given-names></string-name>, <string-name><surname>Kelsh</surname><given-names>R.N.</given-names></string-name></person-group><article-title>A direct role for Sox10 in specification of neural crest-derived sensory neurons</article-title>. <source>Development</source>. <year>2006</year>; <volume>133</volume>:<fpage>4619</fpage>–<lpage>4630</lpage>.<pub-id pub-id-type="pmid">17065232</pub-id></mixed-citation>
    </ref>
    <ref id="B71">
      <label>71.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheung</surname><given-names>M.</given-names></string-name>, <string-name><surname>Briscoe</surname><given-names>J.</given-names></string-name></person-group><article-title>Neural crest development is regulated by the transcription factor Sox9</article-title>. <source>Development</source>. <year>2003</year>; <volume>130</volume>:<fpage>5681</fpage>–<lpage>5693</lpage>.<pub-id pub-id-type="pmid">14522876</pub-id></mixed-citation>
    </ref>
    <ref id="B72">
      <label>72.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muralidharan</surname><given-names>B.</given-names></string-name>, <string-name><surname>Khatri</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Maheshwari</surname><given-names>U.</given-names></string-name>, <string-name><surname>Gupta</surname><given-names>R.</given-names></string-name>, <string-name><surname>Roy</surname><given-names>B.</given-names></string-name>, <string-name><surname>Pradhan</surname><given-names>S.J.</given-names></string-name>, <string-name><surname>Karmodiya</surname><given-names>K.</given-names></string-name>, <string-name><surname>Padmanabhan</surname><given-names>H.</given-names></string-name>, <string-name><surname>Shetty</surname><given-names>A.S.</given-names></string-name>, <string-name><surname>Balaji</surname><given-names>C.</given-names></string-name><etal>et al</etal>.</person-group><article-title>LHX2 interacts with the NuRD complex and regulates cortical neuron subtype determinants Fezf2 and Sox11</article-title>. <source>J. Neurosci.</source><year>2017</year>; <volume>37</volume>:<fpage>194</fpage>–<lpage>203</lpage>.<pub-id pub-id-type="pmid">28053041</pub-id></mixed-citation>
    </ref>
    <ref id="B73">
      <label>73.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Panayi</surname><given-names>H.</given-names></string-name>, <string-name><surname>Panayiotou</surname><given-names>E.</given-names></string-name>, <string-name><surname>Orford</surname><given-names>M.</given-names></string-name>, <string-name><surname>Genethliou</surname><given-names>N.</given-names></string-name>, <string-name><surname>Mean</surname><given-names>R.</given-names></string-name>, <string-name><surname>Lapathitis</surname><given-names>G.</given-names></string-name>, <string-name><surname>Li</surname><given-names>S.</given-names></string-name>, <string-name><surname>Xiang</surname><given-names>M.</given-names></string-name>, <string-name><surname>Kessaris</surname><given-names>N.</given-names></string-name>, <string-name><surname>Richardson</surname><given-names>W.D.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Sox1 is required for the specification of a novel p2-derived interneuron subtype in the mouse ventral spinal cord</article-title>. <source>J. Neurosci.</source><year>2010</year>; <volume>30</volume>:<fpage>12274</fpage>–<lpage>12280</lpage>.<pub-id pub-id-type="pmid">20844123</pub-id></mixed-citation>
    </ref>
    <ref id="B74">
      <label>74.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fawkner-Corbett</surname><given-names>D.</given-names></string-name>, <string-name><surname>Antanaviciute</surname><given-names>A.</given-names></string-name>, <string-name><surname>Parikh</surname><given-names>K.</given-names></string-name>, <string-name><surname>Jagielowicz</surname><given-names>M.</given-names></string-name>, <string-name><surname>Gerós</surname><given-names>A.S.</given-names></string-name>, <string-name><surname>Gupta</surname><given-names>T.</given-names></string-name>, <string-name><surname>Ashley</surname><given-names>N.</given-names></string-name>, <string-name><surname>Khamis</surname><given-names>D.</given-names></string-name>, <string-name><surname>Fowler</surname><given-names>D.</given-names></string-name>, <string-name><surname>Morrissey</surname><given-names>E.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Spatiotemporal analysis of human intestinal development at single-cell resolution</article-title>. <source>Cell</source>. <year>2021</year>; <volume>184</volume>:<fpage>810</fpage>–<lpage>826</lpage>.<pub-id pub-id-type="pmid">33406409</pub-id></mixed-citation>
    </ref>
    <ref id="B75">
      <label>75.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Johansson</surname><given-names>M.E.V.</given-names></string-name>, <string-name><surname>Larsson</surname><given-names>J.M.H.</given-names></string-name>, <string-name><surname>Hansson</surname><given-names>G.C.</given-names></string-name></person-group><article-title>The two mucus layers of colon are organized by the MUC2 mucin, whereas the outer layer is a legislator of host–microbial interactions</article-title>. <source>Proc. Nat. Acad. Sci. U.S.A.</source><year>2011</year>; <volume>108</volume>:<fpage>4659</fpage>–<lpage>4665</lpage>.</mixed-citation>
    </ref>
    <ref id="B76">
      <label>76.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wagner</surname><given-names>L.</given-names></string-name>, <string-name><surname>Oliyarnyk</surname><given-names>O.</given-names></string-name>, <string-name><surname>Gartner</surname><given-names>W.</given-names></string-name>, <string-name><surname>Nowotny</surname><given-names>P.</given-names></string-name>, <string-name><surname>Groeger</surname><given-names>M.</given-names></string-name>, <string-name><surname>Kaserer</surname><given-names>K.</given-names></string-name>, <string-name><surname>Waldhäusl</surname><given-names>W.</given-names></string-name>, <string-name><surname>Pasternack</surname><given-names>M.S.</given-names></string-name></person-group><article-title>Cloning and expression of secretagogin, a novel neuroendocrine- and pancreatic islet of Langerhans-specific Ca2+-binding protein</article-title>. <source>J. Biol. Chem.</source><year>2000</year>; <volume>275</volume>:<fpage>24740</fpage>–<lpage>24751</lpage>.<pub-id pub-id-type="pmid">10811645</pub-id></mixed-citation>
    </ref>
    <ref id="B77">
      <label>77.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Laforenza</surname><given-names>U.</given-names></string-name>, <string-name><surname>Cova</surname><given-names>E.</given-names></string-name>, <string-name><surname>Gastaldi</surname><given-names>G.</given-names></string-name>, <string-name><surname>Tritto</surname><given-names>S.</given-names></string-name>, <string-name><surname>Grazioli</surname><given-names>M.</given-names></string-name>, <string-name><surname>LaRusso</surname><given-names>N.F.</given-names></string-name>, <string-name><surname>Splinter</surname><given-names>P.L.</given-names></string-name>, <string-name><surname>D’Adamo</surname><given-names>P.</given-names></string-name>, <string-name><surname>Tosco</surname><given-names>M.</given-names></string-name>, <string-name><surname>Ventura</surname><given-names>U.</given-names></string-name></person-group><article-title>Aquaporin-8 is involved in water transport in isolated superficial colonocytes from rat proximal colon</article-title>. <source>J. Nutr.</source><year>2005</year>; <volume>135</volume>:<fpage>2329</fpage>–<lpage>2336</lpage>.<pub-id pub-id-type="pmid">16177191</pub-id></mixed-citation>
    </ref>
    <ref id="B78">
      <label>78.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Birchenough</surname><given-names>G. M.H.</given-names></string-name>, <string-name><surname>Johansson</surname><given-names>M.E.</given-names></string-name>, <string-name><surname>Gustafsson</surname><given-names>J.K.</given-names></string-name>, <string-name><surname>Bergström</surname><given-names>J.H.</given-names></string-name>, <string-name><surname>Hansson</surname><given-names>G.C.</given-names></string-name></person-group><article-title>New developments in goblet cell mucus secretion and function</article-title>. <source>Mucosal Immunol.</source><year>2015</year>; <volume>8</volume>:<fpage>712</fpage>–<lpage>719</lpage>.<pub-id pub-id-type="pmid">25872481</pub-id></mixed-citation>
    </ref>
    <ref id="B79">
      <label>79.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andreou</surname><given-names>N.P.</given-names></string-name>, <string-name><surname>Legaki</surname><given-names>E.</given-names></string-name>, <string-name><surname>Gazouli</surname><given-names>M.</given-names></string-name></person-group><article-title>Inflammatory bowel disease pathobiology: the role of the interferon signature</article-title>. <source>Ann. Gastroenterol.</source><year>2020</year>; <volume>33</volume>:<fpage>125</fpage>–<lpage>133</lpage>.<pub-id pub-id-type="pmid">32127733</pub-id></mixed-citation>
    </ref>
    <ref id="B80">
      <label>80.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zafar</surname><given-names>H.</given-names></string-name>, <string-name><surname>Tzen</surname><given-names>A.</given-names></string-name>, <string-name><surname>Navin</surname><given-names>N.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>K.</given-names></string-name>, <string-name><surname>Nakhleh</surname><given-names>L.</given-names></string-name></person-group><article-title>SiFit: inferring tumor trees from single-cell sequencing data under finite-sites models</article-title>. <source>Genome Biol.</source><year>2017</year>; <volume>18</volume>:<fpage>178</fpage>.<pub-id pub-id-type="pmid">28927434</pub-id></mixed-citation>
    </ref>
    <ref id="B81">
      <label>81.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zafar</surname><given-names>H.</given-names></string-name>, <string-name><surname>Navin</surname><given-names>N.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>K.</given-names></string-name>, <string-name><surname>Nakhleh</surname><given-names>L.</given-names></string-name></person-group><article-title>SiCloneFit: Bayesian inference of population structure, genotype, and phylogeny of tumor clones from single-cell genome sequencing data</article-title>. <source>Genome Res.</source><year>2019</year>; <volume>29</volume>:<fpage>1847</fpage>–<lpage>1859</lpage>.<pub-id pub-id-type="pmid">31628257</pub-id></mixed-citation>
    </ref>
    <ref id="B82">
      <label>82.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zafar</surname><given-names>H.</given-names></string-name>, <string-name><surname>Lin</surname><given-names>C.</given-names></string-name>, <string-name><surname>Bar-Joseph</surname><given-names>Z.</given-names></string-name></person-group><article-title>Single-cell lineage tracing by integrating CRISPR-Cas9 mutations with transcriptomic data</article-title>. <source>Nat. Commun.</source><year>2020</year>; <volume>11</volume>:<fpage>3055</fpage>.<pub-id pub-id-type="pmid">32546686</pub-id></mixed-citation>
    </ref>
    <ref id="B83">
      <label>83.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Regev</surname><given-names>A.</given-names></string-name>, <string-name><surname>Teichmann</surname><given-names>S.A.</given-names></string-name>, <string-name><surname>Lander</surname><given-names>E.S.</given-names></string-name>, <string-name><surname>Amit</surname><given-names>I.</given-names></string-name>, <string-name><surname>Benoist</surname><given-names>C.</given-names></string-name>, <string-name><surname>Birney</surname><given-names>E.</given-names></string-name>, <string-name><surname>Bodenmiller</surname><given-names>B.</given-names></string-name>, <string-name><surname>Campbell</surname><given-names>P.</given-names></string-name>, <string-name><surname>Carninci</surname><given-names>P.</given-names></string-name>, <string-name><surname>Clatworthy</surname><given-names>M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>The Human Cell Atlas</article-title>. <source>eLife</source>. <year>2017</year>; <volume>6</volume>:<fpage>e27041</fpage>.<pub-id pub-id-type="pmid">29206104</pub-id></mixed-citation>
    </ref>
    <ref id="B84">
      <label>84.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Snyder</surname><given-names>M.P.</given-names></string-name>, <string-name><surname>Lin</surname><given-names>S.</given-names></string-name>, <string-name><surname>Posgai</surname><given-names>A.</given-names></string-name>, <string-name><surname>Atkinson</surname><given-names>M.</given-names></string-name>, <string-name><surname>Regev</surname><given-names>A.</given-names></string-name>, <string-name><surname>Rood</surname><given-names>J.</given-names></string-name>, <string-name><surname>Rozenblatt-Rosen</surname><given-names>O.</given-names></string-name>, <string-name><surname>Gaffney</surname><given-names>L.</given-names></string-name>, <string-name><surname>Hupalowska</surname><given-names>A.</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name><etal>et al</etal>.</person-group><article-title>The human body at cellular resolution: the NIH Human Biomolecular Atlas Program</article-title>. <source>Nature</source>. <year>2019</year>; <volume>574</volume>:<fpage>187</fpage>–<lpage>192</lpage>.<pub-id pub-id-type="pmid">31597973</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
