<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10474950</article-id>
    <article-id pub-id-type="pmid">37624916</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad515</article-id>
    <article-id pub-id-type="publisher-id">btad515</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Cell-connectivity-guided trajectory inference from single-cell data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3872-9668</contrib-id>
        <name>
          <surname>Smolander</surname>
          <given-names>Johannes</given-names>
        </name>
        <aff><institution>Turku Bioscience Centre, University of Turku and Åbo Akademi University</institution>, 20520 Turku, <country country="FI">Finland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3754-5584</contrib-id>
        <name>
          <surname>Junttila</surname>
          <given-names>Sini</given-names>
        </name>
        <aff><institution>Turku Bioscience Centre, University of Turku and Åbo Akademi University</institution>, 20520 Turku, <country country="FI">Finland</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Elo</surname>
          <given-names>Laura L</given-names>
        </name>
        <aff><institution>Turku Bioscience Centre, University of Turku and Åbo Akademi University</institution>, 20520 Turku, <country country="FI">Finland</country></aff>
        <aff><institution>Institute of Biomedicine, University of Turku</institution>, 20520 Turku, <country country="FI">Finland</country></aff>
        <xref rid="btad515-cor1" ref-type="corresp"/>
        <!--laura.elo@utu.fi-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad515-cor1">Corresponding author. Turku Bioscience Centre, University of Turku and Åbo Akademi University, Tykistökatu 6, 20520 Turku, Finland. E-mail: <email>laura.elo@utu.fi</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-25">
      <day>25</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>9</issue>
    <elocation-id>btad515</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>13</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>02</day>
        <month>9</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad515.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-cell RNA-sequencing enables cell-level investigation of cell differentiation, which can be modelled using trajectory inference methods. While tremendous effort has been put into designing these methods, inferring accurate trajectories automatically remains difficult. Therefore, the standard approach involves testing different trajectory inference methods and picking the trajectory giving the most biologically sensible model. As the default parameters are often suboptimal, their tuning requires methodological expertise.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce Totem, an open-source, easy-to-use R package designed to facilitate inference of tree-shaped trajectories from single-cell data. Totem generates a large number of clustering results, estimates their topologies as minimum spanning trees, and uses them to measure the connectivity of the cells. Besides automatic selection of an appropriate trajectory, cell connectivity enables to visually pinpoint branching points and milestones relevant to the trajectory. Furthermore, testing different trajectories with Totem is fast, easy, and does not require in-depth methodological knowledge.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Totem is available as an R package at <ext-link xlink:href="https://github.com/elolab/Totem" ext-link-type="uri">https://github.com/elolab/Totem</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council ERC</institution>
          </institution-wrap>
        </funding-source>
        <award-id>677943</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union's Horizon 2020 research and innovation programme</institution>
          </institution-wrap>
        </funding-source>
        <award-id>955321</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Academy of Finland</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002341</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>310561</award-id>
        <award-id>314443</award-id>
        <award-id>329278</award-id>
        <award-id>335434</award-id>
        <award-id>335611</award-id>
        <award-id>341342</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA-sequencing (scRNA-seq) enables researchers to quantify the transcriptome of thousands or even millions of cells simultaneously at the single-cell level. The cells in a tissue undergo transcriptomic changes that are part of biological processes. If the changes happen gradually, the tissue contains cells derived from different stages of the process. If a correct trajectory that accurately models these different stages can be generated from the scRNA-seq data, this enables researchers to unravel the transcriptomic mechanisms of the processes. The modelling of trajectories from scRNA-seq data has formed a new branch in computational biology, known as trajectory inference.</p>
    <p>A vast number of trajectory inference methods has been developed (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad515-B9" ref-type="bibr">Deconinck <italic toggle="yes">et al.</italic> 2021</xref>). While these methods have proven to be valuable in many situations, their use is still difficult for several reasons. The main reason is that a single method used with default settings often fails to generate a trajectory that can capture all relevant parts (milestones) of the trajectory and also accurately model the correct milestone network. Therefore, a popular approach is to test different methods and tune their parameters until a biologically sensible or otherwise satisfactory trajectory is obtained.</p>
    <p>Slingshot (<xref rid="btad515-B28" ref-type="bibr">Street <italic toggle="yes">et al.</italic> 2018</xref>) has become one of the most popular trajectory inference methods after a comparison study (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>) showed it was one of the best-performing methods for inferring tree-shaped trajectories. A tree can be any trajectory in which the parts are not disconnected and the trajectory has no cycles. Slingshot requires as input a clustering of cells that is used to construct a Minimum Spanning Tree (MST), which is subsequently smoothed using the simultaneous principal curves algorithm to obtain a directed trajectory, which also includes pseudotime, a measure of the differentiation stage of the cells. While methods such as the Average Silhouette Width (ASW) (<xref rid="btad515-B25" ref-type="bibr">Rousseeuw 1987</xref>) and the Variance Ratio Criterion (VRC) (<xref rid="btad515-B3" ref-type="bibr">Caliński and Harabasz 1974</xref>) can be used to select the clustering automatically, their weakness is in their tendency to select a clustering with an overly small number of clusters. The resulting trajectories are often over-simplistic and lack especially small milestones. Therefore, a more reliable approach can be to manually generate a clustering that includes all the relevant milestones, but this requires careful parameter testing and validation using markers to ensure that the clustering is optimal. However, even then the resulting MST may not correlate well with the true milestone network because the MST is generated using a distance matrix that is sensitive to the preprocessing steps (e.g. dimensionality reduction), the clustering structure, and the choice of the distance metric.</p>
    <p>To provide a system with better user experience for researchers who perform trajectory inference, we developed a new tool, Totem, for the inference of tree-shaped trajectories from single-cell data (<xref rid="btad515-F1" ref-type="fig">Fig. 1</xref>). Totem generates a large number of dissimilar clustering results for the cells (by default, 10 000) using a <italic toggle="yes">k</italic>-medoids algorithm. The number of clusters (<italic toggle="yes">k</italic>) and the structure of the clustering results vary, generating vastly different trajectories when used as the basis for constructing the MST. To select a clustering from the large set of clustering results, Totem uses a new measure called cell connectivity, which is based on counting the number of edges (connections) between the clusters in an MST. The ratio of the number of edges and clusters (connectivity) is calculated for each cell and clustering, and the connectivity vectors are averaged to obtain the cell connectivity of the cells. The cell connectivity acts as a useful baseline for selecting an appropriate trajectory and deciding which milestones to include in the trajectory, while also helping to give a visual overview of the milestone network, i.e. how the milestones are connected and where the branching points and leaf nodes are located. Importantly, a key feature of Totem for its usability is that it allows to quickly and easily browse different MSTs, from which the user can select one or several MSTs for further analysis.</p>
    <fig position="float" id="btad515-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Schematic illustration of the Totem workflow. (1) A gene expression matrix is used as input, which needs to be preprocessed upstream of Totem analysis, including normalization, quality control, and possible batch correction and feature selection. Further dimensionality reduction (feature extraction) can also be performed using Totem. For the low-dimensional data matrix, Totem generates (2) a large set of clustering results using a <italic toggle="yes">k</italic>-medoids clustering algorithm (CLARA), (3) a Minimum Spanning Tree (MST) for each clustering, which models the cluster (milestone) network, and (4) estimates the connectivity of the clusters in each MST (ratio of the number of edges a cluster has in MST and the number of clusters). The connectivity vectors are averaged to generate the cell connectivity measure (top right), which helps to locate branching points and milestones that are relevant to model. (5) The clustering results are ranked based on the Variance Ratio Criterion (VRC) of the cell connectivity measure, and (6) top-ranking clustering results and their corresponding MSTs are selected for further analysis (middle-right). (7) The selected MSTs are smoothed using the Slingshot algorithm to obtain directed trajectories (lower right). The trajectory can be exported as objects that can be used downstream of Totem analysis, such as differential expression analysis.</p>
      </caption>
      <graphic xlink:href="btad515f1" position="float"/>
    </fig>
    <p>To benchmark Totem, we performed a comprehensive comparison using the dynverse benchmarking framework (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>), which comprises over 200 tree-shaped trajectories. We compared Totem with the popular Slingshot tool (<xref rid="btad515-B28" ref-type="bibr">Street <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>) and the more recently introduced TinGa (<xref rid="btad515-B29" ref-type="bibr">Todorov <italic toggle="yes">et al.</italic> 2020</xref>), which is based on a growing neural gas (GNG) model (<xref rid="btad515-B10" ref-type="bibr">Fritzke 1994</xref>) and can also model trajectories that are more complex than trees. In particular, to evaluate the performance of the connectivity-based criterion of Totem for clustering selection in trajectory inference, we compared it with the popular ASW and VRC clustering selection methods. Because a single clustering is rarely optimal, and thus the users are often forced to try multiple clustering results to optimize the trajectories, we investigated the performance of the trajectories generated based on multiple top-ranked clustering results, giving a deeper overview of the performance. Finally, we demonstrate the usefulness of the cell connectivity measure with a few examples that show how the measure can aid trajectory inference by helping to pinpoint relevant branching points and milestones.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Totem</title>
      <p>In the following subsections, we go through the main steps of Totem trajectory inference workflow. <xref rid="btad515-F1" ref-type="fig">Figure 1</xref> illustrates the basic workflow of Totem.</p>
      <sec>
        <title>2.1.1 Upstream analysis</title>
        <p>Upstream of trajectory inference, Totem assumes that the input gene expression matrix has been normalized and quality control has been performed to remove bad-quality cells (<xref rid="btad515-B15" ref-type="bibr">Ilicic <italic toggle="yes">et al.</italic> 2016</xref>). scRNA-seq data analysis toolkits like Seurat (<xref rid="btad515-B2" ref-type="bibr">Butler <italic toggle="yes">et al.</italic> 2018</xref>) and Scanpy (<xref rid="btad515-B32" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) can perform the normalization and quality control.</p>
        <p>Trajectory inference methods require a low-dimensional (from 2 to 50) embedding as input. The dimensionality reduction steps can be customized as the user sees best prior to Totem analysis, but Totem can also be used to transform gene counts into new features (feature extraction) with functions that utilize the dyndimred R package. In scRNA-seq data analysis, the most common way to perform feature extraction is the Principal Component Analysis (PCA) in which the number of principal components typically varies from 10 to 30. Alternatively, methods like Multi-Dimensional Scaling (MDS) or the more scalable landscape MDS (LMDS) can be used to generate an embedding with a smaller number of dimensions (e.g. from 2 to 5), which is usually not a sufficient number in PCA of scRNA-seq data. <italic toggle="yes">t</italic>-distributed stochastic neighbour embedding (<italic toggle="yes">t</italic>-SNE) (<xref rid="btad515-B18" ref-type="bibr">Maaten and van der Hinton 2008</xref>) and Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP) (<xref rid="btad515-B20" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic> 2018</xref>) are commonly used only for visualization, and they should be used with caution if used as input in trajectory inference. As the default dimensionality reduction method in Totem, we use the 5-dimensional LMDS. Moreover, it is generally a good idea to reduce the number of features prior to feature extraction by selecting highly variable genes (HVGs), which can be performed using methods like Seurat (<xref rid="btad515-B2" ref-type="bibr">Butler <italic toggle="yes">et al.</italic> 2018</xref>) and Scanpy (<xref rid="btad515-B32" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>). If the dataset has batch effects, and the user does not want to model these differences in trajectory inference, data integration methods (<xref rid="btad515-B2" ref-type="bibr">Butler <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad515-B17" ref-type="bibr">Luecken <italic toggle="yes">et al.</italic> 2022</xref>) can be used.</p>
      </sec>
      <sec>
        <title>2.1.2 Generation of a large set of clustering results</title>
        <p>To generate a large set of dissimilar clustering results that can be used as the basis for constructing the MST, we use the CLARA <italic toggle="yes">k</italic>-medoids clustering algorithm (<xref rid="btad515-B24" ref-type="bibr">Peter and Rousseeuw 1990</xref>) from the cluster R package, which performs fast <italic toggle="yes">k</italic>-medoids clustering. We run the algorithm <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>L</mml:mi></mml:math></inline-formula> times (by default <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo> </mml:mo><mml:mn>000</mml:mn></mml:math></inline-formula>) and filter out clustering results that have clusters with fewer than five cells to prevent overly small clusters, which are usually not interesting. The number of remaining clustering results (<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>L</mml:mi><mml:mi>′</mml:mi></mml:math></inline-formula>) can be close to <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi>L</mml:mi></mml:math></inline-formula> or deviate from it considerably depending on the dataset. The number of clusters (<inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>) varies by default from 3 to 20, but can be adjusted by the user if more complex trajectories with more milestones are expected. The default upper limit (20) is well above the average number of clusters (milestones) in the trajectories of the dynverse benchmarking framework. We also activate the R random number generation (RNG) in the clara R function so that the program returns different results with different RNG seeds.</p>
      </sec>
      <sec>
        <title>2.1.3 Generation of minimum spanning trees for clustering results</title>
        <p>For each clustering, we generate an MST by representing the clusters of cells as vertices in a graph and using the covariance-based approach of Slingshot (<xref rid="btad515-B28" ref-type="bibr">Street <italic toggle="yes">et al.</italic> 2018</xref>) to measure distances between the clusters. The Mahalanobis-like distances are calculated from the covariance matrix for cells in each cluster, while also considering the shape and spread of the clusters. We use the ape R package to perform the MST estimation (<xref rid="btad515-B23" ref-type="bibr">Paradis and Schliep 2019</xref>).</p>
      </sec>
      <sec>
        <title>2.1.4 Estimate cell connectivity</title>
        <p>For each MST<italic toggle="yes">j</italic> (<inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mi>′</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, we measure the connectivity <italic toggle="yes">c<sub>ij</sub> = d<sub>ij</sub>/k<sub>j</sub></italic> of the <italic toggle="yes">i</italic>th vertex (cluster) in the graph by dividing the degree of the vertex <italic toggle="yes">d<sub>ij</sub></italic>, i.e. the number of edges that are connected to the vertex, by the number of vertices <italic toggle="yes">k<sub>j</sub></italic> in the graph. We then create a connectivity vector <bold><italic toggle="yes">c</italic></bold><sub><italic toggle="yes">j</italic></sub> that contains the connectivity values for all <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi>N</mml:mi></mml:math></inline-formula> cells corresponding to MST <italic toggle="yes">j</italic>, scale the connectivity values so that the maximum connectivity of each graph is always one, and calculate the cell connectivity of all the cells <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula> by averaging over the <italic toggle="yes">L′</italic> connectivity vectors using the arithmetic mean:
</p>
        <disp-formula id="E1">
          <label>(1)</label>
          <mml:math id="M1" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">c</mml:mi>
                  </mml:mrow>
                  <mml:mo>¯</mml:mo>
                </mml:mover>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>L</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">'</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:munderover>
                  <mml:mo stretchy="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>L</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">'</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mrow>
                </mml:munderover>
              </mml:mrow>
              <mml:mrow>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">c</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">max</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">c</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>The cell connectivity is higher for cell populations that are farther from the leaf parts of the trajectory (<xref rid="btad515-F1" ref-type="fig">Fig. 1</xref>). We used the arithmetic mean because it ensures that the connectivity gradient is continuous, as opposed to the median approach (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
      </sec>
      <sec>
        <title>2.1.5 Clustering selection using the variance ratio criterion</title>
        <p>To find a clustering that captures the tree structure of the data and gives clusters that are well defined, we use VRC, also known as the Calinski–Harabasz score (<xref rid="btad515-B3" ref-type="bibr">Caliński and Harabasz 1974</xref>), which measures the ratio of the between-cluster dispersion and the within-cluster dispersion. Instead of using the whole dimensionally reduced data as input, we use the one-dimensional cell connectivity vector <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula> to find clusters that have cells with similar connectivity within the clusters but different compared to the other clusters. VRC is a more memory-efficient method for clustering selection than the commonly used ASW because it does not require a distance matrix of cells as input, making it more suitable for datasets with many cells. We use the fpc R package to perform the VRC analysis.</p>
      </sec>
      <sec>
        <title>2.1.6 Lineage smoothing</title>
        <p>For an MST corresponding to a selected clustering, Totem performs lineage smoothing using Slingshot (<xref rid="btad515-B28" ref-type="bibr">Street <italic toggle="yes">et al.</italic> 2018</xref>), which generates a directed trajectory along with pseudotime that quantifies cell differentiation continuously at the single-cell level. Slingshot fits principal curves (<xref rid="btad515-B13" ref-type="bibr">Hastie and Stuetzle 1989</xref>) for each lineage of the MST starting from a user-specified root node, which is initially selected randomly. The root node can be adjusted later by the user.</p>
      </sec>
      <sec>
        <title>2.1.7 Trajectory visualization and interpretation</title>
        <p>Totem includes visualization functions that aid trajectory inference, utilizing the dynplot R package (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>). The functions enable to visualize multiple MSTs and smoothed trajectories side by side over a two-dimensional embedding. The two-dimensional embedding can be provided by the user or generated using one of the methods included in the dyndimred R package, such as <italic toggle="yes">t</italic>-SNE, UMAP, or MDS. To assist in biological interpretation, the user can also visualize expression levels of genes over the embedding.</p>
        <p>The cell connectivity can be visualized over the two-dimensional embedding to pinpoint milestones and branching points that could be otherwise missed or inaccurately modelled (<xref rid="btad515-F1" ref-type="fig">Fig. 1</xref>). Local changes in the connectivity indicate milestone transitions that are relevant to include in the trajectory. The connectivity levels can be used to locate branching points, where a cell population is encircled by other cell populations whose connectivity is relatively lower (<xref rid="btad515-F4" ref-type="fig">Fig. 4</xref>).</p>
        <p>Although the clustering selection is performed based on the VRC of the cell connectivity, the resulting MST can still be suboptimal in terms of the connections that the milestone network comprises. In addition, small milestones can be missing or the trajectory can seem over-complicated. Therefore, the user should not rely upon a single, automatically generated trajectory. Instead, the trajectory should be validated using gene markers to ensure that the model is biologically sensible, and compared with the cell connectivity by visualization to ensure that the milestone network is in line with the connectivity profile. If the trajectory requires adjustments, Totem allows to easily test different clustering results until a trajectory is obtained that meets both requirements.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Benchmarking</title>
      <p>To benchmark Totem, we repeated the comprehensive benchmarking of scRNA-seq trajectory inference methods using the dynverse framework (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>). We included trajectories that have a tree-like structure, which were labelled as linear, bifurcation, multifurcation, or tree in the original comparison. These comprise 69, 44, 16, and 87 linear, bifurcation, multifurcation, and tree trajectories, respectively. The datasets are of synthetic and real origin. The real datasets include 26 gold standard datasets of which ground-truth includes cell types and their differentiation order at the cluster level (discrete pseudotime). The 54 real, silver standard datasets have a ground-truth that includes a continuous or discrete pseudotime. The synthetic, simulated datasets provide the most accurate ground-truth, and they were simulated using four different simulators: dyntoy (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>), dyngen (<xref rid="btad515-B6" ref-type="bibr">Cannoodt <italic toggle="yes">et al.</italic> 2021</xref>), PROSSTT (<xref rid="btad515-B22" ref-type="bibr">Papadopoulos <italic toggle="yes">et al.</italic> 2019</xref>), and Splatter (<xref rid="btad515-B33" ref-type="bibr">Zappia <italic toggle="yes">et al.</italic> 2017</xref>).</p>
      <p>The dynverse benchmarking framework includes four main metrics. The accuracy of the cell differentiation order is measured using the correlation of pairwise geodesic distances between the ground-truth and predicted trajectories. The accuracy of the differentially expressed genes is measured using the weighted correlation of the random forest regression-derived feature importance lists. The features that are ranked higher in the ground-truth are given a relatively higher weight. The F1 branches value maps the cells to the closest branching points in the ground-truth and inferred trajectories and measures the clustering similarity between the two clustering results. Hamming-Ipsen-Mikhailov (HIM) (<xref rid="btad515-B16" ref-type="bibr">Jurman <italic toggle="yes">et al.</italic> 2015</xref>) measures the similarity of two topologies. For example, two linear trajectories would yield a perfect HIM value of 1, even if the two trajectories would be otherwise completely dissimilar. All four metrics range from 0 to 1 and the geometric mean of the metrics is used to assess the overall performance by penalizing small values in the metrics.</p>
      <p>To benchmark Totem, we compared it with the dynverse implementation of the Slingshot method, which uses PAM (<italic toggle="yes">k</italic>-medoids) clustering algorithm and ASW to select the optimal number of clusters, as well as TinGa, which is based on a GNG model (<xref rid="btad515-B10" ref-type="bibr">Fritzke 1994</xref>). However, the preprocessing was standardized so that each method uses the 5-dimensional LMDS, which is the default feature extraction method of TinGa. All three methods also allow to choose how to perform the normalization, feature selection, and feature extraction steps.</p>
      <p>The vanilla version of Slingshot available at Bioconductor takes as input a low-dimensional embedding, such as principal components or UMAP dimensions, and a clustering. There are no requirements for using a certain type of clustering or embedding. Slingshot models the trajectory topology as an MST and fits one or multiple principal curves, depending on how many lineages there are, using one of the clusters as the starting point. The distances between the clusters are calculated using a Mahalanobis-like distance metric, which can also be changed to a mutual nearest neighbour (MNN) based metric or the Euclidean distance metric. If no starting cluster is specified by the user, Slingshot selects one so that the number of shared clusters between the lineages is maximized before the first branching point.</p>
      <p>In total, the GNG algorithm of TinGa has eight parameters in addition to the input embedding for which the trajectory is inferred. Of the eight GNG-related parameters, the maximum number of nodes (by default, 30) can be decreased if the trajectory has too many milestones (cell types, clusters) in the network. The maximum number of iterations (by default, 10 000) should not be tuned as the high iteration count ensures that the GNG algorithm converges. The six remaining parameters control how sensitively the graph nodes are linked and changed during the iteration, and their adjustment should be considered if tuning the maximum number of nodes does not improve the result. The original article of TinGa mentions that especially adjustment of the two epsilon parameters (<inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ε</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ε</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) affects the performance.</p>
    </sec>
    <sec>
      <title>2.3 Comparing clustering selection methods</title>
      <p>Trajectory inference methods such as Slingshot require a clustering that is used as the basis for constructing the MST, which is subsequently smoothed using the simultaneous principal curves algorithm to obtain a directed trajectory and pseudotime. In addition to the cell connectivity criterion of Totem for clustering selection, we tested three other methods: ASW, which is used by the dynverse implementation of Slingshot; VRC; and the random criterion that ranks the clustering results into a random order.</p>
      <p>To compare the clustering selection methods, we ran the <italic toggle="yes">k</italic>-medoids clustering algorithm (CLARA) 10 000 times for each dataset, selected the top 100 clustering results with each method, performed the trajectory inference using Slingshot for each clustering, and ran the dynverse performance evaluation for the trajectories. For each benchmark dataset, we varied the number of evaluated trajectories from 1 to 100 and calculated the maximum and mean of the overall performance score. Finally, we calculated the mean of the overall scores across the datasets.</p>
    </sec>
    <sec>
      <title>2.4 Robustness of Totem</title>
      <p>We investigated how robust the performance of Totem is with respect to its parameters: the number of clustering results (by default, 10 000) and the range of the <italic toggle="yes">k</italic> values (by default, from 2 to 20) from which the number of clusters is sampled with replacement. We randomly selected 10 datasets from the top 50 datasets with the highest overall score in the benchmark (names listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). For each of the 10 datasets, we ran Totem with different combinations of the number of clusterings (100, 500, 1000, 2500, 5000, 7500) and the upper limit of the <italic toggle="yes">k</italic> range (5, 10, 15, 20, 30, 40). For each parameter configuration and dataset, we ran Totem 10 times using different random seeds. We calculated the dynverse overall score between the inferred and ground-truth trajectories (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Benchmarking Totem for trajectory inference</title>
      <p>To benchmark Totem, we used the dynverse benchmarking framework (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>) that includes 216 tree-shaped trajectories. In our comparison, we included the dynverse implementation of Slingshot (<xref rid="btad515-B28" ref-type="bibr">Street <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>), which uses ASW for clustering selection, and TinGa, which is a GNG-based method (<xref rid="btad515-B10" ref-type="bibr">Fritzke 1994</xref>) that can also predict more complex trajectories than tree-shaped, such as acyclic and disconnected trajectories (<xref rid="btad515-B29" ref-type="bibr">Todorov <italic toggle="yes">et al.</italic> 2020</xref>).</p>
      <p>As shown in the rightmost panel of <xref rid="btad515-F2" ref-type="fig">Fig. 2</xref>, Totem achieved superior overall scores (Friedman test; Bonferroni-adjusted <italic toggle="yes">P</italic>-value ≤ 0.001; Wilcoxon signed-rank test; Bonferroni-adjusted <italic toggle="yes">P</italic>-value ≤ 0.01) for datasets with a nonlinear trajectory (bifurcating, multifurcating, or other nonlinear tree), whereas TinGa was the second-best method for the nonlinear datasets. The violin plots also show that Totem’s distribution of the overall scores with the nonlinear trajectories was more concentrated to higher performance levels compared to TinGa and Slingshot. For linear trajectories, Slingshot achieved superior performance among the tested methods (Friedman test; Bonferroni-adjusted <italic toggle="yes">P</italic>-value ≤ 0.001; Wilcoxon signed-rank test; Bonferroni-adjusted <italic toggle="yes">P</italic>-value ≤ 0.05), while the overall scores of the linear datasets were, on average, similar for TinGa and Totem. The difference in the overall performance was mainly attributable to the differences in the topology accuracy (HIM) and the accuracy of the cell assignment onto the branches (F1 branches). The HIM score of Slingshot was close to perfect for most of the linear datasets but worse compared to TinGa and Totem for the nonlinear datasets.</p>
      <fig position="float" id="btad515-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Results of the benchmarking for trajectory inference from scRNA-seq data. The overall score is the geometric mean of four performance metrics: the correlation of geodesic distances (correlation), which measures accuracy of cellular ordering, the Hamming-Ipsen-Mikhailov (HIM), which measures topological accuracy, the weighted correlation of feature importance lists, which measures accuracy of differentially expressed genes inferred from the trajectory, and the F1 branches, which measures accuracy of cell assignment onto branches. The results were grouped by the performance metric (columns) and whether the ground-truth topology is linear or nonlinear, i.e. bifurcating, multifurcating, or some other nonlinear tree (rows).</p>
        </caption>
        <graphic xlink:href="btad515f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Benchmarking Totem for clustering selection</title>
      <p>Selection of an appropriate clustering for constructing the MST is an important step in the trajectory inference process. Therefore, we took a closer look at the clustering selection step to investigate which clustering selection approach gives the best results when we consider multiple top-ranking trajectories simultaneously. We included two popular clustering selection methods, ASW and VRC, as well as the Totem method that uses cell connectivity and VRC, and also a method that ranks the clustering results into a random order (Random).</p>
      <p>When we tested multiple top-ranking clustering results and always selected the trajectory that gave the best performance in the evaluation, the result suggested that the random criterion gave the best performance (<xref rid="btad515-F3" ref-type="fig">Fig. 3A</xref>). This is an expected result considering that the random criterion generates more dissimilar trajectories than the other methods. However, when we averaged the performance values of the multiple top trajectories (<xref rid="btad515-F3" ref-type="fig">Fig. 3B</xref>), the random criterion was the worst-performing method, as expected. ASW achieved the worst performance among the methods in the analysis in which we selected the best-performing trajectory, and it was the second-worst method when the performance values of the trajectories were averaged. VRC achieved slightly better performance than ASW when selecting the best-performing trajectory, and it was tied with the Totem method as the best method by the average performance. In addition to good average performance, Totem had a relatively high-performance curve in the analysis that considers the performance of the best-performing trajectories, similar with the random criterion. In other words, the selection method of Totem enables to find better performing trajectories than the ASW and VRC without sacrificing as much on the average performance as the random criterion.</p>
      <fig position="float" id="btad515-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Comparing clustering selection methods in the dynverse benchmarking. We selected the top 100 clusterings from 10 000 k-medoids clusterings for each of the 216 dynverse benchmark datasets using four different methods: the average silhouette width (ASW), the variance ratio criterion (VRC), random selection, and the Totem method. For each clustering, the rest of the trajectory inference (Minimum Spanning Tree generation, smoothing) was performed using Slingshot. In (A), we varied the number of top-ranking trajectory models and selected the model for each dataset that gave the best overall score from all the models. In (B), we calculated the mean performance of all the models.</p>
        </caption>
        <graphic xlink:href="btad515f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Examples of trajectory inference with Totem</title>
      <p>To demonstrate the utility of Totem in practice, we considered two datasets from the dynbenchmark database. The datasets meet the prerequisites of Totem: they have a tree-shaped topology with a single starting point and no disconnected parts. Importantly, the cell types of the two datasets are connected in the correct way in their low-dimensional embeddings, in this case 5-dimensional LMDS, a property that generally hinders trajectory inference of many of the dynverse benchmark datasets irrespective of the trajectory method used.</p>
      <p>In the first example, we compared the trajectories (<xref rid="btad515-F4" ref-type="fig">Fig. 4A</xref>) produced by Totem, Slingshot and TinGa for a simulated dataset that has a multifurcating trajectory (named multifurcating_4 in the dynverse benchmark data repository). With Slingshot, we used the ground-truth clustering of the simulated dataset as input. The MST produced by Slingshot was linear and did not correlate well with the true milestone network. The example shows how Slingshot can still produce inaccurate trajectories even if the ground-truth clustering is available because the cluster distances generate an MST with a wrong network. Similarly, TinGa’s trajectory for the dataset was inaccurate because the multifurcation was not symmetrical. In contrast, Totem predicted trajectories that correlated well with the true milestone network. In addition, the cell connectivity measure of Totem provided, in general, accurate information about the location of the end points and the middle branching point.</p>
      <fig position="float" id="btad515-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Example analyses with Slingshot, Totem, and TinGa. (A) A multifurcating trajectory simulated with dyntoy. (B) T cells from a mouse thymus with a bifurcating trajectory. The two-dimensional embeddings for visualization were generated with the Multi-Dimensional Scaling (MDS) method from the dyndimred R package.</p>
        </caption>
        <graphic xlink:href="btad515f4" position="float"/>
      </fig>
      <p>The second example (<xref rid="btad515-F4" ref-type="fig">Fig. 4B</xref>) shows similar results but for a bifurcating trajectory that includes T cells from a mouse thymus (<xref rid="btad515-B12" ref-type="bibr">Han <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>). Based on the trajectory inferred by Slingshot, the topology of this network could be linear, i.e. the starting point would be one of the end nodes, or bifurcating, i.e. the starting point would be one of the middle nodes, if we have no knowledge about the starting point of the trajectory. By selecting a trajectory with Totem that is in line with the cell connectivity profile of the data, we obtain a trajectory with the correct topology (bifurcating), where the bifurcation point is at the node in the middle, from which the bifurcation starts in the ground-truth trajectory. Both of these examples demonstrate, how the cell connectivity helped us to choose trajectories that exhibit the correct topology. TinGa’s trajectory for this dataset was inaccurate because the two end points of the bifurcation were connected.</p>
    </sec>
    <sec>
      <title>3.4 Robustness of Totem</title>
      <p>We investigated the robustness of Totem to its parameters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S2 and S3</xref>). The results show that the robustness of Totem improved when the number of clusterings increased (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>), and the variation was small when the number of clusterings was over 2500 (5000 or 7500). However, the upper limit of the cluster number range did not have a clear impact on the robustness, but it did affect the average performance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). The lowest average performance was achieved when the upper limit of the cluster number range was only five (by default, 20), but otherwise the average performance was robust regardless of the upper limit of the number of clusters.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>While a large number of trajectory inference methods has been developed (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>) for constructing trajectories from single-cell data through mathematical modelling, the usability of these methods remains rather poor. One main reason is that the methods do not work optimally with every dataset, requiring the users to try different methods, tune the parameters, and adjust the preprocessing steps prior to trajectory inference. Oftentimes, the parameter tuning requires detailed knowledge of the underlying statistical and machine learning models, which many users are not familiar with, and the manuals of trajectory inference tools often do not provide clear instructions on how the parameters should be adjusted.</p>
    <p>In this article, we introduced Totem, a tool designed to facilitate the inference of tree-shaped trajectories from single-cell data. Totem generates a large number of clustering results (by default, 10 000) with the <italic toggle="yes">k</italic>-medoids algorithm and calculates the cell connectivity measure, which acts as a useful baseline for finding the optimal trajectory. In our examples, we showed how the cell connectivity enabled us to select clustering results that generated accurate trajectories. Other trajectory inference methods, such as Slingshot (<xref rid="btad515-B28" ref-type="bibr">Street <italic toggle="yes">et al.</italic> 2018</xref>) and TinGa (<xref rid="btad515-B29" ref-type="bibr">Todorov <italic toggle="yes">et al.</italic> 2020</xref>), do not provide a metric like the cell connectivity that can be used as a reference to guide trajectory inference. With these methods the user needs to instead use the visualization to get a sense of the topology, use biological markers to ensure the model is biologically sensible, and change the parameters if the trajectory is not satisfactory, which can be arduous for users without advanced background in mathematics and machine learning.</p>
    <p>In Slingshot, the between-cluster distances determine the MST and the milestone network. Our examples showed how even when the correct cell types were available, the MSTs predicted by Slingshot could still be inaccurate. One solution is to change the distance method, e.g. to a mutual neighbour-based method, but this will still not necessarily generate the correct network. Totem addresses this issue by providing a user-friendly interface to analyse MSTs generated based on different clustering results. With this interface the user can select an MST that best fits to the biological hypothesis and the cell connectivity profile without time-consuming and arbitrary parameter tuning. Totem then smoothens the MSTs of the selected clustering results using the simultaneous principal curves algorithm of Slingshot to obtain directed trajectories that include pseudotime. The trajectories can be exported as Slingshot or dynwrap objects to be used in downstream analysis, e.g. to perform differential expression analysis using tradeSeq (<xref rid="btad515-B30" ref-type="bibr">Van den Berge <italic toggle="yes">et al.</italic> 2020</xref>) or dyno (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>To benchmark Totem for inferring trajectories from scRNA-seq data, we used the dynverse benchmarking framework, which includes 216 tree-shaped trajectories. We compared Totem with the dynverse implementation of Slingshot and TinGa. Totem outperformed the other two methods for nonlinear trajectories (bifurcation, multifurcation, or some other nonlinear tree) and performed comparably with TinGa for linear trajectories. The results suggested that while Slingshot was the best method for linear trajectories among the tested methods, it was significantly worse than TinGa and Totem for nonlinear trajectories. This happened because ASW is generally known to select a small number of clusters, which will more likely generate a linear trajectory than a nonlinear trajectory when used for MST estimation. In contrast, TinGa is more likely to overcomplicate the trajectories with redundant cycles and disconnected parts than Slingshot and Totem, both of which can only infer tree-shaped trajectories. Indeed, the performance differences between the methods were mainly attributable to differences in the accuracy of the topology (HIM) and branch assignment (F1 branches).</p>
    <p>To investigate what is the most optimal way to select the clustering that is used to generate the MST, we generated 10 000 <italic toggle="yes">k</italic>-medoids clustering results for each of the benchmark datasets and ranked them using different clustering evaluation methods, including ASW, VRC, and a Totem criterion that uses cell connectivity and VRC. When we investigated the performance scores of the top 100 clustering results, the results suggested that the Totem criterion and VRC provided the best average performance. However, the Totem criterion outperformed the VRC when we considered only the best trajectory from the set of trajectories. In other words, when testing multiple trajectories, it is more likely that we find a higher-performing trajectory with Totem than with the ASW and VRC methods, and the average performance of all the trajectories found by Totem will likely be at least as good as for the other methods.</p>
    <p>Totem has the same limitations as Slingshot. In particular, it cannot be used to infer trajectories that have cycles or both diverging (cells diverge from a single point into several lineages) and converging (cells converge into a single point from several lineages) parts at the same time. In addition, unlike the updated Slingshot, Totem cannot currently handle disconnected trajectories. However, we do not consider this a major limitation because determining automatically which cell types belong to which disconnected sub-trajectories is not an easy task (<xref rid="btad515-B8" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2022</xref>). A safer approach is to analyse the disconnected parts as separate trajectories by segregating the cell types manually before trajectory inference. Although there exist methods that can handle almost arbitrary topologies, such as PAGA (<xref rid="btad515-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2019</xref>), Monocle3 (<xref rid="btad515-B7" ref-type="bibr">Cao <italic toggle="yes">et al.</italic> 2019</xref>), and TinGa (<xref rid="btad515-B29" ref-type="bibr">Todorov <italic toggle="yes">et al.</italic> 2020</xref>), their issue is that they are more likely to overcomplicate the trajectory with extra cycles and branches than methods like Slingshot and Totem that are limited to tree-shaped trajectories. Similarly, methods like scShaper (<xref rid="btad515-B27" ref-type="bibr">Smolander <italic toggle="yes">et al.</italic> 2021</xref>), SCORPIUS (<xref rid="btad515-B4" ref-type="bibr">Cannoodt 2016</xref>), and Elpilinear (<xref rid="btad515-B1" ref-type="bibr">Albergante <italic toggle="yes">et al.</italic> 2020</xref>) that are limited to linear trajectories are still useful because they are guaranteed to provide the correct topology if the trajectory is expected to be linear, unlike the more complex methods.</p>
    <p>An important consideration is how to perform the upstream analysis steps prior to trajectory inference, including quality control, normalization, and dimensionality reduction. The choice of the normalization method has been shown to affect the cell types that can be identified from single-cell data (<xref rid="btad515-B11" ref-type="bibr">Hafemeister and Satija 2019</xref>), and consequently the trajectory should also change to reflect the varying level of cell heterogeneity. Similarly, the choice of the feature selection and feature extraction methods can have an impact on the identifiable cell types. If analysing data with batch effects, the method used for data integration can also affect the composition of identifiable cell types (<xref rid="btad515-B17" ref-type="bibr">Luecken <italic toggle="yes">et al.</italic> 2022</xref>). Therefore, robustness to the upstream analysis steps should generally not be an objective of trajectory inference. Trajectory inference methods assume that the global distances between the cell types in the low-dimensional embeddings, such as principal components or UMAP dimensions, can be used to model the correct topology. If the correct topology cannot be inferred based on the cell type distances in the embeddings, alternative upstream analysis steps such as embedding refinement should be considered (<xref rid="btad515-B21" ref-type="bibr">Pandey and Zafar 2022</xref>).</p>
    <p>In some cases, it is possible that the optimal trajectory, the one that is in line with the cell connectivity profile, is not readily obtainable from the top-ranking clustering results. This can happen when some cell types are extremely rare and some cell types are highly numerous. This cell number deviation makes it more difficult for the k-medoids to find a clustering result that creates the correct trajectory topology. To alleviate this issue, Totem’s vignette explains that in situations such as these, it is a good idea to increase the number of clusters so that the rare cell types are captured in the clustering. If some of the highly numerous cell types are overclustered, these cell types can be merged using a function implemented in the Totem R package. This approach requires slightly more manual work but will guarantee a clustering that matches the cell connectivity profile.</p>
    <p>As a potential future direction in Totem’s development, the discrete cluster-level connectivity values could be turned into more precise, cell-level connectivity values by measuring the distance of each cell from the central/mass point of the cluster. However, the current implementation of Totem can also model the cell connectivity at the single-cell level by aggregating the connectivity vectors of a large number of clustering results (by default, 10 000) using the arithmetic mean. In our analyses, the arithmetic mean provided a continuous connectivity gradient, as opposed to the median-based approach.</p>
    <p>To summarize, Totem is a tool designed to facilitate the inference of tree-shaped trajectories from single-cell data. It is built upon the popular Slingshot method, which uses a clustering to construct an MST and the simultaneous principal curves algorithm to obtain a directed trajectory along with pseudotime that quantifies cell differentiation at the single-cell level. The benefit of Totem over the available tools is that it is designed to provide a user-friendly interface for finding a clustering that is used as the basis of the trajectory. Although the clustering selection is highly critical for the success of the trajectory inference, performing it automatically in a way that will generate the correct milestone network in the trajectory remains challenging. To address this challenge, the analysis of different clustering results and their MSTs with Totem has been designed to be fast and easy without requiring complex parameter tuning and in-depth technical knowledge. As a notable difference compared to existing trajectory inference methods, Totem provides the cell connectivity measure, which aids the trajectory optimization by providing information about the location of the branching points and milestone transitions.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad515_Supplementary_Data</label>
      <media xlink:href="btad515_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>The authors thank the Elo lab for fruitful discussions and comments on the manuscript.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>L.L.E. reports grants from the European Research Council ERC [677943]; European Union's Horizon 2020 research and innovation programme [955321]; Academy of Finland [310561, 314443, 329278, 335434, 335611, 341342]; Sigrid Juselius Foundation, during the conduct of the study. This work was also supported by Turku Graduate School (UTUGS); Biocenter Finland; ELIXIR Finland.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The benchmark data are available on Zenodo (<xref rid="btad515-B5" ref-type="bibr">Cannoodt <italic toggle="yes">et al.</italic> 2018</xref>). The Totem R package is available at <ext-link xlink:href="https://github.com/elolab/Totem" ext-link-type="uri">https://github.com/elolab/Totem</ext-link>, and it includes a vignette that explains how Totem should be used. The codes that are relevant for repeating the benchmarking are available at <ext-link xlink:href="https://github.com/elolab/Totem-benchmarking" ext-link-type="uri">https://github.com/elolab/Totem-benchmarking</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad515-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Albergante</surname><given-names>L</given-names></string-name>, <string-name><surname>Mirkes</surname><given-names>E</given-names></string-name>, <string-name><surname>Bac</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Robust and scalable learning of complex intrinsic dataset geometry via ElPiGraph</article-title>. <source>Entropy</source><year>2020</year>;<volume>22</volume>:<fpage>296</fpage>.<pub-id pub-id-type="pmid">33286070</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>36</volume>:<fpage>411</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Calinski</surname><given-names>T</given-names></string-name>, <string-name><surname>Harabasz</surname><given-names>J.</given-names></string-name></person-group><article-title>A dendrite method for cluster analysis</article-title>. <source>Comm Stat Theory Methods</source><year>1974</year>;<volume>3</volume>:<fpage>1</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Cannoodt</surname><given-names>R.</given-names></string-name></person-group> SCORPIUS improves trajectory inference and identifies novel modules in dendritic cell development. bioRxiv, <year>2016</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad515-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Cannoodt</surname><given-names>R</given-names></string-name>, <string-name><surname>Saelens</surname><given-names>W</given-names></string-name>, <string-name><surname>Todorov</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal> Single-cell-omics datasets containing a trajectory. <italic toggle="yes">Zenodo</italic>. <year>2018</year>. <pub-id pub-id-type="doi">10.5281/zenodo.1443566</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad515-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cannoodt</surname><given-names>R</given-names></string-name>, <string-name><surname>Saelens</surname><given-names>W</given-names></string-name>, <string-name><surname>Deconinck</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Spearheading future omics analyses using dyngen, a multi-modal simulator of single cells</article-title>. <source>Nat Commun</source><year>2021</year>;<volume>12</volume>:<fpage>3942</fpage>.<pub-id pub-id-type="pmid">34168133</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>J</given-names></string-name>, <string-name><surname>Spielmann</surname><given-names>M</given-names></string-name>, <string-name><surname>Qiu</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title>. <source>Nature</source><year>2019</year>;<volume>566</volume>:<fpage>496</fpage>–<lpage>502</lpage>.<pub-id pub-id-type="pmid">30787437</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>W</given-names></string-name>, <string-name><surname>Guillaume-Gentil</surname><given-names>O</given-names></string-name>, <string-name><surname>Rainer</surname><given-names>PY</given-names></string-name></person-group><etal>et al</etal><article-title>Live-seq enables temporal transcriptomic recording of single cells</article-title>. <source>Nature</source><year>2022</year>;<volume>608</volume>:<fpage>733</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">35978187</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deconinck</surname><given-names>L</given-names></string-name>, <string-name><surname>Cannoodt</surname><given-names>R</given-names></string-name>, <string-name><surname>Saelens</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Recent advances in trajectory inference from single-cell omics data</article-title>. <source>Curr. Opin Syst Biol</source><year>2021</year>;<volume>27</volume>:<fpage>100344</fpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Fritzke</surname><given-names>B.</given-names></string-name></person-group><part-title>A growing neural gas network learns topologies</part-title>. In: <source>Advances in Neural Information Processing Systems</source>. Cambridge, MA: <publisher-name>MIT Press</publisher-name><year>1995</year>.</mixed-citation>
    </ref>
    <ref id="btad515-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hafemeister</surname><given-names>C</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group><article-title>Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>296</fpage>.<pub-id pub-id-type="pmid">31870423</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>X</given-names></string-name>, <string-name><surname>Wang</surname><given-names>R</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Mapping the mouse cell atlas by Microwell-Seq</article-title>. <source>Cell</source><year>2018</year>;<volume>172</volume>:<fpage>1091</fpage>–<lpage>107.e17</lpage>.<pub-id pub-id-type="pmid">29474909</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hastie</surname><given-names>T</given-names></string-name>, <string-name><surname>Stuetzle</surname><given-names>W.</given-names></string-name></person-group><article-title>Principal curves</article-title>. <source>J Am Stat Assoc</source><year>1989</year>;<volume>84</volume>:<fpage>502</fpage>–<lpage>16</lpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ilicic</surname><given-names>T</given-names></string-name>, <string-name><surname>Kim</surname><given-names>JK</given-names></string-name>, <string-name><surname>Kolodziejczyk</surname><given-names>AA</given-names></string-name></person-group><etal>et al</etal><article-title>Classification of low quality cells from single-cell RNA-seq data</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>29</fpage>.<pub-id pub-id-type="pmid">26887813</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Jurman</surname><given-names>G</given-names></string-name>, <string-name><surname>Visintainer</surname><given-names>R</given-names></string-name>, <string-name><surname>Filosi</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal> The HIM glocal metric and kernel for network comparison and classification. In: <italic toggle="yes">2015 IEEE International Conference on Data Science and Advanced Analytics (DSAA).</italic> IEEE, <year>2015</year>, <fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B24">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kaufman</surname><given-names>L</given-names></string-name>, <string-name><surname>Rousseeuw</surname><given-names>PJ.</given-names></string-name></person-group><part-title>Clustering large applications (program CLARA)</part-title>. In: <source>Finding Groups in Data</source>. New York: <publisher-name>John Wiley &amp; Sons</publisher-name><year>1990</year>, <fpage>126</fpage>–<lpage>163</lpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luecken</surname><given-names>MD</given-names></string-name>, <string-name><surname>Büttner</surname><given-names>M</given-names></string-name>, <string-name><surname>Chaichoompu</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Benchmarking atlas-level data integration in single-cell genomics</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>41</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">34949812</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maaten</surname><given-names>L</given-names></string-name>, <string-name><surname>van der Hinton</surname><given-names>G.</given-names></string-name></person-group><article-title>Visualizing data using t-SNE</article-title>. <source>J Mach Learn Res</source><year>2008</year>;<volume>9</volume>:<fpage>2579</fpage>–<lpage>605</lpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B20">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Melville</surname><given-names>J.</given-names></string-name></person-group> UMAP: uniform manifold approximation and projection for dimension reduction. arXiv preprint, arXiv:1802.03426, <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="btad515-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pandey</surname><given-names>K</given-names></string-name>, <string-name><surname>Zafar</surname><given-names>H.</given-names></string-name></person-group><article-title>Inference of cell state transitions and cell fate plasticity from single-cell with MARGARET</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>e86</fpage>.<pub-id pub-id-type="pmid">35639499</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Papadopoulos</surname><given-names>N</given-names></string-name>, <string-name><surname>Gonzalo</surname><given-names>PR</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>PROSSTT: probabilistic simulation of single-cell RNA-seq data for complex differentiation processes</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>3517</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30715210</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paradis</surname><given-names>E</given-names></string-name>, <string-name><surname>Schliep</surname><given-names>K.</given-names></string-name></person-group><article-title>ape 5.0: an environment for modern phylogenetics and evolutionary analyses in R</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>526</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30016406</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rousseeuw</surname><given-names>PJ.</given-names></string-name></person-group><article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>. <source>J Comput Appl Math</source><year>1987</year>;<volume>20</volume>:<fpage>53</fpage>–<lpage>65</lpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saelens</surname><given-names>W</given-names></string-name>, <string-name><surname>Cannoodt</surname><given-names>R</given-names></string-name>, <string-name><surname>Todorov</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>A comparison of single-cell trajectory inference methods</article-title>. <source>Nat Biotechnol</source><year>2019</year>;<volume>37</volume>:<fpage>547</fpage>–<lpage>54</lpage>.<pub-id pub-id-type="pmid">30936559</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smolander</surname><given-names>J</given-names></string-name>, <string-name><surname>Junttila</surname><given-names>S</given-names></string-name>, <string-name><surname>Venäläinen</surname><given-names>MS</given-names></string-name></person-group><etal>et al</etal><article-title>scShaper: an ensemble method for fast and accurate linear trajectory inference from single-cell RNA-seq data</article-title>. <source>Bioinformatics</source><year>2022</year>;38(5):<fpage>1328</fpage>–<lpage>1335</lpage>.<pub-id pub-id-type="pmid">34888622</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Street</surname><given-names>K</given-names></string-name>, <string-name><surname>Risso</surname><given-names>D</given-names></string-name>, <string-name><surname>Fletcher</surname><given-names>RB</given-names></string-name></person-group><etal>et al</etal><article-title>Slingshot: cell lineage and pseudotime inference for single-cell transcriptomics</article-title>. <source>BMC Genomics</source><year>2018</year>;<volume>19</volume>:<fpage>477</fpage>.<pub-id pub-id-type="pmid">29914354</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Todorov</surname><given-names>H</given-names></string-name>, <string-name><surname>Cannoodt</surname><given-names>R</given-names></string-name>, <string-name><surname>Saelens</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>TinGa: fast and flexible trajectory inference with growing neural gas</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>i66</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">32657409</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van den Berge</surname><given-names>K</given-names></string-name>, <string-name><surname>Roux de Bézieux</surname><given-names>H</given-names></string-name>, <string-name><surname>Street</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Trajectory-based differential expression analysis for single-cell sequencing data</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>1201</fpage>.<pub-id pub-id-type="pmid">32139671</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Hamey</surname><given-names>FK</given-names></string-name>, <string-name><surname>Plass</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>PAGA: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>59</fpage>.<pub-id pub-id-type="pmid">30890159</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ</given-names></string-name></person-group><etal>et al</etal><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source><year>2018</year>;<volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zappia</surname><given-names>L</given-names></string-name>, <string-name><surname>Phipson</surname><given-names>B</given-names></string-name>, <string-name><surname>Oshlack</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>. <source>Genome Biol</source><year>2017</year>;<volume>18</volume>:<fpage>174</fpage>.<pub-id pub-id-type="pmid">28899397</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10474950</article-id>
    <article-id pub-id-type="pmid">37624916</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad515</article-id>
    <article-id pub-id-type="publisher-id">btad515</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Cell-connectivity-guided trajectory inference from single-cell data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3872-9668</contrib-id>
        <name>
          <surname>Smolander</surname>
          <given-names>Johannes</given-names>
        </name>
        <aff><institution>Turku Bioscience Centre, University of Turku and Åbo Akademi University</institution>, 20520 Turku, <country country="FI">Finland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3754-5584</contrib-id>
        <name>
          <surname>Junttila</surname>
          <given-names>Sini</given-names>
        </name>
        <aff><institution>Turku Bioscience Centre, University of Turku and Åbo Akademi University</institution>, 20520 Turku, <country country="FI">Finland</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Elo</surname>
          <given-names>Laura L</given-names>
        </name>
        <aff><institution>Turku Bioscience Centre, University of Turku and Åbo Akademi University</institution>, 20520 Turku, <country country="FI">Finland</country></aff>
        <aff><institution>Institute of Biomedicine, University of Turku</institution>, 20520 Turku, <country country="FI">Finland</country></aff>
        <xref rid="btad515-cor1" ref-type="corresp"/>
        <!--laura.elo@utu.fi-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad515-cor1">Corresponding author. Turku Bioscience Centre, University of Turku and Åbo Akademi University, Tykistökatu 6, 20520 Turku, Finland. E-mail: <email>laura.elo@utu.fi</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-25">
      <day>25</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>9</issue>
    <elocation-id>btad515</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>13</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>02</day>
        <month>9</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad515.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-cell RNA-sequencing enables cell-level investigation of cell differentiation, which can be modelled using trajectory inference methods. While tremendous effort has been put into designing these methods, inferring accurate trajectories automatically remains difficult. Therefore, the standard approach involves testing different trajectory inference methods and picking the trajectory giving the most biologically sensible model. As the default parameters are often suboptimal, their tuning requires methodological expertise.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce Totem, an open-source, easy-to-use R package designed to facilitate inference of tree-shaped trajectories from single-cell data. Totem generates a large number of clustering results, estimates their topologies as minimum spanning trees, and uses them to measure the connectivity of the cells. Besides automatic selection of an appropriate trajectory, cell connectivity enables to visually pinpoint branching points and milestones relevant to the trajectory. Furthermore, testing different trajectories with Totem is fast, easy, and does not require in-depth methodological knowledge.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Totem is available as an R package at <ext-link xlink:href="https://github.com/elolab/Totem" ext-link-type="uri">https://github.com/elolab/Totem</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council ERC</institution>
          </institution-wrap>
        </funding-source>
        <award-id>677943</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union's Horizon 2020 research and innovation programme</institution>
          </institution-wrap>
        </funding-source>
        <award-id>955321</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Academy of Finland</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002341</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>310561</award-id>
        <award-id>314443</award-id>
        <award-id>329278</award-id>
        <award-id>335434</award-id>
        <award-id>335611</award-id>
        <award-id>341342</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA-sequencing (scRNA-seq) enables researchers to quantify the transcriptome of thousands or even millions of cells simultaneously at the single-cell level. The cells in a tissue undergo transcriptomic changes that are part of biological processes. If the changes happen gradually, the tissue contains cells derived from different stages of the process. If a correct trajectory that accurately models these different stages can be generated from the scRNA-seq data, this enables researchers to unravel the transcriptomic mechanisms of the processes. The modelling of trajectories from scRNA-seq data has formed a new branch in computational biology, known as trajectory inference.</p>
    <p>A vast number of trajectory inference methods has been developed (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad515-B9" ref-type="bibr">Deconinck <italic toggle="yes">et al.</italic> 2021</xref>). While these methods have proven to be valuable in many situations, their use is still difficult for several reasons. The main reason is that a single method used with default settings often fails to generate a trajectory that can capture all relevant parts (milestones) of the trajectory and also accurately model the correct milestone network. Therefore, a popular approach is to test different methods and tune their parameters until a biologically sensible or otherwise satisfactory trajectory is obtained.</p>
    <p>Slingshot (<xref rid="btad515-B28" ref-type="bibr">Street <italic toggle="yes">et al.</italic> 2018</xref>) has become one of the most popular trajectory inference methods after a comparison study (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>) showed it was one of the best-performing methods for inferring tree-shaped trajectories. A tree can be any trajectory in which the parts are not disconnected and the trajectory has no cycles. Slingshot requires as input a clustering of cells that is used to construct a Minimum Spanning Tree (MST), which is subsequently smoothed using the simultaneous principal curves algorithm to obtain a directed trajectory, which also includes pseudotime, a measure of the differentiation stage of the cells. While methods such as the Average Silhouette Width (ASW) (<xref rid="btad515-B25" ref-type="bibr">Rousseeuw 1987</xref>) and the Variance Ratio Criterion (VRC) (<xref rid="btad515-B3" ref-type="bibr">Caliński and Harabasz 1974</xref>) can be used to select the clustering automatically, their weakness is in their tendency to select a clustering with an overly small number of clusters. The resulting trajectories are often over-simplistic and lack especially small milestones. Therefore, a more reliable approach can be to manually generate a clustering that includes all the relevant milestones, but this requires careful parameter testing and validation using markers to ensure that the clustering is optimal. However, even then the resulting MST may not correlate well with the true milestone network because the MST is generated using a distance matrix that is sensitive to the preprocessing steps (e.g. dimensionality reduction), the clustering structure, and the choice of the distance metric.</p>
    <p>To provide a system with better user experience for researchers who perform trajectory inference, we developed a new tool, Totem, for the inference of tree-shaped trajectories from single-cell data (<xref rid="btad515-F1" ref-type="fig">Fig. 1</xref>). Totem generates a large number of dissimilar clustering results for the cells (by default, 10 000) using a <italic toggle="yes">k</italic>-medoids algorithm. The number of clusters (<italic toggle="yes">k</italic>) and the structure of the clustering results vary, generating vastly different trajectories when used as the basis for constructing the MST. To select a clustering from the large set of clustering results, Totem uses a new measure called cell connectivity, which is based on counting the number of edges (connections) between the clusters in an MST. The ratio of the number of edges and clusters (connectivity) is calculated for each cell and clustering, and the connectivity vectors are averaged to obtain the cell connectivity of the cells. The cell connectivity acts as a useful baseline for selecting an appropriate trajectory and deciding which milestones to include in the trajectory, while also helping to give a visual overview of the milestone network, i.e. how the milestones are connected and where the branching points and leaf nodes are located. Importantly, a key feature of Totem for its usability is that it allows to quickly and easily browse different MSTs, from which the user can select one or several MSTs for further analysis.</p>
    <fig position="float" id="btad515-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Schematic illustration of the Totem workflow. (1) A gene expression matrix is used as input, which needs to be preprocessed upstream of Totem analysis, including normalization, quality control, and possible batch correction and feature selection. Further dimensionality reduction (feature extraction) can also be performed using Totem. For the low-dimensional data matrix, Totem generates (2) a large set of clustering results using a <italic toggle="yes">k</italic>-medoids clustering algorithm (CLARA), (3) a Minimum Spanning Tree (MST) for each clustering, which models the cluster (milestone) network, and (4) estimates the connectivity of the clusters in each MST (ratio of the number of edges a cluster has in MST and the number of clusters). The connectivity vectors are averaged to generate the cell connectivity measure (top right), which helps to locate branching points and milestones that are relevant to model. (5) The clustering results are ranked based on the Variance Ratio Criterion (VRC) of the cell connectivity measure, and (6) top-ranking clustering results and their corresponding MSTs are selected for further analysis (middle-right). (7) The selected MSTs are smoothed using the Slingshot algorithm to obtain directed trajectories (lower right). The trajectory can be exported as objects that can be used downstream of Totem analysis, such as differential expression analysis.</p>
      </caption>
      <graphic xlink:href="btad515f1" position="float"/>
    </fig>
    <p>To benchmark Totem, we performed a comprehensive comparison using the dynverse benchmarking framework (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>), which comprises over 200 tree-shaped trajectories. We compared Totem with the popular Slingshot tool (<xref rid="btad515-B28" ref-type="bibr">Street <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>) and the more recently introduced TinGa (<xref rid="btad515-B29" ref-type="bibr">Todorov <italic toggle="yes">et al.</italic> 2020</xref>), which is based on a growing neural gas (GNG) model (<xref rid="btad515-B10" ref-type="bibr">Fritzke 1994</xref>) and can also model trajectories that are more complex than trees. In particular, to evaluate the performance of the connectivity-based criterion of Totem for clustering selection in trajectory inference, we compared it with the popular ASW and VRC clustering selection methods. Because a single clustering is rarely optimal, and thus the users are often forced to try multiple clustering results to optimize the trajectories, we investigated the performance of the trajectories generated based on multiple top-ranked clustering results, giving a deeper overview of the performance. Finally, we demonstrate the usefulness of the cell connectivity measure with a few examples that show how the measure can aid trajectory inference by helping to pinpoint relevant branching points and milestones.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Totem</title>
      <p>In the following subsections, we go through the main steps of Totem trajectory inference workflow. <xref rid="btad515-F1" ref-type="fig">Figure 1</xref> illustrates the basic workflow of Totem.</p>
      <sec>
        <title>2.1.1 Upstream analysis</title>
        <p>Upstream of trajectory inference, Totem assumes that the input gene expression matrix has been normalized and quality control has been performed to remove bad-quality cells (<xref rid="btad515-B15" ref-type="bibr">Ilicic <italic toggle="yes">et al.</italic> 2016</xref>). scRNA-seq data analysis toolkits like Seurat (<xref rid="btad515-B2" ref-type="bibr">Butler <italic toggle="yes">et al.</italic> 2018</xref>) and Scanpy (<xref rid="btad515-B32" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>) can perform the normalization and quality control.</p>
        <p>Trajectory inference methods require a low-dimensional (from 2 to 50) embedding as input. The dimensionality reduction steps can be customized as the user sees best prior to Totem analysis, but Totem can also be used to transform gene counts into new features (feature extraction) with functions that utilize the dyndimred R package. In scRNA-seq data analysis, the most common way to perform feature extraction is the Principal Component Analysis (PCA) in which the number of principal components typically varies from 10 to 30. Alternatively, methods like Multi-Dimensional Scaling (MDS) or the more scalable landscape MDS (LMDS) can be used to generate an embedding with a smaller number of dimensions (e.g. from 2 to 5), which is usually not a sufficient number in PCA of scRNA-seq data. <italic toggle="yes">t</italic>-distributed stochastic neighbour embedding (<italic toggle="yes">t</italic>-SNE) (<xref rid="btad515-B18" ref-type="bibr">Maaten and van der Hinton 2008</xref>) and Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP) (<xref rid="btad515-B20" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic> 2018</xref>) are commonly used only for visualization, and they should be used with caution if used as input in trajectory inference. As the default dimensionality reduction method in Totem, we use the 5-dimensional LMDS. Moreover, it is generally a good idea to reduce the number of features prior to feature extraction by selecting highly variable genes (HVGs), which can be performed using methods like Seurat (<xref rid="btad515-B2" ref-type="bibr">Butler <italic toggle="yes">et al.</italic> 2018</xref>) and Scanpy (<xref rid="btad515-B32" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>). If the dataset has batch effects, and the user does not want to model these differences in trajectory inference, data integration methods (<xref rid="btad515-B2" ref-type="bibr">Butler <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad515-B17" ref-type="bibr">Luecken <italic toggle="yes">et al.</italic> 2022</xref>) can be used.</p>
      </sec>
      <sec>
        <title>2.1.2 Generation of a large set of clustering results</title>
        <p>To generate a large set of dissimilar clustering results that can be used as the basis for constructing the MST, we use the CLARA <italic toggle="yes">k</italic>-medoids clustering algorithm (<xref rid="btad515-B24" ref-type="bibr">Peter and Rousseeuw 1990</xref>) from the cluster R package, which performs fast <italic toggle="yes">k</italic>-medoids clustering. We run the algorithm <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>L</mml:mi></mml:math></inline-formula> times (by default <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo> </mml:mo><mml:mn>000</mml:mn></mml:math></inline-formula>) and filter out clustering results that have clusters with fewer than five cells to prevent overly small clusters, which are usually not interesting. The number of remaining clustering results (<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>L</mml:mi><mml:mi>′</mml:mi></mml:math></inline-formula>) can be close to <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi>L</mml:mi></mml:math></inline-formula> or deviate from it considerably depending on the dataset. The number of clusters (<inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>) varies by default from 3 to 20, but can be adjusted by the user if more complex trajectories with more milestones are expected. The default upper limit (20) is well above the average number of clusters (milestones) in the trajectories of the dynverse benchmarking framework. We also activate the R random number generation (RNG) in the clara R function so that the program returns different results with different RNG seeds.</p>
      </sec>
      <sec>
        <title>2.1.3 Generation of minimum spanning trees for clustering results</title>
        <p>For each clustering, we generate an MST by representing the clusters of cells as vertices in a graph and using the covariance-based approach of Slingshot (<xref rid="btad515-B28" ref-type="bibr">Street <italic toggle="yes">et al.</italic> 2018</xref>) to measure distances between the clusters. The Mahalanobis-like distances are calculated from the covariance matrix for cells in each cluster, while also considering the shape and spread of the clusters. We use the ape R package to perform the MST estimation (<xref rid="btad515-B23" ref-type="bibr">Paradis and Schliep 2019</xref>).</p>
      </sec>
      <sec>
        <title>2.1.4 Estimate cell connectivity</title>
        <p>For each MST<italic toggle="yes">j</italic> (<inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mi>′</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, we measure the connectivity <italic toggle="yes">c<sub>ij</sub> = d<sub>ij</sub>/k<sub>j</sub></italic> of the <italic toggle="yes">i</italic>th vertex (cluster) in the graph by dividing the degree of the vertex <italic toggle="yes">d<sub>ij</sub></italic>, i.e. the number of edges that are connected to the vertex, by the number of vertices <italic toggle="yes">k<sub>j</sub></italic> in the graph. We then create a connectivity vector <bold><italic toggle="yes">c</italic></bold><sub><italic toggle="yes">j</italic></sub> that contains the connectivity values for all <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi>N</mml:mi></mml:math></inline-formula> cells corresponding to MST <italic toggle="yes">j</italic>, scale the connectivity values so that the maximum connectivity of each graph is always one, and calculate the cell connectivity of all the cells <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula> by averaging over the <italic toggle="yes">L′</italic> connectivity vectors using the arithmetic mean:
</p>
        <disp-formula id="E1">
          <label>(1)</label>
          <mml:math id="M1" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">c</mml:mi>
                  </mml:mrow>
                  <mml:mo>¯</mml:mo>
                </mml:mover>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>L</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">'</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:munderover>
                  <mml:mo stretchy="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>L</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">'</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mrow>
                </mml:munderover>
              </mml:mrow>
              <mml:mrow>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">c</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">max</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">c</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>The cell connectivity is higher for cell populations that are farther from the leaf parts of the trajectory (<xref rid="btad515-F1" ref-type="fig">Fig. 1</xref>). We used the arithmetic mean because it ensures that the connectivity gradient is continuous, as opposed to the median approach (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
      </sec>
      <sec>
        <title>2.1.5 Clustering selection using the variance ratio criterion</title>
        <p>To find a clustering that captures the tree structure of the data and gives clusters that are well defined, we use VRC, also known as the Calinski–Harabasz score (<xref rid="btad515-B3" ref-type="bibr">Caliński and Harabasz 1974</xref>), which measures the ratio of the between-cluster dispersion and the within-cluster dispersion. Instead of using the whole dimensionally reduced data as input, we use the one-dimensional cell connectivity vector <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula> to find clusters that have cells with similar connectivity within the clusters but different compared to the other clusters. VRC is a more memory-efficient method for clustering selection than the commonly used ASW because it does not require a distance matrix of cells as input, making it more suitable for datasets with many cells. We use the fpc R package to perform the VRC analysis.</p>
      </sec>
      <sec>
        <title>2.1.6 Lineage smoothing</title>
        <p>For an MST corresponding to a selected clustering, Totem performs lineage smoothing using Slingshot (<xref rid="btad515-B28" ref-type="bibr">Street <italic toggle="yes">et al.</italic> 2018</xref>), which generates a directed trajectory along with pseudotime that quantifies cell differentiation continuously at the single-cell level. Slingshot fits principal curves (<xref rid="btad515-B13" ref-type="bibr">Hastie and Stuetzle 1989</xref>) for each lineage of the MST starting from a user-specified root node, which is initially selected randomly. The root node can be adjusted later by the user.</p>
      </sec>
      <sec>
        <title>2.1.7 Trajectory visualization and interpretation</title>
        <p>Totem includes visualization functions that aid trajectory inference, utilizing the dynplot R package (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>). The functions enable to visualize multiple MSTs and smoothed trajectories side by side over a two-dimensional embedding. The two-dimensional embedding can be provided by the user or generated using one of the methods included in the dyndimred R package, such as <italic toggle="yes">t</italic>-SNE, UMAP, or MDS. To assist in biological interpretation, the user can also visualize expression levels of genes over the embedding.</p>
        <p>The cell connectivity can be visualized over the two-dimensional embedding to pinpoint milestones and branching points that could be otherwise missed or inaccurately modelled (<xref rid="btad515-F1" ref-type="fig">Fig. 1</xref>). Local changes in the connectivity indicate milestone transitions that are relevant to include in the trajectory. The connectivity levels can be used to locate branching points, where a cell population is encircled by other cell populations whose connectivity is relatively lower (<xref rid="btad515-F4" ref-type="fig">Fig. 4</xref>).</p>
        <p>Although the clustering selection is performed based on the VRC of the cell connectivity, the resulting MST can still be suboptimal in terms of the connections that the milestone network comprises. In addition, small milestones can be missing or the trajectory can seem over-complicated. Therefore, the user should not rely upon a single, automatically generated trajectory. Instead, the trajectory should be validated using gene markers to ensure that the model is biologically sensible, and compared with the cell connectivity by visualization to ensure that the milestone network is in line with the connectivity profile. If the trajectory requires adjustments, Totem allows to easily test different clustering results until a trajectory is obtained that meets both requirements.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Benchmarking</title>
      <p>To benchmark Totem, we repeated the comprehensive benchmarking of scRNA-seq trajectory inference methods using the dynverse framework (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>). We included trajectories that have a tree-like structure, which were labelled as linear, bifurcation, multifurcation, or tree in the original comparison. These comprise 69, 44, 16, and 87 linear, bifurcation, multifurcation, and tree trajectories, respectively. The datasets are of synthetic and real origin. The real datasets include 26 gold standard datasets of which ground-truth includes cell types and their differentiation order at the cluster level (discrete pseudotime). The 54 real, silver standard datasets have a ground-truth that includes a continuous or discrete pseudotime. The synthetic, simulated datasets provide the most accurate ground-truth, and they were simulated using four different simulators: dyntoy (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>), dyngen (<xref rid="btad515-B6" ref-type="bibr">Cannoodt <italic toggle="yes">et al.</italic> 2021</xref>), PROSSTT (<xref rid="btad515-B22" ref-type="bibr">Papadopoulos <italic toggle="yes">et al.</italic> 2019</xref>), and Splatter (<xref rid="btad515-B33" ref-type="bibr">Zappia <italic toggle="yes">et al.</italic> 2017</xref>).</p>
      <p>The dynverse benchmarking framework includes four main metrics. The accuracy of the cell differentiation order is measured using the correlation of pairwise geodesic distances between the ground-truth and predicted trajectories. The accuracy of the differentially expressed genes is measured using the weighted correlation of the random forest regression-derived feature importance lists. The features that are ranked higher in the ground-truth are given a relatively higher weight. The F1 branches value maps the cells to the closest branching points in the ground-truth and inferred trajectories and measures the clustering similarity between the two clustering results. Hamming-Ipsen-Mikhailov (HIM) (<xref rid="btad515-B16" ref-type="bibr">Jurman <italic toggle="yes">et al.</italic> 2015</xref>) measures the similarity of two topologies. For example, two linear trajectories would yield a perfect HIM value of 1, even if the two trajectories would be otherwise completely dissimilar. All four metrics range from 0 to 1 and the geometric mean of the metrics is used to assess the overall performance by penalizing small values in the metrics.</p>
      <p>To benchmark Totem, we compared it with the dynverse implementation of the Slingshot method, which uses PAM (<italic toggle="yes">k</italic>-medoids) clustering algorithm and ASW to select the optimal number of clusters, as well as TinGa, which is based on a GNG model (<xref rid="btad515-B10" ref-type="bibr">Fritzke 1994</xref>). However, the preprocessing was standardized so that each method uses the 5-dimensional LMDS, which is the default feature extraction method of TinGa. All three methods also allow to choose how to perform the normalization, feature selection, and feature extraction steps.</p>
      <p>The vanilla version of Slingshot available at Bioconductor takes as input a low-dimensional embedding, such as principal components or UMAP dimensions, and a clustering. There are no requirements for using a certain type of clustering or embedding. Slingshot models the trajectory topology as an MST and fits one or multiple principal curves, depending on how many lineages there are, using one of the clusters as the starting point. The distances between the clusters are calculated using a Mahalanobis-like distance metric, which can also be changed to a mutual nearest neighbour (MNN) based metric or the Euclidean distance metric. If no starting cluster is specified by the user, Slingshot selects one so that the number of shared clusters between the lineages is maximized before the first branching point.</p>
      <p>In total, the GNG algorithm of TinGa has eight parameters in addition to the input embedding for which the trajectory is inferred. Of the eight GNG-related parameters, the maximum number of nodes (by default, 30) can be decreased if the trajectory has too many milestones (cell types, clusters) in the network. The maximum number of iterations (by default, 10 000) should not be tuned as the high iteration count ensures that the GNG algorithm converges. The six remaining parameters control how sensitively the graph nodes are linked and changed during the iteration, and their adjustment should be considered if tuning the maximum number of nodes does not improve the result. The original article of TinGa mentions that especially adjustment of the two epsilon parameters (<inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ε</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ε</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) affects the performance.</p>
    </sec>
    <sec>
      <title>2.3 Comparing clustering selection methods</title>
      <p>Trajectory inference methods such as Slingshot require a clustering that is used as the basis for constructing the MST, which is subsequently smoothed using the simultaneous principal curves algorithm to obtain a directed trajectory and pseudotime. In addition to the cell connectivity criterion of Totem for clustering selection, we tested three other methods: ASW, which is used by the dynverse implementation of Slingshot; VRC; and the random criterion that ranks the clustering results into a random order.</p>
      <p>To compare the clustering selection methods, we ran the <italic toggle="yes">k</italic>-medoids clustering algorithm (CLARA) 10 000 times for each dataset, selected the top 100 clustering results with each method, performed the trajectory inference using Slingshot for each clustering, and ran the dynverse performance evaluation for the trajectories. For each benchmark dataset, we varied the number of evaluated trajectories from 1 to 100 and calculated the maximum and mean of the overall performance score. Finally, we calculated the mean of the overall scores across the datasets.</p>
    </sec>
    <sec>
      <title>2.4 Robustness of Totem</title>
      <p>We investigated how robust the performance of Totem is with respect to its parameters: the number of clustering results (by default, 10 000) and the range of the <italic toggle="yes">k</italic> values (by default, from 2 to 20) from which the number of clusters is sampled with replacement. We randomly selected 10 datasets from the top 50 datasets with the highest overall score in the benchmark (names listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). For each of the 10 datasets, we ran Totem with different combinations of the number of clusterings (100, 500, 1000, 2500, 5000, 7500) and the upper limit of the <italic toggle="yes">k</italic> range (5, 10, 15, 20, 30, 40). For each parameter configuration and dataset, we ran Totem 10 times using different random seeds. We calculated the dynverse overall score between the inferred and ground-truth trajectories (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Benchmarking Totem for trajectory inference</title>
      <p>To benchmark Totem, we used the dynverse benchmarking framework (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>) that includes 216 tree-shaped trajectories. In our comparison, we included the dynverse implementation of Slingshot (<xref rid="btad515-B28" ref-type="bibr">Street <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>), which uses ASW for clustering selection, and TinGa, which is a GNG-based method (<xref rid="btad515-B10" ref-type="bibr">Fritzke 1994</xref>) that can also predict more complex trajectories than tree-shaped, such as acyclic and disconnected trajectories (<xref rid="btad515-B29" ref-type="bibr">Todorov <italic toggle="yes">et al.</italic> 2020</xref>).</p>
      <p>As shown in the rightmost panel of <xref rid="btad515-F2" ref-type="fig">Fig. 2</xref>, Totem achieved superior overall scores (Friedman test; Bonferroni-adjusted <italic toggle="yes">P</italic>-value ≤ 0.001; Wilcoxon signed-rank test; Bonferroni-adjusted <italic toggle="yes">P</italic>-value ≤ 0.01) for datasets with a nonlinear trajectory (bifurcating, multifurcating, or other nonlinear tree), whereas TinGa was the second-best method for the nonlinear datasets. The violin plots also show that Totem’s distribution of the overall scores with the nonlinear trajectories was more concentrated to higher performance levels compared to TinGa and Slingshot. For linear trajectories, Slingshot achieved superior performance among the tested methods (Friedman test; Bonferroni-adjusted <italic toggle="yes">P</italic>-value ≤ 0.001; Wilcoxon signed-rank test; Bonferroni-adjusted <italic toggle="yes">P</italic>-value ≤ 0.05), while the overall scores of the linear datasets were, on average, similar for TinGa and Totem. The difference in the overall performance was mainly attributable to the differences in the topology accuracy (HIM) and the accuracy of the cell assignment onto the branches (F1 branches). The HIM score of Slingshot was close to perfect for most of the linear datasets but worse compared to TinGa and Totem for the nonlinear datasets.</p>
      <fig position="float" id="btad515-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Results of the benchmarking for trajectory inference from scRNA-seq data. The overall score is the geometric mean of four performance metrics: the correlation of geodesic distances (correlation), which measures accuracy of cellular ordering, the Hamming-Ipsen-Mikhailov (HIM), which measures topological accuracy, the weighted correlation of feature importance lists, which measures accuracy of differentially expressed genes inferred from the trajectory, and the F1 branches, which measures accuracy of cell assignment onto branches. The results were grouped by the performance metric (columns) and whether the ground-truth topology is linear or nonlinear, i.e. bifurcating, multifurcating, or some other nonlinear tree (rows).</p>
        </caption>
        <graphic xlink:href="btad515f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Benchmarking Totem for clustering selection</title>
      <p>Selection of an appropriate clustering for constructing the MST is an important step in the trajectory inference process. Therefore, we took a closer look at the clustering selection step to investigate which clustering selection approach gives the best results when we consider multiple top-ranking trajectories simultaneously. We included two popular clustering selection methods, ASW and VRC, as well as the Totem method that uses cell connectivity and VRC, and also a method that ranks the clustering results into a random order (Random).</p>
      <p>When we tested multiple top-ranking clustering results and always selected the trajectory that gave the best performance in the evaluation, the result suggested that the random criterion gave the best performance (<xref rid="btad515-F3" ref-type="fig">Fig. 3A</xref>). This is an expected result considering that the random criterion generates more dissimilar trajectories than the other methods. However, when we averaged the performance values of the multiple top trajectories (<xref rid="btad515-F3" ref-type="fig">Fig. 3B</xref>), the random criterion was the worst-performing method, as expected. ASW achieved the worst performance among the methods in the analysis in which we selected the best-performing trajectory, and it was the second-worst method when the performance values of the trajectories were averaged. VRC achieved slightly better performance than ASW when selecting the best-performing trajectory, and it was tied with the Totem method as the best method by the average performance. In addition to good average performance, Totem had a relatively high-performance curve in the analysis that considers the performance of the best-performing trajectories, similar with the random criterion. In other words, the selection method of Totem enables to find better performing trajectories than the ASW and VRC without sacrificing as much on the average performance as the random criterion.</p>
      <fig position="float" id="btad515-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Comparing clustering selection methods in the dynverse benchmarking. We selected the top 100 clusterings from 10 000 k-medoids clusterings for each of the 216 dynverse benchmark datasets using four different methods: the average silhouette width (ASW), the variance ratio criterion (VRC), random selection, and the Totem method. For each clustering, the rest of the trajectory inference (Minimum Spanning Tree generation, smoothing) was performed using Slingshot. In (A), we varied the number of top-ranking trajectory models and selected the model for each dataset that gave the best overall score from all the models. In (B), we calculated the mean performance of all the models.</p>
        </caption>
        <graphic xlink:href="btad515f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Examples of trajectory inference with Totem</title>
      <p>To demonstrate the utility of Totem in practice, we considered two datasets from the dynbenchmark database. The datasets meet the prerequisites of Totem: they have a tree-shaped topology with a single starting point and no disconnected parts. Importantly, the cell types of the two datasets are connected in the correct way in their low-dimensional embeddings, in this case 5-dimensional LMDS, a property that generally hinders trajectory inference of many of the dynverse benchmark datasets irrespective of the trajectory method used.</p>
      <p>In the first example, we compared the trajectories (<xref rid="btad515-F4" ref-type="fig">Fig. 4A</xref>) produced by Totem, Slingshot and TinGa for a simulated dataset that has a multifurcating trajectory (named multifurcating_4 in the dynverse benchmark data repository). With Slingshot, we used the ground-truth clustering of the simulated dataset as input. The MST produced by Slingshot was linear and did not correlate well with the true milestone network. The example shows how Slingshot can still produce inaccurate trajectories even if the ground-truth clustering is available because the cluster distances generate an MST with a wrong network. Similarly, TinGa’s trajectory for the dataset was inaccurate because the multifurcation was not symmetrical. In contrast, Totem predicted trajectories that correlated well with the true milestone network. In addition, the cell connectivity measure of Totem provided, in general, accurate information about the location of the end points and the middle branching point.</p>
      <fig position="float" id="btad515-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Example analyses with Slingshot, Totem, and TinGa. (A) A multifurcating trajectory simulated with dyntoy. (B) T cells from a mouse thymus with a bifurcating trajectory. The two-dimensional embeddings for visualization were generated with the Multi-Dimensional Scaling (MDS) method from the dyndimred R package.</p>
        </caption>
        <graphic xlink:href="btad515f4" position="float"/>
      </fig>
      <p>The second example (<xref rid="btad515-F4" ref-type="fig">Fig. 4B</xref>) shows similar results but for a bifurcating trajectory that includes T cells from a mouse thymus (<xref rid="btad515-B12" ref-type="bibr">Han <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>). Based on the trajectory inferred by Slingshot, the topology of this network could be linear, i.e. the starting point would be one of the end nodes, or bifurcating, i.e. the starting point would be one of the middle nodes, if we have no knowledge about the starting point of the trajectory. By selecting a trajectory with Totem that is in line with the cell connectivity profile of the data, we obtain a trajectory with the correct topology (bifurcating), where the bifurcation point is at the node in the middle, from which the bifurcation starts in the ground-truth trajectory. Both of these examples demonstrate, how the cell connectivity helped us to choose trajectories that exhibit the correct topology. TinGa’s trajectory for this dataset was inaccurate because the two end points of the bifurcation were connected.</p>
    </sec>
    <sec>
      <title>3.4 Robustness of Totem</title>
      <p>We investigated the robustness of Totem to its parameters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S2 and S3</xref>). The results show that the robustness of Totem improved when the number of clusterings increased (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>), and the variation was small when the number of clusterings was over 2500 (5000 or 7500). However, the upper limit of the cluster number range did not have a clear impact on the robustness, but it did affect the average performance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). The lowest average performance was achieved when the upper limit of the cluster number range was only five (by default, 20), but otherwise the average performance was robust regardless of the upper limit of the number of clusters.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>While a large number of trajectory inference methods has been developed (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>) for constructing trajectories from single-cell data through mathematical modelling, the usability of these methods remains rather poor. One main reason is that the methods do not work optimally with every dataset, requiring the users to try different methods, tune the parameters, and adjust the preprocessing steps prior to trajectory inference. Oftentimes, the parameter tuning requires detailed knowledge of the underlying statistical and machine learning models, which many users are not familiar with, and the manuals of trajectory inference tools often do not provide clear instructions on how the parameters should be adjusted.</p>
    <p>In this article, we introduced Totem, a tool designed to facilitate the inference of tree-shaped trajectories from single-cell data. Totem generates a large number of clustering results (by default, 10 000) with the <italic toggle="yes">k</italic>-medoids algorithm and calculates the cell connectivity measure, which acts as a useful baseline for finding the optimal trajectory. In our examples, we showed how the cell connectivity enabled us to select clustering results that generated accurate trajectories. Other trajectory inference methods, such as Slingshot (<xref rid="btad515-B28" ref-type="bibr">Street <italic toggle="yes">et al.</italic> 2018</xref>) and TinGa (<xref rid="btad515-B29" ref-type="bibr">Todorov <italic toggle="yes">et al.</italic> 2020</xref>), do not provide a metric like the cell connectivity that can be used as a reference to guide trajectory inference. With these methods the user needs to instead use the visualization to get a sense of the topology, use biological markers to ensure the model is biologically sensible, and change the parameters if the trajectory is not satisfactory, which can be arduous for users without advanced background in mathematics and machine learning.</p>
    <p>In Slingshot, the between-cluster distances determine the MST and the milestone network. Our examples showed how even when the correct cell types were available, the MSTs predicted by Slingshot could still be inaccurate. One solution is to change the distance method, e.g. to a mutual neighbour-based method, but this will still not necessarily generate the correct network. Totem addresses this issue by providing a user-friendly interface to analyse MSTs generated based on different clustering results. With this interface the user can select an MST that best fits to the biological hypothesis and the cell connectivity profile without time-consuming and arbitrary parameter tuning. Totem then smoothens the MSTs of the selected clustering results using the simultaneous principal curves algorithm of Slingshot to obtain directed trajectories that include pseudotime. The trajectories can be exported as Slingshot or dynwrap objects to be used in downstream analysis, e.g. to perform differential expression analysis using tradeSeq (<xref rid="btad515-B30" ref-type="bibr">Van den Berge <italic toggle="yes">et al.</italic> 2020</xref>) or dyno (<xref rid="btad515-B26" ref-type="bibr">Saelens <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>To benchmark Totem for inferring trajectories from scRNA-seq data, we used the dynverse benchmarking framework, which includes 216 tree-shaped trajectories. We compared Totem with the dynverse implementation of Slingshot and TinGa. Totem outperformed the other two methods for nonlinear trajectories (bifurcation, multifurcation, or some other nonlinear tree) and performed comparably with TinGa for linear trajectories. The results suggested that while Slingshot was the best method for linear trajectories among the tested methods, it was significantly worse than TinGa and Totem for nonlinear trajectories. This happened because ASW is generally known to select a small number of clusters, which will more likely generate a linear trajectory than a nonlinear trajectory when used for MST estimation. In contrast, TinGa is more likely to overcomplicate the trajectories with redundant cycles and disconnected parts than Slingshot and Totem, both of which can only infer tree-shaped trajectories. Indeed, the performance differences between the methods were mainly attributable to differences in the accuracy of the topology (HIM) and branch assignment (F1 branches).</p>
    <p>To investigate what is the most optimal way to select the clustering that is used to generate the MST, we generated 10 000 <italic toggle="yes">k</italic>-medoids clustering results for each of the benchmark datasets and ranked them using different clustering evaluation methods, including ASW, VRC, and a Totem criterion that uses cell connectivity and VRC. When we investigated the performance scores of the top 100 clustering results, the results suggested that the Totem criterion and VRC provided the best average performance. However, the Totem criterion outperformed the VRC when we considered only the best trajectory from the set of trajectories. In other words, when testing multiple trajectories, it is more likely that we find a higher-performing trajectory with Totem than with the ASW and VRC methods, and the average performance of all the trajectories found by Totem will likely be at least as good as for the other methods.</p>
    <p>Totem has the same limitations as Slingshot. In particular, it cannot be used to infer trajectories that have cycles or both diverging (cells diverge from a single point into several lineages) and converging (cells converge into a single point from several lineages) parts at the same time. In addition, unlike the updated Slingshot, Totem cannot currently handle disconnected trajectories. However, we do not consider this a major limitation because determining automatically which cell types belong to which disconnected sub-trajectories is not an easy task (<xref rid="btad515-B8" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2022</xref>). A safer approach is to analyse the disconnected parts as separate trajectories by segregating the cell types manually before trajectory inference. Although there exist methods that can handle almost arbitrary topologies, such as PAGA (<xref rid="btad515-B31" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2019</xref>), Monocle3 (<xref rid="btad515-B7" ref-type="bibr">Cao <italic toggle="yes">et al.</italic> 2019</xref>), and TinGa (<xref rid="btad515-B29" ref-type="bibr">Todorov <italic toggle="yes">et al.</italic> 2020</xref>), their issue is that they are more likely to overcomplicate the trajectory with extra cycles and branches than methods like Slingshot and Totem that are limited to tree-shaped trajectories. Similarly, methods like scShaper (<xref rid="btad515-B27" ref-type="bibr">Smolander <italic toggle="yes">et al.</italic> 2021</xref>), SCORPIUS (<xref rid="btad515-B4" ref-type="bibr">Cannoodt 2016</xref>), and Elpilinear (<xref rid="btad515-B1" ref-type="bibr">Albergante <italic toggle="yes">et al.</italic> 2020</xref>) that are limited to linear trajectories are still useful because they are guaranteed to provide the correct topology if the trajectory is expected to be linear, unlike the more complex methods.</p>
    <p>An important consideration is how to perform the upstream analysis steps prior to trajectory inference, including quality control, normalization, and dimensionality reduction. The choice of the normalization method has been shown to affect the cell types that can be identified from single-cell data (<xref rid="btad515-B11" ref-type="bibr">Hafemeister and Satija 2019</xref>), and consequently the trajectory should also change to reflect the varying level of cell heterogeneity. Similarly, the choice of the feature selection and feature extraction methods can have an impact on the identifiable cell types. If analysing data with batch effects, the method used for data integration can also affect the composition of identifiable cell types (<xref rid="btad515-B17" ref-type="bibr">Luecken <italic toggle="yes">et al.</italic> 2022</xref>). Therefore, robustness to the upstream analysis steps should generally not be an objective of trajectory inference. Trajectory inference methods assume that the global distances between the cell types in the low-dimensional embeddings, such as principal components or UMAP dimensions, can be used to model the correct topology. If the correct topology cannot be inferred based on the cell type distances in the embeddings, alternative upstream analysis steps such as embedding refinement should be considered (<xref rid="btad515-B21" ref-type="bibr">Pandey and Zafar 2022</xref>).</p>
    <p>In some cases, it is possible that the optimal trajectory, the one that is in line with the cell connectivity profile, is not readily obtainable from the top-ranking clustering results. This can happen when some cell types are extremely rare and some cell types are highly numerous. This cell number deviation makes it more difficult for the k-medoids to find a clustering result that creates the correct trajectory topology. To alleviate this issue, Totem’s vignette explains that in situations such as these, it is a good idea to increase the number of clusters so that the rare cell types are captured in the clustering. If some of the highly numerous cell types are overclustered, these cell types can be merged using a function implemented in the Totem R package. This approach requires slightly more manual work but will guarantee a clustering that matches the cell connectivity profile.</p>
    <p>As a potential future direction in Totem’s development, the discrete cluster-level connectivity values could be turned into more precise, cell-level connectivity values by measuring the distance of each cell from the central/mass point of the cluster. However, the current implementation of Totem can also model the cell connectivity at the single-cell level by aggregating the connectivity vectors of a large number of clustering results (by default, 10 000) using the arithmetic mean. In our analyses, the arithmetic mean provided a continuous connectivity gradient, as opposed to the median-based approach.</p>
    <p>To summarize, Totem is a tool designed to facilitate the inference of tree-shaped trajectories from single-cell data. It is built upon the popular Slingshot method, which uses a clustering to construct an MST and the simultaneous principal curves algorithm to obtain a directed trajectory along with pseudotime that quantifies cell differentiation at the single-cell level. The benefit of Totem over the available tools is that it is designed to provide a user-friendly interface for finding a clustering that is used as the basis of the trajectory. Although the clustering selection is highly critical for the success of the trajectory inference, performing it automatically in a way that will generate the correct milestone network in the trajectory remains challenging. To address this challenge, the analysis of different clustering results and their MSTs with Totem has been designed to be fast and easy without requiring complex parameter tuning and in-depth technical knowledge. As a notable difference compared to existing trajectory inference methods, Totem provides the cell connectivity measure, which aids the trajectory optimization by providing information about the location of the branching points and milestone transitions.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad515_Supplementary_Data</label>
      <media xlink:href="btad515_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>The authors thank the Elo lab for fruitful discussions and comments on the manuscript.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>L.L.E. reports grants from the European Research Council ERC [677943]; European Union's Horizon 2020 research and innovation programme [955321]; Academy of Finland [310561, 314443, 329278, 335434, 335611, 341342]; Sigrid Juselius Foundation, during the conduct of the study. This work was also supported by Turku Graduate School (UTUGS); Biocenter Finland; ELIXIR Finland.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The benchmark data are available on Zenodo (<xref rid="btad515-B5" ref-type="bibr">Cannoodt <italic toggle="yes">et al.</italic> 2018</xref>). The Totem R package is available at <ext-link xlink:href="https://github.com/elolab/Totem" ext-link-type="uri">https://github.com/elolab/Totem</ext-link>, and it includes a vignette that explains how Totem should be used. The codes that are relevant for repeating the benchmarking are available at <ext-link xlink:href="https://github.com/elolab/Totem-benchmarking" ext-link-type="uri">https://github.com/elolab/Totem-benchmarking</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad515-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Albergante</surname><given-names>L</given-names></string-name>, <string-name><surname>Mirkes</surname><given-names>E</given-names></string-name>, <string-name><surname>Bac</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Robust and scalable learning of complex intrinsic dataset geometry via ElPiGraph</article-title>. <source>Entropy</source><year>2020</year>;<volume>22</volume>:<fpage>296</fpage>.<pub-id pub-id-type="pmid">33286070</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>36</volume>:<fpage>411</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Calinski</surname><given-names>T</given-names></string-name>, <string-name><surname>Harabasz</surname><given-names>J.</given-names></string-name></person-group><article-title>A dendrite method for cluster analysis</article-title>. <source>Comm Stat Theory Methods</source><year>1974</year>;<volume>3</volume>:<fpage>1</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Cannoodt</surname><given-names>R.</given-names></string-name></person-group> SCORPIUS improves trajectory inference and identifies novel modules in dendritic cell development. bioRxiv, <year>2016</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad515-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Cannoodt</surname><given-names>R</given-names></string-name>, <string-name><surname>Saelens</surname><given-names>W</given-names></string-name>, <string-name><surname>Todorov</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal> Single-cell-omics datasets containing a trajectory. <italic toggle="yes">Zenodo</italic>. <year>2018</year>. <pub-id pub-id-type="doi">10.5281/zenodo.1443566</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad515-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cannoodt</surname><given-names>R</given-names></string-name>, <string-name><surname>Saelens</surname><given-names>W</given-names></string-name>, <string-name><surname>Deconinck</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Spearheading future omics analyses using dyngen, a multi-modal simulator of single cells</article-title>. <source>Nat Commun</source><year>2021</year>;<volume>12</volume>:<fpage>3942</fpage>.<pub-id pub-id-type="pmid">34168133</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>J</given-names></string-name>, <string-name><surname>Spielmann</surname><given-names>M</given-names></string-name>, <string-name><surname>Qiu</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title>. <source>Nature</source><year>2019</year>;<volume>566</volume>:<fpage>496</fpage>–<lpage>502</lpage>.<pub-id pub-id-type="pmid">30787437</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>W</given-names></string-name>, <string-name><surname>Guillaume-Gentil</surname><given-names>O</given-names></string-name>, <string-name><surname>Rainer</surname><given-names>PY</given-names></string-name></person-group><etal>et al</etal><article-title>Live-seq enables temporal transcriptomic recording of single cells</article-title>. <source>Nature</source><year>2022</year>;<volume>608</volume>:<fpage>733</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">35978187</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deconinck</surname><given-names>L</given-names></string-name>, <string-name><surname>Cannoodt</surname><given-names>R</given-names></string-name>, <string-name><surname>Saelens</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Recent advances in trajectory inference from single-cell omics data</article-title>. <source>Curr. Opin Syst Biol</source><year>2021</year>;<volume>27</volume>:<fpage>100344</fpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Fritzke</surname><given-names>B.</given-names></string-name></person-group><part-title>A growing neural gas network learns topologies</part-title>. In: <source>Advances in Neural Information Processing Systems</source>. Cambridge, MA: <publisher-name>MIT Press</publisher-name><year>1995</year>.</mixed-citation>
    </ref>
    <ref id="btad515-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hafemeister</surname><given-names>C</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group><article-title>Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>296</fpage>.<pub-id pub-id-type="pmid">31870423</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>X</given-names></string-name>, <string-name><surname>Wang</surname><given-names>R</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Mapping the mouse cell atlas by Microwell-Seq</article-title>. <source>Cell</source><year>2018</year>;<volume>172</volume>:<fpage>1091</fpage>–<lpage>107.e17</lpage>.<pub-id pub-id-type="pmid">29474909</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hastie</surname><given-names>T</given-names></string-name>, <string-name><surname>Stuetzle</surname><given-names>W.</given-names></string-name></person-group><article-title>Principal curves</article-title>. <source>J Am Stat Assoc</source><year>1989</year>;<volume>84</volume>:<fpage>502</fpage>–<lpage>16</lpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ilicic</surname><given-names>T</given-names></string-name>, <string-name><surname>Kim</surname><given-names>JK</given-names></string-name>, <string-name><surname>Kolodziejczyk</surname><given-names>AA</given-names></string-name></person-group><etal>et al</etal><article-title>Classification of low quality cells from single-cell RNA-seq data</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>29</fpage>.<pub-id pub-id-type="pmid">26887813</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Jurman</surname><given-names>G</given-names></string-name>, <string-name><surname>Visintainer</surname><given-names>R</given-names></string-name>, <string-name><surname>Filosi</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal> The HIM glocal metric and kernel for network comparison and classification. In: <italic toggle="yes">2015 IEEE International Conference on Data Science and Advanced Analytics (DSAA).</italic> IEEE, <year>2015</year>, <fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B24">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kaufman</surname><given-names>L</given-names></string-name>, <string-name><surname>Rousseeuw</surname><given-names>PJ.</given-names></string-name></person-group><part-title>Clustering large applications (program CLARA)</part-title>. In: <source>Finding Groups in Data</source>. New York: <publisher-name>John Wiley &amp; Sons</publisher-name><year>1990</year>, <fpage>126</fpage>–<lpage>163</lpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luecken</surname><given-names>MD</given-names></string-name>, <string-name><surname>Büttner</surname><given-names>M</given-names></string-name>, <string-name><surname>Chaichoompu</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Benchmarking atlas-level data integration in single-cell genomics</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>41</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">34949812</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maaten</surname><given-names>L</given-names></string-name>, <string-name><surname>van der Hinton</surname><given-names>G.</given-names></string-name></person-group><article-title>Visualizing data using t-SNE</article-title>. <source>J Mach Learn Res</source><year>2008</year>;<volume>9</volume>:<fpage>2579</fpage>–<lpage>605</lpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B20">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <string-name><surname>Melville</surname><given-names>J.</given-names></string-name></person-group> UMAP: uniform manifold approximation and projection for dimension reduction. arXiv preprint, arXiv:1802.03426, <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="btad515-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pandey</surname><given-names>K</given-names></string-name>, <string-name><surname>Zafar</surname><given-names>H.</given-names></string-name></person-group><article-title>Inference of cell state transitions and cell fate plasticity from single-cell with MARGARET</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>e86</fpage>.<pub-id pub-id-type="pmid">35639499</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Papadopoulos</surname><given-names>N</given-names></string-name>, <string-name><surname>Gonzalo</surname><given-names>PR</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>PROSSTT: probabilistic simulation of single-cell RNA-seq data for complex differentiation processes</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>3517</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30715210</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paradis</surname><given-names>E</given-names></string-name>, <string-name><surname>Schliep</surname><given-names>K.</given-names></string-name></person-group><article-title>ape 5.0: an environment for modern phylogenetics and evolutionary analyses in R</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>526</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30016406</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rousseeuw</surname><given-names>PJ.</given-names></string-name></person-group><article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>. <source>J Comput Appl Math</source><year>1987</year>;<volume>20</volume>:<fpage>53</fpage>–<lpage>65</lpage>.</mixed-citation>
    </ref>
    <ref id="btad515-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saelens</surname><given-names>W</given-names></string-name>, <string-name><surname>Cannoodt</surname><given-names>R</given-names></string-name>, <string-name><surname>Todorov</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>A comparison of single-cell trajectory inference methods</article-title>. <source>Nat Biotechnol</source><year>2019</year>;<volume>37</volume>:<fpage>547</fpage>–<lpage>54</lpage>.<pub-id pub-id-type="pmid">30936559</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smolander</surname><given-names>J</given-names></string-name>, <string-name><surname>Junttila</surname><given-names>S</given-names></string-name>, <string-name><surname>Venäläinen</surname><given-names>MS</given-names></string-name></person-group><etal>et al</etal><article-title>scShaper: an ensemble method for fast and accurate linear trajectory inference from single-cell RNA-seq data</article-title>. <source>Bioinformatics</source><year>2022</year>;38(5):<fpage>1328</fpage>–<lpage>1335</lpage>.<pub-id pub-id-type="pmid">34888622</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Street</surname><given-names>K</given-names></string-name>, <string-name><surname>Risso</surname><given-names>D</given-names></string-name>, <string-name><surname>Fletcher</surname><given-names>RB</given-names></string-name></person-group><etal>et al</etal><article-title>Slingshot: cell lineage and pseudotime inference for single-cell transcriptomics</article-title>. <source>BMC Genomics</source><year>2018</year>;<volume>19</volume>:<fpage>477</fpage>.<pub-id pub-id-type="pmid">29914354</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Todorov</surname><given-names>H</given-names></string-name>, <string-name><surname>Cannoodt</surname><given-names>R</given-names></string-name>, <string-name><surname>Saelens</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>TinGa: fast and flexible trajectory inference with growing neural gas</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>i66</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">32657409</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van den Berge</surname><given-names>K</given-names></string-name>, <string-name><surname>Roux de Bézieux</surname><given-names>H</given-names></string-name>, <string-name><surname>Street</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>Trajectory-based differential expression analysis for single-cell sequencing data</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>1201</fpage>.<pub-id pub-id-type="pmid">32139671</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Hamey</surname><given-names>FK</given-names></string-name>, <string-name><surname>Plass</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>PAGA: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>59</fpage>.<pub-id pub-id-type="pmid">30890159</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ</given-names></string-name></person-group><etal>et al</etal><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source><year>2018</year>;<volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="btad515-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zappia</surname><given-names>L</given-names></string-name>, <string-name><surname>Phipson</surname><given-names>B</given-names></string-name>, <string-name><surname>Oshlack</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>. <source>Genome Biol</source><year>2017</year>;<volume>18</volume>:<fpage>174</fpage>.<pub-id pub-id-type="pmid">28899397</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
